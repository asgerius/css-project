[{"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 3291, "user_id": 3182819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f06bc890e441e9bd3ffba85d8d063f?s=128&d=identicon&r=PG", "display_name": "Thomas Urban", "link": "https://stackoverflow.com/users/3182819/thomas-urban"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1511998733, "post_id": 47563590, "comment_id": 82085246, "body": "Quoting comment on accepted answer in thread linked by @CeriseLim&#243;n: &quot;Identifiers that start with capital letter are exported, it means they are accessible from all packages.&quot; You are obviously missing the same point."}, {"owner": {"reputation": 1, "user_id": 9028377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385ab6e6c3cda34e178dfad7f2f1e2ff?s=128&d=identicon&r=PG&f=1", "display_name": "D.Ritchie", "link": "https://stackoverflow.com/users/9028377/d-ritchie"}, "edited": false, "score": 0, "creation_date": 1512002636, "post_id": 47563590, "comment_id": 82086311, "body": "Very much a duplicate, thank you for showing me to that!"}], "owner": {"reputation": 1, "user_id": 9028377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385ab6e6c3cda34e178dfad7f2f1e2ff?s=128&d=identicon&r=PG&f=1", "display_name": "D.Ritchie", "link": "https://stackoverflow.com/users/9028377/d-ritchie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1512009817, "answer_count": 0, "score": 0, "last_activity_date": 1511998314, "creation_date": 1511998314, "question_id": 47563590, "link": "https://stackoverflow.com/questions/47563590/trying-to-pull-data-from-mongodb-using-go", "closed_reason": "Duplicate", "title": "Trying to pull data from mongodb using go", "body": "<p>I'm trying to understand how to collect data from mongodb using Go. I created a sample database and filled it with one \"person\" with id, login, and password data fields. Here's my struct</p>\n\n<pre><code>type Person struct {\nid     bson.ObjectId   `json:\"id\" bson:\"_id\"`\nlogin  string          `json:\"login\" bson:\"login\"`\npass   string          `json:\"pass\" bson:\"pass\"`}\n</code></pre>\n\n<p>On the mgo documentation, the &amp;data object says to be a interface{} type. I have it defined as a Person struct, yet it still compiles.</p>\n\n<pre><code>data := Person{}\nc.Find(bson.M{\"login\": \"Larry\"}).One(&amp;data)\nfmt.Printf(\"(%v)\\n\", data.pass)\n</code></pre>\n\n<p>When I run the code, it prints: ()</p>\n\n<p>Not sure what I'm doing wrong. If it should be an interface{} type, how could I format that Person interface?</p>\n"}, {"tags": ["docker", "go", "gitlab", "gitlab-ci", "gitlab-ci-runner"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511996663, "post_id": 47563115, "comment_id": 82084535, "body": "I&#39;m not sure how gitlab-ci works, but would it fix your problem if you vendor your dependencies, deploy them together with your project, and just not run dep at all?"}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511996893, "post_id": 47563115, "comment_id": 82084615, "body": "Dependencies (vendor) are compiled to *.so files, they should be compiled in same environment where binary is compiled. Also deps are 150 megabytes. Would be to heavy to store and update them every time. Gitlab-CI runner should do all compiling, building, testing and deploying process. I&#39;ve posted only compile section which is failing. Developer needs only to write code and push it to gitlab. Everything should be done by Gitlab-CI runner."}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997145, "post_id": 47563115, "comment_id": 82084700, "body": "@mkopriva Please see my upper comment. Maybe I&#39;m missing something ? I&#39;m a novice at Golang"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997373, "post_id": 47563115, "comment_id": 82084776, "body": "Usually, and your case may differ, Go dependencies are kept in a vendor folder inside the project folder, and they are kept in their original form, *.go. That means that if you have all your Go deps in the vendor folder inside your project, push that to a remote server, and run go install, your project should be compiled together with the deps and without an issue."}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997569, "post_id": 47563115, "comment_id": 82084851, "body": "@mkopriva Do I need to also push Gopkg.lock and Gopkg.toml files to my repository in case if I&#39;m pushing vendor directory? I will use your suggestion as a backup variant, if no one will offer how to solve problem with Gitlab-CI"}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997706, "post_id": 47563115, "comment_id": 82084891, "body": "@mkopriva I took, one of my dependencies, and did inspection of their repository. <a href=\"https://github.com/aws/aws-sdk-go\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go</a> They have pushed their vendor and also Gopkg.toml and Gopkg.lock files to their repository. Is it normal practice with golang to push vendor and those files ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997793, "post_id": 47563115, "comment_id": 82084922, "body": "On the requirement of having the lock files in vendor when deploying: I don&#39;t really think so, the vendor directory itself is recognized by default by Go since version 1.7? or something. The locks are <code>dep</code> specific I believe."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511997843, "post_id": 47563115, "comment_id": 82084945, "body": "Yes it is normal to put your dependencies in your project and keep them in the repo, remote or not. <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">github.com/golang/dep</a> does that too, as most other Go projects do too."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511998144, "post_id": 47563115, "comment_id": 82085037, "body": "There are multiple different dependency management tools for Go, they all store the deps in the <code>vendor</code> folder because it&#39;s supported by Go, but they may have different ways of tracking the versions of the deps, <code>dep</code> uses .lock files; <code>Govendor</code> uses a vendor.json file, these are non-standard but the <code>vendor</code> folder is."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1511999717, "post_id": 47563115, "comment_id": 82085546, "body": "Make sure your project on the ci server / docker image is under go path directory as well. <a href=\"https://github.com/vardius/go-api-boilerplate/blob/master/Dockerfile\" rel=\"nofollow noreferrer\">This</a> is how I build my project under docker environment"}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1511999942, "post_id": 47563115, "comment_id": 82085638, "body": "@Vardius It is under $GOPATH. As you can see in my gitlab-ci.yml file, I&#39;m creating $GOPATH/src/$REPO_NAME directory and symlinking all files to that directory. It is done same as in official golang template from gitlab."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1512000007, "post_id": 47563115, "comment_id": 82085661, "body": "Try to copy ur directories when running dep init in a directory that is linked it may not work"}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1512000080, "post_id": 47563115, "comment_id": 82085684, "body": "@Vardius Already tried. Same result as with symlinking. If finds half of dependencies, and when building is done, fails with same missing deps."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1512000099, "post_id": 47563115, "comment_id": 82085687, "body": "You may want to check some issues like <a href=\"https://github.com/golang/dep/issues/1146\" rel=\"nofollow noreferrer\">this one</a>"}, {"owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "reply_to_user": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1512000381, "post_id": 47563115, "comment_id": 82085754, "body": "@Vardius Thank you for pointing to that problem again. Added cp -rf $CI_PROJECT_DIR/* $GOPATH/src/$REPO_NAME/ instead of symlink and it worked !!! You can make an answer. I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "is_accepted": true, "score": 1, "last_activity_date": 1512000771, "creation_date": 1512000771, "answer_id": 47563939, "question_id": 47563115, "link": "https://stackoverflow.com/questions/47563115/failing-to-compile-golang-project-in-gitlab-ci-using-docker-image/47563939#47563939", "title": "Failing to compile golang project in gitlab-ci using docker image", "body": "<p>The reason it might now work on a CI server might be the symlinks.\nAs said for example in this issue <a href=\"https://github.com/golang/dep/issues/1146\" rel=\"nofollow noreferrer\">Symlinked project root is not handled as I would expect</a>.</p>\n\n<p>You might want to hard copy your project files and give it a try. I think it should fix your issue.</p>\n\n<p>This answer is summary of a talk leading to a solution between me and @user991 in a question comments.</p>\n"}], "owner": {"reputation": 1210, "user_id": 1392749, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/VNYLb.png?s=128&g=1", "display_name": "user991", "link": "https://stackoverflow.com/users/1392749/user991"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "accepted_answer_id": 47563939, "answer_count": 1, "score": 2, "last_activity_date": 1512001636, "creation_date": 1511995528, "last_edit_date": 1512001636, "question_id": 47563115, "link": "https://stackoverflow.com/questions/47563115/failing-to-compile-golang-project-in-gitlab-ci-using-docker-image", "title": "Failing to compile golang project in gitlab-ci using docker image", "body": "<p>I'm failing to build my golang project using gitlab-ci.\nWhen running dep init inside of project directory it fetches only part of my dependencies, and when tries to build binary fails with error that dependencies aren't found. When I'm building my project on osx, or running docker golang image to compile project on osx it builds successfully.</p>\n\n<p>My .gitlab-ci.yml file:</p>\n\n<pre><code>image: golang:1.9.2\n\nvariables:\n  REPO_NAME: storage\n\nbefore_script:\n  - mkdir -p $GOPATH/src/$REPO_NAME\n  - ln -svf $CI_PROJECT_DIR/* $GOPATH/src/$REPO_NAME\n  - cd $GOPATH/src/$REPO_NAME\n  - go get -u github.com/golang/dep/cmd/dep\n  - dep init\n\nstages:\n  - compile\n\ncompile:\n    stage: compile\n    script:\n      - go build -o $CI_PROJECT_DIR/main\n    artifacts:\n      paths:\n        - main\n</code></pre>\n\n<p>Output of gitlab-runner task:</p>\n\n<pre><code>[0KRunning with gitlab-runner 10.2.0 (0a75cdd1)\n  on docker-auto-scale (4e4528ca)\n[0;m[0KUsing Docker executor with image golang:1.9.2 ...\n[0;m[0KUsing docker image sha256:5f8b4886692c4897e1f0855043da1896fe4f1e6762fccddfa2114a2fdfa1674f for predefined container...\n[0;m[0KPulling docker image golang:1.9.2 ...\n[0;m[0KUsing docker image golang:1.9.2 ID=sha256:1a34fad76b34f485ebc72d32044cafe963ae00c8e80dbf4115bafabd31e93ff6 for build container...\n[0;msection_start:1511994825:prepare_script\n[0KRunning on runner-4e4528ca-project-4778312-concurrent-0 via runner-4e4528ca-srm-1511994698-320032ac...\nsection_end:1511994828:prepare_script\n[0Ksection_start:1511994828:get_sources\n[0K[32;1mCloning repository...[0;m\nCloning into '/builds/group-name/service-storage'...\n[32;1mChecking out f59f57e4 as master...[0;m\n[32;1mSkipping Git submodules setup[0;m\nsection_end:1511994831:get_sources\n[0Ksection_start:1511994831:restore_cache\n[0Ksection_end:1511994832:restore_cache\n[0Ksection_start:1511994832:download_artifacts\n[0Ksection_end:1511994834:download_artifacts\n[0Ksection_start:1511994834:build_script\n[0K[32;1m$ mkdir -p $GOPATH/src/$REPO_NAME[0;m\n[32;1m$ ln -svf $CI_PROJECT_DIR/* $GOPATH/src/$REPO_NAME[0;m\n'/go/src/storage/Dockerfile' -&gt; '/builds/group-name/service-storage/Dockerfile'\n'/go/src/storage/aws' -&gt; '/builds/group-name/service-storage/aws'\n'/go/src/storage/db' -&gt; '/builds/group-name/service-storage/db'\n'/go/src/storage/logHelper' -&gt; '/builds/group-name/service-storage/logHelper'\n'/go/src/storage/main' -&gt; '/builds/group-name/service-storage/main'\n'/go/src/storage/main.go' -&gt; '/builds/group-name/service-storage/main.go'\n'/go/src/storage/responses' -&gt; '/builds/group-name/service-storage/responses'\n'/go/src/storage/routers' -&gt; '/builds/group-name/service-storage/routers'\n[32;1m$ cd $GOPATH/src/$REPO_NAME[0;m\n[32;1m$ go get -u github.com/golang/dep/cmd/dep[0;m\n[32;1m$ dep init[0;m\n  Using ^1.2.0 as constraint for direct dep github.com/joho/godotenv\n  Locking in v1.2.0 (a79fa1e) for direct dep github.com/joho/godotenv\n  Using ^1.6.0 as constraint for direct dep github.com/gorilla/mux\n  Locking in v1.6.0 (7f08801) for direct dep github.com/gorilla/mux\n  Locking in v1.1 (1ea2538) for transitive dep github.com/gorilla/context\n[32;1m$ go build -o $CI_PROJECT_DIR/main[0;m\naws/aws.go:16:2: cannot find package \"github.com/aws/aws-sdk-go/aws\" in any of:\n    /go/src/storage/vendor/github.com/aws/aws-sdk-go/aws (vendor tree)\n    /usr/local/go/src/github.com/aws/aws-sdk-go/aws (from $GOROOT)\n    /go/src/github.com/aws/aws-sdk-go/aws (from $GOPATH)\naws/aws.go:17:2: cannot find package \"github.com/aws/aws-sdk-go/aws/credentials\" in any of:\n    /go/src/storage/vendor/github.com/aws/aws-sdk-go/aws/credentials (vendor tree)\n    /usr/local/go/src/github.com/aws/aws-sdk-go/aws/credentials (from $GOROOT)\n    /go/src/github.com/aws/aws-sdk-go/aws/credentials (from $GOPATH)\naws/aws.go:18:2: cannot find package \"github.com/aws/aws-sdk-go/aws/session\" in any of:\n    /go/src/storage/vendor/github.com/aws/aws-sdk-go/aws/session (vendor tree)\n    /usr/local/go/src/github.com/aws/aws-sdk-go/aws/session (from $GOROOT)\n    /go/src/github.com/aws/aws-sdk-go/aws/session (from $GOPATH)\naws/aws.go:19:2: cannot find package \"github.com/aws/aws-sdk-go/service/s3\" in any of:\n    /go/src/storage/vendor/github.com/aws/aws-sdk-go/service/s3 (vendor tree)\n    /usr/local/go/src/github.com/aws/aws-sdk-go/service/s3 (from $GOROOT)\n    /go/src/github.com/aws/aws-sdk-go/service/s3 (from $GOPATH)\nrouters/v1/images/imageFunctions/save_images.go:23:2: cannot find package \"github.com/disintegration/imaging\" in any of:\n    /go/src/storage/vendor/github.com/disintegration/imaging (vendor tree)\n    /usr/local/go/src/github.com/disintegration/imaging (from $GOROOT)\n    /go/src/github.com/disintegration/imaging (from $GOPATH)\ndb/dbFunctions/db_functions.go:7:2: cannot find package \"github.com/satori/go.uuid\" in any of:\n    /go/src/storage/vendor/github.com/satori/go.uuid (vendor tree)\n    /usr/local/go/src/github.com/satori/go.uuid (from $GOROOT)\n    /go/src/github.com/satori/go.uuid (from $GOPATH)\ndb/db.go:13:2: cannot find package \"gopkg.in/mgo.v2\" in any of:\n    /go/src/storage/vendor/gopkg.in/mgo.v2 (vendor tree)\n    /usr/local/go/src/gopkg.in/mgo.v2 (from $GOROOT)\n    /go/src/gopkg.in/mgo.v2 (from $GOPATH)\ndb/db.go:14:2: cannot find package \"gopkg.in/mgo.v2/bson\" in any of:\n    /go/src/storage/vendor/gopkg.in/mgo.v2/bson (vendor tree)\n    /usr/local/go/src/gopkg.in/mgo.v2/bson (from $GOROOT)\n    /go/src/gopkg.in/mgo.v2/bson (from $GOPATH)\nsection_end:1511994846:build_script\n[0Ksection_start:1511994846:after_script\n[0Ksection_end:1511994847:after_script\n[0K[31;1mERROR: Job failed: exit code 1\n[0;m\n</code></pre>\n\n<p>When running locally on osx, I see that dep init pulls all dependencies, and after that I can successfully run go build and it will build binary.</p>\n\n<pre><code>username@hostname storage (master) $ dep init\n  Locking in v1.1 (1ea2538) for transitive dep github.com/gorilla/context\n  Locking in v1.32.0 (32e4c1e) for transitive dep github.com/go-ini/ini\n  Locking in master (f7e31b4) for transitive dep golang.org/x/image\n  Using ^1.6.0 as constraint for direct dep github.com/gorilla/mux\n  Locking in v1.6.0 (7f08801) for direct dep github.com/gorilla/mux\n  Using ^1.1.0 as constraint for direct dep github.com/satori/go.uuid\n  Locking in v1.1.0 (879c588) for direct dep github.com/satori/go.uuid\n  Using ^1.2.0 as constraint for direct dep github.com/joho/godotenv\n  Locking in v1.2.0 (a79fa1e) for direct dep github.com/joho/godotenv\n  Using ^1.12.36 as constraint for direct dep github.com/aws/aws-sdk-go\n  Locking in v1.12.36 (5bcc0a2) for direct dep github.com/aws/aws-sdk-go\n  Locking in  (0b12d6b5) for transitive dep github.com/jmespath/go-jmespath\n  Using v2 as constraint for direct dep gopkg.in/mgo.v2\n  Locking in v2 (3f83fa5) for direct dep gopkg.in/mgo.v2\n  Using ^1.2.4 as constraint for direct dep github.com/disintegration/imaging\n  Locking in v1.2.4 (dd50a3e) for direct dep github.com/disintegration/imaging\n</code></pre>\n\n<p>Also I have tried to run on OSX locally using docker golang image and it compiles fine:</p>\n\n<pre><code>docker run --rm -v \"$PWD\":/go/src/storage -w /go/src/storage golang:1.9.2 go get -u github.com/golang/dep/cmd/dep &amp;&amp; dep init\n\ndocker run --rm -v \"$PWD\":/go/src/storage -w /go/src/storage golang:1.9.2 go build -v -o main\n</code></pre>\n\n<p>Problem only exists, running on gitlab-ci.</p>\n\n<p>Tried various golang images, alpine and others. Same result, it always fails with same missing dependencies.</p>\n\n<p><strong>Update and Solution example:</strong></p>\n\n<p>As user @vardius pointed and comments and later made an answer, problem was with symlinking.</p>\n\n<p>Replaced my line in .gitlab-ci.yml from:</p>\n\n<pre><code>- ln -svf $CI_PROJECT_DIR/* $GOPATH/src/$REPO_NAME\n</code></pre>\n\n<p>to</p>\n\n<pre><code>- cp -rf $CI_PROJECT_DIR/* $GOPATH/src/$REPO_NAME/\n</code></pre>\n\n<p>and everything compiled.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1511988966, "post_id": 47561632, "comment_id": 82081017, "body": "Try writing a newline"}, {"owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1511989004, "post_id": 47561632, "comment_id": 82081040, "body": "I have tried that like <code>w.WriteString(testIn + &quot;\\n&quot;)</code>. I didn&#39;t work."}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1511989186, "post_id": 47561632, "comment_id": 82081129, "body": "Works for me on the playground: <a href=\"https://play.golang.org/p/ZK46IIYX12\" rel=\"nofollow noreferrer\">play.golang.org/p/ZK46IIYX12</a>"}, {"owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1511989798, "post_id": 47561632, "comment_id": 82081454, "body": "Sorry my bad! The problem was actually that I had to use a whitespace and I was using Reader instead of Writer!"}], "owner": {"reputation": 3049, "user_id": 774437, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/6fL8U.jpg?s=128&g=1", "display_name": "moorara", "link": "https://stackoverflow.com/users/774437/moorara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1464, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1511988838, "creation_date": 1511988838, "question_id": 47561632, "link": "https://stackoverflow.com/questions/47561632/how-to-pipe-stdin-in-golang", "title": "How to pipe stdin in golang?", "body": "<p>I'm connecting a pipe to my <code>stdout</code> in golang as follows for the purpose of testing (I stripped out the error handling codes):</p>\n\n<pre><code>stdout := os.Stdout\ndefer func() {\n  os.Stdout = stdout\n}()\n\nr, w, _ = os.Pipe()\nos.Stdout = w\n\nvar buf bytes.Buffer\nfmt.Print(testOut)\nw.Close()\nio.Copy(&amp;buf, r)\nassert.Equal(t, testOut, buf.String())\n</code></pre>\n\n<p>I want to basically do something similar with <code>stdin</code> as well. Something like this:</p>\n\n<pre><code>stdin := os.Stdin\ndefer func() {\n  os.Stdin = stdin\n}()\n\nr, w, _ = os.Pipe()\nos.Stdin = r\n\nvar in string\nw.WriteString(testIn)\n// w.Close()\nfmt.Scan(&amp;in)\nassert.Equal(t, testIn, in)\n</code></pre>\n\n<p>But, I cannot get this working. If I don't close <code>w</code>, <code>fmt.Scan(&amp;in)</code> never returns. If I close <code>w</code>, I get <code>file already closed</code> error.</p>\n\n<p>Any I idea how to get this working?</p>\n"}, {"tags": ["go", "video-streaming", "html5-video"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 7, "creation_date": 1511984353, "post_id": 47560370, "comment_id": 82078726, "body": "Because seeking the video at client side requires support for partial content serving from the server. See possible duplicate: <a href=\"https://stackoverflow.com/questions/36540610/how-to-serve-http-partial-content-with-go\">How to serve http partial content with Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2947, "user_id": 1308883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEAHs.jpg?s=128&g=1", "display_name": "Jofre", "link": "https://stackoverflow.com/users/1308883/jofre"}, "edited": false, "score": 0, "creation_date": 1529006195, "post_id": 50864641, "comment_id": 88732480, "body": "BTW, as @icza said in the comment to the original question, the reason for this different behavior (that I had not digged in), is clearly explained in <a href=\"https://stackoverflow.com/questions/36540610/how-to-serve-http-partial-content-with-go\">this other SO answer</a>."}], "tags": [], "owner": {"reputation": 2947, "user_id": 1308883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IEAHs.jpg?s=128&g=1", "display_name": "Jofre", "link": "https://stackoverflow.com/users/1308883/jofre"}, "is_accepted": false, "score": 3, "last_activity_date": 1529004722, "creation_date": 1529004722, "answer_id": 50864641, "question_id": 47560370, "link": "https://stackoverflow.com/questions/47560370/stream-video-in-go-lang-server/50864641#50864641", "title": "Stream video in Go lang server", "body": "<p>This different behavior is directly addressed on the <code>net/http</code> package, on the documentation for <a href=\"https://golang.org/pkg/net/http/#ServeContent\" rel=\"nofollow noreferrer\">ServeContent</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>ServeContent replies to the request using the content in the provided ReadSeeker. <strong>The main benefit of ServeContent over io.Copy is that it handles Range requests properly</strong>, sets the MIME type, and handles If-Match, If-Unmodified-Since, If-None-Match, If-Modified-Since, and If-Range requests.</p>\n</blockquote>\n\n<p>If you check the <code>net/http</code> code, you'll see that <a href=\"https://golang.org/src/net/http/fs.go#L662\" rel=\"nofollow noreferrer\"><code>ServeFile</code></a> calls <a href=\"https://golang.org/src/net/http/fs.go#L180\" rel=\"nofollow noreferrer\"><code>serveContent</code></a> (through <a href=\"https://golang.org/src/net/http/fs.go#L540\" rel=\"nofollow noreferrer\"><code>serveFile</code></a>), which is the same unexported function called by <a href=\"https://golang.org/src/net/http/fs.go#L151\" rel=\"nofollow noreferrer\"><code>ServeContent</code></a>.</p>\n\n<p>I've not digged into the reason for the different behaviors, but the documentation on the package makes quite clear why your <code>io.Copy</code> strategy is not working, while the <code>http.ServeFile</code> does.</p>\n"}], "owner": {"reputation": 967, "user_id": 1150241, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/a701c26f8b85f00dce28ec874eb2f21f?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1150241/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7371, "favorite_count": 6, "answer_count": 1, "score": 10, "last_activity_date": 1529004722, "creation_date": 1511983821, "last_edit_date": 1511984215, "question_id": 47560370, "link": "https://stackoverflow.com/questions/47560370/stream-video-in-go-lang-server", "title": "Stream video in Go lang server", "body": "<p>I've written this simple http server to serve video file:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os\"\n    \"bytes\"\n    \"io\"\n    \"fmt\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n\nrangeValue := r.Header.Get(\"range\")\nfmt.Println(\"Range:\")\nfmt.Println(rangeValue)\n\nbuf := bytes.NewBuffer(nil)\nf, _ := os.Open(\"oceans_1.webm\")\nio.Copy(buf, f)           // Error handling elided for brevity.\nf.Close()\n\nw.Header().Set(\"Accept-Ranges\",\"bytes\")\nw.Header().Set(\"Content-Type\", \"video/webm\")\nw.Header().Set(\"Content-Length\",\"22074728\")\nw.Header().Set(\"Last-Modified\", \"Wed, 29 Nov 2017 17:10:44 GMT\")\n\nw.WriteHeader(206)\nw.Write(buf.Bytes())\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>The video is served perfect, but I can not change time of the video. When I click on the timeline video cursor it doesn't change the position and the video doesn't jump to specific time.</p>\n\n<p>When I serve the video using <code>http.ServeFile(w, r, \"oceans_1.webm\")</code> everything works perfect - I can change video time.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1511994160, "post_id": 47559830, "comment_id": 82083525, "body": "See also: <a href=\"https://github.com/golang/go/issues/6842\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/6842</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1019, "user_id": 1453704, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/h6nHH.png?s=128&g=1", "display_name": "deeptimancode", "link": "https://stackoverflow.com/users/1453704/deeptimancode"}, "edited": false, "score": 0, "creation_date": 1560218433, "post_id": 47559862, "comment_id": 99653759, "body": "awesome, perfect explanation :)"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 6, "last_activity_date": 1511993324, "last_edit_date": 1511993324, "creation_date": 1511981816, "answer_id": 47559862, "question_id": 47559830, "link": "https://stackoverflow.com/questions/47559830/why-is-a-structs-field-a-non-name/47559862#47559862", "title": "Why is a struct&#39;s field a &quot;non-name&quot;", "body": "<p>The <code>:=</code> operator simultaneously declares a new variable, and assigns a value to it. <code>j.Bar</code> is not a legal variable name in Go; variable names cannot contain periods. Now, obviously you're trying to assign a value to a struct field, not a variable with a period in its name (the compiler just doesn't know it). You can do this, using just assignment without declaration:</p>\n\n<pre><code>var ok bool\nj.Bar, ok = os.LookupEnv(\"SOME VAR\")\n</code></pre>\n\n<p>Or this, declaring two variables at once:</p>\n\n<pre><code>bar,ok := os.LookupEnv(\"SOME VAR\")\nif ok {\n    j.Bar = bar\n}\n</code></pre>\n\n<p>See also: <a href=\"https://tour.golang.org/basics/10\" rel=\"nofollow noreferrer\">Go tour on short variable declarations</a> and <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">the spec on short variable declarations</a>.</p>\n"}], "owner": {"reputation": 759, "user_id": 607453, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/f460ee15558ce3c81d2048c7778476a9?s=128&d=identicon&r=PG", "display_name": "raindog308", "link": "https://stackoverflow.com/users/607453/raindog308"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1913, "favorite_count": 0, "closed_date": 1570046614, "answer_count": 1, "score": 1, "last_activity_date": 1570046606, "creation_date": 1511981714, "last_edit_date": 1570046606, "question_id": 47559830, "link": "https://stackoverflow.com/questions/47559830/why-is-a-structs-field-a-non-name", "closed_reason": "Duplicate", "title": "Why is a struct&#39;s field a &quot;non-name&quot;", "body": "<p>This code does not work.  It complains that j.Bar is a \"non-name\":</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\ntype foo struct {\n    Bar string\n    Baz int\n}\n\nfunc main() {\n    var j foo\n\n    // this next line fails with \"non-name j.Bar on left side of :=\"\n    j.Bar, ok := os.LookupEnv(\"SOME VAR\")\n    if ( ! ok ) {\n        panic(\"lookup failed!\")\n    }\n    fmt.Printf(\"j.Bar is now %s\\n\",j.Bar)\n}\n</code></pre>\n\n<p>Now I can change it easily to work:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\ntype foo struct {\n    Bar string\n    Baz int\n}\n\nfunc main() {\n    var j foo\n\n    val, ok := os.LookupEnv(\"SOME VAR\")\n    if ( ! ok ) {\n        panic(\"lookup failed!\")\n    }\n    j.Bar = val\n    fmt.Printf(\"j.Bar is now %s\\n\",j.Bar)\n}\n</code></pre>\n\n<p>I'm really puzzled by the \"non-name\" error.  j.Bar is a string.  <a href=\"https://golang.org/pkg/os/#LookupEnv\" rel=\"nofollow noreferrer\">os.LookupEnv() returns a string</a> as its first value.  So what is the problem with taking a string and putting it into a string variable?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1511976420, "post_id": 47558389, "comment_id": 82074451, "body": "There&#39;s not one. Try <code>if condition { panic(message) }</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 7, "creation_date": 1511976577, "post_id": 47558389, "comment_id": 82074535, "body": "See also <a href=\"https://golang.org/doc/faq#assertions\" rel=\"nofollow noreferrer\">golang.org/doc/faq#assertions</a>"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 1, "creation_date": 1511978790, "post_id": 47558389, "comment_id": 82075866, "body": "If you need it did testing there\u2019s excellent <code>testing </code>package   Also have a look at <a href=\"https://godoc.org/github.com/stretchr/testify/assert\" rel=\"nofollow noreferrer\">godoc.org/github.com/stretchr/testify/assert</a>"}, {"owner": {"reputation": 1589, "user_id": 5380414, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FGXKX.jpg?s=128&g=1", "display_name": "Yixing Liu", "link": "https://stackoverflow.com/users/5380414/yixing-liu"}, "edited": false, "score": 0, "creation_date": 1532905250, "post_id": 47558389, "comment_id": 90136015, "body": "I understand that it is a design choice to not support assert() in Go. I asked this question just because I wanted to use it in a course project for debugging purpose, not in production."}], "answers": [{"comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1512074350, "post_id": 47559438, "comment_id": 82121974, "body": "Don&#39;t use panics, but properly handle the error! <a href=\"https://stackoverflow.com/questions/25356602/golang-panic-crash-prevention\" title=\"golang panic crash prevention\">stackoverflow.com/questions/25356602/&hellip;</a>"}, {"owner": {"reputation": 4386, "user_id": 15529, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/094c4877f215aa468d84c42a4127c585?s=128&d=identicon&r=PG", "display_name": "gimpf", "link": "https://stackoverflow.com/users/15529/gimpf"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 22, "creation_date": 1553524157, "post_id": 47559438, "comment_id": 97405206, "body": "sry @RickyA, but this ignores the stark difference between regular runtime errors and programming/logic bugs: <code>panic()</code> in Go (as <code>assert</code> in C et al.) is used to signal when a bug has been encountered; you check for invariants that must never be violated (because the code should properly handle error conditions...), but if the invariant is broken, a Bug has occurred. Examples are like &quot;index must be within bounds&quot; when accessing a slice, etc."}, {"owner": {"reputation": 314, "user_id": 5579463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b605f30fa77cd9f62b99fd74c2ce8cf2?s=128&d=identicon&r=PG&f=1", "display_name": "MrR", "link": "https://stackoverflow.com/users/5579463/mrr"}, "edited": false, "score": 0, "creation_date": 1600196576, "post_id": 47559438, "comment_id": 113010320, "body": "I guess the next question is, does an invariant having be violated warrant the program having to halt execution? E.g. imagine the condition being triggered only by some work items in a queue, even if an &quot;invariant&quot; has been violated, I still want to process the next item?"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 25, "last_activity_date": 1597424175, "last_edit_date": 1597424175, "creation_date": 1511980190, "answer_id": 47559438, "question_id": 47558389, "link": "https://stackoverflow.com/questions/47558389/what-is-the-go-equivalent-to-assert-in-c/47559438#47559438", "title": "What is the Go equivalent to assert() in C++?", "body": "<p>As mentioned by commenters, <a href=\"https://golang.org/doc/faq#assertions\" rel=\"noreferrer\">Go does not have assertions</a>.</p>\n<p>A comparable alternative in Go is the <a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"noreferrer\">built-in function <code>panic(...)</code></a>, gated by a condition:</p>\n<pre><code>if condition {\n  panic(err)\n}\n</code></pre>\n<p>This <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"noreferrer\">article titled &quot;Defer, Panic, and Recover&quot;</a> may also be informative.</p>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "is_accepted": false, "score": 1, "last_activity_date": 1597424320, "last_edit_date": 1597424320, "creation_date": 1575504414, "answer_id": 59186358, "question_id": 47558389, "link": "https://stackoverflow.com/questions/47558389/what-is-the-go-equivalent-to-assert-in-c/59186358#59186358", "title": "What is the Go equivalent to assert() in C++?", "body": "<p>I actually use a little helper:</p>\n<pre><code>func failIf(err error, msg string) {\n  if err != nil {\n    log.Fatalf(&quot;error &quot; + msg + &quot;: %v&quot;, err)\n  }\n}\n</code></pre>\n<p>And then in use:</p>\n<pre><code>db, err := sql.Open(&quot;mysql&quot;, &quot;my_user@/my_database&quot;)\ndefer db.Close()\nfailIf(err, &quot;connecting to my_database&quot;)\n</code></pre>\n<p>On failure it generates:</p>\n<blockquote>\n<p>error connecting to my_database: &lt;error from MySQL/database&gt;</p>\n</blockquote>\n"}], "owner": {"reputation": 1589, "user_id": 5380414, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FGXKX.jpg?s=128&g=1", "display_name": "Yixing Liu", "link": "https://stackoverflow.com/users/5380414/yixing-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15756, "favorite_count": 4, "accepted_answer_id": 47559438, "answer_count": 2, "score": 24, "last_activity_date": 1597424320, "creation_date": 1511976373, "last_edit_date": 1592644375, "question_id": 47558389, "link": "https://stackoverflow.com/questions/47558389/what-is-the-go-equivalent-to-assert-in-c", "title": "What is the Go equivalent to assert() in C++?", "body": "<p>I'm looking for a condition check in Go which can terminate the program execution like <a href=\"http://www.cplusplus.com/reference/cassert/assert/\" rel=\"noreferrer\">assert</a> in C++.</p>\n"}, {"tags": ["parsing", "go", "http-post"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511975773, "post_id": 47558164, "comment_id": 82074080, "body": "If you&#39;re putting the body into a <code>bytes.Reader</code> or <code>bytes.Buffer</code>, you are essentially just keeping the same cached byte slice. Are you trying to avoid copying it with <code>ReadAll</code>?"}, {"owner": {"reputation": 1239, "user_id": 2806963, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j1xpG.png?s=128&g=1", "display_name": "Shawn Throop", "link": "https://stackoverflow.com/users/2806963/shawn-throop"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511975972, "post_id": 47558164, "comment_id": 82074184, "body": "@JimB <code>ReadAll</code> was just the simplest way I&#39;ve found to read everything from <code>Body</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511976448, "post_id": 47558164, "comment_id": 82074466, "body": "I&#39;m asking why you think putting the byte slice back into the body is expensive?  Are you trying to avoid the copy, or something else? Simply wrapping the byte slice in a <code>Reader</code> and <code>Closer</code> is no more expensive than your context method. If you want to avoid the copy, make a simple type to give you direct access to the bytes from the body."}, {"owner": {"reputation": 1239, "user_id": 2806963, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j1xpG.png?s=128&g=1", "display_name": "Shawn Throop", "link": "https://stackoverflow.com/users/2806963/shawn-throop"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511977954, "post_id": 47558164, "comment_id": 82075349, "body": "@JimB I assumed that reading from a <code>io.Reader</code> would involve some sort of conversion or at least be more expensive than accessing a value from a <code>Context</code>. Is that incorrect?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511978248, "post_id": 47558164, "comment_id": 82075524, "body": "Yes, reading from the body will copy the bytes into the destination slice (there&#39;s no conversion). If you need a copy though, then you&#39;re going to do that anyways. If you don&#39;t need a copy, I would still stash it in the Body to remain compatible with any other code that isn&#39;t aware of the body in the context, and extract it from the Body interface rather than the context."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1511978863, "post_id": 47558164, "comment_id": 82075903, "body": "Read once. Put into a variable and use every time yoga need"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1511976033, "creation_date": 1511976033, "answer_id": 47558301, "question_id": 47558164, "link": "https://stackoverflow.com/questions/47558164/what-is-the-proper-way-to-allow-multiple-reads-of-http-request-body/47558301#47558301", "title": "What is the proper way to allow multiple reads of http.Request.Body", "body": "<p>Is it \"cheaper\"? Probably, depending on what resource(s) you're looking at, but you should benchmark and compare your specific application to know for sure. Are there pitfalls? Everything has pitfalls, this doesn't seem particularly \"risky\" to me, though. Context values are kind of a lousy solution to any problem due to loss of compile-time type checking and the general increase in complexity and loss of readability. You'll have to decide what trade-offs to make in your particular situation.</p>\n\n<p>If you don't need the hash to be completed before the handler starts, you could also wrap the body reader in another reader (e.g. <code>io.TeeReader</code>), so that when you unmarshall the JSON, the wrapper can watch the bytes that are read and compute the signature hash. Is that \"cheaper\"? You'd have to benchmark &amp; compare to know. Is it better? Depends entirely on your situation. It is an option worth considering.</p>\n"}], "owner": {"reputation": 1239, "user_id": 2806963, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j1xpG.png?s=128&g=1", "display_name": "Shawn Throop", "link": "https://stackoverflow.com/users/2806963/shawn-throop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511976033, "creation_date": 1511975524, "question_id": 47558164, "link": "https://stackoverflow.com/questions/47558164/what-is-the-proper-way-to-allow-multiple-reads-of-http-request-body", "title": "What is the proper way to allow multiple reads of http.Request.Body", "body": "<p>I want to access a <code>http.Request</code>'s <code>Body</code> multiple times. The first time happens in my authentication middleware, it uses it to recreate a sha256 signature. The second time happens later, I parse it into JSON for use in my database.</p>\n\n<p>I realize that you can't read from an <code>io.Reader</code> (or an <code>io.ReadCloser</code> in this case) more than once. I found an <a href=\"https://stackoverflow.com/a/43021236/2806963\">answer to another question</a> with a solution:</p>\n\n<blockquote>\n  <p>When you first read the body, you have to store it so once you're done with it, you can set a new <code>io.ReadCloser</code> as the request body constructed from the original data. So when you advance in the chain, the next handler can read the same body.</p>\n</blockquote>\n\n<p>Then in the example they set <code>http.Request.Body</code> to a new <code>io.ReadCloser</code>:</p>\n\n<pre><code>// And now set a new body, which will simulate the same data we read:\nr.Body = ioutil.NopCloser(bytes.NewBuffer(body))\n</code></pre>\n\n<p>Reading from <code>Body</code> and then setting a new <code>io.ReadCloser</code> at each step in my middleware seems expensive. Is this accurate?</p>\n\n<p>In an effort to make this less tedious and expensive I use <a href=\"https://joeshaw.org/revisiting-context-and-http-handler-for-go-17/\" rel=\"nofollow noreferrer\">a solution described here</a> to stash the parsed byte array in the <code>Context()</code> value of the request. Whenever I want it, its waiting for me already as byte array:</p>\n\n<pre><code>type bodyKey int\nconst bodyAsBytesKey bodyKey = 0\n\nfunc newContextWithParsedBody(ctx context.Context, req *http.Request) context.Context {\n    if req.Body == nil || req.ContentLength &lt;= 0 {\n        return ctx\n    }\n\n    if _, ok := ctx.Value(bodyAsBytesKey).([]byte); ok {\n        return ctx\n    }\n\n    body, err := ioutil.ReadAll(req.Body)\n    if err != nil {\n        return ctx\n    }\n\n    return context.WithValue(ctx, bodyAsBytesKey, body)\n}\n\nfunc parsedBodyFromContext(ctx context.Context) []byte {\n    if body, ok := ctx.Value(bodyAsBytesKey).([]byte); ok {\n        return body\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>I feel like keeping a single byte array around is cheaper than reading a new one each time. Is this accurate? Are there pitfalls to this solution that I can't see?</p>\n"}, {"tags": ["go", "gonum"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511974149, "post_id": 47557768, "comment_id": 82073087, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> showing what you&#39;ve tried and explaining specifically what was wrong with the result."}, {"owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511977560, "post_id": 47557768, "comment_id": 82075097, "body": "@Adrian, I&#39;m asking if library has specific feature. It is not documented but probably there is a way to do it. I have no problem with my code. So I guess your suggestion is inappropriate here."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511987982, "post_id": 47557768, "comment_id": 82080517, "body": "@IgorMikushkin: I would try the gonum mailing before SO"}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9148664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16009bcd1af2e1c225e3c73a13598908?s=128&d=identicon&r=PG&f=1", "display_name": "pplcc", "link": "https://stackoverflow.com/users/9148664/pplcc"}, "is_accepted": true, "score": 1, "last_activity_date": 1514466191, "creation_date": 1514466191, "answer_id": 48008011, "question_id": 47557768, "link": "https://stackoverflow.com/questions/47557768/multiple-plots-in-single-image-in-gonum-plot/48008011#48008011", "title": "Multiple plots in single image in gonum/plot", "body": "<p>You can do this using <a href=\"https://godoc.org/gonum.org/v1/plot#Align\" rel=\"nofollow noreferrer\">plot.Align</a>.</p>\n\n<p>Also have a look at the example code I posted to your issue <a href=\"https://stackoverflow.com/questions/47557438/multiple-line-plots-sharing-abscissas-axis-in-gonum-plot\">Multiple line plots sharing abscissas axis in gonum/plot</a>. The code is applicable to this issue as well.</p>\n"}], "owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 48008011, "answer_count": 1, "score": -2, "last_activity_date": 1514466191, "creation_date": 1511974018, "last_edit_date": 1511988883, "question_id": 47557768, "link": "https://stackoverflow.com/questions/47557768/multiple-plots-in-single-image-in-gonum-plot", "title": "Multiple plots in single image in gonum/plot", "body": "<p>Is it possible to combine multiple plots in single image in gonum/plot?\nThey should have their own axes. Is it possible to stack them vertically, horizontally or probably in a grid?</p>\n\n<p>In matplotlib it would look like this.\n<a href=\"https://i.stack.imgur.com/2WGLG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2WGLG.png\" alt=\"Subplots\"></a></p>\n"}, {"tags": ["go", "gonum"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1511974163, "post_id": 47557438, "comment_id": 82073090, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> showing what you&#39;ve tried and explaining specifically what was wrong with the result."}, {"owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511977491, "post_id": 47557438, "comment_id": 82075050, "body": "@Adrian, I&#39;m asking if library has specific feature. It is not documented but probably there is a way to do it. I have no problem with my code. So I guess your suggestion is inappropriate here."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 9148664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16009bcd1af2e1c225e3c73a13598908?s=128&d=identicon&r=PG&f=1", "display_name": "pplcc", "link": "https://stackoverflow.com/users/9148664/pplcc"}, "is_accepted": true, "score": 2, "last_activity_date": 1514537685, "last_edit_date": 1514537685, "creation_date": 1514465693, "answer_id": 48007906, "question_id": 47557438, "link": "https://stackoverflow.com/questions/47557438/multiple-line-plots-sharing-abscissas-axis-in-gonum-plot/48007906#48007906", "title": "Multiple line plots sharing abscissas axis in gonum/plot", "body": "<p>Yes, it is possible. You can use <code>plot.Align</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"math/rand\"\n    \"os\"\n\n    \"gonum.org/v1/plot\"\n    \"gonum.org/v1/plot/plotter\"\n    \"gonum.org/v1/plot/vg\"\n    \"gonum.org/v1/plot/vg/draw\"\n    \"gonum.org/v1/plot/vg/vgimg\"\n)\n\nfunc main() {\n    rand.Seed(int64(0))\n\n    const rows, cols = 2, 1\n    plots := make([][]*plot.Plot, rows)\n    for j := 0; j &lt; rows; j++ {\n        plots[j] = make([]*plot.Plot, cols)\n        for i := 0; i &lt; cols; i++ {\n\n            p := randomLinePlot(rand.Intn(10))\n\n            // make sure the horizontal scales match\n            p.X.Min = 0\n            p.X.Max = 5\n\n            plots[j][i] = p\n        }\n    }\n\n    img := vgimg.New(vg.Points(150), vg.Points(175))\n    dc := draw.New(img)\n\n    t := draw.Tiles{\n        Rows: rows,\n        Cols: cols,\n    }\n\n    canvases := plot.Align(plots, t, dc)\n    for j := 0; j &lt; rows; j++ {\n        for i := 0; i &lt; cols; i++ {\n            if plots[j][i] != nil {\n                plots[j][i].Draw(canvases[j][i])\n            }\n        }\n    }\n\n    w, err := os.Create(\"aligned.png\")\n    if err != nil {\n        panic(err)\n    }\n\n    png := vgimg.PngCanvas{Canvas: img}\n    if _, err := png.WriteTo(w); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>This generates the following plots in a single PNG file:</p>\n\n<p><img src=\"https://i.stack.imgur.com/287mJ.png\" alt=\"Two aligned plots in a single file\"></p>\n\n<p>You can find another example below the GoDoc entry of <a href=\"https://godoc.org/gonum.org/v1/plot#Align\" rel=\"nofollow noreferrer\" title=\"GoDoc plot.Align\">plot.Align</a></p>\n"}], "owner": {"reputation": 884, "user_id": 380247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ba8cab2eb1a3727d54aaf5f3f40d144?s=128&d=identicon&r=PG", "display_name": "Igor Mikushkin", "link": "https://stackoverflow.com/users/380247/igor-mikushkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 0, "accepted_answer_id": 48007906, "answer_count": 1, "score": -2, "last_activity_date": 1514537685, "creation_date": 1511972904, "last_edit_date": 1511975075, "question_id": 47557438, "link": "https://stackoverflow.com/questions/47557438/multiple-line-plots-sharing-abscissas-axis-in-gonum-plot", "title": "Multiple line plots sharing abscissas axis in gonum/plot", "body": "<p>Is it possible to make multiple line plots with common abscissas axis in gonum/plot?</p>\n\n<p>In matplotlib it would look like this.\n<a href=\"https://i.stack.imgur.com/YbHdg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YbHdg.png\" alt=\"Sharing X axis\"></a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 6171578, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/9e035177e9539ce163b0197a777b34f7?s=128&d=identicon&r=PG&f=1", "display_name": "botscripter", "link": "https://stackoverflow.com/users/6171578/botscripter"}, "edited": false, "score": 0, "creation_date": 1511972803, "post_id": 47557353, "comment_id": 82072256, "body": "Thanks for your time and explanation. I understand it now. Your tip was the solution."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1511972659, "creation_date": 1511972659, "answer_id": 47557353, "question_id": 47557304, "link": "https://stackoverflow.com/questions/47557304/how-to-obtain-all-request-headers-in-go/47557353#47557353", "title": "How to obtain all request headers in Go", "body": "<p>As you can see from <a href=\"https://golang.org/pkg/net/http/#Header\" rel=\"nofollow noreferrer\">the documentation</a>, <code>Header</code> is just a <code>map[string][]string</code> with some extra helper methods, so you can still use it like any <code>map</code> to access its keys:</p>\n\n<pre><code>for key,val := range req.Header {\n    // Logic using key\n    // And val if you need it\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 21, "last_activity_date": 1511975577, "last_edit_date": 1511975577, "creation_date": 1511973033, "answer_id": 47557484, "question_id": 47557304, "link": "https://stackoverflow.com/questions/47557304/how-to-obtain-all-request-headers-in-go/47557484#47557484", "title": "How to obtain all request headers in Go", "body": "<p>Use <a href=\"https://godoc.org/net/http#Request.Header\" rel=\"noreferrer\">Request.Header</a> to access all headers. Because Header is a map[string][]string, two loops are required to access all headers.</p>\n\n<pre><code>// Loop over header names\nfor name, values := range r.Header {\n    // Loop over all values for the name.\n    for _, value := range values {\n        fmt.Println(name, value)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 217, "user_id": 5713047, "user_type": "registered", "profile_image": "https://graph.facebook.com/511702685666241/picture?type=large", "display_name": "Abhishek Srivastava", "link": "https://stackoverflow.com/users/5713047/abhishek-srivastava"}, "is_accepted": false, "score": 3, "last_activity_date": 1563779215, "creation_date": 1563779215, "answer_id": 57140729, "question_id": 47557304, "link": "https://stackoverflow.com/questions/47557304/how-to-obtain-all-request-headers-in-go/57140729#57140729", "title": "How to obtain all request headers in Go", "body": "<p>You can use above approaches if you want to loop one by one through all headers. If you want to print all headers in one line you can,</p>\n\n<pre><code>if reqHeadersBytes, err := json.Marshal(req.Header); err != nil {\n    log.Println(\"Could not Marshal Req Headers\")\n} else {\n    log.Println(string(reqHeadersBytes))\n}\n</code></pre>\n"}], "owner": {"reputation": 457, "user_id": 6171578, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/9e035177e9539ce163b0197a777b34f7?s=128&d=identicon&r=PG&f=1", "display_name": "botscripter", "link": "https://stackoverflow.com/users/6171578/botscripter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10567, "favorite_count": 3, "accepted_answer_id": 47557484, "answer_count": 3, "score": 9, "last_activity_date": 1563779215, "creation_date": 1511972493, "question_id": 47557304, "link": "https://stackoverflow.com/questions/47557304/how-to-obtain-all-request-headers-in-go", "title": "How to obtain all request headers in Go", "body": "<p>How can I obtain all available http headers from a request as array in Go? I see only the following two methods:</p>\n\n<ul>\n<li>Header(name string, value string) </li>\n<li>GetHeader(name string)</li>\n</ul>\n\n<p>But in this case I need to know the name of the Header and can't return all existing headers. I'd like to copy the http headers from one request to anther one.</p>\n"}, {"tags": ["go", "arduino", "cross-compiling", "mips32", "arduino-yun"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1511971807, "post_id": 47556071, "comment_id": 82071577, "body": "You can run <code>strace program</code> to find out what system call it makes and possibly blocks on."}, {"owner": {"reputation": 77, "user_id": 3094851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1d095a921b9970a38f64f800e91d76?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Naumann", "link": "https://stackoverflow.com/users/3094851/philipp-naumann"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1511974997, "post_id": 47556071, "comment_id": 82073616, "body": "I have added the strace output. In a previous version of the question I had indeed uploaded a binary built for the wrong platform."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1511978008, "post_id": 47556071, "comment_id": 82075386, "body": "What is the output of <code>uname -a</code>?"}, {"owner": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "edited": false, "score": 0, "creation_date": 1512020131, "post_id": 47556071, "comment_id": 82090735, "body": "Do you have floating-point emulation compiled in your linux? I have heard of similar behavior when the device is missing an FPU and does not support floating-point emulation."}, {"owner": {"reputation": 77, "user_id": 3094851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1d095a921b9970a38f64f800e91d76?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Naumann", "link": "https://stackoverflow.com/users/3094851/philipp-naumann"}, "reply_to_user": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "edited": false, "score": 0, "creation_date": 1512125004, "post_id": 47556071, "comment_id": 82140237, "body": "I&#39;ve added the output of uname -a.  @HeinOldewage How can I check that? I&#39;ve read that it&#39;s enabled by default since kernel 2.2.4, but this may be wrong."}], "answers": [{"tags": [], "owner": {"reputation": 2772, "user_id": 297793, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1O4s7.jpg?s=128&g=1", "display_name": "konrad", "link": "https://stackoverflow.com/users/297793/konrad"}, "is_accepted": false, "score": 0, "last_activity_date": 1526063093, "creation_date": 1526063093, "answer_id": 50298176, "question_id": 47556071, "link": "https://stackoverflow.com/questions/47556071/execute-go-program-on-arduino-y%c3%ban/50298176#50298176", "title": "Execute Go program on Arduino Y&#250;n", "body": "<p>You might want to try again with Go 1.10, which added 32-bit MIPS software floating point emulation. </p>\n\n<p>You can enable this with <code>GOMIPS=softfloat</code>, see\n<a href=\"https://golang.org/doc/go1.10#ports\" rel=\"nofollow noreferrer\">https://golang.org/doc/go1.10#ports</a></p>\n"}], "owner": {"reputation": 77, "user_id": 3094851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a1d095a921b9970a38f64f800e91d76?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Naumann", "link": "https://stackoverflow.com/users/3094851/philipp-naumann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 340, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1526063093, "creation_date": 1511968582, "last_edit_date": 1512124972, "question_id": 47556071, "link": "https://stackoverflow.com/questions/47556071/execute-go-program-on-arduino-y%c3%ban", "title": "Execute Go program on Arduino Y&#250;n", "body": "<p>I would like to run a Go program on the Arduino Y\u00fan platform. It features an embedded Linux running on a 32 bit MIPS processor (Atheros AR9331).</p>\n\n<p>Contents of test.go:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello!\")\n}\n</code></pre>\n\n<p>I use the following command on Linux (4.13.12-1-ARCH #1 SMP PREEMPT Wed Nov 8 11:54:06 CET 2017 x86_64 GNU/Linux), Go (go1.9.2 linux/amd64) to compile the binary:</p>\n\n<pre><code>GOOS=linux GOARCH=mips go build test.go\n</code></pre>\n\n<p>I copy the binary to the device (via SSH) and execute it there. It doesn't crash. It doesn't print \"Hello!\". It just seems to wait for stdin. How can I debug/fix this?</p>\n\n<p>Contents of /proc/cpuinfo on the device:</p>\n\n<pre><code>system type     : Atheros AR9330 rev 1\nmachine         : Arduino Yun\nprocessor       : 0\ncpu model       : MIPS 24Kc V7.4\nBogoMIPS        : 265.42\nwait instruction    : yes\nmicrosecond timers  : yes\ntlb_entries     : 16\nextra interrupt vector  : yes\nhardware watchpoint : yes, count: 4, address/irw mask: [0x0000, 0x0920, 0x04b8, 0x0180]\nASEs implemented    : mips16\nshadow register sets    : 1\nkscratch registers  : 0\ncore            : 0\nVCED exceptions     : not available\nVCEI exceptions     : not available\n</code></pre>\n\n<p>Output of strace ./test on the device:</p>\n\n<pre><code>execve(\"./test\", [\"./test\"], [/* 11 vars */]) = 0\n</code></pre>\n\n<p>Output of uname -r on the device:</p>\n\n<pre><code>Linux B4218AF03376 3.3.8 #1 Sun Oct 4 02:29:26 CEST 2015 mips GNU/Linux\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 37983, "user_id": 1843331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVX5R.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/1843331/tim"}, "edited": false, "score": 0, "creation_date": 1527067837, "post_id": 50484572, "comment_id": 87982430, "body": "why would it not?"}, {"owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "reply_to_user": {"reputation": 37983, "user_id": 1843331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVX5R.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/1843331/tim"}, "edited": false, "score": 0, "creation_date": 1527068293, "post_id": 50484572, "comment_id": 87982735, "body": "@TimCastelijns Because i cant find it in the docs and if i check &quot;serving-static-files&quot; it gives an example how to handle it via code. Also when i changed to the &quot;standard version&quot; it worked like a charm."}], "tags": [], "owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "is_accepted": false, "score": 0, "last_activity_date": 1527068367, "last_edit_date": 1527068367, "creation_date": 1527067380, "answer_id": 50484572, "question_id": 47554909, "link": "https://stackoverflow.com/questions/47554909/google-appengine-go-webapp/50484572#50484572", "title": "Google AppEngine Go WebApp", "body": "<p>The flex version does not support handlers, as far as i understand.</p>\n"}], "owner": {"reputation": 377, "user_id": 2214818, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/904dfd8f939241f50c468d2f27b25bd0?s=128&d=identicon&r=PG", "display_name": "Tiega", "link": "https://stackoverflow.com/users/2214818/tiega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1527068367, "creation_date": 1511965055, "question_id": 47554909, "link": "https://stackoverflow.com/questions/47554909/google-appengine-go-webapp", "title": "Google AppEngine Go WebApp", "body": "<p>I have a ReactJS based Website with GO has Webserver/Backend with a REST API approach. At least this is how it would run on a normal dedicated server.</p>\n\n<p>I'm trying to move the project to the Google Cloud but I have some issues. </p>\n\n<p>I kicked out all the static file serving from my GO application because the Google Guide told me that the App Engine can handle the Static File serving. But its not serving any... my app.yaml looks as follow:</p>\n\n<blockquote>\n<pre><code>runtime: go\nenv: flex\napi_version: go1.8\n\nmanual_scaling:\n  instances: 1\nresources:\n  cpu: 1\n  memory_gb: 0.5\n  disk_size_gb: 10\nenv_variables:ur\n  CLOUDSQL_CONNECTION_NAME: xxx\n  CLOUDSQL_USER: xxx\n  CLOUDSQL_PASSWORD: 'XXX'\n  GCLOUD_STORAGE_BUCKET: xxx\n  REDIS_ADDR: \"&lt;REDIS_HOST&gt;:&lt;REDIS_PORT&gt;\"\n  REDIS_PASSSWORD: \"\"\nhandlers:\n- url: /\n  mime_type: text/html\n  static_files: static/index.html\n  upload: static/index.html\n  application_readable: true\n\n- url: /public/css\n  mime_type: text/css\n  static_dir: static/public/css\n  application_readable: true\n\n- url: /public/js\n  mime_type: text/javascript\n  static_dir: static/public/js\n  application_readable: true\n\n- url: /.*\n  script: _go_app\n</code></pre>\n</blockquote>\n\n<p>The \"static\" folder is also in the project folder from where i start the deploy. How can i check if the files are even uploaded?</p>\n\n<p>I always get a response from the GO Server</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1511963925, "post_id": 47554489, "comment_id": 82065783, "body": "You should show us how you try to generate the JSON document you posted. Aim for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511964047, "post_id": 47554489, "comment_id": 82065864, "body": "just use golang&#39;s encoding/json.Marshal function"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1511964071, "post_id": 47554489, "comment_id": 82065889, "body": "That I guessed. Please post your code (a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": true, "score": 0, "last_activity_date": 1511964266, "creation_date": 1511964266, "answer_id": 47554653, "question_id": 47554489, "link": "https://stackoverflow.com/questions/47554489/go-json-naming-strategy-about-extends/47554653#47554653", "title": "Go JSON Naming strategy about extends", "body": "<p>Please, add your convert code here. The code below works fine.</p>\n\n<pre><code>type BaseModel struct {\n    Id          string    `json:\"id\"`\n    CreatedTime time.Time `json:\"createdTime\"`\n    UpdatedTime time.Time `json:\"updatedTime\"`\n    Deleted     bool      `json:\"deleted\"`\n}\n\ntype Category struct {\n    BaseModel\n    Parent    string `json:\"parent\"`\n    Name      string `json:\"name\"`\n    IconClass string `json:\"iconClass\"`\n    Mark      string `json:\"mark\"`\n}\n\nfunc main() {\n    data, err := json.Marshal(Category{})\n    if err != nil {\n        return\n    }\n\n    fmt.Println(string(data[:]))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"id\":\"\",\"createdTime\":\"0001-01-01T00:00:00Z\",\"updatedTime\":\"0001-01-01T00:00:00Z\",\"deleted\":false,\"parent\":\"\",\"name\":\"\",\"iconClass\":\"\",\"mark\":\"\"}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 47554653, "answer_count": 1, "score": -6, "last_activity_date": 1511964342, "creation_date": 1511963733, "last_edit_date": 1511964342, "question_id": 47554489, "link": "https://stackoverflow.com/questions/47554489/go-json-naming-strategy-about-extends", "title": "Go JSON Naming strategy about extends", "body": "<p>My Go struct is like this:</p>\n\n<pre><code>type BaseModel struct {\n    Id          string    `json:\"id\"`\n    CreatedTime time.Time `json:\"createdTime\"`\n    UpdatedTime time.Time `json:\"updatedTime\"`\n    Deleted     bool      `json:\"deleted\"`\n}\n\ntype Category struct {\n    BaseModel        \n    Parent    string `json:\"parent\"`\n    Name      string `json:\"name\"`\n    IconClass string `json:\"iconClass\"`\n    Mark      string `json:\"mark\"`\n}\n</code></pre>\n\n<p>I want convert <code>Category</code> to JSON like this:</p>\n\n<pre><code>{\n  \"id\":\"\",\n  \"deleted\":\"\",\n  ...\n  \"parent\":\"\",\n  \"name\":\"\"\n}\n</code></pre>\n\n<p>But when I use Go's json to convert it, it gives me this:</p>\n\n<pre><code>{\n  \"Id\":\"\",\n  \"Deleted\":\"\",\n  ...\n  \"parent\":\"\",\n  \"name\":\"\",\n  ...\n}\n</code></pre>\n\n<p>What should I do now?</p>\n\n<p>I use under code to convert:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>// define\r\nvar menus []models.Category\r\n// query from db\r\nq.Filter(\"deleted__exact\", false).All(&amp;menus)\r\n// serialize it\r\nres, _ := json.Marshal(&amp;menus)\r\ns := string(res[:])\r\nbeego.Debug(s)</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["go", "gregorian-calendar", "hijri"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1511960352, "post_id": 47553025, "comment_id": 82063433, "body": "Please share code you&#39;re trying to run."}, {"owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "reply_to_user": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1511960802, "post_id": 47553025, "comment_id": 82063675, "body": "Please check the edited answer!"}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "edited": false, "score": 0, "creation_date": 1512025172, "post_id": 47553558, "comment_id": 82092623, "body": "Exactly what I did! Although used <a href=\"http://xsoh.ws/hijritools/\" rel=\"nofollow noreferrer\">xsoh.ws/hijritools</a> for inspiration. Check my answer!"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 1, "last_activity_date": 1511960630, "creation_date": 1511960630, "answer_id": 47553558, "question_id": 47553025, "link": "https://stackoverflow.com/questions/47553025/hijiri-date-to-gregorian-date-in-golang/47553558#47553558", "title": "Hijiri date to Gregorian date in golang", "body": "<p>Go has converter of date formats, not date types. I think you have to implement a go package, you can find a code for JS here <a href=\"https://github.com/arabiaweather/hijri-date/blob/master/hijri-date.js\" rel=\"nofollow noreferrer\">https://github.com/arabiaweather/hijri-date/blob/master/hijri-date.js</a></p>\n"}, {"tags": [], "owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1512025124, "creation_date": 1512025124, "answer_id": 47567600, "question_id": 47553025, "link": "https://stackoverflow.com/questions/47553025/hijiri-date-to-gregorian-date-in-golang/47567600#47567600", "title": "Hijiri date to Gregorian date in golang", "body": "<p>I created a small helper library <a href=\"https://github.com/younisshah/hijri\" rel=\"nofollow noreferrer\" title=\"hijri\">hijri</a> to solve my problem. Thanks for all the help!</p>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 0, "last_activity_date": 1512048520, "creation_date": 1512048520, "answer_id": 47574633, "question_id": 47553025, "link": "https://stackoverflow.com/questions/47553025/hijiri-date-to-gregorian-date-in-golang/47574633#47574633", "title": "Hijiri date to Gregorian date in golang", "body": "<p>If you mean Hijri Shamsi (Solar Calendar) you can use <a href=\"https://github.com/dc0d/persical\" rel=\"nofollow noreferrer\">persical</a>.</p>\n"}], "owner": {"reputation": 543, "user_id": 1929013, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11f5a7ee410a95d7fca8faf6dd7398f4?s=128&d=identicon&r=PG", "display_name": "cannot_mutably_borrow", "link": "https://stackoverflow.com/users/1929013/cannot-mutably-borrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 47567600, "answer_count": 3, "score": 1, "last_activity_date": 1512048520, "creation_date": 1511958888, "last_edit_date": 1511960781, "question_id": 47553025, "link": "https://stackoverflow.com/questions/47553025/hijiri-date-to-gregorian-date-in-golang", "title": "Hijiri date to Gregorian date in golang", "body": "<p>I'm trying to convert a Hijri Date to Gregorian date according to Umm AlQura calendar. I couldn't find much on the Internet (maybe attributing to my lazy attitude). I tried converting the Hijri date to Julian number and then from Julian number to Gregorian date. </p>\n\n<p>However, I just could convert Hijri date to Julian number. I cannot figure out how to convert from Julian number to Gregorian.</p>\n\n<p>Or maybe I'm taking the wrong approach. Can anyone please help to convert a Hijri date according to Umm AlQura calendar to a Gregorian date in golang?</p>\n\n<p>This is what I've so far:</p>\n\n<pre><code>func getJulianNumber(y, m, d int) float64 {\n    if m == 1 || m == 2 {\n        y -= 1\n        m += 12\n    }\n    a := y / 100\n    b := a / 4\n    c := 2 - a + b\n    e := int(365.25 * (float64(y) + 4716))\n    f := int(30.6001 * (float64(m) + 1))\n    return float64(float64(c) + float64(d) + float64(e) + float64(f) - 1524.5)\n}\n\nfunc julianToH(jd float64) {\n    q := jd + 0.5\n    z := int(q)\n    w := int((float64(z) - 1867216.25) / 36524.25)\n    x := w / 4\n    a := int(float64(z) + 1 + float64(w) - float64(x))\n    b := a + 1524\n    c := int((float64(b) - 122.1) / 365.25)\n    d := int(365.25 * float64(c))\n    e := int((float64(b) - float64(d)) / 30.6001)\n    f := int(30.6001 * float64(e))\n\n    day := int(float64(b) - float64(d) - float64(f) + (q - float64(z)))\n    var month, year int\n    e1 := e - 1\n    if e1 &lt;= 12 {\n        month = e1\n    } else {\n        month = e - 3\n    }\n    if month == 1 || month == 2 {\n        year = int(c - 4715)\n    } else {\n        year = int(c - 4716)\n    }\n    fmt.Println(day, month, year)\n}\n</code></pre>\n\n<p>Much obliged!</p>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511962551, "post_id": 47552572, "comment_id": 82064821, "body": "If you don&#39;t want something in a vendor folder, then don&#39;t put it there. You need to show where the vendor folder is, what is in it, and what tool you&#39;re using to manage it."}, {"owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511963936, "post_id": 47552572, "comment_id": 82065791, "body": "Edited my question to add more context!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511965383, "post_id": 47552572, "comment_id": 82066779, "body": "If <code>vendor&#47;</code> is in <code>go-project</code>, then <code>dep</code> should not be adding <code>go-project</code> packages to the vendor folder. We need to see how to reproduce the issue. You can also make sure you&#39;re using the latest version of <code>dep</code>, and fixing the vendor folder yourself, or remove it and start over."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1511966793, "post_id": 47552572, "comment_id": 82067770, "body": "Could you show step by step with env bars how you have installed <code>dep</code>, started the project and added dependencies to it"}], "answers": [{"comments": [{"owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "edited": false, "score": 0, "creation_date": 1511973937, "post_id": 47556730, "comment_id": 82072935, "body": "I have 3 directories at my root folder, (cmd, pkg, vendor) but I dont&#39;t have any go file."}, {"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "reply_to_user": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "edited": false, "score": 0, "creation_date": 1511974362, "post_id": 47556730, "comment_id": 82073218, "body": "Your project structure should be: go-project/src/github.com/userX/go-project/cmd   go-project/src/github.com/userX/go-project/pkg go-project/src/github.com/userX/go-project/vendor"}, {"owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "edited": false, "score": 0, "creation_date": 1511975068, "post_id": 47556730, "comment_id": 82073662, "body": "Yup, it was my problem you are right! I have cloned my project to the wrong folder <code>src&#47;go-project</code> and not <code>src&#47;github.com&#47;userX&#47;go-project</code> :(  shame on me!"}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 3, "last_activity_date": 1511970610, "creation_date": 1511970610, "answer_id": 47556730, "question_id": 47552572, "link": "https://stackoverflow.com/questions/47552572/go-package-dependencies-with-go-dep/47556730#47556730", "title": "Go package dependencies with go dep", "body": "<p>Looks like you should take a look at <a href=\"https://golang.org/doc/code.html#Organization\" rel=\"nofollow noreferrer\">project structure</a>, because for me it looks like only directory you have is a <code>vendor</code> directory. And also take a look at <a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow noreferrer\">vendor directories</a></p>\n"}], "owner": {"reputation": 1944, "user_id": 4120554, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh5.googleusercontent.com/-RKmmNTC8iUo/AAAAAAAAAAI/AAAAAAAAAGs/oQQp9tU-Zb4/photo.jpg?sz=128", "display_name": "Marco Talento", "link": "https://stackoverflow.com/users/4120554/marco-talento"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1216, "favorite_count": 0, "accepted_answer_id": 47556730, "answer_count": 1, "score": 2, "last_activity_date": 1511971973, "creation_date": 1511957478, "last_edit_date": 1511971973, "question_id": 47552572, "link": "https://stackoverflow.com/questions/47552572/go-package-dependencies-with-go-dep", "title": "Go package dependencies with go dep", "body": "<p>I have the following project structure in the same github repository:</p>\n\n<pre><code>https://github.com/userX/go-project/cmd/server/main.go\nhttps://github.com/userX/go-project/pkg/package1\nhttps://github.com/userX/go-project/pkg/package2\nhttps://github.com/userX/go-project/pkg/package2\nhttps://github.com/userX/go-project/Gopkg.toml\n</code></pre>\n\n<p>And for some reason my project is in folder vendor as a dependency. And ofc I don't want that because if I change <code>package1</code> I need to push it first to have the latest changes inside <code>package2</code>. Because it's using files inside vendor folder.</p>\n\n<p>I am importing with full path: <code>import \"github.com/userX/go-project/pkg/package1\"</code></p>\n\n<p>What I am doing wrong? </p>\n\n<p>ENV VARS: <code>GOPATH=\"/Users/username/go\"</code></p>\n\n<p><code>vendor</code> folder is in the root folder of the project and I am using <code>dep</code> (<a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">https://github.com/golang/dep</a>) to manage my dependencies!</p>\n\n<p>Inside my vendor folder I can find my third party libraries and also my own project.</p>\n\n<pre><code>\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Gopkg.lock\n\u251c\u2500\u2500 Gopkg.toml\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 README.md\n\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 server\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 cli\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 package1\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 file.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 package2\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 file.go\n\u2514\u2500\u2500 vendor\n    \u2514\u2500\u2500 github.com\n        \u251c\u2500\u2500 julienschmidt\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 httprouter\n        \u2502\u00a0\u00a0     \u251c\u2500\u2500 LICENSE\n        \u2514\u2500\u2500 userX\n            \u2514\u2500\u2500 go-project\n                \u251c\u2500\u2500 Dockerfile\n                \u251c\u2500\u2500 Gopkg.lock\n                \u251c\u2500\u2500 Gopkg.toml\n                \u251c\u2500\u2500 LICENSE\n                \u251c\u2500\u2500 Makefile\n                \u251c\u2500\u2500 README.md\n                \u251c\u2500\u2500 cmd\n                \u2502\u00a0\u00a0 \u251c\u2500\u2500 server\n                \u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n                \u2502\u00a0\u00a0 \u2514\u2500\u2500 cli\n                \u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n                \u251c\u2500\u2500 docker-compose.yml\n                \u2514\u2500\u2500 pkg\n                    \u251c\u2500\u2500 package1\n                    \u2502\u00a0\u00a0 \u251c\u2500\u2500 file.go\n                    \u251c\u2500\u2500 pacakge2\n                        \u2514\u2500\u2500 file.go\n</code></pre>\n\n<p>EDIT: Updated my file structure after <code>dep ensure --update</code></p>\n\n<p>Basically my steps:\n 1. go get -u github.com/golang/dep/cmd/dep\n 2. dep init\n 3. dep ensure --update</p>\n\n<p>Gopkg.lock contains info about my own project:</p>\n\n<pre><code>[[projects]]\n  branch = \"master\"\n  name = \"github.com/userX/go-project\"\n  packages = [\"pkg/package1\",\"pkg/package2\"]\n  revision = \"560d3aaasdas53562c3eb083252e54ef8ee468bea74ba\"\n</code></pre>\n"}, {"tags": ["go", "telegram", "telegram-bot"], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 1, "last_activity_date": 1511964603, "creation_date": 1511964603, "answer_id": 47554762, "question_id": 47551540, "link": "https://stackoverflow.com/questions/47551540/golang-telegram-bot-api-how-to-ask-for-location/47554762#47554762", "title": "GoLang Telegram-bot-api how to ask for location?", "body": "<p>Unfortunately there is no examples for this in their repository. I read a bit of their code to figure out how to do it.</p>\n\n<p>This is a sample bot that requests location for every message it got. I created a one button virtual keyboard that shares location when clicked.</p>\n\n<pre><code>package main\n\nimport (\n    \"gopkg.in/telegram-bot-api.v4\"\n    \"log\"\n)\n\nconst botToken = \"Put your bot token here!\"\n\nfunc main() {\n    bot, err := tgbotapi.NewBotAPI(botToken)\n    if err != nil {\n        log.Panic(err)\n    }\n\n    bot.Debug = true\n    log.Printf(\"Authorized on account %s\", bot.Self.UserName)\n\n    u := tgbotapi.NewUpdate(0)\n    u.Timeout = 60\n    updates, err := bot.GetUpdatesChan(u)\n\n    for update := range updates {\n        if update.Message == nil {\n            continue\n        }\n\n        log.Printf(\"[%s] %s\", update.Message.From.UserName, update.Message.Text)\n\n        msg := tgbotapi.NewMessage(update.Message.Chat.ID, \"Hi\")\n        //msg.ReplyToMessageID = update.Message.MessageID\n        btn := tgbotapi.KeyboardButton{\n            RequestLocation: true,\n            Text: \"Gimme where u live!!\",\n        }\n        msg.ReplyMarkup = tgbotapi.NewReplyKeyboard([]tgbotapi.KeyboardButton{btn})\n        bot.Send(msg)\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8664286"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "accepted_answer_id": 47554762, "answer_count": 1, "score": 1, "last_activity_date": 1526757570, "creation_date": 1511954259, "last_edit_date": 1511968766, "question_id": 47551540, "link": "https://stackoverflow.com/questions/47551540/golang-telegram-bot-api-how-to-ask-for-location", "title": "GoLang Telegram-bot-api how to ask for location?", "body": "<p>I am using <a href=\"https://github.com/go-telegram-bot-api/telegram-bot-api\" rel=\"nofollow noreferrer\">github.com/go-telegram-bot-api</a> to create my bot. I want to ask location of the client. How do I do it? So far I did this:</p>\n\n<pre><code>updates, err := bot.GetUpdatesChan(u)\n\nfor update := range updates {\n    if update.Message == nil {\n        continue\n    }\n\n    switch update.Message.Text {\n    case \"/shop\":   \n        msg := tgbotapi.NewMessage(update.Message.Chat.ID,\"Send me your location\")\n        //I need to make this message ask for the location\n        msg.Text = tgbotapi.ChatFindLocation\n        bot.Send(msg)\n        continue\n    }\n}\n</code></pre>\n"}, {"tags": ["image", "go", "jpeg", "python-imaging-library"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511964924, "post_id": 47550838, "comment_id": 82066472, "body": "I don&#39;t know much about color models, but I&#39;d start looking here: <a href=\"https://golang.org/src/image/jpeg/reader.go#L757\" rel=\"nofollow noreferrer\">golang.org/src/image/jpeg/reader.go#L757</a> - based on a quick once-over it does appear to be doing a lot of integer division, so there could be some rounding differences coming through vs. the way the IM/Python do it. That&#39;s pure guess, though."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1511972629, "post_id": 47550838, "comment_id": 82072132, "body": "@Adrian Well, there&#39;s a difference between the arithmetic required to parse out the pixels and the arithmetic required to convert the colors from their base representation to RGB. In this case, the image is first represented using one type of color encoding prescribed by the JPEG standard/process (YCbCr, which would have to be in the JPEG-specific logic that you shared) but my issue is with <i>how</i> it is being converted from that to RGB by Go, here: <a href=\"https://golang.org/src/image/color/ycbcr.go\" rel=\"nofollow noreferrer\">golang.org/src/image/color/ycbcr.go</a> (#58, though it&#39;s also dup&#39;d later in the same file)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511973059, "post_id": 47550838, "comment_id": 82072427, "body": "It appears from the source that it converts to RGB at decode time, but that may not be the case. Regardless, the ycbcr conversion you linked has the same concern w/r/t integer arithmetic and rounding/truncation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511989917, "post_id": 47550838, "comment_id": 82081519, "body": "There is no exact transformation between YCbCr and RGB, so it&#39;s always going to be implementation dependent. Some implementations using floating point values start with differing precision, and others vary by the bit size of the values used for the calculations (which effects the final rounding). I wouldn&#39;t even be surprised if ImageMagick (or GraphicsMagick) returned slightly different results depending on the quantum they were compiled with."}], "answers": [{"tags": [], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "is_accepted": true, "score": 0, "last_activity_date": 1512429121, "creation_date": 1512429121, "answer_id": 47643514, "question_id": 47550838, "link": "https://stackoverflow.com/questions/47550838/unexpected-inaccurate-image-color-conversions-in-go/47643514#47643514", "title": "Unexpected/inaccurate image color conversions in Go", "body": "<p>See the comment by @JimB, above. Apparently the specification does not cover this particular conversion. So, it may, in fact, be different from one implementation to the next.</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 1, "accepted_answer_id": 47643514, "answer_count": 1, "score": 3, "last_activity_date": 1512429121, "creation_date": 1511952204, "last_edit_date": 1511975273, "question_id": 47550838, "link": "https://stackoverflow.com/questions/47550838/unexpected-inaccurate-image-color-conversions-in-go", "title": "Unexpected/inaccurate image color conversions in Go", "body": "<p>It seems as if Go's conversion arithmetic from JPEG's YCbCr to RGBA is slightly off, based on Python's PIL and ImageMagick's color values, but I'm probably just overlooking something.</p>\n\n<p>PIL's and IM's results are identical. For Go, I load the image, convert to a non-alpha-premultiplied model, and then access the fields directly instead of using the RGBA getter (which <em>will</em> multiply the alpha against the color components). Unfortunately, many of the individual component values are equal but most of the colors have at least one component that is +-1 off of the component in that same position in PIL/IM's results.</p>\n\n<p><strong>Can anyone lend some wisdom/interpretation to this?</strong></p>\n\n<p>With ImageMagick (\"convert image.jpg image.txt\"; the left and right RGBs match, here, FYI):</p>\n\n<pre><code># ImageMagick pixel enumeration: 100,67,255,srgb\n0,0: (190,200,210)  #BEC8D2  srgb(190,200,210)\n1,0: (193,203,213)  #C1CBD5  srgb(193,203,213)\n2,0: (195,205,215)  #C3CDD7  srgb(195,205,215)\n3,0: (195,205,215)  #C3CDD7  srgb(195,205,215)\n4,0: (194,204,214)  #C2CCD6  srgb(194,204,214)\n5,0: (195,205,215)  #C3CDD7  srgb(195,205,215)\n6,0: (198,208,218)  #C6D0DA  srgb(198,208,218)\n7,0: (200,210,220)  #C8D2DC  srgb(200,210,220)\n8,0: (202,210,221)  #CAD2DD  srgb(202,210,221)\n9,0: (203,211,222)  #CBD3DE  srgb(203,211,222)\n10,0: (205,213,224)  #CDD5E0  srgb(205,213,224)\n11,0: (208,217,226)  #D0D9E2  srgb(208,217,226)\n12,0: (211,218,226)  #D3DAE2  srgb(211,218,226)\n13,0: (213,220,228)  #D5DCE4  srgb(213,220,228)\n14,0: (216,223,229)  #D8DFE5  srgb(216,223,229)\n15,0: (217,224,230)  #D9E0E6  srgb(217,224,230)\n16,0: (220,225,231)  #DCE1E7  srgb(220,225,231)\n17,0: (221,226,232)  #DDE2E8  srgb(221,226,232)\n18,0: (223,228,234)  #DFE4EA  srgb(223,228,234)\n19,0: (224,229,235)  #E0E5EB  srgb(224,229,235)\n</code></pre>\n\n<p>With PIL:</p>\n\n<p>(code)</p>\n\n<pre><code>import os\n\nimport PIL.Image as Image\n\ndef _main():\n    image_filepath = 'image.jpg'\n    output_filepath = image_filepath + '.python-dump'\n\n    im = Image.open(image_filepath)\n    width, height = im.size\n\n    data = im.getdata()\n\n    if os.path.exists(output_filepath):\n        os.remove(output_filepath)\n\n    with open(output_filepath, 'w') as f:\n        for y in range(height):\n            for x in range(width):\n                r, g, b = data[y * im.size[0] + x]\n\n                s = '({}, {}): [{} {} {}]\\n'.format(y, x, r, g, b)\n                f.write(s)\n\nif __name__ == '__main__':\n    _main()\n</code></pre>\n\n<p>(output)</p>\n\n<pre><code>(0, 0): [190 200 210]\n(0, 1): [193 203 213]\n(0, 2): [195 205 215]\n(0, 3): [195 205 215]\n(0, 4): [194 204 214]\n(0, 5): [195 205 215]\n(0, 6): [198 208 218]\n(0, 7): [200 210 220]\n(0, 8): [202 210 221]\n(0, 9): [203 211 222]\n(0, 10): [205 213 224]\n(0, 11): [208 217 226]\n(0, 12): [211 218 226]\n(0, 13): [213 220 228]\n(0, 14): [216 223 229]\n(0, 15): [217 224 230]\n(0, 16): [220 225 231]\n(0, 17): [221 226 232]\n(0, 18): [223 228 234]\n(0, 19): [224 229 235]\n</code></pre>\n\n<p>With Go:</p>\n\n<p>(code)</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"fmt\"\n    \"image\"\n    \"image/color\"\n    \"reflect\"\n\n    _ \"image/jpeg\"\n)\n\nfunc main() {\n    imageFilepath := \"image.jpg\"\n    outputFilepath := imageFilepath + \".go-dump\"\n\n    f, err := os.Open(imageFilepath)\n    if err != nil {\n        panic(err)\n    }\n\n    defer f.Close()\n\n    image, _, err := image.Decode(f)\n    if err != nil {\n        panic(err)\n    }\n\n    r := image.Bounds()\n    width := r.Max.X\n    height := r.Max.Y\n\n    os.Remove(outputFilepath)\n\n    g, err := os.OpenFile(outputFilepath, os.O_RDWR|os.O_CREATE, 0644)\n    if err != nil {\n        panic(err)\n    }\n\n    defer g.Close()\n\n    for y := 0; y &lt; height; y++ {\n        for x := 0; x &lt; width; x++ {\n            p := image.At(x, y)\n            c := color.NRGBAModel.Convert(p).(color.NRGBA)\n\n            s := fmt.Sprintf(\"(%d, %d): [%d %d %d %d]\\n\", y, x, c.R, c.G, c.B, c.A)\n            g.Write([]byte(s))\n        }\n    }\n}\n</code></pre>\n\n<p>(output)</p>\n\n<pre><code>(0, 0): [190 200 211 255]\n(0, 1): [193 203 214 255]\n(0, 2): [195 205 216 255]\n(0, 3): [195 205 216 255]\n(0, 4): [194 204 215 255]\n(0, 5): [195 205 216 255]\n(0, 6): [198 208 219 255]\n(0, 7): [200 210 221 255]\n(0, 8): [202 210 222 255]\n(0, 9): [203 211 223 255]\n(0, 10): [205 213 225 255]\n(0, 11): [208 217 226 255]\n(0, 12): [212 218 226 255]\n(0, 13): [214 220 228 255]\n(0, 14): [217 224 229 255]\n(0, 15): [218 225 230 255]\n(0, 16): [220 225 231 255]\n(0, 17): [221 226 232 255]\n(0, 18): [223 228 234 255]\n(0, 19): [224 229 235 255]\n</code></pre>\n\n<p><strong>EDIT: Oh, man.</strong></p>\n\n<p>The Go code seems to implement the YCbCr->RGB conversion in a totally different manner. Not only does it indicate that it does some minor rounding (which deviates from the JFIF specification) so that it can implement faster integer math, instead of floating point math, PIL/Pillow (and IM, by implication) uses <em>lookup tables rather than actual arithmetic</em>. This ultimately seems to imply that Go will never produce the same color values as the other implementations. <strong>If it's critical that the color values be identical between Go and the others, you might need to use an alternate implementation.</strong></p>\n\n<p>Go implementation:</p>\n\n<p>(<a href=\"https://golang.org/src/image/color/ycbcr.go\" rel=\"nofollow noreferrer\">https://golang.org/src/image/color/ycbcr.go</a>)</p>\n\n<pre><code>// YCbCrToRGB converts a Y'CbCr triple to an RGB triple.\nfunc YCbCrToRGB(y, cb, cr uint8) (uint8, uint8, uint8) {\n  // The JFIF specification says:\n  //  R = Y' + 1.40200*(Cr-128)\n  //  G = Y' - 0.34414*(Cb-128) - 0.71414*(Cr-128)\n  //  B = Y' + 1.77200*(Cb-128)\n  // http://www.w3.org/Graphics/JPEG/jfif3.pdf says Y but means Y'.\n  //\n  // Those formulae use non-integer multiplication factors. When computing,\n  // integer math is generally faster than floating point math. We multiply\n  // all of those factors by 1&lt;&lt;16 and round to the nearest integer:\n  //   91881 = roundToNearestInteger(1.40200 * 65536).\n  //   22554 = roundToNearestInteger(0.34414 * 65536).\n  //   46802 = roundToNearestInteger(0.71414 * 65536).\n  //  116130 = roundToNearestInteger(1.77200 * 65536).\n  //\n  // Adding a rounding adjustment in the range [0, 1&lt;&lt;16-1] and then shifting\n  // right by 16 gives us an integer math version of the original formulae.\n  //  R = (65536*Y' +  91881 *(Cr-128)                  + adjustment) &gt;&gt; 16\n  //  G = (65536*Y' -  22554 *(Cb-128) - 46802*(Cr-128) + adjustment) &gt;&gt; 16\n  //  B = (65536*Y' + 116130 *(Cb-128)                  + adjustment) &gt;&gt; 16\n  // A constant rounding adjustment of 1&lt;&lt;15, one half of 1&lt;&lt;16, would mean\n  // round-to-nearest when dividing by 65536 (shifting right by 16).\n  // Similarly, a constant rounding adjustment of 0 would mean round-down.\n  //\n  // Defining YY1 = 65536*Y' + adjustment simplifies the formulae and\n  // requires fewer CPU operations:\n  //  R = (YY1 +  91881 *(Cr-128)                 ) &gt;&gt; 16\n  //  G = (YY1 -  22554 *(Cb-128) - 46802*(Cr-128)) &gt;&gt; 16\n  //  B = (YY1 + 116130 *(Cb-128)                 ) &gt;&gt; 16\n  //\n  // The inputs (y, cb, cr) are 8 bit color, ranging in [0x00, 0xff]. In this\n  // function, the output is also 8 bit color, but in the related YCbCr.RGBA\n  // method, below, the output is 16 bit color, ranging in [0x0000, 0xffff].\n  // Outputting 16 bit color simply requires changing the 16 to 8 in the \"R =\n  // etc &gt;&gt; 16\" equation, and likewise for G and B.\n  //\n  // As mentioned above, a constant rounding adjustment of 1&lt;&lt;15 is a natural\n  // choice, but there is an additional constraint: if c0 := YCbCr{Y: y, Cb:\n  // 0x80, Cr: 0x80} and c1 := Gray{Y: y} then c0.RGBA() should equal\n  // c1.RGBA(). Specifically, if y == 0 then \"R = etc &gt;&gt; 8\" should yield\n  // 0x0000 and if y == 0xff then \"R = etc &gt;&gt; 8\" should yield 0xffff. If we\n  // used a constant rounding adjustment of 1&lt;&lt;15, then it would yield 0x0080\n  // and 0xff80 respectively.\n  //\n  // Note that when cb == 0x80 and cr == 0x80 then the formulae collapse to:\n  //  R = YY1 &gt;&gt; n\n  //  G = YY1 &gt;&gt; n\n  //  B = YY1 &gt;&gt; n\n  // where n is 16 for this function (8 bit color output) and 8 for the\n  // YCbCr.RGBA method (16 bit color output).\n  //\n  // The solution is to make the rounding adjustment non-constant, and equal\n  // to 257*Y', which ranges over [0, 1&lt;&lt;16-1] as Y' ranges over [0, 255].\n  // YY1 is then defined as:\n  //  YY1 = 65536*Y' + 257*Y'\n  // or equivalently:\n  //  YY1 = Y' * 0x10101\n  yy1 := int32(y) * 0x10101\n  cb1 := int32(cb) - 128\n  cr1 := int32(cr) - 128\n\n  // The bit twiddling below is equivalent to\n  //\n  // r := (yy1 + 91881*cr1) &gt;&gt; 16\n  // if r &lt; 0 {\n  //     r = 0\n  // } else if r &gt; 0xff {\n  //     r = ^int32(0)\n  // }\n  //\n  // but uses fewer branches and is faster.\n  // Note that the uint8 type conversion in the return\n  // statement will convert ^int32(0) to 0xff.\n  // The code below to compute g and b uses a similar pattern.\n  r := yy1 + 91881*cr1\n  if uint32(r)&amp;0xff000000 == 0 {\n      r &gt;&gt;= 16\n  } else {\n      r = ^(r &gt;&gt; 31)\n  }\n\n  g := yy1 - 22554*cb1 - 46802*cr1\n  if uint32(g)&amp;0xff000000 == 0 {\n      g &gt;&gt;= 16\n  } else {\n      g = ^(g &gt;&gt; 31)\n  }\n\n  b := yy1 + 116130*cb1\n  if uint32(b)&amp;0xff000000 == 0 {\n      b &gt;&gt;= 16\n  } else {\n      b = ^(b &gt;&gt; 31)\n  }\n\n  return uint8(r), uint8(g), uint8(b)\n}\n</code></pre>\n\n<p>PIL (Pillow, actually) implementation (uses lookup tables):</p>\n\n<p>(<a href=\"https://github.com/python-pillow/Pillow/blob/bb1b3a532ca3fef915f9cde17ba2227671ac691c/libImaging/ConvertYCbCr.c#L363\" rel=\"nofollow noreferrer\">https://github.com/python-pillow/Pillow/blob/bb1b3a532ca3fef915f9cde17ba2227671ac691c/libImaging/ConvertYCbCr.c#L363</a>)</p>\n\n<pre><code>void\nImagingConvertYCbCr2RGB(UINT8* out, const UINT8* in, int pixels)\n{\n    int x;\n    UINT8 a;\n    int r, g, b;\n    int y, cr, cb;\n\n    for (x = 0; x &lt; pixels; x++, in += 4, out += 4) {\n\n        y = in[0];\n        cb = in[1];\n        cr = in[2];\n        a = in[3];\n\n        r = y + ((           R_Cr[cr]) &gt;&gt; SCALE);\n        g = y + ((G_Cb[cb] + G_Cr[cr]) &gt;&gt; SCALE);\n        b = y + ((B_Cb[cb]           ) &gt;&gt; SCALE);\n\n        out[0] = (r &lt;= 0) ? 0 : (r &gt;= 255) ? 255 : r;\n        out[1] = (g &lt;= 0) ? 0 : (g &gt;= 255) ? 255 : g;\n        out[2] = (b &lt;= 0) ? 0 : (b &gt;= 255) ? 255 : b;\n        out[3] = a;\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9023853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d241c4effaced3eb97074eeb3826b76?s=128&d=identicon&r=PG&f=1", "display_name": "goask", "link": "https://stackoverflow.com/users/9023853/goask"}, "edited": false, "score": 0, "creation_date": 1511937009, "post_id": 47546136, "comment_id": 82049409, "body": "thanks it works . but you see this example <a href=\"https://play.golang.org/p/P02AN1e09C\" rel=\"nofollow noreferrer\">play.golang.org/p/P02AN1e09C</a> it also has some problem."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 61, "user_id": 9023853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d241c4effaced3eb97074eeb3826b76?s=128&d=identicon&r=PG&f=1", "display_name": "goask", "link": "https://stackoverflow.com/users/9023853/goask"}, "edited": false, "score": 0, "creation_date": 1511940897, "post_id": 47546136, "comment_id": 82051147, "body": "<code>bigval</code> has a default precision of 53 bits. You need to increase this value to get accurate result: <a href=\"https://play.golang.org/p/Xy88JX57JE\" rel=\"nofollow noreferrer\">play.golang.org/p/Xy88JX57JE</a>. You&#39;ll need to read up on float precision documents to determine the number of bits your program requires."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 6, "last_activity_date": 1511940977, "last_edit_date": 1511940977, "creation_date": 1511935624, "answer_id": 47546136, "question_id": 47545898, "link": "https://stackoverflow.com/questions/47545898/golang-convert-big-float-to-big-int/47546136#47546136", "title": "golang convert big.Float to big.Int", "body": "<p>A big int bigger than <code>uint64</code> will always cause an overflow as <code>uint64</code> has fixed size. You should use the following <a href=\"https://golang.org/pkg/math/big/#Float.Int\" rel=\"noreferrer\">method</a> on <code>*Float</code>:</p>\n\n<pre><code>func (*Float) Int\n</code></pre>\n\n<p>The changes required would be:</p>\n\n<pre><code>func FloatToBigInt(val float64) *big.Int {\n    bigval := new(big.Float)\n    bigval.SetFloat64(val)\n    // Set precision if required.\n    // bigval.SetPrec(64)\n\n    coin := new(big.Float)\n    coin.SetInt(big.NewInt(1000000000000000000))\n\n    bigval.Mul(bigval, coin)\n\n    result := new(big.Int)\n    bigval.Int(result) // store converted number in result\n\n    return result\n}\n</code></pre>\n\n<p>Working example: <a href=\"https://play.golang.org/p/sEhH6iPkrK\" rel=\"noreferrer\">https://play.golang.org/p/sEhH6iPkrK</a></p>\n"}, {"tags": [], "owner": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "is_accepted": false, "score": 0, "last_activity_date": 1511935964, "creation_date": 1511935964, "answer_id": 47546193, "question_id": 47545898, "link": "https://stackoverflow.com/questions/47545898/golang-convert-big-float-to-big-int/47546193#47546193", "title": "golang convert big.Float to big.Int", "body": "<p>Use the function <a href=\"https://golang.org/pkg/math/big/#Float.Int\" rel=\"nofollow noreferrer\">Float.Int(nil)</a></p>\n"}], "owner": {"reputation": 61, "user_id": 9023853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d241c4effaced3eb97074eeb3826b76?s=128&d=identicon&r=PG&f=1", "display_name": "goask", "link": "https://stackoverflow.com/users/9023853/goask"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3893, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1612400300, "creation_date": 1511934436, "question_id": 47545898, "link": "https://stackoverflow.com/questions/47545898/golang-convert-big-float-to-big-int", "title": "golang convert big.Float to big.Int", "body": "<p>convert big.Float to big.Int, i write code below, but it overflow with uint64, so what's the correct way to cenvert big.Float to big.Int.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math/big\"\n\nfunc FloatToBigInt(val float64) *big.Int {\n    bigval := new(big.Float)\n    bigval.SetFloat64(val)\n\n    coin := new(big.Float)\n    coin.SetInt(big.NewInt(1000000000000000000))\n    bigval.Mul(bigval, coin)\n\n    result := new(big.Int)\n    f,_ := bigval.Uint64()\n    result.SetUint64(f)\n\n    return result\n}\n\nfunc main() {\n    fmt.Println(\"vim-go\")\n    fmt.Println(FloatToBigInt(float64(10)))\n    fmt.Println(FloatToBigInt(float64(20)))\n    fmt.Println(FloatToBigInt(float64(30)))\n    fmt.Println(FloatToBigInt(float64(40)))\n    fmt.Println(FloatToBigInt(float64(50)))\n    fmt.Println(FloatToBigInt(float64(100)))\n    fmt.Println(FloatToBigInt(float64(1000)))\n    fmt.Println(FloatToBigInt(float64(10000)))\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1511934593, "last_edit_date": 1511934593, "creation_date": 1511934265, "answer_id": 47545865, "question_id": 47545689, "link": "https://stackoverflow.com/questions/47545689/regex-match-subdomain/47545865#47545865", "title": "regex match subdomain", "body": "<p>The greedy <code>(.*)</code> in your regex is matching all the stuff that you don't want, you can remove that. Also, I escaped your <code>.</code> characters and moved your <code>+</code> to be inside the capture group. </p>\n\n<p>Change your regex to: <code>([-a-z0-9]+)\\.domain\\.com</code> or in the context of your code:</p>\n\n<pre><code>regexp.Compile(`([-a-z0-9]+)\\.domain\\.com`)\n</code></pre>\n\n<p>Here's a <a href=\"https://regex101.com/r/VSOi0w/1\" rel=\"nofollow noreferrer\">regex101 fiddle</a> you can test it with.</p>\n"}, {"comments": [{"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1511935321, "post_id": 47545959, "comment_id": 82048835, "body": "This is a better option, parsing URLs can quickly become complex and a URL library will be better able to pull out the relevant URL parts."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1511935596, "post_id": 47545959, "comment_id": 82048934, "body": "Quite agree - that\u2019s the way I recommend ;) it has one more advantage url lib checks url for errors and invalid sequences. I\u2019ve put a recipe above."}, {"owner": {"reputation": 133, "user_id": 8271744, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aac49eb3971ab6cbf0b6b916c5b33413?s=128&d=identicon&r=PG&f=1", "display_name": "Books", "link": "https://stackoverflow.com/users/8271744/books"}, "edited": false, "score": 0, "creation_date": 1511963271, "post_id": 47545959, "comment_id": 82065349, "body": "I&#39;ve used it to extract URLs from JavaScript(source code) and I ended up with a lot of garbage. I wouldn&#39;t recommend it for data &quot;extraction&quot; or validation. It&#39;s like that because of legacy reasons and the Go team doesn&#39;t want to make it a data extraction/validation tool anyway."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 133, "user_id": 8271744, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aac49eb3971ab6cbf0b6b916c5b33413?s=128&d=identicon&r=PG&f=1", "display_name": "Books", "link": "https://stackoverflow.com/users/8271744/books"}, "edited": false, "score": 0, "creation_date": 1511966330, "post_id": 47545959, "comment_id": 82067411, "body": "@Books with url?  how did you get that garbage with <code>url</code>? It produces much few variants then regexp parsing. Variants can be easily checked as I showed above with <code>u.Schema</code>. When you parse with regexp you have to handle many variants with different symbols."}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1511935720, "last_edit_date": 1511935720, "creation_date": 1511934772, "answer_id": 47545959, "question_id": 47545689, "link": "https://stackoverflow.com/questions/47545689/regex-match-subdomain/47545959#47545959", "title": "regex match subdomain", "body": "<p>I recommend use <a href=\"https://golang.org/pkg/net/url/\" rel=\"nofollow noreferrer\">url</a> package that can parse URL for  you and then check domain.  Otherwise you can get some pitfalls like symbols escaping etc. </p>\n\n<p><a href=\"https://play.golang.org/p/6so9FTfOSo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6so9FTfOSo</a></p>\n\n<p>Upd: updated the recipe, also there\u2019s an error in source URL - last <code>%</code> is not followed by hex code. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n    \"strings\"\n)\n\nvar s = \"prefix1-prefix2.domain.com%2Fdocument%2F%3Fusp%3Dmkt_docs%26lng%3Den&amp;followup=https%3A%2F%2Fprefix1-prefix2.domain.com%2Fdocument%2F%3Fusp%3Dmkt_docs%26lng\"\n\nfunc main() {\n    s2, err := url.QueryUnescape(s)\n    u, err := url.Parse(s2)\n    if err != nil {\n        fmt.Println(\"error\")\n    }\n    if u.Scheme == \"\" {\n        s2 = \"https://\" + s2\n    }\n    fmt.Println(s2, err)\n    u, err = url.Parse(s2)\n\n    fmt.Printf(\"%#v %v\", u, err)\n\n    fmt.Println(u.Host)\n    if strings.HasSuffix(u.Host, \".domain.com\") {\n        fmt.Println(\"subdomain!\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 8271744, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aac49eb3971ab6cbf0b6b916c5b33413?s=128&d=identicon&r=PG&f=1", "display_name": "Books", "link": "https://stackoverflow.com/users/8271744/books"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 47545865, "answer_count": 2, "score": 1, "last_activity_date": 1511935720, "creation_date": 1511933378, "question_id": 47545689, "link": "https://stackoverflow.com/questions/47545689/regex-match-subdomain", "title": "regex match subdomain", "body": "<p>I need a regex that matches all the subdomains of a specific domain. The content media type is unknown (i.g. may be urlencoded, json etc)\nSo far I've got this simple regex \n<code>re, err := regexp.Compile(`([-a-z0-9])+[.](.*)domain.com`)</code></p>\n\n<p>The issue is that for a string such this below the whole string is <a href=\"https://golang.org/pkg/regexp/#Regexp.FindAll\" rel=\"nofollow noreferrer\">Found</a> instead to get the specific sudomains extracted such <code>prefix1-prefix2.domain.com</code> so the question is what regexp do I need to get only the subdomains without the extra string (i.e <code>%2Fdocument...</code>) </p>\n\n<p><code>prefix1-prefix2.domain.com%2Fdocument%2F%3Fusp%3Dmkt_docs%26lng%3Den&amp;followup=https%3A%2F%2Fprefix1-prefix2.domain.com%2Fdocument%2F%3Fusp%3Dmkt_docs%26lng%</code> </p>\n"}, {"tags": ["mysql", "rest", "go", "connection-pooling"], "comments": [{"owner": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 2, "creation_date": 1511928639, "post_id": 47544906, "comment_id": 82046721, "body": "Please be sure to properly format code. As originally posted, it was completely unreadable. I edited it, but... in the future, please do this when posting."}, {"owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "reply_to_user": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 0, "creation_date": 1511936302, "post_id": 47544906, "comment_id": 82049152, "body": "Sure thanks. Why is my question given -2 :). Is it an invalid question ? Guys I am looking for an answer."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 1, "creation_date": 1511940169, "post_id": 47544906, "comment_id": 82050799, "body": "Why do you need separate connection for each request? In fact good framework can cache data so page loads can involve no database access. Also db driver has its own connection pool. So there\u2019s no direct association between web and db requests."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1511950648, "post_id": 47544906, "comment_id": 82057061, "body": "I recommend you to get and read <a href=\"https://www.vividcortex.com/resources/the-ultimate-guide-to-building-database-driven-apps-with-go\" rel=\"nofollow noreferrer\">this ebook</a> to gain deep understanding of how <code>database&#47;sql</code> is implemented. (I&#39;m not affilicated with the book&#39;s authors, FWIW.)"}, {"owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1512030499, "post_id": 47544906, "comment_id": 82095275, "body": "Great @kostix. This is quite helpful"}, {"owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "reply_to_user": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1512107845, "post_id": 47544906, "comment_id": 82132193, "body": "@EugeneLisitsky, what I am looking for is : how to utilise &#39;prepared-statement&#39; with this framework ( gin ). I don&#39;t want to see it working because everytime the REST API call is preparing the statement. Which would be very in-efficient. The proper logic would be while creating prepared statement it should be tightly bound with the connection. Now if we use connection pool and we really want to utilise prep-stmt handle, then we should have a map of each stmt with unique db connection. Now question is : is it provided by GIN or not"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1512107992, "post_id": 47544906, "comment_id": 82132244, "body": "Not sure about gin. I guess you have to set in db pooler. Also if all the prepared statements are the same in all connnections, then try to set up them on connection statrt."}, {"owner": {"reputation": 1053, "user_id": 9342041, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4e7aadf1a0fdcc33569b83e752edd611?s=128&d=identicon&r=PG&f=1", "display_name": "devmrh", "link": "https://stackoverflow.com/users/9342041/devmrh"}, "edited": false, "score": 0, "creation_date": 1529681837, "post_id": 47544906, "comment_id": 88977296, "body": "nice question +1"}], "answers": [{"comments": [{"owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "edited": false, "score": 0, "creation_date": 1512107893, "post_id": 47556877, "comment_id": 82132210, "body": "Here is copy-paste of my question mentioned above :  what I am looking for is : how to utilise &#39;prepared-statement&#39; with this framework ( gin ). I don&#39;t want to see it working because everytime the REST API call is preparing the statement. Which would be very in-efficient. The proper logic would be while creating prepared statement it should be tightly bound with the connection. Now if we use connection pool and we really want to utilise prep-stmt handle, then we should have a map of each stmt with unique db connection. Now question is : is it provided by GIN or not"}, {"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "reply_to_user": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "edited": false, "score": 0, "creation_date": 1512115455, "post_id": 47556877, "comment_id": 82135137, "body": "No, it doesn&#39;t. Gin - is a web tool and does nothing with anything underneath HTTP transport layer."}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": false, "score": 1, "last_activity_date": 1511971084, "creation_date": 1511971084, "answer_id": 47556877, "question_id": 47544906, "link": "https://stackoverflow.com/questions/47544906/gin-golang-db-connection-pooling/47556877#47556877", "title": "Gin + Golang + DB Connection Pooling", "body": "<p>Establishing a new SQL connection for each HTTP request is too heavy and has no sense.<br>\nIn go there is no user-managable connection pool yet, it is handled internally by go implementation.<br>\n<code>sql.DB</code> is ready to be used concurrently, so there is no worry about it.<br>\nAnd GIN has nothing to do with SQL connections at all. It is fully your responsibility to handle queries/transactions properly.</p>\n"}], "owner": {"reputation": 1632, "user_id": 306819, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/dd75cc276ca4b29e97f7dfcd6087faf0?s=128&d=identicon&r=PG", "display_name": "siddhusingh", "link": "https://stackoverflow.com/users/306819/siddhusingh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3657, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1512365929, "creation_date": 1511928506, "last_edit_date": 1511928601, "question_id": 47544906, "link": "https://stackoverflow.com/questions/47544906/gin-golang-db-connection-pooling", "title": "Gin + Golang + DB Connection Pooling", "body": "<p>I would like to understand how does GIN ensures that each HTTP request gets a unique DB ( say MySQL ) connection. Here is one example code.\nIf you see, since 'db' is a global object and therefore, the API router.GET(\"/person/:age\"... gets access to DB. \nNow with load, I suppose GIN will have concurrency implemented internally. If yes, then how does it ensures that each request gets a different connection. If no, then it is single threaded imnplementation. Could anyone please correct my understanding.</p>\n\n<pre><code>package main\n\nimport (\n    //  \"bytes\"\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/gin-gonic/gin\"\n    _ \"github.com/go-sql-driver/mysql\"\n    \"net/http\"\n)\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    } else {\n        fmt.Println(\"successful...\")\n    }\n}\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"abfl:abfl@tcp(127.0.0.1:3306)/abfl?charset=utf8\")\n    checkErr(err)\n    defer db.Close()\n    // make sure connection is available\n    err = db.Ping()\n    checkErr(err)\n    type User struct {\n        age  int\n        name string\n    }\n    router := gin.Default()\n    // Add API handlers here\n    // GET a user detail\n    router.GET(\"/person/:age\", func(c *gin.Context) {\n        var (\n            user   User\n            result gin.H\n        )\n        age := c.Param(\"age\")\n        fmt.Println(\"input age : '%d'\", age)\n        row := db.QueryRow(\"select age, name from user where age = ?\", age)\n        err = row.Scan(&amp;user.age, &amp;user.name)\n        fmt.Printf(\"user : %+v\\n\", user)\n        if err != nil {\n            // If no results send null\n            result = gin.H{\n                \"user\":  nil,\n                \"count\": 0,\n            }\n        } else {\n            result = gin.H{\n                \"age\":   user.age,\n                \"name\":  user.name,\n                \"count\": 1,\n            }\n        }\n        c.JSON(http.StatusOK, result)\n    })\n    router.Run(\":3000\")\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "time", "aggregate", "mgo"], "comments": [{"owner": {"reputation": 4359, "user_id": 960362, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/031e30c4f9c0728b3a557e9a1844247f?s=128&d=identicon&r=PG", "display_name": "tarheel", "link": "https://stackoverflow.com/users/960362/tarheel"}, "edited": false, "score": 0, "creation_date": 1511927925, "post_id": 47544743, "comment_id": 82046512, "body": "Welcome to Stackoverflow! Please take a minute to review <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask a good question</a>. It will help you get a great answer."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8931061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d225845383d7dbf47e1af547fdcc486f?s=128&d=identicon&r=PG&f=1", "display_name": "Shahul H", "link": "https://stackoverflow.com/users/8931061/shahul-h"}, "edited": false, "score": 0, "creation_date": 1511965869, "post_id": 47548534, "comment_id": 82067104, "body": "Thank you so much."}, {"owner": {"reputation": 11, "user_id": 8931061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d225845383d7dbf47e1af547fdcc486f?s=128&d=identicon&r=PG&f=1", "display_name": "Shahul H", "link": "https://stackoverflow.com/users/8931061/shahul-h"}, "edited": false, "score": 0, "creation_date": 1511966491, "post_id": 47548534, "comment_id": 82067541, "body": "Thank you so much. Above code works well without any errors but I&#39;m not getting the data from the database, output []. Below is the sample data. {   \t&quot;latitude&quot; : -78.703347,  \t&quot;longitude&quot;: 32.710459,         &quot;date&quot;:ISODate(&quot;2017-11-29T19:58:00.389Z&quot;), \t&quot;distance&quot; : 2500 }, {   \t&quot;latitude&quot; : -78.703347,  \t&quot;longitude&quot;: 32.710459,         &quot;date&quot;:ISODate(&quot;2017-11-29T19:58:20.389Z&quot;), \t&quot;distance&quot; : 250 }                When the above code is executed the output should be total distance : 2750."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 8931061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d225845383d7dbf47e1af547fdcc486f?s=128&d=identicon&r=PG&f=1", "display_name": "Shahul H", "link": "https://stackoverflow.com/users/8931061/shahul-h"}, "edited": false, "score": 0, "creation_date": 1511966726, "post_id": 47548534, "comment_id": 82067712, "body": "@ShahulH Because in your MongoDB there is no <code>createdAt</code> field, only <code>date</code>. Either use <code>date</code> in the query, or rename the field to <code>createdAt</code> in MongoDB."}, {"owner": {"reputation": 11, "user_id": 8931061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d225845383d7dbf47e1af547fdcc486f?s=128&d=identicon&r=PG&f=1", "display_name": "Shahul H", "link": "https://stackoverflow.com/users/8931061/shahul-h"}, "edited": false, "score": 0, "creation_date": 1512053901, "post_id": 47548534, "comment_id": 82109636, "body": "Thank you. I understood now."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1511948911, "last_edit_date": 1511948911, "creation_date": 1511945329, "answer_id": 47548534, "question_id": 47544743, "link": "https://stackoverflow.com/questions/47544743/how-to-aggregrate-data-created-in-the-last-hour-in-go-using-mongodb/47548534#47548534", "title": "How to aggregrate data created in the last hour in Go using MongoDB?", "body": "<h2>First your error message</h2>\n\n<p>This <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> is invalid:</p>\n\n<pre><code>[]bson.M{\n    {\"$match\": bson.M{\"createdAt\":{\"$gt\":hour} }},\n    ...\n</code></pre>\n\n<p>More specifically this part:</p>\n\n<pre><code>bson.M{\"createdAt\":{\"$gt\":hour} }\n</code></pre>\n\n<p>Because the <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#M\" rel=\"nofollow noreferrer\"><code>bson.M</code></a> type is:</p>\n\n<pre><code>type M map[string]interface{}\n</code></pre>\n\n<p>So a <code>bson.M</code> literal is effecively a map literal, where if the type of the value (in the key-value pairs) is not identical to the map type's value type, you have to explicitly write it out. This is mentioned in the spec:</p>\n\n<blockquote>\n  <p>Within a composite literal of array, slice, or map type <code>T</code>, elements or map keys that are themselves composite literals may elide the respective literal type if it is identical to the element or key type of <code>T</code>.</p>\n</blockquote>\n\n<p>The key-value pair: <code>\"createdAt: {\"$gt\":hour}</code>, the value here is another <code>bson.M</code> value, but you did not mention it. The value type of this map is <code>interface{}</code>, so the compiler cannot guess you want it to be another <code>bson.M</code>. You have to spell it out for the compiler.</p>\n\n<p>The correct version is:</p>\n\n<pre><code>bson.M{\"createdAt\": bson.M{\"$gt\":hour}}\n</code></pre>\n\n<p>This fixes the compile-time error, but won't give you the desired result.</p>\n\n<h2>Now on to the task you want to achieve</h2>\n\n<p>If the <code>createdAt</code> field is a <a href=\"https://docs.mongodb.com/manual/reference/bson-types/#document-bson-type-date\" rel=\"nofollow noreferrer\"><code>Date</code></a> type in MongoDB, then pass a value of <a href=\"https://golang.org/pkg/time/#Time\" rel=\"nofollow noreferrer\"><code>time.Time</code></a> when filtering by it.</p>\n\n<p>Regarding the value of the passed <code>time.Time</code>, calculate the time value 1 hour ago (from the current time). For that, you may use the <a href=\"https://golang.org/pkg/time/#Time.Add\" rel=\"nofollow noreferrer\"><code>time.Add()</code></a> method, which adds a given <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\"><code>time.Duration</code></a> value to a time, and returns the new time. The duration may be negative to go back in time.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>anHourAgo := time.Now().Add(-time.Hour)\npipeline := []bson.M{\n    {\"$match\": bson.M{\"createdAt\": bson.M{\"$gt\": anHourAgo}}},\n    {\"$group\": bson.M{\n        \"_id\":              \"\",\n        \"total distance\":   bson.M{\"$sum\": \"$distance\"},\n        \"maximum distance\": bson.M{\"$max\": \"$distance\"},\n        \"minimum distance\": bson.M{\"$min\": \"$distance\"},\n    }},\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8931061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d225845383d7dbf47e1af547fdcc486f?s=128&d=identicon&r=PG&f=1", "display_name": "Shahul H", "link": "https://stackoverflow.com/users/8931061/shahul-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511948911, "creation_date": 1511927449, "last_edit_date": 1511945487, "question_id": 47544743, "link": "https://stackoverflow.com/questions/47544743/how-to-aggregrate-data-created-in-the-last-hour-in-go-using-mongodb", "title": "How to aggregrate data created in the last hour in Go using MongoDB?", "body": "<p>I want to aggregate the distance field created in the last hour.</p>\n\n<p>The error I get is is: <code>\"missing type in composite literal\"</code></p>\n\n<p>My code:</p>\n\n<pre><code>var lastHour = time.Now()\nvar hour=lastHour.Hour()-1\npipeline := []bson.M{\n    {\"$match\": bson.M{\"createdAt\":{\"$gt\":hour} }},\n    {\"$group\":\n    bson.M{\"_id\": \"\",\n    \"total distance\": bson.M{ \"$sum\": \"$distance\" },\n    \"maximum distance\": bson.M{ \"$max\": \"$distance\" },\n    \"minimum distance\": bson.M{ \"$min\": \"$distance\" },\n        },\n    },\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 3, "creation_date": 1511923184, "post_id": 47544156, "comment_id": 82045292, "body": "<a href=\"https://dave.cheney.net/2014/03/25/the-empty-struct\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/03/25/the-empty-struct</a>"}, {"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 1, "creation_date": 1511923374, "post_id": 47544156, "comment_id": 82045339, "body": "<a href=\"https://stackoverflow.com/questions/20793568/golang-anonymous-struct-and-empty-struct\" title=\"golang anonymous struct and empty struct\">stackoverflow.com/questions/20793568/&hellip;</a> <a href=\"https://stackoverflow.com/questions/22770114/any-difference-in-using-an-empty-interface-or-an-empty-struct-as-a-maps-value-i\" title=\"any difference in using an empty interface or an empty struct as a maps value i\">stackoverflow.com/questions/22770114/&hellip;</a>"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1511923512, "post_id": 47544156, "comment_id": 82045382, "body": "@ChronoKitsune, I read it before posting, but I still don&#39;t understand. What is a &quot;method receiver&quot; in the first place?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511965434, "post_id": 47544156, "comment_id": 82066809, "body": "Method receivers are covered in the Go tour: <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">tour.golang.org/methods/1</a>"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511971758, "post_id": 47544156, "comment_id": 82071541, "body": "@Adrian, why would someone use a null method receiver if you can omit it in the first place? You are just doing extra typing work."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511972244, "post_id": 47544156, "comment_id": 82071883, "body": "I&#39;m not sure I understand the question, but I do know that the goal of programming is not to minimize typing."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511972604, "post_id": 47544156, "comment_id": 82072116, "body": "@Adrian, in this case, this typing isn&#39;t producing any benefits, and I am sure the goal of programming is not to fill your code with pointless annotations."}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1511958229, "post_id": 47544821, "comment_id": 82062046, "body": "thanks! a much useful answer than on dave cheney net"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 45, "last_activity_date": 1511927956, "creation_date": 1511927956, "answer_id": 47544821, "question_id": 47544156, "link": "https://stackoverflow.com/questions/47544156/what-uses-a-type-with-empty-struct-has-in-go/47544821#47544821", "title": "What uses a type with empty struct has in Go?", "body": "<p>Empty struct <code>struct{}</code> is realized in special way in Go. </p>\n\n<ol>\n<li><p>It\u2019s a smallest building block in Go. It\u2019s size is literally 0 bytes. </p></li>\n<li><p>If has zero size. you may create a slice of 1000\u2019s empty structures and this slice will be very tiny. Because really Go stores only a number of them in the slice but not them itself. The same story with channels. </p></li>\n<li><p>All pointers to it always point to the same special place in memory. </p></li>\n<li><p>Very useful In channels when you have notify about some event but you don\u2019t need to pass any information about it, only a fact. Best solution is to pass an empty structure because it will only increment a counter in the channel but not assign memory, copy elements end so on. \nSometime people use Boolean values for this purpose, but it\u2019s much worse. </p></li>\n<li><p>Zero size  container for methods. You may want have a mock for testing interfaces.  often you don\u2019t need data on it just methods with predefined input and output. </p></li>\n<li><p>Go has no <code>Set</code> object. Bit can be easily realized as a <code>map[keyType]struct{}</code>. This way map keeps only keys and no values. </p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11396, "user_id": 2768067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSTUv.png?s=128&g=1", "display_name": "Komu", "link": "https://stackoverflow.com/users/2768067/komu"}, "is_accepted": false, "score": 6, "last_activity_date": 1546587949, "creation_date": 1546587949, "answer_id": 54034902, "question_id": 47544156, "link": "https://stackoverflow.com/questions/47544156/what-uses-a-type-with-empty-struct-has-in-go/54034902#54034902", "title": "What uses a type with empty struct has in Go?", "body": "<p>I usually use it where I would have used a channel of booleans. \nie, instead of;</p>\n\n<pre><code>func main() {\n    done := make(chan bool, 1)\n\n    go func() {\n        // simulate long running task\n        time.Sleep(4 * time.Second)\n        done &lt;- true\n        fmt.Println(\"long running task is done\")\n    }()\n\n    &lt;-done\n    close(done)\n\n    fmt.Printf(\"whole program is done.\")\n}\n</code></pre>\n\n<p>I use;</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    done := make(chan struct{}, 1)\n\n    go func() {\n        // simulate long running task\n        time.Sleep(4 * time.Second)\n        done &lt;- struct{}{}\n        fmt.Println(\"long running task is done\")\n    }()\n\n    &lt;-done\n    close(done)\n\n    fmt.Printf(\"whole program is done.\")\n}\n</code></pre>\n"}], "owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6185, "favorite_count": 8, "accepted_answer_id": 47544821, "answer_count": 2, "score": 19, "last_activity_date": 1546587949, "creation_date": 1511923037, "question_id": 47544156, "link": "https://stackoverflow.com/questions/47544156/what-uses-a-type-with-empty-struct-has-in-go", "title": "What uses a type with empty struct has in Go?", "body": "<p>Why would you create a type with empty struct?</p>\n\n<pre><code>type FrontierSigner struct{}\n</code></pre>\n\n<p>What is it good for?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1511916590, "post_id": 47543241, "comment_id": 82043729, "body": "The second variable in a <code>range</code> gets set to each value in the slice as the loop iterates. Assigning to that variable does not affect the slice."}, {"owner": {"reputation": 45, "user_id": 5523509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38d25d397b6df9efc88e1debdd6ff69?s=128&d=identicon&r=PG&f=1", "display_name": "shoki", "link": "https://stackoverflow.com/users/5523509/shoki"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1511940709, "post_id": 47543241, "comment_id": 82051048, "body": "thanks for the clarification @AndySchweig."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5523509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38d25d397b6df9efc88e1debdd6ff69?s=128&d=identicon&r=PG&f=1", "display_name": "shoki", "link": "https://stackoverflow.com/users/5523509/shoki"}, "edited": false, "score": 0, "creation_date": 1511940756, "post_id": 47543346, "comment_id": 82051074, "body": "Thanks for your time dave. Yes, Andy had answered my question"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1511916686, "creation_date": 1511916686, "answer_id": 47543346, "question_id": 47543241, "link": "https://stackoverflow.com/questions/47543241/error-when-creating-2d-slice/47543346#47543346", "title": "Error when creating 2D slice", "body": "<p>As Andy said in a comment:</p>\n\n<blockquote>\n  <p>The second variable in a range gets set to each value in the slice as the loop iterates. Assigning to that variable does not affect the slice.</p>\n</blockquote>\n\n<p>You probably just want to do:</p>\n\n<pre><code>func notWorking2D() [][]uint8 {\n    p := make([][]uint8, 2)\n    for i, _ := range p {      \n        p[i] = make([]uint8, 8)\n        for j, _ := range p[i] {\n            p[i][j] = uint8(j)\n        }\n    }\n    return p\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cHQc9ReJBE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/cHQc9ReJBE</a></p>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1511981592, "creation_date": 1511981592, "answer_id": 47559794, "question_id": 47543241, "link": "https://stackoverflow.com/questions/47543241/error-when-creating-2d-slice/47559794#47559794", "title": "Error when creating 2D slice", "body": "<p>There\u2019 re no 2d slice in Go. </p>\n\n<p>You can create a \u201cslice of slices\u201d. This has drawback as you have to initialize every \u201csubslice\u201d manually. </p>\n\n<p>Also gives toy more flexibility as any particular slice can have its own length and capacity. </p>\n\n<pre><code>func slice2(n int) [][]int {\n    Result := make([][]int, 0, n)\n    for i:=0; i&lt;n; i++ {\n        Result = append(Result, make([]int))\n    }\n    return Result\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5523509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38d25d397b6df9efc88e1debdd6ff69?s=128&d=identicon&r=PG&f=1", "display_name": "shoki", "link": "https://stackoverflow.com/users/5523509/shoki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1511981592, "creation_date": 1511915876, "last_edit_date": 1511919940, "question_id": 47543241, "link": "https://stackoverflow.com/questions/47543241/error-when-creating-2d-slice", "title": "Error when creating 2D slice", "body": "<p>I am trying to create and initialize a 2D slice in Go. While the following function works without any issues:</p>\n\n<pre><code>func working2D() [][]uint8 {\n    p := make([][]uint8, 2)\n    for i:=range p{\n        p[i]=make([]uint8, 8)\n        for j:=range p[i]{\n            p[i][j]=uint8(j)\n        }\n    }\n    fmt.Println(p)\n    return p\n}\n</code></pre>\n\n<blockquote>\n  <p>Output: [[0 1 2 3 4 5 6 7] [0 1 2 3 4 5 6 7]]</p>\n</blockquote>\n\n<p>But the following function does not even compile and throws a compilation error:</p>\n\n<blockquote>\n  <p>sample/main/range.go:35:9: v2 declared and not used</p>\n</blockquote>\n\n<pre><code>func notWorking2D() [][]uint8 {\n    p := make([][]uint8, 1)\n    for _,v := range p {\n        v = make([]uint8, 8)\n        for j, v2 := range v {\n            v2 = uint8(j)\n        }\n    }\n    fmt.Println(p)\n    return p\n}\n</code></pre>\n\n<blockquote>\n  <p>Output: [[],[]]</p>\n</blockquote>\n\n<p>What is it that I am missing in the second function?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 106, "user_id": 3280862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d20230449c1d7d94f261e0c3d87d784?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/3280862/seth"}, "edited": false, "score": 0, "creation_date": 1511975996, "post_id": 47543333, "comment_id": 82074201, "body": "Ah, I see. That does make sense. So, what if I want the python script to run indefinitely? Does it make sense for me to just start a new goroutine, start the python process there, then do cmd.Wait() from that routine? Thanks!"}], "tags": [], "owner": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "is_accepted": true, "score": 2, "last_activity_date": 1511916867, "last_edit_date": 1511916867, "creation_date": 1511916567, "answer_id": 47543333, "question_id": 47543200, "link": "https://stackoverflow.com/questions/47543200/eof-error-when-trying-to-execute-python-2-7-code-from-golang/47543333#47543333", "title": "EOF Error when trying to execute python 2.7 code from Golang", "body": "<p>When <code>cmd.Start()</code> returns, the process running test.go exits and its standard input is closed; so, the process running test.py receives EOF.</p>\n\n<p>Modify test.go, adding something like <code>cmd.Wait()</code>, or even just a <code>time.Sleep(300 * time.Second)</code> after the last block, and you'll see what you probably expected.</p>\n\n<p>For instance:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"os/exec\"\n) \n\nfunc main() {\n        cmd := exec.Command(\"python\", \"test.py\")\n\n        cmd.Stderr = os.Stderr\n        cmd.Stdout = os.Stdout\n        cmd.Stdin = os.Stdin\n\n        // Start the process\n        if err := cmd.Start(); err != nil {\n                panic(err)\n        }\n        if err := cmd.Wait(); err != nil { \n                fmt.Println(\"cmd.Wait() in parent process:\", err)\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 106, "user_id": 3280862, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d20230449c1d7d94f261e0c3d87d784?s=128&d=identicon&r=PG&f=1", "display_name": "Seth", "link": "https://stackoverflow.com/users/3280862/seth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 47543333, "answer_count": 1, "score": 0, "last_activity_date": 1511916998, "creation_date": 1511915600, "last_edit_date": 1511916998, "question_id": 47543200, "link": "https://stackoverflow.com/questions/47543200/eof-error-when-trying-to-execute-python-2-7-code-from-golang", "title": "EOF Error when trying to execute python 2.7 code from Golang", "body": "<p>I've been trying to use a python utility from code that I'm writing in go. I've been trying to use stdin/stdout to communicate between the processes. However, I'm getting an EOF error using python's <code>raw_input()</code>, even if I connect its stdin to go's stdin.</p>\n\n<p>Here is the code to reproduce the issue:</p>\n\n<p>test.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"python\", \"test.py\")\n\n    cmd.Stderr = os.Stderr\n    cmd.Stdout = os.Stdout\n    cmd.Stdin = os.Stdin\n\n    // Start the process\n    if err := cmd.Start(); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>test.py:</p>\n\n<pre><code>while True:\n    input = raw_input()\n    print input\n</code></pre>\n\n<p>The error I get is </p>\n\n<pre><code>Traceback (most recent call last):\n  File \"test.py\", line 3, in &lt;module&gt;\n    input = raw_input()\nEOFError\n</code></pre>\n\n<p>I don't understand why this would be an issue. Does anybody have any input?</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1511915323, "creation_date": 1511915323, "answer_id": 47543154, "question_id": 47543130, "link": "https://stackoverflow.com/questions/47543130/assigning-a-pointer-field-to-a-casted-value/47543154#47543154", "title": "Assigning a pointer field to a casted value", "body": "<p>You would need to first assign the int64 to a variable:</p>\n\n<pre><code>aValueTmp := int64(aValue)\nreturn someStruct{IntVal: &amp;aValueTmp}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1511915877, "last_edit_date": 1511915877, "creation_date": 1511915538, "answer_id": 47543192, "question_id": 47543130, "link": "https://stackoverflow.com/questions/47543130/assigning-a-pointer-field-to-a-casted-value/47543192#47543192", "title": "Assigning a pointer field to a casted value", "body": "<p>The easiest way - instantuiate a variable and give a pointer to it. Or in one line:</p>\n\n<pre><code>return someStruct{\n    IntVal: func(i int64) *int64 {return &amp;i}(aValue)\n}\n</code></pre>\n"}], "owner": {"reputation": 1811, "user_id": 3004041, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e9c675dd9408721a8e8e1106774a9d11?s=128&d=identicon&r=PG&f=1", "display_name": "covfefe", "link": "https://stackoverflow.com/users/3004041/covfefe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1511984122, "creation_date": 1511915160, "last_edit_date": 1511984122, "question_id": 47543130, "link": "https://stackoverflow.com/questions/47543130/assigning-a-pointer-field-to-a-casted-value", "title": "Assigning a pointer field to a casted value", "body": "<p>I'm sure this is just a syntax thing I'm not aware of but this is the struct with pointer fields:</p>\n\n<pre><code>type someStruct struct {\n    StringVal string     `json:\"val_str\"`\n    IntVal    *int64     `json:\"val_int\"`\n}\n</code></pre>\n\n<p>I'm trying to return an instance of this struct like so, where <code>aValue</code> is an <code>int64</code> value and I'm trying to get the <code>IntVal</code> pointer to point to it:</p>\n\n<pre><code>return someStruct{IntVal: &amp;(int64(aValue))}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>cannot take the address of int64(d)\n</code></pre>\n\n<p>Any ideas how to achieve this?</p>\n"}, {"tags": ["angular", "go"], "comments": [{"owner": {"reputation": 3765, "user_id": 843443, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/07748ad3a158dfc6aee92c9bbac06b90?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/843443/jeff"}, "edited": false, "score": 0, "creation_date": 1511917593, "post_id": 47542908, "comment_id": 82044015, "body": "I think the solution is to return JSON from the go server, then handle the redirect in the angular app."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1511950006, "post_id": 47542908, "comment_id": 82056610, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/35934298/golang-how-to-redirect-to-a-url\">Golang: how to redirect to a url</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3765, "user_id": 843443, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/07748ad3a158dfc6aee92c9bbac06b90?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/843443/jeff"}, "edited": false, "score": 0, "creation_date": 1511918118, "post_id": 47543481, "comment_id": 82044122, "body": "This confirms what I was thinking. Thanks."}], "tags": [], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "is_accepted": true, "score": 3, "last_activity_date": 1511918192, "last_edit_date": 1511918192, "creation_date": 1511917706, "answer_id": 47543481, "question_id": 47542908, "link": "https://stackoverflow.com/questions/47542908/how-to-redirect-after-api-call/47543481#47543481", "title": "How to redirect after API call", "body": "<p>You can not redirect frontend client app with an API response.\nWhat you need to do is to handle this on the client side, and use your router to navigate to correct page.</p>\n\n<p>What API does:</p>\n\n<pre><code>Redirect replies to the request with a redirect to url, which may be a path relative to the request path.\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Redirect\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>Which is simple <strong>instruction</strong> for your angular client what to do. Lets say in your <strong>$http success callback</strong> you call <code>$location.url('/my/success')</code> , which would use the Angular router to \"redirect\" to <code>'/my/success'</code>.</p>\n"}], "owner": {"reputation": 3765, "user_id": 843443, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/07748ad3a158dfc6aee92c9bbac06b90?s=128&d=identicon&r=PG", "display_name": "Jeff", "link": "https://stackoverflow.com/users/843443/jeff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2502, "favorite_count": 1, "accepted_answer_id": 47543481, "answer_count": 1, "score": 2, "last_activity_date": 1511949932, "creation_date": 1511913255, "last_edit_date": 1511949932, "question_id": 47542908, "link": "https://stackoverflow.com/questions/47542908/how-to-redirect-after-api-call", "title": "How to redirect after API call", "body": "<p>I have an angular front end app and a golang api. The angular app is built (and runs fine). It makes a few calls to the go api which makes calls to an external service. After the calls to the external service, I want the frontend to redirect to a success page. I can't seem to get that to work in my Go code. </p>\n\n<p>This is what I have (and works except for the redirect):</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n    \"github.com/gin-contrib/static\"\n    \"net/http\"\n    \"io/ioutil\"\n    \"strings\"\n    \"encoding/json\"\n    \"strconv\"\n    \"net/http/cookiejar\"\n)\n\nconst BASE_ENDPOINT = \"https://external.host.com/\"\nconst FIRST_CALL_ENDPOINT = BASE_ENDPOINT + \"first\"\nconst SECOND_CALL_ENDPOINT = BASE_ENDPOINT + \"second\"\n\n\nfunc main() {\n    // create an http client with a cookie jar\n    cookieJar, _ := cookiejar.New(nil)\n    client := &amp;http.Client{\n        Jar: cookieJar,\n    }\n\n    router := gin.Default()\n    // this is the default route for the front end.  The angular app will handle\n    // all non-api calls\n    router.Use(static.Serve(\"/\", static.LocalFile(\"../frontend/dist\", true)))\n\n    // Routes\n    api := router.Group(\"/\")\n    {\n        // get post calls to this endpoint\n        api.POST(\"/my/first\", func(c *gin.Context) {\n\n            userData := c.PostForm(\"userData\")\n            rawTextBody := \"data=\" + userData\n            resp, err := client.Post(FIRST_CALL_ENDPOINT, \"text/plain\", strings.NewReader(rawTextBody))\n            if err != nil {\n                panic(err)\n            }\n            body, _ := ioutil.ReadAll(resp.Body)\n            var data map[string]interface{}\n            jsonErr := json.Unmarshal([]byte(body), &amp;data)\n            if jsonErr != nil {\n                panic(jsonErr)\n            }\n            // data comes back as a \"float64\", is converted to an int, then to a string\n            var jobId = strconv.Itoa(int(data[\"curjobId\"].(float64)))\n            moreUserData := c.PostForm(\"moreUserData\")\n            rawTextBodyCat := \"secondUserData=\" + moreUserData + \"&amp;jobid=\" + jobId\n            _, secErr := client.Post(SECOND_CALL_ENDPOINT, \"text/plain\", strings.NewReader(rawTextBodyCat))\n            if secErr != nil {\n                panic(secErr)\n            }\n            // TODO: need \"successfully submitted\" page. This already exists in the frontend angular server\n            // I can manually go to that page. ('/my/success')\n\n            // what i've tried:\n            //http.Redirect(w, r, \"/my/success\", http.StatusSeeOther)\n            //http.RedirectHandler( \"/my/success\", http.StatusSeeOther)\n\n        })\n    }\n\n    router.NoRoute(func(c *gin.Context) {\n        c.File(\"../frontend/dist/index.html\")\n    })\n\n    // Run server\n    router.Run(\":8899\")\n}\n</code></pre>\n\n<p>In my code comments, you can see I've tried <code>http.Redirect(w, r, \"/my/success\", http.StatusSeeOther)</code> but I don't know how to call it in this context. I am not setting up a route listener, but just trying to trigger a redirect on demand. Should this be handled by the angular app somehow? How can I tell the angular app \"all done\"?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1511903177, "post_id": 47540876, "comment_id": 82038997, "body": "Don&#39;t add the <code>-</code> to the flag name when you define it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511905398, "post_id": 47540876, "comment_id": 82040013, "body": "If your question is truly &quot;why can you not use double hyphens with flags&quot;, then it&#39;s not a question for SO, it&#39;s a question for whoever wrote the <code>flag</code> package. That&#39;s just how the package works, and if you use it according to its documentation, it works according to its documentation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1511905704, "post_id": 47540876, "comment_id": 82040151, "body": "BTW, the flag packages will allow you to use <code>--name</code> for flags as a compatibility feature, even if that&#39;s not how they are declared."}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 3, "last_activity_date": 1511916188, "creation_date": 1511916188, "answer_id": 47543288, "question_id": 47540876, "link": "https://stackoverflow.com/questions/47540876/issue-with-golang-flags/47543288#47543288", "title": "Issue with golang flags", "body": "<p>Try to define the flag without <code>-</code>:</p>\n\n<pre><code>func main() {\n    test := flag.String(\"test\", \"\", \"test var\")\n    flag.Parse()\n    if *test != \"\" {\n        fmt.Println(*test)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 161284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e632a431fb00dc80923383ef639f49b7?s=128&d=identicon&r=PG&f=1", "display_name": "0xbadbeef", "link": "https://stackoverflow.com/users/161284/0xbadbeef"}, "is_accepted": false, "score": 5, "last_activity_date": 1553171059, "last_edit_date": 1553171059, "creation_date": 1511953118, "answer_id": 47551162, "question_id": 47540876, "link": "https://stackoverflow.com/questions/47540876/issue-with-golang-flags/47551162#47551162", "title": "Issue with golang flags", "body": "<p>You can use double hyphens and this is documented in the package <a href=\"https://golang.org/pkg/flag/#pkg-overview\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<blockquote>\n  <p>One or two minus signs may be used; they are equivalent.</p>\n</blockquote>\n\n<p>Having declared your flags, <code>flag.Parse()</code> will try to remove one or two hyphens from the flags passed and use the remaining characters of each flag to detect whether one has been declared or not. This is done internally by the flag package in <a href=\"https://github.com/golang/go/blob/master/src/flag/flag.go#L887\" rel=\"nofollow noreferrer\"><code>parseOne()</code></a>.</p>\n\n<p>Declaring a flag with name <code>-test</code> will literally map it as is, resulting in <code>flag.Parse()</code> internally looking for the name <code>test</code> instead of <code>-test</code> which is the one you actually declared, resulting in the error you see.</p>\n\n<p>Instead, use only the name of the flag when declaring one:</p>\n\n<pre><code>test := flag.String(\"test\", \"\", \"test var\")\n</code></pre>\n\n<p>and you can use this flag with both one (<code>./main -test 1</code>) or two hyphens (<code>./main --test 2</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "is_accepted": false, "score": 0, "last_activity_date": 1604082463, "last_edit_date": 1604082463, "creation_date": 1604082133, "answer_id": 64613843, "question_id": 47540876, "link": "https://stackoverflow.com/questions/47540876/issue-with-golang-flags/64613843#64613843", "title": "Issue with golang flags", "body": "<p>For us the <code>flag</code> package is probably not the nicest thing to use here.</p>\n<p>Instead of that, you might want to try <a href=\"https://godoc.org/github.com/pborman/getopt\" rel=\"nofollow noreferrer\">getopt</a> package owned by Google, which provides the more standard command line parsing (vs the <code>flag</code> package).</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;github.com/pborman/getopt&quot;\n)\n\nfunc main() {\n    optName := getopt.StringLong(&quot;name&quot;, 'n', &quot;&quot;, &quot;Your name&quot;)\n    optHelp := getopt.BoolLong(&quot;test&quot;, 0, &quot;test var&quot;)\n    getopt.Parse()\n\n    if *optHelp {\n        getopt.Usage()\n        os.Exit(0)\n    }\n\n    fmt.Println(&quot;Hello &quot; + *optName + &quot;!&quot;)\n}\n</code></pre>\n<hr />\n<pre><code>$ ./hello --help\nUsage: hello [--test] [-n value] [parameters ...]\n     --test        test var\n -n, --name=value  Your name\n\n$ ./hello --name Bob\nHello Bob!\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 8890987, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/66c0709a0e9fc420d07e6f23a0d6a9b5?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8890987/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2857, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1604082463, "creation_date": 1511902989, "question_id": 47540876, "link": "https://stackoverflow.com/questions/47540876/issue-with-golang-flags", "title": "Issue with golang flags", "body": "<p>So recently I ran into a problem with Golang flags and was curious to know if this is as intended, if its a problem or if I'm being a blithering idiot and there is a very simple answer to this.</p>\n\n<p>So using the following code:</p>\n\n<pre><code>func main() {\n    test := flag.String(\"-test\", \"\", \"test var\")\n    flag.Parse()\n    if *test != \"\" {\n        fmt.Println(*test)\n    }\n}\n</code></pre>\n\n<p>And then run it using the following command <code>./main -test 1</code></p>\n\n<p>You get the following autogenerated error:</p>\n\n<pre><code>flag provided but not defined: -test\nUsage of ./main:\n  --test string\n        test var\n</code></pre>\n\n<p>The same happens if you then use <code>./main --test 1</code>, you get the same error. The only way I have found around this is to change the flag definition to be  <code>test := flag.String(\"test\", \"\", \"test var\")</code> and then run it with <code>./main -test 1</code>.</p>\n\n<p>So my question is why can you not use double hyphens with flags? If you can, where did I go wrong when doing this? </p>\n"}, {"tags": ["bash", "shell", "go"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 5169717, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4552faa86f3364cafc2fe9f1e3b1e337?s=128&d=identicon&r=PG&f=1", "display_name": "v8rs", "link": "https://stackoverflow.com/users/5169717/v8rs"}, "edited": false, "score": 0, "creation_date": 1511904638, "post_id": 47541091, "comment_id": 82039680, "body": "Thanks for your answer. I have updated the question. Indeed if I do all this from a tty shell it works but it&#39;s not the case. I apologise If I did not explain well"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": false, "score": 2, "last_activity_date": 1511903877, "creation_date": 1511903877, "answer_id": 47541091, "question_id": 47540536, "link": "https://stackoverflow.com/questions/47540536/using-go-to-spawn-a-shell-with-a-tty-from-nc-e-bin-bash/47541091#47541091", "title": "Using Go to spawn a shell with a TTY from &quot;nc -e /bin/bash&quot;", "body": "<p>Your program works fine for me.  I put some error checking in and an extra print statement which should make what is happening clearer.  You are getting an interactive shell, it just looks <strong>exactly</strong> like your previous shell.</p>\n\n<pre><code>$ go run Go/shell.go \n$ # whoa another shell\n$ exit\nexit\nexiting\n$ # back again\n$ \n</code></pre>\n\n<p>Here is the revised program</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    shell := exec.Command(\"/bin/bash\")\n    shell.Stdout = os.Stdout\n    shell.Stdin = os.Stdin\n    shell.Stderr = os.Stderr\n    err := shell.Run()\n    if err != nil {\n        log.Fatalf(\"command failed: %v\", err)\n    }\n    fmt.Printf(\"exiting\\n\")\n}\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 5169717, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4552faa86f3364cafc2fe9f1e3b1e337?s=128&d=identicon&r=PG&f=1", "display_name": "v8rs", "link": "https://stackoverflow.com/users/5169717/v8rs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511905305, "creation_date": 1511901494, "last_edit_date": 1511905305, "question_id": 47540536, "link": "https://stackoverflow.com/questions/47540536/using-go-to-spawn-a-shell-with-a-tty-from-nc-e-bin-bash", "title": "Using Go to spawn a shell with a TTY from &quot;nc -e /bin/bash&quot;", "body": "<p>I want to escape a restricted shell spawning a bash shell via Go. In other words, I want to do this but using Go:</p>\n\n<pre><code>python -c 'import pty; pty.spawn(\"/bin/bash\")'\n</code></pre>\n\n<p>I am totally new to Go. I have tried this (following the answer in this question <a href=\"https://stackoverflow.com/questions/38485656/go-how-to-spawn-a-bash-shell\">Go: How to spawn a bash shell</a>) but nothing happens:</p>\n\n<pre><code>package main\n\nimport \"os\"\nimport \"os/exec\"\n\nfunc main() {\n    shell := exec.Command(\"/bin/bash\")\n    shell.Stdout = os.Stdout\n    shell.Stdin = os.Stdin\n    shell.Stderr = os.Stderr\n    shell.Run()\n}\n</code></pre>\n\n<p>Also if I add the  <code>fmt.Println(\"hello\")</code> line at the end of the main function nothing is printed</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Maybe I did not expalined well. What I am trying to achieve it's to spawn a shell gotten a restricted shell. This is what I did:\nListener:</p>\n\n<pre><code>nc.traditional -l -p 8080 -e /bin/bash\n</code></pre>\n\n<p>Connects to listener:  And I exec the code here</p>\n\n<pre><code>nc.traditional localhost 8080 -v\n</code></pre>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1511897990, "post_id": 47539607, "comment_id": 82036216, "body": "Sounds like a problem with mysql."}, {"owner": {"reputation": 4031, "user_id": 4142087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/100004205677206/picture?type=large", "display_name": "Anton Shkurenko", "link": "https://stackoverflow.com/users/4142087/anton-shkurenko"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1511898097, "post_id": 47539607, "comment_id": 82036269, "body": "@Flimzy strange thing is that mysql works from CLI or in another way and only this one fails"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1511898178, "post_id": 47539607, "comment_id": 82036300, "body": "Try to use tcpdump to capture what is sent and recived back from the mysql server."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1511898858, "post_id": 47539607, "comment_id": 82036641, "body": "I&#39;ve had similar problems w/ psql, usually it had to do with a transaction currently ongoing so the db waits on all other requests."}, {"owner": {"reputation": 4031, "user_id": 4142087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/100004205677206/picture?type=large", "display_name": "Anton Shkurenko", "link": "https://stackoverflow.com/users/4142087/anton-shkurenko"}, "reply_to_user": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1511899026, "post_id": 47539607, "comment_id": 82036751, "body": "@BenjaminKadish problem is, that this is simple init function, and I don&#39;t run any queries except Ping(), also I restarted mysql server, restarted laptop and go program :|"}], "owner": {"reputation": 4031, "user_id": 4142087, "user_type": "registered", "accept_rate": 92, "profile_image": "https://graph.facebook.com/100004205677206/picture?type=large", "display_name": "Anton Shkurenko", "link": "https://stackoverflow.com/users/4142087/anton-shkurenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 680, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511900445, "creation_date": 1511897938, "last_edit_date": 1511900445, "question_id": 47539607, "link": "https://stackoverflow.com/questions/47539607/go-mysql-driver-hangs-on-connect", "title": "Go mysql driver hangs on connect", "body": "<p>I met some weird situation with such simple code:</p>\n\n<pre><code>func InitDatabase(dataSourceName string) {\n\n    var err error\n    DBCon, err = sql.Open(\"mysql\", dataSourceName)\n\n    if err != nil {\n        log.Panic(err)\n    }\n\n    log.Println(\"Ping...\")\n\n    if err = DBCon.Ping(); err != nil { // &lt;- it hangs here\n        log.Println(\":(\")\n    }\n\n    log.Println(\":)\")\n}\n</code></pre>\n\n<p>I debugged and found, that it locks goroutine in this line (fd_poll_runtime.go, line #85), looks like it even doesn't connect:</p>\n\n<pre><code>res := runtime_pollWait(pd.runtimeCtx, mode)\n</code></pre>\n\n<p>It can wait here for ages, my mac becomes very hot.</p>\n\n<p>I made a small change:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), time.Second)\ndefer cancel()\nif err = DBCon.PingContext(ctx); err != nil {\n    log.Println(\":(\")\n}\n\nlog.Println(\":)\")\n</code></pre>\n\n<p>And it still hangs and timeout doesn't work.</p>\n\n<p>Problem is, that it worked yesterday (and, funny, it works on my friend's machine, same params) and now it doesn't even after reboot and after reinstalling mysql (which works perfectly in terminal/goland/mysqlworkbench).</p>\n\n<p>Go version 1.9, mysql driver: \"github.com/go-sql-driver/mysql\", mysql version: 5.7.20 Homebrew, macos version: High Sierra 10.13.1, I host mysql on localhost, port 3306.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>It finally worked. I copied init code to the clean project and it worked there. I started to comment out code, to find where is the problem. I found that I have this code in the imported package. Even if code from this package executes after database ping, but init code executes before and somehow it blocks <code>db.Ping()</code>:</p>\n\n<pre><code>func init() {\n    for i := 1; i &lt;= maxWorkers; i++ {\n        go func(i int) {\n            for {\n                select {\n                case j, ok := &lt;-jobs:\n                    if ok {\n                        j.invoke()\n                    } else {\n                        // loop\n                    }\n                default:\n                    // loop\n                }\n            }\n        }(i)\n    }\n}\n</code></pre>\n\n<p>I rewrote method name and executed it after database ping and everything worked. </p>\n\n<p>I don't know why it happened, but if you have the answer, feel free to post it here.</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8544855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2c6a7c624131b1b260e48b4b95a45b4?s=128&d=identicon&r=PG&f=1", "display_name": "alrx", "link": "https://stackoverflow.com/users/8544855/alrx"}, "is_accepted": false, "score": 1, "last_activity_date": 1511974802, "creation_date": 1511974802, "answer_id": 47557977, "question_id": 47539442, "link": "https://stackoverflow.com/questions/47539442/gorm-and-relationships/47557977#47557977", "title": "Gorm and relationships", "body": "<p>See the section <a href=\"http://jinzhu.me/gorm/associations.html#has-many\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/associations.html#has-many</a></p>\n\n<p>I assume TickerModel has many TickerDataModel. The following model setup should do the trick.</p>\n\n<pre><code>type TickerModel struct {\n    gorm.Model\n    Name        string\n    Symbol      string\n    TickerData  []tickerdata.TickerDataModel\n}\n\n\ntype TickerDataModel struct {\n    gorm.Model\n    Rank           int\n    TickerModelID  uint\n}\n</code></pre>\n\n<p>Create a relation with (<a href=\"http://jinzhu.me/gorm/crud.html#associations\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/crud.html#associations</a>)</p>\n\n<pre><code>tickerModel := TickerModel{\n    Name:       \"foo\",\n    Symbol:     \"bar\",\n    TickerData: []TickerDataModel{\n        {Rank: \"1\"},\n        {Rank: \"2\"},\n    },\n}\n\ndb.Create(&amp;tickerModel)\n</code></pre>\n\n<p>Load TickerModels and TickerDataModels in the TickerData slices with (<a href=\"http://jinzhu.me/gorm/crud.html#preloading-eager-loading\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/crud.html#preloading-eager-loading</a>)</p>\n\n<pre><code>db.Preload(\"TickerData\").Find(&amp;tickerModels)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "is_accepted": true, "score": 0, "last_activity_date": 1512202635, "creation_date": 1512202635, "answer_id": 47605934, "question_id": 47539442, "link": "https://stackoverflow.com/questions/47539442/gorm-and-relationships/47605934#47605934", "title": "Gorm and relationships", "body": "<p>The solution that made it work <a href=\"http://jinzhu.me/gorm/database.html#migration\" rel=\"nofollow noreferrer\">Link</a></p>\n\n<pre><code>db.Model(&amp; TickerDataModel{}).AddForeignKey(\"ticker_id\", \"tickers(id)\", \"RESTRICT\", \"RESTRICT\")\n</code></pre>\n"}], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 0, "accepted_answer_id": 47605934, "answer_count": 2, "score": 1, "last_activity_date": 1512202635, "creation_date": 1511897351, "question_id": 47539442, "link": "https://stackoverflow.com/questions/47539442/gorm-and-relationships", "title": "Gorm and relationships", "body": "<p>I'm new to Golang and even more to Gorm. I'm trying to get a one-to-many relationship going. Basically there is one ticker symbol and his many ticker data. Everything works well, except that I cannot get the relationship on the models going. I just need a little hint on how to do that (best practise welcome).</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/khwerhahn/quoteworker/common\"\n    \"github.com/khwerhahn/quoteworker/tickerdata\"\n    \"github.com/khwerhahn/quoteworker/ticker\"\n)\n\n// Migrate database\nfunc Migrate(db *gorm.DB) {\n    ticker.AutoMigrate()\n    tickerdata.AutoMigrate()\n}\n\nfunc main() {\n    db := common.Init()\n    Migrate(db)\n    defer db.Close()\n    //// more code....\n}\n</code></pre>\n\n<p>Lives in it own file and package.\n<code>model.go</code>for ticker</p>\n\n<pre><code>package ticker\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/khwerhahn/quoteworker/common\"\n)\n\ntype TickerModel struct {\n    gorm.Model\n    Name   string `gorm:\"column:name;unique_index\"`\n    Symbol string `gorm:\"column:symbol;unique_index\"`\n}\n\n// AutoMigrate the schema of database if needed\nfunc AutoMigrate() {\n    db := common.GetDB()\n    db.AutoMigrate(&amp;TickerModel{})\n}\n</code></pre>\n\n<p>Lives in it own file and package.\n<code>model.go</code> for tickerdata</p>\n\n<pre><code>package tickerdata\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    \"github.com/khwerhahn/quoteworker/common\"\n    \"github.com/khwerhahn/quoteworker/ticker\"\n)\n\ntype TickerDataModel struct {\n    gorm.Model\n    Rank                           int     `gorm:\"column:rank\"`\n    // left out some stuff....\n    TickerModel                     ticker.TickerModel\n    TickerModelID                   uint `gorm:\"column:tickerId\"`\n}\n\n// AutoMigrate the schema of database if needed\nfunc AutoMigrate() {\n    db := common.GetDB()\n    db.AutoMigrate(&amp;TickerDataModel{})\n}\n</code></pre>\n\n<p>Thx</p>\n"}, {"tags": ["go", "reflection", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511894694, "post_id": 47538723, "comment_id": 82034395, "body": "The method signature is <code>HandleIncomingMessage(IncomingMessage) error</code>. You can&#39;t use a different signature, but why do you need to at all?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1511894896, "post_id": 47538723, "comment_id": 82034501, "body": "The compiler&#39;s complaint is valid. TelegramService is not able to handle <i>any</i> IncomingMessage, only some and thus does not satisfy the MessagingService interface."}, {"owner": {"reputation": 1206, "user_id": 2596734, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Qd1p8.jpg?s=128&g=1", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2596734/roemer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511895689, "post_id": 47538723, "comment_id": 82034941, "body": "@JimB Thanks sir. If I use IncomingMessage, can I just use it as if it were a telegram.Message?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511895865, "post_id": 47538723, "comment_id": 82035040, "body": "@RoemerBakker: I don&#39;t understand. If you want it to be an interface, then you use it through its interface methods. You can always assert it to a concrete type, but then why have the interface in the first place?"}, {"owner": {"reputation": 1206, "user_id": 2596734, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Qd1p8.jpg?s=128&g=1", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2596734/roemer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511896044, "post_id": 47538723, "comment_id": 82035141, "body": "@JimB This function is specific to Telegram. However, I&#39;ll be implementing other messaging services along side logic to store incoming message in a database. In this case I want the IncomingMessage to be an interface so that I can write general stuff for the db storage. Though again, those incoming messages will have specific functionality as well"}, {"owner": {"reputation": 5380, "user_id": 146620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba0c9119010302832e1d129b38228b?s=128&d=identicon&r=PG", "display_name": "Graham King", "link": "https://stackoverflow.com/users/146620/graham-king"}, "edited": false, "score": 0, "creation_date": 1511897763, "post_id": 47538723, "comment_id": 82036119, "body": "Does it help if you make your methods have a pointer receiver? <code>func (s *TelegramService) Han..</code> and <code>func (m *Message) Send()</code>."}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1511907070, "post_id": 47538723, "comment_id": 82040722, "body": "What does actual error say? Could be related to this <a href=\"https://stackoverflow.com/questions/40823315/go-x-does-not-implement-y-method-has-a-pointer-receiver?noredirect=1&amp;lq=1\" title=\"go x does not implement y method has a pointer receiver\">stackoverflow.com/questions/40823315/&hellip;</a>. As Graham mentions you might need to change just this <code>func (m *Message) Send() error {</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1511905963, "last_edit_date": 1511905963, "creation_date": 1511905536, "answer_id": 47541432, "question_id": 47538723, "link": "https://stackoverflow.com/questions/47538723/cannot-use-implementation-of-interface-as-argument-to-func-that-wants-interface/47541432#47541432", "title": "Cannot use implementation of interface as argument to func that wants interface", "body": "<p><code>HandleIncomingMessage</code> must take an <code>IncomingMessage</code> argument since that's the way the interface is defined. You can't define an implementation of <code>HandleIncomingMessage</code> that takes some other type as the argument, even if that type implements <code>IncomingMessage</code>. You can define your function to take <code>IncomingMessage</code> and convert that to <code>*telegram.Message</code> using a type assertion:</p>\n\n<pre><code>func (s TelegramService) HandleIncomingMessage(im IncomingMessage) error {\n    msg := im.(*telegram.Message)\n    return nil\n}\n</code></pre>\n\n<p>I'm assuming you actually want to be using a pointer to <code>telegram.Message</code>. If so, you need to change the definition of the <code>Send</code>  method to take a pointer receiver.</p>\n"}], "owner": {"reputation": 1206, "user_id": 2596734, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Qd1p8.jpg?s=128&g=1", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2596734/roemer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1511905963, "creation_date": 1511894524, "last_edit_date": 1511897913, "question_id": 47538723, "link": "https://stackoverflow.com/questions/47538723/cannot-use-implementation-of-interface-as-argument-to-func-that-wants-interface", "title": "Cannot use implementation of interface as argument to func that wants interface", "body": "<p>I'm getting the following error: </p>\n\n<pre><code>./main.go:31: cannot use telegramService (type messaging.TelegramService) as type mypackage.MessagingService in argument to mypackage.RegisterMessagingService:\n    messaging.TelegramService does not implement mypackage.MessagingService (wrong type for HandleIncomingMessage method)\n        have HandleIncomingMessage(telegram.Message) error\n        want HandleIncomingMessage(mypackage.IncomingMessage) error\n</code></pre>\n\n<p>I have an interface that describes a messaging service like Telegram or WhatsApp, and an interface that describes an incoming message from one of those services:</p>\n\n<pre><code>// IncomingMessage is a message that comes in on a messaging service\ntype IncomingMessage interface {\n    Send() error\n}\n\n// MessagingService is a service on which messages can be send (like Telegram or FB Messenger)\ntype MessagingService interface {\n    Start()\n    HandleIncomingMessage(IncomingMessage) error\n    GetHTTPHandler() http.HandlerFunc\n    GetCommands() []MessagingCommand\n}\n</code></pre>\n\n<p>The first implementation of <code>MessagingService</code> is for Telegram. The issue is the <code>HandleIncomingMessage</code> function, which currently doesn't really do anything and just looks like this:</p>\n\n<pre><code>// HandleIncomingMessage will take an incoming message and repond to it\nfunc (s TelegramService) HandleIncomingMessage(msg *telegram.Message) error {\n\n    return nil\n}\n</code></pre>\n\n<p>The issue is that this function accepts a <code>telegram.Message</code>, which the compiler says doesn't comply with the interface. The thing is, that <code>telegram.Message</code> is an <em>implementation</em> of <code>IncomingMessage</code>:</p>\n\n<pre><code>// Message is a Telegram message\ntype Message struct {\n    // Added the line below at some point, but it didn't work without it either\n    mypackage.IncomingMessage\n    MessageID uint64 `json:\"message_id\"`\n    FirstName string `json:\"first_name\"`\n    Username  string `json:\"username\"`\n    Date      uint64 `json:\"date\"`\n    Text      string `json:\"text\"`\n    Chat      Chat   `json:\"chat\"`\n    From      User   `json:\"from\"`\n}\n\n// Send will take m and send it\nfunc (m Message) Send() error {\n    // Do stuff\n\n    return nil\n}\n</code></pre>\n\n<p>Initially <code>IncomingMessage</code> was an empty interface, which is where I first noticed the issue. I tried adding the function <code>Send()</code> which I was going to add anyway, as I thought maybe just giving it any struct wouldnt't work. However, I'm still getting this error. </p>\n\n<p>I don't see any reason why <code>telegram.Message</code> doesn't implement the interface, it's pretty straight forward.</p>\n\n<p>Can anyone explain why this doesn't work?</p>\n\n<p>PS: My package isn't actually called <code>mypackage</code>, changed for clarity</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 14, "last_activity_date": 1511892061, "creation_date": 1511892061, "answer_id": 47538114, "question_id": 47537379, "link": "https://stackoverflow.com/questions/47537379/go-test-fails-with-cant-load-package-build-constraints-exclude-all-go-files/47538114#47538114", "title": "go test fails with &quot;can&#39;t load package build constraints exclude all Go files&quot;", "body": "<p>You will only get that error if <em>all</em> the files in the package are excluded by your build constraints, not just the test files. If that's what you want, just add a single package file with no code and the package will still be able to be loaded. For example, many packages put their package level docs in a separate file, which you could use to always have a valid package:</p>\n\n<pre><code>// Package foo does foo\npackage foo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 5981590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cce6ff2e2b80392134e9b686af851bee?s=128&d=identicon&r=PG&f=1", "display_name": "bharat nc", "link": "https://stackoverflow.com/users/5981590/bharat-nc"}, "is_accepted": false, "score": 0, "last_activity_date": 1583292104, "creation_date": 1583292104, "answer_id": 60518602, "question_id": 47537379, "link": "https://stackoverflow.com/questions/47537379/go-test-fails-with-cant-load-package-build-constraints-exclude-all-go-files/60518602#60518602", "title": "go test fails with &quot;can&#39;t load package build constraints exclude all Go files&quot;", "body": "<p>For whatever it's worth : I was seeing similar errors while building my code. In my case, my main file had // +build go1.13 at the top of it and I was trying to get the file built using go1.12.x. Removing +build go1.13 fixed the issue. </p>\n"}], "owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9637, "favorite_count": 0, "accepted_answer_id": 47538114, "answer_count": 2, "score": 11, "last_activity_date": 1583292104, "creation_date": 1511889473, "question_id": 47537379, "link": "https://stackoverflow.com/questions/47537379/go-test-fails-with-cant-load-package-build-constraints-exclude-all-go-files", "title": "go test fails with &quot;can&#39;t load package build constraints exclude all Go files&quot;", "body": "<p>When I run this command</p>\n\n<pre><code>go test -tags integration $(go list ./... | grep -v /vendor/)\n</code></pre>\n\n<p>go fails with this for some packages that has all tests marked with <code>// +build !integration</code></p>\n\n<pre><code>can't load package: build constraints exclude all Go files\n</code></pre>\n\n<p>Is there a way I can make <code>go test</code> ignore those packages in this case, instead of failing?  Thanks</p>\n"}, {"tags": ["google-app-engine", "docker", "go", "bitbucket-pipelines", "google-app-engine-go"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1511885538, "post_id": 47535695, "comment_id": 82028956, "body": "A typical problem causing failures for scripts automatically executed is lacking some environment var which, when successfully executed by hand, is somehow set, either manually or via some .rc file. The <code>($GOROOT not set)</code> in your error msg could be hinting at this. Compare your environments in the 2 cases."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1511885784, "post_id": 47535695, "comment_id": 82029119, "body": "I&#39;m not a go user, so I&#39;m unsure about this: your app appears to have some external dependencies (/go/src/github.com/gorilla/context) which <i>might</i> already be available on the system where you deploy manually, but might need to be pulled explicitly in the bitbucket pipeline."}, {"owner": {"reputation": 945, "user_id": 487016, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/daRGK.jpg?s=128&g=1", "display_name": "ephilip", "link": "https://stackoverflow.com/users/487016/ephilip"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1511886783, "post_id": 47535695, "comment_id": 82029826, "body": "@DanCornilescu so I thought that too, and tried to set the GOROOT myself.  however, the lines &quot;cannot find package &quot;github.com/gorilla/context&quot; in any of:     ($GOROOT not set)     /go/src/github.com/gorilla/context (from $GOPATH) tells me that it&#39;s actually looking (and finding) something in my GOPATH."}, {"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 1, "creation_date": 1511893331, "post_id": 47535695, "comment_id": 82033731, "body": "Is <code>github.com&#47;gorilla&#47;context</code> only used within your test files?  If so, <code>go get</code>, will not by default get test dependencies.  What if you exclusively add <code>go get github.com&#47;gorilla&#47;context</code> to your pipeline script?"}, {"owner": {"reputation": 945, "user_id": 487016, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/daRGK.jpg?s=128&g=1", "display_name": "ephilip", "link": "https://stackoverflow.com/users/487016/ephilip"}, "reply_to_user": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1511899523, "post_id": 47535695, "comment_id": 82037019, "body": "@PassKit it was only used within Gorilla Mux&#39;s package.  Your fix worked, however (I swear i tried it before, and it didn&#39;t work) by adding  go get github.com/gorilla/context  to my pipeline.  This is weird behaviour because I didn&#39;t have it in my local machine either.  Anyways If you post your comment as an answer I can mark it as the correct one.   Thanks a ton"}], "answers": [{"tags": [], "owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "is_accepted": false, "score": 1, "last_activity_date": 1511932412, "last_edit_date": 1511932412, "creation_date": 1511919470, "answer_id": 47543698, "question_id": 47535695, "link": "https://stackoverflow.com/questions/47535695/bitbucket-pipeline-deploy-issue-to-google-app-engine/47543698#47543698", "title": "Bitbucket Pipeline Deploy issue to Google App Engine", "body": "<p>Is <code>github.com/gorilla/context</code> only used within your test files? </p>\n\n<p><code>go get</code>, will not by default get test dependencies. </p>\n\n<p>You can exclusively add <code>go get github.com/gorilla/context</code> to your pipeline script.</p>\n"}], "owner": {"reputation": 945, "user_id": 487016, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/daRGK.jpg?s=128&g=1", "display_name": "ephilip", "link": "https://stackoverflow.com/users/487016/ephilip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1511932412, "creation_date": 1511884409, "last_edit_date": 1511884849, "question_id": 47535695, "link": "https://stackoverflow.com/questions/47535695/bitbucket-pipeline-deploy-issue-to-google-app-engine", "title": "Bitbucket Pipeline Deploy issue to Google App Engine", "body": "<p>I'm trying to deploy a golang app to app engine.  Now I'm able to do it via the gcloud CLI on my mac, and this works fine (running gcloud app deploy app.yaml).  However, I'm getting the following error on Bitbucket Pipelines:</p>\n\n<pre><code>+ gcloud --quiet --verbosity=error app deploy app.yaml --promote\nYou are about to deploy the following services:\n - some-project/default/20171128t070345 (from [/go/src/bitbucket.org/acme/some-app/app.yaml])\n     Deploying to URL: [https://project-url.appspot.com]\n\nBeginning deployment of service [default]...\nERROR: (gcloud.app.deploy) Staging command [/tmp/google-cloud-sdk/platform/google_appengine/goroot/bin/go-app-stager /go/src/bitbucket.org/acme/some-app/app.yaml /tmp/tmpLbUCA5] failed with return code [1].\n\n------------------------------------ STDOUT ------------------------------------\n------------------------------------ STDERR ------------------------------------\n2017/11/28 07:03:45 failed analyzing /go/src/bitbucket.org/acme/some-app: cannot find package \"github.com/gorilla/context\" in any of:\n    ($GOROOT not set)\n    /go/src/github.com/gorilla/context (from $GOPATH)\nGOPATH: /go\n--------------------------------------------------------------------------------\n</code></pre>\n\n<p>Here's my bitbucket-pipelines.yaml content:</p>\n\n<pre><code>image: golang:onbuild\n\npipelines:\n  branches:\n    develop:\n    - step:\n        script: # Modify the commands below to build your repository.\n          # Downloading the Google Cloud SDK\n          - curl -o /tmp/google-cloud-sdk.tar.gz https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-155.0.0-linux-x86_64.tar.gz\n          - tar -xvf /tmp/google-cloud-sdk.tar.gz -C /tmp/\n          - /tmp/google-cloud-sdk/install.sh -q\n          - source /tmp/google-cloud-sdk/path.bash.inc\n          - PACKAGE_PATH=\"${GOPATH}/src/bitbucket.org/${BITBUCKET_REPO_OWNER}/${BITBUCKET_REPO_SLUG}\"\n          - mkdir -pv \"${PACKAGE_PATH}\"\n          - tar -cO --exclude-vcs --exclude=bitbucket-pipelines.yml . | tar -xv -C \"${PACKAGE_PATH}\"\n          - cd \"${PACKAGE_PATH}\"\n          - go get -v\n          - go get -u github.com/golang/dep/cmd/dep\n          - go build -v\n          - go install\n          - go test -v\n          - echo $GOOGLE_CLIENT_SECRET | base64 --decode --ignore-garbage &gt; ./gcloud-api-key.json\n          - gcloud auth activate-service-account --key-file gcloud-api-key.json\n          - gcloud components install app-engine-go\n          #- GOROOT=\"/tmp/go\"\n          # Linking to the Google Cloud project\n          - gcloud config set project $CLOUDSDK_CORE_PROJECT\n          # Deploying the application\n          - gcloud --quiet --verbosity=error app deploy app.yaml --promote\n          - echo $GCLOUD_API_KEYFILE | base64 --decode --ignore-garbage &gt; ./gcloud-api-key.json\n          #- gcloud auth activate-service-account --key-file gcloud-api-key.json\n</code></pre>\n\n<p>And, though it shouldn't be an issue since deploying to the cloud works fine, my app.yaml file as well:</p>\n\n<pre><code>runtime: go\napi_version: go1\n\nhandlers:\n- url: /.*\n  script: _go_app\n\n\nnobuild_files:\n- vendor\n\nskip_files:\n- |\n  ^(.*/)?(\n  (#.*#)|\n  (.*\\.mapping)|\n  (.*\\.po)|\n  (.*\\.pot)|\n  (.*\\.py[co])|\n  (.*\\.sw?)|\n  (.*\\.yaml)|\n  (.*_test\\.go)|\n  (.*~)|\n  (LICENSE)|\n  (Makefile.*)|\n  (\\..*)|\n  (vendor/.*)|\n  )$\n</code></pre>\n\n<p>I'm fairly certain my issue is with how my bitbucket yaml file or the docker image I'm starting with, but I'm stuck.  Any thoughts?</p>\n"}, {"tags": ["mysql", "go", "orm", "beego"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1511884638, "post_id": 47535543, "comment_id": 82028309, "body": "First, you should use <code>BOOL</code> in MySQL if your type corresponds to a boolean value (as it appears to, based on the name). Once you&#39;ve made that change, hopefully the answer to your actual question will be obvious."}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1511884935, "post_id": 47535543, "comment_id": 82028537, "body": "But I think  I can&#39;t change the type. The old Java program is running now. I&#39;m not sure the old program will run correctly after my change."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1511885040, "post_id": 47535543, "comment_id": 82028619, "body": "If you&#39;re required to use that schema, that sucks, but go with it. But my comment should still help answer your question."}, {"owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1511885310, "post_id": 47535543, "comment_id": 82028814, "body": "OK\uff0clet me have a try under the test conditon. Thank you."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1573207625, "last_edit_date": 1573207625, "creation_date": 1511885650, "answer_id": 47536138, "question_id": 47535543, "link": "https://stackoverflow.com/questions/47535543/mysqls-bit-type-maps-to-which-go-type/47536138#47536138", "title": "MySQL&#39;s bit type maps to which Go type?", "body": "<blockquote>\n  <p>So which Go type should I use?</p>\n</blockquote>\n\n<p>Generally, this depends on how you're using the data more than how it's stored. As you eluded to, you tried using it as a <code>Bool</code> (which makes sense) but got an error.</p>\n\n<p>The problem is that MySQL expresses a <code>BIT</code> differently than a <code>BOOL</code>, and the Go MySQL driver expects a MySQL <code>BOOL</code>.  You can fix this by using a custom type that implements the <a href=\"https://golang.org/pkg/database/sql/#Scanner\" rel=\"nofollow noreferrer\">sql.Scanner</a> interface.  Since you presumably have only two (or maybe three, if you count <code>NULL</code>) inputs, it should be fairly easy. Note this code is incomplete and untested. It is meant to serve as a guide, not a copy-and-paste solution.</p>\n\n<pre><code>type MyBool bool\n\nfunc (b *MyBool) Scan(src interface{}) error {\n    str, ok := src.(string)\n    if !ok {\n        return fmt.Errorf(\"Unexpected type for MyBool: %T\", src)\n    }\n    switch str {\n    case \"\\x00\":\n        v := false\n        *b = v\n    case \"\\x01\":\n        v := true\n        *b = v\n    }\n    return nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 351, "user_id": 3920963, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f2319256410e1470bedb36b92d994b08?s=128&d=identicon&r=PG&f=1", "display_name": "udayanga", "link": "https://stackoverflow.com/users/3920963/udayanga"}, "edited": false, "score": 0, "creation_date": 1611105673, "post_id": 58024364, "comment_id": 116342042, "body": "The Scan func can be used as follows;  var valOrg interface{} var valBB types.BitBool var val bool .... err = query.Scan(..., &amp;valOrg,...) .... err = valBB.Scan(valOrg) val = bool(valBB)"}], "tags": [], "owner": {"reputation": 686, "user_id": 1656501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/bw1rj.png?s=128&g=1", "display_name": "Tarmo", "link": "https://stackoverflow.com/users/1656501/tarmo"}, "is_accepted": false, "score": 5, "last_activity_date": 1568966936, "creation_date": 1568966936, "answer_id": 58024364, "question_id": 47535543, "link": "https://stackoverflow.com/questions/47535543/mysqls-bit-type-maps-to-which-go-type/58024364#58024364", "title": "MySQL&#39;s bit type maps to which Go type?", "body": "<p>Sqlx has created also a custom bool datatype for such situations and it works fine. <a href=\"https://github.com/jmoiron/sqlx/commit/581097f1be765de629ca6a6e0110d64e98b13267\" rel=\"noreferrer\">Link to related code</a></p>\n\n<pre><code>// BitBool is an implementation of a bool for the MySQL type BIT(1).\n// This type allows you to avoid wasting an entire byte for MySQL's boolean type TINYINT.\ntype BitBool bool\n\n// Value implements the driver.Valuer interface,\n// and turns the BitBool into a bitfield (BIT(1)) for MySQL storage.\nfunc (b BitBool) Value() (driver.Value, error) {\n    if b {\n        return []byte{1}, nil\n    } else {\n        return []byte{0}, nil\n    }\n}\n\n// Scan implements the sql.Scanner interface,\n// and turns the bitfield incoming from MySQL into a BitBool\nfunc (b *BitBool) Scan(src interface{}) error {\n    v, ok := src.([]byte)\n    if !ok {\n        return errors.New(\"bad []byte type assertion\")\n    }\n    *b = v[0] == 1\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6140215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187fbdfe3268ea0ffa2e4fa520203646?s=128&d=identicon&r=PG&f=1", "display_name": "JICHUN", "link": "https://stackoverflow.com/users/6140215/jichun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3002, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573207625, "creation_date": 1511883947, "last_edit_date": 1573207580, "question_id": 47535543, "link": "https://stackoverflow.com/questions/47535543/mysqls-bit-type-maps-to-which-go-type", "title": "MySQL&#39;s bit type maps to which Go type?", "body": "<p>I used Java before, so some columns' type in database table is <code>bit(1)</code>. But now I want to use beego to rebuild my project and I don't want to alter my database table (need do much). I use beego's orm in my project. So which Go type should I use?</p>\n\n<p>Table like this and the deleted column has the question:</p>\n\n<pre><code>+--------------+--------------+------+-----+---------+-------+\n| Field        | Type         | Null | Key | Default | Extra |\n+--------------+--------------+------+-----+---------+-------+\n| id           | varchar(255) | NO   | PRI | NULL    |       |\n| created_time | datetime     | YES  |     | NULL    |       |\n| deleted      | bit(1)       | NO   |     | NULL    |       |\n| updated_time | datetime     | YES  |     | NULL    |       |\n| icon_class   | varchar(255) | YES  |     | NULL    |       |\n| mark         | varchar(255) | YES  |     | NULL    |       |\n| name         | varchar(255) | YES  |     | NULL    |       |\n| parent       | varchar(255) | YES  |     | NULL    |       |\n+--------------+--------------+------+-----+---------+-------+\n</code></pre>\n\n<p>go struct like this:</p>\n\n<pre><code>type BaseModel struct {\n    Id          string           `orm:\"pk\";form:\"id\"`\n    CreatedTime time.Time        `orm:\"auto_now_add;type(datetime)\";form:\"-\"`\n    UpdatedTime time.Time        `orm:\"auto_now;type(datetime)\";form:\"-\"`\n    Deleted     bool `form:\"-\"`\n}\n</code></pre>\n\n<p>When I use bool in my code, the error like this:</p>\n\n<pre><code>`[0]` convert to `*orm.BooleanField` failed, field: shareall-go/models.Category.BaseModel.Deleted err: strconv.ParseBool: parsing \"\\x00\": invalid syntax\n</code></pre>\n"}, {"tags": ["go", "ginkgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511884823, "post_id": 47535538, "comment_id": 82028453, "body": "Related: <a href=\"https://stackoverflow.com/questions/23205419/how-do-you-print-in-a-go-test-using-the-testing-package\" title=\"how do you print in a go test using the testing package\">stackoverflow.com/questions/23205419/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 2, "last_activity_date": 1511885418, "creation_date": 1511885418, "answer_id": 47536052, "question_id": 47535538, "link": "https://stackoverflow.com/questions/47535538/go-test-prints-output-only-after-tests-have-finished/47536052#47536052", "title": "go test prints output only after tests have finished", "body": "<p>Use the verbose flag on go test to see output of log or print statements as tests are run. </p>\n\n<pre><code>go test -v \n</code></pre>\n"}], "owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1511885418, "creation_date": 1511883933, "question_id": 47535538, "link": "https://stackoverflow.com/questions/47535538/go-test-prints-output-only-after-tests-have-finished", "title": "go test prints output only after tests have finished", "body": "<p>I noticed that <code>go test</code> seems to print to stdout after tests have finished.  </p>\n\n<p>I'm not sure if this is <code>go test</code>'s issue, or because I am using <a href=\"https://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\">ginkgo</a> as well.  </p>\n\n<p>Does anyone know how to make it print output as the tests run?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511884985, "post_id": 47535474, "comment_id": 82028582, "body": "You could create a new RGBA image with the same bounds, iterate the YCbCr image pixel by pixel using <code>.At()</code> (which returns an RGBA <code>Color</code> value), and copy it to the RGBA image. Posting as a comment because I&#39;m really hoping there&#39;s a better answer out there for you from someone who has used the <code>image</code> package."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511885821, "post_id": 47535474, "comment_id": 82029147, "body": "And you can see an example of how to draw an image onto another at the end of this answer: <a href=\"https://stackoverflow.com/questions/36573413/change-color-of-a-single-pixel-go-lang-image/36577076#36577076\">Change color of a single pixel - Go lang image</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5380, "user_id": 146620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4ba0c9119010302832e1d129b38228b?s=128&d=identicon&r=PG", "display_name": "Graham King", "link": "https://stackoverflow.com/users/146620/graham-king"}, "is_accepted": true, "score": 3, "last_activity_date": 1511898289, "creation_date": 1511898289, "answer_id": 47539710, "question_id": 47535474, "link": "https://stackoverflow.com/questions/47535474/convert-image-from-image-ycbcr-to-image-rgba/47539710#47539710", "title": "Convert image from *image.YCbCr to *image.RGBA", "body": "<p>As the comments suggest, you have to create a new image and draw into it:\n<code>\nb := thumbnail.Bounds()\nm := image.NewRGBA(image.Rect(0, 0, b.Dx(), b.Dy()))\ndraw.Draw(m, m.Bounds(), thumbnail, b.Min, draw.Src)\n</code></p>\n\n<p>YCbCr is a sub-sampled image, so it doesn't map directly to the 4-bytes-per-pixel of RGBA.</p>\n"}], "owner": {"reputation": 2589, "user_id": 508459, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/deef27f7e98f18a5101168cfc5bb9732?s=128&d=identicon&r=PG", "display_name": "eshalev", "link": "https://stackoverflow.com/users/508459/eshalev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2373, "favorite_count": 1, "accepted_answer_id": 47539710, "answer_count": 1, "score": 2, "last_activity_date": 1511898289, "creation_date": 1511883728, "last_edit_date": 1511885710, "question_id": 47535474, "link": "https://stackoverflow.com/questions/47535474/convert-image-from-image-ycbcr-to-image-rgba", "title": "Convert image from *image.YCbCr to *image.RGBA", "body": "<p>I am loading a jpeg from the disk, and I would like to do some RGBA operations on it.</p>\n\n<p>However, since the jpeg is not RGBA, i get an error when I try to use it as such:</p>\n\n<pre><code>thumbnail,err:=jpeg.Decode(imageAsReader)\n...\nreturn thumbnail.(*image.RGBA)\n</code></pre>\n\n<p>yeileds the error:</p>\n\n<pre><code>interface conversion: image.Image is *image.YCbCr, not *image.RGBA\n</code></pre>\n\n<p>Is there an easy way to convert the image to RGBA once I have loaded it in memory? (Other operations are in RGBA later on, so that is the color model I want to use in memory).</p>\n"}, {"tags": ["go", "trace"], "comments": [{"owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "edited": false, "score": 1, "creation_date": 1511883390, "post_id": 47535304, "comment_id": 82027443, "body": "so wait, this is not really go right? You want a way to add some text to into a document based on a predefined pattern, if I got it right"}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "reply_to_user": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "edited": false, "score": 0, "creation_date": 1511883477, "post_id": 47535304, "comment_id": 82027499, "body": "Actually, this about a golang project."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1511883610, "post_id": 47535304, "comment_id": 82027590, "body": "You can add text to the source files using any text processing tooling you&#39;d like, but there&#39;s an example <a href=\"https://github.com/jbardin/gotrace/\" rel=\"nofollow noreferrer\">here</a> of doing this in Go."}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511883942, "post_id": 47535304, "comment_id": 82027804, "body": "@JimB Thanks for the link. I will try that out. I was also thinking we should be able to tweak gofmt code, but not sure how easy that will be."}, {"owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511884281, "post_id": 47535304, "comment_id": 82028056, "body": "@JimB Thanks again. The tool perfectly fits the requirement."}], "owner": {"reputation": 4166, "user_id": 1898070, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c29fa44faffe872325c40c6d5aea0393?s=128&d=identicon&r=PG", "display_name": "Nipun Talukdar", "link": "https://stackoverflow.com/users/1898070/nipun-talukdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511883242, "creation_date": 1511883242, "question_id": 47535304, "link": "https://stackoverflow.com/questions/47535304/how-can-i-programmatically-add-a-statement-at-the-beginning-of-all-functions-bo", "title": "How can I programmatically add a statement at the beginning of all function&#39;s body in a file?", "body": "<p>I want to add one line (something like printing funtion name, file name, line no.) at the beginning of all the function bodies in a file. This is to log the execution flow of some functionalities of a big project. There is zero or almost negligible logging in the entire project and I am trying to figure a way out.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1511877196, "post_id": 47533200, "comment_id": 82023025, "body": "The speed of parsing <code>0</code> or <code>1</code> is not even measurable in the course of an http request. Use whichever is more convenient."}, {"owner": {"reputation": 1809, "user_id": 4274475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b7d37b7f022503a0869af7bb8c2ace16?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Smithyyy", "link": "https://stackoverflow.com/users/4274475/mr-smithyyy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511877239, "post_id": 47533200, "comment_id": 82023051, "body": "@JimB Well to do that the whole <code>strconv</code> package has to be imported, doesn&#39;t that affect performance?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1511877400, "post_id": 47533200, "comment_id": 82023167, "body": "You&#39;re already parsing a text protocol, HTTP, which requires the <code>strconv</code> pacakge (and it&#39;s used in the <code>fmt</code> package which is probably already imported too). Also, simply importing the package has no bearing on performance."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1511885512, "post_id": 47533200, "comment_id": 82028940, "body": "@Mr.Smithyyy, Go is a statically compiled language, so nothing &quot;imported&quot; gets somehow &quot;loaded at runtime&quot;. Importing a package merely means adding the necessary pieces of its code to the binary image of the executable program being prepared by the compiler and the linker. So no, importing a package does not incur runtime costs."}, {"owner": {"reputation": 1809, "user_id": 4274475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b7d37b7f022503a0869af7bb8c2ace16?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Smithyyy", "link": "https://stackoverflow.com/users/4274475/mr-smithyyy"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1511903516, "post_id": 47533200, "comment_id": 82039158, "body": "@kostix Thanks for the explanation, coming from node I wanted to avoid the using a bundle of packages that would just slow my program down."}], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 4, "last_activity_date": 1511965922, "last_edit_date": 1511965922, "creation_date": 1511877574, "answer_id": 47533373, "question_id": 47533200, "link": "https://stackoverflow.com/questions/47533200/parse-parameter-to-bool-or-just-use-string-in-switch-statement/47533373#47533373", "title": "Parse parameter to bool or just use string in switch statement", "body": "<p>You could see the source code of <code>ParseBool</code> <a href=\"https://golang.org/src/strconv/atob.go?s=351:391#L1\" rel=\"nofollow noreferrer\">here</a>. It uses switch too but with more cases. If the compiler inlines its code it, speed should be very similar to your code. If you want a definite answer you should benchmark different cases.</p>\n\n<p>In general I discourage you from paying attention to this small details. It's just matter of some nano seconds but it make your codes more difficult to understand. Begin optimizations with profiling your code to find hotspots that take a lot of time and fix them.</p>\n"}], "owner": {"reputation": 1809, "user_id": 4274475, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b7d37b7f022503a0869af7bb8c2ace16?s=128&d=identicon&r=PG&f=1", "display_name": "Mr.Smithyyy", "link": "https://stackoverflow.com/users/4274475/mr-smithyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 47533373, "answer_count": 1, "score": -2, "last_activity_date": 1511965922, "creation_date": 1511877019, "question_id": 47533200, "link": "https://stackoverflow.com/questions/47533200/parse-parameter-to-bool-or-just-use-string-in-switch-statement", "title": "Parse parameter to bool or just use string in switch statement", "body": "<p>I'm coming across a few situations where I would like to use routing to change some <code>Is_Active</code> fields in my database but I'm curious about performance.</p>\n\n<p>Let's have a route handler as so:</p>\n\n<pre><code>func testHandler(r *mux.Router) {\n    r.HandleFunc(\"/test/{status}\" statusHandler).Methods(\"GET\")\n}\n</code></pre>\n\n<p>Now that parameter will only ever be 0 or 1, unless the user tries something else but either way nothing will happen unless it's  0 or 1. My question is, is it faster to parse the string into a boolean which would involve bringing in the <code>strconv</code> package or would it be faster to just do a switch on the string?</p>\n\n<p>Example of both:</p>\n\n<pre><code>func statusHandler(w http.ResponseWriter, r *http.Request) {\n    v := mux.Vars(r)\n    active, err := strconv.ParseBool(v[\"status\"])\n    // Handle err\n\n    if active {\n      // Do something\n    } else {\n      // Do something else\n    }\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>func statusHandler(w http.ResponseWriter, r *http.Request) {\n    v := mux.Vars(r)\n\n    switch v[\"status\"] {\n        case \"0\":\n            // Do something\n        case \"1\":\n            // Do something else\n        default:\n            // Throw 500 Error\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes", "minikube"], "comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 1, "creation_date": 1511879545, "post_id": 47532434, "comment_id": 82024690, "body": "Changing the binary file, is not going to stop a running process and restart it with a new binary.  The typical approach would be to containerize your application, since a live k8s deployment is not going to be mounting volumes from your local machine.  Once containerized, you can use a bash script to build a linux binary, build the new docker image, push it to a reposition with a custom tag (E.g. version number, commit hash or timestamp), then use kubectl update the deployment.yaml file.  While this sound like a lot of work, you only need to write such a script once."}, {"owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "edited": false, "score": 0, "creation_date": 1511881994, "post_id": 47532434, "comment_id": 82026473, "body": "Only addition to PassKit is you can explore wider Continuous Integration/Deployment tools (e.g. Spinnaker) for auto deploying changes. Probably of more value if when in production though."}, {"owner": {"reputation": 356, "user_id": 5998521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkFFT.jpg?s=128&g=1", "display_name": "Pietro Bongiovanni", "link": "https://stackoverflow.com/users/5998521/pietro-bongiovanni"}, "edited": false, "score": 0, "creation_date": 1511882846, "post_id": 47532434, "comment_id": 82027066, "body": "We have CI/CD pipelines for deployments, that is not the problem. The problem is how to handle development locally as Minikube does not detect changes to the code and doesn&#39;t restart the service when changes are applied to the source code"}, {"owner": {"reputation": 1183, "user_id": 4274484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0dPT2.jpg?s=128&g=1", "display_name": "hypnoglow", "link": "https://stackoverflow.com/users/4274484/hypnoglow"}, "edited": false, "score": 0, "creation_date": 1512743738, "post_id": 47532434, "comment_id": 82393060, "body": "tl;dr: you don&#39;t want to. Minikube is NOT that development environment, where you need to re-deploy an application on each line of code change. Develop &amp; run locally, use <code>kubectl proxy</code> or kubectl port-forward` to provide external resources to your app, and deploy to minikube only when you need to test how your app behaves in kubernetes cluster."}], "owner": {"reputation": 356, "user_id": 5998521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mkFFT.jpg?s=128&g=1", "display_name": "Pietro Bongiovanni", "link": "https://stackoverflow.com/users/5998521/pietro-bongiovanni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511874628, "creation_date": 1511874628, "question_id": 47532434, "link": "https://stackoverflow.com/questions/47532434/rebuild-and-rerun-go-application-in-minikube", "title": "Rebuild and Rerun Go application in Minikube", "body": "<p>I'm building a micro service in Golang which is going to live in a Kubernetes cluster. I'm developing it and using Minikube to run a copy of the cluster locally.</p>\n\n<p>The problem I ran into is that if I run my application inside of the container using <code>go run main.go</code>, I need to kill the pod for it to detect changes and update what is running.</p>\n\n<p>I tried using a watcher for the binary so that the binary is updated on every save and a binary is running inside the pod, but even after compiling the new version, minikube is running the old one.</p>\n\n<p>Any suggestion? \nHere is my deployment file for running the MS locally:</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  labels:\n    name: pokedex\n  name: pokedex\nspec:\n  template:\n    metadata:\n      labels:\n        name: pokedex\n    spec:\n      volumes:\n        - name: source\n          hostPath:\n            path: *folder where source resides*\n      containers:\n        - name: pokedex\n          image: golang:1.8.5-jessie\n          workingDir: *folder where source resides*\n          command: [\"./pokedex\"] # Here I tried both the binary and go run main.go\n          ports:\n            - containerPort: 8080\n              name: go-server\n              protocol: TCP\n          volumeMounts:\n            - name: source\n              mountPath: /source\n          env:\n          - name: GOPATH\n            value: /source\n</code></pre>\n"}, {"tags": ["go", "path"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1511878192, "post_id": 47531760, "comment_id": 82023698, "body": "When you run a Go program, there is no &quot;project&quot;. You&#39;re just running a compiled binary; it has no concept of where it&#39;s source code might be (or even if it exists on the machine where it&#39;s running), nor should it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511900335, "post_id": 47531760, "comment_id": 82037466, "body": "@Adrian - thanks the problem is that I need to read json file from the root project, the problem that it working very strange ,when I run the program in goland it provide path like &#39;go/src/myapp/` and when I run it in vsCode I got this path <code>go&#47;src&#47;myapp&#47;src&#47;server.go</code> im running it on the exact same project so I want to find some generic solution, how would you do it ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511900425, "post_id": 47531760, "comment_id": 82037507, "body": "I&#39;d make the path configurable by config file, command line flag, and/or environment variable."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1511900576, "post_id": 47531760, "comment_id": 82037573, "body": "@Adrian - can you please provide some example ? like for my project root path ? thanks"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "edited": false, "score": 1, "creation_date": 1511873293, "post_id": 47531989, "comment_id": 82020372, "body": "Ok but how should I resolve it to the parent project in case im in the structure of <code>myapp&#47;src&#47;server.go</code> ?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1511873724, "post_id": 47531989, "comment_id": 82020643, "body": "My point is your project structure is irrelevant. Usually paths are passed to program explicitly via flags (<a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">golang.org/pkg/flag</a>) or config files."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "edited": false, "score": 0, "creation_date": 1511873958, "post_id": 47531989, "comment_id": 82020788, "body": "Ok thanks, so how should I update it via flag and how should I go up two levels ?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1511874835, "post_id": 47531989, "comment_id": 82021371, "body": "@Ninawatcher Updated my post to include an example."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "edited": false, "score": 0, "creation_date": 1511899955, "post_id": 47531989, "comment_id": 82037251, "body": "Thanks 1+ , you put it on main and the path is <code>&#47;</code> but how it should be in case you are not in the main and you are using the path as in my question <code>myapp&#47;src&#47;server.go</code> to provide it in any file structure whether if I put it on  <code>myapp&#47;src&#47;server.go</code> or for example <code>myapp&#47;src&#47;util&#47;server.go</code> can you provide example to this ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "edited": false, "score": 0, "creation_date": 1511900512, "post_id": 47531989, "comment_id": 82037547, "body": "Im not sure how you example help here since I want to run the program without provide any path..."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1511940756, "post_id": 47531989, "comment_id": 82051073, "body": "@Ninawatcher Don&#39;t think there is a way to get a source file path in a compiled programming language! There is no source file when program is running. You could use <code>filepath.Abs(os.Args[0])</code> to get location of current running program and use <code>filepath.Dir</code> to get its parent directory."}], "tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 8, "last_activity_date": 1511874787, "last_edit_date": 1511874787, "creation_date": 1511873187, "answer_id": 47531989, "question_id": 47531760, "link": "https://stackoverflow.com/questions/47531760/how-to-get-the-root-path-of-the-project/47531989#47531989", "title": "How to get the root path of the project", "body": "<p><code>os.Getwd()</code> does not return your source file path. It returns program current working directory (Usually the directory that you executed your program).</p>\n\n<p>Example:</p>\n\n<p>Assume I have a main.go in <code>/Users/Arman/go/src/github.com/rmaan/project/main.go</code> that just outputs <code>os.Getwd()</code></p>\n\n<pre><code>$ cd /Users/Arman/go/src/github.com/rmaan/project/\n$ go run main.go\n/Users/Arman/go/src/github.com/rmaan/project &lt;nil&gt;\n</code></pre>\n\n<p>If I change to other directory and execute there, result will change.</p>\n\n<pre><code>$ cd /Users/Arman/\n$ go run ./go/src/github.com/rmaan/project/main.go\n/Users/Arman &lt;nil&gt;\n</code></pre>\n\n<hr>\n\n<p>IMO you should explicitly pass the path you want to your program instead of trying to infer it from context (As it may change specially in production environment). Here is an example with <code>flag</code> package.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"flag\"\n)\n\n\nfunc main() {\n    var myPath string\n    flag.StringVar(&amp;myPath, \"my-path\", \"/\", \"Provide project path as an absolute path\")\n    flag.Parse()\n\n    fmt.Printf(\"provided path was %s\\n\", myPath)\n}\n</code></pre>\n\n<p>then execute your program as follows:</p>\n\n<pre><code>$ cd /Users/Arman/go/src/github.com/rmaan/project/\n$ go run main.go  --my-path /Users/Arman/go/src/github.com/rmaan/project/\nprovided path was /Users/Arman/go/src/github.com/rmaan/project/\n$ # or more easily\n$ go run main.go  --my-path `pwd`\nprovided path was /Users/Arman/go/src/github.com/rmaan/project/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 4110451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZY8hyLRV1EE/AAAAAAAAAAI/AAAAAAAAAd4/KnZOqFmdduU/photo.jpg?sz=128", "display_name": "Marco Vignati", "link": "https://stackoverflow.com/users/4110451/marco-vignati"}, "is_accepted": false, "score": 2, "last_activity_date": 1586430381, "creation_date": 1586430381, "answer_id": 61119725, "question_id": 47531760, "link": "https://stackoverflow.com/questions/47531760/how-to-get-the-root-path-of-the-project/61119725#61119725", "title": "How to get the root path of the project", "body": "<p>If your project is a git repository you can also use the <code>git rev-parse</code> command with the <code>--show-toplevel</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>cmdOut, err := exec.Command(\"git\", \"rev-parse\", \"--show-toplevel\").Output()\nif err != nil {\n    assert.Fail(t, fmt.Sprintf(`Error on getting the go-kit base path: %s - %s`, err.Error(), string(cmdOut)))\n    return\n}\n\nfmt.Println(strings.TrimSpace(string(cmdOut)))\n</code></pre>\n\n<p>It'll print out the git project home path wherever in the sub path you are</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8317, "favorite_count": 0, "accepted_answer_id": 47531989, "answer_count": 2, "score": 6, "last_activity_date": 1586430381, "creation_date": 1511872416, "question_id": 47531760, "link": "https://stackoverflow.com/questions/47531760/how-to-get-the-root-path-of-the-project", "title": "How to get the root path of the project", "body": "<p>I run the following code <code>workingDir, _ := os.Getwd()</code> \nin <code>server.go</code> file which is under the root project and get the root path,\nNow I need to move the <code>server.go</code> file to the following structure </p>\n\n<pre><code>myapp\n  src\n   server.go\n</code></pre>\n\n<p>and I want to ge the path of <code>go/src/myapp</code> \ncurrently after I move the <code>server.go</code> under <code>myapp-&gt;src&gt;server.go</code> I got path of <code>go/src/myapp/src/server.go</code> and I want to get the previews  path ,</p>\n\n<p>How should I do it in go automatically? or should I put <code>../</code> explicit in get path ?</p>\n"}, {"tags": ["xml", "parsing", "go"], "comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 0, "creation_date": 1511873414, "post_id": 47530727, "comment_id": 82020459, "body": "Your example is not very clear, what wrapping the responses tags?"}, {"owner": {"reputation": 42, "user_id": 7925568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RN4td.png?s=128&g=1", "display_name": "Noy", "link": "https://stackoverflow.com/users/7925568/noy"}, "reply_to_user": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 0, "creation_date": 1511873597, "post_id": 47530727, "comment_id": 82020565, "body": "Nothing wraps the response tags. That example was the whole XML doc."}], "answers": [{"comments": [{"owner": {"reputation": 42, "user_id": 7925568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RN4td.png?s=128&g=1", "display_name": "Noy", "link": "https://stackoverflow.com/users/7925568/noy"}, "edited": false, "score": 1, "creation_date": 1511887423, "post_id": 47533848, "comment_id": 82030227, "body": "Thank you for that, was wondering if there was a wildcard for that. Completely agree with you on that, no data is given for the tag name. on the API I&#39;m using, the tag name is dynamic, bad on their part to be honest, but couldn&#39;t do anything about it. All the data is held in the tag body luckily. Thanks for the answer!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1511878956, "creation_date": 1511878956, "answer_id": 47533848, "question_id": 47530727, "link": "https://stackoverflow.com/questions/47530727/parsing-multiple-xml-files-with-custom-tags/47533848#47533848", "title": "Parsing Multiple XML Files with Custom tags", "body": "<p>As XML goes, this is pretty bad; tag names should not be used for data, only tag bodies and attribute values should hold data. But, all is not lost! Per <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">the documentation on <code>encoding/xml</code></a>, you can use the <code>,any</code> tag to map a field that should contain \"a sub-element that hasn't matched any of the above rules\". You can use this as a sort of wildcard, to match any child element not otherwise mapped - in your case, a child element whose tag name you don't know at compile time:</p>\n\n<pre><code>type Data struct {\n    Rows []Info `xml:\",any\"`\n}\n</code></pre>\n\n<p>Playground example: <a href=\"https://play.golang.org/p/lo6bJBRvgV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lo6bJBRvgV</a></p>\n"}], "owner": {"reputation": 42, "user_id": 7925568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RN4td.png?s=128&g=1", "display_name": "Noy", "link": "https://stackoverflow.com/users/7925568/noy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 47533848, "answer_count": 1, "score": 1, "last_activity_date": 1511878956, "creation_date": 1511869343, "last_edit_date": 1511869580, "question_id": 47530727, "link": "https://stackoverflow.com/questions/47530727/parsing-multiple-xml-files-with-custom-tags", "title": "Parsing Multiple XML Files with Custom tags", "body": "<p>I have to parse many XML documents, I already know the logic to parse the files, but the issue is, the tag for each xml file is different.</p>\n\n<p>This is what I have so far</p>\n\n<pre><code>type Data struct {\n     Rows []Info `xml:\"domain-google.com\"` // &lt;- This is custom and needs to change (e.g. the next xml doc tag will be `xml:\"domain-facebook.com\"`\n}\n\ntype Info struct {\n     Domain string `xml:\"domain\"`\n }\n</code></pre>\n\n<p>// example logic for parsing xml</p>\n\n<pre><code>    xmlFile, err := http.Get(\"somefiles.xml\")\n    if err != nil { fmt.Println(err) }\n    var data Data\n    if err = xml.NewDecoder(xmlFile.Body).Decode(&amp;data); err != nil {\n        fmt.Println(err)\n    }\n    for _, rows := range data.Rows {\n        fmt.Println(rows.Domain)\n    }\n</code></pre>\n\n<p>example xml documents</p>\n\n<pre><code>&lt;response&gt;\n   &lt;!-- This tag is what is custom every time --&gt;\n   &lt;domain-google.com&gt;\n      &lt;domain&gt;google.com&lt;/domain&gt;\n   &lt;/domain-google.com&gt;\n&lt;/response&gt;\n\n&lt;response&gt;\n   &lt;!-- This tag is what is custom every time --&gt;\n   &lt;domain-facebook.com&gt;\n      &lt;domain&gt;facebook.com&lt;/domain&gt;\n   &lt;/domain-facebook.com&gt;\n&lt;/response&gt;\n</code></pre>\n\n<p>Any idea how to tackle this issue?</p>\n\n<p>Thank you in advanced.</p>\n"}, {"tags": ["multithreading", "go", "synchronization", "shutdown"], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1511868089, "creation_date": 1511868089, "answer_id": 47530318, "question_id": 47529636, "link": "https://stackoverflow.com/questions/47529636/how-to-safely-close-a-chan-chan-t-in-go/47530318#47530318", "title": "how to safely close a chan chan T in Go?", "body": "<p>Closing a channel indicates that no more values will be sent to it. This can be useful to communicate completion to the channel\u2019s receivers.</p>\n\n<p>The data in the channel will still be there where you may have to close the channel and then remove all channels inside it like following</p>\n\n<pre><code>// Stop stops the Pool and free all the channels\nfunc (p *WorkerPool) Stop() bool {\n    // stops all workers\n    for _, worker := range p.Workers {\n        worker.Stop()\n    }\n    p.waitGroup.Wait() //Wait for the goroutines to shutdown\n    close(p.WorkerPool)\n    for channel := range p.WorkerPool {\n        fmt.Println(\"Freeing channel\") //remove all the channels\n    }\n    more := p.IsOpen()\n    fmt.Printf(\" more? %t\", more)\n\n    return ok\n}\n</code></pre>\n\n<p>BTW, one can not use <code>_, ok &lt;-</code> to check if a channel is closed. I would suggest a different name for the function</p>\n"}], "owner": {"reputation": 6522, "user_id": 931511, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/eNqBf.jpg?s=128&g=1", "display_name": "guilhebl", "link": "https://stackoverflow.com/users/931511/guilhebl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 47530318, "answer_count": 1, "score": 1, "last_activity_date": 1511869330, "creation_date": 1511866043, "question_id": 47529636, "link": "https://stackoverflow.com/questions/47529636/how-to-safely-close-a-chan-chan-t-in-go", "title": "how to safely close a chan chan T in Go?", "body": "<p>I'm implementing a simple worker-pool algorithm where 1 Sender (the dispatcher) sends jobs to M (Worker) go routines. For that it uses a channel of channels to allocate to the first idle worker an available job:</p>\n\n<pre><code>// builds the pool\nfunc NewWorkerPool(maxWorkers int) WorkerPool {\n    pool := make(chan chan Job, maxWorkers)\n    workers := make([]Worker, 0)\n    return WorkerPool{\n        WorkerPool: pool,\n        Workers: workers,\n        maxWorkers: maxWorkers,\n        waitGroup: sync.WaitGroup{}}\n}\n\n// Starts the WorkerPool\nfunc (p *WorkerPool) Run(queue chan Job) {\n    w := p.waitGroup\n\n    // starting n number of workers\n    for i := 0; i &lt; p.maxWorkers; i++ {\n        worker := NewWorker(p.WorkerPool)\n        p.Workers = append(p.Workers, worker)\n        w.Add(1)\n        worker.Start(&amp;w)\n    }\n\n    go p.dispatch(queue)\n}\n\n// dispatches a job to be handled by an idle Worker of the pool\nfunc (p *WorkerPool) dispatch(jobQueue chan Job) {\n    for {\n        select {\n        case job := &lt;-jobQueue:\n            // a model request has been received\n            go func(job Job) {\n                // try to obtain a worker model channel that is available.\n                // this will block until a worker is idle\n                jobChannel := &lt;-p.WorkerPool\n\n                // dispatch the model to the worker model channel\n                jobChannel &lt;- job\n            }(job)\n        }\n    }\n}\n\n\n// checks if a Worker Pool is open or closed - If we can recieve on the channel then it is NOT closed\nfunc (p *WorkerPool) IsOpen() bool {\n    _, ok := &lt;-p.WorkerPool\n    return ok\n}\n</code></pre>\n\n<p>The worker Start and Stop methods</p>\n\n<pre><code>// Start method starts the run loop for the worker, listening for a quit channel in\n// case we need to stop it\nfunc (w Worker) Start(wg *sync.WaitGroup) {\n    go func() {\n        defer wg.Done()\n        for {\n            // register the current worker into the worker queue.\n            w.WorkerPool &lt;- w.JobChannel\n\n            select {\n            case job := &lt;-w.JobChannel:\n                // we have received a work request.\n                result := job.Run()\n                job.ReturnChannel &lt;- result\n\n                // once result is returned close the job output channel\n                close(job.ReturnChannel)\n\n            case &lt;-w.quit:\n                // we have received a signal to stop\n                return\n            }\n        }\n    }()\n}\n\n// Stop signals the worker to stop listening for work requests.\nfunc (w Worker) Stop() {\n    go func() {\n        w.quit &lt;- true\n    }()\n}\n</code></pre>\n\n<p>Now I'm trying to close the Pool by using the following method, I use a sync.WaitGroup in order to wait for all the workers to shutdown:</p>\n\n<pre><code>// stops the Pool\nfunc (p *WorkerPool) Stop() bool {\n    // stops all workers\n    for _, worker := range p.Workers {\n        worker.Stop()\n    }\n    p.waitGroup.Wait() //Wait for the goroutines to shutdown\n\n    close(p.WorkerPool)\n\n    more := p.IsOpen()\n\n    fmt.Printf(\" more? %t\", more)\n\n    return ok\n}\n</code></pre>\n\n<p>// prints more? TRUE</p>\n\n<p>Even though I wait for the workers to quit and later on invoke close(p.WorkerPool) I still have the channel open, what is missing in this case, how to close the channels accordingly ? </p>\n"}, {"tags": ["go", "continuous-integration", "go-toolchain"], "answers": [{"comments": [{"owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "edited": false, "score": 0, "creation_date": 1512143769, "post_id": 47531759, "comment_id": 82151948, "body": "I used both of your solutions combined. This allows me to automatically format for developers and later check this and other stuff in CI. Thanks!"}], "tags": [], "owner": {"reputation": 446, "user_id": 8471521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17220bc1e04ba055af7a275c80e6d31f?s=128&d=identicon&r=PG&f=1", "display_name": "S. Diego", "link": "https://stackoverflow.com/users/8471521/s-diego"}, "is_accepted": true, "score": 8, "last_activity_date": 1511872412, "creation_date": 1511872412, "answer_id": 47531759, "question_id": 47529611, "link": "https://stackoverflow.com/questions/47529611/goimports-needs-to-ignore-vendor-package/47531759#47531759", "title": "goimports needs to ignore vendor package", "body": "<p>gometalinter has a \"--vendor\" flag to ignore the vendor folder. the flag passes the needed paramters to the underlying tools to ignore the folder.</p>\n\n<p>so one solution would be to use only govet, golint und goimports with gometalinter</p>\n\n<pre><code>gometalinter --disable-all --enable=vet --enable=golint --enable=goimports --vendor ./...\n</code></pre>\n\n<p>another solution might be (copied from <a href=\"https://gist.github.com/bgentry/fd1ffef7dbde01857f66\" rel=\"noreferrer\">gist</a>):</p>\n\n<pre><code>goimports -d $(find . -type f -name '*.go' -not -path \"./vendor/*\")\n</code></pre>\n\n<p>imho I would prefer the first solution. That way you could easily add other linters as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "edited": false, "score": 0, "creation_date": 1511945416, "post_id": 47532382, "comment_id": 82053575, "body": "Somehow this solution ignores the vendor package. I suspect this is due to the fact that the vendored code is used in the main source."}], "tags": [], "owner": {"reputation": 1847, "user_id": 391464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1XdRz.png?s=128&g=1", "display_name": "yee", "link": "https://stackoverflow.com/users/391464/yee"}, "is_accepted": false, "score": 0, "last_activity_date": 1511874444, "creation_date": 1511874444, "answer_id": 47532382, "question_id": 47529611, "link": "https://stackoverflow.com/questions/47529611/goimports-needs-to-ignore-vendor-package/47532382#47532382", "title": "goimports needs to ignore vendor package", "body": "<blockquote>\n  <p>To exclude directories in your $GOPATH from being scanned for Go files, goimports respects a configuration file at $GOPATH/src/.goimportsignore which may contain blank lines, comment lines (beginning with '#'), or lines naming a directory relative to the configuration file to ignore when scanning. No globbing or regex patterns are allowed. Use the \"-v\" verbose flag to verify it's working and see what goimports is doing.</p>\n</blockquote>\n\n<p><a href=\"https://godoc.org/golang.org/x/tools/cmd/goimports\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/tools/cmd/goimports</a></p>\n\n<p>So you can add the vendor dir to <code>$GOPATH/src/.goimportsignore</code> file, e.g.:</p>\n\n<pre><code>github.com/foo/bar/vendor\n</code></pre>\n"}], "owner": {"reputation": 2437, "user_id": 4102515, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31b3a2bfa392f631bc24a7c1dce899b9?s=128&d=identicon&r=PG", "display_name": "snorberhuis", "link": "https://stackoverflow.com/users/4102515/snorberhuis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3208, "favorite_count": 0, "accepted_answer_id": 47531759, "answer_count": 2, "score": 5, "last_activity_date": 1511874444, "creation_date": 1511865947, "question_id": 47529611, "link": "https://stackoverflow.com/questions/47529611/goimports-needs-to-ignore-vendor-package", "title": "goimports needs to ignore vendor package", "body": "<p>I am trying to implement <code>dep</code> in my project. This is all working well but it also adds a vendor directory. I now need to update my tooling to ignore this directory or my vendored packages will be modified or I get false positives of warnings. I am currently using the following tooling:</p>\n\n<ul>\n<li>goimports -w </li>\n<li>go vet</li>\n<li>go lint</li>\n</ul>\n\n<p>These tools are also used in CI. I do want to keep autoformatting using goimports, but I am willing to start using gometalinter. I am not really looking for a solution using grep and find magic.</p>\n\n<p>How can I make these tools ignore <code>vendor/</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1511863879, "post_id": 47528836, "comment_id": 82014058, "body": "Did you try <code>&quot;github.com&#47;nats-io&#47;go-nats&quot;</code>?"}, {"owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "reply_to_user": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1511864247, "post_id": 47528836, "comment_id": 82014319, "body": "@FrankAK what do you mean? Where should I try this?"}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1511864307, "post_id": 47528836, "comment_id": 82014355, "body": "in your terminal"}, {"owner": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1511864345, "post_id": 47528836, "comment_id": 82014389, "body": "Did you try <code>go get &quot;github.com&#47;nats-io&#47;go-nats&quot;</code>?"}, {"owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "reply_to_user": {"reputation": 1505, "user_id": 4344586, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zmULe.png?s=128&g=1", "display_name": "Frank AK", "link": "https://stackoverflow.com/users/4344586/frank-ak"}, "edited": false, "score": 0, "creation_date": 1511864550, "post_id": 47528836, "comment_id": 82014561, "body": "Yes, <code>&quot;github.com&#47;nats-io&#47;go-nats&quot;</code> is installed into my <code>$GOPATH</code> and it&#39;s visible by <code>go build</code>, but not by <code>go tool compile</code>."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1511865148, "post_id": 47528836, "comment_id": 82015004, "body": "Have you tried using the -D or -I flag? <a href=\"https://golang.org/cmd/compile/\" rel=\"nofollow noreferrer\">docs</a>"}, {"owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "reply_to_user": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1511866182, "post_id": 47528836, "comment_id": 82015760, "body": "@dev.bmax thanks for documentation link, it&#39;s described better than in help of command itself. I&#39;ll write an answer to my question."}], "answers": [{"tags": [], "owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "is_accepted": false, "score": 7, "last_activity_date": 1511866355, "creation_date": 1511866355, "answer_id": 47529746, "question_id": 47528836, "link": "https://stackoverflow.com/questions/47528836/import-path-difference-using-build-and-tool-compile/47529746#47529746", "title": "Import path difference using &quot;build&quot; and &quot;tool compile&quot;", "body": "<p>Correct syntax of <code>goo tool compile</code> is as follows:</p>\n\n<pre><code>$ go tool compile -I $GOPATH/pkg/linux_amd64 -o main.o main.go\n</code></pre>\n\n<p>The problem was that by default <code>compile</code> performs lookup only in <code>GOROOT</code> and ignores <code>GOPATH</code>.</p>\n"}], "owner": {"reputation": 2193, "user_id": 5512095, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/58e730dd5510436d080bb145d452a2e6?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Sheremet", "link": "https://stackoverflow.com/users/5512095/denis-sheremet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1764, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1511866355, "creation_date": 1511863707, "question_id": 47528836, "link": "https://stackoverflow.com/questions/47528836/import-path-difference-using-build-and-tool-compile", "title": "Import path difference using &quot;build&quot; and &quot;tool compile&quot;", "body": "<p>I'm trying to compile this <a href=\"https://github.com/nats-io/go-nats/blob/master/examples/nats-sub.go\" rel=\"noreferrer\">example</a> (which is saved as <code>main.go</code> in current working dir):</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"log\"\n    \"runtime\"\n\n    \"github.com/nats-io/go-nats\"\n)\n\n// rest of the code\n</code></pre>\n\n<p>This works:</p>\n\n<pre><code>$ go build ./\n</code></pre>\n\n<p>But this does not:</p>\n\n<pre><code>$ go tool compile -o main.o main.go\nmain.go:8:2: can't find import: \"github.com/nats-io/go-nats\"\n</code></pre>\n\n<p>Both of examples above were run on the same terminal with same environment variables, so I don't understand why the 2nd one does not work. I've tried <code>-D</code> and <code>-I</code> parameters with various directories as <code>$GOPATH</code>, <code>$GOPATH/src</code> and so on with no success.</p>\n\n<p>I know what it's considered best practice to not use <code>go tool compile</code> and so on, but my goal is to add my go source to existing C++ makefile project and useage of <code>go tool</code> will make it more consistent.</p>\n"}, {"tags": ["dictionary", "go", "interface", "path", "navigation"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1511864952, "post_id": 47528802, "comment_id": 82014854, "body": "You can see an example of getting and setting an element given by a path in this answer: <a href=\"https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an#28878037\">Taking a JSON string, unmarshaling it into a map, editing, and marshaling it into a byte seems more complicated then it should be</a> (only difference is that path is given as a string slice there, but the concept is the same)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8322661"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511865836, "post_id": 47528802, "comment_id": 82015490, "body": "Thanks for the quick reply. If I have a predefined struct to unmarshal my value into. Is it possible to navigate with the Selectors (for struct types) and Index expressions (for maps and slices) as well even if I want to go into several levels? I hope you understand my question"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511865993, "post_id": 47528802, "comment_id": 82015613, "body": "You can, but for that you&#39;d need reflection (<code>reflect</code> package), and it would only work for exported fields."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511868524, "post_id": 47528802, "comment_id": 82017305, "body": "Go is not a dynamically typed language. Get rid of these empty interfaces and design a proper data model and you&#39;ll be much better of."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8322661"}, "edited": false, "score": 0, "creation_date": 1511873413, "post_id": 47528802, "comment_id": 82020457, "body": "icza thank you very much you solved my problem unfortunatly I cannot upvote comments."}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 3226930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/440671bc691ca95bfc74ffd7437e4b3c?s=128&d=identicon&r=PG&f=1", "display_name": "Aarthi", "link": "https://stackoverflow.com/users/3226930/aarthi"}, "is_accepted": true, "score": 3, "last_activity_date": 1511867331, "creation_date": 1511867331, "answer_id": 47530077, "question_id": 47528802, "link": "https://stackoverflow.com/questions/47528802/navigation-into-a-map-with-a-string-path-variable-for-golang/47530077#47530077", "title": "Navigation into a map with a string path variable for golang", "body": "<p>Quite a lot of reflect calls will be needed if there is no predefined struct.</p>\n\n<p>That being said, you can do it by iterating through the map with type checking on every iteration and handling cases accordingly.</p>\n\n<pre><code>// Splitting the path into keys\nkeys := strings.Split(path, \".\")\n\nvar value interface{} = map1\nfor _, key := range keys {\n    if value, err = Get(key, value); err != nil {\n        break\n    }\n}\nif err == nil {\n    fmt.Println(\"Value:\", value)\n} else {\n    fmt.Println(\"Error:\", err)\n}\n\n\nfunc Get(key string, s interface{}) (v interface{}, err error) {\n    var (\n        i  int64\n        ok bool\n    )\n    switch s.(type) {\n    case map[string]interface{}:\n        if v, ok = s.(map[string]interface{})[key]; !ok {\n            err = fmt.Errorf(\"Key not present. [Key:%s]\", key)\n        }\n    case []interface{}:\n        if i, err = strconv.ParseInt(key, 10, 64); err == nil {\n            array := s.([]interface{})\n            if int(i) &lt; len(array) {\n                v = array[i]\n            } else {\n                err = fmt.Errorf(\"Index out of bounds. [Index:%d] [Array:%v]\", i, array)\n            }\n        }\n    case Signature:\n        r := reflect.ValueOf(s)\n        v = reflect.Indirect(r).FieldByName(key)\n    }\n    //fmt.Println(\"Value:\", v, \" Key:\", key, \"Error:\", err)\n    return v, err\n}\n</code></pre>\n\n<p><a href=\"https://goplay.space/#uRqm6GSEMG\" rel=\"nofollow noreferrer\">Playground code</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8322661"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1488, "favorite_count": 1, "accepted_answer_id": 47530077, "answer_count": 1, "score": 1, "last_activity_date": 1511867331, "creation_date": 1511863601, "last_edit_date": 1511864408, "question_id": 47528802, "link": "https://stackoverflow.com/questions/47528802/navigation-into-a-map-with-a-string-path-variable-for-golang", "title": "Navigation into a map with a string path variable for golang", "body": "<p>I would like to directly navigate to a value in a map. Lets be more specific with the following go code example which should give me the value of \"Walter\" directly: (<a href=\"https://play.golang.org/p/tYJsvp39hn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tYJsvp39hn</a>)</p>\n\n<pre><code>type Signature struct{\n     Name string\n     Signed bool\n}    \n\npath := \"Document.Signatures.1.Name\"\nmap := map[string]interface{}{\n    \"Document\": map[string]interface{}{\n        \"Signatures\": []interface{}{\n            Signature{ Name: \"Hugo\", Signed: false },\n            Signature{ Name: \"Walter\", Signed: false },\n        },\n        \"Otherstuff\": \"asadwa\",\n    },\n    \"AlsoOtherStuff\": \"adwaw\",\n}\n\n// map.giveMe(path)\n// even better (if possible:) map.change(path,\"ToThisNewValue\")\n</code></pre>\n\n<p>I have searched for solutions, but I can't find any on the internet. Maybe one of you knows how to do this or knows a library to use for me.</p>\n\n<p>Thank you so much in advance!</p>\n"}, {"tags": ["go", "integration-testing", "stripe-payments"], "answers": [{"tags": [], "owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "is_accepted": true, "score": 4, "last_activity_date": 1511868222, "creation_date": 1511868222, "answer_id": 47530361, "question_id": 47528679, "link": "https://stackoverflow.com/questions/47528679/how-to-point-stripe-go-to-stripe-mock-local-server/47530361#47530361", "title": "How to point stripe-go to stripe-mock local server?", "body": "<p>Looking in <a href=\"https://github.com/stripe/stripe-go/blob/master/stripe.go#L210\" rel=\"nofollow noreferrer\">stripe.go</a>, the publicly exposed <code>BackendConfiguration</code> struct implements the <code>Backend</code> interface.  So the following should work:</p>\n\n<pre><code>httpClient := &amp;http.Client{Timeout: defaultHTTPTimeout}\n\nmockBackend := &amp;stripe.BackendConfiguration{\n      \"api\", \n      \"http://localhost:12111\", \n      httpClient,\n}\n\nstripe.SetBackend(\"api\", mockBackend)\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6611682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba41f1994955b4bab724ccb0d84bf779?s=128&d=identicon&r=PG&f=1", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6611682/ruzaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "accepted_answer_id": 47530361, "answer_count": 1, "score": 4, "last_activity_date": 1511868222, "creation_date": 1511863291, "last_edit_date": 1511864461, "question_id": 47528679, "link": "https://stackoverflow.com/questions/47528679/how-to-point-stripe-go-to-stripe-mock-local-server", "title": "How to point stripe-go to stripe-mock local server?", "body": "<p>I am using <a href=\"https://github.com/stripe/stripe-go#without-a-client\" rel=\"nofollow noreferrer\">stripe-go</a> to perform Stripe actions such as create a new customer, add a credit card, create a subscription and so on. I want to perform end-to-end testing. There is <a href=\"https://github.com/stripe/stripe-mock\" rel=\"nofollow noreferrer\">stripe-mock</a> which is a mock HTTP server that responds like the real Stripe API. I have that running locally in a terminal. How do I point my stripe-go which I am using in my Go application to make calls to this mock HTTP server instead of the real Stripe API.</p>\n\n<p>In the stripe-go documentation there is this </p>\n\n<pre><code>// Setup\nstripe.Key = \"sk_key\"\n\nstripe.SetBackend(\"api\", backend) // optional, useful for mocking\n</code></pre>\n\n<p>Am I supposed to pass something special as <code>backend</code> so that stripe-go knows to then make calls to <a href=\"http://localhost:12111\" rel=\"nofollow noreferrer\">http://localhost:12111</a> which is the address of stripe-mock?</p>\n\n<p>This is <code>stripe.SetBackend</code></p>\n\n<pre><code>// SetBackend sets the backend used in the binding.\nfunc SetBackend(backend SupportedBackend, b Backend) {\n    switch backend {\n    case APIBackend:\n        backends.API = b\n    case UploadsBackend:\n        backends.Uploads = b\n    }\n}\n</code></pre>\n\n<p>This is <code>Backend</code></p>\n\n<pre><code>// Backend is an interface for making calls against a Stripe service.\n// This interface exists to enable mocking for during testing if needed.\ntype Backend interface {\n    Call(method, path, key string, body *RequestValues, params *Params, v interface{}) error\n    CallMultipart(method, path, key, boundary string, body io.Reader, params *Params, v interface{}) error\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1511853537, "post_id": 47525672, "comment_id": 82007777, "body": "The client code looks correct. See <a href=\"https://play.golang.org/p/9ajZEuuQ_o\" rel=\"nofollow noreferrer\">this working example on the playground</a>. Show the server code."}, {"owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "edited": false, "score": 1, "creation_date": 1511856696, "post_id": 47525672, "comment_id": 82009426, "body": "Check StatusCode of the Get response. Most likely it is not 200 and your response.Body is simply empty. BTW last line in your code prints content length of second server response (&quot;PUT&quot;), not the length of data you have posted."}, {"owner": {"reputation": 2517, "user_id": 3654352, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40fc4503427ae3fcf5c37b89dfad207b?s=128&d=identicon&r=PG", "display_name": "mehdy", "link": "https://stackoverflow.com/users/3654352/mehdy"}, "edited": false, "score": 0, "creation_date": 1511885144, "post_id": 47525672, "comment_id": 82028700, "body": "I tested the code and it&#39;s working fine! maybe the problem is with the destination code (if it&#39;s yours)"}, {"owner": {"reputation": 476, "user_id": 456974, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/21ac396f360201c1358e528a53083abd?s=128&d=identicon&r=PG", "display_name": "donkeyx", "link": "https://stackoverflow.com/users/456974/donkeyx"}, "edited": false, "score": 0, "creation_date": 1511910907, "post_id": 47525672, "comment_id": 82042162, "body": "Thanks for the comments guys, its appreciated. I will maybe compare the content length of the put and get as well as the status on each end."}], "owner": {"reputation": 476, "user_id": 456974, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/21ac396f360201c1358e528a53083abd?s=128&d=identicon&r=PG", "display_name": "donkeyx", "link": "https://stackoverflow.com/users/456974/donkeyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1511880454, "creation_date": 1511852300, "last_edit_date": 1511880454, "question_id": 47525672, "link": "https://stackoverflow.com/questions/47525672/stream-file-from-one-http-endpoint-to-another", "title": "Stream file from one http endpoint to another", "body": "<p>I am trying to stream a file from one http endpoint to another, and avoid storing large files on disk. I thought I had working with this code, but it is creating empty files: </p>\n\n<pre><code>    // out, err := os.Create(key)\n    resp, err := http.Get(\"http://source_url.com/_content/\" + key)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer resp.Body.Close()\n\n    // now stream the file straight to the endpoint using put\n    req, err := http.NewRequest(\"PUT\", \"http://dest_url.com/_content/\"+key, resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Set(\"Content-Type\", \"application/octet-stream\")\n\n    client := &amp;http.Client{}\n    res, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(key, res.ContentLength, res.Status)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511863120, "post_id": 47525250, "comment_id": 82013503, "body": "Obviously not. Maybe you could explain why you think any of the receive or send could possibly execute."}], "answers": [{"comments": [{"owner": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511859990, "post_id": 47525732, "comment_id": 82011415, "body": "Why isn&#39;t this statement : &quot;case c := &lt;-ch1:&quot; enough to trigger the fact that receiver is ready? And this statement &quot;case ch1 &lt;- 1:&quot; enough to trigger that sender is ready? It seems to be enough, when two separate go-routines are running it, like below example suggested by @A-R"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511887491, "post_id": 47525732, "comment_id": 82030265, "body": "A single goroutine cannot make the send and receive both ready because the goroutine can only execute one branch of the select at a time."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1511887271, "last_edit_date": 1511887271, "creation_date": 1511852504, "answer_id": 47525732, "question_id": 47525250, "link": "https://stackoverflow.com/questions/47525250/in-the-go-select-construct-can-i-have-send-and-receive-to-unbuffered-channel-in/47525732#47525732", "title": "In the Go select construct, can I have send and receive to unbuffered channel in two case statements?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"noreferrer\">channel documentation says</a>:</p>\n\n<blockquote>\n  <p>If the capacity is zero or absent, the channel is unbuffered and communication succeeds only when both a sender and receiver are ready. </p>\n</blockquote>\n\n<p>The <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"noreferrer\">select documentation says</a>:</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection.</p>\n</blockquote>\n\n<p>The receive case cannot proceed because there's not a ready sender.  The send case cannot proceed because there's not a ready receiver.  The program deadlocks in the select.</p>\n\n<p>A single goroutine cannot make the send and receive both ready because the goroutine can only execute one branch of the select at a time. </p>\n\n<p>The program will loop forever if the channel is buffered (<a href=\"https://play.golang.org/p/YN5KYhQaes\" rel=\"noreferrer\">playground example</a>).</p>\n"}, {"comments": [{"owner": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511859744, "post_id": 47525746, "comment_id": 82011223, "body": "I meant why can&#39;t I do it using a single go routine as above."}, {"owner": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511860148, "post_id": 47525746, "comment_id": 82011504, "body": "@A-R - thanks for the edit, but really - I am not trying to get it working - I am trying to understand the reasoning."}, {"owner": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511863027, "post_id": 47525746, "comment_id": 82013435, "body": "Why isn&#39;t this statement : &quot;case c := &lt;-ch1:&quot; enough to trigger the fact that receiver is ready? And this statement &quot;case ch1 &lt;- 1:&quot; enough to trigger that sender is ready? It seems to be enough, when two separate go-routines are running it, like you suggested"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "edited": false, "score": 0, "creation_date": 1511865572, "post_id": 47525746, "comment_id": 82015285, "body": "it is by design, and this is good, in many situations we need unbuffered channels to make direct handshaking. when we need to send a data to another channel without direct handshaking we may use buffered channel so we don&#39;t care what time the other party receives data, in your code this code runs first: <code>case ch1 &lt;- 1</code> and it needs handshaking so simply use buffered channel then we are good to Go! in <code>select </code> all <code>case</code> statements run once from top down, not concurrently: try <a href=\"https://play.golang.org/p/-yqnFMUcBE\" rel=\"nofollow noreferrer\">this</a>"}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 3, "last_activity_date": 1511867875, "last_edit_date": 1511867875, "creation_date": 1511852579, "answer_id": 47525746, "question_id": 47525250, "link": "https://stackoverflow.com/questions/47525250/in-the-go-select-construct-can-i-have-send-and-receive-to-unbuffered-channel-in/47525746#47525746", "title": "In the Go select construct, can I have send and receive to unbuffered channel in two case statements?", "body": "<p>To unbuffered channel with one goroutine: <strong>No</strong> (Why: <strong>by design</strong>):<br>\nYou may use <strong>Buffered channel with one goroutine</strong> or<br>\n<strong>two goroutines using unbuffered channel</strong> to avoid <strong>deadlock</strong>:</p>\n\n<blockquote>\n  <p>If the channel is unbuffered, the sender blocks until the receiver has\n  received the value. If the channel has a buffer, the sender blocks\n  only until the value has been copied to the buffer; if the buffer is\n  full, this means waiting until some receiver has retrieved a value.</p>\n</blockquote>\n\n<hr>\n\n<p>1- Using <strong>buffered channel</strong>: The <code>main</code> itself is a <strong>goroutine</strong> and if you need do it in one goroutine you should use buffered channel like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch1 := make(chan int, 1)\n    for {\n        select {\n        case ch1 &lt;- 1:\n            fmt.Println(\"sent 1 \")\n        case c := &lt;-ch1:\n            fmt.Println(\" received \", c)\n        }\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>sent 1\n received  1\nsent 1\n received  1\nsent 1\n received  1\n</code></pre>\n\n<hr>\n\n<p>2- Using <strong>unbuffered channel</strong>: You may send and receive to unbuffered channel in two <code>case</code> statements in one <code>select</code>, and you need <strong>two goroutines</strong> here, see:</p>\n\n<p>Try <a href=\"https://play.golang.org/p/Ru5WdOsA3q\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    go ct(\"Alex\")\n    go ct(\"John\")\n    //select {}\n    time.Sleep(300 * time.Millisecond)\n}\nfunc ct(name string) {\n    for {\n        select {\n        case ch1 &lt;- 1:\n            fmt.Println(name, \"sent 1\")\n        case c := &lt;-ch1:\n            fmt.Println(name, \"received:\", c)\n        }\n        fmt.Println(name, \"waiting...\")\n        time.Sleep(100 * time.Millisecond)\n    }\n}\n\nvar ch1 = make(chan int)\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>John sent 1\nJohn waiting...\nAlex received: 1\nAlex waiting...\nJohn received: 1\nJohn waiting...\nAlex sent 1\nAlex waiting...\nJohn sent 1\nJohn waiting...\nAlex received: 1\nAlex waiting...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 935742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s93g5.jpg?s=128&g=1", "display_name": "Supratim Samanta", "link": "https://stackoverflow.com/users/935742/supratim-samanta"}, "is_accepted": false, "score": -1, "last_activity_date": 1584624071, "last_edit_date": 1584624071, "creation_date": 1584599275, "answer_id": 60751954, "question_id": 47525250, "link": "https://stackoverflow.com/questions/47525250/in-the-go-select-construct-can-i-have-send-and-receive-to-unbuffered-channel-in/60751954#60751954", "title": "In the Go select construct, can I have send and receive to unbuffered channel in two case statements?", "body": "<p>Your code is blocked in here :</p>\n\n<p><strong>case c := &lt;-ch1</strong></p>\n\n<p>as by doing this:</p>\n\n<p><strong>case ch1 &lt;- 1</strong></p>\n\n<p>you are not sending anything on the channel. This send construct is applicable for a channel or a generator function. 1 is not a channel nor a generator. This construct should be used like this:</p>\n\n<p><strong>case ch1 &lt;- someotherchannel</strong> // channel</p>\n\n<p>or</p>\n\n<p><strong>case ch1 &lt;- time.After(time.Duration(10*time.Second))</strong> // generator</p>\n\n<p>To send a message continuously in ch1, you will have to do it in a separate goroutine.</p>\n\n<pre><code>func main(){\nch1 := make(chan int)\ngo func(){\n    for{\n        ch1 &lt;- 1\n    }\n}()\ngo func() {\n    for {\n        select {\n        case c := &lt;-ch1:\n            fmt.Println(\" received \", c)\n        default:\n            fmt.Print(\"Nothin is here\")\n        }\n\n    }\n}()\n\ntime.Sleep(time.Duration(time.Second*10))\n</code></pre>\n\n<p>}</p>\n\n<p>There are 3 observations here:</p>\n\n<ol>\n<li>I am sending the message in a separate goroutine</li>\n<li>You should add a default case, sometimes otherwise you may see cpu spikes, if the for select construct is not doing anything.</li>\n<li>Never add a time.Sleep inside the for loop in a for-select construct</li>\n</ol>\n"}], "owner": {"reputation": 767, "user_id": 544499, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/T1cZO.jpg?s=128&g=1", "display_name": "Guruprasad GV", "link": "https://stackoverflow.com/users/544499/guruprasad-gv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2449, "favorite_count": 0, "accepted_answer_id": 47525732, "answer_count": 3, "score": 3, "last_activity_date": 1584624071, "creation_date": 1511850527, "last_edit_date": 1511859935, "question_id": 47525250, "link": "https://stackoverflow.com/questions/47525250/in-the-go-select-construct-can-i-have-send-and-receive-to-unbuffered-channel-in", "title": "In the Go select construct, can I have send and receive to unbuffered channel in two case statements?", "body": "<p>I am expecting this code to go in an infinite loop, sending and receiving the message. But it does not seem to either send or receive. Why?</p>\n\n<pre><code>go func() {\n    for {\n        select {\n        case ch1 &lt;- 1:\n            println(\"sent 1 \")\n        case c := &lt;-ch1:\n            println(\" received \", c)\n        }\n        time.Sleep(time.Second)\n    }\n}()\n</code></pre>\n"}, {"tags": ["docker", "go", "runtime"], "answers": [{"comments": [{"owner": {"reputation": 551, "user_id": 7254686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e48e3e7298422d80ea289093732e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/7254686/stephen"}, "edited": false, "score": 0, "creation_date": 1511850860, "post_id": 47524825, "comment_id": 82006660, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1511848418, "creation_date": 1511848418, "answer_id": 47524825, "question_id": 47524766, "link": "https://stackoverflow.com/questions/47524766/docker-and-go-runtime/47524825#47524825", "title": "Docker and GO runtime", "body": "<blockquote>\n  <p>My question is whether Docker requires GO runtime when it runs or not. I have read that docker itself is written in GO.</p>\n</blockquote>\n\n<p>No, it does not. And Go produces <a href=\"https://www.reddit.com/r/golang/comments/53nl4b/why_all_go_binaries_are_staticallylinked/\" rel=\"nofollow noreferrer\">statically linked binaries</a>, so it does not require any dll dependencies on runtime.</p>\n\n<p>For a more detailed list of actual Docker dependencies, see \"<a href=\"https://docs.docker.com/engine/installation/linux/docker-ce/binaries/#prerequisites\" rel=\"nofollow noreferrer\">Install Docker CE from binaries</a>\".</p>\n"}], "owner": {"reputation": 551, "user_id": 7254686, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/51e48e3e7298422d80ea289093732e8d?s=128&d=identicon&r=PG&f=1", "display_name": "Stephen", "link": "https://stackoverflow.com/users/7254686/stephen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 47524825, "answer_count": 1, "score": 2, "last_activity_date": 1511848520, "creation_date": 1511848094, "last_edit_date": 1511848520, "question_id": 47524766, "link": "https://stackoverflow.com/questions/47524766/docker-and-go-runtime", "title": "Docker and GO runtime", "body": "<p>First of all, I would call myself a C/C++ programmer. I do not have years of experiences on Docker or Go. Thus, my questions might be silly although I am writing this after putting my best efforts on Google search. </p>\n\n<p>My question is whether Docker requires GO runtime when it runs or not. I have read that docker itself is written in GO. I could see that a GO compiler is necessary to build a docker binary. Say, I build a docker binary on a build machine and remotely distribute. For example, I am building a .deb docker package on machine A, and distributes it for the users' machine B, C, D, E, and F. Do B, C, D, E, and F ever need GO installed to run my docker? </p>\n\n<p>If docker were written in C/C++ and linked with DLL(s), I would know the answer. If docker were written in C/C++ and statically linked, I would also know the answer. However, I do not know so well how a GO program runs and what particularly docker requires.</p>\n"}, {"tags": ["linux", "docker", "go", "containers"], "comments": [{"owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "edited": false, "score": 0, "creation_date": 1511845897, "post_id": 47524122, "comment_id": 82004903, "body": "Do your &quot;editing&quot; and build in the <code>Dockerfile</code> then <code>docker run --restart unless-stopped myapp main</code>"}, {"owner": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "edited": false, "score": 0, "creation_date": 1511851238, "post_id": 47524122, "comment_id": 82006795, "body": "How does your Dockerfile look like. Are you setting the application to run on container start up?"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1511854236, "post_id": 47524122, "comment_id": 82008119, "body": "Stack Overflow is a site for programming and development questions. This question appears to be off-topic because it is not about programming or development. See <a href=\"http://stackoverflow.com/help/on-topic\">What topics can I ask about here</a> in the Help Center. Perhaps <a href=\"http://superuser.com/\">Super User</a> or <a href=\"http://unix.stackexchange.com/\">Unix &amp; Linux Stack Exchange</a> would be a better place to ask."}, {"owner": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "reply_to_user": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "edited": false, "score": 0, "creation_date": 1511856018, "post_id": 47524122, "comment_id": 82009045, "body": "@foecum I have changeable configs cause of network, that&#39;s why I have to edit container. Dockefile looks like: FROM golang:1.8  WORKDIR /go/src/app COPY . .  RUN go-wrapper download   # &quot;go get -d -v ./...&quot; RUN go-wrapper install    # &quot;go install -v ./...&quot; RUN [&quot;apt-get&quot;,&quot;update&quot;] RUN [&quot;apt-get&quot;,&quot;install&quot;,&quot;-y&quot;,&quot;vim&quot;] EXPOSE 3000  CMD [&quot;app&quot;]"}, {"owner": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "edited": false, "score": 0, "creation_date": 1511858890, "post_id": 47524122, "comment_id": 82010703, "body": "My suggestion is for you to have different docker files to run that override the config that you are always editing. that way when the app is started you always have the correct config and you won&#39;t need to edit the file everytime"}, {"owner": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "edited": false, "score": 0, "creation_date": 1511858922, "post_id": 47524122, "comment_id": 82010729, "body": "here is a link to the docker build/run options <a href=\"https://docs.docker.com/engine/reference/commandline/build/#options\" rel=\"nofollow noreferrer\">docs.docker.com/engine/reference/commandline/build/#options</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4800, "user_id": 4930423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d0eea67e2712f2444609d636a6e9ca?s=128&d=identicon&r=PG", "display_name": "programmerq", "link": "https://stackoverflow.com/users/4930423/programmerq"}, "is_accepted": true, "score": 1, "last_activity_date": 1511892319, "creation_date": 1511892319, "answer_id": 47538167, "question_id": 47524122, "link": "https://stackoverflow.com/questions/47524122/why-app-in-docker-container-doesnt-restart/47538167#47538167", "title": "Why app in docker container doesn&#39;t restart?", "body": "<p>When you create a container and pass in <code>/bin/bash</code> as the command, that's as far as Docker cares. When the container restarts, it will start up another instance of <code>/bin/bash</code>.</p>\n\n<p>Docker doesn't watch your shell session and see what things you do after it starts the command. If you want to actually run <code>./main</code> as the command of the container, then you'll need to pass in <code>/go/src/app/main</code> as the command instead of <code>/bin/bash</code>.</p>\n\n<p>Additionally, compiling code is something better done during the image build phase instead of at container runtime.</p>\n"}], "owner": {"reputation": 137, "user_id": 4412626, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2abd6052249d23b37122aef8bc311b31?s=128&d=identicon&r=PG&f=1", "display_name": "\u042e\u0440\u0438\u0439 \u0428\u0438\u043f\u043e\u0432\u0430\u043b\u043e\u0432", "link": "https://stackoverflow.com/users/4412626/%d0%ae%d1%80%d0%b8%d0%b9-%d0%a8%d0%b8%d0%bf%d0%be%d0%b2%d0%b0%d0%bb%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 47538167, "answer_count": 1, "score": 0, "last_activity_date": 1511892319, "creation_date": 1511843919, "last_edit_date": 1511859552, "question_id": 47524122, "link": "https://stackoverflow.com/questions/47524122/why-app-in-docker-container-doesnt-restart", "title": "Why app in docker container doesn&#39;t restart?", "body": "<p>I've deployed some docker containers with golang apps. One of them I need to start by this command:</p>\n\n<pre><code>docker run --restart unless-stopped -it myapp /bin/bash\n</code></pre>\n\n<p>The next step I enter the container and edit some config files, then I run </p>\n\n<pre><code>go build main.go\n</code></pre>\n\n<p>and <code>./main</code>\nAfter that I press ctrl+q and leave it out.\nEverything works perfectly and all my containers restart perfectly after restarting server. But there is one issue, when myapp container restarts, the golang application doesn't run while container still works. I have to enter this again and run <code>./main</code>. How can I fixed it? </p>\n\n<p><strong>Dockerfile</strong></p>\n\n<pre><code>FROM golang:1.8 \nWORKDIR /go/src/app \nCOPY . . \nRUN go-wrapper download # \"go get -d -v ./...\" \nRUN go-wrapper install # \"go install -v ./...\" RUN [\"apt-get\",\"update\"] \nRUN [\"apt-get\",\"install\",\"-y\",\"vim\"] \nEXPOSE 3000 \nCMD [\"app\"]\n</code></pre>\n"}, {"tags": ["c", "go", "data-structures", "struct", "linked-list"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1511836931, "post_id": 47523070, "comment_id": 82002521, "body": "Go is not very good at implementing generic data structures."}, {"owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "edited": false, "score": 0, "creation_date": 1511839177, "post_id": 47523070, "comment_id": 82003051, "body": "<code>token_list_elt</code> is the struct, and <code>token_list</code> is a pointer to the struct.  Is there a reason that you cannot simply translate the code by explicitly instantiating all <code>token_list</code> types as <code>&amp;token_list_elt{ ... }</code> in the go code?"}, {"owner": {"reputation": 872, "user_id": 3875321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/44b3686b859ea5e4f03f079bc8b574ee?s=128&d=identicon&r=PG", "display_name": "nathanielobrown", "link": "https://stackoverflow.com/users/3875321/nathanielobrown"}, "edited": false, "score": 0, "creation_date": 1511840511, "post_id": 47523070, "comment_id": 82003411, "body": "This was a bad example, other struct definitions are used for more than just two types where one type is a pointer like I showed here."}], "answers": [{"comments": [{"owner": {"reputation": 872, "user_id": 3875321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/44b3686b859ea5e4f03f079bc8b574ee?s=128&d=identicon&r=PG", "display_name": "nathanielobrown", "link": "https://stackoverflow.com/users/3875321/nathanielobrown"}, "edited": false, "score": 0, "creation_date": 1511840409, "post_id": 47523446, "comment_id": 82003383, "body": "I think you are right. Having different types of lists is really not that beneficial. I will just use one type."}], "tags": [], "owner": {"reputation": 588, "user_id": 6107031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1d3E0.png?s=128&g=1", "display_name": "Armatorix", "link": "https://stackoverflow.com/users/6107031/armatorix"}, "is_accepted": true, "score": 1, "last_activity_date": 1511839260, "creation_date": 1511839260, "answer_id": 47523446, "question_id": 47523070, "link": "https://stackoverflow.com/questions/47523070/recursive-linked-list-type-alias-in-go/47523446#47523446", "title": "Recursive linked list type alias in Go", "body": "<p>But why not use it like this:</p>\n\n<pre><code>type linkedList struct {\n    item token\n    next *linkedList\n}\n\n...\n\ntokenList := linkedList{}\ntokenListElt := linkedList{}\n</code></pre>\n\n<p>Are different struct types so important?</p>\n"}], "owner": {"reputation": 872, "user_id": 3875321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/44b3686b859ea5e4f03f079bc8b574ee?s=128&d=identicon&r=PG", "display_name": "nathanielobrown", "link": "https://stackoverflow.com/users/3875321/nathanielobrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 47523446, "answer_count": 1, "score": 1, "last_activity_date": 1511839260, "creation_date": 1511836691, "last_edit_date": 1511837835, "question_id": 47523070, "link": "https://stackoverflow.com/questions/47523070/recursive-linked-list-type-alias-in-go", "title": "Recursive linked list type alias in Go", "body": "<p>I am trying to translate some C code to Go and I'm wondering if there is a Go equivalent to the following linked list types:</p>\n\n<pre><code>typedef struct TOKENLIST {\n  token item;\n  struct TOKENLIST *next;\n} token_list_elt, *token_list;\n</code></pre>\n\n<p>So far it appears that I would have to create both types separately like this:</p>\n\n<pre><code>type token_list struct {\n    item token\n    next *token_list\n}\ntype token_list_elt struct {\n    item token\n    next *token_list_elt\n}\n</code></pre>\n\n<p>This is not such a big deal for this example, but there are lots linked list types like these I need to translate and some of them have many aliases and/or struct fields.</p>\n"}, {"tags": ["go", "plugins"], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 1107282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Gt61o.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1107282/brian"}, "edited": false, "score": 0, "creation_date": 1511876810, "post_id": 47530699, "comment_id": 82022764, "body": "Ok, so the correct approach would be to separate the common package into a separate project altogether, and then have both reference that independent project? That makes sense. If it is later moved to a new machine, will it still work correctly with the main app being compiled on the original machine?"}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "reply_to_user": {"reputation": 414, "user_id": 1107282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Gt61o.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1107282/brian"}, "edited": false, "score": 0, "creation_date": 1511885149, "post_id": 47530699, "comment_id": 82028703, "body": "Yes the idea is to keep the common package at a stable import url - go will see different urls as different packages. So fix that and it should work fine. If a separate project you could call it plugins or something like that and make it support functions for plugins, along with a readme which explains how to build one."}, {"owner": {"reputation": 414, "user_id": 1107282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Gt61o.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1107282/brian"}, "edited": false, "score": 0, "creation_date": 1511893310, "post_id": 47530699, "comment_id": 82033716, "body": "Gotcha! I tried that, and it appears to solve my issue. Much appreciated."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 1, "last_activity_date": 1511869267, "creation_date": 1511869267, "answer_id": 47530699, "question_id": 47522358, "link": "https://stackoverflow.com/questions/47522358/golang-package-versions-between-plugin-and-main-application/47530699#47530699", "title": "Golang package versions between plugin and main application", "body": "<p>Have you tried instead keeping the path of the common package stable? You should probably have that in its own repo (so that both projects can refer to it), or keep it in your app repo, but allow plugins to link to it there.</p>\n\n<p>So for example say your project lives at:</p>\n\n<p>github.com/brianwest/myapp</p>\n\n<p>you could make the import path (for both app and plugins): </p>\n\n<p>github.com/brianwest/myapp/src/common</p>\n\n<p>OR </p>\n\n<p>github.com/brianwest/common</p>\n\n<p>and keep it stable across the app and plugins, then it should just work and you won't need the script to copy it into gopath, or if you do it can put it at src/github.com/brianwest/common and use that path in both plugins and your app. </p>\n"}], "owner": {"reputation": 414, "user_id": 1107282, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Gt61o.jpg?s=128&g=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/1107282/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 1, "accepted_answer_id": 47530699, "answer_count": 1, "score": 0, "last_activity_date": 1511869267, "creation_date": 1511831048, "last_edit_date": 1511842549, "question_id": 47522358, "link": "https://stackoverflow.com/questions/47522358/golang-package-versions-between-plugin-and-main-application", "title": "Golang package versions between plugin and main application", "body": "<p>I'm not a Go expert, so I may be doing this in a way that is not the ideal approach for Go. Essentially, I have a main application that needs to be able to have plugins written for it. The plugins all adhere to a given format and are built with <code>go build -buildmode=plugin</code>. I don't want the end user to need to recompile the main application every time. Ideally, you should be able to drag and drop it to a new computer without issue.</p>\n\n<p>To pass information between the plugins and the application, I have a third package defined called \"common\" that I treat similar to a C-header file. It only defines interfaces and a few integer constants that both can use. The application generates types that adhere to the interface and can pass them to the plugins to use.</p>\n\n<p>When I compile, it seems to work fine, and the application can load the plugins using <code>plugin.Open</code>. The catch comes when trying to move the location of the <code>common</code> package. I built the original application in a local directory and I have a script that installs the application and the copies the <code>common</code> package into the <code>GOPATH</code> so that it can be found. Now, when I try to create plugins and compile them referencing the global copy of the <code>common</code> package, I can't load them in the main application because it sees the two occurrences of the package as being different versions.</p>\n\n<p>My understanding is that to determine package version, a hash is made of all the Go files in the package at compile time. Is this hash including the location on the server where the package was found as well?</p>\n\n<p>I know for a fact that the actual versions of the packages are identical. The only different is that I did <code>cp -r src/myapp /usr/local/go/src</code>. Is there a better way to accomplish this than my approach that still allows the user to move the main application around to different machines and not need to recompile it?</p>\n\n<p>Further explanation:</p>\n\n<p>Here is my directory structure</p>\n\n<pre><code>./\n   |-- main.go \n   |-- src/myapp/common\n   |      |-- Common.go\n   |-- install.sh\n</code></pre>\n\n<p>Once I compile this into <code>myapp</code>, I copy <code>src/myapp/common</code> into the <code>GOPATH</code> and then build plugins with <code>go build -buildmode=plugin</code> against that package. When loading those plugins from <code>myapp</code>, it sees the two versions of <code>myapp/common</code> as being different, although the only difference is location on the server.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1511825547, "post_id": 47521522, "comment_id": 81999726, "body": "What it&#39;s telling you is completely correct. <code>test</code> is a <code>func(impl)</code> and not a <code>func(myinteface)</code> and can&#39;t be used as a <code>func(myinteface)</code>."}, {"owner": {"reputation": 5187, "user_id": 2759075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OUIOd.png?s=128&g=1", "display_name": "Yaron Schwimmer", "link": "https://stackoverflow.com/users/2759075/yaron-schwimmer"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1511825810, "post_id": 47521522, "comment_id": 81999797, "body": "I know it&#39;s correct... but <code>impl</code> does satisfy <code>myinterface</code>, so I want to know if I can tell that a function has an implementation of that interface in its signature"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1511825852, "post_id": 47521522, "comment_id": 81999807, "body": "What @hobbs said, and addition: function types are <i>invariant</i> in Golang (as well as arrays and slices). Searching by that term would lead to a lot of various relevant articles."}, {"owner": {"reputation": 5187, "user_id": 2759075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OUIOd.png?s=128&g=1", "display_name": "Yaron Schwimmer", "link": "https://stackoverflow.com/users/2759075/yaron-schwimmer"}, "edited": false, "score": 0, "creation_date": 1511826012, "post_id": 47521522, "comment_id": 81999848, "body": "Obviously I can&#39;t do what I was trying to do. Evidently it doesn&#39;t work. What I&#39;m asking is if there is way to do this check in some other way"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1511826107, "post_id": 47521522, "comment_id": 81999878, "body": "I think you can take a reflection and implement a type checker that could introduce covariance in this particular case, but it sounds complicated and error-prone. It would be better to reconsider the original design that does not require it."}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1511853365, "last_edit_date": 1511853365, "creation_date": 1511852898, "answer_id": 47525839, "question_id": 47521522, "link": "https://stackoverflow.com/questions/47521522/type-switch-to-validate-function-by-interface/47525839#47525839", "title": "Type switch to validate function by interface", "body": "<p>You may check arguments type manually using <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package. Here's an example for <code>myinteface</code>. I check whether first parameter <code>Implements</code> desired interface. For brevity I suppose function has only one obligatory argument. For production it's better to check number of arguments (commented out string with <code>NumIn()</code>) and all their types in a cycle. </p>\n\n<pre><code>func do(i interface{}) {\n    val := reflect.ValueOf(i)\n    typ := val.Type()\n    // numIn := typ.NumIn()\n    arg0 := typ.In(0)\n    modelType := reflect.TypeOf((*myinteface)(nil)).Elem()\n    if arg0.Implements(modelType) {\n        fmt.Println(\"OK\")\n    } else {\n        fmt.Println(\"not OK\")\n    }\n}\n</code></pre>\n\n<p>Also, please pay attention to a receiver type: value or pointer. For example, here only <code>test2</code> function argument implements <code>myinteface</code>, but <code>test</code> doesn't because of the pointer receiver on the struct <code>impl</code>.</p>\n\n<pre><code>func test(im impl) {}\n\nfunc test2(im *impl) {}\n\nfunc main() {\n    do(test)\n    do(test2)\n}\n</code></pre>\n\n<p>Demo: <a href=\"https://play.golang.org/p/ZDZKZIh2lW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZDZKZIh2lW</a></p>\n\n<p>If you change struct definition to value receiver then both function's arguments implement it:</p>\n\n<pre><code>type impl struct{}\n\nfunc (im impl) DoSomething(int) string {\n    return \"fsdfsd\"\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xvasgBs-_a\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xvasgBs-_a</a></p>\n"}, {"tags": [], "owner": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "is_accepted": false, "score": 0, "last_activity_date": 1511866431, "creation_date": 1511866431, "answer_id": 47529783, "question_id": 47521522, "link": "https://stackoverflow.com/questions/47521522/type-switch-to-validate-function-by-interface/47529783#47529783", "title": "Type switch to validate function by interface", "body": "<p>From your question it is a little hard to tell what you want to assert about the function. I wrote up something that I think does what you need.</p>\n\n<p>Note that the function <code>test</code> in your question did not take a parameter that implements <code>myinteface</code> as it was not a pointer.  </p>\n\n<p>As mentoined, you probably need to find a different solution to your problem you are trying to solve using this.   </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"reflect\"\n\ntype myinteface interface {\n    DoSomething(int) string\n}\n\ntype myfunc func(myinteface)\n\ntype impl struct{}\n\nfunc (im *impl) DoSomething(int) string {\n    return \"fsdfsd\"\n}\n\n//Does the function passed as `i` take a type that implements the `myinteface` type as first parameter\nfunc do(i interface{}) {\n    functionType := reflect.TypeOf(i)\n    if functionType.Kind() != reflect.Func {\n        fmt.Printf(\"(%s) is not a function\", functionType)\n    }\n    ourInterfaceType := reflect.TypeOf((*myinteface)(nil)).Elem()\n    if functionType.In(0).Implements(ourInterfaceType) {\n        fmt.Printf(\"(%s)'s first paramter implements the `myinteface` interface\\n\", functionType)\n    } else {\n        fmt.Printf(\"(%s)'s first paramter does not implement the `myinteface` interface\\n\", functionType)\n    }\n}\n\nfunc test(im *impl) {}\nfunc test2(im impl) {}\n\nfunc main() {\n    do(test)\n    do(test2)\n}\n</code></pre>\n"}], "owner": {"reputation": 5187, "user_id": 2759075, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/OUIOd.png?s=128&g=1", "display_name": "Yaron Schwimmer", "link": "https://stackoverflow.com/users/2759075/yaron-schwimmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1539, "favorite_count": 1, "accepted_answer_id": 47525839, "answer_count": 2, "score": 2, "last_activity_date": 1511866431, "creation_date": 1511825344, "last_edit_date": 1511825654, "question_id": 47521522, "link": "https://stackoverflow.com/questions/47521522/type-switch-to-validate-function-by-interface", "title": "Type switch to validate function by interface", "body": "<p>I want to test a given function in runtime, to verify that it matches a certain signature. It's sufficient that this signature complies with some interface, not a specific implementation. </p>\n\n<p>I can't seem to find the right pattern to do such validation. In runtime, the function's type is using the implementation.</p>\n\n<p>How can I compare the function's signature to the interface?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype myinteface interface{\n    DoSomething(int) string\n}\n\ntype myfunc func(myinteface)\n\ntype impl struct {}\n\nfunc (im *impl) DoSomething(int) string{\n    return \"fsdfsd\"\n}\n\nfunc do(i interface{}) {\n    switch v := i.(type) {\n    case func(myinteface):  \n        fmt.Print(\"doesn't stop here\")\n    case func(impl):    \n        fmt.Print(\"this does work\")\n    default:\n        fmt.Printf(\"I don't know about type %T!\\n\", v)\n    }\n}\n\nfunc test(im impl) {}\n\nfunc main() {\n    do(test)\n}\n</code></pre>\n\n<p>see it live in <a href=\"https://play.golang.org/p/q578dXUR8Z\" rel=\"nofollow noreferrer\">playground</a></p>\n"}, {"tags": ["c", "go", "biginteger", "gmp"], "comments": [{"owner": {"reputation": 1121, "user_id": 2150289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1256cfbd4bb053bad532320ad570f9a5?s=128&d=identicon&r=PG", "display_name": "maharvey67", "link": "https://stackoverflow.com/users/2150289/maharvey67"}, "edited": false, "score": 1, "creation_date": 1511823077, "post_id": 47520988, "comment_id": 81998851, "body": "Are you converting to an ascii string, or an array of bytes? Those are very different things. If the latter you might want to look at mpz_import/mpz_export"}, {"owner": {"reputation": 1, "user_id": 4381694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2909ca5c92b8697325689087d3549792?s=128&d=identicon&r=PG", "display_name": "jhd", "link": "https://stackoverflow.com/users/4381694/jhd"}, "reply_to_user": {"reputation": 1121, "user_id": 2150289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1256cfbd4bb053bad532320ad570f9a5?s=128&d=identicon&r=PG", "display_name": "maharvey67", "link": "https://stackoverflow.com/users/2150289/maharvey67"}, "edited": false, "score": 0, "creation_date": 1511823377, "post_id": 47520988, "comment_id": 81998950, "body": "I m looking to convert an mpz to an unsigned char array (byte array equivalent in C)"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1511866752, "post_id": 47520988, "comment_id": 82016137, "body": "Would browsing the page <a href=\"https://gmplib.org/manual/Integer-Import-and-Export.html#Integer-Import-and-Export\" rel=\"nofollow noreferrer\">gmplib.org/manual/&hellip;</a> help? Exporting seems to be what you want."}, {"owner": {"reputation": 1, "user_id": 4381694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2909ca5c92b8697325689087d3549792?s=128&d=identicon&r=PG", "display_name": "jhd", "link": "https://stackoverflow.com/users/4381694/jhd"}, "edited": false, "score": 0, "creation_date": 1511869753, "post_id": 47520988, "comment_id": 82018051, "body": "yes but i dont know how to export as unsigned char array :/"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1511875124, "post_id": 47520988, "comment_id": 82021590, "body": "Allocate the proper size and pass it as the <code>rop</code> argument. The function will fill the array with the requested data (be sure to pass the appropriate <code>order</code> and <code>endian</code> arguments, and perhaps <code>nails</code> too)."}], "owner": {"reputation": 1, "user_id": 4381694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2909ca5c92b8697325689087d3549792?s=128&d=identicon&r=PG", "display_name": "jhd", "link": "https://stackoverflow.com/users/4381694/jhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1511822058, "creation_date": 1511822058, "question_id": 47520988, "link": "https://stackoverflow.com/questions/47520988/c-help-converting-mpz-to-unsigned-char-array", "title": "C help - Converting mpz to unsigned char array", "body": "<p>I m learning C an I have ome issues.</p>\n\n<p>First, i m using library gmp and I need to convert a mpzt to an unsigned char array.</p>\n\n<p>I already lookup on documentation but I dont find anything. Maybe using mpz_get_str but I dont known how.</p>\n\n<p>More over I have to convert 2 functions from GoLang to C but I have some trouble</p>\n\n<p>Here is the two GoLang func:</p>\n\n<pre><code>    // paddedAppend appends the src byte slice to dst, returning the new slice.\n// If the length of the source is smaller than the passed size, leading zero\n// bytes are appended to the dst slice before appending src.\nfunc paddedAppend(size uint, dst, src []byte) []byte {\n  for i := 0; i &lt; int(size)-len(src); i++ {\n    dst = append(dst, 0)\n  }\n  return append(dst, src...)\n}\n\nfunc isOdd(a *big.Int) bool {\n  return a.Bit(0) == 1\n}\n\n// SerializeUncompressed serializes a public key in a 65-byte uncompressed format.\nfunc SerializeUncompressed(x *big.Int, y *big.Int) []byte {\n  b := make([]byte, 0, PubKeyBytesLenUncompressed)\n  b = append(b, pubkeyUncompressed)\n  b = paddedAppend(32, b, x.Bytes())\n  return paddedAppend(32, b, y.Bytes())\n}\n\n// SerializeCompressed serializes a public key in a 33-byte compressed format.\nfunc SerializeCompressed(x *big.Int, y *big.Int) []byte {\n  b := make([]byte, 0, PubKeyBytesLenCompressed)\n  format := pubkeyCompressed\n  if isOdd(y) {\n    format |= 0x1\n  }\n  b = append(b, format)\n  return paddedAppend(32, b, x.Bytes())\n}\n</code></pre>\n\n<p>Every help will be appreciated ! Thanx in advance</p>\n"}, {"tags": ["docker", "go", "dns", "debian", "docker-compose"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 7761319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70caee01f7717ad1aad14aa2932d589d?s=128&d=identicon&r=PG&f=1", "display_name": "MrBlobby", "link": "https://stackoverflow.com/users/7761319/mrblobby"}, "edited": false, "score": 0, "creation_date": 1511823930, "post_id": 47521141, "comment_id": 81999161, "body": "I am still a little lost, if I am wrong let me know. So far I have &#39;installed&#39; <b>it</b> but I have not ran <b>it</b>, sort of like.. I have downloaded CC cleaner, installed it but not clicked the icon to run the program. To do that I would need to do things like &quot;docker run docker_ddns-web&quot; which would launch said action. I have attempted it and I noticed this (<a href=\"https://i.gyazo.com/de83745f463ecbd00c4466aede08c685.png\" rel=\"nofollow noreferrer\">i.gyazo.com/de83745f463ecbd00c4466aede08c685.png</a>), have I installed this into the wrong directories?"}, {"owner": {"reputation": 318, "user_id": 725997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48e13d73417ae5a21c72f6e62825b8?s=128&d=identicon&r=PG", "display_name": "paulski", "link": "https://stackoverflow.com/users/725997/paulski"}, "reply_to_user": {"reputation": 61, "user_id": 7761319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70caee01f7717ad1aad14aa2932d589d?s=128&d=identicon&r=PG&f=1", "display_name": "MrBlobby", "link": "https://stackoverflow.com/users/7761319/mrblobby"}, "edited": false, "score": 0, "creation_date": 1511895631, "post_id": 47521141, "comment_id": 82034916, "body": "So I didn&#39;t actually look at the docker-compose.yml file that closely when I posted, but if you look at the yaml for the <code>ddns-web</code> it says that it mounts a volume and depends on a redis container already existing. You probably want to run <code>docker-compose up</code> like @Leon said to interact with the web container, and exec inside to run any one-off commands. Or mount the volume manually using the -v option to docker run. You might also want to start by understanding docker first, then move on to docker-compose. Docker-compose is for setting up a more complex environment of docker images"}, {"owner": {"reputation": 61, "user_id": 7761319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70caee01f7717ad1aad14aa2932d589d?s=128&d=identicon&r=PG&f=1", "display_name": "MrBlobby", "link": "https://stackoverflow.com/users/7761319/mrblobby"}, "edited": false, "score": 0, "creation_date": 1512039046, "post_id": 47521141, "comment_id": 82100246, "body": "Thanks for the message paulski, I believe the actual docker build I provided above is not currently working, the master build is also not working/outdated and the original creator is not wanting to provide any further information as to versions he used, he has simply stated &#39;if you do not have the knowledge to set this up, you should not be hosting it and you can use my hosted version&#39; which leads me to believe he is using github to advertise his own DDNS provider which will likely turn pay to use once enough people use it, thanks for your help anyway mate."}], "tags": [], "owner": {"reputation": 318, "user_id": 725997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b48e13d73417ae5a21c72f6e62825b8?s=128&d=identicon&r=PG", "display_name": "paulski", "link": "https://stackoverflow.com/users/725997/paulski"}, "is_accepted": false, "score": 0, "last_activity_date": 1511893509, "last_edit_date": 1511893509, "creation_date": 1511823050, "answer_id": 47521141, "question_id": 47520870, "link": "https://stackoverflow.com/questions/47520870/setting-up-a-container-from-a-users-github-source/47521141#47521141", "title": "Setting up a container from a users github source", "body": "<p>The instructions it runs that you probably care about are in the Dockerfile, which for that repo is in the docker/ddns/ directory. What you're missing is that Dockerfile creates an image, which is a template to create an instance. Every time you docker run you'll create a new instance from the image. <code>docker run docker_ddns go version</code> will create a new instance of the image, run go version and output it, then die. Running long running processes like the <code>docker_ddns-web</code> image probably does will run the process until something kills that process. The reason you can't see the web page is probably because you haven't run <code>docker-compose up</code> yet, which will create linked instances of all of the docker images specified in the docker-compose.yml file. Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 7761319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70caee01f7717ad1aad14aa2932d589d?s=128&d=identicon&r=PG&f=1", "display_name": "MrBlobby", "link": "https://stackoverflow.com/users/7761319/mrblobby"}, "edited": false, "score": 0, "creation_date": 1511824594, "post_id": 47521280, "comment_id": 81999436, "body": "You&#39;re talking to me like I understand what docker is, I have literally never used it before since 2 hours ago? Literally none of what you said I can relate to in my case, at all."}, {"owner": {"reputation": 5480, "user_id": 1264360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed97babb5c190f0eacce8cb27affe733?s=128&d=identicon&r=PG", "display_name": "Shawn C.", "link": "https://stackoverflow.com/users/1264360/shawn-c"}, "edited": false, "score": 0, "creation_date": 1511843526, "post_id": 47521280, "comment_id": 82004226, "body": "Actually, Leon is correct. You built the images. You didn&#39;t state that you did anything like <code>docker-compose up</code> which would start the containers. The command <code>docker images</code> just shows what images are available on the machine."}], "tags": [], "owner": {"reputation": 11, "user_id": 8556446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9293c638f753c4a26b2989ae60eb233c?s=128&d=identicon&r=PG&f=1", "display_name": "LeGre", "link": "https://stackoverflow.com/users/8556446/legre"}, "is_accepted": false, "score": 0, "last_activity_date": 1511890730, "last_edit_date": 1511890730, "creation_date": 1511823786, "answer_id": 47521280, "question_id": 47520870, "link": "https://stackoverflow.com/questions/47520870/setting-up-a-container-from-a-users-github-source/47521280#47521280", "title": "Setting up a container from a users github source", "body": "<p><code>docker-compose build</code> will only build the images. </p>\n\n<p>You need to run this. It will build and run them.</p>\n\n<pre><code>docker-compose up -d\n</code></pre>\n\n<p>The <code>-d</code> option runs containers in the background</p>\n\n<p>To check if it's running after <code>docker-compose up</code></p>\n\n<pre><code>docker-compose ps\n</code></pre>\n\n<p>It will show what is running and what ports are exposed from the container.\nUsually you can access services from your <code>localhost</code></p>\n\n<p>If you want to have a look inside the container </p>\n\n<pre><code>docker-compose exec SERVICE /bin/bash\n</code></pre>\n\n<p>Where SERVICE is the name of the service in <code>docker-compose.yml</code></p>\n"}], "owner": {"reputation": 61, "user_id": 7761319, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70caee01f7717ad1aad14aa2932d589d?s=128&d=identicon&r=PG&f=1", "display_name": "MrBlobby", "link": "https://stackoverflow.com/users/7761319/mrblobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1512039087, "creation_date": 1511821472, "last_edit_date": 1512039087, "question_id": 47520870, "link": "https://stackoverflow.com/questions/47520870/setting-up-a-container-from-a-users-github-source", "title": "Setting up a container from a users github source", "body": "<p><strong>Can be closed, not sure how to do it.</strong></p>\n\n<p>I am to be quite frank lost right now, the user whom published his source on github somehow failed to update the installation instructions when he released a new branch. Now, I am not dense, just uneducated when it comes to docker. I would really appreciate a push in the right direction. If I am missing any information from this post, please allow me to provide it in the comments.</p>\n\n<p><strong>Current Setup</strong></p>\n\n<ul>\n<li><strong>O/S</strong> - Debian 8 Minimal (Latest kernel)</li>\n<li><strong>Hardware</strong> - 1GB VPS (KVM)</li>\n<li><strong>Docker</strong> - Installed with Compose (<a href=\"https://i.gyazo.com/60ea982c10d61bf3b0e659facdb052db.png\" rel=\"nofollow noreferrer\"># docker info</a>)</li>\n</ul>\n\n<p>I am attempting to setup this (<a href=\"https://github.com/pboehm/ddns/tree/docker_and_rework\" rel=\"nofollow noreferrer\">https://github.com/pboehm/ddns/tree/docker_and_rework</a>), first I should clone this git to my working directory? Lets say /home for example. I will run the following command;</p>\n\n<pre><code>git clone -b docker_and_rework https://github.com/pboehm/ddns.git\n</code></pre>\n\n<p>Which has successfully cloned the source files into /home/ddns/... (<a href=\"https://i.gyazo.com/6985c70c5ac9df46e3dd95ac82c290d2.png\" rel=\"nofollow noreferrer\">working dir</a>)</p>\n\n<p>Now I believe I am supposed to go ahead and build something*, so I go into the following directory;</p>\n\n<pre><code>/home/ddns/docker\n</code></pre>\n\n<p>Inside contains a docker-compose.yml file, I am not sure what this does but by looking at it, it appears to be sending a bunch of instructions which I can only presume is to do with actually deploying or building the whole container/image or magical thing right? From here I go ahead and do the following;</p>\n\n<pre><code>docker-compose build\n</code></pre>\n\n<p>As we can see, I believe its building the container or image or whatever its called, you get my point (<a href=\"https://i.gyazo.com/4a08555af74664d8df0f083c2133c268.png\" rel=\"nofollow noreferrer\">here</a>). After a short while, that completes and we can see the following (<a href=\"https://i.gyazo.com/17fa869bf79924d66bf6c9583fc42fc7.png\" rel=\"nofollow noreferrer\">docker images running</a>). Which is correct, I see all of the dependencies in there, but things like;</p>\n\n<pre><code>go version\n</code></pre>\n\n<p>It does not show as a command, so I presume I need to run it inside the container maybe? If so I dont have a clue how, I need to run 'ddns.go' which is inside /home/ddns, the execution command is;</p>\n\n<pre><code>ddns --soa_fqdn=dns.stealthy.pro --domain=d.stealthy.pro backend\n</code></pre>\n\n<p>I am also curious why the front end web page is not showing? There should be a page like this;</p>\n\n<p><a href=\"http://ddns.pboehm.org/\" rel=\"nofollow noreferrer\">http://ddns.pboehm.org/</a></p>\n\n<p>But again, I believe there is some more to do I just do not know what??</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1511808436, "post_id": 47517270, "comment_id": 81991681, "body": "You have to construct a temporary slice of string, set index 0 to the map key and append the map value."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 8697436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d3cf70e4890086f8f57ea38ea81b0?s=128&d=identicon&r=PG&f=1", "display_name": "Dangle", "link": "https://stackoverflow.com/users/8697436/dangle"}, "edited": false, "score": 0, "creation_date": 1511810777, "post_id": 47517824, "comment_id": 81992853, "body": "Thanks! I&#39;m a little new to the language some of the docs are a tad confusing, this makes perfect sense, was attempting to avoid making a temporary slice but it seems that would be the way to do it.  Thanks!"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 95, "user_id": 8697436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d3cf70e4890086f8f57ea38ea81b0?s=128&d=identicon&r=PG&f=1", "display_name": "Dangle", "link": "https://stackoverflow.com/users/8697436/dangle"}, "edited": false, "score": 2, "creation_date": 1511811596, "post_id": 47517824, "comment_id": 81993286, "body": "@Dangle: A slice is a <code>struct</code> with a length, a capacity, and a pointer to an underlying array, 24  ( 3 *( 64 / 8)) bytes on a 64-bit architecture. <code>make([]string, 0, 1+len(value))</code> allocated the exact size for the slice&#39;s underlying array of <code>string</code>s, which avoids reallocations during <code>append</code>. A <code>string</code> is a <code>struct</code> with a length and a pointer to the underlying string bytes."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 95, "user_id": 8697436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d3cf70e4890086f8f57ea38ea81b0?s=128&d=identicon&r=PG&f=1", "display_name": "Dangle", "link": "https://stackoverflow.com/users/8697436/dangle"}, "edited": false, "score": 1, "creation_date": 1511819978, "post_id": 47517824, "comment_id": 81997522, "body": "@Dangle: When the value of r is created we are allocating and copying slice descriptors (<code>structs</code>). We don&#39;t allocate or copy the string values, only the pointers to them. So it is not very expensive."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1511810893, "last_edit_date": 1511810893, "creation_date": 1511808533, "answer_id": 47517824, "question_id": 47517270, "link": "https://stackoverflow.com/questions/47517270/writing-a-map-to-a-csv/47517824#47517824", "title": "Writing a map to a csv", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"noreferrer\">Package csv</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/encoding/csv/#Writer.Error\" rel=\"noreferrer\">func (*Writer) Write</a></p>\n\n<pre><code>func (w *Writer) Write(record []string) error\n</code></pre>\n  \n  <p>Writer writes a single CSV record to w along with any necessary\n  quoting. A record is a slice of strings with each string being one\n  field.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>error: cannot use key (type <code>string</code>) as type <code>[]string</code> in argument to\n  <code>writer.Write</code></p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>\"I've done a lot of googling and searching here.\"</p>\n</blockquote>\n\n<p>To solve this problem, read the documentation of <code>Write</code> and follow the instructions in the error message, You have type <code>string</code>, <code>Write</code> wants type <code>[]string</code>. For example,</p>\n\n<pre><code>for key, value := range m {\n    r := make([]string, 0, 1+len(value))\n    r = append(r, key)\n    r = append(r, value...)\n    err := writer.Write(r)\n    if err != nil {\n        // handle error\n    }\n}\nwriter.Flush()\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 8697436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da8d3cf70e4890086f8f57ea38ea81b0?s=128&d=identicon&r=PG&f=1", "display_name": "Dangle", "link": "https://stackoverflow.com/users/8697436/dangle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3287, "favorite_count": 1, "accepted_answer_id": 47517824, "answer_count": 1, "score": 5, "last_activity_date": 1511873899, "creation_date": 1511806286, "last_edit_date": 1511873899, "question_id": 47517270, "link": "https://stackoverflow.com/questions/47517270/writing-a-map-to-a-csv", "title": "Writing a map to a csv", "body": "<p>I've been attempting to figure out how to properly write a map to a csv file with no luck.</p>\n\n<p>I essentially have a program that queries an sql database, I store one of the return values as the key to the map, and then a slice of string for the data related to it that's returned, as an example the map would be:</p>\n\n<pre><code>var m = make(map[string][]string)\n\nm['test1'] = [5, 4, 3]\n</code></pre>\n\n<p>so writing it to a csv would be</p>\n\n<blockquote>\n  <p>test1, 5, 4, 3</p>\n</blockquote>\n\n<p>Its printed to the csv just like a list/slice would be, I'm storing it in a map to make it easier to construct dynamic queries elsewhere.</p>\n\n<p>I've attempted using a for loop such that:</p>\n\n<pre><code>for key, value := range m{\n    writer.Write(key)\n    writer.Write(value)\n}\n</code></pre>\n\n<p>but I'm getting the following error:</p>\n\n<blockquote>\n  <p>cannot use key (type string) as type []string in argument to writer.Write</p>\n</blockquote>\n\n<p>I've done a lot of googling and searching here and can't seem to find a way to do this properly.  </p>\n"}, {"tags": ["go", "libraries"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511802152, "post_id": 47516188, "comment_id": 81988242, "body": "All your code should be in your GOPATH. Always. Reference: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\"><code>How to Write Go Code</code></a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1511802267, "post_id": 47516188, "comment_id": 81988313, "body": "As JimB says. This should be checked out into <code>&#47;Users&#47;adam&#47;go&#47;src&#47;github.com&#47;elastic&#47;beats</code>. Then everything will work normally."}, {"owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "edited": false, "score": 0, "creation_date": 1511855267, "post_id": 47516188, "comment_id": 82008648, "body": "Thanks for the comments. I&#39;ve started my problem clearly and did my homework. Why the downvote?"}, {"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 1, "creation_date": 1513445779, "post_id": 47516188, "comment_id": 82660859, "body": "No need to downvote. Faced exactly the same problem, might be typical for a go newbie."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1511803711, "creation_date": 1511803711, "answer_id": 47516642, "question_id": 47516188, "link": "https://stackoverflow.com/questions/47516188/modifying-an-imported-library-in-go/47516642#47516642", "title": "Modifying an imported library in Go", "body": "<p>A project working copy should be checked out into <code>$GOPATH/src/package/import/path</code> - for example, this project should be checked out into <code>/Users/adam/go/src/github.com/elastic/beats</code>. With the project in the correct location, the go tooling will be able to operate on it normally; otherwise, it will not be able to resolve imports correctly. See <code>go help gopath</code> for more info.</p>\n"}, {"comments": [{"owner": {"reputation": 3069, "user_id": 1394981, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8bc6f5d86a2a8d7ed90dea48ca7c67e2?s=128&d=identicon&r=PG", "display_name": "Matt Westlake", "link": "https://stackoverflow.com/users/1394981/matt-westlake"}, "edited": false, "score": 2, "creation_date": 1565378377, "post_id": 47526341, "comment_id": 101349666, "body": "Can you elaborate on &quot;compile code, fix compile, go install&quot;?  I made changes but go build &amp; go install did nothing"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 3, "last_activity_date": 1511854820, "creation_date": 1511854820, "answer_id": 47526341, "question_id": 47516188, "link": "https://stackoverflow.com/questions/47516188/modifying-an-imported-library-in-go/47526341#47526341", "title": "Modifying an imported library in Go", "body": "<p>One of the recommended ways to work with other's packages is:</p>\n\n<ol>\n<li><p>Get the sources of the original package:</p>\n\n<pre><code>go get github.com/elastic/beats\n</code></pre>\n\n<p>As a result you will clone project's git repository to the folder </p>\n\n<pre><code>$GOPATH/src/github.com/elastic/beats\n</code></pre></li>\n<li><p>Make some fixes, compile code, fix, compile... When you make <code>go install</code> package will be compiled and installed to your system. When you need merge updates from original repository you can <code>git pull</code> them.</p></li>\n</ol>\n\n<p><strong>Everything is OK. What's next? How to share your work with others?</strong></p>\n\n<ol start=\"3\">\n<li><p>Fork project on github, suppose it will be <code>github.com/username/beats</code></p></li>\n<li><p>Add this fork as another remote <code>mycopy</code> (or any other name you like) to your local repository</p>\n\n<pre><code>git remote add mycopy git://github.com/username/beats.git\n</code></pre></li>\n<li><p>When all is done you can push updated sources to your repo on github</p>\n\n<pre><code>git push mycopy\n</code></pre>\n\n<p>and then open a pull-request to original sources. This way you can share your work with others. And keep your changes in sync with mainstream.</p></li>\n</ol>\n"}], "owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2622, "favorite_count": 0, "accepted_answer_id": 47516642, "answer_count": 2, "score": 1, "last_activity_date": 1511854820, "creation_date": 1511802065, "question_id": 47516188, "link": "https://stackoverflow.com/questions/47516188/modifying-an-imported-library-in-go", "title": "Modifying an imported library in Go", "body": "<h1>My Problem</h1>\n\n<p><a href=\"https://www.elastic.co/products/beats\" rel=\"nofollow noreferrer\">Elastic Beats</a> is an open source project for log shippers written in Go. It features several log outputs, including console, Elasticsearch and Redis. I would like to add an output of my own - to AWS Kinesis.</p>\n\n<p>I have cloned the repo to <code>~/github/beats</code>, and tried building it:</p>\n\n<pre><code>$ cd filebeat; go build main.go\n</code></pre>\n\n<p>However, it failed due to a missing library <em>which is a part of the project</em>:</p>\n\n<pre><code>main.go:6:2: cannot find package \"github.com/elastic/beats/filebeat/cmd\" in any of:\n    /usr/local/go/src/github.com/elastic/beats/filebeat/cmd (from $GOROOT)\n    /Users/adam/go/src/github.com/elastic/beats/filebeat/cmd (from $GOPATH)\n</code></pre>\n\n<p>A directory of the project is dependent on a package from the same repo, but instead of looking one directory up the hierarchy it looks in the <code>GOPATH</code>.</p>\n\n<p>So, <code>go get github.com/elastic/beats/filebeat/cmd</code> fetched the code, and now <code>go build main.go</code> works. Changing the code in my <code>GOPATH</code> is reflected in these builds.</p>\n\n<p>This leaves me with an structural inconvenience. Some of my code is at a working directory, and some of it is at my <code>GOPATH</code> and included by the code in my working directory.</p>\n\n<p>I would like to have all my code in a single directory for various reasons, not the least being keeping everything under version control.</p>\n\n<h1>What Have I Tried</h1>\n\n<p>Mostly searching for the problem. I am quite new to Go, so I might have missed the correct terminology.</p>\n\n<h1>My Question</h1>\n\n<p>What is the right way to edit the code of an imported library in Go?</p>\n"}, {"tags": ["go", "github-api"], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 8576951, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/94990d082349d42cde770442ec50940a?s=128&d=identicon&r=PG&f=1", "display_name": "alexandre", "link": "https://stackoverflow.com/users/8576951/alexandre"}, "is_accepted": false, "score": 0, "last_activity_date": 1511814490, "creation_date": 1511814490, "answer_id": 47519274, "question_id": 47514935, "link": "https://stackoverflow.com/questions/47514935/how-to-get-notifications-with-the-github-api-using-go/47519274#47519274", "title": "How to get notifications with the github api using go", "body": "<p>I finally found the answer, the program is working, the problem was on my side, I did not enable notifications on web in my github settings.</p>\n"}], "owner": {"reputation": 141, "user_id": 8576951, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/94990d082349d42cde770442ec50940a?s=128&d=identicon&r=PG&f=1", "display_name": "alexandre", "link": "https://stackoverflow.com/users/8576951/alexandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511814490, "creation_date": 1511798040, "last_edit_date": 1511798951, "question_id": 47514935, "link": "https://stackoverflow.com/questions/47514935/how-to-get-notifications-with-the-github-api-using-go", "title": "How to get notifications with the github api using go", "body": "<p>I am trying to write a go program to connect to the github api and to get notifications on my account. I can get repos and infos on the user pretty easily but I am having a hard time getting notifications, even if I have notification on my account, the array is always empty. Does someone knows what I am doing wrong ?\nThanks in advance !</p>\n\n<p>Here is my code :</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"golang.org/x/net/context\"\n\n    \"github.com/google/go-github/github\"\n    \"golang.org/x/oauth2\"\n)\n\nfunc check(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\n/**\n * this function is used to get the repositories of the client\n */\nfunc getRepo(client *github.Client) []*github.Repository {\n    ctx := context.Background()\n\n    repos, _, err := client.Repositories.List(ctx, \"\", nil)\n\n    check(err)\n\n    fmt.Printf(\"\\n%v\\n\", github.Stringify(repos))\n\n    return repos\n}\n\n/**\n * this function is used to get Authentification using a oauth token\n */\nfunc getAuth() *github.Client {\n    ctx := context.Background()\n    // put your own OAUTH_TOKEN\n    ts := oauth2.StaticTokenSource(&amp;oauth2.Token{AccessToken: \"OAUTH_TOKEN\"})\n\n    tc := oauth2.NewClient(ctx, ts)\n    client := github.NewClient(tc)\n\n    return client\n}\n\n/**\n * this function is used to get notification on the client's account\n */\nfunc getNotif(client *github.Client) []*github.Notification {\n    ctx := context.Background()\n\n    notifs, resp, err := client.Activity.ListRepositoryNotifications(ctx, \"AlexandreMazgaj\", \"task_app\", nil)\n\n    fmt.Printf(\"Status code of the response: %d\\n\", resp.StatusCode)\n    check(err)\n\n    return notifs\n}\n\nfunc main() {\n    // first we get authentification\n    client := getAuth()\n    // then we get the notifications\n    notifs := getNotif(client)\n\n    fmt.Printf(\"\\n%v\\n\", github.Stringify(notifs))\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1511798694, "post_id": 47514812, "comment_id": 81985983, "body": "Check codebases that are out there. In go, the common way to do that is to load configuration via environment variables (eg <code>LOG_LEVEL</code>, and use <code>os.Getenv</code> or a config package to load the value). That&#39;s why <code>logrus</code> for example allows you to set log levels via ints <i>or</i> strings."}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1511798845, "post_id": 47514812, "comment_id": 81986088, "body": "@EliasVanOotegem - Can you please provide example how to init and use it via logrus ?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1511800195, "post_id": 47514812, "comment_id": 81986984, "body": "Posted a minimal example. TBH: just read the <i>readme</i> of the logrus repository, It contains <a href=\"https://github.com/sirupsen/logrus#example\" rel=\"nofollow noreferrer\">an example</a> where the log level is actually being set."}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1511800090, "post_id": 47515351, "comment_id": 81986916, "body": "Thanks, assume I want to influence from outside (my application should be deployed to the cloud) the program on the log i.e. flag/env to print debug.log or not , how should I do it ?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1511800426, "post_id": 47515351, "comment_id": 81987121, "body": "This is a poor implementation: it&#39;s not thread safe (no assignment is, unless you use the <code>atomic</code> package). You&#39;re not really implementing different <i>levels</i>. OP mentions <code>logrus</code>, which <i>does</i> have differen log levels. Why wouldn&#39;t you simply use that instead? Lastly: the question was mainly focused on <i>how</i> you switch to a different log level: hard-coding a boolean reassignment wouldn&#39;t be the way to go I don&#39;t think"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1511803921, "post_id": 47515351, "comment_id": 81989259, "body": "@EliasVanOotegem that&#39;s a start point to understand better how to start. If you understand logics than bool can be switched to any else and analogue methods like <code>Debug</code>, <code>Warn</code> and <code>Critical</code> implemented. Usually you do not switch DebugLevels on fly, so bool var is really written only once. Original Logger is thread safe.  Logrus is nice, but it has some drawbacks - for example bad handling of line numbers, what standard logger can do well. Solution"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1511857994, "post_id": 47515351, "comment_id": 82010135, "body": "Logrus&#39; issues aside, the OP was mainly asking <i>how</i> to set the loglevel, to which the answer would be: this is commonly done through environment variables. Your answer is a simplistic implementation using boolean flags. The OP already mentioned logrus, so I&#39;d assume he&#39;s using that, and is mainly trying to find out how to turn debug logging on/off"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 2, "last_activity_date": 1511799427, "creation_date": 1511799427, "answer_id": 47515351, "question_id": 47514812, "link": "https://stackoverflow.com/questions/47514812/how-to-use-debug-log-in-golang/47515351#47515351", "title": "How to use debug log in golang", "body": "<p>If the only thing you need is check level before printing  you can create you own thin wrapper for standard logger. </p>\n\n<p>This will help to better understand how they work. Feel free to ask any questions. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype MyLog struct {\n    PrintDebug bool\n}\n\nfunc (m *MyLog) Debug(args ...interface{}) {\n    if m.PrintDebug {\n        m.Print(args...)\n    }\n}\n\nfunc (m *MyLog) Print(args ...interface{}) {\n    log.Print(args...)\n}\n\nfunc main() {\n    ml := MyLog{}\n    ml.Debug(\"PrintDebig = false, so no oitput\")\n    ml.Print(\"this will be printed anyway\")\n\n    ml.PrintDebug = true\n    ml.Debug(\"Hello, playground\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gKxQtC9NqX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gKxQtC9NqX</a></p>\n"}, {"comments": [{"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1511800743, "post_id": 47515580, "comment_id": 81987323, "body": "Thanks 1+ I&#39;ve tried your suggestion which is good idea but not working :( in both case the log is printed <code>if !ok</code> and <code>if ok</code> , why ?"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1511800932, "post_id": 47515580, "comment_id": 81987449, "body": "in both case it get <code>5</code> for debug level"}, {"owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1511801457, "post_id": 47515580, "comment_id": 81987789, "body": "and btw, does it good practice to put it on <code>init</code> function ?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "edited": false, "score": 0, "creation_date": 1511857863, "post_id": 47515580, "comment_id": 82010059, "body": "In this example, unless you set the log level to something other than debug (eg <code>info</code>), you&#39;ll always see debug log output. Check the implementation of the <code>ParseLevel</code> function to see what string values you can assign to <code>LOG_LEVEL</code>. Having this in the <code>main.init</code> func is acceptable, but in most cases you&#39;ll want to configure some other things, and you&#39;ll end up setting up the logger in the <code>main</code> func somewhere. It all depends. In this small example, this is a valid use-case of the <code>init</code> func though"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 16, "last_activity_date": 1511800145, "creation_date": 1511800145, "answer_id": 47515580, "question_id": 47514812, "link": "https://stackoverflow.com/questions/47514812/how-to-use-debug-log-in-golang/47515580#47515580", "title": "How to use debug log in golang", "body": "<p>Ok, a really simple example of the approach I suggested in the comment:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n\n    \"github.com/sirupsen/logrus\"\n)\n\nfunc init() {\n    lvl, ok := os.LookupEnv(\"LOG_LEVEL\")\n    // LOG_LEVEL not set, let's default to debug\n    if !ok {\n        lvl = \"debug\"\n    }\n    // parse string, this is built-in feature of logrus\n    ll, err := logrus.ParseLevel(lvl)\n    if err != nil {\n        ll = logrus.DebugLevel\n    }\n    // set global log level\n    logrus.SetLevel(ll)\n}\n\nfunc main() {\n    logrus.Debug(\"Will only be visible if the loglevel permits it\")\n}\n</code></pre>\n\n<p>The original comment: </p>\n\n<blockquote>\n  <p>Check codebases that are out there. In go, the common way to do that is to load configuration via environment variables (eg LOG_LEVEL, and use os.Getenv or a config package to load the value). That's why logrus for example allows you to set log levels via ints or strings.</p>\n</blockquote>\n\n<p>Please, please: before you ask a question, read the basic info about the packages you use. Even the github repo for logrus' main README contains an example setting the log level to a specific level:</p>\n\n<p><a href=\"https://github.com/sirupsen/logrus#example\" rel=\"noreferrer\">https://github.com/sirupsen/logrus#example</a></p>\n"}], "owner": {"reputation": 987, "user_id": 7571053, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3acddcbb4ffa065f60b021cdf35965af?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny Hilton", "link": "https://stackoverflow.com/users/7571053/jenny-hilton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12562, "favorite_count": 5, "accepted_answer_id": 47515580, "answer_count": 2, "score": 8, "last_activity_date": 1541613990, "creation_date": 1511797676, "question_id": 47514812, "link": "https://stackoverflow.com/questions/47514812/how-to-use-debug-log-in-golang", "title": "How to use debug log in golang", "body": "<p>I\u2019ve application which should use log in state of debug. i.e. all the logs that I want to \nprovide is like log.debug </p>\n\n<p>I\u2019ve read about it and find the following</p>\n\n<pre><code>https://github.com/Sirupsen/logrus\nhttps://github.com/uber-go/zap\n</code></pre>\n\n<p>My question is how should I \u201ctell\u201d to the program that now run at debug mode an then \nall the logs will be printed since this I believe should come from outside \u2026\n<strong>example will be very helpful</strong> since Im new to golfing .</p>\n"}, {"tags": ["linux", "go", "sqlite", "arm"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511793276, "post_id": 47513189, "comment_id": 81982511, "body": "Do you have a C toolchain for arm, and do you have <code>CGO_ENABLED=1</code>?"}, {"owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511795238, "post_id": 47513189, "comment_id": 81983723, "body": "@JimB I don&#39;t think so, how do I use that?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1511795638, "post_id": 47513189, "comment_id": 81983975, "body": "You can choose the target C compiler with <code>CC_FOR_TARGET</code>. See <code>https:&#47;&#47;golang.org&#47;cmd&#47;cgo&#47;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "edited": false, "score": 0, "creation_date": 1511800857, "post_id": 47514836, "comment_id": 81987401, "body": "I tried <code>go-sqlite</code>, while it builds and runs fine on the host system, when built for ARM and copied to RPi - it fails with <code>_: sql: unknown driver &quot;sqlite3&quot; (forgotten import?)</code>"}, {"owner": {"reputation": 58, "user_id": 2866611, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003527038743/picture?type=large", "display_name": "Yury Kozyrev", "link": "https://stackoverflow.com/users/2866611/yury-kozyrev"}, "reply_to_user": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "edited": false, "score": 0, "creation_date": 1511881340, "post_id": 47514836, "comment_id": 82025983, "body": "@jdevelop here is an advice to compile on Raspberry PI itself: <a href=\"https://stackoverflow.com/questions/28262389/golang-cgo-clang-with-sqlite3-c?rq=1\" title=\"golang cgo clang with sqlite3 c\">stackoverflow.com/questions/28262389/&hellip;</a>"}], "tags": [], "owner": {"reputation": 58, "user_id": 2866611, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003527038743/picture?type=large", "display_name": "Yury Kozyrev", "link": "https://stackoverflow.com/users/2866611/yury-kozyrev"}, "is_accepted": false, "score": 1, "last_activity_date": 1511797751, "creation_date": 1511797751, "answer_id": 47514836, "question_id": 47513189, "link": "https://stackoverflow.com/questions/47513189/link-sqlite3-on-arm-x86-64-host/47514836#47514836", "title": "Link SQLite3 on ARM (x86_64 host)", "body": "<p>I'd recommend to check out other sqlite drivers mentioned on official <a href=\"https://github.com/golang/go/wiki/SQLDrivers\" rel=\"nofollow noreferrer\">wiki page</a>, say this one <a href=\"https://github.com/mxk/go-sqlite\" rel=\"nofollow noreferrer\">github.com/mxk/go-sqlite</a>. Just checked, it perfectly compiles for ARM.</p>\n\n<p>But if you want to use this particular library, there is a Github <a href=\"https://github.com/mattn/go-sqlite3/issues/494\" rel=\"nofollow noreferrer\">issue</a> related to this problem. Short answer is that you need to have <code>arm-linux-gnueabihf-gcc</code> library and then force compiler to use it somehow like this:</p>\n\n<p><code>CC=arm-linux-gnueabihf-gcc CXX=arm-linux-gnueabihf-g++ CGO_ENABLED=1 GOOS=linux GOARCH=arm GOARM=7 go get github.com/mattn/go-sqlite3\n</code></p>\n"}], "owner": {"reputation": 11467, "user_id": 741404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/28832e0d64ab5e5b21c9a78c02d8aefc?s=128&d=identicon&r=PG", "display_name": "jdevelop", "link": "https://stackoverflow.com/users/741404/jdevelop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 814, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511809743, "creation_date": 1511792651, "last_edit_date": 1511809743, "question_id": 47513189, "link": "https://stackoverflow.com/questions/47513189/link-sqlite3-on-arm-x86-64-host", "title": "Link SQLite3 on ARM (x86_64 host)", "body": "<p>I need to cross-compile some Go application so it will run on Raspberry Pi. So far it works pretty good with <code>GOARCH=arm GOOS=linux</code>, however for <code>SQLite3</code> there's some problem with the imported symbols:</p>\n\n<pre><code>GOOS=linux GOARCH=arm go build                          \nvendor/github.com/mattn/go-sqlite3/sqlite3_go18.go:18:10: undefined: \nSQLiteConn\n</code></pre>\n\n<p>I also tried </p>\n\n<pre><code>GOOS=linux GOARCH=arm go get github.com/mattn/go-sqlite3\n# github.com/mattn/go-sqlite3\n../../mattn/go-sqlite3/sqlite3_go18.go:18:10: undefined: SQLiteConn\n</code></pre>\n\n<p>with the same result. I presume I need to get the SQLite3 lib for ARM and put it somewhere so Go compiler can link against it?</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 2551, "user_id": 4739247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OwOaK.jpg?s=128&g=1", "display_name": "assefamaru", "link": "https://stackoverflow.com/users/4739247/assefamaru"}, "edited": false, "score": 0, "creation_date": 1511791798, "post_id": 47512171, "comment_id": 81981513, "body": "Have you tried <code>LoadHTMLGlob()</code> or <code>LoadHTMLFiles()</code> from <a href=\"https://github.com/gin-gonic/gin#html-rendering\" rel=\"nofollow noreferrer\">gin-gonic/gin#html-rendering</a>?"}, {"owner": {"reputation": 2725, "user_id": 1804658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f2d4980dde71df2d28db3888942ced40?s=128&d=identicon&r=PG", "display_name": "autronix", "link": "https://stackoverflow.com/users/1804658/autronix"}, "reply_to_user": {"reputation": 2551, "user_id": 4739247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OwOaK.jpg?s=128&g=1", "display_name": "assefamaru", "link": "https://stackoverflow.com/users/4739247/assefamaru"}, "edited": false, "score": 0, "creation_date": 1511792664, "post_id": 47512171, "comment_id": 81982097, "body": "I want to go the helper way to reduce loading each template manually when rendering the page. I&#39;ve actually found the source of my problem with EZ Gin Template, though I haven&#39;t tried again with GinRenderHTML. I&#39;ll be posting my findings as an answer to my question. Thanks for the suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 2725, "user_id": 1804658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f2d4980dde71df2d28db3888942ced40?s=128&d=identicon&r=PG", "display_name": "autronix", "link": "https://stackoverflow.com/users/1804658/autronix"}, "is_accepted": false, "score": 0, "last_activity_date": 1511793463, "creation_date": 1511793463, "answer_id": 47513466, "question_id": 47512171, "link": "https://stackoverflow.com/questions/47512171/unable-to-load-html-templates-with-gin/47513466#47513466", "title": "Unable to load HTML templates with Gin", "body": "<p>After doing some further research I found the source of my problem with EZ Gin Template.</p>\n\n<p>I'm hoping this helps anyone experiencing the same issue.</p>\n\n<p>After taking a deeper look at the helper code, I realized that the template matching pattern is strict and does not search for files recursively; ie. it expects a specific file structure to find template files:</p>\n\n<p>In the default setting, EZ Gin Template requires the following file structure to work:</p>\n\n<pre><code>/workspace\n- app\n  - views\n    - layouts\n      - some_layout.html\n    - some_dir\n      - template_file.html\n      - _partial_template.html\n    - partials\n      - _some_other_partial.html\n</code></pre>\n\n<p>In order to allow for other file patterns, the helper set of functions needs to be modified.</p>\n\n<p>In my case, I forked the helper code locally to allow matching 1st level template files:</p>\n\n<pre><code>func (r Render) Init() Render {\n    globalPartials := r.getGlobalPartials()\n\n    layout := r.TemplatesDir + r.Layout + r.Ext\n\n    // Match multiple levels of templates\n    viewDirs, _ := filepath.Glob(r.TemplatesDir + \"**\" + string(os.PathSeparator) + \"*\" + r.Ext)\n    // Added the following two lines to match for app/views/some_file.html as well as files on the **/*.html matching pattern\n    tmp, _ := filepath.Glob(r.TemplatesDir + \"*\" + r.Ext)\n    viewDirs = append(viewDirs, tmp...)\n    // Can be extended by replicating those two lines above and adding search paths within the base template path.\n\n    fullPartialDir := filepath.Join(r.TemplatesDir + r.PartialDir)\n    for _, view := range viewDirs {\n        templateFileName := filepath.Base(view)\n        //skip partials\n        if strings.Index(templateFileName, \"_\") != 0 &amp;&amp; strings.Index(view, fullPartialDir) != 0 {\n            localPartials := r.findPartials(filepath.Dir(view))\n\n            renderName := r.getRenderName(view)\n            if r.Debug {\n                log.Printf(\"[GIN-debug] %-6s %-25s --&gt; %s\\n\", \"LOAD\", view, renderName)\n            }\n            allFiles := []string{layout, view}\n            allFiles = append(allFiles, globalPartials...)\n            allFiles = append(allFiles, localPartials...)\n            r.AddFromFiles(renderName, allFiles...)\n        }\n    }\n\n    return r\n}\n</code></pre>\n\n<p>I have not tried a similar solution with GinHTMLRenderer, but I expect that the issue might likely be related to it in terms of the expected file structure.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6056991, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BDDRXsAOpYY/AAAAAAAAAAI/AAAAAAAAAU8/E0k7yb1fX4c/photo.jpg?sz=128", "display_name": "go je jo", "link": "https://stackoverflow.com/users/6056991/go-je-jo"}, "is_accepted": false, "score": 0, "last_activity_date": 1579444565, "last_edit_date": 1579444565, "creation_date": 1579444225, "answer_id": 59810993, "question_id": 47512171, "link": "https://stackoverflow.com/questions/47512171/unable-to-load-html-templates-with-gin/59810993#59810993", "title": "Unable to load HTML templates with Gin", "body": "<p>You can also bind the templates into the code. The <a href=\"http://github.com/jessevdk/go-assets-builder\" rel=\"nofollow noreferrer\">jessevdk/go-assets-builder</a> will generate a go file that contains assets within the specified directory. Make sure that the file generated is located where the main package is. Gin also provided this as an example in their <a href=\"https://gin-gonic.com/docs/examples/bind-single-binary-with-template/\" rel=\"nofollow noreferrer\">Documentation</a> <a href=\"https://github.com/gin-gonic/examples/tree/master/assets-in-binary\" rel=\"nofollow noreferrer\">For more Info</a>. It will also include subfolders and its files (i. e. assets) in the binary.</p>\n\n<p>Get The generator tool:</p>\n\n<pre><code>go get github.com/jessevdk/go-assets-builder\n</code></pre>\n\n<p>Generate:</p>\n\n<pre><code># go-assets-builder &lt;dir&gt; -o &lt;generated file name&gt;\ngo-assets-builder app -o assets.go\n</code></pre>\n\n<p>Note that <code>&lt;generated file name&gt;</code> can also be like <code>cmd/client/assets.go</code> to specify the destination of the file to be generated.</p>\n\n<p>Load Template:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\n// ... imports\n\nfunc main() {\n    r := gin.New()\n\n    t, err := loadTemplate()\n    if err != nil {\n        panic(err)\n    }\n    r.SetHTMLTemplate(t)\n\n    r.GET(\"/\", func(c *gin.Context) {\n        c.HTML(http.StatusOK, \"app/views/layouts/application.html\", nil)\n    })\n    r.GET(\"/test\", func(c *gin.Context) {\n        c.HTML(http.StatusOK, \"app/views/test.html\", nil)\n    })\n    r.Run(\":8080\")\n}\n\n// loadTemplate loads templates embedded by go-assets-builder\nfunc loadTemplate() (*template.Template, error) {\n    t := template.New(\"\")\n    // Assets is the templates\n    for name, file := range Assets.Files {\n        if file.IsDir() || !strings.HasSuffix(name, \".html\") {\n            continue\n        }\n        h, err := ioutil.ReadAll(file)\n        if err != nil {\n            return nil, err\n        }\n        t, err = t.New(name).Parse(string(h))\n        if err != nil {\n            return nil, err\n        }\n    }\n    return t, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 10950622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ffae8edc4edb5a2eaa3262d3924b543?s=128&d=identicon&r=PG&f=1", "display_name": "Cengleby", "link": "https://stackoverflow.com/users/10950622/cengleby"}, "is_accepted": false, "score": 0, "last_activity_date": 1610311339, "creation_date": 1610311339, "answer_id": 65658305, "question_id": 47512171, "link": "https://stackoverflow.com/questions/47512171/unable-to-load-html-templates-with-gin/65658305#65658305", "title": "Unable to load HTML templates with Gin", "body": "<p>Here is how I do it.  This walks through the directory and collects the files marked with my template suffix which is .html &amp; then I just include all of those.  I haven't seen this answer anywhere so I thought Id post it.</p>\n<pre><code>// START UP THE ROUTER\nrouter := gin.Default()\n\nvar files []string\nfilepath.Walk(&quot;./views&quot;, func(path string, info os.FileInfo, err error) error {\n    if strings.HasSuffix(path, &quot;.html&quot;) {\n        files = append(files, path)\n    }\n    return nil\n})\n\nrouter.LoadHTMLFiles(files...)\n\n// SERVE STATICS\nrouter.Use(static.Serve(&quot;/css&quot;, static.LocalFile(&quot;./css&quot;, true)))\nrouter.Use(static.Serve(&quot;/js&quot;, static.LocalFile(&quot;./js&quot;, true)))\nrouter.Use(static.Serve(&quot;/images&quot;, static.LocalFile(&quot;./images&quot;, true)))\n\nrouters.LoadBaseRoutes(router)\nrouters.LoadBlog(router)\n\nrouter.Run(&quot;:8080&quot;)\n</code></pre>\n<p>Now they don't have to all be nested at the exact depth like the other suggestions ... the file structure can be uneven</p>\n"}], "owner": {"reputation": 2725, "user_id": 1804658, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f2d4980dde71df2d28db3888942ced40?s=128&d=identicon&r=PG", "display_name": "autronix", "link": "https://stackoverflow.com/users/1804658/autronix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1839, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1610311339, "creation_date": 1511789484, "question_id": 47512171, "link": "https://stackoverflow.com/questions/47512171/unable-to-load-html-templates-with-gin", "title": "Unable to load HTML templates with Gin", "body": "<p>I've been having some issues loading html templates using the Gin framework through the <code>r.HTMLRender</code> setting.</p>\n\n<p>It would seem that the templates are not being found.</p>\n\n<p>I have tried to use the following helpers:</p>\n\n<ul>\n<li>GinHTMLRender: <a href=\"https://gist.github.com/madhums/4340cbeb36871e227905\" rel=\"nofollow noreferrer\">https://gist.github.com/madhums/4340cbeb36871e227905</a></li>\n<li>EZ Gin Template: <a href=\"https://github.com/michelloworld/ez-gin-template\" rel=\"nofollow noreferrer\">https://github.com/michelloworld/ez-gin-template</a></li>\n</ul>\n\n<p>Neither of these seem to be working when setting the default path for templates (in my case <code>app/views</code>); for the purposes of getting to this to work my html template file structure looks like this:</p>\n\n<pre><code>/workspace\n|-app\n  |-views\n    |-layouts\n      |-application.html\n    |-test.html\n</code></pre>\n\n<p>Here is a sample of the Gin loading code:</p>\n\n<pre><code>import (\n    \"github.com/gin-contrib/location\"\n    \"github.com/gin-gonic/gin\"\n    \"fmt\"\n    \"os\"\n    \"github.com/gin-gonic/contrib/static\"\n    \"github.com/michelloworld/ez-gin-template\"\n)\n\n//CORSMiddleware ...\nfunc CORSMiddleware() gin.HandlerFunc {\n    /** CORS middleware **/\n}\n\nfunc Router() {\n\n    if os.Getenv(\"ENVIRONMENT\") == \"production\" {\n        gin.SetMode(gin.ReleaseMode)\n    }\n\n    // Initialize Gin object\n    r := gin.Default()\n\n    // Cors Middleware\n    r.Use(CORSMiddleware())\n\n    // Rate limiting\n    rl, err := helpers.RateLimiterMiddleware()\n    if err != nil {\n        panic(\"Rate Limiting Initialization error\")\n    }\n    r.Use(rl)\n\n    // Asset provision\n    r.Use(static.ServeRoot(\"/public\",\"app/assets\"))\n\n    // Get URL information\n    r.Use(location.Default())\n\n    // Attempt with EZ Template, fails\n    // I ge this error: \"runtime error: invalid memory address or nil pointer dereference\" when calling c.HTML(...)\n    render := eztemplate.New()\n    render.TemplatesDir = \"app/views/\" // default\n    render.Layout = \"layouts/application\"     // default\n    render.Ext = \".html\"               // default\n    render.Debug = true               // default\n    r.HTMLRender = render.Init()\n\n\n    // Attempt with GinHTMLRender, fails\n    // I get this error: https://gist.github.com/madhums/4340cbeb36871e227905#file-gin_html_render-go-L110\n    /* \n    htmlRender := GinHTMLRender.New()\n    htmlRender.TemplatesDir = \"app/views/\"\n    htmlRender.Debug = gin.IsDebugging()\n    htmlRender.Layout = \"layouts/application\"\n\n    log.Println(\"Dir:\"+htmlRender.TemplatesDir)\n\n    r.HTMLRender = htmlRender.Create()*/\n\n    /** Some Routes **/\n\n    // Start web listener\n\n    r.Run(\":8009\") // listen and serve on 0.0.0.0:8080\n}\n</code></pre>\n\n<p>The corresponding render call is code is the following:</p>\n\n<pre><code>/* c is of type *gin.Context */\nc.HTML(200, \"test\", \"\")\n</code></pre>\n\n<p>For some reason it seems like the <code>r.HTMLRender</code> function is not taking into account the template path; I have attempted doing this:</p>\n\n<pre><code>_, err := template.ParseFiles(\"app/views/test.html\")\nif err != nil {\n    log.Println(\"Template Error\")\n} else {\n    log.Println(\"No Template Error\")\n}\n</code></pre>\n\n<p>This code consistently displays \"No Template Error\", which leads me to believe that the <code>HTMLRender</code> assignment is not considering the <code>TemplatesDir</code> set variable.</p>\n\n<p>I've been stuck with this issue for some time, and I am not entirely sure how to get it resolved.</p>\n\n<p>Any help getting this to work would be greatly appreciated.</p>\n"}, {"tags": ["go", "types", "channel"], "answers": [{"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 4, "last_activity_date": 1511785898, "last_edit_date": 1511785898, "creation_date": 1511785347, "answer_id": 47510921, "question_id": 47510854, "link": "https://stackoverflow.com/questions/47510854/cannot-use-msgs-type-chan-as-type-chan-in-return-argument/47510921#47510921", "title": "cannot use msgs (type &lt;-chan _) as type chan _ in return argument", "body": "<p>It's perfectly straightforward. You're trying to return a directional channel (in this case a read-only channel) as a general channel that can be used for both reading and writing.</p>\n\n<p>There's some basic information about channel directions <a href=\"https://gobyexample.com/channel-directions\" rel=\"nofollow noreferrer\">here</a></p>\n\n<h2>Tl;Dr</h2>\n\n<p>Any <code>chan t</code> can be used as a directional channel. This increases overal typesafety and makes code easier to understand/use for others:</p>\n\n<pre><code>func Foo() &lt;-chan struct{} {\n}\n</code></pre>\n\n<p>This tells me <code>Foo</code> returns a channel I can read from. If it were to return just <code>chan struct{}</code>, I'd have to check the docs to see if I'm expected to push something to that channel, or receive from it.</p>\n\n<p>A non-directional channel can be made directional, but it's not allowed to convert back to a non-directional channel for obvious reasons. You can check <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">the spec</a> on channel types for even more details, but the essence of it is this simple sentence:</p>\n\n<blockquote>\n  <p>The optional &lt;- operator specifies the channel direction, send or receive. If no direction is given, the channel is bidirectional. A channel may be constrained only to send or only to receive by conversion or assignment.</p>\n</blockquote>\n\n<h2>solution</h2>\n\n<p>In your particular case, the solution is simple: change the return type to match the channel you have:</p>\n\n<pre><code>func consumeQueue(ch *amqp.Channel, q_Name string) (&lt;-chan amqp.Delivery) {\n</code></pre>\n\n<p>As you've noticed: the compiler shouts at you when you try to convert a directional channel into a bidirectional channel. You'll also get a similar error when you try to convert a read-channel into a write channel (written as <code>chan&lt;- amqp.Delivery</code>). So if you get type error messages from the compiler, just check what types it's mentioning... go's compiler spits out pretty self-explanatory errors IMO</p>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1852, "favorite_count": 0, "accepted_answer_id": 47510921, "answer_count": 1, "score": 1, "last_activity_date": 1511785898, "creation_date": 1511785159, "question_id": 47510854, "link": "https://stackoverflow.com/questions/47510854/cannot-use-msgs-type-chan-as-type-chan-in-return-argument", "title": "cannot use msgs (type &lt;-chan _) as type chan _ in return argument", "body": "<p>Have following code:</p>\n\n<pre><code>func consumeQueue(ch *amqp.Channel, q_Name string) (chan amqp.Delivery) {\n    msgs, err := ch.Consume(\n        q_Name, // queue\n        \"\",     // consumer\n        true,   // auto-ack\n        false,  // exclusive\n        false,  // no-local\n        false,  // no-wait\n        nil,    // args\n    )\n    failOnError(err, \"Failed to register a consumer\")   \n    return msgs\n}\n</code></pre>\n\n<p>It throws following compile time exception:</p>\n\n<pre><code>cannot use msgs (type &lt;-chan amqp.Delivery) as type chan amqp.Delivery in return argument\n</code></pre>\n\n<p>What is wrong?</p>\n"}, {"tags": ["unit-testing", "go", "testify"], "comments": [{"owner": {"reputation": 2939, "user_id": 803359, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/pnuDZ.jpg?s=128&g=1", "display_name": "mikuszefski", "link": "https://stackoverflow.com/users/803359/mikuszefski"}, "edited": false, "score": 1, "creation_date": 1511783917, "post_id": 47510225, "comment_id": 81976498, "body": "please provide a minimum &quot;non&quot;-working example."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 4490293, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002189244418/picture?type=large", "display_name": "Riteek Srivastava", "link": "https://stackoverflow.com/users/4490293/riteek-srivastava"}, "is_accepted": true, "score": 0, "last_activity_date": 1512652953, "creation_date": 1512652953, "answer_id": 47696122, "question_id": 47510225, "link": "https://stackoverflow.com/questions/47510225/error-the-code-you-are-testing-needs-to-make-1-more-calls-in-testify-package/47696122#47696122", "title": "Error `The code you are testing needs to make 1 more call(s)` in testify package", "body": "<p>I read about the goroutine scheduling and come to know that if you are writing the test for the go functions(goroutines) then sometimes they may be called (the case when the test will pass and) and sometimes they may not be called.(the case when the test will fail). To recover from this one should use Gosched() in the test file where we are calling the goroutine. \nThis happens because go uses cooperative scheduling for the scheduling for the goroutines, which is different from preemptive and non-preemptive. If anyone wants to more about it follow this. <a href=\"https://github.com/golang/go/issues/11462\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/11462</a></p>\n"}], "owner": {"reputation": 41, "user_id": 4490293, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002189244418/picture?type=large", "display_name": "Riteek Srivastava", "link": "https://stackoverflow.com/users/4490293/riteek-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "accepted_answer_id": 47696122, "answer_count": 1, "score": -3, "last_activity_date": 1512652953, "creation_date": 1511783109, "last_edit_date": 1511785428, "question_id": 47510225, "link": "https://stackoverflow.com/questions/47510225/error-the-code-you-are-testing-needs-to-make-1-more-calls-in-testify-package", "title": "Error `The code you are testing needs to make 1 more call(s)` in testify package", "body": "<p>I am using the testify package for the unit testing in golang. My code contains mocking. while running the test it is getting passed for sometimes and showing error <code>The code you are testing needs to make 1 more call(s)</code> for sometimes, I am unable to figure out the reason why is this happening\n<a href=\"https://i.stack.imgur.com/cXpZl.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>I went through this <a href=\"https://github.com/stretchr/testify/issues/31\" rel=\"nofollow noreferrer\">https://github.com/stretchr/testify/issues/31</a> but did get what is the problem and how it can be solved?</p>\n"}, {"tags": ["function", "go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1511781095, "last_edit_date": 1592644375, "creation_date": 1511780702, "answer_id": 47509440, "question_id": 47509364, "link": "https://stackoverflow.com/questions/47509364/can-functions-implement-an-interface-in-go/47509440#47509440", "title": "Can functions implement an interface in Go", "body": "<p>Your <code>DeviceHandlerFunc</code> type indeed implements <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow noreferrer\"><code>http.Handler</code></a>. That's not the problem.</p>\n<p>But your <code>getDevice()</code> function is <strong>not</strong> of type <code>DeviceHandlerFunc</code>, it's of type <code>func(http.ResponseWriter, *http.Request, string)</code> (which is an unnamed type which obviously does not implement <code>http.Handler</code>).</p>\n<p>To make it work, use a simple type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a>:</p>\n<pre><code>mux.Handle(&quot;/&quot;, DeviceHandlerFunc(getDevice))\n</code></pre>\n<p>You can convert <code>getDevice</code> to <code>DeviceHandlerFunc</code> as the underlying type of <code>DeviceHandlerFunc</code> is the same as the type of <code>getDevice</code>. Try it on the <a href=\"https://play.golang.org/p/uJhqNTyXB8\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n<p>The following would also work:</p>\n<pre><code>var f DeviceHandlerFunc = getDevice\nmux.Handle(&quot;/&quot;, f)\n</code></pre>\n<p>Here type of <code>f</code> is obviously <code>DeviceHandlerFunc</code>. And you can assign <code>getDevice</code> to <code>f</code> as <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability</a> rules apply, namely this one:</p>\n<blockquote>\n<p>[A value <code>x</code> is assignable to a variable of type <code>T</code> (&quot;<code>x</code> is assignable to <code>T</code>&quot;) in any of these cases:]</p>\n<ul>\n<li><code>x</code>'s type <code>V</code> and <code>T</code> have identical underlying types and at least one of <code>V</code> or <code>T</code> is not a defined type.</li>\n</ul>\n</blockquote>\n"}], "owner": {"reputation": 1239, "user_id": 2806963, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/j1xpG.png?s=128&g=1", "display_name": "Shawn Throop", "link": "https://stackoverflow.com/users/2806963/shawn-throop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 47509440, "answer_count": 1, "score": 1, "last_activity_date": 1511781095, "creation_date": 1511780465, "question_id": 47509364, "link": "https://stackoverflow.com/questions/47509364/can-functions-implement-an-interface-in-go", "title": "Can functions implement an interface in Go", "body": "<p>I'm trying to make an interface similar to <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow noreferrer\"><code>http.Handler</code></a>. For certain endpoints of my API I need a APNS token included in the query or I need to respond with <code>http.StatusBadRequest</code>.</p>\n\n<p>I want the type <code>DeviceHandlerFunc</code> to implement <code>ServeHTTP(http.ResponseWriter, *http.Request)</code> and automatically parse the token and call itself with the token:</p>\n\n<pre><code>type DeviceHandlerFunc func(http.ResponseWriter, *http.Request, string)\n\nfunc (f DeviceHandlerFunc) ServeHTTP(res http.ResponseWriter, req *http.Request) {\n    token := req.URL.Query().Get(\"token\")\n\n    if token == \"\" {\n        http.Error(res, \"token missing from query\", http.StatusBadRequest)\n    } else {\n        f(res, req, token)\n    }\n}\n</code></pre>\n\n<p>Then from <code>main.go</code>:</p>\n\n<pre><code>func main() {\n    mux := http.NewServeMux()\n    mux.Handle(\"/\", getDevice)\n    log.Fatal(http.ListenAndServe(\":8081\", mux))\n}\n\nfunc getDevice(res http.ResponseWriter, req *http.Request, token string) {\n    // Do stuff with token...\n}\n</code></pre>\n\n<p>This causes a compiler error: </p>\n\n<pre><code>main.go:22:13: cannot use getDevice (type func(http.ResponseWriter, *http.Request, string)) as type http.Handler in argument to mux.Handle:\n    func(http.ResponseWriter, *http.Request, string) does not implement http.Handler (missing ServeHTTP method)\n</code></pre>\n\n<p>In my mind I couldn't be more clear that the type <code>func(http.ResponseWriter, *http.Request, string)</code> implements <code>http.Handler</code>. What am I doing wrong?</p>\n\n<p><em>Sample code <a href=\"https://play.golang.org/p/FcpXZVJ30V\" rel=\"nofollow noreferrer\">as playground</a>.</em></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 9591909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5WQdx.jpg?s=128&g=1", "display_name": "Muddz", "link": "https://stackoverflow.com/users/9591909/muddz"}, "edited": false, "score": 0, "creation_date": 1618076065, "post_id": 47510909, "comment_id": 118495058, "body": "Do this only works if the specified package is under GOPATH or GOROOT?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 38, "last_activity_date": 1511785528, "last_edit_date": 1511785528, "creation_date": 1511785324, "answer_id": 47510909, "question_id": 47509272, "link": "https://stackoverflow.com/questions/47509272/how-to-set-package-variable-using-ldflags-x-in-golang-build/47510909#47510909", "title": "How to set package variable using -ldflags -X in Golang build", "body": "<p>Quoting from doc of <a href=\"https://golang.org/cmd/link/\" rel=\"noreferrer\">Command link</a>:</p>\n\n<blockquote>\n<pre>\n-X importpath.name=value\n    Set the value of the string variable in importpath named name to value.\n    Note that before Go 1.5 this option took two separate arguments.\n    Now it takes one argument split on the first = sign.\n</pre>\n</blockquote>\n\n<p>So it can be used for any package, not just for the <code>main</code> package. But you must specify the full <em>import path</em>, not just the package name.</p>\n\n<p>E.g. if your <code>config</code> package is located at <code>$GOPATH/src/my/package/config</code>, then use the following command:</p>\n\n<pre><code>go build -ldflags \"-X my/package/config.Version=1.0.0\" -o $(MY_BIN) $(MY_SRC)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 1, "last_activity_date": 1593888840, "creation_date": 1593888840, "answer_id": 62733180, "question_id": 47509272, "link": "https://stackoverflow.com/questions/47509272/how-to-set-package-variable-using-ldflags-x-in-golang-build/62733180#62733180", "title": "How to set package variable using -ldflags -X in Golang build", "body": "<p>Here's a simple example, hopefully it would clarify and help how to do it easily:</p>\n<p>Create a directory for your application:</p>\n<pre><code>$ mkdir app &amp;&amp; cd app\n</code></pre>\n<p>Create a sub directory <code>config</code>:</p>\n<pre><code>$ mkdir config \n</code></pre>\n<p>Add the following file. it should be under <code>app/config/vars.go</code>:</p>\n<pre><code>package config\n\nvar Version string \n\nvar BuildTime string \n//todo: can add as many as build vars \n</code></pre>\n<p>In the root <code>app/</code>, add main package <code>main.go</code>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;app/config&quot;\n)\n\nfunc main() {\n    fmt.Println(&quot;build.Version:\\t&quot;, Version)\n    fmt.Println(&quot;build.Time:\\t&quot;, build.BuildTime)\n}\n</code></pre>\n<p>Now it is time to build:</p>\n<p><code>go build -ldflags &quot;-X 'app/config.Version=0.0.1' -X 'app/config.BuildTime=$(date)'&quot; </code></p>\n<p>Once it's built, you can run now the app:</p>\n<pre><code>$ ./app \nVersion:     0.0.1\nbuild.Time:  Sat Jul  4 19:49:19 UTC 2020\n</code></pre>\n<p>Finally, you may need sometimes to explore what does specific app you didn't code yourself provide in <code>ldflags</code>, you can do this by using <code>nm</code> that comes with <code>go tool</code> to list all <code>ldflags</code>.</p>\n<p>Just build the app then use <code>go tool nm</code> to list all linker flags.</p>\n<pre><code>$ go build -o app \n$ go tool nm ./app \n</code></pre>\n<p>Still have any questions or anything to be more clarified? please feel free to leave a comment below and I will get back to you as soon as I can.</p>\n"}], "owner": {"reputation": 3782, "user_id": 839211, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/THWvr.jpg?s=128&g=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/839211/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16063, "favorite_count": 7, "accepted_answer_id": 47510909, "answer_count": 2, "score": 22, "last_activity_date": 1593888840, "creation_date": 1511780202, "question_id": 47509272, "link": "https://stackoverflow.com/questions/47509272/how-to-set-package-variable-using-ldflags-x-in-golang-build", "title": "How to set package variable using -ldflags -X in Golang build", "body": "<p>I am creating an app using Go 1.9.2 and I am trying to add a version string variable to it using the <code>ldflags -X</code> options during the build.</p>\n\n<p>I've managed to set a <code>Version</code> variable in my <code>main</code> package by using: <code>-ldflags \"-X main.Version=1.0.0\"</code>, however what I really need is to set the <code>Version</code> variable inside my <code>config</code> package instead of the <code>main</code> one. Is this possible?</p>\n\n<p>Here is my build command:</p>\n\n<p><code>go build -ldflags \"-X config.Version=1.0.0\" -o $(MY_BIN) $(MY_SRC)</code></p>\n"}, {"tags": ["arrays", "string", "logging", "go", "substring"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1511783409, "creation_date": 1511783409, "answer_id": 47510311, "question_id": 47508305, "link": "https://stackoverflow.com/questions/47508305/dont-print-secrets-in-log/47510311#47510311", "title": "Dont print secrets in log", "body": "<p>Your current <code>args</code> is a slice of the following <code>string</code>s:</p>\n\n<pre><code>/var/lib/kubelet/pods/74785895-cab5-11e7-88ed-ce1c8b57856c/volumes/xyz-xandndnd\n{\"kubernetes.io/secret/access-key\":\"Qdfnnfbbdnsjnxni8ehh=\",\"kubernetes.io/secret/secret-key\":\"GGHNHwsffUIJMNBNBVV==\",\"parallel-count\":\"5\",\"region\":\"iam-standard\"}\n</code></pre>\n\n<p>The input argument that contains the security-sensitive data is at index <code>1</code>, and it's a JSON text.</p>\n\n<p>You should not \"string-manipulate\" a JSON text. First you should unmarshal it into a Go value, then manipulate it, then marshal it back.</p>\n\n<p>This is how this can be done:</p>\n\n<pre><code>// Make a copy of args:\nargs2 := append([]string{}, args...)\n\n// Unmarshal:\nvar m map[string]interface{}\nif err := json.Unmarshal([]byte(args2[1]), &amp;m); err != nil {\n    panic(err)\n}\n\n// Modify:\nm[\"kubernetes.io/secret/access-key\"] = \"XXX\"\nm[\"kubernetes.io/secret/secret-key\"] = \"YYY\"\n\n// Marshal:\ns2, err := json.Marshal(m)\nif err != nil {\n    panic(err)\n}\nargs2[1] = string(s2)\n\n// Verify:\nfmt.Println(args2[1])\n\n// Now use args2 to log\nfilelogger.Info(\"First log\", zap.Strings(\"(masked) input args\", args2))\n</code></pre>\n\n<p>The \"Verify:\" is obviously not needed, it's just for us to see the result. Output on the <a href=\"https://play.golang.org/p/hZPRlv-vMR\" rel=\"nofollow noreferrer\">Go Playground</a>:</p>\n\n<pre><code>{\"kubernetes.io/secret/access-key\":\"XXX\",\"kubernetes.io/secret/secret-key\":\"YYY\",\"parallel-count\":\"5\",\"region\":\"iam-standard\"}\n</code></pre>\n\n<p>In your solution you should also add slice index checks to avoid run-time panic.</p>\n"}], "owner": {"reputation": 2491, "user_id": 1117320, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/LA0T3.jpg?s=128&g=1", "display_name": "ambikanair", "link": "https://stackoverflow.com/users/1117320/ambikanair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 47510311, "answer_count": 1, "score": 2, "last_activity_date": 1511783409, "creation_date": 1511777225, "question_id": 47508305, "link": "https://stackoverflow.com/questions/47508305/dont-print-secrets-in-log", "title": "Dont print secrets in log", "body": "<p>I am using <a href=\"https://github.com/uber-go/zap\" rel=\"nofollow noreferrer\">Zap</a> logger and I want to limit the information that gets logged. For example , I have below code snippet</p>\n\n<pre><code>func (m *mountCommand) Execute(args []string) error {\n\n    filelogger.Info(\"First log\", zap.Strings(\"input args\", args))\n</code></pre>\n\n<p>And the log output is as below</p>\n\n<pre><code>    {\"level\":\"info\",\"ts\":\"2017-11-16T10:04:40.225Z\",\"msg\":\"First log\",\"input args\":[\"/var/lib/kubelet/pods/74785895-cab5-11e7-88ed-ce1c8b57856c/volumes/xyz-xandndnd\",\n    \"{\\\"kubernetes.io/secret/access-key\\\":\\\"Qdfnnfbbdnsjnxni8ehh=\\\",\\\"kubernetes.io/secret/secret-key\\\":\\\"GGHNHwsffUIJMNBNBVV==\\\",\n\\\"parallel-count\\\":\\\"5\\\",\\\"region\\\":\\\"iam-standard\\\"}\"]}\n</code></pre>\n\n<p>How do I just prevent the access-key and secret-key values from getting added to the log due to sensitivity of the data.</p>\n\n<p>I tried many string manipulation functions in Go so that I can just remove those contents before using the zap object.There seems no simple function to get this done in a straight forward simple way.</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 1233, "user_id": 4983242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQbOP.jpg?s=128&g=1", "display_name": "Dharma Saputra", "link": "https://stackoverflow.com/users/4983242/dharma-saputra"}, "edited": false, "score": 0, "creation_date": 1511778993, "post_id": 47508279, "comment_id": 81973493, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go\">Mock functions in Go</a>"}, {"owner": {"reputation": 460, "user_id": 6677487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rt-9p328Y48/AAAAAAAAAAI/AAAAAAAACR8/GX_XGEr4Gp0/photo.jpg?sz=128", "display_name": "Vikram Singh Choudhary", "link": "https://stackoverflow.com/users/6677487/vikram-singh-choudhary"}, "reply_to_user": {"reputation": 1233, "user_id": 4983242, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQbOP.jpg?s=128&g=1", "display_name": "Dharma Saputra", "link": "https://stackoverflow.com/users/4983242/dharma-saputra"}, "edited": false, "score": 0, "creation_date": 1511779626, "post_id": 47508279, "comment_id": 81973886, "body": "@DharmaSaputra, I already look at that answer but want a different possible approach/solution"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1511780686, "post_id": 47508279, "comment_id": 81974556, "body": "I think you are looking for <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/httptest</a>. A discussion on SO <a href=\"https://stackoverflow.com/questions/16154999/how-to-test-http-calls-in-go-using-httptest\">here</a>."}, {"owner": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "edited": false, "score": 0, "creation_date": 1511944979, "post_id": 47508279, "comment_id": 82053304, "body": "Why do you not want to change the interface of the function? I ask because that will change how you can implement it."}], "owner": {"reputation": 460, "user_id": 6677487, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-rt-9p328Y48/AAAAAAAAAAI/AAAAAAAACR8/GX_XGEr4Gp0/photo.jpg?sz=128", "display_name": "Vikram Singh Choudhary", "link": "https://stackoverflow.com/users/6677487/vikram-singh-choudhary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1511779939, "creation_date": 1511777128, "last_edit_date": 1511779939, "question_id": 47508279, "link": "https://stackoverflow.com/questions/47508279/mocking-function-in-golang-without-using-a-function-type-or-passing-mock-functio", "title": "Mocking function in Golang without using a function type or passing mock function as parameter", "body": "<p>I want to test LoadPage and GetData function. While testing LoadPage, I want to mock GetData function, how to do that?\nDon't want to use something like this <code>type PageGetter func(url string) string</code> and pass mock func as parameter</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"os\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc GetData(url string) (*http.Response,error){\n    return http.Get(url)\n}\n\nfunc LoadPage(url string) {\n\n    resp,err := GetData(url)\n    if err != nil {\n        os.Exit(0)\n    }\n    data,err :=ioutil.ReadAll(resp.Body)\n    fmt.Println(string(data))\n}\n\nfunc main()  {\n    var url string\n    fmt.Scanf(\"%s\", &amp;url)\n    LoadPage(url)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1511890663, "post_id": 47507450, "comment_id": 82032261, "body": "Please provide more context the next time! While @zerkms has excellent psychic debugging skills and was able to help you, that <code>github.com&#47;Jeffail&#47;gabs</code> package is certainly not a part of the Go standard library so you really ought to mention what package that <code>gabs</code> idenfifier identifies."}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 3, "last_activity_date": 1511774942, "creation_date": 1511774942, "answer_id": 47507597, "question_id": 47507450, "link": "https://stackoverflow.com/questions/47507450/catch-error-before-hand-in-golang/47507597#47507597", "title": "Catch error before hand in golang", "body": "<p>There is an <code>Exists</code> method</p>\n\n<pre><code>if jsonParsedApp.Exists(\"debug\") {\n    // you can safely read it here\n}\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://github.com/Jeffail/gabs/blob/master/gabs.go#L129\" rel=\"nofollow noreferrer\">https://github.com/Jeffail/gabs/blob/master/gabs.go#L129</a></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 47507597, "answer_count": 1, "score": 2, "last_activity_date": 1511775156, "creation_date": 1511774505, "last_edit_date": 1511775156, "question_id": 47507450, "link": "https://stackoverflow.com/questions/47507450/catch-error-before-hand-in-golang", "title": "Catch error before hand in golang", "body": "<p>I have the following code and when the attribute <code>debug</code> is missing the program crashed with error which difficult to understand. I want to catch this error and provide better message but what I\u2019ve tried is not working \nI want to avoid.</p>\n\n<pre><code>var jsonParsedApp *gabs.Container = nil    \n\ndebug := jsonParsedApp.Path(\"debug\").Data()\n//This is what I\u2019ve tried\nif debug == nil {\n    log.Println(\u201cProperty debug is missing \u201c)\n}\n</code></pre>\n"}, {"tags": ["heroku", "go", "cookies", "gorilla", "beego"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1511772143, "post_id": 47506557, "comment_id": 81969238, "body": "Start by not omitting the error returned by <code>store.Get()</code>.  What is the returned error?"}, {"owner": {"reputation": 89, "user_id": 7525883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pZY92RYSUEk/AAAAAAAAAAI/AAAAAAAAABU/CuTiIl6Cn7A/photo.jpg?sz=128", "display_name": "Abdurrahman", "link": "https://stackoverflow.com/users/7525883/abdurrahman"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511774216, "post_id": 47506557, "comment_id": 81970426, "body": "This is just an example. The first endpoint I test with have error checking and no errors are printed."}, {"owner": {"reputation": 89, "user_id": 7525883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pZY92RYSUEk/AAAAAAAAAAI/AAAAAAAAABU/CuTiIl6Cn7A/photo.jpg?sz=128", "display_name": "Abdurrahman", "link": "https://stackoverflow.com/users/7525883/abdurrahman"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1511774331, "post_id": 47506557, "comment_id": 81970495, "body": "Here is the full code <a href=\"https://pastebin.com/GNiggVDt\" rel=\"nofollow noreferrer\">pastebin.com/GNiggVDt</a>"}, {"owner": {"reputation": 546, "user_id": 1174534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8267f69e15cd421deb3ca8a0524ec4?s=128&d=identicon&r=PG", "display_name": "navossoc", "link": "https://stackoverflow.com/users/1174534/navossoc"}, "edited": false, "score": 0, "creation_date": 1511843594, "post_id": 47506557, "comment_id": 82004237, "body": "I think this may be your problem: <a href=\"https://devcenter.heroku.com/articles/go-sessions\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/go-sessions</a>"}], "owner": {"reputation": 89, "user_id": 7525883, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pZY92RYSUEk/AAAAAAAAAAI/AAAAAAAAABU/CuTiIl6Cn7A/photo.jpg?sz=128", "display_name": "Abdurrahman", "link": "https://stackoverflow.com/users/7525883/abdurrahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1511772466, "creation_date": 1511771226, "last_edit_date": 1511772466, "question_id": 47506557, "link": "https://stackoverflow.com/questions/47506557/gorilla-sessions-not-working-on-heroku", "title": "Gorilla sessions not working on heroku", "body": "<p>Hello I am using beego to create an API, and I am using gorillla for the session as I had problems with beego's session. Now this is working well on localhost but cookies are not sent on the deployed version on heroku.\nHere is how I set the cookies in a controller:</p>\n\n<pre><code>session, _ := store.Get(c.Ctx.Request, \"session\") // c is the controller\nsession.Values[\"id\"] = user.Id\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3568, "user_id": 3621735, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fd836e3ae389f324e2f8112b33a5772?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3621735/sam"}, "edited": false, "score": 0, "creation_date": 1511772453, "post_id": 47506534, "comment_id": 81969415, "body": "Doesn&#39;t shadowing occur for same name variables, if redeclared? I changed (a int) to (a bool) and still got the same shadowing error on empty return."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1511773046, "post_id": 47506534, "comment_id": 81969764, "body": "@peterSO I believe this is not correct: &quot;The call argument, <code>(a int)</code>, type <code>int</code> is shadowed by the return argument names <code>int</code>.&quot; Change it to <code>(a float64)</code> and you get the same error, change one return int to float64 and you lose the error. What the error means is that the first return variable named <code>int</code> is shadowed by the second return variable named <code>int</code>. <a href=\"https://play.golang.org/p/YkuPSxkC-4\" rel=\"nofollow noreferrer\">play.golang.org/p/YkuPSxkC-4</a>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1511794396, "last_edit_date": 1511794396, "creation_date": 1511771119, "answer_id": 47506534, "question_id": 47506173, "link": "https://stackoverflow.com/questions/47506173/using-named-result-params-partially-to-set-defaults/47506534#47506534", "title": "Using named result params partially to set defaults", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">Function types</a> </p>\n  \n  <p>Within a list of parameters or results, the names (IdentifierList)\n  must either all be present or all be absent. If present, each name\n  stands for one item (parameter or result) of the specified type and\n  all non-blank names in the signature must be unique. If absent, each\n  type stands for one item of that type.</p>\n</blockquote>\n\n<hr>\n\n<pre><code>package main\n\n// duplicate argument int\nfunc call1(a int) (int, int, r3 string) {\n    // int is shadowed during return\n    return\n}\n\n// duplicate argument int\nfunc call2(a int) (int string, int string, r3 string) {\n    // int is shadowed during return\n    return\n}\n\n// duplicate argument int\nfunc call3(a bool) (int, int, r3 string) {\n    // int is shadowed during return\n    return\n}\n\nfunc call4(a int) (int, r2, r3 string) {\n    return\n}\n\nfunc call5(a int) (r1, r2, r3 string) {\n    return\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/PUhY7Y0H9f\" rel=\"nofollow noreferrer\">https://play.golang.org/p/PUhY7Y0H9f</a></p>\n\n<p>Output:</p>\n\n<pre><code>tmp/sandbox842451638/main.go:4:33: duplicate argument int\ntmp/sandbox842451638/main.go:6:2: int is shadowed during return\ntmp/sandbox842451638/main.go:10:47: duplicate argument int\ntmp/sandbox842451638/main.go:12:2: int is shadowed during return\ntmp/sandbox842451638/main.go:16:34: duplicate argument int\ntmp/sandbox842451638/main.go:18:2: int is shadowed during return\n</code></pre>\n\n<hr>\n\n<p><code>call1</code> is shorthand for <code>call2</code>. As you can see, you have duplicate return argument names <code>int</code>: \"all non-blank names in the signature must be unique.\" The first return argument name <code>int</code> is shadowed by the second return argument name <code>int</code>.</p>\n\n<hr>\n\n<p>If you want anonymous return arguments, you can use the blank identifier.</p>\n\n<pre><code>package main\n\n// duplicate argument int\nfunc callA(a int) (int, int, r3 string) {\n    // int is shadowed during return\n    return\n}\n\nfunc callB(a int) (_ int, _ int, r3 string) {\n    return\n}\n\nfunc main() {}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/CS1x9mmIh6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CS1x9mmIh6</a></p>\n"}], "owner": {"reputation": 3568, "user_id": 3621735, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fd836e3ae389f324e2f8112b33a5772?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3621735/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 47506534, "answer_count": 1, "score": 2, "last_activity_date": 1511794396, "creation_date": 1511769388, "question_id": 47506173, "link": "https://stackoverflow.com/questions/47506173/using-named-result-params-partially-to-set-defaults", "title": "Using named result params partially to set defaults", "body": "<p>Let's say I have a function with 3 return values. I set the values of 2 of them, and want to leave the 3rd one to default if I do not set it. Something like this -</p>\n\n<pre><code>func call(a int) (int, int, r3 string){\n\n  //        return a, a+1, \"no error\" // stmt 1\n  //        return a, a+1             // stmt 2\n  //        return                    // stmt 3\n}\n</code></pre>\n\n<p>Running with stmt 2 or stmt 3 uncommented, I get below error - </p>\n\n<pre><code>duplicate argument int\nint is shadowed during return\n</code></pre>\n\n<p>How is int shadowed here? The return list does not have named int params.</p>\n\n<p>Running with stmt 1 uncommented, I get below error - </p>\n\n<pre><code>duplicate argument int\ncannot use a (type int) as type string in return argument\ncannot use a + 1 (type int) as type string in return argument\n</code></pre>\n\n<p>Can someone explain origin of these errors ?</p>\n\n<p>Is it not possible to have partial list of named result params (or even returning variables when using named result params) ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1511791316, "post_id": 47505730, "comment_id": 81981191, "body": "You don&#39;t need a tool, a stack trace will show the status of all goroutines."}], "answers": [{"tags": [], "owner": {"reputation": 240, "user_id": 8800369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4f69be8fda374dc3075128df3a05f37?s=128&d=identicon&r=PG", "display_name": "Hein Oldewage", "link": "https://stackoverflow.com/users/8800369/hein-oldewage"}, "is_accepted": false, "score": 1, "last_activity_date": 1511796540, "creation_date": 1511796540, "answer_id": 47514478, "question_id": 47505730, "link": "https://stackoverflow.com/questions/47505730/detect-which-lock-causes-program-to-hang/47514478#47514478", "title": "Detect which Lock() causes program to hang?", "body": "<p>You can get a stack trace using <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\">pprof</a>.</p>\n\n<p>If you follow the example code in the package the url <a href=\"http://localhost:6060/debug/pprof/goroutine?debug=1\" rel=\"nofollow noreferrer\">http://localhost:6060/debug/pprof/goroutine?debug=1</a> will give you a stack trace of every running goroutine.</p>\n"}], "owner": {"reputation": 2280, "user_id": 2094168, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf7f39f46237a00ea06cd9706be9efab?s=128&d=identicon&r=PG", "display_name": "2ank3th", "link": "https://stackoverflow.com/users/2094168/2ank3th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511796540, "creation_date": 1511767531, "question_id": 47505730, "link": "https://stackoverflow.com/questions/47505730/detect-which-lock-causes-program-to-hang", "title": "Detect which Lock() causes program to hang?", "body": "<p>In my go program, the execution is hung up because it is waiting for Lock(). Are there tools in go which I can use to find the exact line where it is getting deadlocked? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1511749641, "post_id": 47503080, "comment_id": 81962103, "body": "<a href=\"https://github.com/golang/go/issues/11865\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/11865</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1511750214, "post_id": 47503080, "comment_id": 81962214, "body": "What original problem are you solving? Is this copy operation a bottleneck? Have you profiled and checked the go assembly for this code?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1511759399, "post_id": 47503080, "comment_id": 81964329, "body": "Unduable. Map values are not addressable."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1511760506, "post_id": 47503080, "comment_id": 81964638, "body": "A solution to the problem may be to use <code>map[keyType]*Foo</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 3, "last_activity_date": 1511761575, "creation_date": 1511761575, "answer_id": 47504630, "question_id": 47503080, "link": "https://stackoverflow.com/questions/47503080/how-get-a-pointer-to-a-value-in-a-map-in-go/47504630#47504630", "title": "How get a pointer to a value in a map in Go", "body": "<p>For this operation you may use <code>map</code> if pointers. Like:</p>\n\n<pre><code>var myMap = map[int]*Foo\n\nif _, val := range myMap {\n  // val is of type `* Foo`\n  SomeFunction(val)\n}\n</code></pre>\n"}], "owner": {"reputation": 1457, "user_id": 2638548, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mkJxQ.jpg?s=128&g=1", "display_name": "dlasalle", "link": "https://stackoverflow.com/users/2638548/dlasalle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2679, "favorite_count": 1, "accepted_answer_id": 47504630, "answer_count": 1, "score": 2, "last_activity_date": 1511761575, "creation_date": 1511749030, "question_id": 47503080, "link": "https://stackoverflow.com/questions/47503080/how-get-a-pointer-to-a-value-in-a-map-in-go", "title": "How get a pointer to a value in a map in Go", "body": "<p>I would like to get a pointer to a map value (which contains structs), so that I can modify a field in the struct, without having to re-assign it.</p>\n\n<pre><code>type Foo struct {\n    Bar int64\n}\n\nfunc SomeFunction(arg * Foo) {\n    ...\n}\n</code></pre>\n\n<p>What I currently have to do:</p>\n\n<pre><code>if val, ok := myMap[idx]; ok {\n  // val is of type `Foo`\n  SomeFunction(&amp;val)\n  myMap[idx] = val\n}\n</code></pre>\n\n<p>What I'd like to do:</p>\n\n<pre><code>if val, ok := getPointer(myMap, idx); ok {\n  // val is of type `* Foo`\n  SomeFunction(val)\n}\n</code></pre>\n\n<p>Is there a way to do this Go, or do I need to rely on the compiler being smart enough to perform copy elision here?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511712067, "post_id": 47497959, "comment_id": 81951386, "body": "In Go you can loop over a map just like you loop over an array, instead of the <code>index, value</code> combo, you&#39;ll get <code>key, value</code> from <code>:= range map</code>."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1511713027, "creation_date": 1511713027, "answer_id": 47498257, "question_id": 47497959, "link": "https://stackoverflow.com/questions/47497959/loop-over-json-using-golang-go-simplejson/47498257#47498257", "title": "Loop over Json using Golang go-simplejson", "body": "<p>In Go you can use the <code>range</code> loop to iterate over a <code>map</code> the same way you would over an <code>array</code> or <code>slice</code>. The values provided to you by the range loop on each iteration will be the map's keys and their corresponding values.</p>\n\n<p>So you can simply change your loop line from:</p>\n\n<pre><code>for k, v := range settings.MustArray() {\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>for k, v := range settings.MustMap() {\n</code></pre>\n\n<hr>\n\n<p>Also, personally, I would recommend ditching <code>simplejson</code> unless you have a better use case for it than what you have in your example. Using the standard <code>encoding/json</code> you can achieve the same result with less effort in my opinion.</p>\n\n<pre><code>var settings map[string]interface{}\nif err := json.NewDecoder(req.Body).Decode(&amp;settings); err != nil {\n    panic(err)\n}\nfmt.Printf(\"\\nJson: %+v\",settings)\n\nfor k, v := range settings {\n    fmt.Println(\"\\n k:\",k)\n    fmt.Println(\"\\n v:\",v)\n}\n</code></pre>\n\n<p>Example on playground: <a href=\"https://play.golang.org/p/TKdO5pOJCY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TKdO5pOJCY</a></p>\n\n<p>More info on <code>for</code> with <code>range</code> here: <a href=\"https://golang.org/ref/spec#For_range\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#For_range</a></p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1594, "favorite_count": 0, "accepted_answer_id": 47498257, "answer_count": 1, "score": 1, "last_activity_date": 1511713027, "creation_date": 1511711377, "question_id": 47497959, "link": "https://stackoverflow.com/questions/47497959/loop-over-json-using-golang-go-simplejson", "title": "Loop over Json using Golang go-simplejson", "body": "<p>I am working in Golang,and using the package <code>github.com/bitly/go-simplejson</code></p>\n\n<p>I will receive a Json from the client side, I already constructed the json object using that package. Now I need to iterate over all the \"first level\" elements of that Json. The Json is something like this:</p>\n\n<pre><code>{\"Name\":\"demo2\",\"Creator\":\"some creator\",\"URL\":\"www.url.com\",\"GACode\":\"UA-xxxx\"} \n</code></pre>\n\n<p>My code is:</p>\n\n<pre><code>body, _ := ioutil.ReadAll(req.Body)\nsettings,_ := simplejson.NewJson(body)\nfmt.Printf(\"\\nJson: %+v\",settings)\n\nfor k, v := range settings.MustArray() {\n    fmt.Println(\"\\n k:\",k)\n    fmt.Println(\"\\n v:\",v)\n}\n</code></pre>\n\n<p>When I print the Json I receive:</p>\n\n<pre><code>Json: &amp;{data:map[Name:demo2 Creator:some creator URL:www.url.com GACode:UA-xxxx]}\n</code></pre>\n\n<p>And the loop is giving me nothing, MustArray() is giving me an empty array. The keys of that Json are very dynamic so I cannot do somehting like <code>.Get(\"TheKey\")</code> because I don't know the name of the keys that can come in the json.</p>\n\n<p>Then, how can I loop over that Json? I am more insterested in loop over the first level of that Json.</p>\n"}, {"tags": ["go", "goland"], "comments": [{"owner": {"reputation": 342, "user_id": 2349055, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/acf4e1f8d0a92e6ccaedb44a73945dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Nir", "link": "https://stackoverflow.com/users/2349055/nir"}, "edited": false, "score": 3, "creation_date": 1511708853, "post_id": 47497486, "comment_id": 81950354, "body": "Make f of  func2 in Upper case like Func2() and try.."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "edited": false, "score": 0, "creation_date": 1511709319, "post_id": 47497486, "comment_id": 81950513, "body": "Check Run Configuration in Goland."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1511710106, "post_id": 47497486, "comment_id": 81950768, "body": "It seems that Goland, when you press <code>RUN</code>, only executes <code>go run main.go</code> leaving out the <code>file2.go</code> argument. So you have to look into the settings and see if you can change it to something like <code>go run *.go</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 7, "last_activity_date": 1618894046, "last_edit_date": 1618894046, "creation_date": 1511709931, "answer_id": 47497721, "question_id": 47497486, "link": "https://stackoverflow.com/questions/47497486/goland-doesnt-see-functions-from-another-file/47497721#47497721", "title": "Goland doesn&#39;t see functions from another file", "body": "<p>Go to <code>Run | Edit Configurations</code> and change the run configuration <code>Type</code> to point from <code>File</code> to a <code>Package</code>, then the package name must be fully qualified (for example <code>github.com/user/package</code>).</p>\n<p>Edit:\nYou can also right-click on the folder and then select <code>Run | go test &lt;folder name&gt;</code>. This will create a run configuration of the type <code>Directory</code>.</p>\n<p><strong>Note:</strong> there are differences between the <code>Directory</code> and <code>Package</code> type configurations.</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 0, "accepted_answer_id": 47497721, "answer_count": 1, "score": 3, "last_activity_date": 1618894046, "creation_date": 1511708535, "question_id": 47497486, "link": "https://stackoverflow.com/questions/47497486/goland-doesnt-see-functions-from-another-file", "title": "Goland doesn&#39;t see functions from another file", "body": "<p>I have <code>main.go</code> file</p>\n\n<pre><code>package main\n\nfunc main() {\n    func2()\n}\n</code></pre>\n\n<p><code>func2</code> is defined in <code>file2.go</code>: </p>\n\n<pre><code>package main\n\nfunc func2(){\n    ...\n}\n</code></pre>\n\n<p>Everything is OK when I compile and run it from a command line:</p>\n\n<pre><code>go run main.go file2.go\n</code></pre>\n\n<p>But when I run it from <code>Goland</code> by pressing <code>RUN</code> it gives me an error:</p>\n\n<pre><code># command-line-arguments\n./main.go:95: undefined: func2\n</code></pre>\n\n<p>How should I overcome it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 342, "user_id": 2349055, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/acf4e1f8d0a92e6ccaedb44a73945dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Nir", "link": "https://stackoverflow.com/users/2349055/nir"}, "edited": false, "score": 0, "creation_date": 1511709360, "post_id": 47497425, "comment_id": 81950533, "body": "why you have created 2 different structs with the same fields ?"}, {"owner": {"reputation": 11, "user_id": 9010649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c3187973645c7d230ee60141c959ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Mikky", "link": "https://stackoverflow.com/users/9010649/mikky"}, "reply_to_user": {"reputation": 342, "user_id": 2349055, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/acf4e1f8d0a92e6ccaedb44a73945dcf?s=128&d=identicon&r=PG&f=1", "display_name": "Nir", "link": "https://stackoverflow.com/users/2349055/nir"}, "edited": false, "score": 0, "creation_date": 1511710169, "post_id": 47497425, "comment_id": 81950784, "body": "Last json factor is not same, Sell is the last one is amount, but Buy is the buy_amount. this needs to post the website as deference field."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1511717487, "last_edit_date": 1511717487, "creation_date": 1511715191, "answer_id": 47498647, "question_id": 47497425, "link": "https://stackoverflow.com/questions/47497425/about-golfing-is-there-a-nice-way-to-not-have-redundancy-in-this-code/47498647#47498647", "title": "About golfing, Is there a nice way to not have redundancy in this code?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.8\" rel=\"nofollow noreferrer\">Go 1.8 Release Notes </a></p>\n  \n  <p><a href=\"https://golang.org/doc/go1.8#language\" rel=\"nofollow noreferrer\">Changes to the language</a></p>\n  \n  <p>When explicitly converting a value from one struct type to another, as\n  of Go 1.8 the tags are ignored. Thus two structs that differ only in\n  their tags may be converted from one to the other:</p>\n\n<pre><code>func example() {\n  type T1 struct {\n      X int `json:\"foo\"`\n  }\n  type T2 struct {\n      X int `json:\"bar\"`\n  }\n  var v1 T1\n  var v2 T2\n  v1 = T1(v2) // now legal\n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>This is how I do it. I have an <code>Order</code> <code>struct</code>. <code>Buy</code> and <code>Sell</code> <code>struct</code> differences are an artifact of <code>json</code>, which I hide from the rest of the program.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Order struct {\n    Pair      string `json:\"pair\"`\n    OrderType string `json:\"order_type\"`\n    Amount    string `json:\"amount\"`\n}\n\nfunc CreateSomething(pair, amount, orderType string) Order {\n    type Sell struct {\n        Pair      string `json:\"pair\"`\n        OrderType string `json:\"order_type\"`\n        Amount    string `json:\"amount\"`\n    }\n    type Buy struct {\n        Pair      string `json:\"pair\"`\n        OrderType string `json:\"order_type\"`\n        Amount    string `json:\"buy_amount\"`\n    }\n\n    var order Order\n    var buf []byte\n    switch orderType {\n    case \"sell\":\n        sell := Sell{pair, orderType, amount}\n        buf, _ = json.Marshal(sell)\n        order = Order(sell)\n    case \"buy\":\n        buy := Buy{pair, orderType, amount}\n        buf, _ = json.Marshal(buy)\n        order = Order(buy)\n    }\n    fmt.Println(string(buf))\n    return order\n}\n\nfunc main() {\n    order := CreateSomething(\"twin\", \"$1,000\", \"sell\")\n    fmt.Println(order)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/E2PL7wE3ls\" rel=\"nofollow noreferrer\">https://play.golang.org/p/E2PL7wE3ls</a></p>\n\n<p>Output:</p>\n\n<pre><code>{\"pair\":\"twin\",\"order_type\":\"sell\",\"amount\":\"$1,000\"}\n{twin sell $1,000}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1511763163, "creation_date": 1511763163, "answer_id": 47504927, "question_id": 47497425, "link": "https://stackoverflow.com/questions/47497425/about-golfing-is-there-a-nice-way-to-not-have-redundancy-in-this-code/47504927#47504927", "title": "About golfing, Is there a nice way to not have redundancy in this code?", "body": "<p>You may move common part to a separate structure and then embed it into the structures:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Order struct {\n    Pair      string `json:\"pair\"`\n    OrderType string `json:\"order_type\"`\n}\n\ntype Sell struct {\n    Order\n    Amount string `json:\"amount\"`\n}\n\ntype Buy struct {\n    Order\n    Amount string `json:\"buy_amount\"`\n}\n\nfunc CreateSomething(a, b, c, OrderType string) {\n    SellPram := Sell{}\n    BuyPram := Buy{}\n    if OrderType == \"sell\" {\n        SellPram = Sell{Order{Pair: a, OrderType: b}, c}\n        s, err := json.Marshal(SellPram)\n        fmt.Println(s, err)\n    } else if OrderType == \"buy\" {\n        BuyPram = Buy{Order{a, b}, c}\n        s, err := json.Marshal(BuyPram)\n        fmt.Println(string(s), err)\n    }\n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    CreateSomething(\"a\", \"b\", \"c\", \"buy\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aTjSRkMVqr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/aTjSRkMVqr</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9010649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c3187973645c7d230ee60141c959ec4?s=128&d=identicon&r=PG&f=1", "display_name": "Mikky", "link": "https://stackoverflow.com/users/9010649/mikky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1511763163, "creation_date": 1511708095, "last_edit_date": 1511741455, "question_id": 47497425, "link": "https://stackoverflow.com/questions/47497425/about-golfing-is-there-a-nice-way-to-not-have-redundancy-in-this-code", "title": "About golfing, Is there a nice way to not have redundancy in this code?", "body": "<p>I just started learning golang. In a structure, I am using the below:</p>\n\n<pre><code>type Sell struct {\n    Pair string      `json:\"pair\"`\n    OrderType string `json:\"order_type\"`\n    Amount string    `json:\"amount\"`\n}\n\ntype Buy struct {\n    Pair string      `json:\"pair\"`\n    OrderType string `json:\"order_type\"`\n    Amount string    `json:\"buy_amount\"`\n}\n\nfunc CreateSomething(a, b, c, OrderType string) {\n    SellPram := Sell{}\n    BuyPram  := Buy{}\n    if OrderType == \"sell\" {\n        SellPram = Sell{a,b,c}\n        json.Marshal(SellPram)\n    } else if OrderType == \"buy\" {\n        BuyPram = Buy{a,b,c}\n        json.Marshal(BuyPram)\n    }\n}\n</code></pre>\n\n<p>In this code, I declared structures in main function both <code>SellPram</code> and <code>BuyPram</code>, but I think this is very redundant in the code. \nSo is there a nice way to not declare both <code>SellPram</code> and <code>BuyPram</code>.\nI don't want to declare both of them, because at least one side will not use by the end of the function.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1, "user_id": 7403750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25708380a069c29076b79c67588132c7?s=128&d=identicon&r=PG&f=1", "display_name": "mfpass", "link": "https://stackoverflow.com/users/7403750/mfpass"}, "reply_to_user": {"reputation": 3521, "user_id": 2304215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W708V.png?s=128&g=1", "display_name": "chrk", "link": "https://stackoverflow.com/users/2304215/chrk"}, "edited": false, "score": 0, "creation_date": 1511717599, "post_id": 47497218, "comment_id": 81953208, "body": "the only idea was to slice strings, convert it to map and then try to add the values but it involves so many loops that I gave up for a moment, because maybe there is something simpler to implement"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9012800, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CpO8N.jpg?s=128&g=1", "display_name": "fuzzyqu", "link": "https://stackoverflow.com/users/9012800/fuzzyqu"}, "is_accepted": false, "score": 0, "last_activity_date": 1511756325, "creation_date": 1511756325, "answer_id": 47503908, "question_id": 47497218, "link": "https://stackoverflow.com/questions/47497218/manipulate-data-in-array-of-strings/47503908#47503908", "title": "manipulate data in array of strings", "body": "<p>You can use a map to achieve that.</p>\n\n<pre><code>var a [3]string\na[0] = \"red|apple|1\"\na[1] = \"yellow|apple|3\"\na[2] = \"red|apple|4\"\n\nb := make(map[string]int)\n\nfor _, s := range a {\n    k := s[:len(s)-2]\n    v := s[len(s)-1:]\n    i, err:= strconv.Atoi(v) // please, check for errors\n    if err != nil {\n        fmt.Println(\"bad input\")\n        continue\n    }\n    b[k] += i\n}\n\nfor k, v := range b {\n    fmt.Println(k, v)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>yellow|apple 3\nred|apple 5\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7403750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25708380a069c29076b79c67588132c7?s=128&d=identicon&r=PG&f=1", "display_name": "mfpass", "link": "https://stackoverflow.com/users/7403750/mfpass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1511756325, "creation_date": 1511706720, "last_edit_date": 1511707501, "question_id": 47497218, "link": "https://stackoverflow.com/questions/47497218/manipulate-data-in-array-of-strings", "title": "manipulate data in array of strings", "body": "<p>I have an array of strings:</p>\n\n<pre><code>var a [5]string\na[0] = \"red|apple|1\"\na[1] = \"yellow|apple|3\"\na[2] = \"red|apple|4\"\n</code></pre>\n\n<p>I need to convert the data to array or map or whatever but if first and second values between pipes are the same the numbers should be added, so my desired output would be:</p>\n\n<pre><code>var b [5]string\na[0] = \"red|apple|5\"\na[1] = \"yellow|apple|3\"\n</code></pre>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["arrays", "string", "mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 13835, "user_id": 1807881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sied7.png?s=128&g=1", "display_name": "hassansin", "link": "https://stackoverflow.com/users/1807881/hassansin"}, "is_accepted": false, "score": 0, "last_activity_date": 1511741050, "last_edit_date": 1511741050, "creation_date": 1511739271, "answer_id": 47502176, "question_id": 47496603, "link": "https://stackoverflow.com/questions/47496603/retrieve-unstructured-array-from-mongodb-in-golang/47502176#47502176", "title": "Retrieve unstructured array from mongodb in golang", "body": "<p>You can use a <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Setter\" rel=\"nofollow noreferrer\">Setter</a> to use a custom unmarshal method like below:</p>\n\n<pre><code>type Record struct {\n    //...\n    Groups Groups        `bson:\"groups\"`\n}\n\ntype Groups string\n\nfunc (g *Groups) SetBSON(raw bson.Raw) error {\n    var data []string\n    err := raw.Unmarshal(&amp;data)\n    *g = Groups(strings.Join(data, \",\"))\n    return err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1511772603, "creation_date": 1511772603, "answer_id": 47506922, "question_id": 47496603, "link": "https://stackoverflow.com/questions/47496603/retrieve-unstructured-array-from-mongodb-in-golang/47506922#47506922", "title": "Retrieve unstructured array from mongodb in golang", "body": "<p><code>groups</code> is an array in MongoDB, so in Go use a slice type:</p>\n\n<pre><code>type Record struct {\n    ID           bson.ObjectId `bson:\"_id\"`\n    IP           string        `bson:\"ip\"`\n    Browser      string        `bson:\"browser\"`\n    DateTime     string        `bson:\"datetime\"`\n    Groups       []string      `bson:\"groups\"`\n}\n</code></pre>\n\n<p>Once you get the records like this:</p>\n\n<pre><code>err := c.Find(nil).All(&amp;result)\n// Do check error\n</code></pre>\n\n<p>You can concatenate them with a comma <code>,</code> using <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"noreferrer\"><code>strings.Join()</code></a>. Example:</p>\n\n<pre><code>s := []string{\"group1\", \"group2\"}\nall := strings.Join(s, \",\")\nfmt.Println(all)\n</code></pre>\n\n<p>The code above prints (try it on the <a href=\"https://play.golang.org/p/W82Z3UK7ca\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>group1,group2\n</code></pre>\n\n<p>So for example to print the groups:</p>\n\n<pre><code>for _, r := range result {\n    fmt.Println(strings.Join(r.Groups, \",\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 1731139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ecc0ece730253b35dd4384d7a4ba35?s=128&d=identicon&r=PG", "display_name": "pidgebob", "link": "https://stackoverflow.com/users/1731139/pidgebob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1713, "favorite_count": 0, "accepted_answer_id": 47506922, "answer_count": 2, "score": 5, "last_activity_date": 1536685776, "creation_date": 1511702508, "last_edit_date": 1536685776, "question_id": 47496603, "link": "https://stackoverflow.com/questions/47496603/retrieve-unstructured-array-from-mongodb-in-golang", "title": "Retrieve unstructured array from mongodb in golang", "body": "<p>I have the following document in MongoDB</p>\n\n<pre><code>{\n     \"_id\" : ObjectId(\"57e4f8f454b9a4bb13a031d8\"),\n     \"ip\" : \"192.168.0.1\",\n     \"browser\" : \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729)\",\n     \"datetime\" : ISODate(\"2016-09-23T09:42:12.821Z\"),\n     \"userhash\" : \"BF12742F1B3A486F75E80843230168CE\",\n     \"groups\" : [ \n         \"group1\", \n         \"group2\"\n     ]\n}\n</code></pre>\n\n<p>I'm trying to get the groups into a comma separated string like <code>group1,group2</code> but as much as I've tried I keep coming up against a brick wall.</p>\n\n<p>Closest I've got is as follows</p>\n\n<pre><code>type Record struct {\n    ID           bson.ObjectId `bson:\"_id\"`\n    IP           string        `bson:\"ip\"`\n    Browser      string        `bson:\"browser\"`\n    DateTime     string        `bson:\"datetime\"`\n    Groups       bson.M        `bson:\"groups,inline\"`\n} \n\nresult = []Record{}\n\n_ = c.Find(bson.M{}).All(&amp;result)\n</code></pre>\n\n<p>The seems to put the groups into a map but I then can't get the groups into a string. I'm fairly new to Go so I'm still learning the different data types and what syntax to use to access them.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "dictionary", "go", "indexing"], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1511699452, "post_id": 47496108, "comment_id": 81947408, "body": "yes, it&#39;s good, but is it possible to do it while populating <code>Map</code> to avoid additional assignments like this <code>hm := Map[&quot;hosts&quot;].([]Host)</code>?"}], "tags": [], "owner": {"reputation": 1169, "user_id": 498109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100036fbeed75b1abf5bf0161d1fb560?s=128&d=identicon&r=PG", "display_name": "Vadyus", "link": "https://stackoverflow.com/users/498109/vadyus"}, "is_accepted": true, "score": 10, "last_activity_date": 1558096748, "last_edit_date": 1558096748, "creation_date": 1511698817, "answer_id": 47496108, "question_id": 47496040, "link": "https://stackoverflow.com/questions/47496040/type-interface-does-not-support-indexing-in-golang/47496108#47496108", "title": "type interface {} does not support indexing in golang", "body": "<p>You have to explicitly convert your interface{} to a slice of the expected type to achieve it. Something like this\n<a href=\"https://play.golang.org/p/yZmniZwFar\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yZmniZwFar</a></p>\n"}, {"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1511702553, "post_id": 47496548, "comment_id": 81948366, "body": "There is no reason to reach for reflection here. Use the two-value form of type assertions to avoid the panic: u, ok := myMap[&quot;user&quot;].([]User)"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1511703759, "post_id": 47496548, "comment_id": 81948764, "body": "Thank you for correcting me, you&#39;re right about that. I edit my answer now"}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 7, "last_activity_date": 1511731689, "last_edit_date": 1511731689, "creation_date": 1511702151, "answer_id": 47496548, "question_id": 47496040, "link": "https://stackoverflow.com/questions/47496040/type-interface-does-not-support-indexing-in-golang/47496548#47496548", "title": "type interface {} does not support indexing in golang", "body": "<p>First thing to be noted is the <code>interface{}</code> can hold any data type including <code>function</code> and <code>struct</code> or <code>[]struct</code>. Since the error gives you : </p>\n\n<blockquote>\n  <p>(type interface {} does not support indexing)</p>\n</blockquote>\n\n<p>It means that it holds no <code>slice</code> or no <code>array</code> values. Because you directly call the <code>index</code> in this case is <code>0</code> to an <code>interface{}</code> and you assume that the <code>Map[\"Users\"]</code> is an array. But it is not. This is one of very good thing about Go it is statically type which mean all the data type is check at compiled time.</p>\n\n<p>if you want to be avoid the parsing error like this: </p>\n\n<blockquote>\n  <p>panic: interface conversion: interface {} is []main.User, not\n  []main.Host</p>\n</blockquote>\n\n<p>To avoid that error while your parsing it to another type like <code>Map[\"user\"].([]User)</code> just in case that another data type pass to the <code>interface{}</code> consider the code snippet below : </p>\n\n<pre><code>u, ok := myMap[\"user\"].([]User)\nif ok {\n    log.Printf(\"value = %+v\\n\", u)\n}\n</code></pre>\n\n<p>Above code is simple and you can use it to check if the interface match to the type you are parsing.</p>\n\n<p>And if you want to be more general passing the value to your <code>interface{}</code> at runtime you can check it first using <code>reflect.TypeOf()</code> please consider this code : </p>\n\n<pre><code>switch reflect.TypeOf(myMap[\"user\"]).String() {\ncase \"[]main.User\":\n    log.Println(\"map = \", \"slice of user\")\n    logger.Debug(\"map = \", myMap[\"user\"].([]User)[0])\n\ncase \"[]main.Host\":\n    log.Println(\"map = \", \"slice of host\")\n    logger.Debug(\"map = \", myMap[\"user\"].([]Host)[0])\n\n}\n</code></pre>\n\n<p>after you know what's the value of the <code>interface{}</code> you can confidently parse it the your specific data type in this case slice of user <code>[]User</code>. Not that the <code>main</code> there is a package name you can change it to yours.</p>\n"}], "owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18844, "favorite_count": 1, "accepted_answer_id": 47496108, "answer_count": 2, "score": 12, "last_activity_date": 1558096748, "creation_date": 1511698459, "last_edit_date": 1511699395, "question_id": 47496040, "link": "https://stackoverflow.com/questions/47496040/type-interface-does-not-support-indexing-in-golang", "title": "type interface {} does not support indexing in golang", "body": "<p>I have such map:</p>\n\n<pre><code>Map := make(map[string]interface{})\n</code></pre>\n\n<p>This map is supposed to contain mapping from string to array of objects. Arrays can be of different types, like <code>[]Users</code> or <code>[]Hosts</code>. I populated this array:</p>\n\n<pre><code>TopologyMap[\"Users\"] = Users_Array\nTopologyMap[\"Hosts\"] = Hosts_Array\n</code></pre>\n\n<p>but when I try to get an elements  from it:</p>\n\n<pre><code>Map[\"Users\"][0]\n</code></pre>\n\n<p>it gives an error:\n<code>(type interface {} does not support indexing)</code></p>\n\n<p>How can I overcome it?</p>\n"}, {"tags": ["debugging", "go", "delve"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 2, "creation_date": 1511683021, "post_id": 47493829, "comment_id": 81943198, "body": "There is no way to do this AFAIK; not with the standard commandline anyway."}, {"owner": {"reputation": 41, "user_id": 4922918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YqMW0fiCF-c/AAAAAAAAAAI/AAAAAAAAAFU/YXgGTVh5SZQ/photo.jpg?sz=128", "display_name": "Xiaodong Feng", "link": "https://stackoverflow.com/users/4922918/xiaodong-feng"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1511690834, "post_id": 47493829, "comment_id": 81944899, "body": "@Carpetsmoker Thank you for your answer. As a new delve user, I&#39;m interesting to known why &#39;disable&#39;-like command not support in dlv? In my mind,  this is a very useful command when debugging.Or there is any other better meth to disable-enable breakpoints?"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1511775029, "post_id": 47493829, "comment_id": 81970896, "body": "Probably because no one took the time to make it (yet). I agree it would be a useful feature though; it&#39;s actually on my wishlist as well. I suspect it wouldn&#39;t be too hard to implement. So if you really want it, you could try implementing it :-)"}, {"owner": {"reputation": 41, "user_id": 4922918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YqMW0fiCF-c/AAAAAAAAAAI/AAAAAAAAAFU/YXgGTVh5SZQ/photo.jpg?sz=128", "display_name": "Xiaodong Feng", "link": "https://stackoverflow.com/users/4922918/xiaodong-feng"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1512984740, "post_id": 47493829, "comment_id": 82459840, "body": "@Carpetsmoker I found jetBrain&#39;s GoLand debug-ui support &#39;disable breakpoints&#39; feature today, and it works.  I known GoLand use  delve as its debug tools, maybe jetBrain do something above delve."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1512985138, "post_id": 47493829, "comment_id": 82460059, "body": "It&#39;s just an UI to the Delve API, like the commandline interface is. It can implement feature independently."}, {"owner": {"reputation": 41, "user_id": 4922918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YqMW0fiCF-c/AAAAAAAAAAI/AAAAAAAAAFU/YXgGTVh5SZQ/photo.jpg?sz=128", "display_name": "Xiaodong Feng", "link": "https://stackoverflow.com/users/4922918/xiaodong-feng"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1512986627, "post_id": 47493829, "comment_id": 82460992, "body": "@Carpetsmoker I running my program in delve and open remote-debug port, then GoLand link to delve server to debugging, so I think GoLand implement some feature in its debug client."}], "owner": {"reputation": 41, "user_id": 4922918, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YqMW0fiCF-c/AAAAAAAAAAI/AAAAAAAAAFU/YXgGTVh5SZQ/photo.jpg?sz=128", "display_name": "Xiaodong Feng", "link": "https://stackoverflow.com/users/4922918/xiaodong-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1511682966, "creation_date": 1511680044, "last_edit_date": 1511682966, "question_id": 47493829, "link": "https://stackoverflow.com/questions/47493829/how-to-disable-breakpoints-when-debugging-go-program-in-dlvdelve-like-using-gd", "title": "how to disable breakpoints when debugging go program in dlv(delve) like using gdb?", "body": "<p>When using gdb to debugging go program, we can disable all breakpoints by using 'disable' command, and then we can 'enable' breakpoints if we need. But when using dlv(delve), i'm not found command like 'disable' in gdb, I can only use 'clear' or 'clearall' command to delete breakpoints, but I need recreating breakpoints if I need using these breakpoints again.<br>\nMy questing is if there any command exist in dlv can 'disable' breakpoints and then I can re-enable them?<br>\nThanks.</p>\n"}, {"tags": ["api", "http", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1511684078, "creation_date": 1511684078, "answer_id": 47494191, "question_id": 47493820, "link": "https://stackoverflow.com/questions/47493820/how-do-i-serve-both-web-pages-and-api-routes-by-using-same-port-address-and-diff/47494191#47494191", "title": "How do I serve both web pages and API Routes by using same port address and different Handle pattern", "body": "<p>This is supported by the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\"><code>net/http</code></a> package out-of-the-box. Quoting from <a href=\"https://golang.org/pkg/net/http/#ServeMux\" rel=\"nofollow noreferrer\"><code>http.ServeMux</code></a>:</p>\n\n<blockquote>\n  <p>Patterns name fixed, rooted paths, like \"/favicon.ico\", or rooted subtrees, like \"/images/\" (note the trailing slash). <strong>Longer patterns take precedence over shorter ones</strong>, so that if there are handlers registered for both \"/images/\" and \"/images/thumbnails/\", the latter handler will be called for paths beginning \"/images/thumbnails/\" and the former will receive requests for any other paths in the \"/images/\" subtree.</p>\n</blockquote>\n\n<p>So simply you can register your file handler to path <code>/</code>, and register an API handler to e.g. <code>/api/</code> path. In this scenario any requests that start with <code>/api/</code> will be directed to the API handler, and any other requests will be directed to the file handler.</p>\n\n<p>Note that this of course means if there are files that are in the <code>/api/</code> folder (or more specifically whose request paths start with <code>/api/</code>), they won't be reachable for the above mentioned reason.</p>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "is_accepted": false, "score": 0, "last_activity_date": 1511704461, "creation_date": 1511704461, "answer_id": 47496887, "question_id": 47493820, "link": "https://stackoverflow.com/questions/47493820/how-do-i-serve-both-web-pages-and-api-routes-by-using-same-port-address-and-diff/47496887#47496887", "title": "How do I serve both web pages and API Routes by using same port address and different Handle pattern", "body": "<p>I did following changers to my code and now it's running as I expected.</p>\n\n<pre><code>func main() {\n\n    //Starting the API server\n    router := routes.UserRoutes()\n    http.Handle(\"/api/\", router)\n\n    //Starting the FileServer\n    fs := http.FileServer(http.Dir(\"server/webapps/play_maths\"))\n    http.Handle(\"/\", fs)\n\n    log.Println(\"Listening...\")\n    log.Fatal(http.ListenAndServe(\":3000\", nil))\n\n}\n</code></pre>\n\n<p>Then I change my routes as follows.</p>\n\n<pre><code>func UserRoutes() *mux.Router  {\n    var router = mux.NewRouter()\n    router = mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/api/user/create\", api.CreateUser)\n    router.HandleFunc(\"/api/user/get/all\", api.GetAllUsers)\n    return router\n} \n</code></pre>\n"}], "owner": {"reputation": 5283, "user_id": 6336221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Rh8CEJ_IGpA/AAAAAAAAAAI/AAAAAAAAALc/VV4nk6Yyqhg/photo.jpg?sz=128", "display_name": "Nisal Edu", "link": "https://stackoverflow.com/users/6336221/nisal-edu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 47494191, "answer_count": 2, "score": 2, "last_activity_date": 1511704461, "creation_date": 1511679956, "last_edit_date": 1511684096, "question_id": 47493820, "link": "https://stackoverflow.com/questions/47493820/how-do-i-serve-both-web-pages-and-api-routes-by-using-same-port-address-and-diff", "title": "How do I serve both web pages and API Routes by using same port address and different Handle pattern", "body": "<p>I have simple web application with CRUD operation, I want to serve web pages and API routes using same port address and different Handle pattern. As follows,</p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"server/webapps/play_maths\"))\nhttp.Handle(\"/\", fs) \n\nhttp.Handle(\"/api\", call API routes)\n</code></pre>\n\n<p>Following is my API routes </p>\n\n<pre><code>func UserRoutes() *mux.Router  {\n    var router = mux.NewRouter()\n    router = mux.NewRouter().StrictSlash(true)\n    router.HandleFunc(\"/user/create\", api.CreateUser)\n    router.HandleFunc(\"/user/get/all\", api.GetAllUsers)\n    return router\n}\n</code></pre>\n"}, {"tags": ["pdf", "go"], "answers": [{"comments": [{"owner": {"reputation": 1246, "user_id": 4516106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/37134b731235c61f94701c9e5d6882cf?s=128&d=identicon&r=PG", "display_name": "khue bui", "link": "https://stackoverflow.com/users/4516106/khue-bui"}, "edited": false, "score": 1, "creation_date": 1511844166, "post_id": 47520596, "comment_id": 82004391, "body": "Thank Patrick, I have run example above with some test files and imagick.v2. Somehow, some large files ( &gt; 15 pages ) was fail, but with two, three pages pdf file is ok. I dont know why??, but anyway thank you, it&#39;s enough for me."}], "tags": [], "owner": {"reputation": 104, "user_id": 9017102, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WyXDhSiG05w/AAAAAAAAAAI/AAAAAAAAAQE/kxZEtBqpzsk/photo.jpg?sz=128", "display_name": "Patrick Tou", "link": "https://stackoverflow.com/users/9017102/patrick-tou"}, "is_accepted": true, "score": 8, "last_activity_date": 1511820975, "last_edit_date": 1511820975, "creation_date": 1511820201, "answer_id": 47520596, "question_id": 47492837, "link": "https://stackoverflow.com/questions/47492837/golang-convert-pdf-to-image-by-bimg/47520596#47520596", "title": "Golang convert pdf to image by bimg", "body": "<p>bimg uses libvips, and can <a href=\"https://github.com/h2non/bimg/blob/master/vips.h#L365\" rel=\"noreferrer\">potentially load PDFs</a>.\nUnfortunately, the <a href=\"http://jcupitt.github.io/libvips/API/current/VipsForeignSave.html#vips-pdfload\" rel=\"noreferrer\">default for libvips loading PDFs</a> is to load one page only.\nUnless you want to modify bimg (<a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"noreferrer\">vendor</a>, <a href=\"https://github.com/h2non/bimg\" rel=\"noreferrer\">contribute</a>, hack the source, etc.) you're out of luck.</p>\n\n<p>Not an answer to the question (not using bimg), but you can use imagemagick instead, </p>\n\n<pre><code>import \"gopkg.in/gographics/imagick.v3/imagick\"\nfunc main() {\n    imagick.Initialize()\n    defer imagick.Terminate()\n    mw := imagick.NewMagickWand()\n    defer mw.Destroy()\n    mw.ReadImage(\"test.pdf\")\n    mw.SetIteratorIndex(0)        // This being the page offset\n    mw.SetImageFormat(\"jpg\")\n    mw.WriteImage(\"test.jpg\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1246, "user_id": 4516106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/37134b731235c61f94701c9e5d6882cf?s=128&d=identicon&r=PG", "display_name": "khue bui", "link": "https://stackoverflow.com/users/4516106/khue-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8286, "favorite_count": 3, "accepted_answer_id": 47520596, "answer_count": 1, "score": 3, "last_activity_date": 1523427036, "creation_date": 1511668035, "last_edit_date": 1511682240, "question_id": 47492837, "link": "https://stackoverflow.com/questions/47492837/golang-convert-pdf-to-image-by-bimg", "title": "Golang convert pdf to image by bimg", "body": "<p>The example code below convert pdf to jpeg by using <a href=\"https://github.com/h2non/bimg#convert\" rel=\"nofollow noreferrer\">bimg</a>.</p>\n\n<pre><code>func main() {\n\n    buffer, err := bimg.Read(\"test.pdf\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n    }\n\n    newImage, err := bimg.NewImage(buffer).Convert(bimg.JPEG)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n    }\n\n    if bimg.NewImage(newImage).Type() == \"jpeg\" {\n        fmt.Fprintln(os.Stderr, \"The image was converted into jpeg\")\n    }\n\n    bimg.Write(\"test.jpg\", newImage)\n\n}\n</code></pre>\n\n<p>But it only convert 1st page of <code>test.pdf</code>.</p>\n\n<p>Is there any way that convert to image that contain more than one page.</p>\n"}, {"tags": ["linux", "bash", "go", "ssh", "terminal"], "comments": [{"owner": {"reputation": 4150, "user_id": 7412986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xOv4e.png?s=128&g=1", "display_name": "AlexP", "link": "https://stackoverflow.com/users/7412986/alexp"}, "edited": false, "score": 1, "creation_date": 1511670976, "post_id": 47492811, "comment_id": 81941309, "body": "I&#39;m pretty sure that Unicode code point 13 is Carriage Return; Delete is 127 and Backspace is 8. And from the description I&#39;m pretty sure that you are mixing up terminal emulation and SSH; an SSH server (or an SSH client, for that matter) does not and should not do terminal emulation -- that&#39;s the job of a terminal emulator."}, {"owner": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1511671906, "post_id": 47492811, "comment_id": 81941441, "body": "This Q is not about programming as defined for StackOverflow. It <b>may</b> be more appropriate on  <a href=\"http://superuser.com\">superuser.com</a> or another StackExchange site. Use the <code>flag</code> link at the bottom of your Q and ask the moderator to move it. Please don&#39;t post the same Q on 2 different sites. <b><i>Please</i></b> read  <a href=\"https://stackoverflow.com/help/on-topic\">stackoverflow.com/help/on-topic</a> , <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> , <a href=\"https://stackoverflow.com/help/dont-ask\">stackoverflow.com/help/dont-ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a> before posting more Qs here. GoodLuck"}, {"owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "reply_to_user": {"reputation": 33642, "user_id": 620097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/820980fd43f2607a815c1f3dbfe152cc?s=128&d=identicon&r=PG", "display_name": "shellter", "link": "https://stackoverflow.com/users/620097/shellter"}, "edited": false, "score": 0, "creation_date": 1511686183, "post_id": 47492811, "comment_id": 81943865, "body": "@shellter Yes it is about programming!  This is a question about the behaviour of ssh clients from the programmer&#39;s perspective, for the purpose of writing a program.  Please READ THE QUESTION before voting to close!"}], "answers": [{"tags": [], "owner": {"reputation": 10896, "user_id": 453851, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f72d9b8fe02cc534906f89eb22d74cb0?s=128&d=identicon&r=PG", "display_name": "Philip Couling", "link": "https://stackoverflow.com/users/453851/philip-couling"}, "is_accepted": false, "score": 1, "last_activity_date": 1511687757, "creation_date": 1511687757, "answer_id": 47494628, "question_id": 47492811, "link": "https://stackoverflow.com/questions/47492811/delete-characters-from-openssh-client/47494628#47494628", "title": "Delete characters from OpenSSH client", "body": "<p>The answer is send a space <code>\" \"</code>.  </p>\n\n<p>But I suspect you are going about this in the wrong way.  SSH is just a way to let a user access a terminal.  It is not a command line processor.  That's the job of Bash or whatever other command line the user has selected.  Bash should be able to handle this type of logic as it's designed to talk to a terminal.  Re-implementing bash in go-lang is a huge task and if that's what you want to do then good luck!</p>\n\n<p>To avoid these problems (and make lot less work for yourself) you should be using a <a href=\"http://man7.org/linux/man-pages/man7/pty.7.html\" rel=\"nofollow noreferrer\">Pseudo Terminal</a> to talk to bash not a pipe.  If you do so then I believe bash should correctly handle backspaces for you.</p>\n\n<p>You may also want to look at \"<a href=\"http://rachid.koucha.free.fr/tech_corner/pty_pdip.html\" rel=\"nofollow noreferrer\">Using Pseudo Terminals to Control Interactive Programs</a>\"</p>\n"}], "owner": {"reputation": 41, "user_id": 6210314, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sV-IrktKfMs/AAAAAAAAAAI/AAAAAAAAARo/549Wga-y-xE/photo.jpg?sz=128", "display_name": "katkinson", "link": "https://stackoverflow.com/users/6210314/katkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1511687978, "creation_date": 1511667779, "last_edit_date": 1511687978, "question_id": 47492811, "link": "https://stackoverflow.com/questions/47492811/delete-characters-from-openssh-client", "title": "Delete characters from OpenSSH client", "body": "<p>I'm writing an SSH server in Golang. Currently I have a server which can read and write from/to the client. When the client presses the delete key the server receives unicode character 13 (delete). I can rewrite the current line by sending all but the deleted character to the client. However, it only rewrites as many characters as I send. This means the last characters don't get re-written until new characters are entered. Does anyone know what the server needs to send in order for characters to be deleted from the client.</p>\n\n<h2>Client</h2>\n\n<p>Operating system: Ubuntu 16.04</p>\n\n<p>Ssh version: 1.2.12</p>\n\n<p>Bash version: 4.3</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1511655119, "post_id": 47491772, "comment_id": 81938791, "body": "Well, you got me there ;). I&#39;ll fix the answer."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1511655485, "post_id": 47491772, "comment_id": 81938851, "body": "@zerkms Thanks for pointing it out and allowing me to correct myself."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 3, "last_activity_date": 1511655420, "last_edit_date": 1511655420, "creation_date": 1511654963, "answer_id": 47491772, "question_id": 47491469, "link": "https://stackoverflow.com/questions/47491469/pass-string-with-json-data-to-map-in-golang/47491772#47491772", "title": "Pass String with Json data to Map in Golang", "body": "<p>If you're dealing with a json object of arbitrary structure you can use a map of interfaces as the type to unmarshal it into.</p>\n\n<pre><code>map[string]interface{}\n</code></pre>\n\n<p>The <code>encoding/json</code> package will nicely unmarshal the json object into it, nested or not.</p>\n\n<p>This, while very flexible, has an obvious downside, the types of the map's values are unknown and so to do anything useful with them you'll have to use a type assertion or type switch.</p>\n\n<pre><code>v, ok := m[\"key\"].(Type)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/wM0gkU1g5G\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wM0gkU1g5G</a></p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1511690141, "answer_count": 1, "score": -1, "last_activity_date": 1511655420, "creation_date": 1511652080, "question_id": 47491469, "link": "https://stackoverflow.com/questions/47491469/pass-string-with-json-data-to-map-in-golang", "closed_reason": "Duplicate", "title": "Pass String with Json data to Map in Golang", "body": "<p>Currently I have stored in my database json objects as string. I want to pass them to a map to be able to consult any field as:</p>\n\n<pre><code>Mymap[\"Name\"]\nMymap[\"Age\"]\n..\n</code></pre>\n\n<p>Let's say that my string would be something like:</p>\n\n<pre><code>'{\"Name\":[\"zero\"],\"Age\":\"10\"}'\n</code></pre>\n\n<p>I don't know the structure of the data, so that Json can have many fields as required and also many levels of nestings (but I am worried more about to get at least the first level)</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1511651740, "last_edit_date": 1511651740, "creation_date": 1511650699, "answer_id": 47491336, "question_id": 47491296, "link": "https://stackoverflow.com/questions/47491296/how-to-remove-slice-element-using-append/47491336#47491336", "title": "How to remove slice element using append?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">Passing arguments to ... parameters</a></p>\n  \n  <p>If the final argument is assignable to a slice type <code>[]T</code>, it may be\n  passed unchanged as the value for a <code>...T</code> parameter if the argument\n  is followed by <code>...</code>.</p>\n</blockquote>\n\n<hr>\n\n<p><code>append</code> is a variadic function. You need to add <code>...</code> to append a slice.</p>\n\n<pre><code>allUser = append(allUser[:ii], allUser[ii+1:]...)\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5902381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-ryQHRPr1cTA/AAAAAAAAAAI/AAAAAAAAAH0/ocl8QbWfa3k/photo.jpg?sz=128", "display_name": "Umutcan Ert&#252;rk", "link": "https://stackoverflow.com/users/5902381/umutcan-ert%c3%bcrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 47491336, "answer_count": 1, "score": 0, "last_activity_date": 1511651740, "creation_date": 1511650373, "last_edit_date": 1511651454, "question_id": 47491296, "link": "https://stackoverflow.com/questions/47491296/how-to-remove-slice-element-using-append", "title": "How to remove slice element using append?", "body": "<p>I want to remove some struct element from pointer array</p>\n\n<p>Here is my struct</p>\n\n<pre><code>type User struct{\n    userName string\n    userId   int\n}\n</code></pre>\n\n<p>And I m trying to remove item like that.</p>\n\n<pre><code>allUser []*User\n------------\n------------\n------------\nfunc RemoveUser(deletedUser *User) {\n    for ii := 0; ii &lt; len(allUser); ii++ {\n        if allUser[ii] == deletedUser {\n            allUser = append(allUser[:ii], allUser[ii+1:])\n        }\n    }\n}\n</code></pre>\n\n<p>but I'm getting this error.\n<strong>cannot use allUser[ii+1:] (type []*User as type *User in append</strong>\nWhat's my fault</p>\n"}, {"tags": ["string", "go"], "answers": [{"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 5, "last_activity_date": 1613165935, "last_edit_date": 1613165935, "creation_date": 1511638741, "answer_id": 47489825, "question_id": 47489745, "link": "https://stackoverflow.com/questions/47489745/splitting-a-string-at-space-except-inside-quotation-marks/47489825#47489825", "title": "Splitting a string at Space, except inside quotation marks", "body": "<ol>\n<li>Using <code>strings.FieldsFunc</code> try <a href=\"https://play.golang.org/p/-z3GWlF-NDJ\" rel=\"nofollow noreferrer\">this</a>:</li>\n</ol>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    s := `Foo bar random &quot;letters lol&quot; stuff`\n    quoted := false\n    a := strings.FieldsFunc(s, func(r rune) bool {\n        if r == '&quot;' {\n            quoted = !quoted\n        }\n        return !quoted &amp;&amp; r == ' '\n    })\n\n    out := strings.Join(a, &quot;, &quot;)\n    fmt.Println(out) // Foo, bar, random, &quot;letters lol&quot;, stuff\n}\n</code></pre>\n<hr />\n<ol start=\"2\">\n<li>Using simple <code>strings.Builder</code> and <code>range</code> over string and keeping or not keeping <code>&quot;</code> at your will, try <a href=\"https://play.golang.org/p/_Ozs21zvqny\" rel=\"nofollow noreferrer\">this</a></li>\n</ol>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    s := `Foo bar random &quot;letters lol&quot; stuff`\n    a := []string{}\n    sb := &amp;strings.Builder{}\n    quoted := false\n    for _, r := range s {\n        if r == '&quot;' {\n            quoted = !quoted\n            sb.WriteRune(r) // keep '&quot;' otherwise comment this line\n        } else if !quoted &amp;&amp; r == ' ' {\n            a = append(a, sb.String())\n            sb.Reset()\n        } else {\n            sb.WriteRune(r)\n        }\n    }\n    if sb.Len() &gt; 0 {\n        a = append(a, sb.String())\n    }\n\n    out := strings.Join(a, &quot;, &quot;)\n    fmt.Println(out) // Foo, bar, random, &quot;letters lol&quot;, stuff\n    // not keep '&quot;': // Foo, bar, random, letters lol, stuff\n}\n\n</code></pre>\n<hr />\n<ol start=\"3\">\n<li>Using <code>scanner.Scanner</code>, try <a href=\"https://play.golang.org/p/Pct3mj2VanX\" rel=\"nofollow noreferrer\">this</a>:</li>\n</ol>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strings&quot;\n    &quot;text/scanner&quot;\n)\n\nfunc main() {\n    var s scanner.Scanner\n    s.Init(strings.NewReader(`Foo bar random &quot;letters lol&quot; stuff`))\n    slice := make([]string, 0, 5)\n    tok := s.Scan()\n    for tok != scanner.EOF {\n        slice = append(slice, s.TokenText())\n        tok = s.Scan()\n    }\n    out := strings.Join(slice, &quot;, &quot;)\n    fmt.Println(out) // Foo, bar, random, &quot;letters lol&quot;, stuff\n}\n</code></pre>\n<hr />\n<ol start=\"4\">\n<li>Using <code>csv.NewReader</code> which <strong>removes</strong> <code>&quot;</code> itself, try <a href=\"https://play.golang.org/p/Ydk14neoIgh\" rel=\"nofollow noreferrer\">this</a>:</li>\n</ol>\n<pre><code>package main\n\nimport (\n    &quot;encoding/csv&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    s := `Foo bar random &quot;letters lol&quot; stuff`\n    r := csv.NewReader(strings.NewReader(s))\n    r.Comma = ' '\n    record, err := r.Read()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    out := strings.Join(record, &quot;, &quot;)\n    fmt.Println(out) // Foo, bar, random, letters lol, stuff\n}\n</code></pre>\n<hr />\n<ol start=\"5\">\n<li>Using <code>regexp</code>, try <a href=\"https://play.golang.org/p/UQyrvbDc9Eg\" rel=\"nofollow noreferrer\">this</a>:</li>\n</ol>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;regexp&quot;\n    &quot;strings&quot;\n)\n\nfunc main() {\n    s := `Foo bar random &quot;letters lol&quot; stuff`\n\n    r := regexp.MustCompile(`[^\\s&quot;]+|&quot;([^&quot;]*)&quot;`)\n    a := r.FindAllString(s, -1)\n\n    out := strings.Join(a, &quot;, &quot;)\n    fmt.Println(out) // Foo, bar, random, &quot;letters lol&quot;, stuff\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 6560446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKTVg.png?s=128&g=1", "display_name": "MOBlox", "link": "https://stackoverflow.com/users/6560446/moblox"}, "edited": false, "score": 0, "creation_date": 1511769433, "post_id": 47489846, "comment_id": 81967994, "body": "That isn&#39;t the output I really wanted. I wanted, for example, the <code>letters lol</code> to be in quotation marks and the other not. Also, I didn&#39;t do a very good job with the question... I was going to use it to split <code>blockdata 8539 58 584 {CustomName:&quot;Foo&quot;}</code> into <code>blockdata</code>, <code>8539</code>, <code>58</code>, <code>584</code>, `{CustomName:&quot;Foo&quot;}... Should have mentioned that."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 15, "last_activity_date": 1511642258, "last_edit_date": 1511642258, "creation_date": 1511638949, "answer_id": 47489846, "question_id": 47489745, "link": "https://stackoverflow.com/questions/47489745/splitting-a-string-at-space-except-inside-quotation-marks/47489846#47489846", "title": "Splitting a string at Space, except inside quotation marks", "body": "<p>Think about it. You have a string in comma separated values (CSV) file format, <a href=\"https://tools.ietf.org/rfc/rfc4180.txt\" rel=\"noreferrer\">RFC4180</a>, except that your separator, outside quote pairs, is a space (instead of a comma). For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    s := `Foo bar random \"letters lol\" stuff`\n    fmt.Printf(\"String:\\n%q\\n\", s)\n\n    // Split string\n    r := csv.NewReader(strings.NewReader(s))\n    r.Comma = ' ' // space\n    fields, err := r.Read()\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    fmt.Printf(\"\\nFields:\\n\")\n    for _, field := range fields {\n        fmt.Printf(\"%q\\n\", field)\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Ed4IV97L7H\" rel=\"noreferrer\">https://play.golang.org/p/Ed4IV97L7H</a></p>\n\n<p>Output:</p>\n\n<pre><code>String:\n\"Foo bar random \\\"letters lol\\\" stuff\"\n\nFields:\n\"Foo\"\n\"bar\"\n\"random\"\n\"letters lol\"\n\"stuff\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1575346626, "post_id": 47490643, "comment_id": 104525552, "body": "Seems like you only need: <code>[^\\s&quot;]+|&quot;([^&quot;]*)&quot;</code>.  I guess the intent was to handle single quotes also, but that isn&#39;t in the test (and doesn&#39;t work due to missing <code>&#39;</code> at the end)."}], "tags": [], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "is_accepted": false, "score": 2, "last_activity_date": 1511677634, "last_edit_date": 1511677634, "creation_date": 1511645013, "answer_id": 47490643, "question_id": 47489745, "link": "https://stackoverflow.com/questions/47489745/splitting-a-string-at-space-except-inside-quotation-marks/47490643#47490643", "title": "Splitting a string at Space, except inside quotation marks", "body": "<p>You could use <a href=\"https://en.wikipedia.org/wiki/Regular_expression\" rel=\"nofollow noreferrer\">regex</a> </p>\n\n<p>This (<a href=\"https://play.golang.org/p/GgiBeIAAvD\" rel=\"nofollow noreferrer\">go playground</a>) will cover all use cases for multiple words inside quotes and multiple quoted entries in your array:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    s := `Foo bar random \"letters lol\" stuff \"also will\" work on \"multiple quoted stuff\"`       \n    r := regexp.MustCompile(`[^\\s\"']+|\"([^\"]*)\"|'([^']*)`) \n    arr := r.FindAllString(s, -1)       \n    fmt.Println(\"your array: \", arr)    \n}\n</code></pre>\n\n<p>Output will be:</p>\n\n<pre><code>[Foo, bar, random, \"letters lol\", stuff, \"also will\", work, on, \"multiple quoted stuff\"]\n</code></pre>\n\n<p>If you want to learn more about regex here is a great SO answer with super handy resources at the end - <a href=\"https://stackoverflow.com/a/2759417/5674583\">Learning Regular Expressions</a></p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 141, "user_id": 6560446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kKTVg.png?s=128&g=1", "display_name": "MOBlox", "link": "https://stackoverflow.com/users/6560446/moblox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3972, "favorite_count": 3, "answer_count": 3, "score": 12, "last_activity_date": 1613165935, "creation_date": 1511638009, "last_edit_date": 1612786635, "question_id": 47489745, "link": "https://stackoverflow.com/questions/47489745/splitting-a-string-at-space-except-inside-quotation-marks", "title": "Splitting a string at Space, except inside quotation marks", "body": "<p>I was wondering if there is any way I could easily split a string at spaces, except when the space is inside quotation marks?</p>\n<p>For example, changing</p>\n<p><code>Foo bar random &quot;letters lol&quot; stuff</code></p>\n<p>into</p>\n<p><code>Foo</code>, <code>bar</code>, <code>random</code>, <code>&quot;letters lol&quot;</code>, <code>stuff</code></p>\n"}, {"tags": ["go", "reflection", "types", "interface", "casting"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1511634500, "creation_date": 1511634500, "answer_id": 47489260, "question_id": 47489126, "link": "https://stackoverflow.com/questions/47489126/converting-interface-into-another-and-copy-content/47489260#47489260", "title": "Converting interface into another and copy content", "body": "<p>One option is to use the reflect package:</p>\n\n<p>The basic idea is to create reflect.Values for input and output, check if input is assignable to output and then assign. </p>\n\n<pre><code>func ValidateParam(conf map[string]interface{}, paramName string, out interface{}) error {\n    param, ok := conf[paramName]\n\n    if !ok {\n        return errors.New(\"some error\")\n    }\n\n    // Output is pointer to value.\n    vo := reflect.ValueOf(out)\n    if vo.Kind() != reflect.Ptr {\n        return errors.New(\"out must be poitner\")\n    }\n    vo = vo.Elem()  // deref ptr\n\n    // Can input be assigned to output?\n    vi := reflect.ValueOf(param)\n    if !vi.Type().AssignableTo(vo.Type()) {\n        return fmt.Errorf(\"param %s of type %v is not assignable to %v\", paramName, vi.Type(), vo.Type())\n    }\n\n    vo.Set(vi)\n    return nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/_gMvoOhHbb\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}], "owner": {"reputation": 421, "user_id": 2336131, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/aTeec.jpg?s=128&g=1", "display_name": "Aziule", "link": "https://stackoverflow.com/users/2336131/aziule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 47489260, "answer_count": 1, "score": 0, "last_activity_date": 1511636239, "creation_date": 1511633643, "question_id": 47489126, "link": "https://stackoverflow.com/questions/47489126/converting-interface-into-another-and-copy-content", "title": "Converting interface into another and copy content", "body": "<p>I've got the following method:</p>\n\n<pre><code>func ValidateParam(conf map[string]interface{}, paramName string, out interface{}) error {\n    param, ok := conf[paramName]\n\n    if !ok {\n        return errors.New(\"some error\")\n    }\n\n    // ...\n}\n</code></pre>\n\n<p>I would like to be able to call it like so:</p>\n\n<pre><code>myVar := \"some text\"\nerr := ValidateParam(conf, \"my_var_param\", &amp;myVar)\n\nmyOtherVar := &amp;MyStruct{}\nerr := ValidateParam(conf, \"my_struct_param\", myOtherVar)\n</code></pre>\n\n<p>The idea is:</p>\n\n<ul>\n<li>Get the param using the <code>conf</code> map</li>\n<li>Check that this param could be converted into the same type as <code>out</code></li>\n<li>Hydrate <code>out</code> using the param</li>\n</ul>\n\n<p>=> It is kind of the same process as for <code>json.Unmarshal(data, &amp;myVar)</code> or when doing a query with mgo <code>query.Collection(\"col\").One(&amp;myVar)</code></p>\n\n<p>I can't find how to achieve this, any help would be more than welcome.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["email", "go", "io", "gmail", "imap"], "answers": [{"comments": [{"owner": {"reputation": 381, "user_id": 8573838, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-id8ZMMo9mIA/AAAAAAAAAAI/AAAAAAAAADM/VJic0_NAcpo/photo.jpg?sz=128", "display_name": "James Morgan", "link": "https://stackoverflow.com/users/8573838/james-morgan"}, "edited": false, "score": 0, "creation_date": 1511628827, "post_id": 47487852, "comment_id": 81931673, "body": "alright, wonderful. Thank you. I&#39;ll see what I can do about it"}], "tags": [], "owner": {"reputation": 6958, "user_id": 857727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3772f7ef99bd17c1e77d77edbf76c13d?s=128&d=identicon&r=PG&f=1", "display_name": "arnt", "link": "https://stackoverflow.com/users/857727/arnt"}, "is_accepted": true, "score": 0, "last_activity_date": 1511626165, "last_edit_date": 1511626165, "creation_date": 1511625526, "answer_id": 47487852, "question_id": 47486934, "link": "https://stackoverflow.com/questions/47486934/gmail-imap-charset-error-within-body/47487852#47487852", "title": "Gmail imap - charset error within body", "body": "<p>That message seems to be from <a href=\"https://github.com/emersion/go-imap/blob/939ec3994dbebac66a7c44eb4e17c5878ce1341d/message.go#L101\" rel=\"nofollow noreferrer\">message.go</a>, and probably says that go-imap only supports ASCII when it's the default, not when it's explicitly specified. In other words, <code>Content-Type: text/plain</code> should work, <code>Content-Type: text/plain; charset=ascii</code> not. The easiest way forward is probably to fix <a href=\"https://github.com/emersion/go-imap\" rel=\"nofollow noreferrer\">go-imap</a> and submit a pull request.</p>\n\n<p>FYI, many old charsets have more than one name. You don't need to add support for all the legacy charsets, but for those that <em>are</em> supported, go-imap really should know all the names. The <a href=\"http://www.iana.org/assignments/character-sets\" rel=\"nofollow noreferrer\">names are kept by IANA</a> and <a href=\"https://github.com/aox/aox/blob/master/encodings/charset.pl\" rel=\"nofollow noreferrer\">this script</a> is the kind of thing you might want to use to parse the IANA list and generate an array of aliases.</p>\n"}], "owner": {"reputation": 381, "user_id": 8573838, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-id8ZMMo9mIA/AAAAAAAAAAI/AAAAAAAAADM/VJic0_NAcpo/photo.jpg?sz=128", "display_name": "James Morgan", "link": "https://stackoverflow.com/users/8573838/james-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 47487852, "answer_count": 1, "score": 0, "last_activity_date": 1511626165, "creation_date": 1511619250, "last_edit_date": 1511620210, "question_id": 47486934, "link": "https://stackoverflow.com/questions/47486934/gmail-imap-charset-error-within-body", "title": "Gmail imap - charset error within body", "body": "<p>currently trying to use package <code>\"github.com/emersion/go-imap\"</code> in order to parse some emails however I've discovered when trying to parse emails from a specific company - they send an automated email on signup, I get returned the error \"<code>unhandled charset \"ascii</code>\" when attempting the following code:</p>\n\n<pre><code>mr, err := mail.CreateReader(r)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>the value <code>r</code> is assigned with the code:</p>\n\n<pre><code>msg := &lt;-messages\n    r := msg.GetBody(\"BODY[]\")\n\n    if r == nil {\n        log.Fatal(\"Server didn't returned message body\")\n    }\n</code></pre>\n\n<p>which attempts to get the body of the message in my inbox. I'm not sure what's causing this error to be thrown considering every other email I've tested it on works - it's just this specific email that gets sent that causes my code to fail. I've tried having it resend and tried new email addresses. Not sure what I can do</p>\n"}, {"tags": ["go", "go-echo"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1511626530, "creation_date": 1511626530, "answer_id": 47488038, "question_id": 47486812, "link": "https://stackoverflow.com/questions/47486812/golang-img-from-base64-zgotmplz/47488038#47488038", "title": "Golang img from base64 ZgotmplZ", "body": "<p>The template functions must be defined before the template is parsed.  To fix the error, create an empty template, set the functions and then parse the glob:</p>\n\n<pre><code>templates: template.Must(template.New(\"\").Funcs(funcMap).ParseGlob(\"C:/Projects/Golang/hello/resources/*.html\")),\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5108376, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/579f3bda5cedc16d70083d2277c8e2cd?s=128&d=identicon&r=PG&f=1", "display_name": "dekros", "link": "https://stackoverflow.com/users/5108376/dekros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 607, "favorite_count": 0, "accepted_answer_id": 47488038, "answer_count": 1, "score": 2, "last_activity_date": 1521027150, "creation_date": 1511618531, "last_edit_date": 1521027150, "question_id": 47486812, "link": "https://stackoverflow.com/questions/47486812/golang-img-from-base64-zgotmplz", "title": "Golang img from base64 ZgotmplZ", "body": "<p>So i try to put image in  from base64 but i'm gettin ZgotmplZ i try to \nuse template.URL(s) like this:</p>\n\n<pre><code>e := echo.New()\nfuncMap := template.FuncMap{\n    \"safe\": func(s string) template.URL {\n        return template.URL(s)\n    },\n}\nt := &amp;Template{\n    templates: template.Must(template.ParseGlob(\"C:/Projects/Golang/hello/resources/*.html\")).Funcs(funcMap),\n}\ne.Renderer = t\ne.GET(\"/\", func(context echo.Context) error {\n    return context.Render(http.StatusOK, \"index.html\", GetData())\n})\n</code></pre>\n\n<p>and in template:</p>\n\n<pre><code> &lt;td rowspan=\"2\"&gt;&lt;img src=\"{{.Icon|safe}}\"&gt;&lt;/td&gt;\n</code></pre>\n\n<p>But while i exeute: go run\npanic: template: index.html:34: function \"safe\" not defined\nso what i do wrong?</p>\n"}, {"tags": ["docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 8411216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/076324715c8779834391def594ffb0a0?s=128&d=identicon&r=PG", "display_name": "ngurajeka", "link": "https://stackoverflow.com/users/8411216/ngurajeka"}, "is_accepted": false, "score": 0, "last_activity_date": 1511619626, "creation_date": 1511619626, "answer_id": 47486987, "question_id": 47486811, "link": "https://stackoverflow.com/questions/47486811/go-build-fails-when-building-docker-image/47486987#47486987", "title": "Go build fails when building docker image", "body": "<p>It may have failed because you used gin, and the library cannot be found inside the container. Try to use glide or godep to vendoring third party library. </p>\n"}, {"comments": [{"owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "edited": false, "score": 0, "creation_date": 1511620158, "post_id": 47487041, "comment_id": 81928928, "body": "Thx that worked. How can one set this up more efficiently in the go world? Its not really practical to add every package manually to docker. Any good ideas articles/tutorials I could read?"}, {"owner": {"reputation": 1362, "user_id": 18703, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/45b0ee94acfbcc06f333f2daf03d4c91?s=128&d=identicon&r=PG", "display_name": "Hace", "link": "https://stackoverflow.com/users/18703/hace"}, "edited": false, "score": 2, "creation_date": 1511624537, "post_id": 47487041, "comment_id": 81930238, "body": "One way is to vendor the gin-gonic package. Basicly means to copy the package over to your folder as a dependency. Please do look at dep and glide which should be the succesors of govendoring."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1511624573, "post_id": 47487041, "comment_id": 81930247, "body": "Incidentally, you can just run a naked <code>go get</code> to pull all dependencies.  That said, you (OP) may want to look into vendoring (<a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder\" rel=\"nofollow noreferrer\">blog.gopheracademy.com/advent-2015/vendor-folder</a>).  It solves both this issue and problems that arise from differing dependency versions. (Edit: damn, beat me to it, Hace)"}], "tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 2, "last_activity_date": 1511620187, "last_edit_date": 1511620187, "creation_date": 1511619960, "answer_id": 47487041, "question_id": 47486811, "link": "https://stackoverflow.com/questions/47486811/go-build-fails-when-building-docker-image/47487041#47487041", "title": "Go build fails when building docker image", "body": "<p>The program succeeds on your machine because you probably have the gin package installed. You can't assume a container will have it, and should install it explicitly.  Just add the following line to your dockerfile before the <code>go build</code> line:</p>\n\n<pre><code>RUN go get github.com/gin-gonic/gin\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 331, "user_id": 1475214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31cf4ea9378db965a6845a801995fb6a?s=128&d=identicon&r=PG", "display_name": "Huang Minghe", "link": "https://stackoverflow.com/users/1475214/huang-minghe"}, "is_accepted": false, "score": 0, "last_activity_date": 1511620006, "creation_date": 1511620006, "answer_id": 47487051, "question_id": 47486811, "link": "https://stackoverflow.com/questions/47486811/go-build-fails-when-building-docker-image/47487051#47487051", "title": "Go build fails when building docker image", "body": "<pre><code>go get github.com/gin-gonic/gin\n</code></pre>\n\n<p>Then it should work.</p>\n"}], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 47487041, "answer_count": 3, "score": 4, "last_activity_date": 1542197509, "creation_date": 1511618511, "last_edit_date": 1542196669, "question_id": 47486811, "link": "https://stackoverflow.com/questions/47486811/go-build-fails-when-building-docker-image", "title": "Go build fails when building docker image", "body": "<p>I'm a little new to golang and I'm still trying to get my head around the difference between <code>go run main.go</code> and <code>go build [-o] main.go</code>. </p>\n\n<p>I've build a little gin app to try out locally with docker and kubernetes. </p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n\n    r := gin.Default()\n\n    r.GET(\"/healthz\", func(c *gin.Context) {\n        c.String(http.StatusOK, \"\")\n    })\n\n    r.GET(\"/readinez\", func(c *gin.Context) {\n        c.String(http.StatusOK, \"\")\n    })\n\n    r.Run() // listen and serve on 0.0.0.0:8080\n} \n</code></pre>\n\n<p>The app runs perfectly fine with <code>go run main.go</code>. </p>\n\n<p>My Dockerfile:</p>\n\n<pre><code>FROM golang:latest\nRUN mkdir /app\nADD . /app/\nWORKDIR /app\nRUN go build -o main .\nCMD [\"/app/main\"]\n</code></pre>\n\n<p>It fails:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PTpjE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PTpjE.png\" alt=\"enter image description here\"></a></p>\n\n<p>It is definitely in there and it also works when I <code>go run main.go</code>. What is the difference to build?</p>\n\n<p>I'm not sure what to do here. Coming from a node background. This does drive a noobie somewhat mad... Sure there is an easy solution. </p>\n"}, {"tags": ["go", "parameter-passing", "pass-by-reference", "pass-by-value", "pass-by-pointer"], "comments": [{"owner": {"reputation": 43, "user_id": 960296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476071852261ae27a9f031ad39d88b4?s=128&d=identicon&r=PG", "display_name": "SammyO", "link": "https://stackoverflow.com/users/960296/sammyo"}, "edited": false, "score": 0, "creation_date": 1511620429, "post_id": 47486606, "comment_id": 81929029, "body": "OK, thanks for the help!  With the information provided, I am getting the effect I want by passing a reference to the type <code>manglePC(&amp;c)</code> and changing the function to: <code>func manglePC(row *cT) { \t(*row)[2] = 0 }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1511620059, "last_edit_date": 1511620059, "creation_date": 1511617932, "answer_id": 47486724, "question_id": 47486606, "link": "https://stackoverflow.com/questions/47486606/please-explain-if-golang-types-pass-by-value/47486724#47486724", "title": "Please explain if golang types pass by value", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">Array types</a></p>\n  \n  <p>An array is a numbered sequence of elements of a single type, called\n  the element type. </p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">Slice types</a></p>\n  \n  <p>A slice is a descriptor for a contiguous segment of an underlying\n  array and provides access to a numbered sequence of elements from that\n  array.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls</a></p>\n  \n  <p>In a function call, the function value and arguments are evaluated in\n  the usual order. After they are evaluated, the parameters of the call\n  are passed by value to the function and the called function begins\n  execution. The return parameters of the function are passed by value\n  back to the calling function when the function returns.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n<pre><code>type cT [3]int\n\nb := []int{1, 2, 3}\nc := cT{1, 2, 3}\n</code></pre>\n  \n  <p>I have two variables, <code>b</code> and <code>c</code>, both are arrays of 3 integers</p>\n</blockquote>\n\n<hr>\n\n<p>No, you don't!</p>\n\n<p><code>b</code> is a <strong>slice</strong> of <code>int</code> with length (<code>len(b)</code>) 3 and capacity (<code>cap(b)</code>) 3, <code>c</code> is an <strong>array</strong> of (<code>len(c)</code>) 3 <code>int</code>.</p>\n\n<p>In Go, all parameters are passed by value. <code>b</code> is passed as a slice descriptor, <code>c</code> is passed as an array. A slice descriptor is a <code>struct</code> with a slice length and capacity, and a pointer to the underlying array.</p>\n"}, {"tags": [], "owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "is_accepted": false, "score": 0, "last_activity_date": 1511620048, "creation_date": 1511620048, "answer_id": 47487058, "question_id": 47486606, "link": "https://stackoverflow.com/questions/47486606/please-explain-if-golang-types-pass-by-value/47487058#47487058", "title": "Please explain if golang types pass by value", "body": "<p>See comments:</p>\n\n \n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    b := []int{1, 2, 3} // slice\n    c := cT{1, 2, 3} // array\n\n    fmt.Println(\"before b:\", b) \n    fmt.Println(\"before c:\", c) \n\n    b[0] = -1\n    c[0] = -1\n\n    // passing in a slice which you can think of as ref to array\n    // pass by value, and it is copy of ref to array \n    mangleB(b) // ignore return value\n\n    // passing in copy of array (pass by value)\n    // yes full shallow copy of array \n    mangleC(c) // ignore return value\n    // if you ignore return modifications are lost\n\n    fmt.Println(\"*after b:\", b)\n    fmt.Println(\"*after c:\", c)\n\n    // return value is modified array\n    c = mangleC(c)\n    // c now copy of array from line 24\n\n    fmt.Println(\"*what? c:\", c)\n}\n</code></pre>\n\n<ul>\n<li>when I'm calling slice a ref I'm simplifying details here <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></li>\n</ul>\n\n<p><a href=\"https://play.golang.org/p/OAaCMhc-Ug\" rel=\"nofollow noreferrer\">https://play.golang.org/p/OAaCMhc-Ug</a></p>\n"}], "owner": {"reputation": 43, "user_id": 960296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a476071852261ae27a9f031ad39d88b4?s=128&d=identicon&r=PG", "display_name": "SammyO", "link": "https://stackoverflow.com/users/960296/sammyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3787, "favorite_count": 3, "accepted_answer_id": 47486724, "answer_count": 2, "score": 3, "last_activity_date": 1511620059, "creation_date": 1511617213, "last_edit_date": 1511617791, "question_id": 47486606, "link": "https://stackoverflow.com/questions/47486606/please-explain-if-golang-types-pass-by-value", "title": "Please explain if golang types pass by value", "body": "<p>I'm trying to make a very simple program that modifies arrays, but ran across some interesting behavior if I converted them to types. <a href=\"https://play.golang.org/p/KC7mqmHuLw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KC7mqmHuLw</a> It appears that if I have an array go passes by reference, but if I have a type then go passes by value.  Is this correct?</p>\n\n<p>I have two variables b and c, both are arrays of 3 integers, but c is of type cT, in every other respect they should be identical.  I can assign values as <code>b[0]=-1</code> and <code>c[0]=-1</code>, but if I pass those arrays as parameters to a function they act very differently.</p>\n\n<p>The output of the program is:</p>\n\n<blockquote>\n  <p>before b: [1 2 3]</p>\n  \n  <p>before c: [1 2 3]</p>\n  \n  <p>*after b: [-1 2 0]</p>\n  \n  <p>*after c: [-1 2 3]</p>\n  \n  <p>*what? c: [-1 2 0]</p>\n</blockquote>\n\n<p>My initial assumption is that the lines \"after b\" and \"after c\" should have been the same.  Am I doing something incorrectly or am I correct about types passing to functions by value (ie. creating copy of the variable before passing to the function)?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype cT [3]int\n\nfunc main() {\n    b := []int{1, 2, 3}\n    c := cT{1, 2, 3}\n\n    fmt.Println(\"before b:\", b)\n    fmt.Println(\"before c:\", c)\n\n    b[0] = -1\n    c[0] = -1\n    mangleB(b) // ignore return value\n    mangleC(c) // ignore return value\n\n    fmt.Println(\"*after b:\", b)\n    fmt.Println(\"*after c:\", c)\n\n    c = mangleC(c)    \n    fmt.Println(\"*what? c:\", c)    \n}\n\nfunc mangleB(row []int) []int {\n    row[2] = 0\n    return row\n}\n\nfunc mangleC(row cT) cT{\n    row[2] = 0\n    return row\n}\n</code></pre>\n"}, {"tags": ["go", "overloading"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1511617495, "last_edit_date": 1511617495, "creation_date": 1511616476, "answer_id": 47486497, "question_id": 47486370, "link": "https://stackoverflow.com/questions/47486370/is-there-a-way-to-overload-a-function-in-go/47486497#47486497", "title": "Is there a way to overload a function in Go?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a> </p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Built-in_functions\" rel=\"nofollow noreferrer\">Built-in functions</a></p>\n  \n  <p>Built-in functions are predeclared. They are called like any other\n  function but some of them accept a type instead of an expression as\n  the first argument.</p>\n  \n  <p>The built-in functions do not have standard Go types, so they can only\n  appear in call expressions; they cannot be used as function values.</p>\n</blockquote>\n\n<hr>\n\n<p>The Go programming language does not allow function overloading except for Go built-in functions. There is no way for you to overload your functions.</p>\n"}, {"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 3, "last_activity_date": 1511618252, "last_edit_date": 1511618252, "creation_date": 1511616666, "answer_id": 47486521, "question_id": 47486370, "link": "https://stackoverflow.com/questions/47486370/is-there-a-way-to-overload-a-function-in-go/47486521#47486521", "title": "Is there a way to overload a function in Go?", "body": "<p>No.</p>\n\n<p>For obvious reasons this is called the <strong>comma ok</strong> idiom (not a function overload ):</p>\n\n<pre><code>result, status := &lt;-ch1\n</code></pre>\n\n<p>1- Try <a href=\"https://play.golang.org/p/bsjJ-P3C6f\" rel=\"nofollow noreferrer\">this</a> for Channels:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    ch1 := make(chan string, 1)\n    ch1 &lt;- `Hi`\n    result, status := &lt;-ch1\n    fmt.Println(result, status) // Hi true\n\n    ch1 &lt;- `Hi`\n    close(ch1)\n    result, status = &lt;-ch1\n    fmt.Println(result, status) // Hi true\n\n    result, status = &lt;-ch1\n    fmt.Println(result, status) //    false\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>Hi true\nHi true\n false\n</code></pre>\n\n<hr>\n\n<p>2- Try <a href=\"https://play.golang.org/p/v05WBo3Qj9\" rel=\"nofollow noreferrer\">this</a> for Maps:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    m := map[string]int{\"One\": 1, \"Two\": 2}\n\n    result, status := m[\"One\"]\n    fmt.Println(result, status) // 1 true\n\n    result, status = m[\"Two\"]\n    fmt.Println(result, status) // 2 true\n\n    result, status = m[\"Zero\"]\n    fmt.Println(result, status) //  0  false\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>1 true\n2 true\n0 false\n</code></pre>\n\n<hr>\n\n<p>3- Try <a href=\"https://play.golang.org/p/-pQFxezq91\" rel=\"nofollow noreferrer\">this</a> for <code>interface</code> conversions and type assertions:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var s interface{} = `One`\n\n    result, status := s.(string)\n    fmt.Println(result, status) // One true\n\n    i, status := s.(int)\n    fmt.Println(i, status) // 0 false\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>One true\n0 false\n</code></pre>\n"}], "owner": {"reputation": 5894, "user_id": 4746206, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/aeb5a68770c5420348fb112d7e082436?s=128&d=identicon&r=PG&f=1", "display_name": "Bob5421", "link": "https://stackoverflow.com/users/4746206/bob5421"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 1, "accepted_answer_id": 47486521, "answer_count": 2, "score": 1, "last_activity_date": 1554400786, "creation_date": 1511615723, "last_edit_date": 1511617299, "question_id": 47486370, "link": "https://stackoverflow.com/questions/47486370/is-there-a-way-to-overload-a-function-in-go", "title": "Is there a way to overload a function in Go?", "body": "<p>I have read that there is no way to overload a function in Go. I mean by overloading, a way to have two functions with the same name but with different arguments.</p>\n\n<p>I have seen something strange in the built-in functions of Go:</p>\n\n<p>Let's suppose <code>ch1</code> is a channel variable:</p>\n\n<pre><code>ch1 := make(chan string)\n</code></pre>\n\n<p>It is possible to read somthing from a channel like this:</p>\n\n<pre><code>result := &lt;-ch1\n</code></pre>\n\n<p>But it is also possible to get a status like this:</p>\n\n<pre><code>result, status := &lt;-ch1\n</code></pre>\n\n<p>So, is there is a  way to overloaded a function like a built-in function?</p>\n"}, {"tags": ["go", "visual-studio-code", "vscode-settings"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8659831, "user_type": "registered", "profile_image": "https://graph.facebook.com/489480171415442/picture?type=large", "display_name": "lhvubtqn", "link": "https://stackoverflow.com/users/8659831/lhvubtqn"}, "edited": false, "score": 0, "creation_date": 1511890905, "post_id": 47528005, "comment_id": 82032392, "body": "Thank for your help ^^"}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 0, "last_activity_date": 1511861188, "creation_date": 1511861188, "answer_id": 47528005, "question_id": 47486366, "link": "https://stackoverflow.com/questions/47486366/go-debugging-with-gdb-using-visual-studio-code/47528005#47528005", "title": "Go debugging with GDB using Visual Studio Code", "body": "<p>lauch.json won't be enough to achieve that. To actually use GDB from VS Code you will need a plugin supporting GDB. You can probably try \"Native Debug\" plugin for that. But I'd like to point out that GDB has several issues with debugging Go programs. And generally recommended debugger for Go is delve. And debugging with delve is supported (among many other things) by \"Go for Visual Studio Code\" plugin. Both plugins include detailed instructions on necessary configuration.</p>\n"}], "owner": {"reputation": 1, "user_id": 8659831, "user_type": "registered", "profile_image": "https://graph.facebook.com/489480171415442/picture?type=large", "display_name": "lhvubtqn", "link": "https://stackoverflow.com/users/8659831/lhvubtqn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511861188, "creation_date": 1511615708, "last_edit_date": 1511723099, "question_id": 47486366, "link": "https://stackoverflow.com/questions/47486366/go-debugging-with-gdb-using-visual-studio-code", "title": "Go debugging with GDB using Visual Studio Code", "body": "<p>Is there any way to set up lauch.json file, so that we can debug Go file with GDB using VSC?</p>\n"}, {"tags": ["go", "io"], "comments": [{"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 1, "creation_date": 1511614157, "post_id": 47486128, "comment_id": 81927046, "body": "Your process still has the write side of the pipe open.  So io.Copy is blocking waiting until you close it.  This is expected behavior."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1511614280, "post_id": 47486128, "comment_id": 81927093, "body": "EOF hasn\u2019t been reached. EOF is when you close the pipe."}], "answers": [{"tags": [], "owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "is_accepted": true, "score": 8, "last_activity_date": 1511615910, "last_edit_date": 1511615910, "creation_date": 1511614346, "answer_id": 47486180, "question_id": 47486128, "link": "https://stackoverflow.com/questions/47486128/why-does-io-pipe-continue-to-block-even-when-eof-is-reached/47486180#47486180", "title": "Why does io.Pipe() continue to block even when EOF is reached?", "body": "<p>\"why does io.Pipe() seem to ignore an EOF from the writer, leaving the reader blocking forever?\"  Because there is no such thing as \"EOF from the writer\".  All an EOF is (in unix) is an indication to the reader that  no processes hold the write side of the pipe open.  When a process attempts to read from a pipe which has no writers, the <code>read</code> system call returns a value that is conveniently named EOF.  Since your parent still has one copy of the write side of the pipe open, <code>read</code> blocks.  Stop thinking of EOF as a thing. It is merely an abstraction, and the writer never \"sends\" it.</p>\n"}], "owner": {"reputation": 5011, "user_id": 10839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d83bb8f0321b186ab83bc0945d87ec?s=128&d=identicon&r=PG", "display_name": "Jeremy Visser", "link": "https://stackoverflow.com/users/10839/jeremy-visser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2058, "favorite_count": 0, "accepted_answer_id": 47486180, "answer_count": 1, "score": 2, "last_activity_date": 1511797788, "creation_date": 1511613942, "question_id": 47486128, "link": "https://stackoverflow.com/questions/47486128/why-does-io-pipe-continue-to-block-even-when-eof-is-reached", "title": "Why does io.Pipe() continue to block even when EOF is reached?", "body": "<p>While playing with subprocesses and reading stdout through pipes I noticed interesting behaviour.</p>\n\n<p>If I use an <code>io.Pipe()</code> to read the stdout of a subprocess created through <code>os/exec</code>, reading from that pipe hangs forever even when EOF is reached (the process is finished):</p>\n\n<pre><code>cmd := exec.Command(\"/bin/echo\", \"Hello, world!\")\nr, w := io.Pipe()\ncmd.Stdout = w\ncmd.Start()\n\nio.Copy(os.Stdout, r) // Prints \"Hello, World!\" but never returns\n</code></pre>\n\n<p>However, if I use the built-in method <code>StdoutPipe()</code> it works:</p>\n\n<pre><code>cmd := exec.Command(\"/bin/echo\", \"Hello, world!\")\np := cmd.StdoutPipe()\ncmd.Start()\n\nio.Copy(os.Stdout, p) // Prints \"Hello, World!\" and returns\n</code></pre>\n\n<p>Digging into the source code of <code>/usr/lib/go/src/os/exec/exec.go</code>, I can see that the StdoutPipe() method actually uses <code>os.Pipe()</code>, not <code>io.Pipe()</code>:</p>\n\n<pre><code>pr, pw, err := os.Pipe()\ncmd.Stdout = pw\ncmd.closeAfterStart = append(c.closeAfterStart, pw)\ncmd.closeAfterWait = append(c.closeAfterWait, pr)\nreturn pr, nil\n</code></pre>\n\n<p>This gives me two clues:</p>\n\n<ol>\n<li>File descriptors are being closed at certain points. Critically, the \"write\" end of the pipe is being closed after process start.</li>\n<li>Instead of <code>io.Pipe()</code> as I used above, <code>os.Pipe()</code> (a lower level call that roughly maps to <code>pipe(2)</code> in POSIX) is used.</li>\n</ol>\n\n<p>However I am still unable to understand why my original example behaves the way it does after taking into account this newfound knowledge.</p>\n\n<p>If I try to close the write end of an <code>io.Pipe()</code> (instead of an <code>os.Pipe()</code>) then it appears to break it completely and nothing gets read (as if I'm reading from a closed pipe even though I thought I passed it to the subprocess):</p>\n\n<pre><code>cmd := exec.Command(\"/bin/echo\", \"Hello, world!\")\nr, w := io.Pipe()\ncmd.Stdout = w\ncmd.Start()\n\nw.Close()\nio.Copy(os.Stdout, r) // Prints nothing, no read buffer available\n</code></pre>\n\n<p>Okay, so I guess an <code>io.Pipe()</code> is quite different than an <code>os.Pipe()</code>, and probably doesn't behave like Unix pipes where one <code>close()</code> doesn't close it for everybody.</p>\n\n<p>Just so you don't think I'm asking for a quick fix, I already know I can achieve my expected behaviour by using this code:</p>\n\n<pre><code>cmd := exec.Command(\"/bin/echo\", \"Hello, world!\")\nr, w, _ := os.Pipe() // using os.Pipe() instead of io.Pipe()\ncmd.Stdout = w\ncmd.Start()\n\nw.Close()\nio.Copy(os.Stdout, r) // Prints \"Hello, World!\" and returns on EOF. Works. :-)\n</code></pre>\n\n<p>What I'm asking for is <em>why does io.Pipe() seem to ignore an EOF from the writer</em>, leaving the reader blocking forever? A valid answer could be that <code>io.Pipe()</code> is the wrong tool for the job because <code>$REASONS</code> but I can't figure out what those <code>$REASONS</code> are because according to the documentation what I'm trying to do seems perfectly reasonable.</p>\n\n<p>Here is a complete example to illustrate what I'm talking about:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n  \"os/exec\"\n  \"io\"\n)\n\nfunc main() {\n  cmd := exec.Command(\"/bin/echo\", \"Hello, world!\")\n  r, w := io.Pipe()\n  cmd.Stdout = w \n  cmd.Start()\n\n  io.Copy(os.Stdout, r) // Blocks here even though EOF is reached\n\n  fmt.Println(\"Finished io.Copy()\")\n  cmd.Wait()\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "go", "macros", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1511629357, "last_edit_date": 1511629357, "creation_date": 1511617424, "answer_id": 47486630, "question_id": 47485904, "link": "https://stackoverflow.com/questions/47485904/cannot-wrap-cgo-flags-with-macros/47486630#47486630", "title": "Cannot wrap cgo flags with macros", "body": "<p>The <code>#cgo</code> directives are used by the go tools, not the C pre-processor. </p>\n\n<p>In the <a href=\"https://golang.org/cmd/cgo/#hdr-Using_cgo_with_the_go_command\" rel=\"nofollow noreferrer\">cgo documentation</a>, there are examples of using <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a> to conditionally set the flag values. What you want is</p>\n\n<pre><code>#cgo windows CFLAGS:-nostdlib\n#cgo linux LDFLAGS: -lX11 -lXtst\n</code></pre>\n"}], "owner": {"reputation": 348, "user_id": 7121906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39d83955a24c118cf5dda3b982f2e634?s=128&d=identicon&r=PG&f=1", "display_name": "Andrea Nardi", "link": "https://stackoverflow.com/users/7121906/andrea-nardi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 47486630, "answer_count": 1, "score": 0, "last_activity_date": 1511629357, "creation_date": 1511612439, "question_id": 47485904, "link": "https://stackoverflow.com/questions/47485904/cannot-wrap-cgo-flags-with-macros", "title": "Cannot wrap cgo flags with macros", "body": "<p>I made a Go program to simulate key presses. To do that I had to use cgo and different snippet of C code depending on the OS the Go code was being compiled.\nThe code that I wrote looks like this:</p>\n\n<pre><code>package keyboard\n\n/*\n#include &lt;stdint.h&gt;\n#ifdef __WIN32\n#cgo CFLAGS:-nostdlib\n#include &lt;Windows.h&gt;\n\nvoid SetKey(uint16_t key, uint8_t value) {\n    INPUT ip;\n\n    ip.type = INPUT_KEYBOARD;\n    ip.ki.wScan = 0;\n    ip.ki.time = 0;\n    ip.ki.dwExtraInfo = 0;\n\n    ip.ki.wVk = key;\n    if (value) {\n        ip.ki.dwFlags = 0;\n    } else {\n        ip.ki.dwFlags = KEYEVENTF_KEYUP;\n    }\n\n    SendInput(1, &amp;ip, sizeof(INPUT));\n}\n#endif\n\n#ifdef __linux__\n#cgo LDFLAGS: -lX11 -lXtst\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt; //TODO: REMOVE\n\n#include &lt;X11/Xlib.h&gt;\n#include &lt;X11/keysym.h&gt;\n#include &lt;X11/extensions/XTest.h&gt;\n\nvoid SetKey(uint16_t key, uint8_t value) {\n    Display *display;\n    display = XOpenDisplay(NULL);\n\n    if(display == NULL) {\n        exit(EXIT_FAILURE);\n    }\n\n    XTestFakeKeyEvent(display,XKeysymToKeycode(display,key), value, 0);\n    XCloseDisplay(display);\n}\n#endif\n*/\nimport \"C\"\n\nfunc SetKey(keyId uint16, value bool) {\n    C.SetKey(C.uint16_t(keyId),boolToByte(value));\n}\n\nfunc boolToByte(value bool) C.uint8_t {\n    if(value) {\n        return 1\n    } else {\n        return 0\n    }\n}\n</code></pre>\n\n<p>The code compiles fine on Ubuntu, but on Windows 10 I get the following error</p>\n\n<pre><code>C:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lX11\nC:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/bin/ld.exe: cannot find -lXtst\n</code></pre>\n\n<p>even if the line <code>#cgo LDFLAGS: -lX11 -lXtst</code> is wrapped around <code>#ifdef __linux__</code> and <code>#endif</code>.\nWhere does the problem lie on?\nDoes the GCC compiler define the <code>__linux__</code> macro? \nIs the keyword <code>#cgo</code> not supposed to be used like that?</p>\n"}, {"tags": ["go", "rabbitmq", "message-queue", "rpc", "channel"], "answers": [{"tags": [], "owner": {"reputation": 1520, "user_id": 4267030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BOrG6b-sscc/AAAAAAAAAAI/AAAAAAAAAWA/D2MY5eo53kU/photo.jpg?sz=128", "display_name": "Amir Rahimi Farahani", "link": "https://stackoverflow.com/users/4267030/amir-rahimi-farahani"}, "is_accepted": true, "score": 1, "last_activity_date": 1511614893, "creation_date": 1511614893, "answer_id": 47486255, "question_id": 47485461, "link": "https://stackoverflow.com/questions/47485461/rabbitmq-d-ack-close-channel/47486255#47486255", "title": "RabbitMQ: d.Ack() close channel", "body": "<p><a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Ack\" rel=\"nofollow noreferrer\">Ack()</a> acknowledges a delivery, and should be used when the acknowledgement mode is manual. See also Nack and Reject.</p>\n\n<p>From <a href=\"https://www.rabbitmq.com/confirms.html\" rel=\"nofollow noreferrer\">Consumer Acknowledgements and Publisher Confirms</a></p>\n\n<blockquote>\n  <p>Depending on the acknowledgement mode used, RabbitMQ can consider a\n  message to be successfully delivered either immediately after it is\n  sent out (written to a TCP socket) or when an explicit (\"manual\")\n  client acknowledgement is received.</p>\n</blockquote>\n\n<p><a href=\"https://godoc.org/github.com/streadway/amqp#Delivery.Ack\" rel=\"nofollow noreferrer\">Ack()</a> might end up closing the channel since each message should be acknowledged not more than once, otherwise the channel gets closed due to an exception:</p>\n\n<p><a href=\"https://www.rabbitmq.com/amqp-0-9-1-reference.html#basic.ack\" rel=\"nofollow noreferrer\">AMQP basic acknowledgement:</a></p>\n\n<blockquote>\n  <p>A message MUST not be acknowledged more than once. The receiving peer\n  MUST validate that a non-zero delivery-tag refers to a delivered\n  message, and raise a channel exception if this is not the case.</p>\n</blockquote>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "accepted_answer_id": 47486255, "answer_count": 1, "score": 2, "last_activity_date": 1511614893, "creation_date": 1511609364, "question_id": 47485461, "link": "https://stackoverflow.com/questions/47485461/rabbitmq-d-ack-close-channel", "title": "RabbitMQ: d.Ack() close channel", "body": "<p>I am reading this <a href=\"https://www.rabbitmq.com/tutorials/tutorial-six-go.html\" rel=\"nofollow noreferrer\">tutorial</a> about RPC with RabbitMQ</p>\n\n<p>seems following line close the queue channel:</p>\n\n<pre><code>d.Ack()\n</code></pre>\n\n<p>Could anyone explain what <code>d.Ack()</code> is actually for? And why it happen to close the queue channel?  </p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511610228, "post_id": 47485360, "comment_id": 81925946, "body": "Can you come up with a short problem description and a clear question? Sending JSON via HTTP is so simple but you show so much code..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6198643"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511610650, "post_id": 47485360, "comment_id": 81926064, "body": "Sorry, I&#39;ve edited my answer. Please let me know if it&#39;s still unclear."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6198643"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511612043, "post_id": 47485360, "comment_id": 81926471, "body": "@Volker, what I&#39;m trying to achieve is indeed &quot;so simple&quot;, I just don&#39;t have the knowledge yet for it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6198643"}, "edited": false, "score": 0, "creation_date": 1511622170, "post_id": 47486419, "comment_id": 81929549, "body": "Thanks, this is exactly what I was struggling to understand."}], "tags": [], "owner": {"reputation": 12722, "user_id": 393157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PiD4P.png?s=128&g=1", "display_name": "svenwltr", "link": "https://stackoverflow.com/users/393157/svenwltr"}, "is_accepted": true, "score": 0, "last_activity_date": 1511616428, "last_edit_date": 1511616428, "creation_date": 1511615976, "answer_id": 47486419, "question_id": 47485360, "link": "https://stackoverflow.com/questions/47485360/golang-how-to-use-a-struct-to-write-json-response-over-http/47486419#47486419", "title": "Golang, how to use a struct to write JSON response over HTTP?", "body": "<p>You question is a bit confusing. <s>You are asking about JSON, but your wanted response is not in a valid JSON format:</s> <em>It looks like you added unrelated GraphQL information.</em></p>\n\n<p>I am not sure if this is an question about GraphQL or JSON. I will try to answer it anyway.</p>\n\n<p>Your example <code>data</code> looks like this, therefore I assume that is the result you want to generate:</p>\n\n<pre><code>data := `{\"data\":{\"character\":{\"name\":\"Luke Skywalker\",\"appearsIn\":[\"NEWHOPE\",\"EMPIRE\",\"JEDI\"]}}}`\n</code></pre>\n\n<p>A clean way to make Go generate a proper JSON is to create Structs which contain the data:</p>\n\n<pre><code>type Response struct {\n    Data Data `json:\"data\"`\n}\n\ntype Data struct {\n    Character Character `json:\"characer\"`\n}\n\ntype Character struct {\n    Name      string   `json:\"name\"`\n    AppearsIn []string `json:\"appearsIn\"`\n}\n</code></pre>\n\n<p>Then you can define the data like this:</p>\n\n<pre><code>    data := Response{\n        Data: Data{\n            Character: Character{\n                Name:      \"Luke Skywalker\",\n                AppearsIn: []string{\"NEWHOPE\", \"EMPIRE\", \"JEDI\"},\n            },\n        },\n    }\n</code></pre>\n\n<p>Perhaps this question isn't about JSON rather than GraphQL. In this case you need to clarify your question.</p>\n\n<p><strong>References</strong></p>\n\n<ul>\n<li>Details about JSON tags (ie <code>json:\"..\"</code>): <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#Marshal</a></li>\n<li>Example with Structs: <a href=\"https://gobyexample.com/structs\" rel=\"nofollow noreferrer\">https://gobyexample.com/structs</a></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6198643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 0, "accepted_answer_id": 47486419, "answer_count": 1, "score": 0, "last_activity_date": 1511616428, "creation_date": 1511608800, "last_edit_date": 1511612214, "question_id": 47485360, "link": "https://stackoverflow.com/questions/47485360/golang-how-to-use-a-struct-to-write-json-response-over-http", "title": "Golang, how to use a struct to write JSON response over HTTP?", "body": "<p><strong>The Goal:</strong></p>\n\n<p>Using github.com/neelance/graphql-go starwars example, I'm trying to write a JSON response to my ReactJS client. That struct stuff is completely new for me, Golang as well btw.</p>\n\n<p><strong>The question:</strong></p>\n\n<p>What should <code>data</code> variable be in order to get the appropriate response to the following example GraphQL query? </p>\n\n<pre class=\"lang-graphql prettyprint-override\"><code>query clientQuery {\n  character(id: 1000) {\n    name\n    appearsIn\n  }\n}\n</code></pre>\n\n<p><strong>Additional info:</strong></p>\n\n<p>From what I've read here and there, <code>data</code> must be some kind of struct. I've got plenty of structs available in the example (see starwars.go below).</p>\n\n<p><strong>The Code to be modified (main.go):</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n\n    \"github.com/neelance/graphql-go\"\n    \"github.com/neelance/graphql-go/example/starwars\"\n    \"github.com/neelance/graphql-go/relay\"\n)\n\nvar schema *graphql.Schema\n\nfunc init() {\n    schema = graphql.MustParseSchema(starwars.Schema, &amp;starwars.Resolver{})\n}\n\nfunc main() {\n\n    port := \":8080\"\n    log.Printf(`GraphQL server starting up on http://localhost%v`, port)\n\n    http.Handle(\"/query\", &amp;relay.Handler{Schema: schema})\n\n    http.HandleFunc(\"/graphql\", func(w http.ResponseWriter, r *http.Request) {\n\n        // THIS IS SUPER WRONG, data should be something\n        // like data := starwars.Resolver{} or so?\n        data := `{\"data\":{\"character\":{\"name\":\"Luke Skywalker\",\"appearsIn\":[\"NEWHOPE\",\"EMPIRE\",\"JEDI\"]}}}`\n\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.WriteHeader(http.StatusCreated)\n        json.NewEncoder(w).Encode(data)\n    })\n\n    log.Fatal(http.ListenAndServe(port, nil))\n}\n</code></pre>\n\n<p><strong>REFERENCE 1 - <a href=\"https://github.com/neelance/graphql-go/blob/master/example/starwars/starwars.go\" rel=\"nofollow noreferrer\">starwars.go</a></strong></p>\n\n<p><strong>REFERENCE 2 - <a href=\"https://github.com/neelance/graphql-go/blob/master/relay/relay.go\" rel=\"nofollow noreferrer\">relay.go</a></strong></p>\n"}, {"tags": ["for-loop", "go", "rabbitmq", "message-queue", "event-driven"], "answers": [{"tags": [], "owner": {"reputation": 698, "user_id": 5617424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rmoz.jpg?s=128&g=1", "display_name": "Vane Trajkov", "link": "https://stackoverflow.com/users/5617424/vane-trajkov"}, "is_accepted": true, "score": 1, "last_activity_date": 1511607678, "creation_date": 1511607678, "answer_id": 47485191, "question_id": 47484693, "link": "https://stackoverflow.com/questions/47484693/event-driven-model-in-golang/47485191#47485191", "title": "Event driven model in Golang", "body": "<blockquote>\n  <ol>\n  <li>How would it process next event?</li>\n  </ol>\n</blockquote>\n\n<p>Beside iteration over basic data structures, <a href=\"https://tour.golang.org/concurrency/4\" rel=\"nofollow noreferrer\">range</a> in GoLang can also iterate over values received from a channel. Range iterates over each element as it's received from queue and ends only when the channel is closed. \nThe next iteration will happen when the channel (msgs) will receive a value</p>\n\n<pre><code>msgs &lt;- message\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>After some playing around with this code I found that it could stuck on log.Printf line and wouldn't process events anymore. What can be a reason?</li>\n  </ol>\n</blockquote>\n\n<p>Considering that there is a <a href=\"https://gobyexample.com/channel-synchronization\" rel=\"nofollow noreferrer\">blocking channel</a> <code>forever</code> and we have a range that iterates over the <code>msgs</code> channel there are 2 possible actions that are expected:</p>\n\n<p>Either </p>\n\n<ol>\n<li><p>send message through the msgs channel</p>\n\n<p>msgs &lt;- message</p></li>\n</ol>\n\n<p>or</p>\n\n<ol start=\"2\">\n<li><p>send value to <code>forever</code> so it unblocks the process </p>\n\n<p>forever &lt;- false </p></li>\n</ol>\n\n<p>It seems like the solution is designed to <strong>wait</strong> and asynchronously process messages through a channel.</p>\n"}], "owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 47485191, "answer_count": 1, "score": 0, "last_activity_date": 1511607678, "creation_date": 1511603981, "question_id": 47484693, "link": "https://stackoverflow.com/questions/47484693/event-driven-model-in-golang", "title": "Event driven model in Golang", "body": "<p>I am reading <a href=\"https://www.rabbitmq.com/tutorials/tutorial-one-go.html\" rel=\"nofollow noreferrer\">RabbitMQ tutorial</a> and seeing following code:</p>\n\n<pre><code>forever := make(chan bool)\n\ngo func() {\n  for d := range msgs {\n    log.Printf(\"Received a message: %s\", d.Body)\n  }\n}()\n\nlog.Printf(\" [*] Waiting for messages. To exit press CTRL+C\")\n&lt;-forever\n</code></pre>\n\n<p>What I am interested in is <code>for d := range msgs</code>. How does this for loop handle events? eg. At the app start I have only one message in <code>msgs</code> queue buffer. </p>\n\n<p><strong>Questions:</strong></p>\n\n<ol>\n<li>How would it process next event? </li>\n<li>After some <a href=\"https://stackoverflow.com/questions/47477206/rpc-with-golang-and-rabbitmq\">playing around</a> with this code I found that it could stuck on <code>log.Printf</code> line and wouldn't process events anymore. What can be a reason?  </li>\n</ol>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6759806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08e46430b8ac1c4f98d9e0c6512a0b?s=128&d=identicon&r=PG&f=1", "display_name": "rbxb", "link": "https://stackoverflow.com/users/6759806/rbxb"}, "edited": false, "score": 0, "creation_date": 1511583692, "post_id": 47482432, "comment_id": 81919978, "body": "This might be what I\u2019m looking for. The request should contain a key to information as a URL parameter. I have to check if the information they are requesting exists and, if so, I should just open the body of the response, indicating to the client that it does exist and the server is retrieving data. If not, then I can send back an error response."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1511583809, "last_edit_date": 1511583809, "creation_date": 1511581857, "answer_id": 47482432, "question_id": 47482365, "link": "https://stackoverflow.com/questions/47482365/writing-an-interim-response-go-server/47482432#47482432", "title": "writing an interim response - go server", "body": "<p>If the request has the <a href=\"https://github.com/golang/go/blob/be589f8d2b721aa86fd5e406733f61a5ed245d3a/src/net/http/server.go#L1776-L1780\" rel=\"nofollow noreferrer\">Expect: 100-continue</a> header, then the net/http server <a href=\"https://github.com/golang/go/blob/be589f8d2b721aa86fd5e406733f61a5ed245d3a/src/net/http/server.go#L857-L860\" rel=\"nofollow noreferrer\">sends \"HTTP/1.1 100 Continue\" on first read of the request body</a>.</p>\n\n<p>The logic for the application is:</p>\n\n<ul>\n<li>Is the request OK?\n\n<ul>\n<li>If yes, then read the request body and proceed as normal.</li>\n<li>if no, then respond with an error. Do not read the request body.</li>\n</ul></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6759806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08e46430b8ac1c4f98d9e0c6512a0b?s=128&d=identicon&r=PG&f=1", "display_name": "rbxb", "link": "https://stackoverflow.com/users/6759806/rbxb"}, "edited": false, "score": 0, "creation_date": 1511625657, "post_id": 47482891, "comment_id": 81930587, "body": "Does this set the status code for the complete response or does this actually trigger an interim response?"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1511587487, "creation_date": 1511587487, "answer_id": 47482891, "question_id": 47482365, "link": "https://stackoverflow.com/questions/47482365/writing-an-interim-response-go-server/47482891#47482891", "title": "writing an interim response - go server", "body": "<pre><code>func handle(w http.ResponseWriter, r *http.Request) {\n    w.WriteHeader(http. StatusContinue) // 100 code\n    fmt.Fprintf(w, \"existence is pain\")\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6759806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d08e46430b8ac1c4f98d9e0c6512a0b?s=128&d=identicon&r=PG&f=1", "display_name": "rbxb", "link": "https://stackoverflow.com/users/6759806/rbxb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1511587487, "creation_date": 1511580920, "question_id": 47482365, "link": "https://stackoverflow.com/questions/47482365/writing-an-interim-response-go-server", "title": "writing an interim response - go server", "body": "<p>I'm writing a Go server and client and I can't figure out how write an interim response (status code 1xx). I've searched for documentation and examples for this but haven't found anything.\nMy searching did turn up some information about chunked responses but I don't think that is quite what I need.</p>\n\n<p>I really just want to send a interim response to let the Client know that the request has been recieved (and some information has been validated) while the server gets more data for the final response.\nThe request will be made using ajax on my javascript client. I think I can figure out the client part on my own but I'm new to Go and I could really use some help with writing the response.</p>\n\n<p>I don't have a lot of relevant code to show because I am completely lost as to where to start. But here is the <em>very</em> basic Go server that I am trying to build off of ...if that helps.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc handle(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"existence is pain\")\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handle)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>So this is my starting point and where I got stuck.\nI want to be able to do something like</p>\n\n<pre><code>//validate request\n//send interim response\n//get more data\n//send complete response\n</code></pre>\n\n<p>Is there a net/http function that allows me to send an interim response?\nShould I not be using <code>http.HandleFunc()</code> for something like this? (and what should I be using?)\nIf anyone has an example of this or can point me in the right direction, that would help.</p>\n\n<p>Also, sorry if \"interim\" isn't the accepted jargon. If that caused confusion, here is my source: <a href=\"https://msdn.microsoft.com/en-us/library/cc246721.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/cc246721.aspx</a></p>\n"}, {"tags": ["http", "post", "go", "struct", "types"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511610307, "post_id": 47482278, "comment_id": 81925971, "body": "Go is not dynamically typed. Redesign. For the real case where something like this is needed: Take a look at package reflect."}, {"owner": {"reputation": 1190, "user_id": 3241177, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3454c7c0a468a102de5f250830c4ecf9?s=128&d=identicon&r=PG&f=1", "display_name": "stackunderflow", "link": "https://stackoverflow.com/users/3241177/stackunderflow"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1511619072, "post_id": 47482278, "comment_id": 81928556, "body": "I appreciate the feedback, thank you."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1511579947, "creation_date": 1511579947, "answer_id": 47482299, "question_id": 47482278, "link": "https://stackoverflow.com/questions/47482278/go-struct-with-computed-key/47482299#47482299", "title": "Go struct with computed key", "body": "<p>Use a map when the key is not known a compile time:</p>\n\n<pre><code>type File struct {\n    Contents string\n}\n\ntype Payload struct {\n    Description string\n    Public      bool\n    Files       map[string]*File\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9KNvHToXG3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9KNvHToXG3</a></p>\n"}], "owner": {"reputation": 1190, "user_id": 3241177, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3454c7c0a468a102de5f250830c4ecf9?s=128&d=identicon&r=PG&f=1", "display_name": "stackunderflow", "link": "https://stackoverflow.com/users/3241177/stackunderflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 47482299, "answer_count": 1, "score": -2, "last_activity_date": 1511579947, "creation_date": 1511579483, "question_id": 47482278, "link": "https://stackoverflow.com/questions/47482278/go-struct-with-computed-key", "title": "Go struct with computed key", "body": "<p>How can I create a <code>struct</code> for the following data structure in Go?</p>\n\n<pre><code>{\n    \"description\": String,\n    \"public\":      Boolean,\n    \"files\": {\n        \"some_filename.txt\": {\n            \"contents\": String\n        }\n    }\n}\n</code></pre>\n\n<p>I have started with the following:</p>\n\n<pre><code>type File struct {\n    // stuck here?\n}\n\ntype Payload struct {\n    Description string\n    Public      bool\n    Files       File\n}\n</code></pre>\n\n<p>Any help with using this for a HTTP post request would be greatly appreciated.</p>\n"}, {"tags": ["go", "ibm-mq"], "comments": [{"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1511584112, "post_id": 47482153, "comment_id": 81920042, "body": "What version of the IBM MQ client do you have installed?"}, {"owner": {"reputation": 11, "user_id": 6735406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e055397e7a07f829a21a764c5b9d42?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhua Zhu", "link": "https://stackoverflow.com/users/6735406/jianhua-zhu"}, "reply_to_user": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "edited": false, "score": 0, "creation_date": 1511585440, "post_id": 47482153, "comment_id": 81920231, "body": "@JoshMc 7.5.0.2"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6735406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e055397e7a07f829a21a764c5b9d42?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhua Zhu", "link": "https://stackoverflow.com/users/6735406/jianhua-zhu"}, "edited": false, "score": 0, "creation_date": 1511587739, "post_id": 47482841, "comment_id": 81920592, "body": "according to the error msg, it&#39;s when put message error, this is not use publish. code line 102 is err = qObject.Put(putmqmd, pmo, buffer) , /svr/ibmmq/clientconn/clientconn.go:102 +0x158e fp=0xc42004ff80 sp=0xc42004fa80 pc=0x49e29e"}, {"owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "reply_to_user": {"reputation": 11, "user_id": 6735406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e055397e7a07f829a21a764c5b9d42?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhua Zhu", "link": "https://stackoverflow.com/users/6735406/jianhua-zhu"}, "edited": false, "score": 0, "creation_date": 1511588140, "post_id": 47482841, "comment_id": 81920664, "body": "The readme states that it assumes availability of MQI structures from MQ v9. You are two levels of MQ behind what is the minimum requirement.  You should try to recreate this with the minimum."}, {"owner": {"reputation": 11, "user_id": 6735406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e055397e7a07f829a21a764c5b9d42?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhua Zhu", "link": "https://stackoverflow.com/users/6735406/jianhua-zhu"}, "edited": false, "score": 0, "creation_date": 1511916827, "post_id": 47482841, "comment_id": 82043805, "body": "Unfortunately, I&#39;ve tested it in version 9, and there&#39;s the same mistake."}], "tags": [], "owner": {"reputation": 8737, "user_id": 7264620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbebce2451f4d9f7abdebb6b2db7b618?s=128&d=identicon&r=PG&f=1", "display_name": "JoshMc", "link": "https://stackoverflow.com/users/7264620/joshmc"}, "is_accepted": false, "score": 0, "last_activity_date": 1511586918, "creation_date": 1511586918, "answer_id": 47482841, "question_id": 47482153, "link": "https://stackoverflow.com/questions/47482153/can-someone-share-an-example-of-using-ibm-mq-in-go-language/47482841#47482841", "title": "Can someone share an example of using IBM MQ in go language?", "body": "<p>The readme for mq-golang states you must be at a minimum of IBM MQ v9.</p>\n\n<blockquote>\n  <p>A minimum level of MQ V9 is required to build this package. The monitoring data published by the queue manager is not available before that version; the interface also assumes availability of MQI structures from that level of MQ.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 3493994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1655d64b6132c94bcba36006aa2ed5?s=128&d=identicon&r=PG", "display_name": "LaurenceBonney", "link": "https://stackoverflow.com/users/3493994/laurencebonney"}, "is_accepted": false, "score": 0, "last_activity_date": 1548420783, "creation_date": 1548420783, "answer_id": 54365715, "question_id": 47482153, "link": "https://stackoverflow.com/questions/47482153/can-someone-share-an-example-of-using-ibm-mq-in-go-language/54365715#54365715", "title": "Can someone share an example of using IBM MQ in go language?", "body": "<p>I've tried using the latest MQ 9.1.1 CD version with go1.11.5 I had to make a slight modification to your code to add an int32 in the Close() calls to get it to compile, but it now compiles and runs fine on my Ubuntu 16.04 VM. </p>\n\n<p>If rebuilding the MQ Go client with a later version of MQ you should use the -a flag on go install to force it to rebuild everything rather than cache the bit its already built, you could still be using code compiled against the old MQ libraries. </p>\n"}], "owner": {"reputation": 11, "user_id": 6735406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08e055397e7a07f829a21a764c5b9d42?s=128&d=identicon&r=PG&f=1", "display_name": "Jianhua Zhu", "link": "https://stackoverflow.com/users/6735406/jianhua-zhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1031, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1548420783, "creation_date": 1511577494, "last_edit_date": 1511945223, "question_id": 47482153, "link": "https://stackoverflow.com/questions/47482153/can-someone-share-an-example-of-using-ibm-mq-in-go-language", "title": "Can someone share an example of using IBM MQ in go language?", "body": "<p>everybody. Has anyone ever used the experience of IBM provided by <a href=\"https://github.com/ibm-messaging/mq-golang\" rel=\"nofollow noreferrer\">https://github.com/ibm-messaging/mq-golang</a> to share?</p>\n\n<p>here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"../ibmmq\"\n    \"os\"\n    \"strings\"\n    // \"time\"\n)\n\nfunc main() {\n    var qMgrName string\n    var qMgrObject ibmmq.MQObject\n    var managedQObject ibmmq.MQObject\n    var subObject ibmmq.MQObject\n    var err error\n    var qMgr ibmmq.MQQueueManager\n    // var rc int\n    var openOptions int32\n    var qObject ibmmq.MQObject\n\nif len(os.Args) != 5 {\n    fmt.Println(\"clientconn &lt;qmgrname&gt; &lt;channelname&gt; &lt;conname&gt; &lt;queuename&gt;\")\n    fmt.Println(\"\")\n    fmt.Println(\"For example\")\n    fmt.Println(\"  clientconn QMGR1 \\\"SYSTEM.DEF.SVRCONN\\\" \\\"myhost.example.com(1414)\\\" \\\"LOCAL.QUEUE\\\"\")\n    fmt.Println(\"All parameters are required.\")\n    os.Exit(1)\n}\n\nconnected := false\n\nqMgrName = os.Args[1]\n\ncno := ibmmq.NewMQCNO()\ncd := ibmmq.NewMQCD()\n\ncd.ChannelName = os.Args[2]\ncd.ConnectionName = os.Args[3]\n\ncno.ClientConn = cd\ncno.Options = ibmmq.MQCNO_CLIENT_BINDING\n\nuserId := os.Getenv(\"MQSAMP_USER_ID\")\nif userId != \"\" {\n    scanner := bufio.NewScanner(os.Stdin)\n    csp := ibmmq.NewMQCSP()\n    csp.AuthenticationType = ibmmq.MQCSP_AUTH_USER_ID_AND_PWD\n    csp.UserId = userId\n\n    fmt.Println(\"Enter password : \")\n    scanner.Scan()\n    csp.Password = scanner.Text()\n\n    cno.SecurityParms = csp\n}\n\nqMgr, err = ibmmq.Connx(qMgrName, cno)\n// qMgr, err = ibmmq.Conn(qMgrName)\nif err == nil {\n    fmt.Printf(\"Connection to %s succeeded.\\n\", qMgrName)\n    // d, _ := time.ParseDuration(\"5s\")\n    // time.Sleep(d)\n    // qMgr.Disc()\n} else {\n    fmt.Printf(\"Connection to %s failed.\\n\", qMgrName)\n    fmt.Println(err)\n}\n\nif err == nil {\n    mqod := ibmmq.NewMQOD()\n\n    openOptions = ibmmq.MQOO_OUTPUT + ibmmq.MQOO_FAIL_IF_QUIESCING\n    openOptions |= ibmmq.MQOO_INPUT_AS_Q_DEF\n\n    mqod.ObjectType = ibmmq.MQOT_Q\n    mqod.ObjectName = os.Args[4]\n\n    qObject, err = qMgr.Open(mqod, openOptions)\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(\"Opened queue\", qObject.Name)\n    }\n}\n\nif err == nil {\n    putmqmd := ibmmq.NewMQMD()\n    pmo := ibmmq.NewMQPMO()\n\n    pmo.Options = ibmmq.MQPMO_SYNCPOINT | ibmmq.MQPMO_NEW_MSG_ID | ibmmq.MQPMO_NEW_CORREL_ID\n\n    putmqmd.Format = \"MQSTR\"\n    msgData := \"Hello from Go\"\n    buffer := []byte(msgData)\n\n    // mqod := ibmmq.NewMQOD()\n    // openOptions = ibmmq.MQOO_INQUIRE + ibmmq.MQOO_FAIL_IF_QUIESCING\n    // mqod.ObjectType = ibmmq.MQOT_CHANNEL\n    // mqod.ObjectName = qObject.Name\n    err = qObject.Put(putmqmd, pmo, buffer)\n    // err = qMgr.Put1(mqod, putmqmd, pmo, buffer)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(\"Put message to\", qObject.Name)\n    }\n}\n\nif err == nil {\n    err = qMgr.Cmit()\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nif err == nil {\n    msgAvail := true\n\n    for msgAvail == true {\n        var datalen int\n\n        getmqmd := ibmmq.NewMQMD()\n        gmo := ibmmq.NewMQGMO()\n        gmo.Options = ibmmq.MQGMO_NO_SYNCPOINT | ibmmq.MQGMO_FAIL_IF_QUIESCING\n        gmo.Options |= ibmmq.MQGMO_WAIT\n        gmo.WaitInterval = 3000\n        buffer := make([]byte, 32768)\n\n        datalen, err = qObject.Get(getmqmd, gmo, buffer)\n\n        if err != nil {\n            msgAvail = false\n            fmt.Println(err)\n            mqret := err.(*ibmmq.MQReturn)\n            if mqret.MQRC == ibmmq.MQRC_NO_MSG_AVAILABLE {\n                err = nil\n            }\n        } else {\n            fmt.Printf(\"Got message of length %d: \", datalen)\n            fmt.Println(strings.TrimSpace(string(buffer[:datalen])))\n        }\n    }\n}\n\nif err == nil {\n    err = qObject.Close()\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(\"Closed queue\")\n    }\n}\n\nif err == nil {\n    mqsd := ibmmq.NewMQSD()\n    mqsd.Options = ibmmq.MQSO_CREATE\n    mqsd.Options |= ibmmq.MQSO_NON_DURABLE\n    mqsd.Options |= ibmmq.MQSO_FAIL_IF_QUIESCING\n    mqsd.Options |= ibmmq.MQSO_MANAGED\n    mqsd.ObjectString = \"$SYS/MQ/INFO/QMGR/\" + qMgrName + \"/ActivityTrace/ApplName/mqitest\"\n\n    subObject, err = qMgr.Sub(mqsd, &amp;managedQObject)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(\"Subscribed to topic \", mqsd.ObjectString)\n    }\n}\n\nif err == nil {\n    msgAvail := true\n\n    for msgAvail == true {\n        var datalen int\n\n        getmqmd := ibmmq.NewMQMD()\n        gmo := ibmmq.NewMQGMO()\n        gmo.Options = ibmmq.MQGMO_NO_SYNCPOINT | ibmmq.MQGMO_FAIL_IF_QUIESCING\n        gmo.Options |= ibmmq.MQGMO_WAIT\n        gmo.WaitInterval = 3000\n        buffer := make([]byte, 32768)\n\n        datalen, err = managedQObject.Get(getmqmd, gmo, buffer)\n\n        if err != nil {\n            msgAvail = false\n            fmt.Println(err)\n            mqret := err.(*ibmmq.MQReturn)\n            if mqret.MQRC == ibmmq.MQRC_NO_MSG_AVAILABLE {\n                // not a real error so reset err, but\n                // end retrieval loop\n                err = nil\n            }\n        } else {\n            fmt.Printf(\"Got message of length %d. Format = %s\\n\", datalen, getmqmd.Format)\n        }\n    }\n}\n\nif err == nil {\n    subObject.Close()\n}\n\nif err == nil {\n    mqod := ibmmq.NewMQOD()\n    openOptions = ibmmq.MQOO_INQUIRE + ibmmq.MQOO_FAIL_IF_QUIESCING\n\n    mqod.ObjectType = ibmmq.MQOT_Q_MGR\n    mqod.ObjectName = qMgrName\n\n    qMgrObject, err = qMgr.Open(mqod, openOptions)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Printf(\"Opened QMgr for MQINQ\\n\")\n    }\n}\n\nif err == nil {\n    selectors := []int32{ibmmq.MQCA_Q_MGR_NAME,\n        ibmmq.MQCA_DEAD_LETTER_Q_NAME,\n        ibmmq.MQIA_MSG_MARK_BROWSE_INTERVAL}\n\n    intAttrs, charAttrs, err := qMgrObject.Inq(selectors, 2, 160)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        returnedName := string(charAttrs[0:48])\n        fmt.Printf(\"MQINQ returned +%v %s \\n\",\n            intAttrs, string(charAttrs))\n        fmt.Printf(\"               '%s'\\n\", returnedName)\n    }\n\n}\n\nif connected {\n    err = qMgr.Disc()\n    fmt.Println(\"Disconnected from queue manager \", qMgrName)\n}\n\nif err == nil {\n    os.Exit(0)\n} else {\n    mqret := err.(*ibmmq.MQReturn)\n    os.Exit((int)(mqret.MQCC))\n}\n\n}\n</code></pre>\n\n<p>but is always show fatal error:</p>\n\n<pre><code>[root@localhost clientconn]# ./clientconn QM_T01 \"JMS\" \"127.0.0.1(1414)\" \"LQ\"\nConnection to QM_T01 succeeded.\nOpened queue LQ\nfatal error: unexpected signal during runtime execution\n[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x7f214ba2b414]\n\nruntime stack: runtime.throw(0x4ebdce, 0x2a)\n    /home/app/go/src/runtime/panic.go:605 +0x95 runtime.sigpanic()\n    /home/app/go/src/runtime/signal_unix.go:351 +0x2b8\n\ngoroutine 1 [syscall, locked to thread]: runtime.cgocall(0x49ed30,\n0xc42004f9c8, 0x100)    /home/app/go/src/runtime/cgocall.go:132 +0xe4\nfp=0xc42004f980 sp=0xc42004f940 pc=0x4072c4\n_/svr/ibmmq/ibmmq._Cfunc_MQPUT(0x1000006, 0xc42007c000, 0xc4200720c0, 0xd, 0xc420016110, 0xc420016120, 0xc4200160fc)\n    _/svr/ibmmq/ibmmq/_obj/_cgo_gotypes.go:887 +0x45 fp=0xc42004f9c8\nsp=0xc42004f980 pc=0x4938e5\n_/svr/ibmmq/ibmmq.MQObject.Put.func1(0x1000006, 0xc42007c000, 0xc4200720c0, 0xc40000000d, 0xc420016110, 0xc420016120, 0xc4200160fc)\n    /svr/ibmmq/ibmmq/mqi.go:407 +0x10e fp=0xc42004fa10 sp=0xc42004f9c8\npc=0x49a69e\n_/svr/ibmmq/ibmmq.MQObject.Put(0x0, 0xc42000c0a0, 0xc42001a0f0, 0x30, 0xc420078000, 0xc42007a000, 0xc420016110, 0xd, 0x10, 0x0, ...)\n    /svr/ibmmq/ibmmq/mqi.go:407 +0x120 fp=0xc42004fa80 sp=0xc42004fa10\npc=0x495030 main.main()     /svr/ibmmq/clientconn/clientconn.go:102\n+0x158e fp=0xc42004ff80 sp=0xc42004fa80 pc=0x49e29e runtime.main()  /home/app/go/src/runtime/proc.go:195 +0x226 fp=0xc42004ffe0\nsp=0xc42004ff80 pc=0x42e9c6 runtime.goexit()\n    /home/app/go/src/runtime/asm_amd64.s:2337 +0x1 fp=0xc42004ffe8\nsp=0xc42004ffe0 pc=0x457491\n</code></pre>\n"}]