[{"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1458774798, "post_id": 36189890, "comment_id": 60015844, "body": "Are you sure there isn&#39;t an error on the first commit?"}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1458775818, "post_id": 36189890, "comment_id": 60016217, "body": "You&#39;re doing a tx.Query for an INSERT. You should use tx.Exec. Query expects to return rows."}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "edited": false, "score": 0, "creation_date": 1458778248, "post_id": 36189890, "comment_id": 60016929, "body": "nah for postgres drivers the query just returns the inserted row so I don&#39;t think that&#39;s it. This begs 2 questions. Does the connection have the ability to select? Does the error resolve if you clean up the returned rows explicitly by closing the cursor on the return value? I&#39;m pretty much shooting in the dark here, this error is pretty.. well not nice haha"}], "owner": {"reputation": 2722, "user_id": 1846979, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/7d247cd6a1e86c8e3f135743d0e51527?s=128&d=identicon&r=PG", "display_name": "Stanimirovv", "link": "https://stackoverflow.com/users/1846979/stanimirovv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 613, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1458772041, "creation_date": 1458772041, "question_id": 36189890, "link": "https://stackoverflow.com/questions/36189890/golang-postgres-driver-panics-when-using-transactions", "title": "Golang postgres driver panics when using transactions", "body": "<p>So... this was apperantly an issue a few years ago, atleast there are several bugs with what I <strong>think</strong> is the same issue. In a method I have 2 transactions, one after the other (so they are not concurrent, they are sequencial) and the second transaction always fails. </p>\n\n<p>This is roughly the code:</p>\n\n<pre><code>import (\n        \"database/sql\"\n        _ \"github.com/lib/pq\"\n)\nvar db *sql.DB\n\nfunc InitStorage() {\n        var err error\n        db, err = sql.Open(os.Getenv(\"DB_CONNECTION_DRIVER\"), os.Getenv(\"DB_CONNECTION_STRING\"))\n        if err != nil {\n                glog.Error(err)\n        }   \n        if db == nil {\n                glog.Fatal(db)\n        }   \n        tx, err := db.Begin()\n   if err != nil {\n            glog.Error(err)\n        } else {\n            glog.Info(\"ERROR ON BEGIN IS NiLL!!!\")\n        }   \n\n        _, err = tx.Query(`INSERT INTO urls(url_hash, url) VALUES($1, $2)`, `asdadsaaa`, `1313`)\n        if err != nil {\n                glog.Error(err)\n                tx.Rollback()\n        }   \n        tx.Commit()\n        glog.Info(\"SECOND TRANSACTION!!!\")\n        tx1, err := db.Begin()\n   if err != nil {\n            glog.Error(\"SECOND TRANSACTION HAS ERR: \", err)\n        } else {\n            glog.Info(\"ERROR ON BEGIN IS NiLL!!!\")\n        }   \n        _, err = tx1.Query(`INSERT INTO urls(url_hash, url) VALUES($1, $2)`, `asdadsaaa`, `1313`)\n        if err != nil {   \n                glog.Error(err)\n                tx1.Rollback()\n        }   \n        tx1.Commit()\n}\n</code></pre>\n\n<p>And this is always the output (I have cut the end, since it doesn't bring useful information):</p>\n\n<pre><code>I0324 00:24:26.192256   11580 storage_rdb.go:33] ERROR ON BEGIN IS NiLL!!!\nI0324 00:24:26.195134   11580 storage_rdb.go:42] SECOND TRANSACTION!!!\nE0324 00:24:26.195197   11580 storage_rdb.go:45] SECOND TRANSACTION HAS ERRpq: unexpected transaction status idle in transaction\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x20 pc=0x5460cb]\n\ngoroutine 1 [running]:\npanic(0x7c41c0, 0xc820010150)\n        /usr/local/go/src/runtime/panic.go:464 +0x3e6\ndatabase/sql.(*Tx).Query(0x0, 0x8b2e00, 0x2e, 0xc82011fd50, 0x2, 0x2, 0xc82001a540, 0x0, 0x0)\n        /usr/local/go/src/database/sql/sql.go:1404 +0x3b\nmain.InitStorage()\n</code></pre>\n\n<p>I assume I am doing something wrong(since the bug was found in 2013), but I can't figure out what it is. Please help.</p>\n"}, {"tags": ["postgresql", "go", "where-clause", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 2752670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BUkkv.jpg?s=128&g=1", "display_name": "vikyd", "link": "https://stackoverflow.com/users/2752670/vikyd"}, "edited": false, "score": 0, "creation_date": 1542186042, "post_id": 36193498, "comment_id": 93473517, "body": "Add <code>chain := db.Where(&quot;&quot;)</code> ahead may be better."}, {"owner": {"reputation": 391, "user_id": 4136745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b512049cfc6af771dedfa13926801de9?s=128&d=identicon&r=PG&f=1", "display_name": "sify", "link": "https://stackoverflow.com/users/4136745/sify"}, "edited": false, "score": 0, "creation_date": 1604302360, "post_id": 36193498, "comment_id": 114295560, "body": "What about postgresql? The placeholder is &#39;$1&#39;, &#39;$2&#39;... instead of &#39;?&#39;"}], "tags": [], "owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "is_accepted": true, "score": 9, "last_activity_date": 1458795225, "creation_date": 1458795225, "answer_id": 36193498, "question_id": 36188706, "link": "https://stackoverflow.com/questions/36188706/separate-where-in-query/36193498#36193498", "title": "Separate where in query", "body": "<p>I believe this should work:</p>\n\n<pre><code>chain := db.Where(\"users.name like ?\", \"%\"+jhon+\"%\")\nemail := \"test@test.com\"\nif email != \"\" {\n  chain = chain.Where(\"users.email LIKE ?\", \"%\"+email+\"%\")\n}\nchain.Find(&amp;users)\n</code></pre>\n\n<p>All of the Gorm methods like <code>Where</code> return a result, which is chainable. That means that you can continue calling methods on it until you get something that you like.</p>\n"}], "owner": {"reputation": 1407, "user_id": 889074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YwYtO.jpg?s=128&g=1", "display_name": "kalelc", "link": "https://stackoverflow.com/users/889074/kalelc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2020, "favorite_count": 0, "accepted_answer_id": 36193498, "answer_count": 1, "score": 4, "last_activity_date": 1568122326, "creation_date": 1458767302, "last_edit_date": 1568122326, "question_id": 36188706, "link": "https://stackoverflow.com/questions/36188706/separate-where-in-query", "title": "Separate where in query", "body": "<p>I need to separate <code>where</code> to validates values with conditional, Example</p>\n\n<pre><code>email := \"test@test.com\"\nif email != \"\" {\n  db.Where(\"users.email LIKE ?\", \"%\"+email+\"%\")\n}\ndb.Where(\"users.name like ?\", \"%\"+jhon+\"%\").Find(&amp;users)\n</code></pre>\n\n<p>That returns two queries:</p>\n\n<p>1: <code>SELECT \"users\".* FROM \"users\" WHERE users.email LIKE '%test@test.com%'</code></p>\n\n<p>2: <code>SELECT \"users\".* FROM \"users\" WHERE users.name LIKE '%jhon%'</code></p>\n\n<p>but I need the result in only one query:</p>\n\n<pre><code> SELECT \"users\".* FROM \"users\" WHERE users.email LIKE '%test@test.com%' and users.name LIKE '%jhon%'\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": true, "score": 3, "last_activity_date": 1458787094, "last_edit_date": 1458787094, "creation_date": 1458769581, "answer_id": 36189294, "question_id": 36188649, "link": "https://stackoverflow.com/questions/36188649/cgo-char-to-slice-string/36189294#36189294", "title": "cgo **char to slice string", "body": "<p>Cobbled together from the cgo wiki: <a href=\"https://github.com/golang/go/wiki/cgo#Turning_C_arrays_into_Go_slices\" rel=\"nofollow\">https://github.com/golang/go/wiki/cgo#Turning_C_arrays_into_Go_slices</a>.</p>\n\n<pre><code>import \"C\"\nimport \"unsafe\"\n\nfunc GoStrings(argc C.int, argv **C.char) []string {\n\n    length := int(argc)\n    tmpslice := (*[1 &lt;&lt; 30]*C.char)(unsafe.Pointer(argv))[:length:length]\n    gostrings := make([]string, length)\n    for i, s := range tmpslice {\n        gostrings[i] = C.GoString(s)\n    }\n    return gostrings\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4870525, "user_type": "registered", "profile_image": "https://graph.facebook.com/805695979508785/picture?type=large", "display_name": "Kazuhiko Yamashita", "link": "https://stackoverflow.com/users/4870525/kazuhiko-yamashita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3336, "favorite_count": 0, "accepted_answer_id": 36189294, "answer_count": 1, "score": 3, "last_activity_date": 1502951384, "creation_date": 1458767039, "question_id": 36188649, "link": "https://stackoverflow.com/questions/36188649/cgo-char-to-slice-string", "title": "cgo **char to slice string", "body": "<p>I have developed a pam module using the cgo.\ncan not be converted to []string a ** char</p>\n\n<p><code>\nfunc pam_sm_authenticate(pamh *C.pam_handle_t, flags C.int, argc C.int, argv **C.char) int {\n        fmt.Println(C.GoString(*argv[0]))\n        return 0\n}\n</code></p>\n\n<p>error is</p>\n\n<p><code>\ninvalid operation: argv[0] (type **C.char does not support indexing)\n</code></p>\n\n<p>Please let me know if you know.</p>\n"}, {"tags": ["http", "authentication", "go", "basic-authentication"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458784463, "post_id": 36187853, "comment_id": 60018601, "body": "<a href=\"https://github.com/goji/httpauth\" rel=\"nofollow noreferrer\">github.com/goji/httpauth</a> will allow you to set a user/pass and prompt. Note that basic auth is in plain text when not over HTTPS, and is not especially secure."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 6, "last_activity_date": 1458765310, "creation_date": 1458765310, "answer_id": 36188200, "question_id": 36187853, "link": "https://stackoverflow.com/questions/36187853/http-basic-auth-with-golang/36188200#36188200", "title": "HTTP Basic Auth with Golang", "body": "<p>In order to force a user to authenticate/make that basic auth prompt in the users browser appear you send the header <code>WWW-Authenticate : Basic ream=\"mydomain\"</code></p>\n\n<p>So if you have a <code>http.ResponseWriter</code> called <code>w</code>, you can do </p>\n\n<pre><code> w.Header().Set(\"WWW-Authenticate\", `Basic realm=\"mydomain\"`)\n</code></pre>\n\n<p>Which will cause the browser to open the prompt you're referring to.</p>\n"}, {"tags": [], "owner": {"reputation": 9576, "user_id": 866021, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jYLJl.jpg?s=128&g=1", "display_name": "Adil B", "link": "https://stackoverflow.com/users/866021/adil-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1527695163, "creation_date": 1527695163, "answer_id": 50608830, "question_id": 36187853, "link": "https://stackoverflow.com/questions/36187853/http-basic-auth-with-golang/50608830#50608830", "title": "HTTP Basic Auth with Golang", "body": "<p>You could also use <a href=\"https://echo.labstack.com/\" rel=\"nofollow noreferrer\">Echo's labstack project</a>, which provides Basic Auth middleware:</p>\n\n<pre><code>e.Use(middleware.BasicAuth(func(username, password string, c echo.Context) (bool, error) {\n    // check username and password for a match here\n}))\n</code></pre>\n\n<p>Use the code above to protect any route groups with basic authentication.</p>\n"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3887, "favorite_count": 0, "accepted_answer_id": 36188200, "answer_count": 2, "score": 2, "last_activity_date": 1527695163, "creation_date": 1458764008, "question_id": 36187853, "link": "https://stackoverflow.com/questions/36187853/http-basic-auth-with-golang", "title": "HTTP Basic Auth with Golang", "body": "<p>How do I implement basic auth with a Golang site? So that when someone visits a page they will be prompted by their <strong>browser</strong> with a login. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1458760973, "creation_date": 1458760973, "answer_id": 36186964, "question_id": 36186808, "link": "https://stackoverflow.com/questions/36186808/golang-variable-struct-field/36186964#36186964", "title": "Golang variable struct field", "body": "<p>Your loop stuff doesn't make a whole lot of sense to me so I'll give a general example with a single field in a string called <code>field</code>. If you have a slice or array of fields you want to check for then you'll want to range over that using the current value for <code>field</code>.</p>\n\n<pre><code>import \"reflect\"\n\nst := reflect.TypeOf(EmailTemplate)\nv, ok := st.FieldByName(field)\nif ok {\n    // field existed on EmailTemplate, now check if it's nil\n    if v.IsNil() {\n        // the field field on instance EmailTemplate was nil, do something\n    }\n}\n</code></pre>\n\n<p>Now assuming you have a list of fields you need to check are all non-nil, then just add a loop like so;</p>\n\n<pre><code>for field := range requiredFields {\n    st := reflect.TypeOf(EmailTemplate)\n    v, ok := st.FieldByName(field)\n    if ok {\n        // field existed on EmailTemplate, now check if it's nil\n        if v.IsNil() {\n          // the field field on instance EmailTemplate was nil, do something\n          // maybe raise error since the field was nil\n    } else {\n        //the field wasn't found at all, probably time to raise an error\n    }\n  }\n}\n</code></pre>\n\n<p>reflect package docs are here; <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\">https://golang.org/pkg/reflect/</a></p>\n"}], "owner": {"reputation": 2559, "user_id": 244152, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/09c67b0c43a6f06f72935bd896188965?s=128&d=identicon&r=PG", "display_name": "CogitoErgoSum", "link": "https://stackoverflow.com/users/244152/cogitoergosum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1539, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458760973, "creation_date": 1458760431, "question_id": 36186808, "link": "https://stackoverflow.com/questions/36186808/golang-variable-struct-field", "title": "Golang variable struct field", "body": "<p>This may require reflection but I'm not sure. I am trying to loop through an array of required fields in a struct. If any of those fields are nil I want to throw an error essentially. I've got the basic form down but I realized I don't know how in Go to pass a struct field name via a variabel</p>\n\n<p>imagine you have a struct called EmailTemplate and it has a field called template_id</p>\n\n<p>In this case I want to know if EmailTemplate.TemplateId is nil</p>\n\n<p>emailDef.Fields is a string array [\"TemplateId\"]</p>\n\n<p>I want to check if those fields are in the EmailTemplate struct and if they are nil</p>\n\n<pre><code>    for field := range emailDef.Fields {\n        fmt.Println(emailDef.Fields[field])\n        if EmailTemplate.[emailDef.Fields[field]] == nil {\n            missingField := true\n        }         \n    }\n</code></pre>\n\n<p>is along the lines of what I am thinking but I know that is wrong as a struct isn't an array. emailDef.Fields[field] would be equivalent to TemplateId</p>\n"}, {"tags": ["go", "gorilla", "mux"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1458764289, "creation_date": 1458764289, "answer_id": 36187932, "question_id": 36185591, "link": "https://stackoverflow.com/questions/36185591/how-to-get-or-pattern-in-gorilla-mux-routing/36187932#36187932", "title": "How to get OR pattern in Gorilla mux routing", "body": "<p>I think it's because of parenthesis which denote capturing group and yield submatch. It can interfere with gorilla matcher. Just try without parenthesis.</p>\n\n<pre><code>router.HandleFunc(\"/{adapter:s3|onedrive}/{schema:[a-z]+}/check\",\n</code></pre>\n"}], "owner": {"reputation": 6304, "user_id": 390722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/64fc18734e843f8bb227765cb1b62137?s=128&d=identicon&r=PG&f=1", "display_name": "StartupGuy", "link": "https://stackoverflow.com/users/390722/startupguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 36187932, "answer_count": 1, "score": 0, "last_activity_date": 1458764289, "creation_date": 1458756434, "question_id": 36185591, "link": "https://stackoverflow.com/questions/36185591/how-to-get-or-pattern-in-gorilla-mux-routing", "title": "How to get OR pattern in Gorilla mux routing", "body": "<p>I'm trying to use Gorilla mux router to handle paths that respond to a limited list of strings in the URL. The service I am developing will take files from the caller and pass them through an \"adapter\" that send them to S3 or OneDrive, depending on the \"adapter\" specified in the URL. I also require a variable named \"schema\", which I only mention now because of the weirdness that follows. My test is as follows ({schema} will be set to \"test\"):</p>\n\n<pre><code>router.HandleFunc(\"/{adapter:(s3|onedrive)}/{schema:[a-z]+}/check\",\nfunc(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(fmt.Sprintf(`{\"a\":\"%s\",\"s\":\"%s\"}`,\n        mux.Vars(r)[\"adapter\"], mux.Vars(r)[\"schema\"])))\n}).Methods(\"GET\")\n</code></pre>\n\n<p>I would expect that going to <code>/s3/test/check</code> would yield <code>{\"a\":\"s3\",\"s\":\"test\"}</code> just as going to <code>/onedrive/test/check</code> should yield <code>{\"a\":\"onedrive\",\"s\":\"test\"}</code> ... however in these cases I am getting <code>{\"a\":\"s3\",\"s\":\"s3\"}</code> and <code>{\"a\":\"onedrive\",\"s\":\"onedrive\"}</code> respectively.</p>\n\n<p>The <code>(s3|onedrive)</code> check seems to be enforced because, for example, trying to go to <code>/dropbox/test/check</code> correctly yields a 404.</p>\n\n<p>Why is the <code>{schema}</code> variable getting the value of the <code>{adapter}</code> variable and how can I fix this?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "edited": false, "score": 0, "creation_date": 1458798694, "post_id": 36188130, "comment_id": 60022044, "body": "Ugh.. thanks again!! Though I hoped there is a more beautiful / idiomatic way to do this task"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1458765707, "last_edit_date": 1495540810, "creation_date": 1458765053, "answer_id": 36188130, "question_id": 36184701, "link": "https://stackoverflow.com/questions/36184701/initializing-go-appengine-app-with-cloud-datastore/36188130#36188130", "title": "Initializing Go AppEngine app with Cloud Datastore", "body": "<h2>Using static files</h2>\n\n<p>On AppEngine you don't have access to the file system of the host operating system, but you can access files of your web application (you have read-only permission, you can't change them and you can't create new files in the app's folder).</p>\n\n<p>So the question is: can your application's code change the data that you want to read and use for initialization? Or is it fine if it is deployed \"statically\" with your app's code?</p>\n\n<p>If you don't need to change it (or only when you redeploy your app), easiest is to store it as a \"static\" file as part of your webapp. You may refer to files of your app using relative paths, where the current or working directory is your app's root. E.g. if your app contains a <code>data</code> folder in its root (where <code>app.yaml</code> resides), and there is an <code>init_values.txt</code> file inside the <code>data</code> folder, you can refer to it with the path: <code>data/init_values.txt</code>.</p>\n\n<p>One important note: not every file is readable by code, this depends on the app configuration. Quoting from <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Static_file_handlers\" rel=\"nofollow noreferrer\">Configuring with app.yaml / Static file handlers</a>:</p>\n\n<blockquote>\n  <p>If you have data files that need to be read by the application code, the data files must be application files, and must not be matched by a static file pattern.</p>\n</blockquote>\n\n<h2>Using the Datastore</h2>\n\n<p>You can't use AppEngine services that require a <code>Context</code> outside of handlers (because the creation of a <code>Context</code> requires an <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>*http.Request</code></a> value). This by nature means you can't use them in package <code>init()</code> functions either.<br>\n<sub>Note that you can use them from cron jobs and tasks added to task queues, because tasks and cron jobs are executed by issuing HTTP GET requests.</sub></p>\n\n<p>You have to restructure your code so that your initialization (e.g. reading from the Datastore) gets called from a handler.</p>\n\n<p>Example of achieving this with <a href=\"https://golang.org/pkg/sync/#Once.Do\" rel=\"nofollow noreferrer\"><code>Once.Do()</code></a>:</p>\n\n<pre><code>var once = sync.Once{}\n\nfunc MainHandler(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n    once.Do(func() { mysetup(ctx) })\n    // do your regular stuff here\n}\n\nfunc mysetup(ctx appengine.Context) {\n    // This function is executed only once.\n    // Read from Datastore and initialize your vars here.\n}\n</code></pre>\n\n<h3>\"Utilizing\" warmup requests</h3>\n\n<p>Yes, this may cause first requests to take considerably longer to serve. For this purpose (to avoid this) I recommend you to utilize <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Warmup_requests\" rel=\"nofollow noreferrer\">Warmup requests</a>. A warmup request is issued to a new instance before it goes \"live\", before it starts serving user requests. In your <code>app.yaml</code> config file you can enable warmup requests by adding <code>-warmup</code> to the <code>inbound_services</code> directive:</p>\n\n<pre><code>inbound_services:\n  - warmup\n</code></pre>\n\n<p>This will cause the App Engine infrastructure to first issue a <code>GET</code> request to <code>/_ah/warmup</code>. You can register a handler to this URL and perform initialization tasks. As with any other request, you will have an <code>http.Request</code> in the warmup handler.</p>\n\n<p>But please note that:</p>\n\n<blockquote>\n  <p>..you may encounter <a href=\"https://cloud.google.com/appengine/docs/adminconsole/instances#Loading_Requests\" rel=\"nofollow noreferrer\">loading requests</a>, even if warmup requests are enabled in your app.</p>\n</blockquote>\n\n<p>Which means that in rare cases it may happen a new instance will not receive a warmup request, so its best to check initialization state in user handlers too.</p>\n\n<hr>\n\n<p>Related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/34629056/how-do-i-store-the-private-key-of-my-server-in-google-app-engine\">How do I store the private key of my server in google app engine?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/29912318/fetching-a-url-from-the-init-func-in-go-on-appengine\">Fetching a URL From the init() func in Go on AppEngine</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/33336850/environment-variables-specified-on-app-yaml-but-its-not-fetching-on-main-go\">Environment variables specified on app.yaml but it&#39;s not fetching on main.go</a></p>\n"}], "owner": {"reputation": 227, "user_id": 4045078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/375906045c619617cf26aa3378b6ac62?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis S", "link": "https://stackoverflow.com/users/4045078/dennis-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "accepted_answer_id": 36188130, "answer_count": 1, "score": 1, "last_activity_date": 1474760615, "creation_date": 1458753580, "last_edit_date": 1474760615, "question_id": 36184701, "link": "https://stackoverflow.com/questions/36184701/initializing-go-appengine-app-with-cloud-datastore", "title": "Initializing Go AppEngine app with Cloud Datastore", "body": "<p>in init() function for GAE's golang app, how can I set-up initial values for my application ?</p>\n\n<p>How to read from Cloud Datastore in the init() function or immediately after applications start-up ? As I understand, server cannot write to the local filesystem and Cloud Datastore is the only option ?</p>\n\n<p>I need some global variables and slices of data..</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 0, "creation_date": 1458766690, "post_id": 36185431, "comment_id": 60012404, "body": "Is there a way to set the environment variable from the command line instead of in app.yml? Otherwise there&#39;s not really a good way to know if my app is running in project &#39;myapp-prod&#39; or &#39;myapp-staging&#39;"}, {"owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 0, "creation_date": 1458770459, "post_id": 36185431, "comment_id": 60014178, "body": "Noting here that <code>appcfg.py</code> offers the following argument options: -E NAME:VALUE, --env_variable=NAME:VALUE                         Set an environment variable, potentially overriding an                         env_variable value from app.yaml file (flag may be                         repeated to set multiple variables)."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 1, "last_activity_date": 1458756241, "last_edit_date": 1458756241, "creation_date": 1458755915, "answer_id": 36185431, "question_id": 36184603, "link": "https://stackoverflow.com/questions/36184603/how-to-set-variables-based-on-project-id/36185431#36185431", "title": "How to set variables based on project id?", "body": "<p>Use an <a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Defining_environment_variables\" rel=\"nofollow\">environment variable</a> describing whether your app is on production or staging. Add to <code>app.yml</code>,</p>\n\n<pre><code>env_variables:\n  ENVIRONMENT: 'production'\n</code></pre>\n\n<p>In your code,</p>\n\n<pre><code>import \"os\"\n\nif v := os.Getenv(\"ENVIRONMENT\"); v == \"production\" {\n  // You're in production\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 0, "creation_date": 1458766793, "post_id": 36187894, "comment_id": 60012455, "body": "Thanks Ill try AppID(). IsDevAppServer() wont work in this case because im trying to differentiate running on different projects <code>myapp-prod</code> and <code>myapp-staging</code> neither of which are running in dev model."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 0, "creation_date": 1458766975, "post_id": 36187894, "comment_id": 60012534, "body": "@sthomps Yeah, I know, I mentioned it because it is relevant and might be useful for someone else."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1458766885, "last_edit_date": 1458766885, "creation_date": 1458764151, "answer_id": 36187894, "question_id": 36184603, "link": "https://stackoverflow.com/questions/36184603/how-to-set-variables-based-on-project-id/36187894#36187894", "title": "How to set variables based on project id?", "body": "<p>You can use the <code>appengine.AppID()</code> function to get the name/id of your application:</p>\n\n<pre><code>// AppID returns the application ID for the current application.\n// The string will be a plain application ID (e.g. \"appid\"), with a\n// domain prefix for custom domain deployments (e.g. \"example.com:appid\"). \nfunc AppID(c Context) string\n</code></pre>\n\n<p>And you can use <code>appengine.IsDevAppServer()</code> to tell if your app is running in development mode (using the AppEngine SDK) or live (in production):</p>\n\n<pre><code>// IsDevAppServer reports whether the App Engine app is running in the\n// development App Server. \nfunc IsDevAppServer() bool\n</code></pre>\n\n<p>Alternatively you can also use <code>appengine.ServerSoftware()</code> which contains both of the information above, merged into one string:</p>\n\n<pre><code>// ServerSoftware returns the App Engine release version.\n// In production, it looks like \"Google App Engine/X.Y.Z\".\n// In the development appserver, it looks like \"Development/X.Y\". \nfunc ServerSoftware() string\n</code></pre>\n"}], "owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 36185431, "answer_count": 2, "score": 1, "last_activity_date": 1458766885, "creation_date": 1458753269, "question_id": 36184603, "link": "https://stackoverflow.com/questions/36184603/how-to-set-variables-based-on-project-id", "title": "How to set variables based on project id?", "body": "<p>I currently have an App Engine Go app with 2 projects: <code>myapp-prod</code> and <code>myapp-staging</code>.</p>\n\n<p>I'd like to be able to set the value of certain variables depending if the app is running in prod or staging. </p>\n\n<p>Is there a way for the app to detect which environment it is running in?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 3897701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f5fb47fb9a9d75a1a3dc3f5ba664f9?s=128&d=identicon&r=PG&f=1", "display_name": "BlueSpaceCanary", "link": "https://stackoverflow.com/users/3897701/bluespacecanary"}, "reply_to_user": {"reputation": 131, "user_id": 5084409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dS_scu24-JQ/AAAAAAAAAAI/AAAAAAAADAU/rgt0YIkd5XA/photo.jpg?sz=128", "display_name": "Rolando Toledo Fernandez", "link": "https://stackoverflow.com/users/5084409/rolando-toledo-fernandez"}, "edited": false, "score": 0, "creation_date": 1458828206, "post_id": 36184524, "comment_id": 60037434, "body": "Oh, I missed that you set allow_aliasing. Hm."}], "tags": [], "owner": {"reputation": 371, "user_id": 3897701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47f5fb47fb9a9d75a1a3dc3f5ba664f9?s=128&d=identicon&r=PG&f=1", "display_name": "BlueSpaceCanary", "link": "https://stackoverflow.com/users/3897701/bluespacecanary"}, "is_accepted": false, "score": 1, "last_activity_date": 1458753012, "creation_date": 1458753012, "answer_id": 36184524, "question_id": 36182638, "link": "https://stackoverflow.com/questions/36182638/protocol-buffer-use-enum/36184524#36184524", "title": "Protocol Buffer use enum", "body": "<p>The answer you're looking for is in the error message :) it's just a bit hard to parse out what it's actually telling you. </p>\n\n<p>Basically, what </p>\n\n<blockquote>\n  <p>enum values are siblings of their type, not children of it </p>\n</blockquote>\n\n<p>means is that, rather than the enum values being scoped as <code>MyEnum.FOO</code> and <code>MyEnum2.FOO</code>, they are scoped <strong>at the same level as MyEnum</strong>. So two enum values in the same .proto file <strong>cannot</strong> have the same name; they're both trying to exist as <code>FOO</code> within that file, rather than being <code>MyEnum.FOO</code> and <code>MyEnum2.FOO</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 5084409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dS_scu24-JQ/AAAAAAAAAAI/AAAAAAAADAU/rgt0YIkd5XA/photo.jpg?sz=128", "display_name": "Rolando Toledo Fernandez", "link": "https://stackoverflow.com/users/5084409/rolando-toledo-fernandez"}, "is_accepted": false, "score": 0, "last_activity_date": 1458811293, "creation_date": 1458811293, "answer_id": 36196727, "question_id": 36182638, "link": "https://stackoverflow.com/questions/36182638/protocol-buffer-use-enum/36196727#36196727", "title": "Protocol Buffer use enum", "body": "<p>I don' t understand your point because I have 2 enums with digfferent name the first is EnumAllowingAlias and the secund is EnumNotAllowingAlias this is the example in </p>\n\n<blockquote>\n  <p><a href=\"https://developers.google.com/protocol-buffers/docs/proto#enum\" rel=\"nofollow\">https://developers.google.com/protocol-buffers/docs/proto#enum</a></p>\n</blockquote>\n\n<p>and before the example they explain </p>\n\n<blockquote>\n  <p>\"You can define aliases by assigning the same value to different enum constants. To do this you need to set the allow_alias option to\n  true, otherwise protocol compiler will generate an error message when\n  aliases are found.\"</p>\n</blockquote>\n\n<p>In this case I can create 2 enums like these and the compiler should be create tow enums first using alias and the second without alias but instead of that the compiler sent me the error in the first answer.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 6785034, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SBPOsCpMWYI/AAAAAAAAAAI/AAAAAAAABaQ/y-hjAjCPJMY/photo.jpg?sz=128", "display_name": "jackic23", "link": "https://stackoverflow.com/users/6785034/jackic23"}, "edited": false, "score": 0, "creation_date": 1576792937, "post_id": 51715911, "comment_id": 105022192, "body": "I just want to add a comment here about how bad the user experience is for Go. Need to work around this limitation? No problem, just prefix them like this <code>ENUMALLOWINGALIAS_UNKNOWN</code> right? FYI, the Go compiler tries to be &quot;helpful&quot; to you by prefixing the enumerators for you; which is usually great. Except now in this case your constant is defined as <code>&lt;package_name&gt;.EnumAllowingAlias_ENUMALLOWINGALIAS_UNKNOWN</code> (insert facepalm here)"}], "tags": [], "owner": {"reputation": 31, "user_id": 4910126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5adea49573953fcedb7a3fb6485af4fa?s=128&d=identicon&r=PG&f=1", "display_name": "mahdt", "link": "https://stackoverflow.com/users/4910126/mahdt"}, "is_accepted": false, "score": 2, "last_activity_date": 1533591052, "creation_date": 1533591052, "answer_id": 51715911, "question_id": 36182638, "link": "https://stackoverflow.com/questions/36182638/protocol-buffer-use-enum/51715911#51715911", "title": "Protocol Buffer use enum", "body": "<p>allow_alias allows you to have <strong>two different names</strong> for the same value.</p>\n\n<p>However, it still <strong>doesn't</strong> allow you to use the <strong>same name</strong> twice!</p>\n\n<p>In the example you took from the docs, they are just trying to demonstrate how you can use STARTED = 1 and RUNNING = 1 in the same enum type by setting allow_alias to be true. The two enums example they gave are not meant to be used in the same package.</p>\n\n<p>But if you already have RUNNING in EnumAllowingAlias, you cannot use RUNNING again in EnumNotAllowingAlias if they are in the same package.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 8562476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6811a315e8d68bf62c72d0397b1be44d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/8562476/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1544503322, "last_edit_date": 1544503322, "creation_date": 1543981161, "answer_id": 53624827, "question_id": 36182638, "link": "https://stackoverflow.com/questions/36182638/protocol-buffer-use-enum/53624827#53624827", "title": "Protocol Buffer use enum", "body": "<p>EnumAllowingAlias and EnumNotAllowingAlias can't be defined in the same proto file, they are just two examples for understanding the usage of allow_alias.</p>\n\n<p>allow_alias only work in the same enum, as mahdt said, allow_alias allows you to have two different names for the same value in a enum, the EnumAllowingAlias is the example for this case:</p>\n\n<pre><code>enum EnumAllowingAlias {\n  option allow_alias = true;\n  UNKNOWN = 0;\n  STARTED = 1;\n  RUNNING = 1;\n}\n</code></pre>\n\n<p>If allow_alias is not set to true, the the EnumNotAllowingAlias will get an error:</p>\n\n<pre><code>enum EnumNotAllowingAlias {\n  UNKNOWN = 0;\n  STARTED = 1;\n  RUNNING = 1;  // Uncommenting this line will cause a compile error inside Google and a warning message outside.\n}\n</code></pre>\n\n<p>Enum usage don't have this limit in Java, I think it is really confusing for most developers, so I raised a bug report:\n<a href=\"https://github.com/protocolbuffers/protobuf/issues/5425\" rel=\"nofollow noreferrer\">https://github.com/protocolbuffers/protobuf/issues/5425</a></p>\n"}], "owner": {"reputation": 131, "user_id": 5084409, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dS_scu24-JQ/AAAAAAAAAAI/AAAAAAAADAU/rgt0YIkd5XA/photo.jpg?sz=128", "display_name": "Rolando Toledo Fernandez", "link": "https://stackoverflow.com/users/5084409/rolando-toledo-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5518, "favorite_count": 0, "answer_count": 4, "score": 4, "last_activity_date": 1577253000, "creation_date": 1458747802, "last_edit_date": 1577253000, "question_id": 36182638, "link": "https://stackoverflow.com/questions/36182638/protocol-buffer-use-enum", "title": "Protocol Buffer use enum", "body": "<p>Hello I'm working with protobuf but I have a problem. </p>\n\n<p>I have some enum functions but in tow of these I have the same alias, when I try to compile the file for some language \"go\" the compiler return an error. </p>\n\n<p>I copied the example in protobuf documentation to define the enum and still not working.</p>\n\n<pre><code>enum EnumAllowingAlias {\n  option allow_alias = true;\n  UNKNOWN = 0;\n  STARTED = 1;\n  RUNNING = 1;\n}\nenum EnumNotAllowingAlias {\n  UNKNOWN = 0;\n  STARTED = 1;\n  // RUNNING = 1;  // Uncommenting this line will cause a compile error inside Google and a warning message outside.\n}\n</code></pre>\n\n<p>This is the google documentation said if you need to use the same alias in some different enums you need to add the option \"option allow_alias = true;\" in the enum but after try to compile the .proto file the compiler response.</p>\n\n<blockquote>\n  <p>example.proto:13:5: \"UNKNOWN\" is already defined in \"namespace\".<br>\n  example.proto:13:5: Note that enum values use C++ scoping rules, meaning that enum values are siblings of their type, not children of it.<br>\n  Therefore, \"UNKNOWN\" must be unique within \"kluso\", not just within \"EnumNotAllowingAlias\".  </p>\n  \n  <p>example.proto:14:5: \"STARTED\" is already defined in \"namespace\".<br>\n  example.proto:14:5: Note that enum values use C++ scoping rules,\n  meaning that enum values are siblings of their type, not children of\n  it.<br>\n  Therefore, \"STARTED\" must be unique within \"kluso\", not just within \"EnumNotAllowingAlias\".</p>\n</blockquote>\n\n<p>I don't know what's happen. Someone know what is the problem?</p>\n"}, {"tags": ["go", "neo4j", "neoism"], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "edited": false, "score": 0, "creation_date": 1458897290, "post_id": 36203135, "comment_id": 60066019, "body": "Thanks for your response. I ended up doing just that - creating a cypher statement and running it via neoism.query."}], "tags": [], "owner": {"reputation": 36, "user_id": 352170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b17424b6bb180dce4a2949f31a18d958?s=128&d=identicon&r=PG", "display_name": "erezny", "link": "https://stackoverflow.com/users/352170/erezny"}, "is_accepted": true, "score": 1, "last_activity_date": 1458831162, "creation_date": 1458831162, "answer_id": 36203135, "question_id": 36181929, "link": "https://stackoverflow.com/questions/36181929/neoism-relate-if-relationship-doesnt-exist/36203135#36203135", "title": "Neoism relate if relationship doesn&#39;t exist", "body": "<p>There is not a native function or REST endpoint for creating unique directed relationships. You might assign a unique property value to each relationship and add a unique index on the relationship property, or you might use a cypher query and the CREATE UNIQUE clause. </p>\n\n<p><a href=\"http://neo4j.com/docs/stable/query-create-unique.html#_create_unique_relationships\" rel=\"nofollow\">http://neo4j.com/docs/stable/query-create-unique.html#_create_unique_relationships</a></p>\n"}, {"tags": [], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "is_accepted": false, "score": 1, "last_activity_date": 1472477188, "creation_date": 1472477188, "answer_id": 39207478, "question_id": 36181929, "link": "https://stackoverflow.com/questions/36181929/neoism-relate-if-relationship-doesnt-exist/39207478#39207478", "title": "Neoism relate if relationship doesn&#39;t exist", "body": "<p>You can use the following function which I am using for my code. It has an external dependency at </p>\n\n<blockquote>\n  <p><strong>github.com/imdario/mergo</strong></p>\n</blockquote>\n\n<p>And the following generic function will work for any kind of node and relationships.</p>\n\n<pre><code> func GetOrCreateRelationship(from *neoism.Node, to *neoism.Node, relType string, props neoism.Props) (relationship *neoism.Relationship) {\nrelationships, err := from.Relationships(relType)\n\nif err == nil {\n    for _, relationship := range relationships {\n        endNode, err := relationship.End()\n\n        if err != nil {\n            continue\n        }\n\n        if endNode.Id() == to.Id() {\n            newProps, err := relationship.Properties()\n\n            if err != nil {\n                return relationship\n            }\n\n            if err := mergo.Merge(&amp;newProps, props); err != nil {\n                relationship.SetProperties(newProps)\n            }\n\n            return relationship\n        }\n    }\n}\n\nrelationship, err = from.Relate(relType, to.Id(), props)\n\nif err != nil {\n    log.Printf(\"Cannot create relationship: %s\", err)\n}\n\nreturn\n}\n</code></pre>\n"}], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36203135, "answer_count": 2, "score": 0, "last_activity_date": 1472477188, "creation_date": 1458745988, "question_id": 36181929, "link": "https://stackoverflow.com/questions/36181929/neoism-relate-if-relationship-doesnt-exist", "title": "Neoism relate if relationship doesn&#39;t exist", "body": "<p>I've only just started using neoism and enjoying it so far. I've hit a bit of a problem and wondered if it my naivety of neoism or neoism itself that's at fault.</p>\n\n<p>I've got a line in my go code:</p>\n\n<pre><code>agent.Relate(relation, node.Id() , neoism.Props{})\n</code></pre>\n\n<p>The issue is that if I run it more than once it will duplicate the relationship. Is there a way to create only if the relationship doesn't already exist - something similar to the GetOrCreateNodeFunction. </p>\n\n<p>Or will I have to write some raw cql to check if the relationship already exists before running the statement above?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 2, "creation_date": 1458743506, "post_id": 36180852, "comment_id": 59997065, "body": "You should try on your own and ask specific question when you are facing concrete problems. Nobody here has time to write your code."}, {"owner": {"reputation": 674, "user_id": 866376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1175553f0c746b7a2711465792aefe42?s=128&d=identicon&r=PG", "display_name": "Mitchell Ingram", "link": "https://stackoverflow.com/users/866376/mitchell-ingram"}, "reply_to_user": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1458743557, "post_id": 36180852, "comment_id": 59997116, "body": "I was curious if there was a library for it. Seems like image decimation is a common language problem."}, {"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1458743879, "post_id": 36180852, "comment_id": 59997379, "body": "You might take a look at <a href=\"https://github.com/nfnt/resize\" rel=\"nofollow noreferrer\">github.com/nfnt/resize</a>"}, {"owner": {"reputation": 674, "user_id": 866376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1175553f0c746b7a2711465792aefe42?s=128&d=identicon&r=PG", "display_name": "Mitchell Ingram", "link": "https://stackoverflow.com/users/866376/mitchell-ingram"}, "reply_to_user": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1458743963, "post_id": 36180852, "comment_id": 59997456, "body": "I can definitely run with that, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "is_accepted": false, "score": 1, "last_activity_date": 1458744376, "creation_date": 1458744376, "answer_id": 36181334, "question_id": 36180852, "link": "https://stackoverflow.com/questions/36180852/how-to-perform-image-decimation-for-map-tiler/36181334#36181334", "title": "How to perform image decimation for map tiler?", "body": "<p>Take a look at <a href=\"https://github.com/nfnt/resize\" rel=\"nofollow\">nfnt/resize</a>. It is a library for image resizing (but Google would have told you the same):</p>\n\n<pre><code>func main() {\n    // open \"test.jpg\"\n    file, err := os.Open(\"test.jpg\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // decode jpeg into image.Image\n    img, err := jpeg.Decode(file)\n    if err != nil {\n        log.Fatal(err)\n    }\n    file.Close()\n\n    // resize to width 1000 using Lanczos resampling\n    // and preserve aspect ratio\n    m := resize.Resize(1000, 0, img, resize.Lanczos3)\n\n    out, err := os.Create(\"test_resized.jpg\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer out.Close()\n\n    // write new image to file\n    jpeg.Encode(out, m, nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 674, "user_id": 866376, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1175553f0c746b7a2711465792aefe42?s=128&d=identicon&r=PG", "display_name": "Mitchell Ingram", "link": "https://stackoverflow.com/users/866376/mitchell-ingram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1459716163, "answer_count": 1, "score": -1, "last_activity_date": 1458744376, "creation_date": 1458743065, "question_id": 36180852, "link": "https://stackoverflow.com/questions/36180852/how-to-perform-image-decimation-for-map-tiler", "closed_reason": "Not suitable for this site", "title": "How to perform image decimation for map tiler?", "body": "<p>I am writing a map tiler for zoom levels 18-1 from big images. I need to downsample the image so that a pixel at zoom level 17 is 4 pixels at 18, 18 being the native resolution all tiles being 256x256. How would I do this in Go?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 5556, "user_id": 1393225, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MGcyh.png?s=128&g=1", "display_name": "Vnuuk", "link": "https://stackoverflow.com/users/1393225/vnuuk"}, "edited": false, "score": 0, "creation_date": 1458743973, "post_id": 36180928, "comment_id": 59997471, "body": "@Vnuuk it works for me. could be that your terminal is not using \\n but \\r\\n. Which is why the second approach of trimming would work better, because it will be portable"}, {"owner": {"reputation": 5556, "user_id": 1393225, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MGcyh.png?s=128&g=1", "display_name": "Vnuuk", "link": "https://stackoverflow.com/users/1393225/vnuuk"}, "edited": false, "score": 0, "creation_date": 1458744323, "post_id": 36180928, "comment_id": 59997775, "body": "Works, thanks! By the way - I&#39;m useing Windows terminal"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1458744081, "last_edit_date": 1458744081, "creation_date": 1458743282, "answer_id": 36180928, "question_id": 36180836, "link": "https://stackoverflow.com/questions/36180836/golang-doesnt-process-2-operations/36180928#36180928", "title": "Golang doesn&#39;t process 2 operations", "body": "<p>from TFM:</p>\n\n<blockquote>\n  <p>ReadString reads until the first occurrence of delim in the input, returning a string containing the data up to <strong>and including the delimiter</strong></p>\n</blockquote>\n\n<p>You are comparing the string without the delimiter. </p>\n\n<p>So just doing:</p>\n\n<pre><code>if input == \"q\\n\" {...}\n</code></pre>\n\n<p>would work (BTW no need to call <code>string(input)</code> as input is already a string).</p>\n\n<p>Alternatively you can also trim the endline before checking, using <code>strings.TrimRight</code>. This will make the code more portable as it will work on Windows where <code>\\r\\n</code> is used to delimit lines. So do this:</p>\n\n<pre><code>input = strings.TrimRight(input, \"\\r\\n\")\nif input == \"q\" {\n    fmt.Println(\"OK\")\n}\n</code></pre>\n\n<p>And I've tested this to work myself.</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 2, "last_activity_date": 1458819736, "last_edit_date": 1458819736, "creation_date": 1458744294, "answer_id": 36181304, "question_id": 36180836, "link": "https://stackoverflow.com/questions/36180836/golang-doesnt-process-2-operations/36181304#36181304", "title": "Golang doesn&#39;t process 2 operations", "body": "<p>Not_a_Golfer is correct on why its not working. However, for simple things like reading from STDIN you're better off using Scanner:</p>\n\n<pre><code>func ListApps(){\n    fmt.Printf(\"\\nPress Q to go back..\\n\")\n    reader := bufio.NewScanner(os.Stdin)\n    reader.Scan()  // this line scans the STDIN for input\n\n    // error checking...\n    if err := scanner.Err(); err != nil {\n        panic(err)\n    }\n\n    // To access what the scanner got, you use scanner.Text() (reader.Text() in this case)\n    if reader.Text() == \"q\" {\n        fmt.Printf(\"OK\")\n     }\n }\n</code></pre>\n\n<p>This will work, regardless of where the input is from (windows command prompt, terminal on linux/OSX, etc)</p>\n"}], "owner": {"reputation": 5556, "user_id": 1393225, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/MGcyh.png?s=128&g=1", "display_name": "Vnuuk", "link": "https://stackoverflow.com/users/1393225/vnuuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36180928, "answer_count": 2, "score": -1, "last_activity_date": 1458819736, "creation_date": 1458743024, "question_id": 36180836, "link": "https://stackoverflow.com/questions/36180836/golang-doesnt-process-2-operations", "title": "Golang doesn&#39;t process 2 operations", "body": "<p>I'm a new in golang and i don't understand why I can't get next code working:</p>\n\n<pre><code>func ListApps(){\n    fmt.Printf(\"\\nPress Q to go back..\\n\")\n    reader := bufio.NewReader(os.Stdin)\n    input, _ := reader.ReadString('\\n')\n\n    if string(input) == \"q\" {\n        fmt.Printf(\"OK\")\n     }\n }\n</code></pre>\n\n<p>I want to print a message, then scan user's input in console, compare input and print messafe if imput equals string \"q\". Last check doesn't work for some reasons.</p>\n"}, {"tags": ["go", "rabbitmq", "rabbitmqctl"], "comments": [{"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1458739039, "post_id": 36179111, "comment_id": 59993618, "body": "As far as I can see the connection is only create one time in the linked samples. You should include the respective code in your question."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1458739163, "post_id": 36179111, "comment_id": 59993706, "body": "No, but let&#39;s say i have a http handler which gets called every time you need to push an object in the queue. So, should we create connection on every request to rabbitmq or use only one connection."}], "answers": [{"comments": [{"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459346420, "post_id": 36179544, "comment_id": 60245486, "body": "Could you please elaborate in more detail. I am new to go. So, don&#39;t have much idea. I have edited the question. Could you please point out the error where i am wrong."}, {"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459346859, "post_id": 36179544, "comment_id": 60245872, "body": "Are you re-declaring your topology (create channels, etc.) on reconnect?"}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459347367, "post_id": 36179544, "comment_id": 60246335, "body": "No, I am only re-creating the connection. As you can see in the code. I have pasted in my question"}, {"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459347848, "post_id": 36179544, "comment_id": 60246749, "body": "You need to re-declare the topology after you have established the connection. You can place this in some function which you can call on startup and after reconnects."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459350323, "post_id": 36179544, "comment_id": 60248741, "body": "But i create RabbitMQ channel (not to be confused with go channel) for every request to publish the message. Now how can i re-declare it. Could you please give me the suggestion using code."}, {"owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "reply_to_user": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "edited": false, "score": 0, "creation_date": 1459357047, "post_id": 36179544, "comment_id": 60253606, "body": "I updated my answer. BTW: Your code isn&#39;t working for more than one reconnect because nothing is listening on the channel <code>c</code> after you have called <code>Conn.NotifyClose(c)</code> within the goroutine."}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "edited": false, "score": 0, "creation_date": 1459416266, "post_id": 36179544, "comment_id": 60280758, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/107829/discussion-between-naresh-and-sebastian\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "is_accepted": true, "score": 10, "last_activity_date": 1459356801, "last_edit_date": 1459356801, "creation_date": 1458739709, "answer_id": 36179544, "question_id": 36179111, "link": "https://stackoverflow.com/questions/36179111/whether-to-create-connection-every-time-when-amqp-dial-is-threadsafe-or-not-in-g/36179544#36179544", "title": "Whether to create connection every time when amqp.Dial is threadsafe or not in go lang", "body": "<p>Of course, you shouldn't create a connection for each request. Make it a global variable or better part of an <a href=\"https://elithrar.github.io/article/custom-handlers-avoiding-globals/\" rel=\"noreferrer\">application context</a> which you initialize once at startup.</p>\n\n<p>You can handle connection errors by registering a channel using <code>Connection.NotifyClose</code>:</p>\n\n<pre><code>func initialize() {\n  c := make(chan *amqp.Error)\n  go func() {\n    err := &lt;-c\n    log.Println(\"reconnect: \" + err.Error())\n    initialize()\n  }()\n\n  conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\")\n  if err != nil {\n    panic(\"cannot connect\")\n  }\n  conn.NotifyClose(c)\n\n  // create topology\n}\n</code></pre>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3229, "favorite_count": 2, "accepted_answer_id": 36179544, "answer_count": 1, "score": 5, "last_activity_date": 1459356801, "creation_date": 1458738580, "last_edit_date": 1459346378, "question_id": 36179111, "link": "https://stackoverflow.com/questions/36179111/whether-to-create-connection-every-time-when-amqp-dial-is-threadsafe-or-not-in-g", "title": "Whether to create connection every time when amqp.Dial is threadsafe or not in go lang", "body": "<p>As it is mentioned in the RabbitMQ docs that tcp connections are expensive to make. So, for that concept of channel was introduced. Now i came across this <a href=\"https://www.rabbitmq.com/tutorials/tutorial-four-go.html\" rel=\"noreferrer\">example</a>. In the <code>main()</code> it creates the connection everytime a message is publised. \n<code>conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\")</code>. \nShouldn't it be declared globally once and there should be failover mechanism in case connection get closed like singleton object. If amqp.Dial is  thread-safe, which i suppose it should be </p>\n\n<p><strong>Edited question :</strong></p>\n\n<p>I am handling the connection error in the following manner. In which i listen on a channel and create a new connection on error. But when i kill the existing connection and try to publish message. I get the following error.</p>\n\n<p><strong>error :</strong></p>\n\n<pre><code>2016/03/30 19:20:08 Failed to open a channel: write tcp 172.16.5.48:51085-&gt;172.16.0.20:5672: use of closed network connection\nexit status 1\n7:25 PM\n</code></pre>\n\n<p><strong>Code :</strong></p>\n\n<pre><code> func main() {\n\n        Conn, err := amqp.Dial(\"amqp://guest:guest@172.16.0.20:5672/\")\n        failOnError(err, \"Failed to connect to RabbitMQ\")\n         context := &amp;appContext{queueName: \"QUEUENAME\",exchangeName: \"ExchangeName\",exchangeType: \"direct\",routingKey: \"RoutingKey\",conn: Conn}\n        c := make(chan *amqp.Error)\n\n        go func() {\n            error := &lt;-c\n            if(error != nil){                \n                Conn, err = amqp.Dial(\"amqp://guest:guest@172.16.0.20:5672/\")            \n                failOnError(err, \"Failed to connect to RabbitMQ\")            \n                Conn.NotifyClose(c)                                           \n            }            \n        }()\n\n        Conn.NotifyClose(c)\n        r := web.New()\n        // We pass an instance to our context pointer, and our handler.\n        r.Get(\"/\", appHandler{context, IndexHandler})\n        graceful.ListenAndServe(\":8086\", r)  \n\n    }\n</code></pre>\n"}, {"tags": ["api", "rest", "unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 0, "creation_date": 1458737744, "post_id": 36177614, "comment_id": 59992681, "body": "Why is it not possible to do all the set-up for your tests in an init function?"}, {"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "reply_to_user": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 0, "creation_date": 1458744413, "post_id": 36177614, "comment_id": 59997850, "body": "@Machiel If I have an init function that sets everything up, I need to define global variables for one test file. This implies I cannot define the same variables in another test file. I want to make sure that I am able to run each test separately as well as to run them all at once..."}, {"owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 0, "creation_date": 1458745708, "post_id": 36177614, "comment_id": 59998865, "body": "What exactly do you mean by &#39;test files&#39;? I understand you have a_test.go b_test.go, but that should not be a problem right? If you run one test it sets everything up for one test, otherwise it sets everything up for multiple tests?"}], "answers": [{"comments": [{"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1458744289, "post_id": 36180479, "comment_id": 59997748, "body": "I have tried to pull the <i>init</i> stuff to extra package, but this brings one downside - in order to make the package/file accessible, it has to be without <code>_test</code> name in the package which makes it to be built within the production code (i.e. final executable). This is not really wanted... When I pulled the init code into a <code>_test</code> package, variables set in it&#39;s <code>init()</code> func were not accessible by test files. Neither was <code>SetUpTests()</code> func which I also tried..."}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1458754958, "post_id": 36180479, "comment_id": 60005587, "body": "Sorry.  At least when I build packages, I can control whether they end up in my production code.  If my production code doesn&#39;t import the package, the package is not included.  By package, I mean a go package, so the file(s) for it are in their own directory.  They can&#39;t be in the same directory as the production code files."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1458742032, "creation_date": 1458742032, "answer_id": 36180479, "question_id": 36177614, "link": "https://stackoverflow.com/questions/36177614/go-unit-testing-structured-rest-api-projects/36180479#36180479", "title": "GO Unit testing structured REST API projects", "body": "<p>Perhaps you could put the setup code that you want to use from multiple unit test files into a separate package that only the unit tests use?</p>\n\n<p>Or you could put the setup code into the normal package and just use it from the unit tests.</p>\n\n<p>It's been asked before but the Go authors have chosen not to implicitly supply a test tag that could be used to selectively enable function compiles within the normal package files.</p>\n"}, {"comments": [{"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1458813457, "post_id": 36188366, "comment_id": 60028185, "body": "OK, so having this <code>TestMain</code> and global variables initialized I just rely on them in my handlers tests (ofc. I have one test per handler/endpoint) and it will work? And this <code>os.Exit()</code> will be called after all tests from all packages are done? I need to be able to run the tests with <code>go test .&#47;...</code> because this will be called from build and deploy script."}, {"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1458831042, "post_id": 36188366, "comment_id": 60039480, "body": "I am trying to achieve this with Ginkgo, but unfortunately I am experiencing some problems there as well... <a href=\"http://stackoverflow.com/questions/36202934/running-ginkgo-test-suite-beforesuite-setup-before-any-spec-is-ran\" title=\"running ginkgo test suite beforesuite setup before any spec is ran\">stackoverflow.com/questions/36202934/&hellip;</a>"}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 0, "creation_date": 1458854998, "post_id": 36188366, "comment_id": 60053916, "body": "@shadyyx Yes, you can rely on them in handlers. But keep in mind that global variables are package scoped. If you test multiple packages with <code>go test .&#47;...</code> you&#39;ll need one <code>TestMain</code> per package. And yes, os.Exit() will be called when all tests are done."}, {"owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "edited": false, "score": 1, "creation_date": 1458923341, "post_id": 36188366, "comment_id": 60078866, "body": "Thank you once more. Though I understand this is a valid answer and I&#39;ll accept it, I&#39;ll post mine as well to cover the same functionality with Ginkgo and Gomega that I am finally utilizing :-)"}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": true, "score": 1, "last_activity_date": 1458766307, "last_edit_date": 1458766307, "creation_date": 1458765924, "answer_id": 36188366, "question_id": 36177614, "link": "https://stackoverflow.com/questions/36177614/go-unit-testing-structured-rest-api-projects/36188366#36188366", "title": "GO Unit testing structured REST API projects", "body": "<p>Test packages, not files! </p>\n\n<p>Since you're testing handlers/endpoints it would make sense to put all your <code>_test</code> files in either the handlers or the router package. (e.g. one file per endpoint/handler).</p>\n\n<p>Also, don't use <code>init()</code> to setup your tests. The <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow\"><code>testing</code></a> package specifies a function with the following signature:</p>\n\n<pre><code>func TestMain(m *testing.M) \n</code></pre>\n\n<blockquote>\n  <p>The generated test will call TestMain(m) instead of running the tests\n  directly. TestMain runs in the main goroutine and can do whatever\n  setup and teardown is necessary around a call to m.Run. It should then\n  call os.Exit with the result of m.Run</p>\n</blockquote>\n\n<p>Inside the TestMain function you can do whatever setup you need in order to run your tests. If you have global variables, this is the place to declare and initialize them. You only need to do this once per package, so it makes sense to put the <code>TestMain</code> code in a seperate <code>_test</code> file. For example: </p>\n\n<pre><code>package router\n\nimport (\n    \"testing\"\n    \"net/http/httptest\"\n) \n\nvar (\n    testServer *httptest.Server\n)\n\nfunc TestMain(m *testing.M)  {\n    // setup the test server\n    router := ConfigureRouter()\n    testServer = httptest.NewServer(router)\n\n    // run tests\n    os.Exit(m.Run())\n}\n</code></pre>\n\n<p>Finally run the tests with <code>go test my/package/router</code>.</p>\n"}], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1438, "favorite_count": 1, "accepted_answer_id": 36188366, "answer_count": 2, "score": 1, "last_activity_date": 1458766307, "creation_date": 1458734407, "question_id": 36177614, "link": "https://stackoverflow.com/questions/36177614/go-unit-testing-structured-rest-api-projects", "title": "GO Unit testing structured REST API projects", "body": "<p>I am trying to write <em>nice</em> unit tests for my already created REST API. I have this simple structure:</p>\n\n<pre><code>ROOT/\n    config/\n    handlers/\n    lib/\n    models/\n    router/\n    main.go\n</code></pre>\n\n<p><code>config</code> contains configuration in JSON and one simple <code>config.go</code> that reads and parses JSON file and fills the <code>Config</code> struct. <code>handlers</code> contains <em>controllers</em> (i.e. handlers of respective METHOD+URL described in <code>router/routes.go</code>). <code>lib</code> contains some DB, request responder and logger logic. <code>models</code> contains structs and their funcs to be mapped from-to JSON and DB. Finally <code>router</code> contains the router and routes definition.</p>\n\n<p>Now I was searching and reading a lot about unit testing REST APIs in GO and found more or less satisfying articles about how to set up a testing server, define routes and test my requests. All fine. <strong>BUT only if you want to test a single file!</strong></p>\n\n<p>My problem is now how to set up the testing environment (server, routes, DB connection) for all handlers? With the approach found <a href=\"http://dennissuratna.com/testing-in-go/\" rel=\"nofollow\">here</a> (which I find very easy to understand and implement) I have one problem: either <strong>I have to run tests separately for each handler</strong> or <strong>I have to write test suites for all handlers in just one test file</strong>. I believe you understand that both cases are not very happy (1st because I need to preserve that running <code>go test</code> runs all tests that succeed and 2nd because having one test file to cover all handler funcs would become unmaintainable).</p>\n\n<p>By now I have succeeded (according to <a href=\"http://dennissuratna.com/testing-in-go/\" rel=\"nofollow\">the linked article</a>) only if I put all testing and initializing code into just one func per <code>XYZhandler_test.go</code> file but I don't like this approach as well.</p>\n\n<p>What I would like to achieve is kind of <code>setUp()</code> or <code>init()</code> that runs once with first triggered test making all required variables globally visible and initialized so that all next tests could use them already without the need of instantiating them again while making sure that this setup file is compiled only for tests...</p>\n\n<p>I am not sure if this is completely clear or if some code example is required for this kind of question (other than what is <a href=\"http://dennissuratna.com/testing-in-go/\" rel=\"nofollow\">already linked in the article</a> but I will add anything that you think is required, just tell me!</p>\n"}, {"tags": ["go", "rabbitmq", "rabbitmqctl"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458743833, "post_id": 36175661, "comment_id": 59997338, "body": "<code>map[string]string</code> is a fairly simple data structure, why not use json?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1458744298, "post_id": 36177258, "comment_id": 59997756, "body": "since the type is mostly string data (<code>map[string]string</code>), json is going to be more compact than a gob in base64."}, {"owner": {"reputation": 1837, "user_id": 6077001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe446152875b896fe3c6b7fbbbc22b3e?s=128&d=identicon&r=PG", "display_name": "Jean-S&#233;bastien P&#233;dron", "link": "https://stackoverflow.com/users/6077001/jean-s%c3%a9bastien-p%c3%a9dron"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458746744, "post_id": 36177258, "comment_id": 59999749, "body": "I agree, JSON is probably a better choice for many reasons (easier debugging, possibility to read and interpret it from another language, etc.). I just mentionned base64 here because I found an example quickly. I&#39;m not a Go developer so I couldn&#39;t prepare a JSON-based example."}], "tags": [], "owner": {"reputation": 1837, "user_id": 6077001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe446152875b896fe3c6b7fbbbc22b3e?s=128&d=identicon&r=PG", "display_name": "Jean-S&#233;bastien P&#233;dron", "link": "https://stackoverflow.com/users/6077001/jean-s%c3%a9bastien-p%c3%a9dron"}, "is_accepted": true, "score": 3, "last_activity_date": 1458734510, "last_edit_date": 1495541266, "creation_date": 1458733382, "answer_id": 36177258, "question_id": 36175661, "link": "https://stackoverflow.com/questions/36175661/how-to-publish-and-consume-makemapstringstring-in-rabbitmq-go-lang/36177258#36177258", "title": "How to publish and consume make(map[string]string) in rabbitmq go lang", "body": "<p>You need to serialize your Go object to eg. base64 text before publishing it. In your consumer, you then deserialize it to get back your initial object. See \"<a href=\"https://stackoverflow.com/questions/28020070/golang-serialize-and-deserialize-back\">Golang serialize and deserialize back</a>\" for an example in Go.</p>\n\n<p>For the content type, I'm not sure what is the most appropriate. <code>application/octet-stream</code>?</p>\n"}, {"comments": [{"owner": {"reputation": 876, "user_id": 1776964, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/788b5dd9ba6c754311c8d08d199e88e1?s=128&d=identicon&r=PG", "display_name": "philip_nunoo", "link": "https://stackoverflow.com/users/1776964/philip-nunoo"}, "edited": false, "score": 0, "creation_date": 1593423134, "post_id": 50656325, "comment_id": 110765790, "body": "Works great. This should be stated somewhere in the documentation."}], "tags": [], "owner": {"reputation": 219, "user_id": 3839709, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awI8E.jpg?s=128&g=1", "display_name": "Ismayil Niftaliyev", "link": "https://stackoverflow.com/users/3839709/ismayil-niftaliyev"}, "is_accepted": false, "score": 2, "last_activity_date": 1527947910, "last_edit_date": 1527947910, "creation_date": 1527937945, "answer_id": 50656325, "question_id": 36175661, "link": "https://stackoverflow.com/questions/36175661/how-to-publish-and-consume-makemapstringstring-in-rabbitmq-go-lang/50656325#50656325", "title": "How to publish and consume make(map[string]string) in rabbitmq go lang", "body": "<p>It's so simple. You can use <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">json</a> and <a href=\"https://golang.org/pkg/bytes/\" rel=\"nofollow noreferrer\">bytes</a> packages to serialize and deserialize messages. Prepared this example for you:</p>\n\n<pre><code>type Message map[string]interface{}\n\nfunc serialize(msg Message) ([]byte, error) {\n    var b bytes.Buffer\n    encoder := json.NewEncoder(&amp;b)\n    err := encoder.Encode(msg)\n    return b.Bytes(), err\n}\n\nfunc deserialize(b []byte) (Message, error) {\n    var msg Message\n    buf := bytes.NewBuffer(b)\n    decoder := json.NewDecoder(buf)\n    err := decoder.Decode(&amp;msg)\n    return msg, err\n}\n</code></pre>\n\n<p>Yeah, basically that's it. Body field in <a href=\"https://www.rabbitmq.com/tutorials/tutorial-one-go.html\" rel=\"nofollow noreferrer\">RabbitMQ</a> library is byte array, therefore all you need are just converting to/from your data structure to/from byte array.</p>\n"}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2820, "favorite_count": 1, "accepted_answer_id": 36177258, "answer_count": 2, "score": 1, "last_activity_date": 1527947910, "creation_date": 1458729063, "question_id": 36175661, "link": "https://stackoverflow.com/questions/36175661/how-to-publish-and-consume-makemapstringstring-in-rabbitmq-go-lang", "title": "How to publish and consume make(map[string]string) in rabbitmq go lang", "body": "<p>I have multiple objects of key-value type which i need to send to RabbitMQ and hence forward would consume them. So, after going through this <a href=\"http://www.rabbitmq.com/tutorials/tutorial-five-go.html\" rel=\"nofollow\">RabbitMQ</a> link. It only tells the way to publish a simple plain text message. Can anyone tell me how to publish and consume map objects in RabbitMQ go lang?</p>\n\n<pre><code>     m := make(map[string]string)\n     m[\"col1\"] = \"004999010640000\"\n     m[\"col2\"] = \"awadwaw\"\n     m[\"col3\"] = \"13\"  \n\n     err = ch.Publish(\n        \"EventCaptureData-Exchange\", // exchange\n        q.Name + \"Key\",          // routing key\n        true,           // mandatory                            \n        false,           // immediate\n        amqp.Publishing{\n            ContentType: \"?????\",\n            Body:        ????,\n        })\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 1, "creation_date": 1458737875, "post_id": 36175145, "comment_id": 59992778, "body": "Have you tried <code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text&#47;css&quot; href=&quot;&#47;css&#47;css.css&quot;&gt;</code>? With a <code>&#47;</code> before <code>css</code>?"}, {"owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "edited": false, "score": 0, "creation_date": 1458752784, "post_id": 36175145, "comment_id": 60004176, "body": "There is another stackoverflow question which I think might answer your question - <a href=\"http://stackoverflow.com/questions/15834278/serving-static-content-with-a-root-url-with-the-gorilla-toolkit\" title=\"serving static content with a root url with the gorilla toolkit\">stackoverflow.com/questions/15834278/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 3697418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935fc81c219027453f720c590366e988?s=128&d=identicon&r=PG&f=1", "display_name": "nexteL", "link": "https://stackoverflow.com/users/3697418/nextel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1577, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458864294, "creation_date": 1458727727, "last_edit_date": 1458864294, "question_id": 36175145, "link": "https://stackoverflow.com/questions/36175145/how-can-i-serve-static-files-in-subroutes-with-gorilla-mux", "title": "How can I serve static files in subroutes with Gorilla mux?", "body": "<p>I have the following code:</p>\n\n<pre><code>func MainRouter() *mux.Router {\n    prefix := \"/\"\n    adminus_prefix := \"/adminus/\"\n    r := mux.NewRouter()\n    publicSub := r.PathPrefix(\"/\").Subrouter()\n    publicus.Routers(publicSub, prefix)\n    return r\n}\n</code></pre>\n\n<p>And the following routers:</p>\n\n<pre><code>func Routers(router *mux.Router, prefix string) {\n    router.HandleFunc(\"/\", handlers.MainHandler)\n    router.HandleFunc(\"/help\", handlers.HelpHandler)\n    router.HandleFunc(\"/company\", handlers.CompanyHandler)\n    router.HandleFunc(\"/documents\", handlers.DocumentsHandler)\n    router.HandleFunc(\"/addcomplaint\", handlers.AddcomplaintHandler).Methods(\"POST\")\n    router.PathPrefix(\"/\").Handler(http.StripPrefix(prefix, http.FileServer(http.Dir(\"./static/\"))))\n }\n</code></pre>\n\n<p>That's simple organisation of route handlers, each handler renders HTML templates as following:</p>\n\n<pre><code>var maintlp = pongo2.Must(pongo2.FromFile(\"templates/index.html\"))\n\nfunc MainHandler(w http.ResponseWriter, request *http.Request) {\n    fmt.Println(\"MainHandler\")\n    Session := utils.NewDbinstanse()\n    notices := make([]documents.Notice, 0)\n    Session.C(\"notice\").Find(nil).Sort(\"-time\").All(&amp;notices)\n\n    err := maintlp.ExecuteWriter(pongo2.Context{\"notices\": notices}, w)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>And in HTML I get static files from folder as following:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/css.css\"&gt;\n</code></pre>\n\n<p>It works fine in root directory, but if I want to add a route, e.g.:</p>\n\n<pre><code>router.HandleFunc(\"/help/bablala/vlavlavla\", handlers.BlablaHandler)\n</code></pre>\n\n<p>The HTML templates are rendered, but the CSS and JS files give a 404 error. I think the problem is in this part:</p>\n\n<pre><code>router.PathPrefix(\"/\").Handler(http.StripPrefix(prefix, http.FileServer(http.Dir(\"./static/\"))))\n</code></pre>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ajax", "http", "post", "go", "request"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1458727298, "post_id": 36173920, "comment_id": 59985549, "body": "Did you remember to set the content type on the client to <code>application&#47;x-www-form-urlencoded</code>?"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1458728945, "post_id": 36173920, "comment_id": 59986724, "body": "@Not_a_Golfer I did, but it does nothing here. I need to check if it reaches the handler or not, and it doesn&#39;t"}, {"owner": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 0, "creation_date": 1458738008, "post_id": 36173920, "comment_id": 59992866, "body": "So the problem is is that it does not reach your TurnOn function?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458743949, "post_id": 36173920, "comment_id": 59997439, "body": "Is your AJAX call returning an error? 404? Timing out? Nothing?"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 1425, "user_id": 293581, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d96c8822fa6bd112a3df4e45c16ea786?s=128&d=identicon&r=PG", "display_name": "Machiel", "link": "https://stackoverflow.com/users/293581/machiel"}, "edited": false, "score": 0, "creation_date": 1458755080, "post_id": 36173920, "comment_id": 60005667, "body": "@Machiel Yes, it seems that it doesn&#39;t reach <code>TurnOn</code> function  @elithrar No. In JavaScript code I wrote for it to log something in console to notify success. And it does log, which means no error occurs"}, {"owner": {"reputation": 1599, "user_id": 425810, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/510d3b22f788b849e098f53676ee282f?s=128&d=identicon&r=PG", "display_name": "Maleck13", "link": "https://stackoverflow.com/users/425810/maleck13"}, "edited": false, "score": 0, "creation_date": 1458897177, "post_id": 36173920, "comment_id": 60065976, "body": "Ok so does it reach IsAuthenticated? Have you tried removing IsAuthenticated and seeing if it reaches the code? Could it be you are hitting the redirect? The code looks ok so difficult to add anything of real value"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "reply_to_user": {"reputation": 1599, "user_id": 425810, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/510d3b22f788b849e098f53676ee282f?s=128&d=identicon&r=PG", "display_name": "Maleck13", "link": "https://stackoverflow.com/users/425810/maleck13"}, "edited": false, "score": 0, "creation_date": 1458898314, "post_id": 36173920, "comment_id": 60066481, "body": "@Maleck13 It does reach <code>IsAuthenticated</code>. Even if I put aside IsAuthenticated and set a sole <code>TurnOn</code> handler without <code>IsAuthenticated</code> middleware, it still doesn&#39;t reach <code>TurnOn</code>"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458804855, "creation_date": 1458724350, "last_edit_date": 1458804855, "question_id": 36173920, "link": "https://stackoverflow.com/questions/36173920/go-handling-ajax-post-request", "title": "go - Handling AJAX POST request", "body": "<p>I setup a middleware and router to handle an AJAX request on path <code>/api/on</code> like this</p>\n\n<pre><code>http.HandleFunc(\"/\",route.IndexHandler)\nhttp.HandleFunc(\"/login\",route.GoogleLoginHandler)\nhttp.HandleFunc(\"/auth/google\",route.GoogleCallbackHandler)\nhttp.Handle(\"/dashboard\",negroni.New(\n            negroni.HandlerFunc(route.IsAuthenticated),\n            negroni.Wrap(http.HandlerFunc(route.DashboardHandler)),\n))\nhttp.Handle(\"/api/on\",negroni.New(\n            negroni.HandlerFunc(route.IsAuthenticated),\n            negroni.Wrap(http.HandlerFunc(route.TurnOn)),\n))\n</code></pre>\n\n<p>Middleware <code>IsAuthenticated</code> allows to jump to the next router if there is a user session in my web, otherwise it will redirect</p>\n\n<pre><code>func IsAuthenticated(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n    session, _ := util.GlobalSessions.SessionStart(w, r)\n    defer session.SessionRelease(w)\n\n    if session.Get(\"profile\") == nil {\n        http.Redirect(w, r, \"/\", http.StatusMovedPermanently)\n    } else {\n        next(w, r)\n    }\n}\n</code></pre>\n\n<p>And this is <code>TurnOn</code> handler for later process</p>\n\n<pre><code>func TurnOn(w http.ResponseWriter, r *http.Request) {\n    session, _ := util.GlobalSessions.SessionStart(w, r)\n    defer session.SessionRelease(w)\n\n    w.Header().Set(\"Access-Control-Allow-Origin\",\"*\")\n    w.Header().Set(\"Access-Control-Allow-Methods\",\"POST\")\n    w.Header().Set(\"Access-Control-Allow-Headers\",\"Content-Type\")\n\n    fmt.Println(r.URL)\n}\n</code></pre>\n\n<p>After I turned on server, I conducted a POST request with JavaScript's client-side code using AJAX, but the console logged nothing. It seems that the <code>TurnOn</code> function was not reached even when AJAX request was sent successfully. Did I miss something obviously?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1458722568, "post_id": 36173222, "comment_id": 59982587, "body": "Funny thing. &quot;Var true = false&quot; gives the same result. But when I try to declare a package or import I get this error: &quot;prog.go:6: syntax error: unexpected package, expecting name prog.go:6: cannot declare name &quot;"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1458722895, "post_id": 36173222, "comment_id": 59982766, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31987772/why-are-new-and-make-not-reserved-keywords\">Why are &#39;new&#39; and &#39;make&#39; not reserved keywords?</a> It asks about <code>new</code> and <code>make</code>, but <code>true</code> is also a <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow noreferrer\">predeclared identifier</a> which makes the answers apply here too."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1458722956, "post_id": 36173222, "comment_id": 59982795, "body": "Neither true nor false are keywords (<a href=\"https://golang.org/ref/spec#Keywords\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Keywords</a>)  but predeclared identifiers (<a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Predeclared_identifiers</a>) and you redefine them which is fine and works like the whole language."}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 9, "last_activity_date": 1458724925, "last_edit_date": 1458724925, "creation_date": 1458723230, "answer_id": 36173576, "question_id": 36173222, "link": "https://stackoverflow.com/questions/36173222/why-is-const-true-false-allowed/36173576#36173576", "title": "Why is &quot;const true = false&quot; allowed?", "body": "<p><code>true</code> and <code>false</code> are not reserved keywords. These are predeclared identifiers.</p>\n\n<pre><code>const (\n        true  = 0 == 0 // Untyped bool.\n        false = 0 != 0 // Untyped bool.\n)\n</code></pre>\n\n<p>This means that <code>true</code> and <code>false</code> are simple two untyped boolean values. This is the reason that in your example <code>true</code> is equal to <code>false</code>.</p>\n\n<p><a href=\"https://golang.org/pkg/builtin/#pkg-constants\">https://golang.org/pkg/builtin/#pkg-constants</a></p>\n"}], "owner": {"reputation": 533, "user_id": 1723012, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/66ece1a38264060cdd051f11ac550440?s=128&d=identicon&r=PG", "display_name": "Zhomart", "link": "https://stackoverflow.com/users/1723012/zhomart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1428, "favorite_count": 1, "accepted_answer_id": 36173576, "answer_count": 1, "score": 5, "last_activity_date": 1458724925, "creation_date": 1458722092, "question_id": 36173222, "link": "https://stackoverflow.com/questions/36173222/why-is-const-true-false-allowed", "title": "Why is &quot;const true = false&quot; allowed?", "body": "<ol>\n<li><p>What version of Go are you using (go version)?\n<a href=\"https://play.golang.org\">https://play.golang.org</a></p></li>\n<li><p>What did you do?</p></li>\n</ol>\n\n<p>Run a small program:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst true = false\n\nfunc main() {\n    if (true == false) {\n        fmt.Println(\"True equals to false\")\n    }\n    fmt.Println(\"Hello World\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KwePsmQ_q9\">https://play.golang.org/p/KwePsmQ_q9</a></p>\n\n<ol start=\"3\">\n<li>What did you expect to see?</li>\n</ol>\n\n<p>Error or warning message that I'm creating constant with already defined name, and potentially breaking whole app.</p>\n\n<ol start=\"4\">\n<li>What did you see instead?</li>\n</ol>\n\n<p>Running without a problem. No warnings or anything to prevent creating new constant with already defined name.</p>\n"}, {"tags": ["linux", "sockets", "go", "tcp", "websocket"], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 3, "last_activity_date": 1458721618, "creation_date": 1458721618, "answer_id": 36173063, "question_id": 36172875, "link": "https://stackoverflow.com/questions/36172875/maintaning-more-than-65535-connections-on-single-ip/36173063#36173063", "title": "Maintaning more than 65535 connections on single IP", "body": "<blockquote>\n  <p>When a connection is made to one of these servers, I assume they continue communication from a random established TCP connection with random ports.</p>\n</blockquote>\n\n<p>Wrong assumption. They communicate with the clients using the same local port number they are listening on.</p>\n\n<blockquote>\n  <p>So, as one IP is used, and there are 64K ports, how can one maintain 10M connections?</p>\n</blockquote>\n\n<p>Not a problem.</p>\n\n<blockquote>\n  <p>Are connections identified by IP-Port pairs?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>Can two different connections from different IPs to same port be established?</p>\n</blockquote>\n\n<p>Yes.</p>\n\n<blockquote>\n  <p>How does this work under the hood? </p>\n</blockquote>\n\n<p>See above. IP:port pairs. You answered your own question.</p>\n"}, {"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1458738841, "creation_date": 1458738841, "answer_id": 36179194, "question_id": 36172875, "link": "https://stackoverflow.com/questions/36172875/maintaning-more-than-65535-connections-on-single-ip/36179194#36179194", "title": "Maintaning more than 65535 connections on single IP", "body": "<p>I think the part you are missing is a TCP connection is actually two pairs of IP:PORT.  </p>\n\n<p>One for the server, one for the client.  </p>\n\n<p>The listening side of a tcp socket is generally always the same IP/Port pair.</p>\n\n<p>Example: <code>net.Listen(\"tcp\", \":8080\")</code> is listening on port 8080 (on all interfaces in this case)</p>\n\n<p>The connecting (client) side is usually uses a single outgoing IP along with a random port.</p>\n\n<p>Example: <code>net.Dial(\"tcp\",\"server:8080)</code> Selects a random available ephemeral port and then attempts to connect to <code>server:8080</code>.</p>\n\n<p>So, in the above example, that connection is: <code>client.ip:32768 -&gt; server.ip:8080</code> (where 32768 is the ephemeral port selected)</p>\n\n<p>the two pairs combined make a unique connection.</p>\n\n<p>The server side can take as many connections from a single client as there are available (client side) ports.  It can also take as many clients are there are IP addresses.</p>\n\n<p>Think of it as, for one listening socket, you can theoretically have 2^16(ports) * 2^32(ipv4 addrs) connections.</p>\n\n<p>In reality, there are reserved IPs, ports, memory limitations, etc so the number is far smaller.  </p>\n\n<p>For exmaple, the ephemeral port range on Linux is 32768 - 61000.  Which means I'll start getting errors if I <code>net.Dial(\"tcp\", \"server:8080\")</code> more than 28232 times as I will have exhausted my ephemeral port range for the given server address.  But if the server is listening on 2 separate ports, I can do 28232 to the first port, and another 28232 to the second port.</p>\n\n<p>When you see people do the 10MM connection tests, they have to use multiple client IPs or multiple server IPs/Ports to achieve this (or a combo of both to get 10MM unique client:ip/server:ip pairs)</p>\n"}, {"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458744721, "post_id": 36181000, "comment_id": 59998113, "body": "If it&#39;s all over one socket why do the server and client need all those FDs, and that huge backlog, and what&#39;s all that about incrementing port numbers?"}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458754748, "post_id": 36181000, "comment_id": 60005481, "body": "My first answer was wrong.  But the incrementing port numbers are needed only because the test is using a single OS to run the client side."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 2, "last_activity_date": 1458754673, "last_edit_date": 1458754673, "creation_date": 1458743472, "answer_id": 36181000, "question_id": 36172875, "link": "https://stackoverflow.com/questions/36172875/maintaning-more-than-65535-connections-on-single-ip/36181000#36181000", "title": "Maintaning more than 65535 connections on single IP", "body": "<p>Sorry for totally changing my answer.</p>\n\n<p>Linux can easily support millions of open sockets if the machine has enough memory and processing power.  The TCP/IP stack allows this because the socket the OS targets for a given TCP packet is determined by the source and destination IP and port tuple.</p>\n\n<p>The server implementing the websocket protocol need only listen to a single TCP socket, often defined by the HTTP or HTTPS port number, but not in this example.  As part of standard TCP handshaking, the server OS and application open a unique socket for the TCP connection to the new client when the HTTP request which is a websocket request is received.  The websocket package takes care of upgrading the protocol used on this new socket from standard HTTP to websocket.  </p>\n\n<p>In the example, a goroutine is started for each websocket socket.</p>\n\n<p>The client side, the side initiating the TCP connections, is limited by the number of ephemeral ports its OS can open for a given destination host and port.  Honestly, I don't know if this is a limitation of the client OS or the TCP/IP specification itself.</p>\n"}], "owner": {"reputation": 9005, "user_id": 337504, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f365e5b3587387ed67c9c747288874e2?s=128&d=identicon&r=PG", "display_name": "Mustafa", "link": "https://stackoverflow.com/users/337504/mustafa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1093, "favorite_count": 0, "accepted_answer_id": 36173063, "answer_count": 3, "score": 0, "last_activity_date": 1458754673, "creation_date": 1458720946, "question_id": 36172875, "link": "https://stackoverflow.com/questions/36172875/maintaning-more-than-65535-connections-on-single-ip", "title": "Maintaning more than 65535 connections on single IP", "body": "<p>Reading the following article: <a href=\"http://goroutines.com/10m\" rel=\"nofollow\">10M concurrent websockets</a> </p>\n\n<p>So, there are 1000 websocket servers listening on ports 10000-11000. When a connection is made to one of these servers, I assume they continue communication from a random established TCP connection with random ports. So, as one IP is used, and there are 64K ports, how can one maintain 10M connections? Are connections identified by IP-Port pairs? Can two different connections from different IPs to same port be established? How does this work under the hood? </p>\n"}, {"tags": ["go", "zeromq"], "comments": [{"owner": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1458745911, "post_id": 36172107, "comment_id": 59999041, "body": "Have you tried any of the ready made go examples either in the <a href=\"http://zguide.zeromq.org/page:all\" rel=\"nofollow noreferrer\">ZMQ guide</a> or that <a href=\"https://github.com/pebbe/zmq4/tree/master/examples\" rel=\"nofollow noreferrer\">came with your binding</a>?  Can you confirm that any of those other examples work as expected?"}, {"owner": {"reputation": 1857, "user_id": 720694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d9dcbb57805a421a25ddf051f2d9f2?s=128&d=identicon&r=PG&f=1", "display_name": "user720694", "link": "https://stackoverflow.com/users/720694/user720694"}, "reply_to_user": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1458755181, "post_id": 36172107, "comment_id": 60005750, "body": "@Jason Yes i tried <a href=\"https://github.com/pebbe/zmq4/blob/master/examples/rtdealer.go\" rel=\"nofollow noreferrer\">github.com/pebbe/zmq4/blob/master/examples/rtdealer.go</a> and it works. However my code doesn&#39;t."}, {"owner": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1458759032, "post_id": 36172107, "comment_id": 60008014, "body": "Great, that helps.  Is there any chance, when you&#39;re starting up your processes, that you&#39;re starting the client first, then the server?"}, {"owner": {"reputation": 1857, "user_id": 720694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d9dcbb57805a421a25ddf051f2d9f2?s=128&d=identicon&r=PG&f=1", "display_name": "user720694", "link": "https://stackoverflow.com/users/720694/user720694"}, "reply_to_user": {"reputation": 12998, "user_id": 545332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d8d3c844a9033a1c70daaaff2c4ab5?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/545332/jason"}, "edited": false, "score": 0, "creation_date": 1458769685, "post_id": 36172107, "comment_id": 60013802, "body": "@Jason I first start the server, then run the client."}], "owner": {"reputation": 1857, "user_id": 720694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d9dcbb57805a421a25ddf051f2d9f2?s=128&d=identicon&r=PG&f=1", "display_name": "user720694", "link": "https://stackoverflow.com/users/720694/user720694"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1458718450, "creation_date": 1458718108, "last_edit_date": 1458718450, "question_id": 36172107, "link": "https://stackoverflow.com/questions/36172107/zeromq-router-dealer-router-not-receiving-data", "title": "ZeroMQ: Router-dealer, Router not receiving data", "body": "<p>I am new to zeroMQ and am trying to create a server (with router socket bound to a local port) and a client with a dealer socket which connects to the router socket on the local port. The client sends data and exits, however nothing shows up on the router socket i.e. the Recv(0) call blocks forever. The server and client codes are as follows: </p>\n\n<p>zmserver.go:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n         zmq \"github.com/pebbe/zmq4\")\n\nfunc main() {\n\nfmt.Println(\"Starting server\")\nserversock, _  := zmq.NewSocket(zmq.ROUTER)\nserversock.Bind(\"tcp://*:5050\")\n\nidentity, _ := serversock.Recv(0)\nfmt.Println(identity) //nothing is printed\nfmt.Println(serversock.Recv(0)) //nothing is printed\nfmt.Println(serversock.Recv(0)) //nothing is printed\n}\n</code></pre>\n\n<p>zmclient.go:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n         zmq \"github.com/pebbe/zmq4\")\n\nfunc main(){\n\nfmt.Println(\"Starting client\")\n\nclientsock, _ := zmq.NewSocket(zmq.DEALER)\ndefer clientsock.Close()\nclientsock.SetIdentity(\"ID1\")\nclientsock.Connect(\"tcp://localhost:5050\")  \nclientsock.Send(\"\", zmq.SNDMORE)\nclientsock.Send(\"Hi Boss\", 0)\n}\n</code></pre>\n"}, {"tags": ["java", "web-services", "go"], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 4643409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e2b16742d459d0a863ce7764ed99c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Ramesh Singh", "link": "https://stackoverflow.com/users/4643409/ramesh-singh"}, "edited": false, "score": 0, "creation_date": 1458717112, "post_id": 36171320, "comment_id": 59979890, "body": "Cool thanx..best answer!"}], "tags": [], "owner": {"reputation": 4671, "user_id": 434408, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/WQ1I9.jpg?s=128&g=1", "display_name": "a3.14_Infinity", "link": "https://stackoverflow.com/users/434408/a3-14-infinity"}, "is_accepted": true, "score": 2, "last_activity_date": 1458717493, "last_edit_date": 1458717493, "creation_date": 1458715057, "answer_id": 36171320, "question_id": 36170941, "link": "https://stackoverflow.com/questions/36170941/which-http-method-to-use-for-this-client-request/36171320#36171320", "title": "Which HTTP method to use for this client request?", "body": "<p>Looking at the problem you are solving and comparing to an <a href=\"https://www.hackerearth.com/\" rel=\"nofollow\">existing production solution</a> , I suggest that you can use POST in your scenario.</p>\n\n<ul>\n<li>Reasoning - Example Production code solving similar problem:-</li>\n</ul>\n\n<p>Assuming that the problem you are trying to solve is this:-\nClients submit code in Go programming language, Your server compiles it, runs    it and then gives the output. Assuming also that, it is somewhat similar to many online coding websites like hackerEarth, their <a href=\"https://www.hackerearth.com/docs/api/developers/code/v3/\" rel=\"nofollow\">API documentation</a> page and the sample python code provided show that we can use HTTP:POST to submit code to the server for its processing.</p>\n\n<ul>\n<li>Reasoning - <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.6\" rel=\"nofollow\">RFC for HTTP POST, PUT</a> :-</li>\n</ul>\n\n<p>POST is designed to allow a uniform method to cover the following functions:\n  Providing a block of data, such as the result of submitting a\n        form, to a data-handling process;</p>\n\n<p>The PUT method requests that the enclosed entity be stored under the supplied Request-URI. If the Request-URI refers to an already existing resource, the enclosed entity SHOULD be considered as a modified version of the one residing on the origin server.</p>\n\n<ul>\n<li>Referring to the above statements, we can conclude that in the context of this problem which you are solving, you are requesting the server to do some data-handling for the enclosed entity, so you can use POST.</li>\n</ul>\n"}], "owner": {"reputation": 137, "user_id": 4643409, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e2b16742d459d0a863ce7764ed99c9d?s=128&d=identicon&r=PG&f=1", "display_name": "Ramesh Singh", "link": "https://stackoverflow.com/users/4643409/ramesh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 2, "accepted_answer_id": 36171320, "answer_count": 1, "score": 1, "last_activity_date": 1458717493, "creation_date": 1458713282, "question_id": 36170941, "link": "https://stackoverflow.com/questions/36170941/which-http-method-to-use-for-this-client-request", "title": "Which HTTP method to use for this client request?", "body": "<p>I am developing a REST web service in Java which on clients' request processes the request body and gives the output to the client. The request body sent by the client consists of a GO(programing language) program which the server executes(runs) on the server machine and returns the standard output of the program back to the client. Now since the request body contains some text(program), I cannot use HTTP GET method to do that. I can use PUT or POST, but I have learnt that they(PUT and POST) are generally used for updating/creating a resource. Since, I am not creating any resource here, is it conceptually correct to use PUT or POST. If not, which is the HTTP method that I need to use?</p>\n"}, {"tags": ["mysql", "json", "go", "crud", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6022227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BkKgi11r8Oc/AAAAAAAAAAI/AAAAAAAAAAs/Udr5NJ7Q7Q4/photo.jpg?sz=128", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/6022227/nuwan-indika"}, "edited": false, "score": 0, "creation_date": 1458721962, "post_id": 36172415, "comment_id": 59982269, "body": "ok i tried another application that doesn&#39;t have any DATETIME values but only have int and string. I got the same error.."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1458719313, "last_edit_date": 1592644375, "creation_date": 1458719313, "answer_id": 36172415, "question_id": 36170330, "link": "https://stackoverflow.com/questions/36170330/select-all-is-not-working-in-golaong-gorm/36172415#36172415", "title": "Select all is not working in golaong gorm", "body": "<p>You can find the answer in the driver documentation\n<a href=\"https://github.com/go-sql-driver/mysql#timetime-support\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql#timetime-support</a>:</p>\n<blockquote>\n<p>The default internal output type of MySQL DATE and DATETIME values is []byte which allows you to scan the value into a []byte, string or sql.RawBytes variable in your programm.</p>\n<p>However, many want to scan MySQL DATE and DATETIME values into time.Time variables, which is the logical opposite in Go to DATE and DATETIME in MySQL. You can do that by changing the internal output type from []byte to time.Time with the DSN parameter parseTime=true. You can set the default time.Time location with the loc DSN parameter.</p>\n<p>Alternatively you can use the NullTime type as the scan destination, which works with both time.Time and string / []byte.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 6141723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207772970035894/picture?type=large", "display_name": "M F&#233;lix Hertz", "link": "https://stackoverflow.com/users/6141723/m-f%c3%a9lix-hertz"}, "is_accepted": false, "score": -3, "last_activity_date": 1459452127, "creation_date": 1459452127, "answer_id": 36341943, "question_id": 36170330, "link": "https://stackoverflow.com/questions/36170330/select-all-is-not-working-in-golaong-gorm/36341943#36341943", "title": "Select all is not working in golaong gorm", "body": "<p>Are you ever actually opening the database here? I don't see an actual Open() call in there at all...</p>\n"}], "owner": {"reputation": 31, "user_id": 6022227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BkKgi11r8Oc/AAAAAAAAAAI/AAAAAAAAAAs/Udr5NJ7Q7Q4/photo.jpg?sz=128", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/6022227/nuwan-indika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3447, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489462697, "creation_date": 1458710057, "last_edit_date": 1489462697, "question_id": 36170330, "link": "https://stackoverflow.com/questions/36170330/select-all-is-not-working-in-golaong-gorm", "title": "Select all is not working in golaong gorm", "body": "<p>I'm using gin framework and trying do crud operation using grom.I'm trying to get data from MYSQL database. i have db.go to get database instances, some controllers to each table and models\ni have a model like this</p>\n\n<pre><code>    type Campaigns struct {\n\n        ID                     int       `json:\"id\" form:\"id\" gorm:\"column:CampaignID\"`\n        UserID                 int       `json:\"userId\" form:\"userId\" gorm:\"column:UserID\"`\n        Name                   string    `json:\"name\" form:\"name\" gorm:\"column:Name\"`\n        StartDate              time.Time `json:\"start\" form:\"start\" gorm:\"column:StartDate\"`\n        EndDate                time.Time `json:\"end\" form:\"end\" gorm:\"column:EndDate\"`\n        Customer               string    `json:\"customer\" form:\"customer\" gorm:\"column:Customer\"`\n        CustomerID             int       `json:\"customerId\" form:\"customerId\" gorm:\"column:CustomerID\"`\n        ImpressionsCounter     int       `json:\"ImpressionsCounter\" form:\"ImpressionsCounter\" gorm:\"column:ImpressionsCounter\"`\n        MaxImpressions         int       `json:\"maxImpressions\" form:\"maxImpressions\" gorm:\"column:MaxImpressions\"`\n        CurrentSpend           float64   `json:\"currentSpend\" gorm:\"column:CurrentSpend\"`\n        MaxSpend               float64   `json:\"maxSpend\" form:\"maxSpend\" gorm:\"column:MaxSpend\"`\n        Active                 bool      `json:\"active\" form:\"active\" gorm:\"column:Active\"`\n        Created                time.Time `json:\"created\" gorm:\"column:DateCreated\"`\n        Updated                time.Time `json:\"updated\" gorm:\"column:DateCreated\"`\n}\n</code></pre>\n\n<p>this is a one controller I'm using </p>\n\n<pre><code>    package controllers\nimport (\n    \"time\"\n\n  \"github.com/op/go-logging\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jinzhu/gorm\"\n  _ \"github.com/go-sql-driver/mysql\"\n\n    \"../models\"\n)\n\nvar log = logging.MustGetLogger(\"AsAPI\")\n\ntype AsController struct {\n    DB gorm.DB\n}\n\nfunc (ac *AsController) SetDB(d gorm.DB) {\n    ac.DB = d\n    ac.DB.LogMode(true)\n}\n\n\n// Get all table\nfunc (ac *AsController) ListTable(c *gin.Context) {\n\n    var results []models.Campaigns\n  err := ac.DB.Find(&amp;results)\n\n    if err != nil {\n        log.Debugf(\"Error when looking up Table, the error is '%v'\", err)\n        res := gin.H{\n                \"status\": \"404\",\n                \"error\": \"No Table found\",\n        }\n        c.JSON(404, res)\n        return\n    }\n    content := gin.H{\n                        \"status\": \"200\",\n            \"result\": \"Success\",\n            \"Table\": results,\n        }\n\n  c.Writer.Header().Set(\"Content-Type\", \"application/json\")\n  c.JSON(200, content)\n}\n</code></pre>\n\n<p>To get database connection I'm using </p>\n\n<pre><code>package controllers\nimport (\n    \"time\"\n\n  \"github.com/op/go-logging\"\n    \"github.com/gin-gonic/gin\"\n    \"github.com/jinzhu/gorm\"\n  _ \"github.com/go-sql-driver/mysql\"\n\n    \"../models\"\n)\n\nvar log = logging.MustGetLogger(\"AdsAPI\")\n\ntype AsController struct {\n    DB gorm.DB\n}\n\nfunc (ac *AsController) SetDB(d gorm.DB) {\n    ac.DB = d\n    ac.DB.LogMode(true)\n} \n</code></pre>\n\n<p>and I'm using following routs </p>\n\n<pre><code>ac := controllers.AdsController{}\nac.SetDB(dc.GetDB())\n\n\n// Get a Ads resource\nrouter := gin.Default()\n\nrouter.GET(\"/table\", ac.ListTables)\n</code></pre>\n\n<p>when i run this I'm getting following error</p>\n\n<pre><code>(/api/controllers/table.go:30) \n[2016-03-23 09:56:39]  [0.99ms]  SELECT  * FROM `tables`  \n2016/03/23 09:56:39 Error when looking up tables, the error is '&amp;{0xc8202140e0 sql: Scan error on column index 3: unsupported driver -&gt; Scan pair: []uint8 -&gt; *time.Time 1 &lt;nil&gt; 0xc82022f860 0xc82022f7c0 0xc82021e140 2 {0xc8201fb4a0} &lt;nil&gt; false  map[] map[]}'\n[GIN] 2016/03/23 - 09:56:39 | 404 |    1.153811ms | 127.0.0.1 |   GET     /table\n</code></pre>\n\n<p>what is the reason for this error ? help me to fix this error ?</p>\n"}, {"tags": ["sockets", "go", "ip", "icmp", "raw-sockets"], "answers": [{"comments": [{"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "edited": false, "score": 0, "creation_date": 1460173349, "post_id": 36170811, "comment_id": 60631206, "body": "Thanks for the tip, I can&#39;t set <code>IPPROTO_ICMP</code> as the protocol when I create the socket since I need to set <code>TTL</code> to 1 which must be done in IP layer."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "edited": false, "score": 0, "creation_date": 1460173925, "post_id": 36170811, "comment_id": 60631298, "body": "Isn&#39;t there a socket option to set the TTL?"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 1, "last_activity_date": 1458712673, "creation_date": 1458712673, "answer_id": 36170811, "question_id": 36169890, "link": "https://stackoverflow.com/questions/36169890/raw-socket-didnt-receive-icmp-response/36170811#36170811", "title": "raw socket didn&#39;t receive icmp response", "body": "<p>I think you need to give <code>IPPROTO_ICMP</code> as the protocol when you create your socket. The <a href=\"http://man7.org/linux/man-pages/man7/raw.7.html\" rel=\"nofollow\">raw(7) man page</a> says that an <code>IPPROTO_RAW</code> socket is send only. Also, if you use <code>IPPROTO_ICMP</code>, you don't give the IP header. (Note: I haven't actually tried this in Go.)</p>\n"}, {"tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": true, "score": 2, "last_activity_date": 1460173271, "creation_date": 1460173271, "answer_id": 36512473, "question_id": 36169890, "link": "https://stackoverflow.com/questions/36169890/raw-socket-didnt-receive-icmp-response/36512473#36512473", "title": "raw socket didn&#39;t receive icmp response", "body": "<p>As Andy pointed out, the <a href=\"http://man7.org/linux/man-pages/man7/raw.7.html\" rel=\"nofollow\">raw(7) man page</a> says:</p>\n\n<blockquote>\n  <p>An IPPROTO_RAW socket is send only.  If you really want to receive\n         all IP packets, use a packet(7) socket with the ETH_P_IP protocol.\n         Note that packet sockets don't reassemble IP fragments, unlike raw\n         sockets.</p>\n</blockquote>\n\n<p>I know I can receive ICMP reply if I set <code>IPPROTO_ICMP</code> as the protocol when I create the socket, but I need to set <code>TTL</code> to 1 which must be done in IP layer. Therefore I send the ICMP request with <code>IPPROTO_RAW</code> socket, after that I use <code>net.ListenIP</code> to receive ICMP messages. Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"syscall\"\n)\n\nconst icmpID uint16 = 43565 // use a magic number for now\n\ntype ICMP struct {\n    Type       uint8\n    Code       uint8\n    Checksum   uint16\n    Identifier uint16\n    SeqNo      uint16\n}\n\nfunc Checksum(data []byte) uint16 {\n    var (\n        sum    uint32\n        length int = len(data)\n        index  int\n    )\n\n    for length &gt; 1 {\n        sum += uint32(data[index])&lt;&lt;8 + uint32(data[index+1])\n        index += 2\n        length -= 2\n    }\n\n    if length &gt; 0 {\n        sum += uint32(data[index])\n    }\n\n    sum += (sum &gt;&gt; 16)\n\n    return uint16(^sum)\n}\n\nfunc main() {\n    h := Header{\n        Version:  4,\n        Len:      20,\n        TotalLen: 20 + 8,\n        TTL:      1,\n        Protocol: 1,\n    }\n\n    argc := len(os.Args)\n    if argc &lt; 2 {\n        log.Println(\"usage: program + host\")\n        return\n    }\n\n    ipAddr, _ := net.ResolveIPAddr(\"ip\", os.Args[1])\n    h.Dst = ipAddr.IP\n\n    icmpReq := ICMP{\n        Type:       8,\n        Code:       0,\n        Identifier: icmpID,\n        SeqNo:      1,\n    }\n\n    out, err := h.Marshal()\n    if err != nil {\n        log.Println(\"ip header error\", err)\n        return\n    }\n\n    var icmpBuf bytes.Buffer\n    binary.Write(&amp;icmpBuf, binary.BigEndian, icmpReq)\n    icmpReq.Checksum = Checksum(icmpBuf.Bytes())\n\n    icmpBuf.Reset()\n    binary.Write(&amp;icmpBuf, binary.BigEndian, icmpReq)\n\n    fd, _ := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_RAW)\n    addr := syscall.SockaddrInet4{\n        Port: 0,\n    }\n\n    copy(addr.Addr[:], ipAddr.IP[12:16])\n    pkg := append(out, icmpBuf.Bytes()...)\n\n    if err := syscall.Sendto(fd, pkg, 0, &amp;addr); err != nil {\n        log.Println(\"Sendto err:\", err)\n    }\n\n    laddr, err := net.ResolveIPAddr(\"ip4:icmp\", \"0.0.0.0\")\n    if err != nil {\n        log.Fatal(err)\n\n    }\n\n    c, err := net.ListenIP(\"ip4:icmp\", laddr)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for {\n        buf := make([]byte, 2048)\n        n, raddr, err := c.ReadFrom(buf)\n        if err != nil {\n            log.Println(err)\n            continue\n        }\n        icmpType := buf[0]\n        if icmpType == 11 {\n            if n == 36 { // Time exceeded messages\n                // A time exceeded message contain IP header(20 bytes) and first 64 bits of the original payload\n                id := binary.BigEndian.Uint16(buf[32:34])\n                log.Println(\"recv id\", id)\n                if id == icmpID {\n                    log.Println(\"recv Time Exceeded from\", raddr)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Actually, I am writing a traceroute in go, if anyone is interested about that, the whole code is in <a href=\"https://github.com/jflyup/traceroute\" rel=\"nofollow\">github</a>.</p>\n"}], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "accepted_answer_id": 36512473, "answer_count": 2, "score": 3, "last_activity_date": 1460982603, "creation_date": 1458707504, "last_edit_date": 1460982603, "question_id": 36169890, "link": "https://stackoverflow.com/questions/36169890/raw-socket-didnt-receive-icmp-response", "title": "raw socket didn&#39;t receive icmp response", "body": "<p>I'm trying to send an icmp message whose TTL is just 1, and expect to receive a time exceeded message. that message does come(I see it from wireshark), but my program blocks on <code>syscall.Recvfrom</code>. Anyone knows why?<br>\n<strong>icmp.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"fmt\"\n    \"net\"\n    \"os\"\n    \"syscall\"\n)\n\ntype ICMP struct {\n    Type       uint8\n    Code       uint8\n    Checksum   uint16\n    Identifier uint16\n    SeqNo      uint16\n}\n\nfunc Checksum(data []byte) uint16 {\n    var (\n        sum    uint32\n        length int = len(data)\n        index  int\n    )\n\n    for length &gt; 1 {\n        sum += uint32(data[index])&lt;&lt;8 + uint32(data[index+1])\n        index += 2\n        length -= 2\n    }\n\n    if length &gt; 0 {\n        sum += uint32(data[index])\n    }\n\n    sum += (sum &gt;&gt; 16)\n\n    return uint16(^sum)\n}\n\nfunc main() {\n    h := Header{\n        Version:  4,\n        Len:      20,\n        TotalLen: 20 + 8,\n        TTL:      1,\n        Protocol: 1,\n        //  Dst:\n    }\n\n    argc := len(os.Args)\n    if argc &lt; 2 {\n        fmt.Println(\"usage: program + host\")\n        return\n    }\n\n    ipAddr, _ := net.ResolveIPAddr(\"ip\", os.Args[1])\n    h.Dst = ipAddr.IP\n\n    icmpReq := ICMP{\n        Type:       8,\n        Code:       0,\n        Identifier: 0,\n        SeqNo:      0,\n    }\n\n    out, err := h.Marshal()\n    if err != nil {\n        fmt.Println(\"ip header error\", err)\n        return\n    }\n\n    var icmpBuf bytes.Buffer\n    binary.Write(&amp;icmpBuf, binary.BigEndian, icmpReq)\n    icmpReq.Checksum = Checksum(icmpBuf.Bytes())\n\n    icmpBuf.Reset()\n    binary.Write(&amp;icmpBuf, binary.BigEndian, icmpReq)\n\n    fd, _ := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_RAW)\n    addr := syscall.SockaddrInet4{\n        Port: 0,\n    }\n\n    copy(addr.Addr[:], ipAddr.IP[12:16])\n    pkg := append(out, icmpBuf.Bytes()...)\n\n    fmt.Println(\"ip length\", len(pkg))\n\n    if err := syscall.Sendto(fd, pkg, 0, &amp;addr); err != nil {\n        fmt.Println(\"Sendto err:\", err)\n    }\n\n    var recvBuf []byte\n    if nBytes, rAddr, err := syscall.Recvfrom(fd, recvBuf, 0); err == nil {\n        fmt.Printf(\"recv %d bytes from %v\\n\", nBytes, rAddr)\n    }\n}\n</code></pre>\n\n<p>additionally, I use <code>header.go</code> and <code>helper.go</code> from <a href=\"https://github.com/golang/net/tree/master/ipv4\" rel=\"nofollow\">https://github.com/golang/net/tree/master/ipv4</a></p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "edited": false, "score": 0, "creation_date": 1458691757, "post_id": 36167542, "comment_id": 59972340, "body": "Perhaps I can set the name of the task to the entity key to stop the risk of tasks being created twice?"}, {"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1458721295, "post_id": 36167542, "comment_id": 59981892, "body": "If I&#39;m reading this right, you&#39;re re-running the query for every result and creating a task to do something with that result (entity)?  That seems like a lot of queries and tasks.  Could you not just run your job on a task queue and &#39;paginate&#39; your query results into &lt; 10 minute pages, each time enqueueing a new Task with the cursor to mark the current position?   I guess it depends how much work you&#39;re doing on each entity."}, {"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1458762482, "post_id": 36167542, "comment_id": 60010024, "body": "yeah i wasn&#39;t too worried about the cost of pulling the next key after the current cursor - or i coulda batched them more - tho then there is more chance of failure within that task - and I wouldn&#39;t know which key to restart the task from. callwithnextkey is a task itself. it calls itself but it also calls the other task (copycourse). copy course has to great a bunch of course groups etc so does a fair amount of work."}], "tags": [], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1458691677, "creation_date": 1458691677, "answer_id": 36167542, "question_id": 36167500, "link": "https://stackoverflow.com/questions/36167500/iterate-over-a-large-number-of-entities-on-appengine-with-go/36167542#36167542", "title": "iterate over a large number of entities on appengine with go", "body": "<p>Here's my solution although I'm hoping someone out there has a better solution. I also wonder if this is prone to fork bombs e.g. if the task runs twice, it will set off two chains of iteration.. ! I'm only using it to iterate a few hundred thousand entities, although the operation on each entity is expensive.</p>\n\n<p>First I create a taskqueue for running each individual function call on an entity one at a time:</p>\n\n<pre><code>queue:\n- name: entity-iter\n  rate: 100/s\n  max_concurrent_requests: 1\n  retry_parameters:\n    task_retry_limit: 3\n    task_age_limit: 30m\n    min_backoff_seconds: 200\n</code></pre>\n\n<p>and then I have an iterate entity method which, given the kind, will call your delay func on each entity with the key.</p>\n\n<pre><code>package sysadmin\n\nimport (\n    \"google.golang.org/appengine/datastore\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/appengine/log\"\n    \"google.golang.org/appengine/delay\"\n    \"google.golang.org/appengine/taskqueue\"\n)\n\n\nfunc ForEachEntity(kind string, f *delay.Function) *delay.Function {\n    var callWithNextKey *delay.Function // func(c context.Context, depth int, cursorString string) error\n    callWithNextKey = delay.Func(\"something\", func(c context.Context, depth int, cursorString string) error {\n        q := datastore.NewQuery(kind).KeysOnly()\n        if cursorString != \"\" {\n            if curs, err := datastore.DecodeCursor(cursorString); err != nil {\n                log.Errorf(c, \"error decoding cursor %v\", err)\n                return err\n            } else {\n                q = q.Start(curs)\n            }\n        }\n        it := q.Run(c)\n        if key, err := it.Next(nil); err != nil {\n            if err == datastore.Done {\n                log.Infof(c, \"Done %v\", err)\n                return nil\n            }\n            log.Errorf(c, \"datastore error %v\", err)\n            return err\n        } else {\n            curs, _ := it.Cursor()\n            if t, err := f.Task(key); err != nil {\n                return err\n            } else if _, err = taskqueue.Add(c, t, \"entity-iter\"); err != nil {\n                log.Errorf(c, \"error %v\", err)\n                return err\n            }\n            if depth - 1 &gt; 0 {\n                if err := callWithNextKey.Call(c, depth - 1, curs.String()); err != nil {\n                    log.Errorf(c, \"error2 %v\", err)\n                    return err\n                }\n            }\n        }\n        return nil\n    })\n    return callWithNextKey\n}\n</code></pre>\n\n<p>example usage:</p>\n\n<pre><code>var DoCopyCourse = delay.Func(\"something2\", CopyCourse)\n\nvar DoCopyCourses = ForEachEntity(\"Course\", DoCopyCourse)\n\nfunc CopyCourses(c context.Context) {\n    //sharedmodels.MakeMockCourses(c)\n    DoCopyCourses.Call(c, 9999999, \"\")\n}\n</code></pre>\n"}], "owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1463411453, "creation_date": 1458691440, "last_edit_date": 1463411453, "question_id": 36167500, "link": "https://stackoverflow.com/questions/36167500/iterate-over-a-large-number-of-entities-on-appengine-with-go", "title": "iterate over a large number of entities on appengine with go", "body": "<p>On app engine I have a large number of entities of a particular kind.\nI want to run a function on each entity (e.g. edit the entity or copy it)\nI would do this in a taskqueue but a taskqueue is limited to 10 minutes runtime and each function call is prone to many kinds of errors. What is the best way to do this?</p>\n"}, {"tags": ["go", "concurrency", "hashmap"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1458690895, "post_id": 36167200, "comment_id": 59972040, "body": "We need a reproducible example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1458691273, "post_id": 36167200, "comment_id": 59972177, "body": "Run your code with the race detector."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1458694059, "post_id": 36167200, "comment_id": 59973031, "body": "Not safe. Go 1.6 <a href=\"https://golang.org/doc/go1.6#runtime\" rel=\"nofollow noreferrer\">added a best-effort detection of concurrent misuse of maps</a>.  The runtime crashes the program when misuse is detected."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1458710498, "post_id": 36167200, "comment_id": 59977470, "body": "Q: &quot;Can this last risk be reduced in some cases?&quot; A: &quot;No&quot;."}, {"owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "edited": false, "score": 1, "creation_date": 1458711373, "post_id": 36167200, "comment_id": 59977746, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11063473/map-with-concurrent-access\">Map with concurrent access</a>"}, {"owner": {"reputation": 640, "user_id": 2127434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2edd263a2e1a10c6eedd59ad9f53ae5e?s=128&d=identicon&r=PG", "display_name": "pyramids", "link": "https://stackoverflow.com/users/2127434/pyramids"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1471102887, "post_id": 36167200, "comment_id": 65224545, "body": "@peterSO <a href=\"http://stackoverflow.com/questions/23579479/how-can-one-implement-a-thread-safe-wrapper-to-maps-in-go-by-locking\">Here</a> is an example of a panic from unintentional concurrent write access called many times in a benchmark test."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 10, "last_activity_date": 1458690842, "last_edit_date": 1458690842, "creation_date": 1458690437, "answer_id": 36167319, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/36167319#36167319", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/go1.6\" rel=\"noreferrer\">Go 1.6 Release Notes</a></p>\n  \n  <p>The runtime has added lightweight, best-effort detection of concurrent\n  misuse of maps. As always, if one goroutine is writing to a map, no\n  other goroutine should be reading or writing the map concurrently. If\n  the runtime detects this condition, it prints a diagnosis and crashes\n  the program. The best way to find out more about the problem is to run\n  the program under the race detector, which will more reliably identify\n  the race and give more detail.</p>\n</blockquote>\n\n<p>Maps are complex, self-reorganizing data structures. Concurrent read and write access is undefined.</p>\n\n<p>Without code, there's not much else to say.  </p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 16, "last_activity_date": 1458694058, "last_edit_date": 1495542345, "creation_date": 1458692693, "answer_id": 36167693, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/36167693#36167693", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>Concurrent read (read only) is ok. Concurrent write and/or read is not ok.</p>\n\n<p>Multiple goroutines can only write and/or read the same map if access is synchronized, e.g. via the <a href=\"https://golang.org/pkg/sync/\" rel=\"noreferrer\"><code>sync</code></a> package, with channels or via other means.</p>\n\n<p>Your example:</p>\n\n<blockquote>\n  <ol>\n  <li>Function A generates k and sets m[k]=0. This is the only time A writes to map m. k is known to not be in m.</li>\n  <li>A passes k to function B running concurrently</li>\n  <li>A then reads m[k]. If m[k]==0, it waits, continuing only when m[k]!=0</li>\n  <li>B looks for k in the map. If it finds it, B sets m[k] to some positive integer. If it doesn't it waits until k is in m.</li>\n  </ol>\n</blockquote>\n\n<p>Your example has 2 goroutines: A and B, and A tries to read <code>m</code> (in step 3) and B tries to write it (in step 4) concurrently. There is no synchronization (you didn't mention any), so this alone is not permitted / not determined.</p>\n\n<p>What does it mean? Not determined means even though B writes <code>m</code>, A may never observe the change. Or A may observe a change that didn't even happen. Or a panic may occur. Or the Earth may explode due to this non-synchronized concurrent access (although the chance of this latter case is extremely small, maybe even less than 1e-40).</p>\n\n<p>Related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11063473/map-with-concurrent-access\">Map with concurrent access</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/31730684/what-does-not-being-thread-safe-means-about-maps-in-go\">what does not being thread safe means about maps in Go?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35431102/what-is-the-danger-of-neglecting-goroutine-thread-safety-when-using-a-map-in-go\">What is the danger of neglecting goroutine/thread-safety when using a map in Go?</a></p>\n"}, {"comments": [{"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1565698411, "post_id": 36169924, "comment_id": 101426780, "body": "It&#39;s been several years and I&#39;ve seen a lot more discussion about race conditions. I don&#39;t like my answer from three years ago because even reading and writing an int, which is just like writing to an int being pointed to by another variable, is not considered safe by those who would know. Would it work? On some architectures, probably. But most processor hardware engineers would still say the results are undefined. The golang sync/atomic package is our friend and does what is necessary from the various architectures golang supports."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1458707742, "creation_date": 1458707742, "answer_id": 36169924, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/36169924#36169924", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>You can store a pointer to an int in the map, and have multiple goroutines read the int being pointed to while another writes a new value to the int.  The map is not being updated in this case.</p>\n\n<p>This wouldn't be idiomatic for Go and not what you were asking.</p>\n\n<p>Or instead of passing a key to a map, you could pass the index to an array, and have that updated by one goroutine while others read the location.</p>\n\n<p>But you're probably just wondering why a map's value can't be updated with a new value when the key is already in the map.  Presumably nothing about the map's hashing scheme is being changed - at least not given their current implementation.  It would seem the Go authors don't want to make allowances for such special cases.  Generally they want code to be easy to read and understand, and a rule like not allowing map writes when other goroutines could be reading keeps things simple and now in 1.6 they can even start to catch misuse during normal runtimes - saving many people many hours of debugging.</p>\n"}, {"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 10, "creation_date": 1482514009, "post_id": 38140573, "comment_id": 69813778, "body": "Concurrent read and write was never ok even before 1.6 it just didn&#39;t complain."}, {"owner": {"reputation": 4968, "user_id": 244330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/66b048081841e1854319684966683663?s=128&d=identicon&r=PG", "display_name": "newguy", "link": "https://stackoverflow.com/users/244330/newguy"}, "edited": false, "score": 1, "creation_date": 1506309376, "post_id": 38140573, "comment_id": 79751301, "body": "This is really nice solution. But is it possible to use channels instead of mutex?"}, {"owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "reply_to_user": {"reputation": 4968, "user_id": 244330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/66b048081841e1854319684966683663?s=128&d=identicon&r=PG", "display_name": "newguy", "link": "https://stackoverflow.com/users/244330/newguy"}, "edited": false, "score": 0, "creation_date": 1514257674, "post_id": 38140573, "comment_id": 82916642, "body": "@newguy I think channel can&#39;t do it. As <code>map</code> can&#39;t read when it&#39;s writting, so just use one channel to handle the <code>map</code>."}, {"owner": {"reputation": 310, "user_id": 6811933, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1073602816008139/picture?type=large", "display_name": "Kshitij Kumar", "link": "https://stackoverflow.com/users/6811933/kshitij-kumar"}, "edited": false, "score": 0, "creation_date": 1531207371, "post_id": 38140573, "comment_id": 89497039, "body": "Do I have to put lock in comparisons like this -&gt; if m[&quot;a&quot;] == 1{} ?"}, {"owner": {"reputation": 2903, "user_id": 1676472, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/G3qfj.jpg?s=128&g=1", "display_name": "tsturzl", "link": "https://stackoverflow.com/users/1676472/tsturzl"}, "reply_to_user": {"reputation": 4968, "user_id": 244330, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/66b048081841e1854319684966683663?s=128&d=identicon&r=PG", "display_name": "newguy", "link": "https://stackoverflow.com/users/244330/newguy"}, "edited": false, "score": 0, "creation_date": 1568922398, "post_id": 38140573, "comment_id": 102439606, "body": "@newguy You can use a channel talking to a control goroutine which has exclusive access to the map. So have a goroutine that&#39;s listening on a channel for an operation(read or write) along with a new channel for the return data, but this is still synchronous and the caller will still be blocked waiting for a response on the return channel. Not sure what the implications of this are, but it seems unnecessary."}, {"owner": {"reputation": 481, "user_id": 2967113, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5d72f96279c46ac2639cfdc34753bc42?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Lagergren", "link": "https://stackoverflow.com/users/2967113/eric-lagergren"}, "edited": false, "score": 3, "creation_date": 1572390136, "post_id": 38140573, "comment_id": 103542562, "body": "&gt; Before Golang 1.6, concurrent read is OK, concurrent write is not OK, but write and concurrent read is OK.  This is flat out incorrect. It has always been incorrect to concurrently read and write to a map."}], "tags": [], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "is_accepted": false, "score": 70, "last_activity_date": 1514259083, "last_edit_date": 1514259083, "creation_date": 1467361566, "answer_id": 38140573, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/38140573#38140573", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>Before Golang 1.6, concurrent read is OK, concurrent write is not OK, but write and concurrent read is OK. Since Golang 1.6, map cannot be read when it's being written.\nSo After Golang 1.6, concurrent access map should be like:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"time\"\n)\n\nvar m = map[string]int{\"a\": 1}\nvar lock = sync.RWMutex{}\n\nfunc main() {\n    go Read()\n    time.Sleep(1 * time.Second)\n    go Write()\n    time.Sleep(1 * time.Minute)\n}\n\nfunc Read() {\n    for {\n        read()\n    }\n}\n\nfunc Write() {\n    for {\n        write()\n    }\n}\n\nfunc read() {\n    lock.RLock()\n    defer lock.RUnlock()\n    _ = m[\"a\"]\n}\n\nfunc write() {\n    lock.Lock()\n    defer lock.Unlock()\n    m[\"b\"] = 2\n}\n</code></pre>\n\n<p>Or you will get the error below:\n<a href=\"https://i.stack.imgur.com/VsUhV.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/VsUhV.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>ADDED:</strong></p>\n\n<p>You can detect the race by using <code>go run -race race.go</code></p>\n\n<p>Change the <code>read</code> function:</p>\n\n<pre><code>func read() {\n    // lock.RLock()\n    // defer lock.RUnlock()\n    _ = m[\"a\"]\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zHZAA.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/zHZAA.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Another choise:</strong></p>\n\n<p>As we known, <code>map</code> was implemented by buckets and <code>sync.RWMutex</code> will lock all the buckets. <a href=\"https://github.com/orcaman/concurrent-map\" rel=\"noreferrer\">concurrent-map</a> use <code>fnv32</code> to shard the key and every bucket use one <code>sync.RWMutex</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "is_accepted": false, "score": 0, "last_activity_date": 1487506567, "creation_date": 1487506567, "answer_id": 42327097, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/42327097#42327097", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>As the other answers here stated, the native <code>map</code> type is not <code>goroutine</code>-safe. A couple of notes after reading the current answers:</p>\n\n<ol>\n<li>Do not use defer to unlock, it has some overhead that affects performance (see <a href=\"https://misfra.me/optimizing-concurrent-map-access-in-go/\" rel=\"nofollow noreferrer\">this</a> nice post). Call unlock directly.</li>\n<li>You can achieve better performance by reducing time spent between locks. For example, by sharding the map. </li>\n<li>There is a common package (approaching 400 stars on GitHub) used to solve this called <code>concurrent-map</code> <a href=\"https://github.com/orcaman/concurrent-map\" rel=\"nofollow noreferrer\">here</a> which has performance and usability in mind. You could use it to handle the concurrency issues for you. </li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 579, "user_id": 1608682, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/pVLpr.jpg?s=128&g=1", "display_name": "I.Tyger", "link": "https://stackoverflow.com/users/1608682/i-tyger"}, "is_accepted": false, "score": 2, "last_activity_date": 1543354988, "creation_date": 1543354988, "answer_id": 53508626, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/53508626#53508626", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>After long discussion it was decided that the typical use of maps did not require safe access from multiple goroutines, and in those cases where it did, the map was probably part of some larger data structure or computation that was already synchronized. Therefore requiring that all map operations grab a mutex would slow down most programs and add safety to few. This was not an easy decision, however, since it means uncontrolled map access can crash the program.</p>\n\n<p>The language does not preclude atomic map updates. When required, such as when hosting an untrusted program, the implementation could interlock map access.</p>\n\n<p>Map access is unsafe only when updates are occurring. As long as all goroutines are only reading\u2014looking up elements in the map, including iterating through it using a for range loop\u2014and not changing the map by assigning to elements or doing deletions, it is safe for them to access the map concurrently without synchronization.</p>\n\n<p>As an aid to correct map use, some implementations of the language contain a special check that automatically reports at run time when a map is modified unsafely by concurrent execution.</p>\n"}, {"comments": [{"owner": {"reputation": 5469, "user_id": 598940, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/3665d076aec49bf74e33d162bde6a710?s=128&d=identicon&r=PG", "display_name": "Alec", "link": "https://stackoverflow.com/users/598940/alec"}, "edited": false, "score": 1, "creation_date": 1587053309, "post_id": 60163006, "comment_id": 108364192, "body": "Note that <code>sync.Map</code> is only intended for specific use cases where lock contention ends up being a bottleneck. For most usual cases, a native map with a mutex is recommended: &quot;The Map type is specialized. Most code should use a plain Go map instead, with separate locking or coordination, for better type safety and to make it easier to maintain other invariants along with the map content.&quot; <a href=\"https://golang.org/pkg/sync/#Map\" rel=\"nofollow noreferrer\">golang.org/pkg/sync/#Map</a>"}], "tags": [], "owner": {"reputation": 25, "user_id": 12752366, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-23WV5OkANTE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcZJYSxHFUZx0cNc-vDj9HjbeP3Ww/photo.jpg?sz=128", "display_name": "Palash Nigam", "link": "https://stackoverflow.com/users/12752366/palash-nigam"}, "is_accepted": false, "score": 2, "last_activity_date": 1581401916, "creation_date": 1581401916, "answer_id": 60163006, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations/60163006#60163006", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>You can use <code>sync.Map</code> which is safe for concurrent use. The only caveat is that you are gonna give up on type safety and change all the reads and writes to your map to use the methods defined for this type</p>\n"}], "owner": {"reputation": 1149, "user_id": 2763030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0757000fd120a9eff6e9474bc785e3b5?s=128&d=identicon&r=PG&f=1", "display_name": "John D.", "link": "https://stackoverflow.com/users/2763030/john-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80611, "favorite_count": 23, "answer_count": 7, "score": 67, "last_activity_date": 1581401916, "creation_date": 1458689736, "question_id": 36167200, "link": "https://stackoverflow.com/questions/36167200/how-safe-are-golang-maps-for-concurrent-read-write-operations", "title": "How safe are Golang maps for concurrent Read/Write operations?", "body": "<p>According to the Go blog,</p>\n\n<blockquote>\n  <p>Maps are not safe for concurrent use: it's not defined what happens when you read and write to them simultaneously. If you need to read from and write to a map from concurrently executing goroutines, the accesses must be mediated by some kind of synchronization mechanism.\n  (source: <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"noreferrer\">https://blog.golang.org/go-maps-in-action</a>)</p>\n</blockquote>\n\n<p>Can anyone elaborate on this? Concurrent read operations seem permissible across routines, but concurrent read/write operations may generate a race condition if one attempts to read from and write to the same key.</p>\n\n<p>Can this last risk be reduced in some cases? For example: </p>\n\n<ul>\n<li>Function A generates k and sets m[k]=0. This is the only time A writes to map m. k is known to not be in m.</li>\n<li>A passes k to function B running concurrently</li>\n<li>A then reads m[k]. If m[k]==0, it waits, continuing only when m[k]!=0</li>\n<li>B looks for k in the map. If it finds it, B sets m[k] to some positive integer. If it doesn't it waits until k is in m.</li>\n</ul>\n\n<p>This isn't code (obviously) but I think it shows the outlines of a case where even if A and B both try to access m there won't be a race condition, or if there is it won't matter because of the additional constraints.</p>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 1, "creation_date": 1458688802, "post_id": 36166967, "comment_id": 59971310, "body": "What is a &quot;database ID&quot; in this context? Columns have names, not Ids. It looks like you&#39;re storing enums in a database but duplicating them in code as well? If so, then stick with one and ditch the other (and I don&#39;t recommend storing trivial key/value pairs in a database table unless they&#39;re mutable)."}], "answers": [{"tags": [], "owner": {"reputation": 13237, "user_id": 611545, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/YXVOl.jpg?s=128&g=1", "display_name": "Ross Bush", "link": "https://stackoverflow.com/users/611545/ross-bush"}, "is_accepted": true, "score": 1, "last_activity_date": 1458689219, "creation_date": 1458689219, "answer_id": 36167105, "question_id": 36166967, "link": "https://stackoverflow.com/questions/36166967/what-is-best-practice-for-defining-database-id-constants-vars/36167105#36167105", "title": "What is best practice for defining database ID constants/vars", "body": "<p>Your are likely to get wildly different answers on this as it merely boils down to preference. I would not consider this to be an example of a bad practice. If you are not using a orm mapper then constants or enums would be a good way to represent \"typeification\".  There are two questions you should ask yourself. </p>\n\n<ol>\n<li>Will the values change once established.</li>\n<li>Will there need to be loose coupling between the code and the database.</li>\n</ol>\n\n<p>If the answer to #1 is yes then I would look into pulling your values from a type table as it would be counter intuitive having constants or enumerations in the first place. (If the types are core to your application and no other client applications need to be modified when values are added then this would be easier to maintain and use in logic comparisons)</p>\n\n<p>If the answer to #2 is yes then I would look into an orm mapper or other ways to express your constant range dynamically. If you can't respond to changes to the database then that puts you in a predicament.</p>\n"}], "owner": {"reputation": 3, "user_id": 1757830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ffb63d09e96337bcd3d6f7ce6d50493?s=128&d=identicon&r=PG", "display_name": "user1757830", "link": "https://stackoverflow.com/users/1757830/user1757830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 36167105, "answer_count": 1, "score": 0, "last_activity_date": 1458689219, "creation_date": 1458688414, "question_id": 36166967, "link": "https://stackoverflow.com/questions/36166967/what-is-best-practice-for-defining-database-id-constants-vars", "title": "What is best practice for defining database ID constants/vars", "body": "<p>I find that when I am working on a project it often simplifies things to define variables or constants that represent database ID fields. In golang I have a constants.go file with </p>\n\n<pre><code>const (\n   //SELECT ID FROM dbo.MyTable\n   MYTABLEID_NO    = 1 // MyTable ID for NO\n   MYTABLEID_YES   = 2 // MyTable ID for YES\n   MYTABLEID_MAYBE = 3 // MyTable ID for MAYBE\n)\n</code></pre>\n\n<p>Is this considered bad practice? how might I get around doing this if it is? Is there a more dynamic way of doing this in golang? If for some reason an ID changes, new IDs are added or the table has many IDs this way of doing things starts to break down.</p>\n"}, {"tags": ["networking", "go"], "comments": [{"owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 1, "creation_date": 1458688158, "post_id": 36166791, "comment_id": 59971062, "body": "Maybe <b><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/IrfXFTUavXE\" rel=\"nofollow noreferrer\"><code>this</code></a></b> link can help you?"}, {"owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "reply_to_user": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "edited": false, "score": 0, "creation_date": 1458691952, "post_id": 36166791, "comment_id": 59972399, "body": "I had looked at the beginning of that thread, but hadn&#39;t made it all the way through to the end where the goods are. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "is_accepted": true, "score": 2, "last_activity_date": 1458692128, "creation_date": 1458692128, "answer_id": 36167611, "question_id": 36166791, "link": "https://stackoverflow.com/questions/36166791/how-to-get-broadcast-address-of-ipv4-net-ipnet/36167611#36167611", "title": "How to Get Broadcast Address of (IPv4) net.IPNet?", "body": "<p>The link @Dsafds has the answer. Here for history's sake, and so you don't have to read through the thread yourself. Code is Mikio Hara's with minor modifications made by me.</p>\n\n<pre><code>func lastAddr(n *net.IPNet) (net.IP, error) { // works when the n is a prefix, otherwise...\n    if n.IP.To4() == nil {\n        return net.IP{}, errors.New(\"does not support IPv6 addresses.\")\n    }\n    ip := make(net.IP, len(n.IP.To4()))\n    binary.BigEndian.PutUint32(ip, binary.BigEndian.Uint32(n.IP.To4())|^binary.BigEndian.Uint32(net.IP(n.Mask).To4()))\n    return ip, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "accepted_answer_id": 36167611, "answer_count": 1, "score": 0, "last_activity_date": 1461621211, "creation_date": 1458687369, "last_edit_date": 1461621211, "question_id": 36166791, "link": "https://stackoverflow.com/questions/36166791/how-to-get-broadcast-address-of-ipv4-net-ipnet", "title": "How to Get Broadcast Address of (IPv4) net.IPNet?", "body": "<p>Is there a built-in function to calculate the broadcast address of a <code>net.IPNet</code> struct?</p>\n"}, {"tags": ["git", "heroku", "go", "heroku-toolbelt"], "answers": [{"comments": [{"owner": {"reputation": 2900, "user_id": 581665, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a7d3308cfeb7ab814b0580de19ccc5f?s=128&d=identicon&r=PG", "display_name": "mbb", "link": "https://stackoverflow.com/users/581665/mbb"}, "edited": false, "score": 0, "creation_date": 1458711164, "post_id": 36166709, "comment_id": 59977671, "body": "I appreciate you posting the word took nevertheless. +1"}], "tags": [], "owner": {"reputation": 563, "user_id": 2276005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e8901c03bd5b909cb7abae832c993cb?s=128&d=identicon&r=PG", "display_name": "WolfTivy", "link": "https://stackoverflow.com/users/2276005/wolftivy"}, "is_accepted": false, "score": 4, "last_activity_date": 1458687005, "creation_date": 1458687005, "answer_id": 36166709, "question_id": 36166620, "link": "https://stackoverflow.com/questions/36166620/heroku-local-is-not-using-my-latest-code-why/36166709#36166709", "title": "Heroku local is not using my latest code. Why?", "body": "<p>The problem is that golang is a compiled language, and <code>heroku local</code> just uses the last build and does not initiate the rebuild on its own. The fix is to simply remember to compile before running <code>heroku local</code>:</p>\n\n<pre><code>$ go install\n</code></pre>\n\n<p>It is easy to forget this if you use <code>go run web.go</code> for testing, because that doesn't need a recompile, and heroku itself automatically does the build, so you could get away with never running <code>go install</code> until you try to use <code>heroku local</code>.</p>\n\n<p>(I actually figured this out as soon as I had the whole question written out, but I figured I should post anyways for future reference.)</p>\n"}], "owner": {"reputation": 563, "user_id": 2276005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e8901c03bd5b909cb7abae832c993cb?s=128&d=identicon&r=PG", "display_name": "WolfTivy", "link": "https://stackoverflow.com/users/2276005/wolftivy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1458687005, "creation_date": 1458686518, "question_id": 36166620, "link": "https://stackoverflow.com/questions/36166620/heroku-local-is-not-using-my-latest-code-why", "title": "Heroku local is not using my latest code. Why?", "body": "<p>I'm trying to get a very simple database-backed golang heroku app working as a hello world.</p>\n\n<p>The deployed Heroku version of my app is working perfectly, and if I manually test it locally, it works perfectly, but <code>heroku local</code> is stubbornly using an old version of my code. Specifically:</p>\n\n<pre><code>$ heroku local\nforego | starting web.1 on port 8080\n</code></pre>\n\n<p>works, but unexpectedly serves an older version of the app. On the other hand, this:</p>\n\n<pre><code>$ go run web.go\n</code></pre>\n\n<p>and this:</p>\n\n<pre><code>$ git push heroku master\nEverything up-to-date\n$ heroku open\n</code></pre>\n\n<p>both serve what I expect, which is the latest version of my code.</p>\n\n<p>This is really confusing me. I've read all the documentation and double checked the state of everything, and can't find anything that indicates what is going on, or which could cause it.</p>\n\n<p>My best guess are that <code>heroku local</code> is using a compiled slug from somewhere that is not getting updated.</p>\n"}, {"tags": ["networking", "go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1458681474, "creation_date": 1458681474, "answer_id": 36165417, "question_id": 36165121, "link": "https://stackoverflow.com/questions/36165121/getting-flags-from-a-network-interface/36165417#36165417", "title": "Getting Flags From a Network Interface", "body": "<p><a href=\"https://godoc.org/net#Interface\" rel=\"noreferrer\"><code>net.Interface.Flags</code></a> is a bitmask. To see if an interface has a certain flag, use the <a href=\"https://golang.org/ref/spec#Arithmetic_operators\" rel=\"noreferrer\">bitwise AND operator</a> (<code>&amp;</code>). For example:</p>\n\n<pre><code>if i.Flags&amp;net.FlagBroadcast != 0 {\n    // interface has broadcast\n}\n</code></pre>\n"}], "owner": {"reputation": 3465, "user_id": 1342445, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7ZNEn.jpg?s=128&g=1", "display_name": "pnovotnak", "link": "https://stackoverflow.com/users/1342445/pnovotnak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 36165417, "answer_count": 1, "score": 4, "last_activity_date": 1458681474, "creation_date": 1458680437, "question_id": 36165121, "link": "https://stackoverflow.com/questions/36165121/getting-flags-from-a-network-interface", "title": "Getting Flags From a Network Interface", "body": "<p>Looking at the net/interface.go code it seems like the only way to get interface flags is as strings. Is this true?</p>\n\n<pre><code>if strings.Contains(i.Flags.String(), \"broadcast\") {\n</code></pre>\n\n<p>Feels gross.</p>\n"}, {"tags": ["ios", "go", "react-native"], "answers": [{"tags": [], "owner": {"reputation": 3445, "user_id": 3543861, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jrwvB.jpg?s=128&g=1", "display_name": "MSU_Bulldog", "link": "https://stackoverflow.com/users/3543861/msu-bulldog"}, "is_accepted": false, "score": 3, "last_activity_date": 1458677313, "creation_date": 1458677313, "answer_id": 36164188, "question_id": 36164059, "link": "https://stackoverflow.com/questions/36164059/is-it-possible-to-create-an-ios-app-with-go-without-swift-or-objective-c/36164188#36164188", "title": "Is it possible to create an iOS app with Go without Swift or Objective-C?", "body": "<p>There are alternatives to native iOS apps without Swift or Obj-c, such as HTML5, Xamarin (C#), PhoneGap, Cordova, etc. but these alternatives have sacrifices.  </p>\n\n<p>Most of your extra coding time would be invested in workarounds to make these alternative technologies work. If you want your app to perform better than a web app, then you should use Obj-C or Swift.</p>\n"}, {"tags": [], "owner": {"reputation": 1760, "user_id": 5352909, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207444242405314/picture?type=large", "display_name": "Nishanth Shankar", "link": "https://stackoverflow.com/users/5352909/nishanth-shankar"}, "is_accepted": false, "score": 1, "last_activity_date": 1458684009, "creation_date": 1458684009, "answer_id": 36166058, "question_id": 36164059, "link": "https://stackoverflow.com/questions/36164059/is-it-possible-to-create-an-ios-app-with-go-without-swift-or-objective-c/36166058#36166058", "title": "Is it possible to create an iOS app with Go without Swift or Objective-C?", "body": "<p>You can build basic (and more with packages) iOS/Android apps using react-native. It is a great tool to build iOS apps using js. There are loads of modules and community support (<a href=\"https://js.coach/\" rel=\"nofollow\">https://js.coach/</a>) to help you build out of the basics. I've been building apps on react-native and the result is on par with native apps. There is a small learning curve in react-native but it is definitely worth it</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 1, "last_activity_date": 1476119105, "last_edit_date": 1495535358, "creation_date": 1476076786, "answer_id": 39951682, "question_id": 36164059, "link": "https://stackoverflow.com/questions/36164059/is-it-possible-to-create-an-ios-app-with-go-without-swift-or-objective-c/39951682#39951682", "title": "Is it possible to create an iOS app with Go without Swift or Objective-C?", "body": "<p>This is good question, and I did many research on this, results:</p>\n\n<p>The most promising option in Golang is: <a href=\"https://godoc.org/golang.org/x/mobile/app\" rel=\"nofollow noreferrer\">Package app lets you write portable all-Go apps for Android and iOS</a></p>\n\n<hr>\n\n<p>Most applications in Apple\u2019s App Store are written in the Objective-C and Swift programming languages, and developers typically use Xcode to develop their applications (<a href=\"https://www.smashingmagazine.com/2013/11/four-ways-to-build-a-mobile-app-part1-native-ios/\" rel=\"nofollow noreferrer\">Four Ways To Build A Mobile Application, Part 1: Native iOS</a>).</p>\n\n<hr>\n\n<p>There are some cross-platform options:<br>\n- <a href=\"https://facebook.github.io/react-native/\" rel=\"nofollow noreferrer\">React Native</a><br>\n- <a href=\"http://cordova.apache.org/docs/en/5.1.1/guide/platforms/ios/index.html\" rel=\"nofollow noreferrer\">Building HTML5 mobile apps with the Ionic Framework</a><br>\n- <a href=\"https://developer.xamarin.com/guides/ios/getting_started/\" rel=\"nofollow noreferrer\">Xamarin.iOS</a><br>\n- <a href=\"https://www.embarcadero.com/products/rad-studio/ios-development\" rel=\"nofollow noreferrer\">Develop iOS applications with RAD Studio</a><br>\n- <a href=\"http://phonegap.com/getstarted/\" rel=\"nofollow noreferrer\">PhoneGap, build cross-platform apps using HTML, CSS and Javascript</a><br>\n- <a href=\"http://cordova.apache.org/docs/en/latest/guide/platforms/ios/index.html\" rel=\"nofollow noreferrer\">Cordova apps for iOS</a><br>\n- <a href=\"http://www.adobe.com/devnet/air/air_for_ios.html\" rel=\"nofollow noreferrer\">Adobe AIR for iOS, built with ActionScript and Flash as iOS apps</a>  </p>\n\n<hr>\n\n<p>Some relative questions:<br>\n<a href=\"https://stackoverflow.com/questions/3369413/developing-cross-platform-mobile-application\">Developing cross platform mobile application</a><br>\n<a href=\"https://stackoverflow.com/questions/31109022/how-to-build-a-cross-platform-app\">How to build a cross platform app</a><br>\n<a href=\"https://stackoverflow.com/questions/2353305/building-cross-platform-app-recommendation\">Building Cross Platform app - recommendation</a><br>\n<a href=\"https://stackoverflow.com/questions/30048820/react-native-v-xamarin-forms-choosing-cross-platform-app-environment\">React Native v Xamarin Forms - Choosing Cross Platform App Environment</a><br>\n<a href=\"https://stackoverflow.com/questions/8460037/list-of-delphi-language-features-and-version-in-which-they-were-introduced-depre\">List of Delphi language features and version in which they were introduced/deprecated</a>  </p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2495, "favorite_count": 1, "closed_date": 1512454787, "accepted_answer_id": 39951682, "answer_count": 3, "score": 3, "last_activity_date": 1512454665, "creation_date": 1458676866, "last_edit_date": 1476077059, "question_id": 36164059, "link": "https://stackoverflow.com/questions/36164059/is-it-possible-to-create-an-ios-app-with-go-without-swift-or-objective-c", "closed_reason": "Needs more focus", "title": "Is it possible to create an iOS app with Go without Swift or Objective-C?", "body": "<p>I will soon start mobile development on iOS and I would like to know if it possible to create an app with Go along with React Native \u200b\u200b(for example) without using Swift or Objective-C.</p>\n\n<p>I searched for answers about Quora and Google, but none are precise enough.</p>\n"}, {"tags": ["google-app-engine", "go"], "owner": {"reputation": 1954, "user_id": 110844, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4afd458cb202c0a2e566e569f753765?s=128&d=identicon&r=PG", "display_name": "Ecognium", "link": "https://stackoverflow.com/users/110844/ecognium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1458675894, "creation_date": 1458675894, "question_id": 36163762, "link": "https://stackoverflow.com/questions/36163762/app-engine-blob-store-url-response-in-production-differs-from-development", "title": "App Engine Blob Store URL Response in Production Differs From Development", "body": "<p>I am using Go SDK (<code>1.9.34 - 2016-03-15</code>) on App Engine. The blobstore api was working correctly in both dev and production but now it seems to return different results, which now breaks the upload. </p>\n\n<p>When I use this code in dev (using <code>goapp serve</code>) and production I get different results. The <code>GET</code> request comes with a parameter, which I extract and add it to the upload URL. </p>\n\n<pre><code>c          := appengine.NewContext(r)\nupUrl, err := blobstore.UploadURL(c, \"/upload\", nil)\nc.Infof(\"Upload url = %+v\", upUrl)\n\nif (err != nil) { //error handling here }\n\nparam      := r.FormValue(\"param\")\nq          := upUrl.Query()\nq.Set(\"param\", param)\nupUrl.RawQuery = q.Encode()\nc.Infof(\"Upload url after query  = %+v\", upUrl)\n</code></pre>\n\n<p>In <code>Dev</code> I get (this is the intended behavior): </p>\n\n<pre><code>Upload url = http://localhost:8080/_ah/upload/RANDOMSTRING\nUpload url after query = http://localhost:8080/_ah/upload/RANDOMSTRING?param=99\n</code></pre>\n\n<p>In <code>Prod</code> I get (incorrect upload url is being constructed):</p>\n\n<pre><code>Upload url = https://www.example.com/_ah/upload/?param=99/RANDOMSTRING1/RANDOMSTRING2/\nUpload url after query = https://www.example.com/_ah/upload/?param=99\n</code></pre>\n\n<p>I know it is recommended to use Cloud Storage instead of blobstore but this is a legacy code so I don't want to change it right now. It was working fine a couple of weeks back and just noticed a difference. I upgrade from an older SDK to newer one (the results are based on the latest SDK) but still made no difference. </p>\n\n<p>Any suggestions on what could be going wrong?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["macos", "go", "gzip"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1458675421, "post_id": 36163519, "comment_id": 59964373, "body": "&lt;strike&gt;Can you try go 1.6?&lt;/strike&gt;"}, {"owner": {"reputation": 175, "user_id": 4219537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89bcc75841a5c4da353fc4edbe24b4b5?s=128&d=identicon&r=PG&f=1", "display_name": "mansfield", "link": "https://stackoverflow.com/users/4219537/mansfield"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1458675565, "post_id": 36163519, "comment_id": 59964466, "body": "Not yet. There are no references to bug fixes in the release history, but I can try and see what happens. Also, in the original version of the question, I said that it worked on my cluster, but upon retesting, I found that I was in the wrong directory when I ran the test and that I get the same results on the cluster."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1458675621, "post_id": 36163519, "comment_id": 59964485, "body": "I just tested, it doesn&#39;t work on go1.4 -&gt; tip, it might be a bug, worth filing an issue on the bug tracker."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458675914, "post_id": 36163519, "comment_id": 59964645, "body": "You&#39;re not reading until EOF. BTW, there&#39;s <a href=\"https://golang.org/pkg/bytes/#Equal\" rel=\"nofollow noreferrer\"><code>bytes.Equal</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 4219537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89bcc75841a5c4da353fc4edbe24b4b5?s=128&d=identicon&r=PG&f=1", "display_name": "mansfield", "link": "https://stackoverflow.com/users/4219537/mansfield"}, "edited": false, "score": 0, "creation_date": 1458676066, "post_id": 36163755, "comment_id": 59964752, "body": "Yes, this fixed it completely. Silly me, forgetting my fundamentals. Thank you!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1458676887, "last_edit_date": 1592644375, "creation_date": 1458675866, "answer_id": 36163755, "question_id": 36163519, "link": "https://stackoverflow.com/questions/36163519/cannot-gzip-slices-with-more-than-32768-bytes-in-go-1-5-on-mac-os-x/36163755#36163755", "title": "Cannot gzip slices with more than 32768 bytes in Go 1.5 on Mac OS X", "body": "<p>The problem is in this line:</p>\n<pre><code>reader.Read(out)\n</code></pre>\n<p>There is no guarantee that <a href=\"https://golang.org/pkg/compress/gzip/#Reader.Read\" rel=\"nofollow noreferrer\"><code>Reader.Read()</code></a> will read the whole <code>out</code> slice <em>in one step</em>.</p>\n<p><a href=\"https://golang.org/pkg/compress/gzip/#Reader.Read\" rel=\"nofollow noreferrer\"><code>gzip.Reader.Read()</code></a> is to implement <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader.Read()</code></a>.<br />\nQuoting from its doc (the <em>&quot;general contract&quot;</em>):</p>\n<blockquote>\n<pre><code>Read(p []byte) (n int, err error)\n</code></pre>\n<p>Read reads <strong>up to</strong> len(p) bytes into p.</p>\n</blockquote>\n<p>There is no guarantee that <code>Reader.Read()</code> will read until <code>out</code> is filled, it may stop at fewer bytes if the implementation wishes so (even if EOF is not reached). If you pass a &quot;big&quot; slice, this may easily happen if an internal cache of the implementation is exhausted. <code>Read()</code> returns the number of read bytes (and an <code>error</code>), you may use that to check if the full slice was read.</p>\n<p>Or even better, instead you may use <a href=\"https://golang.org/pkg/io/#ReadFull\" rel=\"nofollow noreferrer\"><code>io.ReadFull()</code></a> to make sure <code>out</code> is read fully:</p>\n<pre><code>if _, err = io.ReadFull(reader, out); err != nil {\n    t.Errorf(&quot;Error reading full out slice:&quot;, err)\n}\n</code></pre>\n<p>By applying this change, your test passes.</p>\n"}], "owner": {"reputation": 175, "user_id": 4219537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89bcc75841a5c4da353fc4edbe24b4b5?s=128&d=identicon&r=PG&f=1", "display_name": "mansfield", "link": "https://stackoverflow.com/users/4219537/mansfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 36163755, "answer_count": 1, "score": 3, "last_activity_date": 1458676887, "creation_date": 1458675125, "last_edit_date": 1458675472, "question_id": 36163519, "link": "https://stackoverflow.com/questions/36163519/cannot-gzip-slices-with-more-than-32768-bytes-in-go-1-5-on-mac-os-x", "title": "Cannot gzip slices with more than 32768 bytes in Go 1.5 on Mac OS X", "body": "<p>I am trying to compress byte slices in Go using <code>compress/gzip</code>. Whenever I  compress slices with lengths longer than 2^15 on my laptop, every byte with an index of 2^15 or greater is set to 0 after decompression. When I run the same code on my research cluster it also breaks.</p>\n\n<p>Calling <code>go version</code> on my laptop prints:</p>\n\n<pre><code>$ go version\ngo version go1.5 darwin/amd64\n</code></pre>\n\n<p>Calling <code>go version</code> on the cluster prints:</p>\n\n<pre><code>$ go version\ngo version go1.3.3 linux/amd64\n</code></pre>\n\n<p>Below is a demonstrative test file that I wrote. It generates random slices of different lengths, compresses them, then decompresses them. It checks that no calls returns errors and also checks that the compressed and decompressed slices are the same:</p>\n\n<pre><code>package compress\n\nimport (\n    \"bytes\"\n    \"compress/gzip\"\n    \"math/rand\"\n    \"testing\"\n)\n\nfunc byteSliceEq(xs, ys []byte) bool {\n    if len(xs) != len(ys) { return false }\n    for i := range xs {\n        if xs[i] != ys[i] { return false }\n    }\n    return true\n}\n\nfunc TestGzip(t *testing.T) {\n    tests := []struct {\n        n int\n    }{\n        { 1&lt;&lt;10 },\n        { 1&lt;&lt;15 },\n        { 1&lt;&lt;15 + 1 },\n        { 1&lt;&lt;20 },\n\n    }\n\n    rand.Seed(0)\n\n    for i := range tests {\n        n := tests[i].n\n\n        in, out := make([]byte, n), make([]byte, n)\n        buf := &amp;bytes.Buffer{}\n        for i := range in { in[i] = byte(rand.Intn(256)) }\n\n        writer := gzip.NewWriter(buf)\n        _, err := writer.Write(in)\n        if err != nil {\n            t.Errorf(\"%d) n = %d: writer.Write() error: %s\",\n                i + 1, n, err.Error())\n        }\n        err = writer.Close()\n        if err != nil {\n            t.Errorf(\"%d) n = %d: writer.Close() error: %s\",\n                i + 1, n, err.Error())\n        }\n\n        reader, err := gzip.NewReader(buf)\n        if err != nil {\n            t.Errorf(\"%d) n = %d: gzip.NewReader error: %s\",\n                i + 1, n, err.Error())\n        }\n        reader.Read(out)\n        err = reader.Close()\n        if err != nil {\n            t.Errorf(\"%d) n = %d: reader.Close() error: %s\",\n                i + 1, n, err.Error())\n        }\n\n        if !byteSliceEq(in, out) {\n            idx := -1\n            for i := range in {\n                if in[i] != out[i] {\n                    idx = i\n                    break\n                }\n            }\n            t.Errorf(\"%d) n = %d: in[%d] = %d, but out[%d] = %d\",\n                i + 1, n, idx, in[idx], idx, out[idx])\n        }\n    }\n}\n</code></pre>\n\n<p>When I run this test, I get the following output:</p>\n\n<pre><code>$ go test --run \"TestGzip\"\n--- FAIL: TestGzip (0.12s)\n    gzip_test.go:77: 3) n = 32769: in[32768] = 78, but out[32768] = 0\n    gzip_test.go:77: 4) n = 1048576: in[32768] = 229, but out[32768] = 0\nFAIL\nexit status 1\n</code></pre>\n\n<p>Does anyone know what is going on here? Am I misusing the package in some way? Let me know if I haven't given enough information.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 0, "creation_date": 1458669321, "post_id": 36161777, "comment_id": 59960630, "body": "A vanity package path? I like that term. Thanks for your help."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 1, "creation_date": 1458669450, "post_id": 36161777, "comment_id": 59960719, "body": "The Go team uses the term &quot;vanity path&quot; when referring to the feature."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1458670493, "last_edit_date": 1458670493, "creation_date": 1458669218, "answer_id": 36161777, "question_id": 36161565, "link": "https://stackoverflow.com/questions/36161565/how-does-go-get-work-when-given-a-not-known-code-hosting-domain-site/36161777#36161777", "title": "How does &#39;go get&#39; work when given a not known code hosting domain site?", "body": "<p>The command <code>curl -D --raw 'https://robpike.io/ivy?go-get=1'</code> returns an HTML document containing the tag </p>\n\n<pre><code>&lt;meta name=\"go-import\" content=\"robpike.io/ivy git https://github.com/robpike/ivy.git\"&gt;\n</code></pre>\n\n<p>The <code>go get</code> command uses this meta tag to resolve the vanity import path to an actual git repository. You can do the same.</p>\n"}, {"comments": [{"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 0, "creation_date": 1458669435, "post_id": 36161785, "comment_id": 59960712, "body": "I got bitten by the escape character bug : <code>curl -D --raw https:&#47;&#47;robpike.io&#47;ivy\\?go-get\\=1</code>. Thank you for timely reply. I appreciate it."}, {"owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "reply_to_user": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 1, "creation_date": 1458669809, "post_id": 36161785, "comment_id": 59960953, "body": "Ah yes. My zsh config automatically escapes input when I paste it in."}, {"owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 0, "creation_date": 1458670085, "post_id": 36161785, "comment_id": 59961142, "body": "I use zsh. Would you mind sharing the line that does that?"}, {"owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "reply_to_user": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "edited": false, "score": 1, "creation_date": 1458670832, "post_id": 36161785, "comment_id": 59961600, "body": "I&#39;m using <a href=\"https://github.com/sorin-ionescu/prezto\" rel=\"nofollow noreferrer\">prezto</a> not sure exactly which line fixes that."}], "tags": [], "owner": {"reputation": 3761, "user_id": 142020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vKJEv.png?s=128&g=1", "display_name": "T0xicCode", "link": "https://stackoverflow.com/users/142020/t0xiccode"}, "is_accepted": true, "score": 2, "last_activity_date": 1458669831, "last_edit_date": 1458669831, "creation_date": 1458669226, "answer_id": 36161785, "question_id": 36161565, "link": "https://stackoverflow.com/questions/36161565/how-does-go-get-work-when-given-a-not-known-code-hosting-domain-site/36161785#36161785", "title": "How does &#39;go get&#39; work when given a not known code hosting domain site?", "body": "<p>That last command you entered does return data. When I run <code>curl -D --raw https://robpike.io/ivy\\?go-get\\=1</code> in my terminal, I get the following data back:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;meta name=\"go-import\" content=\"robpike.io/toy git https://github.com/robpike/toy.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/translate git https://github.com/robpike/translate.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/freq git https://github.com/robpike/freq.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/hira git https://github.com/robpike/hira.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/kana git https://github.com/robpike/kana.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/kata git https://github.com/robpike/kata.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/nihongo git https://github.com/robpike/nihongo.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/typo git https://github.com/robpike/typo.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/filter git https://github.com/robpike/filter.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/unicode git https://github.com/robpike/unicode.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/doc git https://github.com/robpike/doc.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/scrub git https://github.com/robpike/scrub.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/strings git https://github.com/robpike/strings.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/ivy git https://github.com/robpike/ivy.git\"&gt;&lt;meta name=\"go-import\" content=\"robpike.io/cmd/now git https://github.com/robpike/now.git\"&gt;\n</code></pre>\n\n<p>Ths allows the go get command to resolve the vanity path to git repositories.</p>\n"}], "owner": {"reputation": 4844, "user_id": 666818, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/uixCu.jpg?s=128&g=1", "display_name": "Laurent", "link": "https://stackoverflow.com/users/666818/laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 36161785, "answer_count": 2, "score": 1, "last_activity_date": 1458670493, "creation_date": 1458668547, "question_id": 36161565, "link": "https://stackoverflow.com/questions/36161565/how-does-go-get-work-when-given-a-not-known-code-hosting-domain-site", "title": "How does &#39;go get&#39; work when given a not known code hosting domain site?", "body": "<p>Let's take an example. The command below will do:</p>\n\n<p><code>go get robpike.io/ivy</code></p>\n\n<p>This will get me the content of the repository under $GOPATH/src. Great!</p>\n\n<p>Now, how does it work?</p>\n\n<p>First, robpike.io/ivy replies with a HTTP-redirect:</p>\n\n<p><code>HTTP/1.1 302 Found</code></p>\n\n<p><code>&lt;a href=\"http://godoc.org/robpike.io/ivy\"&gt;Found&lt;/a&gt;</code></p>\n\n<p>From reading at <code>go help importpath</code>, I learn that:</p>\n\n<blockquote>\n  <p>If the import path is not a known code hosting site and also lacks a\n  version control qualifier, the go tool attempts to fetch the import\n  over https/http and looks for a  tag in the document's HTML</p>\n</blockquote>\n\n<p>However, looking for a metatag inside the content of the redirected page using:</p>\n\n<p><code>curl -D --raw https://godoc.org/robpike.io/ivy | grep go-import</code></p>\n\n<p>returns nothing.</p>\n\n<p>Reading further:</p>\n\n<blockquote>\n  <p>The repo-root is the root of the version control system containing a\n  scheme and not containing a .vcs qualifier.</p>\n  \n  <p>For example,</p>\n  \n  <p>import \"example.org/pkg/foo\"</p>\n  \n  <p>will result in the following requests:</p>\n  \n  <p><a href=\"https://example.org/pkg/foo?go-get=1\" rel=\"nofollow\">https://example.org/pkg/foo?go-get=1</a> (preferred)</p>\n  \n  <p><a href=\"http://example.org/pkg/foo?go-get=1\" rel=\"nofollow\">http://example.org/pkg/foo?go-get=1</a>  (fallback, only with -insecure)</p>\n</blockquote>\n\n<p>Again:</p>\n\n<p><code>curl -D --raw https://robpike.io/ivy?go-get=1</code></p>\n\n<p>returns nothing.</p>\n\n<p>So the question is: how can I do the same thing as Mr. Rob Pike and use my own site with the <code>go get</code> command?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1458668092, "post_id": 36161340, "comment_id": 59959802, "body": "do you mean, like a flag or environment variable?"}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1458687611, "post_id": 36161559, "comment_id": 59970856, "body": "To add, you can also read it from the client as well. Just have the application expect it from a connection."}], "tags": [], "owner": {"reputation": 11415, "user_id": 675311, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/5e4575fdaacc879dc2199490417d170a?s=128&d=identicon&r=PG", "display_name": "bigblind", "link": "https://stackoverflow.com/users/675311/bigblind"}, "is_accepted": false, "score": 1, "last_activity_date": 1458668532, "last_edit_date": 1495539909, "creation_date": 1458668532, "answer_id": 36161559, "question_id": 36161340, "link": "https://stackoverflow.com/questions/36161340/setting-values-in-go-application-at-runtime/36161559#36161559", "title": "Setting Values in Go Application at Runtime", "body": "<p>If the location is not set, you'll need to read it in some way.</p>\n\n<ul>\n<li>You might want to read it from a command line flag passed in when running the command. The easiest way to do that is using the <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">flag</a> package.</li>\n<li>You could read it from STDIN. The top answer to <a href=\"https://stackoverflow.com/questions/20895552/how-to-read-input-from-console-line\">this question</a> nicely explains how to do that.</li>\n<li>You could read it from an environment variable. Check out the <a href=\"https://golang.org/src/os/env.go?s=3349:3372#L105\" rel=\"nofollow noreferrer\">Environ function in the os package</a>.</li>\n</ul>\n"}], "owner": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458668532, "creation_date": 1458667928, "question_id": 36161340, "link": "https://stackoverflow.com/questions/36161340/setting-values-in-go-application-at-runtime", "title": "Setting Values in Go Application at Runtime", "body": "<p>I'm writing a go application that writes values to a file.</p>\n\n<p>However, I want the location of that file to be determined at runtime (i.e. not set as part of the application code).</p>\n\n<p>I have create a test client for the application and I want the client to tell the application which file it should write to.</p>\n\n<p>Can anyone tell me how I would go about this in Go? </p>\n\n<p>Thanks,</p>\n\n<p>Sean</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1458667118, "post_id": 36160825, "comment_id": 59959164, "body": "Read the csv, transform the data, write it back. Cannot be done inplace."}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458667544, "post_id": 36160825, "comment_id": 59959417, "body": "Normally, modifying a text file in place is considered difficult because the text being substituted may not be the same size as the original.  In your example, Second and Change are both six bytes long.  Probably a happy coincidence.  You probably want to read all the data in and then write it all out again.  If you&#39;re sure you want to modify the file in place, you could try using syscall.Mmap() but I&#39;ve only used it for reading files and it might not be available for all platforms - and it doesn&#39;t seem  appropriate for the average CSV file."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1458675334, "post_id": 36160825, "comment_id": 59964327, "body": "One optimization is to only write back modified data and everything after it. For example, if you have a large file but are only modifying the 2nd to last entry: you would (1) read the last two entries, (2) modify the first of the two, then (3) write those two entries back to the file, starting at the offset of the old entry."}, {"owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "edited": false, "score": 0, "creation_date": 1458824550, "post_id": 36160825, "comment_id": 60034942, "body": "Thanks a lot for this informations! So csv is not efficient for my program I will use another form of data, like xml, json or sql."}], "owner": {"reputation": 286, "user_id": 5899150, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a4380bc3fef16ee11788a3efea8e1cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Majonsi", "link": "https://stackoverflow.com/users/5899150/majonsi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1212, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1458666429, "creation_date": 1458666429, "question_id": 36160825, "link": "https://stackoverflow.com/questions/36160825/modify-content-of-a-csv-file-in-golang", "title": "Modify content of a CSV file in Golang", "body": "<p>My problem is that I have a csv file with a content. Like:</p>\n\n<pre><code>Number,Name\n1,First\n2,Second\n3,Third\n</code></pre>\n\n<p>In this table I want to change one of the value with golang. For example obtain this content:</p>\n\n<pre><code>Number,Name\n1,First\n2,Change\n3,Third\n</code></pre>\n\n<p>The only thing I found is to add value in the csv file and not change it.\nHow implemement it?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["database", "go", "psql"], "comments": [{"owner": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1458664499, "post_id": 36160064, "comment_id": 59957422, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/20271123/how-to-execute-an-in-lookup-in-sql-using-golang\">How to execute an IN lookup in SQL using Golang?</a>"}, {"owner": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1458677904, "post_id": 36160064, "comment_id": 59965975, "body": "This part is breaking <code>IN (&quot;, &quot;?&quot;+</code>. The comma is outside of the string. Try <code>IN (?&quot;+</code>"}, {"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "reply_to_user": {"reputation": 1506, "user_id": 713486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c2a3b1ea7651ccc1259578b0f2853f4?s=128&d=identicon&r=PG", "display_name": "Brian", "link": "https://stackoverflow.com/users/713486/brian"}, "edited": false, "score": 0, "creation_date": 1458679282, "post_id": 36160064, "comment_id": 59966764, "body": "Sorry, that was a copy paste error, it&#39;s fixed in the question."}], "answers": [{"comments": [{"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1458680901, "post_id": 36164458, "comment_id": 59967627, "body": "Before calling this the uuids are converted to 128 bit ints, then formatted back into uid strings, so I am safe, thanks!"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1458682855, "post_id": 36164458, "comment_id": 59968691, "body": "This is answer for Java and operator in is used in select, but does not matter. Limitation is the same for each language <a href=\"http://stackoverflow.com/questions/178479/preparedstatement-in-clause-alternatives\" title=\"preparedstatement in clause alternatives\">stackoverflow.com/questions/178479/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "is_accepted": true, "score": 2, "last_activity_date": 1458685555, "last_edit_date": 1458685555, "creation_date": 1458678218, "answer_id": 36164458, "question_id": 36160064, "link": "https://stackoverflow.com/questions/36160064/go-select-in-using-a-list-of-uuid-strings/36164458#36164458", "title": "Go Select In using a list of uuid strings", "body": "<p>Using fmt. Make sure that your uuids doesn't contain any <a href=\"https://en.wikipedia.org/wiki/SQL_injection\" rel=\"nofollow\">SQL-injection</a>.</p>\n\n\n\n<pre><code>ary := []string{\n    \"1442edc8-9e1f-4213-8622-5610cdd66790\",\n    \"0506ca17-d254-40b3-9ef0-bca6d15ad49d\",\n    \"e46f3708-6da5-4b82-9c92-f89394dffe5d\",\n    \"fb8bf848-73a2-4253-9fa3-e9d5e16ef94a\",\n    \"84691fa5-3391-4c02-9b16-82389331b7ac\",\n    \"adba3c9d-b4ab-4e62-a650-414970645be7\",\n}\nquery := fmt.Sprintf(`DELETE FROM files WHERE uid IN ('%s'::uuid);`,\n             strings.Join(ary, \"'::uuid,'\"))\ndb.Exec(query) // etc\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/hE4WUvtWGh\" rel=\"nofollow\">play.golang.org</a></p>\n\n<hr>\n\n<p>Rid out of potential SQL-injections:</p>\n\n<pre><code>ary := []string{ /* list of uuids */ }\nquery := `DELETE FROM files WHERE uid IN (`\naryInterfaces := make([]interface{}, len(ary))\nfor i, v := range ary {\n    query += \"$\" + strconv.FormatInt(int64(i+1), 10)\n    if i &lt; len(ary)-1 {\n        query += \",\"\n    }\n    aryInterfaces[i] = v\n}\nquery += \")\"\ndb.Exec(query, aryInterface...)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/m0MEdATjzp\" rel=\"nofollow\">play.golang.org</a></p>\n\n<hr>\n\n<p><strong>BONUS</strong>\nPostgresql uses <code>$1, $2, $3</code> etc instead of <code>?, ?, ?</code>. Here is a little <a href=\"http://play.golang.org/p/S-NDi7NNUX\" rel=\"nofollow\">helper function</a> and <a href=\"http://play.golang.org/p/QsjD9BJYJ_\" rel=\"nofollow\">here</a> is its proof of concept.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11787870, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4wKPYJ5lh6I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfMAIslxDvuuVG2QW2cHWvJe7RgsA/photo.jpg?sz=128", "display_name": "Patrick Aboagye", "link": "https://stackoverflow.com/users/11787870/patrick-aboagye"}, "is_accepted": false, "score": 0, "last_activity_date": 1612970805, "creation_date": 1612970805, "answer_id": 66139849, "question_id": 36160064, "link": "https://stackoverflow.com/questions/36160064/go-select-in-using-a-list-of-uuid-strings/66139849#66139849", "title": "Go Select In using a list of uuid strings", "body": "<p>This is an old question but for the sake of people who will be directed here, if you are using postgres db you can use this easier way:</p>\n<p><code>DELETE FROM files WHERE uid=ANY($1);</code></p>\n<p><code>$1</code> is an array of uuids. so your query becomes:</p>\n<pre><code>toBeDeleted:= []uuid.UUID{....}\n_, err = tx.Exec(&quot;UDELETE FROM files WHERE uid=ANY($1);&quot;,toBeDeleted)\n\n//or\n\n_, err = tx.Exec(&quot;UDELETE FROM files WHERE uid=ANY($1);&quot;,pq.Array(toBeDeleted))\n</code></pre>\n<p>either should work for you.</p>\n"}], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1813, "favorite_count": 0, "accepted_answer_id": 36164458, "answer_count": 2, "score": 1, "last_activity_date": 1612970805, "creation_date": 1458664294, "last_edit_date": 1495542687, "question_id": 36160064, "link": "https://stackoverflow.com/questions/36160064/go-select-in-using-a-list-of-uuid-strings", "title": "Go Select In using a list of uuid strings", "body": "<p>I have a list of uuid strings that I want to use to filter a query.  I can get the query to work if I loop over elements in my list like so:</p>\n\n<pre><code>for i, fileUID := range fileUIDs {\n    db.Exec(\"DELETE FROM files WHERE uid = $1::uuid\", fileUID)\n}\n</code></pre>\n\n<p>But I'd like to get it working using the list:</p>\n\n<pre><code>db.Exec(\"DELETE FROM files WHERE uid IN $1::uuid[]\", fileUIDs)\n</code></pre>\n\n<p>Is this possible?  I can't seem to get it working.</p>\n\n<p>I tried the solution in <a href=\"https://stackoverflow.com/questions/20271123/how-to-execute-an-in-lookup-in-sql-using-golang\">How to execute an IN lookup in SQL using Golang?</a> but I get errors like <code>pq: syntax error at or near \",\"</code> when using plain <code>?</code> or <code>pq: syntax error at or near \"::\"</code> when using <code>?:uuid</code>.  I used the following:</p>\n\n<pre><code>fileUIDArgs := make([]interface{}, len(fileUIDs))\nfor i, fileUID := range fileUIDs {\n    fileUIDArgs[i] = interface{}(fileUID)\n}\n//also tried using \"?::uuid\"\nmyPsql := \"DELETE FROM files WHERE uid IN (\" + \"?\" + strings.Repeat(\",?\", len(uidStrings)-1) + \")\"\ndb.Exec(myPsql, fileUIDArgs...)\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "deployment", "gcloud"], "comments": [{"owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1458668141, "post_id": 36159758, "comment_id": 59959831, "body": "Does <a href=\"https://code.google.com/p/google-cloud-sdk/issues/detail?id=631\" rel=\"nofollow noreferrer\">this</a> help?  Points to <a href=\"https://cloud.google.com/appengine/docs/flexible/go/hello-world#running_hello_world_on_app_engine\" rel=\"nofollow noreferrer\">this page</a>, which is for Managed VMs, but looks like the same issue."}, {"owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "reply_to_user": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "edited": false, "score": 0, "creation_date": 1458668788, "post_id": 36159758, "comment_id": 59960296, "body": "eadeploy will work only for Managed VM&#39;s which should have a bit different app structure (main func etc..)"}, {"owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 1, "creation_date": 1458753637, "post_id": 36159758, "comment_id": 60004725, "body": "Also had this issue but ended up just using <code>goapp deploy</code>"}, {"owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "edited": false, "score": 0, "creation_date": 1458809831, "post_id": 36159758, "comment_id": 60026292, "body": "Same for me, I am using my oauth_refrash_token in CI for now. And there is a related issue here <a href=\"https://groups.google.com/forum/#!topic/google-appengine-go/eoSSKKN_VmI\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/google-appengine-go/eoSSKKN_&zwnj;&#8203;VmI</a>"}, {"owner": {"reputation": 1536, "user_id": 5317173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZglzG.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/5317173/nicholas"}, "edited": false, "score": 0, "creation_date": 1471465002, "post_id": 36159758, "comment_id": 65362706, "body": "Did specify your <a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow noreferrer\"><code>$GOPATH</code></a>?  Also, did you use <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\"><code>go get</code></a> to import the required packages?  You can confirm using <a href=\"https://golang.org/cmd/go/#hdr-List_packages\" rel=\"nofollow noreferrer\"><code>go list</code></a> to see what packages have already been imported."}, {"owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "edited": false, "score": 0, "creation_date": 1471528118, "post_id": 36159758, "comment_id": 65390249, "body": "Yes, and &quot;goapp serve&quot; works as well"}, {"owner": {"reputation": 1536, "user_id": 5317173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZglzG.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/5317173/nicholas"}, "edited": false, "score": 0, "creation_date": 1473194423, "post_id": 36159758, "comment_id": 66044853, "body": "What is the directory structure of your app engine project and what is your <code>$GOPATH</code>?  Also, what version of the SDK are you using?  If your <code>$GOPATH</code> is set to the same as or within the project directory, you will likely get import errors.  Ideally, the <code>$GOPATH</code> should be <b>above</b> the project directory.  Also, if you are still attempting to use <code>gcloud preview app deploy</code>, I would suggest updating your Cloud SDK installation and using <code>gcloud app deploy</code> instead."}, {"owner": {"reputation": 613, "user_id": 4743732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/glP0W.jpg?s=128&g=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/4743732/jordan"}, "edited": false, "score": 0, "creation_date": 1479246469, "post_id": 36159758, "comment_id": 68474770, "body": "@user1835337 If you were able to solve this, you can post the answer here for other community members who may be seeing this same issue. If not, you can provide further information as Nicholas suggested to further troubleshooting."}], "answers": [{"tags": [], "owner": {"reputation": 1536, "user_id": 5317173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZglzG.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/5317173/nicholas"}, "is_accepted": false, "score": 1, "last_activity_date": 1483645588, "creation_date": 1483645588, "answer_id": 41493449, "question_id": 36159758, "link": "https://stackoverflow.com/questions/36159758/how-to-deploy-golang-app-with-dependencies-to-the-app-engine-with-gcloud/41493449#41493449", "title": "how to deploy golang app with dependencies to the app engine with gcloud?", "body": "<p>To answer your question directly, the way around this would be to use <code>goapp deploy</code> as is recommended by the App Engine documentation for the Go standard environment, <a href=\"https://cloud.google.com/appengine/docs/go/tools/uploadinganapp\" rel=\"nofollow noreferrer\">Deploying a Go App</a>.  At the time when <code>gcloud preview app deploy</code> was available, goapp was recommended precisely for handling go's specific environment and dependency requirements.</p>\n\n<p>Alternatively, if you're looking to use <strong>gcloud</strong>, you would need to use <a href=\"https://cloud.google.com/sdk/gcloud/reference/app/deploy\" rel=\"nofollow noreferrer\"><code>gcloud app deploy</code></a> now.  <code>gcloud preview app deploy</code> has been <a href=\"https://cloud.google.com/sdk/docs/release-notes#11600_20160629\" rel=\"nofollow noreferrer\">deprecated and/or removed as of June 29, 2016</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 327, "user_id": 2591878, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/64ca8366e08af4c5639ca871a4c3a5c9?s=128&d=identicon&r=PG", "display_name": "Matthieu", "link": "https://stackoverflow.com/users/2591878/matthieu"}, "is_accepted": false, "score": 3, "last_activity_date": 1486147438, "creation_date": 1486147438, "answer_id": 42030997, "question_id": 36159758, "link": "https://stackoverflow.com/questions/36159758/how-to-deploy-golang-app-with-dependencies-to-the-app-engine-with-gcloud/42030997#42030997", "title": "how to deploy golang app with dependencies to the app engine with gcloud?", "body": "<p>Since Google Cloud SDK 142.0.0 with app-engine-go 1.9.50, you should be able to deploy your application doing</p>\n\n<pre><code>gcloud beta app deploy\n</code></pre>\n\n<p>This also enables you to use CI/CD tools</p>\n"}], "owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1388, "favorite_count": 5, "answer_count": 2, "score": 7, "last_activity_date": 1486147438, "creation_date": 1458663467, "question_id": 36159758, "link": "https://stackoverflow.com/questions/36159758/how-to-deploy-golang-app-with-dependencies-to-the-app-engine-with-gcloud", "title": "how to deploy golang app with dependencies to the app engine with gcloud?", "body": "<p>I have an app that uses \"github.com/gorilla/mux\" and I am able to deploy it with <code>goapp deploy</code>. But I cannot do the same with <code>gcloud preview app deploy</code> because I am facing this error: </p>\n\n<pre><code>Beginning deployment...\nCopying files to Google Cloud Storage...\nSynchronizing files to [&lt;googlecloudsdk.api_lib.app.cloud_storage.BucketReference object at 0x10514e790&gt;].\nFile upload done.\nUpdating module [api]...failed.\nERROR: (gcloud.preview.app.deploy) Error Response: [9] Deployment contains files that cannot be compiled: Compile failed:\n2016/03/22 09:06:40 go-app-builder: build timing: 1\u00d76g (42ms total), 0\u00d76l (0 total)\n2016/03/22 09:06:40 go-app-builder: failed running 6g: exit status 1\n\napi.go:29: can't find import: \"github.com/gorilla/handlers\"\n</code></pre>\n\n<p>I want to be able to do it because I need to deploy from travisCI on merge and I want to use service-client.json for authorisation. </p>\n\n<p>Is there any way around it? </p>\n"}, {"tags": ["java", "google-app-engine", "go", "google-api", "google-api-java-client"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5755474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mhbL3whSmwE/AAAAAAAAAAI/AAAAAAAACZU/y5IsoRNYgPc/photo.jpg?sz=128", "display_name": "Lorenz So", "link": "https://stackoverflow.com/users/5755474/lorenz-so"}, "is_accepted": true, "score": 0, "last_activity_date": 1459016061, "creation_date": 1459016061, "answer_id": 36238979, "question_id": 36158503, "link": "https://stackoverflow.com/questions/36158503/http-500-error-when-generating-java-client-library-using-endpointscfg-from-a-gae/36238979#36238979", "title": "HTTP 500 error when generating Java Client Library using endpointscfg from a GAE API", "body": "<p>I remove this part from \"schema\" section from the discovery document, and it works.</p>\n\n<p>\"Order\": {\n   \"id\": \"Order\",\n   \"type\": \"object\",\n   \"properties\": {\n    \"addressArea\": {\n     \"type\": \"string\"\n    },\n    \"addressDistrict\": {\n     \"type\": \"string\"\n    },\n    \"addressField1\": {\n     \"type\": \"string\"\n    },\n    \"addressField2\": {\n     \"type\": \"string\"\n    },\n    \"addressField3\": {\n     \"type\": \"string\"\n    },\n    \"addressField4\": {\n     \"type\": \"string\"\n    },\n    \"amountPayable\": {\n     \"type\": \"integer\",\n     \"format\": \"int32\"\n    },\n    \"completed\": {\n     \"type\": \"boolean\"\n    },\n    \"createdAt\": {\n     \"type\": \"string\",\n     \"format\": \"date-time\"\n    },\n    \"deliveryDate\": {\n     \"type\": \"string\",\n     \"format\": \"date-time\"\n    },\n    \"deliveryTimeslot\": {\n     \"type\": \"integer\",\n     \"format\": \"int32\"\n    },\n    \"id\": {\n     \"type\": \"string\"\n    },\n    \"pickupDate\": {\n     \"type\": \"string\",\n     \"format\": \"date-time\"\n    },\n    \"pickupDeliveryInstruction\": {\n     \"type\": \"string\"\n    },\n    \"pickupTimeslot\": {\n     \"type\": \"integer\",\n     \"format\": \"int32\"\n    },\n    \"referenceNumber\": {\n     \"type\": \"string\"\n    },\n    \"status\": {\n     \"type\": \"integer\",\n     \"format\": \"int32\"\n    },\n    \"\uff0d\": {\n     \"type\": \"string\"\n    }\n   }\n  },</p>\n"}], "owner": {"reputation": 1, "user_id": 5755474, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mhbL3whSmwE/AAAAAAAAAAI/AAAAAAAACZU/y5IsoRNYgPc/photo.jpg?sz=128", "display_name": "Lorenz So", "link": "https://stackoverflow.com/users/5755474/lorenz-so"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 36238979, "answer_count": 1, "score": 0, "last_activity_date": 1459016061, "creation_date": 1458660348, "question_id": 36158503, "link": "https://stackoverflow.com/questions/36158503/http-500-error-when-generating-java-client-library-using-endpointscfg-from-a-gae", "title": "HTTP 500 error when generating Java Client Library using endpointscfg from a GAE API", "body": "<p>I tried to generate java client library using a discovery doc retrieved from my API endpoints (which is running on golang) but failed wit the following message.</p>\n\n<pre><code>endpointscfg.py gen_client_lib java happylaundry.rest.discovery\n\nTraceback (most recent call last):\n  File \"//Users/lorenz/go/go_appengine/endpointscfg.py\", line 133, in &lt;module&gt;\n    run_file(__file__, globals())\n  File \"//Users/lorenz/go/go_appengine/endpointscfg.py\", line 129, in run_file\n    execfile(_PATHS.script_file(script_name), globals_)\n  File \"/Users/lorenz/go/go_appengine/google/appengine/tools/endpointscfg.py\", line 561, in &lt;module&gt;\n    main(sys.argv)\n  File \"/Users/lorenz/go/go_appengine/google/appengine/tools/endpointscfg.py\", line 557, in main\n    args.callback(args)\n  File \"/Users/lorenz/go/go_appengine/google/appengine/tools/endpointscfg.py\", line 458, in _GenClientLibCallback\n    args.build_system)\n  File \"/Users/lorenz/go/go_appengine/google/appengine/tools/endpointscfg.py\", line 335, in _GenClientLib\n    build_system, client_name)\n  File \"/Users/lorenz/go/go_appengine/google/appengine/tools/endpointscfg.py\", line 366, in _GenClientLibFromContents\n    raise ServerRequestException(error)\n__main__.ServerRequestException: HTTP 500 (Internal Server Error) error when communicating with URL: https://google-api-client-libraries.appspot.com/generate. Response: \n</code></pre>\n\n<p>I tried to use the same command and generated for a very simple program, and it runs without errro. From the syntax or structure of the discovery doc, i can't see anything ran wrong. Do you guys have any idea?</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458654530, "post_id": 36155486, "comment_id": 59949537, "body": "It&#39;s hard to help without any code to go by. Can you be more specific about what problem you&#39;re having implementing this?"}, {"owner": {"reputation": 623, "user_id": 5615224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bea88308ec27975167f216eb8f998e?s=128&d=identicon&r=PG&f=1", "display_name": "sfault", "link": "https://stackoverflow.com/users/5615224/sfault"}, "edited": false, "score": 2, "creation_date": 1458654542, "post_id": 36155486, "comment_id": 59949546, "body": "look at <code>gorilla&#47;websocket</code> chat example, its implemented as chat room, but can be modified to work one to one."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1458655290, "post_id": 36155486, "comment_id": 59950149, "body": "what exactly you want to share?"}, {"owner": {"reputation": 761, "user_id": 4408431, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2b44a8fe8eced45cbed11539b706c48?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/4408431/lukas"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1458655770, "post_id": 36155486, "comment_id": 59950534, "body": "@Uvelichitel I simply want to relay messages from the mobile phone to the browser and vice-versa."}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458669875, "post_id": 36155486, "comment_id": 59961006, "body": "The OS from your server still has to route all the traffic through the one http server port.  So no parallelism there.  The go application has to read all the traffic from this port with a single goroutine.  If you are just looking  up the outgoing connection to use to echo the message, you may find it more efficient to do it all in one goroutine, then no channel or mutex is needed.  How to take advantage of multiple cores with web sockets when there is no real work to do on the server side is an interesting question."}], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 4408431, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2b44a8fe8eced45cbed11539b706c48?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/4408431/lukas"}, "edited": false, "score": 0, "creation_date": 1458657847, "post_id": 36157155, "comment_id": 59952266, "body": "Thanks a lot, but I don&#39;t think a further protocol will suit my needs. Also the client should run on Android and eventually iOS and Windows Phone, thus I want to use simple socket connections."}, {"owner": {"reputation": 3448, "user_id": 2154839, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/79c9780d30d201ab911ae86c74f71cf5?s=128&d=identicon&r=PG", "display_name": "Georgi-it", "link": "https://stackoverflow.com/users/2154839/georgi-it"}, "reply_to_user": {"reputation": 761, "user_id": 4408431, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2b44a8fe8eced45cbed11539b706c48?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/4408431/lukas"}, "edited": false, "score": 0, "creation_date": 1473521375, "post_id": 36157155, "comment_id": 66178784, "body": "Well these are simple socket connections underneath."}], "tags": [], "owner": {"reputation": 3448, "user_id": 2154839, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/79c9780d30d201ab911ae86c74f71cf5?s=128&d=identicon&r=PG", "display_name": "Georgi-it", "link": "https://stackoverflow.com/users/2154839/georgi-it"}, "is_accepted": false, "score": 2, "last_activity_date": 1458656914, "creation_date": 1458656914, "answer_id": 36157155, "question_id": 36155486, "link": "https://stackoverflow.com/questions/36155486/concurrent-relaying-of-data-between-multiple-clients/36157155#36157155", "title": "concurrent relaying of data between multiple clients", "body": "<p>I had a similar to your problem, I needed multiple connections which each send data to each other through multiple servers.</p>\n\n<p>I went with the <a href=\"http://wamp-proto.org\" rel=\"nofollow\">WAMP</a> protocol</p>\n\n<pre><code>WAMP is an open standard WebSocket subprotocol that provides two application messaging patterns in one unified protocol:\nRemote Procedure Calls + Publish &amp; Subscribe.\n</code></pre>\n\n<p>You can also take a look at a project of mine which is written in go and uses the protocol at hand: <a href=\"https://github.com/neutrinoapp/neutrino\" rel=\"nofollow\">github.com/neutrinoapp/neutrino</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1458663445, "last_edit_date": 1458663445, "creation_date": 1458661200, "answer_id": 36158833, "question_id": 36155486, "link": "https://stackoverflow.com/questions/36155486/concurrent-relaying-of-data-between-multiple-clients/36158833#36158833", "title": "concurrent relaying of data between multiple clients", "body": "<p>There's nothing wrong with using a mutex in Go. Here's a solution using a mutex.</p>\n\n<p>Declare a map of endpoints. I assume that a string key is sufficient to identify an endpoint:</p>\n\n<pre><code>type endpoint struct {\n    c *websocket.Conn\n    sync.Mutex  // protects write to c\n}\n\nvar (\n   endpoints = map[string]*endpoint\n   endpointsMu sync.Mutex   // protects endpoints\n)\n\nfunc addEndpoint(key string, c *websocket.Connection) {\n   endpointsMu.Lock()\n   endpoints[key] = &amp;endpoint{c:c}\n   endpointsMu.Unlock()\n}\n\nfunc removeEndpoint(key string) {\n    endpointsMu.Lock()\n    delete(endpoints, key)\n    endpointsMu.Unlock()\n}\n\nfunc sendToEndpoint(key string, message []byte) error {\n    endpointsMu.Lock()\n    e := endpoints[key]\n    endpointsMu.Unlock()\n    if e === nil {\n        return errors.New(\"no endpoint\")\n    }\n    e.Lock()\n    defer e.Unlock()\n    return e.c.WriteMessage(websocket.TextMessage, message)\n}\n</code></pre>\n\n<p>Add the connection to the map with <code>addEndpoint</code> when the client connects. Remove the connection from the map with <code>removeEndpoint</code> when closing the connection. Send messages to a named endpoint with <code>sendToEndpoint</code>.</p>\n\n<p>The <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow\">Gorilla chat example</a> can be adapted to solve this problem.  Change the hub map to <code>connections map[string]*connection</code>, update channels to send a type with connection and key and change the broadcast loop to send to a single connection.</p>\n"}], "owner": {"reputation": 761, "user_id": 4408431, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a2b44a8fe8eced45cbed11539b706c48?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas", "link": "https://stackoverflow.com/users/4408431/lukas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 36158833, "answer_count": 2, "score": 2, "last_activity_date": 1458663445, "creation_date": 1458652794, "question_id": 36155486, "link": "https://stackoverflow.com/questions/36155486/concurrent-relaying-of-data-between-multiple-clients", "title": "concurrent relaying of data between multiple clients", "body": "<p>I am currently working on an application relaying data sent from a mobile phone via a server to a browser using WebSockets. I am writing the server in go and I have a one-to-one relation between the mobile phones and the browsers as shown by the following illustration.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jF9iz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jF9iz.png\" alt=\"communication flow between mobile phone and server\"></a>.</p>\n\n<p>However, I want multiple sessions to work simultaneously.</p>\n\n<p>I have read that go provides concurrency models that follow the principle \"share memory by communicating\" using goroutines and channels. I would prefer using the mentioned principle rather than locks using the <code>sync.Mutex</code> primitive.</p>\n\n<p>Nevertheless, I have not been able to map this information to my issue and wanted to ask you if you could suggest a solution.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458652790, "post_id": 36154238, "comment_id": 59948111, "body": "You could also just do what <code>go get</code> does, and look at the import path to see if there&#39;a a package there."}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 4, "last_activity_date": 1458650812, "creation_date": 1458650812, "answer_id": 36154807, "question_id": 36154238, "link": "https://stackoverflow.com/questions/36154238/how-to-check-go-get-package-installation-status/36154807#36154807", "title": "how to check &#39;go get &lt;package&gt;&#39; installation status?", "body": "<p>Use <code>go get -v</code></p>\n\n<p>Here's an example of get doing something vs not:</p>\n\n<pre><code>$ go get -v  github.com/peak6/envflag\ngithub.com/peak6/envflag (download) # downloaded package\ngithub.com/peak6/envflag # built package (I think)\n\n$ go get -v  github.com/peak6/envflag\n$ # nothing to do\n</code></pre>\n"}], "owner": {"reputation": 933, "user_id": 2058424, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rzBWY.png?s=128&g=1", "display_name": "Jan Warcho\u0142", "link": "https://stackoverflow.com/users/2058424/jan-warcho%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 36154807, "answer_count": 1, "score": 0, "last_activity_date": 1458650812, "creation_date": 1458649210, "question_id": 36154238, "link": "https://stackoverflow.com/questions/36154238/how-to-check-go-get-package-installation-status", "title": "how to check &#39;go get &lt;package&gt;&#39; installation status?", "body": "<p>Is there any option for <code>go get</code> that can tell me whether it actually did anything?</p>\n\n<p>For example, if the package X was already installed, I would like to know that <code>go get X</code> didn't perform any downloading/installation.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1458645913, "post_id": 36152999, "comment_id": 59943165, "body": "Why do you have the type names <code>int64</code> and <code>string</code> in the call to <code>UserPrefer</code>?"}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1458646346, "post_id": 36152999, "comment_id": 59943480, "body": "At what line is the error thrown?"}, {"owner": {"reputation": 1648, "user_id": 2586651, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/peESf.jpg?s=128&g=1", "display_name": "Ahmed_Ali", "link": "https://stackoverflow.com/users/2586651/ahmed-ali"}, "reply_to_user": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1458647366, "post_id": 36152999, "comment_id": 59944162, "body": "@AjPennster. in code i have mention compile time error. any reason of down voting ?"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 3, "creation_date": 1458647854, "post_id": 36152999, "comment_id": 59944495, "body": "Don&#39;t edit out the errors that your question is about. If someone else reads this, the answers and comments are no longer going to make sense."}], "answers": [{"tags": [], "owner": {"reputation": 114, "user_id": 6098446, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153214572354315/picture?type=large", "display_name": "Syed Muhammad BalighurRahman", "link": "https://stackoverflow.com/users/6098446/syed-muhammad-balighurrahman"}, "is_accepted": true, "score": 9, "last_activity_date": 1525120135, "last_edit_date": 1525120135, "creation_date": 1458647460, "answer_id": 36153649, "question_id": 36152999, "link": "https://stackoverflow.com/questions/36152999/go-lang-syntax-error-unexpected-name-expecting/36153649#36153649", "title": "GO lang syntax error: unexpected name, expecting )", "body": "<p>You are passing types when calling methods</p>\n\n<p>Use </p>\n\n<pre><code>response :=models.UserPrefer(cc, userID, key, value)\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>response :=models.UserPrefer(cc, userID int64, key string, value string)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 2771381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6f4a48927fc81c5c7aef57194fb7704?s=128&d=identicon&r=PG&f=1", "display_name": "cricrishi", "link": "https://stackoverflow.com/users/2771381/cricrishi"}, "is_accepted": false, "score": 2, "last_activity_date": 1468171265, "creation_date": 1468171265, "answer_id": 38294549, "question_id": 36152999, "link": "https://stackoverflow.com/questions/36152999/go-lang-syntax-error-unexpected-name-expecting/38294549#38294549", "title": "GO lang syntax error: unexpected name, expecting )", "body": "<p>While calling a function just pass the parameter. You do not need to pass the type of parameter.  </p>\n"}, {"tags": [], "owner": {"reputation": 4578, "user_id": 5180047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Z8PTw2eJC9E/AAAAAAAAAAI/AAAAAAAAAco/2C4t6AgoQNc/photo.jpg?sz=128", "display_name": "Nick Brady", "link": "https://stackoverflow.com/users/5180047/nick-brady"}, "is_accepted": false, "score": 1, "last_activity_date": 1553361755, "creation_date": 1553361755, "answer_id": 55316423, "question_id": 36152999, "link": "https://stackoverflow.com/questions/36152999/go-lang-syntax-error-unexpected-name-expecting/55316423#55316423", "title": "GO lang syntax error: unexpected name, expecting )", "body": "<p>I got an error very similar to this when I forgot to put in a colon while instantiating a type. Created a minimum example to illustrate.</p>\n\n<blockquote>\n  <p>prog.go:11:12: syntax error: unexpected literal \"Sedimentary\", expecting comma or }</p>\n</blockquote>\n\n<p><a href=\"https://play.golang.org/p/QKmcOHnsF7C\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QKmcOHnsF7C</a></p>\n\n<p>In this example, I just needed to add a colon after the attribute name.</p>\n\n<pre><code>r := Rock{\n    RockType:   \"Sedimentary\", // the \":\" was missing, and is in the go play link above\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1613, "user_id": 5013336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d627dbf935d8dcb71c8eff8a223e97cc?s=128&d=identicon&r=PG", "display_name": "Arka Mukherjee", "link": "https://stackoverflow.com/users/5013336/arka-mukherjee"}, "is_accepted": false, "score": 1, "last_activity_date": 1578900669, "creation_date": 1578900669, "answer_id": 59712204, "question_id": 36152999, "link": "https://stackoverflow.com/questions/36152999/go-lang-syntax-error-unexpected-name-expecting/59712204#59712204", "title": "GO lang syntax error: unexpected name, expecting )", "body": "<p>I was getting this error because I was using a <code>reserved</code> keyword as an argument name for a method. </p>\n\n<p>Code snippet that was throwing this error: </p>\n\n<pre><code>func setCustomTypeData(set bson.M, type string) {\n\n}\n</code></pre>\n\n<p>Code snippet that fixed this issue: </p>\n\n<pre><code>func setCustomTypeData(set bson.M, customManagedType string) {\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1648, "user_id": 2586651, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/peESf.jpg?s=128&g=1", "display_name": "Ahmed_Ali", "link": "https://stackoverflow.com/users/2586651/ahmed-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30577, "favorite_count": 1, "protected_date": 1604821431, "accepted_answer_id": 36153649, "answer_count": 4, "score": 6, "last_activity_date": 1604813614, "creation_date": 1458645529, "last_edit_date": 1458647950, "question_id": 36152999, "link": "https://stackoverflow.com/questions/36152999/go-lang-syntax-error-unexpected-name-expecting", "title": "GO lang syntax error: unexpected name, expecting )", "body": "<p>I have started learning <strong>Go lang</strong> recently.I have spend couple of hours but can't figure out what's wrong with this.</p>\n\n<p><strong>Here is my code:</strong> </p>\n\n<pre><code>func preference(cc *core.ComponentContext, w http.ResponseWriter, req *http.Request){\n\nuserID, err := core.PostParam(req, \"user_id\")\nkey, err := core.PostParam(req, \"key\")\nvalue, err := core.PostParam(req, \"value\")  \nif err != nil {\n    cc.Error(\"Error reading the user id:\", err.Error())\n    msg := fmt.Sprintf(\"user_id: %s\", err.Error())\n    http.Error(w, msg, http.StatusBadRequest)\n    return\n}\n\nresponse :=models.UserPrefer(cc, userID int64, key string, value string) --&gt; compile time error\n\nb, err := json.Marshal(response)\nif err != nil {\n    http.Error(w, \"Internal Error\", http.StatusInternalServerError)\n    return\n}\nfmt.Fprintf(w, string(b[:]))\n</code></pre>\n\n<p>}</p>\n\n<p>Following error is throw <strong>syntax error: unexpected name, expecting )</strong>\nit's probably simple, but with my limited knowledge in Go lang I can't figure out.</p>\n"}, {"tags": ["methods", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1458647002, "last_edit_date": 1458647002, "creation_date": 1458646211, "answer_id": 36153205, "question_id": 36152939, "link": "https://stackoverflow.com/questions/36152939/why-must-we-declare-a-variable-name-when-adding-a-method-to-a-struct-in-golang/36153205#36153205", "title": "Why must we declare a variable name when adding a method to a struct in Golang?", "body": "<p>Because there is no implicit identifier denoting the actual receiver value (like <code>this</code> in Java), and <em>if</em> you want to refer to the fields or methods of the receiver value (<code>Rectangle</code> value), you need an identifier that you can use.</p>\n\n<p>Note that the spec does not require you to name the receiver value, e.g. the following using the <a href=\"https://golang.org/ref/spec#Blank_identifier\">blank identifier</a> is a valid syntax:</p>\n\n<pre><code>func (_ Rectangle) Foo() string {\n    return \"foo\"\n}\n</code></pre>\n\n<p>Or even this: omitting the receiver name (the parameter name):</p>\n\n<pre><code>func (Rectangle) Foo() string {\n    return \"foo\"\n}\n</code></pre>\n\n<p>Relevant section from the spec: <a href=\"https://golang.org/ref/spec#Method_declarations\">Method declarations</a>:</p>\n\n<blockquote>\n<pre><code>MethodDecl   = \"func\" Receiver MethodName ( Function | Signature ) .\nReceiver     = Parameters .\n</code></pre>\n</blockquote>\n\n<p>Where Parameters is:</p>\n\n<blockquote>\n<pre><code>Parameters     = \"(\" [ ParameterList [ \",\" ] ] \")\" .\nParameterList  = ParameterDecl { \",\" ParameterDecl } .\nParameterDecl  = [ IdentifierList ] [ \"...\" ] Type .\n</code></pre>\n</blockquote>\n\n<p>As you can see in the last line, the <code>IdentifierList</code> is optional (but <code>Type</code> is required).</p>\n"}, {"tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": false, "score": 1, "last_activity_date": 1458647495, "creation_date": 1458647495, "answer_id": 36153664, "question_id": 36152939, "link": "https://stackoverflow.com/questions/36152939/why-must-we-declare-a-variable-name-when-adding-a-method-to-a-struct-in-golang/36153664#36153664", "title": "Why must we declare a variable name when adding a method to a struct in Golang?", "body": "<p>Struct methods are like Class methods. The variable 'r' is a reference to the struct/class instance/object that the method is being applied to. Without that reference, you will not be able to access whatever is contained within that struct/object. </p>\n\n<p>Lets say for example, I created <code>smallRectangle</code> using your struct:</p>\n\n<pre><code>var smallRectangle = Rectangle{5,3}\n</code></pre>\n\n<p>Now I want to calculate the area using the Rectangle method <code>Area</code></p>\n\n<pre><code>area := smallRectangle.Area()\n</code></pre>\n\n<p>Lets look at what happens within the function. <code>r</code> from the method declaration becomes a <strong>copy</strong> of <code>smallRectangle</code> since that's the struct object calling it. </p>\n\n<pre><code>func (smallRectangle Rectangle) Area() int {\n    return smallRectangle.length * smallRectangle.width\n}\n</code></pre>\n\n<p>As indicated by Icza, there is no implicit identifier like <code>self</code> or <code>this</code>, so the only way for the method to access the values of the struct is through the identifier <code>r</code>. </p>\n"}], "owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1475436754, "creation_date": 1458645341, "last_edit_date": 1475436754, "question_id": 36152939, "link": "https://stackoverflow.com/questions/36152939/why-must-we-declare-a-variable-name-when-adding-a-method-to-a-struct-in-golang", "title": "Why must we declare a variable name when adding a method to a struct in Golang?", "body": "<p>Let's say I have a struct</p>\n\n<pre><code>type Rectangle struct {\n    length, width int\n}\n</code></pre>\n\n<p>and I want to add a method to it:</p>\n\n<pre><code>func (r Rectangle) Area() int {\n    return r.length * r.width\n}\n</code></pre>\n\n<p>Why must I give it a variable name here <code>r</code>?</p>\n"}, {"tags": ["function", "go", "closures", "anonymous"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 1, "creation_date": 1458644166, "post_id": 36152294, "comment_id": 59941984, "body": "<code>i</code> is assigned 15 at the end of <code>closure1</code>, which you call before your call to <code>closure2</code>. So you pass 15 to <code>closure2</code>"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1458644618, "post_id": 36152294, "comment_id": 59942285, "body": "<a href=\"http://www.goinggo.net/2014/06/pitfalls-with-closures-in-go.html\" rel=\"nofollow noreferrer\">Pitfalls With Closures In Go</a>"}, {"owner": {"reputation": 23, "user_id": 6098129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca808545954fe4b33af71440e04a6b5?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/6098129/scott"}, "edited": false, "score": 0, "creation_date": 1458681069, "post_id": 36152294, "comment_id": 59967704, "body": "i see, golang closure catch a reference to i, not a snapshot value, i get it , thank you very much again."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6098129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca808545954fe4b33af71440e04a6b5?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/6098129/scott"}, "edited": false, "score": 0, "creation_date": 1458683002, "post_id": 36153952, "comment_id": 59968770, "body": "yes , in essence , \tgolang closure catch a reference to i, not a snapshot value, i get it , thank you john and dsafds again, by the way , &quot;\t Pitfalls With Closures In Go&quot; is good learning material."}], "tags": [], "owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "is_accepted": true, "score": 2, "last_activity_date": 1458660079, "last_edit_date": 1458660079, "creation_date": 1458648293, "answer_id": 36153952, "question_id": 36152294, "link": "https://stackoverflow.com/questions/36152294/golang-closureanonymous-functioncatch-wrong-parameters-value/36153952#36153952", "title": "golang closure(anonymous function)catch wrong parameter`s value", "body": "<p>The problem is that your first assigning i to 15 when your calling <code>closure1()</code> And then closure two you print it.. Your doing <code>closure1()</code> <strong>after</strong> assigning i to 20.. Thats the problem, this should fix your problem:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    i := 10\n\n    closure1 := func() {\n        fmt.Printf(\"closure, i: %d\\n\", i)\n        i = 15\n    }\n\n    closure1()\n\n    fmt.Printf(\"in main, i: %d\\n\", i)\n\n    closure2 := func(x int) {\n        fmt.Printf(\"function call, pass parameter, i: %d\\n\", x)\n    }\n\n\n\n    closure1()\n    i = 20 // Now it assigns it back to 20.. So the result below will become 20...\n    closure2(i)\n}\n</code></pre>\n\n<p>You see your problem?</p>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 0, "last_activity_date": 1458659740, "creation_date": 1458659740, "answer_id": 36158275, "question_id": 36152294, "link": "https://stackoverflow.com/questions/36152294/golang-closureanonymous-functioncatch-wrong-parameters-value/36158275#36158275", "title": "golang closure(anonymous function)catch wrong parameter`s value", "body": "<p>The last line of closure1 sets i to 15.  This i belongs to the main() context.</p>\n\n<p>The next to last line of main calls closure1() again.  So the i from main is set to 15 again.</p>\n"}], "owner": {"reputation": 23, "user_id": 6098129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca808545954fe4b33af71440e04a6b5?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/6098129/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 1, "accepted_answer_id": 36153952, "answer_count": 2, "score": 1, "last_activity_date": 1458660079, "creation_date": 1458643563, "last_edit_date": 1458644297, "question_id": 36152294, "link": "https://stackoverflow.com/questions/36152294/golang-closureanonymous-functioncatch-wrong-parameters-value", "title": "golang closure(anonymous function)catch wrong parameter`s value", "body": "<p>see test code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    i := 10\n\n    closure1 := func() {\n        fmt.Printf(\"closure, i: %d\\n\", i)\n        i = 15\n    }\n\n    closure1()\n\n    fmt.Printf(\"in main, i: %d\\n\", i)\n\n    closure2 := func(x int) {\n        fmt.Printf(\"function call, pass parameter, i: %d\\n\", x)\n    }\n\n    i = 20\n\n    closure1()\n    closure2(i)\n}\n</code></pre>\n\n<p>I think the output of the closure2 should be 20, but the real result is 15, i do not know why????\nanybody can help me , please see my comment in my code, thanks in advance.</p>\n"}, {"tags": ["go", "constants", "build-time"], "answers": [{"comments": [{"owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "edited": false, "score": 0, "creation_date": 1458642330, "post_id": 36151744, "comment_id": 59940654, "body": "Thanks a lot nemo."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 14, "last_activity_date": 1458642089, "creation_date": 1458642089, "answer_id": 36151744, "question_id": 36151298, "link": "https://stackoverflow.com/questions/36151298/is-there-a-way-to-define-a-constant-at-build-time-in-go/36151744#36151744", "title": "Is there a way to define a constant at build time in Go?", "body": "<p>Yes, this is possible using <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\">Build Constraints</a>.</p>\n\n<p>You can supply a list of these constraints to <code>go build</code> using the <code>-tags</code> flag.</p>\n\n<p>Example:</p>\n\n<h3>main.go</h3>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(f)\n}\n</code></pre>\n\n<h3>foo.go</h3>\n\n<pre><code>// +build foo\n\npackage main\n\nconst f = \"defined in foo.go\"\n</code></pre>\n\n<h3>bar.go</h3>\n\n<pre><code>// +build bar\n\npackage main\n\nconst f = \"defined in bar.go\"\n</code></pre>\n\n<p>Compiling the code with different tags will give different results:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ go build -tags foo\n$ ./main\ndefined in foo.go\n$ go build -tags bar\n$ ./main\ndefined in bar.go\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "edited": false, "score": 1, "creation_date": 1458642641, "post_id": 36151848, "comment_id": 59940890, "body": "Those are huge downsides since I need to use a numeric constant ;) However, this is a very useful functionality in some contexts."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 4, "last_activity_date": 1458642651, "last_edit_date": 1458642651, "creation_date": 1458642363, "answer_id": 36151848, "question_id": 36151298, "link": "https://stackoverflow.com/questions/36151298/is-there-a-way-to-define-a-constant-at-build-time-in-go/36151848#36151848", "title": "Is there a way to define a constant at build time in Go?", "body": "<p>It doesn't solve your exact problem but it may solve others so I add for compelteness that you can use the <code>-ldflags</code> option of the go compiler:</p>\n\n<pre><code>go build -ldflags \"-X main.wordLen=6\"\n</code></pre>\n\n<p>Its however has two downsides:</p>\n\n<ul>\n<li>Only works for strings</li>\n<li>Only works on vars</li>\n</ul>\n"}], "owner": {"reputation": 9718, "user_id": 87584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9f6dfb6c18bce2c8487312b77c32dbc3?s=128&d=identicon&r=PG", "display_name": "Fabien", "link": "https://stackoverflow.com/users/87584/fabien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3554, "favorite_count": 0, "accepted_answer_id": 36151744, "answer_count": 2, "score": 8, "last_activity_date": 1458642651, "creation_date": 1458640921, "question_id": 36151298, "link": "https://stackoverflow.com/questions/36151298/is-there-a-way-to-define-a-constant-at-build-time-in-go", "title": "Is there a way to define a constant at build time in Go?", "body": "<p>I have a program in Go that I want to compile in a bunch of binaries, each having a <code>const</code> value defined differently. More clearly, I have something like that:</p>\n\n<pre><code>const wordLen = 6\ntype knowledge [wordLen]byte\n</code></pre>\n\n<p>Here, <code>wordLen</code> is associated with the value 6, but I want to have different binaries, with values ranging from 5 to 10. I could make it a variable, and then use a slice rather than an array, but that would have a huge performance impact on my soft (yes, I tried).</p>\n\n<p>I would love to have some build tag on <code>go build</code> argument to indicate what the value of <code>wordLen</code> is for a given binary. So, what is the (as idiomatic as possible) way to do this ?</p>\n"}, {"tags": ["go", "rethinkdb"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1458642549, "post_id": 36150650, "comment_id": 59940818, "body": "Each entry to the map should end with commas including the last one. \t \t What is &quot;json_received&quot;? Is it a string? if so you need quotes surrounding it."}], "answers": [{"tags": [], "owner": {"reputation": 3360, "user_id": 2165382, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GfUXc.png?s=128&g=1", "display_name": "Rafique Mohammed", "link": "https://stackoverflow.com/users/2165382/rafique-mohammed"}, "is_accepted": false, "score": 0, "last_activity_date": 1458639935, "creation_date": 1458639935, "answer_id": 36150931, "question_id": 36150650, "link": "https://stackoverflow.com/questions/36150650/gorethink-insert-issue/36150931#36150931", "title": "Gorethink Insert Issue", "body": "<p>you are missing comma after json_received array </p>\n\n<pre><code>\"json_received\": [\n        {\n        \"ezpOrderId\":  \"ezp_123\",\n        \"firstName\":  \"Vasanth\",\n        \"lastName\":  \"K\",\n        \"orderDesc\":  \"Sample\"\n        }\n    ] , //&lt;--\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1458654299, "creation_date": 1458654299, "answer_id": 36156091, "question_id": 36150650, "link": "https://stackoverflow.com/questions/36150650/gorethink-insert-issue/36156091#36156091", "title": "Gorethink Insert Issue", "body": "<p>Go does not support json literals like you are trying to do.</p>\n\n<p>Here's a fixed version (<a href=\"http://play.golang.org/p/dKlbCDxWOu\" rel=\"nofollow\">on Play</a>).</p>\n\n<p>Notice that for all sub structures, you must declare the type when creating it.\nYou were trying to make json_recieved to be a list of json objects, so I used <code>[]map[string]interface{}</code>.</p>\n\n<p>And, as others have pointed out, multi-line map/list literals must have a comma after each line, as in: <code>orderDesc</code>, <code>status</code>.  </p>\n\n<p>package main</p>\n\n<pre><code>import \"fmt\"\n\nfunc main() {\n    var data = map[string]interface{}{\n        \"json_received\": []map[string]interface{}{\n            {\n                \"ezpOrderId\": \"ezp_123\",\n                \"firstName\":  \"Vasanth\",\n                \"lastName\":   \"K\",\n                \"orderDesc\":  \"Sample\",\n            },\n        },\n        \"created_on\": \"03-22-2015\",\n        \"status\":     \"1\",\n    }\n\n    fmt.Printf(\"%#v\\n\", data)\n    //result, err := r.Table(\"order_json\").Insert(data).RunWrite(session)\n}\n</code></pre>\n"}], "owner": {"reputation": 588, "user_id": 2806972, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e9e3cf1c851a51f9df49e148f8c2bd3f?s=128&d=identicon&r=PG&f=1", "display_name": "Kumar Shanmugam", "link": "https://stackoverflow.com/users/2806972/kumar-shanmugam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1458654299, "creation_date": 1458639086, "question_id": 36150650, "link": "https://stackoverflow.com/questions/36150650/gorethink-insert-issue", "title": "Gorethink Insert Issue", "body": "<pre><code>var data = map[string]interface{}{\n    \"json_received\": [\n        {\n        \"ezpOrderId\":  \"ezp_123\",\n        \"firstName\":  \"Vasanth\",\n        \"lastName\":  \"K\",\n        \"orderDesc\":  \"Sample\"\n        }\n    ] \n    \"created_on\":  \"03-22-2015\",\n    \"status\":  \"1\"\n}\n\n\nresult, err := r.Table(\"order_json\").Insert(data).RunWrite(session)\n</code></pre>\n\n<p>When i m tried to run this program i got the error as \"missing operand\" after \"json_received\":[ line.</p>\n\n<p>Please help me to insert the data variable in rethink db via go programming..</p>\n"}, {"tags": ["javascript", "time", "go", "utc", "rethinkdb"], "answers": [{"comments": [{"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "edited": false, "score": 0, "creation_date": 1458669569, "post_id": 36153172, "comment_id": 59960796, "body": "Before I decided to change type to <code>int64</code>, I declared it with type <code>time.Time</code> and it didn&#39;t work. Now it definitely does not work as well"}, {"owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "edited": false, "score": 0, "creation_date": 1458669630, "post_id": 36153172, "comment_id": 59960839, "body": "Result is always <code>0001-01-01 00:00:00 +0000 UTC</code> (if converted to milliseconds, it is <code>0</code>)"}, {"owner": {"reputation": 1204, "user_id": 726786, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/906ddd2af9fd394ea34a09dee9ce8d9b?s=128&d=identicon&r=PG", "display_name": "gabeio", "link": "https://stackoverflow.com/users/726786/gabeio"}, "edited": false, "score": 0, "creation_date": 1458682951, "post_id": 36153172, "comment_id": 59968736, "body": "if you are working with time use <code>time.Time</code> if you want the ms of it you would do something like <code>Quote.CreatedAt.Unix()</code> note that the <code>func (t Time) Unix() int64</code> is a function of (<code>time.Time</code>) with the name <code>Unix(no params)</code> and returns <code>int64</code>"}], "tags": [], "owner": {"reputation": 14627, "user_id": 3535728, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rCSt6.jpg?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/3535728/sebastian"}, "is_accepted": false, "score": 3, "last_activity_date": 1458646066, "creation_date": 1458646066, "answer_id": 36153172, "question_id": 36150021, "link": "https://stackoverflow.com/questions/36150021/go-get-time-from-rethinkdb/36153172#36153172", "title": "go - Get time from RethinkDB", "body": "<p>When using <a href=\"https://github.com/dancannon/gorethink\" rel=\"nofollow\">gorethink</a> the driver will automatically convert to and from GO\u2019s native data types. Change your struct to use <code>time.Time</code>:</p>\n\n<pre><code>type Quote struct{\n    CreatedAt   time.Time  `gorethink:\"created_at\"`\n}\n</code></pre>\n\n<p>For more samples you can check the respective <a href=\"https://github.com/dancannon/gorethink/blob/master/query_time_test.go\" rel=\"nofollow\">test cases</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "is_accepted": true, "score": 0, "last_activity_date": 1458701080, "creation_date": 1458701080, "answer_id": 36168896, "question_id": 36150021, "link": "https://stackoverflow.com/questions/36150021/go-get-time-from-rethinkdb/36168896#36168896", "title": "go - Get time from RethinkDB", "body": "<p>I managed to find the answer myself. True type is used in this condition is <code>float64</code> so that results fetched match with in database explorer (for example, <code>1458184908597</code> milliseconds)</p>\n"}], "owner": {"reputation": 2495, "user_id": 4760425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1415935128722296/picture?type=large", "display_name": "necroface", "link": "https://stackoverflow.com/users/4760425/necroface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 36168896, "answer_count": 2, "score": 0, "last_activity_date": 1458701080, "creation_date": 1458637288, "last_edit_date": 1458669720, "question_id": 36150021, "link": "https://stackoverflow.com/questions/36150021/go-get-time-from-rethinkdb", "title": "go - Get time from RethinkDB", "body": "<p>I have a struct <code>Quote</code> in Go</p>\n\n<pre><code>type Quote struct{\n    CreatedAt int64 `gorethink:\"createdAt\"`\n    // Other fields...\n}\n</code></pre>\n\n<p>I write to query data from RethinkDB and succeed</p>\n\n<pre><code>result,err:=r.Table(\"quote\").GetAll(ids...).Run(session)\n\ndefer result.Close()\n\n        if err!=nil{\n            fmt.Println(err)\n        }\n        var quotes []Quote\n        err=result.All(&amp;quotes)\n</code></pre>\n\n<p>It does get true results, but none of records has value in <code>CreatedAt</code> field. The time format I use for <code>createdAt</code> in database is milliseconds since epoch UTC, I intend to use them as number to calculate after</p>\n\n<p>I read GoDocs for time and found:</p>\n\n<p><code>func (t Time) Unix() int64</code></p>\n\n<p>So I thought <code>int64</code> would be the right type for <code>CreatedAt</code>, but it didn't work. What should I do? How can I get time data?</p>\n\n<p><code>time.Time</code> doesn't work as well. If <code>time.Time</code> is used, the result is always <code>0001-01-01 00:00:00 +0000 UTC</code> (similarly <code>0</code> value if converted to milliseconds)</p>\n\n<p>Because when I built the same server in NodeJS I used <code>Date.Now()</code>, I need to seek an equivalent type in this case, which returns a number for me to calculate later process</p>\n"}, {"tags": ["go", "uniqueidentifier"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1458633303, "post_id": 36148433, "comment_id": 59935180, "body": "gethostid(3) just read /etc/hostid (and does some mumbo jumbo if not available). Just read /etc/hostid yourself."}, {"owner": {"reputation": 2626, "user_id": 1384712, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/3979adfb14d253e6b72a6bebe65e232f?s=128&d=identicon&r=PG", "display_name": "Bernardo Vale", "link": "https://stackoverflow.com/users/1384712/bernardo-vale"}, "edited": false, "score": 0, "creation_date": 1465265437, "post_id": 36148433, "comment_id": 62816867, "body": "Did you manage to find a solution by yourself? I&#39;m trying to implement the same thing, without luck so far."}, {"owner": {"reputation": 372, "user_id": 3839487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/PSX0M.png?s=128&g=1", "display_name": "LEo", "link": "https://stackoverflow.com/users/3839487/leo"}, "edited": false, "score": 0, "creation_date": 1465363528, "post_id": 36148433, "comment_id": 62863540, "body": "I use the ip address, to convert hostid, for example\uff1a ` ip: 192.168.3.120 -&gt; hostid:a8c07803`"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1527506425, "post_id": 36148433, "comment_id": 88140487, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/328936/608639\">Getting a unique id from a unix-like system</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 3406253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NCsCl.png?s=128&g=1", "display_name": "user3406253", "link": "https://stackoverflow.com/users/3406253/user3406253"}, "is_accepted": false, "score": 1, "last_activity_date": 1458640162, "last_edit_date": 1495535642, "creation_date": 1458640162, "answer_id": 36151022, "question_id": 36148433, "link": "https://stackoverflow.com/questions/36148433/how-to-get-the-unique-identifier-of-the-current-host-in-golang/36151022#36151022", "title": "how to get the unique identifier of the current host in golang?", "body": "<p>gethostid(3) is a UNIX/BSD specific libc function. reading from /etc/hostid would not work on non UNIX systems and is not platform independent.</p>\n\n<p>since go does not provide something like gethostid() why not implement it like other platform independent languages like JAVA do, answered here:\n<a href=\"https://stackoverflow.com/questions/1986732/how-to-get-a-unique-computer-identifier-in-java-like-disk-id-or-motherboard-id\">How to get a unique computer identifier in Java (like disk id or motherboard id)</a></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 3989211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d8329e4d06097c307f044a30b25752f?s=128&d=identicon&r=PG", "display_name": "Denis Brodbeck", "link": "https://stackoverflow.com/users/3989211/denis-brodbeck"}, "is_accepted": false, "score": 2, "last_activity_date": 1508444253, "creation_date": 1508444253, "answer_id": 46838241, "question_id": 36148433, "link": "https://stackoverflow.com/questions/36148433/how-to-get-the-unique-identifier-of-the-current-host-in-golang/46838241#46838241", "title": "how to get the unique identifier of the current host in golang?", "body": "<p>You probably want the <strong>machine-id</strong>.</p>\n\n<p><a href=\"http://man7.org/linux/man-pages/man5/machine-id.5.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man5/machine-id.5.html</a> says:</p>\n\n<blockquote>\n  <p>The machine ID is usually generated from a random source during\n    system installation and stays constant for all subsequent boots.\n    Optionally, for stateless systems, it is generated during runtime at\n    early boot if it is found to be empty.</p>\n  \n  <p>The machine ID does not change based on local or network\n    configuration or when hardware is replaced. Due to this and its\n    greater length, it is a more useful replacement for the gethostid(3)\n    call that POSIX specifies.</p>\n</blockquote>\n\n<p>You can get the <code>machine-id</code> on (recent) Linux systems with:</p>\n\n<pre><code>cat /etc/machine-id\n# or\ncat /var/lib/dbus/machine-id\n</code></pre>\n\n<p>Most major OSs have a unique host identifier. Still, there may be non-unique host IDs (caused by imaging/cloning/backup-restore).</p>\n\n<p>You can also check out my golang package <a href=\"https://github.com/denisbrodbeck/machineid\" rel=\"nofollow noreferrer\" title=\"machineid\">machineid</a> for implementation details, which works on BSD, Linux, OS X and Windows and requires no admin privileges.</p>\n"}], "owner": {"reputation": 372, "user_id": 3839487, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/PSX0M.png?s=128&g=1", "display_name": "LEo", "link": "https://stackoverflow.com/users/3839487/leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3352, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1527506563, "creation_date": 1458631628, "last_edit_date": 1527506563, "question_id": 36148433, "link": "https://stackoverflow.com/questions/36148433/how-to-get-the-unique-identifier-of-the-current-host-in-golang", "title": "how to get the unique identifier of the current host in golang?", "body": "<p>I want to get the unique identifier of the current host that is used as the license name in golang. How to do that ? For example, like C\uff1a</p>\n\n<pre><code>gethostid() //can get the host id\n</code></pre>\n"}, {"tags": ["python", "mysql", "csv", "go", "sqlalchemy"], "comments": [{"owner": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1458627002, "post_id": 36147293, "comment_id": 59932132, "body": "What database? Please tag your question"}, {"owner": {"reputation": 157, "user_id": 4444135, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-9ulWM4uAadA/AAAAAAAAAAI/AAAAAAAAEi4/YTOEQaPomoM/photo.jpg?sz=128", "display_name": "WendellLiu", "link": "https://stackoverflow.com/users/4444135/wendellliu"}, "reply_to_user": {"reputation": 51795, "user_id": 495455, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/b0VBC.jpg?s=128&g=1", "display_name": "Jeremy Thompson", "link": "https://stackoverflow.com/users/495455/jeremy-thompson"}, "edited": false, "score": 0, "creation_date": 1458627348, "post_id": 36147293, "comment_id": 59932283, "body": "ok, I  had updated my tag and content."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1458627936, "post_id": 36147293, "comment_id": 59932558, "body": "You want LOAD DATA [LOCAL] INFILE. I can&#39;t help you with it but there are <a href=\"http://stackoverflow.com/search?tab=votes&amp;q=load%20data%20local%20infile\">other questions on it</a> and you can search around for official MySQL or other help on the Web."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 4444135, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-9ulWM4uAadA/AAAAAAAAAAI/AAAAAAAAEi4/YTOEQaPomoM/photo.jpg?sz=128", "display_name": "WendellLiu", "link": "https://stackoverflow.com/users/4444135/wendellliu"}, "edited": false, "score": 0, "creation_date": 1458632824, "post_id": 36147653, "comment_id": 59934957, "body": "OK, i will try them!"}], "tags": [], "owner": {"reputation": 468, "user_id": 1117026, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1b833426c9221e4b886def0ddd170d05?s=128&d=identicon&r=PG", "display_name": "elgris", "link": "https://stackoverflow.com/users/1117026/elgris"}, "is_accepted": false, "score": 2, "last_activity_date": 1458628518, "last_edit_date": 1495535312, "creation_date": 1458628518, "answer_id": 36147653, "question_id": 36147293, "link": "https://stackoverflow.com/questions/36147293/read-a-csv-and-insert-to-database-performance/36147653#36147653", "title": "Read a csv and insert to database performance", "body": "<p>For such a mission you <strong>don't want</strong> to insert data <strong>line by line</strong> :) Basically, you have 2 ways:</p>\n\n<ol>\n<li>Ensure that sqlalchemy does not run queries one by one. Use BATCH <code>INSERT</code> query (<a href=\"https://stackoverflow.com/questions/5526917/how-to-do-a-batch-insert-in-mysql\">How to do a batch insert in MySQL</a>) instead.</li>\n<li>Massage your data in a way you need, then output it into some temporary CSV file and then run <code>LOAD DATA [LOCAL] INFILE</code> as suggested above. If you don't need to preprocess you data, just feed the CSV to the database (I assume it's MySQL)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 7888768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mHorPGzr9lg/AAAAAAAAAAI/AAAAAAAAAAA/8XX_Whsv9-E/photo.jpg?sz=128", "display_name": "Ramesh Seera", "link": "https://stackoverflow.com/users/7888768/ramesh-seera"}, "is_accepted": false, "score": 0, "last_activity_date": 1528277872, "last_edit_date": 1528277872, "creation_date": 1528269257, "answer_id": 50714306, "question_id": 36147293, "link": "https://stackoverflow.com/questions/36147293/read-a-csv-and-insert-to-database-performance/50714306#50714306", "title": "Read a csv and insert to database performance", "body": "<p>Follow below three steps</p>\n\n<ol>\n<li>Save the CSV file with the name of table what you want to save it\nto.  </li>\n<li>Execute below python script to create a table dynamically\n(Update CSV filename, db parameters)  </li>\n<li>Execute \"mysqlimport\n--ignore-lines=1 --fields-terminated-by=, --local -u dbuser -p db_name dbtable_name.csv\"</li>\n</ol>\n\n<p><strong>PYTHON CODE</strong>:</p>\n\n<pre><code>import numpy as np\nimport pandas as pd\nfrom mysql.connector import connect\n\ncsv_file = 'dbtable_name.csv'\ndf = pd.read_csv(csv_file)\ntable_name = csv_file.split('.')\n\nquery = \"CREATE TABLE \" + table_name[0] + \"( \\n\" \nfor count in np.arange(df.columns.values.size):\n    query += df.columns.values[count]\n    if df.dtypes[count] == 'int64':\n        query += \"\\t\\t int(11) NOT NULL\"\n    elif df.dtypes[count] == 'object':\n        query += \"\\t\\t varchar(64) NOT NULL\"\n    elif df.dtypes[count] == 'float64':\n        query += \"\\t\\t float(10,2) NOT NULL\"\n\n\n    if count == 0:\n        query += \" PRIMARY KEY\"\n\n    if count &lt; df.columns.values.size - 1:\n        query += \",\\n\"\n\nquery += \" );\"\n#print(query)\n\ndatabase = connect(host='localhost',  # your host\n                     user='username', # username\n                     passwd='password',     # password\n                     db='dbname') #dbname\ncurs = database.cursor(dictionary=True)\ncurs.execute(query)\n# print(query)\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 4444135, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-9ulWM4uAadA/AAAAAAAAAAI/AAAAAAAAEi4/YTOEQaPomoM/photo.jpg?sz=128", "display_name": "WendellLiu", "link": "https://stackoverflow.com/users/4444135/wendellliu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528277872, "creation_date": 1458626908, "last_edit_date": 1458627369, "question_id": 36147293, "link": "https://stackoverflow.com/questions/36147293/read-a-csv-and-insert-to-database-performance", "title": "Read a csv and insert to database performance", "body": "<p>I have a mission to read a csv file line by line and insert them to database.</p>\n\n<p>And the csv file contains about 1.7 million lines.</p>\n\n<p>I use python with sqlalchemy orm(merge function) to do this.\nBut it spend over five hours.</p>\n\n<p>Is it caused by python slow performance or sqlalchemy or sqlalchemy?</p>\n\n<p>or what if i use golang to do it to make a obvious better performance?(but i have no experience on go. Besides, this job need to be scheduled every month)</p>\n\n<p>Hope you guy giving any suggestion, thanks!</p>\n\n<p>Update: database - mysql</p>\n"}, {"tags": ["javascript", "json", "post", "go"], "comments": [{"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 1, "creation_date": 1458625737, "post_id": 36146950, "comment_id": 59931582, "body": "You&#39;re right in using <code>r.Body</code>. The reason that it looks so strange when you print it is that you&#39;re printing the structure that will let you read the posted contents (that is, the <code>io.Reader</code>) rather than the actual contents."}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "reply_to_user": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 0, "creation_date": 1458625928, "post_id": 36146950, "comment_id": 59931656, "body": "that makes a lot more sense.  thank you"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 1, "creation_date": 1458626572, "post_id": 36146950, "comment_id": 59931934, "body": "<code>ParseForm</code> would not work because it expects the encoding to be <code>application&#47;x-www-form-urlencoded</code> or <code>multipart&#47;form-data</code> which are different to json"}], "answers": [{"comments": [{"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 1, "creation_date": 1458625946, "post_id": 36147018, "comment_id": 59931664, "body": "For the full details see the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">docs for Unmarshal</a>: Unmarshal unmarshals into structs &quot;preferring an exact match but also accepting a case-insensitive match. Unmarshal will only set exported fields of the struct&quot;"}, {"owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "edited": false, "score": 0, "creation_date": 1458626112, "post_id": 36147018, "comment_id": 59931733, "body": "I&#39;ve read that JSON.decode should be used in place of unmarshal.  Though they seem very similar.  Is JSON.decode a sort of extension of unmarshal basic functions?"}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 3, "last_activity_date": 1458625641, "creation_date": 1458625641, "answer_id": 36147018, "question_id": 36146950, "link": "https://stackoverflow.com/questions/36146950/golang-javascript-empty-postform-and-decodebody-on-json-post/36147018#36147018", "title": "GoLang/Javascript: Empty postForm and decode(body) on JSON POST", "body": "<p>Export the field <code>hat</code> of the struct <code>Hat</code> and json decoding would work.</p>\n\n<pre><code>type Hat struct {\n    Hat string // Exported field names begins with capital letters\n}\n</code></pre>\n"}], "owner": {"reputation": 4515, "user_id": 4808079, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/hXTld.jpg?s=128&g=1", "display_name": "Seph Reed", "link": "https://stackoverflow.com/users/4808079/seph-reed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "accepted_answer_id": 36147018, "answer_count": 1, "score": -1, "last_activity_date": 1458625641, "creation_date": 1458625319, "last_edit_date": 1495542689, "question_id": 36146950, "link": "https://stackoverflow.com/questions/36146950/golang-javascript-empty-postform-and-decodebody-on-json-post", "title": "GoLang/Javascript: Empty postForm and decode(body) on JSON POST", "body": "<p>I'm trying to POST JSON data from a javascript page, into a golang server, but I'm unable to find any trace of the JSON data using the SO accepted answers on both ends.</p>\n\n<p><a href=\"https://stackoverflow.com/a/13038218/4808079\"><em>This post</em></a> shows the way I'm posting my JSON in Javascript and <a href=\"https://stackoverflow.com/a/15685432/4808079\"><em>this post</em></a> shows the way I'm trying to process this JSON in Go.</p>\n\n<pre><code>//js json post send\nvar request = new XMLHttpRequest();\nrequest.open('POST', 'http://localhost:8080/aardvark/posts', true);\nrequest.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\nvar data = {hat: \"fez\"};\nrequest.send(JSON.stringify(data));\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/29439630/4808079\">The header below was set from this answer</a></p>\n\n<pre><code>//Go json post response\nfunc reply(w http.ResponseWriter, r *http.Request) {\n\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    w.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n    w.Header().Set(\"Access-Control-Allow-Headers\", \"Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization, accept, origin, Cache-Control, X-Requested-With\")\n    w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, OPTIONS, GET, PUT\")\n\n\n    if err := r.ParseForm(); err != nil {\n        fmt.Println(err);\n    }\n\n    //this is my first impulse.  It makes the most sense to me.\n    fmt.Println(r.PostForm);          //out -&gt; `map[]`  would be `map[string]string` I think\n    fmt.Println(r.PostForm[\"hat\"]);   //out -&gt; `[]`  would be `fez` or `[\"fez\"]`\n    fmt.Println(r.Body);              //out -&gt; `&amp;{0xc82000e780 &lt;nil&gt; &lt;nil&gt; false true {0 0} false false false}`\n\n\n    type Hat struct {\n        hat string\n    }\n\n    //this is the way the linked SO post above said should work.  I don't see how the r.Body could be decoded.\n    decoder := json.NewDecoder(r.Body)\n    var t Hat   \n    err := decoder.Decode(&amp;t)\n    if err != nil {\n        fmt.Println(err);\n    }\n    fmt.Println(t);                  //out -&gt; `{ }`\n}\n</code></pre>\n\n<p>I'm not really sure what else to try from here.  What should I change to make this work?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4060, "user_id": 763355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dxAhW.jpg?s=128&g=1", "display_name": "MoDJ", "link": "https://stackoverflow.com/users/763355/modj"}, "is_accepted": false, "score": 5, "last_activity_date": 1458610301, "creation_date": 1458610301, "answer_id": 36144719, "question_id": 36144675, "link": "https://stackoverflow.com/questions/36144675/how-to-convert-int-int64-into-uint16-in-golang/36144719#36144719", "title": "How to convert int (int64) into uint16 in golang?", "body": "<p>You need to check that the number is not negative and that it is &lt;= 0xFFFF and then cast it to an unsigned 16 bit int.</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1458661845, "post_id": 36145819, "comment_id": 59955469, "body": "Nitpicking: Go does not have type casts; what we&#39;re dealing with here is called type conversion. Go is explicit about this sort of thing."}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1458666904, "post_id": 36145819, "comment_id": 59959045, "body": "Appreciated.  Edited the example.  I hadn&#39;t noticed the distinction but sure enough, I could not find the term cast used by the Go authors, just by examples supplied by others."}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": true, "score": 27, "last_activity_date": 1458666801, "last_edit_date": 1458666801, "creation_date": 1458618869, "answer_id": 36145819, "question_id": 36144675, "link": "https://stackoverflow.com/questions/36144675/how-to-convert-int-int64-into-uint16-in-golang/36145819#36145819", "title": "How to convert int (int64) into uint16 in golang?", "body": "<pre><code>// convert the type and assign to new variable or pass as a parameter. \nvar i int\n...\nu := uint16(i)\nfoo(uint16(i))\n</code></pre>\n"}], "owner": {"reputation": 3728, "user_id": 2073991, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/hjYJt.jpg?s=128&g=1", "display_name": "Yi Jiang", "link": "https://stackoverflow.com/users/2073991/yi-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27429, "favorite_count": 1, "accepted_answer_id": 36145819, "answer_count": 2, "score": 8, "last_activity_date": 1458666801, "creation_date": 1458610085, "last_edit_date": 1458610513, "question_id": 36144675, "link": "https://stackoverflow.com/questions/36144675/how-to-convert-int-int64-into-uint16-in-golang", "title": "How to convert int (int64) into uint16 in golang?", "body": "<p>I can 100% guaranty the value of input int variable is always unsign(positive) and less than int16. </p>\n\n<p>How can I convert this int type variable to uint16?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 5, "creation_date": 1458609954, "post_id": 36144644, "comment_id": 59927101, "body": "What do you mean &quot;cost&quot;? Unless you&#39;re storing billions of these and doing billions of operations on them I doubt you&#39;d even notice the difference. Use whatever representation covers the values you&#39;re likely to encounter."}, {"owner": {"reputation": 3728, "user_id": 2073991, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/hjYJt.jpg?s=128&g=1", "display_name": "Yi Jiang", "link": "https://stackoverflow.com/users/2073991/yi-jiang"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1458610255, "post_id": 36144644, "comment_id": 59927194, "body": "The cost also including developer writing lines to convert variable type in source-code."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1458611534, "post_id": 36144644, "comment_id": 59927517, "body": "If you&#39;re converting all the time you&#39;ve picked the wrong type."}, {"owner": {"reputation": 1594, "user_id": 759298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bae1d7a91cd9e390a4d8d92c2636aa7?s=128&d=identicon&r=PG", "display_name": "Supreet Sethi", "link": "https://stackoverflow.com/users/759298/supreet-sethi"}, "edited": false, "score": 2, "creation_date": 1458615577, "post_id": 36144644, "comment_id": 59928616, "body": "You could look at <a href=\"http://golang-sizeof.tips/?source=djinn\" rel=\"nofollow noreferrer\">golang-sizeof</a> for this category of calculations."}, {"owner": {"reputation": 3728, "user_id": 2073991, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/hjYJt.jpg?s=128&g=1", "display_name": "Yi Jiang", "link": "https://stackoverflow.com/users/2073991/yi-jiang"}, "reply_to_user": {"reputation": 1594, "user_id": 759298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bae1d7a91cd9e390a4d8d92c2636aa7?s=128&d=identicon&r=PG", "display_name": "Supreet Sethi", "link": "https://stackoverflow.com/users/759298/supreet-sethi"}, "edited": false, "score": 0, "creation_date": 1458617314, "post_id": 36144644, "comment_id": 59929037, "body": "@djinn This online tool is so useful! It solved my question. I thought bool and int16 will still waste 64 bits memory."}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 1, "creation_date": 1458648133, "post_id": 36144644, "comment_id": 59944705, "body": "&quot;We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil.&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 15124, "user_id": 144969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a12d286134563e628089f733b946a00?s=128&d=identicon&r=PG", "display_name": "Dimitar Dimitrov", "link": "https://stackoverflow.com/users/144969/dimitar-dimitrov"}, "is_accepted": true, "score": 12, "last_activity_date": 1458632100, "creation_date": 1458632100, "answer_id": 36148542, "question_id": 36144644, "link": "https://stackoverflow.com/questions/36144644/in-golang-uint16-vs-int-which-is-less-cost/36148542#36148542", "title": "In Golang, uint16 VS int, which is less cost?", "body": "<p>For the vast majority of cases using <code>int</code> makes more sense.\nHere are some reasons:</p>\n\n<ol>\n<li>Go doesn't implicitly convert between the numeric types, even when you think it should. If you start using some unsigned type instead of <code>int</code>, you should expect to pepper your code with multiple type conversions, because of other libraries or APIs preferring not to bother with unsigned types, because of untyped constant numerical expressions returning <code>int</code> values, etc.</li>\n<li>Unsigned types are more prone to underflowing than signed types, because 0 (an unsigned type's boundary value) is much more of a naturally occurring value in computer programs than, for example, -9223372036854775808.</li>\n<li>If you want to use an unsigned type because it restricts the values that you can put in it, keep in mind that when you combine silent underflow and compile time-only constant propagation, you probably aren't getting the bargain you were looking for. For example, while you cannot convert the constant <code>math.MinInt64</code> to a <code>uint</code>, you can easily convert an <code>int</code> variable with value <code>math.MinInt64</code> to a <code>uint</code>. And arguably it's not a bad Go style to have an <code>if</code> check whether the value you're trying to assign is valid for your program.</li>\n</ol>\n\n<p>Unless you are experiencing significant memory pressure and your value space is somewhere slightly over what a smaller signed type would offer you, I'd think that using <code>int</code> will be much more efficient even if only because of development cost.\nAnd even then, chances are that either there's a problem somewhere else in your program's memory footprint, or a managed language like Go is not the best fit for your needs.</p>\n"}], "owner": {"reputation": 3728, "user_id": 2073991, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/hjYJt.jpg?s=128&g=1", "display_name": "Yi Jiang", "link": "https://stackoverflow.com/users/2073991/yi-jiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1449, "favorite_count": 0, "accepted_answer_id": 36148542, "answer_count": 1, "score": 2, "last_activity_date": 1458632100, "creation_date": 1458609804, "question_id": 36144644, "link": "https://stackoverflow.com/questions/36144644/in-golang-uint16-vs-int-which-is-less-cost", "title": "In Golang, uint16 VS int, which is less cost?", "body": "<p>I am using a 64Bit server. My golang program needs integer type.</p>\n\n<p>SO, If I use uint16 and uint32 type in source code, does it cost more than use most regular int type? </p>\n\n<p>I am considering both computing cost and developing cost.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1458604948, "creation_date": 1458604948, "answer_id": 36143921, "question_id": 36143870, "link": "https://stackoverflow.com/questions/36143870/use-int-as-month-when-constructing-date/36143921#36143921", "title": "Use int as month when constructing date", "body": "<p>In the first example you're declaring the type as a <code>time.Month</code>, it is not an int, it is a <code>time.Month</code>. In the second example the type is an int. If you were to do a cast, like in this example it would work as you expect; <a href=\"https://play.golang.org/p/drD_7KiJu4\" rel=\"nofollow\">https://play.golang.org/p/drD_7KiJu4</a></p>\n\n<p>If in your first example you declared <code>m</code> as an <code>int</code> or just used the <code>:=</code> operator (the implied type would be int) and you would get the same error as in the second example. Demonstrated here; <a href=\"https://play.golang.org/p/iWc-2Mpsly\" rel=\"nofollow\">https://play.golang.org/p/iWc-2Mpsly</a></p>\n"}, {"comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1458619904, "post_id": 36143950, "comment_id": 59929658, "body": "There&#39;s no such thing as &#39;casting&#39; in Go. It&#39;s a type conversion, casting in the C sense is less strict."}], "tags": [], "owner": {"reputation": 4268, "user_id": 5768335, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FVCGA.jpg?s=128&g=1", "display_name": "amanuel2", "link": "https://stackoverflow.com/users/5768335/amanuel2"}, "is_accepted": true, "score": 18, "last_activity_date": 1458619864, "last_edit_date": 1458619864, "creation_date": 1458605085, "answer_id": 36143950, "question_id": 36143870, "link": "https://stackoverflow.com/questions/36143870/use-int-as-month-when-constructing-date/36143950#36143950", "title": "Use int as month when constructing date", "body": "<p>You have to convert the value to the proper type:</p>\n\n<pre><code>import(\n    \"fmt\" \n    \"time\" \n    \"strconv\"\n) \n\nfunc main() {\n    var m, _ = strconv.Atoi(\"01\")\n     // Now convert m to type time.Month \n    fmt.Println(time.Date(2016, time.Month(m), 1, 0, 0, 0, 0, time.UTC))\n}\n</code></pre>\n\n<p>You converted it to a type <code>int</code>, but the 2nd parameter of <code>time.Date()</code> is of type <code>time.Month</code> so it would give you an error that you are not using the correct type.</p>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1458619326, "creation_date": 1458619326, "answer_id": 36145871, "question_id": 36143870, "link": "https://stackoverflow.com/questions/36143870/use-int-as-month-when-constructing-date/36145871#36145871", "title": "Use int as month when constructing date", "body": "<p>The Go compiler only casts constants to types on its own. Variables need to be explicitly cast. </p>\n"}], "owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9856, "favorite_count": 0, "accepted_answer_id": 36143950, "answer_count": 3, "score": 13, "last_activity_date": 1602147562, "creation_date": 1458604681, "last_edit_date": 1602147562, "question_id": 36143870, "link": "https://stackoverflow.com/questions/36143870/use-int-as-month-when-constructing-date", "title": "Use int as month when constructing date", "body": "<p>When I supply an <code>int</code> as an argument to <code>time.Date</code> for <code>month</code>, it works (<a href=\"https://play.golang.org/p/nNArrTEq0N\" rel=\"noreferrer\">Example</a>):</p>\n\n<pre><code>time.Date(2016, 1, 1, 0, 0, 0, 0, time.UTC)\n</code></pre>\n\n<p>Why, when I try to convert a <code>string</code> to <code>int</code> and then use that variable, I get the error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>cannot use mStr (type int) as type time.Month in argument to time.Date\n</code></pre>\n\n<p>Example: <a href=\"https://play.golang.org/p/-XFNZHK476\" rel=\"noreferrer\">https://play.golang.org/p/-XFNZHK476</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1458609636, "post_id": 36143452, "comment_id": 59926994, "body": "You should use <code>guru</code> (golang.org/x/tools/cmd/guru) instead of <code>oracle</code>."}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458666229, "post_id": 36143452, "comment_id": 59958538, "body": "Thanks.  Didn&#39;t know about guru either.  It&#39;s the renamed oracle.  go get golang.org/x/tools/cmd/guru.  Needed go1.6.  go1.5.3 ran into some build errors I didn&#39;t feel worth trying to figure out."}, {"owner": {"reputation": 31, "user_id": 6096002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mcGLurJ-VDU/AAAAAAAAAAI/AAAAAAAAABE/LHy9g7W1opE/photo.jpg?sz=128", "display_name": "Sinclair Combra", "link": "https://stackoverflow.com/users/6096002/sinclair-combra"}, "edited": false, "score": 0, "creation_date": 1458673134, "post_id": 36143452, "comment_id": 59963007, "body": "Thanks. I have the same problem though. Does <code>guru -scope github.com&#47;rogpeppe&#47;godef callers src&#47;github.com&#47;rogpeppe&#47;godef&#47;doc.go:#860</code> work for you?"}], "owner": {"reputation": 31, "user_id": 6096002, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-mcGLurJ-VDU/AAAAAAAAAAI/AAAAAAAAABE/LHy9g7W1opE/photo.jpg?sz=128", "display_name": "Sinclair Combra", "link": "https://stackoverflow.com/users/6096002/sinclair-combra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458602416, "creation_date": 1458602416, "question_id": 36143452, "link": "https://stackoverflow.com/questions/36143452/go-oracle-command-fails-in-cgo", "title": "Go oracle command fails in cgo", "body": "<p>The oracle command seems to work on some projects,</p>\n\n<pre><code>$ oracle -pos $PWD/src/golang.org/x/tools/oracle/peers.go:#860 callers golang.org/x/tools/oracle\n/Users/charlie/gowork/src/golang.org/x/tools/oracle/peers.go:26:6: golang.org/x/tools/oracle.peers is called from these 1 sites:\n/Users/charlie/gowork/src/golang.org/x/tools/oracle/oracle.go:118:15:   static function call from golang.org/x/tools/oracle.Run\n</code></pre>\n\n<p>But when I try another popular Go project,</p>\n\n<pre><code>$ oracle -pos $PWD/src/github.com/rogpeppe/godef/doc.go:#860 callers github.com/rogpeppe/godef\n/usr/local/go/src/os/user/lookup_unix.go:21:10: fatal error: 'unistd.h' file not found\n#include &lt;unistd.h&gt;\n         ^\n1 error generated.\ncgo failed: [go tool cgo -objdir /var/folders/_f/ctj4_3hn5pj8s_h3zkwj4gzm0000gn/T/os_user_C106771339 -- -I /var/folders/_f/ctj4_3hn5pj8s_h3zkwj4gzm0000gn/T/os_user_C106771339 lookup_unix.go]: exit status 1\n/usr/local/go/src/net/cgo_bsd.go:11:10: fatal error: 'netdb.h' file not found\n#include &lt;netdb.h&gt;\n         ^\n1 error generated.\ncgo failed: [go tool cgo -objdir /var/folders/_f/ctj4_3hn5pj8s_h3zkwj4gzm0000gn/T/net_C499245934 -- -I /var/folders/_f/ctj4_3hn5pj8s_h3zkwj4gzm0000gn/T/net_C499245934 cgo_bsd.go cgo_resnew.go cgo_sockold.go cgo_unix.go]: exit status 1\n</code></pre>\n\n<p>I don't understand why I am receiving errors from cgo. Can anyone help?</p>\n"}, {"tags": ["mongodb", "go", "mongodb-query"], "comments": [{"owner": {"reputation": 298, "user_id": 3740687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1986f5a79f30fc11c64334528ca7aa70?s=128&d=identicon&r=PG&f=1", "display_name": "obi1", "link": "https://stackoverflow.com/users/3740687/obi1"}, "edited": false, "score": 0, "creation_date": 1458600552, "post_id": 36142981, "comment_id": 59924107, "body": "you are grouping by user_id but I don&#39;t see where you are selecting that as a result value"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1458601117, "post_id": 36142981, "comment_id": 59924309, "body": "Please add an example document <a href=\"http://stackoverflow.com/posts/36142981/edit\">by editing your question</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "reply_to_user": {"reputation": 298, "user_id": 3740687, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1986f5a79f30fc11c64334528ca7aa70?s=128&d=identicon&r=PG&f=1", "display_name": "obi1", "link": "https://stackoverflow.com/users/3740687/obi1"}, "edited": false, "score": 0, "creation_date": 1458601145, "post_id": 36142981, "comment_id": 59924321, "body": "@obi1 I am not sure I understand, can you elaborate ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1458601359, "post_id": 36142981, "comment_id": 59924393, "body": "@MarkusWMahlberg, My question arises due to the fact that this code does not compile. I am not sure why you need an example document here."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1458601484, "post_id": 36142981, "comment_id": 59924436, "body": "@ceroloy Simply to make sure you actually <i>do have</i> a field named <code>user_id</code> and to prevent lengthy discussions. ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1458601587, "post_id": 36142981, "comment_id": 59924475, "body": "@MarkusWMahlberg Oh ok, I am able to work through mongo shell, query works fine however I am not able to make it work with go."}], "answers": [{"comments": [{"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 0, "creation_date": 1458609660, "post_id": 36143571, "comment_id": 59927000, "body": "It missed more than just one <code>bson.M</code>, This again would simply not compile, as well as not noting that the <code>$and</code> is completely unnecessary"}], "tags": [], "owner": {"reputation": 453, "user_id": 6083111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba01cf3ef98244da8d16027dc3eb8a9?s=128&d=identicon&r=PG", "display_name": "user161778", "link": "https://stackoverflow.com/users/6083111/user161778"}, "is_accepted": false, "score": -1, "last_activity_date": 1459955722, "last_edit_date": 1459955722, "creation_date": 1458603020, "answer_id": 36143571, "question_id": 36142981, "link": "https://stackoverflow.com/questions/36142981/aggregation-with-golang-mongodb-gives-error-missing-type-in-composite-literal/36143571#36143571", "title": "Aggregation With Golang/Mongodb Gives Error &quot;Missing type in composite literal&quot;", "body": "<p>I believe this is what you want:</p>\n\n<pre><code>operations := []bson.M{\n    bson.M{\n        \"$match\":bson.M{\n            \"$and\":[]interface{}{\n                bson.M{\"age\":bson.M{\"$gte\":gte}},\n                bson.M{\"age\":bson.M{\"$lte\":lte}},\n            },\n        },\n    },\n    bson.M{\n        \"$group\":bson.M{\"_id\":\"$user_id\"},\n    },\n\n}\n</code></pre>\n\n<p>You simply forgot bson.M before \"$and\".</p>\n\n<p><strong>Edit</strong>: Looks like the ages too, I went ahead and fixed those.</p>\n\n<p><strong>Edit2</strong>: I missed more bson.M's than the initial 3 missing that I saw.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "edited": false, "score": 0, "creation_date": 1458642907, "post_id": 36144608, "comment_id": 59941096, "body": "Unfortunately it did not work. I am trying to get distinct users in the given age range that is why I used group? Is that a mistake too?"}, {"owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "edited": false, "score": 1, "creation_date": 1458644227, "post_id": 36144608, "comment_id": 59942025, "body": "@cemre The question you asked was about was about a composite literal with the expression you had. I gave you a solution that solved this. I have also rolled back your question revision as that is extremely rude. This is not a threaded discussion. You ask a question and someone answers it, then you accept it an move on. If you have other questions then <a href=\"http://stackoverflow.com/questions/ask\">Ask another question</a>. Do not change your questions here from what you originally ask. People are nice enough to answer, so be nice back."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "edited": false, "score": 2, "creation_date": 1458746636, "post_id": 36144608, "comment_id": 59999662, "body": "In addition, no your answer did not solved my problem since you modified the conditional part. I was originally trying to learn about using conditionals in the query and your answer just removes the part I am trying to learn."}], "tags": [], "owner": {"reputation": 43776, "user_id": 5031275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h8FTg.png?s=128&g=1", "display_name": "Blakes Seven", "link": "https://stackoverflow.com/users/5031275/blakes-seven"}, "is_accepted": false, "score": 3, "last_activity_date": 1458609935, "last_edit_date": 1458609935, "creation_date": 1458609533, "answer_id": 36144608, "question_id": 36142981, "link": "https://stackoverflow.com/questions/36142981/aggregation-with-golang-mongodb-gives-error-missing-type-in-composite-literal/36144608#36144608", "title": "Aggregation With Golang/Mongodb Gives Error &quot;Missing type in composite literal&quot;", "body": "<p>You have not defined \"each\" pipeline stage as a <code>bson.M</code>. It's an \"array\" of <code>bson.M</code>, hence the error:</p>\n\n<pre><code>operations := []bson.M{\n    bson.M{\n        \"$match\": bson.M{\n            \"date\": bson.M{ \"$gte\": gte, \"$lte\": lte }\n        }\n    },\n    bson.M{\n        \"group\": bson.M{ \"_id\": \"$user_id\" }\n    }\n}\n</code></pre>\n\n<p>Also <a href=\"https://docs.mongodb.org/manual/reference/operator/query/and/\" rel=\"nofollow\"><code>$and</code></a> is not necessary. <strong>ALL</strong> MongoDB query conditions are already an \"AND\" expression anyway. The combination of <a href=\"https://docs.mongodb.org/manual/reference/operator/query/gte/\" rel=\"nofollow\"><code>$gte</code></a> and <a href=\"https://docs.mongodb.org/manual/reference/operator/query/lte/\" rel=\"nofollow\"><code>$lte</code></a> as keys in the same object expression is <em>already</em> an AND condtion on the same <code>\"date\"</code> property. Just as would be the addition of more keys within the <code>$match</code> object.</p>\n\n<p>In the JavaScript shell, this is the same as:</p>\n\n<pre><code>var operations = [\n    { \"$match\": { \"date\": { \"$gte\": gte, \"$lte\": lte } } },\n    { \"$group\": { \"_id\": \"$user_id\" } }\n];\n</code></pre>\n\n<p>So you need to remember that every JavaScript object notation <code>{}</code> equals a <code>.bson.M{}</code> statement. That's how you notate BSON objects in go with this libary.</p>\n\n<p><strong>Note:</strong> <code>{ \"$group\": { \"_id\": \"$user_id } }</code> is not going to do anything meaningful other than just return each \"distinct\" <code>\"user_id\"</code> value. So you likely want more <a href=\"https://docs.mongodb.org/manual/reference/operator/aggregation-group/\" rel=\"nofollow\">accumulator options</a> in any real result</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5766400"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1459955722, "creation_date": 1458600020, "last_edit_date": 1458644244, "question_id": 36142981, "link": "https://stackoverflow.com/questions/36142981/aggregation-with-golang-mongodb-gives-error-missing-type-in-composite-literal", "title": "Aggregation With Golang/Mongodb Gives Error &quot;Missing type in composite literal&quot;", "body": "<p>I am trying to get users in a certain age range via aggregation.</p>\n\n<p><strong>Edit:</strong> I am able to work through mongo shell, query works fine however I am not able to make it work with go</p>\n\n<blockquote>\n  <p>This code gives me \"missing type in composite literal\" error.</p>\n</blockquote>\n\n<p>What am I missing here?</p>\n\n<pre><code>lte := 10\ngte := 0\n\noperations := []bson.M{\n    {\n        \"$match\":{\n            \"$and\":[]interface{}{\n                bson.M{\"age\":{\"$gte\":gte}},\n                bson.M{\"age\":{\"$lte\":lte}},\n            },\n        },\n    },\n    {\n        \"$group\":bson.M{\"_id\":\"$user_id\"},\n    },\n\n}\n\nr := []bson.M{}\n\npipe := c.Pipe(operations)\nerr := pipe.All(&amp;r)\nif err != nil {\n    logrus.Errorf(\"Error:  %v\", err)\n    return err\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 315, "user_id": 5412970, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/73b1e43211e66f1f6fc52e3ac90e1acf?s=128&d=identicon&r=PG&f=1", "display_name": "Andre Minov", "link": "https://stackoverflow.com/users/5412970/andre-minov"}, "edited": false, "score": 0, "creation_date": 1458589470, "post_id": 36139061, "comment_id": 59918740, "body": "@evanmcdonnal I&#39;m interesting of real user experience. I guess people faced same problems with thousands of logs files. Can you recommend exact implementation?"}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1488211356, "post_id": 36140525, "comment_id": 72119991, "body": "What service runner do you recommend for that?"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1458590672, "creation_date": 1458590672, "answer_id": 36140525, "question_id": 36139061, "link": "https://stackoverflow.com/questions/36139061/best-way-to-roll-log-file-in-go/36140525#36140525", "title": "Best way to roll log file in GO", "body": "<p>What I usually do is not use log files directly. Either you write to a network logger, like scribe or kafka, etc; Or preferably, you write to stdout/stderr, and have the service runner deal with writing to logfiles, forwarding to a network logger, or rotating the files.</p>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459570884, "post_id": 36140553, "comment_id": 60357250, "body": "Absolutely agree.  When you have 15+ projects running, with dozens (or 100s) of instances of each, you want all of its output to stdout/stderr for logging.  This allows the devops team (or yourself) to offload the logging however needed. For example, stream it to AWS&#39; CloudWatch Logs service where you can filter and group and setup alerts."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 4, "last_activity_date": 1458590770, "creation_date": 1458590770, "answer_id": 36140553, "question_id": 36139061, "link": "https://stackoverflow.com/questions/36139061/best-way-to-roll-log-file-in-go/36140553#36140553", "title": "Best way to roll log file in GO", "body": "<p>I tend to take the <a href=\"http://12factor.net/\" rel=\"nofollow\">12 Factor</a> approach of logging to std error and letting something else deal with the rotation.</p>\n\n<p>Then, you have the system rotate the logs for you, as is mentioned <a href=\"https://paperairoplane.net/?p=725\" rel=\"nofollow\">here</a></p>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 5412970, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/73b1e43211e66f1f6fc52e3ac90e1acf?s=128&d=identicon&r=PG&f=1", "display_name": "Andre Minov", "link": "https://stackoverflow.com/users/5412970/andre-minov"}, "edited": false, "score": 0, "creation_date": 1458649735, "post_id": 36154355, "comment_id": 59945801, "body": "That looks like perfect solution!"}], "tags": [], "owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "is_accepted": true, "score": 2, "last_activity_date": 1459558056, "last_edit_date": 1459558056, "creation_date": 1458649576, "answer_id": 36154355, "question_id": 36139061, "link": "https://stackoverflow.com/questions/36139061/best-way-to-roll-log-file-in-go/36154355#36154355", "title": "Best way to roll log file in GO", "body": "<p>Here's an internal solution. You can consider having a single goroutine responsible for logging and log rotation with a channel where it receives logs from other goroutines. Whenever it is time to rotate, the goroutine will rotate the log, while the incoming logs from other goroutines are enqueued on the channel. After log rotation is completed, it will then dequeue whatever is on the channel and continue logging. </p>\n\n<p>Something along the lines of:</p>\n\n<pre><code>type Log struct {\n\n    log string\n    // other info you might want\n}\n\n// This will be your goroutine\nfunc Logging(LogChannel chan Log) {\n\n    // assume logger creates/opens a file and prepares it for writing  \n    logger := New(logger) \n\n    for {\n\n        // collect a log. Will also block until a log is available on the channel\n        log &lt;- LogChannel\n\n        if timeToRotate() {\n\n            RotateLogFile(logger)\n\n        }\n\n        // write log \n        logger.Log(log)\n    }\n}\n</code></pre>\n\n<p>EDIT: The previous code had the blocking call after checking if the log file rotated. It is better to put it before the <code>timeToRotate</code> function call to prevent the possibility of writing the log after the log file has rotated</p>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1459570951, "post_id": 36163876, "comment_id": 60357266, "body": "I&#39;ve used this too for small one off projects.  But for any large scale deployment, avoid logging to disk and go to stdout/stderr and let the infrastructure deal with mass logging."}], "tags": [], "owner": {"reputation": 71, "user_id": 5893488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4296933f3c376e0ea830254263a1a9b5?s=128&d=identicon&r=PG&f=1", "display_name": "R. Platani", "link": "https://stackoverflow.com/users/5893488/r-platani"}, "is_accepted": false, "score": 6, "last_activity_date": 1458676254, "creation_date": 1458676254, "answer_id": 36163876, "question_id": 36139061, "link": "https://stackoverflow.com/questions/36139061/best-way-to-roll-log-file-in-go/36163876#36163876", "title": "Best way to roll log file in GO", "body": "<p>i've had good success with <a href=\"https://github.com/natefinch/lumberjack\" rel=\"noreferrer\">https://github.com/natefinch/lumberjack</a> it's lightweight and piggy backs on golang's standard and memory efficient \"log\" pkg.</p>\n\n<p>very simple to use, just add one line of code to set it up, and use log as normal:</p>\n\n<pre><code>log.SetOutput(&amp;lumberjack.Logger{\n    Filename:   \"/var/log/myapp/foo.log\",\n    MaxSize:    500, // megabytes\n    MaxBackups: 3,\n    MaxAge:     28, //days\n})\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 5412970, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/73b1e43211e66f1f6fc52e3ac90e1acf?s=128&d=identicon&r=PG&f=1", "display_name": "Andre Minov", "link": "https://stackoverflow.com/users/5412970/andre-minov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8197, "favorite_count": 4, "accepted_answer_id": 36154355, "answer_count": 4, "score": 3, "last_activity_date": 1459558056, "creation_date": 1458585476, "question_id": 36139061, "link": "https://stackoverflow.com/questions/36139061/best-way-to-roll-log-file-in-go", "title": "Best way to roll log file in GO", "body": "<p>Is anyone who is using go language in production faced problem with rolling of log files?</p>\n\n<p>Is there any possibility to roll log file thread safely? </p>\n\n<p>Are there any frameworks that make this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["logging", "go"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "edited": false, "score": 0, "creation_date": 1458658591, "post_id": 36145709, "comment_id": 59952833, "body": "Thanks. I will try something and let you know about the result."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1458618022, "creation_date": 1458618022, "answer_id": 36145709, "question_id": 36138315, "link": "https://stackoverflow.com/questions/36138315/how-to-create-a-package-to-use-any-logger-depending-on-the-caller-program-in/36145709#36145709", "title": "How to create a package to use any logger, depending on the &quot;caller&quot; program in golang?", "body": "<p>If I understand what you're trying to do, you need to define an interface that a logging package would implement. If you define Logger as an empty interface, you won't be able to call any of those methods. Instead, you need to define an interface that contains the methods you want to use (Debug, Info, Error, etc.). Any logging package would then have to implement those methods. If a particular logging package doesn't have the right set of methods already, you would have to write some wrapper code to implement the interface as you define it.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "is_accepted": false, "score": 0, "last_activity_date": 1459268502, "creation_date": 1459268502, "answer_id": 36289809, "question_id": 36138315, "link": "https://stackoverflow.com/questions/36138315/how-to-create-a-package-to-use-any-logger-depending-on-the-caller-program-in/36289809#36289809", "title": "How to create a package to use any logger, depending on the &quot;caller&quot; program in golang?", "body": "<p>I kept searching and found <a href=\"https://0value.com/about-Go-logging\" rel=\"nofollow\">this post</a>. Very interesting.\nAs a infrastructure manager/technician, one thing that I've always missed from many software that I use (and have used) is the ability to have as deeper information as possible to identify and fix issues or even for logging everything for auditing/security proposal. Many times, we face with some issues that even in debug mode we aren't able to find the exactly cause of the problem, we ended up just finding the \"probable\" cause. Now getting back into development world, and seeing how developer are working with logs and libraries, I'm thinking that this could be one reason (the lack of \"interoperability between the main programs and its libraries). As libraries usually have \"their own\" logging (or not loggin at all) and many times, doesn't give a \"full control\" on what is happening inside the library, in most cases the developer who is developing the main program  (using such libraries) will not be able to give its own application the necessary logging details. Of course, I understand that in the open source world, if you want to have a more detailed information including from libraries that you use, as it is open source, you can simple make your changes and it is done. But then, this could make the use of a library (thinking in the advantage of using libraries mainly for not spending time to \"recreate the wheel\", in other world reusability) not as helpful as it should be.\nAs the referenced post mentioned, one way to handle it is by always sending to the caller the \"necessary\" information to be handled. But usually it works for errors, fatals and maybe info level events. But for debug and trace for instance, it isn't \"pratical\" when developing libraries (for many reasons), and then I think that one big reason is that when a developer is developing a library, he will already need all debugs and traces for testing, but not necessarily sending back to the caller. Another way detailed in the post is by using handlers, but by doing this, the developer of the library will have much more work to do. As Andy answered (and is discussed in the post too), an alternative is to create an interface that will receive the main's program logger and use it and for this option to work properly, it should use the stdlib log (or some logging library that implement the most comum logging levels) in case the caller program doesn't case about logging.\nFor my \"wishes\" right now (as I'm benning in programming again and totally beggining in Go), I will create some \"ugly code\" to handle my needs and keep learning and trying ways to accomplish the \"perfect logging system\" which by now, IMHO is using interfaces as Andy suggested.</p>\n"}], "owner": {"reputation": 15, "user_id": 5909261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4142b94b66cbb1f572dba6663191c0e?s=128&d=identicon&r=PG&f=1", "display_name": "Tuts", "link": "https://stackoverflow.com/users/5909261/tuts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 36145709, "answer_count": 2, "score": 0, "last_activity_date": 1459268502, "creation_date": 1458582890, "question_id": 36138315, "link": "https://stackoverflow.com/questions/36138315/how-to-create-a-package-to-use-any-logger-depending-on-the-caller-program-in", "title": "How to create a package to use any logger, depending on the &quot;caller&quot; program in golang?", "body": "<p>As I can see, each developer has its own need and approach to solve same things/needs. As an example, logging. There are many logging packages that works in different ways and each developer choose the one that best fits their needs/preferences. Thinking on that, I would like to create a package that should use the caller's logging package. Is it possible? Someone have a way to do that?</p>\n\n<p>Something like this:</p>\n\n<p>Main code using logrus package:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n\n    \"github.com/Sirupsen/logrus\"\n\n    \"gitlab.com/tutume/_testing/globallogs/mypack\"\n)\n\nvar Log = logrus.New()\n\nvar myPack pack.Pack\n\nfunc main() {\n    isDebug := os.Getenv(\"MYAPP_LOGLEVEL\")\n    switch isDebug {\n    case \"Debug\":\n        Log.Level = logrus.DebugLevel\n    case \"Info\":\n        Log.Level = logrus.InfoLevel\n    default:\n        Log.Level = logrus.ErrorLevel\n    }\n    Log.Formatter = &amp;logrus.TextFormatter{\n        ForceColors: true,\n    }\n\n    Log.Debug(\"Debugging...\")\n    Log.Info(\"Informing...\")\n    Log.Error(\"Normal...\")\n\n    myPack.Logger = Log\n    myPack.DoSomething()\n\n}\n</code></pre>\n\n<p>mypack code:</p>\n\n<pre><code>package pack\n\ntype Pack struct {\n    Logger interface{}\n}\n\nfunc (mp *Pack) DoSomething() {\n    //  Logger.Debug(\"Debugging...\")\n    //  Logger.Info(\"Informing...\")\n    //  Logger.Error(\"Normal...\")\n}\n</code></pre>\n"}, {"tags": ["go", "atomicity", "uint"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1458570973, "post_id": 36133364, "comment_id": 59906299, "body": "obligatory: <a href=\"https://software.intel.com/en-us/blogs/2013/01/06/benign-data-races-what-could-possibly-go-wrong\" rel=\"nofollow noreferrer\">software.intel.com/en-us/blogs/2013/01/06/&hellip;</a>"}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458579328, "post_id": 36133364, "comment_id": 59912546, "body": "Does the OP worry that 8 bits might not be sent to or from RAM or a cache line or a core register coherently?  Or that data, once read, could be stale because of another core&#39;s write?  The last sentence asks about stale data, and yes, data can become stale in one core, or in one goroutine, if another goroutine has logic to write to that 8 bit location.  Gophers prefer to use coroutines and channels.  If you haven&#39;t seen the recommendation &quot;Do not communicate by sharing memory; instead, share memory by communicating&quot;, please see <a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"nofollow noreferrer\">blog.golang.org/share-memory-by-communicating</a>."}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "reply_to_user": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458589159, "post_id": 36133364, "comment_id": 59918574, "body": "@WeakPointer I saw it. I have read all the documentation. In my case, I am required to use locks, however I preferred to  avoid it by atomic variables for cleaner code. So, this said 8 bit data, could it be stale even if there was 1 core?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1458653630, "post_id": 36133364, "comment_id": 59948768, "body": "@OzumSafa: it depends on what you mean by &quot;stale&quot;. If you want visibility between goroutines, there&#39;s no guarantees unless you create a <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow noreferrer\">&quot;happens before&quot;</a> relationship between writing and reading the value. Atomic operations guarantee that the value is read and written in its entirety into memory, but only locks and channels can create a &quot;happens before&quot; ordering to ensure the reads and writes between goroutines are synchronized."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 9, "last_activity_date": 1458581063, "last_edit_date": 1458581063, "creation_date": 1458569851, "answer_id": 36133452, "question_id": 36133364, "link": "https://stackoverflow.com/questions/36133364/are-reads-and-writes-for-uint8-in-golang-atomic/36133452#36133452", "title": "Are reads and writes for uint8 in golang atomic?", "body": "<p>No. If you want atomic operations, you can use the <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow\"><code>sync/atomic</code></a> package.</p>\n\n<p>If you mean \"would 8bit operations be atomic even if I ignore the Go <a href=\"https://golang.org/ref/mem\" rel=\"nofollow\">memory model</a>?\", then the answer is still, <strike>it depends</strike> probably not.</p>\n\n<p>If the hardware guarantees atomicity of read/write operations, then it might be atomic. But that still doesn't guarantee cache coherence, or compiler optimizations from reordering operations. You need to serialize the operations somehow, with the primitives Go provides in the \"atomic\" package, and using the \"sync\" package and channels to coordinate between goroutines. </p>\n"}, {"comments": [{"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 0, "creation_date": 1458572114, "post_id": 36133481, "comment_id": 59907221, "body": "Oh sweet, I was clever :). Thanks for the answer I did not realize I could use atomic.Value, and predefined methods did not work for me."}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 0, "creation_date": 1458572189, "post_id": 36133481, "comment_id": 59907275, "body": "Although, do you know if this atomic.Value is simply a lock system underneath? Because being able to make any data type atomic does not seem possible in cpu level :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "edited": false, "score": 1, "creation_date": 1458572446, "post_id": 36133481, "comment_id": 59907487, "body": "@OzumSafa: You can load and store anything &quot;atomically&quot;(indirectly) by using a pointer. <code>atomic.Value</code> is a little more complex in that it uses the 2 words for the <code>interface{}</code>, but it&#39;s the same concept."}, {"owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458572524, "post_id": 36133481, "comment_id": 59907547, "body": "@JimB I shall look into the source then :) Thanks JimB"}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 9, "last_activity_date": 1458570769, "last_edit_date": 1458570769, "creation_date": 1458569920, "answer_id": 36133481, "question_id": 36133364, "link": "https://stackoverflow.com/questions/36133364/are-reads-and-writes-for-uint8-in-golang-atomic/36133481#36133481", "title": "Are reads and writes for uint8 in golang atomic?", "body": "<p>There's no guarantee that the access on native types are on any platform atomic. This is why there is <a href=\"https://golang.org/pkg/sync/atomic/\"><code>sync/atomic</code></a>. See also <a href=\"https://golang.org/ref/mem#tmp_1\">the advice in the memory model documentation</a>.</p>\n\n<p>Example for generic way of atomically setting a value (<a href=\"http://play.golang.org/p/kF8IdH5Iok\">Play</a>)</p>\n\n<pre><code>var ax atomic.Value // may be globally accessible\n\nx := uint8(5)\n\n// set atomically\nax.Store(x)\n\nx = ax.Load().(uint8)\n</code></pre>\n\n<p>Probably more efficient solution for <code>uint8</code> (<a href=\"http://play.golang.org/p/I3m_kl45lE\">Play</a>):</p>\n\n<pre><code>var ax int64 // may be globally accessible\n\nx := uint8(5)\n\natomic.StoreInt64(&amp;ax, 10)\n\nx = uint8(atomic.LoadInt64(&amp;ax))\n\nfmt.Printf(\"%T %v\\n\", x, x)\n</code></pre>\n"}], "owner": {"reputation": 1218, "user_id": 1407527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/4033d9b1475b98e7d87d1f89a6e2dec8?s=128&d=identicon&r=PG", "display_name": "Ozum Safa", "link": "https://stackoverflow.com/users/1407527/ozum-safa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4456, "favorite_count": 0, "accepted_answer_id": 36133481, "answer_count": 2, "score": 6, "last_activity_date": 1458581063, "creation_date": 1458569621, "question_id": 36133364, "link": "https://stackoverflow.com/questions/36133364/are-reads-and-writes-for-uint8-in-golang-atomic", "title": "Are reads and writes for uint8 in golang atomic?", "body": "<p>As in the title, are read and write operations regarding  uint8, atomic?\nLogically it must be a single cpu instruction obviously to read and write for a 8 bit variable. But in any case, two cores could simultaneously read and write from the memory, is it possible to create a stale data this way?</p>\n"}, {"tags": ["html", "go", "structure"], "owner": {"reputation": 11, "user_id": 5784385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1c02b577c423df61775ad149f7aed1?s=128&d=identicon&r=PG&f=1", "display_name": "malik lakhani", "link": "https://stackoverflow.com/users/5784385/malik-lakhani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "closed_date": 1458562505, "answer_count": 0, "score": 1, "last_activity_date": 1458562228, "creation_date": 1458562228, "question_id": 36130652, "link": "https://stackoverflow.com/questions/36130652/how-to-pass-two-structure-variable-to-golang-html-template", "closed_reason": "Duplicate", "title": "How to pass two structure variable to GOlang html template?", "body": "<p>I want to pass multiple structure variable to Golang html templates. How to do this?</p>\n\n<p>I am passing users variable. Still i want to pass another variable.\nHow to access those variable in view file i.e. html file.</p>\n\n<p>t.Execute(w, users)</p>\n"}, {"tags": ["git", "go", "githooks"], "comments": [{"owner": {"reputation": 401, "user_id": 3050598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yxA9u.png?s=128&g=1", "display_name": "ekiyanov", "link": "https://stackoverflow.com/users/3050598/ekiyanov"}, "edited": false, "score": 0, "creation_date": 1458564658, "post_id": 36130459, "comment_id": 59901603, "body": "I find out the source of problem why go install didn&#39;t work one of golang packages wasn&#39;t installed ( cause of git issues ? I don&#39;t know )   the package was: <code>&quot;golang.org&#47;x&#47;net&#47;context&quot;</code> and i guess it was a dependency for <code>&quot;golang.org&#47;x&#47;oauth2&quot;</code>  After I add that package to my go, it make go install."}], "answers": [{"tags": [], "owner": {"reputation": 401, "user_id": 3050598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yxA9u.png?s=128&g=1", "display_name": "ekiyanov", "link": "https://stackoverflow.com/users/3050598/ekiyanov"}, "is_accepted": true, "score": 0, "last_activity_date": 1459314346, "creation_date": 1459314346, "answer_id": 36300125, "question_id": 36130459, "link": "https://stackoverflow.com/questions/36130459/failed-to-get-dependency-from-git-on-git-post-update-hook/36300125#36300125", "title": "Failed to get dependency from git on git post-update hook", "body": "<p>My solution was to install Jenkins, move all scripts to it, and initiate building with Jenkins from <code>post-update</code> script</p>\n"}], "owner": {"reputation": 401, "user_id": 3050598, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/yxA9u.png?s=128&g=1", "display_name": "ekiyanov", "link": "https://stackoverflow.com/users/3050598/ekiyanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 36300125, "answer_count": 1, "score": 0, "last_activity_date": 1459314346, "creation_date": 1458561615, "question_id": 36130459, "link": "https://stackoverflow.com/questions/36130459/failed-to-get-dependency-from-git-on-git-post-update-hook", "title": "Failed to get dependency from git on git post-update hook", "body": "<p>I have a golang project and i want to build it on server as I push it</p>\n\n<p>post-update hook is fired, everything nice, project is checked out to some directory, but, after it attempts to get dependency (<code>cd /go/src/kiyanov.com/app/</code> and <code>go get</code> ) it fails with an error</p>\n\n<p><code>remote # cd /go/src/github.com/dgrijalva/jwt-go; git show-ref\nremote: fatal: Not a git repository: '.'\nremote: package github.com/dgrijalva/jwt-go: exit status 128</code></p>\n\n<p><code>remote # cd /go/src/github.com/lib/pq; git show-ref\nremote: fatal: Not a git repository: '.'\nremote: package github.com/lib/pq: exit status 128</code></p>\n\n<p><code>remote: # cd /go/src/golang.org/x/oauth2; git show-ref\nremote: fatal: Not a git repository: '.'\nremote: package golang.org/x/oauth2: exit status 128</code></p>\n\n<p>gopath is exported properly, and packages are downloaded. \nbut go install following after this commands are failed</p>\n\n<p>go install works fine after the following push, once post-update make everything again in existing directory.</p>\n\n<p>I don't have any ideas why it not works .The only suggestion cause it happens inside post-update hook, but i'm not sure.</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1458555984, "post_id": 36128444, "comment_id": 59895818, "body": "This was asked just 3 hours ago. You need to use <code>...</code> like this: <code>Load(files...)</code>."}, {"owner": {"reputation": 799, "user_id": 675083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l75tP.jpg?s=128&g=1", "display_name": "sbs", "link": "https://stackoverflow.com/users/675083/sbs"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1458556350, "post_id": 36128444, "comment_id": 59896082, "body": "There&#39;s absolutely no way I could have found that question and answer, but thanks, that is the correct answer"}], "owner": {"reputation": 799, "user_id": 675083, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/l75tP.jpg?s=128&g=1", "display_name": "sbs", "link": "https://stackoverflow.com/users/675083/sbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1458555954, "answer_count": 0, "score": 0, "last_activity_date": 1458555857, "creation_date": 1458555857, "question_id": 36128444, "link": "https://stackoverflow.com/questions/36128444/how-do-you-pass-a-slice-to-function-list-in-go", "closed_reason": "Duplicate", "title": "How do you pass a slice to function list in go?", "body": "<p>I want to pass some values to a (3rd party) function with a signature like this:</p>\n\n<pre><code>func Load(files ...string) error {\n</code></pre>\n\n<p>If I build up a slice of files like this:</p>\n\n<pre><code>var files []string\nappend(files, \"...\")\nappend(files, \"...\")\n</code></pre>\n\n<p>How do I pass my files slice to the function Load? This:</p>\n\n<pre><code>Load(files)\n</code></pre>\n\n<p>Results in this error:</p>\n\n<blockquote>\n  <p>cannot use files (type []string) as type string in argument to Load</p>\n</blockquote>\n"}, {"tags": ["sockets", "go", "proxy", "udp"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1458555242, "post_id": 36128109, "comment_id": 59895340, "body": "As UDP is a connectionless protocol, your question doesn&#39;t make sense."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458556345, "post_id": 36128109, "comment_id": 59896079, "body": "@EJP thanks for the observation, I mean the pool of clients using the proxy, the issue is not related to how UDP protocol works, is more related of how to maintain a list of clients that will be using the Proxy to avoid reaching the limits <code>too many open files</code>"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458556464, "post_id": 36128109, "comment_id": 59896172, "body": "Why? How can you possibly reach a limit when all you need is one UDP socket?"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1458557099, "post_id": 36128109, "comment_id": 59896581, "body": "@EJP problem is not listening in one UDP socket, that works well, issue is that per each connection established I get an <a href=\"https://github.com/nbari/UDP-proxy/blob/0.3.0/cmd/UDP-proxy/main.go#L75\" rel=\"nofollow noreferrer\">IP:PORT</a> the one I need to proxy (a new connection to the remote server), If I am right iperf sends data in chunks using same port, therefore I can&#39;t just open new connections and need to find a way of how to handle existing clients."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 3, "creation_date": 1458559934, "post_id": 36128109, "comment_id": 59898431, "body": "You don&#39;t get &#39;connection(s) established&#39;, and you don&#39;t need to &#39;open a new connection&#39; at all. I repeat that you only need one UDP socket for everything. Your question is based on a major misapprehension."}], "answers": [{"comments": [{"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458570737, "post_id": 36133649, "comment_id": 59906112, "body": "I should also have asked, what UDPProxy package are you using?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458571356, "post_id": 36133649, "comment_id": 59906584, "body": "OP linked to their own UDP proxy code, which opens a new socket for every call to New"}, {"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458578266, "post_id": 36133649, "comment_id": 59911781, "body": "Oh yes.  So the package uses net.DialUDP() which returns a UDPConn pointer.  The UDPConn needs Close() called on it before totally removing the proxy object from the program&#39;s memory.  The OS will then be able to close the file descriptor."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1458581446, "post_id": 36133649, "comment_id": 59914074, "body": "@WeakPointer right, but since I am proxying I need to create a new <code>UDPConn</code> per every call thus I need to find a way of how to properly handle the clients to reuse/close session like you describe"}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 0, "last_activity_date": 1458570339, "creation_date": 1458570339, "answer_id": 36133649, "question_id": 36128109, "link": "https://stackoverflow.com/questions/36128109/udp-proxy-how-to-maintain-reuse-purge-pool-of-connected-clients/36133649#36133649", "title": "UDP proxy, how to maintain/reuse/purge pool of connected clients?", "body": "<p>Since you are creating UDP proxies, you probably know that you have to come up with your own solution for deciding when to \"terminate\" the proxy session.  The session is just an abstraction when it comes to UDP - unless the UDPProxy package you're using has an established mechanism already.</p>\n\n<p>Depending on why you are creating UDP proxies, it might be easy to arbitrarily cleanup connections ... </p>\n\n<p>So if you know that a client is exiting, call the Close() method on the proxy (assuming there is one) and use delete on the map entry.</p>\n\n<p>How to decide that a client is exiting is up to you.  Could use a slice as a FIFO, or pick one randomly, or try setting timers for each.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458570339, "creation_date": 1458554977, "last_edit_date": 1458556389, "question_id": 36128109, "link": "https://stackoverflow.com/questions/36128109/udp-proxy-how-to-maintain-reuse-purge-pool-of-connected-clients", "title": "UDP proxy, how to maintain/reuse/purge pool of connected clients?", "body": "<p>I am creating a <a href=\"https://github.com/nbari/UDP-proxy/tree/0.3.0\" rel=\"nofollow\">UDP-proxy</a> in <a href=\"https://golang.org/\" rel=\"nofollow\">go</a>, but while doing some load test using <a href=\"https://iperf.fr/\" rel=\"nofollow\">iperf</a>, I start to get this error:</p>\n\n<pre><code>socket: too many open files\n</code></pre>\n\n<p>After searching and testing, I found that if I create a pool using a <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">map</a> of opening connections being the <strong>key</strong> <a href=\"https://golang.org/pkg/net/#UDPAddr\" rel=\"nofollow\"><code>*net.UDPAddr.String()</code></a> and the <strong>value</strong> an instance of <a href=\"https://github.com/nbari/UDP-proxy/blob/0.3.0/proxy.go#L8-L15\" rel=\"nofollow\"><code>UDP-proxy</code></a>  containing an  <a href=\"https://golang.org/pkg/net/#UDPConn\" rel=\"nofollow\"><code>*net.UDPConn</code></a>, I am available to reuse existing connection in case the client address is the same:</p>\n\n<pre><code>var clients   map[string]*UDPProxy.UDPProxy = make(map[string]*UDPProxy.UDPProxy) \n</code></pre>\n\n<p>This block of <a href=\"https://github.com/nbari/UDP-proxy/blob/0.3.0/cmd/UDP-proxy/main.go#L74-L91\" rel=\"nofollow\">code</a> looks something like:</p>\n\n<pre><code>// wait for connections\nfor {\n    n, clientAddr, err := conn.ReadFromUDP(buffer)\n    if err != nil {\n        log.Println(err)\n    }\n    counter++\n    if *d {\n        log.Printf(\"new connection from %s\", clientAddr.String())\n    }\n    fmt.Printf(\"Connections: %d, clients: %d\\n\", counter, len(clients))\n    proxy, found = clients[clientAddr.String()]\n    if !found {\n        // make new connection to remote server\n        proxy = UDPProxy.New(conn, clientAddr, raddr_udp, *d)\n        clients[clientAddr.String()] = proxy\n    }\n    go proxy.Start(buffer[0:n])\n}\n</code></pre>\n\n<p>This seems to be working, but the problem I have now, is that I need find a way of expiring,cleaning the map when the client exists or is not using any more the proxy so that I could avoid having multiple unused connections.</p>\n\n<p>Any idea how of could I improve this or even better, how could I replace totally the map, I don't know if <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow\">channels</a> could be help full?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["time", "go"], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1458554655, "post_id": 36127407, "comment_id": 59894961, "body": "Thanks, guys!  Ah, I see - unfortunately I need to use the format <code>GET &#47;values?from=2015-02-11T15:01:00+00:00</code> in my http request though!   Would it be advisable to read in the <b>unencoded</b> value from the query string and try and parse it?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1458555180, "post_id": 36127407, "comment_id": 59895293, "body": "@Se&#225;n See my edited answer. One way is to deal with <code>+</code> and <code>-</code> time zones as they decode differently. Another way is to extract parameter value yourself using <code>URL.RawQuery</code>."}, {"owner": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1458559160, "post_id": 36127407, "comment_id": 59898008, "body": "Thanks @icza - I went for the latter option, which gave me something like:  <code>var Url *url.URL</code> <code>URL, _ := url.Parse(request.URL.string())</code> <code>fromString := Url.RawQuery[5:30]</code> <code>layout := &quot;2006-01-02T15:04:05Z07:00&quot;</code> <code>fromTime := time.Parse(layout, fromString)</code>  Ugly I know but I can&#39;t (for the minute) conceive of a way of making it more elegant (knowing that I have to handle the &#39;+&#39; sign in the query).  Thanks for your help!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1458560618, "post_id": 36127407, "comment_id": 59898843, "body": "@Se&#225;n There is absolutely no need to create a new <code>URL</code>, you can just use <code>request.URL</code>. See edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1476358588, "last_edit_date": 1476358588, "creation_date": 1458553049, "answer_id": 36127407, "question_id": 36127217, "link": "https://stackoverflow.com/questions/36127217/parsing-date-in-go/36127407#36127407", "title": "Parsing Date in Go", "body": "<p>You should check returned errors. <code>time.Parse()</code> returns an error:</p>\n\n<pre><code>formattedTime, err := time.Parse(layout, dateTime)\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Your error will lie in the <code>'+'</code> character in the URL query. The URL query uses <a href=\"http://www.w3schools.com/tags/ref_urlencode.asp\" rel=\"nofollow\">URL encoding</a> where the <code>+</code> sign is special: it is used to encode the space character. So when you do this:</p>\n\n<pre><code>dateTime := request.URL.Query.Get(\"from\")\n</code></pre>\n\n<p>Your <code>dateTime</code> will contain the decoded value where <code>+</code> will be replaced by a space. Check it like:</p>\n\n<pre><code>fmt.Printf(\"%q\\n\", dateTime)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"2015-02-11T15:01:00 00:00\"\n</code></pre>\n\n<p>And of course this is not a valid format for the layout you specified, which will give you the following error:</p>\n\n<blockquote>\n  <p>parsing time \"2015-02-11T15:01:00 00:00\" as \"2006-01-02T15:04:05Z07:00\": cannot parse \"\" as \"Z07:00\"</p>\n</blockquote>\n\n<p>You have to use <code>%2B</code> in the URL query which is the code for the <code>+</code> sign, and you also have to include the <code>Z</code> char which you used in your layout:</p>\n\n<pre><code>GET /values?from=2015-02-11T15:01:00Z%2B00:00\n</code></pre>\n\n<p>And also note that the layout has to contain the <code>-07:00</code> reference time zone and not <code>07:00</code>:</p>\n\n<pre><code>layout := \"2006-01-02T15:04:05Z-07:00\"\n</code></pre>\n\n<p>Then the output (<code>formattedTime</code>):</p>\n\n<pre><code>2015-02-11 15:01:00 +0000 UTC\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/8Ska4MDtNO\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<h3>If you must use <code>+</code> in the query...</h3>\n\n<p>If you must use the <code>+</code> query (as you claim in the comment), then working with the unescaped value would be tricky, as if time zone in query is <code>+</code>, it is replaced with space, but if the time zone is <code>-</code>, it is not!</p>\n\n<p>One way is to work with the Raw query and not the decoded one. This is available in <code>URL.RawQuery</code>.</p>\n\n<p>Here's a solution which assumes there is only 1 request parameter: <code>\"from=\"</code>. It fails if there are other, please take that into account:</p>\n\n<pre><code>param := \"from=\"\nlayout := \"2006-01-02T15:04:05-07:00\"\nlength := len(param) + len(layout)\n\nif s := request.URL.RawQuery; len(s) &lt; length || !strings.HasPrefix(s, param) {\n     // unexpected query\n}\ndateTime := request.URL.RawQuery[len(param):length]\nformattedTime, err := time.Parse(layout, dateTime)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": -1, "last_activity_date": 1458553217, "creation_date": 1458553217, "answer_id": 36127471, "question_id": 36127217, "link": "https://stackoverflow.com/questions/36127217/parsing-date-in-go/36127471#36127471", "title": "Parsing Date in Go", "body": "<p>You need to use a minus before the time zone offset, so the layout should be: \"2006-01-02T15:04:05-07:00\"</p>\n\n<p><a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow\">https://golang.org/pkg/time/#pkg-constants</a>:</p>\n\n<pre><code>Numeric time zone offsets format as follows:\n\n-0700  \u00b1hhmm\n-07:00 \u00b1hh:mm\n-07    \u00b1hh\n</code></pre>\n\n<p>example: <a href=\"http://play.golang.org/p/ZG979Meuxz\" rel=\"nofollow\">http://play.golang.org/p/ZG979Meuxz</a></p>\n\n<p>When you print it out, it uses the default format, not the one you used to parse it, because it calls the String method: <a href=\"https://golang.org/pkg/time/#Time.String\" rel=\"nofollow\">https://golang.org/pkg/time/#Time.String</a></p>\n\n<p>To format it using a custom format, use Format: <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"nofollow\">https://golang.org/pkg/time/#Time.Format</a></p>\n"}], "owner": {"reputation": 365, "user_id": 3548603, "user_type": "registered", "accept_rate": 8, "profile_image": "https://i.stack.imgur.com/0TUAQ.jpg?s=128&g=1", "display_name": "Se&#225;n", "link": "https://stackoverflow.com/users/3548603/se%c3%a1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4746, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1476358588, "creation_date": 1458552532, "question_id": 36127217, "link": "https://stackoverflow.com/questions/36127217/parsing-date-in-go", "title": "Parsing Date in Go", "body": "<p>I am writing a service in Go that takes a timetstamp passed in as a HTTP request parameter and parses it.</p>\n\n<p>A sample call is <code>GET /values?from=2015-02-11T15:01:00+00:00</code></p>\n\n<p>An example of he value that is being passed into the function is <code>2015-02-11T15:01:00+00:00</code>.</p>\n\n<p>I am trying to parse it thus:</p>\n\n<pre><code>dateTime := request.URL.Query.Get(\"from\")\nlayout := \"2006-01-02T15:04:05Z07:00\"\nformattedTime, _ := time.Parse(layout, dateTime)\n</code></pre>\n\n<p>(I am using Go's layout numbers to to do this - more information here: <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow\">https://golang.org/pkg/time/#pkg-constants</a>)</p>\n\n<p>However, the output from this is <code>0001-01-01 00:00:00 +0000 UTC</code>.</p>\n\n<p>I should also point out that when I do a <code>fmt.Println(dateTime)</code>, I get <code>2015-02-11T15:01:00 00:00</code> (not <code>2015-02-11T15:01:00+00:00</code> as I might expect).</p>\n\n<p>Also, when I hardcode a datetime into the function and parse it using time.Parse(layout, dateTime), it is parsed successfully and gives the output <code>2015-02-11 15:01:00 +000 GMT</code>.</p>\n\n<p>Does anyone know what might be happening here?</p>\n\n<p>Thanks,</p>\n\n<p>Sean</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": 4, "last_activity_date": 1458551042, "creation_date": 1458551042, "answer_id": 36126700, "question_id": 36126552, "link": "https://stackoverflow.com/questions/36126552/golang-reflect-get-closure-function-pointer/36126700#36126700", "title": "golang reflect get closure function pointer", "body": "<p><a href=\"https://golang.org/pkg/reflect/#Value.Pointer\" rel=\"nofollow\">https://golang.org/pkg/reflect/#Value.Pointer</a></p>\n\n<blockquote>\n  <p>If v's Kind is Func, the returned pointer is an underlying code\n  pointer, but not necessarily enough to identify a single function\n  uniquely. The only guarantee is that the result is zero if and only if\n  v is a nil func Value.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "edited": false, "score": 0, "creation_date": 1458572194, "post_id": 36127142, "comment_id": 59907279, "body": "This question and answer were very interesting.  I found <a href=\"http://stackoverflow.com/q/9643205/1103700\">stackoverflow.com/q/9643205/1103700</a> was a similar question (not about closures though) and the answers enlightening.  The Go designers didn&#39;t seem to want function or closure comparisons - even with reflect.  So there are some work arounds the folks have come up with - just as the Go designers would have hoped I expect."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1601312729, "last_edit_date": 1601312729, "creation_date": 1458552303, "answer_id": 36127142, "question_id": 36126552, "link": "https://stackoverflow.com/questions/36126552/golang-reflect-get-closure-function-pointer/36127142#36127142", "title": "golang reflect get closure function pointer", "body": "<p>Function pointers denote the code of the function. And the code of an anonymous function created by function literal is only stored once in memory, no matter how many times the code that returns the anonymous function value runs. This means all function values (or more precisely the function pointers) will be the same.</p>\n<p>So you can't distinguish between the values stored in <code>f1</code> and <code>f2</code>: they denote the same code block to be executed when they are called.</p>\n<p>The function value that is returned by the function value stored in your <code>factory</code> variable is a closure. The environment (local variables and function parameters) referred by it survives for as long as it is accessible. In your case this means since the function values in <code>f1</code> and <code>f2</code> refer to the <code>name</code> argument of the enclosing anonymous function, they (&quot;they&quot; as from multiple calls) will be retained as long as the function values (in <code>f1</code> and <code>f2</code>) are accessible. This is the only thing that makes them &quot;different&quot; or unique, but this is invisible from the &quot;outside&quot;.</p>\n<p>Would you go ahead and print the address of <code>name</code> in the closure, you'd see they are different variables for multiple values of the closure, <strong>but</strong> it is the <em>same</em> if the <em>same</em> closure (function value) is called again. First modify the closure to also print the address of <code>name</code>:</p>\n<pre><code>factory := func(name string) func() {\n    return func() {\n        fmt.Println(name, &amp;name)\n    }\n}\n</code></pre>\n<p>And call <code>f1</code> and <code>f2</code> multiple times:</p>\n<pre><code>f1()\nf2()\nf1()\nf2()\n</code></pre>\n<p>Output:</p>\n<pre><code>f1 0x1040a120\nf2 0x1040a130\nf1 0x1040a120\nf2 0x1040a130\n</code></pre>\n<p>As you can see, the <code>name</code> argument is retained and the same <code>name</code> argument is used again if the same closure is invoked again.</p>\n"}, {"tags": [], "owner": {"reputation": 598, "user_id": 9552116, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Coconut", "link": "https://stackoverflow.com/users/9552116/coconut"}, "is_accepted": false, "score": 1, "last_activity_date": 1540741819, "last_edit_date": 1540741819, "creation_date": 1540741298, "answer_id": 53033248, "question_id": 36126552, "link": "https://stackoverflow.com/questions/36126552/golang-reflect-get-closure-function-pointer/53033248#53033248", "title": "golang reflect get closure function pointer", "body": "<p>Actually, <code>*func()</code> type in Golang is equivalent to <code>void (*)(void)</code> type in C. (I know this because I use cgo often.)</p>\n\n<p>And a <code>func()</code> in Go is defined as a literal, meaning that it's something like a blob of bytes that represent machine code, rather than a function pointer.</p>\n\n<p>Note that everything is passed by <strong>value</strong> in Golang, and even a function in Go is not an exception.</p>\n\n<pre><code>var f1 func() = ...\nreflect.ValueOf(f1)\n</code></pre>\n\n<p>When you do that, I think you're trying to get the first 8 bytes of a code block called <code>f1</code>, and that is not an address to that function.</p>\n\n<p>In Go, you cannot, never, get an address of a <code>func()</code>.</p>\n\n<p>Because a <code>func()</code> is a <strong>literal</strong> and literals do not have address. A literal is located nowhere in memory. So you can't get an address to that.</p>\n"}], "owner": {"reputation": 43, "user_id": 6092458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a289ad364a7c3474e9f9caf7d3751d7?s=128&d=identicon&r=PG&f=1", "display_name": "dr.xsty", "link": "https://stackoverflow.com/users/6092458/dr-xsty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1721, "favorite_count": 1, "accepted_answer_id": 36127142, "answer_count": 3, "score": 4, "last_activity_date": 1601312729, "creation_date": 1458550557, "question_id": 36126552, "link": "https://stackoverflow.com/questions/36126552/golang-reflect-get-closure-function-pointer", "title": "golang reflect get closure function pointer", "body": "<p>please review code</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"reflect\"\n)\nfunc main() {\n\n    factory := func  (name string) func(){\n        return func (){\n            fmt.Println(name)\n        }\n    }\n    f1 := factory(\"f1\")\n    f2 := factory(\"f2\")\n\n    pf1 := reflect.ValueOf(f1)\n    pf2 := reflect.ValueOf(f2)\n\n    fmt.Println(pf1.Pointer(), pf2.Pointer())\n    fmt.Println(pf1.Pointer() == pf2.Pointer())\n\n    f1()\n    f2()\n}\n</code></pre>\n\n<p>the result:</p>\n\n<pre><code>4199328 4199328\ntrue\nf1\nf2\n</code></pre>\n\n<p>Why get to the same address of the closure function! \nOr to how to get a unique address\uff01</p>\n"}, {"tags": ["performance", "memory", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1458548670, "post_id": 36125927, "comment_id": 59891501, "body": "To add even more variation, trying your code on a Windows 7 (Go 1.6, 64 bit), I get 17 seconds no matter if <code>alloc</code> is <code>65536</code> or <code>65535</code>."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1458550101, "post_id": 36125927, "comment_id": 59892155, "body": "I&#39;m not an expert on allocation internals, but I just want to mention that allocating a slice of 65536 bytes is actually allocating that plus 2 integers (the <code>len</code> and <code>cap</code> counters), so actually more than 64KB."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 2, "creation_date": 1458550293, "post_id": 36125927, "comment_id": 59892249, "body": "To add more informations to the problem, I ran the code on my Archlinux (i7-4720HQ @ 2.60GHz), and it takes consistently ~600ms. You should try to use the profiling tool on the setup that takes a long time. It&#39;s actually a good case to start learning it if you don&#39;t know it already."}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1458550856, "post_id": 36125927, "comment_id": 59892551, "body": "You can try disabling the garbage collector (GOGC=off) to see if it is the issue. With 16 GB of RAM you should have plenty of memory for that."}, {"owner": {"reputation": 131, "user_id": 6092351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6b94a45742eab7d716a0184a3e2579?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6092351/j-dow"}, "edited": false, "score": 2, "creation_date": 1458552040, "post_id": 36125927, "comment_id": 59893230, "body": "yeah. set GOGC=off really improved performance. So I think I now understand what&#39;s going on. because of escape analysis golang allocates memory on the heap and then the gc needs to clean it. when I allocate less than 64K, go uses the stack. when the array is on the stack it&#39;ll clean iteself and also the allocation will take only one CPU instruction (just create a pointer to somewhere on the stack)."}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1458580957, "post_id": 36125927, "comment_id": 59913742, "body": "@J.Dow in case that is the solution to your answer, consider answering your own question and mark the answer as accepted. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 6092351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6b94a45742eab7d716a0184a3e2579?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6092351/j-dow"}, "is_accepted": false, "score": 6, "last_activity_date": 1458635079, "creation_date": 1458635079, "answer_id": 36149371, "question_id": 36125927, "link": "https://stackoverflow.com/questions/36125927/golang-slice-allocation-performance/36149371#36149371", "title": "golang slice allocation performance", "body": "<p>Setting GOGC=off improved performance (down to less than 100ms). Why?\nbecaue of <a href=\"https://github.com/golang/go/wiki/CompilerOptimizations#escape-analysis-and-inlining\" rel=\"noreferrer\">escape analysis</a>. When you build with <code>go build -gcflags -m</code> the compiler prints whatever allocations escapes to heap. It really depends on your machine and GO compiler version but when the compiler decides that the allocation should move to heap it means 2 things:\n1. the allocation will take longer (since \"allocating\" on the stack is just 1 cpu instruction)\n2. the GC will have to clean up that memory later - costing more CPU time\nfor my machine, the allocation of 65536 bytes escapes to heap and 65535 doesn't.\nthat's why 1 bytes changed the whole proccess from 200ms to 30s. Amazing..</p>\n"}, {"tags": [], "owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "is_accepted": false, "score": 0, "last_activity_date": 1574690697, "creation_date": 1574690697, "answer_id": 59033671, "question_id": 36125927, "link": "https://stackoverflow.com/questions/36125927/golang-slice-allocation-performance/59033671#59033671", "title": "golang slice allocation performance", "body": "<p>the reason is very simple. </p>\n\n<p>const alloc int = 65535</p>\n\n<p><code>0x0000 00000 (example.go:8)     TEXT    \"\".main(SB), ABIInternal, $65784-0</code></p>\n\n<p>const alloc int = 65536</p>\n\n<p><code>0x0000 00000 (example.go:8)     TEXT    \"\".main(SB), ABIInternal, $248-0</code></p>\n\n<p>the difference is where the slice are created. </p>\n"}], "owner": {"reputation": 131, "user_id": 6092351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6b94a45742eab7d716a0184a3e2579?s=128&d=identicon&r=PG&f=1", "display_name": "J. Dow", "link": "https://stackoverflow.com/users/6092351/j-dow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1924, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1574690697, "creation_date": 1458548181, "last_edit_date": 1458634785, "question_id": 36125927, "link": "https://stackoverflow.com/questions/36125927/golang-slice-allocation-performance", "title": "golang slice allocation performance", "body": "<p>I stumbled upon an interesting thing while checking performance of memory allocation in GO.</p>\n\n<pre><code>package main\n\nimport (\n      \"fmt\"\n      \"time\"\n    )\n\nfunc main(){\n   const alloc int = 65536\n   now := time.Now()\n   loop := 50000\n   for i := 0; i&lt;loop;i++{\n      sl := make([]byte, alloc)\n      i += len(sl) * 0\n   }\n   elpased := time.Since(now)\n   fmt.Printf(\"took %s to allocate %d bytes %d times\", elpased, alloc, loop) \n}\n</code></pre>\n\n<p>I am running this on a Core-i7 2600 with go version 1.6 64bit (also same results on 32bit) and 16GB of RAM (on WINDOWS 10)\nso when alloc is 65536 (exactly 64K) it runs for 30 seconds (!!!!).\nWhen  alloc is 65535 it takes ~200ms.\nCan someone explain this to me please? \nI tried the same code at home with my core i7-920 @ 3.8GHZ but it didn't show same results (both took around 200ms). Anyone has an idea what's going on?</p>\n"}, {"tags": ["go", "bleve"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1546395344, "post_id": 36125244, "comment_id": 94838016, "body": "<a href=\"https://godoc.org/github.com/blevesearch/bleve#MultiSearch\" rel=\"nofollow noreferrer\">godoc.org/github.com/blevesearch/bleve#MultiSearch</a> ?"}], "owner": {"reputation": 31, "user_id": 6092209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22186a90422548824a08a33f0c57009?s=128&d=identicon&r=PG&f=1", "display_name": "DNadar", "link": "https://stackoverflow.com/users/6092209/dnadar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1505484238, "creation_date": 1458545194, "last_edit_date": 1505484238, "question_id": 36125244, "link": "https://stackoverflow.com/questions/36125244/blevesearch-how-to-implement-global-search", "title": "BleveSearch - How to implement global search", "body": "<p>I have been using Bleve Search (Go Based search) for my application and I love the way it works, but I am stuck as how to implement global search using bleve.</p>\n\n<p>Here is my use case:</p>\n\n<p>Create an Index depending upon the Entity:</p>\n\n<ol>\n<li>School</li>\n<li>Teachers</li>\n<li>Students</li>\n<li>HOD</li>\n</ol>\n\n<p>Bleve creates a folder and store the index file inside the folder. I am able to get the result if I search for School info in the School index folder by opening the index for school and do a search.</p>\n\n<p>My question is how to do a global search. Meaning I am not sure which entity to search and want to get results from School, teachers etc. In order to start the Search I have to open the index using the path.</p>\n\n<pre><code>// open a new index\nmapping := bleve.NewIndexMapping()\nindex, err := bleve.New(\"example.bleve\", mapping) // DNadar -  How can we specify for global search?\n</code></pre>\n\n<p><a href=\"http://www.blevesearch.com/docs/Getting%20Started/\" rel=\"nofollow\">http://www.blevesearch.com/docs/Getting%20Started/</a></p>\n"}, {"tags": ["mysql", "go", "slice", "variadic", "go-gorm"], "comments": [{"owner": {"reputation": 2036, "user_id": 2138727, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Sezmn.jpg?s=128&g=1", "display_name": "Kasnady", "link": "https://stackoverflow.com/users/2138727/kasnady"}, "edited": false, "score": 0, "creation_date": 1458544521, "post_id": 36125024, "comment_id": 59889647, "body": "did you mean that.. you want to insert two data using one query?"}, {"owner": {"reputation": 75, "user_id": 2486312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06c41a55a9d382025faa2b011daa240f?s=128&d=identicon&r=PG", "display_name": "user2486312", "link": "https://stackoverflow.com/users/2486312/user2486312"}, "reply_to_user": {"reputation": 2036, "user_id": 2138727, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Sezmn.jpg?s=128&g=1", "display_name": "Kasnady", "link": "https://stackoverflow.com/users/2138727/kasnady"}, "edited": false, "score": 0, "creation_date": 1458544642, "post_id": 36125024, "comment_id": 59889714, "body": "yes i want insert multiple data at once my reference is <a href=\"http://stackoverflow.com/a/21112176/2486312\">stackoverflow.com/a/21112176/2486312</a>"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2486312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06c41a55a9d382025faa2b011daa240f?s=128&d=identicon&r=PG", "display_name": "user2486312", "link": "https://stackoverflow.com/users/2486312/user2486312"}, "edited": false, "score": 0, "creation_date": 1458544901, "post_id": 36125119, "comment_id": 59889830, "body": "Thanks it work is my fault i think ... only sample :|"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1458544917, "last_edit_date": 1458544917, "creation_date": 1458544744, "answer_id": 36125119, "question_id": 36125024, "link": "https://stackoverflow.com/questions/36125024/golang-join-array-interface/36125119#36125119", "title": "Golang Join array interface", "body": "<p>If you want to pass elements of a slice to a function with variadic parameter, you have to use <code>...</code> to tell the compiler you want to pass all elements individually and not pass the slice value as a single argument, so simply do:</p>\n\n<pre><code>tx.Exec(sqlStr, vals...)\n</code></pre>\n\n<p>This is detailed in the spec: <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"noreferrer\">Passing arguments to ... parameters</a>.</p>\n\n<p><a href=\"https://golang.org/pkg/database/sql/#Tx.Exec\" rel=\"noreferrer\"><code>Tx.Exec()</code></a> has the signature of:</p>\n\n<pre><code>func (tx *Tx) Exec(query string, args ...interface{}) (Result, error)\n</code></pre>\n\n<p>So you have to pass <code>vals...</code>. Also don't forget to check returned error, e.g.:</p>\n\n<pre><code>res, err := tx.Exec(sqlStr, vals...)\nif err != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2486312, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/06c41a55a9d382025faa2b011daa240f?s=128&d=identicon&r=PG", "display_name": "user2486312", "link": "https://stackoverflow.com/users/2486312/user2486312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 0, "accepted_answer_id": 36125119, "answer_count": 1, "score": 7, "last_activity_date": 1527756479, "creation_date": 1458544336, "last_edit_date": 1592644375, "question_id": 36125024, "link": "https://stackoverflow.com/questions/36125024/golang-join-array-interface", "title": "Golang Join array interface", "body": "<p>I try to create bulk insert. I use gorm <a href=\"http://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">github.com/jinzhu/gorm</a></p>\n<pre><code>import (\n    &quot;fmt&quot;\n    dB &quot;github.com/edwinlab/api/repositories&quot;\n)\n\nfunc Update() error {\n    tx := dB.GetWriteDB().Begin()\n    sqlStr := &quot;INSERT INTO city(code, name) VALUES (?, ?),(?, ?)&quot;\n    vals := []interface{}{}\n\n    vals = append(vals, &quot;XX1&quot;, &quot;Jakarta&quot;)\n    vals = append(vals, &quot;XX2&quot;, &quot;Bandung&quot;)\n\n    tx.Exec(sqlStr, vals)\n\n    tx.Commit()\n\n    return nil\n}\n</code></pre>\n<p>But I got an error:</p>\n<blockquote>\n<p>Error 1136: Column count doesn't match value count at row 1 becuse i return wrong query</p>\n<pre><code>INSERT INTO city(code, name) VALUES ('XX1','Jakarta','XX2','Bandung', %!v(MISSING)),(%!v(MISSING), %!v(MISSING))\n</code></pre>\n</blockquote>\n<p>If I use manual query it works:</p>\n<pre><code>tx.Exec(sqlStr, &quot;XX1&quot;, &quot;Jakarta&quot;, &quot;XX2&quot;, &quot;Bandung&quot;)\n</code></pre>\n<p>It will generate:</p>\n<pre><code>INSERT INTO city(code, name) VALUES ('XX1', 'Jakarta'),('XX2', 'Bandung')\n</code></pre>\n<p>The problem is how to make array interface to generate string like <code>&quot;XX1&quot;, &quot;Jakarta&quot;, ...</code></p>\n<p>Thanks for help.</p>\n"}, {"tags": ["go", "cmd", "operating-system", "exec", "system-information"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 1, "last_activity_date": 1458543954, "creation_date": 1458543954, "answer_id": 36124951, "question_id": 36124855, "link": "https://stackoverflow.com/questions/36124855/error-in-executing-a-command-in-golang/36124951#36124951", "title": "Error in executing a command in golang", "body": "<p>Your command is <strong>not</strong> right. Your command is shell code and cannot be executed except by a shell (here cmd.exe). If you really want to get the OS name like this: Execute cmd.exe with your command as an argument. You might consider executing systeminfo.exe and parsing the output in Go (instead of the shell).</p>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 36124951, "answer_count": 1, "score": -2, "last_activity_date": 1458543954, "creation_date": 1458543554, "question_id": 36124855, "link": "https://stackoverflow.com/questions/36124855/error-in-executing-a-command-in-golang", "title": "Error in executing a command in golang", "body": "<p>I tried to get the OS name in Golang The below is my code.</p>\n\n<pre><code>// GetOsName.go\npackage main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    fmt.Println(\"systeminfo\",\"|\",\"findstr\",\"/B\",\"/C:\\\"OS Name\\\"\")\n    Out,err:=exec.Command(\"systeminfo\",\"|\",\"findstr\",\"/B\",\"/C:\\\"OS Name\\\"\").Output()\n    if err!=nil{\n        fmt.Println(\"Err:\",err)\n    }else{\n        fmt.Println(\"Out:\",string(Out))\n    }\n}\n</code></pre>\n\n<p>But when i execute the code i get this message</p>\n\n<pre><code>systeminfo | findstr /B /C:\"OS Name\"\nErr: exit status 1\n</code></pre>\n\n<p>The command is right. When i try to execute the command in separate it works fine.\nHelp me to solve this Thanks in Advance.</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1458542308, "post_id": 36124445, "comment_id": 59888670, "body": "I don&#39;t have Person2, I need to generate it first using Person. It is mostly same as Person except for few fields which need to be transformed."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1458542449, "post_id": 36124445, "comment_id": 59888740, "body": "@user568109 If you don&#39;t have <code>person2</code> (yet) but you do have <code>person</code>, then you have to first write <code>person2</code>. Go is statically typed. You can&#39;t just create new types during runtime."}, {"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1458543395, "post_id": 36124445, "comment_id": 59889116, "body": "The struct I use is big so I will have to use the generate tool. Any pointers on how to use that."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1458545038, "post_id": 36124445, "comment_id": 59889890, "body": "@user568109 If you just have to do it once, no matter how big the struct is, you&#39;re better off doing it manually. <code>go generate</code> comes handy when you have to do such task repeatedly and for many different inputs."}, {"owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "edited": false, "score": 0, "creation_date": 1458546694, "post_id": 36124445, "comment_id": 59890573, "body": "For now I will try that. generate is long term solution because I don&#39;t control the original struct itself and it is difficult to get it working."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1483877795, "last_edit_date": 1483877795, "creation_date": 1458541510, "answer_id": 36124445, "question_id": 36124108, "link": "https://stackoverflow.com/questions/36124108/how-to-modify-object-and-struct-from-an-existing-struct/36124445#36124445", "title": "How to modify object and struct from an existing struct?", "body": "<p><strong>Foreword:</strong> if you only have the type <code>person</code> and not <code>person2</code>, you have to first write <code>person2</code>. Go is statically typed language, you can't just create <code>person2</code> at runtime. You may write <code>person2</code> manually or use <code>go generate</code> by writing the generator code yourself, but it won't be any simpler.</p>\n\n<p>You could also use something like <code>map[string]interface{}</code> to <em>mimic</em> a dynamic struct, but that won't be any friendlier nor faster. Not to mention you'd have to use type assertions as value type is <code>interface{}</code>...</p>\n\n<hr>\n\n<p>To create a value of <code>person2</code> from a value of <code>person</code>, you don't need reflection, you can simply manually code it:</p>\n\n<pre><code>func transform(p person) person2 {\n    return person2{\n        p.name,\n        []struct{ value string }{{p.phone}},\n        []struct{ value string }{{p.address}},\n    }\n}\n</code></pre>\n\n<p>Note that this may look a little weird, and that's because you used a slice of anonymous struct for <code>person2.phone</code> and <code>person2.address</code>, and to initialize an anonymous struct with a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a>, the anonymous struct definition has to be repeated.</p>\n\n<p>Testing it:</p>\n\n<pre><code>p := person{\"Bob\", \"1234\", \"New York\"}\nfmt.Println(p)\np2 := transform(p)\nfmt.Println(p2)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/zg2Izw5Fy1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Bob 1234 New York}\n{Bob [{1234}] [{New York}]}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Note that your <code>person2</code> is unnecessarily complex. It could be as simple as this:</p>\n\n<pre><code>type person2 struct {\n    name      string\n    phones    []string\n    addresses []string\n}\n</code></pre>\n\n<p>And then the transformation is a one-liner:</p>\n\n<pre><code>func transform(p person) person2 {\n    return person2{p.name, []string{p.phone}, []string{p.address}}\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/Q3Or7RAjNH\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Bob 1234 New York}\n{Bob [1234] [New York]}\n</code></pre>\n"}], "owner": {"reputation": 43489, "user_id": 568109, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/2hthl.gif?s=128&g=1", "display_name": "user568109", "link": "https://stackoverflow.com/users/568109/user568109"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 36124445, "answer_count": 1, "score": 1, "last_activity_date": 1483877795, "creation_date": 1458540042, "last_edit_date": 1458542449, "question_id": 36124108, "link": "https://stackoverflow.com/questions/36124108/how-to-modify-object-and-struct-from-an-existing-struct", "title": "How to modify object and struct from an existing struct?", "body": "<p>I have a struct say</p>\n\n<pre><code>type person struct{\n    name string\n    phone string\n    address string\n}\n</code></pre>\n\n<p>and I want to transform it to this (modify phone and address) <em>I only have the object not the struct.</em></p>\n\n<pre><code>type person2 struct {\n    name  string\n    phone []struct {\n        value string\n    }\n\n    address []struct {\n        value string\n    }\n}\n</code></pre>\n\n<p>How can I create new struct based on one I have ? I want to transform selected fields only.</p>\n\n<p>I looked into reflection but don't know where to start/how to use it.</p>\n"}, {"tags": ["go", "restful-authentication", "go-gin"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458567088, "post_id": 36122999, "comment_id": 59903449, "body": "What doesn&#39;t work? Do you get a 401? Are you sure the tokens match exactly (including newlines)?"}, {"owner": {"reputation": 31, "user_id": 6022227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BkKgi11r8Oc/AAAAAAAAAAI/AAAAAAAAAAs/Udr5NJ7Q7Q4/photo.jpg?sz=128", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/6022227/nuwan-indika"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458706296, "post_id": 36122999, "comment_id": 59976283, "body": "I able to make this run but can i know how to send toke to using curl I&#39;m using <code>router.Use(TokenAuthMiddleware())</code>  and I&#39;m getting <code>{&quot;error&quot;:&quot;API token required&quot;}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 5907262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72f7bbf9ea306da3e322d886f8f7ed19?s=128&d=identicon&r=PG&f=1", "display_name": "Xeph", "link": "https://stackoverflow.com/users/5907262/xeph"}, "is_accepted": false, "score": 9, "last_activity_date": 1459521320, "creation_date": 1459521320, "answer_id": 36359058, "question_id": 36122999, "link": "https://stackoverflow.com/questions/36122999/how-to-create-a-authentication-model-to-restful-api-using-golang-gin/36359058#36359058", "title": "How to create a authentication model to restful API using golang gin?", "body": "<p>I made my own middleware to check token like below:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gin-gonic/gin\"\n)\n\n//JWTAuthMiddleware middleware\nfunc JWTAuthMiddleware() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        validateToken(c)\n        c.Next()\n    }\n}\n\nfunc validateToken(c *gin.Context) {\n    token := c.Request.Header.Get(\"X-Auth-Token\")\n\n    if token == \"\" {\n        c.AbortWithStatus(401)\n    } else if checkToken(token) {\n        c.Next()\n    } else {\n        c.AbortWithStatus(401)\n    }\n}\n</code></pre>\n\n<p>In the example, I'm using Header instead of FormValue.</p>\n\n<p>Try out Chrome DHC extension to test: <a href=\"https://chrome.google.com/webstore/detail/dhc-rest-client/aejoelaoggembcahagimdiliamlcdmfm\" rel=\"noreferrer\">https://chrome.google.com/webstore/detail/dhc-rest-client/aejoelaoggembcahagimdiliamlcdmfm</a></p>\n"}], "owner": {"reputation": 31, "user_id": 6022227, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-BkKgi11r8Oc/AAAAAAAAAAI/AAAAAAAAAAs/Udr5NJ7Q7Q4/photo.jpg?sz=128", "display_name": "Nuwan Indika", "link": "https://stackoverflow.com/users/6022227/nuwan-indika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8246, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1481275800, "creation_date": 1458533425, "last_edit_date": 1481275800, "question_id": 36122999, "link": "https://stackoverflow.com/questions/36122999/how-to-create-a-authentication-model-to-restful-api-using-golang-gin", "title": "How to create a authentication model to restful API using golang gin?", "body": "<p>I hope to create a authentication model to my restful API. Hope to use API token and I'm using MVC in web service and I created a auth.go controller like this.</p>\n\n<pre><code>package controllers\n\nimport (\n\n    \"github.com/gin-gonic/gin\"\n    \"os\"\n    //\"github.com/jinzhu/gorm\"\n\n)\n\ntype AdsControllerAuth struct {\n\n}\n\n\nfunc (ac *AdsControllerAuth)TokenAuthMiddleware gin.HandlerFunc {\n  return func(c *gin.Context) {\n    token := c.Request.FormValue(\"api_token\")\n\n    if token == \"\" {\n      respondWithError(401, \"API token required\", c)\n      return \n    }\n\n    if token != os.Getenv(\"API_TOKEN\") {\n      respondWithError(401, \"Invalid API token\", c)\n      return\n    }\n\n    c.Next()\n  }\n}\n\nfunc respondWithError(code int,message string,c *gin.Context) {\n  resp := map[string]string{\"error\": message}\n\n  c.JSON(code, resp)\n  //c.Abort(code)\n}\n</code></pre>\n\n<p>It doesn't working for now can some one help do this or is there are any examples to refer?  </p>\n"}, {"tags": ["sorting", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1458543208, "post_id": 36122668, "comment_id": 59889037, "body": "Did you have a look at the example given in the official documentation to package sort? <a href=\"https://golang.org/pkg/sort/#example__sortMultiKeys\" rel=\"nofollow noreferrer\">golang.org/pkg/sort/#example__sortMultiKeys</a>"}, {"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1489826340, "post_id": 36122668, "comment_id": 72849481, "body": "Since Go 1.8, @abourget&#39;s answer is better (because shorter) than the currently accepted one."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 5377850, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jv1yt.jpg?s=128&g=1", "display_name": "Devyzr", "link": "https://stackoverflow.com/users/5377850/devyzr"}, "edited": false, "score": 0, "creation_date": 1575669300, "post_id": 36122804, "comment_id": 104656967, "body": "Why do you compare LastName twice but FirstName only once? Should I follow the same procedure of comparing twice if I&#39;m sorting 3, 4 or more fields?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1575671154, "post_id": 36122804, "comment_id": 104657534, "body": "The logic for all but the last field is: return true if less, return false if greater, otherwise compare the next field.  The last field only requires the less comparison."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 71, "last_activity_date": 1528298139, "last_edit_date": 1528298139, "creation_date": 1458531848, "answer_id": 36122804, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/36122804#36122804", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Use the <a href=\"https://godoc.org/sort#Slice\" rel=\"noreferrer\">sort.Slice</a> (available since Go 1.8) or the <a href=\"https://godoc.org/sort#Sort\" rel=\"noreferrer\">sort.Sort</a> function to sort a slice of values.</p>\n\n<p>With both functions, the application provides a function that tests if one slice element is less than another slice element.  To sort by last name and then first name, compare last name and then first name:</p>\n\n<pre><code>if members[i].LastName &lt; members[j].LastName {\n    return true\n}\nif members[i].LastName &gt; members[j].LastName {\n    return false\n}\nreturn members[i].FirstName &lt; members[j].FirstName\n</code></pre>\n\n<p>The less function is specified using an anonymous function with sort.Slice:</p>\n\n<pre><code>var members []Member\nsort.Slice(members, func(i, j int) bool {\n    if members[i].LastName &lt; members[j].LastName {\n        return true\n    }\n    if members[i].LastName &gt; members[j].LastName {\n        return false\n    }\n    return members[i].FirstName &lt; members[j].FirstName\n})\n</code></pre>\n\n<p>The less function is specified with through an <a href=\"https://godoc.org/sort#Interface\" rel=\"noreferrer\">interface</a> with the sort.Sort function:</p>\n\n<pre><code>type byLastFirst []Member\n\nfunc (members byLastFirst) Len() int           { return len(members) }\nfunc (members byLastFirst) Swap(i, j int)      { members[i], members[j] = members[j], members[i] }\nfunc (members byLastFirst) Less(i, j int) bool { \n    if members[i].LastName &lt; members[j].LastName {\n       return true\n    }\n    if members[i].LastName &gt; members[j].LastName {\n       return false\n    }\n    return members[i].FirstName &lt; members[j].FirstName\n}\n\nsort.Sort(byLastFirst(members))\n</code></pre>\n\n<p>Unless performance analysis shows that sorting is a hot spot, use the function that's most convenient for your application.</p>\n"}, {"comments": [{"owner": {"reputation": 1887, "user_id": 1597656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/22f0d3352b38fd97b8d86992c5dde179?s=128&d=identicon&r=PG", "display_name": "Yerken", "link": "https://stackoverflow.com/users/1597656/yerken"}, "edited": false, "score": 5, "creation_date": 1491660655, "post_id": 42382736, "comment_id": 73656990, "body": "you should mention that this is only available since Go 1.8"}, {"owner": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 5, "creation_date": 1510715636, "post_id": 42382736, "comment_id": 81548895, "body": "Don&#39;t use strings.Compare. The documentation at <a href=\"https://golang.org/pkg/strings/#Compare\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#Compare</a> says &quot;Compare is included only for symmetry with package bytes. It is usually clearer and always faster to use the built-in string comparison operators ==, &lt;, &gt;, and so on.&quot;"}, {"owner": {"reputation": 2088, "user_id": 3309046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5ce388de97238b3147f3d4ba62b17cb?s=128&d=identicon&r=PG", "display_name": "nishanthshanmugham", "link": "https://stackoverflow.com/users/3309046/nishanthshanmugham"}, "edited": false, "score": 3, "creation_date": 1510716011, "post_id": 42382736, "comment_id": 81548981, "body": "And if it&#39;s possible that both last name and first name can be the same for two members and you want to preserve the original order of the slice, you should use <code>sort.Stable</code> or <code>sort.SliceStable</code>."}, {"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 0, "creation_date": 1573651154, "post_id": 42382736, "comment_id": 103950346, "body": "strings.Compare makes remember in Java can&#39;t compare a simple string with &quot;==&quot;"}, {"owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1588886260, "post_id": 42382736, "comment_id": 109081765, "body": "Here&#39;s the source of <a href=\"https://github.com/golang/go/blob/master/src/strings/compare.go#L13\" rel=\"nofollow noreferrer\"><code>strings.Compare</code></a>. It is no different than doing <code>==</code> and <code>&lt;</code>, which are both required in multi-valued comparisons."}], "tags": [], "owner": {"reputation": 2063, "user_id": 1221715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab711d9513839a2eff8b7c557bfc0343?s=128&d=identicon&r=PG", "display_name": "abourget", "link": "https://stackoverflow.com/users/1221715/abourget"}, "is_accepted": true, "score": 23, "last_activity_date": 1487737734, "creation_date": 1487737734, "answer_id": 42382736, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/42382736#42382736", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Use the newer <code>sort.Slice</code> function as such:</p>\n\n<pre><code>sort.Slice(members, func(i, j int) bool {\n    switch strings.Compare(members[i].FirstName, members[j].FirstName) {\n    case -1:\n        return true\n    case 1:\n        return false\n    }\n    return members[i].LastName &gt; members[j].LastName\n})\n</code></pre>\n\n<p>or something like that.</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 5875759, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10208237665480199/picture?type=large", "display_name": "Douglas Adolph", "link": "https://stackoverflow.com/users/5875759/douglas-adolph"}, "is_accepted": false, "score": 1, "last_activity_date": 1533528147, "creation_date": 1533528147, "answer_id": 51700408, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/51700408#51700408", "title": "How to sort struct with multiple sort parameters?", "body": "<p>This has been very helpful. I needed to sort a slice of structs, and found my answer here. I actually extended it to triply-sorting. Although sorting this much is not optimal for runtime purposes, it's useful in some circumstances, especially when the alternative leads to code that is hard to maintain or modify and where faster runtimes are not crucial. </p>\n\n<pre><code>sort.Slice(servers, func(i, j int) bool {\n        if servers[i].code &lt; servers[j].code {\n            return true\n        } else if servers[i].code &gt; servers[j].code {\n            return false\n        } else {\n            if servers[i].group &lt; servers[j].group {\n                return true\n            } else {\n                if servers[i].group &gt; servers[j].group {\n                    return false\n                }\n            }\n        }\n        return servers[i].IDGroup &lt; servers[j]. IDGroup\n    })\n</code></pre>\n\n<p>This code sorts first by code, then by group, then by IDGroup.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4228489"}, "edited": false, "score": 1, "creation_date": 1556182289, "post_id": 52134016, "comment_id": 98352906, "body": "I like this pattern for readability too. It&#39;s even better as the number of fields that need to be compared increases. Still two comparisons for all but the last field though."}], "tags": [], "owner": {"reputation": 1252, "user_id": 453290, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b527b0cd314cb598712a01d1386af689?s=128&d=identicon&r=PG", "display_name": "LVB", "link": "https://stackoverflow.com/users/453290/lvb"}, "is_accepted": false, "score": 17, "last_activity_date": 1535863228, "creation_date": 1535863228, "answer_id": 52134016, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/52134016#52134016", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Another pattern, which I find slightly cleaner:</p>\n\n<pre><code>if members[i].LastName != members[j].LastName {\n    return members[i].LastName &lt; members[j].LastName\n}\n\nreturn members[i].FirstName &lt; members[j].FirstName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 5, "last_activity_date": 1539899988, "creation_date": 1539899988, "answer_id": 52883200, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/52883200#52883200", "title": "How to sort struct with multiple sort parameters?", "body": "<p>The shortest and still comprehensible code I managed to write for this is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\ntype Member struct {\n    Id        int\n    LastName  string\n    FirstName string\n}\n\nfunc sortByLastNameAndFirstName(members []Member) {\n    sort.SliceStable(members, func(i, j int) bool {\n        mi, mj := members[i], members[j]\n        switch {\n        case mi.LastName != mj.LastName:\n            return mi.LastName &lt; mj.LastName\n        default:\n            return mi.FirstName &lt; mj.FirstName\n        }\n    })\n}\n</code></pre>\n\n<p>The pattern using the <code>switch</code> statement easily extends to more than two sorting criteria and is still short enough to be read.</p>\n\n<p>Here's the rest of the program:</p>\n\n<pre><code>func main() {\n    members := []Member{\n        {0, \"The\", \"quick\"},\n        {1, \"brown\", \"fox\"},\n        {2, \"jumps\", \"over\"},\n        {3, \"brown\", \"grass\"},\n        {4, \"brown\", \"grass\"},\n        {5, \"brown\", \"grass\"},\n        {6, \"brown\", \"grass\"},\n        {7, \"brown\", \"grass\"},\n        {8, \"brown\", \"grass\"},\n        {9, \"brown\", \"grass\"},\n        {10, \"brown\", \"grass\"},\n        {11, \"brown\", \"grass\"},\n    }\n\n    sortByLastNameAndFirstNameFunctional(members)\n\n    for _, member := range members {\n        fmt.Println(member)\n    }\n}\n</code></pre>\n\n<h2>A completely different idea, but same API</h2>\n\n<p>If you want to avoid mentioning the fields <code>LastName</code> and <code>FirstName</code> multiple times and if you want to avoid mixing <code>i</code> and <code>j</code> (which can happen all the way), I played around a bit and the basic idea is:</p>\n\n<pre><code>func sortByLastNameAndFirstNameFunctional(members []Member) {\n    NewSorter().\n        AddStr(member -&gt; member.LastName).\n        AddStr(member -&gt; member.FirstName).\n        AddInt(member -&gt; member.Id).\n        SortStable(members)\n}\n</code></pre>\n\n<p>Since Go doesn't support the <code>-&gt;</code> operator for creating anonymous functions and also doesn't have generics like Java, a bit of syntactical overhead is needed:</p>\n\n<pre><code>func sortByLastNameAndFirstNameFunctional(members []Member) {\n    NewSorter().\n        AddStr(func(i interface{}) string { return i.(Member).LastName }).\n        AddStr(func(i interface{}) string { return i.(Member).FirstName }).\n        AddInt(func(i interface{}) int { return i.(Member).Id}).\n        SortStable(members)\n}\n</code></pre>\n\n<p>The implementation as well as the API is a bit ugly using <code>interface{}</code> and reflection, but it only mentions each field once, and the application code does not have a single chance to accidentally mix the indexes <code>i</code> and <code>j</code> since it doesn't deal with them.</p>\n\n<p>I designed this API in the spirit of Java's <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html#comparing-java.util.function.Function-\" rel=\"noreferrer\">Comparator.comparing</a>.</p>\n\n<p>The infrastructure code for the above sorter is:</p>\n\n<pre><code>type Sorter struct{ keys []Key }\n\nfunc NewSorter() *Sorter { return new(Sorter) }\n\nfunc (l *Sorter) AddStr(key StringKey) *Sorter { l.keys = append(l.keys, key); return l }\nfunc (l *Sorter) AddInt(key IntKey) *Sorter    { l.keys = append(l.keys, key); return l }\n\nfunc (l *Sorter) SortStable(slice interface{}) {\n    value := reflect.ValueOf(slice)\n    sort.SliceStable(slice, func(i, j int) bool {\n        si := value.Index(i).Interface()\n        sj := value.Index(j).Interface()\n        for _, key := range l.keys {\n            if key.Less(si, sj) {\n                return true\n            }\n            if key.Less(sj, si) {\n                return false\n            }\n        }\n        return false\n    })\n}\n\ntype Key interface {\n    Less(a, b interface{}) bool\n}\n\ntype StringKey func(interface{}) string\n\nfunc (k StringKey) Less(a, b interface{}) bool  { return k(a) &lt; k(b) }\n\ntype IntKey func(interface{}) int\n\nfunc (k IntKey) Less(a, b interface{}) bool  { return k(a) &lt; k(b) }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2091, "user_id": 679474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16d67e800c5e8e1d2d8e3333ab1f7093?s=128&d=identicon&r=PG", "display_name": "RavuAlHemio", "link": "https://stackoverflow.com/users/679474/ravualhemio"}, "edited": false, "score": 1, "creation_date": 1576864800, "post_id": 57897845, "comment_id": 105044976, "body": "This appears to missort <code>[{John Doe} {Zach Darren} {Jane Doe} {Mary Contrary}]</code> as <code>[{Mary Contrary} {Jane Doe} {Zach Darren} {John Doe}]</code>."}, {"owner": {"reputation": 5495, "user_id": 197359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3aa29fa2c37a05aee707fb11bb9b66b?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/197359/alex"}, "edited": false, "score": 0, "creation_date": 1603244980, "post_id": 57897845, "comment_id": 113973800, "body": "Just missed one clause in there.  <code>members[i].LastName &lt; members[j].LastName || (members[i].LastName == members[j].LastName &amp;&amp; members[i].FirstName &lt; members[j].FirstName)</code>  =&gt;  <code>[{Mary Contrary} {Zach Darren} {Jane Doe} {John Doe}]</code>"}], "tags": [], "owner": {"reputation": 34200, "user_id": 995862, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d5efb6c1054808f7a79aaefbc64cce76?s=128&d=identicon&r=PG", "display_name": "Kurt Peek", "link": "https://stackoverflow.com/users/995862/kurt-peek"}, "is_accepted": false, "score": -3, "last_activity_date": 1568243429, "creation_date": 1568243429, "answer_id": 57897845, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/57897845#57897845", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Here is a slightly more concise implementation of the accepted answer:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\ntype Member struct {\n    FirstName string\n    LastName  string\n}\n\nfunc main() {\n    members := []Member{\n        {\"John\", \"Doe\"},\n        {\"Jane\", \"Doe\"},\n        {\"Mary\", \"Contrary\"},\n    }\n\n    fmt.Println(members)\n\n    sort.Slice(members, func(i, j int) bool {\n        return members[i].LastName &lt; members[j].LastName || members[i].FirstName &lt; members[j].FirstName\n    })\n\n    fmt.Println(members)\n}\n</code></pre>\n\n<p>Running will print the following output:</p>\n\n<pre><code>[{John Doe} {Jane Doe} {Mary Contrary}]\n[{Mary Contrary} {Jane Doe} {John Doe}]\n</code></pre>\n\n<p>This is as expected: the members are printed in order of ascending last name, where in the case of a tie, they are printed in order of first name.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3790829, "user_type": "registered", "profile_image": "https://graph.facebook.com/1333861722/picture?type=large", "display_name": "user3790829", "link": "https://stackoverflow.com/users/3790829/user3790829"}, "is_accepted": false, "score": 0, "last_activity_date": 1586979187, "creation_date": 1586979187, "answer_id": 61237142, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/61237142#61237142", "title": "How to sort struct with multiple sort parameters?", "body": "<p>All good answers,\nIf you don't want to write any configuration. You can use the external package to perform sorting.</p>\n\n<p><code>go get -d github.com/raunakjodhawat/multisort</code></p>\n\n<p>And call the function like so:</p>\n\n<p><code>sortedSlice, err := multisort.MultiSorted(inputSlice, inputKeys, SortOrders)</code></p>\n\n<p>To look at a concrete example, go to:\n<a href=\"https://github.com/raunakjodhawat/multisort\" rel=\"nofollow noreferrer\">https://github.com/raunakjodhawat/multisort</a></p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 1586620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79e56a50419dca257abdc64caf9c0fd5?s=128&d=identicon&r=PG", "display_name": "Ivan Tolstosheyev", "link": "https://stackoverflow.com/users/1586620/ivan-tolstosheyev"}, "is_accepted": false, "score": 2, "last_activity_date": 1597229737, "last_edit_date": 1597229737, "creation_date": 1597224577, "answer_id": 63373689, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/63373689#63373689", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Just created go project to implement it: <a href=\"https://github.com/itroot/keysort\" rel=\"nofollow noreferrer\">https://github.com/itroot/keysort</a></p>\n<p>You can just return a list of fields to sort:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n\n    &quot;github.com/itroot/keysort&quot;\n)\n\ntype Data struct {\n    A int\n    B string\n    C bool\n}\n\nfunc main() {\n    slice := []Data{{1, &quot;2&quot;, false}, {2, &quot;2&quot;, false}, {2, &quot;1&quot;, true}, {2, &quot;1&quot;, false}}\n    keysort.Sort(slice, func(i int) keysort.Sortable {\n        e := slice[i]\n        return keysort.Sequence{e.A, e.B, e.C}\n    })\n    fmt.Println(slice)\n}\n</code></pre>\n<p>Playground link: <a href=\"https://play.golang.org/p/reEDcoXNiwh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/reEDcoXNiwh</a></p>\n"}, {"tags": [], "owner": {"reputation": 1312, "user_id": 1653210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbaa48e3b6fbb90d498e3dca27f099a6?s=128&d=identicon&r=PG", "display_name": "Daniel Pacak", "link": "https://stackoverflow.com/users/1653210/daniel-pacak"}, "is_accepted": false, "score": 1, "last_activity_date": 1614337975, "creation_date": 1614337975, "answer_id": 66384790, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters/66384790#66384790", "title": "How to sort struct with multiple sort parameters?", "body": "<p>Just read the code of the <em>SortMultiKeys</em> example in the official Go documentation at <a href=\"https://pkg.go.dev/sort\" rel=\"nofollow noreferrer\">https://pkg.go.dev/sort</a> and adapt it to your <code>Member</code> structure.</p>\n<p>To keep this answer up to date I won't copy and paste the whole example here, but eventually you'll be able to write it as follows:</p>\n<pre><code>OrderedBy(lastName, firstName).Sort(members)\n</code></pre>\n<p>If the requirement changed to sort also by age, you'd simply add the <code>age</code> closure:</p>\n<pre><code>OrderBy(lastName, firstName, age).Sort(members)\n</code></pre>\n"}], "owner": {"reputation": 5185, "user_id": 2180770, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/i1yKC.jpg?s=128&g=1", "display_name": "Melvin", "link": "https://stackoverflow.com/users/2180770/melvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30807, "favorite_count": 12, "accepted_answer_id": 42382736, "answer_count": 9, "score": 46, "last_activity_date": 1614337975, "creation_date": 1458530817, "last_edit_date": 1554204458, "question_id": 36122668, "link": "https://stackoverflow.com/questions/36122668/how-to-sort-struct-with-multiple-sort-parameters", "title": "How to sort struct with multiple sort parameters?", "body": "<p>I have an array/slice of members:</p>\n\n<pre><code>type Member struct {\n    Id int\n    LastName string\n    FirstName string\n}\n\nvar members []Member\n</code></pre>\n\n<p>My question is how to sort them by <code>LastName</code> and then by <code>FirstName</code>.</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1458528746, "post_id": 36122031, "comment_id": 59884796, "body": "@MuffinTop: You claim is clearly false. Read <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a>."}, {"owner": {"reputation": 111, "user_id": 3966405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7f5c66ca2ad8f9c5c0b09e712f1cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/3966405/devin"}, "edited": false, "score": 0, "creation_date": 1458530496, "post_id": 36122031, "comment_id": 59885153, "body": "Thank you, and thanks for edit my question,I understand now"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1458526067, "last_edit_date": 1458526067, "creation_date": 1458525763, "answer_id": 36122031, "question_id": 36121984, "link": "https://stackoverflow.com/questions/36121984/how-to-use-a-method-as-a-goroutine-function/36122031#36122031", "title": "How to use a method as a goroutine function", "body": "<blockquote>\n  <p><a href=\"https://golang.org/doc/faq\" rel=\"nofollow\">Go Frequently Asked Questions (FAQ)</a></p>\n  \n  <p><a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow\">What happens with closures running as goroutines?</a></p>\n  \n  <p>Some confusion may arise when using closures with concurrency.\n  Consider the following program:</p>\n\n<pre><code>func main() {\n    done := make(chan bool)\n\n    values := []string{\"a\", \"b\", \"c\"}\n    for _, v := range values {\n        go func() {\n            fmt.Println(v)\n            done &lt;- true\n        }()\n    }\n\n    // wait for all goroutines to complete before exiting\n    for _ = range values {\n        &lt;-done\n    }\n}\n</code></pre>\n  \n  <p>One might mistakenly expect to see a, b, c as the output. What you'll\n  probably see instead is c, c, c. This is because each iteration of the\n  loop uses the same instance of the variable v, so each closure shares\n  that single variable. When the closure runs, it prints the value of v\n  at the time fmt.Println is executed, but v may have been modified\n  since the goroutine was launched. To help detect this and other\n  problems before they happen, run go vet.</p>\n  \n  <p>To bind the current value of v to each closure as it is launched, one\n  must modify the inner loop to create a new variable each iteration.\n  One way is to pass the variable as an argument to the closure:</p>\n\n<pre><code>for _, v := range values {\n    go func(u string) {\n        fmt.Println(u)\n        done &lt;- true\n    }(v)\n}\n</code></pre>\n  \n  <p>In this example, the value of v is passed as an argument to the\n  anonymous function. That value is then accessible inside the function\n  as the variable u.</p>\n  \n  <p>Even easier is just to create a new variable, using a declaration\n  style that may seem odd but works fine in Go:</p>\n\n<pre><code>for _, v := range values {\n    v := v // create a new 'v'.\n    go func() {\n        fmt.Println(v)\n        done &lt;- true\n    }()\n}\n</code></pre>\n  \n  <hr>\n</blockquote>\n\n<p>Just create a new variable for the closure using a declaration style that may seem odd but works fine in Go. Add <code>task := task</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Task struct {\n    name string\n    data int32\n}\n\nfunc (this *Task) PrintData() {\n    fmt.Println(this.name, \":\", this.data)\n}\n\nfunc main() {\n    tasks := []Task{{\"hello\", 1}, {\"world\", 2}}\n    for _, task := range tasks {\n        task := task\n        go task.PrintData()\n    }\n    time.Sleep(time.Second * 5000)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>hello : 1\nworld : 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 3966405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7f5c66ca2ad8f9c5c0b09e712f1cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/3966405/devin"}, "edited": false, "score": 0, "creation_date": 1458530036, "post_id": 36122035, "comment_id": 59885049, "body": "Thanks\uff0cthe third is better\uff0cbecause I want to modify the member of the structure."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 111, "user_id": 3966405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7f5c66ca2ad8f9c5c0b09e712f1cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/3966405/devin"}, "edited": false, "score": 0, "creation_date": 1458530451, "post_id": 36122035, "comment_id": 59885139, "body": "@Devin, third option is the only way to go if you want to modify the slice.  Please see the updated third option. It&#39;s less verbose than the original."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 111, "user_id": 3966405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7f5c66ca2ad8f9c5c0b09e712f1cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/3966405/devin"}, "edited": false, "score": 1, "creation_date": 1458530815, "post_id": 36122035, "comment_id": 59885233, "body": "@Devin First option would also usually work (as long as your intent is to modify the <code>Task</code> and not to replace the pointer in the slice with a new pointer), but the third option is still better."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 12, "last_activity_date": 1458584599, "last_edit_date": 1458584599, "creation_date": 1458525771, "answer_id": 36122035, "question_id": 36121984, "link": "https://stackoverflow.com/questions/36121984/how-to-use-a-method-as-a-goroutine-function/36122035#36122035", "title": "How to use a method as a goroutine function", "body": "<p>Because <code>PrintData</code> is a pointer receiver and <code>task</code> is a value, the compiler automatically takes the address of <code>task</code> when making the method call. The resulting call is the same as <code>(&amp;task).PrintData()</code>.</p>\n\n<p>The variable <code>task</code> is set to a different value on each iteration through the loop.  The first goroutine doesn't run until <code>task</code> is set to second value.  Run <a href=\"http://play.golang.org/p/2bQC9V7Wj7\" rel=\"noreferrer\">this example</a> to see that the same address is passed to PrintData on each iteration.</p>\n\n<p>There are a few ways to fix this. The first is to use <code>*Task</code> in the slice:</p>\n\n<pre><code>tasks := []*Task{{\"hello\", 1}, {\"world\", 2}}\nfor _, task := range tasks {\n    go task.PrintData()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/h0NT4QUXNo\" rel=\"noreferrer\">playground example</a></p>\n\n<p>The second is to create a new variable inside the loop:</p>\n\n<pre><code>tasks := []Task{{\"hello\", 1}, {\"world\", 2}}\nfor _, task := range tasks {\n    task := task\n    go task.PrintData()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/EW0WurHIdX\" rel=\"noreferrer\">playground example</a></p>\n\n<p>A third is to take the address of the slice element (using the automatically inserted address operation):</p>\n\n<pre><code>tasks := []Task{{\"hello\", 1}, {\"world\", 2}}\nfor i := range tasks {\n    go tasks[i].PrintData()\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/-KaQeVD9sC\" rel=\"noreferrer\">playground example</a></p>\n\n<p>Yet another option is to change PrintData to a value receiver to prevent the method call from automatically taking the address of <code>task</code>:</p>\n\n<pre><code>func (this Task) PrintData() {\n    fmt.Println(this.name, \":\", this.data)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/kdOKVeO_Ti\" rel=\"noreferrer\">playground example</a></p>\n\n<p>This issue is similar to the <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"noreferrer\">issue discussed in the closures and goroutines FAQ</a>. The difference between the issues is the mechanism used to pass a pointer to the goroutine function. The code in the question uses the method's receiver argument. The code in the FAQ uses a <a href=\"https://en.wikipedia.org/wiki/Closure_(computer_programming)\" rel=\"noreferrer\">closure</a>.</p>\n"}], "owner": {"reputation": 111, "user_id": 3966405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7f5c66ca2ad8f9c5c0b09e712f1cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Devin", "link": "https://stackoverflow.com/users/3966405/devin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4055, "favorite_count": 3, "accepted_answer_id": 36122035, "answer_count": 2, "score": 4, "last_activity_date": 1458584599, "creation_date": 1458525318, "last_edit_date": 1458526833, "question_id": 36121984, "link": "https://stackoverflow.com/questions/36121984/how-to-use-a-method-as-a-goroutine-function", "title": "How to use a method as a goroutine function", "body": "<p>I have this code. I expect to output:</p>\n\n<pre><code>hello : 1 \nworld : 2\n</code></pre>\n\n<p>but it outputs:</p>\n\n<pre><code>world : 2\nworld : 2\n</code></pre>\n\n<p>Is there something wrong with my code?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Task struct {\n    name string\n    data int32\n}\n\nfunc (this *Task) PrintData() {\n    fmt.Println(this.name, \":\", this.data)\n}\n\nfunc main() {\n    tasks := []Task{{\"hello\", 1}, {\"world\", 2}}\n    for _, task := range tasks {\n        go task.PrintData()\n    }\n    time.Sleep(time.Second * 5000)\n}\n</code></pre>\n"}, {"tags": ["database", "postgresql", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458540147, "post_id": 36121206, "comment_id": 59887845, "body": "What is the address of your GCE instance? The external IP address is documented on the VM Instances Page -&gt; External IP."}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458586124, "post_id": 36121206, "comment_id": 59916879, "body": "I have updated the problem, yes indeed you should connect to the external ip address. But now it complains about a: operation not permitted error towards this external ip address"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1458590390, "post_id": 36121206, "comment_id": 59919272, "body": "Are you sure SSL is not enabled? That&#39;s a (very) bad idea if you&#39;re connecting remotely."}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458598021, "post_id": 36121206, "comment_id": 59923112, "body": "Yes I am sure that should be changed eventually, at this moment I just want some more information how this should be configured. I am able to connect with my PGadmin client from my local computer, so it should also be possible to connect AND perform queries on it, but apparently something still need to be configured for this.."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458606574, "post_id": 36121206, "comment_id": 59926029, "body": "What (exactly) are you entering in PGAdmin?"}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458631652, "post_id": 36121206, "comment_id": 59934379, "body": "The same external ip:5432, with the same user\\pw as I use in the code. The connection is not the problem, I can see that I am connected, but the error is given because I am performing a query in this Google App Engine code."}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458632109, "post_id": 36121206, "comment_id": 59934602, "body": "is there a way to &quot;authorize&quot; my app engine App on the compute engine where my DB is located?"}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458758907, "post_id": 36121206, "comment_id": 60007946, "body": "<a href=\"https://cloud.google.com/compute/docs/api/how-tos/authorization\" rel=\"nofollow noreferrer\">cloud.google.com/compute/docs/api/how-tos/authorization</a>"}, {"owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458758939, "post_id": 36121206, "comment_id": 60007960, "body": "see also: <a href=\"https://developers.google.com/identity/protocols/OAuth2#serviceaccount\" rel=\"nofollow noreferrer\">developers.google.com/identity/protocols/OAuth2#serviceaccou&zwnj;&#8203;nt</a>"}], "owner": {"reputation": 1, "user_id": 3509164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4585c1df7e67e5f473d7ea563728d1c3?s=128&d=identicon&r=PG&f=1", "display_name": "probas", "link": "https://stackoverflow.com/users/3509164/probas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 733, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1458758896, "creation_date": 1458518699, "last_edit_date": 1458758896, "question_id": 36121206, "link": "https://stackoverflow.com/questions/36121206/how-to-connect-to-my-postgresql-database-on-a-compute-engine-from-my-google-app", "title": "How to connect to my Postgresql database on a Compute Engine from my Google App Engine app using host", "body": "<p>I have been deploying my Go app on Google App Engine and that is nice. Then I created a Postgresql database on a Computing Engine with this beautiful setup document of Google: \n<a href=\"https://cloud.google.com/solutions/setup-postgres\" rel=\"nofollow\">https://cloud.google.com/solutions/setup-postgres</a></p>\n\n<p>And I have created my Database and tables and thats all very nice.. The only thing I still don't know is, how do I connect to this Computing Engine from my App engine app?</p>\n\n<p>In my Go code the following connection is made like this:</p>\n\n<pre><code>package core\n\nimport (\n\"database/sql\"\n\"log\"\n\n_ \"github.com/lib/pq\"\n)\n\nvar db *sql.DB\n\nfunc ConnectDB(connectStr string) {\n\nvar err error\ndb, err = sql.Open(\"postgres\", (\"host=???? user=user password=pw   \ndbname=dbtest sslmode=disable\")\n\nerr = db.Ping()\ncheckErr(err)\n...\n</code></pre>\n\n<p>Now I see thats Google nicely explains how this can be done for cloud SQL in here:<a href=\"https://cloud.google.com/appengine/docs/go/cloud-sql/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/cloud-sql/reference</a></p>\n\n<p>But I want to know how I make this work for my Compute Engine with my PostgreSQL database aswell :(</p>\n\n<p><strong>UPDATE 21-03-16:</strong></p>\n\n<p>Yes I already changed it to the external ip address as host and now I see it actually connects with the database on the compute engine, HOWEVER I see why I was confused, the log and the site still show a Server error, this time saying the following in the log from the db.Ping error:</p>\n\n<p><strong><em>panic: dial tcp [external ip address]:5432: operation not permitted</em></strong></p>\n\n<p>There are already several standard firewalls with:\n0.0.0.0/0 and a port numbers :80, :443 etc</p>\n\n<p>Do I need to add an extra rule? And how should this rule look like? Is there more information somewhere where I can see how I should do this correctly?</p>\n\n<p><strong>UPDATE 23-03</strong></p>\n\n<p>To summarize: <strong>I want to be \"authorize\" my Google App Engine app on the Compute Engine to connect to my Database. How do I do this?</strong></p>\n\n<p>Somehow, this is not very clear from the google websites, eventhough this should be something trivial. I would expect clear information on the google compute\\app engine site..</p>\n\n<p>Now I am pretty much forced to work with CloudSQL</p>\n\n<p><strong>Conclusion:</strong></p>\n\n<p>I think it is required to use OAuth as is explained in the link provided in my own comment below</p>\n"}, {"tags": ["go", "rust"], "comments": [{"owner": {"reputation": 74030, "user_id": 1256624, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EdJaa.jpg?s=128&g=1", "display_name": "huon", "link": "https://stackoverflow.com/users/1256624/huon"}, "edited": false, "score": 14, "creation_date": 1458516201, "post_id": 36120811, "comment_id": 59881933, "body": "The Rust code will be significantly faster if you compile with optimisations: <code>rustc -O parity.rs</code>."}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1458518288, "post_id": 36120811, "comment_id": 59882441, "body": "Compiling with optimizations is described in the <a href=\"http://doc.rust-lang.org/stable/book/getting-started.html\" rel=\"nofollow noreferrer\">Getting Started</a> section of <a href=\"http://doc.rust-lang.org/stable/book/README.html\" rel=\"nofollow noreferrer\"><i>The Rust Programming Language</i></a>, the section immediately after the 1-page introduction."}, {"owner": {"reputation": 72538, "user_id": 497043, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a138ff3b9c8f1663f8a0613c47b60a?s=128&d=identicon&r=PG", "display_name": "Chris Morgan", "link": "https://stackoverflow.com/users/497043/chris-morgan"}, "edited": false, "score": 7, "creation_date": 1458522357, "post_id": 36120811, "comment_id": 59883475, "body": "I get it taking 3 seconds unoptimised and 0.45 seconds optimised in Rust, and 0.6 seconds in Go."}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 5, "creation_date": 1458523575, "post_id": 36120811, "comment_id": 59883709, "body": "For what it&#39;s worth, I&#39;d recommend using the built-in <a href=\"http://doc.rust-lang.org/std/primitive.i64.html#method.count_ones\" rel=\"nofollow noreferrer\"><code>count_ones</code></a> method. Looks <a href=\"http://is.gd/tjLsyF\" rel=\"nofollow noreferrer\">like this</a>."}, {"owner": {"reputation": 627, "user_id": 1932023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac0b138f6450a33f88a08e89109150?s=128&d=identicon&r=PG", "display_name": "Alex Chekunkov", "link": "https://stackoverflow.com/users/1932023/alex-chekunkov"}, "reply_to_user": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1458563207, "post_id": 36120811, "comment_id": 59900557, "body": "@Shepmaster thanks for the suggestion, good to know!"}], "answers": [{"comments": [{"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 2, "creation_date": 1458522670, "post_id": 36121578, "comment_id": 59883545, "body": "While interesting, this doesn&#39;t answer the question OP asked: <i>Why do the Rust and Go programs I&#39;ve written have such a dramatic difference in performance</i>. This seems like it would be better as a comment on the question about the methodology of the benchmarking. Both Go and Rust versions are measuring code that performs the same functions."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 4, "creation_date": 1458523509, "post_id": 36121578, "comment_id": 59883693, "body": "@Shepmaster: The OPs implicit question was why a &quot;brute-force parity check for 64-bit unsigned integers&quot; has such a dramatic difference in performance between Rust and Go. To paraphrase, there are lies, damn lies, and benchmarks."}, {"owner": {"reputation": 627, "user_id": 1932023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac0b138f6450a33f88a08e89109150?s=128&d=identicon&r=PG", "display_name": "Alex Chekunkov", "link": "https://stackoverflow.com/users/1932023/alex-chekunkov"}, "edited": false, "score": 1, "creation_date": 1458562964, "post_id": 36121578, "comment_id": 59900375, "body": "@peterSO &quot;The OPs implicit question was why a &quot;brute-force parity check for 64-bit unsigned integers&quot; has such a dramatic difference in performance between Rust and Go&quot; Just no."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1458522339, "last_edit_date": 1458522339, "creation_date": 1458521866, "answer_id": 36121578, "question_id": 36120811, "link": "https://stackoverflow.com/questions/36120811/why-is-my-rust-program-4x-slower-than-a-go-program-doing-the-same-bitwise-and-i/36121578#36121578", "title": "Why is my Rust program 4x slower than a Go program doing the same bitwise and I/O operations?", "body": "<p>Your benchmark doesn't measure the parity check. It measures input plus parity check plus output. For example, in Go, you measure <code>scanner.Scan</code> and <code>strconv.ParseUint</code> and <code>fmt.Println</code> as well as the parity check. </p>\n\n<p>Here's a Go benchmark that just measures 1000000 parity checks.</p>\n\n<p><code>parity_test.go</code>:</p>\n\n<pre><code>package parity\n\nimport (\n    \"math/rand\"\n    \"runtime\"\n    \"testing\"\n)\n\nfunc parity(n uint64) uint64 {\n    var parity uint64\n    for n &gt; 0 {\n        parity ^= n &amp; 1\n        n &gt;&gt;= 1\n    }\n    return parity\n}\n\nfunc init() { runtime.GOMAXPROCS(1) }\n\n// Benchmark 1000000 parity checks.\nfunc BenchmarkParity1000000(b *testing.B) {\n    n := make([]uint64, 1000000)\n    for i := range n {\n        r := uint64(rand.Uint32())\n        n[i] = (r &lt;&lt; 32) | r\n    }\n    p := parity(42)\n    b.ResetTimer()\n    for i := 0; i &lt; b.N; i++ {\n        for _, n := range n {\n            p = parity(n)\n        }\n    }\n    b.StopTimer()\n    _ = p\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test -bench=.\nBenchmarkParity1000000        50      34586769 ns/op\n$\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 627, "user_id": 1932023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac0b138f6450a33f88a08e89109150?s=128&d=identicon&r=PG", "display_name": "Alex Chekunkov", "link": "https://stackoverflow.com/users/1932023/alex-chekunkov"}, "edited": false, "score": 0, "creation_date": 1458563397, "post_id": 36124361, "comment_id": 59900705, "body": "You&#39;re so right, thanks! For others who will read this - there&#39;s another way to set optimization level - <code>rustc -C opt-level=3 parity.rs</code>, and <code>-O</code> is a shortcut for <code>-C opt-level=2</code>."}, {"owner": {"reputation": 1343, "user_id": 4365239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88acc4986ddaf51e21c254fb8c0f11b8?s=128&d=identicon&r=PG&f=1", "display_name": "tafia", "link": "https://stackoverflow.com/users/4365239/tafia"}, "reply_to_user": {"reputation": 627, "user_id": 1932023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac0b138f6450a33f88a08e89109150?s=128&d=identicon&r=PG", "display_name": "Alex Chekunkov", "link": "https://stackoverflow.com/users/1932023/alex-chekunkov"}, "edited": false, "score": 0, "creation_date": 1458788817, "post_id": 36124361, "comment_id": 60019694, "body": "you can also use <code>cargo build --release</code>, I find it more convenient than rustc"}], "tags": [], "owner": {"reputation": 1343, "user_id": 4365239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88acc4986ddaf51e21c254fb8c0f11b8?s=128&d=identicon&r=PG&f=1", "display_name": "tafia", "link": "https://stackoverflow.com/users/4365239/tafia"}, "is_accepted": true, "score": 5, "last_activity_date": 1458541159, "creation_date": 1458541159, "answer_id": 36124361, "question_id": 36120811, "link": "https://stackoverflow.com/questions/36120811/why-is-my-rust-program-4x-slower-than-a-go-program-doing-the-same-bitwise-and-i/36124361#36124361", "title": "Why is my Rust program 4x slower than a Go program doing the same bitwise and I/O operations?", "body": "<p>I think you're not compiling with optimisation.\ntry </p>\n\n<pre><code>$ rustc -O parity.rs\n</code></pre>\n"}], "owner": {"reputation": 627, "user_id": 1932023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fac0b138f6450a33f88a08e89109150?s=128&d=identicon&r=PG", "display_name": "Alex Chekunkov", "link": "https://stackoverflow.com/users/1932023/alex-chekunkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 1, "closed_date": 1458563835, "accepted_answer_id": 36124361, "answer_count": 2, "score": 0, "last_activity_date": 1458541159, "creation_date": 1458515663, "last_edit_date": 1458518182, "question_id": 36120811, "link": "https://stackoverflow.com/questions/36120811/why-is-my-rust-program-4x-slower-than-a-go-program-doing-the-same-bitwise-and-i", "closed_reason": "Duplicate", "title": "Why is my Rust program 4x slower than a Go program doing the same bitwise and I/O operations?", "body": "<p>I have a Rust program that implements a brute-force parity check for 64-bit unsigned integers:</p>\n\n<pre class=\"lang-rust prettyprint-override\"><code>use std::io;\nuse std::io::BufRead;\n\nfn parity(mut num: u64) -&gt; u8 {\n    let mut result: u8 = 0;\n    while num &gt; 0 {\n        result = result ^ (num &amp; 1) as u8;\n        num = num &gt;&gt; 1;\n    }\n    result\n}\n\nfn main() {\n    let stdin = io::stdin();\n    let mut num: u64;\n    let mut it = stdin.lock().lines();\n    // skip 1st line with number of test cases\n    it.next();\n    for line in it {\n        num = line.unwrap().parse().unwrap();\n        println!(\"{}\", parity(num));\n    }\n}\n</code></pre>\n\n<p>When I feed it with input file containing 1000000 unsigned integers:</p>\n\n<pre><code>$ rustc parity.rs\n$ time cat input.txt | ./parity &amp;&gt; /dev/null\ncat input.txt  0.00s user 0.02s system 0% cpu 4.178 total\n./parity &amp;&gt; /dev/null  3.87s user 0.32s system 99% cpu 4.195 total\n</code></pre>\n\n<p>And here comes a surprise - the effectively same program in Go does 4x faster:</p>\n\n<pre><code>$ go build parity.go\n$ time cat input.txt | ./parity &amp;&gt; /dev/null\ncat input.txt  0.00s user 0.03s system 3% cpu 0.952 total\n./parity &amp;&gt; /dev/null  0.63s user 0.32s system 99% cpu 0.955 total\n</code></pre>\n\n<p>Here's the code in Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n)\n\nfunc parity(line string) uint64 {\n    var parity uint64\n    u, err := strconv.ParseUint(line, 10, 64)\n    if err != nil {\n        panic(err)\n    }\n    for u &gt; 0 {\n        parity ^= u &amp; 1\n        u &gt;&gt;= 1\n    }\n    return parity\n}\n\nfunc main() {\n    scanner := bufio.NewScanner(os.Stdin)\n    // skip line with number of cases\n    if !scanner.Scan() {\n        // panic if there's no number of test cases\n        panic(\"missing number of test cases\")\n    }\n    for scanner.Scan() {\n        fmt.Println(parity(scanner.Text()))\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading standard input:\", err)\n    }\n}\n</code></pre>\n\n<p>Versions:</p>\n\n<pre><code>$ rustc --version\nrustc 1.7.0\n$ go version\ngo version go1.6 darwin/amd64\n</code></pre>\n\n<p>Sample of input file, first line contains number of input values in the file:</p>\n\n<pre><code>8\n7727369244898783789\n2444477357490019411\n4038350233697550492\n8106226119927945594\n1538904728446207070\n0\n1\n18446744073709551615\n</code></pre>\n\n<p>Why do the Rust and Go programs I've written have such a dramatic difference in performance? I expected Rust to be a bit faster than Go in this case. Am I doing something wrong in my Rust code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 4, "creation_date": 1458515403, "post_id": 36120621, "comment_id": 59881693, "body": "Have you tried doing any debugging? Look at where input21 is being set. Also,  I&#39;m not sure why you have two different Scanners reading from stdin."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1458515720, "post_id": 36120621, "comment_id": 59881779, "body": "Print the values you&#39;re reading and see what they are"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1458535365, "creation_date": 1458535365, "answer_id": 36123281, "question_id": 36120621, "link": "https://stackoverflow.com/questions/36120621/goi-am-trying-to-make-a-guess-my-number-but-my-program-will-not-interpret-numb/36123281#36123281", "title": "GO:I am trying to make a guess My number, but my program will not interpret numbers correctly", "body": "<p>You need to understand how type Scanner works. Read the documentation for <code>type Scanner</code> and its methods carefully and take a look at the examples.</p>\n\n<p><a href=\"https://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow\">package bufio: type Scanner</a></p>\n\n<p>For example, \"Scan advances the Scanner to the next token, which will then be available through the Bytes or Text method.\"</p>\n\n<p>For buffered stream input, it's dangerous to have more than one scanner per file.</p>\n\n<p>It's no fun to guess a number that you input yourself. Use a random number generator, for example, 'package math/rand`.</p>\n\n<p>It would take too long to explain all the problems with your code, so here's a simple example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"math/rand\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    var number = rand.Intn(100)\n    fmt.Println(\"Make a guess:\")\n    var scanner = bufio.NewScanner(os.Stdin)\n    for scanner.Scan() {\n        var guess, err = strconv.Atoi(scanner.Text())\n        if err != nil {\n            fmt.Print(\"Input error\")\n        } else if guess == number {\n            break\n        } else if guess &gt; number {\n            fmt.Print(\"Too high\")\n        } else if guess &lt; number {\n            fmt.Print(\"Too low\")\n        }\n        fmt.Println(\", Guess again:\")\n    }\n    if scanner.Err() != nil {\n        fmt.Println(\"I give up!\")\n    }\n    fmt.Println(\"You win!\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 2, "last_activity_date": 1458538045, "creation_date": 1458538045, "answer_id": 36123736, "question_id": 36120621, "link": "https://stackoverflow.com/questions/36120621/goi-am-trying-to-make-a-guess-my-number-but-my-program-will-not-interpret-numb/36123736#36123736", "title": "GO:I am trying to make a guess My number, but my program will not interpret numbers correctly", "body": "<p>Whenever you have a function that returns an <code>error</code> value, you must check whether that is <code>nil</code>. Only after you have done that may you access any other value that the function returned.</p>\n\n<p>When you add this proper error handling, you will see where your program fails.</p>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "is_accepted": false, "score": 0, "last_activity_date": 1458656117, "creation_date": 1458656117, "answer_id": 36156821, "question_id": 36120621, "link": "https://stackoverflow.com/questions/36120621/goi-am-trying-to-make-a-guess-my-number-but-my-program-will-not-interpret-numb/36156821#36156821", "title": "GO:I am trying to make a guess My number, but my program will not interpret numbers correctly", "body": "<p>I was not resetting the scanners, at the end of the if's where the scanner is re-evaluated, you have to re-declare the strconv.Atoi </p>\n"}], "owner": {"reputation": 193, "user_id": 5574609, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Z8DszpZmPOA/AAAAAAAAAAI/AAAAAAAAABI/qRBWSg0ue2E/photo.jpg?sz=128", "display_name": "liam", "link": "https://stackoverflow.com/users/5574609/liam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1458656117, "creation_date": 1458514283, "last_edit_date": 1458525831, "question_id": 36120621, "link": "https://stackoverflow.com/questions/36120621/goi-am-trying-to-make-a-guess-my-number-but-my-program-will-not-interpret-numb", "title": "GO:I am trying to make a guess My number, but my program will not interpret numbers correctly", "body": "<pre><code>package main\n\nimport \"fmt\"\nimport bf \"bufio\"\nimport \"os\"\nimport \"strconv\"\n\ntype SVC int\n\nfunc main() {\n        fmt.Println(\"Loaded\")\n        var gmber = bf.NewScanner(os.Stdin)\n        gmber.Scan()\n        i := 1\n        for i &lt; 40 {\n                fmt.Println(\"\\n\")\n                i++\n        }\n        var input2 = bf.NewScanner(os.Stdin)\n        fmt.Println(\"Make a guess:\")\n        var input21, err = strconv.Atoi(input2.Text())\n        var gmber1, err0 = strconv.Atoi(gmber.Text())\n        input2.Scan()\n        for {\n                if input21 == gmber1{\n                        break\n                }\n                if input21 &gt; gmber1 {\n                        fmt.Println(\"Too high, Guess again\")\n                        input2.Scan()\n                }\n                if input21 &lt; gmber1 {\n                        fmt.Println(\"Too low, Guess again\")\n                        input2.Scan()\n                }\n        }\n        fmt.Println(\"You win!\")\n        fmt.Println(err)\n        fmt.Println(err0)\n}\n</code></pre>\n\n<p>I when I run this program, my program will always spit out \"Too low, Guess again\". I input: 100 as the number to be guessed, then guessed the number 101, and it said too low. I just do not really know what to do now, does anybody understand why this program does this?\nNOTES:\ninput21 is ALWAYS=to 0 </p>\n"}, {"tags": ["windows", "time", "go", "timestamp", "unix-timestamp"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1458525450, "post_id": 36120459, "comment_id": 59884133, "body": "That&#39;s <code>TimeFromTicks</code>: <a href=\"http://stackoverflow.com/a/33161703/221700\">stackoverflow.com/a/33161703/221700</a>."}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1458513097, "creation_date": 1458513097, "answer_id": 36120460, "question_id": 36120459, "link": "https://stackoverflow.com/questions/36120459/converting-windows-ticks-into-unix-timestamp-in-go/36120460#36120460", "title": "Converting windows ticks into UNIX timestamp in Go", "body": "<p>After trying a lot to adapt answers in other programming languages, I found this to be the most accurate:</p>\n\n<pre><code>t := time.Unix(0, ((635885625204626270)-60*60*24*365*1970*10000000)*100)\n</code></pre>\n\n<p>It should be the most precise solution, as it does not perform divisions on the original tick count, and get to as accurate as microseconds (only if Windows can get that accurate on tick count, that is.)</p>\n"}], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 835, "favorite_count": 0, "closed_date": 1458514197, "answer_count": 1, "score": 1, "last_activity_date": 1458513097, "creation_date": 1458513097, "question_id": 36120459, "link": "https://stackoverflow.com/questions/36120459/converting-windows-ticks-into-unix-timestamp-in-go", "closed_reason": "Duplicate", "title": "Converting windows ticks into UNIX timestamp in Go", "body": "<p>I am trying to convert <a href=\"https://msdn.microsoft.com/en-us/library/system.datetime.ticks(v=vs.110).aspx\" rel=\"nofollow\">Windows Ticks</a> into Go's native <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow\"><code>time.Time</code></a>. Specifically, I want to convert <code>635885625204626270</code> into an UNIX timestamp. So far I only managed to adapt a PHP question, and could get as far as seconds, however I am now stuck here.</p>\n\n<pre><code>ticksInUnix := (635885625204626270 / 10000000) - 60*60*24*365*1970\nt := time.Unix(ticksInUnix, 0)\n</code></pre>\n"}, {"tags": ["serialization", "go", "comma"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1458514942, "post_id": 36120333, "comment_id": 59881589, "body": "Did you try to look at the stdlib&#39;s documentation? <a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/csv</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1458540478, "creation_date": 1458540478, "answer_id": 36124192, "question_id": 36120333, "link": "https://stackoverflow.com/questions/36120333/deserialize-comma-separated-values-into-struct/36124192#36124192", "title": "deserialize comma-separated values into struct", "body": "<p>Don't know of a library to do what you're asking.  But it's easy to work with a string like that.  If there were just a few types of structs I needed to do that with, I'd use strings.Split(s, \", \") to create a slice of key=value strings, and then strings.Split(ss, \"=\") again on the pieces, if I wanted to write code quickly that didn't need to be efficient.  Then run the key value through a switch statement and update the matching struct field.</p>\n\n<p>If I wanted that to be  super efficient, I'ld write a loop around the switch statement that reset two byte slices to each subsequent key and value and not bother creating slices of strings first.</p>\n\n<p>On the other hand, if I wanted to write the code fast, and work with many types of structs, I'd modify the string to be legal JSON and then use the JSON Unmarshal() function.  It would be quick to write, and the json.Unmarshal() error would tell you if you had missed anything.</p>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1458540478, "creation_date": 1458512309, "question_id": 36120333, "link": "https://stackoverflow.com/questions/36120333/deserialize-comma-separated-values-into-struct", "title": "deserialize comma-separated values into struct", "body": "<p>Let's say i have a string like this:</p>\n\n<blockquote>\n  <p>key1=val1, key2=val2 (and so on)</p>\n</blockquote>\n\n<p>I want to deserialize it into a struct (the type I defined in my code), just like we do with JSON or XML. Ofc one could write a decoder function, but I thought it may exist, because writing your own deserializer may take some time and before doing it I thought there could be Go's standard library way.</p>\n"}, {"tags": ["go", "vendor", "glide-golang"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458515628, "post_id": 36119814, "comment_id": 59881759, "body": "Why do you have <code>bin</code>, <code>pkg</code> and <code>src</code> in your project directory? Your project should be located at its import path. What is the overall structure here?"}], "answers": [{"tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": false, "score": 5, "last_activity_date": 1458552696, "last_edit_date": 1458552696, "creation_date": 1458526281, "answer_id": 36122089, "question_id": 36119814, "link": "https://stackoverflow.com/questions/36119814/not-resolving-dependency-in-vendor-directory/36122089#36122089", "title": "Not resolving dependency in vendor directory", "body": "<p>Your <code>main.go</code> file needs to be inside a workspace (that is, inside gopath) for its dependencies to be vendored. As a test, try putting your <code>main.go</code> inside a fake path and see if the vendored deps are found:</p>\n\n<pre><code>$GOPATH/src/\n   example.com/\n     main.go\n   vendor/\n     github.com/\n       spf13/viper/\n       gizak/termui/\n</code></pre>\n\n<p>In general, you don't want to store any code in your gopath outside its root <code>src</code> directory. That is, you should echo the structure that <code>go get</code> would use when creating the directories.</p>\n"}], "owner": {"reputation": 949, "user_id": 897302, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/e1da7a726ee2619f22a27c41992d0b18?s=128&d=identicon&r=PG", "display_name": "bjoern", "link": "https://stackoverflow.com/users/897302/bjoern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2753, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1498653847, "creation_date": 1458509232, "last_edit_date": 1498653847, "question_id": 36119814, "link": "https://stackoverflow.com/questions/36119814/not-resolving-dependency-in-vendor-directory", "title": "Not resolving dependency in vendor directory", "body": "<p>I'm running go1.6 and am getting the follow error when running \"go build\" in GOPATH (/Users/bweidlich/Projects/go)</p>\n\n<pre><code>main.go:6:2: cannot find package \"github.com/spf13/viper\" in any of:\n/usr/local/go/src/github.com/spf13/viper (from $GOROOT)\n/Users/bweidlich/Projects/go/src/github.com/spf13/viper (from $GOPATH)\n</code></pre>\n\n<p>Project structure:</p>\n\n<pre><code>bin/\nglide.lock\nglide.yaml\ngo.iml\nlogs/\nmain.go\npkg/\nsrc/\nvendor/\n      github.com/\n                 deckarep/gosx-notifier\n                 spf13/viper\n                 gizak/termui\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gizak/termui\" &lt;--- doesn't resolve\n    \"github.com/spf13/viper\"  &lt;--- doesn't resolve\n    \"log\"\n    \"bweidlich/dash\"\n    \"net/http\"\n    \"os\"\n    \"os/exec\"\n    \"time\"\n)\n</code></pre>\n"}, {"tags": ["json", "go", "slice"], "comments": [{"owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "edited": false, "score": 0, "creation_date": 1458507389, "post_id": 36119284, "comment_id": 59879074, "body": "It doesn&#39;t have to be json. I just want it to work :)"}, {"owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "edited": false, "score": 0, "creation_date": 1458509946, "post_id": 36119284, "comment_id": 59879942, "body": "Fixed it! Is it good now?"}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1458515095, "post_id": 36120277, "comment_id": 59881627, "body": "You probably should mention using <code>json.NewDecoder</code> if the file is large since it&#39;d be more efficient."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1458511949, "creation_date": 1458511949, "answer_id": 36120277, "question_id": 36119284, "link": "https://stackoverflow.com/questions/36119284/read-a-slice-from-a-json-file-in-golang/36120277#36120277", "title": "Read a slice from a json file in golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    data, err := ioutil.ReadFile(\"data.json\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Print(\"data:  \",string(data))\n    var slice []string\n    err = json.Unmarshal(data, &amp;slice)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Printf(\"slice: %q\\n\",slice)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ cat data.json\n[\"a\",\"b\",\"c\",\"d\"]\n$ go run data.go\ndata:  [\"a\",\"b\",\"c\",\"d\"]\nslice: [\"a\" \"b\" \"c\" \"d\"]\n$\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 6058631, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/80f2cff0a0888497bd7ef323cbc1d4c5?s=128&d=identicon&r=PG&f=1", "display_name": "XXX", "link": "https://stackoverflow.com/users/6058631/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10566, "favorite_count": 1, "accepted_answer_id": 36120277, "answer_count": 1, "score": 1, "last_activity_date": 1458511949, "creation_date": 1458506412, "last_edit_date": 1458509925, "question_id": 36119284, "link": "https://stackoverflow.com/questions/36119284/read-a-slice-from-a-json-file-in-golang", "title": "Read a slice from a json file in golang", "body": "<p>How do I read a slice from a <code>json</code> file in golang? For example, the file <code>data.json</code> looks like this:</p>\n\n<p><code>[\"a\",\"b\",\"c\",\"d\"]</code></p>\n\n<p>I have tried using <code>ioutil.ReadFile</code> to do this, but this returns a string, not a slice. How can I read my slice?<br>\n<strong>NOTE</strong>: You can sub the brackets <code>[]</code> for braces <code>{}</code><br>\nI have done this using structs, but I don't want the user to have to type in this complicated json stuff </p>\n"}, {"tags": ["python", "c", "go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "edited": false, "score": 1, "creation_date": 1458597676, "post_id": 36129145, "comment_id": 59922950, "body": "Thank you for the answer! I resolve it :)"}], "tags": [], "owner": {"reputation": 126, "user_id": 1246431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4254d4b6c9eebe54fecd792d2a0314f6?s=128&d=identicon&r=PG", "display_name": "bgeyts668", "link": "https://stackoverflow.com/users/1246431/bgeyts668"}, "is_accepted": true, "score": 5, "last_activity_date": 1458558086, "last_edit_date": 1458558086, "creation_date": 1458557714, "answer_id": 36129145, "question_id": 36118229, "link": "https://stackoverflow.com/questions/36118229/python-module-written-in-golang-and-c/36129145#36129145", "title": "Python module written in Golang and C", "body": "<h3>Nil output</h3>\n\n<p>This function:</p>\n\n<pre><code>int PyArg_ParseTuple_S(PyObject * args, char* a) {\n    return PyArg_ParseTuple(args, \"s\", &amp;a);\n}\n</code></pre>\n\n<p>will only set the <em>local</em> copy of <code>a</code> and <em>won't</em> return it into the calling function, because you pass the string pointer by value (by copying) so <code>PyArg_ParseTuple</code> only sets the copy.</p>\n\n<pre><code>var a *C.char\nC.PyArg_ParseTuple_S(args, a)\n// Here `a` is not set, so it keeps its default value: nil.\n</code></pre>\n\n<p>You can solve this by passing pointer to your string instead of a string itself:</p>\n\n<pre><code>// C\nint PyArg_ParseTuple_S(PyObject * args, char** a) {\n    return PyArg_ParseTuple(args, \"s\", a);\n}\n\n// Go\nvar a *C.char\nif C.PyArg_ParseTuple_S(args, &amp;a) == 0 {\n    //return nil\n}\n</code></pre>\n\n<h3>Correct printing</h3>\n\n<p><code>fmt.Println(a)</code> will print the address held by <code>a</code>, and not the string, which it points to. Go has own type for strings and does not work with C strings.</p>\n\n<p>If you want to print the text properly, you must convert it using <code>C.GoString</code>:</p>\n\n<pre><code>// C string to Go string\nfunc C.GoString(*C.char) string\n</code></pre>\n\n<p>(from <a href=\"https://golang.org/cmd/cgo/\" rel=\"noreferrer\">https://golang.org/cmd/cgo/</a>)</p>\n\n<p>For example:</p>\n\n<pre><code>str := C.GoString(a)\nfmt.Println(str)\n</code></pre>\n\n<h3>Segmentation fault.</h3>\n\n<p>I'm not familiar with python modules development, but I can assume, that the fault happens, because python method is expected to return a valid <code>PyObject*</code> or <code>NULL</code>. But you code does none of that. The return value of <code>startVM</code> is not set and it doesn't default to nil, python accepts this non-nil pointer as a valid object and dereferences it, which causes segmentation error.</p>\n\n<p>Specifying the return type of <code>startVM</code> might help:</p>\n\n<pre><code>//export startVM\nfunc startVM(self, args *C.PyObject) *C.PyObject {  \n    // ...some code...\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 809, "user_id": 4571943, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/f29b880ba43211bd4f2f586d09e3cc42?s=128&d=identicon&r=PG&f=1", "display_name": "DarkSkull", "link": "https://stackoverflow.com/users/4571943/darkskull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 1, "closed_date": 1458774774, "accepted_answer_id": 36129145, "answer_count": 1, "score": 1, "last_activity_date": 1458558086, "creation_date": 1458500951, "last_edit_date": 1458540562, "question_id": 36118229, "link": "https://stackoverflow.com/questions/36118229/python-module-written-in-golang-and-c", "closed_reason": "Not suitable for this site", "title": "Python module written in Golang and C", "body": "<p>I follow this <a href=\"https://blog.filippo.io/building-python-modules-with-go-1-5/\" rel=\"nofollow\">tutorial</a> </p>\n\n<p>to write this code, in C:</p>\n\n<pre><code>#define Py_LIMITED_API\n#include &lt;Python.h&gt;\n\nPyObject * startVM(PyObject *, PyObject *);\n\nint PyArg_ParseTuple_S(PyObject * args, char* a) {  \n    return PyArg_ParseTuple(args, \"s\", &amp;a);\n}\n\nstatic PyMethodDef FooMethods[] = {  \n    {\"startVM\", startVM, METH_VARARGS, \"Starts.\"},\n    {NULL, NULL, 0, NULL}\n};\n\nstatic struct PyModuleDef foomodule = {  \n   PyModuleDef_HEAD_INIT, \"foo\", NULL, -1, FooMethods\n};\n\nPyMODINIT_FUNC PyInit_foo(void) {\n    return PyModule_Create(&amp;foomodule);\n}\n</code></pre>\n\n<p>and this code in GO:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n\n// #cgo pkg-config: python3\n// #define Py_LIMITED_API\n// #include &lt;Python.h&gt;\n// int PyArg_ParseTuple_S(PyObject *,char *);\nimport \"C\"\n\n//export startVM\nfunc startVM(self, args *C.PyObject) {  \n    var a *C.char\n    if C.PyArg_ParseTuple_S(args, a) == 0 {\n        //return nil\n    }\n    fmt.Println(a)\n    //return C.PyBytes_FromString(&amp;a)\n}\n\nfunc main() {}  \n</code></pre>\n\n<p>I can compile the code in go, but when I call in python the module with this command: <code>python3 -c 'import foo; foo.startVM(\"hello\")'</code>, it prints nil and results in segmentation fault...\nCould someone know how to fix it?\nThanks in advance.</p>\n"}, {"tags": ["javascript", "html", "string", "google-app-engine", "go"], "comments": [{"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1458481267, "post_id": 36114389, "comment_id": 59869551, "body": "I replaced <code>\\n</code> as well, I didn&#39;t work out either. I am using Linux."}], "answers": [{"comments": [{"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "reply_to_user": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1458482984, "post_id": 36114543, "comment_id": 59870121, "body": "Did you try <code>template.New(name).Funcs(funcs).ParseFiles(name)</code>?"}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1458486607, "post_id": 36114543, "comment_id": 59871465, "body": "Yes, that is exactly what I did. It compiled but showed error when requested. <code>http: panic serving 127.0.0.1:36496: runtime error: invalid memory address or nil pointer dereference</code> after calling <code>templates.Execute</code>. It worked when I used <code>template.Must(template.ParseFiles(&quot;page.html&quot;)</code> before calling <code>templates.Execute</code>. I handled error but the error wasn&#39;t thrown from my handlers but by Go&#39;s panic function."}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "reply_to_user": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1458488085, "post_id": 36114543, "comment_id": 59871939, "body": "That&#39;s strange, it works like this on the playground: <a href=\"http://play.golang.org/p/WKDhEm3qJj\" rel=\"nofollow noreferrer\">play.golang.org/p/WKDhEm3qJj</a>"}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1458489070, "post_id": 36114543, "comment_id": 59872270, "body": "By the way, I assigned the template pointer received from <code>template.New(name).Funcs(funcs).ParseFiles(name)</code> to a map of template pointer <code>var templates map[int]*template.Template</code>. I didn&#39;t think it would matter, did it?"}, {"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 1, "creation_date": 1458490055, "post_id": 36114543, "comment_id": 59872642, "body": "Solved! I just have to name the template name in <code>New(name)</code> as the name in the <code>ParseFiles(name)</code> function. Thank user1431317!"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "reply_to_user": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 1, "creation_date": 1458490242, "post_id": 36114543, "comment_id": 59872711, "body": "Oh yeah, sorry if that wasn&#39;t obvious from my comment."}], "tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": true, "score": 3, "last_activity_date": 1458481616, "creation_date": 1458481616, "answer_id": 36114543, "question_id": 36114389, "link": "https://stackoverflow.com/questions/36114389/displaying-line-breaks-produced-by-html-template-in-go-on-gae/36114543#36114543", "title": "Displaying line breaks produced by html/template in Go on GAE", "body": "<p>Instead of changing the newlines to <code>&lt;br&gt;</code> in javascript, do it in Go: <a href=\"http://play.golang.org/p/jJXMZxtYcv\" rel=\"nofollow\">http://play.golang.org/p/jJXMZxtYcv</a></p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    const tpl = `\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;{{.Title}}&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div&gt;{{nl2br .Text}}&lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;`\n\n    check := func(err error) {\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n\n    funcs := template.FuncMap{\n        \"nl2br\": func(text string) template.HTML {\n            return template.HTML(strings.Replace(template.HTMLEscapeString(text), \"\\n\", \"&lt;br&gt;\", -1))\n        },\n    }\n\n    t, err := template.New(\"webpage\").Funcs(funcs).Parse(tpl)\n    check(err)\n\n    data := struct {\n        Title string\n        Text  string\n    }{\n        Title: \"My page\",\n        Text:  \"\\t\\tLine 1\\r\\nLine2\\r\\n\",\n    }\n\n    err = t.Execute(os.Stdout, data)\n    check(err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1458622705, "post_id": 36117535, "comment_id": 59930424, "body": "Thank you icza. You are a Go hero!"}, {"owner": {"reputation": 2752, "user_id": 140164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c44c58fe1ee2a3189f1fd99a3d73d0d2?s=128&d=identicon&r=PG&f=1", "display_name": "Dipen Bhikadya", "link": "https://stackoverflow.com/users/140164/dipen-bhikadya"}, "edited": false, "score": 0, "creation_date": 1502124836, "post_id": 36117535, "comment_id": 78063757, "body": "Very useful answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1458506751, "last_edit_date": 1592644375, "creation_date": 1458497251, "answer_id": 36117535, "question_id": 36114389, "link": "https://stackoverflow.com/questions/36114389/displaying-line-breaks-produced-by-html-template-in-go-on-gae/36117535#36117535", "title": "Displaying line breaks produced by html/template in Go on GAE", "body": "<p>You can simply solve you issue with CSS formatting, namely the <a href=\"http://www.w3schools.com/cssref/pr_text_white-space.asp\" rel=\"nofollow noreferrer\"><code>white-space</code></a> property:</p>\n<blockquote>\n<p>The white-space property specifies how white-space inside an element is handled.</p>\n<p>CSS Syntax:</p>\n<pre><code>white-space: normal|nowrap|pre|pre-line|pre-wrap|initial|inherit;\n</code></pre>\n</blockquote>\n<p>The <code>pre</code> value acts as if it would be wrapped in an HTML <code>&lt;pre&gt;</code> tag, which would also render the double tabs.</p>\n<p>Using the <code>pre-line</code> value works for you:</p>\n<blockquote>\n<p><code>pre-line</code> Sequences of whitespace will collapse into a single whitespace. Text will wrap when necessary, and on line breaks</p>\n</blockquote>\n<p>So lines are preserved, but multiple whitespaces are collapsed into a single one. Advantage is that you don't need to transform your original text, the browser will apply the proper formatting. Code remains safe against HTML injection attacks.</p>\n<p>Complete example:</p>\n<pre><code>func main() {\n    t := template.Must(template.New(&quot;&quot;).Parse(src))\n    http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) {\n        t.Execute(w, text)\n    })\n    panic(http.ListenAndServe(&quot;localhost:8080&quot;, nil))\n}\n\nconst src = `&lt;html&gt;&lt;body&gt;Entered text:\n&lt;div style=&quot;white-space:pre-line&quot;&gt;{{.}}&lt;/div&gt;\n&lt;/body&gt;&lt;/html&gt;`\n\nconst text = &quot;\\t\\t1st line\\n2nd line\\r\\n3rdline&quot;\n</code></pre>\n<h3>Your initial double tabs <code>\\t\\t</code></h3>\n<p>Note that your initial double tabs <code>\\t\\t</code> are not generated by browsers or form submits (nor the Datastore if you store it there) but are most likely the result of you using a template where you have an indentation of 2 tabs. Indentation of templates is also written to output, so you should properly close your <code>&lt;textarea&gt;</code> without newlines in the template. Since you didn't post your template and code, I can't be more help on finding out why you have initial double tabs, but you should find the root cause and not treat the symptoms.</p>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1357, "favorite_count": 0, "accepted_answer_id": 36114543, "answer_count": 2, "score": 1, "last_activity_date": 1458506751, "creation_date": 1458480888, "last_edit_date": 1458481363, "question_id": 36114389, "link": "https://stackoverflow.com/questions/36114389/displaying-line-breaks-produced-by-html-template-in-go-on-gae", "title": "Displaying line breaks produced by html/template in Go on GAE", "body": "<p>My application is written in Go. A page of the application receives user data from an HTML text area which is saved to Google App Engine datastore as string data. Then, on another page of the application, it requires to display the data in the format that the user typed into the HTML text area or at least preserve the line breaks as the user hit enter key while typing the data into the HTML text field.</p>\n\n<p>I tried to use <code>&lt;pre&gt;</code> tag to display the preserved line breaks that user typed into the text field which worked fine. However, I found that there is a double tab </p>\n\n<blockquote>\n  <p>\\t\\t</p>\n</blockquote>\n\n<p>inserted at the beginning of the string when using the <code>&lt;pre&gt;</code> tag which I could remove the double tab by using Javascript.</p>\n\n<p>My idea to keep the line breaks that users type into the text field is to use javascript replace function to replace all <code>\\r\\n</code>, <code>\\n</code> and <code>\\r</code>to <code>&lt;br&gt;</code>, however, it didn't work out. It seems like Go doesn't output the line breaks into the html source code. I am using \"html/template\" for safety reason but I didn't expect it to remove the <code>\\r\\n</code> characters from its output entirely. And is there any suggestion on the strange double tab <code>\\t\\t</code> at the beginning to the string? </p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1458483766, "post_id": 36113794, "comment_id": 59870387, "body": "what was the output when you pushed to heroku?  Any compile errors or anything?"}, {"owner": {"reputation": 41, "user_id": 653931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e852a41883487244c1e0b1438412c?s=128&d=identicon&r=PG", "display_name": "frankie", "link": "https://stackoverflow.com/users/653931/frankie"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1458496396, "post_id": 36113794, "comment_id": 59875098, "body": "@DavidBudworth: The pushed output was a successful build."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1461323147, "creation_date": 1461323147, "answer_id": 36792143, "question_id": 36113794, "link": "https://stackoverflow.com/questions/36113794/heroku-bash-apiworker-command-not-found/36792143#36792143", "title": "Heroku. bash: apiworker: command not found", "body": "<p>A bit late, but i had the same issue yesterday and what worked for me was re-saving the dependencies.</p>\n\n<p>After moving your mains to cmd, you need to run <code>$ godep save ./cmd/...</code>, this of course then updates your Godeps.json file, but more importatnly it adds/updates the <code>\"Packages\"</code> field in the json, which in turn is used by heroku's buildpack (<a href=\"https://github.com/heroku/heroku-buildpack-go/blob/4fec8b5933aa9f2d55fa262813dc81b21b3bddba/bin/compile#L276\" rel=\"nofollow\">link</a>) to run <code>$ go install</code> and <code>$ godep go install</code> (<a href=\"https://github.com/heroku/heroku-buildpack-go/blob/4fec8b5933aa9f2d55fa262813dc81b21b3bddba/bin/compile#L314-L317\" rel=\"nofollow\">link</a>).</p>\n\n<p>Before I re-saved my dependencies the Godeps.json file did not have a <code>\"Packages\"</code> field and so the buildpack would run <code>$ go install</code> only in the project's root folder and not installing the sources in the cmd folder, which would then result in the <code>command not found</code> error.</p>\n"}], "owner": {"reputation": 41, "user_id": 653931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32e852a41883487244c1e0b1438412c?s=128&d=identicon&r=PG", "display_name": "frankie", "link": "https://stackoverflow.com/users/653931/frankie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1188, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1510077032, "creation_date": 1458477474, "last_edit_date": 1458481196, "question_id": 36113794, "link": "https://stackoverflow.com/questions/36113794/heroku-bash-apiworker-command-not-found", "title": "Heroku. bash: apiworker: command not found", "body": "<p>I'm following this Heroku/Go example <a href=\"https://github.com/heroku-examples/go_queue_example\" rel=\"nofollow\">https://github.com/heroku-examples/go_queue_example</a> for a web and worker app.</p>\n\n<p>Running the app via <strong><em>heroku local</em></strong> works but when deploying to Heroku I get the following <strong><em>command not found errors</em></strong> in the log:</p>\n\n<pre><code>2016-03-20T11:55:51.029091+00:00 heroku[worker.1]: Starting process with command `apiworker`\n2016-03-20T11:55:51.603896+00:00 heroku[worker.1]: State changed from starting to up\n2016-03-20T11:55:52.842882+00:00 app[worker.1]: bash: apiworker: command not found\n2016-03-20T11:55:53.624937+00:00 heroku[worker.1]: Process exited with status 127\n2016-03-20T11:55:53.634515+00:00 heroku[worker.1]: State changed from up to crashed\n2016-03-20T11:58:56.772069+00:00 heroku[web.1]: State changed from crashed to starting\n2016-03-20T11:58:56.986655+00:00 heroku[web.1]: Starting process with command `apiweb`\n2016-03-20T11:58:58.389926+00:00 app[web.1]: bash: apiweb: command not found\n2016-03-20T11:58:59.060779+00:00 heroku[web.1]: State changed from starting to crashed\n2016-03-20T11:58:59.049447+00:00 heroku[web.1]: Process exited with status 127\n</code></pre>\n\n<p>The Procfile:</p>\n\n<pre><code>web: apiweb\nworker: apiworker\n</code></pre>\n\n<p>The project structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 Godeps\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Godeps.json\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Readme\n\u251c\u2500\u2500 Procfile\n\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 apiweb\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 main.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 apiworker\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 main.go\n\u251c\u2500\u2500 vendor\n&lt;snip&gt;\n\u2514\u2500\u2500 api.go\n</code></pre>\n\n<p>Surprisingly, I've had little success with searching for answers in the documentation, here, and elsewhere. Any help would be greatly appreciated!</p>\n"}, {"tags": ["go", "network-programming", "server"], "answers": [{"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": false, "score": 3, "last_activity_date": 1458477012, "creation_date": 1458477012, "answer_id": 36113708, "question_id": 36113474, "link": "https://stackoverflow.com/questions/36113474/go-server-get-non-empty-net-conn/36113708#36113708", "title": "Go server : get non-empty net.Conn", "body": "<p>I don't think you can.</p>\n\n<p>If you try to read from the <code>net.Conn</code> with its <code>Read</code> method, it will block until there is data. So just start a goroutine for each <code>net.Conn</code>, and read from it in the goroutine.</p>\n\n<p>The example in the net package's documentation does exactly that: <a href=\"https://golang.org/pkg/net/#example_Listener\" rel=\"nofollow\">https://golang.org/pkg/net/#example_Listener</a></p>\n"}], "owner": {"reputation": 139, "user_id": 6012741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82dcf2f373ba13f33480d7b4e6b49022?s=128&d=identicon&r=PG&f=1", "display_name": "StrangeCube", "link": "https://stackoverflow.com/users/6012741/strangecube"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458477012, "creation_date": 1458475709, "question_id": 36113474, "link": "https://stackoverflow.com/questions/36113474/go-server-get-non-empty-net-conn", "title": "Go server : get non-empty net.Conn", "body": "<p>I have server with several net.Conn. How can I get list of net.Conn which have unreaded messages (without using active waiting) ?</p>\n"}, {"tags": ["multithreading", "go", "nonblocking"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 5, "creation_date": 1458492988, "post_id": 36112564, "comment_id": 59873764, "body": "I would add that the Go runtime scheduler currently (Go 1.6 and below) multiplexes (epoll on Linux, IOCPs on Windows etc) only network I/O syscalls. All I/O syscalls which hit disk, serial etc occupy a single OS thread each. Whether this is good or bad is debatable in the Go developers&#39; community. The current concensus seems to be that it would be nice to have general async I/O available to the user but from the practical standpoint it&#39;s not really <i>that</i> useful..."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1458493090, "post_id": 36112564, "comment_id": 59873792, "body": "...as in -- if you have 1000 goroutines writing to the same disk drive at the same time async I/O won&#39;t really help; use a dedicated writer and a buffered channel.  On a side note: 3rd-party packages exposing the underlying OS&#39;s async/poller interface do exist."}, {"owner": {"reputation": 2246, "user_id": 7529562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LvzXUtUqo1I/AAAAAAAAAAI/AAAAAAAAAAo/5pNfpegHXAE/photo.jpg?sz=128", "display_name": "nuclear", "link": "https://stackoverflow.com/users/7529562/nuclear"}, "edited": false, "score": 0, "creation_date": 1568616497, "post_id": 36112564, "comment_id": 102315513, "body": "I find discussion about <code>file io epoll</code>. <a href=\"https://github.com/golang/go/issues/18507\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/18507</a>, and also have another pr <a href=\"https://github.com/golang/go/commit/c05b06a12d005f50e4776095a60d6bd9c2c91fac\" rel=\"nofollow noreferrer\">github.com/golang/go/commit/&hellip;</a>. I think two posts will solve your question about <code>no blocking io on file and network, when golang makes thread blocking?</code>"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 45, "last_activity_date": 1458484970, "last_edit_date": 1458484970, "creation_date": 1458469438, "answer_id": 36112564, "question_id": 36112445, "link": "https://stackoverflow.com/questions/36112445/golang-blocking-and-non-blocking/36112564#36112564", "title": "Golang blocking and non blocking", "body": "<p>Go has a scheduler that lets you write synchronous code, and does context switching on its own and uses async IO under the hood. So if you're running several goroutines, they might run on a single system thread, and when your code is blocking from the goroutine's view, it's not really blocking. It's not magic, but yes, it masks all this stuff from you.</p>\n\n<p>The scheduler will allocate system threads when they're needed, and during operations that are really blocking (I think file IO is blocking for example, or calling C code). But if you're doing some simple http server, you can have thousands and thousands of goroutine using actually a handful of \"real threads\". </p>\n\n<p>You can read more about the inner workings of Go here: </p>\n\n<p><a href=\"https://morsmachine.dk/go-scheduler\">https://morsmachine.dk/go-scheduler</a></p>\n"}, {"comments": [{"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 2, "creation_date": 1458498535, "post_id": 36117724, "comment_id": 59875958, "body": "I think there is a semantic problem with the word &quot;block&quot; here, if the Go routine yields and can be awaken later, then there has to be something inside that code that makes that work, e.g. continuation passing style or something like that. no?  so it acts as if it is blocking, but behind the scenes it yields execution and is later awaken and continues?  I assume if I have a never ending for loop inside a Go routine, that Go routine could never yeild and the thread currently running the Go routine is forever blocked, right?  If that is not the case then I am completely confused here."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 2, "creation_date": 1458499306, "post_id": 36117724, "comment_id": 59876220, "body": "You should read @Not_a_Golfer answer first and the link he provided to understand how goroutines are scheduled. My answer is more like a dipper dive into network IO specifically. Yes, the meaning of &quot;block&quot; depends on the context. From the programmers point of view it does block. Your code blocks and doesn&#39;t continue until call returns. From the point of view of the runtime it yields execution. That&#39;s why I called it parking - that&#39;s a real term used in Go. It&#39;s cooperative multitasking and infinite loop does block goroutine and the OS thread forever because it will never yield execution."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1458499323, "post_id": 36117724, "comment_id": 59876223, "body": "@RogerAlsing yes, if a goroutine never does anything that &quot;blocks&quot;, and never calls <code>runtime.Gosched</code> (which is an explicit scheduler yield) it will occupy its P indefinitely, preventing other goroutines from running on it."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1458499530, "post_id": 36117724, "comment_id": 59876298, "body": "@RogerAlsing for more on that topic, <a href=\"http://stackoverflow.com/questions/35471480/does-go-block-on-processor-intensive-operations-like-node/35471842#35471842\" title=\"does go block on processor intensive operations like node\">stackoverflow.com/questions/35471480/&hellip;</a>"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1458499752, "post_id": 36117724, "comment_id": 59876380, "body": "And please explain -1. I understand that my answer can be confusing to someone who doesn&#39;t know how Go works inside. But I didn&#39;t plan to explain everything. I specifically chose networking IO which is implemented very differently."}, {"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1458499937, "post_id": 36117724, "comment_id": 59876440, "body": "I am not the one downvoting answers here"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1458500329, "post_id": 36117724, "comment_id": 59876554, "body": "@RogerAlsing, sorry, didn&#39;t mean to ask you personally. Too late to edit now."}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": false, "score": 28, "last_activity_date": 1579090310, "last_edit_date": 1579090310, "creation_date": 1458498187, "answer_id": 36117724, "question_id": 36112445, "link": "https://stackoverflow.com/questions/36112445/golang-blocking-and-non-blocking/36117724#36117724", "title": "Golang blocking and non blocking", "body": "<p>You should read @Not_a_Golfer answer first and the link he provided to understand how goroutines are scheduled. My answer is more like a deeper dive into network IO specifically. I assume you understand how Go achieves cooperative multitasking.</p>\n\n<p>Go can and does use only blocking calls because everything runs in goroutines and they're not real OS threads. They're green threads. So you can have many of them all blocking on IO calls and they will not eat all of your memory and CPU like OS threads would.</p>\n\n<p>File IO is just syscalls. Not_a_Golfer already covered that. Go will use real OS thread to wait on a syscall and will unblock the goroutine when it returns. <a href=\"https://golang.org/src/os/file_unix.go?s=#L224\" rel=\"noreferrer\">Here</a> you can see file <code>read</code> implementation for Unix.</p>\n\n<p>Network IO is different. The runtime uses \"network poller\" to determine which goroutine should unblock from IO call. Depending on the target OS it will use available asynchronous APIs to wait for network IO events. Calls look like blocking but inside everything is done asynchronously.</p>\n\n<p>For example, when you call <code>read</code> on TCP socket goroutine first will try to read using syscall. If nothing is arrived yet it will block and wait for it to be resumed. By blocking here I mean parking which puts the goroutine in a queue where it awaits resuming. That's how \"blocked\" goroutine yields execution to other goroutines when you use network IO.</p>\n\n<pre><code>func (fd *netFD) Read(p []byte) (n int, err error) {\n    if err := fd.readLock(); err != nil {\n        return 0, err\n    }\n    defer fd.readUnlock()\n    if err := fd.pd.PrepareRead(); err != nil {\n        return 0, err\n    }\n    for {\n        n, err = syscall.Read(fd.sysfd, p)\n        if err != nil {\n            n = 0\n            if err == syscall.EAGAIN {\n                if err = fd.pd.WaitRead(); err == nil {\n                    continue\n                }\n            }\n        }\n        err = fd.eofError(n, err)\n        break\n    }\n    if _, ok := err.(syscall.Errno); ok {\n        err = os.NewSyscallError(\"read\", err)\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/src/net/fd_unix.go?s=#L237\" rel=\"noreferrer\">https://golang.org/src/net/fd_unix.go?s=#L237</a></p>\n\n<p>When data arrives network poller will return goroutines that should be resumed. You can see <a href=\"https://golang.org/src/runtime/proc.go?s=#L1795\" rel=\"noreferrer\">here</a> <code>findrunnable</code> function that searches for goroutines that can be run. It calls <code>netpoll</code> function which will return goroutines that can be resumed. You can find <code>kqueue</code> implementation of <code>netpoll</code> <a href=\"https://golang.org/src/runtime/netpoll_kqueue.go?s=#L64\" rel=\"noreferrer\">here</a>.</p>\n\n<p>As for async/wait in C#. async network IO will also use asynchronous APIs (IO completion ports on Windows). When something arrives OS will execute callback on one of the threadpool's completion port threads which will put continuation on the current <code>SynchronizationContext</code>. In a sense, there are some similarities (parking/unparking does looks like calling continuations but on a much lower level) but these models are very different, not to mention the implementations. Goroutines by default are not bound to a specific OS thread, they can be resumed on any one of them, it doesn't matter. There're no UI threads to deal with. Async/await are specifically made for the purpose of resuming the work on the same OS thread using <code>SynchronizationContext</code>. And because there're no green threads or a separate scheduler async/await have to split your function into multiple callbacks that get executed on <code>SynchronizationContext</code> which is basically an infinite loop that checks a queue of callbacks that should be executed. You can even implement it yourself, it's really easy.</p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 7529562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-LvzXUtUqo1I/AAAAAAAAAAI/AAAAAAAAAAo/5pNfpegHXAE/photo.jpg?sz=128", "display_name": "nuclear", "link": "https://stackoverflow.com/users/7529562/nuclear"}, "is_accepted": false, "score": -2, "last_activity_date": 1568616731, "creation_date": 1568616731, "answer_id": 57951690, "question_id": 36112445, "link": "https://stackoverflow.com/questions/36112445/golang-blocking-and-non-blocking/57951690#57951690", "title": "Golang blocking and non blocking", "body": "<p>There are some <code>issues</code> and <code>pull request</code> may be help you :)</p>\n\n<p>It maybe solve some questions like</p>\n\n<ol>\n<li>When golang will blocking IO operation?</li>\n<li><p>Why golang only use <code>async io</code> for <code>socket</code> instead of <code>normal file</code>?</p>\n\n<p><a href=\"https://github.com/golang/go/issues/18507\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/18507</a>\n<a href=\"https://github.com/golang/go/commit/c05b06a12d005f50e4776095a60d6bd9c2c91fac\" rel=\"nofollow noreferrer\">https://github.com/golang/go/commit/c05b06a12d005f50e4776095a60d6bd9c2c91fac</a>\n<a href=\"https://github.com/golang/go/issues/6222\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/6222</a>\n<a href=\"https://github.com/golang/go/issues/6817\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/6817</a>\n<a href=\"https://stackoverflow.com/questions/8057892/epoll-on-regular-files\">Epoll on regular files</a></p></li>\n</ol>\n"}], "owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27261, "favorite_count": 15, "accepted_answer_id": 36112564, "answer_count": 3, "score": 41, "last_activity_date": 1579090310, "creation_date": 1458468590, "question_id": 36112445, "link": "https://stackoverflow.com/questions/36112445/golang-blocking-and-non-blocking", "title": "Golang blocking and non blocking", "body": "<p>I am somewhat confused over how Go handles non blocking IO.\nAPI's mostly look synchronous to me, and when watching presentations on Go, its not uncommon to hear comments like \"and the call blocks\"</p>\n\n<p>Is Go using blocking IO when reading from files or network?\nOr is there some kind of magic that re-writes the code when used from inside a Go Routine?</p>\n\n<p>Coming from a C# background, this feels very non intuitive, in C# we have the <code>await</code> keyword when consuming async API's.\nWhich clearly communicates that the API can yield the current thread and continue later inside a continuation.</p>\n\n<p>So TLDR;\nWill Go block the current thread when doing IO inside a Go routine, or will it be transformed into a C# like async await state machine using continuations?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": true, "score": 3, "last_activity_date": 1458477280, "creation_date": 1458477280, "answer_id": 36113767, "question_id": 36112133, "link": "https://stackoverflow.com/questions/36112133/use-go-rice-with-http-servefile/36113767#36113767", "title": "Use go.rice with http.ServeFile()", "body": "<p>You could use <a href=\"https://golang.org/pkg/net/http/#ServeContent\" rel=\"nofollow\">http.ServeContent</a> instead.\nGet a <a href=\"https://godoc.org/github.com/GeertJohan/go.rice#Box.HTTPBox\" rel=\"nofollow\">HTTPBox</a> and use  <a href=\"https://godoc.org/github.com/GeertJohan/go.rice#HTTPBox.Open\" rel=\"nofollow\">HTTPBox.Open</a> to get a http.File, which implements io.ReadSeeker, so it can be used with ServeContent.</p>\n\n<p>Alternatively, you could use <a href=\"https://godoc.org/github.com/GeertJohan/go.rice#HTTPBox\" rel=\"nofollow\">HTTPBox</a> with http.FileServer, as suggested in the documentation of go.rice (http.FileServer will get the path of the request, and use that as a filename to find the file in the box.)</p>\n"}, {"tags": [], "owner": {"reputation": 502, "user_id": 4230278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d136a2cc45e141b0a04fcd192498510e?s=128&d=identicon&r=PG&f=1", "display_name": "chrphb", "link": "https://stackoverflow.com/users/4230278/chrphb"}, "is_accepted": false, "score": 2, "last_activity_date": 1458477989, "creation_date": 1458477989, "answer_id": 36113863, "question_id": 36112133, "link": "https://stackoverflow.com/questions/36112133/use-go-rice-with-http-servefile/36113863#36113863", "title": "Use go.rice with http.ServeFile()", "body": "<p>There is actually a very simple and short solution to achieve what you want:</p>\n\n<pre><code>func main() {\n box := rice.MustFindBox(\"../../static\")\n http.Handle(\"/\", http.FileServer(box.HTTPBox()))\n http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "accepted_answer_id": 36113767, "answer_count": 2, "score": 2, "last_activity_date": 1458477989, "creation_date": 1458466409, "question_id": 36112133, "link": "https://stackoverflow.com/questions/36112133/use-go-rice-with-http-servefile", "title": "Use go.rice with http.ServeFile()", "body": "<p>Maybe I'm looking at the wrong places, but I cannot find an example of using go.rice with <code>http.ServeFile()</code>. Basically what I want is serve a boxed file with <code>http.ServeFile()</code>. What I have now is the following. As you can see I'm looking for a way to get the string location of a boxed file, since http.ServeFile requires that. I don't know how to get it. Any suggestions?</p>\n\n<pre><code>var StaticBox *rice.Box\n\nfunc NewStaticBox() {\n    StaticBox = rice.MustFindBox(\"../../static\")\n}\n\nfunc Static(req *http.Request, resp *http.Response) {\n    stringToBoxedFile := WHAT-TO-DO-HERE\n    http.ServeFile(req, resp, stringToBoxedFile)\n}\n</code></pre>\n\n<p>I can use the rice.box in various ways. I can get a file contents as a string with <code>StaticBox.String()</code>, etc. But now I want a string as a \"location\" to a boxed file.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 3, "creation_date": 1458463721, "post_id": 36111777, "comment_id": 59864795, "body": "The result of the function above outputs &amp;{0xc082016240}"}], "answers": [{"comments": [{"owner": {"reputation": 1335, "user_id": 1527290, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c90b45a5bde3f27dcffe26ef54760faf?s=128&d=identicon&r=PG", "display_name": "Cristian Chaparro A.", "link": "https://stackoverflow.com/users/1527290/cristian-chaparro-a"}, "edited": false, "score": 1, "creation_date": 1477584632, "post_id": 36111861, "comment_id": 67837117, "body": "you miss the import <code>bufio</code> and it should be <code>bufio.NewScanner(file)</code> instead of <code>bufio.NewScanner(fd)</code>, and the other hand, it works perfectly!! thank you."}, {"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "reply_to_user": {"reputation": 1335, "user_id": 1527290, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c90b45a5bde3f27dcffe26ef54760faf?s=128&d=identicon&r=PG", "display_name": "Cristian Chaparro A.", "link": "https://stackoverflow.com/users/1527290/cristian-chaparro-a"}, "edited": false, "score": 0, "creation_date": 1477584991, "post_id": 36111861, "comment_id": 67837337, "body": "@CristianChaparroA. It&#39;s been fixed! thank you :)"}, {"owner": {"reputation": 52680, "user_id": 1673391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d0fdf8fc4fd7daa19b20cd3f76d2a1e0?s=128&d=identicon&r=PG", "display_name": "Grijesh Chauhan", "link": "https://stackoverflow.com/users/1673391/grijesh-chauhan"}, "edited": false, "score": 1, "creation_date": 1536890275, "post_id": 36111861, "comment_id": 91595121, "body": "The very helpful answer, though I have the question:- do we need slicing in <code>buf[:n]</code> in the statement <code>fmt.Print(buf[:n])</code>.  ....For me just  <code>fmt.Print(buf)</code> worked well. ............"}, {"owner": {"reputation": 1148, "user_id": 5067875, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SeC0a.jpg?s=128&g=1", "display_name": "Flyq", "link": "https://stackoverflow.com/users/5067875/flyq"}, "edited": false, "score": 0, "creation_date": 1607761149, "post_id": 36111861, "comment_id": 115378481, "body": "<code>f.Close()</code> change to <code>file.Close()</code>"}], "tags": [], "owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "is_accepted": true, "score": 113, "last_activity_date": 1616106822, "last_edit_date": 1616106822, "creation_date": 1458464381, "answer_id": 36111861, "question_id": 36111777, "link": "https://stackoverflow.com/questions/36111777/how-to-read-a-text-file/36111861#36111861", "title": "How to read a text file?", "body": "<p>It depends on what you are trying to do.</p>\n<pre><code>file, err := os.Open(&quot;file.txt&quot;)\nfmt.print(file)\n</code></pre>\n<p>The reason it outputs &amp;{0xc082016240}, is because you are printing the pointer value of a file-descriptor (<code>*os.File</code>), not file-content. To obtain file-content, you may <code>READ</code> from a file-descriptor.</p>\n<hr />\n<p>To read all file content(in bytes) to memory, <code>ioutil.ReadAll</code></p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;os&quot;\n    &quot;log&quot;\n)\n\nfunc main() {\n    file, err := os.Open(&quot;file.txt&quot;)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer func() {\n        if err = file.Close(); err != nil {\n            log.Fatal(err)\n        }\n    }()\n\n\n  b, err := ioutil.ReadAll(file)\n  fmt.Print(b)\n}\n</code></pre>\n<p>But sometimes, if the  file size is big, it might be more memory-efficient to just read in chunks: buffer-size, hence you could use the implementation of <code>io.Reader.Read</code> from <code>*os.File</code></p>\n<pre><code>func main() {\n    file, err := os.Open(&quot;file.txt&quot;)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer func() {\n        if err = file.Close(); err != nil {\n            log.Fatal(err)\n        }\n    }()\n\n\n    buf := make([]byte, 32*1024) // define your buffer size here.\n\n    for {\n        n, err := file.Read(buf)\n\n        if n &gt; 0 {\n            fmt.Print(buf[:n]) // your read buffer.\n        }\n\n        if err == io.EOF {\n            break\n        }\n        if err != nil {\n            log.Printf(&quot;read %d bytes: %v&quot;, n, err)\n            break\n        }\n    }\n\n}\n</code></pre>\n<p>Otherwise, you could also use the standard util package: <code>bufio</code>, try <code>Scanner</code>. A <code>Scanner</code> reads your file in tokens: separator.</p>\n<p>By default, scanner advances the token by newline (of course you can customise how scanner should tokenise your file, learn from here <a href=\"https://golang.org/src/bufio/example_test.go\" rel=\"nofollow noreferrer\">the bufio test</a>).</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;os&quot;\n    &quot;log&quot;\n    &quot;bufio&quot;\n)\n\nfunc main() {\n    file, err := os.Open(&quot;file.txt&quot;)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer func() {\n        if err = file.Close(); err != nil {\n            log.Fatal(err)\n        }\n    }()\n\n    scanner := bufio.NewScanner(file)\n\n    for scanner.Scan() {             // internally, it advances token based on sperator\n        fmt.Println(scanner.Text())  // token in unicode-char\n        fmt.Println(scanner.Bytes()) // token in bytes\n\n    }\n}\n</code></pre>\n<p>Lastly, I would also like to reference you to this awesome site: <a href=\"http://www.devdungeon.com/content/working-files-go\" rel=\"nofollow noreferrer\">go-lang file cheatsheet</a>. It encompassed pretty much everything related to working with files in go-lang, hope you'll find it useful.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126097, "favorite_count": 17, "closed_date": 1531518506, "accepted_answer_id": 36111861, "answer_count": 1, "score": 94, "last_activity_date": 1616106822, "creation_date": 1458463656, "last_edit_date": 1582393089, "question_id": 36111777, "link": "https://stackoverflow.com/questions/36111777/how-to-read-a-text-file", "closed_reason": "Duplicate", "title": "How to read a text file?", "body": "<p>I'm trying to read \"file.txt\" and put the contents into a variable using Golang. Here is what I've tried...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"log\"\n)\n\nfunc main() {\n    file, err := os.Open(\"file.txt\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Print(file)\n}\n</code></pre>\n\n<p>The file gets read successfully and the return from <em>os.Open</em> returns a type of <strong>*os.File</strong></p>\n"}, {"tags": ["go", "boltdb"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1458506443, "post_id": 36111698, "comment_id": 59878745, "body": "This seems like the perfect use-case for SQLite; BoltDB is great, but you will have to jump through a few (error prone) hoops to get this to work."}], "answers": [{"tags": [], "owner": {"reputation": 631, "user_id": 819809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bTZ8c.jpg?s=128&g=1", "display_name": "Ernado", "link": "https://stackoverflow.com/users/819809/ernado"}, "is_accepted": false, "score": 1, "last_activity_date": 1458487302, "creation_date": 1458487302, "answer_id": 36115609, "question_id": 36111698, "link": "https://stackoverflow.com/questions/36111698/using-two-separate-keys-in-boltdb/36115609#36115609", "title": "using two separate keys in BoltDB", "body": "<p>There is no secondary key indexing in BoltDB, but you can implement it.</p>\n\n<p>You can store ID to LoginName mapping in another bucket, and it will be technically the \"secondary key\" for your struct. That is, first obtain the primary key value from the secondary key, and then the User struct.</p>\n\n<p>If most of your calls are on LoginName key, use LoginName to ID mapping and store User struct under LoginName key and vice versa.</p>\n\n<p>Be careful: you have to maintain consistency by your own, remember it.</p>\n"}, {"comments": [{"owner": {"reputation": 108, "user_id": 3806611, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e7778fb6ae5123e8296bd627d4f927f?s=128&d=identicon&r=PG", "display_name": "skariel", "link": "https://stackoverflow.com/users/3806611/skariel"}, "edited": false, "score": 0, "creation_date": 1458509857, "post_id": 36116471, "comment_id": 59879906, "body": "yep. this is what I did"}], "tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": true, "score": 1, "last_activity_date": 1458491926, "creation_date": 1458491926, "answer_id": 36116471, "question_id": 36111698, "link": "https://stackoverflow.com/questions/36111698/using-two-separate-keys-in-boltdb/36116471#36116471", "title": "using two separate keys in BoltDB", "body": "<p>No, it's not there.  BoltDB is a lot like Go.  Clean and simple.  And building a layer on top is easy.  BoltDB even allows update transactions to be trivially implemented so two more more buckets can be updated, or not, atomically.  So creating an update transaction that keeps two or more buckets in sync is easy.  But it sounds like you know that and just wanted to check that you aren't missing something.</p>\n"}], "owner": {"reputation": 108, "user_id": 3806611, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e7778fb6ae5123e8296bd627d4f927f?s=128&d=identicon&r=PG", "display_name": "skariel", "link": "https://stackoverflow.com/users/3806611/skariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 36116471, "answer_count": 2, "score": 1, "last_activity_date": 1458491926, "creation_date": 1458462949, "question_id": 36111698, "link": "https://stackoverflow.com/questions/36111698/using-two-separate-keys-in-boltdb", "title": "using two separate keys in BoltDB", "body": "<p>I have a <code>User</code> struct with <code>ID</code> and <code>LoginName</code> fields and I want this struct to be accessible by either of these fields with single call to the DB. I know BoltDB is not supposed to handle arbitrary field indexing etc. (unlike SQL) but this case is a little different as I happen to know in advance the additional field to b used as index.</p>\n\n<p>So is there some kind of secondary key or multiple key indexing? or maybe some strategy that I fail to see? If not then I'll just implement it with two calls, I just prefer a \"cleaner\" solution...</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1458452680, "post_id": 36110601, "comment_id": 59862868, "body": "are you looking for <code>Sprintf</code>?"}, {"owner": {"reputation": 9424, "user_id": 1248913, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ced76ce8952257b480f8b1c96ab0a79?s=128&d=identicon&r=PG", "display_name": "Roy Lee", "link": "https://stackoverflow.com/users/1248913/roy-lee"}, "edited": false, "score": 1, "creation_date": 1458467344, "post_id": 36110601, "comment_id": 59865623, "body": "there is an awesome video that I would also like to reference to you, its about how-to-database in golang: <a href=\"https://www.youtube.com/watch?v=m879N2rzn2g\" rel=\"nofollow noreferrer\">youtube.com/watch?v=m879N2rzn2g</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1458453076, "post_id": 36110656, "comment_id": 59862911, "body": "in case you&#39;re brand new to this, SQL injection is giving a specially-crafted value to the query that terminates and runs another command, e.g. <code>1; DROP TABLE tableA</code>. Now when you&#39;re running your seemingly benign select query, it actually drops your table."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1458453503, "post_id": 36110656, "comment_id": 59862979, "body": "@jniedrauer that works great! But that&#39;s the opposite of what you&#39;re doing :). Any production SQL API will have injection-proof interpolation options. Doing it within the language (even in Python as you&#39;ve done above) is prone to injection."}, {"owner": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "edited": false, "score": 0, "creation_date": 1458453662, "post_id": 36110656, "comment_id": 59863006, "body": "Taken from bobby-tables.com:  <code># Do NOT do it this way.</code> <code>cmd = &quot;update people set name=&#39;%s&#39; where id=&#39;%s&#39;&quot; % (name, id)</code> <code>curs.execute(cmd)</code>  <code>#Instead, do this:</code> <code>cmd = &quot;update people set name=%s where id=%s&quot;</code> <code>curs.execute(cmd, (name, id))</code>  But I don&#39;t see a way to do that with Go&#39;s MyMySQL. Maybe I just didn&#39;t RTFM hard enough. I cast the user input as an integer specifically to prevent injection before this snipped of code. I guess I really just need to know the right way to write a text query in MyMySQL..."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "edited": false, "score": 1, "creation_date": 1458453676, "post_id": 36110656, "comment_id": 59863008, "body": "@jniedrauer see the docs for <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\"><code>database&#47;sql&#47;DB.Query</code></a>. You pass the arguments to the query itself, you don&#39;t interpolate the string by hand."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "edited": false, "score": 0, "creation_date": 1458454428, "post_id": 36110656, "comment_id": 59863134, "body": "@jniedrauer I added an example to my answer. Try that out"}, {"owner": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "edited": false, "score": 1, "creation_date": 1458455170, "post_id": 36110656, "comment_id": 59863246, "body": "Now I feel like an idiot. It works. Databases everywhere thank you for keeping them safe."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 7, "last_activity_date": 1458453823, "last_edit_date": 1458453823, "creation_date": 1458452881, "answer_id": 36110656, "question_id": 36110601, "link": "https://stackoverflow.com/questions/36110601/correct-way-to-write-a-text-sql-query-in-go/36110656#36110656", "title": "Correct way to write a text SQL query in Go", "body": "<p>&lt; standard admonishment about using string interpolation with SQL statements because of injection vulnerabilities ></p>\n\n<p>You can use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"noreferrer\"><code>fmt.Sprintf</code></a> to handle this.</p>\n\n<pre><code>query := fmt.Sprintf(`SELECT columnA FROM tableA WHERE columnB = %d AND columnB = %s`,\n                     someNumber, someString)\n</code></pre>\n\n<p>To avoid injection issues, write your first code as:</p>\n\n<pre><code>query := `SELECT column_name FROM table_name\n    WHERE column1_name = %d AND column2_name = %d`\n\nrows, err := db.Query(query, val1, val2)\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 6044659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcR8I.png?s=128&g=1", "display_name": "Josiah Niedrauer", "link": "https://stackoverflow.com/users/6044659/josiah-niedrauer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3363, "favorite_count": 1, "accepted_answer_id": 36110656, "answer_count": 1, "score": 5, "last_activity_date": 1458454112, "creation_date": 1458452290, "last_edit_date": 1458454112, "question_id": 36110601, "link": "https://stackoverflow.com/questions/36110601/correct-way-to-write-a-text-sql-query-in-go", "title": "Correct way to write a text SQL query in Go", "body": "<p>I can't find a good example of the right way to concat the string portion of a text query with the values. For example:</p>\n\n<pre><code>query := `SELECT column_name FROM table_name\n        WHERE column1_name = %d AND column2_name = %d` % (val1, val2)\nrows, res, err := db.Query(query)\n</code></pre>\n\n<p>This doesn't work. The compiler returns <code>syntax error: unexpected comma, expecting )</code>\nLikely because I'm trying to use a python style tuple.</p>\n\n<p>If I rewrite it as</p>\n\n<pre><code>query := `SELECT column_name FROM table_name\n        WHERE column1_name = %d AND column2_name = %d` % val1\n</code></pre>\n\n<p>I get <code>(mismatched types string and int)</code> which tells me that the tuple was ONE OF the problems.</p>\n\n<p>If I cast my parameters as strings first, I get <code>(operator % not defined on string)</code></p>\n\n<p>In python, you'd do something like</p>\n\n<pre><code>query = \"\"\"SELECT column_name FROM table_name\n    WHERE column1_name = %d\n    AND column2_name = %d\"\"\" % (val1, val2)\n</code></pre>\n\n<p>OR</p>\n\n<pre><code>query = \"\"\"SELECT column_name FROM table_name\n    WHERE column1_name = %s\n    AND column2_name = %s\"\"\" % (val1_string, val2_string)\n</code></pre>\n\n<p>I know I could just cast the values as strings and concat with <code>\"STRING\" + var + \"STRING\"</code>, but that seems really messy compared to the python version. What's the equivalent of that python code in Go? Specifically including the tuple portion, and concatenating a string and an integer.</p>\n"}, {"tags": ["pointers", "go"], "answers": [{"comments": [{"owner": {"reputation": 5438, "user_id": 1944335, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8675e8c601fc98c0ad3a8272b417d0de?s=128&d=identicon&r=PG&f=1", "display_name": "James Taylor", "link": "https://stackoverflow.com/users/1944335/james-taylor"}, "edited": false, "score": 0, "creation_date": 1458444607, "post_id": 36109919, "comment_id": 59861718, "body": "Ahhh I don&#39;t know why I didn&#39;t think of that sooner. I thought <code>defer()</code> was called on error or something. Thank you!"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1458460039, "post_id": 36109919, "comment_id": 59864134, "body": "you don&#39;t need to name the return value. The variable fp you create there is shadowed by the variable fp you create when you call <code>fp, err := os.Create(name)</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1458462493, "post_id": 36109919, "comment_id": 59864557, "body": "@user1431317: Your claim that <code>fp, err := os.Create(name)</code> creates a  variable <code>fp</code> is false. <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">Short variable declarations</a>: Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new. Redeclaration does not introduce a new variable; it just assigns a new value to the original."}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1458466340, "post_id": 36109919, "comment_id": 59865386, "body": "You&#39;re right, because they&#39;re in the same block. But you still don&#39;t need to name it."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1458444932, "last_edit_date": 1458444932, "creation_date": 1458444472, "answer_id": 36109919, "question_id": 36109887, "link": "https://stackoverflow.com/questions/36109887/returning-file-pointer-in-golang/36109919#36109919", "title": "Returning File Pointer in Golang", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"noreferrer\">Defer statements</a></p>\n  \n  <p>A \"defer\" statement invokes a function whose execution is deferred to\n  the moment the surrounding function returns, either because the\n  surrounding function executed a return statement, reached the end of\n  its function body, or because the corresponding goroutine is\n  panicking.</p>\n  \n  <p>Each time a \"defer\" statement executes, the function value and\n  parameters to the call are evaluated as usual and saved anew but the\n  actual function is not invoked. Instead, deferred functions are\n  invoked immediately before the surrounding function returns, in the\n  reverse order they were deferred. If a deferred function value\n  evaluates to nil, execution panics when the function is invoked, not\n  when the \"defer\" statement is executed.</p>\n  \n  <p>For instance, if the deferred function is a function literal and the\n  surrounding function has named result parameters that are in scope\n  within the literal, the deferred function may access and modify the\n  result parameters before they are returned. If the deferred function\n  has any return values, they are discarded when the function completes.</p>\n</blockquote>\n\n<pre><code>func OpenOutputFile(name string) (fp *os.File) {\n    fp, err := os.Create(name)\n    if err != nil {\n        panic(err)\n    }\n\n    defer func() {\n        if err := fp.Close(); err != nil {\n            panic(err)\n        }\n    }()\n\n    return fp\n}\n</code></pre>\n\n<p>You open the file</p>\n\n<pre><code>fp, err := os.Create(name)\n</code></pre>\n\n<p>You close the file</p>\n\n<pre><code>err := fp.Close()\n</code></pre>\n\n<p>After the <code>Close</code>, <code>fp</code> no longer points to a valid file descriptor.</p>\n"}], "owner": {"reputation": 5438, "user_id": 1944335, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8675e8c601fc98c0ad3a8272b417d0de?s=128&d=identicon&r=PG&f=1", "display_name": "James Taylor", "link": "https://stackoverflow.com/users/1944335/james-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7270, "favorite_count": 1, "accepted_answer_id": 36109919, "answer_count": 1, "score": 6, "last_activity_date": 1458444932, "creation_date": 1458444175, "question_id": 36109887, "link": "https://stackoverflow.com/questions/36109887/returning-file-pointer-in-golang", "title": "Returning File Pointer in Golang", "body": "<p>I'm still struggling with the basics of Golang.</p>\n\n<p>Consider the following sample code:</p>\n\n<pre><code>func OpenOutputFile(name string) (fp *os.File) {\n  fp, err := os.Create(name)\n  if err != nil {\n      panic(err)\n  }\n\n  defer func() {\n      if err := fp.Close(); err != nil {\n          panic(err)\n      }\n  }()\n\n  return fp\n}\n</code></pre>\n\n<p>I would assume that calling:</p>\n\n<pre><code>fp := OpenOutputFile(\"output.txt\")\n</code></pre>\n\n<p>would now make <code>fp</code> a file pointer (<code>*os.File</code>), so that I could call a statement like:</p>\n\n<pre><code>io.WriteString(fp, \"Hello World\")\n</code></pre>\n\n<p>In another function. But when calling this method, the error is generated:</p>\n\n<pre><code>0 write output.txt: bad file descriptor\n</code></pre>\n\n<p>So it appears that the pointer returned is not valid. How can I return a properly formed pointer to use with <code>io.WriteString</code>?</p>\n\n<p>I appreciate the help!</p>\n\n<p>Of note: Everything executes as intended when the creation of the file pointer and the writing to the file pointer exists in the same method. Breaking the logic into a function causes it to not behave as intended.</p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6088075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e42d8c1d650a9b7f78a597efd41d6f87?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/6088075/jon"}, "edited": false, "score": 0, "creation_date": 1458441611, "post_id": 36109398, "comment_id": 59861223, "body": "Ok peter! Thanks a lot! Your the best"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1458439703, "last_edit_date": 1458439703, "creation_date": 1458438619, "answer_id": 36109398, "question_id": 36109239, "link": "https://stackoverflow.com/questions/36109239/when-i-dont-use-the-go-keyword-a-function-doesnt-work/36109398#36109398", "title": "When I don&#39;t use the go keyword a function doesn&#39;t work", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Send_statements\" rel=\"nofollow\">Send statements</a></p>\n  \n  <p>A send statement sends a value on a channel. The channel expression\n  must be of channel type, the channel direction must permit send\n  operations, and the type of the value to be sent must be assignable to\n  the channel's element type.</p>\n\n<pre><code>SendStmt = Channel \"&lt;-\" Expression .\nChannel  = Expression .\n</code></pre>\n  \n  <p>Both the channel and the value expression are evaluated before\n  communication begins. Communication blocks until the send can proceed.\n  A send on an unbuffered channel can proceed if a receiver is ready. A\n  send on a buffered channel can proceed if there is room in the buffer.\n  A send on a closed channel proceeds by causing a run-time panic. A\n  send on a nil channel blocks forever.</p>\n\n<pre><code>ch &lt;- 3  // send value 3 to channel ch\n</code></pre>\n</blockquote>\n\n<p>In <code>findGreatestDivisor</code></p>\n\n<pre><code>c := make(chan string)\nfindGreatestDivisor(4,c)\n</code></pre>\n\n<p>you try to send on the unbuffered channel <code>c</code></p>\n\n<pre><code>c &lt;- fmt.Sprintf(\"%f is divisble by %d\", num, i)\n</code></pre>\n\n<p>but communication blocks until the send can proceed. A send on an unbuffered channel can proceed if a receiver is ready. There is no receiver ready.</p>\n\n<p>The receives on channel <code>c</code></p>\n\n<pre><code>fmt.Println(&lt;-c)\n</code></pre>\n\n<p>won't be ready until after you return from <code>findGreatestDivisor</code>. That's too late.</p>\n"}], "owner": {"reputation": 13, "user_id": 6088075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e42d8c1d650a9b7f78a597efd41d6f87?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/6088075/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 2, "accepted_answer_id": 36109398, "answer_count": 1, "score": 0, "last_activity_date": 1458439703, "creation_date": 1458436920, "last_edit_date": 1458437982, "question_id": 36109239, "link": "https://stackoverflow.com/questions/36109239/when-i-dont-use-the-go-keyword-a-function-doesnt-work", "title": "When I don&#39;t use the go keyword a function doesn&#39;t work", "body": "<p>In this function you can see that I use the go keyword.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n    c := make(chan string)\n    go findGreatestDivisor(4, c)\n    for i := 0; i &lt;= 1; i++ {\n        fmt.Println(&lt;-c)\n    }\n}\n\nfunc findGreatestDivisor(num float64, c chan string) {\n    var counter float64 = 10000\n    for i := 9999; i &gt; 0; i-- {\n        if math.Mod(num, counter) == 0 {\n            fmt.Println(\"Check..\", math.Mod(4, 1))\n            c &lt;- fmt.Sprintf(\"%f is divisble by %d\", num, i)\n        }\n        counter--\n    }\n\n}\n</code></pre>\n\n<p>It works. It gives me the largest integer. But now I get curious and delete the go keyword where I called the function here</p>\n\n<pre><code>go findGreatestDivisor(4,c)\n</code></pre>\n\n<p>When i just do</p>\n\n<pre><code>findGreatestDivisor(4,c)\n</code></pre>\n\n<p>it gives me the error</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan send]: main.findGreatestDivisor(0x4010000000000000,\n0xc82001a0c0)\n       /home/ubuntu/workspace/test.go:21 +0x37c main.main()\n       /home/ubuntu/workspace/test.go:10 +0x61 exit status 2\n</code></pre>\n\n<p>Why is that?</p>\n"}, {"tags": ["image", "http", "go"], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 1229165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56b36edf3c8dbf296bee4094376e82c7?s=128&d=identicon&r=PG", "display_name": "Wilfred", "link": "https://stackoverflow.com/users/1229165/wilfred"}, "edited": false, "score": 0, "creation_date": 1458430606, "post_id": 36108522, "comment_id": 59858969, "body": "Thanks for the response. Isn&#39;t it a little redundant though because then you would need to make a new Reader to pass to io.Copy when res.Body already satisfies that interface?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 729, "user_id": 1229165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56b36edf3c8dbf296bee4094376e82c7?s=128&d=identicon&r=PG", "display_name": "Wilfred", "link": "https://stackoverflow.com/users/1229165/wilfred"}, "edited": false, "score": 0, "creation_date": 1458430704, "post_id": 36108522, "comment_id": 59858996, "body": "Call Write directly instead of using io.Copy: <code>file.Write(data)</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1458431757, "last_edit_date": 1458431757, "creation_date": 1458430233, "answer_id": 36108522, "question_id": 36108433, "link": "https://stackoverflow.com/questions/36108433/whats-an-efficient-way-to-pass-a-response-body-response-body-in-go/36108522#36108522", "title": "What&#39;s an efficient way to pass a response body (response.Body) in Go?", "body": "<p>Use <a href=\"https://godoc.org/io/ioutil#ReadAll\" rel=\"nofollow\">ioutil.ReadAll</a>. The function returns a slice of bytes. </p>\n\n<p>Slices are efficient to pass around. A slice is a pointer to the backing array, a length and a capacity.</p>\n\n<pre><code>type ImageData struct {\n    Data      []byte\n    Name      string\n}\n\nfunc FetchImage(url string) ([]byte, error) {\n    res, err := http.Get(url)\n    if err != nil {\n        return nil, err\n    }\n    defer resp.Body.Close()\n    if res.StatusCode != 200 {\n        return nil, fmt.Errorf(\"%s: %d\", url, res.StatusCode)\n    }\n    return ioutil.ReadAll(resp.Body)\n}\n\nfunc Save(data *ImageData) error {\n    file, err := os.Create(data.Name)\n    if err != nil {\n        return err\n    }\n    defer file.Close()\n    _, err := file.Write(data.Data)\n    return err\n}\n</code></pre>\n\n<p>You can also pass around the response body, but use caution. The response body must be closed to release the underlying connection. The code in the question does close the response body, but it's difficult to see because the response body is passed down the function where it's closed.</p>\n"}, {"comments": [{"owner": {"reputation": 729, "user_id": 1229165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56b36edf3c8dbf296bee4094376e82c7?s=128&d=identicon&r=PG", "display_name": "Wilfred", "link": "https://stackoverflow.com/users/1229165/wilfred"}, "edited": false, "score": 0, "creation_date": 1458432858, "post_id": 36108536, "comment_id": 59859504, "body": "Thanks for the response -- some great info."}], "tags": [], "owner": {"reputation": 303, "user_id": 2977136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275c4df9289839b46d76540fedc621ad?s=128&d=identicon&r=PG&f=1", "display_name": "Abex", "link": "https://stackoverflow.com/users/2977136/abex"}, "is_accepted": false, "score": 1, "last_activity_date": 1458430304, "last_edit_date": 1495541725, "creation_date": 1458430304, "answer_id": 36108536, "question_id": 36108433, "link": "https://stackoverflow.com/questions/36108433/whats-an-efficient-way-to-pass-a-response-body-response-body-in-go/36108536#36108536", "title": "What&#39;s an efficient way to pass a response body (response.Body) in Go?", "body": "<p>In Go all arrays have a size specifier, and will look like <code>[8]byte</code>. Slices will not have this and look like <code>[]byte</code>. Slices internally just store a pointer to the data, the length of the slice, and the capacity of the slice. This is just 24 bytes on a 64 bit system, so you don't have to worry about passing it around.</p>\n\n<p>However, I would recommend to return a <code>*ImageData</code> from <code>FetchImage</code> as it already has metadata like the name of the image.</p>\n\n<p>As to why you cant take a pointer to a interface, there is a post <a href=\"https://stackoverflow.com/questions/13511203/why-cant-i-assign-a-struct-to-an-interface\">here on SO</a> that explains why.</p>\n\n<p>Also, in <code>Save</code> you <code>defer file.Close()</code> before checking for a error. You should swap this because file will be nil if there is a error, and will probably segfault.</p>\n"}], "owner": {"reputation": 729, "user_id": 1229165, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/56b36edf3c8dbf296bee4094376e82c7?s=128&d=identicon&r=PG", "display_name": "Wilfred", "link": "https://stackoverflow.com/users/1229165/wilfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "accepted_answer_id": 36108522, "answer_count": 2, "score": -1, "last_activity_date": 1458431757, "creation_date": 1458429537, "question_id": 36108433, "link": "https://stackoverflow.com/questions/36108433/whats-an-efficient-way-to-pass-a-response-body-response-body-in-go", "title": "What&#39;s an efficient way to pass a response body (response.Body) in Go?", "body": "<p>If I have some code, like the example below, that fetches an image from a link and then saves it to disk, what is the best way to pass around the image data?</p>\n\n<p>I thought about using <code>ioutil.ReadAll(res.Body)</code> to convert it to <code>[]byte</code> but passing that around seems expensive, although I can't tell from the documentation whether or not it returns a slice or an array. I also tried returning a pointer to <code>res.Body</code>, a <code>*io.ReadCloser</code> type, but I couldn't figure out how to properly call the <code>.Close()</code> method on the pointed to interface.</p>\n\n<p>I understand that moving the save code into the <code>FetchImage</code> function would probably be the easiest way to solve this but I would like to have these pieces separate if possible.</p>\n\n<pre><code>type ImageData struct {\n    Data      io.ReadCloser\n    Name      string\n}\n\nfunc FetchImage(url string) (io.ReadCloser, error) {\n    res, err := http.Get(url)\n    if err != nil {\n        return nil, err\n    }\n    return res.Body, nil\n}\n\nfunc Save(data *ImageData) error {\n    defer data.Data.Close()\n    file, err := os.Create(data.Name)\n    defer file.Close()\n    if err != nil {\n        return err\n    }\n    _, err = io.Copy(file, data.Data)\n    if err != nil {\n        return err\n    }\n    return nil\n}\n\nfunc main() {\n    body, err := fetcher.FetchImage(\"https://imgur.com/asdf.jpg\")\n    if err != nil {\n        panic(err)\n    }\n    imageData := ImageData{body, \"asdf.jpg\"}\n    saver := Saver{config.BaseDir, 1}\n    err = saver.Save(&amp;imageData)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Additionally, I am very new to Go so if there's anything in this code that looks bad please let me know.</p>\n"}, {"tags": ["go", "firebase", "firebase-authentication"], "comments": [{"owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1458428127, "post_id": 36106839, "comment_id": 59858285, "body": "I&#39;m not clear on what you&#39;re trying to do. Where do you run your Go server? How are you trying to pass the token? Showing code of a <a href=\"http://stackoverflow.com/help/mcve\">minimal, complete reproduction</a> of the problem may go a long way to clarify."}, {"owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "reply_to_user": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "edited": false, "score": 0, "creation_date": 1458430609, "post_id": 36106839, "comment_id": 59858970, "body": "@FrankvanPuffelen I updated my post. I am running my go server on AWS. I am passing the token through the URL which does work but the static server doesnt recognize the url since it doesn&#39;t have routing for it. The formatting of the code is a bit messed up not sure why - feel free it edit my post if you&#39;d like."}, {"owner": {"reputation": 2641, "user_id": 1817185, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b4f572bf3b23b61dc57f79ebc06c6122?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1817185/kevin"}, "edited": false, "score": 0, "creation_date": 1468957711, "post_id": 36106839, "comment_id": 64338512, "body": "@ChrisW, did you ever get this figured out?  I&#39;m curious what you ended up going with because I am thinking about this exact same workflow.  We also use CAS for our central authentication."}, {"owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "edited": false, "score": 0, "creation_date": 1469151207, "post_id": 36106839, "comment_id": 64430170, "body": "Yeah! I followed what Frank said. I passed the token through the URL."}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "edited": false, "score": 0, "creation_date": 1458435211, "post_id": 36108836, "comment_id": 59860053, "body": "Thanks I&#39;ll try this out"}], "tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": true, "score": 4, "last_activity_date": 1458433052, "creation_date": 1458433052, "answer_id": 36108836, "question_id": 36106839, "link": "https://stackoverflow.com/questions/36106839/firebase-custom-authentication-passing-tokens/36108836#36108836", "title": "Firebase Custom Authentication passing tokens", "body": "<p>If I understand the flow correctly, then what you're missing is an end point that your app user talks to and that can return the token to that user.</p>\n\n<p>A workaround for this would be to have the user app pass in a highly unguessable value (a \"request ID\") in step 2, something like a UUID. The token server can then write the token into the Firebase Database in step 5 in <code>/tokens/&lt;requestID&gt;</code>, where the client is listening for it.</p>\n"}], "owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 599, "favorite_count": 1, "accepted_answer_id": 36108836, "answer_count": 1, "score": 2, "last_activity_date": 1458433052, "creation_date": 1458419781, "last_edit_date": 1458431179, "question_id": 36106839, "link": "https://stackoverflow.com/questions/36106839/firebase-custom-authentication-passing-tokens", "title": "Firebase Custom Authentication passing tokens", "body": "<p>I am running a Go server that generates JWT tokens. My original plan was to send the tokens using an http.Redirect using the token string as part of the url. </p>\n\n<p>This doesn't appear to work because I'm using Firebase static hosting and hence only have client side routing. </p>\n\n<p>How can I push my token? Headers maybe?</p>\n\n<ul>\n<li>I'm running my <strong>static</strong> SPA on 'example.firebaseapp.com' (A).   </li>\n<li>I'm running my server that <strong>generates tokens</strong> on 'example.us-west-2.compute.amazonaws.com' (B)</li>\n<li>The <strong>cas server</strong> is running on '<a href=\"https://login.example.edu/cas/\" rel=\"nofollow\">https://login.example.edu/cas/</a>' (C)</li>\n<li>There is also of course the user's computer (D)</li>\n</ul>\n\n<p>The flow goes as follows</p>\n\n<ol>\n<li>User load website from static host (A)</li>\n<li>User on computer D clicks 'login through school' button and is directed to my server (B)</li>\n<li>B then redirects to cas server (C). User puts in his credentials and is redirected to computer B.</li>\n<li>Computer B then generates a token using a secret key and a uid.</li>\n<li><strong>This token needs to somehow be set back to the user</strong>\nUser would then call <code>ref.authWithCustomToken(\"AUTH_TOKEN\", function(error, authData) {</code></li>\n</ol>\n\n<h2>Go Server Code</h2>\n\n<pre><code>    func (h *myHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n      if !cas.IsAuthenticated(r) {\n        cas.RedirectToLogin(w, r)\n        return\n      }\n\n    if r.URL.Path == \"/logout\" {\n        cas.RedirectToLogout(w, r)\n        return\n    }\n\n  generatedToken := generateToken(\"uid\") // token is created using a uid and a secret\n    redirectURL := websiteURL + generatedToken\n    println(redirectURL)\n\n    println(generatedToken)\n    http.Redirect(w, r, redirectURL, http.StatusFound) // I attempt to send the token using a redirect. This doesn't seem to work though since the static server only supports routing for '/'. \n    //html.WriteTo(w)\n\n    }\n</code></pre>\n"}, {"tags": ["loops", "go", "compare", "slice"], "comments": [{"owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "edited": false, "score": 0, "creation_date": 1458414815, "post_id": 36105980, "comment_id": 59854017, "body": "Side note, the above works if only one match is found. The error happens when two matches are found."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1458417827, "post_id": 36105980, "comment_id": 59854968, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28699485/remove-elements-in-slice\">Remove elements in slice</a>, also <a href=\"http://stackoverflow.com/questions/33495995/remove-slice-element-within-a-for\">Remove slice element within a for</a>, also <a href=\"http://stackoverflow.com/questions/29005825/how-to-remove-element-of-struct-array-in-loop-in-golang\">How to remove element of struct array in loop in golang</a>."}, {"owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1458421696, "post_id": 36105980, "comment_id": 59856199, "body": "Yes, I think you&#39;re right. &quot;Remove elements in slice&quot; addresses the same issue."}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "is_accepted": true, "score": 0, "last_activity_date": 1458436552, "creation_date": 1458436552, "answer_id": 36109197, "question_id": 36105980, "link": "https://stackoverflow.com/questions/36105980/go-compare-two-slices-and-delete-multiple-indices/36109197#36109197", "title": "Go: compare two slices and delete multiple indices", "body": "<p>Okay, so that was the thing, once an index is remove from the slice the remaining indices shift position, throwing the loop count off. The issue was resolved by decrementing the loop count variable.</p>\n\n<pre><code>for i := 0; i &lt; len(MySlice); i++ {\n    for _, oa := range OtherSlice {\n        if MySlice[i].SomeVal == oa.OtherVal {\n                MySlice = append(MySlice[:i], MySlice[i+1:]...)\n                i--\n                break\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 3096935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f2b2f03ab65bb90ea760a384c48154e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Babcock", "link": "https://stackoverflow.com/users/3096935/michael-babcock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 36109197, "answer_count": 1, "score": 0, "last_activity_date": 1458436552, "creation_date": 1458414718, "last_edit_date": 1458415146, "question_id": 36105980, "link": "https://stackoverflow.com/questions/36105980/go-compare-two-slices-and-delete-multiple-indices", "title": "Go: compare two slices and delete multiple indices", "body": "<p>How do you loop over two slices and delete multiple indices, based on the comparison? I tried the following, but it results in an error \"panic: runtime error: slice bounds out of range.\"</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    type My struct {\n        SomeVal string\n    }\n\n    type Other struct {\n        OtherVal string\n    }\n\n    var MySlice []My\n    var OtherSlice []Other\n\n    MySlice = append(MySlice, My{SomeVal: \"abc\"})\n    MySlice = append(MySlice, My{SomeVal: \"mno\"})\n    MySlice = append(MySlice, My{SomeVal: \"xyz\"})\n\n    OtherSlice = append(OtherSlice, Other{OtherVal: \"abc\"})\n    OtherSlice = append(OtherSlice, Other{OtherVal: \"def\"})\n    OtherSlice = append(OtherSlice, Other{OtherVal: \"xyz\"})\n\n    for i, a := range MySlice {\n        for _, oa := range OtherSlice {\n            if a.SomeVal == oa.OtherVal {\n                MySlice = MySlice[:i+copy(MySlice[i:], MySlice[i+1:])]\n            }\n        }\n    }\n\n    fmt.Println(MySlice)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/4pgxE3LNmx\" rel=\"nofollow\">http://play.golang.org/p/4pgxE3LNmx</a></p>\n\n<p>Note: the above works if only one match is found. The error happens when two matches are found. </p>\n"}, {"tags": ["sockets", "go", "buffered"], "answers": [{"comments": [{"owner": {"reputation": 21539, "user_id": 193906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f2d5a5d0610a28a9a3634640385b36?s=128&d=identicon&r=PG", "display_name": "Sanjay T. Sharma", "link": "https://stackoverflow.com/users/193906/sanjay-t-sharma"}, "edited": false, "score": 0, "creation_date": 1458412480, "post_id": 36105530, "comment_id": 59853242, "body": "Shouldn&#39;t <code>return err</code> be <code>return nil, err</code>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 21539, "user_id": 193906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02f2d5a5d0610a28a9a3634640385b36?s=128&d=identicon&r=PG", "display_name": "Sanjay T. Sharma", "link": "https://stackoverflow.com/users/193906/sanjay-t-sharma"}, "edited": false, "score": 0, "creation_date": 1458412627, "post_id": 36105530, "comment_id": 59853283, "body": "@SanjayT.Sharma It should be <code>return xml.StartElement{}, err</code>.  Thanks for pointing out the issue."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1582011714, "last_edit_date": 1582011714, "creation_date": 1458412254, "answer_id": 36105530, "question_id": 36105199, "link": "https://stackoverflow.com/questions/36105199/how-to-read-data-xml-sent-by-server-if-it-doesnt-send-new-line/36105530#36105530", "title": "How to read data (xml) sent by server if it doesn&#39;t send new line", "body": "<p>Use an <a href=\"https://godoc.org/encoding/xml#Decoder\" rel=\"nofollow noreferrer\">xml.Decoder</a> to read stanzas from an XMPP stream.  </p>\n\n<pre><code>conn, err := net.Dial(\"tcp\", s.Addr+\":5222\")\nif err != nil {\n    // handle error\n}\ndec := xml.NewDecoder(conn)\n</code></pre>\n\n<p>Use the decoder <a href=\"https://godoc.org/encoding/xml#Decoder.Token\" rel=\"nofollow noreferrer\">Token</a> method to read the root document element and to skip over character data between stanzas:</p>\n\n<pre><code>func readStartElement(dec *xml.Decoder) (xml.StartElement, error) {\n    for {\n        t, err := dec.Token()\n        if err != nil {\n            return xml.StartElement{}, err\n        }\n        switch t := t.(type) {\n        case xml.StartElement:\n            return t, nil\n        }\n    }\n}\n</code></pre>\n\n<p>Use the decoder <a href=\"https://godoc.org/encoding/xml#Decoder.DecodeElement\" rel=\"nofollow noreferrer\">DecodeElement</a> method to read a stanza:</p>\n\n<pre><code>func readStanza(dec *xml.Decoder) (interface{}, error) {\n    se, err := readStartElement(dec)\n    if err != nil {\n        return nil, err\n    }\n    var v interface{}\n    switch  se.Name.Space + \" \" + se.Name.Local {\n    case \"jabber:client message\":\n        v = &amp;jabberMessage{} // jabberMessage is struct type defined by app for messages\n    // Add other stanza types here.        \n    default:\n        v = &amp;struct{}{}\n    }\n    if err := dec.DecodeElement(v, &amp;se); err != nil {\n        return nil, err\n    }\n    return v, nil\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">Type switch</a> on the return value from readStanza to handle the different types of received stanzas.</p>\n\n<p>A client reads stanzas synchronously.  Here's rough outline (ignoring authentication, etc).</p>\n\n<pre><code>conn, err := net.Dial(\"tcp\", s.Addr+\":5222\")\nif err != nil {\n    // handle error\n}\ndec := xml.NewDecoder(conn)\n\n// read and discard root element\n_, err := readStartElement(dec)\nif err != nil {\n     // handle error\n}\n\n// read stanzas\nfor {\n   v, err := readStanza(dec)\n   if err != nil {\n       // handle error \n       // must break out of loop on error\n   }\n   switch v := v.(type) {\n   case *jabberMessage:\n        // handle message\n   case *someOtherStanzaType:\n        // handle other stanza types\n        // ... and so on\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 36105530, "answer_count": 1, "score": 0, "last_activity_date": 1582011714, "creation_date": 1458410412, "question_id": 36105199, "link": "https://stackoverflow.com/questions/36105199/how-to-read-data-xml-sent-by-server-if-it-doesnt-send-new-line", "title": "How to read data (xml) sent by server if it doesn&#39;t send new line", "body": "<p>Let's say we try to communicate with a server (XMPP) which sends back XML data. We can use </p>\n\n<pre><code>conn, err := net.Dial(\"tcp\", s.Addr+\":5222\")\n//...\nr := bufio.NewReader(conn)\n//...\ns, err := s.R.ReadString(10) // to read a string\n</code></pre>\n\n<p>But there is one problem that the server doesn't send the \\10 (newline) symbol. I also tried 12 but without any luck. Same goes for readLine function as it also relies on \\10. So how do I read the data sent by server?\nI tried using '>' as a delimiter and succeeded to receive only parts of the messages (predictable). I had an idea to loop while error is nil and use delimiter of '>' but it also didn't work.\nMy research shown that the last symbol of the message is really '>' (62) and there is not any anything else at the end.</p>\n"}, {"tags": ["go", "concurrency", "parallel-processing"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1458407912, "post_id": 36104038, "comment_id": 59851667, "body": "goroutines are cheap, they are not free. What is the output of the <code>go version</code> command?"}, {"owner": {"reputation": 836, "user_id": 2971839, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae42092534f65bffafcc85cc02e7d35b?s=128&d=identicon&r=PG&f=1", "display_name": "Keozon", "link": "https://stackoverflow.com/users/2971839/keozon"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1458409048, "post_id": 36104038, "comment_id": 59852053, "body": "go version go1.6 linux/amd64"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1458411141, "post_id": 36104038, "comment_id": 59852788, "body": "BUG ALERT: Your example, 20 iterations, overflows your factorial function."}], "answers": [{"tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 3, "last_activity_date": 1458409122, "creation_date": 1458409122, "answer_id": 36104937, "question_id": 36104038, "link": "https://stackoverflow.com/questions/36104038/go-concurrency-chudnovkys-algorithm-slower-than-sync/36104937#36104937", "title": "Go Concurrency: Chudnovky&#39;s algorithm, slower than sync", "body": "<p>The calculations you're doing are too simple to do each one of them in a separate goroutine. You're loosing more time in the runtime (creating goroutines, multiplexing, scheduling etc) than on actual calculations. What you're trying to do is more suited for GPU, for example, where you have massive number of parallel execution units that can do this simple calculations all at ones in an instant. But you would need other languages and APIs to do that.</p>\n\n<p>What you can do is to create software thread of execution for every hardware thread of execution. You want to split your <code>max</code> variable into big chunks and execute them in parallel. Here's very simple take on it just to illustrate the idea:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"math\"\n  \"strconv\"\n  \"time\"\n  \"runtime\"\n)\n\nfunc main() {\n  var input string\n  var sum float64\n  var pi float64\n  c := make(chan float64, runtime.GOMAXPROCS(-1))\n  fmt.Print(\"How many iterations? \")\n  fmt.Scanln(&amp;input)\n  max,err := strconv.Atoi(input)\n\n  if err != nil {\n    panic(\"You did not enter a valid integer\")\n  }\n  start := time.Now() //start timing execution of concurrent routine\n\n  for i := 0; i &lt; runtime.GOMAXPROCS(-1); i++ {\n    go func(i int){\n      var sum float64\n      for j := 0; j &lt; max/runtime.GOMAXPROCS(-1); j++  {\n        sum += chudnovskySync(j + i*max/runtime.GOMAXPROCS(-1))\n      }\n      c &lt;- sum\n    }(i)\n  }\n\n  for i := 0; i &lt; runtime.GOMAXPROCS(-1); i++ {\n    sum += &lt;-c\n  }\n  end := time.Now() //end of concurrent routine\n  fmt.Println(\"Duration of concurrent calculation: \",end.Sub(start))\n  pi = 1/(12*sum)\n  fmt.Println(pi)\n\n  start = time.Now() //start timing execution of syncronous routine\n  sum = 0\n  for i := 0; i &lt; max; i++ {\n    sum += chudnovskySync(i)\n  }\n  end = time.Now() //end of syncronous routine\n  fmt.Println(\"Duration of synchronous calculation: \",end.Sub(start))\n  pi = 1/(12*sum)\n  fmt.Println(pi)\n}\n\nfunc chudnovskySync(i int) (r float64) {\n  var numerator float64\n  var denominator float64\n  ifloat := float64(i)\n  iun := uint64(i)\n  numerator = math.Pow(-1, ifloat) * float64(factorial(6*iun)) * (545140134*ifloat+13591409)\n  denominator = float64(factorial(3*iun)) * math.Pow(float64(factorial(iun)),3) * math.Pow(math.Pow(640320,3),ifloat+0.5)\n  r = numerator/denominator\n  return\n}\n\nfunc factorial(n uint64) (res uint64) {\n  if ( n &gt; 0 ) {\n    res = n * factorial(n-1)\n    return res\n  }\n\n  return 1\n}\n</code></pre>\n\n<p>And here's the results</p>\n\n<pre><code>$ go version\ngo version go1.5.2 windows/amd64\n\n$ go run main.go\nGOMAXPROCS = 4\nHow many iterations? 10000\nDuration of concurrent calculation:  932.8916ms\nNaN\nDuration of synchronous calculation:  2.0639744s\nNaN \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1458416033, "creation_date": 1458416033, "answer_id": 36106220, "question_id": 36104038, "link": "https://stackoverflow.com/questions/36104038/go-concurrency-chudnovkys-algorithm-slower-than-sync/36106220#36106220", "title": "Go Concurrency: Chudnovky&#39;s algorithm, slower than sync", "body": "<p>I agree, your calculations don't do enough processing to overcome the overhead of having multiple goroutines. Just for fun, I modified your code to do the calculation many times (1000, 10000, 100000, 1000000) before returning the result. I ran this (with 20 iterations) under Mac OS X Yosemite running on a quad core Xeon, and, as you might expect, the synchronous version takes in the neighborhood of four times as long as the parallel version.</p>\n\n<p>One interesting thing I noticed is that, with a large number of repetitions, the synchronous version actually takes more than four times as long as the parallel version. I'm guessing this has something to do with Intel's hyperthreading architecture which allows some level of parallelism within each core, but I'm not sure about that.</p>\n"}], "owner": {"reputation": 836, "user_id": 2971839, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ae42092534f65bffafcc85cc02e7d35b?s=128&d=identicon&r=PG&f=1", "display_name": "Keozon", "link": "https://stackoverflow.com/users/2971839/keozon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 36104937, "answer_count": 2, "score": 0, "last_activity_date": 1458416033, "creation_date": 1458404049, "question_id": 36104038, "link": "https://stackoverflow.com/questions/36104038/go-concurrency-chudnovkys-algorithm-slower-than-sync", "title": "Go Concurrency: Chudnovky&#39;s algorithm, slower than sync", "body": "<p>I just recently started learning go at the recommendation of a friend. So far, I am loving it, but I wrote (what I thought would be) the perfect example of the power of lightweight concurrency, and got a surprising result... so I suspect I'm doing something wrong, or I'm misunderstanding how expensive goroutines are. I'm hoping some gophers here can provide insight.</p>\n\n<p>I wrote Chudnovsky's algorithm in Go using both goroutines and simple synchronous execution. I assumed, with each calculation being independent of the others, it'd be at least a little faster running concurrently. </p>\n\n<p><em>note</em>: I am running this on a 5th gen i7, so if goroutines are multiplexed onto threads as I was told, this should be both concurrent <em>and</em> parallel.</p>\n\n<pre><code> package main\n\nimport (\n  \"fmt\"\n  \"math\"\n  \"strconv\"\n  \"time\"\n)\n\nfunc main() {\n  var input string\n  var sum float64\n  var pi float64\n  c := make(chan float64)\n\n  fmt.Print(\"How many iterations? \")\n  fmt.Scanln(&amp;input)\n  max,err := strconv.Atoi(input)\n\n  if err != nil {\n    panic(\"You did not enter a valid integer\")\n  }\n  start := time.Now() //start timing execution of concurrent routine\n\n  for i := 0; i &lt; max; i++ {\n    go chudnovskyConcurrent(i,c)\n  }\n\n  for i := 0; i &lt; max; i++ {\n    sum += &lt;-c\n  }\n  end := time.Now() //end of concurrent routine\n  fmt.Println(\"Duration of concurrent calculation: \",end.Sub(start))\n  pi = 1/(12*sum)\n  fmt.Println(pi)\n\n  start = time.Now() //start timing execution of syncronous routine\n  sum = 0\n  for i := 0; i &lt; max; i++ {\n    sum += chudnovskySync(i)\n  }\n  end = time.Now() //end of syncronous routine\n  fmt.Println(\"Duration of synchronous calculation: \",end.Sub(start))\n  pi = 1/(12*sum)\n  fmt.Println(pi)\n}\n\nfunc chudnovskyConcurrent(i int, c chan&lt;- float64) {\n  var numerator float64\n  var denominator float64\n  ifloat := float64(i)\n  iun := uint64(i)\n  numerator = math.Pow(-1, ifloat) * float64(factorial(6*iun)) * (545140134*ifloat+13591409)\n  denominator = float64(factorial(3*iun)) * math.Pow(float64(factorial(iun)),3) * math.Pow(math.Pow(640320,3),ifloat+0.5)\n  c &lt;- numerator/denominator\n}\n\nfunc chudnovskySync(i int) (r float64) {\n  var numerator float64\n  var denominator float64\n  ifloat := float64(i)\n  iun := uint64(i)\n  numerator = math.Pow(-1, ifloat) * float64(factorial(6*iun)) * (545140134*ifloat+13591409)\n  denominator = float64(factorial(3*iun)) * math.Pow(float64(factorial(iun)),3) * math.Pow(math.Pow(640320,3),ifloat+0.5)\n  r = numerator/denominator\n  return\n}\n\nfunc factorial(n uint64) (res uint64) {\n  if ( n &gt; 0 ) {\n    res = n * factorial(n-1)\n    return res\n  }\n\n  return 1\n}\n</code></pre>\n\n<p>And here are my results:</p>\n\n<pre><code>How many iterations? 20\nDuration of concurrent calculation:  573.944\u00b5s\n3.1415926535897936\nDuration of synchronous calculation:  63.056\u00b5s\n3.1415926535897936\n</code></pre>\n"}, {"tags": ["arrays", "go", "parallel-processing"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1458453148, "post_id": 36104020, "comment_id": 59862931, "body": "BTW It&#39;s not parallel programming that happens in Go; but rather Concurrent programming - which also makes Parallel Programming possible (for example when you use more than one thread)."}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 0, "creation_date": 1458406887, "post_id": 36104459, "comment_id": 59851311, "body": "Thanks ! So if I have 1000 goroutines with 4 threads is it efficient parallel programing or is it better to create goroutines 4 by 4 instead of 1000 in one loop ?"}, {"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "reply_to_user": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 1, "creation_date": 1458407634, "post_id": 36104459, "comment_id": 59851563, "body": "@Fred, if the goroutine is constantly doing work, then is is better to limit them number of goroutines to number of cpus. If there is a wait involved (e.g. simple sleep function), then it make sense to have more goroutines then cpus. Why don&#39;t you play around and see?"}, {"owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "edited": false, "score": 0, "creation_date": 1458471807, "post_id": 36104459, "comment_id": 59866736, "body": "In my case, each goroutine do a short work (correlations calculation) an then print the result :)"}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 0, "last_activity_date": 1458406461, "creation_date": 1458406461, "answer_id": 36104459, "question_id": 36104020, "link": "https://stackoverflow.com/questions/36104020/processing-array-in-go-parallel-any-risk-of-to-much-threads/36104459#36104459", "title": "Processing array in Go parallel : any risk of to much threads?", "body": "<p>Your for loop will create 1000 goroutines, <code>runtime.GOMAXPROCS(4)</code> on sets the number of cpus that can be used.</p>\n\n<blockquote>\n  <p>GOMAXPROCS sets the maximum number of CPUs that can be executing\n  simultaneously and returns the previous setting. If n &lt; 1, it does not\n  change the current setting. The number of logical CPUs on the local\n  machine can be queried with NumCPU. This call will go away when the\n  scheduler improves.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow\">GOMAXPROCS</a></p>\n\n<p>and on the same page:</p>\n\n<blockquote>\n  <p>The GOMAXPROCS variable limits the number of operating system threads\n  that can execute user-level Go code simultaneously. There is no limit\n  to the number of threads that can be blocked in system calls on behalf\n  of Go code; those do not count against the GOMAXPROCS limit. This\n  package's GOMAXPROCS function queries and changes the limit.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1458654807, "creation_date": 1458654807, "answer_id": 36156289, "question_id": 36104020, "link": "https://stackoverflow.com/questions/36104020/processing-array-in-go-parallel-any-risk-of-to-much-threads/36156289#36156289", "title": "Processing array in Go parallel : any risk of to much threads?", "body": "<p>When writing parallel code to improve speed, always remember <a href=\"https://en.wikipedia.org/wiki/Amdahl%27s_law\" rel=\"nofollow\">Amdahl's Law</a>. His Law gives a very useful rule of thumb on when to stop bothering and can be paraphrased as 'the sequential bits will become the bottleneck'.</p>\n\n<p>If you ignore Amdahl's Law, you might end up wasting your time chasing impossible objectives. Instead, you might need to think about broader issues of concurrency to solve any performance problem in more than one place or in more than one way.</p>\n\n<p>Generally, the approach you are using is data-parallel: the \"geometrical\" decomposition of independent segments of data structures across multiple processes.</p>\n\n<p>You might also consider function decompositions (essentially pipelines) where different stages do different work.</p>\n\n<p>Then there is the special temporal case, using master-worker or 'data farming' as a way of achieving parallelism.</p>\n\n<p>All these tend to need truly parallel hardware to be seriously useful. A good, but old, summary of multiprocessing using these techniques is in Tidmus/Chalmers <em>Practical Parallel Processing: An introduction to problem solving in parallel</em> (ISBN 1850321353).</p>\n"}], "owner": {"reputation": 375, "user_id": 6056789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d8bfd94f1b34ad9b1f3bbc5acca74ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/6056789/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1458654807, "creation_date": 1458403991, "last_edit_date": 1495541732, "question_id": 36104020, "link": "https://stackoverflow.com/questions/36104020/processing-array-in-go-parallel-any-risk-of-to-much-threads", "title": "Processing array in Go parallel : any risk of to much threads?", "body": "<p>I have an additional question concerning my previous post <a href=\"https://stackoverflow.com/questions/36092665/processing-arrays-in-go-parallel-gives-unexpected-results/36100540#36100540\">Processing array in Go parallel</a> : imagine that my arrays are very large, for example</p>\n\n<pre><code>a1 := []int{0, 1, 2, 3, 4...1000}\na2 := []int{10, 20, 30, 40, 50...10000}\n\nand I have only 4 cpus :\n\nruntime.GOMAXPROCS(4)\nvar wg sync.WaitGroup\n\nIs the following code still correct ?\n\nfor i := 1; i &lt; 1000; i++ {\n    wg.Add(1)\n    go func(i int) {\n        defer wg.Done()\n        x := process_array(a1[i], a2[i])\n        fmt.Println(a1[i], \"+\", a2[i], \"=\", x)\n    }(i)      \n}\nwg.Wait() \n</code></pre>\n\n<p>in other words, the runtime.GOMAXPROCS(4) will be able to limit the number of threads to 4, or, there will be a problem of \"accumulation\" of 1000 threads ? Thanks for your comments !</p>\n"}, {"tags": ["go", "delve"], "comments": [{"owner": {"reputation": 1075, "user_id": 2288443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbfe76613f45e29cc96c5a36a58b9cf0?s=128&d=identicon&r=PG", "display_name": "phayes", "link": "https://stackoverflow.com/users/2288443/phayes"}, "edited": false, "score": 0, "creation_date": 1460788627, "post_id": 36103981, "comment_id": 60914529, "body": "Did you create an ECC certificate by chance?  (instead of the default RSA)"}], "answers": [{"tags": [], "owner": {"reputation": 538, "user_id": 1676347, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8e7742ad763f9b4f362504853d4330?s=128&d=identicon&r=PG", "display_name": "Alex Goja", "link": "https://stackoverflow.com/users/1676347/alex-goja"}, "is_accepted": false, "score": 2, "last_activity_date": 1480347464, "creation_date": 1480347464, "answer_id": 40848118, "question_id": 36103981, "link": "https://stackoverflow.com/questions/36103981/installing-delve-for-go-in-mac-osx/40848118#40848118", "title": "Installing delve for GO in Mac OSX", "body": "<ol>\n<li>brew install steeve/delve/delve -> this installs delve and creates the certificate</li>\n<li>Go to the delve folder, GOPATH/src/derek\u2026/delve</li>\n<li>Install cert for delve with command CERT=dlv-cert make install</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 0, "last_activity_date": 1580337725, "creation_date": 1580337725, "answer_id": 59976678, "question_id": 36103981, "link": "https://stackoverflow.com/questions/36103981/installing-delve-for-go-in-mac-osx/59976678#59976678", "title": "Installing delve for GO in Mac OSX", "body": "<p>Building <code>devl</code> with a certificate and signing it is an easy task, <a href=\"http://mozey.co/post/golang-dev-osx/\" rel=\"nofollow noreferrer\">check this article</a> that shows how to create cert, sign it and build from source</p>\n\n<ul>\n<li>Install xcode build tools <code>xcode-select --install</code></li>\n<li>Create Certificate and sign it from <code>Key Chain</code> details in the article above.</li>\n<li>Clone repo \n<code>git clone https://github.com/go-delve/delve.git &amp;&amp; cd delve</code></li>\n<li>Build with cert:\n<code>CERT=dlv-cert make install</code></li>\n<li><p>Enable Developer mode:\n<code>sudo /usr/sbin/DevToolsSecurity -enable</code></p></li>\n<li><p>For troubleshooting, check <a href=\"https://github.com/go-delve/delve/blob/master/Documentation/installation/osx/install.md#notes\" rel=\"nofollow noreferrer\">this link</a></p></li>\n</ul>\n\n<p>For Installing <code>delv</code> in <code>OSX</code>, <code>Linux</code> <code>FreeBSD</code>, or <code>Windows</code>, here's their github's wiki page that would help you how to install it.</p>\n\n<p><a href=\"https://github.com/go-delve/delve/tree/master/Documentation/installation\" rel=\"nofollow noreferrer\">https://github.com/go-delve/delve/tree/master/Documentation/installation</a></p>\n\n<p>For more information on how to use it, its APIs and command line interface, visit <a href=\"https://github.com/go-delve/delve/tree/master/Documentation\" rel=\"nofollow noreferrer\">official documentation wiki</a> </p>\n"}], "owner": {"reputation": 623, "user_id": 2211168, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/W4nNr.png?s=128&g=1", "display_name": "Mari Murotani", "link": "https://stackoverflow.com/users/2211168/mari-murotani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3759, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1580337725, "creation_date": 1458403768, "question_id": 36103981, "link": "https://stackoverflow.com/questions/36103981/installing-delve-for-go-in-mac-osx", "title": "Installing delve for GO in Mac OSX", "body": "<p>I have been trying to install delve in my environment.\nHowever , delve fails to start and I can't solve this problem.</p>\n\n<p>OS: OSX Yosemite 10.10.4</p>\n\n<p>Darwin Kernel Version 14.4.0</p>\n\n<pre><code> $GOPATH/bin/dlv debug main.go\n could not launch process: could not fork/exec\n</code></pre>\n\n<p><a href=\"https://github.com/derekparker/delve/wiki/Building\" rel=\"noreferrer\">https://github.com/derekparker/delve/wiki/Building</a></p>\n\n<p>I installed delve following steps mentioned above URL.\nInstall was succeeded and delve starts appropriately with root user.\nDelve returns error except root user.</p>\n\n<p>1) I have created certification and signed application</p>\n\n<p>2) I kill taskgated just before make command but it starts again after make.</p>\n\n<p>3) If I rename these files, this command makes failure.\n/System/Library/LaunchDaemons/com.apple.taskgated-helper.plist\n/System/Library/LaunchDaemons/com.apple.taskgated.plist</p>\n\n<pre><code>codesign -s \"dlv-cert\" /Users/murotanimari/work/bin/dlv\nerror: One or more parameters passed to a function were not valid.\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 137816, "user_id": 13070, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/pio3A.jpg?s=128&g=1", "display_name": "Mark B", "link": "https://stackoverflow.com/users/13070/mark-b"}, "edited": false, "score": 1, "creation_date": 1458404762, "post_id": 36103362, "comment_id": 59850598, "body": "You can create your own custom AMI: <a href=\"http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.customenv.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/elasticbeanstalk/latest/dg/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "edited": false, "score": 0, "creation_date": 1458459056, "post_id": 36108460, "comment_id": 59863932, "body": "Thanks for your help thus far. I think uploading a binary file called application is the best option."}, {"owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "edited": false, "score": 0, "creation_date": 1458459083, "post_id": 36108460, "comment_id": 59863936, "body": "For some reason I&#39;m getting the error: &#39;/var/app/current/application: /var/app/current/application: cannot execute binary file&#39;. I&#39;m compiling my app on OSX Yosemite. Is that the issue?"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "edited": false, "score": 0, "creation_date": 1461907816, "post_id": 36108460, "comment_id": 61420479, "body": "@ChrisW is this issue (error executing binary file) still relevant ?"}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1461939753, "post_id": 36108460, "comment_id": 61440544, "body": "@JohnSPerayil This issue was for a previous version of this answer. It is no longer relevant."}, {"owner": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1487712116, "post_id": 36108460, "comment_id": 71905530, "body": "Docker is great as long as you don&#39;t use the aws-sdk-go library which requires Go 1.5+ since Docker (within AWS) is limited to Go 1.4"}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1487763657, "post_id": 36108460, "comment_id": 71928246, "body": "@MTarantini No It&#39;s not. There is a difference between the preconfigured docker images (limited to Go 1.4) and generic docker."}, {"owner": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1487865506, "post_id": 36108460, "comment_id": 71986510, "body": "@fl0cke Good call. What would you say is the advantage of Docker over using a Native Go platform?"}, {"owner": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1487960960, "post_id": 36108460, "comment_id": 72035218, "body": "@fl0cke Wouldn&#39;t they both? What is specifically an advantage of Docker over a Native Go platform?"}, {"owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "reply_to_user": {"reputation": 819, "user_id": 2499227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NpTc3.jpg?s=128&g=1", "display_name": "MTarantini", "link": "https://stackoverflow.com/users/2499227/mtarantini"}, "edited": false, "score": 0, "creation_date": 1487981372, "post_id": 36108460, "comment_id": 72044514, "body": "@MTarantini Well, It doesn&#39;t depend on amazon maintaining the AMI. You can run anything you want in a docker container. Including versions of Go not supported by elastic beanstalk."}], "tags": [], "owner": {"reputation": 2284, "user_id": 2125099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bf0fb68f7d521aa94e45c76cb18a4b3?s=128&d=identicon&r=PG", "display_name": "fl0cke", "link": "https://stackoverflow.com/users/2125099/fl0cke"}, "is_accepted": true, "score": 2, "last_activity_date": 1461846810, "last_edit_date": 1461846810, "creation_date": 1458429664, "answer_id": 36108460, "question_id": 36103362, "link": "https://stackoverflow.com/questions/36103362/deploying-go-1-6-web-app-to-aws-elastic-beanstalk/36108460#36108460", "title": "Deploying Go 1.6 web app to AWS Elastic Beanstalk?", "body": "<p>The best choice would be to use <a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow\"><strong>docker</strong></a>.</p>\n\n<p>Here are the steps to deploy your application to Elastic Beanstalk:</p>\n\n<ol>\n<li>Choose the <strong>Generic Docker</strong> platform when creating a new environment.</li>\n<li>Put a file named <code>Dockerfile</code> in your project root with the following content:</li>\n</ol>\n\n<hr>\n\n<pre><code>FROM golang:1.6.2-onbuild\nEXPOSE 80\n</code></pre>\n\n<hr>\n\n<ol start=\"3\">\n<li>Add a <a href=\"https://docs.google.com/document/d/1jVFkZTcYbNLaTxXD9OcGfn7vYv5hWtPx9--lTx1gPMs/edit\" rel=\"nofollow\"><strong>canonical import path</strong></a> to your <code>main.go</code>. For example, if your package name is <code>my/package</code> the first line of <code>main.go</code> should be <code>package main // import \"my/package\"</code></li>\n<li>Make your application <strong>listen on port 80</strong></li>\n<li>Deploy!</li>\n</ol>\n"}], "owner": {"reputation": 735, "user_id": 2536700, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/2ac04fd32567ed44ddeaca257bcd6806?s=128&d=identicon&r=PG", "display_name": "Chris W", "link": "https://stackoverflow.com/users/2536700/chris-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 2, "accepted_answer_id": 36108460, "answer_count": 1, "score": 2, "last_activity_date": 1461846810, "creation_date": 1458400218, "question_id": 36103362, "link": "https://stackoverflow.com/questions/36103362/deploying-go-1-6-web-app-to-aws-elastic-beanstalk", "title": "Deploying Go 1.6 web app to AWS Elastic Beanstalk?", "body": "<p>I want to deploy my web app to elastic beanstalk but it appears to only support Go 1.4 rather than Go 1.6. Is there a way to get a custom image?</p>\n\n<p>The reason I want 1.6 is because it supports vendoring and my web app depends on 3rd party packages. </p>\n"}, {"tags": ["sockets", "go", "buffer"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1458398457, "last_edit_date": 1458398457, "creation_date": 1458397911, "answer_id": 36102974, "question_id": 36102926, "link": "https://stackoverflow.com/questions/36102926/reusing-read-buffers-when-working-with-sockets/36102974#36102974", "title": "reusing read buffers when working with sockets", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/io/\" rel=\"nofollow\">Package io</a></p>\n\n<pre><code>import \"io\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow\">type Reader</a></p>\n\n<pre><code>type Reader interface {\n        Read(p []byte) (n int, err error)\n}\n</code></pre>\n  \n  <p>Reader is the interface that wraps the basic Read method.</p>\n  \n  <p>Read reads up to len(p) bytes into p. It returns the number of bytes\n  read (0 &lt;= n &lt;= len(p)) and any error encountered. Even if Read\n  returns n &lt; len(p), it may use all of p as scratch space during the\n  call. If some data is available but not len(p) bytes, Read\n  conventionally returns what is available instead of waiting for more.</p>\n  \n  <p>When Read encounters an error or end-of-file condition after\n  successfully reading n > 0 bytes, it returns the number of bytes read.\n  It may return the (non-nil) error from the same call or return the\n  error (and n == 0) from a subsequent call. An instance of this general\n  case is that a Reader returning a non-zero number of bytes at the end\n  of the input stream may return either err == EOF or err == nil. The\n  next Read should return 0, EOF.</p>\n  \n  <p>Callers should always process the n > 0 bytes returned before\n  considering the error err. Doing so correctly handles I/O errors that\n  happen after reading some bytes and also both of the allowed EOF\n  behaviors.</p>\n  \n  <p>Implementations of Read are discouraged from returning a zero byte\n  count with a nil error, except when len(p) == 0. Callers should treat\n  a return of 0 and nil as indicating that nothing happened; in\n  particular it does not indicate EOF.</p>\n  \n  <p>Implementations must not retain p.</p>\n</blockquote>\n\n<p>Read may use all of the buffer as scratch space during the call.</p>\n\n<p>For example,</p>\n\n<pre><code>buf := make([]byte, 4096)\nfor {\n    n, err := r.Read(buf[:cap(buf)])\n    buf = buf[:n]\n    if err != nil {\n        // handle error\n    }\n    // process buf\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 4, "last_activity_date": 1458399033, "last_edit_date": 1458399033, "creation_date": 1458398641, "answer_id": 36103089, "question_id": 36102926, "link": "https://stackoverflow.com/questions/36102926/reusing-read-buffers-when-working-with-sockets/36103089#36103089", "title": "reusing read buffers when working with sockets", "body": "<p>The Read method reads up to the len(buf) bytes to the buffer and returns the number of bytes read. </p>\n\n<p>The Read method does not modify length of the caller's slice. It cannot because the slice is passed by value. The application must use the returned length to get a slice of the bytes actually read.</p>\n\n<pre><code>n, err = conn.Read(buf)\nbufRead := buf[:n]\n</code></pre>\n\n<p>The application can call Read multiple times using the the same buffer. </p>\n\n<pre><code>conn, err := net.Dial(\"tcp\", addr)\nif err != nil {\n    // handle error\n}\n\nbuf := make([]byte, 1024)\nfor {\n    n, err = conn.Read(buf)\n    if err != nil {\n        // handle error\n    }\n    fmt.Printf(\"Read %s\\n\", buf[:n]) // buf[:n] is slice of bytes read from conn\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 3, "last_activity_date": 1458400347, "creation_date": 1458400347, "answer_id": 36103384, "question_id": 36102926, "link": "https://stackoverflow.com/questions/36102926/reusing-read-buffers-when-working-with-sockets/36103384#36103384", "title": "reusing read buffers when working with sockets", "body": "<p>In practice you rarely use io.Reader.Read(), instead you pipe it down where io.Reader needed in code.\nBuffer will not be wiped, you must do it by hand. Or if you want a buffer you can use bufio</p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", addr)\nr:=bufio.NewReader(conn)\n</code></pre>\n\n<p>which you can </p>\n\n<pre><code>r.WriteTo(io.Writer) //for example for further processing\n</code></pre>\n\n<p>and you can reset</p>\n\n<pre><code>r.Reset(NewConn)\n</code></pre>\n"}], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 1, "accepted_answer_id": 36103384, "answer_count": 3, "score": 2, "last_activity_date": 1458400347, "creation_date": 1458397542, "question_id": 36102926, "link": "https://stackoverflow.com/questions/36102926/reusing-read-buffers-when-working-with-sockets", "title": "reusing read buffers when working with sockets", "body": "<p>I'd like to know the proper way to reuse the []byte buffer in go. I declare it like this</p>\n\n<pre><code>buf := make([]byte, 1024)\n</code></pre>\n\n<p>and then use like this</p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", addr)\n_, err = conn.read(buf)\n</code></pre>\n\n<p>I heard that declaring a new buffer isn't efficient since it involves memory allocations and that we should reuse existing buffers instead. However I am not sure if I just can pass the buffer again and it will be wiped or it can hold parts of previous messages (especially if the current message from socket is shorter than prev.one)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458397853, "post_id": 36102725, "comment_id": 59848519, "body": "<code>go run</code> compiles your program and runs it in another process. Have you tried compiling the binary and running it directly?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user246672"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1458397930, "post_id": 36102725, "comment_id": 59848545, "body": "That wasn&#39;t it, but thanks for trying."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user246672"}, "is_accepted": false, "score": 1, "last_activity_date": 1458398368, "last_edit_date": 1458398368, "creation_date": 1458397899, "answer_id": 36102973, "question_id": 36102725, "link": "https://stackoverflow.com/questions/36102725/how-to-output-to-a-process-substitution-file-in-go/36102973#36102973", "title": "How to output to a process substitution file in Go?", "body": "<p>Wrong form of process substitution:</p>\n\n<p><code>$ go run test_fd.go &gt;(cat)</code></p>\n\n<ul>\n<li><code>&lt;(...)</code> is <strong>read-only</strong> from the process via some file, usually  <code>/dev/fd/*</code></li>\n<li><code>&gt;(...)</code> is <strong>write-only</strong> from the process via some file usually <code>/dev/fd/*</code></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user246672"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1458398368, "creation_date": 1458396393, "last_edit_date": 1458398115, "question_id": 36102725, "link": "https://stackoverflow.com/questions/36102725/how-to-output-to-a-process-substitution-file-in-go", "title": "How to output to a process substitution file in Go?", "body": "<p>I must missing something basic because the following is not working as expected.</p>\n\n<p><code>go run test_fd.go &lt;(cat)</code> under either bash or zsh results in the following:</p>\n\n<h3>Expected output</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ go run test_fd.go &lt;(cat) # where n is some fd number\nfd {{n}} filename /dev/fd/{{n}}\nHello!\n</code></pre>\n\n<h3>Actual output (Zsh)</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ go run test_fd.go &lt;(cat)\nfd 11 filename /dev/fd/11\npanic: Write() err write /dev/fd/11: bad file descriptor\n\ngoroutine 1 [running]:\npanic(0xefe80, 0xc820010200)\n    /usr/local/Cellar/go/1.6/libexec/src/runtime/panic.go:464 +0x3e6\nmain.main()\n    /Users/bmf/Projects/piper/main.go:32 +0x515\nexit status 2\n</code></pre>\n\n<h3>Actual output (Bash)</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ go run main.go &lt;(cat)\nfd 63 filename /dev/fd/63\npanic: Write() err write /dev/fd/63: bad file descriptor\n\ngoroutine 1 [running]:\npanic(0xefe80, 0xc82006c240)\n    /usr/local/Cellar/go/1.6/libexec/src/runtime/panic.go:464 +0x3e6\nmain.main()\n    /Users/bmf/Projects/piper/main.go:32 +0x515\nexit status 2\n</code></pre>\n\n<h3>Source</h3>\n\n<pre><code>// test_fd.go\npackage main\n\nimport (\n  \"fmt\"\n  \"os\"\n  \"regexp\"\n  \"strconv\"\n)\n\nvar fdRegex = regexp.MustCompile(`\\A/dev/fd/(\\d+)\\z`)\n\nfunc main() {\n  for _, filename := range os.Args {\n\n    fdStrMatch := fdRegex.FindStringSubmatch(filename)\n    if len(fdStrMatch) != 2 {\n      continue\n    }\n    fd, _ := strconv.Atoi(fdStrMatch[1]) // fdStrMatch[1] is \\d+\n    fmt.Fprintf(os.Stderr, \"fd %d filename %s\\n\", fd, filename)\n    f := os.NewFile(uintptr(fd), filename)\n    /*\n        f, err := os.OpenFile(filename, os.O_CREATE|os.O_WRONLY, 0777) // have tried many combinations of modes \n      if err != nil {\n        panic(fmt.Sprintf(\"Create() err %v\", err))\n      }\n    */\n    _, err := f.Write([]byte(\"Hello!\\n\"))\n    if err != nil {\n      panic(fmt.Sprintf(\"Write() err %v\", err))\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": true, "score": 3, "last_activity_date": 1458394792, "creation_date": 1458394792, "answer_id": 36102469, "question_id": 36102417, "link": "https://stackoverflow.com/questions/36102417/go-test-reports-incorrect-statement-coverage/36102469#36102469", "title": "&quot;go test&quot; reports incorrect statement coverage", "body": "<p>Are you sure you need that <code>-run=Coverage</code> flag in your go test? This means it will only run tests that match <code>Coverage</code>. If you just want to generate a cover profile for that tests, run <code>go test -coverprofile c.out github.com/suzaku/dummage</code>. Then you may run <code>go tool cover -html c.out</code> to see the HTML report.</p>\n\n<p>If you added <code>-run=Coverage</code> on purpose, then it's expected behavior - the amount of code that runs during <code>-run=Coverage</code> is much less than while running all tests, and the test coverage is calculated for the entire package.</p>\n"}], "owner": {"reputation": 26911, "user_id": 225262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/10f7602ff38f6486cb1580052746fc05?s=128&d=identicon&r=PG", "display_name": "satoru", "link": "https://stackoverflow.com/users/225262/satoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "accepted_answer_id": 36102469, "answer_count": 1, "score": 0, "last_activity_date": 1458806741, "creation_date": 1458394472, "last_edit_date": 1458806741, "question_id": 36102417, "link": "https://stackoverflow.com/questions/36102417/go-test-reports-incorrect-statement-coverage", "title": "&quot;go test&quot; reports incorrect statement coverage", "body": "<p>I have a <a href=\"https://github.com/suzaku/dummage\" rel=\"nofollow\">package</a> with only two Go file: one defines the main function and the other is for the tests.</p>\n\n<p>Now assume that I have <code>cd</code> into this package and run the following command:</p>\n\n<pre><code>$ go test -cover\nPASS\ncoverage: 41.8% of statements\nok      github.com/suzaku/dummage       0.010s\n</code></pre>\n\n<p>As you can see, this works correctly.</p>\n\n<p>But I want to generate a HTML report, so after some googling I use the following command:</p>\n\n<pre><code>$ go test -run=Coverage -coverprofile=c.out github.com/suzaku/dummage\nok      github.com/suzaku/dummage       0.010s  coverage: 1.8% of statements\n</code></pre>\n\n<p>Note that this time the coverage drops to 1.8%.</p>\n\n<p>What can I do to fix this?</p>\n"}]