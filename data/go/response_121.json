[{"tags": ["go", "mutex", "race-condition"], "answers": [{"tags": [], "owner": {"reputation": 4668, "user_id": 71109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/050bf4a3339a6bd7510f96d1e9f742ef?s=128&d=identicon&r=PG", "display_name": "ChrisH", "link": "https://stackoverflow.com/users/71109/chrish"}, "is_accepted": false, "score": 1, "last_activity_date": 1493857079, "creation_date": 1493857079, "answer_id": 43771891, "question_id": 43771733, "link": "https://stackoverflow.com/questions/43771733/race-condition-even-when-using-sync-mutex-in-golang/43771891#43771891", "title": "Race condition even when using sync.Mutex in golang", "body": "<p>The two lines that read and write the counter pointer are not protected by the mutex and are done concurrently from multiple goroutines.</p>\n\n<pre><code>func incrementor(s string) {\n    for i := 0; i &lt; 20; i++ {\n        x := counter  // &lt;-- this pointer read\n        x.Add()\n        counter = x   // &lt;-- races with this pointer write\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1493858750, "last_edit_date": 1493858750, "creation_date": 1493857262, "answer_id": 43771914, "question_id": 43771733, "link": "https://stackoverflow.com/questions/43771733/race-condition-even-when-using-sync-mutex-in-golang/43771914#43771914", "title": "Race condition even when using sync.Mutex in golang", "body": "<p>You have a number of race conditions, all pointed out specifically by the race detector:</p>\n\n<pre><code>    x := counter      // this reads the counter value without a lock\n    fmt.Println(&amp;x.c)\n    x.Add()\n    counter = x       // this writes the counter value without a lock\n    time.Sleep(time.Duration(rand.Intn(3)) * time.Millisecond)\n    fmt.Println(s, i, \"Counter:\", x.c) // this reads the c field without a lock\n</code></pre>\n\n<ul>\n<li><p>race #1 is between the read and the write of the <code>counter</code> value in <code>incrementor</code></p></li>\n<li><p>race #2 is between the concurrent writes to the <code>counter</code> value in <code>incrementor</code></p></li>\n<li><p>race #3 is between the read of the <code>x.c</code> field in <code>fmt.Println</code>, and the increment to <code>x.c</code> in the <code>Add</code> method. </p></li>\n</ul>\n"}], "owner": {"reputation": 7968, "user_id": 485676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b9bd46ef45b1c9e0c7cbe422c0326e5?s=128&d=identicon&r=PG", "display_name": "Nemoden", "link": "https://stackoverflow.com/users/485676/nemoden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "accepted_answer_id": 43771914, "answer_count": 2, "score": 4, "last_activity_date": 1493858750, "creation_date": 1493855197, "question_id": 43771733, "link": "https://stackoverflow.com/questions/43771733/race-condition-even-when-using-sync-mutex-in-golang", "title": "Race condition even when using sync.Mutex in golang", "body": "<p>Complete code is here: <a href=\"https://play.golang.org/p/ggUoxtcv5m\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ggUoxtcv5m</a>\n<code>go run -race main.go</code> says there is a race condition there which I fail to explain.\nThe program outputs correct final result, though.</p>\n\n<p>The essence:</p>\n\n<pre><code>type SafeCounter struct {\n    c int\n    sync.Mutex\n}\n\nfunc (c *SafeCounter) Add() {\n    c.Lock()\n    c.c++\n    c.Unlock()\n}\n\nvar counter *SafeCounter = &amp;SafeCounter{} // global\n</code></pre>\n\n<p>use <code>*SafeCounter</code> in incrementor:</p>\n\n<pre><code>func incrementor(s string) {\n    for i := 0; i &lt; 20; i++ {\n        x := counter\n        x.Add()\n        counter = x\n    }\n}\n</code></pre>\n\n<p>The <code>incrementor</code> method is spawned twice in <code>main</code>:</p>\n\n<pre><code>func main() {\n    go incrementor()\n    go incrementor()\n    // some other non-really-related stuff like\n    // using waitGroup is ommited here for problem showcase\n}\n</code></pre>\n\n<p>So, as I said, <code>go run -race main.go</code> will always say there is a race cond found.</p>\n\n<p>Also, the final result is always correct (at least I've run this program for a number of times and it always say final counter is 40, which is correct).\nBUT, the program prints incorrect values in the beginning so you can get something like:</p>\n\n<pre><code>Incrementor1: 0 Counter: 2\nIncrementor2: 0 Counter: 3\nIncrementor2: 1 Counter: 4\n// ang the rest is ok\n</code></pre>\n\n<p>so, printing out <code>1</code> is missing there.</p>\n\n<p>Can somebody explain why there is a race condition there is my code?</p>\n"}, {"tags": ["arrays", "go", "base64"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1493854898, "creation_date": 1493854898, "answer_id": 43771692, "question_id": 43771601, "link": "https://stackoverflow.com/questions/43771601/why-am-i-getting-an-index-out-of-range-error-when-base64-encoding-a-byte-array/43771692#43771692", "title": "Why am I getting an &quot;index out of range&quot; error when base64 encoding a byte array?", "body": "<p>Allocate space for the output. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte(\"string of data\")\n    encodedData := make([]byte, base64.StdEncoding.EncodedLen(len(data)))\n    base64.StdEncoding.Encode(encodedData, data)\n    fmt.Println(encodedData)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[99 51 82 121 97 87 53 110 73 71 57 109 73 71 82 104 100 71 69 61]\n</code></pre>\n\n<p><code>var encodedData []byte</code> is zero bytes. Therefore, <code>index out of range</code></p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1493855049, "creation_date": 1493855049, "answer_id": 43771708, "question_id": 43771601, "link": "https://stackoverflow.com/questions/43771601/why-am-i-getting-an-index-out-of-range-error-when-base64-encoding-a-byte-array/43771708#43771708", "title": "Why am I getting an &quot;index out of range&quot; error when base64 encoding a byte array?", "body": "<p>Because <a href=\"https://golang.org/pkg/encoding/base64/#Encoding.Encode\" rel=\"nofollow noreferrer\">Encode</a> expects the <code>dst</code> slice to be allocated to the correct length.</p>\n\n<blockquote>\n  <p>Encode encodes src using the encoding enc, writing\n  EncodedLen(len(src)) bytes to dst.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 303, "user_id": 2829757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0231f62bf3e26f7d0585656f563b9a52?s=128&d=identicon&r=PG&f=1", "display_name": "jsc", "link": "https://stackoverflow.com/users/2829757/jsc"}, "edited": false, "score": 0, "creation_date": 1493859682, "post_id": 43771736, "comment_id": 74585569, "body": "Thanks for the in-depth answer! How would the encoded data then be decoded?"}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "reply_to_user": {"reputation": 303, "user_id": 2829757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0231f62bf3e26f7d0585656f563b9a52?s=128&d=identicon&r=PG&f=1", "display_name": "jsc", "link": "https://stackoverflow.com/users/2829757/jsc"}, "edited": false, "score": 1, "creation_date": 1493860432, "post_id": 43771736, "comment_id": 74585739, "body": "I&#39;m confident you can find the answer to that question <a href=\"https://golang.org/pkg/encoding/base64/\" rel=\"nofollow noreferrer\">in the documentation</a> @jscionti :-)"}], "tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 9, "last_activity_date": 1493855228, "creation_date": 1493855228, "answer_id": 43771736, "question_id": 43771601, "link": "https://stackoverflow.com/questions/43771601/why-am-i-getting-an-index-out-of-range-error-when-base64-encoding-a-byte-array/43771736#43771736", "title": "Why am I getting an &quot;index out of range&quot; error when base64 encoding a byte array?", "body": "<p>The error is:</p>\n\n<pre><code>panic: runtime error: index out of range\n\ngoroutine 1 [running]:\nencoding/base64.(*Encoding).Encode(0xc420056000, 0x0, 0x0, 0x0, 0xc42003bf30, 0xe, 0x20)\n        /usr/lib/go/src/encoding/base64/base64.go:113 +0x27b\nmain.main()\n        /home/martin/a.go:11 +0x9b\nexit status 2\n\nshell returned 1\n</code></pre>\n\n<p>If we look at <code>/usr/lib/go/src/encoding/base64/base64.go</code> line 113, we see (abbreviated):</p>\n\n<pre><code>n := (len(src) / 3) * 3\nfor si &lt; n {\n    // [..]\n    dst[di+0] = enc.encode[val&gt;&gt;18&amp;0x3F]\n    dst[di+0] = enc.encode[val&gt;&gt;18&amp;0x3F]\n    dst[di+1] = enc.encode[val&gt;&gt;12&amp;0x3F]\n    // [..]\n}\n</code></pre>\n\n<p>In other words, this function <em>directly</em> sets the index of <code>dst</code>. The length of <code>var encodedData []byte</code> is zero, so you get the <code>index out of range</code> error.</p>\n\n<p>One way to fix it would be to change the line to:</p>\n\n<pre><code>encodedData := make([]byte, base64.StdEncoding.EncodedLen(len(data)))\n</code></pre>\n\n<p>Which will make an array of the size in the second argument. Base64 encoded data is larger than the input, hence the <code>base64.StdEncoding.EncodedLen()</code>.</p>\n\n<p>However, this is hardly the best way to fix it. <a href=\"https://golang.org/pkg/encoding/base64/#Encoding.Encode\" rel=\"noreferrer\">The documentation</a> mentions:</p>\n\n<blockquote>\n  <p>Encode is not appropriate for use on individual blocks of a large data stream. Use NewEncoder() instead. </p>\n</blockquote>\n\n<p>Rewriting the code to <code>NewEncoder()</code> looks like:</p>\n\n<pre><code>func main() {\n    data := []byte(\"string of data\")\n\n    encodedData := &amp;bytes.Buffer{}\n    encoder := base64.NewEncoder(base64.StdEncoding, encodedData)\n    defer encoder.Close()\n    encoder.Write(data)\n\n    fmt.Println(encodedData)\n}\n</code></pre>\n\n<p>There also some other useful functions, such as <code>EncodeToString()</code> which make the above a bit shorter and more convenient: <code>encodedData  := base64.StdEncoding.EncodeToString(data)</code>.</p>\n"}], "owner": {"reputation": 303, "user_id": 2829757, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0231f62bf3e26f7d0585656f563b9a52?s=128&d=identicon&r=PG&f=1", "display_name": "jsc", "link": "https://stackoverflow.com/users/2829757/jsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2847, "favorite_count": 2, "accepted_answer_id": 43771736, "answer_count": 3, "score": 5, "last_activity_date": 1493855228, "creation_date": 1493854298, "question_id": 43771601, "link": "https://stackoverflow.com/questions/43771601/why-am-i-getting-an-index-out-of-range-error-when-base64-encoding-a-byte-array", "title": "Why am I getting an &quot;index out of range&quot; error when base64 encoding a byte array?", "body": "<p>When encoding a byte array into a base64 byte array, the below code produces a runtime <code>index out of range</code> error. How can this be resolved?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/base64\"\n)\n\nfunc main() {\n    data := []byte(\"string of data\")\n    var encodedData []byte\n    base64.StdEncoding.Encode(encodedData, data)\n    fmt.Println(encodedData)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/W5uLpFVWBy\" rel=\"noreferrer\">Playground here</a></p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493853545, "post_id": 43771258, "comment_id": 74584330, "body": "Dave, <code>reflect.ValueOf(x)</code> is not the same as <code>reflect.ValueOf(reflect.ValueOf(x))</code>. Just do <code>res[1].Interface().(error)</code>. <a href=\"https://play.golang.org/p/caS0GQ-9b3\" rel=\"nofollow noreferrer\">play.golang.org/p/caS0GQ-9b3</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4318224"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493862315, "post_id": 43771258, "comment_id": 74586251, "body": "Thanks for the quick response.  Your example is not quite the same though, and if I change the return statement to <code>return nil</code> I get a panic:"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4318224"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493862930, "post_id": 43771258, "comment_id": 74586406, "body": "Sorry, I&#39;m not so good at formatting a comment.  That should have continued: <code>reflect.Value &lt;nil&gt; &lt;nil&gt; &lt;nil&gt; panic: interface conversion: interface is nil, not error </code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1493863772, "post_id": 43771258, "comment_id": 74586629, "body": "Use <code>err, _ := res[1].Interface().(error)</code> to avoid the panic on nil errors."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4318224"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493903479, "post_id": 43771258, "comment_id": 74608066, "body": "Of course, thanks.  I had removed that early on because it masks the behavior of the other mistaken approaches I used.  I was too quick on my earlier response.  Thanks so much for SO and the gracious folks who contribute!  Is it useful for @mkopriva to post an official answer so I can mark as accepted?  I&#39;m not seeing how to upvote the comment  by mkopriva containing the answer..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493906356, "post_id": 43771258, "comment_id": 74610393, "body": "Since you&#39;ve already got this working @Dave this might be irrelevant, but please note that you declared <code>var errToCaller *error</code> and without ever setting <code>errToCaller</code> to an allocated pointer value, you later try to dereference it <code>*errToCaller = ...</code> which is not gonna work, even if everything else was fine your program would panic on those lines. The reason for this is because in Go you <i>cannot dereference <code>nil</code> pointers</i>."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1493905698, "last_edit_date": 1495541878, "creation_date": 1493905698, "answer_id": 43784716, "question_id": 43771258, "link": "https://stackoverflow.com/questions/43771258/how-can-i-assign-a-reflect-value-that-holds-an-error-object-to-an-ordinary-varia/43784716#43784716", "title": "How can I assign a reflect.Value that holds an error object to an ordinary variable of type error?", "body": "<p>The value returned from <a href=\"https://golang.org/pkg/reflect/#Value.Call\" rel=\"nofollow noreferrer\">Call</a> is a slice of <code>reflect.Value</code>s, so there is no need to wrap the result in another <code>reflect.ValueOf</code> call like you do in your example code:</p>\n\n<pre><code>reflect.ValueOf(res[1]) // not what you want\n</code></pre>\n\n<p>Doing that will change the value's underlying type from <code>error</code> to <code>reflect.Value</code> which is the reason why subsequently calling <code>.Interface().(error)</code> causes the program to panic.</p>\n\n<p>So to fix your code just call <code>.Interface().(error)</code> directly on the result like so:</p>\n\n<pre><code>res[1].Interface().(error)\n</code></pre>\n\n<p>And, as already pointed out by <a href=\"https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n\">Cerise Lim\u00f3n</a>, when you do <em>type assertion</em> it's good practice to use the \"comma ok\" idiom to avoid unnecessary panics.</p>\n\n<pre><code>err, ok := res[1].Interface().(error)\nif !ok {\n     // oops\n}\n</code></pre>\n\n<p>Or, a bit more concise alternative:</p>\n\n<pre><code>if err, ok := res[1].Interface().(error); ok &amp;&amp; err != nil {\n     // it's a non-nil error\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4318224"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 0, "accepted_answer_id": 43784716, "answer_count": 1, "score": 2, "last_activity_date": 1493905698, "creation_date": 1493852043, "last_edit_date": 1495540480, "question_id": 43771258, "link": "https://stackoverflow.com/questions/43771258/how-can-i-assign-a-reflect-value-that-holds-an-error-object-to-an-ordinary-varia", "title": "How can I assign a reflect.Value that holds an error object to an ordinary variable of type error?", "body": "<p>I am trying to write a function that returns back to its caller an error result taken from the result slice of <code>reflect.ValueOf(somefunc).Call(someargs)</code>.</p>\n\n<p>I've tried numerous variants of refer. calls, and type assertions. but cannot seem to get the compiler to let me put the actual concrete value from the <code>reflect.Value</code> slice back into an ordinary error variable.</p>\n\n<p>Here's the code, using <code>os.Getwd</code> as the function:</p>\n\n<pre><code>   var somefunc interface{}\n   var errToCaller *error\n   somefunc = os.Getwd\n   ftype := reflect.TypeOf(somefunc)\n   errType := reflect.TypeOf(errToCaller).Elem()\n   resType := ftype.Out(1)\n   fmt.Println(\"resType.Implements(errType) = \",\n      resType.Implements(errType))\n   res := reflect.ValueOf(somefunc).Call([]reflect.Value{})\n   fmt.Printf(\"res[1] as %%v = %v\\n\", res[1])\n   fmt.Printf(\"res[1] as %%#v = %#v\\n\", res[1])\n   fmt.Printf(\"ValueOf(res[1]) as %%v = %v\\n\",\n      reflect.ValueOf(res[1]))\n   fmt.Printf(\"ValueOf(res[1]) as %%#v = %#v\\n\",\n      reflect.ValueOf(res[1]))\n   fmt.Printf(\"ValueOf(res[1]).Type() as %%#v = %#v\\n\",\n      reflect.ValueOf(res[1]).Type())\n   fmt.Printf(\"ValueOf(res[1]).Interface() as %%#v = %#v\\n\",\n      reflect.ValueOf(res[1]).Interface())\n   // *errToCaller = reflect.ValueOf(res[1])\n   // *errToCaller = reflect.ValueOf(res[1]).Interface()\n   // *errToCaller = reflect.ValueOf(res[1]).Interface().(error)\n</code></pre>\n\n<p>With the following output:</p>\n\n<pre><code>resType.Implements(errType) =  true\nres[1] as %v = &lt;nil&gt;\nres[1] as %#v = error(nil)\nValueOf(res[1]) as %v = &lt;error Value&gt;\nValueOf(res[1]) as %#v = reflect.Value{typ:(*reflect.rtype)(0x4b9a60), ptr:(unsafe.Pointer)(0xc42000a3f0), flag:0x94}\nValueOf(res[1]).Type() as %#v = &amp;reflect.rtype{size:0x18, ptrdata:0x10, hash:0x500c1abc, tflag:0x7, align:0x8, fieldAlign:0x8, kind:0x19, alg:(*reflect.typeAlg)(0x4a62d0), gcdata:(*uint8)(0x4daa41), str:21371, ptrToThis:184032}\nValueOf(res[1]).Interface() as %#v = error(nil)\n</code></pre>\n\n<p>I've abbreviated the example to remove lots of other Printf statements that indicate (to me at least) that the types are the same (even in what I think are the relevant fields of the <code>reflect.Value</code> struct).  <strong>Why, when all of the various print statements seem to be telling me the result is an error value, can't I assign it to my local variable?</strong></p>\n\n<p>Uncommenting the first assignment in the code example above results in this complaint from the compiler:</p>\n\n<pre><code>./passerror.go:30: cannot use reflect.ValueOf(res[1]) (type reflect.Value) as type error in assignment:\n        reflect.Value does not implement error (missing Error method)\n</code></pre>\n\n<p>So I figured I needed the Interface() result, but still no luck (using the 2nd assignment commented out above):</p>\n\n<pre><code>./passerror.go:31: cannot use reflect.ValueOf(res[1]).Interface() (type interface {}) as type error in assignment:\n        interface {} does not implement error (missing Error method)\n</code></pre>\n\n<p>Finally, a type assertion on the Interface() return value causes a panic:</p>\n\n<pre><code>panic: interface conversion: reflect.Value is not error: missing method Error\n</code></pre>\n\n<p>No matter what I've tried, I can't seem to escape from the dreaded <code>reflect.Value</code> which prevents me from doing the assignment to ordinary error variable.  I have tried <code>Set()</code> also without success, but perhaps incorrectly.</p>\n\n<p>I would be forever grateful for insight and/or the magic incantation to do this.</p>\n\n<p><strong>EDIT</strong>\nThanks <a href=\"https://stackoverflow.com/users/965900/mkopriva\">https://stackoverflow.com/users/965900/mkopriva</a> for the spot on comment.  The code requires a real error variable, not just a *error, after which <code>localerr = res[n].Interface().(error)</code> worked perfectly.  (also changed function to os.Chdir using a bogus argument to trigger a non-nil error value)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1493850591, "creation_date": 1493850591, "answer_id": 43771026, "question_id": 43770692, "link": "https://stackoverflow.com/questions/43770692/marshal-unmarshal-reflect-type/43771026#43771026", "title": "Marshal/unMarshal reflect.Type", "body": "<p>Short answer: No, it's not possible.</p>\n\n<p>Slightly longer answer: Since <a href=\"https://golang.org/pkg/reflect/#TypeOf\" rel=\"nofollow noreferrer\">relfect.Type</a>, as returned by <code>TypeOf</code>, is an <em>interface type</em> implemented by the <strong>unexported</strong> type <a href=\"https://golang.org/src/reflect/type.go?s=#L292\" rel=\"nofollow noreferrer\">rtype</a>, none of whose fields are exported and whose method set does not contain the <code>MarshalJSON/UnmarshalJSON</code> methods, you cannot marshal or unmarshal a <code>reflect.Type</code> value as is.</p>\n"}], "owner": {"reputation": 87, "user_id": 6575937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02be9ef714436367018c1a7edda58c84?s=128&d=identicon&r=PG&f=1", "display_name": "Erez.L", "link": "https://stackoverflow.com/users/6575937/erez-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 43771026, "answer_count": 1, "score": 1, "last_activity_date": 1493850591, "creation_date": 1493848738, "last_edit_date": 1493849110, "question_id": 43770692, "link": "https://stackoverflow.com/questions/43770692/marshal-unmarshal-reflect-type", "title": "Marshal/unMarshal reflect.Type", "body": "<p>I created map[string]interface{} and i want to pass multiple types through the map between 2 reset services.</p>\n\n<p>every time i marshal i get empty map in the field that should contain reflect.Type.</p>\n\n<pre><code>ServiceType:map[]\n</code></pre>\n\n<p>is it even possible?</p>\n\n<p>code for testing: (the KeyValuePair will represent a single value of the map) and the MessageService can be replaced with any type of course</p>\n\n<pre><code>data := GenericHandlers.KeyValuePair{Key:\"ServiceType\",Value:reflect.TypeOf(MessageService.MessageService{})}\nJson , _ := json.Marshal(data)\nresKvp := GenericHandlers.KeyValuePair{}\nerr := json.Unmarshal(Json,&amp;resKvp)\nif(err != nil){\n     log.Println(err.Error())\n}\nfmt.Println(resKvp)\n\n\ntype KeyValuePair struct{\n        Key string\n        Value interface{}\n}\n</code></pre>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 3, "creation_date": 1493848848, "post_id": 43770667, "comment_id": 74582809, "body": "In my mind, <i>values</i> have types. Not names. But in statically typed languages, a given name can only refer to values of the type it was declared to refer to. It cannot change. That is why they are <i>statically</i> typed. Just think about it as a promise to the compiler: &quot;in this scope, <code>x</code> will always refer to a value of type <code>int</code>&quot;"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 1, "creation_date": 1493849085, "post_id": 43770667, "comment_id": 74582911, "body": "@juanpa.arrivillaga In Go and other statically typed languages, both variables and values have types, and the declared type of the variable must match the type of the value that it holds."}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 1, "creation_date": 1493849252, "post_id": 43770667, "comment_id": 74582971, "body": "@DYZ yeah, I suppose that is correct. Values and Names are both said to be &quot;typed&quot;. In any event, it seems like a subtle semantic difference with no concrete difference."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493883129, "post_id": 43770667, "comment_id": 74593948, "body": "Go does not have the notion of &quot;name&quot; like python does. Go has the concept of a &quot;variable&quot;. <code>x</code> is a variable. Variables have types and values. The type of variable <code>x</code> is <code>int</code> and the value is <code>3</code>. No names involved. The concept &quot;variable&quot; is closely related to the idea of &quot;has a certain, fixed memory address and fixed memory layout&quot;."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1493896802, "post_id": 43770667, "comment_id": 74603023, "body": "@juanpa.arrivillaga x:=3 syntax in GO leads to a confusion, because that syntax looks similar to python, despite GO compiler does type inference to find the type of x at compile time. Not sure, why static typed languages provide such syntax?"}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493926250, "post_id": 43770667, "comment_id": 74623194, "body": "@Volker I would have a small quibble: Go does implicitly have a concept of &quot;names&quot; since it does have classic &quot;variables&quot;. A variable as such consists of an identifier (a name) and an associated storage location (chunk of organized memory). In Python, it is a better mental model to just think of variables as just names, with no associated storage location. But if you come from statically typed languages closer to the metal like C, one might think in terms of classic variables if you limit variables in Python to Py_Object* pointer  types (for CPython... implementation detail yadda yadda)."}, {"owner": {"reputation": 63648, "user_id": 5014455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JTknr.png?s=128&g=1", "display_name": "juanpa.arrivillaga", "link": "https://stackoverflow.com/users/5014455/juanpa-arrivillaga"}, "edited": false, "score": 0, "creation_date": 1493926531, "post_id": 43770667, "comment_id": 74623359, "body": "@overexchange Most consider it a feature, I would say. I like type inference. It is liberating to be able to use powerful type systems in languages like Haskell and Scala without so much boilerplate! As for Go, I&#39;ve only dabbled, but I enjoy it. It is gives you the speed of a statically typed, compiled language like Java or C++ but it feels almost like writing Python, despite the curly braces."}], "answers": [{"tags": [], "owner": {"reputation": 13815, "user_id": 6575931, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CumJFhlEBdA/AAAAAAAAAAI/AAAAAAAAi5U/sqexnazvXek/photo.jpg?sz=128", "display_name": "Uriel", "link": "https://stackoverflow.com/users/6575931/uriel"}, "is_accepted": true, "score": 5, "last_activity_date": 1493926554, "last_edit_date": 1493926554, "creation_date": 1493850131, "answer_id": 43770942, "question_id": 43770667, "link": "https://stackoverflow.com/questions/43770667/name-value-go-vs-python/43770942#43770942", "title": "Name &amp; value - Go vs Python", "body": "<p>Python variables are bound to instances of classes that are assigned to them dynamically over the course of the program. Therefore, and especially with mutable objects, they are merely pointers who contain information about their data location and the type of the data they point to. That's why, upon assigning a new value, you are creating a new instance (which is your main interest) and bind the variable name to it, so the type is related to the <em>value</em>, not the variable itself.</p>\n\n<pre><code>&gt;&gt;&gt; x = 3; id(x)\n1996006560\n&gt;&gt;&gt; x = 'str'; id(x)\n1732654458784\n</code></pre>\n\n<hr>\n\n<p>Go variables on the other hand, are serving (when not pointers) as stronghold memory locations, as the language is compiled and the variables get a constant \"job\" to keep a certain type of information (which could be a pointer as well). Therefore, a variable would almost certainly maintain his memory along the program, will have constant datatype properties, and, you could say the variable itself is of a certain type (and not of a semi-pointer type).</p>\n\n<pre><code>package main\nimport . \"fmt\"\nfunc main () {\n    x := \"str\"; Println(&amp;x)         // 0xc04203a1c0\n    x = \"Hello world!\"; Println(&amp;x) // 0xc04203a1c0\n}\n</code></pre>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 43770942, "answer_count": 1, "score": 3, "last_activity_date": 1493932980, "creation_date": 1493848670, "last_edit_date": 1493932980, "question_id": 43770667, "link": "https://stackoverflow.com/questions/43770667/name-value-go-vs-python", "title": "Name &amp; value - Go vs Python", "body": "<p>In python, with below code,</p>\n\n<pre><code>x = 3\nx='str'\n</code></pre>\n\n<p>allows <code>x</code> to first point to <code>int</code> type object and then to <code>str</code> type object, because python is <strong>dynamic typed</strong>. <code>type(x)</code> gives type of value(<code>3</code> or <code>str</code>) <strong>but not</strong> type of name <code>x</code>.</p>\n\n<p>In-fact, <code>x</code> does not store value <code>3</code> but point to <code>int</code> type object whose value is <code>3</code></p>\n\n<hr>\n\n<p>In GO language, with below syntax,</p>\n\n<pre><code>func main() {\n        y := 2\n        fmt.Println(reflect.TypeOf(y)) // gives 'int'\n        y = \"str\" // Compile time error, because GO is static typed \n}\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>Is <code>int</code>, the type of name <code>y</code> or the type of value <code>2</code>?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493851094, "post_id": 43770426, "comment_id": 74583597, "body": "thanks for clarifying, I still need more help, if you can please also println the objects after unmarshalling."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493852242, "post_id": 43770426, "comment_id": 74583925, "body": "You mean printing the <code>json.RawMessage</code> objects? If so, <code>json.RawMessage</code> is just a slice of bytes, so you can print it as such, e.g. <a href=\"https://play.golang.org/p/jeCU6PIWYv\" rel=\"nofollow noreferrer\">play.golang.org/p/jeCU6PIWYv</a>. But I wonder, do you really want to use <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a>? It&#39;s purpose is to allow you to delay the decoding (or precomupte the encoding) of json... if you don&#39;t need those two features you are much better off using a concrete type instead."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493852652, "post_id": 43770426, "comment_id": 74584043, "body": "If you don&#39;t need that precompute/delay stuff @user2727195, you should use something like this instead: <a href=\"https://play.golang.org/p/VKf7HgAAID\" rel=\"nofollow noreferrer\">play.golang.org/p/VKf7HgAAID</a>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1493848056, "last_edit_date": 1493848056, "creation_date": 1493847532, "answer_id": 43770426, "question_id": 43770273, "link": "https://stackoverflow.com/questions/43770273/json-unmarshalling-without-struct/43770426#43770426", "title": "json unmarshalling without struct", "body": "<p>Your <code>json</code> is an <strong>array</strong> of objects, in Go the <code>encoding/json</code> package marshals/unmarshals <code>maps</code> to/from a json <strong>object</strong> and not an array, so you might want to allocate a <code>slice of maps</code> instead.</p>\n\n<pre><code>var objs []map[string]*json.RawMessage\nif err := json.Unmarshal([]byte(data), &amp;objs); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/3lieuNkoUU\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3lieuNkoUU</a></p>\n\n<p>If you don't want to use a slice you can always wrap your json array in an object.</p>\n\n<pre><code>var dataobj = `{\"arr\":` + data + `}`\nvar objmap map[string]*json.RawMessage\nif err := json.Unmarshal([]byte(dataobj), &amp;objmap); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XM8MmV0gbc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/XM8MmV0gbc</a></p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 2062520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53baf61e709c049b6d27f7c795f4ed5b?s=128&d=identicon&r=PG", "display_name": "codyoss", "link": "https://stackoverflow.com/users/2062520/codyoss"}, "is_accepted": false, "score": 7, "last_activity_date": 1493870516, "creation_date": 1493870516, "answer_id": 43773666, "question_id": 43770273, "link": "https://stackoverflow.com/questions/43770273/json-unmarshalling-without-struct/43773666#43773666", "title": "json unmarshalling without struct", "body": "<p>You can unmarshall to a <code>[]map[string]interface{}</code> as follows:</p>\n\n<pre><code>var objmap map[string]interface{}\nif err := json.Unmarshal(data, &amp;objmap); err != nil {\n    log.Fatal(err)\n}\nfmt.Println(objmap[0][\"href\"]) // to parse out your value\n</code></pre>\n\n<p>To see more on how unmarshalling works see here: <a href=\"https://godoc.org/encoding/json#Unmarshal\" rel=\"noreferrer\">https://godoc.org/encoding/json#Unmarshal</a></p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 9470957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F3y8Q.jpg?s=128&g=1", "display_name": "Rolas", "link": "https://stackoverflow.com/users/9470957/rolas"}, "is_accepted": false, "score": 1, "last_activity_date": 1604664542, "creation_date": 1604664542, "answer_id": 64714424, "question_id": 43770273, "link": "https://stackoverflow.com/questions/43770273/json-unmarshalling-without-struct/64714424#64714424", "title": "json unmarshalling without struct", "body": "<p>This is not direct answer but I think very useful</p>\n<p><strong>Json Unmarshal &amp; Indent without struct</strong></p>\n<pre><code>\nfunc JsonIndent (jsontext []byte) ([]byte,error) {\n    var err error\n    var jsonIndent []byte\n    var objmap map[string]*json.RawMessage\n    err = json.Unmarshal(jsontext, &objmap)\n    if err != nil {\n        return jsonIndent,err\n    }\n    jsonIndent, err = json.MarshalIndent(objmap,\"\", \"  \")\n    return jsonIndent,err\n}\n</code></pre>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7847, "favorite_count": 3, "answer_count": 3, "score": 5, "last_activity_date": 1604664542, "creation_date": 1493846732, "last_edit_date": 1495542363, "question_id": 43770273, "link": "https://stackoverflow.com/questions/43770273/json-unmarshalling-without-struct", "title": "json unmarshalling without struct", "body": "<p>I've following json </p>\n\n<pre><code>[{\"href\":\"/publication/192a7f47-84c1-445e-a615-ff82d92e2eaa/article/b;version=1493756861347\"},{\"href\":\"/publication/192a7f47-84c1-445e-a615-ff82d92e2eaa/article/a;version=1493756856398\"}]\n</code></pre>\n\n<p>Based on the given <a href=\"https://stackoverflow.com/questions/11066946/partly-json-unmarshal-into-a-map-in-go\">answer</a> I've tried following</p>\n\n<pre><code>var objmap map[string]*json.RawMessage\nerr := json.Unmarshal(data, &amp;objmap)\n</code></pre>\n\n<p>I'm getting empty array with following error. any suggestions?</p>\n\n<blockquote>\n  <p>json: cannot unmarshal array into Go value of type map[string]*json.RawMessage</p>\n</blockquote>\n"}, {"tags": ["unit-testing", "go", "interface", "mocking", "typing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493845720, "post_id": 43769695, "comment_id": 74581530, "body": "That&#39;s what <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">golang.org/doc/faq#convert_slice_of_interface</a> talks about. The problem is the slice and not the interface."}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 1, "creation_date": 1493845739, "post_id": 43769695, "comment_id": 74581539, "body": "Check out <a href=\"http://stackoverflow.com/a/12754757/859353\">stackoverflow.com/a/12754757/859353</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 7959546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c59a28109aaa304db6b086dd9dba39?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/7959546/david-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1493849741, "last_edit_date": 1493849741, "creation_date": 1493849438, "answer_id": 43770825, "question_id": 43769695, "link": "https://stackoverflow.com/questions/43769695/os-fileinfo-mock-not-matching/43770825#43770825", "title": "os.FileInfo mock not matching", "body": "<p><code>os.FileInfo</code> is interface and it can converted to <code>file</code>. But you try to convert <code>[]os.FileInfo</code> to <code>[]file</code>. Slice is not interface, and can not be asserted.</p>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 1341036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8661bc2ca2bc5be6e0639f86cee806f0?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1341036/matt"}, "is_accepted": false, "score": 0, "last_activity_date": 1582120108, "creation_date": 1582120108, "answer_id": 60301836, "question_id": 43769695, "link": "https://stackoverflow.com/questions/43769695/os-fileinfo-mock-not-matching/60301836#60301836", "title": "os.FileInfo mock not matching", "body": "<p>To elaborate on the other answer and comments, os.FileInfo does fulfill the <code>file</code> interface you've defined, but a slice of os.FileInfo does not implicitly convert to a slice of your <code>file</code> interface. A simple fix would be to have your <code>readFiles</code> do the conversion explicitly, e.g.</p>\n\n<pre><code>func readFiles() []file{\n    fileInfos, err := ioutil.ReadDir(\".\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    files := make([]file, len(fileInfos))\n    for i, fi := range fileInfos {\n        files[i] = fi\n    }\n\n    return files\n}\n</code></pre>\n"}], "owner": {"reputation": 118, "user_id": 5242249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b5d1d7cd49c7b4f0d01de3bde2e977?s=128&d=identicon&r=PG&f=1", "display_name": "J Polack", "link": "https://stackoverflow.com/users/5242249/j-polack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 554, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1582120108, "creation_date": 1493844336, "question_id": 43769695, "link": "https://stackoverflow.com/questions/43769695/os-fileinfo-mock-not-matching", "title": "os.FileInfo mock not matching", "body": "<p>in one of my golang Projects i went to mock the <code>os.FileInfo</code> for testcases.</p>\n\n<p>I am not sure if I understand the interface handling of golang correctly.\nAs far as I know the following piece of code should work, but I get an Compilererror saying that the interface does not match.</p>\n\n<p>I modified <a href=\"https://golang.org/pkg/io/ioutil/#example_ReadDir\" rel=\"nofollow noreferrer\">this</a> go-doc example a bit in case you want to test it out yourself.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n)\n\ntype file interface{\n    Name() string\n} \n\nfunc readFiles() []file{\n    files, err := ioutil.ReadDir(\".\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    return files\n}\n\nfunc main() {\n    files := readFiles()\n\n    for _, file := range files {\n        fmt.Println(file.Name())\n    }\n}\n</code></pre>\n\n<p>Following at the golang doc, the <code>ioutil.ReadDir(\".\")</code> should Return a slice of <code>os.FileInfo</code> which should be a specialisation of my selfwritten <code>file</code> interface.</p>\n\n<p>Can anyone help me out of this hell of misconceptions and entanglements, please?</p>\n\n<p>Thank you very much guys!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 1, "last_activity_date": 1493855627, "last_edit_date": 1493855627, "creation_date": 1493853691, "answer_id": 43771482, "question_id": 43769590, "link": "https://stackoverflow.com/questions/43769590/subtypes-supertypes-in-go/43771482#43771482", "title": "Subtypes Supertypes in go", "body": "<p>The second parameter of <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal</code></a> is a \"universal\" <code>interface{}</code> type. I think similar approach is applicable to your case.</p>\n\n<ol>\n<li><p>Define data type for storing web service properties which may differ for each entity, e.g.</p>\n\n<pre><code>type ServiceDescriptor struct {\n  URI string\n  //other field/properties...\n}\n</code></pre></li>\n<li><p>Function for populating the entity may look like</p>\n\n<pre><code>func RequestList(desc *ServiceDescriptor, v interface{}) error {\n    //Retrieve json data from web service\n    //some code\n\n    return json.Unmarshal(data, v)\n}\n</code></pre></li>\n<li><p>You can call the function to populate different type of entities, e.g.</p>\n\n<pre><code>desc := &amp;ServiceDescriptor{}\n\narticle := ArticleVO{}\ndesc.URI = \"article.uri\"\n//...\n//You must pass pointer to entity for 2nd param\nRequestList(desc, &amp;article)\n\ncollection := CollectionVO{}\ndesc.URI = \"collection.uri\"\n//...\n//You must pass pointer to entity for 2nd param\nRequestList(desc, &amp;collection)\n</code></pre></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493915898, "post_id": 43785924, "comment_id": 74617434, "body": "this sounds promising, I&#39;m proceeding with the project now the way it should be, will come back soon for questions if any."}], "tags": [], "owner": {"reputation": 5461, "user_id": 307881, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bfc59549c88454a426040bb7abaab3d1?s=128&d=identicon&r=PG", "display_name": "Vervious", "link": "https://stackoverflow.com/users/307881/vervious"}, "is_accepted": true, "score": 3, "last_activity_date": 1493908783, "creation_date": 1493908783, "answer_id": 43785924, "question_id": 43769590, "link": "https://stackoverflow.com/questions/43769590/subtypes-supertypes-in-go/43785924#43785924", "title": "Subtypes Supertypes in go", "body": "<p>This is where golang interfaces can shine.</p>\n\n<p>It's worth noting, however, that it's difficult to write subclass/inheritance code in golang. We'd prefer thinking of it as composition.</p>\n\n<pre><code>type EntityVO interface {\n    GetName() string\n    SetName(string) error\n    GetType() string\n    ...\n}\n\ntype EntityVOImpl struct {\n    EntityName    string\n    EntityType    string\n    PublicationId string\n    Version       string\n}\n\nfunc (e EntityVOImpl) GetName() string {\n    return e.EntityName\n}\n\n...\n\ntype ArticleVOImpl struct {\n    EntityVOImpl\n    ContentSize string\n    Created     string\n}\n\ntype CollectionVOImpl struct {\n    EntityVO\n    ProductId string\n    Position string\n}\n\n// CODE\n\nfunc (e *Entity) RequestList(entityVO valueObject.EntityVO) (valueObject.EntityVO, error) { \n    // some code\n}\n</code></pre>\n\n<p>In addition, as long as your interface files are shared, I don't think there should by any problem sending/marshalling/unmarshalling the structs over the wire.</p>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3254, "favorite_count": 0, "accepted_answer_id": 43785924, "answer_count": 2, "score": 5, "last_activity_date": 1493908783, "creation_date": 1493843961, "question_id": 43769590, "link": "https://stackoverflow.com/questions/43769590/subtypes-supertypes-in-go", "title": "Subtypes Supertypes in go", "body": "<p>Coming from OOP paradigms and porting a code from an OOP language, I come across a problem now which is solved in OOP via abstraction so I'm wondering how can I approach the following problem in Go which follows composition instead of inheritance.</p>\n\n<p>In this scenario my ValueObjects (DTO, POJO etc.) are composed of other ValueObjects. I'm populating them through web service calls that returns json so basically my functions/method calls are common for all types and subtypes.</p>\n\n<p>My super type EntityVO</p>\n\n<pre><code>type EntityVO struct {\n    EntityName    string\n    EntityType    string\n    PublicationId string\n    Version       string\n}\n</code></pre>\n\n<p>A subtype 1 composed with EntityVO</p>\n\n<pre><code>type ArticleVO struct {\n    EntityVO\n    ContentSize string\n    Created     string\n}\n</code></pre>\n\n<p>subtype 2 composed with EntityVO with it's own unique set of fields</p>\n\n<pre><code>type CollectionVO struct {\n    EntityVO\n    ProductId string\n    Position string\n}\n</code></pre>\n\n<p>I'm calling web services to retrieve data and populate these VOs.</p>\n\n<p>Earlier I had one function to call the web service and populate the data but now I'm duplicating the code for each VO.</p>\n\n<pre><code>type Article struct{}\n\nfunc (a *Article) RequestList(articleVO *valueObject.ArticleVO) (*valueObject.ArticleVO, error) { \n    // some code\n}\n</code></pre>\n\n<p>Duplicating the same code but changing the signature.</p>\n\n<pre><code>type Collection struct{}\n\nfunc (c * Collection) RequestList(collectionVO *valueObject.CollectionVO) (*valueObject.ArticleVO, error) { \n    // some code - duplicate same as above except method signature\n}\n</code></pre>\n\n<p>and I've several entities and just because my VO's are different I'm forced to duplicate the code and cater to each type of VO I've. In OOP sub types can be passed to a function accepting super types but not in go, so wondering how it should be done so I don't end up duplicated code that's different in signature only?</p>\n\n<p>Any advice for a better approach in this kind of scenario?</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "edited": false, "score": 0, "creation_date": 1493847988, "post_id": 43768948, "comment_id": 74582474, "body": "I don&#39;t know if you need to change the default context package in the gauss project. <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">golang.org/pkg/context</a>"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 2, "creation_date": 1493872302, "post_id": 43768948, "comment_id": 74588777, "body": "Remove the directory <code>gauss&#47;vendor&#47;golang.org&#47;x&#47;net&#47;context</code>"}, {"owner": {"reputation": 655, "user_id": 1732950, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/055cd772017bfa1cd64b32915daabce5?s=128&d=identicon&r=PG", "display_name": "node42", "link": "https://stackoverflow.com/users/1732950/node42"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1493913101, "post_id": 43768948, "comment_id": 74615610, "body": "@Motakjuq Yup - that sorted it out! Thanks!!!!"}], "owner": {"reputation": 655, "user_id": 1732950, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/055cd772017bfa1cd64b32915daabce5?s=128&d=identicon&r=PG", "display_name": "node42", "link": "https://stackoverflow.com/users/1732950/node42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 768, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1493869065, "creation_date": 1493841529, "last_edit_date": 1493869065, "question_id": 43768948, "link": "https://stackoverflow.com/questions/43768948/protobuf-grpc-code-generator-for-go-creating-invalid-code", "title": "Protobuf (gRPC) Code Generator for Go Creating Invalid Code", "body": "<p>Everything works when I have my proto file defining a service with a <em>streaming</em> response. However when I return a <em>single</em> value, then the generated code is invalid!</p>\n\n<p><strong>Proto File</strong>:</p>\n\n<pre><code>syntax = \"proto3\";\n\npackage analyticsServicesGlobal;\noption go_package = \"generated/analyticsServices\";\n\nservice HealthCheck {\n    rpc Health (HealthCheckParam) returns (HealthCheckPayload) {}\n}\n\nmessage HealthCheckPayload {\n    string message = 1;\n}\n\nmessage HealthCheckParam {\n    string response = 1;\n}\n</code></pre>\n\n<p>The code generation completes without issue : <code>protoc --go_out=plugins=grpc:$GOPATH/src/gauss minimal.proto</code></p>\n\n<p>The ide and command line compilation return this error in the generated Go code though:</p>\n\n<pre><code>./minimal.pb.go:130: cannot use handler (type func(\"gauss/vendor/golang.org/x/net/context\".Context, interface {}) (interface {}, error)) as type grpc.UnaryHandler in argument to interceptor\n./minimal.pb.go:139: cannot use _HealthCheck_Health_Handler (type func(interface {}, \"gauss/vendor/golang.org/x/net/context\".Context, func(interface {}) error, grpc.UnaryServerInterceptor) (interface {}, error)) as type grpc.methodHandler in field value\n</code></pre>\n\n<p>This issue shows up for <em>any</em> service where a non-stream response is returned. I have create this minimal proto file to demonstrate, but every similar service definition has the same issue.</p>\n\n<p>I am on OSX using Go version 1.8.1, <code>protoc</code> version 3.3.0, and the latest protoc plugin for Go <code>go get -u github.com/golang/protobuf/{proto,protoc-gen-go}</code></p>\n\n<p>I'm sure <em>I'm</em> doing something wrong given the lack of reports on this issue - but I don't see what. Any suggestions are appreciated!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493839994, "post_id": 43768377, "comment_id": 74578500, "body": "You may find it useful to read up on how <code>constants</code> are expressed in go. Specifically in this case, because your original code multiplies <code>a</code> with an integer, the constant is converted to and <code>int</code> as well for compatability. <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">blog.golang.org/constants</a>"}, {"owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493841580, "post_id": 43768377, "comment_id": 74579315, "body": "Thanks for the link will read that now"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 19, "last_activity_date": 1493840039, "last_edit_date": 1493840039, "creation_date": 1493839620, "answer_id": 43768438, "question_id": 43768377, "link": "https://stackoverflow.com/questions/43768377/golang-how-can-i-multiply-a-integer-and-a-float/43768438#43768438", "title": "Golang how can I multiply a integer and a float", "body": "<p>If you want to multiply floats, you need to convert the number to a float:</p>\n\n<pre><code>height := int(float64(heightImg) * a) \nwidth := int(float64(widthImg) * a)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 1292299, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7joNZ.png?s=128&g=1", "display_name": "chen youfu", "link": "https://stackoverflow.com/users/1292299/chen-youfu"}, "is_accepted": false, "score": 0, "last_activity_date": 1558062663, "creation_date": 1558062663, "answer_id": 56179066, "question_id": 43768377, "link": "https://stackoverflow.com/questions/43768377/golang-how-can-i-multiply-a-integer-and-a-float/56179066#56179066", "title": "Golang how can I multiply a integer and a float", "body": "<pre><code>var xx float64\nxx = 0.29\nfmt.Println(xx, xx * 100)\n</code></pre>\n\n<p>The result is 28.999999999999996, convert to int is 28</p>\n\n<pre><code>var xx float32\nxx = 0.29\nfmt.Println(xx * 100)\n</code></pre>\n\n<p>The result is 29, convert to int is 29</p>\n"}], "owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16095, "favorite_count": 0, "accepted_answer_id": 43768438, "answer_count": 2, "score": 9, "last_activity_date": 1558062663, "creation_date": 1493839460, "question_id": 43768377, "link": "https://stackoverflow.com/questions/43768377/golang-how-can-i-multiply-a-integer-and-a-float", "title": "Golang how can I multiply a integer and a float", "body": "<p>I am trying to resize the dimensions of an image but am getting a <strong>constant 0.8 truncated to integer</strong> error on compile . This is my code</p>\n\n<pre><code>b := img.Bounds()\n\nheightImg := b.Max.Y  // height of image in pixels\nwidthImg := b.Max.X   // width of image in pixels\nconst a = .80\nheight := int(heightImg * a) // reduce height by 20%\nwidth := int(widthImg * a)  // reduce width by 20%\n\n // resize image below which take in type int, int in the 2nd &amp; 3rd parameter\nnew_img := imaging.Resize(img,width,height, imaging.Lanczos)\n</code></pre>\n\n<p>I am new to golang but this code right here gives me the error</p>\n\n<pre><code>    height := int(heightImg * a) \n    width := int(widthImg * a)\n</code></pre>\n\n<p>any suggestions would be great</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 27290, "user_id": 16959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SlC7g.jpg?s=128&g=1", "display_name": "Jason Sperske", "link": "https://stackoverflow.com/users/16959/jason-sperske"}, "edited": false, "score": 0, "creation_date": 1493838622, "post_id": 43768140, "comment_id": 74577793, "body": "considering what this package is doing I&#39;m kind of amazed that this code is allowed in something like the golang playground"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 27290, "user_id": 16959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SlC7g.jpg?s=128&g=1", "display_name": "Jason Sperske", "link": "https://stackoverflow.com/users/16959/jason-sperske"}, "edited": false, "score": 0, "creation_date": 1493838698, "post_id": 43768140, "comment_id": 74577837, "body": "@JasonSperske Yeah, no kidding. They&#39;ve gotta trust their sandbox quite a bit."}, {"owner": {"reputation": 27290, "user_id": 16959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SlC7g.jpg?s=128&g=1", "display_name": "Jason Sperske", "link": "https://stackoverflow.com/users/16959/jason-sperske"}, "edited": false, "score": 2, "creation_date": 1493838792, "post_id": 43768140, "comment_id": 74577888, "body": "Apparently they have put a lot of thought into this <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">blog.golang.org/playground</a> fascinating stuff :)"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 2, "last_activity_date": 1493850440, "last_edit_date": 1493850440, "creation_date": 1493838390, "answer_id": 43768140, "question_id": 43767898, "link": "https://stackoverflow.com/questions/43767898/casting-a-int-to-a-pointer/43768140#43768140", "title": "Casting a int to a pointer?", "body": "<p>Go through the unsafe package. Please note that it is called \"unsafe\" for a reason and probably shouldn't be used unless you REALLY need to do operations that bypass type safeties, or operate on memory directly.</p>\n\n<p><a href=\"https://play.golang.org/p/WUavNAlyVP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WUavNAlyVP</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    var intaddr int = 0x1040c108\n    var addr uintptr = uintptr(intaddr)\n    ptr := unsafe.Pointer(addr)\n    p := (*int)(ptr)\n    fmt.Printf(\"Type: %T, Ptr: %v, Val: %d\", p, p, *p)\n}\n</code></pre>\n"}], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 1, "accepted_answer_id": 43768140, "answer_count": 1, "score": 0, "last_activity_date": 1493850440, "creation_date": 1493837479, "question_id": 43767898, "link": "https://stackoverflow.com/questions/43767898/casting-a-int-to-a-pointer", "title": "Casting a int to a pointer?", "body": "<p>in C/C++ I can cast <code>int</code> to a <code>int*</code> like this</p>\n\n<pre><code>int i = 0x1040c108;\nint *p = (int*)i; // compiles\n</code></pre>\n\n<p>but why can't I do this in Go?</p>\n\n<pre><code>addr := 0x1040c108\np := (*int)(addr) // Error: cannot convert addr (type int) to type *int\n</code></pre>\n\n<p>What is the way to achieve this in golang ??</p>\n"}, {"tags": ["pointers", "go", "memory-address"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493833181, "post_id": 43766471, "comment_id": 74574636, "body": "My question is very similar to <a href=\"http://stackoverflow.com/questions/27539388\">stackoverflow.com/questions/27539388</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 3, "creation_date": 1493835420, "post_id": 43766471, "comment_id": 74575971, "body": "You really don&#39;t want to do this...."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1493841131, "post_id": 43766471, "comment_id": 74579059, "body": "In what possible scenario would you ever want to do this? Just reading the question sets off all the alarms in my head."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1493881955, "post_id": 43766471, "comment_id": 74593179, "body": "@Adrian I didn&#39;t really need to know the answer to this for any projects of mine. It was just to satisfy my curiosity."}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493832720, "post_id": 43766557, "comment_id": 74574389, "body": "I&#39;m not talking about pointing to a variable&#39;s memory address that was made in the program... I mean using a string (such as <code>&quot;0x1040c108&quot;</code>) and checking the value of that memory address in the computer&#39;s memory."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1493832841, "post_id": 43766557, "comment_id": 74574450, "body": "@Acidic: what does it mean to &quot;check it&quot;? Do you want to assume the type to read and just hope you don&#39;t segfault?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493832934, "post_id": 43766557, "comment_id": 74574512, "body": "It&#39;s really confusing, but yeah I guess that could be an issue... not knowing the memory address&#39; value&#39;s type. But if you ignore the type (assuming somehow you know what it is), is it possible?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493835346, "post_id": 43766557, "comment_id": 74575931, "body": "The edit you just made is false. <code>ptr, _ := strconv.ParseInt(addr, 0, 64)</code> does not create a pointer, it creates an <code>int</code>. <code>fmt.Println(*ptr)</code> therefore is an invalid indirect because it isn&#39;t a pointer. You can only use <code>*</code> operator on variables you&#39;ve previously taken the pointer of <code>&amp;</code>."}, {"owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "edited": false, "score": 0, "creation_date": 1493835452, "post_id": 43766557, "comment_id": 74575988, "body": "ty for noticing"}], "tags": [], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1493835418, "last_edit_date": 1493835418, "creation_date": 1493832637, "answer_id": 43766557, "question_id": 43766471, "link": "https://stackoverflow.com/questions/43766471/accessing-a-memory-address-from-a-string-in-go/43766557#43766557", "title": "Accessing a Memory Address From a String in Go?", "body": "<p><strong>Yes!!</strong> you can store the address in a pointer variable and print its value by derefrencing it</p>\n\n<pre><code>i := \"something\"\nptr := &amp;i\nfmt.Println(*ptr)\n</code></pre>\n\n<p>For accessing the memory using a hard coded address such as <strong>0x1040c108</strong>, it is necessary for your program to have access to that memory address otherwise, you will get an error saying invalid indirection of a pointer or segmentation fault.</p>\n"}, {"comments": [{"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493836542, "post_id": 43767517, "comment_id": 74576654, "body": "@RayfenWindspear assuming the string in memory is a Go string."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1493836693, "post_id": 43767517, "comment_id": 74576741, "body": "The OP wants to dereference arbitrary raw pointer values. Many assumptions are going to be made... here be dragons..."}, {"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493837812, "post_id": 43767517, "comment_id": 74577400, "body": "Heh, fair enough"}], "tags": [], "owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "is_accepted": false, "score": 1, "last_activity_date": 1493836083, "creation_date": 1493836083, "answer_id": 43767517, "question_id": 43766471, "link": "https://stackoverflow.com/questions/43766471/accessing-a-memory-address-from-a-string-in-go/43767517#43767517", "title": "Accessing a Memory Address From a String in Go?", "body": "<pre><code>package main\n\nimport \"C\"\n\nimport (\n    \"log\"\n    \"strconv\"\n    \"unsafe\"\n)\n\nfunc main() {\n\n    // parse the string into an integer value\n    addr, _ := strconv.ParseInt(\"0x1040c108\", 0, 64)\n\n    // cast the integer to a c string pointer\n    ptr := (*C.char)(unsafe.Pointer(uintptr(addr)))\n\n    // convert to a go string (this will segfault)\n    str := C.GoString(ptr)\n\n    // print it\n    log.Println(str)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493836472, "post_id": 43767541, "comment_id": 74576610, "body": "By the way, I&#39;m really surprised that it doesn&#39;t require you to know the length and loop over each individual character."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493838212, "post_id": 43767541, "comment_id": 74577588, "body": "A string value includes the length."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 2, "creation_date": 1493882014, "post_id": 43767541, "comment_id": 74593213, "body": "Can you elaborate on &quot;everything will come crashing down catastrophically&quot; please. Seems like I&#39;ve asked a critically dangerous question."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493882797, "post_id": 43767541, "comment_id": 74593728, "body": "Hm, I opened your example on the Go playground and I simply removed the line <code>fmt.Println(&quot;Hello, Playground&quot;)</code> which caused the output to only print the memory address of <code>hi</code>. Very interesting."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493911576, "post_id": 43767541, "comment_id": 74614465, "body": "@Acidic Oops, yeah, I always manage to forget to remove that. The reason it breaks it is because a string is created in memory when &quot;Hello, Playground&quot; is passed to <code>fmt</code>, so the memory address of the string created with <code>hi := &quot;HI&quot;</code> is different. So apparently go doesn&#39;t panic if it&#39;s not a string. Interesting."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493913928, "post_id": 43767541, "comment_id": 74616226, "body": "@RayfenWindspear ah I see. That added line changes the memory address of <code>hi</code>. Mildly interesting."}, {"owner": {"reputation": 3516, "user_id": 1597944, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c1d9df1b61a99e23af28bf753da54256?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Kayarohanam", "link": "https://stackoverflow.com/users/1597944/harish-kayarohanam"}, "edited": false, "score": 0, "creation_date": 1534640938, "post_id": 43767541, "comment_id": 90777361, "body": "Hi @RayfenWindspear, Is there a similar way to call a function , when given just the address of the function ?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 3516, "user_id": 1597944, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/c1d9df1b61a99e23af28bf753da54256?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Kayarohanam", "link": "https://stackoverflow.com/users/1597944/harish-kayarohanam"}, "edited": false, "score": 0, "creation_date": 1534800916, "post_id": 43767541, "comment_id": 90827713, "body": "@HarishKayarohanam it&#39;s exactly the same. The types have to match PERFECTLY though, which the regular runtime assures. There seems to be no point to this, and the serious bugs that will eventually result will be nigh impossible to fix... but whatever. But really, DO NOT DO THIS <a href=\"https://play.golang.org/p/1wkmdcBRu6W\" rel=\"nofollow noreferrer\">play.golang.org/p/1wkmdcBRu6W</a>"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 11, "last_activity_date": 1599249770, "last_edit_date": 1599249770, "creation_date": 1493836164, "answer_id": 43767541, "question_id": 43766471, "link": "https://stackoverflow.com/questions/43766471/accessing-a-memory-address-from-a-string-in-go/43767541#43767541", "title": "Accessing a Memory Address From a String in Go?", "body": "<p>This can be done, but it is a really really REALLY bad idea. Anytime you are importing the <code>unsafe</code> package, you are either doing something wrong, or something really hardcore. I'm hesitant to even answer this, but here goes.</p>\n<p><a href=\"https://play.golang.org/p/unkb-s8IzAo\" rel=\"nofollow noreferrer\">https://play.golang.org/p/unkb-s8IzAo</a></p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;strconv&quot;\n    &quot;unsafe&quot;\n)\n\nfunc main() {\n    // original example manually examined the printed address and used the value\n    // updated to preserve forward compatibility due to runtime changes shifting the address over time\n\n    hi := &quot;HI&quot;\n\n    // getting address as string dynamically to preserve compatibility\n    address := fmt.Sprint(&amp;hi)\n\n    fmt.Printf(&quot;Address of var hi: %s\\n&quot;, address)\n\n    // convert to uintptr\n    var adr uint64\n    adr, err := strconv.ParseUint(address, 0, 64)\n    if err != nil {\n        panic(err)\n    }\n    var ptr uintptr = uintptr(adr)\n\n    fmt.Printf(&quot;String at address: %s\\n&quot;, address)\n    fmt.Printf(&quot;Value: %s\\n&quot;, ptrToString(ptr))\n}\n\nfunc ptrToString(ptr uintptr) string {\n    p := unsafe.Pointer(ptr)\n    return *(*string)(p)\n}\n</code></pre>\n<p>And yes, this was pretty much taken almost line for line from the <code>unsafe</code> godoc. <a href=\"https://godoc.org/unsafe\" rel=\"nofollow noreferrer\">https://godoc.org/unsafe</a></p>\n<p>Also note that if/when your memory reference is NOT a go string, everything will come crashing down catastrophically. And that <code>go vet</code> is configured to send you an angry message for doing this, reinforcing that this is indeed a bad idea.</p>\n<p>UPDATE: Updated example to run on playground as of go 1.15.1, which either the playground or go itself has changed the way the memory is addressed. Or the more likely case that changes in core libs/runtime will shift the address across versions. It now dynamically obtains the address vs a manually hardcoded value.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6030, "favorite_count": 1, "accepted_answer_id": 43767541, "answer_count": 3, "score": 4, "last_activity_date": 1599249770, "creation_date": 1493832359, "question_id": 43766471, "link": "https://stackoverflow.com/questions/43766471/accessing-a-memory-address-from-a-string-in-go", "title": "Accessing a Memory Address From a String in Go?", "body": "<p>In golang, can I print the value of a memory address from a given string?</p>\n\n<p>For example, if run the following code:</p>\n\n<pre><code>a := \"A String\"\nfmt.Println(&amp;a)\n</code></pre>\n\n<p>It prints <code>0x1040c108</code>.</p>\n\n<p>How could I take a string such as <code>0x1040c108</code> and print the value of that string stored in the memory? Something like <code>fmt.Println(*0x1040c108)</code></p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1493834247, "post_id": 43766346, "comment_id": 74575275, "body": "Are your go routines modifying the struct&#39;s data?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 5, "creation_date": 1493834263, "post_id": 43766346, "comment_id": 74575290, "body": "If all your goroutines are running continuously (i.e., not blocking on I/O), you&#39;re not going to get any performance advantage by having more goroutines than the number of threads your system can run simultaneously. In fact, having more goroutines will slow things down because of the overhead involved in switching between them."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 7959546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c59a28109aaa304db6b086dd9dba39?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/7959546/david-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1493847054, "creation_date": 1493847054, "answer_id": 43770333, "question_id": 43766346, "link": "https://stackoverflow.com/questions/43766346/factors-affecting-goroutines-performance/43770333#43770333", "title": "Factors affecting goroutine&#39;s performance", "body": "<p>Start few \"worker\" goroutines and send \"jobs\" to its via channel. You save many memory allocations that consume a lot of CPU. </p>\n"}], "owner": {"reputation": 691, "user_id": 5390982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7e8ea48156770ffe661a3b27d26034c?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/5390982/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493847054, "creation_date": 1493831927, "question_id": 43766346, "link": "https://stackoverflow.com/questions/43766346/factors-affecting-goroutines-performance", "title": "Factors affecting goroutine&#39;s performance", "body": "<p>I'm experiencing some weird behaviors using goroutine and please provide advise or comments on things I might do wrong. Here is my process:</p>\n\n<p>I am using goroutines to perform a simulation concurrently, but for some reason the time I spent increases with number of goroutines I put in which makes my simulation not possible to finish in a reasonable time. Here are the things I notice:</p>\n\n<ol>\n<li><p>For every 10k goroutines initiated, the calculation time increases by 5 seconds</p></li>\n<li><p>I don't see a shortage in CPU or memory. However CPU usage increases only a little bit for every 10k goroutines. For example when I put 200k goroutines, CPU usage is around 70%</p></li>\n<li><p>I'm not using disks</p></li>\n<li><p>I ran the simulation without triggering the goroutines and it finishes very fast, so the slowness is inside or due to goroutines</p></li>\n<li><p>I tried to use additional goroutines in 1 occasion inside each goroutine to run some workload in parallel. CPU usage is boosted to 100% but the overall speed decreased by 50%...</p></li>\n<li><p>I am passing some large structs to goroutines using pointers. All goroutines use the same data.</p></li>\n</ol>\n\n<p>Does anyone have a clue on things I might need to optimize, or suggest me any test I can perform? Thanks!</p>\n"}, {"tags": ["mysql", "docker", "go", "docker-compose", "mariadb"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7756607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5381c1edcca130f62814da4cf967ee?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Kirwan", "link": "https://stackoverflow.com/users/7756607/alex-kirwan"}, "edited": false, "score": 0, "creation_date": 1493885383, "post_id": 43766112, "comment_id": 74595298, "body": "Hey man, My yaml was fine It just formatted that way here on stack, sorry .  But that link you gave me worked like a charm . Thanks very much"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1493831127, "creation_date": 1493831127, "answer_id": 43766112, "question_id": 43765581, "link": "https://stackoverflow.com/questions/43765581/golang-connect-to-docker-connect-to-my-sql-docker-getsockopt-connection-refused/43766112#43766112", "title": "Golang connect to docker connect to my sql docker getsockopt: connection refused", "body": "<p>The spacing in your yaml file is important, your mysql line should line up with your app line.</p>\n\n<p>You have to add a </p>\n\n<pre><code>links:\n  - mysql\n</code></pre>\n\n<p>line in under your <code>app:</code> section so it knows to connect the two.</p>\n\n<p>Look here <a href=\"https://github.com/gpuenteallott/golang-mysql-docker-setup/blob/master/docker-compose.yml\" rel=\"nofollow noreferrer\">https://github.com/gpuenteallott/golang-mysql-docker-setup/blob/master/docker-compose.yml</a> for a decent working example. </p>\n"}], "owner": {"reputation": 45, "user_id": 7756607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6c5381c1edcca130f62814da4cf967ee?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Kirwan", "link": "https://stackoverflow.com/users/7756607/alex-kirwan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 595, "favorite_count": 0, "accepted_answer_id": 43766112, "answer_count": 1, "score": 0, "last_activity_date": 1494858559, "creation_date": 1493829277, "last_edit_date": 1494858559, "question_id": 43765581, "link": "https://stackoverflow.com/questions/43765581/golang-connect-to-docker-connect-to-my-sql-docker-getsockopt-connection-refused", "title": "Golang connect to docker connect to my sql docker getsockopt: connection refused", "body": "<p>I am loosing my mind trying to set up my golang and docker env. I am using docker compose which seems to book both images fine but when I try run and go lang operations I get an error.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "is_accepted": false, "score": 1, "last_activity_date": 1528480476, "creation_date": 1528480476, "answer_id": 50766091, "question_id": 43765014, "link": "https://stackoverflow.com/questions/43765014/appengine-using-a-context-not-associated-with-a-request/50766091#50766091", "title": "AppEngine: using a context not associated with a request", "body": "<p>Each request should create a new client (when the client requires a <code>context</code>). The <code>context</code> of the request handles things like cancels and timeouts. So, if your request gets cancelled, you should also cancel any of the outgoing API requests. The client handles all of the outgoing API requests, so it needs the same <code>context</code>.</p>\n\n<p>The App Engine Standard requires requests to use the App Engine context since it handles scaling and resources automatically.</p>\n\n<p>You can get a <code>context.Context</code> from a request by calling <code>appengine.NewContext(req)</code> (<a href=\"https://cloud.google.com/appengine/docs/standard/go/reference#NewContext\" rel=\"nofollow noreferrer\">g3doc</a>).</p>\n\n<p>For example:</p>\n\n<pre><code>import (\n        \"net/http\"\n\n        \"cloud.google.com/go/pubsub\"\n        \"google.golang.org/appengine\"\n        \"google.golang.org/appengine/log\"\n)\n\nfunc pubSubHandler(w http.ResponseWriter, r *http.Request) {\n    ctx := appengine.NewContext(r)\n    client, err := pubsub.NewClient(ctx, \"myproject-1234\")\n    if err != nil {\n        log.Errorf(ctx, \"pubsub.NewClient: %v\", err)\n        http.Error(w, \"An error occurred. Try again.\", http.StatusInternalServerError)\n        return\n    }\n    _ = client // Use the client.\n}\n</code></pre>\n\n<p>Another note is to use the <code>google.golang.org/appengine/log</code> package to do logging in App Engine Standard, as done above. See <a href=\"https://cloud.google.com/appengine/docs/standard/go/logs/\" rel=\"nofollow noreferrer\">Reading and Writing Application Logs</a>.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/building-app/\" rel=\"nofollow noreferrer\">Building an App with Go</a> from the official docs describes how to build an example application on App Engine Standard.</p>\n"}], "owner": {"reputation": 115, "user_id": 7919963, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/21c502d0b100715f293bee9fc7f58b24?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/7919963/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1528480476, "creation_date": 1493827359, "last_edit_date": 1493827817, "question_id": 43765014, "link": "https://stackoverflow.com/questions/43765014/appengine-using-a-context-not-associated-with-a-request", "title": "AppEngine: using a context not associated with a request", "body": "<p>I was trying to deploy an API using PubSub with AppEngine but I got a \"not an App Engine context\" error, it's related to the following code: </p>\n\n<pre><code>import (\n    \"golang.org/x/net/context\"\n    \"log\"\n\n    \"cloud.google.com/go/pubsub\"\n)\n\nvar (\n    ctx                             context.Context\n    pubsubClient                    *pubsub.Client\n)  \n\nfunc InitPubSub () {\n    ctx = context.Background()\n\n    psClient, err := pubsub.NewClient(ctx, \"myproject-1234\")\n    if err != nil {\n        log.Println(\"(init pub sub) error while creating new pubsub client:\", err)\n\n    } else {\n        pubsubClient = psClient\n\n    }\n}\n</code></pre>\n\n<p>So I was looking at the BackgroundContext func from the appengine package but it says that it only works with AppEngine flexible environment (standard environment seems more appropriate to my app):\n<a href=\"https://godoc.org/google.golang.org/appengine#BackgroundContext\" rel=\"nofollow noreferrer\">https://godoc.org/google.golang.org/appengine#BackgroundContext</a></p>\n\n<p>Do you know if there's another function I can use? Or should I create and close a client for each request?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["http", "go", "fasthttp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493824132, "post_id": 43763725, "comment_id": 74568954, "body": "Spaces in a URL query are escaped as <code>+</code>. As far as a query string goes, the values are equivalent."}, {"owner": {"reputation": 21, "user_id": 7947488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxiXx.jpg?s=128&g=1", "display_name": "Alakey", "link": "https://stackoverflow.com/users/7947488/alakey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493825072, "post_id": 43763725, "comment_id": 74569701, "body": "thanks for your help."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1493841326, "post_id": 43763725, "comment_id": 74579182, "body": "Technically you are getting the correct result; if the parameter is supposed to include literal <code>+</code> characters, then the input is incorrect, and should be URL-encoded (passing <code>%2B</code> in place of <code>+</code>)."}, {"owner": {"reputation": 21, "user_id": 7947488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxiXx.jpg?s=128&g=1", "display_name": "Alakey", "link": "https://stackoverflow.com/users/7947488/alakey"}, "edited": false, "score": 0, "creation_date": 1493867917, "post_id": 43763725, "comment_id": 74587616, "body": "thanks Adrian. I solved problem."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 7947488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxiXx.jpg?s=128&g=1", "display_name": "Alakey", "link": "https://stackoverflow.com/users/7947488/alakey"}, "edited": false, "score": 0, "creation_date": 1493868014, "post_id": 43763916, "comment_id": 74587641, "body": "I think your answer is not good solution. I have to encode url. This is best solution, I think. Anyway I appreciate your help.AndreaM"}], "tags": [], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "is_accepted": false, "score": 0, "last_activity_date": 1493824290, "creation_date": 1493824290, "answer_id": 43763916, "question_id": 43763725, "link": "https://stackoverflow.com/questions/43763725/how-to-get-query-arguments-from-requesturi-without-losing-character/43763916#43763916", "title": "How to get query arguments from RequestURI without losing character", "body": "<p>You can simply use <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\">strings.Replace</a> to replace a character with another one.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    s := \"AgAAAA**AQAAAA**aAAAAA**6d8JWQ**nY sHZ2PrBmdj6wVnY sEZ2...\";\n    conv := strings.Replace(s, \" \", \"+\", -1)\n\n    fmt.Println(conv) //AgAAAA**AQAAAA**aAAAAA**6d8JWQ**nY+sHZ2PrBmdj6wVnY+sEZ2...\n\n}\n</code></pre>\n\n<p>Here you can find a <a href=\"https://play.golang.org/p/pEvjyiUAfo\" rel=\"nofollow noreferrer\">Playground</a> reproducing this code.</p>\n"}], "owner": {"reputation": 21, "user_id": 7947488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pxiXx.jpg?s=128&g=1", "display_name": "Alakey", "link": "https://stackoverflow.com/users/7947488/alakey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1051, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1582281344, "creation_date": 1493823766, "last_edit_date": 1582281344, "question_id": 43763725, "link": "https://stackoverflow.com/questions/43763725/how-to-get-query-arguments-from-requesturi-without-losing-character", "title": "How to get query arguments from RequestURI without losing character", "body": "<p>I want to get the query arguments from RequestURI in golang.\nThe URL is like that:\n<code>http://localhost:3000/add-ebay?authToken=AgAAAA**AQAAAA**aAAAAA**6d8JWQ**nY+sHZ2PrBmdj6wVnY+sEZ2...</code></p>\n\n<p>And my code is followings:</p>\n\n<pre><code>func CreateEbayProfile(ctx *fasthttp.RequestCtx) {\n\n    log.Println( ctx.QueryArgs().Peek(\"authToken\"))\n               ....\n}\n</code></pre>\n\n<p>The result is that:</p>\n\n<pre><code>AgAAAA**AQAAAA**aAAAAA**6d8JWQ**nY sHZ2PrBmdj6wVnY sEZ2...\n</code></pre>\n\n<p>But I want to result like that:</p>\n\n<pre><code>AgAAAA**AQAAAA**aAAAAA**6d8JWQ**nY+sHZ2PrBmdj6wVnY+sEZ2...\n</code></pre>\n\n<p>How can I get the correct result? And why this is happening?</p>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1493817975, "post_id": 43760408, "comment_id": 74563995, "body": "thank you man, I&#39;ve couldn&#39;t find any example for this subject, it might help me but I have still some questions, can I ask you in private channel or anywhere else?"}, {"owner": {"reputation": 152, "user_id": 1657083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KD4f8.jpg?s=128&g=1", "display_name": "RadekSohlich", "link": "https://stackoverflow.com/users/1657083/radeksohlich"}, "reply_to_user": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "edited": false, "score": 0, "creation_date": 1493821566, "post_id": 43760408, "comment_id": 74566921, "body": "Reach me on twitter @radeksohlich."}], "tags": [], "owner": {"reputation": 152, "user_id": 1657083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KD4f8.jpg?s=128&g=1", "display_name": "RadekSohlich", "link": "https://stackoverflow.com/users/1657083/radeksohlich"}, "is_accepted": false, "score": 0, "last_activity_date": 1493815469, "creation_date": 1493815469, "answer_id": 43760408, "question_id": 43760065, "link": "https://stackoverflow.com/questions/43760065/reflect-one-clients-message-to-another-client-on-websocket-golang/43760408#43760408", "title": "Reflect one client&#39;s message to another client on Websocket (golang)", "body": "<p>You need to send the information to the existing sessions that you stored from opened connection and distribute the information to other users.</p>\n\n<p>Try to go through this solution to get some inspiration <a href=\"https://github.com/suricatatalk/core/blob/master/core.go\" rel=\"nofollow noreferrer\">https://github.com/suricatatalk/core/blob/master/core.go</a>.</p>\n"}], "owner": {"reputation": 273, "user_id": 3559801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7b8996e43ec87f7e1fab8d548c7d2a58?s=128&d=identicon&r=PG&f=1", "display_name": "Mert Serin", "link": "https://stackoverflow.com/users/3559801/mert-serin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493815469, "creation_date": 1493814540, "question_id": 43760065, "link": "https://stackoverflow.com/questions/43760065/reflect-one-clients-message-to-another-client-on-websocket-golang", "title": "Reflect one client&#39;s message to another client on Websocket (golang)", "body": "<p>I'm having a problem using websockets in my backend. I have to re-write some old with golang and old developer using websocket while one client tracking other client's location. </p>\n\n<p>both client connecting websocket with given url</p>\n\n<pre><code>\"\\(URLConstants.webSocketURL)?token=\\(token)&amp;jobId=\\(jobId)\"\n</code></pre>\n\n<p>So I thought both client connecting websocket with her/his own token and I need to reflect user's message to other user. I can open two sockets with given url. </p>\n\n<p>It's the first time that I'm using websocket so I'm not sure I'm asking the right question.</p>\n"}, {"tags": ["go", "mqtt", "paho"], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 0, "creation_date": 1493822984, "post_id": 43762849, "comment_id": 74568090, "body": "thank you for answer, but I think  <a href=\"https://github.com/eclipse/paho.mqtt.golang/blob/master/options.go#L100\" rel=\"nofollow noreferrer\">OnConnectionLostHandler</a> by default must notify me I lost connection!!!"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 1, "creation_date": 1493823525, "post_id": 43762849, "comment_id": 74568492, "body": "The default handler just print the message (My bad, the example above also just print a message ...). I means, if you assign a custom connection lost handler, you can do more than just printing a message, e.g. counting the number of connection lost, send notification through email, etc..."}, {"owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 0, "creation_date": 1493823818, "post_id": 43762849, "comment_id": 74568713, "body": "<code>OnConnectionLostHandler</code> not print any thing if I lost connection."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 2, "creation_date": 1493824101, "post_id": 43762849, "comment_id": 74568925, "body": "To see the message, you need to setup <code>DEBUG</code> handler, e.g. add <code>mqtt.DEBUG = log.New(os.Stderr, &quot;DEBUG    &quot;, log.Ltime)</code> to the first line of your <code>main</code> function."}, {"owner": {"reputation": 111, "user_id": 3212907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b533d79ab3468bd94ac2b3fa50dd7c9?s=128&d=identicon&r=PG", "display_name": "nerab", "link": "https://stackoverflow.com/users/3212907/nerab"}, "edited": false, "score": 0, "creation_date": 1599422597, "post_id": 43762849, "comment_id": 112763572, "body": "This should be in the default sample of paho - the fact that one must re-subscribe after a disconnect event is quite surprising."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 7, "last_activity_date": 1493823737, "last_edit_date": 1493823737, "creation_date": 1493821531, "answer_id": 43762849, "question_id": 43759445, "link": "https://stackoverflow.com/questions/43759445/how-i-can-check-if-i-lose-connection-with-mqtt-broker/43762849#43762849", "title": "How I can check if I lose connection with mqtt broker?", "body": "<p>Assign a custom <code>OnConnectionLostHandler</code> to catch connection lost event, so you can perform additional action whenever the client loses connection. If you set the <code>AutoReconnect</code> option to <code>true</code> (which is the default behavior), the client will automatically reconnects to the broker after connection lost. Please note that after connection lost, your subscription state/info may not being saved by the broker, so you won't be able to receive any message. To deal with this issue, move topic subscription to <code>OnConnect</code> handler. Below is an example implementation:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n\n    mqtt \"github.com/eclipse/paho.mqtt.golang\"\n)\n\nfunc messageHandler(c mqtt.Client, msg mqtt.Message) {\n    fmt.Printf(\"TOPIC: %s\\n\", msg.Topic())\n    fmt.Printf(\"MSG: %s\\n\", msg.Payload())\n}\n\nfunc connLostHandler(c mqtt.Client, err error) {\n    fmt.Printf(\"Connection lost, reason: %v\\n\", err)\n\n    //Perform additional action...\n}\n\nfunc main() {\n    //create a ClientOptions\n    opts := mqtt.NewClientOptions().\n        AddBroker(\"tcp://localhost:1883\").\n        SetClientID(\"group-one\").\n        SetDefaultPublishHandler(messageHandler).\n        SetConnectionLostHandler(connLostHandler)\n\n    //set OnConnect handler as anonymous function\n    //after connected, subscribe to topic\n    opts.OnConnect = func(c mqtt.Client) {\n        fmt.Printf(\"Client connected, subscribing to: test/topic\\n\")\n\n        //Subscribe here, otherwise after connection lost, \n        //you may not receive any message\n        if token := c.Subscribe(\"test/topic\", 0, nil); token.Wait() &amp;&amp; token.Error() != nil {\n            fmt.Println(token.Error())\n            os.Exit(1)\n        }\n    }\n\n    //create and start a client using the above ClientOptions\n    c := mqtt.NewClient(opts)\n    if token := c.Connect(); token.Wait() &amp;&amp; token.Error() != nil {\n        panic(token.Error())\n    }\n\n    for {\n        //Lazy...\n        time.Sleep(500 * time.Millisecond)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4582, "favorite_count": 2, "accepted_answer_id": 43762849, "answer_count": 1, "score": 3, "last_activity_date": 1493823737, "creation_date": 1493812734, "last_edit_date": 1493813377, "question_id": 43759445, "link": "https://stackoverflow.com/questions/43759445/how-i-can-check-if-i-lose-connection-with-mqtt-broker", "title": "How I can check if I lose connection with mqtt broker?", "body": "<p>I am trying with <a href=\"https://github.com/eclipse/paho.mqtt.golang\" rel=\"nofollow noreferrer\">paho</a> pkg to build mqtt sub client by golang,\nand I have a problem with my client when the broker disconnect, I think should lost message <a href=\"https://github.com/eclipse/paho.mqtt.golang/blob/master/options.go#L100\" rel=\"nofollow noreferrer\">appear</a>, but this not happen, and if I start the broker, \nmqtt sub client can't able to get message sent by mqtt pub client.</p>\n\n<p>why this happens and how I can fix that?</p>\n\n<p>Code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    mqtt \"github.com/eclipse/paho.mqtt.golang\"\n)\n\nvar (\n    broker                     = \"tcp://localhost:1883\"\n    f      mqtt.MessageHandler = func(client mqtt.Client, msg mqtt.Message) {\n        fmt.Printf(\"TOPIC: %s\\n\", msg.Topic())\n        fmt.Printf(\"MSG: %s\\n\", msg.Payload())\n    }\n)\n\nfunc main() {\n    //create a ClientOptions\n    opts := mqtt.NewClientOptions().AddBroker(broker)\n    opts.SetClientID(\"group-one\")\n    opts.SetDefaultPublishHandler(f)\n\n    //create and start a client using the above ClientOptions\n    c := mqtt.NewClient(opts)\n    if token := c.Connect(); token.Wait() &amp;&amp; token.Error() != nil {\n        panic(token.Error())\n    }\n\n    if token := c.Subscribe(\"test\", 0, nil); token.Wait() &amp;&amp; token.Error() != nil {\n        fmt.Println(token.Error())\n        os.Exit(1)\n    }\n\n    for {\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493814517, "post_id": 43756561, "comment_id": 74561224, "body": "Please show what <code>go get -v -x github.com&#47;beego&#47;bee</code> outputs. In general: Always run failing command with a sensible amount of verbosity and debug logging turned on when asking someone for help."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 6882114, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YxH-NmrJZdE/AAAAAAAAAAI/AAAAAAAAABI/aUiJgfFRDTw/photo.jpg?sz=128", "display_name": "Zeyit Ba\u015far", "link": "https://stackoverflow.com/users/6882114/zeyit-ba%c5%9far"}, "edited": false, "score": 0, "creation_date": 1493842897, "post_id": 43769140, "comment_id": 74580035, "body": "If you do not have git(<a href=\"https://git-scm.com/\" rel=\"nofollow noreferrer\">git-scm.com</a>) installed, you may encounter the same problem again"}], "tags": [], "owner": {"reputation": 46, "user_id": 6882114, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YxH-NmrJZdE/AAAAAAAAAAI/AAAAAAAAABI/aUiJgfFRDTw/photo.jpg?sz=128", "display_name": "Zeyit Ba\u015far", "link": "https://stackoverflow.com/users/6882114/zeyit-ba%c5%9far"}, "is_accepted": false, "score": 0, "last_activity_date": 1493842284, "creation_date": 1493842284, "answer_id": 43769140, "question_id": 43756561, "link": "https://stackoverflow.com/questions/43756561/use-go-get-command-report-open-go-src-runtime-internal-sys-zversion-go-the-sy/43769140#43769140", "title": "use go get command, report open &quot;Go\\src\\runtime\\internal\\sys\\zversion.go&quot; the system cannot find the file specified", "body": "<p>You may not have defined GOPATH or GOROOT.</p>\n\n<p>GOPATH -> The directory where your GoLang work on your computer will be located (your own user specific)</p>\n\n<p>GOROOT -> Displays the GoLang installed directory (for all users) on your computer.</p>\n\n<p>Get help <a href=\"https://beego.me/\" rel=\"nofollow noreferrer\">here</a> to install Beego framework</p>\n\n<p>go get github.com/astaxie/beego</p>\n"}], "owner": {"reputation": 11, "user_id": 7956683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nCfeZ.jpg?s=128&g=1", "display_name": "Jafar.Tang", "link": "https://stackoverflow.com/users/7956683/jafar-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 658, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493842284, "creation_date": 1493804733, "question_id": 43756561, "link": "https://stackoverflow.com/questions/43756561/use-go-get-command-report-open-go-src-runtime-internal-sys-zversion-go-the-sy", "title": "use go get command, report open &quot;Go\\src\\runtime\\internal\\sys\\zversion.go&quot; the system cannot find the file specified", "body": "<p>the commands are as follows: </p>\n\n<p><code>$ go get github.com/beego/bee</code></p>\n\n<p>and the result is :</p>\n\n<p>go: open C:\\Go\\src\\runtime\\internal\\sys\\zversion.go: The system cannot find the file specified.</p>\n\n<p>where goes wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1493808370, "post_id": 43755892, "comment_id": 74556870, "body": "You might be able to wrap each returned client in a struct that implements a common interface."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493809018, "post_id": 43755892, "comment_id": 74557305, "body": "Are <code>Get</code>/<code>Add</code> analogous to <code>Select</code>/<code>Insert</code> in mysql? Or do they represent some <i>connection</i> managment stuff only? That is, is <code>Intfc</code> supposed to handle only the db connection (open, close, etc.) or does it also handle data storage and retrieval (insert user, select comments, etc.)?"}], "answers": [{"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493815766, "post_id": 43759026, "comment_id": 74562168, "body": "Hi Ralph, thanks for sharing, but how would I connect now?"}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493815884, "post_id": 43759026, "comment_id": 74562258, "body": "You connect the same way you did in your original question. The value returned in now a <code>DBClient</code> instead of a client of type specific to the database. That client has methods to do the other DB operations"}, {"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "reply_to_user": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493815944, "post_id": 43759026, "comment_id": 74562306, "body": "Instead of <code>selectedDb.Get(client, addStringA, addStringB, addStringC)</code>, you call <code>client.Get(addStringA, addStringB, addStringC)</code>."}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493817255, "post_id": 43759026, "comment_id": 74563360, "body": "Hmm, I can&#39;t get this to work. Not sure what I&#39;m missing"}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493817768, "post_id": 43759026, "comment_id": 74563801, "body": "this returns: <code>cannot use mysqlConnector.Mysql literal (type mysqlConnector.Mysql) as type dbinit.Intfc in assignment:     mysqlConnector.Mysql does not implement dbinit.Intfc (wrong type for Connect method)         have Connect() mysqlConnector.MySQLClient         want Connect() dbinit.DBClient</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493817898, "post_id": 43759026, "comment_id": 74563922, "body": "just change the return type of the <code>Connect</code> method on your <code>Mysql</code> implementation, from <code>func (Mysql) Connect() MySQLClient {...</code> to <code>func (Mysql) Connect() dbinit.DBClient {...</code>"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1493821820, "post_id": 43759026, "comment_id": 74567098, "body": "The main idea divide your Intfc to 2 level. First - MySqlIntfc and MgoIntfc will provide only method Add and Get - and both satified interface Intfc. And second level provides only functions Connect (better names will be NewMySqlIntfc and NewMgoIntfc) that return Intfc. It allows client to Get/Add without knowlegde of what interface is used."}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1494187664, "post_id": 43759026, "comment_id": 74708879, "body": "Thanks all, but it doesn&#39;t seem to work. Started a bounty to maybe get some other answers"}], "tags": [], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1493811636, "creation_date": 1493811636, "answer_id": 43759026, "question_id": 43755892, "link": "https://stackoverflow.com/questions/43755892/how-to-deal-with-unknown-variables-or-how-to-deal-with-multiple-databases/43759026#43759026", "title": "How to deal with unknown variables or How to deal with multiple databases", "body": "<p>Elaborating on my comment, instead of</p>\n\n<pre><code>type Intfc interface {\n    Connect() HERE_LIES_MY_PROBLEM\n    Add(string, string, string) string\n    Get(string) (Object, bool)\n}\n</code></pre>\n\n<p>you can use</p>\n\n<pre><code>type Intfc interface {\n    Connect() DBClient\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type DBClient interface {\n    Add(string, string, string) string\n    Get(string) (Object, bool)\n}\n\ntype MySQLClient sql.DB\ntype MongoClient mgo.Session\n\nfunc (f Mysql) Connect() DBCLient {\n\n    client, err = sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\n    if err != nil {\n        panic(err.Error())    \n    }\n\n    return MySQLClient(client)\n}\n\nfunc (f Mongo) Connect() DBClient {\n\n    info := &amp;mgo.DialInfo{\n        Addrs:    []string{hosts},\n        Timeout:  60 * time.Second,\n        Database: database,\n        Username: username,\n        Password: password,\n    }\n\n    client, err := mgo.DialWithInfo(info)\n    if err != nil {\n        panic(err)\n    }\n\n    return MongoClient(client)\n}\n\nfunc (s *MySQLClient) Add(...) {\n    // ...\n}\n\nfunc (s *MongoClient) Add(...) {\n    // ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 1, "last_activity_date": 1493811735, "creation_date": 1493811735, "answer_id": 43759072, "question_id": 43755892, "link": "https://stackoverflow.com/questions/43755892/how-to-deal-with-unknown-variables-or-how-to-deal-with-multiple-databases/43759072#43759072", "title": "How to deal with unknown variables or How to deal with multiple databases", "body": "<p>I think, that interface Intfc (or better name DbIntfc) should have only methods Get and Add.</p>\n\n<p>And it should exist another function - but not a part of DbIntfc, that returns DbIntfc - that connects to MySql or MongoDb. Let's look:</p>\n\n<pre><code>    type MySqlDbIntfc struct{\n       db *Sql.DB\n    }\n\n    // Connect to mysql\n    func NewMySqlDbIntfc() (DbIntfc,error) {\n        // Please do not prefer panic in such abstract methods\n        client, err := sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\n        if err != nil {\n            return nil, err\n        }\n        return &amp;MySqlDbIntfc{client}, nil\n    }\n\n    func (mySqlDb *MySqlDbIntfc) Get(Uuid string) (dbinit.Object, error) {\n      var obj dbinit.Object\n      err := mySqlDb.db.QueryRow(\"SELECT uuid, object, deleted FROM myTable WHERE uuid=?\", Uuid).Scan(&amp;obj.Uuid, &amp;obj.Object, &amp;obj.Deleted)\n      if err != nil {\n        return dbinit.Object{}, err\n      }\n      return obj, nil\n    }\n</code></pre>\n\n<p>And implemention NewMgoDbIntfc should be easy, including methods NewMgoDbIntfc.Add/Get.</p>\n\n<p>And decision whether use NewMySqlDbIntfc or NewMgoDbIntfc should also be easy.</p>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1493817067, "creation_date": 1493817067, "answer_id": 43761090, "question_id": 43755892, "link": "https://stackoverflow.com/questions/43755892/how-to-deal-with-unknown-variables-or-how-to-deal-with-multiple-databases/43761090#43761090", "title": "How to deal with unknown variables or How to deal with multiple databases", "body": "<blockquote>\n  <ol>\n  <li>What should be in the places where I have HERE_LIES_MY_PROBLEM in the code?</li>\n  </ol>\n</blockquote>\n\n<p>As you can see from <a href=\"https://github.com/go-mgo/mgo/blob/v2/session.go#L415\" rel=\"nofollow noreferrer\">the source</a> that the <code>DialWithInfo()</code> return <code>error</code> and <code>*Session</code> from <code>mgo</code> package and that is a <code>struct</code>. so you can replace your <strong>HERE_LIES_MY_PROBLEM</strong> with <code>*mgo.Session</code></p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>do I get the Go paradigm wrong for dealing with these things?</li>\n  </ol>\n</blockquote>\n\n<p>As far as the idiomatic to connect with multiple databases there are many opinion I think. And here is some of my thought to connect with mongo and redis : </p>\n\n<pre><code>var logger *log.Logger\n\nfunc init() {\n    logger = log.New(os.Stderr,\n        \"Database :: \",\n        log.Ldate|log.Ltime|log.Lshortfile)\n}\n\n//we create different types of databse connection here.\nfunc SystemConnection() map[string]interface{} {\n    listConnection := make(map[string]interface{})\n    var err error\n    // create redis connection\n    redisConn := RedisHost{\n        Address:  \"localhost:6379\",\n        Password: \"\",\n        DB:       0,\n    }\n\n    redisConnection, err := redisConn.Connect()\n    if err != nil {\n        panic(err)\n    }\n\n    //create mongodb connection\n    mongo := MongoHost{\n        Host: \"localhost\",\n        Port: \"27017\",\n    }\n    mongoConnection := mongo.Connect()\n\n    listConnection[\"redis\"] = redisConnection\n    listConnection[\"mongodb\"] = mongoConnection\n    return listConnection\n}\n\nfunc GetMongo() *mgo.Session {\n    //create mongodb connection\n    mongo := MongoHost{\n        Host: \"localhost\",\n        Port: \"27017\",\n    }\n    mongoConnection := mongo.Connect()\n\n    return mongoConnection\n}\n</code></pre>\n\n<p>you can see the source <a href=\"https://github.com/Gujarats/API-Golang/tree/master/database\" rel=\"nofollow noreferrer\">from here</a></p>\n\n<p>To use above code you can call the <code>SystemConnection()</code> on your <code>init()</code> in your main program. like this : </p>\n\n<pre><code>func init(){\n    listConnection := database.SystemConnection()\n\n    //getting redis connection convert it from interface to *redisClient.\n    redisConn := listConnection[\"redis\"].(*redis.Client)\n\n    // get postgre connection.\n    mongoConn := listConnection[\"mongodb\"].(*mgo.Session)\n\n}\n</code></pre>\n\n<p>Again this approach is my opinion there are others that might be suit with yours.</p>\n"}, {"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 5, "last_activity_date": 1494226517, "creation_date": 1494226517, "answer_id": 43841502, "question_id": 43755892, "link": "https://stackoverflow.com/questions/43755892/how-to-deal-with-unknown-variables-or-how-to-deal-with-multiple-databases/43841502#43841502", "title": "How to deal with unknown variables or How to deal with multiple databases", "body": "<p>If you want to preserve the interface with those methods, you should change a little your interface as:</p>\n\n<p><strong>Interface:</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// The interface that all connectors should have\ntype Intfc interface {\n    // Connect to the database, if an error occur at the moment\n    // of connection, return the error\n    Connect() error\n    // Add returns a string, it returns an error if something occurs\n    Add(string, string, string) (string, error)\n    Get(string) (Object, bool)\n}\n</code></pre>\n\n<p><strong>MySQL:</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Mysql struct{\n    conn *sql.DB // contains the connection to the DB\n}\n\n// Connect to mysql\nfunc (f *Mysql) Connect() error {\n    conn, err := sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\n    if err != nil {\n        return error\n    }\n    f.conn = conn\n    return nil\n}\n\n// Add item to DB\nfunc (f *Mysql) Add(owner string, refType string, object string) (string, error) {\n    // do something\n    return // a string and error\n}\n\nfunc (f *Mysql) Get(Uuid string) (dbinit.Object, bool) {\n    // do something\n    return // an object and a bool\n}\n</code></pre>\n\n<p><strong>Mongo:</strong></p>\n\n\n\n<pre><code>type Mongo struct{\n    session *mgo.Session\n}\n\n// Connect to mongo\nfunc (f *Mongo) Connect() error {\n    info := &amp;mgo.DialInfo{\n        // some data\n    }\n\n    session, err := mgo.DialWithInfo(info)\n    if err != nil {\n        return error\n    }\n    f.session = session\n    return nil\n}\n\n// Add item to DB\nfunc (f *Mongo) Add(owner string, refType string, object string) (string, error) {\n    // do something\n    return // a string and error (it could be nil at success)\n}\n\nfunc (f *Mongo) Get(Uuid string) (dbinit.Object, bool) {\n    // do something\n    return // an object and a bool\n}\n</code></pre>\n\n<p><strong>Main:</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var selectedDb dbinit.Intfc\n\ncommandLineInput := \"mysql\"\n\nif commandLineInput == \"mysql\" {\n    selectedDb = &amp;mysqlConnector.Mysql{}\n} else if commandLineInput == \"mongo\" {\n    selectedDb = &amp;mongoConnector.Mongo{}\n}\n\nerr := selectedDb.Connect()\nif err != nil {\n    panic(err)\n}\n\n// this runs everytime the API is called\napi.HandlerFoobar = foobar.handlerFunction(func(params foobar.Params) middleware.Responder {\n    data, err := selectedDb.Add(addStringA, addStringB, addStringC)\n    if err != nil {\n        // do something\n    }\n\n    return // the API response\n})\n</code></pre>\n\n<p>But you also can remove the <code>Connect() error</code> method from <code>Intfc</code> and just use <code>Add</code> and <code>Get</code>, but you should update the packages like:</p>\n\n<p><strong>Mysql</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Connect to mysql, it could be any function name\nfunc Connect() (*Mysql, error) {\n    connection, err := sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\n    if err != nil {\n        return nil, error\n    }\n    return &amp;Mysql{conn: connection}\n}\n</code></pre>\n\n<p><strong>Mongo</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Connect to mongo, it could be any function name\nfunc Connect() (*Mongo, error) {\n    info := &amp;mgo.DialInfo{\n        // some data\n    }\n\n    s, err := mgo.DialWithInfo(info)\n    if err != nil {\n        return nil, error\n    }\n    return &amp;Mongo{session: s}\n}\n</code></pre>\n\n<p><strong>Main</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var selectedDb dbinit.Intfc\nvar err error\ncommandLineInput := \"mysql\"\n\nif commandLineInput == \"mysql\" {\n    selectedDb, err = mysqlConnector.Connect()\n} else if commandLineInput == \"mongo\" {\n    selectedDb, err = mongoConnector.Connect()\n}\n\nif err != nil {\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1219, "favorite_count": 0, "accepted_answer_id": 43841502, "answer_count": 4, "score": 13, "last_activity_date": 1561623960, "creation_date": 1493803051, "last_edit_date": 1561623960, "question_id": 43755892, "link": "https://stackoverflow.com/questions/43755892/how-to-deal-with-unknown-variables-or-how-to-deal-with-multiple-databases", "title": "How to deal with unknown variables or How to deal with multiple databases", "body": "<p>I'm working on a Go RESTful API application with multiple databases. When starting the server, the user supplies which database they would like to use.</p>\n\n<p>In the application, I have <strong>three functions</strong> of which one handles the connection: <code>selectedDb.Get()</code>, <code>selectedDb.Add()</code>, <code>selectedDb.Connect()</code>.</p>\n\n<p>If somebody selects, Mysql, it handles things for Mysql, if someone selects MongoDB it handles things for Mongo and so on.</p>\n\n<p>This is how I <em>try</em> to accomplish this:</p>\n\n<p><strong>DbInterface.go</strong></p>\n\n<pre><code>package dbinit\n\ntype Object struct {\n    Uuid         string\n    Object       string\n    Deleted      bool\n}\n\n// The interface that all connectors should have\ntype Intfc interface {\n    Connect() HERE_LIES_MY_PROBLEM\n    Add(string, string, string) string\n    Get(string) (Object, bool)\n}\n</code></pre>\n\n<p><strong>MySQL.go</strong></p>\n\n<pre><code>package mysqlConnector\n\nimport (\n    ...\n)\n\ntype Mysql struct{}\n\n// Connect to mysql\nfunc (f Mysql) Connect() HERE_LIES_MY_PROBLEM {\n\n    client, err = sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\n    if err != nil {\n        panic(err.Error())    \n    }\n\n    return client\n}\n\n// Add item to DB\nfunc (f Mysql) Add(owner string, refType string, object string) string {\n    // do stuff related to this DB\n\n    return // a string\n}\n\nfunc (f Mysql) Get(Uuid string) (dbinit.Object, bool) {\n    // do stuff related to this DB\n\n    return // an object and a bool\n}\n</code></pre>\n\n<p><strong>Mongo.go</strong></p>\n\n<pre><code>package mongoConnector\n\nimport (\n    ...\n)\n\ntype Mongo struct{}\n\n// Connect to mongo\nfunc (f Mongo) Connect() HERE_LIES_MY_PROBLEM {\n\n    info := &amp;mgo.DialInfo{\n        Addrs:    []string{hosts},\n        Timeout:  60 * time.Second,\n        Database: database,\n        Username: username,\n        Password: password,\n    }\n\n    client, err := mgo.DialWithInfo(info)\n    if err != nil {\n        panic(err)\n    }\n\n    return client\n}\n\n// Add item to DB\nfunc (f Mongo) Add(owner string, refType string, object string) string {\n    // do stuff related to this DB\n\n    return // a string\n}\n\nfunc (f Mongo) Get(Uuid string) (dbinit.Object, bool) {\n    // do stuff related to this DB\n\n    return // an object and a bool\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>...\n\nvar selectedDb dbinit.Intfc\n\ncommandLineInput := \"mysql\" // just for the example\n\nif commandLineInput == \"mysql\" {\n    selectedDb = mysqlConnector.Mysql{}\n} else if commandLineInput == \"mongo\" {\n    selectedDb = mongoConnector.Mongo{}\n}\n\nclient := selectedDb.Connect()\n\n// this runs everytime the API is called\napi.HandlerFoobar = foobar.handlerFunction(func(params foobar.Params) middleware.Responder {\n\n    // Here I want to add something to the selected dbinit\n    selectedDb.Get(client, addStringA, addStringB, addStringC)\n\n    return // the API response\n\n})\n\n...\n</code></pre>\n\n<p><strong>Problem statement</strong></p>\n\n<p>When I return the client for Mysql, it doesn't work for Mongo and visa versa.</p>\n\n<p>I want to connect to the database ONLY when starting the server and store the <code>client</code> inside the client variable. The problem, however, is that Mongo returns another client than Mysql does and so forth.</p>\n\n<ol>\n<li>What should be in the places where I have <code>HERE_LIES_MY_PROBLEM</code> in the code?</li>\n<li>Or do I get the Go paradigm wrong for dealing with these things?</li>\n</ol>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1493796802, "last_edit_date": 1493796802, "creation_date": 1493796101, "answer_id": 43753647, "question_id": 43753470, "link": "https://stackoverflow.com/questions/43753470/why-gos-channel-can-close-twice/43753647#43753647", "title": "Why Go&#39;s channel can close twice?", "body": "<p>A channel can only be closed once, attempting to close a closed channel panics.</p>\n\n<p>But <a href=\"https://golang.org/ref/spec#Receive_operator\" rel=\"noreferrer\">receiving</a> from a closed channel is not limited, receiving from a closed channel:</p>\n\n<blockquote>\n  <p>A receive operation on a <a href=\"https://golang.org/ref/spec#Close\" rel=\"noreferrer\">closed</a> channel can always proceed immediately, yielding the element type's <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> after any previously sent values have been received.</p>\n</blockquote>\n\n<p>A Go app runs until its main goroutine runs (given \"normal\" circumstances), or from another point of view: a Go app terminates when its main goroutine terminates, that is, the <code>main()</code> function returns. It does not wait for other non-<code>main</code> goroutines to complete.</p>\n\n<p>You started a 2nd goroutine with an endless <code>for</code> loop, with no way of terminating. So that loop will keep going until the <code>main()</code> function \u2013which runs in the concurrent, main goroutine\u2013 returns. Since the <code>for</code> loop first receives from <code>jobs</code>, it waits for the main goroutine to close it (this receive operation can only then proceed). Then the main goroutine wants to receive from <code>done</code>, so that waits until the 2nd goroutine sends a value on it. Then the main goroutine is \"free\" to terminate at any moment. Your 2nd goroutine running the loop may receive an additional value from <code>jobs</code> since it's closed, but the subsequent send on <code>done</code> will block as there are nobody receiving from it anymore (and it's unbuffered).</p>\n\n<p>Receiving from a channel until it's closed is normally done using <code>for range</code>, which exits if the channel is closed:</p>\n\n<pre><code>for j := range jobs {\n    fmt.Println(\"received: \", j)\n    done &lt;- true\n}\n</code></pre>\n\n<p>Of course this would cause a deadlock in your case, as the loop body would never be reached as nobody sends anything on <code>jobs</code>, and so the loop would never enter its body to send a value on <code>done</code> which is what the main goroutine waits for.</p>\n"}, {"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1493796259, "creation_date": 1493796259, "answer_id": 43753711, "question_id": 43753470, "link": "https://stackoverflow.com/questions/43753470/why-gos-channel-can-close-twice/43753711#43753711", "title": "Why Go&#39;s channel can close twice?", "body": "<p>The <code>jobs</code> channel is not being closed twice. It's closed only once when <code>close(jobs)</code> is called. The output you are seeing is because of how the goroutine and main threads are executing.</p>\n\n<p>When the goroutine fires, it does not immidieatly start running. Instead, the program control goes to this part:</p>\n\n<pre><code>  close(jobs) // &lt;--\n  &lt;- done\n}\n</code></pre>\n\n<p>and <code>jobs</code> is closed. Main thread then hangs on the next receive on <code>done</code>.</p>\n\n<p>Now context switching occurs and the goroutine starts running. It reads from a closed <code>jobs</code>, prints the appropriate values (<code>false</code> for <code>more</code> indicating a closed channel), and sends a <code>true</code> along <code>done</code>.</p>\n\n<p>However, the loop is able to execute once more and the goroutine blocks on the next send on <code>done</code>. Now <code>main</code> wakes up again, receives on <code>done</code> and terminates the program.</p>\n"}, {"tags": [], "owner": {"reputation": 544, "user_id": 4429372, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a3b46109ee56d7f16757b0db3fb3a3c3?s=128&d=identicon&r=PG", "display_name": "logsv", "link": "https://stackoverflow.com/users/4429372/logsv"}, "is_accepted": false, "score": 0, "last_activity_date": 1493797551, "creation_date": 1493797551, "answer_id": 43754119, "question_id": 43753470, "link": "https://stackoverflow.com/questions/43753470/why-gos-channel-can-close-twice/43754119#43754119", "title": "Why Go&#39;s channel can close twice?", "body": "<p>Go channel no getting closed twise. your are passing done &lt;- true after first print </p>\n\n<pre><code>j,more := &lt;-jobs\n\nfmt.Println(\"receive close: \", j, more)\ndone &lt;- true\n</code></pre>\n\n<p>so it printed two time </p>\n\n<pre><code>receive close:  0 false\nreceive close:  0 false\n</code></pre>\n\n<p>If you use done &lt;- true before print then it will print one time only, will get closed.</p>\n\n<pre><code>done &lt;- true\nj,more := &lt;-jobs\n\nfmt.Println(\"receive close: \", j, more)\n</code></pre>\n\n<p>Output :</p>\n\n<pre><code>receive close:  0 false\n</code></pre>\n"}], "owner": {"reputation": 1102, "user_id": 1182481, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3c4833d092f9955fb3c47d49e02e937a?s=128&d=identicon&r=PG", "display_name": "shellfly", "link": "https://stackoverflow.com/users/1182481/shellfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7971, "favorite_count": 2, "accepted_answer_id": 43753647, "answer_count": 3, "score": 2, "last_activity_date": 1493797551, "creation_date": 1493795564, "question_id": 43753470, "link": "https://stackoverflow.com/questions/43753470/why-gos-channel-can-close-twice", "title": "Why Go&#39;s channel can close twice?", "body": "<p>When I am do some go practices code, I encounter a problem that a channel can be closed twice like this:</p>\n\n<pre><code>// jobs.go\n\npackage main\n\nimport (\n   \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    jobs := make(chan int, 5)\n    done := make(chan bool)\n\n    go func() {\n        for {\n            j,more := &lt;-jobs\n\n            fmt.Println(\"receive close: \", j, more)\n            done &lt;- true   \n        }\n    }()\n\n    close(jobs)\n    &lt;- done\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>~ go run jobs.go\nHello, playground\nreceive close:  0 false\nreceive close:  0 false\n</code></pre>\n\n<p>But when I close the channel twice manually, I got <code>panic: close of closed channel</code>. </p>\n\n<p>Why the code above can receive close  twice?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493792845, "post_id": 43751322, "comment_id": 74547060, "body": "1. There are no &quot;sub-projects&quot; in Go (for whatever notion of sub-project you might choose). 2. You can have handlers for URL paths like /subproject1/whatever in any package you import into your executable. So just make a package which supplies one HTTP handler &quot;per subproject&quot; and route to this handler from your main. 3. Folder structure is not relevant here."}], "answers": [{"comments": [{"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1493818899, "post_id": 43761730, "comment_id": 74564738, "body": "Of course, you might want those group routes to be created in your sub-projects via function call, i.e. <code>project1.init_routes(v1)</code>"}], "tags": [], "owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "is_accepted": false, "score": 3, "last_activity_date": 1493818677, "creation_date": 1493818677, "answer_id": 43761730, "question_id": 43751322, "link": "https://stackoverflow.com/questions/43751322/golang-best-way-of-calling-invoking-sub-project/43761730#43761730", "title": "Golang best way of calling/invoking sub project", "body": "<p><strong>To be</strong></p>\n\n<p><em>Golang</em> source code is not running through interpreter, but is built into a binary, which gives less flexibility in case of dynamic projects. That said, I'd keep my projects isolated one from another, and would let <em>Nginx</em> (for example) take care of multiple project grouping. Of course, that would require some refactoring like creating shared packages, etc.</p>\n\n<p><strong>Or not to be</strong></p>\n\n<p>If, for some reason, you still think running multiple projects via single binary is ok, it's your choice. In this case you might have a look into route grouping that are available in some frameworks. Here's <a href=\"https://github.com/gin-gonic/gin#grouping-routes\" rel=\"nofollow noreferrer\">what Go Gin provides</a>:</p>\n\n<pre><code>func main() {\n    router := gin.Default()\n\n    // Simple group: v1\n    v1 := router.Group(\"/v1\")\n    {\n        v1.POST(\"/login\", loginEndpoint)\n        v1.POST(\"/submit\", submitEndpoint)\n        v1.POST(\"/read\", readEndpoint)\n    }\n\n    // Simple group: v2\n    v2 := router.Group(\"/v2\")\n    {\n        v2.POST(\"/login\", loginEndpoint)\n        v2.POST(\"/submit\", submitEndpoint)\n        v2.POST(\"/read\", readEndpoint)\n    }\n\n    router.Run(\":8080\")\n}\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 7244426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd3cd5c043c125a0186effe9b4830ff6?s=128&d=identicon&r=PG&f=1", "display_name": "msk", "link": "https://stackoverflow.com/users/7244426/msk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493824477, "creation_date": 1493787073, "last_edit_date": 1493824477, "question_id": 43751322, "link": "https://stackoverflow.com/questions/43751322/golang-best-way-of-calling-invoking-sub-project", "title": "Golang best way of calling/invoking sub project", "body": "<p>Im moving my project from <code>PHP</code> to <code>Golang</code> and I looking efficient way of calling/invoking/handling control to <code>sub project</code> <code>main.go</code> from <code>src</code> <code>main.go</code>,  I want to pass control from</p>\n\n<pre><code>http://localhost/  =&gt;   http://localhost/sub-project1/\nhttp://localhost/  =&gt;   http://localhost/sub-project2/\nhttp://localhost/  =&gt;   http://localhost/sub-projectn/\n</code></pre>\n\n<p>I'm new to <code>Golang</code> I don't know how to do it in best way, and my project structure is</p>\n\n<pre><code>src/\n    main.go\n    sub-project1/\n        main.go\n    sub-project2/\n        main.go\n    sub-projectn/\n        main.go\n    gitHub.com/\n        ......\n    golang.org/\n        ......\n</code></pre>\n\n<p>I'm using <code>httprouter</code> for routing, in <code>main.go</code> which is located under <code>src</code> contain following</p>\n\n<pre><code>package main\nimport ....\n\n// homePageHandler\n// contactPageHandler\n// aboutPageHandler\n// loginPageHandler\n// signupPageHandler\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/\", homePageHandler)\n    router.GET(\"/contact\", contactPageHandler)\n    router.GET(\"/about\", aboutPageHandler)\n    router.GET(\"/login\", loginPageHandler)\n    router.GET(\"/signup\", signupPageHandler)\n\n    // here I want to pass control to my sub project main.go \n    // and I don't want to write any /sub-project routing urls here,\n    // because each /sub-project's contain many urls \n    router.GET(\"/sub-project1\", ??????)\n    router.GET(\"/sub-project2\", ??????)\n    router.GET(\"/sub-project3\", ??????)\n    router.GET(\"/sub-projectn\", ??????)\n}\n</code></pre>\n\n<p>and all files must be passes from <code>src</code> <code>main.go</code> because whole project has only one <code>main()</code> and inside any <code>/sub-projectx</code> <code>main.go</code> I want to do this</p>\n\n<pre><code>package main\nimport ....\n// subprojectPageHandler\n// feature1PageHandler\n// feature2PageHandler\n// feature3PageHandler\n// ........\n// featurenPageHandler\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/sub-projectx\", subprojectPageHandler)\n    router.GET(\"/sub-projectx/feature1\", feature1PageHandler)\n    router.GET(\"/sub-projectx/feature2\", feature2PageHandler)\n    router.GET(\"/sub-projectx/feature3\", feature3PageHandler)\n    ..........\n    router.GET(\"/sub-projectx/featureN\", featureNPageHandler)\n\n\n    // here I want to pass control to my sub project main.go \n    // and I don't want to write any /sub-project routing urls here,\n    // because each /sub-project's contain many urls \n    router.GET(\"/sub-project1\", ??????)\n    router.GET(\"/sub-project2\", ??????)\n    router.GET(\"/sub-project3\", ??????)\n    router.GET(\"/sub-projectn\", ??????)\n}\n</code></pre>\n"}, {"tags": ["go", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "edited": false, "score": 0, "creation_date": 1499058335, "post_id": 43751383, "comment_id": 76734346, "body": "Thanks for the help."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 3, "last_activity_date": 1493790794, "last_edit_date": 1493790794, "creation_date": 1493787422, "answer_id": 43751383, "question_id": 43751095, "link": "https://stackoverflow.com/questions/43751095/customizing-error-structure-in-golang/43751383#43751383", "title": "Customizing error structure in Golang", "body": "<p><code>error</code> in not a struct, is an interface. </p>\n\n<pre><code>type error interface {\n    Error() string\n}\n</code></pre>\n\n<p>you can define your own error struct, just implement the <code>Error() string</code> function.</p>\n\n<pre><code>type ErrorA struct {\n    // any field you want\n}\n\nfunc (e ErrorA) Error() string {\n    // implement this function\n}\n</code></pre>\n\n<p>then <code>ErrorA</code> can be used as <code>error</code>.</p>\n\n<p>ref:<br>\n1. <a href=\"https://golang.org/ref/spec#Errors\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Errors</a><br>\n2. <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Interface_types</a></p>\n"}], "owner": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 43751383, "answer_count": 1, "score": -1, "last_activity_date": 1493809417, "creation_date": 1493785819, "last_edit_date": 1493809417, "question_id": 43751095, "link": "https://stackoverflow.com/questions/43751095/customizing-error-structure-in-golang", "title": "Customizing error structure in Golang", "body": "<p>The default structure for error messages in golang contains a string but I want to add dynamic response code and the time the error occurred to it. Any suggestions on how to do it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1493777530, "post_id": 43749952, "comment_id": 74542530, "body": "There are no reference types in golang, everything is passed by value."}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1493788146, "post_id": 43749952, "comment_id": 74545143, "body": "what&#39;s the problem here?"}, {"owner": {"reputation": 187, "user_id": 459019, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e30a1b3669c3ee7d2f12b88ebbd0d9c6?s=128&d=identicon&r=PG", "display_name": "Icestorm", "link": "https://stackoverflow.com/users/459019/icestorm"}, "edited": false, "score": 0, "creation_date": 1493838115, "post_id": 43749952, "comment_id": 74577554, "body": "The problem was there&#39;s no way that a user of an api can tell(from the method signature) whether they need to use T or *T when using assertions. You basically need to guess. Unless there&#39;s a best practice around using one or the other."}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 1, "last_activity_date": 1493777667, "creation_date": 1493777667, "answer_id": 43749978, "question_id": 43749952, "link": "https://stackoverflow.com/questions/43749952/type-assertion-when-returning-an-interface/43749978#43749978", "title": "Type assertion when returning an interface", "body": "<blockquote>\n  <p>So if my understanding is correct, the user needs to know how the struct is returned to correctly assert its type?</p>\n</blockquote>\n\n<p>It depends. If you need the type assertion to pass - you surely need to know the exact type of the value. <code>a</code> and <code>*a</code> are different types.</p>\n\n<blockquote>\n  <p>I'm going to guess and assume the standard practice in golang is to always return a pointer to a struct(i.e like *PathError)?</p>\n</blockquote>\n\n<p>No.</p>\n"}], "owner": {"reputation": 187, "user_id": 459019, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e30a1b3669c3ee7d2f12b88ebbd0d9c6?s=128&d=identicon&r=PG", "display_name": "Icestorm", "link": "https://stackoverflow.com/users/459019/icestorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 43749978, "answer_count": 1, "score": -1, "last_activity_date": 1493777667, "creation_date": 1493777447, "last_edit_date": 1493777541, "question_id": 43749952, "link": "https://stackoverflow.com/questions/43749952/type-assertion-when-returning-an-interface", "title": "Type assertion when returning an interface", "body": "<p>I'm new to golang; however based on my current knowledge I understand that a <em>value-type</em> and a <em>reference-type</em> can both fulfill an interface. But it seems in regards to type assertion, how you return a struct does matter. See the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype SomeError interface {\n    Error() string\n}\n\ntype ConcreteError struct{}\n\nfunc (ConcreteError) Error() string {\n    return \"?\"\n}\n\nfunc returnPointer() SomeError {\n    return &amp;ConcreteError{}\n}\n\nfunc returnVal() SomeError {\n    return ConcreteError{}\n}\n\nfunc main() {\n    pointer := returnPointer()\n    value := returnVal()\n    _, pointerWithPointer := pointer.(*ConcreteError);\n    _, pointerWithValue := pointer.(ConcreteError);\n\n    _, valueWithValue := value.(ConcreteError);\n    _, valueWithPointer := value.(*ConcreteError)\n\n    fmt.Printf(\"Returning a pointer, assert using (*ConcreteError): %v\\n\", pointerWithPointer); // true\n    fmt.Printf(\"Returning a pointer, assert using (ConcreteError): %v\\n\", pointerWithValue); // false\n    fmt.Printf(\"Returning a value,   assert using (ConcreteError): %v\\n\", valueWithValue); // true\n    fmt.Printf(\"Returning a value,   assert using (*ConcreteError): %v\\n\", valueWithPointer); // false\n}\n</code></pre>\n\n<p>So if my understanding is correct, the user needs to know how the struct is returned to correctly assert its type?</p>\n\n<p>I'm going to guess and assume the standard practice in golang is to always return a pointer to a struct(i.e like *PathError)?</p>\n\n<p>link to play: <a href=\"https://play.golang.org/p/ieToKnErJ7\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["go", "concurrency", "channel"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1493775584, "post_id": 43749424, "comment_id": 74542122, "body": "I don&#39;t have time right now for a complete answer, but an unbuffered channel blocks until the corresponding receive is done. When you send the job on the <code>Queue</code> channel, it waits for the object to be received, which isn&#39;t going to happen because you try to receive it later in that same function. You might want to read more about channels here: <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#channels</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7968, "user_id": 485676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b9bd46ef45b1c9e0c7cbe422c0326e5?s=128&d=identicon&r=PG", "display_name": "Nemoden", "link": "https://stackoverflow.com/users/485676/nemoden"}, "edited": false, "score": 0, "creation_date": 1493816882, "post_id": 43754404, "comment_id": 74563030, "body": "Thank you for the answer! But I guess things are even worse with my code. It took me a whole day to understand exactly what <b>unbuffered channels</b> are and how they work. By <code>things are worse</code> I mean the code will not even reach first loop, even defer statement: <a href=\"https://play.golang.org/p/G96SoHdgUB\" rel=\"nofollow noreferrer\">play.golang.org/p/G96SoHdgUB</a> I&#39;ve taught myself on how unbuffered channels are blocking with the following code I wrote: <a href=\"https://play.golang.org/p/ZFTSTrMDeA\" rel=\"nofollow noreferrer\">play.golang.org/p/ZFTSTrMDeA</a> Now I&#39;ve got an idea how to re-write code, but way too tired today learning go :)"}, {"owner": {"reputation": 7968, "user_id": 485676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b9bd46ef45b1c9e0c7cbe422c0326e5?s=128&d=identicon&r=PG", "display_name": "Nemoden", "link": "https://stackoverflow.com/users/485676/nemoden"}, "edited": false, "score": 0, "creation_date": 1493817568, "post_id": 43754404, "comment_id": 74563627, "body": "And yes, second link to a playground is a good example of memory leak in go since goroutine will stay in memory forever (wont be gc&#39;ed) and I don&#39;t think things will change since there is (presumably) no acceptable way to gc such hanging goroutines <a href=\"https://github.com/golang/go/issues/19702\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19702</a>"}], "tags": [], "owner": {"reputation": 376, "user_id": 953837, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e809f1b811d369a2ff190f45115ed893?s=128&d=identicon&r=PG", "display_name": "Gov", "link": "https://stackoverflow.com/users/953837/gov"}, "is_accepted": false, "score": 1, "last_activity_date": 1493799135, "last_edit_date": 1493799135, "creation_date": 1493798462, "answer_id": 43754404, "question_id": 43749424, "link": "https://stackoverflow.com/questions/43749424/understanding-golang-channels-all-goroutines-are-asleep-deadlock-tour-of-go/43754404#43754404", "title": "Understanding golang channels. All goroutines are asleep - deadlock [Tour of Go, Crawler]", "body": "<p>You're 'defer'ring the closing of the queue. This means \"Close the Queue when this function (Crawl) exits!\"</p>\n\n<p>Then you enter a loop that will block until it either:</p>\n\n<ol>\n<li>Receives an item OR</li>\n<li>'Queue' is closed</li>\n</ol>\n\n<p>There is a 'Job' added to the queue at the beginning (this would allow the loop to run a single time), then at the end of the first run, the loop will block until either of the above two conditions are met once again. </p>\n\n<p><em>Note: The run through the first loop could potentially add more items to the queue (and therefore cause more iterations), at some point though, the loop's queue will be exhausted and the loop will once again block waiting for one of the above two conditions</em></p>\n\n<p>However, there are never any more items added to the queue (so #1 fails) and the 'Queue' is only closed after this function exits, which cannot happen until after the loop exits (so #2 fails).</p>\n\n<p><strong>TLDR:</strong> Your loop is waiting for your function to exit, and your function is waiting for your loop to exit - Deadlock</p>\n"}], "owner": {"reputation": 7968, "user_id": 485676, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6b9bd46ef45b1c9e0c7cbe422c0326e5?s=128&d=identicon&r=PG", "display_name": "Nemoden", "link": "https://stackoverflow.com/users/485676/nemoden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493799135, "creation_date": 1493773066, "last_edit_date": 1493773495, "question_id": 43749424, "link": "https://stackoverflow.com/questions/43749424/understanding-golang-channels-all-goroutines-are-asleep-deadlock-tour-of-go", "title": "Understanding golang channels. All goroutines are asleep - deadlock [Tour of Go, Crawler]", "body": "<p>Probably this is what happens when a PHP-developer who has never dealt with multi-threaded programs starts to learn golang and channels.</p>\n\n<p>I'm on the last exercise of Tour of Go, <a href=\"https://tour.golang.org/concurrency/10\" rel=\"nofollow noreferrer\">[Exercise: Web Crawler]</a> (I had no problems with other exercises before this one)</p>\n\n<p>I'm trying to write as simple code as possible though,\nmy Crawl method looks like this:</p>\n\n<pre><code>func Crawl(url string, depth int, fetcher Fetcher) {\n    // kick off crawling by passing initial Url to a Job queue\n    Queue &lt;- Job{\n        url,\n        depth,\n    }\n\n    // make sure we close the Queue channel\n    defer close(Queue)\n\n    // read from the Queue\n    for job := range Queue {\n        // if fetched or has hit the bottom of depth,\n        // just continue right away to pick up next Job\n        if fetched.Has(job.Url) || job.Depth &lt;= 0 {\n            continue\n        }\n        fres := fetcher.Fetch(job.Url)\n        fetched.Add(job.Url, fres)\n        for i := range fres.Urls {\n            // send new urls just fetched from current url in Job\n            // to the Queue\n            Queue &lt;- Job{\n                fres.Urls[i], job.Depth - 1,\n            }\n        }\n    }\n\n    for _, res := range fetched.m {\n        fmt.Println(res)\n    }\n}\n</code></pre>\n\n<p><code>go run</code> says I should not write any <code>go</code> code and get back to <code>PHP</code>:</p>\n\n<pre><code>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan send]:\nmain.Crawl(0xf37c1, 0x12, 0x4, 0x1600e0, 0x104401c0, 0x104000f0)\n    /tmp/sandbox452918312/main.go:64 +0x80\nmain.main()\n    /tmp/sandbox452918312/main.go:87 +0x60\n</code></pre>\n\n<p>Of course, I have googled this problem and the conclusion is usually: \"close your chans\", which I did (did I?).</p>\n\n<p>So, can somebody point out what am I missing here?</p>\n\n<p>The complete code is here: <a href=\"https://play.golang.org/p/-98SdVndD6\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-98SdVndD6</a></p>\n\n<p>What is the most idiomatic golang way for this exercise? I've found a handful of them.</p>\n\n<ul>\n<li><a href=\"https://gist.github.com/avalanche123/4127253\" rel=\"nofollow noreferrer\">by avalanche123</a></li>\n<li><a href=\"https://github.com/fgrehm/go-tour/blob/master/73-web-crawler-golang-team-solution.go\" rel=\"nofollow noreferrer\">by fgrehm</a></li>\n<li><a href=\"https://play.golang.org/p/Zovub8KdL-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Zovub8KdL-</a></li>\n</ul>\n\n<p>etc. which one seems to be a clean solution to you?</p>\n\n<p>Also, should I use channels <strong>only</strong> with goroutines?</p>\n"}, {"tags": ["google-app-engine", "ssl", "go", "https", "google-cloud-platform"], "comments": [{"owner": {"reputation": 528, "user_id": 6341812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0de3a15a3177a569d2394f6a5aee487?s=128&d=identicon&r=PG", "display_name": "Prateek Gupta", "link": "https://stackoverflow.com/users/6341812/prateek-gupta"}, "edited": false, "score": 0, "creation_date": 1493792739, "post_id": 43748981, "comment_id": 74547004, "body": "Duplicate of [<a href=\"http://stackoverflow.com/questions/5367974/https-only-in-google-app-engine]\" title=\"https only in google app engine%5d\">stackoverflow.com/questions/5367974/&hellip;</a>"}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 528, "user_id": 6341812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0de3a15a3177a569d2394f6a5aee487?s=128&d=identicon&r=PG", "display_name": "Prateek Gupta", "link": "https://stackoverflow.com/users/6341812/prateek-gupta"}, "edited": false, "score": 2, "creation_date": 1493823991, "post_id": 43748981, "comment_id": 74568843, "body": "@PrateekGupta You should first read the question before reaching this kind of decision. The question you posted does not involve flexible environment. Also I already mentioned that the solution offered there does not work because of the flexible environment case."}], "answers": [{"comments": [{"owner": {"reputation": 1380, "user_id": 1170354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H14HR.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/1170354/oliver"}, "edited": false, "score": 0, "creation_date": 1542071408, "post_id": 44053531, "comment_id": 93427970, "body": "should the <code>next(w, r)</code> after the else be removed?"}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 1380, "user_id": 1170354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H14HR.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/1170354/oliver"}, "edited": false, "score": 1, "creation_date": 1542141920, "post_id": 44053531, "comment_id": 93460255, "body": "It actually make sense, thank you for correcting. Please feel free to edit!"}], "tags": [], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "is_accepted": true, "score": 2, "last_activity_date": 1542263791, "last_edit_date": 1542263791, "creation_date": 1495125708, "answer_id": 44053531, "question_id": 43748981, "link": "https://stackoverflow.com/questions/43748981/google-cloud-platform-golang-flexible-environment-https-only-for-custom-domain/44053531#44053531", "title": "Google Cloud Platform, Golang Flexible Environment HTTPS only for custom domain", "body": "<p>Currently, flexible environment does not support HTTPS only directing by using <code>app.yaml</code>. However, this can be achieved in the server code by using a function like this,</p>\n\n<pre><code>func directToHttps(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n    if r.URL.Scheme == \"https\" || strings.HasPrefix(r.Proto, \"HTTPS\") || r.Header.Get(\"X-Forwarded-Proto\") == \"https\" {\n        next(w, r)\n    } else {\n        target := \"https://\" + r.Host + r.URL.Path\n\n        http.Redirect(w, r, target,\n            http.StatusTemporaryRedirect)\n    }\n}\n</code></pre>\n\n<p>I wrapped this function to my handlers with <code>negroni</code>.</p>\n\n<p>Working example can be found here: <a href=\"https://github.com/malisit/munhasir\" rel=\"nofollow noreferrer\">https://github.com/malisit/munhasir</a></p>\n"}], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 0, "accepted_answer_id": 44053531, "answer_count": 1, "score": 1, "last_activity_date": 1542263791, "creation_date": 1493769413, "question_id": 43748981, "link": "https://stackoverflow.com/questions/43748981/google-cloud-platform-golang-flexible-environment-https-only-for-custom-domain", "title": "Google Cloud Platform, Golang Flexible Environment HTTPS only for custom domain", "body": "<p>I have deployed my application without hassle just by running <code>gcloud app deploy</code> command on GCP. Which takes the flexible environment as default. Yesterday I made the necessary customizations to have a custom domain for this app with ssl. Currently it works when I go to any of the following, <code>http://example.com</code>, <code>https://example.com</code> but I also want to force people to use https. Currently the http requests work as they are, I want them to be directed to https. I want to direct any user to <code>https://example.com</code> when they try to go to the website with http or without anything at all like <code>example.com</code>. How can this be achieved?</p>\n\n<p>Here's my <code>app.yaml</code>:</p>\n\n<pre><code>api_version: go1\nenv: flex\nruntime: go\n</code></pre>\n\n<p>I already tried to use <code>handlers and secure</code> attributes but it seems they are not valid for flexible environment.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c#", "go"], "comments": [{"owner": {"reputation": 152, "user_id": 1657083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KD4f8.jpg?s=128&g=1", "display_name": "RadekSohlich", "link": "https://stackoverflow.com/users/1657083/radeksohlich"}, "edited": false, "score": 2, "creation_date": 1493814988, "post_id": 43748751, "comment_id": 74561552, "body": "Good approach is to go through some open-source project to get an inspiration how to handle these issues. Try to go through the <a href=\"http://gobuffalo.io\" rel=\"nofollow noreferrer\">gobuffalo.io</a> project. For this particular case the <a href=\"https://github.com/markbates/pop\" rel=\"nofollow noreferrer\">github.com/markbates/pop</a> could help."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1493841569, "post_id": 43748751, "comment_id": 74579305, "body": "The best advice I can give is not to try to emulate other languages, especially object-oriented ones. Applying Java or C# idioms to Go will cause you no end of pain down the road. Rather than trying to do things the way you&#39;re used to, just do the simplest thing that could work that seems idiomatic in Go, and iterate from there. KISS+YAGNI will save you many headaches. Look to existing, similar projects for inspiration."}], "answers": [{"comments": [{"owner": {"reputation": 597, "user_id": 2836841, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5aed770572ea9c55247ac7bee8cea36f?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2836841/ben"}, "edited": false, "score": 0, "creation_date": 1499485181, "post_id": 44981367, "comment_id": 76939666, "body": "This is the model I had already gone with and it is great to get some confirmation that it was a good decision - it has certainly worked well in my application, thus far, albeit, somewhat at the price of development speed."}, {"owner": {"reputation": 5455, "user_id": 555493, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/7f71360d1b97bf28012fffa173ec0eb0?s=128&d=identicon&r=PG", "display_name": "U Avalos", "link": "https://stackoverflow.com/users/555493/u-avalos"}, "edited": false, "score": 0, "creation_date": 1520634119, "post_id": 44981367, "comment_id": 85411425, "body": "Yea but this couples the API with the database. It doesn&#39;t &quot;scale&quot; (namely, API versions, or even refactoring the table.)"}], "tags": [], "owner": {"reputation": 1621, "user_id": 486998, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0f0a1ee2c9b6c87792a2637a95f272cf?s=128&d=identicon&r=PG", "display_name": "klotz", "link": "https://stackoverflow.com/users/486998/klotz"}, "is_accepted": true, "score": 18, "last_activity_date": 1499473889, "creation_date": 1499473889, "answer_id": 44981367, "question_id": 43748751, "link": "https://stackoverflow.com/questions/43748751/golang-dtos-entities-and-mapping/44981367#44981367", "title": "Golang - DTOs, Entities and Mapping", "body": "<p>In the case of a REST API, you'll typically deal with at least three different implementation layers:</p>\n\n<ul>\n<li>HTTP handler</li>\n<li>some sort of business logic/use case</li>\n<li>persistent storage/database interface</li>\n</ul>\n\n<p>You can treat and build each of these separately which does not only decouple it but makes it just a lot more testable, too. These parts then are put together by injecting the necessary bits since they conform to interfaces you define. Usually this ends up leaving the <code>main</code> or a separate configuration mechanism the only place that's aware of <em>what</em> is combined and injected <em>how</em>.</p>\n\n<p>The article <a href=\"http://manuel.kiessling.net/2012/09/28/applying-the-clean-architecture-to-go-applications\" rel=\"noreferrer\">Applying The Clean Architecture to Go applications</a> illustrates very well how the various parts can be separated. How strictly you should follow this approach depends a little on the complexity of your project.</p>\n\n<p>Below is a very basic breakdown, separating the handler from logic and database layer.</p>\n\n<h2>HTTP handler</h2>\n\n<p>The handler does nothing else than mapping the request values into local variables or possibly custom data structures if needed. In addition to that it just runs the use case logic and maps the result before writing it to the response. This is also a good place to map different errors to different response objects.</p>\n\n<pre><code>type Interactor interface {\n    Bar(foo string) ([]usecases.Bar, error)\n}\n\ntype MyHandler struct {\n    Interactor Interactor\n}\n\nfunc (handler MyHandler) Bar(w http.ResponseWriter, r *http.Request) {\n    foo := r.FormValue(\"foo\")\n    res, _ := handler.Interactor.Bar(foo)\n\n    // you may want to map/cast res to a different type that is encoded\n    // according to your spec\n    json.NewEncoder(w).Encode(res)\n}\n</code></pre>\n\n<p>Unit tests are a great way to test that the HTTP response contains the correct data for different results and errors.</p>\n\n<h2>Use case / business logic</h2>\n\n<p>Since the repository is just specified as an interface it's very easy to create unit tests for the business logic with different results returned by a mock repository implementation that also conforms to <code>DataRepository</code>.</p>\n\n<pre><code>type DataRepository interface {\n    Find(f string) (Bar, error)\n}\n\ntype Bar struct {\n    Identifier string\n    FooBar     int\n}\n\ntype Interactor struct {\n    DataRepository DataRepository\n}\n\nfunc (interactor *Interactor) Bar(f string) (Bar, error) {\n    b := interactor.DataRepository.Find(f)\n\n    // ... custom logic\n\n    return b\n}   \n</code></pre>\n\n<h2>Database interface</h2>\n\n<p>The part talking to the database implements the <code>DataRepository</code> interface but is otherwise totally independent on how it turns the data into the expected types.</p>\n\n<pre><code>type Repo {\n    db sql.DB\n}\n\nfunc NewDatabaseRepo(db sql.DB) *Repo {\n    // config if necessary...\n\n    return &amp;Repo{db: db}\n}\n\nfunc (r Repo)Find(f string) (usecases.Bar, error) {\n    rows, err := db.Query(\"SELECT id, foo_bar FROM bar WHERE foo=?\", f)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        var id string, fooBar int\n        if err := rows.Scan(&amp;id, &amp;fooBar); err != nil {\n            log.Fatal(err)\n        }\n        // map row value to desired structure\n        return usecases.Bar{Identifier: id, FooBar: fooBar}\n    }\n\n    return errors.New(\"not found\")\n}\n</code></pre>\n\n<p>Again, this allows testing the database operations separately without the need of any mock SQL statements.</p>\n\n<blockquote>\n  <p><strong>Note:</strong> The code above is very much pseudo code and incomplete.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3555216"}, "is_accepted": false, "score": 5, "last_activity_date": 1502425989, "creation_date": 1502425989, "answer_id": 45627016, "question_id": 43748751, "link": "https://stackoverflow.com/questions/43748751/golang-dtos-entities-and-mapping/45627016#45627016", "title": "Golang - DTOs, Entities and Mapping", "body": "<p>I had .NET MVC experience prior to developing my own application in Go. I did miss that the mapper between BLL and DTO in .NET, but as I write more code in Go, I am getting used to the fact that there is not much free lunch in Go.</p>\n\n<p>The fact that there is almost no framework, NHibernate, Entity, and automatic mapping between URI and views in Go indicates that you probably have to do a lot of work that is taken care of by other frameworks. While this may be inefficient in some people's opinion, it is certainly a great opportunity for learning as well as building a highly customizable application in a less-inefficient manner. Sure, you have to write your own SQL to perform CRUD actions, read the rows returned by the query, map sql.Rows to model, apply some business logic, save changes, map models to DTOs, and send a response back to the client. </p>\n\n<p>As for the difference between DTO and model: DTO is a representation of model for view and has no behaviors (methods). Model is the abstraction of your business logic and has a lot of complex behaviours. I would never implement methods like \"checkProvisioning()\" or \"applyCouponCode()\" on a DTO object because they are business logic. </p>\n\n<p>As for mapping database with your model, I won't take any shortcuts because most of the ORM available at this point is pretty primitive. I won't even try to use foreign keys if I have to build my database with ORM. It is better to build your database from a SQL script since you can also configure indexes, triggers, and other bells and whistles. Yes, if the schema changes, you will have to update quite a bit of code to reflect that change, but most of the time it only affects data access layer code.</p>\n\n<p>I have a project that utilizes C#'s MVC design but is completely written in Go, and I bet it's more complex than any toy projects that you can find from published books. If reading the code help you understand the structure better, then go for it: <a href=\"https://github.com/yubing24/das\" rel=\"noreferrer\">https://github.com/yubing24/das</a></p>\n"}], "owner": {"reputation": 597, "user_id": 2836841, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5aed770572ea9c55247ac7bee8cea36f?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2836841/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13616, "favorite_count": 7, "accepted_answer_id": 44981367, "answer_count": 2, "score": 19, "last_activity_date": 1502425989, "creation_date": 1493767485, "last_edit_date": 1493768161, "question_id": 43748751, "link": "https://stackoverflow.com/questions/43748751/golang-dtos-entities-and-mapping", "title": "Golang - DTOs, Entities and Mapping", "body": "<p>I am new to Go having come from a C# background and I am just plain confused about how to structure a Go application.</p>\n\n<p>Say I am building a REST API that will sit on top of a database. Also say that, even after it is complete, this application could need to change somewhat frequently given the vicissitudes of the business etc.</p>\n\n<p>In C# with tools like Entity Framework and DTOs I somewhat alleviate this problem by abstracting the database from the results given by the controllers. If I change the name of a bunch of fields in the database, I might have to change my database access logic but hopefully my DTOs that I map to my entities using AutoMapper can remain the same so I don't break frontend functionality that relies on a given DTO structure.</p>\n\n<p>Should I replicate this structure with Go's structs? Something about such an approach seems wrong given that structs basically are just DTOs and I will have quite a few DTO structs that are identical to the entity structs. I also have to setup logic to map entities to DTOs. This all just feels very unidiomatic somehow and many of the examples I see on the web just serialise the database structs.</p>\n\n<p>In short, how do people avoid excessive coupling between their API and the database in Go and how would they broadly go about separating out the different parts of the application?</p>\n\n<p>If it makes any difference, I am planning to use <code>sqlx</code> to marshal database results into structs which will mean more tags in addition to the JSON ones if I don't separate entities from DTOs.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1493763254, "post_id": 43747954, "comment_id": 74539288, "body": "FYI: You need to declare the regex as a raw string literal, or double the backslashes."}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1493763350, "post_id": 43747954, "comment_id": 74539321, "body": "sorry, can you help me with the code, I&#39;m new to go lang, i want to go for string literal approach instead of double backslashes, appreciate your help"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1493764302, "post_id": 43747954, "comment_id": 74539624, "body": "See <a href=\"https://regex101.com/r/Dzg3JC/1/codegen?language=golang\" rel=\"nofollow noreferrer\">regex101.com/r/Dzg3JC/1/codegen?language=golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493763714, "post_id": 43748144, "comment_id": 74539449, "body": "you mentioned string literal approach, can you amend with option B as well please?"}, {"owner": {"reputation": 4416, "user_id": 1186936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7eyc.jpg?s=128&g=1", "display_name": "degant", "link": "https://stackoverflow.com/users/1186936/degant"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493763904, "post_id": 43748144, "comment_id": 74539504, "body": "Sure thing. Updated! Try it out now"}, {"owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493763983, "post_id": 43748144, "comment_id": 74539518, "body": "oh i see, got it. by the way I&#39;m not getting any matches, can you try against my test strings"}, {"owner": {"reputation": 4416, "user_id": 1186936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7eyc.jpg?s=128&g=1", "display_name": "degant", "link": "https://stackoverflow.com/users/1186936/degant"}, "reply_to_user": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "edited": false, "score": 0, "creation_date": 1493764155, "post_id": 43748144, "comment_id": 74539577, "body": "@user2727195 your regex seems to be fine. Check out the <a href=\"http://ideone.com/Jonc1Y\" rel=\"nofollow noreferrer\">try it out</a> link in the answer which has output from the regex match operation. All you have to do now is ensure that <code>re.FindStringSubmatch()</code> is getting the right input."}], "tags": [], "owner": {"reputation": 4416, "user_id": 1186936, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R7eyc.jpg?s=128&g=1", "display_name": "degant", "link": "https://stackoverflow.com/users/1186936/degant"}, "is_accepted": true, "score": 1, "last_activity_date": 1493764013, "last_edit_date": 1493764013, "creation_date": 1493763610, "answer_id": 43748144, "question_id": 43747954, "link": "https://stackoverflow.com/questions/43747954/regular-expressions-for-the-guid/43748144#43748144", "title": "regular expressions for the guid", "body": "<p>You need to fix the first line, declare the regex correctly. Try these:</p>\n\n<p><strong>Using backslashes</strong> (to escape)</p>\n\n<pre><code>re := regexp.MustCompile(\"(([a-f0-9]+\\\\-)+[a-f0-9]+)\\\\/(.*?)\\\\/(.*?);version=(\\\\d*)\")\n</code></pre>\n\n<p><a href=\"http://ideone.com/Jonc1Y\" rel=\"nofollow noreferrer\">Try it out</a></p>\n\n<p><strong>Using raw string literals</strong> (`)</p>\n\n<pre><code>re := regexp.MustCompile(`(([a-f0-9]+\\-)+[a-f0-9]+)\\/(.*?)\\/(.*?);version=(\\d*)`)\n</code></pre>\n\n<p><a href=\"http://ideone.com/qyZUIe\" rel=\"nofollow noreferrer\">Try it out</a></p>\n"}], "owner": {"reputation": 5814, "user_id": 2727195, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/5f7f938a39627be91557a2844664dd3e?s=128&d=identicon&r=PG&f=1", "display_name": "user2727195", "link": "https://stackoverflow.com/users/2727195/user2727195"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 43748144, "answer_count": 1, "score": 0, "last_activity_date": 1493764013, "creation_date": 1493762541, "last_edit_date": 1493763947, "question_id": 43747954, "link": "https://stackoverflow.com/questions/43747954/regular-expressions-for-the-guid", "title": "regular expressions for the guid", "body": "<p>I'm having some issues with following regular expressions.</p>\n\n<blockquote>\n  <p>Error: Invalid operation</p>\n</blockquote>\n\n<pre><code>re := regexp.MustCompile(\"(([a-f0-9]+\\-)+[a-f0-9]+)\\/(.*?)\\/(.*?);version=(\\d*)\")\nmatch := re.FindStringSubmatch(hex.EncodeToString([]byte(href)))\nfmt.Println(match)\n</code></pre>\n\n<p>my test strings that I'm trying to match are</p>\n\n<pre><code>/data/1221a7f47-84c1-445e-a615-ff82d92e2eaa/article/jane;version=1493756861347\n\n/data/1221a7f47-84c1-445e-a615-ff82d92e2eaa/article/john;version=1493756856398\n</code></pre>\n\n<p>Expecting following strings after match</p>\n\n<ol>\n<li>1221a7f47-84c1-445e-a615-ff82d92e2eaa</li>\n<li>article</li>\n<li>jane</li>\n<li>1493756856398</li>\n</ol>\n"}, {"tags": ["go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493760143, "post_id": 43747267, "comment_id": 74537987, "body": "The library you use should point in their documentation how you implement connection pooling."}], "answers": [{"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493800972, "post_id": 43747478, "comment_id": 74551687, "body": "Thanks, @mkopriva (again, haha). I already was afraid this was the answer. Because now I need to figure out how to deal with multiple databases :-P"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1493760562, "last_edit_date": 1493760562, "creation_date": 1493760221, "answer_id": 43747478, "question_id": 43747267, "link": "https://stackoverflow.com/questions/43747267/what-is-good-practice-to-connect-to-multiple-databases-in-go/43747478#43747478", "title": "What is good practice to connect to multiple databases in Go?", "body": "<p>I'm not sure about <code>datastore.Client</code>, but <code>database.DB</code> manages a pool of connections, is safe for concurrent use, and you shouldn't really call <code>db.Open</code> every time you want to execute a query. In fact, the last paragraph from <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow noreferrer\">Open's</a> documentation states that clearly.</p>\n\n<blockquote>\n  <p>The returned DB is safe for concurrent use by multiple goroutines and\n  maintains its own pool of idle connections. Thus, the Open function\n  should be called just once. It is rarely necessary to close a DB.</p>\n</blockquote>\n\n<p><strong>Update</strong>:</p>\n\n<p>If you take a look at the comment in the example code of the <a href=\"https://godoc.org/cloud.google.com/go/datastore#hdr-Basic_Operations\" rel=\"nofollow noreferrer\"><strong>Basic Operations</strong></a> section in the <code>datastore</code>'s documentation, you'll find the recommended use.</p>\n\n<blockquote>\n  <p>Create a datastore client. In a typical application, you would\n  create a single client which is reused for every datastore\n  operation.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 5798, "user_id": 4529152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b7469ad7b95b70315a9775e38f561cd?s=128&d=identicon&r=PG", "display_name": "vith", "link": "https://stackoverflow.com/users/4529152/vith"}, "is_accepted": false, "score": 1, "last_activity_date": 1493760700, "last_edit_date": 1592644375, "creation_date": 1493760700, "answer_id": 43747582, "question_id": 43747267, "link": "https://stackoverflow.com/questions/43747267/what-is-good-practice-to-connect-to-multiple-databases-in-go/43747582#43747582", "title": "What is good practice to connect to multiple databases in Go?", "body": "<p>I don't have any experience with Google Datastore but I expect it to be designed similarly to <code>database/sql</code> package. And in that case it's not terrible to use <code>sql.Open</code> on every request as connections are initialized lazily and it doesn't validate the params. But it's much better to reuse it as it is safe to be used concurrently.</p>\n<blockquote>\n<p>Although it\u2019s idiomatic to Close() the database when you\u2019re finished with it, the sql.DB object is designed to be long-lived. Don\u2019t Open() and Close() databases frequently. Instead, create one sql.DB object for each distinct datastore you need to access, and keep it until the program is done accessing that datastore. Pass it around as needed, or make it available somehow globally, but keep it open. And don\u2019t Open() and Close() from a short-lived function. Instead, pass the sql.DB into that short-lived function as an argument.</p>\n<p>If you don\u2019t treat the sql.DB as a long-lived object, you could experience problems such as poor reuse and sharing of connections, running out of available network resources, or sporadic failures due to a lot of TCP connections remaining in TIME_WAIT status. Such problems are signs that you\u2019re not using database/sql as it was designed.</p>\n</blockquote>\n<p>from: <a href=\"http://go-database-sql.org/accessing.html\" rel=\"nofollow noreferrer\">http://go-database-sql.org/accessing.html</a></p>\n<p>By default it is backed by a connection pool without a limit for connections. So you may starve it with enough concurrent goroutines (not to mention some database systems have pretty heavy connection initialization). However, you can limit the pool size pretty easily: <a href=\"http://go-database-sql.org/connection-pool.html\" rel=\"nofollow noreferrer\">http://go-database-sql.org/connection-pool.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 0, "last_activity_date": 1493761992, "creation_date": 1493761992, "answer_id": 43747854, "question_id": 43747267, "link": "https://stackoverflow.com/questions/43747267/what-is-good-practice-to-connect-to-multiple-databases-in-go/43747854#43747854", "title": "What is good practice to connect to multiple databases in Go?", "body": "<p>This is a preference based answer, but here it is for what it's worth.</p>\n\n<p>Use package <code>github.com/mjibson/goon</code> for all your <code>datastore</code> needs. It wraps up calls like <code>Get</code> and <code>Put</code> really nicely and will Marshal/Unmarshal <code>structs</code> for you. It also runs any key queries through <code>memcache</code> automatically to speed things up.</p>\n\n<p>So back to your actual question. It is appropriate with <code>goon</code> to run one of these two lines upon each request.</p>\n\n<pre><code>g := goon.FromContext(c) // if you have Context\ng := goon.NewGoon(req) // if you have http.Request\n</code></pre>\n"}], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2752, "favorite_count": 0, "accepted_answer_id": 43747478, "answer_count": 3, "score": 4, "last_activity_date": 1493761992, "creation_date": 1493759342, "question_id": 43747267, "link": "https://stackoverflow.com/questions/43747267/what-is-good-practice-to-connect-to-multiple-databases-in-go", "title": "What is good practice to connect to multiple databases in Go?", "body": "<p>I am trying to understand if the following is good or bad practice.</p>\n\n<p>If it turns out that this is good / normal practice, it makes it easier for me to implement multiple database connectors into my project.</p>\n\n<p>Situation: I have created an API server and every time a call is done to the API this piece of code runs:</p>\n\n<pre><code>ctx := context.Background()\n\nclient, err := datastore.NewClient(ctx, \"foobar\")\nif err != nil {\n    log.Fatalf(\"Failed to create client: %v\", err)\n}\n</code></pre>\n\n<p>The service gets many requests per second and I'm not sure if I should run the <code>newClient()</code> function only once on startup, or every time the API is called.</p>\n\n<p>PS:<br>\nThe same would go if another connector would be MySQL. Every time the API gets a request, the following code will run:</p>\n\n<pre><code>db, err = sql.Open(\"mysql\", \"yourusername:yourpassword@/yourdatabase\")\nif err != nil {\n    panic(err.Error())    \n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": true, "score": 3, "last_activity_date": 1495234030, "creation_date": 1495234030, "answer_id": 44079990, "question_id": 43747075, "link": "https://stackoverflow.com/questions/43747075/cobra-commander-how-to-call-a-command-from-another-command/44079990#44079990", "title": "Cobra Commander: How to call a command from another command?", "body": "<p>The \"shared\" switches make as global.</p>\n\n<p>The \"run\" sections of the sub-commands, convert to functions.</p>\n\n<p>To do this you must define the commands manually:</p>\n\n<pre><code>var (\n    cfgDirectory  string\n    cfgFilename  string\n    cfgOutput string\n)\n\nvar rootCmd = &amp;cobra.Command{\n    Use:   \"root\",\n    Short: \"root\",\n    Long:  \"root\",\n    Run: func(cmd *cobra.Command, args []string) {\n        // something\n    },\n}\n\nvar uploadCmd = &amp;cobra.Command{\n    Use:   'upload',\n    Short: 'upload',\n    Long:  `upload`,\n    Run: func(cmd *cobra.Command, args []string) {\n        Upload()\n    },\n}\n\nvar zipCmd = &amp;cobra.Command{\n    Use:   \"zip\",\n    Short: \"zip\",\n    Long:  \"zip\",\n    Run: func(cmd *cobra.Command, args []string) {\n        Zip()\n    },\n}\n\nvar zipupCmd = &amp;cobra.Command{\n    Use:   \"zipup\",\n    Short: \"zipup\",\n    Long:  \"zipup\",\n    Run: func(cmd *cobra.Command, args []string) {\n        Zip()\n        Upload()\n    },\n}\n\nfunc setFlags() {\n    rootCmd.PersistentFlags().StringVar(&amp;cfgDirectory, \"directory\", \"\", \"explanation\")\n    rootCmd.PersistentFlags().StringVar(&amp;cfgFilename, \"filename\", \"\", \"explanation\")\n    rootCmd.PersistentFlags().StringVar(&amp;cfgOutput, \"output\", \"\", \"explanation\")\n}\n\nfunc Upload() {\n    // you know what to do\n}\n\nfunc Zip() {\n    // you know what to do\n}\n...\n\n// Add subcommands\nrootCmd.AddCommand(zipCmd)\nrootCmd.AddCommand(uploadCmd)\nrootCmd.AddCommand(zipupCmd)\n</code></pre>\n\n<p>Hope this helps, this is the best I could do without any example code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11029082, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-35p5UyrhKp4/AAAAAAAAAAI/AAAAAAAAAAA/ZFZBhUWLnMk/photo.jpg?sz=128", "display_name": "Jim Fisk", "link": "https://stackoverflow.com/users/11029082/jim-fisk"}, "is_accepted": false, "score": -1, "last_activity_date": 1604519543, "creation_date": 1604519543, "answer_id": 64686822, "question_id": 43747075, "link": "https://stackoverflow.com/questions/43747075/cobra-commander-how-to-call-a-command-from-another-command/64686822#64686822", "title": "Cobra Commander: How to call a command from another command?", "body": "<p>When you create new commands from the cobra CLI, it usually puts them into separate files. If you want to run a command from a different command file, it would look something like this:</p>\n<pre><code>package cmd\n\nimport &quot;github.com/spf13/cobra&quot;\n\n// DirectoryFlag specifies the directory\nvar DirectoryFlag string\n\n// OutputFlag specifies the output\nvar OutputFlag string\n\n// zipupCmd represents the &quot;zipup&quot; command\nvar zipupCmd = &amp;cobra.Command{\n    Use:   &quot;zipup&quot;,\n    Short: &quot;Zip &amp; Upload&quot;,\n    Long: `Zip &amp; Upload`,\n    Run: func(cmd *cobra.Command, args []string) {\n        anyArgs := &quot;whatever&quot;\n        zipCmd.Run(cmd, []string{anyArgs})\n        uploadCmd.Run(cmd, []string{anyArgs})\n    },\n}\n\nfunc init() {\n    rootCmd.AddCommand(zipupCmd)\n    zipupCmd.Flags().StringVarP(&amp;DirectoryFlag, &quot;directory&quot;, &quot;d&quot;, &quot;&quot;, &quot;set the directory&quot;)\n    zipupCmd.Flags().StringVarP(&amp;OutputFlag, &quot;output&quot;, &quot;o&quot;, &quot;&quot;, &quot;set the output&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 811, "user_id": 2644113, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/23949b1ad01e3b7237a23382706a4305?s=128&d=identicon&r=PG", "display_name": "user2644113", "link": "https://stackoverflow.com/users/2644113/user2644113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1862, "favorite_count": 0, "accepted_answer_id": 44079990, "answer_count": 2, "score": 0, "last_activity_date": 1604519543, "creation_date": 1493758545, "question_id": 43747075, "link": "https://stackoverflow.com/questions/43747075/cobra-commander-how-to-call-a-command-from-another-command", "title": "Cobra Commander: How to call a command from another command?", "body": "<p>In cobra I've create a command of commands:</p>\n\n<pre><code>myapp zip -directory \"xzy\" -output=\"zipname\"\nmyapp upload -filename=\"abc\"\n</code></pre>\n\n<p>I want to make a zipAndUpload command and reuse the existing commands, i.e.,</p>\n\n<pre><code>myapp zipup -directory \"xzy\" -outout=\"zipname\"\n</code></pre>\n\n<p>Here the zipup would first call the \"zip\" command and then use the output name from the \"zip\" command as the \"filename\" flag for the \"upload\" command.</p>\n\n<p>How can I execute this without a lot of code duplication?</p>\n"}, {"tags": ["go", "hash", "redis"], "answers": [{"comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1493758161, "post_id": 43746955, "comment_id": 74537015, "body": "Oh, yes, I didn&#39;t really notice that honestly. Thank you."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 3, "last_activity_date": 1493758024, "creation_date": 1493758024, "answer_id": 43746955, "question_id": 43746853, "link": "https://stackoverflow.com/questions/43746853/go-redis-hmset-with-string-fields-gives-wrongtype-operation/43746955#43746955", "title": "Go-Redis HMSet with string fields gives WRONGTYPE Operation", "body": "<p>You are accessing the same key <code>\"i\"</code> twice - once as a string when calling SET, and then as a hash when calling HMSET. </p>\n\n<p>The error you are getting is just redis denying HMSET on a string, which is an invalid operation. </p>\n\n<p>BTW the other way around will work - calling SET on any type in redis will just write a string instead of that value, so be careful.</p>\n"}], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3861, "favorite_count": 0, "accepted_answer_id": 43746955, "answer_count": 1, "score": 2, "last_activity_date": 1493758024, "creation_date": 1493757609, "question_id": 43746853, "link": "https://stackoverflow.com/questions/43746853/go-redis-hmset-with-string-fields-gives-wrongtype-operation", "title": "Go-Redis HMSet with string fields gives WRONGTYPE Operation", "body": "<p>I'm trying to use <a href=\"https://redis.io/commands/hmset\" rel=\"nofollow noreferrer\">HMSET</a> to set a new <code>hash</code> containing two string fields, <code>id</code> and <code>content</code>.</p>\n\n<p>I'm able to make this via <code>redis-cli</code> pretty easily using <code>SET i 0</code> to initialize a counter for ids, then creating a new hash using <code>HMSET test id hey content herro</code> and getting both of these fields with <code>HMGET test id content</code> resulting in <code>1) hey 2) herro</code>.</p>\n\n<p>Unfortunately I'm not able to achieve such result with <a href=\"https://godoc.org/github.com/go-redis/redis\" rel=\"nofollow noreferrer\">Go-Redis</a> and in particular with <a href=\"https://godoc.org/github.com/go-redis/redis#Client.HMSet\" rel=\"nofollow noreferrer\">HMSet</a>.</p>\n\n<p>So far I tried</p>\n\n<pre><code>var uid = \"0\"\nerr = c.Get(\"i\").Err()\nif(err != nil) {\n    //If the counter is not set, set it to 0\n    err := c.Set(\"i\", \"0\", 0).Err()\n    if(err != nil){\n        panic(err)\n    }\n} else {\n    //Else, increment it\n    counter, err := c.Incr(\"i\").Result()\n    //Cast it to string\n    uid = strconv.FormatInt(index, 10)\n    if(err != nil){\n        panic(err)\n    }\n    //Set new counter\n    err = c.Set(\"i\", counter, 0).Err()\n    if( err!= nil ){\n        panic(err)\n    }\n}\n\n//Init a map[string]interface{}\nvar m = make(map[string]interface{})\nm[\"id\"] = uid\nm[\"content\"] = \"herro\"\n\nhash, err := c.HMSet(\"i\", m).Result()\nif(err != nil){\n    panic(err)\n}\n\nfmt.Println(hash)\n</code></pre>\n\n<p>Everything works fine but <code>c.HMSet(\"i\", m).Result()</code>. I get:</p>\n\n<blockquote>\n  <p>WRONGTYPE Operation against a key holding the wrong kind of value</p>\n</blockquote>\n\n<p>And I cannot really get why since I managed to make it work on the very same way in <code>redis-cli</code>.</p>\n\n<p><code>HMSet</code> is defined as <code>func (c *Client) HMSet(key string, fields map[string]interface{}) *StatusCmd</code>.</p>\n\n<p>I wasn't able to find any example online using Go-Redis illustrating this use case.</p>\n\n<p><strong>What Am I doing Wrong?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1493752697, "post_id": 43745595, "comment_id": 74534178, "body": "You don&#39;t have anything receiving from <code>c</code>."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493753211, "post_id": 43745595, "comment_id": 74534400, "body": "To elaborate on @JimB &#39;s comment, all your go-routines are blocking on <code>c &lt;- item.Title </code> because nothing is reading from the channel, so they never complete and the defer is never called, so main blocks waiting for the <code>WaitGroup</code>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493756934, "post_id": 43745595, "comment_id": 74536420, "body": "@MarcelCliff and after you added it - <code>c</code> is never closed so <code>for title := range c</code> is blocked forever."}, {"owner": {"reputation": 1009, "user_id": 2837489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9332e46ce84393e32ab32f7612f0354?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel Bochtler", "link": "https://stackoverflow.com/users/2837489/marcel-bochtler"}, "edited": false, "score": 0, "creation_date": 1493757904, "post_id": 43745595, "comment_id": 74536890, "body": "I&#39;ve figured it out now. Thank you. Reading the channel before <code>wg.Wait()</code> and closing this channel after the loop writing to it solves the problem.  Please post the solution as answer and I&#39;ll accept it."}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1493758556, "post_id": 43745595, "comment_id": 74537225, "body": "@MarcelCliff - you are allowed to post your own solution."}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 2837489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9332e46ce84393e32ab32f7612f0354?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel Bochtler", "link": "https://stackoverflow.com/users/2837489/marcel-bochtler"}, "is_accepted": true, "score": 1, "last_activity_date": 1493794153, "creation_date": 1493794153, "answer_id": 43753024, "question_id": 43745595, "link": "https://stackoverflow.com/questions/43745595/defer-never-called-when-writing-to-channel/43753024#43753024", "title": "Defer never called when writing to channel", "body": "<p>The problem is that I was only writing to the channel. Never reading from it.\nWithout doing this the channel would be useless.</p>\n\n<p>The solution to this is:</p>\n\n<p>Reading from the channel after the loop which starts the goroutines:</p>\n\n<pre><code>for title := range c {\n    fmt.Println(title)\n}\n</code></pre>\n\n<p>This then causes an endless loop if the channel is never closed.\nSo I just close the channel after writing to it:</p>\n\n<pre><code>close(c)\n</code></pre>\n\n<p>Here is the whole code:</p>\n\n<pre><code>func main() {\n\n    urls := []string{\"http://rss.cnn.com/rss/edition.rss\", \"http://rss.time.com/web/time/rss/top/index.xml\"}\n\n    var c = make(chan []string)\n    var wg sync.WaitGroup\n\n    for _, url := range urls {\n        wg.Add(1)\n        go receiveRss(url, &amp;wg, c)\n    }\n    for title := range c {\n        fmt.Println(title)\n    }\n    wg.Wait()\n    fmt.Println(\"==============DONE=================\")\n}\n\nfunc receiveRss(url string, wg *sync.WaitGroup, c chan []string) {\n    defer wg.Done()\n    feed, err := rss.Fetch(url)\n    if err != nil {\n        fmt.Println(\"Failed to retrieve RSS feed\", err)\n    }\n\n    items := feed.Items\n    var titles []string\n    for _, item := range items {\n        titles = append(titles, item.Title)\n    }\n    c &lt;- titles\n    close(c)\n}\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 2837489, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c9332e46ce84393e32ab32f7612f0354?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel Bochtler", "link": "https://stackoverflow.com/users/2837489/marcel-bochtler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 0, "accepted_answer_id": 43753024, "answer_count": 1, "score": 1, "last_activity_date": 1493836716, "creation_date": 1493752615, "last_edit_date": 1493836716, "question_id": 43745595, "link": "https://stackoverflow.com/questions/43745595/defer-never-called-when-writing-to-channel", "title": "Defer never called when writing to channel", "body": "<p>I'm trying to write to a channel as last action in a goroutine function.</p>\n\n<p>Unfortunately this is not working. And the waitGroup is never done.</p>\n\n<pre><code>import (\n    \"sync\"\n    \"github.com/SlyMarbo/rss\"\n    \"fmt\"\n)\n\nfunc main() {\n    urls := []string{\"http://rss.cnn.com/rss/edition.rss\", \"http://rss.time.com/web/time/rss/top/index.xml\"}\n\n    var c = make(chan string)\n    var wg sync.WaitGroup\n    for _, url := range urls {\n        wg.Add(1)\n        go receiveRss(url, &amp;wg, c)\n    }\n    wg.Wait()\n    fmt.Println(\"==============DONE=================\")\n}\n\nfunc receiveRss(url string, wg *sync.WaitGroup, c chan string) {\n    defer wg.Done()\n    feed, err := rss.Fetch(url)\n    if err != nil {\n        fmt.Println(\"Failed to retrieve RSS feed\", err)\n    }\n\n    items := feed.Items\n    for _, item := range items {\n        c &lt;- item.Title\n    }\n}\n</code></pre>\n\n<p>When replacing <code>c &lt;- item.Title</code> with <code>fmt.Println(item.Title)</code> the deferred function is called and DONE is printed.</p>\n"}, {"tags": ["pointers", "go", "reflection", "struct", "null"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493748193, "post_id": 43744238, "comment_id": 74531671, "body": "I&#39;ll ask the obvious question here... why would you want to do this? I myself have never seen much of a reason to use pointers to strings, nor have I seen them used in the standard libraries."}, {"owner": {"reputation": 156, "user_id": 2330648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZugEZ.jpg?s=128&g=1", "display_name": "Ryan Smith", "link": "https://stackoverflow.com/users/2330648/ryan-smith"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1493748429, "post_id": 43744238, "comment_id": 74531795, "body": "Fair question. When I expose a REST API, its my way of knowing if the client provided a field or not. If they were not pointers, the empty value of a string is <code>&quot;&quot;</code>. Then I&#39;d have to ask.. did the client provide <code>&quot;&quot;</code> or did they provide nothing? Plus, I&#39;m adding unique tags to the struct fields like.. <code>Validate</code> and <code>Transform</code>. So, I&#39;m using the reflect package there to parse those."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1493748366, "creation_date": 1493748366, "answer_id": 43744458, "question_id": 43744238, "link": "https://stackoverflow.com/questions/43744238/golang-set-nil-string-pointer-value-in-struct-using-reflect/43744458#43744458", "title": "Golang set nil string pointer value in struct using reflect", "body": "<p>You first need a pointer to a <code>Person{}</code>, because you need to set a value to the <code>LastName</code> Field.</p>\n\n<pre><code>p := &amp;Person{}\n</code></pre>\n\n<p>Then you can set a valid pointer value to the <code>LastName</code> field, which will allow you to set the string value:</p>\n\n<pre><code>rp.Field(1).Set(reflect.New(rp.Field(1).Type().Elem()))\nrp.Field(1).Elem().SetString(\"Jones\")\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/f5MjpkDI2H\" rel=\"noreferrer\">https://play.golang.org/p/f5MjpkDI2H</a></p>\n"}], "owner": {"reputation": 156, "user_id": 2330648, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ZugEZ.jpg?s=128&g=1", "display_name": "Ryan Smith", "link": "https://stackoverflow.com/users/2330648/ryan-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3023, "favorite_count": 0, "accepted_answer_id": 43744458, "answer_count": 1, "score": 2, "last_activity_date": 1493748366, "creation_date": 1493747513, "question_id": 43744238, "link": "https://stackoverflow.com/questions/43744238/golang-set-nil-string-pointer-value-in-struct-using-reflect", "title": "Golang set nil string pointer value in struct using reflect", "body": "<p>Using Go's reflect package, is there a way to set a pointer in a struct if the pointer is nil? Looking at the reflect package, if <code>reflect.Value.CanSet()</code> is <code>false</code> then any <code>Set()</code> calls will yield a panic. Is there another way around this, only using the reflect package, not depending on any direct reference to the struct? For example, how can I set the empty last name as \"Johnson\" in the code below?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Person struct {\n    FirstName *string\n    LastName  *string\n}\n\nfunc main() {\n    p := Person{}\n    firstName := \"Ryan\"\n    p.FirstName = &amp;firstName\n\n    rp := reflect.ValueOf(p)\n    fmt.Println(\"rp:\", rp)\n\n    for i := 0; i &lt; rp.NumField(); i++ {\n        fmt.Printf(\"%s: Pointer: %d CanSet: %t\\n\", rp.Type().Field(i).Name, rp.Field(i).Pointer(), rp.Field(i).Elem().CanSet())\n    }\n\n    rp.Field(0).Elem().SetString(\"Brian\")\n    fmt.Println(*p.FirstName)\n\n    // Yields nil pointer error\n    // rp.Field(1).Elem().SetString(\"Johnson\")\n    // fmt.Println(*p.LastName)\n\n    fmt.Println(rp.Field(1).Type()) \n    fmt.Println(rp.Field(1).CanSet())\n    // fmt.Println(rp.Field(1).Elem().Type()) // nil pointer here also\n    fmt.Println(rp.Field(1).Elem().CanSet())\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VeKr5G3KvK\" rel=\"nofollow noreferrer\">See in Golang Playground</a></p>\n"}, {"tags": ["docker", "go", "circleci", "bazel"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 559073, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fad735b6124f99fd41f50cb588a38c46?s=128&d=identicon&r=PG", "display_name": "macrael", "link": "https://stackoverflow.com/users/559073/macrael"}, "edited": false, "score": 0, "creation_date": 1493758577, "post_id": 43746352, "comment_id": 74537235, "body": "I&#39;m using the latest released version, installed with apt-get. 0.4.5 Which looks like it doesn&#39;t have the fix you posted. How frequent are bazel releases usually?"}, {"owner": {"reputation": 946, "user_id": 2263152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/905783fea28698173446329b709f5969?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Silverman", "link": "https://stackoverflow.com/users/2263152/brian-silverman"}, "reply_to_user": {"reputation": 181, "user_id": 559073, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fad735b6124f99fd41f50cb588a38c46?s=128&d=identicon&r=PG", "display_name": "macrael", "link": "https://stackoverflow.com/users/559073/macrael"}, "edited": false, "score": 0, "creation_date": 1493845513, "post_id": 43746352, "comment_id": 74581416, "body": "They&#39;re typically every month or two, which means the next one is due about now. <a href=\"https://github.com/bazelbuild/bazel/issues/2692\" rel=\"nofollow noreferrer\">#2692</a> is the release bug for 0.5.0, and it looks like there&#39;s active progress happening on it right now."}], "tags": [], "owner": {"reputation": 946, "user_id": 2263152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/905783fea28698173446329b709f5969?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Silverman", "link": "https://stackoverflow.com/users/2263152/brian-silverman"}, "is_accepted": true, "score": 1, "last_activity_date": 1493755591, "creation_date": 1493755591, "answer_id": 43746352, "question_id": 43744153, "link": "https://stackoverflow.com/questions/43744153/is-there-a-way-to-get-bazel-to-use-sandbox-directories-when-sandboxing-is-not-su/43746352#43746352", "title": "Is there a way to get bazel to use sandbox directories when sandboxing is not supported?", "body": "<p>What bazel version are you using which crashes when it tries to use sandboxing? I suspect <a href=\"https://github.com/bazelbuild/bazel/commit/c2d773ef4c0916a44fd7936f7bbc22ec55102915\" rel=\"nofollow noreferrer\">c2d773ef4c0916a44fd7936f7bbc22ec55102915</a> will resolve that problem because it makes the detection of whether the sandbox works much more robust, which seems like it would then do what you're looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 559073, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fad735b6124f99fd41f50cb588a38c46?s=128&d=identicon&r=PG", "display_name": "macrael", "link": "https://stackoverflow.com/users/559073/macrael"}, "edited": false, "score": 0, "creation_date": 1493853005, "post_id": 43755793, "comment_id": 74584160, "body": "--genrule_strategy &amp; --spawn_strategy should cover everything. But my question is about avoiding calling them."}], "tags": [], "owner": {"reputation": 73, "user_id": 2514169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/223139cd460f00528796f94dc2415633?s=128&d=identicon&r=PG", "display_name": "user2514169", "link": "https://stackoverflow.com/users/2514169/user2514169"}, "is_accepted": false, "score": 1, "last_activity_date": 1493802773, "creation_date": 1493802773, "answer_id": 43755793, "question_id": 43744153, "link": "https://stackoverflow.com/questions/43744153/is-there-a-way-to-get-bazel-to-use-sandbox-directories-when-sandboxing-is-not-su/43755793#43755793", "title": "Is there a way to get bazel to use sandbox directories when sandboxing is not supported?", "body": "<p>Two possible options:</p>\n\n<p>1) To disable sandboxing, <code>--genrule_strategy=standalone</code> only applies to <code>genrule</code>s. You also need to disable it for other rules, i.e. add <code>--spawn_strategy=standalone</code>. You may also need to disable it for specific rule types, e.g. <code>--strategy GoCompile=standalone</code>.</p>\n\n<p>2) To use sandboxing, you can run Bazel inside a privileged container, i.e. start its container with the <code>--privileged</code> flag. This might be a configuration option in your CI.</p>\n"}], "owner": {"reputation": 181, "user_id": 559073, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fad735b6124f99fd41f50cb588a38c46?s=128&d=identicon&r=PG", "display_name": "macrael", "link": "https://stackoverflow.com/users/559073/macrael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 43746352, "answer_count": 2, "score": 0, "last_activity_date": 1493802773, "creation_date": 1493747190, "question_id": 43744153, "link": "https://stackoverflow.com/questions/43744153/is-there-a-way-to-get-bazel-to-use-sandbox-directories-when-sandboxing-is-not-su", "title": "Is there a way to get bazel to use sandbox directories when sandboxing is not supported?", "body": "<p>I'm running bazel inside of a docker container. Locally, when I run bazel with no flags I get the following warning: </p>\n\n<blockquote>\n  <p>WARNING: Sandboxed execution is not supported on your system and thus hermeticity of actions cannot be guaranteed. See <a href=\"http://bazel.build/docs/bazel-user-manual.html#sandboxing\" rel=\"nofollow noreferrer\">http://bazel.build/docs/bazel-user-manual.html#sandboxing</a> for more information. You can turn off this warning via --ignore_unsupported_sandboxing.</p>\n</blockquote>\n\n<p>And while I lose some guarantees about hermeticity, Bazel still creates all the sandboxing directories before running any of my genrules. </p>\n\n<p>However, in CI, I'm not seeing that warning and instead just get failures when sandboxing is attempted. So I passed <code>--genrule_strategy=standalone</code> to stop the crash, but now my genrules are executing right in the workspace, which I definitely don't want. </p>\n\n<p>Is there a way for me to get the behavior I'm seeing locally, where explicit sandboxing calls are being disabled because they would fail but the tmp directory creation with srcs/deps/data being copied over correctly still happens?</p>\n\n<p>Either a flag I could pass to bazel to trigger that behavior, or something I could do to my system to convince bazel that sandboxing is not supported there?</p>\n"}, {"tags": ["go", "google-app-engine", "jwt-go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493742970, "post_id": 43743025, "comment_id": 74528923, "body": "If you&#39;re using the standard environment, the Go version there is only 1.6."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1493743190, "post_id": 43743025, "comment_id": 74529036, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40552001/running-go-app-engine-apps-locally/40561187#40561187\">Running Go App Engine apps locally.</a>"}, {"owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1495345034, "post_id": 43743025, "comment_id": 75208520, "body": "Having similar issues go version go version go1.8.1 darwin/amd64 and deploying to App Engine too"}, {"owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "reply_to_user": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "edited": false, "score": 0, "creation_date": 1495453860, "post_id": 43743025, "comment_id": 75243430, "body": "@iswak, as JimB says go 1.7 and onwards are not supported by appengine, and only god knows when they are going to rollout 1.8 compatibility :/"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "is_accepted": true, "score": 0, "last_activity_date": 1495453933, "creation_date": 1495453933, "answer_id": 44112167, "question_id": 43743025, "link": "https://stackoverflow.com/questions/43743025/http-request-has-undefined-fields-when-deploying-to-appengine/44112167#44112167", "title": "http.Request has undefined fields when deploying to appengine", "body": "<p>Appengine only supports Go 1.6. A bit baffling since it renders my app useless without a major compat overhaul, but that's the current state of the platform</p>\n"}], "owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 44112167, "answer_count": 1, "score": 0, "last_activity_date": 1588099236, "creation_date": 1493742828, "last_edit_date": 1588099236, "question_id": 43743025, "link": "https://stackoverflow.com/questions/43743025/http-request-has-undefined-fields-when-deploying-to-appengine", "title": "http.Request has undefined fields when deploying to appengine", "body": "<p>I'm working on a web app and I depend on the following code for authentication (I'm using github.com/dgrijalva/jwt-go package):</p>\n\n<pre><code>func ValidateProtectedPage(protectedPage http.HandlerFunc) http.HandlerFunc {\nreturn http.HandlerFunc(func(res http.ResponseWriter, req *http.Request) {\n    // If no Auth cookie is set then return a 404 not found\n    cookie, err := req.Cookie(\"Auth\")\n    if err != nil {\n        Forbidden(res)\n        return\n    }\n\n    // Return a Token using the cookie\n    token, err := jwt.ParseWithClaims(cookie.Value, &amp;Claims{}, func(token *jwt.Token) (interface{}, error) {\n        // Make sure token's signature wasn't changed\n        if _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {\n            return nil, fmt.Errorf(\"Unexpected siging method\")\n        }\n        return []byte(util.Secret), nil\n    })\n\n    if err != nil {\n        Forbidden(res)\n        return\n    }\n\n    // Grab the tokens claims and pass it into the original request\n    if claims, ok := token.Claims.(*Claims); ok &amp;&amp; token.Valid {\n        ctx := context.WithValue(req.Context(), \"Auth\", *claims)\n        protectedPage(res, req.WithContext(ctx))\n    } else {\n        Forbidden(res)\n    }\n})}\n</code></pre>\n\n<p>The issue is, that I'm trying to deploy my app to appengine, and I get the following errors:</p>\n\n<pre><code>planilla-go/controllers/auth.go:45: req.Context undefined (type *http.Request has no field or method Context)\nplanilla-go/controllers/auth.go:46: req.WithContext undefined (type *http.Request has no field or method WithContext)\n</code></pre>\n\n<p>From what I read this is due to incompatibilities between appengine's requests and those from go's library, but I couldn't find a workaround yet</p>\n\n<p>Is there a way to wrap or convert the http.Request to use appengine's instead?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493742477, "post_id": 43742827, "comment_id": 74528636, "body": "You say you want <code>am AND bo</code>, but you seem to be describing <code>am OR bo</code>. Which do you really want? And what problem are you having?"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493743380, "post_id": 43742827, "comment_id": 74529136, "body": "i would like to have all object that have am &amp; bo in their categories_data thanks"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493743692, "post_id": 43742827, "comment_id": 74529290, "body": "Is <code>categories_data</code> an array then?"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493743773, "post_id": 43742827, "comment_id": 74529341, "body": "yes it is it&#39;s an array"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "closed_date": 1493745157, "answer_count": 0, "score": 0, "last_activity_date": 1493742420, "creation_date": 1493742114, "last_edit_date": 1493742420, "question_id": 43742827, "link": "https://stackoverflow.com/questions/43742827/mgo-golang-make-a-query-with-and", "closed_reason": "Duplicate", "title": "mgo golang make a query with $and", "body": "<p>Here is my code  :</p>\n\n<pre><code>var cat string\nvar cat2 string\ncat = \"am\"\ncat2 = \"bo\"\nvar myarr = []string{cat,cat2}\nerr5 := c.Find(bson.M{\"categories_data\" : bson.M{\"$in\":myarr} }).All(&amp;results)\n</code></pre>\n\n<p>So I would like to find all data that have am AND bo in the categories_data field wich is an array</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1493738484, "post_id": 43741286, "comment_id": 74526210, "body": "To have that level of control you&#39;ll probably need to define your own type based on <code>time.Time</code> and implement your own version of <code>MarshalJSON</code> for that type."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493742679, "post_id": 43741286, "comment_id": 74528758, "body": "Why is this necessary? Presumably a receiver expects 3 decimal points of precision? Could you fudge a little, and just make sure you never have a zero in that spot by adding <code>0.001</code> seconds?  That would hurt accuracy a bit (whether that matters depends on your application), but might make the rest of your code easier."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493743516, "post_id": 43741286, "comment_id": 74529196, "body": "Well, adding 0.001 seconds still won&#39;t ensure you never have .000, since it causes X.999 to roll up to (X+1).000."}], "answers": [{"comments": [{"owner": {"reputation": 1797, "user_id": 633626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VacBs.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/633626/george"}, "edited": false, "score": 0, "creation_date": 1559608791, "post_id": 43742578, "comment_id": 99466182, "body": "&quot;only including sub-second precision if present&quot;: so you can use <code>mytime.Truncate(1 * time.Second)</code> to drop anything sub-second and then you have a time that will serialise out without millis, micros, nanos, etc."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1797, "user_id": 633626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VacBs.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/633626/george"}, "edited": false, "score": 0, "creation_date": 1559833593, "post_id": 43742578, "comment_id": 99551169, "body": "Yes, though you could just as easily do that by using a format string without the subsecond precision, like <code>2006-01-02T15:04:05Z07:00</code>."}, {"owner": {"reputation": 1797, "user_id": 633626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VacBs.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/633626/george"}, "edited": false, "score": 0, "creation_date": 1559878895, "post_id": 43742578, "comment_id": 99564779, "body": "yep that&#39;s a good solution if you&#39;re <code>fmt.Print()</code>ing or <code>log.Printf()</code>ing it, but in my case I was serialising out to JSON, so had to <code>mytime.Truncate()</code> before the serialisation. It&#39;s probably better to use a specific format string if that&#39;s an option vs permanently dropping precision off the <code>time.Date</code> struct."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1797, "user_id": 633626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VacBs.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/633626/george"}, "edited": false, "score": 0, "creation_date": 1560796078, "post_id": 43742578, "comment_id": 99844901, "body": "Could also implement a JSON marshaller with your specified format.  Ex: <a href=\"https://goplay.space/#3SQ5zR5B8x0\" rel=\"nofollow noreferrer\">goplay.space/#3SQ5zR5B8x0</a>"}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1493742045, "last_edit_date": 1493742045, "creation_date": 1493741363, "answer_id": 43742578, "question_id": 43741286, "link": "https://stackoverflow.com/questions/43741286/prevent-json-marshal-time-time-removing-trailing-zeros/43742578#43742578", "title": "prevent json.Marshal time.Time removing trailing zeros", "body": "<p>time.Time always marshals to RFC 3339, only including sub-second precision if present: <a href=\"https://golang.org/pkg/time/#Time.MarshalJSON\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Time.MarshalJSON</a></p>\n\n<p>You can write your own custom version using a named time.Time type, or you can define a custom marshal function for your structure, or you can make your structure hold a string in that place instead.  In any case, if you want to use the same format, but including trailing zeros, you need to use a modified version of the RFC3339Nano constant.  </p>\n\n<p>Its value is: <code>\"2006-01-02T15:04:05.999999999Z07:00\"</code>.</p>\n\n<p>The 9's at the end mean \"include until the rightmost non-zero value, omit after that\".  If you change those 9's to 0's, it will always include them.  For example, if you always want millisecond precision (and nothing after that, regardless of whether it's non-zero or not), you would use:</p>\n\n<p><code>\"2006-01-02T15:04:05.000Z07:00\"</code></p>\n\n<p>If you feed that to Format() on your time.Time value, you'll get out the string you want, and can thus include it in the JSON.</p>\n\n<p>Functioning example: <a href=\"https://play.golang.org/p/oqwnma6odw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oqwnma6odw</a></p>\n"}], "owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 43742578, "answer_count": 1, "score": 2, "last_activity_date": 1493742572, "creation_date": 1493737461, "last_edit_date": 1493742572, "question_id": 43741286, "link": "https://stackoverflow.com/questions/43741286/prevent-json-marshal-time-time-removing-trailing-zeros", "title": "prevent json.Marshal time.Time removing trailing zeros", "body": "<p>I have code similar to the following </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"encoding/json\"\n)\n\ntype Message struct {\n    Time time.Time `json:\"timestamp,omitempty\"`\n}\n\nfunc main() {\n    t, _ := time.Parse(\"2006-01-02T15:04:05.999Z07:00\", \"2017-05-01T15:04:05.630Z\")\n    msg := Message{\n        Time: t,\n    }\n    bs, _ := json.Marshal(msg)\n    fmt.Println(string(bs[:]))\n}\n</code></pre>\n\n<p>This prints</p>\n\n<pre><code>{\"timestamp\":\"2017-05-01T15:04:05.63Z\"}\n</code></pre>\n\n<p>How can I make json marshalling keep the trailing 0?  I.e., to print this?</p>\n\n<pre><code>{\"timestamp\":\"2017-05-01T15:04:05.630Z\"}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>Here's the playground <a href=\"https://play.golang.org/p/9p3kWeiwu2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9p3kWeiwu2</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493737156, "post_id": 43741109, "comment_id": 74525203, "body": "Yes, you can start as many goroutines as you want within the limits of memory. What exactly are you asking?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493747132, "post_id": 43741109, "comment_id": 74531066, "body": "It&#39;s hard to tell from the code, since you&#39;ve cut out some rather important parts (like where various variables are declared, and what they are initialized to), but I&#39;d wager you&#39;re running into an issue with channel deadlocking, not goroutines themselves.  How you&#39;re managing the <code>jobs</code> channel and sending to the <code>results</code> channel and reading from it is extremely suspect and doesn&#39;t seem like it would be doing anything actually useful.  I&#39;d look at what you&#39;re actually trying to do, and maybe add logging to figure out where it&#39;s hanging."}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 1, "last_activity_date": 1493742985, "creation_date": 1493742985, "answer_id": 43743070, "question_id": 43741109, "link": "https://stackoverflow.com/questions/43741109/can-a-go-program-start-8k-goroutines-simultaneously/43743070#43743070", "title": "Can a Go program start 8k+ Goroutines simultaneously?", "body": "<p>The amount of available goroutines to spawn depends on your RAM, live memory of your computer. So yes, you can start 8k+, but not if your computer can't handle it.</p>\n"}], "owner": {"reputation": 1617, "user_id": 1478168, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/2Fok1.jpg?s=128&g=1", "display_name": "thinkerou", "link": "https://stackoverflow.com/users/1478168/thinkerou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "closed_date": 1493750807, "answer_count": 1, "score": -2, "last_activity_date": 1493742985, "creation_date": 1493736976, "last_edit_date": 1493742766, "question_id": 43741109, "link": "https://stackoverflow.com/questions/43741109/can-a-go-program-start-8k-goroutines-simultaneously", "closed_reason": "Not suitable for this site", "title": "Can a Go program start 8k+ Goroutines simultaneously?", "body": "<p>I need to start multiple goroutines for sending http requests. The following is my code:</p>\n\n<pre><code>func InteractWithCheck(clusterId int, tableName string, key string, jobs &lt;-chan int, results chan&lt;- objRes) error {\n    // the host only test\n    host := \"http://xxx.yyy.com/a/b?method=check&amp;\"\n    for _ = range jobs {\n        url := fmt.Sprintf(\"%scluster=%d&amp;table=%s&amp;key=%s\", host, clusterId, tableName, key)\n        for intRetry := 0; intRetry &lt; 3; intRetry++ {\n            resp, err := http.Get(url)\n            if err != nil {\n                continue\n            }\n            if resp.StatusCode &gt;= 500 {\n                continue\n            }\n            defer resp.Body.Close()\n            body, err := ioutil.ReadAll(resp.Body)\n            if err != nil {\n                return err\n            }\n            // ...\n            return nil\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p><code>DataCheck</code> will call <code>InteractWithCheck</code> with <code>go</code>, the following code:</p>\n\n<pre><code>func DataCheck(clusterId int, tableName string, keyList []string) error {\n    // ...\n\n    for _, sliceKey := range keyList {\n        // when len(keyList) &gt; 8000, it will be hang\n        go InteractWithCheck(clusterId, tableName, sliceKey, jobs, results)\n    }\n\n    for j := 0; j &lt; num; j++ {\n        jobs &lt;- j\n    }\n    close(jobs)\n\n    for k := 0; k &lt; num; k++ {\n        select {\n        case res := &lt;-results:\n            // check result\n            // ...\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>When <code>len(keylist) &gt;= 8000</code>, the program will be hang, so I should optimize it?</p>\n"}, {"tags": ["go", "multiple-value"], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 1, "last_activity_date": 1493733456, "creation_date": 1493733456, "answer_id": 43739798, "question_id": 43739732, "link": "https://stackoverflow.com/questions/43739732/whats-the-difference-between-these-two-variants/43739798#43739798", "title": "What&#39;s the difference between these two variants?", "body": "<p><code>fmt.Println</code> accepts any number of arguments, so is ok accepting the results of <code>half</code>.</p>\n\n<p>In the first one, you need to provide places for both variables. Either:</p>\n\n<p><code>i,b := half(2)</code></p>\n\n<p>or </p>\n\n<p><code>i, _ := half(2)</code></p>\n\n<p>if you don't need the second return.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1493733850, "last_edit_date": 1495542360, "creation_date": 1493733506, "answer_id": 43739816, "question_id": 43739732, "link": "https://stackoverflow.com/questions/43739732/whats-the-difference-between-these-two-variants/43739816#43739816", "title": "What&#39;s the difference between these two variants?", "body": "<p>If a function has 2 return values, you have to \"expect\" both of them or none at all. More on this: <a href=\"https://stackoverflow.com/questions/28487036/return-map-like-ok-in-golang-on-normal-functions/28487270#28487270\">Return map like &#39;ok&#39; in Golang on normal functions</a></p>\n\n<p>Your <code>half()</code> function has 2 return values, so when using a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> to store the returned values in variables, you have to provide 2 variables:</p>\n\n<pre><code>O, even := half(I)\nfmt.Println(\"Returned:\", O, even)\n</code></pre>\n\n<p>In the second case, you're not storing the returned values, you are passing them to <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\"><code>fmt.Println()</code></a> which has the signature:</p>\n\n<pre><code>func Println(a ...interface{}) (n int, err error)\n</code></pre>\n\n<p><code>fmt.Println()</code> has a variadic parameter, so you can pass any number of arguments to it. What happens here is that all the multiple return values of <code>half()</code> are passed as the value of the variadic parameter of <code>Println()</code>. This is allowed and detailed in <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Spec: Calls:</a></p>\n\n<blockquote>\n  <p>As a special case, if the return values of a function or method <code>g</code> are equal in number and individually assignable to the parameters of another function or method <code>f</code>, then the call <code>f(g(parameters_of_g))</code> will invoke <code>f</code> after binding the return values of <code>g</code> to the parameters of <code>f</code> in order. The call of <code>f</code> must contain no parameters other than the call of <code>g</code>, and <code>g</code> must have at least one return value. If <code>f</code> has a final <code>...</code> parameter, it is assigned the return values of <code>g</code> that remain after assignment of regular parameters.</p>\n</blockquote>\n\n<p>Note that when doing so, you are not allowed to pass / provide extra parameters, so for example the following is also a <strong>compile-time error</strong>:</p>\n\n<pre><code>fmt.Println(\"Returned:\", half(10))\n// Error: multiple-value half() in single-value context\n</code></pre>\n\n<p>Check out these similar questions: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/28227095/go-multiple-value-in-single-value-context/28233172#28233172\">Go: multiple value in single-value context</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/35548073/avoid-nesting-from-conjunction-with-function-that-returns-2-values-in-go/35548183#35548183\">Avoid nesting from conjunction with function that returns 2 values in go?</a></p>\n"}], "owner": {"reputation": 41, "user_id": 7644599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ded8a21232657208d736f167d02662?s=128&d=identicon&r=PG&f=1", "display_name": "A. Solomatin", "link": "https://stackoverflow.com/users/7644599/a-solomatin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1493734511, "creation_date": 1493733222, "last_edit_date": 1493734511, "question_id": 43739732, "link": "https://stackoverflow.com/questions/43739732/whats-the-difference-between-these-two-variants", "title": "What&#39;s the difference between these two variants?", "body": "<p>I tried to make my own code for learning how to return multiple values in main function:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Enter a integer:\")\n    var I int\n    fmt.Scanf(\"%d\", &amp;I)\n    fmt.Println(\"Accepted:\", I)\n\n    O := half(I)\n    fmt.Println(\"Returned:\", O)\n}\n\nfunc half(N int) (int, bool) {\n    var NA int\n    NA = N / 2\n    if NA%2 == 0 {\n        fmt.Println(\"even\")\n        return NA, true\n    } else {\n        fmt.Println(\"odd\")\n        return NA, false\n    }\n}\n</code></pre>\n\n<p>And given error: <code>half.go|11| multiple-value half() in single-value context</code>.\nHowever another variant are working:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc half(number int) (int, bool) {\n    if x := int(number % 2); x == 0 {\n        return x, true\n    } else {\n        return x, false\n    }\n}\n\nfunc main() {\n    fmt.Println(half(1))\n    fmt.Println(half(2))\n}\n</code></pre>\n\n<p>What am I doing wrong? How to overcome my error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493735637, "post_id": 43739330, "comment_id": 74524104, "body": "It looks like you&#39;re trying to shoe-horn classical object orientation into Go.  I advise not doing that. It&#39;s just asking for headaches."}], "answers": [{"comments": [{"owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "edited": false, "score": 0, "creation_date": 1512860253, "post_id": 43740321, "comment_id": 82428694, "body": "I came here with the same question. Would you care to elaborate on what you mean by &quot;have one type with function pointers for the implementation&quot;?"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 4, "last_activity_date": 1493734969, "creation_date": 1493734969, "answer_id": 43740321, "question_id": 43739330, "link": "https://stackoverflow.com/questions/43739330/calling-embeded-structs-interface-method-without-losing-type-information-on-the/43740321#43740321", "title": "Calling embeded struct&#39;s interface method without losing type information on the receiver", "body": "<blockquote>\n  <p>Is there a way to preserve the information about B's type when calling the method from it's embedded struct Parent, without duplicating the code?</p>\n</blockquote>\n\n<p>No.  When you call the embedded method, it is called with a pointer to the embedded struct.</p>\n\n<p>Unfortunately as attractive as it first seems, embedded objects don't make Go into an object oriented language.</p>\n\n<p>You might be better off just having one type with function pointers for the implementation.</p>\n"}], "owner": {"reputation": 3145, "user_id": 2146491, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kK9KC.jpg?s=128&g=1", "display_name": "B\u0142a\u017cej Michalik", "link": "https://stackoverflow.com/users/2146491/b%c5%82a%c5%bcej-michalik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 43740321, "answer_count": 1, "score": -1, "last_activity_date": 1493734969, "creation_date": 1493732172, "last_edit_date": 1493733136, "question_id": 43739330, "link": "https://stackoverflow.com/questions/43739330/calling-embeded-structs-interface-method-without-losing-type-information-on-the", "title": "Calling embeded struct&#39;s interface method without losing type information on the receiver", "body": "<p>The following code fails, because after using <code>B.Assign(A)</code>, the information on the specific type of <code>B</code> is lost (at least that's what I think goes wrong here):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Methods interface {\n    Method()\n    Assign(Methods)\n    Set(Methods)\n}\n\ntype Parent struct {\n    Methods\n    assigned Methods\n}\n\ntype ChildA struct {\n    Parent\n}\n\ntype ChildB struct {\n    Parent\n    msg string\n}\n\nfunc (this *Parent) Assign(other Methods) {\n    //Some other logic here\n    other.Set(this)\n}\n\nfunc (this *Parent) Set(other Methods) {\n    this.assigned = other\n}\n\nfunc (c *ChildA) Method() {\n    fmt.Println(\"I'm child A\")\n}\n\nfunc (c *ChildB) Method() {\n    fmt.Println(\"I'm child B, and I approve this message:\", c.msg)\n}\n\nfunc main() {\n    A := new(ChildA)\n    B := new(ChildB)\n    B.msg = \"my message\"\n\n    B.Assign(A)\n    A.assigned.Method()\n\n}\n</code></pre>\n\n<p>Now, in order to avoid this, I would have to make another method, that has exactly the same definition as <code>Parent.Assign()</code>, but different receiver: </p>\n\n<pre><code>func (this *Parent) Assign(other Methods) {\n    //Some other logic here\n    other.Set(this)                        \n}                                          \n\nfunc (this *ChildB) Assign(other Methods) {\n    //Same as above\n    other.Set(this)                        \n}                                          \n</code></pre>\n\n<p>This is rather ugly. Is there a way to preserve the information about <code>B</code>'s type when calling the method from it's embedded struct <code>Parent</code>, without duplicating the code?</p>\n"}, {"tags": ["amazon-web-services", "go", "exec"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1493730919, "post_id": 43738527, "comment_id": 74520593, "body": "When you run the <code>aws</code> command in the terminal and then do an <code>echo $?</code>, what do you get?"}, {"owner": {"reputation": 91, "user_id": 3506574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367f461d9712ab7a06893e2d675248c0?s=128&d=identicon&r=PG&f=1", "display_name": "Matus Kacmar", "link": "https://stackoverflow.com/users/3506574/matus-kacmar"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1493731159, "post_id": 43738527, "comment_id": 74520783, "body": "@MichaelHausenblas &quot;When I run my command in terminal it works so cli is configured correctly&quot; So the answer is 0"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493735113, "post_id": 43738527, "comment_id": 74523702, "body": "<code>&quot;s3 ls s3:&#47;&#47;&quot;+s3Path+&quot; --recursive&quot;</code> is 4 separate arguments, you can&#39;t put them in a single string. You&#39;re also ignoring Stderr which would print an error or usage information."}, {"owner": {"reputation": 91, "user_id": 3506574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367f461d9712ab7a06893e2d675248c0?s=128&d=identicon&r=PG&f=1", "display_name": "Matus Kacmar", "link": "https://stackoverflow.com/users/3506574/matus-kacmar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493789214, "post_id": 43738527, "comment_id": 74545512, "body": "@JimB so if I write it like this -&gt; output, err := exec.Command(&quot;aws&quot;, &quot;s3&quot;, &quot;ls&quot;, s3Path, &quot;--recursive&quot;).Output() the difference is just process hanging in terminal when I run compiled binnary."}, {"owner": {"reputation": 91, "user_id": 3506574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367f461d9712ab7a06893e2d675248c0?s=128&d=identicon&r=PG&f=1", "display_name": "Matus Kacmar", "link": "https://stackoverflow.com/users/3506574/matus-kacmar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493793294, "post_id": 43738527, "comment_id": 74547275, "body": "@JimB It&#39;ll finish eventually but it&#39;s taking so long."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493817557, "post_id": 43738527, "comment_id": 74563618, "body": "@MatusKacmar: so read the stdout/stderr, turn on debug logging, try a different command, etc. You need to do some debugging, but using correctly formatted arguments isn&#39;t going to cause the problem."}], "owner": {"reputation": 91, "user_id": 3506574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367f461d9712ab7a06893e2d675248c0?s=128&d=identicon&r=PG&f=1", "display_name": "Matus Kacmar", "link": "https://stackoverflow.com/users/3506574/matus-kacmar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493729877, "creation_date": 1493729877, "question_id": 43738527, "link": "https://stackoverflow.com/questions/43738527/exec-command-returns-exit-status-2-using-aws-cli", "title": "exec.Command returns exit status 2 using aws cli", "body": "<p>I'm trying to list directory content on s3 using aws cli. When I run my command in terminal it works so cli is configured correctly. However when I try to run it with exec.Command().Output() it does not work.</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nconst (\n    bucketName = \"some-bucket\"\n    dirPath    = \"data/entity/\"\n)\n\nfunc main() {\n    s3Path := bucketName + \"/\" + dirPath\n    output, err := exec.Command(\"aws\", \"s3 ls s3://\"+s3Path+\" --recursive\").Output()\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>Stdout:</p>\n\n<pre><code>exit status 2\n[]\n</code></pre>\n"}, {"tags": ["go", "byte"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1493729843, "post_id": 43738105, "comment_id": 74519831, "body": "The function <code>append</code> is for appending values to a slice and has <b>absolutely</b> <b>nothing</b> to do with bytes.Buffer which is not a slice. Just Write to your bytes.Buffer. And please read the docs ,especially <a href=\"https://golang.org/pkg/bytes/#Buffer.WriteByte\" rel=\"nofollow noreferrer\">golang.org/pkg/bytes/#Buffer.WriteByte</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1523511310, "last_edit_date": 1523511310, "creation_date": 1493729808, "answer_id": 43738493, "question_id": 43738105, "link": "https://stackoverflow.com/questions/43738105/append-byte-to-a-byte-buffer-in-golang/43738493#43738493", "title": "Append byte to a byte buffer in golang", "body": "<p>You have a buffer which is of type <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\"><code>bytes.Buffer</code></a> (or more specifically a pointer to that type). It has a <a href=\"https://golang.org/pkg/bytes/#Buffer.WriteByte\" rel=\"nofollow noreferrer\"><code>Buffer.WriteByte()</code></a> method, just use that:</p>\n\n<pre><code>message.Buf.WriteByte(0xff)\n</code></pre>\n\n<p>The builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a> function which you tried to call is to append values to <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slices</a>. <code>bytes.Buffer</code> is not a slice, you can't use that with <code>append()</code> (it is implemented using an internal slice, but that is an implementation detail which you should not build on / utilize).</p>\n"}], "owner": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5391, "favorite_count": 0, "accepted_answer_id": 43738493, "answer_count": 1, "score": 1, "last_activity_date": 1523511310, "creation_date": 1493728714, "question_id": 43738105, "link": "https://stackoverflow.com/questions/43738105/append-byte-to-a-byte-buffer-in-golang", "title": "Append byte to a byte buffer in golang", "body": "<p>I have a message byte Buffer and I would like to append a byte at the end of the Buffer</p>\n\n<p>I tried to append like this:</p>\n\n<pre><code>append(message.Buf, 0xff)\nfirst argument to append must be slice; have *bytes.Buffer\n\nappend(0xff,message.Buf)\nfirst argument to append must be slice; have untyped number\n</code></pre>\n\n<p>How can I make the 0xff as a slice to append? </p>\n"}, {"tags": ["shell", "go", "cmd", "operating-system", "exec"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1493729699, "post_id": 43738031, "comment_id": 74519727, "body": "Write your shell script to a file and have /bin/sh execute this script. This will give you line numbers."}, {"owner": {"reputation": 635, "user_id": 3491921, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e2794eb0e45c57129cb73d2c9d7b41a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mehulkumar", "link": "https://stackoverflow.com/users/3491921/mehulkumar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493739017, "post_id": 43738031, "comment_id": 74526578, "body": "@Volker running it directly also gives line numbers (my mistake, question updated). Please take a look at updated question. Thanks."}, {"owner": {"reputation": 635, "user_id": 3491921, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e2794eb0e45c57129cb73d2c9d7b41a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mehulkumar", "link": "https://stackoverflow.com/users/3491921/mehulkumar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493739342, "post_id": 43738031, "comment_id": 74526787, "body": "If you downvote, please also say what is missing or what can be improved in the question else I&#39;ll have no idea."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493751007, "post_id": 43738031, "comment_id": 74533237, "body": "Same advice again: Combine into <i>one</i> script and execute that script. Or: exec /bin/sh three times. Both variants work and produce the desired error reporting."}, {"owner": {"reputation": 635, "user_id": 3491921, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e2794eb0e45c57129cb73d2c9d7b41a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mehulkumar", "link": "https://stackoverflow.com/users/3491921/mehulkumar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493793429, "post_id": 43738031, "comment_id": 74547332, "body": "@Volker Thanks for the advice. <code>scripts</code> in the example can be any arbitrary commands. What I&#39;m really looking for is to <b>execute a command based on the output of the previous command</b>. It has to be in the same session. Combining into one script wouldn&#39;t let me run command based on the output of the previous command unless I do some shell programming."}], "owner": {"reputation": 635, "user_id": 3491921, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e2794eb0e45c57129cb73d2c9d7b41a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mehulkumar", "link": "https://stackoverflow.com/users/3491921/mehulkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493793723, "creation_date": 1493728393, "last_edit_date": 1493793723, "question_id": 43738031, "link": "https://stackoverflow.com/questions/43738031/how-to-run-multiple-shell-commands-independently-in-go", "title": "How to run multiple shell commands independently in Go", "body": "<p>I'm trying to find a way to run some commands based on the output of the previous command in the same session.</p>\n\n<p>For example: </p>\n\n<ul>\n<li>I've <code>cmd_one</code>, <code>cmd_two</code>, and <code>cmd_three</code>.</li>\n<li>Run the <code>cmd_one</code> first.</li>\n<li>If <code>cmd_one</code> returns non-zero exit status then run <code>cmd_two</code>,</li>\n<li>Else run <code>cmd_three</code>.</li>\n</ul>\n\n<p>Something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n\n    cmd := exec.Command(\"/bin/sh\")\n\n    pw, _ := cmd.StdinPipe()\n    pr, _ := cmd.StdoutPipe()\n    pe, _ := cmd.StderrPipe()\n\n    cmd.Start()\n\n    // run \"cmd_one\"\n    pw.Write([]byte(\"cmd_one\\n\"))\n\n    /*\n       Some way to get the output of \"cmd_one\" &lt;- Tricky one\n\n       if \"cmd_one\" exits with non-zero exit status, run \"cmd_two\"\n\n       else run \"cmd_three\"\n    */\n\n    pw.Close()\n\n    cmd.Wait()\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "edited": false, "score": 0, "creation_date": 1493728993, "post_id": 43737858, "comment_id": 74519251, "body": "Instead of a screenshot can you please post the actual code?"}, {"owner": {"reputation": 1604, "user_id": 6709477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mQdM4.jpg?s=128&g=1", "display_name": "fayeed", "link": "https://stackoverflow.com/users/6709477/fayeed"}, "reply_to_user": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "edited": false, "score": 0, "creation_date": 1493730285, "post_id": 43737858, "comment_id": 74520155, "body": "@chridam updated the code please take a look, thanks for you time."}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 1, "last_activity_date": 1493773152, "creation_date": 1493773152, "answer_id": 43749437, "question_id": 43737858, "link": "https://stackoverflow.com/questions/43737858/how-to-do-multi-level-push-of-array-element-in-mgo/43749437#43749437", "title": "How to do multi-level push of array element in mgo?", "body": "<p>You can utilise the <a href=\"https://docs.mongodb.com/manual/reference/operator/update/positional/\" rel=\"nofollow noreferrer\">$ positional</a> operator to update. Which basically identifies an element in an array to update without explicitly specifying the position of the element in the array.</p>\n\n<p>Alter your second push statement as below: </p>\n\n<pre><code>pushQuery := bson.M{\"date.$.event\": Event{    \n        Event_Name:\"foobar\",\n        Event_Id:\"4984984198\",   \n}}\nerr = collection.Update(bson.M{\"unique_id\":\"2549090\", \n                               \"date.event_timestamp\":\"08-05-2017\"}, \n                        bson.M{\"$push\": pushQuery})\n</code></pre>\n\n<p>The above will push event 'foobar' into the same date array matching event_timestamp '08-05-2017' i.e. </p>\n\n<pre><code>{\"_id\": ObjectId(\"5909287934cb838fe8f89b6e\"),\n  \"unique_id\": \"2549090\",\n  \"date\": [\n    {\n      \"event_timestamp\": \"08-05-2017\",\n      \"event\": [\n        {\n          \"event_name\": \"baz\",\n          \"event_id\": \"123456789\"\n        },\n        {\n          \"event_name\": \"foobar\",\n          \"event_id\": \"4984984198\"\n        }\n      ]\n    }\n  ]}\n</code></pre>\n\n<p><em>Generally</em> having an array of array makes querying or extracting data difficult/complex later on. Depending on your application's use case, I would also suggest to re-consider your <a href=\"https://docs.mongodb.com/manual/core/data-modeling-introduction/\" rel=\"nofollow noreferrer\">document Data Model</a>. </p>\n"}], "owner": {"reputation": 1604, "user_id": 6709477, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mQdM4.jpg?s=128&g=1", "display_name": "fayeed", "link": "https://stackoverflow.com/users/6709477/fayeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 43749437, "answer_count": 1, "score": 0, "last_activity_date": 1493773302, "creation_date": 1493727930, "last_edit_date": 1493773302, "question_id": 43737858, "link": "https://stackoverflow.com/questions/43737858/how-to-do-multi-level-push-of-array-element-in-mgo", "title": "How to do multi-level push of array element in mgo?", "body": "<p>So I want to do a multi level push for the struct below :</p>\n\n<pre><code>type Inspector_Pool struct{\n    Unique_Id string `json:\"unique_id\" form:\"unique_id\" query:\"unique_id\"`\n    Email string `json:\"email\" form:\"email\" query:\"email\"`\n    Branch []string `json:\"branch\" query:\"branch\"`\n    Date []Date `json:\"date\" query:\"date\"`\n}\n\ntype Date struct {\n    Event_Timestamp string `json:\"event_timestamp\" query:\"event_timestamp\"`\n    Event []Event `json:\"event\" query:\"event\"`\n}\n\ntype Event struct {\n    Event_Name string `json:\"event_name\" form:\"event_name\" query:\"event_name\"`\n    Event_Id string `json:\"event_id\" form:\"event_id\" query:\"event_id\"`\n    Status string `json:\"status\" query:\"status\"`\n}\n</code></pre>\n\n<p>So what i want is to push data in Event array so what I have to achieve code below:</p>\n\n<pre><code>//push a new node in date array\nquery := bson.M{\"branch\":\"400612\", \"unique_id\":c.Unique_Id}\nupdate := bson.M{\"$push\": bson.M{\"date\": bson.M{\"event_timestamp\": t, \"event\": []models.Event{\n        {\n            Event:models.INSPECTION,\n            Event_Id:\"123456789\",\n            Status:models.PENDING,\n        },\n\n}}}}\n\nerr = look_up.Update(query, update)\nif err != nil {\n    panic(err)\n}\n\n//push the data in the nested event \npushQuery := bson.M{\"date.event\": bson.M{\"event\": []models.Event{\n    {\n        Event_Name:models.INSPECTION,\n        Event_Id:\"4984984198\",\n        Status:models.PENDING,\n    },\n}}}\n\nerr = look_up.Update(bson.M{\"unique_id\": \"2549090\", \"date.event_timestamp\":\"08-05-2017\"}, bson.M{\"$push\": pushQuery})\nif err != nil {\n    //panic(err)\n    fmt.Print(\"error_2\",err)\n}\n</code></pre>\n\n<p>but it doesn'tpush it in the event object but instead create a new entry in date object heres the snapshot<a href=\"https://i.stack.imgur.com/zhaVw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zhaVw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493725948, "post_id": 43737030, "comment_id": 74517260, "body": "Your <code>x</code> got added to the <code>flows</code>. Then you change x. This does not change the value inside <code>flows</code>. It is like <code>a := 3; b := a; a = 5; fmt.Println(b);</code> As <code>b</code>&#39;s value is a copy of <code>a</code>&#39;s value it would be strange if <code>b</code>changed. Same with slices. Work your way through the Tour of Go once more."}, {"owner": {"reputation": 45, "user_id": 3714459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XcFBN.png?s=128&g=1", "display_name": "AkrogAmes", "link": "https://stackoverflow.com/users/3714459/akrogames"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493727056, "post_id": 43737030, "comment_id": 74518076, "body": "Thank you Volker. It&#39;s true. Thank you so much for this help."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3714459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XcFBN.png?s=128&g=1", "display_name": "AkrogAmes", "link": "https://stackoverflow.com/users/3714459/akrogames"}, "edited": false, "score": 0, "creation_date": 1493727285, "post_id": 43737181, "comment_id": 74518235, "body": "Thank you for your answer. I tried to create slice of pointers before my question but I had an error on another function. So Excuse me for this question. I am tired"}], "tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": true, "score": 1, "last_activity_date": 1493725955, "creation_date": 1493725955, "answer_id": 43737181, "question_id": 43737030, "link": "https://stackoverflow.com/questions/43737030/how-to-change-attribute-value-with-pointer/43737181#43737181", "title": "How to change attribute value with pointer", "body": "<p>In your function <code>AddFoo</code> you are adding a <em>copy</em> of Foo to your slice, then in <code>UpdateFoo</code> you are changing <code>x</code> which is not the same variable as the one in the slice.</p>\n\n<p>Yes, if you'd create a slice of pointers it'd <a href=\"https://play.golang.org/p/WX0YRx-9JG\" rel=\"nofollow noreferrer\">work</a>.</p>\n"}], "owner": {"reputation": 45, "user_id": 3714459, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XcFBN.png?s=128&g=1", "display_name": "AkrogAmes", "link": "https://stackoverflow.com/users/3714459/akrogames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 43737181, "answer_count": 1, "score": -1, "last_activity_date": 1493725955, "creation_date": 1493725532, "question_id": 43737030, "link": "https://stackoverflow.com/questions/43737030/how-to-change-attribute-value-with-pointer", "title": "How to change attribute value with pointer", "body": "<p>I am trying to change a value within a struct. Unfortunately, the value in \"\" ==>\", flow\" doesn't change. I don't understand why.</p>\n\n<p>Can you help me to explain why the pointer doesn't correspond in Slice. May be I must write a slice of pointer ?</p>\n\n<p>Thank you in advance.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Foo struct {\n    value float64\n}\n\nvar flows []Foo;\n\nfunc AddFoo(foo Foo) {\n    flows = append(flows, foo)\n}\n\nfunc UpdateFoo(stream *Foo) {\n    stream.value = 5.00\n}\n\nfunc main() {\n    x := Foo{1.00}\n    AddFoo(x)\n    UpdateFoo(&amp;x)\n    fmt.Println(x)\n\n\n    for _, flow := range flows {\n        fmt.Println(\" ==&gt;\", flow)\n        }\n}\n</code></pre>\n"}, {"tags": ["go", "variadic-functions"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1493724399, "post_id": 43736264, "comment_id": 74516198, "body": "Unfortunately there isn&#39;t a way that would satisfy both of your conditions, the best you can do, i think, is something like this: <code>foo(append([]string{bar1}, rest...)...)</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1493724696, "post_id": 43736264, "comment_id": 74516398, "body": "Also have a look at this <a href=\"http://stackoverflow.com/a/28626170/965900\">so answer</a>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1493725203, "post_id": 43736264, "comment_id": 74516741, "body": "Also related: <a href=\"http://stackoverflow.com/questions/37270743/is-it-possible-to-trigger-compile-time-error-with-custom-library-in-golang/37271129#37271129\">Is it possible to trigger compile time error with custom library in golang?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "is_accepted": false, "score": 1, "last_activity_date": 1493723631, "creation_date": 1493723631, "answer_id": 43736470, "question_id": 43736264, "link": "https://stackoverflow.com/questions/43736264/is-it-possible-to-partially-apply-variadic-functions-in-go/43736470#43736470", "title": "Is it possible to &quot;partially apply&quot; variadic functions in go?", "body": "<p>You'd have to change the signature to <code>func foo(some string, bars ...string)</code> as explained in the <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">docs</a>. More in the playground: <a href=\"https://play.golang.org/p/xlsCKzhj5y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xlsCKzhj5y</a></p>\n"}], "owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493723631, "creation_date": 1493722985, "question_id": 43736264, "link": "https://stackoverflow.com/questions/43736264/is-it-possible-to-partially-apply-variadic-functions-in-go", "title": "Is it possible to &quot;partially apply&quot; variadic functions in go?", "body": "<p>Given a function declared as</p>\n\n<pre><code>func foo(bars ...string) {\n    // ...\n}\n</code></pre>\n\n<p>I'd like to call this like so:</p>\n\n<pre><code>bar1 := \"whiskey bar\"\nrest := []string{\"vodka bar\", \"wine bar\"}\nfoo(bar1, rest...)\n</code></pre>\n\n<p>but this doesn't compile; the last line errors with this message:</p>\n\n<pre><code>have (string, []string...)\nwant (...[]string)\n</code></pre>\n\n<p>Is there a way I can declare a variadic function so that it can be called with both zero or more parameters that are values, and zero or one array of values (at the end)?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 606, "user_id": 2172325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf4000bd0804142a77bd3bdeb80fd527?s=128&d=identicon&r=PG", "display_name": "Rodrigo de Castro", "link": "https://stackoverflow.com/users/2172325/rodrigo-de-castro"}, "is_accepted": true, "score": 2, "last_activity_date": 1493772507, "creation_date": 1493772507, "answer_id": 43749356, "question_id": 43735533, "link": "https://stackoverflow.com/questions/43735533/identity-google-app-engine-environtment-type/43749356#43749356", "title": "Identity Google App Engine Environtment Type", "body": "<p>One way to do it is via Cloud Console. Go to \"App Engine\" on the left side and then click on \"Versions\". For which version there's a column identifying \"Standard\" or \"Flexible\".</p>\n"}], "owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 43749356, "answer_count": 1, "score": 0, "last_activity_date": 1493772507, "creation_date": 1493720579, "question_id": 43735533, "link": "https://stackoverflow.com/questions/43735533/identity-google-app-engine-environtment-type", "title": "Identity Google App Engine Environtment Type", "body": "<p>I just setup my first Go GAE (Google App Engine) last 2 months ago, and I forgot what environment type I've chosen (Whether Flexible or Standard edition).</p>\n\n<p>Anybody here know how to identity what type of my Go GAE is ?</p>\n"}, {"tags": ["mongodb", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493718130, "post_id": 43734341, "comment_id": 74512133, "body": "Thank you for taking the time to answer my question.  So you mean i have to write all the methods declared in FixedDataGrid &amp; DataGrid ?  and to implement the interface i just have to do like this in my function :   <code>func CreateModel(i base.FixedDataGrid) error {&#47;***   ****&#47; }</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493718692, "post_id": 43734341, "comment_id": 74512496, "body": "Yes, if, for examle, you want to call this <a href=\"https://godoc.org/github.com/sjwhitworth/golearn/trees#InferID3Tree\" rel=\"nofollow noreferrer\">InferID3Tree function</a> and you want to pass in your <code>[]dataStruct</code> as the first argument you need to implement <b>all</b> those methods. The <code>InferID3Tree</code> relies on the <b>behaviour</b> (the methods) of that interface, if your type does not implement those methods and you try to pass it as the first argument your program will not even compile."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493719167, "post_id": 43734341, "comment_id": 74512776, "body": "<code>&#47;* ... *&#47;</code> is just a comment that you need to replace with real code. I&#39;m not sure I understand what you mean in you second sentence of the comment, can you be more specific? Why do you actually need to convert your type into the <code>base.FixedDataGrid</code>? What does <code>CreateModel</code> do?"}, {"owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493720464, "post_id": 43734341, "comment_id": 74513669, "body": "Actually here is what my function CreateModel doing: I taking data from mongodb to use it in machine learning training, my model is KNN. And the <code>results</code> argument  in <code>base.InstancesTrainTestSplit()</code> has to be type <code>base.FixedDataGrid</code> ...  I Added the function createModel code in the question."}, {"owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493722384, "post_id": 43734341, "comment_id": 74514960, "body": "Thank you, it&#39;s clear. I&#39;ll try to implement this and come back to you if i need something. Thanks again"}, {"owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493727731, "post_id": 43734341, "comment_id": 74518518, "body": "I have one more question: Should i let the <code>type dataStructList []dataStruct </code> just like this? or should i add the other attributes like in <code>InstancesView</code> type like this: <code>type InstancesView struct  {         src                   FixesDataGrid         attrs                []AttributeSpec         rows                map[int]int         classAttrs        map[attribute]bool         maskRows      bool }</code>  Because those attributes seems to be needed in the implementation of  <code>FixedDataGrid  </code> functions..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "edited": false, "score": 0, "creation_date": 1493729118, "post_id": 43734341, "comment_id": 74519335, "body": "I&#39;m not that familiar with the <code>golearn</code> package so it&#39;s hard for me to tell, but to be able to pass your <code>type</code> to a function that takes an argument of type <code>FixesDataGrid</code> all you need to do is implement the methods of that interface and your program will compile. How you implement them is entirely up to you. So, if besides <code>[]dataStruct</code> you need to keep some extra <i>state</i> to make <b>your</b> implementation of those methods work the way <b>you</b> want, then yes, do wrap it in a <code>struct</code> with fields that will hold the relevant state, for example: <a href=\"https://play.golang.org/p/cYa8-f_Lq4\" rel=\"nofollow noreferrer\">play.golang.org/p/cYa8-f_Lq4</a>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1493721978, "last_edit_date": 1493721978, "creation_date": 1493716892, "answer_id": 43734341, "question_id": 43733221, "link": "https://stackoverflow.com/questions/43733221/convert-type-from-struct-table-to-base-fixeddatagrid-in-go/43734341#43734341", "title": "Convert type from struct table to base.FixedDataGrid in GO", "body": "<p><a href=\"https://godoc.org/github.com/sjwhitworth/golearn/base#FixedDataGrid\" rel=\"nofollow noreferrer\">base.FixedDataGrid</a> is an <code>interface</code>, so what you need to do is to implement that interface, that is, implement all of its methods, on the type you want to use as <code>FixedDataGrid</code>.</p>\n\n<p>Since you want to use <code>[]dataStruct</code>, a slice of <code>dataStruct</code>s, which is an <em>unnamed type</em>, as <code>FixedDataGrid</code> you will have to declare a new type to be able to add methods to it because you can add methods only to <em>named types</em>. For example something like this:</p>\n\n<pre><code>type dataStructList []dataStruct\n</code></pre>\n\n<p>Now, if you take a look at the documentation, you can see that the <code>FixedDataGrid</code> interface declares two methods <code>RowString</code> and <code>Size</code> but also <em>embeds</em> another interface, the <a href=\"https://godoc.org/github.com/sjwhitworth/golearn/base#DataGrid\" rel=\"nofollow noreferrer\">base.DataGrid</a> interface, which means you need to implement the methods declared by <code>DataGrid</code> as well. So, given your new <code>dataStructList</code> type, you can do something like this:</p>\n\n<pre><code>func (l dataStructList) RowString(int) string { /* ... */ }\nfunc (l dataStructList) Size() (int, int) { /* ... */ }\nfunc (l dataStructList) GetAttribute(base.Attribute) (base.AttributeSpec, error)  { /* ... */ }\nfunc (l dataStructList) AllAttributes() []base.Attribute  { /* ... */ }\nfunc (l dataStructList) AddClassAttribute(base.Attribute) error  { /* ... */ }\nfunc (l dataStructList) RemoveClassAttribute(base.Attribute) error  { /* ... */ }\nfunc (l dataStructList) AllClassAttributes() []base.Attribute  { /* ... */ }\nfunc (l dataStructList) Get(base.AttributeSpec, int) []byte  { /* ... */ }\nfunc (l dataStructList) MapOverRows([]base.AttributeSpec, func([][]byte, int) (bool, error)) error  { /* ... */ }\n</code></pre>\n\n<p>After you've implemented the <code>/* ... */</code> parts you can then start using <code>dataStructList</code> as a <code>FixedDataGrid</code>, so something like this:</p>\n\n<pre><code>var results []dataStruct\nerr := col.Find(nil).All(&amp;results)\nfdg := dataStructList(results) // you can use fdg as FixedDataGrid\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>var results dataStructList // you can use results as FixedDataGrid\nerr := col.Find(nil).All(&amp;results)\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<p>After you've implemented all of those methods on the <code>dataStructList</code> all you need is the type of the <code>results</code> variable inside your function:</p>\n\n<pre><code>func CreateModel(c echo.Context) error {\n    fmt.Println(\"====&gt; Entry CreateModel function\")\n    //var results []dataStruct\n    var Success bool = false\n\n    Db := db.MgoDb{}\n    Db.Init()\n    defer Db.Close()\n\n    col := Db.C(db.TrainingDataCollection)\n    var results dataStructList // &lt;--- use the type that implements the interface\n    if err := col.Find(nil).All(&amp;results); err != nil { // &lt;-- pass a pointer to results\n        fmt.Println(\"ERROR WHILE GETTING THE TRAINING DATA\")\n    } else {\n        //fmt.Println(\"Results All: \", results)\n        Success = true\n    }\n\n    fmt.Println(\"=============\", results)\n\n    //Initialises a new KNN classifier\n    cls := knn.NewKnnClassifier(\"euclidean\", \"linear\", 2)\n\n    //Do a training-test split\n    trainData, testData := base.InstancesTrainTestSplit(results, 0.55) // &lt;-- this will work because results if of type dataStructList, which implements the base.FixedDataGrid interface.\n    cls.Fit(trainData)\n\n    //Calculates the Euclidean distance and returns the most popular label\n    predictions, err := cls.Predict(testData)\n\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(predictions)\n\n    // Prints precision/recall metrics\n    confusionMat, err := evaluation.GetConfusionMatrix(testData, predictions)\n\n    if err != nil {\n        panic(fmt.Sprintf(\"Unable to get confusion matrix: %s\", err.Error()))\n    }\n\n    fmt.Println(evaluation.GetSummary(confusionMat))\n\n    return c.JSON(http.StatusOK, Success)\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "is_accepted": true, "score": 1, "last_activity_date": 1493887623, "creation_date": 1493887623, "answer_id": 43778014, "question_id": 43733221, "link": "https://stackoverflow.com/questions/43733221/convert-type-from-struct-table-to-base-fixeddatagrid-in-go/43778014#43778014", "title": "Convert type from struct table to base.FixedDataGrid in GO", "body": "<p>Here is how i solved the issue: Actually there is a function <code>InstancesFromMat64(row int, col int, matrix)</code> than creates <code>instances</code> from a <code>float64</code> matrix, and this is what i used:</p>\n\n<pre><code>func CreateModel(c echo.Context) error {\n    fmt.Println(\"====&gt; Entry CreateModel function\");\n    var Success bool = false\n\n    Db := db.MgoDb{}\n    Db.Init()\n    defer Db.Close()\n\n    col := Db.C(db.TrainingDataCollection)\n    var results dataStruct\n    if err := col.Find(nil).All(&amp;results); err != nil {\n           fmt.Println(\"ERROR WHILE GETTING THE TRAINING DATA\")\n    } else {\n           Success = true\n     }\n\n   Data := make([]float64, len(results*nbAttrs)\n\n   /**** Filling the Data var with my dataset data *****/\n\n   mat := mat64.NewDense(row,nbAttrs,Data)\n   inst := base.InstancesFromMat64(row,nbAttrs,mat)\n\n   //Selecting the class attribute for our instance\n   attrs := inst.AllAttributes()\n   inst.AddClassAttribute(attrs[4])\n\n   //Initialise a new KNN classifier\n   cls := knn.NewKnnClassifier(\"manhattan\",\"linear\",3)\n\n   //Training-tessting split\n   trainData, testData := base.InstancesTrainTestSplit(inst,0.7)\n\n   /*******          Continue the Model creation                ******/\n</code></pre>\n\n<p>I'll be glad if my answer helps someone.</p>\n\n<p>Thanks a lot @mkopriva for your help !</p>\n"}], "owner": {"reputation": 33, "user_id": 7097542, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8f940397d5d6133a248a18a4a339517c?s=128&d=identicon&r=PG&f=1", "display_name": "Lie Hili", "link": "https://stackoverflow.com/users/7097542/lie-hili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 43778014, "answer_count": 2, "score": 1, "last_activity_date": 1493887623, "creation_date": 1493713067, "last_edit_date": 1493720592, "question_id": 43733221, "link": "https://stackoverflow.com/questions/43733221/convert-type-from-struct-table-to-base-fixeddatagrid-in-go", "title": "Convert type from struct table to base.FixedDataGrid in GO", "body": "<p>i'm having a trouble converting my struct table to fixedDataGrid, because i need my data to be a fixedDataGrid so that i can use machine learning methods from GoLearn lib.</p>\n\n<p>My struct is like this:</p>\n\n<pre><code>type dataStruct struct{\n    Sepal_length string\n    Sepal_width string\n    Petal_length string\n    Petal_width string\n    Species string\n}\n</code></pre>\n\n<p>So when i get my data from my mongo db, i get them like this:</p>\n\n<pre><code>var results []dataStruct\nerr := col.Find(nil).All(&amp;results)\n</code></pre>\n\n<p>Is there a way to convert my \"results\" from []dataStruct type to base.FixedDataGrid ??</p>\n\n<p>CreateModel function:</p>\n\n<pre><code>func CreateModel(c echo.Context) error {\n    fmt.Println(\"====&gt; Entry CreateModel function\");\n    //var results []dataStruct\n    var Success bool = false\n\n    Db := db.MgoDb{}\n    Db.Init()\n    defer Db.Close()\n\n    col := Db.C(db.TrainingDataCollection)\n    var results dataStruct\n    if err := col.Find(nil).All(results); err != nil {\n        fmt.Println(\"ERROR WHILE GETTING THE TRAINING DATA\")\n    } else {\n       //fmt.Println(\"Results All: \", results) \n       Success = true\n    }\n\nfmt.Println(\"=============\",results)\n\n//Initialises a new KNN classifier\ncls := knn.NewKnnClassifier(\"euclidean\", \"linear\", 2)\n\n//Do a training-test split\ntrainData, testData := base.InstancesTrainTestSplit(results, 0.55)\ncls.Fit(trainData)\n\n//Calculates the Euclidean distance and returns the most popular label\npredictions, err := cls.Predict(testData)\n\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(predictions)\n\n// Prints precision/recall metrics\nconfusionMat, err := evaluation.GetConfusionMatrix(testData, predictions)\n\nif err != nil {\n    panic(fmt.Sprintf(\"Unable to get confusion matrix: %s\", err.Error()))\n}\n\nfmt.Println(evaluation.GetSummary(confusionMat))\n\nreturn c.JSON(http.StatusOK, Success)\n\n}\n</code></pre>\n\n<p>Thank you in advance for your help !</p>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493704600, "post_id": 43730858, "comment_id": 74505120, "body": "Code you must show."}, {"owner": {"reputation": 4223, "user_id": 710955, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/GvorM.png?s=128&g=1", "display_name": "LeMoussel", "link": "https://stackoverflow.com/users/710955/lemoussel"}, "edited": false, "score": 0, "creation_date": 1493704882, "post_id": 43730858, "comment_id": 74505225, "body": "Difficult to answer without code source."}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493705674, "post_id": 43730858, "comment_id": 74505578, "body": "i&#39;m sorry. The code is just plain html, didn&#39;t  think it would be useful. But i have just uploaded some code as well as some images"}, {"owner": {"reputation": 971, "user_id": 4508728, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-W7a9SCsU8wY/AAAAAAAAAAI/AAAAAAAAABs/ZTOmhRWvTts/photo.jpg?sz=128", "display_name": "AwesomeGuy", "link": "https://stackoverflow.com/users/4508728/awesomeguy"}, "edited": false, "score": 0, "creation_date": 1493706307, "post_id": 43730858, "comment_id": 74505869, "body": "You should check your permissions for index.css if you&#39;re using a mac or linux."}, {"owner": {"reputation": 647, "user_id": 7923571, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4e62d182c335f07c1f883e5b8809e740?s=128&d=identicon&r=PG&f=1", "display_name": "Ferus7", "link": "https://stackoverflow.com/users/7923571/ferus7"}, "edited": false, "score": 0, "creation_date": 1493706417, "post_id": 43730858, "comment_id": 74505926, "body": "is the path correct?"}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 2, "creation_date": 1493706561, "post_id": 43730858, "comment_id": 74505996, "body": "Hmmm. It was probably a permission issue. I deleted the old one, and created a new one and it works now. Funny thing is i did this before and it still didn&#39;t work. Oh well, welcome to programming i guess..."}], "answers": [{"tags": [], "owner": {"reputation": 377, "user_id": 4712552, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/liv59.jpg?s=128&g=1", "display_name": "Ravi Ubana", "link": "https://stackoverflow.com/users/4712552/ravi-ubana"}, "is_accepted": false, "score": 0, "last_activity_date": 1493706701, "creation_date": 1493706701, "answer_id": 43731504, "question_id": 43730858, "link": "https://stackoverflow.com/questions/43730858/go-html-cannot-find-css-file/43731504#43731504", "title": "Go: HTML cannot find css file", "body": "<p>May be this problem is because of -</p>\n\n<p>1.Temp file, try to find index.css~ file.If using Ubuntu then go to the css folder and press <code>ctrl+H</code>. then you will see the temp file if it is there. </p>\n\n<p>2.May be path is not correct.</p>\n\n<p>3.May be file got corrupted, try to delete and create new index.css</p>\n\n<p>4.Provide your source code to debug your issue. </p>\n"}, {"tags": [], "owner": {"reputation": 1177, "user_id": 1462608, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f142026b67b59b53a9929b8c6eb8e4c?s=128&d=identicon&r=PG", "display_name": "Lai Xue", "link": "https://stackoverflow.com/users/1462608/lai-xue"}, "is_accepted": false, "score": 1, "last_activity_date": 1493706964, "creation_date": 1493706964, "answer_id": 43731565, "question_id": 43730858, "link": "https://stackoverflow.com/questions/43730858/go-html-cannot-find-css-file/43731565#43731565", "title": "Go: HTML cannot find css file", "body": "<p>Did you mark the css folder as static in your server side script? Try running this code from your go web server and see if you could access those css files.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    http.Handle(\"/\", http.FileServer(http.Dir(\"./web/content/css\")))\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I'm not sure if I got your folder structure right, you might have to modify \"./web/content/css\".</p>\n"}], "owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1493707089, "creation_date": 1493703738, "last_edit_date": 1493707089, "question_id": 43730858, "link": "https://stackoverflow.com/questions/43730858/go-html-cannot-find-css-file", "title": "Go: HTML cannot find css file", "body": "<p>So i'm writing a web application in Golang. The html references a <code>css</code> file like so: <code>&lt;link href=\"/css/index.css\"...</code>, but the <code>css</code> file is never found!.</p>\n\n<p>Here is the bummer though, i have a couple of <code>css</code> files and they are all in the same folder, and they all work!. </p>\n\n<p>If i create another <code>css</code> file and name it <code>index2.css</code> and copy the contents of <code>index.css</code> into <code>index2.css</code>, this works perfectly, but for some reason, the name <code>index.css</code> does not work!</p>\n\n<p>Also, when i go to the link <code>http://localhost:8080/css/</code> this list all my <code>css</code> files. If i click on any of them, it opens up perfectly except <code>index.css</code>; i get a 404 not found. </p>\n\n<p>This is really strange, any idea what could be the problem?</p>\n\n<p>All files in css folder:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pEVaE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pEVaE.png\" alt=\"enter image description here\"></a></p>\n\n<p>index.css not found:</p>\n\n<p><a href=\"https://i.stack.imgur.com/P0Sl0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P0Sl0.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>&lt;head&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;link href=\"/css/index2.css\" rel=\"stylesheet\" type=\"text/css\" media=\"screen\"/&gt;\n    &lt;link rel=\"icon\" type=\"image/png\" href=\"/images/img.png\"/&gt;\n    &lt;script src=\"/scripts/jquery.min.js\"&gt;&lt;/script&gt;\n    &lt;script src=\"/scripts/scroll.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n</code></pre>\n\n<p>When i like to <code>&lt;link href=\"/css/index2.css\" rel=\"stylesheet\"...</code> i can see the css style on my page. When i link to <code>&lt;link href=\"/css/index.css\" rel=\"stylesheet\"...</code> i can't.</p>\n\n<p>index.css exists in my folder:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dk3M5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dk3M5.png\" alt=\"enter image description here\"></a></p>\n\n<p>EDIT</p>\n\n<p>It works now. I think it was a permission issue. I deleted the old <code>index.css</code> and created a new one and it works now. Thanks for the help.</p>\n"}, {"tags": ["go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 14464, "user_id": 50419, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/S1nop.jpg?s=128&g=1", "display_name": "Navaneeth K N", "link": "https://stackoverflow.com/users/50419/navaneeth-k-n"}, "is_accepted": false, "score": 2, "last_activity_date": 1493701344, "creation_date": 1493701344, "answer_id": 43730398, "question_id": 43730255, "link": "https://stackoverflow.com/questions/43730255/how-to-deal-with-duplicate-methods-in-go-interface/43730398#43730398", "title": "How to deal with duplicate methods in Go interface?", "body": "<p>I don't think it is possible to do this. IMO, interface embedding is just a shorthand for having those functions directly there. So it is equivalent as having two <code>Hello()</code> functions. Hence the error from compiler. </p>\n"}, {"tags": [], "owner": {"reputation": 416, "user_id": 7950755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dd1100866630687cc7e1b956deed416?s=128&d=identicon&r=PG&f=1", "display_name": "ij6", "link": "https://stackoverflow.com/users/7950755/ij6"}, "is_accepted": true, "score": 10, "last_activity_date": 1493723027, "last_edit_date": 1493723027, "creation_date": 1493713450, "answer_id": 43733306, "question_id": 43730255, "link": "https://stackoverflow.com/questions/43730255/how-to-deal-with-duplicate-methods-in-go-interface/43733306#43733306", "title": "How to deal with duplicate methods in Go interface?", "body": "<p>The way to do this is to explicitly provide the required methods instead of using the shorthand syntax:</p>\n\n<pre><code>type Entertainer interface {\n    Hello()\n    Joke()\n    Jump()\n}\n</code></pre>\n\n<p>This may seem like code duplication, but note that duplicate code isn't an untypical thing in Go, especially when it leads to clearer code.</p>\n\n<p>Also note this: If you think in terms of typical inheritance in other languages, it may seem like you're losing some information by doing this, because you're not recording the fact that <code>Entertainer</code> <em>inherits</em> from, say, <code>Person</code>. But Go interfaces are purely structural, there is no inheritance. Because an <code>Entertainer</code> has a <code>Hello()</code> method, every <code>Entertainer</code> is automatically a <code>Person</code>, whether or not you explicitly mention <code>Person</code> insided the <code>Entertainer</code> declaration.</p>\n\n<p>All of this compiles without problems (except for a \"declared and not used\" error) even when you don't use the shorthand syntax for any of the interfaces:</p>\n\n<pre><code>var e Entertainer\nvar ju Jumper\nvar jo Joker\nvar p Person\n\np = e    // every Entertainer is also a Person\np = ju   // every Jumper is also a Person\np = jo   // every Joker is also a Person\n\nju = e   // every Entertainer is also a Jumper\n\njo = e   // every Entertainer is also a Joker\n</code></pre>\n\n<p>Here's a complete program that compiles and runs just fine. Given these declarations:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person interface {\n    Hello()\n}\n\ntype Joker interface {\n    Hello()\n    Joke()\n}\n\ntype Jumper interface {\n    Hello()\n    Jump()\n}\n\ntype Entertainer interface {\n    Hello()\n    Joke()\n    Jump()\n}\n</code></pre>\n\n<p>let's create a <code>Clown</code> type:</p>\n\n<pre><code>type Clown struct {}\n\nfunc (c Clown) Hello() {\n    fmt.Println(\"Hello everybody\")\n}\n\nfunc (c Clown) Joke() {\n    fmt.Println(\"I'm funny\")\n}\n\nfunc (c Clown) Jump() {\n    fmt.Println(\"And up I go\")\n}\n</code></pre>\n\n<p>A <code>Clown</code> can greet, jump, and joke, and so it implements all of our interfaces. Given these four functions:</p>\n\n<pre><code>func PersonSayHello(p Person) {\n    p.Hello()\n}\n\nfunc JumperJump(j Jumper) {\n    j.Jump()\n}\n\nfunc JokerJoke(j Joker) {\n    j.Joke()\n}\n\nfunc EntertainerEntertain(e Entertainer) {\n    e.Joke()\n    e.Jump()\n}\n</code></pre>\n\n<p>you can pass a <code>Clown</code> to any of them:</p>\n\n<pre><code>func main() {\n    c := Clown{}\n\n    PersonSayHello(c)\n    JokerJoke(c)\n    JumperJump(c)\n    EntertainerEntertain(c)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/GTAeKecLGY\" rel=\"noreferrer\">Here's a link to a Go Playground with the above code</a>.</p>\n\n<p>One final thing &ndash; you could argue something like this: \"But if I later make a change to <code>Person</code>, it won't be reflected in the other interfaces.\" It's true, you have to make such an adjustment manually, but the compiler will let you know about it.</p>\n\n<p>If you have this function:</p>\n\n<pre><code>func JumperSayHello(j Jumper) {\n    PersonSayHello(j)\n}\n</code></pre>\n\n<p>your code will work without any issues. But if you add another method to <code>Person</code>, code that relies on the fact that a <code>Jumper</code> is a <code>Person</code> will no longer compile. With</p>\n\n<pre><code>type Person interface {\n    Hello()\n    Think()\n}\n</code></pre>\n\n<p>you get</p>\n\n<pre>.\\main.go:18: cannot use j (type Jumper) as type Person in argument to PersonSayHello:\n        Jumper does not implement Person (missing Think method)</pre>\n\n<p>This will be the case as long as you have code <em>anywhere</em> that relies on the fact that a <code>Jumper</code> is always a <code>Person</code>. And if you don't, not even in your tests, then &ndash; well, maybe it doesn't actually matter that the jumper doesn't think?</p>\n\n<p>But if for whatever reason you actually need to ensure that a <code>Jumper</code> is always a <code>Person</code>, no matter what changes you make to these interfaces, but this fact isn't actually used anywhere, you can always create code just for this purpose:</p>\n\n<pre><code>package main\n\ntype Person interface {\n    Hello()\n}\n\ntype Jumper interface {\n    Hello()\n    Jump()\n}\n\n// this function is never used, it just exists to ensure\n// interface compatibility at compile time\nfunc ensureJumperIsPerson(j Jumper) {\n    var p Person = j\n    _ = p\n}\n\nfunc main() {\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1570637126, "creation_date": 1570637126, "answer_id": 58308146, "question_id": 43730255, "link": "https://stackoverflow.com/questions/43730255/how-to-deal-with-duplicate-methods-in-go-interface/58308146#58308146", "title": "How to deal with duplicate methods in Go interface?", "body": "<p>This is followed by \"<a href=\"https://github.com/golang/go/issues/6977\" rel=\"nofollow noreferrer\">issue 6997, proposal: spec: allow embedding overlapping interfaces</a>\".</p>\n\n<blockquote>\n  <p>If you view an interface as a set of constraints on the implementing type, then\n  combining two interfaces (that are not mutually incompatible) such as:</p>\n\n<pre><code>type I interface { f(); String() string }\ntype J interface { g(); String() string } \n</code></pre>\n  \n  <p>has a natural interpretation that is equivalent to an interface containing the union of\n  such constraints.  e.g. these should be equivalent:</p>\n\n<pre><code>type IJ interface { I; J }\ntype IJ interface { f(); g(); String() string }\n</code></pre>\n  \n  <p>but in fact the first is an error: \"duplicate method: String\". </p>\n</blockquote>\n\n<p>Go 1.14 (Q1 2020, five years later) <em>might</em> include some improvments:</p>\n\n<p><a href=\"https://go-review.googlesource.com/c/go/+/190258/\" rel=\"nofollow noreferrer\">CL 190258: allow embedding overlapping interfaces</a> , replaced by <a href=\"https://go-review.googlesource.com/c/go/+/191257/\" rel=\"nofollow noreferrer\">CL 191257</a></p>\n\n<blockquote>\n  <p>Quietly drop duplicate methods from embedded interfaces if they have an identical signature to existing methods.</p>\n  \n  <p>Instead of adjusting the prior syntax-based only method set computation where methods don't have signature information (and thus where de-duplication according to the new rules would have been somewhat tricky to get right), this change completely rewrites interface method set computation, taking a page from the <code>cmd/compiler</code>'s implementation. </p>\n  \n  <p>In a first pass, when type-checking interfaces, explicit methods and embedded interfaces are collected, but the interfaces are not \"expanded\", that is the final method set computation is done lazily, either when needed for method lookup, or\n  at the end of type-checking.</p>\n</blockquote>\n\n<p>The spec is updated (<a href=\"https://go-review.googlesource.com/c/go/+/190378/\" rel=\"nofollow noreferrer\">CL 190378</a>)</p>\n\n<p>See some <a href=\"https://go-review.googlesource.com/c/proposal/+/188197/3/design/6977-overlapping-interfaces.md\" rel=\"nofollow noreferrer\">examples here</a>.</p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2629, "favorite_count": 1, "accepted_answer_id": 43733306, "answer_count": 3, "score": 6, "last_activity_date": 1570637126, "creation_date": 1493700400, "question_id": 43730255, "link": "https://stackoverflow.com/questions/43730255/how-to-deal-with-duplicate-methods-in-go-interface", "title": "How to deal with duplicate methods in Go interface?", "body": "<p>How to deal with duplicate methods in Go interface?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person interface {\n    Hello()\n}\n\ntype Joker interface {\n    Person\n    Joke()\n}\n\ntype Jumper interface {\n    Person\n    Jump()\n}\n\ntype Entertainer interface {\n    Joker\n    Jumper\n}\n\nfunc main() {\n    fmt.Println(\"hello, world\")\n}\n</code></pre>\n\n<p>The following error occurs if I run this code.</p>\n\n<pre><code>$ go run foo.go\n# command-line-arguments\n./foo.go:24: duplicate method Hello\n</code></pre>\n\n<p>How to deal with situations like this and how can we avoid duplicate\nmethods in such a scenario?</p>\n"}, {"tags": ["pointers", "go", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1493698859, "last_edit_date": 1592644375, "creation_date": 1493698025, "answer_id": 43729948, "question_id": 43729893, "link": "https://stackoverflow.com/questions/43729893/where-does-go-define-that-p-field-as-opposed-to-p-field-is-a-valid-syntax-e/43729948#43729948", "title": "Where does Go define that p.Field (as opposed to (*p).Field) is a valid syntax even when p is a pointer to a struct?", "body": "<p><a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">Spec: Selectors:</a></p>\n<blockquote>\n<p>The following rules apply to selectors:</p>\n<p>[...] if the type of <code>x</code> is a named pointer type and <code>(*x).f</code> is a valid selector expression denoting a field (but not a method), <strong><code>x.f</code> is shorthand for <code>(*x).f</code></strong>.</p>\n</blockquote>\n<p>The language spec helps you with the pointer syntax to make it feel you're not even using pointers in some cases. Dereferencing a pointer to access its field is one of them. Also you can call methods that have pointer receiver on non-pointer values if they are addressable, see <a href=\"https://stackoverflow.com/questions/38481420/calling-a-method-with-a-pointer-receiver-by-an-object-instead-of-a-pointer-to-it/38481697#38481697\">Calling a method with a pointer receiver by an object instead of a pointer to it?</a></p>\n<p>Also you can index and slice array pointers, e.g. if <code>a</code> is a pointer to array type:</p>\n<ul>\n<li><code>a[x]</code> is shorthand for <code>(*a)[x]</code></li>\n<li>and <code>a[low : high]</code> is shorthand for <code>(*a)[low : high]</code>.</li>\n</ul>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493698859, "creation_date": 1493697670, "question_id": 43729893, "link": "https://stackoverflow.com/questions/43729893/where-does-go-define-that-p-field-as-opposed-to-p-field-is-a-valid-syntax-e", "title": "Where does Go define that p.Field (as opposed to (*p).Field) is a valid syntax even when p is a pointer to a struct?", "body": "<p>Here is my Go program.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person struct {\n    Name string\n}\n\nfunc main() {\n    p := &amp;Person{\"Jack\"}\n\n    // The following statement makes sense. We dereference the\n    // pointer to reach the Person object and then retrieve its Name\n    // field.\n    fmt.Println((*p).Name)\n\n    // But the following statement does not make sense. How does\n    // this code work by retrieving the Name field directly from the\n    // pointer without dereferencing it?\n    fmt.Println(p.Name)\n}\n</code></pre>\n\n<p>Here is the output.</p>\n\n<pre><code>$ go run foo.go \nJack\nJack\n</code></pre>\n\n<p>When <code>p</code> is of type <code>*Person</code>, i.e. a pointer to <code>Person</code>, how is it legal to access its field <code>Name</code> without dereferencing it? I see all Go tutorials using the syntax <code>p.Name</code> instead of <code>(*p).Name</code> but where exactly the Go language defines <code>p.Person</code> as a legal syntax?</p>\n"}, {"tags": ["c++", "go"], "comments": [{"owner": {"reputation": 19411, "user_id": 6640099, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/tf1sO.jpg?s=128&g=1", "display_name": "Christian Dean", "link": "https://stackoverflow.com/users/6640099/christian-dean"}, "edited": false, "score": 0, "creation_date": 1493696330, "post_id": 43729511, "comment_id": 74502803, "body": "Please don&#39;t spam the tags. Only use tags which are related to your question."}, {"owner": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "reply_to_user": {"reputation": 19411, "user_id": 6640099, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/tf1sO.jpg?s=128&g=1", "display_name": "Christian Dean", "link": "https://stackoverflow.com/users/6640099/christian-dean"}, "edited": false, "score": 0, "creation_date": 1493698058, "post_id": 43729511, "comment_id": 74503206, "body": "@ChristianDean actually I am enlightened by the python of concept of the aop, or decoration, so I think it&#39;s not spam tag. perhaps someone else may   be interested in this question"}], "answers": [{"tags": [], "owner": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "is_accepted": false, "score": 2, "last_activity_date": 1493722341, "last_edit_date": 1493722341, "creation_date": 1493697922, "answer_id": 43729931, "question_id": 43729511, "link": "https://stackoverflow.com/questions/43729511/are-there-some-methods-in-golang-manipulate-function-like-stdbind-in-c/43729931#43729931", "title": "Are there some methods in golang manipulate function like std::bind in C++?", "body": "<p>Closure, here is my solution:</p>\n\n<pre><code>handler_new = func(c *gin.Context){ return PreExecute(c, handler_old)(c) } // since there is no return value of handler, so just do not use `return` statements, I will not correct this error\n</code></pre>\n\n<p>and then handler_new can be used as:</p>\n\n<pre><code>handler_new(some_context)\n</code></pre>\n\n<p>It's the same as</p>\n\n<pre><code>handler_new = std::bind(PreExecute, _1, handler_old)\n</code></pre>\n\n<p>in C++</p>\n"}], "owner": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 925, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493722341, "creation_date": 1493695042, "last_edit_date": 1493696303, "question_id": 43729511, "link": "https://stackoverflow.com/questions/43729511/are-there-some-methods-in-golang-manipulate-function-like-stdbind-in-c", "title": "Are there some methods in golang manipulate function like std::bind in C++?", "body": "<p>Here is my design:</p>\n\n<pre><code>type Handler func(c *gin.Context)\nfunc PreExecute(c *gin.Context, handle_func Handler) Handler {\n    if c.User.IsAuthorized {\n        return handle_func\n    } else {\n        return some_error_handle_func\n    }\n}\n</code></pre>\n\n<p>and I want to decorate every handler by PreExecute just like the decoration in Python. So I am looking for some std::bind functions in golang to get PreExecute a exactly same signature as Handler</p>\n\n<p>What I expect:</p>\n\n<pre><code>handler = std::bind(PreExecute, _1, handler) // where _1 hold the position for parameter `c *gin.Context`\n</code></pre>\n\n<p>some function like std::bind</p>\n\n<p>How can I do that in Golang? Are there some more elegant methods to get this work?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1493683151, "post_id": 43727349, "comment_id": 74500015, "body": "I wonder if you might be experiencing <a href=\"https://github.com/golang/go/issues/20160\" rel=\"nofollow noreferrer\">issue 20160</a> fixed recently <a href=\"https://github.com/golang/go/commit/2133d63fa81777315981fbf961338218832e5099\" rel=\"nofollow noreferrer\">commit</a>. Also, does the full stack trace suggest the garbage collector might be involved?"}, {"owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1493768266, "post_id": 43727349, "comment_id": 74540687, "body": "@Mark I think it&#39;s highly possible. Will take a look"}, {"owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1493777546, "post_id": 43727349, "comment_id": 74542533, "body": "@Mark It looks like a fix to my issue.  Do you know how often they merge master into 1.8 release branch?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493818244, "post_id": 43727349, "comment_id": 74564179, "body": "@JFreebird: master doesn&#39;t get merged into old release branches, it&#39;s the next release. You can easily build Go from source and see if it fixes your issue.  Also make sure you&#39;ve pulled the latest commits from the ora.v4 package. Also make sure you&#39;re <i>not</i> using <code>GODEBUG=cgocheck=0</code> as these errors could be caused by incorrect use of Go pointers in cgo."}, {"owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "edited": false, "score": 0, "creation_date": 1493937574, "post_id": 43727349, "comment_id": 74628390, "body": "The thing is I&#39;m running it in Docker.  And I&#39;m just using Go&#39;s official docker image. My local doesn&#39;t have the environment to compile the program. I think it&#39;s not straightforward to build Go into a docker image myself."}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493677182, "creation_date": 1493677182, "question_id": 43727349, "link": "https://stackoverflow.com/questions/43727349/get-c-code-stack-trace-in-go-program", "title": "Get C Code Stack Trace in Go Program", "body": "<p>I'm using the <a href=\"https://github.com/rana/ora\" rel=\"nofollow noreferrer\">rana/ora</a> oracle driver in my Go program to query some Oracle tables.</p>\n\n<p>The program somehow always gets SIGSEGV from a C library after running for a while and exits on segfault. It also gets a lot of query timeouts (<code>context deadline exceeded</code>) before it hits segfault error.</p>\n\n<p>I'm using the driver in a pretty standard way:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), 10*time.Seconds)\ndefer cancel()\nrows, err := initialedDb.QueryContext(ctx, \"sql_query\")\n</code></pre>\n\n<p>The stack trace from the 1st Goroutine is:</p>\n\n<pre><code>fatal error: unexpected signal during runtime execution\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x70 pc=0x7fbb03e5d193]\nruntime stack:\nruntime.throw(0xa4a0a4, 0x2a)\n    /usr/local/go/src/runtime/panic.go:596 +0x95\nruntime.sigpanic()\n    /usr/local/go/src/runtime/signal_unix.go:274 +0x2db\ngoroutine 5230 [syscall, locked to thread]:\nruntime.cgocall(0x921850, 0xc421667348, 0xa495f1)\n    /usr/local/go/src/runtime/cgocall.go:131 +0xe2 fp=0xc421667308 sp=0xc4216672c8\ngopkg.in/rana/ora%2ev4._Cfunc_OCIAttrGet(0x2c92f08, 0x35, 0xc421cb8be4, 0xc421cb8be8, 0x5, 0x2b81930, 0xc400000000)\n    gopkg.in/rana/ora.v4/_obj/_cgo_gotypes.go:347 +0x4d fp=0xc421667348 sp=0xc421667308\ngopkg.in/rana/ora%2ev4.(*Rset).paramAttr.func1(0x2c92f08, 0xc400000035, 0xc421cb8be4, 0xc421cb8be8, 0x5, 0x2b81930, 0xf1ef01)\n    /go/src/gopkg.in/rana/ora.v4/rset.go:970 +0xfc fp=0xc421667390 sp=0xc421667348\ngopkg.in/rana/ora%2ev4.(*Rset).paramAttr(0xc4211f22d0, 0x2c92f08, 0xc421cb8be4, 0xc421cb8be8, 0xc400000005, 0x0, 0x0)\n    /go/src/gopkg.in/rana/ora.v4/rset.go:976 +0x88 fp=0xc4216673e0 sp=0xc421667390\ngopkg.in/rana/ora%2ev4.(*Rset).open(0xc4211f22d0, 0xc421358000, 0x7fbae405ed28, 0x0, 0x0)\n    /go/src/gopkg.in/rana/ora.v4/rset.go:554 +0xd43 fp=0xc421667b98 sp=0xc4216673e0\ngopkg.in/rana/ora%2ev4.(*Stmt).qryC(0xc421358000, 0xf1e940, 0xc421ace900, 0xc421cb8ad0, 0x1, 0x1, 0xc4211f22d0, 0x0, 0x0)\n    /go/src/gopkg.in/rana/ora.v4/stmt.go:442 +0x3e0 fp=0xc421667f18 sp=0xc421667b98\ngopkg.in/rana/ora%2ev4.(*DrvStmt).QueryContext.func1(0xc421b73260, 0xc420e789e8, 0xc420e789e0, 0xf1e940, 0xc421ace900, 0xc421cb8ad0, 0x1, 0x1)\n    /go/src/gopkg.in/rana/ora.v4/drvStmt_go1_8.go:76 +0xa6 fp=0xc421667fa0 sp=0xc421667f18\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:2197 +0x1 fp=0xc421667fa8 sp=0xc421667fa0\ncreated by gopkg.in/rana/ora%2ev4.(*DrvStmt).QueryContext\n    /go/src/gopkg.in/rana/ora.v4/drvStmt_go1_8.go:82 +0x30c\n</code></pre>\n\n<p>I checked my program many times and I don't think I'm causing any memory leaks, double frees or anything like that.</p>\n\n<p>I wonder how I can debug this since Go doesn't give me C's stack trace. Will Valgrind's Memcheck tool help?</p>\n"}, {"tags": ["go", "cmd"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1493684995, "post_id": 43727250, "comment_id": 74500440, "body": "It sounds like you&#39;re running into trouble with the &quot;This file is from another computer&quot; issue on Windows, which sounds odd to me. Have you tried right-clicking the <code>go.exe</code> file and selecting Properties to ensure that the &quot;This file is from another computer&quot; message doesn&#39;t appear? If it does, click the Unblock button next to it and apply the changes. This assumes you have the permissions to make this change, but if it&#39;s on your personal computer or in your user directory, you should be able to do this. If it doesn&#39;t appear, perhaps another &quot;go&quot; program in your PATH is executed instead."}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 2, "creation_date": 1493690412, "post_id": 43727250, "comment_id": 74501569, "body": "Also from the command prompt, try <code>where go</code> to see the location of the <code>go.exe</code>. Does it match with where you installed it?"}, {"owner": {"reputation": 611, "user_id": 4557118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SLhYe.jpg?s=128&g=1", "display_name": "Mullenb", "link": "https://stackoverflow.com/users/4557118/mullenb"}, "edited": false, "score": 0, "creation_date": 1493744981, "post_id": 43727250, "comment_id": 74529977, "body": "Thanks,  I found it under the Compatibility tab in Properties. It seems that &quot;Run this program as an administrator&quot; was checked. Once I unselected this it everything works now."}], "owner": {"reputation": 611, "user_id": 4557118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/SLhYe.jpg?s=128&g=1", "display_name": "Mullenb", "link": "https://stackoverflow.com/users/4557118/mullenb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493676609, "creation_date": 1493676609, "question_id": 43727250, "link": "https://stackoverflow.com/questions/43727250/go-not-running-in-terminal", "title": "Go not running in terminal", "body": "<p>For some reason now, when I try to run my Go code in command prompt my computer first asks me if I want to run this program \"go.exe\" from an unknown publisher.</p>\n\n<p>Then once I hit yes, a separate window flashs open, I assume runs the program, then closes. </p>\n\n<p>I have run different Go code before and never have had this happen to me. </p>\n\n<p>Here is the simple go Hello World code saved under \"test.go\" located in my \"C:\\Users\\\\go\\src\\test\\\"</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello World!\")\n}\n</code></pre>\n\n<p>In the Command Prompt, I write <code>go run test.go</code></p>\n\n<p>Any Go command does the same thing. I can't even run <code>go version</code></p>\n\n<p>How do I get Go to run in the terminal without my computer asking me to run the program every time, and it opening a separate window that I cannot see the results?</p>\n"}, {"tags": ["go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493673922, "post_id": 43726727, "comment_id": 74497219, "body": "this isn&#39;t the code you&#39;re using, because it can&#39;t compile. There&#39;s no reason for <code>GetAllUsers</code> to return a <code>*[]User</code>, just return the slice."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493674463, "post_id": 43726727, "comment_id": 74497446, "body": "You might want to use <code>[]*User</code> so as to avoid copying the user every time you do something like <code>u := users[0]</code>, etc. And in cases like you have in your example you almost never want/need to return a pointer to a slice (<code>*[]User</code>), so just return the slice (<code>[]User</code>/<code>[]*User</code>) like @JimB already mentioned."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493674967, "post_id": 43726727, "comment_id": 74497641, "body": "It compiled fine for me (but I of course also have package names, imports, datastore setup, main function, etc., (didn&#39;t want to paste a hundred lines of code).. but the problem was the <code>*[]User</code>.. after removing the pointer then it works, thanks a lot @mkopriva &lt;3"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493675650, "post_id": 43726727, "comment_id": 74497899, "body": "@fisker: it compiles after you edit it ;) Don&#39;t do &quot;trial and error&quot; to figure out how pointers work, you&#39;re just going to end up in this situation over and over again. Pointers are very simple, just keep working through examples and it should click."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1493676193, "post_id": 43726727, "comment_id": 74498082, "body": "Yeah I did a recheck and noticed the missing &amp;. I feel like I have read so many articles about pointers (and when I read them they make sense), but when I have to implement it myself then I&#39;m not sure when to use and when not to use.. and then it ends up in the frustrating situation where I just try everything and hope something works. I have also gone through so much code on GitHub where they sometimes return function with <code>([]*User, error)</code>, while other times as <code>([]User, error)</code>, and I&#39;ve pretty sure I&#39;ve also seen it as <code>(*[]User, error)</code>"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1493676350, "post_id": 43726727, "comment_id": 74498140, "body": "Similarly, sometimes it&#39;s written as <code>_, err := db.client.GetAll(ctx, query, &amp;users)</code>, other times it&#39;s written as <code>_, err := db.client.GetAll(ctx, query, users)</code> (without the &#39;address of&#39;).. both ways appears to work just fine with <code>var users []User</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493677230, "post_id": 43726727, "comment_id": 74498438, "body": "@fisker: trying to guess what type to use by copying other code isn&#39;t going to work. You need to understand <i>what</i> a pointer is before it can make sense. If you look at the docs, the 3rd argument to <code>GetAll</code> <i>must</i> be a pointer (like any other unmarshal/decode function), whether a <code>&amp;</code> is required simply depends on the type of the variable. <code>[]*User</code>, <code>[]User</code> and <code>*[]User</code> and even <code>*[]*User</code> all have their uses, depending on the context and the type of <code>User</code>, you&#39;re not going to come up with an answer by looking at the syntax of other code, you need to look at <i>why</i>."}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 0, "last_activity_date": 1493678922, "last_edit_date": 1493678922, "creation_date": 1493678562, "answer_id": 43727537, "question_id": 43726727, "link": "https://stackoverflow.com/questions/43726727/function-returning-pointer-to-struct-slice-only-returns-1/43727537#43727537", "title": "function returning pointer to struct slice only returns 1", "body": "<p>Slices include pointers; in fact they are structs with a pointer to an array and some information as to where the slice <em>begins</em> and <em>ends</em>.</p>\n\n<blockquote>\n  <p>A slice is a descriptor of an array segment. It consists of a pointer to the array, the length of the segment, and its capacity (the maximum length of the segment)</p>\n</blockquote>\n\n<ul>\n<li><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Golang blog</a></li>\n</ul>\n\n<p>The asterix before a type designates that type as a pointer (unless it already is a pointer, in that case it <em>dereferences</em> it). I think you probably meant to write <strong><code>[]*User</code></strong>, which will expect a slice of <strong>pointers to Users</strong>. You can think of <code>[]</code> and <code>User</code> as distinct types.</p>\n\n<p>To create a slice, the simplest way is probably with <code>make()</code>;</p>\n\n<p>You can try, instead of <code>var users []User</code>,</p>\n\n<pre><code>users := make([]*User, 0) // replace 0 with the amount of nil values in the slice you're looking to fill\n</code></pre>\n\n<p>Finally, you'll have to remove the <code>&amp;</code> signs you place before <code>users</code>, as these pass the pointer to a value (but as I <em>pointed</em> out above, slices are already pointers)</p>\n\n<hr>\n\n<p>To better understand pointers, Dave Cheney recently wrote a blog post titled <a href=\"https://dave.cheney.net/2017/04/26/understand-go-pointers-in-less-than-800-words-or-your-money-back\" rel=\"nofollow noreferrer\">Understand Go pointers in less than 800 words or your money back</a>, you might find it useful.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493678922, "creation_date": 1493673753, "last_edit_date": 1493674598, "question_id": 43726727, "link": "https://stackoverflow.com/questions/43726727/function-returning-pointer-to-struct-slice-only-returns-1", "title": "function returning pointer to struct slice only returns 1", "body": "<p>I have a function that basically looks like this:</p>\n\n<pre><code>func (db *datastoreDB) GetAllUsers(ctx context.Context) (*[]User, error) {\n  query := datastore.NewQuery(\"User\")\n  var users []User\n  _, err := db.client.GetAll(ctx, query, &amp;users)\n  return &amp;users, nil\n}\n</code></pre>\n\n<p>with the struct:</p>\n\n<pre><code>type User struct {\n  username string\n  password []byte\n}\n</code></pre>\n\n<p>Now, if I try to call</p>\n\n<pre><code>users, err := models.DB.GetAllUsers(ctx)\nlog.Println(users)\n</code></pre>\n\n<p>then it will only print 1 user, even though there are many..</p>\n\n<p>I tried to Print using users[0], users[1] but that returned errors, also tried with *users[1], &amp;users[1], and <code>for i, _ range users { log.Println(users[i]) }</code></p>\n\n<p>Haven't quite been able to understand when/how to use * and &amp; even though I read many online tutorials, so often just do trail and error.. I doubt there is anything wrong with my datastore GetAll function, so I assume I just fail to properly access/return the struct slice but feel like I tried everything..</p>\n"}, {"tags": ["go", "usb"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493679172, "post_id": 43725478, "comment_id": 74499055, "body": "After <code>OpenEndpoint</code>, check and print <code>err</code> first before accessing <code>outEP</code> or writing to the endpoint. I think the parameter <code>1,0,0,1</code> is correct for <code>OUT</code> endpoint."}, {"owner": {"reputation": 982, "user_id": 578847, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8cef08a54f77f1cd6e8ef6509e4e72a2?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/578847/chris"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493734562, "post_id": 43725478, "comment_id": 74523307, "body": "@putu I have edited my original post to include that information."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493768948, "post_id": 43725478, "comment_id": 74540812, "body": "It&#39;s weird. The <code>OpenEndpoint</code> method should be straightforward. Based on the enumeration output,  the endpoint address should be <code>1 (OUT)</code>, and <code>130 (IN)</code>. Please double check that when you call <code>OpenEndpoint</code> method, the endpoint address (fourth parameter) does not contain <code>| uint8(usb.ENDPOINT_DIR_IN)</code>."}, {"owner": {"reputation": 982, "user_id": 578847, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8cef08a54f77f1cd6e8ef6509e4e72a2?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/578847/chris"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493835694, "post_id": 43725478, "comment_id": 74576117, "body": "@putu as I said, I believe I should be sending a 1 (to correspond with the output endpoint), and all that contains is a 1. Given that gousb thinks it&#39;s an out endpoint lends validity to that theory."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493850456, "post_id": 43725478, "comment_id": 74583399, "body": "What is your operating system and CPU arch? The following approaches may be useful for seeking the cause of the problem: (1) Use <a href=\"https://github.com/kr/pretty\" rel=\"nofollow noreferrer\">pretty printing</a> to dump variable of interest and observe carefully, e.g. <code>fmt.Printf(&quot;Printer = %v\\n&quot;, pretty.Formatter(thePrinter))</code>. (2) Use debugger, perform step-by-step/step-into execution. Personally I&#39;m using <a href=\"https://code.visualstudio.com/docs/languages/go\" rel=\"nofollow noreferrer\">Visual Studio Code</a> (<a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"nofollow noreferrer\">Wiki on Debugging using delve</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3941854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2384a26b2d60e644c5966214aa66e508?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Zagrodzki", "link": "https://stackoverflow.com/users/3941854/sebastian-zagrodzki"}, "is_accepted": false, "score": 0, "last_activity_date": 1497347453, "creation_date": 1497347453, "answer_id": 44517997, "question_id": 43725478, "link": "https://stackoverflow.com/questions/43725478/gousb-not-an-out-endpoint/44517997#44517997", "title": "gousb - not an OUT endpoint", "body": "<p>The package github.com/kylelemons/gousb has been deprecated in favor of github.com/google/gousb. Please note that the new package has a slightly different API - we think it should be less confusing.</p>\n\n<p>That being said, your call with OpenEndpoint(1,0,0,1) looks correct - it should set configuration #1 on the device, claim interface #0 with alt setting #0 and then return a representation of an endpoint with address 0x01, which is an OUT endpoint. Looking at the gousb code, I can't find any obvious issues. You can try again with the current head of the package from github, and if it still returns EP address 130 (0x82) after OpenEndpoint(1,0,0,1), please file an issue on github, this definitely should not be happening.</p>\n"}], "owner": {"reputation": 982, "user_id": 578847, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8cef08a54f77f1cd6e8ef6509e4e72a2?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/578847/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1497347453, "creation_date": 1493668182, "last_edit_date": 1493918241, "question_id": 43725478, "link": "https://stackoverflow.com/questions/43725478/gousb-not-an-out-endpoint", "title": "gousb - not an OUT endpoint", "body": "<p>I'm new to the go programming language. Trying to use <a href=\"https://github.com/kylelemons/gousb\" rel=\"nofollow noreferrer\">gousb</a> to access an epson receipt printer. </p>\n\n<p>So I took some example code from the repo and repurposed it a bit just to validate that I could access the printer. </p>\n\n<p>I can see the printer and enumerate the endpoints. I receive this output:</p>\n\n<pre><code>Printer found: 020.005 Receipt Printer M129C/TM-T70 (Seiko Epson Corp.)\nLength of device array: 1\n[0] 020.005 04b8 - 0202\n  [0] Config 01 [1]\n    [0]--------------[0]\n    [0] Interface 00 Setup 00 [0]\n      Vendor Specific Class (Vendor Specific Subclass)\n      [0] [1] Endpoint #1 OUT bulk - unsynchronized data [64 0] [OUT]\n      [1] [130] Endpoint #2 IN  bulk - unsynchronized data [64 0] [IN]\n</code></pre>\n\n<p>My understanding is that if I want to write something to the printer, I would open the endpoint that corresponds to [OUT]. Aand this is where my trouble begins.</p>\n\n<p>If I use <code>outEP, err := thePrinter.OpenEndpoint(1,0,0,0)</code>, I receive a seg fault. If I pass a 1, gousb assumes I'm trying to access endpoint 130 [IN].</p>\n\n<p>So.. What do I pass as the endpoint ID to access the OUT endpoint?</p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"strings\"\n\n        \"github.com/kylelemons/gousb/usb\"\n        \"github.com/kylelemons/gousb/usbid\"\n\n        \"C\"\n)\n\nfunc main() {\n  ctx := usb.NewContext()\n  defer ctx.Close()\n\n\n  ctx.Debug(3)\n\n  var thePrinter *usb.Device\n\n  devs, _ := ctx.ListDevices(func(desc *usb.Descriptor) bool {\n    if strings.Contains(usbid.Describe(desc), \"Seiko Epson Corp\") {\n      fmt.Printf(\"Printer found: %03d.%03d %s\\n\", desc.Bus, desc.Address, usbid.Describe(desc))\n      return true\n    } else {\n      return false\n    }\n\n  })\n\n  fmt.Printf(\"Length of device array: %d\\n\", len(devs))\n\n  for x, dev := range devs {\n    fmt.Printf(\"[%d] %03d.%03d %s - %s\\n\", x, dev.Bus, dev.Address, dev.Vendor, dev.Product)\n\n    for i, cfg := range dev.Configs {\n      // This loop just uses more of the built-in and usbid pretty printing to list\n      // the USB devices.\n      fmt.Printf(\"  [%d] %s [%d]\\n\", i, cfg, cfg.Config)\n      for j, alt := range cfg.Interfaces {\n        fmt.Printf(\"    [%d]--------------[%d]\\n\", j, alt.Number)\n        for k, iface := range alt.Setups {\n          fmt.Printf(\"    [%d] %s [%d]\\n\", k, iface, iface.Number)\n          fmt.Printf(\"      %s\\n\", usbid.Classify(iface))\n          for l, end := range iface.Endpoints {\n            fmt.Printf(\"      [%d] [%d] %s [%s]\\n\", l, end.Address, end, end.Direction() )\n          }\n        }\n      }\n      fmt.Printf(\"    --------------\\n\")\n    }\n\n\n\n    thePrinter=dev\n  }\n\n  outEP, err := thePrinter.OpenEndpoint(1,0,0,1)\n\n  fmt.Printf(\"OpenEndpoint Err: [%s]\\n\", err)\n\n  fmt.Printf(\"direction: [%s] %d\\n\", outEP.Info().Direction(), outEP.Info().Address)\n\n  message := []byte(\"hi there!\\n\")\n\n  _, outerr := outEP.Write(message)\n\n  fmt.Printf(\"write Err: [%s]\", outerr)\n\n}\n</code></pre>\n\n<p>EDIT: I was asked to examine the error returned by OpenEndpoint prior to looking at the value of the endpoint. Here is what was returned (it was nil)</p>\n\n<pre><code>OpenEndpoint Err: [%!s(&lt;nil&gt;)]\ndirection: [IN] 130\nOpenEndpoint Err: [%!s(&lt;nil&gt;)]\nlibusb: warning [libusb_exit] application left some devices open\nwrite Err: [usb: write: not an OUT endpoint]\n[Finished in 1.512s]\n</code></pre>\n\n<p>This is what I receive when I send an endpoint number of zero:</p>\n\n<pre><code>OpenEndpoint Err: [usb: unknown endpoint 00]\nlibusb: warning [libusb_exit] application left some devices open\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x20 pc=0x41e94c4]\n\ngoroutine 1 [running]:\nmain.main()\n    /Users/.../go/src/github.com/deltasonic/epson/main.go:63 +0xcb4\nexit status 2\n[Finished in 0.817s]\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>I'm attempting this on a mac, Mac OS 10.12.</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493667634, "post_id": 43725078, "comment_id": 74494383, "body": "Can you show your code in <code>main.go:90</code>? or which ever line it is that is calling <code>revel.RegisterController</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493668061, "post_id": 43725078, "comment_id": 74494599, "body": "Not sure why you&#39;re passing in <code>nil</code> as the controller but that is why it&#39;s breaking. <code>reflect: call of reflect.Value.Type on zero Value</code> in your case <code>(*controllers0.Jobs)(nil)</code> is the <b>zero Value</b>."}, {"owner": {"reputation": 530, "user_id": 978927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/daf1ffb2144fd84fe8f39b36d75996bc?s=128&d=identicon&r=PG", "display_name": "Puzzle84", "link": "https://stackoverflow.com/users/978927/puzzle84"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493668266, "post_id": 43725078, "comment_id": 74494698, "body": "Not aware i&#39;m passing anything into the controller. all i&#39;m doing is enabling the module and restarting revel."}, {"owner": {"reputation": 530, "user_id": 978927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/daf1ffb2144fd84fe8f39b36d75996bc?s=128&d=identicon&r=PG", "display_name": "Puzzle84", "link": "https://stackoverflow.com/users/978927/puzzle84"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493668385, "post_id": 43725078, "comment_id": 74494743, "body": "it works for other controllers just fine."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493669029, "post_id": 43725078, "comment_id": 74495058, "body": "My bad, I see now that that&#39;s how you register controllers in revel, please ignore me."}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 978927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/daf1ffb2144fd84fe8f39b36d75996bc?s=128&d=identicon&r=PG", "display_name": "Puzzle84", "link": "https://stackoverflow.com/users/978927/puzzle84"}, "is_accepted": true, "score": 0, "last_activity_date": 1495561957, "creation_date": 1495561957, "answer_id": 44141804, "question_id": 43725078, "link": "https://stackoverflow.com/questions/43725078/revel-doesnt-start-when-i-enable-module-jobs/44141804#44141804", "title": "Revel doesn&#39;t start when i enable module.jobs", "body": "<p>Apparently this was because i was vendoring in half of the packages. i didn't have the entire modules repo vendored in, after fixing that it worked.</p>\n\n<p>Jobs got enabled without having it in the config file though.\nall i had to do was create a jobs folder and a go file that had the job in it.</p>\n"}], "owner": {"reputation": 530, "user_id": 978927, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/daf1ffb2144fd84fe8f39b36d75996bc?s=128&d=identicon&r=PG", "display_name": "Puzzle84", "link": "https://stackoverflow.com/users/978927/puzzle84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 44141804, "answer_count": 1, "score": 0, "last_activity_date": 1495561957, "creation_date": 1493666278, "last_edit_date": 1493667975, "question_id": 43725078, "link": "https://stackoverflow.com/questions/43725078/revel-doesnt-start-when-i-enable-module-jobs", "title": "Revel doesn&#39;t start when i enable module.jobs", "body": "<p>I get below error when i enable module.jobs in app.conf\nTried redownloading the modules package.</p>\n\n<p>Vendored in the cron package. no avail.</p>\n\n<pre><code>INFO 2017/05/01 18:51:12 main.go:32: Running revel server\npanic: reflect: call of reflect.Value.Type on zero Value\n\ngoroutine 1 [running]:\npanic(0xbd1b00, 0xc4201e7c20)\n/usr/local/go/src/runtime/panic.go:500 +0x1a1\nreflect.Value.Type(0x0, 0x0, 0x0, 0x0, 0x0)\n/usr/local/go/src/reflect/value.go:1670 +0x224\ngithub.com/company/project/vendor/github.com/revel/revel.findControllers(0x137d2c0, 0xcaba60, 0xc4202a26e0, 0x4, 0x10)\n/root/git/go/src/github.com/company/project/vendor/github.com/revel/revel/controller.go:329 +0x9f2\ngithub.com/company/projectvendor/github.com/revel/revel.RegisterController(0xca73e0, 0x0, 0xc420028118, 0x1, 0x1)\n/root/git/go/src/github.com/company/project/vendor/github.com/revel/revel/controller.go:414 +0x219\nmain.main()\n/root/git/go/src/github.com/company/project/web/app/tmp/main.go:90 +0xbd0\n</code></pre>\n\n<p>It doesn't even get to my init section of the app.\nThe second I disable the module.jobs line in app.conf revel works fine.</p>\n\n<p>EDIT Line 90</p>\n\n<pre><code> revel.RegisterController((*controllers0.Jobs)(nil),\n    []*revel.MethodType{\n        &amp;revel.MethodType{\n            Name: \"Status\",\n            Args: []*revel.MethodArg{\n            },\n            RenderArgNames: map[int][]string{\n                28: []string{\n                    \"entries\",\n                },\n            },\n        },\n\n    })\n</code></pre>\n"}, {"tags": ["go", "concurrency", "deadlock"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493663833, "post_id": 43724439, "comment_id": 74492597, "body": "You never close <code>evaluated</code>, so that for-range loop never terminates"}, {"owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493663935, "post_id": 43724439, "comment_id": 74492635, "body": "Wow, man. That did it. Thanks!"}], "owner": {"reputation": 18919, "user_id": 891440, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/dd366bcdcf85991fa8af1b6d11d3ad49?s=128&d=identicon&r=PG", "display_name": "jjmerelo", "link": "https://stackoverflow.com/users/891440/jjmerelo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "closed_date": 1493663903, "answer_count": 0, "score": 0, "last_activity_date": 1506535345, "creation_date": 1493663720, "last_edit_date": 1506535345, "question_id": 43724439, "link": "https://stackoverflow.com/questions/43724439/working-with-two-goroutines-and-still-getting-a-deadlock", "closed_reason": "Duplicate", "title": "Working with two goroutines... and still getting a deadlock", "body": "<p>I have been trying to make this work without erroring:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"math/rand\"\n    \"github.com/JJ/go-onemax\"\n    \"sync\"\n)\n\ntype eval_chromosome struct {\n    chromosome string\n    fitness  int\n}\n\n\n// Check out https://gobyexample.com/command-line-arguments\nvar wg sync.WaitGroup \nfunc main() {\n    start := time.Now()\n    chromosomes := make( chan string, 100 )\n    evaluated := make( chan *eval_chromosome, 100 )\n    for i := 0; i &lt; 100; i ++ {\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            this_chromosome := random_chromosome( 10000 )\n            chromosomes &lt;- this_chromosome\n        }()\n\n        wg.Add(1)\n        go func() {\n            defer wg.Done()\n            this_chromosome := &lt;- chromosomes\n            this_evaluated := &amp;eval_chromosome{ chromosome: this_chromosome,\n                fitness: CountOnes.Count( this_chromosome ) }\n            evaluated &lt;- this_evaluated\n        }()\n    }\n\n    wg.Wait()\n    i:= 1\n    for result := range evaluated {\n        fmt.Printf(\"%d =&gt; %d\\n\", i, result.fitness )\n        i++\n\n    }\n    fmt.Println(\"Time \", time.Since(start).Seconds())\n}\n\nfunc random_chromosome( length int ) string {\n    chromosome := \"\"\n    for i:= 0; i  &lt; length; i ++  {\n        if ( rand.Float32() &lt; 0.5 ) {\n            chromosome+= \"1\"\n        } else {\n            chromosome+= \"0\"\n        }\n    }\n    return chromosome\n}\n</code></pre>\n\n<p>What this code does is generate random boolean strings, write them to a channel, with another channel reading the strings and counting the number of ones. </p>\n\n<p>I have used a WaitGroup, incrementing it by one every time I call a goroutine, and using <code>defer</code> inside it. It does its job: arrives to the part where the result is printed, but then it says</p>\n\n<pre><code>100 =&gt; 5033\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [chan receive]:\nmain.main()\n    /home/jmerelo/Tutoriales/go-now/code/src/count-many-ones/count-many-ones.go:44 +0x1bf\nexit status 2\n</code></pre>\n\n<p>closing the channels also does nothing. Going unbuffered produces lots of errors. Changing the buffer size does nothing. </p>\n\n<p>Any idea of what is going wrong here?</p>\n\n<p><em>Edit</em>: The example is a bit more complex than the one mentioned here: <a href=\"https://stackoverflow.com/questions/34519546/all-go-routines-are-asleep-deadlock\">all go routines are asleep - deadlock</a> . There are two channels, and that one is not using the WaitGroups as indicated in the answer checked above. In fact, as indicated above, closing channels was tested, but only <em>after</em> doing the reading, since I thought (wrongly) that closing channels effectively destroyed it. The answer provided by JimB was really helpful, though. </p>\n"}, {"tags": ["testing", "go", "tdd"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1493663706, "post_id": 43724264, "comment_id": 74492519, "body": "Why does it seem out of the question to you? I think it&#39;s perfectly fine to declare a new interface that is implemented by <code>redis.Pipeline</code> and have your <code>RedisClient.TxPipeline</code> method return that interface instead of <code>redis.Pipeline</code>."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1520549058, "post_id": 43724264, "comment_id": 85373330, "body": "What conclusion did you ultimately come to? I have a similar dilemma."}, {"owner": {"reputation": 847, "user_id": 2851750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d224b1e5e20c21967d792608b295204?s=128&d=identicon&r=PG&f=1", "display_name": "cejast", "link": "https://stackoverflow.com/users/2851750/cejast"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1520553497, "post_id": 43724264, "comment_id": 85374829, "body": "@Lansana My approach is essentially as below, with integration tests covering interactions with any dependencies. For something non-specific to Redis, or anything that can&#39;t be tested with an integration test as such, mkopriva&#39;s suggestion also works."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1520553852, "post_id": 43724264, "comment_id": 85374911, "body": "Care to share a dummy example of your Redis implementation?"}], "answers": [{"comments": [{"owner": {"reputation": 847, "user_id": 2851750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d224b1e5e20c21967d792608b295204?s=128&d=identicon&r=PG&f=1", "display_name": "cejast", "link": "https://stackoverflow.com/users/2851750/cejast"}, "edited": false, "score": 0, "creation_date": 1493670999, "post_id": 43725637, "comment_id": 74495937, "body": "The implementation of <code>UserStore</code> and how it interacts with redis is ultimately what I&#39;m trying to test - for example, I want to assert that if an error is returned by redis, then this error is handled correctly. This is why I&#39;m trying to mock out the redis client."}, {"owner": {"reputation": 2336, "user_id": 1826232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DldsJ.png?s=128&g=1", "display_name": "Asdine", "link": "https://stackoverflow.com/users/1826232/asdine"}, "reply_to_user": {"reputation": 847, "user_id": 2851750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d224b1e5e20c21967d792608b295204?s=128&d=identicon&r=PG&f=1", "display_name": "cejast", "link": "https://stackoverflow.com/users/2851750/cejast"}, "edited": false, "score": 0, "creation_date": 1493671442, "post_id": 43725637, "comment_id": 74496167, "body": "Testing each implementation of <code>UserStore</code> requires using no mocks IMO but making actual calls because even if you are mocking you can&#39;t be sure that your implementation will work the same way without mock (imagine how hard it would be with PostgreSQL). This approach gives you the flexibility to isolate the actual Redis tests from the rest of your code which would be able to only work with a mock <code>UserStore</code>."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 847, "user_id": 2851750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d224b1e5e20c21967d792608b295204?s=128&d=identicon&r=PG&f=1", "display_name": "cejast", "link": "https://stackoverflow.com/users/2851750/cejast"}, "edited": false, "score": 0, "creation_date": 1493672277, "post_id": 43725637, "comment_id": 74496532, "body": "@cejast Asdine&#39;s code example is definitely the way you&#39;re gonna want to go, as it&#39;s a clean design. You can still follow his recommendation for using mocks, etc. for testing. If you want to test how YOUR code interacts with an error from the Redis client, simply return an error from your mock client. If you want to test that your code will actually work with a real instance of Redis, you will have to write an integration test or two."}], "tags": [], "owner": {"reputation": 2336, "user_id": 1826232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DldsJ.png?s=128&g=1", "display_name": "Asdine", "link": "https://stackoverflow.com/users/1826232/asdine"}, "is_accepted": true, "score": 5, "last_activity_date": 1493669168, "last_edit_date": 1493669168, "creation_date": 1493668781, "answer_id": 43725637, "question_id": 43724264, "link": "https://stackoverflow.com/questions/43724264/testing-mocking-3rd-party-packages-in-golang/43725637#43725637", "title": "Testing/mocking 3rd party packages in Golang", "body": "<p>One approach would be to create a type that focuses on what you want to accomplish instead on what methods of the client you are using.</p>\n\n<p>Let's say all you want is a storage to save and fetch users, you could imagine an interface like this:</p>\n\n<pre><code>type UserStore interface {\n  SaveUser(*User) error\n  GetUserByID(id string) (*User, error)\n  SearchUsers(query string) ([]User, error)\n}\n</code></pre>\n\n<p>You could then implement a Redis version of this storage and call whatever client methods you want inside, it doesn't matter. You can even implement one in PostgreSQL or whatever.\nAlso, mocking is way easier with this approach since you all you need to do is to implement this interface instead of the Redis one.</p>\n\n<p>Here is an example of a mock version of this interface:</p>\n\n<pre><code>type UserStoreMock struct {\n  SaveUserFn func (*User) error\n  SaveUserInvoked bool\n  ...\n}\n\nfunc (m *UserStoreMock) SaveUser(u *User) error {\n  m.SaveUserInvoked = true\n\n  if m.SaveUserFn != nil {\n    return m.SaveUserFn(u)\n  }\n\n  return nil\n}\n...\n</code></pre>\n\n<p>You can then use this mock in tests like this:</p>\n\n<pre><code>var m UserStoreMock\n\nm.SaveUserFn = func(u *User) error {\n  if u.ID != \"123\" {\n    t.Fail(\"Bad ID\")\n  }\n\n  return ErrDuplicateError\n}\n...\n</code></pre>\n"}], "owner": {"reputation": 847, "user_id": 2851750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d224b1e5e20c21967d792608b295204?s=128&d=identicon&r=PG&f=1", "display_name": "cejast", "link": "https://stackoverflow.com/users/2851750/cejast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2592, "favorite_count": 3, "accepted_answer_id": 43725637, "answer_count": 1, "score": 3, "last_activity_date": 1493669168, "creation_date": 1493663008, "question_id": 43724264, "link": "https://stackoverflow.com/questions/43724264/testing-mocking-3rd-party-packages-in-golang", "title": "Testing/mocking 3rd party packages in Golang", "body": "<p>I'm new to Golang and have been taking a TDD approach while learning the language. I've been getting along okay yet I find testing third party packages quite clunky, which leads me to believe that I've been taking the wrong approach.</p>\n\n<p>The specific case I'm having trouble with is mocking a <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">Redis client</a> for error handling. The approach I've taken is to create my own interface, and the implementation wraps the clients methods that I want to use.</p>\n\n<pre><code>type Redis interface {\n    Get(key string) (string, error)\n}\n\ntype RedisClient struct {\n    client *redis.Client\n}\n\nfunc (redisClient *RedisClient) New(client *redis.Client) *RedisClient {\n    redisClient.client = client\n\n    return redisClient\n}\n\nfunc (redisClient *RedisClient) Get(key string) (string, error) {\n    return redisClient.client.Get(key).Result()\n}\n</code></pre>\n\n<p>I can then create a mock which implements that same interface to return whichever values I specify, particularly for testing error handling.</p>\n\n<p>I've hit a roadblock where a specific method on the client to <a href=\"https://godoc.org/github.com/go-redis/redis#Client.TxPipeline\" rel=\"nofollow noreferrer\">perform transactions</a> (MULTI) returns another interface belonging to that package. What would I do in this scenario? Implementing that interface myself seems out of the question.</p>\n\n<p>Similarly, as usage of this client grows, my own implementation can grow to the point that it implements the whole interface to Redis - this seems to go against the whole idea of delegating this out to an external dependency.</p>\n\n<p>Is there a better way to test third-party packages like this, for things such as error handling?</p>\n"}, {"tags": ["html", "css", "go", "filepath"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493662652, "post_id": 43724122, "comment_id": 74491971, "body": "The location of the html assets shouldn&#39;t have any relation to the Go source code."}], "answers": [{"comments": [{"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493663461, "post_id": 43724178, "comment_id": 74492406, "body": "&quot;Serve all files inside &quot;content&quot; (relative to where you are running app from) at /content/*&quot;  But if i do this, then every request that comes in will be redirected to the <code>&#47;content&#47;</code> folder. But i don&#39;t want this. the content folder only contains the <code>css</code> and <code>js</code> files."}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493663799, "post_id": 43724178, "comment_id": 74492577, "body": "Also, this does&#39;t explain with i can&#39;t access the <code>html</code> files from the <code>Constants.go file</code>. Its even weirder that it works for other people on my team but not me"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493664100, "post_id": 43724178, "comment_id": 74492708, "body": "I see. Clarified some. If you could post your <code>http.Handlexxx</code> lines it would help."}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493664992, "post_id": 43724178, "comment_id": 74493121, "body": "Just did. I am using a lot of external libraries, like the julian schmidt router."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493665076, "post_id": 43724178, "comment_id": 74493157, "body": "Not seeing what handler would be serving anything from /content"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493665163, "post_id": 43724178, "comment_id": 74493194, "body": "Also, what command are you using to run your app? What is your working dir?"}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1493668199, "post_id": 43724178, "comment_id": 74494664, "body": "I just posted the handler. Also, i&#39;m in the <code>c:&#47;projectname&#47;src&#47;web&#47;</code> folder. That is where my <code>main.go</code> file is located. So i just run <code>go run main.go</code> to run the app"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1493664068, "last_edit_date": 1493664068, "creation_date": 1493662643, "answer_id": 43724178, "question_id": 43724122, "link": "https://stackoverflow.com/questions/43724122/go-open-src-web-views-index-htm-the-system-cannot-find-the-path-specified/43724178#43724178", "title": "Go: open ../src/web/views/index.htm: The system cannot find the path specified", "body": "<p>We need to see the code you are using to host the files to be sure, but usually what I will do to serve a directory is this:</p>\n\n<p><code>http.Handle(\"/content/\", http.StripPrefix(\"/content/\", http.FileServer(http.Dir(\"content\"))</code></p>\n\n<p>This will:</p>\n\n<ul>\n<li>Serve all files inside \"content\" (relative to where you are running app from) at <code>/content/*</code></li>\n<li>Strip (\"/content\") from the front of all urls before looking up the file in that dir.</li>\n</ul>\n\n<p>I try to put all static files in a common directory to make this easier.</p>\n\n<p>My guess is you are just doing <code>http.Handle(\"/\", http.Fileserver(http.Dir(\"\"))</code> or something, which just serves all files at their paths relative to the working dir.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>In go apps, you have to specify the path for each handler. You need to either move the files to match the urls you want, or define multiple url mappings. I would usually recommend handlers in this setup:</p>\n\n<ol>\n<li><p>API handlers under <code>/api</code> defined one at a time (<code>http.HandleFunc(\"/api/whatever\", myHandler)</code>)</p></li>\n<li><p>All Static content served from <code>/static/*</code> from a single directory. (First line in answer above). So <code>/content/css/style.css</code> serves <code>./content/css/style.css</code></p></li>\n<li><p>Anything else serves \"index.html\". <code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request){ http.ServeFile(w,r,\"path/to/index.html\") }</code></p></li>\n</ol>\n"}], "owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493668084, "creation_date": 1493662370, "last_edit_date": 1493668084, "question_id": 43724122, "link": "https://stackoverflow.com/questions/43724122/go-open-src-web-views-index-htm-the-system-cannot-find-the-path-specified", "title": "Go: open ../src/web/views/index.htm: The system cannot find the path specified", "body": "<p>So i am having strange file path issues in Go. Here is what my file structure looks like.</p>\n\n<pre><code>C:/ProjectName/\n--------------&gt;bin/\n--------------&gt;pkg/\n--------------&gt;src/web/\n----------------------&gt;main.go\n----------------------&gt;controllers/Constants.go\n----------------------&gt;content/css/index.css\n----------------------&gt;views/index.html\n</code></pre>\n\n<p>My go enviroment variables</p>\n\n<pre><code>GOBIN=C:\\ProjectName\\bin\nGOPATH=C:\\ProjectName\n</code></pre>\n\n<p>In the file <code>index.html</code>, i access the css file like so <code>&lt;link href=\"/css/index.css\"...</code> but this doesn't work. The <code>css</code> file is not found.<br>\nAlso in the <code>Constants.go</code> file i access the <code>html</code> file like so <code>const indexFile string = \"../src/web/views/index.htm\"</code> but this also doesn't work. </p>\n\n<p>If i access the <code>css</code> file like this <code>/content/css/index.css</code> it works, and if i access the <code>index.html</code>file like this <code>\"../web/views/index.htm\"</code> it also works. </p>\n\n<p>The problem is that i am on a team, and everybody else's code works in the way that doesn't work on my computer. And every time i make the changes to make it run on my computer, it breaks on every other persons computer.</p>\n\n<p>Any idea on what the problem could be and how to get about fixing it?</p>\n\n<p>Thank you,</p>\n\n<p>EDIT 1: My handlers</p>\n\n<pre><code>router := httprouter.New()\nrouter.GET(basic(\"/\", IndexFunc))\n\nfunc basic(p string, h func(http.ResponseWriter, *http.Request)) (string, \nhttprouter.Handle) {\n\n    return p, wrapHandler(alice.New(context.ClearHandler).ThenFunc(h))\n}\n\nfunc IndexFunc(w http.ResponseWriter, r *http.Request) \n{    \n    t, err := template.ParseFiles(\"../src/web/views/index.htm\")\n    checkError(err)\n    t.Execute(w, nil)\n}\n</code></pre>\n\n<p>alice -> <a href=\"https://github.com/justinas/alice\" rel=\"nofollow noreferrer\">https://github.com/justinas/alice</a>\ncontext -> <a href=\"https://github.com/gorilla/context\" rel=\"nofollow noreferrer\">https://github.com/gorilla/context</a>\nfunction <code>indexFunc</code> just serves the <code>index.html</code> file.</p>\n"}, {"tags": ["regex", "go", "regex-negation"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7938795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd49da4ff8a968b9a0246f2c1ab378b6?s=128&d=identicon&r=PG&f=1", "display_name": "jack_017", "link": "https://stackoverflow.com/users/7938795/jack-017"}, "edited": false, "score": 0, "creation_date": 1493664245, "post_id": 43723945, "comment_id": 74492770, "body": "thanks for your explanation but I am getting error regarding  unsupported Perl syntax <code>(?!</code>. Is there any workaround for that?"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 45, "user_id": 7938795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd49da4ff8a968b9a0246f2c1ab378b6?s=128&d=identicon&r=PG&f=1", "display_name": "jack_017", "link": "https://stackoverflow.com/users/7938795/jack-017"}, "edited": false, "score": 0, "creation_date": 1493664894, "post_id": 43723945, "comment_id": 74493069, "body": "Are you sure you are using Java <code>java.util.regex</code>? What is the regex flavor?"}, {"owner": {"reputation": 45, "user_id": 7938795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd49da4ff8a968b9a0246f2c1ab378b6?s=128&d=identicon&r=PG&f=1", "display_name": "jack_017", "link": "https://stackoverflow.com/users/7938795/jack-017"}, "edited": false, "score": 0, "creation_date": 1493665155, "post_id": 43723945, "comment_id": 74493184, "body": "Oh it&#39;s for Go, my bad"}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "reply_to_user": {"reputation": 45, "user_id": 7938795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd49da4ff8a968b9a0246f2c1ab378b6?s=128&d=identicon&r=PG&f=1", "display_name": "jack_017", "link": "https://stackoverflow.com/users/7938795/jack-017"}, "edited": false, "score": 1, "creation_date": 1493665682, "post_id": 43723945, "comment_id": 74493429, "body": "@jack_017: It is a really bad &quot;bad&quot; since Go does not support <i>any</i> lookarounds. See the updated answer with a workaround suggestion. I do not mean there is no way to use a regex here, but it will be a veeeery long unreadable regex."}], "tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1493665642, "last_edit_date": 1493665642, "creation_date": 1493661642, "answer_id": 43723945, "question_id": 43723905, "link": "https://stackoverflow.com/questions/43723905/go-regex-to-match-all-lines-that-dont-start-with-timestamp/43723945#43723945", "title": "Go regex to match all lines that don&#39;t start with timestamp", "body": "<p>Your <code>^(^[0-9]{4}-[0-9]{2}-[0-9]{2})</code> pattern matches a string starting with the pattern you defined (the <code>^</code> here just matches the start of a string).</p>\n\n<p>In Go lang, the regex engine does not support lookarounds, and thus it is difficult to create a readable regex that would do the required job. </p>\n\n<p>I suggest you remove all lines that match your pattern</p>\n\n<pre><code>(?m)\\s*^[0-9]{4}-[0-9]{2}-[0-9]{2}.*\n</code></pre>\n\n<p>(<a href=\"https://regex101.com/r/oaYqfT/3\" rel=\"nofollow noreferrer\">see demo</a>) and then split the result with line breaks to get the lines that did not match the pattern.</p>\n"}], "owner": {"reputation": 45, "user_id": 7938795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd49da4ff8a968b9a0246f2c1ab378b6?s=128&d=identicon&r=PG&f=1", "display_name": "jack_017", "link": "https://stackoverflow.com/users/7938795/jack-017"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "accepted_answer_id": 43723945, "answer_count": 1, "score": 3, "last_activity_date": 1493665642, "creation_date": 1493661479, "last_edit_date": 1493665188, "question_id": 43723905, "link": "https://stackoverflow.com/questions/43723905/go-regex-to-match-all-lines-that-dont-start-with-timestamp", "title": "Go regex to match all lines that don&#39;t start with timestamp", "body": "<p>Can anybody explain what the correct Java regex is to match all lines that don't start with timestamp <code>[0-9]{4}-[0-9]{2}-[0-9]{2}</code>?</p>\n\n<p>I am trying to use <code>^(^[0-9]{4}-[0-9]{2}-[0-9]{2})</code> but it doesn't work.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1442, "user_id": 511571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9bb95084db9503663a58efaa8cd4978?s=128&d=identicon&r=PG", "display_name": "Virtually Real", "link": "https://stackoverflow.com/users/511571/virtually-real"}, "edited": false, "score": 1, "creation_date": 1493671493, "post_id": 43723618, "comment_id": 74496191, "body": "While it is sufficient for my case, it is worth noting that go allows multiple imports of the same package, thereby making circumventing this scheme, somewhat easy. Nothing other than a review to prevent someone from re-declaring <code>_ &quot;errors&quot;</code> on another line as <code>&quot;errors&quot;</code>"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 0, "last_activity_date": 1493660704, "last_edit_date": 1493660704, "creation_date": 1493660311, "answer_id": 43723618, "question_id": 43723564, "link": "https://stackoverflow.com/questions/43723564/poisoning-a-package-function-in-go/43723618#43723618", "title": "Poisoning A Package/Function in GO", "body": "<p>If you're only concerned with a packages use within a file, you could import it under a silly name, like 'NEVER'... and people could use it, but they'd get the idea I think.</p>\n\n<pre><code> import (\n      NEVER \"fmt\"\n )\n</code></pre>\n\n<p>OR, if you want to be less silly, you could use the <code>_</code> underscore, <a href=\"https://golang.org/doc/effective_go.html#blank_import\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#blank_import</a></p>\n\n<pre><code>import (\n    _ \"fmt\"\n)\n</code></pre>\n\n<p>which will load the import, but only it's side effects (that is, not for explicit use.</p>\n\n<hr>\n\n<p>To stop the input of all errors not of a certain type, you could use <code>reflect</code> in order to stop the undesirable types with type assertion, <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Type_assertions</a></p>\n\n<pre><code>v, ok = x.(T)\n</code></pre>\n\n<p>So if an <code>err</code> comes up in the public facing function, that you don't want passed through, check what kind of error it is,</p>\n\n<pre><code> specialError, ok := err.(mypackage.ErrorType)\n    if !ok {\n        // don't send this error on\n    } \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1493663100, "creation_date": 1493663100, "answer_id": 43724291, "question_id": 43723564, "link": "https://stackoverflow.com/questions/43723564/poisoning-a-package-function-in-go/43724291#43724291", "title": "Poisoning A Package/Function in GO", "body": "<p>If you really want to enforce it, you could do a build step that checks the output of <a href=\"https://golang.org/cmd/go/#hdr-List_packages\" rel=\"nofollow noreferrer\"><code>go list</code></a> for all of your packages, and make sure <code>fmt</code> and <code>errors</code> are not in the list of direct imports. With such common packages though, it could be difficult to avoid altogether. You could do more detailed parsing to detect <code>fmt.Errorf</code> or whatever, but could be tricky.</p>\n\n<p>A more invasive solution would be modifying package source for those packages and forcing devs to use your custom go distribution. Probably too hard to pull off for the <code>fmt</code> and <code>errors</code> packages that are used literally everywhere in the std lib, but it may work for other packages. I would never recommend it though. Definitely add it as a build-time validation that runs on checkins and PRs and things.</p>\n"}], "owner": {"reputation": 1442, "user_id": 511571, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c9bb95084db9503663a58efaa8cd4978?s=128&d=identicon&r=PG", "display_name": "Virtually Real", "link": "https://stackoverflow.com/users/511571/virtually-real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 43723618, "answer_count": 2, "score": 1, "last_activity_date": 1493663100, "creation_date": 1493660069, "question_id": 43723564, "link": "https://stackoverflow.com/questions/43723564/poisoning-a-package-function-in-go", "title": "Poisoning A Package/Function in GO", "body": "<p>TLDR: Is there a way in golang (even if it is a bit non-standard), to \"poison\" a function or import of a certain package altogether.</p>\n\n<p>The longer version: I am writing a thrift service, which all public facing functions return results, or an error of a certain type, declared in the thrift file. The code generator generates code for the interface like this:</p>\n\n<pre><code>publicFacingFunc(...) (returnType, error)\n</code></pre>\n\n<p>This would be great, until someone I am working with decides to check for another condition, and when that condition is not met does something like this:</p>\n\n<pre><code>if conditionIsNotMet {\n    return nil, errors.New(...)\n}\n</code></pre>\n\n<p>The code compiles, but when the error arises, the received message is undocumented random string. So in these files, I want to prevent usage of \"errors\" and \"fmt\" packages.</p>\n\n<p>And yes, I tried, and still have I a blaring warning at the top of the file, but nobody seems to read.</p>\n\n<p>BTW, the public errors all have a respective \"constructor\", which is external to these files, and only those should be used, in my case.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1493668886, "post_id": 43723126, "comment_id": 74494997, "body": "Other people will experience this same error when they attempt to follow the instructions on the Golang Appengine site. While the solution may be the same, a newb probably won&#39;t find it."}], "answers": [{"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1493668816, "post_id": 43723292, "comment_id": 74494963, "body": "That is an very hacky solution.  I wish Google did a better job of keeping their repositories and Tutorial info both current."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 1, "creation_date": 1493669311, "post_id": 43723292, "comment_id": 74495190, "body": "Hacky for sure, but it&#39;s the only way with a canonical import path defined.  However, if you&#39;re using a vendoring tool (like Govendor), most let you define an alternate import path from the actual source URL, which would allow you, for example, to always update from the github URL, but store it in the <code>google.golang.orc&#47;appengine</code> directory structure for proper importing.  We have to do this with apache&#39;s thrift library in our applications currently."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1493658968, "creation_date": 1493658968, "answer_id": 43723292, "question_id": 43723126, "link": "https://stackoverflow.com/questions/43723126/how-can-i-import-the-github-version-of-golang-appengine-because-the-version-goog/43723292#43723292", "title": "How can I import the github version of Golang Appengine because the version google.golang.org/appengine is outdated?", "body": "<p>Copy the files from <code>$GOPATH/src/github.com/golang/appengine</code> to <code>$GOPATH/src/google.golang.org/appengine</code>, and use <code>google.golang.org/appengine</code> as the import path.</p>\n\n<p>That, or go into <code>$GOPATH/src/github.com/golang/appengine/doc.go</code> and delete the comment after <code>package appengine</code> in the file.</p>\n\n<p>This is a result of <a href=\"https://golang.org/doc/go1.4#canonicalimports\" rel=\"nofollow noreferrer\">canonical import paths</a> added in Go 1.4.</p>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1493659978, "accepted_answer_id": 43723292, "answer_count": 1, "score": 0, "last_activity_date": 1493658984, "creation_date": 1493658276, "question_id": 43723126, "link": "https://stackoverflow.com/questions/43723126/how-can-i-import-the-github-version-of-golang-appengine-because-the-version-goog", "closed_reason": "Duplicate", "title": "How can I import the github version of Golang Appengine because the version google.golang.org/appengine is outdated?", "body": "<p>The repository at google.golang.org/appengine   is outdated( aetest package specifically), the most current version of aetest looks like it's at github.com/golang/appengine</p>\n\n<p>I'm not sure how to propery import the repository code to my local computer because the import paths in the code repository are to an outdated repository.</p>\n\n<p>I attempted:<br>\n$ go get github.com/golang/appengine   </p>\n\n<pre><code>package github.com/golang/appengine: code in directory /Users/Bryan/work/gocode/src/github.com/golang/appengine expects import \"google.golang.org/appengine\"\n</code></pre>\n\n<p>So it looks like the code in the Github repository uses the old import path.</p>\n\n<p>How should I properly import the most current version of golang appengine?</p>\n"}, {"tags": ["go", "vips"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1493661614, "post_id": 43723322, "comment_id": 74491494, "body": "This is really great, I do wonder.. with this approach I will likely end up calling the image manipulation library (e.g. libvips) over and over again with each parameter. Would you also do it this way, or maybe it would be smarter to store the parameters and then do the image manipulation in some Process function, or maybe something else?"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1493661752, "post_id": 43723322, "comment_id": 74491560, "body": "Mmh, I&#39;m not sure how libvips works, but I bet it would be all around simpler to have one process function in which the queries could be passed"}, {"owner": {"reputation": 7702, "user_id": 894763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d013c9681666f0a68a6c1c00ff4d603?s=128&d=identicon&r=PG", "display_name": "jcupitt", "link": "https://stackoverflow.com/users/894763/jcupitt"}, "edited": false, "score": 0, "creation_date": 1493714476, "post_id": 43723322, "comment_id": 74510099, "body": "You can use libvips both ways. You can call the basic functions separately, or you can call a single high-level thumbnail function with a set of parameters. If you gather up your params and call vips_thumbnail() at the end, you can be sure the basic functions will be called for you in the best order. API here: <a href=\"http://jcupitt.github.io/libvips/API/current/libvips-resample.html#vips-thumbnail\" rel=\"nofollow noreferrer\">jcupitt.github.io/libvips/API/current/&hellip;</a> intro to resizing here: <a href=\"https://github.com/jcupitt/libvips/wiki/HOWTO----Image-shrinking\" rel=\"nofollow noreferrer\">github.com/jcupitt/libvips/wiki/HOWTO----Image-shrinking</a> intro to vipsthumbnail here: <a href=\"http://jcupitt.github.io/libvips/API/current/Using-vipsthumbnail.md.html\" rel=\"nofollow noreferrer\">jcupitt.github.io/libvips/API/current/&hellip;</a>"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1493743073, "post_id": 43723322, "comment_id": 74528988, "body": "then I would call it once, and &quot;gather up&quot; the params to call <code>vips_thumbnail()</code>"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 1, "last_activity_date": 1493659807, "last_edit_date": 1493659807, "creation_date": 1493659101, "answer_id": 43723322, "question_id": 43723053, "link": "https://stackoverflow.com/questions/43723053/process-image-given-multiple-url-parameters-in-go/43723322#43723322", "title": "Process image given multiple URL parameters in Go", "body": "<p>Likely, </p>\n\n<blockquote>\n  <p>imgfile</p>\n</blockquote>\n\n<p>will satisfy the <a href=\"https://golang.org/pkg/image/#Image\" rel=\"nofollow noreferrer\"><code>image.Image</code></a> interface <strong>and not</strong> the data saved on disk (ie. the actual jpg file)</p>\n\n<blockquote>\n  <p>Image is a finite rectangular grid of color.Color values taken from a color model. </p>\n</blockquote>\n\n<p>Lots of 3rd party golang image libraries use <code>image.Image</code> to manipulate images.</p>\n\n<hr>\n\n<p>I would use a standard <a href=\"https://golang.org/pkg/image/#Image\" rel=\"nofollow noreferrer\"><code>image.Image</code></a> interface retrieved (read to memory) by a filename in the <code>imageGET</code> function and modified according to the queries. You can see also the <a href=\"https://golang.org/pkg/image/jpeg/\" rel=\"nofollow noreferrer\">jpeg</a> golang library from the standard lib.</p>\n\n<pre><code>function ImageGET(w http.ResponseWriter, r *http.Request) {\n  // GetJPEGImageFromFileSystem must decode os.File content and \n  // return a golang image.Image interface\n  img, _ := GetJPEGImageFromFileSystem(r.URL.Query().Get(\"filename\"))\n  if r.URL.Query().Get(\"resize\") != \"\" {\n      // If resizing, write over the image.Image in Memory, \n      // but not the image File on disk\n      img, _ = Resize(img, r.URL.Query().GET(\"resize\"))\n  }\n  // etc...\n}\n\nfunction Resize(img image.Image, size string) (image.Image, error) {\n  // the resize stuff -- or, alternatively just call a dependency in the original handler to resize\n  return resizedImage, nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 1, "last_activity_date": 1493659273, "creation_date": 1493659273, "answer_id": 43723369, "question_id": 43723053, "link": "https://stackoverflow.com/questions/43723053/process-image-given-multiple-url-parameters-in-go/43723369#43723369", "title": "Process image given multiple URL parameters in Go", "body": "<blockquote>\n  <p>Now, my question is, how should I design whatever function does the\n  image processing so that it will process everything properly and\n  efficiently?</p>\n</blockquote>\n\n<p>Depends on the package you are using for your stuff and what you want to do with it. If you look for example to the <a href=\"https://godoc.org/github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">imaging package</a> you see that they return always: <a href=\"https://godoc.org/image#NRGBA\" rel=\"nofollow noreferrer\">*image.NRGBA</a></p>\n\n<p>That type implements the <code>image.Image</code> interface.</p>\n\n<p>At the next step you can use the <a href=\"https://godoc.org/github.com/disintegration/imaging#Encode\" rel=\"nofollow noreferrer\">Encode function</a>.</p>\n\n<blockquote>\n  <p>func Encode(w io.Writer, img image.Image, format Format) error</p>\n</blockquote>\n\n<p>As you see that function uses a io.Writer. </p>\n\n<pre><code>function ImageGET(w http.ResponseWriter, r *http.Request) {\n  // ...\n  imaging.Encode(w,img,imaging.PNG)\n  // ...\n</code></pre>\n\n<p>So you just need to use the writer from the your handler there and ready.</p>\n\n<p>So to keep your function correct just return the <code>image.Image</code> interface.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "closed_date": 1493689687, "accepted_answer_id": 43723322, "answer_count": 2, "score": 1, "last_activity_date": 1493659807, "creation_date": 1493657990, "question_id": 43723053, "link": "https://stackoverflow.com/questions/43723053/process-image-given-multiple-url-parameters-in-go", "closed_reason": "Needs more focus", "title": "Process image given multiple URL parameters in Go", "body": "<p>I would probably prefer to use pressly/chi, but I guess it makes no difference. I imagine given an input URL like this <code>example.com/Jd8saD.jpg?resize=420x320&amp;fit=crop&amp;rotate=90</code>, then it would go to the following GET function because of <code>r.Get(\"/:image\", ImageGET)</code>:</p>\n\n<pre><code>function ImageGET(w http.ResponseWriter, r *http.Request) {\n  if r.URL.Query().Get(\"resize\") != \"\" {\n    // do something\n  }\n  if r.URL.Query().Get(\"crop\") != \"\" {\n    // do something\n  }\n  if r.URL.Query().Get(\"watermark\") != \"\" {\n    // do something\n  }\n  etc\n}\n</code></pre>\n\n<p>Now, my question is, how should I design whatever function does the image processing so that it will process everything properly and efficiently? I don't expect you to write code that will handle the resizing, but how would these functions look like? Perhaps:</p>\n\n<pre><code>function Resize(size string) (imgfile?, error) {\n  // the resize stuff\n}\n</code></pre>\n\n<p>What would that returned <code>imgfile</code> even be? A struct containing some relevant img info?</p>\n"}, {"tags": ["go", "range", "permutation", "slice", "channels"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 2, "last_activity_date": 1493658040, "creation_date": 1493658040, "answer_id": 43723065, "question_id": 43722558, "link": "https://stackoverflow.com/questions/43722558/golang-range-through-channel-with-odd-behaviour-when-inplementing-heaps-permuta/43723065#43723065", "title": "Golang range through channel with odd behaviour when inplementing Heap&#39;s permutation algorithm", "body": "<p>Your problem is that slices are reference types, and are being accessed in multiple goroutines.  In <code>perm</code>, you're printing <code>a</code> directly as you finish processing it at each step.  In <code>permch</code>, you're sending <code>a</code> over the channel, but then immediate starting to modify it again.  Since each slice sent over the channel refers to the same underlying array, you have a race condition as to whether your next loop iteration alters <code>a</code> or your <code>Println()</code> call in main gets to that array first.</p>\n\n<p>In general, if you're running into unexpected behavior in any program using goroutines, you <em>probably</em> have a race condition.  Run the program with the <code>-race</code> flag to see where.</p>\n\n<p><strong>Edit:</strong> also, closing a channel has no effect on a routine <em>reading</em> from the channel.  A channel can continue to be read until its buffer is empty, at which point it will start returning the zero value for that type instead.  Range loops over a channel will only terminate once the channel is closed <em>and its buffer is empty</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "edited": false, "score": 0, "creation_date": 1493663761, "post_id": 43723144, "comment_id": 74492546, "body": "Can you please show me how to implement #1 or #2? I think adding another channel to signal from main to the goroutine a little cumbersome. I&#39;ve tried using builtin <code>copy()</code> and <code>make()</code> creating a new underlying array but i think the problem relies on main printing the array at the same time <code>permch</code> changes it. And i really don&#39;t know how to use mutexes since i can lock the part in permch that is changing the array but it do not guarantee that it will wait <code>main()</code> print the array."}, {"owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "edited": false, "score": 0, "creation_date": 1493681453, "post_id": 43723144, "comment_id": 74499634, "body": "And when i try to use Mutexes i am able to silence the race detector but not to get what i want which is the behaviour of the no channel version.<a href=\"https://play.golang.org/p/fSt9MfIyOi\" rel=\"nofollow noreferrer\">play.golang.org/p/fSt9MfIyOi</a>"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1493664407, "last_edit_date": 1493664407, "creation_date": 1493658346, "answer_id": 43723144, "question_id": 43722558, "link": "https://stackoverflow.com/questions/43722558/golang-range-through-channel-with-odd-behaviour-when-inplementing-heaps-permuta/43723144#43723144", "title": "Golang range through channel with odd behaviour when inplementing Heap&#39;s permutation algorithm", "body": "<p>It looks like <code>permch</code> is modifying <code>a</code> at the same time as <code>main</code> is printing it, so your output is garbled.</p>\n\n<p>I can think of three easy fixes:</p>\n\n<ol>\n<li>Guard access to <code>a</code> with a mutex.</li>\n<li>Put a copy of <code>a</code> on the channel:</li>\n<li>Have some kind of return signal from main that it has printed and <code>permch</code> can continue. (don't really recommend this, but it works).</li>\n</ol>\n\n<p>Number 2 is pretty simple:</p>\n\n<pre><code>a2 := make([]int64, len(a))\ncopy(a2,a)\nch &lt;- a2\n</code></pre>\n\n<p>and is what I would recommend.</p>\n\n<p>For #1, just declare a <code>var m sync.Mutex</code> as a package variable and <code>Lock</code> is anytime you read or modify <code>a</code>. This is a race condition though between the reader and the next modification, as you pointed out, so it probably isn't a good solution after all.</p>\n\n<p><a href=\"https://play.golang.org/p/GhNAAd4MSf\" rel=\"nofollow noreferrer\">fixed version on playground using #3</a></p>\n"}], "owner": {"reputation": 43, "user_id": 2103321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f395b5f9e60e24045e822e0c2f50ebc0?s=128&d=identicon&r=PG", "display_name": "Daniel Rangel", "link": "https://stackoverflow.com/users/2103321/daniel-rangel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 43723144, "answer_count": 2, "score": 2, "last_activity_date": 1493664407, "creation_date": 1493655889, "last_edit_date": 1493656208, "question_id": 43722558, "link": "https://stackoverflow.com/questions/43722558/golang-range-through-channel-with-odd-behaviour-when-inplementing-heaps-permuta", "title": "Golang range through channel with odd behaviour when inplementing Heap&#39;s permutation algorithm", "body": "<p>I was trying to implement <a href=\"https://en.wikipedia.org/wiki/Heap%27s_algorithm\" rel=\"nofollow noreferrer\">Heap's Algorithm</a> in go using channels. The code below is working fine when just printing the slices on the screen, but when using channels to delivery the arrays to a for/range loop on main function some unexpected behaviour occurs and the slices/arrays are printed in duplicity and not all permutations are sent. I thought that maybe i'm closing the channel earlier than the main function is able to print the results but i wouldn't expect that double print. Why is this happening and how can i make it work.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc perm(a []int64) {\n    var n = len(a)\n    var c = make([]int, n)\n    fmt.Println(a)\n    i := 0\n    for i &lt; n {\n        if c[i] &lt; i {\n            if i%2 == 0 {\n                a[0], a[i] = a[i], a[0]\n            } else {\n                a[c[i]], a[i] = a[i], a[c[i]]\n            }\n            fmt.Println(a)\n            c[i]++\n            i = 0\n        } else {\n            c[i] = 0\n            i++\n        }\n    }\n}\n\nfunc permch(a []int64, ch chan&lt;- []int64) {\n    var n = len(a)\n    var c = make([]int, n)\n    ch &lt;- a\n    i := 0\n    for i &lt; n {\n        if c[i] &lt; i {\n            if i%2 == 0 {\n                a[0], a[i] = a[i], a[0]\n            } else {\n                a[c[i]], a[i] = a[i], a[c[i]]\n            }\n            ch &lt;- a\n            c[i]++\n            i = 0\n        } else {\n            c[i] = 0\n            i++\n        }\n    }\n    close(ch)\n}\n\nfunc main() {\n    var i = []int64{1, 2, 3}\n    fmt.Println(\"Without Channels\")\n    perm(i)\n    ch := make(chan []int64)\n    go permch(i, ch)\n    fmt.Println(\"With Channels\")\n    for slc := range ch {\n        fmt.Println(slc)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["heroku", "go", "godeps"], "answers": [{"comments": [{"owner": {"reputation": 1026, "user_id": 1183362, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/62a4e16806c8fd879f159e8777f0ca28?s=128&d=identicon&r=PG", "display_name": "Welton122", "link": "https://stackoverflow.com/users/1183362/welton122"}, "edited": false, "score": 2, "creation_date": 1493655843, "post_id": 43722216, "comment_id": 74488536, "body": "After changing my GOPATH to <code>&#47;Users&#47;username&#47;gosource&#47;src&#47;github&#47;foo&#47;my-server&#47;</code>, I&#39;m still getting <code>godep should only be used inside a valid go package directory and godep: [WARNING]: may not function correctly. You are probably outside of your $GOPATH.</code>"}], "tags": [], "owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "is_accepted": false, "score": 0, "last_activity_date": 1493654517, "creation_date": 1493654517, "answer_id": 43722216, "question_id": 43721962, "link": "https://stackoverflow.com/questions/43721962/godep-save-never-works/43722216#43722216", "title": "godep save never works", "body": "<p>You want to make sure that you run this command from a repo that is also defined in your <code>$GOPATH</code>. </p>\n\n<p>So it would need to be: <code>/Users/username/gosource/src/github/foo/my-server/</code></p>\n\n<p>This means that not only are all your packages located in your <code>$GOPATH</code> but additionally your own repo is located in your <code>$GOPATH</code>. At this point everything should work as expected.</p>\n\n<p>If you don't have a <code>$GOPATH</code> environment variable defined you need to make sure it is set pre Go1.8.</p>\n\n<p>Try this: <code>echo $GOPATH</code> at the command prompt to see if it's defined.</p>\n\n<p>If not, you'll want to choose a location and set it with: <code>export GOPATH=/your/final/location</code>.</p>\n\n<p>More details can be <a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">found here</a>.</p>\n"}], "owner": {"reputation": 1026, "user_id": 1183362, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/62a4e16806c8fd879f159e8777f0ca28?s=128&d=identicon&r=PG", "display_name": "Welton122", "link": "https://stackoverflow.com/users/1183362/welton122"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 849, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493654517, "creation_date": 1493653593, "question_id": 43721962, "link": "https://stackoverflow.com/questions/43721962/godep-save-never-works", "title": "godep save never works", "body": "<p>When trying to run <code>godep save</code>, I'm always getting the following error:</p>\n\n<pre><code>godep: [WARNING]: godep should only be used inside a valid go package directory and\ngodep: [WARNING]: may not function correctly. You are probably outside of your $GOPATH.\ngodep: [WARNING]:   Current Directory: /Users/username/Development/my-server\ngodep: [WARNING]:   $GOPATH: /Users/username/Development/my-server\n</code></pre>\n\n<p>Does anyone know how to solve this issue?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 6, "last_activity_date": 1493651919, "creation_date": 1493651919, "answer_id": 43721495, "question_id": 43721355, "link": "https://stackoverflow.com/questions/43721355/how-timed-loop-works/43721495#43721495", "title": "How timed loop works?", "body": "<p><a href=\"https://golang.org/pkg/time/#Tick\" rel=\"noreferrer\">Tick</a> returns a <code>&lt;-chan Time</code> channel, and in Go looping over channels with <code>range</code>, just as you would loop over an array or a map, is a ok. When you loop over a channel the code inside the loop gets executed on every <code>recieve</code> from that channel, which in your example would happen every 3 seconds. The loop terminates after that channel is closed.</p>\n\n<p><a href=\"https://tour.golang.org/concurrency/4\" rel=\"noreferrer\">https://tour.golang.org/concurrency/4</a></p>\n"}], "owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 43721495, "answer_count": 1, "score": 1, "last_activity_date": 1493651919, "creation_date": 1493651363, "question_id": 43721355, "link": "https://stackoverflow.com/questions/43721355/how-timed-loop-works", "title": "How timed loop works?", "body": "<p>I am learning golang, and I just came to know about the timed loop. But I don't understand how is it working?</p>\n\n<pre><code>for _ = range time.Tick(time.Second * 3) {\n    fmt.Println(\"Ticking every 3 seconds\")\n}\n</code></pre>\n"}, {"tags": ["api", "go"], "comments": [{"owner": {"reputation": 77, "user_id": 7858740, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/liIcc.png?s=128&g=1", "display_name": "C.Petrescu", "link": "https://stackoverflow.com/users/7858740/c-petrescu"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1493663409, "post_id": 43720183, "comment_id": 74492371, "body": "well, I can&#39;t understand your words. Can you explain about that in detail?"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1493676886, "post_id": 43720183, "comment_id": 74498335, "body": "The error you getting means that the server you are sending data to, <a href=\"https://api.sandbox.ebay.com/identity/v1/oauth2/token\" rel=\"nofollow noreferrer\">api.sandbox.ebay.com/identity/v1/oauth2/token</a>, doesn&#39;t understand the the message you&#39;re sending (the message is a combination of header+body). So I don&#39;t know what it is expecting, but it&#39;s not getting the request it expects. I suggest double checking how to compose that message :)"}], "answers": [{"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 1, "last_activity_date": 1493677594, "last_edit_date": 1493677594, "creation_date": 1493677288, "answer_id": 43727368, "question_id": 43720183, "link": "https://stackoverflow.com/questions/43720183/400-error-getting-oauth-user-token-in-golang/43727368#43727368", "title": "400 error getting oauth user token in golang?", "body": "<p>I looks like the message isn't formed correctly (which is why the server returns <code>400</code>). </p>\n\n<p>When you're setting your headers you write:</p>\n\n<pre><code>req.Header.Add(\"Authorization\", \"Basic \"+authorizationBase64)\nreq.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n</code></pre>\n\n<p>Golang has a nice built in way to add <strong>Authorization to a Header</strong>: <a href=\"https://golang.org/pkg/net/http/#Request.SetBasicAuth\" rel=\"nofollow noreferrer\"><code>SetBasicAuth</code></a>, which is a method of <code>http.Request</code>. </p>\n\n<pre><code>func (r *Request) SetBasicAuth(username, password string)\n</code></pre>\n\n<blockquote>\n  <p>SetBasicAuth sets the request's Authorization header to use HTTP Basic Authentication with the provided username and password.</p>\n  \n  <p>With HTTP Basic Authentication the provided username and password are not encrypted. </p>\n</blockquote>\n\n<p>So instead of setting the Authorization Header manually, you could try:</p>\n\n<pre><code>req.SetBasicAuth(\"AppID\u201d, \u201cCertID\u201d)\n</code></pre>\n\n<p>You were using something called <strong>CertID</strong>, but I think you meant <strong>ClientId</strong> and <strong>ClientSecret</strong> -- respectively <strong>user</strong> and <strong>password</strong></p>\n\n<hr>\n\n<p>I don't <em>know</em> if this is the cause of your problem :). One way to help find out, is <strong>consistent error checking</strong>, see your line:</p>\n\n<pre><code>applicationTokenURLEncoded, _ := url.Parse(applicationToken)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7858740, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/liIcc.png?s=128&g=1", "display_name": "C.Petrescu", "link": "https://stackoverflow.com/users/7858740/c-petrescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 43727368, "answer_count": 1, "score": 1, "last_activity_date": 1494211733, "creation_date": 1493646497, "last_edit_date": 1494211733, "question_id": 43720183, "link": "https://stackoverflow.com/questions/43720183/400-error-getting-oauth-user-token-in-golang", "title": "400 error getting oauth user token in golang?", "body": "<p>I tried to get the ebay user token.\nI've alreay gotten auth code in ebay, but can't get user token with auth code.\nCode is following:</p>\n\n<pre><code>status := ctx.UserValue(\"status\").(string)\napplicationToken := string(ctx.QueryArgs().Peek(\"code\"))\nlog.Println(\"ApplicationToken: \", applicationToken)\nlog.Println(\"Status: \", status)\nif status == \"declined\" {\n\u00a0\u00a0\u00a0\u00a0fmt.Printf(\"User doesn't give permission. Go back to your dashboard.\")\n\u00a0\u00a0\u00a0\u00a0ctx.Redirect(\"/dashboard\", fasthttp.StatusSeeOther)\n}\n\n//var appConfig = config.Config()\nclient := &amp;http.Client{}\n\napplicationTokenURLEncoded, _ := url.Parse(applicationToken)\n\nbody := url.Values{\n\u00a0\u00a0\u00a0\u00a0\"grant_type\":   {\"authorization_code\"},\n\u00a0\u00a0\u00a0\u00a0\"code\":         {applicationTokenURLEncoded.String()},\n\u00a0\u00a0\u00a0\u00a0\"redirect_uri\": {Runame},\n}\nreqBody := bytes.NewBufferString(body.Encode())\nlog.Println(\"Reqbody: \", reqBody)\n\nreq, _ := http.NewRequest(\"POST\", \"https://api.sandbox.ebay.com/identity/v1/oauth2/token\", reqBody)\n\n\nauthorization := \u201cAppID\u201d + \":\" + \u201cCertID\u201d\nauthorizationBase64 := base64.StdEncoding.EncodeToString([]byte(authorization))\n\nreq.Header.Add(\"Authorization\", \"Basic \"+authorizationBase64)\nreq.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\nlog.Println(\"Body: \", req)\n\nresp, _ := client.Do(req)\nlog.Println(\"resp: \", resp)\nlog.Println(\"ResBody: \", resp.Body)\n</code></pre>\n\n<p>And the error is like that:</p>\n\n<pre><code>Bad Request 400\n</code></pre>\n"}, {"tags": ["go", "internationalization"], "comments": [{"owner": {"reputation": 4628, "user_id": 744534, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/iWWdZ.jpg?s=128&g=1", "display_name": "Thaadikkaaran", "link": "https://stackoverflow.com/users/744534/thaadikkaaran"}, "edited": false, "score": 0, "creation_date": 1531915795, "post_id": 43718200, "comment_id": 89774055, "body": "These examples works fine. Is this the problem with <code>Big-Little endian</code> byte order"}], "owner": {"reputation": 65, "user_id": 7636062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b462c3a7ef691579d6a666b0763780dc?s=128&d=identicon&r=PG&f=1", "display_name": "jaimelescornichons", "link": "https://stackoverflow.com/users/7636062/jaimelescornichons"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1493718558, "creation_date": 1493637182, "last_edit_date": 1493718558, "question_id": 43718200, "link": "https://stackoverflow.com/questions/43718200/issue-with-the-plural-package-inside-golang-org-x-text", "title": "Issue with the plural package inside &quot;golang.org/x/text&quot;", "body": "<p>I am doing some tests with the <a href=\"https://godoc.org/golang.org/x/text\" rel=\"nofollow noreferrer\"><code>golang.org/x/text</code></a> package and particularly with the <a href=\"https://godoc.org/golang.org/x/text/feature/plural\" rel=\"nofollow noreferrer\"><code>feature/plural</code></a> sub package and its <a href=\"https://godoc.org/golang.org/x/text/feature/plural#Rules.MatchDigits\" rel=\"nofollow noreferrer\"><code>MatchDigits</code></a> method. Here is what I am doing :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"golang.org/x/text/feature/plural\"\n    \"golang.org/x/text/language\"\n)\n\nfunc main() {\n    fmt.Println(plural.Cardinal.MatchDigits(language.French, []byte{1}, 1, 0)) // \"1\" -&gt; should print 2 (One) but prints 0 (Other)\n    fmt.Println(plural.Cardinal.MatchDigits(language.French, []byte{2}, 1, 0)) // \"2\" -&gt; prints 0 (Other) the correct value\n    fmt.Println(plural.Cardinal.MatchDigits(language.French, []byte{1, 0}, 2, 0)) // \"10\" -&gt; prints 0 (Other) the correct value\n}\n</code></pre>\n\n<p>And here is where I get the expected results from : <a href=\"http://www.unicode.org/cldr/charts/latest/supplemental/language_plural_rules.html#fr\" rel=\"nofollow noreferrer\">http://www.unicode.org/cldr/charts/latest/supplemental/language_plural_rules.html#fr</a></p>\n\n<p>I also tried with another language with more complex plural rules like Czech and the output was not correct.</p>\n\n<p>Am I missing something ? I can not find a lot of examples on this package.</p>\n\n<p>Thanks !</p>\n\n<p>EDIT:</p>\n\n<p>After some more tests, I found the good result for \"1\", using 0 as both the <code>exp</code> and <code>scale</code> parameters :</p>\n\n<pre><code>fmt.Println(plural.Cardinal.MatchDigits(language.French, []byte{1}, 0, 0)) // prints 2 (One), the correct value\n</code></pre>\n\n<p>But it does not follow what the <a href=\"https://godoc.org/golang.org/x/text/feature/plural#Rules.MatchDigits\" rel=\"nofollow noreferrer\">documentation says</a>, and does not work when I try for 1,5 with the same logic :</p>\n\n<pre><code>fmt.Println(plural.Cardinal.MatchDigits(language.French, []byte{1, 5}, 0, 1)) // prints 0 (Other), should print 2 (One)\n</code></pre>\n"}, {"tags": ["go", "tcp", "gorilla"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1493640300, "post_id": 43718126, "comment_id": 74480815, "body": "What does the cpu (wait) do?"}, {"owner": {"reputation": 49, "user_id": 1359660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbc314f97b428e79652586e6ce7edb0?s=128&d=identicon&r=PG", "display_name": "user1359660", "link": "https://stackoverflow.com/users/1359660/user1359660"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1493642089, "post_id": 43718126, "comment_id": 74481640, "body": "this method  camera := getService().GetByPath(path) returns camera object from map"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493643187, "post_id": 43718126, "comment_id": 74482135, "body": "It kinda looks like the client might disconnect before receiving the response."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493644964, "post_id": 43718126, "comment_id": 74482922, "body": "Don&#39;t use <code>ab</code>. It&#39;s <code>http&#47;1.0</code> and probably not even using keepalive. Chances are you&#39;ve just exhausted your ephemeral ports or file descriptors on the server."}, {"owner": {"reputation": 49, "user_id": 1359660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbc314f97b428e79652586e6ce7edb0?s=128&d=identicon&r=PG", "display_name": "user1359660", "link": "https://stackoverflow.com/users/1359660/user1359660"}, "edited": false, "score": 0, "creation_date": 1493646515, "post_id": 43718126, "comment_id": 74483694, "body": "I think you are right, and ab is the problem. Thanks"}], "owner": {"reputation": 49, "user_id": 1359660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbc314f97b428e79652586e6ce7edb0?s=128&d=identicon&r=PG", "display_name": "user1359660", "link": "https://stackoverflow.com/users/1359660/user1359660"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3256, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493637522, "creation_date": 1493636821, "last_edit_date": 1493637522, "question_id": 43718126, "link": "https://stackoverflow.com/questions/43718126/go-get-request-write-broken-pipe", "title": "Go Get Request - write: broken pipe", "body": "<p>I'm Sorry in advance for the probably stupid question.\nI want to send an image(image/jpeg) when certain URL is called. When I do few get request everything seems  to be working fine, but when I use apache benchmark to stress test the same endpoint I got this error</p>\n\n<blockquote>\n  <p>write tcp [::1]:8080->[::1]:65255: write: broken pipe</p>\n</blockquote>\n\n<p>Here is a code I want to execute:</p>\n\n<pre><code>func CameraImage(w http.ResponseWriter, r *http.Request) {\n    //log.Println(\"Serving\", r.URL)\n\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n    w.Header().Set(\"Content-Type\", \"image/jpeg\")\n\n    vars := mux.Vars(r)\n    path := vars[\"camera_path\"]\n\n    camera := getService().GetByPath(path)\n\n    if camera.Image == nil {\n        return\n    }\n\n    err := jpeg.Encode(w, camera.Image, nil)\n    if err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://gist.github.com/anonymous/c19c9c6f797d744382a90f35f8ea512f\" rel=\"nofollow noreferrer\">https://gist.github.com/anonymous/c19c9c6f797d744382a90f35f8ea512f</a></p>\n\n<p><a href=\"https://github.com/babell00/toc_camera\" rel=\"nofollow noreferrer\">https://github.com/babell00/toc_camera</a></p>\n\n<p>Thanks for any Help\nKuba</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 2, "creation_date": 1493635548, "post_id": 43717803, "comment_id": 74478903, "body": "Have you checked what&#39;s inside your <code>GOPATH&#47;pkg</code> / <code>GOPATH&#47;github</code> folders?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493635797, "post_id": 43717803, "comment_id": 74478982, "body": "If it does not output anything then everything worked and you installed the command."}, {"owner": {"reputation": 13154, "user_id": 2999675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb0b7c8c3b13457a7cb7749d1334d3ae?s=128&d=identicon&r=PG&f=1", "display_name": "Hello lad", "link": "https://stackoverflow.com/users/2999675/hello-lad"}, "reply_to_user": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 0, "creation_date": 1493638444, "post_id": 43717803, "comment_id": 74480046, "body": "@AndreaM16 thanks for the response, in there is github.com/miku/esbulk.a. (see my update :))"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493640770, "post_id": 43717803, "comment_id": 74481008, "body": "@Flimzy: <code>-v</code> does turn on output, but there is no output."}, {"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 3, "creation_date": 1508832339, "post_id": 43717803, "comment_id": 80757161, "body": "Maybe also mention that in the absence of any explicit <code>GOPATH</code> the results end up in <code>$HOME&#47;go</code>."}, {"owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "edited": false, "score": 0, "creation_date": 1560436507, "post_id": 43717803, "comment_id": 99743735, "body": "I&#39;m sure you solve that issue by now, but if that can help others, you shold check your &quot;$GOTOOLDIR&quot; which is where the &quot;go get&quot; are going to be installed."}], "answers": [{"comments": [{"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 1, "creation_date": 1558313804, "post_id": 43718900, "comment_id": 99047434, "body": "Actually what I want to see is the downloading speed. Just like <code>git clone</code>, we can see the speed, so that we needn&#39;t to consider another option."}, {"owner": {"reputation": 398, "user_id": 10377640, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tYnPVIRXnNo/AAAAAAAAAAI/AAAAAAAAAsM/TB3MdQBBB88/photo.jpg?sz=128", "display_name": "Alif Ramdani", "link": "https://stackoverflow.com/users/10377640/alif-ramdani"}, "edited": false, "score": 0, "creation_date": 1604642760, "post_id": 43718900, "comment_id": 114414870, "body": "My goodness, so it is just not showing anything in the process like <code>git clone</code> does. It confuses me because I don&#39;t know if it is work or not. Thanks btw"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 13, "last_activity_date": 1493640602, "creation_date": 1493640602, "answer_id": 43718900, "question_id": 43717803, "link": "https://stackoverflow.com/questions/43717803/go-get-command-does-not-provide-output-nor-take-effect/43718900#43718900", "title": "go get command does not provide output nor take effect", "body": "<pre><code>$ go help get\nusage: go get [-d] [-f] [-fix] [-insecure] [-t] [-u] [build flags] [packages]\n\nGet downloads the packages named by the import paths, along with their\ndependencies. It then installs the named packages, like 'go install'.\n\nThe -u flag instructs get to use the network to update the named packages\nand their dependencies.  By default, get uses the network to check out\nmissing packages but does not use it to look for updates to existing packages.\n\nThe -v flag enables verbose progress and debug output.\n\n$ \n</code></pre>\n\n<p>If there is nothing to do then there is nothing to report. For example, when <code>go get</code> is run for the first time it downloads and installs, after that it does nothing because there is nothing to do, unless you force an update:</p>\n\n<pre><code>$ go get -v github.com/aclements/perflock/cmd/perflock \ngithub.com/aclements/perflock (download)\ngithub.com/aclements/perflock/internal/cpupower\ngithub.com/aclements/perflock/cmd/perflock\n$ go get -v github.com/aclements/perflock/cmd/perflock \n$ go get -v github.com/aclements/perflock/cmd/perflock \n$ go get -v -u github.com/aclements/perflock/cmd/perflock \ngithub.com/aclements/perflock (download)\n$ go get -v -u github.com/aclements/perflock/cmd/perflock \ngithub.com/aclements/perflock (download)\n$ go get -v github.com/aclements/perflock/cmd/perflock \n$ go get -v github.com/aclements/perflock/cmd/perflock \n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 4098847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd49d43c52289efda3178fc27039c54?s=128&d=identicon&r=PG", "display_name": "Rem&#39;s", "link": "https://stackoverflow.com/users/4098847/rems"}, "is_accepted": false, "score": 0, "last_activity_date": 1560436584, "creation_date": 1560436584, "answer_id": 56582914, "question_id": 43717803, "link": "https://stackoverflow.com/questions/43717803/go-get-command-does-not-provide-output-nor-take-effect/56582914#56582914", "title": "go get command does not provide output nor take effect", "body": "<p>I'm sure you solve that issue by now, but if that can help others, you shold check your \"$GOTOOLDIR\" which is where the \"go get\" are going to be installed.</p>\n\n<p>Type </p>\n\n<pre><code>go env\n</code></pre>\n\n<p>And check that your GOTOOLDIR is the one that should be where you want the go get to be installed.</p>\n"}], "owner": {"reputation": 13154, "user_id": 2999675, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb0b7c8c3b13457a7cb7749d1334d3ae?s=128&d=identicon&r=PG&f=1", "display_name": "Hello lad", "link": "https://stackoverflow.com/users/2999675/hello-lad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15000, "favorite_count": 2, "accepted_answer_id": 43718900, "answer_count": 2, "score": 11, "last_activity_date": 1560436584, "creation_date": 1493635253, "last_edit_date": 1493638404, "question_id": 43717803, "link": "https://stackoverflow.com/questions/43717803/go-get-command-does-not-provide-output-nor-take-effect", "title": "go get command does not provide output nor take effect", "body": "<p>I have installed go on my mac</p>\n\n<pre><code>go version\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>go version go1.8.1 darwin/amd64\n</code></pre>\n\n<p>AND</p>\n\n<pre><code>go env\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/MYUSERNAME/go/\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/np/ts5bwp_91ns22l9h751h2j8r0000gn/T/go-build124313959=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n\n<p>when I ran the following go get command:</p>\n\n<pre><code>go get -v github.com/miku/esbulk/cmd/esbulk\n</code></pre>\n\n<p>it neither generating any output nor does anything. Just nothing happened.</p>\n\n<h1>Update 1</h1>\n\n<p>in GOPATH/pkg folder there is darwin_amd64 folder, in darwin_amd64 folder there is </p>\n\n<pre><code>github.com/miku/esbulk.a\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "confluent-platform"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1493631485, "post_id": 43717025, "comment_id": 74477382, "body": "Are the messages spread evenly across partitions?"}, {"owner": {"reputation": 177, "user_id": 3780854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/whtpl.png?s=128&g=1", "display_name": "stop-start", "link": "https://stackoverflow.com/users/3780854/stop-start"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1493634563, "post_id": 43717025, "comment_id": 74478554, "body": "How can I check this? From my logs it looks like it"}, {"owner": {"reputation": 4544, "user_id": 1252056, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/fruvR.png?s=128&g=1", "display_name": "streetturtle", "link": "https://stackoverflow.com/users/1252056/streetturtle"}, "edited": false, "score": 0, "creation_date": 1493740219, "post_id": 43717025, "comment_id": 74527334, "body": "How do you set messages? Do your messages have key set, or it&#39;s only value&amp;"}, {"owner": {"reputation": 177, "user_id": 3780854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/whtpl.png?s=128&g=1", "display_name": "stop-start", "link": "https://stackoverflow.com/users/3780854/stop-start"}, "reply_to_user": {"reputation": 4544, "user_id": 1252056, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/fruvR.png?s=128&g=1", "display_name": "streetturtle", "link": "https://stackoverflow.com/users/1252056/streetturtle"}, "edited": false, "score": 0, "creation_date": 1493799846, "post_id": 43717025, "comment_id": 74551029, "body": "@streetturtle: No we don&#39;t use key set."}, {"owner": {"reputation": 2288, "user_id": 1821055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4031acff2994243c56d92f9fd4a8e3bb?s=128&d=identicon&r=PG", "display_name": "Edenhill", "link": "https://stackoverflow.com/users/1821055/edenhill"}, "edited": false, "score": 1, "creation_date": 1507656172, "post_id": 43717025, "comment_id": 80293357, "body": "You can debug the assignment process by setting the <code>debug</code> property to <code>cgrp</code>"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 3780854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/whtpl.png?s=128&g=1", "display_name": "stop-start", "link": "https://stackoverflow.com/users/3780854/stop-start"}, "edited": false, "score": 0, "creation_date": 1538142696, "post_id": 52530717, "comment_id": 92052235, "body": "Honestly we dropped kafka and ended up using nats."}], "tags": [], "owner": {"reputation": 2368, "user_id": 4245859, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/KmKez.png?s=128&g=1", "display_name": "Bitswazsky", "link": "https://stackoverflow.com/users/4245859/bitswazsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1538029622, "creation_date": 1538029622, "answer_id": 52530717, "question_id": 43717025, "link": "https://stackoverflow.com/questions/43717025/only-one-consumer-gets-kafka-messages-with-5-partitions/52530717#52530717", "title": "Only one consumer gets kafka messages with 5 partitions", "body": "<p>Can you try using this command to see the partition assignments, and add the results here?\n<code>bin/kafka-consumer-groups.sh --bootstrap-server &lt;your-broker-ip&gt;:9092 --describe --group &lt;your-consumer-group&gt; --members --verbose</code></p>\n\n<p>By default, Kafka uses range partitioning scheme, so sometimes there are unexpected behaviors (e.g. if you have only one partition per topic, and multiple consumers, only one consumer will be assigned to all the partitions). I don't know if that's relevant here, but you can take a look at <a href=\"https://stackoverflow.com/questions/51703503/consumer-group-member-has-no-partition/51704869#51704869\">this</a> post for more detail.</p>\n"}], "owner": {"reputation": 177, "user_id": 3780854, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/whtpl.png?s=128&g=1", "display_name": "stop-start", "link": "https://stackoverflow.com/users/3780854/stop-start"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538029622, "creation_date": 1493631205, "last_edit_date": 1538025289, "question_id": 43717025, "link": "https://stackoverflow.com/questions/43717025/only-one-consumer-gets-kafka-messages-with-5-partitions", "title": "Only one consumer gets kafka messages with 5 partitions", "body": "<p>We tested consumers group with 2 and 3 consumers (knowing that we may have more consumers in the future) using the confluent kafka package for Go.</p>\n\n<p>With 10 partitions per topic the messages are split between all the consumers.</p>\n\n<p>With 5 partitions per topic somehow only one consumer gets the messages.</p>\n\n<p>Any idea why this behavior?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 18, "last_activity_date": 1493634835, "last_edit_date": 1493634835, "creation_date": 1493630281, "answer_id": 43716857, "question_id": 43716691, "link": "https://stackoverflow.com/questions/43716691/how-to-publish-a-go-package/43716857#43716857", "title": "How to publish a Go package", "body": "<p>You already did it.</p>\n\n<p>All you must do to \"publish\" a Go package is make it available via a public URL. By putting it on GitHub, you have already published your package. You can view the <a href=\"https://godoc.org/github.com/dylhunn/dragontooth-movegen\" rel=\"noreferrer\">GoDoc</a> as proof.  It may take time for the doc search to update, but once you've loaded the GoDoc once on your own, the indexing will happen automatically.</p>\n\n<p>As for Go search, just click the <a href=\"http://go-search.org/add\" rel=\"noreferrer\">Add Packages</a> link at the top of the page.</p>\n"}], "owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3914, "favorite_count": 2, "accepted_answer_id": 43716857, "answer_count": 1, "score": 10, "last_activity_date": 1493634835, "creation_date": 1493629509, "question_id": 43716691, "link": "https://stackoverflow.com/questions/43716691/how-to-publish-a-go-package", "title": "How to publish a Go package", "body": "<p>I am trying to publish <a href=\"https://github.com/dylhunn/dragontooth-movegen\" rel=\"noreferrer\">my Go package</a> so it is visible on <a href=\"https://godoc.org/\" rel=\"noreferrer\">doc search</a> and <a href=\"http://go-search.org/\" rel=\"noreferrer\">go search</a>, and can be installed with <code>go get</code>. </p>\n\n<p>However, the <a href=\"https://github.com/golang/go/wiki/PackagePublishing\" rel=\"noreferrer\">one document</a> I found doesn't clearly tell me how to get the documentation generated and hosted, or to publish the package at all. How can I publish my package?</p>\n"}, {"tags": ["mysql", "templates", "web", "go"], "comments": [{"owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "edited": false, "score": 0, "creation_date": 1493629480, "post_id": 43716630, "comment_id": 74476698, "body": "This is the Go property. Struct First character must be a capital letter."}, {"owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "edited": false, "score": 0, "creation_date": 1493629800, "post_id": 43716630, "comment_id": 74476795, "body": "You can see lower case properties as <i>private</i> (not exported) : <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Exported_identifiers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "edited": false, "score": 5, "creation_date": 1493636708, "post_id": 43716845, "comment_id": 74479342, "body": "In Go, an identifier that starts with a capital letter is exported from the package, and can be accessed by anyone outside the package that declares it it.  If an identifier starts with a lower case letter, it can only be accessed from within the package."}], "tags": [], "owner": {"reputation": 308, "user_id": 974144, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/812322de97a388b26703e74b8bc40807?s=128&d=identicon&r=PG", "display_name": "Yoesoff", "link": "https://stackoverflow.com/users/974144/yoesoff"}, "is_accepted": true, "score": 5, "last_activity_date": 1534200479, "last_edit_date": 1534200479, "creation_date": 1493630251, "answer_id": 43716845, "question_id": 43716630, "link": "https://stackoverflow.com/questions/43716630/golang-using-lowercase-for-first-letter-in-struct-property/43716845#43716845", "title": "Golang using lowercase for first letter in Struct property", "body": "<p>read the doc <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>An identifier may be exported to permit access to it from another package. An identifier is exported if both:</p>\n\n<ul>\n<li>the first character of the identifier's name is a Unicode upper case\nletter (Unicode class \"Lu\"); </li>\n<li>and the identifier is declared in thepackage block or it is a field\nname or method name.</li>\n</ul>\n\n<p>All other identifiers are not exported.</p>\n"}], "owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7111, "favorite_count": 3, "accepted_answer_id": 43716845, "answer_count": 1, "score": 2, "last_activity_date": 1559121599, "creation_date": 1493629159, "last_edit_date": 1559121599, "question_id": 43716630, "link": "https://stackoverflow.com/questions/43716630/golang-using-lowercase-for-first-letter-in-struct-property", "title": "Golang using lowercase for first letter in Struct property", "body": "<p>I have an issue with Golang view template, I currently using lowercase in the struct properties to build the struct then passed it to the view as a map.</p>\n\n<p>here is my Struct look like:</p>\n\n<pre><code>type User struct {\n      uid                  int\n      username, departname string\n}\n</code></pre>\n\n<p>then I passed the collection of structs to the file view:</p>\n\n<pre><code>func (App *App) indexHander(w http.ResponseWriter, r *http.Request) {\n      rows, err := App.db.Query(\"SELECT * FROM userinfo\")\n      checkErr(err)\n\n      t, _ := template.ParseFiles(App.folderpath + \"/list.gtpl\")\n\n      users := make([]User, 0) // define empty collection of users\n\n      for rows.Next() {\n          var uid int \n          var username string\n          var departname string\n          var created string\n          err = rows.Scan(&amp;uid, &amp;username, &amp;departname, &amp;created)\n          checkErr(err)\n          users = append(users, User{uid, username, departname})\n\n      }   \n\n      t.Execute(w, users)\n\n      defer rows.Close()\n  }\n</code></pre>\n\n<p><strong>and here is my view html code:</strong></p>\n\n<pre><code>&lt;html&gt;\n      &lt;head&gt;\n      &lt;title&gt;&lt;/title&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n          &lt;ul&gt;\n          {{ range  . }}\n             &lt;li&gt;{{ .username }}&lt;/li&gt;\n          {{ end }}\n          &lt;/ul&gt;\n      &lt;/body&gt;\n  &lt;/html&gt;\n</code></pre>\n\n<p>Those code above gave me empty users data:\n<a href=\"https://i.stack.imgur.com/omsqR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/omsqR.png\" alt=\"enter image description here\"></a></p>\n\n<p>But however, using capitalize first letter in struct give me working result:</p>\n\n<p><strong>Struct</strong></p>\n\n<pre><code>type User struct {\n     Uid                  int\n     Username, Departname string  \n}\n</code></pre>\n\n<p><strong>html</strong></p>\n\n<pre><code>&lt;html&gt;\n      &lt;head&gt;\n      &lt;title&gt;&lt;/title&gt;\n      &lt;/head&gt;\n      &lt;body&gt;\n          &lt;ul&gt;\n          {{ range  . }}\n             &lt;li&gt;{{ .Username }}&lt;/li&gt;\n          {{ end }}\n          &lt;/ul&gt;\n      &lt;/body&gt;\n  &lt;/html&gt;\n</code></pre>\n\n<p><strong>it works now</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/uJLzS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uJLzS.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can somebody explain me this behavior ?</p>\n"}, {"tags": ["json", "file", "go", "file-writing"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1493665247, "post_id": 43715972, "comment_id": 74493232, "body": "I understand your code, but unless I&#39;m messing up, something isn&#39;t going right. I&#39;m getting the error: &quot;# command-line-arguments ./json.go:48: u.User.Authenticators undefined&quot;. Should I change the structure of UserType and instead of having that block of text replace it with a more broken down series of smaller structures? Thanks, I value your response!"}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "reply_to_user": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "edited": false, "score": 0, "creation_date": 1493666488, "post_id": 43715972, "comment_id": 74493813, "body": "I missed that <code>u.User</code> is a slice. I&#39;ve modified my code above."}], "tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": true, "score": 2, "last_activity_date": 1493666588, "last_edit_date": 1493666588, "creation_date": 1493625036, "answer_id": 43715972, "question_id": 43713952, "link": "https://stackoverflow.com/questions/43713952/modifying-json-file-using-golang/43715972#43715972", "title": "Modifying JSON file using Golang", "body": "<p>Add a declaration</p>\n\n<pre><code>type Authenticator struct {\n    Name  string `json:\"name\"`\n    Phone int64  `json:\"phone\"`\n}\n</code></pre>\n\n<p>and change</p>\n\n<pre><code>Authenticators []struct {\n        Name  string `json:\"name\"`\n        Phone int64  `json:\"phone\"`\n} `json:\"authenticators\"`\n</code></pre>\n\n<p>to</p>\n\n<pre><code>Authenticators []Authenticator `json:\"authenticators\"`\n</code></pre>\n\n<p>Then, to add an authenticator to the first user:</p>\n\n<pre><code>u.User[0].Authenticators = append(u.User[0].Authenticators, Authenticator{\n        Name: \"John Doe\",\n        Phone: 1234567890,\n})\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 7065713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb5447d563dd473b0792db7f4cdd5fbb?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit Panikar", "link": "https://stackoverflow.com/users/7065713/rohit-panikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5133, "favorite_count": 2, "accepted_answer_id": 43715972, "answer_count": 1, "score": 1, "last_activity_date": 1493666588, "creation_date": 1493609924, "last_edit_date": 1493624873, "question_id": 43713952, "link": "https://stackoverflow.com/questions/43713952/modifying-json-file-using-golang", "title": "Modifying JSON file using Golang", "body": "<p>I am attempting to read in a JSON file in Golang, modifying this JSON file, and then creating a new JSON file/writing over this JSON file. I have seen several samples online, but can't seem to put two and two together to get the required result. I tried just making my own JSON str in GO and modifying that, but have still failed. </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Person struct {\n    Name    string\n    Age     int\n    Details interface{}\n}\n\nfunc main() {\n    //I created a simple Json structure here to play with\n    str := `{\"name\": \"A\",\n        \"age\":20,\n        \"details\": {\"salary\":100000000}\n    }`\n    var data Person\n\n    err := json.Unmarshal([]byte(str), &amp;data)\n    if err != nil {\n        panic(err)\n    }\n\n    //I make a map so that I can adjust the value of the salary\n    details, ok := data.Details.(map[string]interface{})\n    if ok {\n        details[\"salary\"] = 999999\n    }\n    //Change the other values of a Person\n    data.Name = \"B\"\n    data.Age = 19\n    fmt.Println(data)\n\n    //SAMPLE OUTPUT: {B 19 map[salary:999999]}\n}\n</code></pre>\n\n<p>I have made several attempts with reading the file, below is my best attempt:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\n/* Create the structure that follows the outline of the JSON file*/\n\ntype UserType struct {\n    User []struct {\n        CdbID     string `json:\"cdb_id\"`\n        Firstname string `json:\"firstname\"`\n        Lastname  string `json:\"lastname\"`\n        Phone     int64  `json:\"phone\"`\n        Email     string `json:\"email\"`\n        Address   []struct {\n            Street  string `json:\"street\"`\n            City    string `json:\"city\"`\n            Zip     string `json:\"zip\"`\n            Country string `json:\"country\"`\n        } `json:\"address\"`\n        Authenticators []struct {\n            Name  string `json:\"name\"`\n            Phone int64  `json:\"phone\"`\n        } `json:\"authenticators\"`\n        VoiceSig            string `json:\"voice_sig\"`\n        VoicesigCreatedTime string `json:\"voicesig_created_time\"`\n        Status              string `json:\"status\"`\n    } `json:\"user\"`\n}\n\nfunc main() {\n    file, err := ioutil.ReadFile(\"user.json\") //Read File\n    if err != nil {\n        fmt.Print(\"Error:\", err)\n    }\n\n    var u UserType\n    json.Unmarshal(file, &amp;u)     //Parse the Json-encoded Data and store the results in u\n    result, e := json.Marshal(u) //Returns the Json encoding of u into the variable result\n    if e != nil {\n        fmt.Println(\"error\", err)\n    }\n    os.Stdout.Write(result) //The line of code golang.org uses to print  the Json encoding\n}\n</code></pre>\n\n<p>This is a sample output:</p>\n\n<pre><code>{\n    \"user\": [{\n        \"cdb_id\":\"\",\n        \"firstname\":\"Tom\",\n        \"lastname\":\"Bradley\",\n        \"phone\":14155555555,\n        \"email\":\"tom@gmail.com\",\n        \"address\":[{\n            \"street\":\"4343 shoemaker ave\",\n            \"city\":\"Brea\",\n            \"zip\":\"92821\",\n            \"country\":\"USA\"\n        }],\n        \"authenticators\":[{\n            \"name\":\"Lisa Hayden\",\n            \"phone\":15625555555\n        },{\n            \"name\":\"Pavan M\",\n            \"phone\":17145555555\n        }],\n        \"voice_sig\":\"242y5-4546-555kk54-437879ek545\",\n        \"voicesig_created_time\":\"2017-08-02T21:27:44+0000\",\n        \"status\":\"verified\"\n    }]\n}\n</code></pre>\n\n<p>I am just confused on how to modify what I want, specifically the \"Authenticators\" of the aforementioned sample output. Thanks!</p>\n"}, {"tags": ["linux", "ubuntu", "go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1493602627, "post_id": 43713102, "comment_id": 74470253, "body": "how odd... maybe it goes away if you follow convention by moving the project to <code>~&#47;go&#47;src&#47;github.com&#47;nubrozaref&#47;goTest</code> ? <i>edit</i> nvm your gopath is not ~/go, fix that first. your code needs to live somewhere inside $GOPATH/src"}, {"owner": {"reputation": 21, "user_id": 4024824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6da35b0172a70ef815d474352f58341?s=128&d=identicon&r=PG&f=1", "display_name": "nubrozaref", "link": "https://stackoverflow.com/users/4024824/nubrozaref"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1493602977, "post_id": 43713102, "comment_id": 74470306, "body": "@Plato Moved it to <code>&#47;usr&#47;local&#47;go&#47;src&#47;github.com&#47;nubrozaref&#47;goTest</code> and still getting the import cycle problem, but no mention of non-standard import in the error."}], "answers": [{"tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": false, "score": 0, "last_activity_date": 1493602901, "creation_date": 1493602901, "answer_id": 43713191, "question_id": 43713102, "link": "https://stackoverflow.com/questions/43713102/go-code-building-error-non-standard-import-fmt-in-standard-package-import-cy/43713191#43713191", "title": "Go code building error, non standard import &quot;fmt&quot; in standard package, import cycle not allowed", "body": "<p>I haven't seen this, but try fixing your paths:</p>\n\n<p>1) <code>export GOPATH=$HOME/go</code>. </p>\n\n<p>2) <code>export GOROOT=/usr/local/go</code>. </p>\n\n<p>3) <code>mkdir -p $GOPATH/src/github.com/nubrozaref/goTest</code></p>\n\n<p>4) <code>mv $GOPATH/src/goTest/ $GOPATH/src/github.com/nubrozaref/goTest</code></p>\n\n<p>5) if you want: <code>ln -s $GOPATH/src/github.com/nubrozaref/goTest ~/goTest</code></p>\n"}, {"comments": [{"owner": {"reputation": 838, "user_id": 5989200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0dgxm.jpg?s=128&g=1", "display_name": "nekketsuuu", "link": "https://stackoverflow.com/users/5989200/nekketsuuu"}, "reply_to_user": {"reputation": 21, "user_id": 4024824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6da35b0172a70ef815d474352f58341?s=128&d=identicon&r=PG&f=1", "display_name": "nubrozaref", "link": "https://stackoverflow.com/users/4024824/nubrozaref"}, "edited": false, "score": 1, "creation_date": 1493603676, "post_id": 43713193, "comment_id": 74470449, "body": "@nubrozaref Because <code>$GOPATH</code> is different from <code>$GOROOT</code>. Read <a href=\"https://golang.org/cmd/go/#hdr-Environment_variables\" rel=\"nofollow noreferrer\">this reference</a> and <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">this</a>."}], "tags": [], "owner": {"reputation": 838, "user_id": 5989200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0dgxm.jpg?s=128&g=1", "display_name": "nekketsuuu", "link": "https://stackoverflow.com/users/5989200/nekketsuuu"}, "is_accepted": true, "score": 2, "last_activity_date": 1493603689, "last_edit_date": 1493603689, "creation_date": 1493602924, "answer_id": 43713193, "question_id": 43713102, "link": "https://stackoverflow.com/questions/43713102/go-code-building-error-non-standard-import-fmt-in-standard-package-import-cy/43713193#43713193", "title": "Go code building error, non standard import &quot;fmt&quot; in standard package, import cycle not allowed", "body": "<p>Set <code>$GOPATH</code>, <code>$GOROOT</code>, and <code>$GOBIN</code> <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">correctly</a>. In this case, they should be as follows.</p>\n\n<pre><code>export GOPATH=\"$HOME/go\"\nexport GOROOT=\"/usr/local/go\"\n</code></pre>\n\n<p>Also, locate the source code correctly. Maybe it should be under <code>$GOPATH/src/github.com/&lt;your id&gt;/&lt;repository name&gt;/</code></p>\n\n<p>(If you use newer version of Go (>=1.8), you don't have to set <code>$GOPATH</code> and others. <a href=\"https://beta.golang.org/doc/go1.8#gopath\" rel=\"nofollow noreferrer\">Details here.</a>)</p>\n"}], "owner": {"reputation": 21, "user_id": 4024824, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6da35b0172a70ef815d474352f58341?s=128&d=identicon&r=PG&f=1", "display_name": "nubrozaref", "link": "https://stackoverflow.com/users/4024824/nubrozaref"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2694, "favorite_count": 0, "accepted_answer_id": 43713193, "answer_count": 2, "score": 1, "last_activity_date": 1493627109, "creation_date": 1493601943, "last_edit_date": 1493627109, "question_id": 43713102, "link": "https://stackoverflow.com/questions/43713102/go-code-building-error-non-standard-import-fmt-in-standard-package-import-cy", "title": "Go code building error, non standard import &quot;fmt&quot; in standard package, import cycle not allowed", "body": "<p>I've been working in go for a little while and this weekend I wanted to try to deploy some server code. When I run <code>go build</code> on some very simple code to test if Go is working I get this error:</p>\n\n<pre><code>can't load package: ($HOME)/go/src/goTest/main.go:4:2: non-standard \nimport \"fmt\" in standard package \"goTest\"\nimport cycle not allowed\npackage goTest\n        imports fmt\n        imports errors\n        imports runtime\n        imports runtime/internal/atomic\n        imports unsafe\n        imports runtime\n</code></pre>\n\n<p>In my ~/.bashrc I'm running this to set environment variables.</p>\n\n<pre><code>export GOPATH=/usr/local/go\nexport GOBIN=$GOPATH/bin\nexport PATH=$PATH:$GOBIN\n</code></pre>\n\n<p>My go workspace is in <code>$HOME/go</code> and my go install is at the default <code>/usr/local/go</code>. Any help is appreciated</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"test\")\n}\n</code></pre>\n\n<p>Edit: <code>go version</code> is <code>go1.6 linux/amd64</code></p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493594817, "post_id": 43711869, "comment_id": 74468714, "body": "A build doesn&#39;t happen in the current directory. Would the <code>-work</code> flag suffice, which leaves the temp working directory?"}, {"owner": {"reputation": 1037, "user_id": 377252, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Dfc8O.jpg?s=128&g=1", "display_name": "ehiller", "link": "https://stackoverflow.com/users/377252/ehiller"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493656515, "post_id": 43711869, "comment_id": 74488834, "body": "@JimB - I am using that flag - that is essentially what I was referring to with &#39;some script to grab the header each time from the working directory&#39; - Do you suppose that is my only option, write a post-compilation script that grabs the header from the work directory after compilation?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493657610, "post_id": 43711869, "comment_id": 74489403, "body": "Yes, you would need to copy it from the temp dir, or generate it with the cgo tool. If you&#39;re not building a C shared library, why do you need the header?"}, {"owner": {"reputation": 1037, "user_id": 377252, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Dfc8O.jpg?s=128&g=1", "display_name": "ehiller", "link": "https://stackoverflow.com/users/377252/ehiller"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1494007637, "post_id": 43711869, "comment_id": 74661826, "body": "Just for ease of use. In-editor autocomplete. The niceties is all, no functional NEED, just a developer&#39;s <i>want</i>."}], "owner": {"reputation": 1037, "user_id": 377252, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/Dfc8O.jpg?s=128&g=1", "display_name": "ehiller", "link": "https://stackoverflow.com/users/377252/ehiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493595182, "creation_date": 1493590158, "last_edit_date": 1493595182, "question_id": 43711869, "link": "https://stackoverflow.com/questions/43711869/on-go-build-creating-cgo-headerfile", "title": "On `go build` creating cgo headerfile", "body": "<p>Short of it is in the title... I'm trying to have the headerfile that cgo already creates <code>cgo_export.h</code>  - but sticks in the working directory - created in a static location that I can reliably access (as working directories can and should change). Directly using <code>cgo</code> provides for a <code>-headerfile</code> option, but I see no such option within the build options of <code>go build</code>, nor a way of passing options to <code>cgo</code> from <code>go build</code>.</p>\n\n<p>Besides using a second run of <code>cgo</code>(or some script to grab the header each time from the working directory) is there any way to produce the header file with <code>go build</code></p>\n"}, {"tags": ["go", "shared-libraries", "cross-compiling"], "answers": [{"tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": false, "score": 0, "last_activity_date": 1493648989, "last_edit_date": 1493648989, "creation_date": 1493627560, "answer_id": 43716378, "question_id": 43710987, "link": "https://stackoverflow.com/questions/43710987/cross-compile-shared-libraries/43716378#43716378", "title": "Cross compile shared libraries", "body": "<p>when building a client use : </p>\n\n<pre><code>package main \n</code></pre>\n\n<p>... however building a library use : </p>\n\n<pre><code>package mylibname\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1493832701, "post_id": 43766155, "comment_id": 74574379, "body": "To say, don&#39;t works on my machine. ld unrecognizes flags and gcc returns exit status 1"}, {"owner": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1493833350, "post_id": 43766155, "comment_id": 74574748, "body": "<code>package main</code> and <code>-buildmode=c-shared</code> won&#39;t work together. I assumed the OP was aware of it as another answer already stated that problem. I have edited my answer to clarify this point. Thank you very much!"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1493836731, "post_id": 43766155, "comment_id": 74576762, "body": "I have always misspelled CGO_ENABLED... Now it &quot;works&quot; in a sense that it doesn&#39;t throw any errors anymore. I whish the solution would have been without installing a cross compilation environment."}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1493836876, "post_id": 43766155, "comment_id": 74576829, "body": "@hasanyasin I have no problems with <code>package main</code> on OS X."}, {"owner": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "edited": false, "score": 0, "creation_date": 1493837488, "post_id": 43766155, "comment_id": 74577181, "body": "If package is main, we are cross-compiling with GOOS=darwin on a linux machine and we want it to produce a shared package, then linking fails as uvelichitel mentioned.  If you use pure go, then cross-compiling is a breeze. If you use non-Go libraries, then there is no way around having those libraries for the target platform. Can&#39;t play lego without lego bricks. :)"}, {"owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "edited": false, "score": 0, "creation_date": 1507115130, "post_id": 43766155, "comment_id": 80079983, "body": "Somehow (Go 1.9, macOS 10.13) it only works when I have the package named <code>main</code>. Otherwise I get a <code>current ar archive</code> not <code>Mach-O 64-bit dynamically linked shared library x86_64</code>."}], "tags": [], "owner": {"reputation": 6075, "user_id": 1191620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c0116c0a6ef4ebfa0eb37747b613c61?s=128&d=identicon&r=PG", "display_name": "hasanyasin", "link": "https://stackoverflow.com/users/1191620/hasanyasin"}, "is_accepted": true, "score": 6, "last_activity_date": 1493833541, "last_edit_date": 1493833541, "creation_date": 1493831250, "answer_id": 43766155, "question_id": 43710987, "link": "https://stackoverflow.com/questions/43710987/cross-compile-shared-libraries/43766155#43766155", "title": "Cross compile shared libraries", "body": "<p>The problem you face is not actually about compiling shared libraries or executables, but about using cgo and trying to cross-compile. (Still, if you want a library, not an executable, package name shouldn't be <code>main</code>.)</p>\n\n<p>When cross-compiling, cgo is disabled by default. If you add the environment variable <code>CGO_ENABLED=1</code>, then your example will work:</p>\n\n<pre><code>CGO_ENABLED=1 GOOS=darwin go build -o libdoubler.dylib -buildmode=c-shared doubler\n</code></pre>\n\n<p>Keep in mind that using cgo while cross-compiling will be cumbersome. You will need to make sure that C libraries for the target platform are ready on your host machine. If it is not really necessary, stay away from cgo. If you have to, then you may consider compiling on the target machine instead of dealing with the maintenance of cross-compiling with cgo.</p>\n"}], "owner": {"reputation": 13244, "user_id": 317915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/86d01c87cc6f22c8445661b72b6b0d78?s=128&d=identicon&r=PG", "display_name": "topskip", "link": "https://stackoverflow.com/users/317915/topskip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2384, "favorite_count": 1, "accepted_answer_id": 43766155, "answer_count": 2, "score": 4, "last_activity_date": 1493833541, "creation_date": 1493583942, "last_edit_date": 1493625402, "question_id": 43710987, "link": "https://stackoverflow.com/questions/43710987/cross-compile-shared-libraries", "title": "Cross compile shared libraries", "body": "<p>I'd like to know if it is possible (and if yes: how) to cross compile shared libraries with Go. Say I have this code:</p>\n\n<pre><code>package main\n\nimport \"C\"\n\n//export DoubleIt\nfunc DoubleIt(x int) int {\n    return x * 2\n}\n\nfunc main() {}\n</code></pre>\n\n<p>in <code>src/doubler/main.go</code>. On Mac I can run</p>\n\n<pre><code>go build -o libdoubler.dylib -buildmode=c-shared doubler\n</code></pre>\n\n<p>to get a shared library called <code>libdoubler.dylib</code>. Similar on linux, just with the extension <code>.so</code>.</p>\n\n<p>Now I'd like to use Linux as the main platform to build my libraries (for Mac and Windows). What are my options? </p>\n\n<p>Setting <code>GOOS</code> to <code>darwin</code> and running the above on linux, I get</p>\n\n<pre><code>can't load package: package doubler: no buildable Go source files in /home/patrick/Desktop/go/src/doubler\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["object", "go", "send"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493581321, "post_id": 43710406, "comment_id": 74465110, "body": "There are literally an infinite number of ways to &quot;send objects&quot;. What encoding do you want to use?"}], "answers": [{"comments": [{"owner": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "edited": false, "score": 0, "creation_date": 1493669141, "post_id": 43710619, "comment_id": 74495104, "body": "Thanks for the sample. If I have multiple objects that I have to send on the wire? Any pointers on how to accomplish it?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "edited": false, "score": 0, "creation_date": 1493669305, "post_id": 43710619, "comment_id": 74495188, "body": "You can use slices, maps, arrays.. it&#39;s up to you really, both <code>json</code> and <code>gob</code> can handle those just fine."}, {"owner": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "edited": false, "score": 0, "creation_date": 1493745596, "post_id": 43710619, "comment_id": 74530306, "body": "I checked out maps and slices and using both was able to send a set of objects. However, I would also like to be able to send stream of data continuously which seems to not work."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "edited": false, "score": 0, "creation_date": 1493748635, "post_id": 43710619, "comment_id": 74531904, "body": "It would be better if you open a new question. One with precise explanation of what you&#39;re trying to achieve, with code you have so far, with what worked and what didn&#39;t, the desired result you would like to get and the undesired result you actually got."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1493582674, "last_edit_date": 1493582674, "creation_date": 1493581516, "answer_id": 43710619, "question_id": 43710406, "link": "https://stackoverflow.com/questions/43710406/golang-send-and-receive-objects/43710619#43710619", "title": "golang send and receive objects", "body": "<p>You'll first want to declare a type for your messages. Something like:</p>\n\n<pre><code>type Message struct {\n    From      string\n    To        string\n    Text      string\n    CreatedAt time.Time\n}\n</code></pre>\n\n<p>Then you'll need to decide how you want your new types to be encoded to/decoded from bytes, since all you can send through the wire are bytes.\nYou can for example send your messages as <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">json</a>, as <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\">xml</a>, or as <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">gob</a>, etc. Which one you choose depends on what your requirements are, <code>json</code> is ubiquitous and readable but <code>gob</code> on the other hand is much faster, at least that's what I heard, haven't really used <code>gob</code> myself yet.</p>\n\n<p>For example if you go with <code>json</code>.</p>\n\n<pre><code>// receive\nvar m Message\nif _, err := json.NewDecoder(conn).Decode(&amp;m); err != nil {\n    panic(err)\n}\n\n// send\nif err := json.NewEncoder(conn).Encode(m); err != nil {\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 3020, "user_id": 1072825, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a27932ed81093b975e0b2619367cce95?s=128&d=identicon&r=PG", "display_name": "Pavan K", "link": "https://stackoverflow.com/users/1072825/pavan-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 43710619, "answer_count": 1, "score": 1, "last_activity_date": 1493582674, "creation_date": 1493580206, "question_id": 43710406, "link": "https://stackoverflow.com/questions/43710406/golang-send-and-receive-objects", "title": "golang send and receive objects", "body": "<p>I am able to send and receive strings in golang using the following code: </p>\n\n<pre><code>//send side\nmessage.Buf.WriteTo(conn)\n\n//receive side\nmessage, err := bufio.NewReader(conn).ReadString('\\n')\n    if err != nil {\n        panic(err)\n    }\nfmt.Print(\"Message from client: \", string(message))\n</code></pre>\n\n<p>However, I would like to send the entire message object and receive it at the receive side</p>\n\n<p>Something like:</p>\n\n<pre><code>//send side\nmessage.WriteTo(conn)\n\n//receive side\nmessage,err :=bufio.NewReader(conn).ReadMessageObject()\n</code></pre>\n\n<p>I am new to Golang and any pointers are extremely helpful.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk", "amazon-ses"], "answers": [{"comments": [{"owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "edited": false, "score": 0, "creation_date": 1493578858, "post_id": 43710040, "comment_id": 74464296, "body": "Thank you so much! Did I understood correctly that PAYLOAD must be base64 encoded? Also, where can I see which MIME headers are required?"}, {"owner": {"reputation": 21821, "user_id": 775544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e243c267efa20cc8d317f9b73c28c7f1?s=128&d=identicon&r=PG", "display_name": "Anthony Neace", "link": "https://stackoverflow.com/users/775544/anthony-neace"}, "reply_to_user": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "edited": false, "score": 2, "creation_date": 1493579055, "post_id": 43710040, "comment_id": 74464358, "body": "The SDK should base64 encode <code>Data</code> in RawMessage for you (<a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/ses/api.go#L8032\" rel=\"nofollow noreferrer\">reference</a>), and for more info on headers check here: <a href=\"http://docs.aws.amazon.com/ses/latest/DeveloperGuide/email-format.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/ses/latest/DeveloperGuide/email-format.h&zwnj;&#8203;tml</a>"}], "tags": [], "owner": {"reputation": 21821, "user_id": 775544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e243c267efa20cc8d317f9b73c28c7f1?s=128&d=identicon&r=PG", "display_name": "Anthony Neace", "link": "https://stackoverflow.com/users/775544/anthony-neace"}, "is_accepted": true, "score": 10, "last_activity_date": 1493578183, "last_edit_date": 1493578183, "creation_date": 1493577824, "answer_id": 43710040, "question_id": 43709761, "link": "https://stackoverflow.com/questions/43709761/aws-ses-sdk-send-email-with-attachments/43710040#43710040", "title": "AWS SES SDK send email with attachments", "body": "<p>To send attachments, use the SendRawEmail API instead of SendEmail. AWS documentation will generally refer to this as constructing a 'raw message' instead of explicitly calling out how to send attachments.</p>\n\n<h2>Example</h2>\n\n<p>From the AWS SDK for Go API Reference, linked below:</p>\n\n<pre><code>params := &amp;ses.SendRawEmailInput{\n    RawMessage: &amp;ses.RawMessage{ // Required\n        Data: []byte(\"PAYLOAD\"), // Required\n    },\n    ConfigurationSetName: aws.String(\"ConfigurationSetName\"),\n    Destinations: []*string{\n        aws.String(\"Address\"), // Required\n        // More values...\n    },\n    FromArn:       aws.String(\"AmazonResourceName\"),\n    ReturnPathArn: aws.String(\"AmazonResourceName\"),\n    Source:        aws.String(\"Address\"),\n    SourceArn:     aws.String(\"AmazonResourceName\"),\n    Tags: []*ses.MessageTag{\n        { // Required\n            Name:  aws.String(\"MessageTagName\"),  // Required\n            Value: aws.String(\"MessageTagValue\"), // Required\n        },\n        // More values...\n    },\n}\nresp, err := svc.SendRawEmail(params)\n</code></pre>\n\n<h2>Further Reading</h2>\n\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/ses/latest/APIReference/API_SendRawEmail.html\" rel=\"noreferrer\">Amazon SES API Reference - SendRawEmail</a></li>\n<li><a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/ses/#SES.SendRawEmail\" rel=\"noreferrer\">AWS SDK for Go API Reference - SendRawEmail</a></li>\n<li><a href=\"http://docs.aws.amazon.com/ses/latest/DeveloperGuide/send-email-raw.html\" rel=\"noreferrer\">AWS SES Documentation - Sending Raw Email Using the Amazon SES API</a> - This is a good primer for email standards and constructing raw messages (including a section about attachments).</li>\n</ul>\n"}], "owner": {"reputation": 646, "user_id": 4335622, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh5.googleusercontent.com/-OeTdPDQRltk/AAAAAAAAAAI/AAAAAAAAAE4/KXT0pHbxg9s/photo.jpg?sz=128", "display_name": "i.van", "link": "https://stackoverflow.com/users/4335622/i-van"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12896, "favorite_count": 2, "accepted_answer_id": 43710040, "answer_count": 1, "score": 7, "last_activity_date": 1493578183, "creation_date": 1493576321, "last_edit_date": 1493577837, "question_id": 43709761, "link": "https://stackoverflow.com/questions/43709761/aws-ses-sdk-send-email-with-attachments", "title": "AWS SES SDK send email with attachments", "body": "<p>I'm using the <a href=\"https://github.com/aws/aws-sdk-go\" rel=\"noreferrer\">official AWS Golang SDK</a> to integrate with SES but can't find any information about how to add some attachments (pdf file represented as []byte in code) to the email. </p>\n\n<p>Could you help me?</p>\n\n<p>The current email sending code looks like this:</p>\n\n<pre><code>sesEmailInput := &amp;ses.SendEmailInput{\n    Destination: &amp;ses.Destination{\n        ToAddresses: []*string{aws.String(\"To address\")},\n    },\n    Message: &amp;ses.Message{\n        Subject: &amp;ses.Content{\n            Data: aws.String(\"Some text\"),\n        },\n        Body: &amp;ses.Body{\n            Html: &amp;ses.Content{\n                Data: aws.String(\"Some Text\"),\n            },\n        },\n    },\n    Source: aws.String(\"From address\"),\n    ReplyToAddresses: []*string{\n        aws.String(\"From address\"),\n    },\n}\nif _, err := s.sesSession.SendEmail(sesEmailInput); err != nil {\n    return err\n}\n</code></pre>\n"}, {"tags": ["go", "scanf"], "answers": [{"comments": [{"owner": {"reputation": 419, "user_id": 3887956, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/061a4cb0652eb9a8dc7599fe93dbdb5c?s=128&d=identicon&r=PG&f=1", "display_name": "dodo254", "link": "https://stackoverflow.com/users/3887956/dodo254"}, "edited": false, "score": 3, "creation_date": 1493629893, "post_id": 43711185, "comment_id": 74476824, "body": "What is the difference between <code>Scanf</code> and <code>Scan</code>? This may sound trivial, but I&#39;m kinda confused. What if format in <code>Scanf</code> is <code>%d smth %s</code>? It seems like &quot;<code>smth</code>&quot; doesn&#39;t have any purpose."}], "tags": [], "owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "is_accepted": false, "score": 13, "last_activity_date": 1493650985, "last_edit_date": 1493650985, "creation_date": 1493585463, "answer_id": 43711185, "question_id": 43708943, "link": "https://stackoverflow.com/questions/43708943/understanding-scanf-in-go/43711185#43711185", "title": "Understanding Scanf in Go", "body": "<p>You have to first take your input as an int and then print the hex value : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    var e int\n\n    fmt.Scanf(\"%d\", &amp;e)\n    fmt.Fprintf(os.Stdout, \"%#X\\n\", e)\n\n}\n</code></pre>\n\n<p>Output is : </p>\n\n<pre><code>go run main.go \n10\n0XA\n</code></pre>\n\n<p>For multiple inputs :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    var e int\n    var s string\n\n    fmt.Scanf(\"%d %s\", &amp;e, &amp;s)\n    fmt.Fprintf(os.Stdout, \"%#X \\t%s\\n\", e, s)\n\n}\n</code></pre>\n\n<p>Output is : </p>\n\n<pre><code>go run main.go\n10 hello\n0XA     hello\n</code></pre>\n\n<p><strong>Update : fmt.Scanf() vs fmt.Scan()</strong></p>\n\n<p>Scan is able to loop : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    var e int\n    var f int\n    var g int\n\n    fmt.Scan(&amp;e, &amp;f, &amp;g)\n    fmt.Fprintf(os.Stdout, \"%d - %d - %d\", e, f, g)\n}\n</code></pre>\n\n<p>Output is : </p>\n\n<pre><code>go run main.go\n10\n11\n12\n10 - 11 - 12\n</code></pre>\n\n<p>Scanf is able to \"\"\"filter\"\"\" from a formated string : </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n\n    var e int\n    var f int\n\n    fmt.Scanf(\"%d Scanf %d\", &amp;e, &amp;f)\n    fmt.Fprintf(os.Stdout, \"%d - %d\", e, f)\n}\n</code></pre>\n\n<p>Output is : </p>\n\n<pre><code>go run main.go \n10 Scanf 11\n10 - 11\n</code></pre>\n"}], "owner": {"reputation": 419, "user_id": 3887956, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/061a4cb0652eb9a8dc7599fe93dbdb5c?s=128&d=identicon&r=PG&f=1", "display_name": "dodo254", "link": "https://stackoverflow.com/users/3887956/dodo254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17816, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1493734730, "creation_date": 1493571395, "last_edit_date": 1493734730, "question_id": 43708943, "link": "https://stackoverflow.com/questions/43708943/understanding-scanf-in-go", "title": "Understanding Scanf in Go", "body": "<p>I am not sure how to use <code>Scanf</code> function. Let's say I want to input number 10 on scan. By doing that, shouldn't the output be 0xA?</p>\n\n<p>Also, how do I use the function with two or more scan arguments (e.g. <code>fmt.Scanf(\"%x\", &amp;e, &amp;f, &amp;g)</code>)?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var e int\n\n    fmt.Scanf(\"%#X\", &amp;e)\n    fmt.Println(e)\n\n}\n</code></pre>\n"}, {"tags": ["arrays", "pointers", "memory", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493570082, "post_id": 43708273, "comment_id": 74461410, "body": "<a href=\"https://play.golang.org/p/H1V_hFZEwc\" rel=\"nofollow noreferrer\">modified slice example</a>"}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493570270, "post_id": 43708273, "comment_id": 74461466, "body": "@mkopriva Lmao hello again. Could you (again) post that as an answer so that I can accept it?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493571668, "post_id": 43708273, "comment_id": 74461918, "body": "I&#39;ve now added the answer with a little bit nicer solution."}], "answers": [{"comments": [{"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1493573463, "post_id": 43708960, "comment_id": 74462487, "body": "It seems that your solution does not describe the same address. I made a slight modification: <a href=\"https://play.golang.org/p/SZRl-UA3Wu\" rel=\"nofollow noreferrer\">play.golang.org/p/SZRl-UA3Wu</a>"}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1493573662, "post_id": 43708960, "comment_id": 74462562, "body": "And also, shouldn&#39;t the size of the casted array be 6?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1493573928, "post_id": 43708960, "comment_id": 74462647, "body": "Size <code>3</code> is meant to serve as an example that it doesn&#39;t have to be the same as the original array&#39;s len, it&#39;s up to you what size the new array should have, you could set it to <code>10</code> but the data after the first 6 elements might be garbage."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1493574100, "post_id": 43708960, "comment_id": 74462709, "body": "The new arrays will hold a copy of the original&#39;s data, that&#39;s why the elements of those new arrays are in a different memory location as those of the original."}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 0, "creation_date": 1493574179, "post_id": 43708960, "comment_id": 74462728, "body": "Why is it at the same location without the * on the outside? I&#39;d rather the new array describe the exact same memory location as the byte slice does. (i.e. no copying)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "edited": false, "score": 2, "creation_date": 1493575415, "post_id": 43708960, "comment_id": 74463098, "body": "In your example <code>c</code> is not an array but a <code>pointer to an array</code>, and it&#39;s a pointer to the same address as the <code>data</code> slice, just different in type (<a href=\"https://play.golang.org/p/N7P3XonBCq\" rel=\"nofollow noreferrer\">play.golang.org/p/N7P3XonBCq</a>). As soon as you dereference it (<code>*c</code>) you get a copy of its contents <a href=\"https://play.golang.org/p/fSLGpf8VnS\" rel=\"nofollow noreferrer\">play.golang.org/p/fSLGpf8VnS</a>. It&#39;s up to you which one you prefer."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1493571509, "creation_date": 1493571509, "answer_id": 43708960, "question_id": 43708273, "link": "https://stackoverflow.com/questions/43708273/converting-a-pointer-to-an-array-in-go/43708960#43708960", "title": "Converting a pointer to an array in Go", "body": "<p>It's almost the same as with slices but since Go arrays are just <code>values laid out sequentially</code> as opposed to being represented by a <code>pointer</code>, <code>cap</code>, and <code>len</code> like slices are, you don't need to define the array's memory layout.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"unsafe\"\n)\n\nvar data = []byte(`foobar`)\n\nfunc main() {\n    rv := reflect.ValueOf(data)\n\n    ptr := rv.Pointer()\n    b := *(*[3]byte)(unsafe.Pointer(ptr))\n\n    fmt.Printf(\"%T %q\\n\", b, b)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/r9yi9OdDIC\" rel=\"nofollow noreferrer\">https://play.golang.org/p/r9yi9OdDIC</a></p>\n"}], "owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1759, "favorite_count": 0, "accepted_answer_id": 43708960, "answer_count": 1, "score": 2, "last_activity_date": 1493571509, "creation_date": 1493567463, "last_edit_date": 1495542864, "question_id": 43708273, "link": "https://stackoverflow.com/questions/43708273/converting-a-pointer-to-an-array-in-go", "title": "Converting a pointer to an array in Go", "body": "<p>This question is similar to <a href=\"https://stackoverflow.com/questions/43591047/converting-a-pointer-to-a-byte-slice\">this one</a>, only I want to convert a pointer and a length to a fixed-size Golang array.</p>\n\n<p>For a slice, the <a href=\"https://stackoverflow.com/a/43592538/3302584\">solution</a> was to create a struct with the relevant information, and cast it directly, as follows:</p>\n\n<pre><code>// Slice memory layout\nvar sl = struct {\n    addr uintptr\n    len  int\n    cap  int\n}{addr, length, length}\n\n// Use unsafe to turn sl into a []byte.\nb := *(*[]byte)(unsafe.Pointer(&amp;sl))\n</code></pre>\n\n<p>How would you create an array for that specified memory instead?</p>\n"}, {"tags": ["go", "google-cloud-datastore", "gql"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493565193, "post_id": 43707878, "comment_id": 74459807, "body": "What error do you get? Or what other evidence do you have that it&#39;s incorrect?"}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493565693, "post_id": 43707878, "comment_id": 74459964, "body": "cannot use <code>&quot;SELECT * FROM Task WHERE Uuid = \\&quot;foobar\\&quot; ORDER BY CreateTimeMs DESC LIMIT 1&quot; (type string) as type *&quot;cloud.google.com&#47;go&#47;datastore&quot;.Query in argument to client.Run</code>. This makes sense, the point is more, that I don&#39;t know which function to use for GQL queries..."}], "answers": [{"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493710576, "post_id": 43708132, "comment_id": 74508046, "body": "Thanks @mkoprive, I&#39;m aware of this. The thing is, I have a bunch of GQL queries that I would like to run directly. But, I will accept this answer because for whatever reason the friendly Go community already started downvoting this question."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493713406, "post_id": 43708132, "comment_id": 74509567, "body": "I&#39;m sorry I&#39;ve totally misunderstood your question. I did a quick search and it seems to me that you&#39;re stuck with the <code>Query</code> type, I can&#39;t find anything on <code>GQL</code> in the Go specific documentation on appengine."}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493724714, "post_id": 43708132, "comment_id": 74516414, "body": "No worries, thanks. An upvote to 0 would be appreciated though :-)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 1, "creation_date": 1493724788, "post_id": 43708132, "comment_id": 74516460, "body": "There you go, just to be clear it wasn&#39;t me who downvoted ;)."}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493758610, "post_id": 43708132, "comment_id": 74537253, "body": "o, oops, haha. Thanks though ;-)"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1493567504, "last_edit_date": 1493567504, "creation_date": 1493566682, "answer_id": 43708132, "question_id": 43707878, "link": "https://stackoverflow.com/questions/43707878/how-to-run-a-datastore-gql-query-in-golang/43708132#43708132", "title": "How to run a Datastore GQL query in Golang?", "body": "<p>Take a look at the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Query\" rel=\"nofollow noreferrer\">Query</a> type documentation, from looking at its methods and reading their respective documentation you should be able to understand how to translate your SQL into <code>datastore.Query</code> specific method calls.</p>\n\n<p>For example your sql can be written as:</p>\n\n<pre><code>q := datastore.NewQuery(\"Task\").Filter(\"Uuid =\", \"FOOBAR\").Order(\"-CreateTimeMs\").Limit(1)\n</code></pre>\n\n<p>This just builds your Query value, to get the actual result you need to <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Query.Run\" rel=\"nofollow noreferrer\">run</a> the query to get an <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Iterator\" rel=\"nofollow noreferrer\">iterator</a> whose <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Iterator.Next\" rel=\"nofollow noreferrer\">Next method</a> can be used to read the result.</p>\n\n<p>If you want to avoid the run-iterate-next dance you can use the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Query.GetAll\" rel=\"nofollow noreferrer\">GetAll</a> query method.</p>\n\n<pre><code>var tt = []*Task{}\nq := datastore.NewQuery(\"Task\").Filter(\"Uuid =\", \"FOOBAR\").Order(\"-CreateTimeMs\").Limit(1)\nif _, err := q.GetAll(tt); err != nil {\n    panic(err)\n}\nlog.Println(tt[0]) // your task\n</code></pre>\n\n<p>Read more here:</p>\n\n<ul>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/queries\" rel=\"nofollow noreferrer\">Datastore Queries</a></li>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/retrieving-query-results\" rel=\"nofollow noreferrer\">Retrieving query results</a></li>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/query-restrictions\" rel=\"nofollow noreferrer\">Query Restrictions</a></li>\n<li><a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/query-cursors\" rel=\"nofollow noreferrer\">Query Cursors</a></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1507031093, "post_id": 46543809, "comment_id": 80041473, "body": "Thanks for the info Wim"}], "tags": [], "owner": {"reputation": 26, "user_id": 1905881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0e177d75c82e94ef27c08730b1c0f2b?s=128&d=identicon&r=PG", "display_name": "wimvanleuven", "link": "https://stackoverflow.com/users/1905881/wimvanleuven"}, "is_accepted": true, "score": 1, "last_activity_date": 1507031047, "creation_date": 1507031047, "answer_id": 46543809, "question_id": 43707878, "link": "https://stackoverflow.com/questions/43707878/how-to-run-a-datastore-gql-query-in-golang/46543809#46543809", "title": "How to run a Datastore GQL query in Golang?", "body": "<p>I was searching to solve exactly the same problem when I came across this note in the <a href=\"https://cloud.google.com/datastore/docs/reference/gql_reference\" rel=\"nofollow noreferrer\">GQL documentation</a>:</p>\n\n<blockquote>\n  <p><strong>Note:</strong> Google Cloud Client Library for Java and Google Cloud Client Library for Ruby support GQL, but other Google Cloud client libraries do not.</p>\n</blockquote>\n\n<p>So that's a no-go ... </p>\n\n<p>However, it should be feasible to implement it over the <a href=\"https://cloud.google.com/datastore/docs/reference/rest/v1/projects/runQuery\" rel=\"nofollow noreferrer\">REST api projects.runQuery</a> but then you have to unmarshal the result into structs by yourself.</p>\n"}], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 989, "favorite_count": 0, "accepted_answer_id": 46543809, "answer_count": 2, "score": 2, "last_activity_date": 1605178626, "creation_date": 1493564974, "last_edit_date": 1493710501, "question_id": 43707878, "link": "https://stackoverflow.com/questions/43707878/how-to-run-a-datastore-gql-query-in-golang", "title": "How to run a Datastore GQL query in Golang?", "body": "<p>I have the following query in GQL:</p>\n\n<p><code>\"SELECT * FROM Task WHERE Uuid = \\\"FOOBAR\\\" ORDER BY CreateTimeMs DESC LIMIT 1\"</code></p>\n\n<p>How can I directly run this query in Golang?</p>\n\n<p><code>query := datastore.NewQuery(\"SELECT * FROM Task WHERE Uuid = \\\"FOOBAR\\\" ORDER BY CreateTimeMs DESC LIMIT 1\")</code> seems to be incorrect.</p>\n\n<p><strong>UPDATE:</strong><br>\nI am very aware of the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Query\" rel=\"nofollow noreferrer\">Query types</a>. The thing is that I would like to use GQL directly instead of translating them into Query types.</p>\n"}, {"tags": ["regex", "go", "re2"], "answers": [{"tags": [], "owner": {"reputation": 124629, "user_id": 7586, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Ryqtb.jpg?s=128&g=1", "display_name": "Kobi", "link": "https://stackoverflow.com/users/7586/kobi"}, "is_accepted": true, "score": 12, "last_activity_date": 1493556277, "creation_date": 1493556277, "answer_id": 43706505, "question_id": 43706322, "link": "https://stackoverflow.com/questions/43706322/regex-newline-and-whitespace-in-golang/43706505#43706505", "title": "Regex newline and whitespace in golang", "body": "<p>By default <code>.</code> does not match newlines. To change that, use the <code>s</code> flag:</p>\n\n<pre><code>(?s)/system.sensor\\d\\d.*DeviceID=(?P&lt;sensor&gt;.*)\n</code></pre>\n\n<p>From: <a href=\"https://github.com/google/re2/blob/7bab3dc83df6a838cc004cc7a7f51d5fe1a427d5/doc/syntax.txt#L65,L68\" rel=\"noreferrer\">RE2 regular expression syntax reference</a></p>\n\n<blockquote>\n  <p><code>(?flags)</code> set flags within current group; non-capturing<br>\n  <code>s</code> -  let <code>.</code> match <code>\\n</code> (default false)</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3525, "user_id": 7225971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3eb7d161a79e0f2f674929bbdc6a714?s=128&d=identicon&r=PG", "display_name": "Mateus", "link": "https://stackoverflow.com/users/7225971/mateus"}, "is_accepted": false, "score": 3, "last_activity_date": 1493562166, "creation_date": 1493562166, "answer_id": 43707450, "question_id": 43706322, "link": "https://stackoverflow.com/questions/43706322/regex-newline-and-whitespace-in-golang/43707450#43707450", "title": "Regex newline and whitespace in golang", "body": "<p>If you want to get these properties using regex in a shorter way, you'd like to firstly use <code>(?s)</code> [Meaning &amp; use in Kobi's answer]. And for each property use this syntax:<br>\n<code>.*ExampleProperty=(?P&lt;example&gt;[^\\n]*).*</code>:</p>\n\n<blockquote>\n  <p><code>.*</code> - \"Ignores\" all text at the <strong>beginning</strong> and at the <strong>end</strong> (Match, but doesn't capture);\n  <br><code>ExampleProperty=</code> - Stop \"ignoring\" the text;\n  <br><code>(?P&lt;example&gt;...)</code> - Named capture group;\n  <br><code>[^\\n*]</code> - Matches the value from the property till it find a new line character.</p>\n</blockquote>\n\n<p>So, this is the short regex that shall match your text and get all these properties:</p>\n\n<pre><code>(?s)\\/system.\\/sensor\\d\\d.+DeviceID=(?P&lt;sensor&gt;[^\\n]*).*CurrentReading=(?P&lt;reading&gt;[^\\n]*).*SensorType=(?P&lt;type&gt;[^\\n]*).*HealthState=(?P&lt;health&gt;[^\\n]*).*\n</code></pre>\n\n<p></p>\n\n<pre><code>&lt;sensor&gt; = 37-Fuse \n&lt;reading&gt; = 49\n&lt;type&gt; = Temperature\n&lt;health&gt; = Ok\n</code></pre>\n\n<p><strong>[DEMO]</strong>: <a href=\"https://regex101.com/r/Awgqpk/1\" rel=\"nofollow noreferrer\">https://regex101.com/r/Awgqpk/1</a></p>\n"}], "owner": {"reputation": 794, "user_id": 2665391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1468977014/picture?type=large", "display_name": "Amal Ts", "link": "https://stackoverflow.com/users/2665391/amal-ts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7739, "favorite_count": 0, "accepted_answer_id": 43706505, "answer_count": 2, "score": 2, "last_activity_date": 1493562166, "creation_date": 1493555088, "last_edit_date": 1493555546, "question_id": 43706322, "link": "https://stackoverflow.com/questions/43706322/regex-newline-and-whitespace-in-golang", "title": "Regex newline and whitespace in golang", "body": "<p>I was trying to match the below string with a regex and get some values out of it.</p>\n\n<pre><code>/system1/sensor37\n  Targets\n  Properties\n    DeviceID=37-Fuse \n    ElementName=Power Supply\n    OperationalStatus=Ok\n    RateUnits=Celsius\n    CurrentReading=49\n    SensorType=Temperature\n    HealthState=Ok\n    oemhp_CautionValue=100\n    oemhp_CriticalValue=Not Applicable\n</code></pre>\n\n<p>Used the below regex for that</p>\n\n<pre><code>`/system1/sensor\\d\\d\\n.*\\n.*\\n\\s*DeviceID=(?P&lt;sensor&gt;.*)\\n.*\\n.*\\n.*\\n\\s*CurrentReading=(?P&lt;reading&gt;\\d*)\\n\\s*SensorType=Temperature\\n\\s*HealthState=(?P&lt;health&gt;.*)\\n`\n</code></pre>\n\n<p>Now my question is: Is there a better way to do it?\nI explicitly mentioned each new line and white space group in the string. But can I just say <code>/system.sensor\\d\\d.*DeviceID=(?P&lt;sensor&gt;.*)\\n*.</code> (It didn't work for me, but I believe there should be a way to it.)</p>\n"}, {"tags": ["go", "oauth-2.0", "google-identity"], "answers": [{"comments": [{"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1493615507, "post_id": 43707655, "comment_id": 74472894, "body": "I understand the flow now. header.payload.signature. Is the signature encryted using the client id? If so then can I decrypt the signature using secret key? I believe that client id is public key and secret is private key. Is my assumption correct?"}, {"owner": {"reputation": 11100, "user_id": 2157818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f122e6b4c044c93222b952d70aaec3ec?s=128&d=identicon&r=PG", "display_name": "Florent Morselli", "link": "https://stackoverflow.com/users/2157818/florent-morselli"}, "reply_to_user": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "edited": false, "score": 0, "creation_date": 1493844610, "post_id": 43707655, "comment_id": 74580925, "body": "The JWT is not encrypted but just encoded (Base64 Url Safe). The signature can be verified by using the public keys of the issuer. In your case the issuer is Google and the keys are available at <a href=\"https://www.googleapis.com/oauth2/v3/certs\" rel=\"nofollow noreferrer\">googleapis.com/oauth2/v3/certs</a> (or <a href=\"https://www.googleapis.com/oauth2/v1/certs\" rel=\"nofollow noreferrer\">googleapis.com/oauth2/v1/certs</a> for keys in PEM format)"}], "tags": [], "owner": {"reputation": 11100, "user_id": 2157818, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f122e6b4c044c93222b952d70aaec3ec?s=128&d=identicon&r=PG", "display_name": "Florent Morselli", "link": "https://stackoverflow.com/users/2157818/florent-morselli"}, "is_accepted": false, "score": 1, "last_activity_date": 1493844636, "last_edit_date": 1493844636, "creation_date": 1493563592, "answer_id": 43707655, "question_id": 43706248, "link": "https://stackoverflow.com/questions/43706248/cant-get-user-profile-info-using-oauth2-in-server-using-id-token-provided-by-cl/43707655#43707655", "title": "can&#39;t get user profile info using Oauth2 in server using id_token provided by client", "body": "<p>The <code>id_token</code> you received already contains the information of the user you need. </p>\n\n<p>See <a href=\"https://jwt.io\" rel=\"nofollow noreferrer\">https://jwt.io</a> to find a Go library to decode your token. </p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493844636, "creation_date": 1493554586, "question_id": 43706248, "link": "https://stackoverflow.com/questions/43706248/cant-get-user-profile-info-using-oauth2-in-server-using-id-token-provided-by-cl", "title": "can&#39;t get user profile info using Oauth2 in server using id_token provided by client", "body": "<p>I tried to log in using the google id on my web page. I logged the id_token from the user in console. Then I copied that and passed to a server and tried to get user info. But I get an error in golang server as</p>\n\n<blockquote>\n  <p>err is oauth2: cannot fetch token: 400 Bad Request\n  Response: {\n    \"error\" : \"invalid_grant\"\n  }</p>\n</blockquote>\n\n<p>This is my serve side code.</p>\n\n<pre><code>func main() {\ngo func() {\n    http.ListenAndServe(\":8123\", nil)\n}()\nhttp.HandleFunc(\"/\", serveFile)\nhttp.HandleFunc(\"/loginUser\", loginUser)\n&lt;-quit\n}\nfunc loginUser(rw http.ResponseWriter, req *http.Request) {\nid_token, _ := getIdToken(req)\nconf := oauth2.Config{\n    ClientID:     \"HIDDEN.apps.googleusercontent.com\",\n    ClientSecret: \"HIDDEN\",\n    Scopes: []string{\n        \"https://www.googleapis.com/auth/userinfo.email\",\n        \"https://www.googleapis.com/auth/userinfo.profile\",\n    },\n    Endpoint: google.Endpoint,\n}\nL.Errorln(id_token)\ntok, err := conf.Exchange(oauth2.NoContext, id_token)\nif err != nil {\n    L.Errorln(\"err is\", err)\n}\n\nL.Errorln(\"token is \", tok)\nresponse, err := http.Get(\"https://www.googleapis.com/oauth2/v2/userinfo?access_token=\" + tok.AccessToken)\n\ndefer response.Body.Close()\ncontents, err := ioutil.ReadAll(response.Body)\nL.Errorln(contents, err)\n</code></pre>\n\n<p>My client side code as follows</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta name=\"google-signin-scope\" content=\"profile email\"&gt;\n&lt;meta name=\"google-signin-client_id\" content=\"HIDDEN.apps.googleusercontent.com\"&gt;\n &lt;script src=\"https://apis.google.com/js/client:platform.js?\" async defer&gt;\n &lt;/script&gt;\n &lt;script  src=\"/login.js\"&gt;&lt;/script&gt;\n &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"/login.css\"&gt;\n &lt;title&gt;Wander&lt;/title&gt;\n &lt;/head&gt;\n &lt;body&gt;\n &lt;div id=\"g-login\" class=\"g-signin2\" data-onsuccess=\"onSignIn\" data-\n theme=\"dark\" &gt;&lt;/div&gt;\n\n&lt;a href=\"#\" onclick=\"signOut();\"&gt;Sign out&lt;/a&gt;\n&lt;script&gt;\nfunction signOut() {\nvar auth2 = gapi.auth2.getAuthInstance();\nauth2.signOut().then(function () {\n  console.log('User signed out.');\n});\n}\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>login.js</p>\n\n<pre><code>    function onSignIn(googleUser) {\n    // Useful data for your client-side scripts:\n    var profile = googleUser.getBasicProfile();\n    console.log(\"ID: \" + profile.getId()); // Don't send this directly to your server!\n    console.log('Full Name: ' + profile.getName());\n    console.log('Given Name: ' + profile.getGivenName());\n    console.log('Family Name: ' + profile.getFamilyName());\n    console.log(\"Image URL: \" + profile.getImageUrl());\n    console.log(\"Email: \" + profile.getEmail());\n\n    // The ID token you need to pass to your backend:\n    var id_token = googleUser.getAuthResponse().id_token;\n\n    console.log(\"ID Token: \" + id_token);\n};\n</code></pre>\n"}, {"tags": ["go", "global-variables"], "comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1493567954, "post_id": 43706088, "comment_id": 74460656, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/143035/discussion-on-question-by-zer09-how-to-call-a-variable-declared-on-the-root-pack\">moved to chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "is_accepted": true, "score": 2, "last_activity_date": 1493901781, "creation_date": 1493901781, "answer_id": 43783233, "question_id": 43706088, "link": "https://stackoverflow.com/questions/43706088/how-to-call-a-variable-declared-on-the-root-package/43783233#43783233", "title": "How to call a variable declared on the root package", "body": "<p>If someone have this, doing <code>go install</code> on the directory where the main package is, makes the <code>gotype</code> stop spitting the message.</p>\n"}], "owner": {"reputation": 1091, "user_id": 3387602, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c5ef481e47f40861b734abc7d7973777?s=128&d=identicon&r=PG&f=1", "display_name": "zer09", "link": "https://stackoverflow.com/users/3387602/zer09"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 43783233, "answer_count": 1, "score": -1, "last_activity_date": 1493901781, "creation_date": 1493553304, "last_edit_date": 1495540028, "question_id": 43706088, "link": "https://stackoverflow.com/questions/43706088/how-to-call-a-variable-declared-on-the-root-package", "title": "How to call a variable declared on the root package", "body": "<p>I have a version.go on my root folder(MyPackage).</p>\n\n<pre><code>package MyPackage\nvar (\n    Version = \"undifened\"\n    Hash = \"undifined\"\n)\n</code></pre>\n\n<p>And I have second file found on MyPackage/cmd/bootloader/bootloader.go</p>\n\n<pre><code>package main\nimport(\n       \"MyPackage\"\n       \"fmt\"\n)\n\nfunc main() {\n     fmt.Println(MyPackage.Version)\n}\n</code></pre>\n\n<p>But I am getting<code>undeclared name: MyPackage</code> and <code>\"MyPackage\" imported but not used as ext</code> on gotype and i dont know how to fix.</p>\n\n<p>I tried executing this <code>gotype bootloader.go</code> and get this.</p>\n\n<pre><code>bootloader.go:9:14: undeclared name: MyPackage\nbootloader.go:4:2: \"MyPackage\" imported but not used as ext\n</code></pre>\n\n<p>I will appreciate for any help will come.</p>\n\n<p>Edit: This is not the same with <a href=\"https://stackoverflow.com/questions/35038864/golang-global-variable-access\">Golang Global Variable access</a> because this will defeat the purpose of that variables, because i don't want to rewrite it on the every main.go. because I want to build the main.go with the <code>-ldflags</code> to set the value on the variable.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19488, "user_id": 3536236, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JhjSz.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3536236/martin"}, "edited": false, "score": 0, "creation_date": 1493546757, "post_id": 43705213, "comment_id": 74454826, "body": "you&#39;re not resizing the image, you&#39;re wanting to resize the <i>canvas</i>"}, {"owner": {"reputation": 9457, "user_id": 790846, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bd465c508de03ada567e3edd01f5096?s=128&d=identicon&r=PG", "display_name": "jogesh_pi", "link": "https://stackoverflow.com/users/790846/jogesh-pi"}, "reply_to_user": {"reputation": 19488, "user_id": 3536236, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JhjSz.jpg?s=128&g=1", "display_name": "Martin", "link": "https://stackoverflow.com/users/3536236/martin"}, "edited": false, "score": 0, "creation_date": 1493546817, "post_id": 43705213, "comment_id": 74454839, "body": "@Martin exactly, does the same library helps me to achieve this?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493548909, "post_id": 43705213, "comment_id": 74455402, "body": "The library you&#39;ve chosen is specifically for image resizing. If you only need to resize the underlying canvas - you don&#39;t need additional libraries, the standard library is suffice."}, {"owner": {"reputation": 8719, "user_id": 3347384, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/unn6p.jpg?s=128&g=1", "display_name": "cchantep", "link": "https://stackoverflow.com/users/3347384/cchantep"}, "edited": false, "score": 0, "creation_date": 1579381036, "post_id": 43705213, "comment_id": 105749638, "body": "You can have a look at <a href=\"https://github.com/cchantep/nuggan\" rel=\"nofollow noreferrer\">nuggan</a> (I&#39;m a contributor of)"}], "answers": [{"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 0, "last_activity_date": 1493550041, "creation_date": 1493550041, "answer_id": 43705648, "question_id": 43705213, "link": "https://stackoverflow.com/questions/43705213/image-resize-without-stretching-and-shrinking/43705648#43705648", "title": "Image Resize without stretching and shrinking", "body": "<p>You can use another function from the same library:</p>\n\n<p><code>resize.Thumbnail</code> downscales an image <strong>preserving its aspect ratio</strong> to the maximum dimensions</p>\n"}], "owner": {"reputation": 9457, "user_id": 790846, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bd465c508de03ada567e3edd01f5096?s=128&d=identicon&r=PG", "display_name": "jogesh_pi", "link": "https://stackoverflow.com/users/790846/jogesh-pi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 975, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493550041, "creation_date": 1493546679, "question_id": 43705213, "link": "https://stackoverflow.com/questions/43705213/image-resize-without-stretching-and-shrinking", "title": "Image Resize without stretching and shrinking", "body": "<p>I am using <a href=\"https://i.stack.imgur.com/GykQG.png\" rel=\"nofollow noreferrer\">https://github.com/nfnt/resize</a> to resize image</p>\n\n<pre><code>// open \"test.jpg\"\nfile, err := os.Open(\"images/\" + fileName)\nif err != nil {\n    log.Fatal(err)\n}\n\n// decode jpeg into image.Image\nimg, err := jpeg.Decode(file)\nif err != nil {\n    log.Fatal(err)\n}\nfile.Close()\n\n\nm := resize.Resize(500, 500, img, resize.Lanczos3)\n\nout, err := os.Create(\"images/\" + fileName + \"_resized.jpg\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer out.Close()\n\n// write new image to file\njpeg.Encode(out, m, nil)\n</code></pre>\n\n<p>That gives me the output like: </p>\n\n<p><a href=\"https://i.stack.imgur.com/GykQG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GykQG.png\" alt=\"[1]: https://github.com/nfnt/resize\"></a></p>\n\n<p>I don't want to stretch the image, Just want to resize and fill white background in the added area. Don't have any idea with Go. In Laravel i done with the help of <a href=\"http://image.intervention.io\" rel=\"nofollow noreferrer\">http://image.intervention.io</a> But don't have idea with GO lang. Please help me to achieve this.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "edited": false, "score": 0, "creation_date": 1493632474, "post_id": 43704864, "comment_id": 74477756, "body": "It is an amazing explanation."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 14, "last_activity_date": 1493544243, "creation_date": 1493544243, "answer_id": 43704864, "question_id": 43704483, "link": "https://stackoverflow.com/questions/43704483/difference-between-gos-standard-context-package-and-gorilla-context-package/43704864#43704864", "title": "Difference between Go&#39;s standard context package and Gorilla context package", "body": "<p>Gorilla's context package</p>\n\n<blockquote>\n  <p>stores values shared during a request lifetime.</p>\n</blockquote>\n\n<p>The official <code>context</code> package</p>\n\n<blockquote>\n  <p>carries deadlines, cancelation signals, and other request-scoped values across API boundaries and between processes.</p>\n</blockquote>\n\n<p>So from the outset, it's obvious that the official package does much more.  But before getting into the details, some history:</p>\n\n<p>Gorilla's context package predates the official Go context package.  It was created to solve a fundamental problem when responding to HTTP requests:  Different middlewares and handlers need to be able to share request-scoped state. Things like the authenticated user's name and user ID, as well as the results of information retrieved from a database before sending it to a template to be parsed, etc.</p>\n\n<p>Gorilla's context package does this through a pretty ugly hack:  It creates a map with the HTTP request pointer as a key. To make this concurrency-safe, it wraps all access to this map in mutexes, which make the access slower (although realistically, it probably only matters for very busy web sites).</p>\n\n<p>The Go context package, as stated, came later, and with a different need in mind.  The Go context package exists primarily to solve the problem of cancelling operations after they're no longer needed.</p>\n\n<p>Before this, if you were serving an HTTP request, and the user closed their web browser or hit the 'Stop' button, or their wifi connection dropped, you would have no way of knowing.  Your server would happily continue chugging along, fetching values from the database, rendering templates, etc, just to send the result back to... nobody.</p>\n\n<p>Or maybe your program needs to fetch data from a bunch of remote APIs, but you're only willing to wait 10 seconds. After 10 seconds, you want to cancel the pending requests.</p>\n\n<p>With the Go context package, these things are possible--and easy.  By providing a cancelable context, the http library can now tell your HTTP server that the HTTP request was cancelled by the client.  Or you can set a context with a timeout for the latter scenario.</p>\n\n<p>So you can see, the two packages are intended to solve entirely different problems.</p>\n\n<p><em>However</em>, the official Go context package also has an extra feature. The <a href=\"https://golang.org/pkg/context/#WithValue\" rel=\"noreferrer\">WithValue</a> method allows you to pass along arbitrary data in a context.  This <em>does</em> serve the same purpose as Gorilla's context package, but kind of as an after thought.</p>\n\n<p>Best practice these days is to use the official context package.  But this should be done primarily for cancellation purposes.  As a secondary benefit, you can also use it to pass along values--the same sorts of values you would pass in Gorilla's context.</p>\n\n<p>But if you're <em>only</em> using it to pass along values, you're missing about 90% of its benefit.</p>\n"}], "owner": {"reputation": 873, "user_id": 5303460, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7370b6d79ff8a15cedc2c69fc9c71e3b?s=128&d=identicon&r=PG", "display_name": "Tural Asgar", "link": "https://stackoverflow.com/users/5303460/tural-asgar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 2, "accepted_answer_id": 43704864, "answer_count": 1, "score": 4, "last_activity_date": 1579107287, "creation_date": 1493541294, "last_edit_date": 1579107287, "question_id": 43704483, "link": "https://stackoverflow.com/questions/43704483/difference-between-gos-standard-context-package-and-gorilla-context-package", "title": "Difference between Go&#39;s standard context package and Gorilla context package", "body": "<p>What are the differences? \nWhich one is more powerful? \nCan it be accomplished the same thing by using only standard <code>context</code> without using any third party libraries?</p>\n"}, {"tags": ["go", "exec", "riak", "basho-client"], "comments": [{"owner": {"reputation": 213, "user_id": 3748381, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebd246696740f35a419dc4e3432a1dac?s=128&d=identicon&r=PG&f=1", "display_name": "parmar7725274", "link": "https://stackoverflow.com/users/3748381/parmar7725274"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493547351, "post_id": 43704208, "comment_id": 74454974, "body": "I have gone through riak docs but I didn&#39;t find any way to Get its status using Go program, they have provided CLI commands."}, {"owner": {"reputation": 213, "user_id": 3748381, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebd246696740f35a419dc4e3432a1dac?s=128&d=identicon&r=PG&f=1", "display_name": "parmar7725274", "link": "https://stackoverflow.com/users/3748381/parmar7725274"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493547743, "post_id": 43704208, "comment_id": 74455097, "body": "I&#39;m not saying I want to read from command line tool But my question is what is possible(best) ways to read Riak Status ?"}], "answers": [{"tags": [], "owner": {"reputation": 2815, "user_id": 3365419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BIJjA.png?s=128&g=1", "display_name": "vempo", "link": "https://stackoverflow.com/users/3365419/vempo"}, "is_accepted": false, "score": 0, "last_activity_date": 1495608326, "creation_date": 1495608326, "answer_id": 44150847, "question_id": 43704208, "link": "https://stackoverflow.com/questions/43704208/how-to-get-riak-kv-cluster-and-node-status-data-in-go/44150847#44150847", "title": "How to get Riak KV cluster and node status data in Go", "body": "<p>The best way to get Riak performance/status/metrics might be via its <a href=\"http://docs.basho.com/riak/kv/2.2.3/developing/api/http/status/\" rel=\"nofollow noreferrer\">stats HTTP API</a>. It works with any language or even using <code>curl</code>. As long as you know how to connect via HTTP and parse JSON, you should be able to use it.</p>\n\n<p>Using the API can be as simple as running:</p>\n\n<p><code>curl -v http://127.0.0.1:8098/stats -H \"Accept: application/json\"</code></p>\n\n<p>It gives you a lot of useful information like allocated and used memory, get/put statistics, CPU utilization, ring status, etc.</p>\n\n<p><a href=\"https://github.com/basho-labs/riak_explorer\" rel=\"nofollow noreferrer\">Riak Explorer</a> exposes an even more powerful API that allows not only to monitor, but also manage Riak clusters. You have to install the tool separately though.</p>\n"}], "owner": {"reputation": 213, "user_id": 3748381, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ebd246696740f35a419dc4e3432a1dac?s=128&d=identicon&r=PG&f=1", "display_name": "parmar7725274", "link": "https://stackoverflow.com/users/3748381/parmar7725274"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495608326, "creation_date": 1493539017, "last_edit_date": 1493547870, "question_id": 43704208, "link": "https://stackoverflow.com/questions/43704208/how-to-get-riak-kv-cluster-and-node-status-data-in-go", "title": "How to get Riak KV cluster and node status data in Go", "body": "<p>I'm trying to monitor Riak-KV from Go program. Riak has a client for go named 'riak-go-client', But it doesn't have any api to get Riak performance/Status data.\nIs there any way to get it ?</p>\n"}, {"tags": ["http", "go", "compilation"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1493521779, "post_id": 43702101, "comment_id": 74449858, "body": "You can the expected input error by  renaming the directory <code>golang_org</code> to <code>golang.org</code>"}, {"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1493523399, "post_id": 43702101, "comment_id": 74450087, "body": "You mean <code>mv ~&#47;gocode&#47;src&#47;golang_org&#47; ~&#47;gocode&#47;src&#47;golang.org&#47;</code>? That brings me back to initial situation where I get the first set of errors. Please elaborate."}, {"owner": {"reputation": 1281, "user_id": 3070080, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wmtmd.jpg?s=128&g=1", "display_name": "iamatsundere181", "link": "https://stackoverflow.com/users/3070080/iamatsundere181"}, "edited": false, "score": 0, "creation_date": 1493533438, "post_id": 43702101, "comment_id": 74451779, "body": "Firstly, you should use &#39;go env&#39; to check your current setting for Go, post the result in here and we will decide what to do next?"}, {"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1493535063, "post_id": 43702101, "comment_id": 74452132, "body": "updated with go env output."}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1493576934, "post_id": 43709593, "comment_id": 74463594, "body": "Can you please briefly describe why this works? I.e. the difference between the 1.8.1 installation and the go toolchain built from dev."}], "tags": [], "owner": {"reputation": 136, "user_id": 7102681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6cc241c531ff5ad849b2f718ba7513?s=128&d=identicon&r=PG&f=1", "display_name": "Kale B", "link": "https://stackoverflow.com/users/7102681/kale-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1493581560, "last_edit_date": 1493581560, "creation_date": 1493575376, "answer_id": 43709593, "question_id": 43702101, "link": "https://stackoverflow.com/questions/43702101/golang-core-net-http-package-import-errors/43709593#43709593", "title": "golang: core net/http package import errors", "body": "<p>The problem here is that you're running <code>go test</code>, where the <code>go</code> command is your 1.8.1 installation. For the tests to work properly you should run with the Go toolchain built from your development directory.</p>\n\n<ol>\n<li>Make sure you've built the Go toolchain, <code>cd ~/godev/src; ./make.bash</code> (<code>./all.bash</code> will work too, but then you'll have to wait for tests to run instead of just building the toolchain).</li>\n<li>Run the tests with the newly compiled toolchain, <code>cd ~/godev/src/net/http; ~/godev/bin/go test</code>.</li>\n</ol>\n\n<p>I suggest adding an alias to your profile, such as <code>alias godev=~/godev/bin/go</code>, then you can run <code>godev test</code>.</p>\n\n<p>Also make sure that you are not setting the <code>GOROOT</code> environment variable as it will cause the <code>go</code> command to use the specified path as the GOROOT regardless of which toolchain you're running with, which is not what you want.</p>\n\n<p><strong>Update</strong></p>\n\n<p>As requested in the comments, here's as brief an explaination as I can come up with:</p>\n\n<ol>\n<li><p>The errors that mention \"cannot find package\" are looking for some packages that are vendored in <code>~/godev/src/vendor/golang_net/...</code>. However, the vendoring support added in 1.5/1.6 only works when the package is inside the GOPATH or GOROOT. Your godev installation is not (and should not be) inside GOPATH and GOROOT is pointing to your 1.8.1 install.</p></li>\n<li><p><code>transfer.go:14:2: use of internal package not allowed</code> is because <code>transfer.go</code> imports <code>net/http/internal</code>. Since this is not a relative path it'll be found in <code>$GOROOT/src/net/http/internal</code>, instead of <code>~/godev/src/net/http/internal</code> and internal packages cannot be imported if the importing package does not share a common root with the internal directory.</p></li>\n</ol>\n\n<p>It boils down to GOROOT pointing to your 1.8.1 installation. You might wonder if you could just set GOROOT to point at your godev directory, but this is not going to work correctly either. I'm not as certain of the mechanics here, but I think the problems come down to mismatches between what the 1.8.1 compiler expects are what is in <code>~/godev/src/runtime</code>.</p>\n\n<p>When the toolchain is compiled the location of GOROOT is compiled in, so when <code>~/godev/bin/go</code> is run, it uses <code>~/godev</code> as it's GOROOT.</p>\n"}], "owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3479, "favorite_count": 1, "accepted_answer_id": 43709593, "answer_count": 1, "score": 2, "last_activity_date": 1493581560, "creation_date": 1493516351, "last_edit_date": 1493573401, "question_id": 43702101, "link": "https://stackoverflow.com/questions/43702101/golang-core-net-http-package-import-errors", "title": "golang: core net/http package import errors", "body": "<p>I've cloned <a href=\"https://go.googlesource.com/go/\" rel=\"nofollow noreferrer\">go source code</a> using <code>git clone https://go.googlesource.com/go</code> into my <code>~/godev/</code> directory (outside of GOPATH as the docs advise).</p>\n\n<p>My $GOPATH is <code>~/gocode</code></p>\n\n<p>I installed go 1.8.1 using the official osx installer.</p>\n\n<p>If I cd into <code>~/godev/go/src/net/http</code> and run <code>go test</code>, I get these errors:</p>\n\n<pre><code>h2_bundle.go:46:2: cannot find package \"golang_org/x/net/http2/hpack\" in any of:\n    /usr/local/go/src/golang_org/x/net/http2/hpack (from $GOROOT)\n    ~/gocode/src/golang_org/x/net/http2/hpack (from $GOPATH)\nh2_bundle.go:47:2: cannot find package \"golang_org/x/net/idna\" in any of:\n    /usr/local/go/src/golang_org/x/net/idna (from $GOROOT)\n    ~/gocode/src/golang_org/x/net/idna (from $GOPATH)\nh2_bundle.go:48:2: cannot find package \"golang_org/x/net/lex/httplex\" in any of:\n    /usr/local/go/src/golang_org/x/net/lex/httplex (from $GOROOT)\n    ~/gocode/src/golang_org/x/net/lex/httplex (from $GOPATH)\ntransport.go:32:2: cannot find package \"golang_org/x/net/proxy\" in any of:\n    /usr/local/go/src/golang_org/x/net/proxy (from $GOROOT)\n    ~/gocode/src/golang_org/x/net/proxy (from $GOPATH)\ntransfer.go:14:2: use of internal package not allowed\n</code></pre>\n\n<p>After I follow the directions <a href=\"https://github.com/mailgun/godebug/issues/88#issuecomment-272671936\" rel=\"nofollow noreferrer\">here</a> by doing <code>cd $GOPATH/src\n</code> followed by <code>cp -R /usr/local/go/src/vendor/golang_org .</code>, I still get these errors:</p>\n\n<pre><code>h2_bundle.go:47:2: code in directory ~/gocode/src/golang_org/x/net/idna expects import \"golang.org/x/net/idna\"\ntransport.go:32:2: cannot find package \"golang_org/x/net/proxy\" in any of:\n    /usr/local/go/src/golang_org/x/net/proxy (from $GOROOT)\n    ~/gocode/src/golang_org/x/net/proxy (from $GOPATH)\ntransfer.go:14:2: use of internal package not allowed\n</code></pre>\n\n<p>It is true that there is no proxy package under ~/gocode/src/golang_org/x/net, but I still don't know how to fix that and the other 2 errors.</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"~/gocode\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/71/k_tftg2d1qd7gf5ww0n_wl_r0000gn/T/go-build541211050=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n</code></pre>\n\n<p>If I run the all.bash script, it will run all unit tests, but that is time consuming. Is there a way to run just net/http tests without getting these errors?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1493508809, "creation_date": 1493508809, "answer_id": 43701464, "question_id": 43701322, "link": "https://stackoverflow.com/questions/43701322/gorm-golang-sql-nullint64-not-working-when-we-wrapper-with-another-struct/43701464#43701464", "title": "Gorm golang sql.NullInt64 not working when we wrapper with another struct", "body": "<p>In Go when you declare a type as an <em>alias</em> of another type, the new type <strong>does not get to keep</strong> the other type's methods. So here:</p>\n\n<pre><code>type NullInt64 sql.NullInt64\n</code></pre>\n\n<p>your new <code>NullInt64</code> type has the same structure and memory layout as <code>sql.NullInt64</code> <strong>but</strong> it does not have its methods, namely the <a href=\"https://golang.org/pkg/database/sql/#NullInt64.Scan\" rel=\"nofollow noreferrer\">Scan</a> and <a href=\"https://golang.org/pkg/database/sql/#NullInt64.Value\" rel=\"nofollow noreferrer\">Value</a> methods required for it to work the way you want.</p>\n\n<p>Instead what you can do is to embed the <code>sql.NullInt64</code> and you should be good to go.</p>\n\n<pre><code>type NullInt64 struct {\n    sql.NullInt64\n}\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "accepted_answer_id": 43701464, "answer_count": 1, "score": 0, "last_activity_date": 1527756817, "creation_date": 1493507377, "last_edit_date": 1527756817, "question_id": 43701322, "link": "https://stackoverflow.com/questions/43701322/gorm-golang-sql-nullint64-not-working-when-we-wrapper-with-another-struct", "title": "Gorm golang sql.NullInt64 not working when we wrapper with another struct", "body": "<p>User can be deleted by another user. In that case,</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Email string `gorm:\"type:varchar(100)\"`\n    DeletedBy     sql.NullInt64\n}\n</code></pre>\n\n<p>DeletedBy will be null when we create a new user. So I used sql.NullInt64 instead of int64.\nBut I cannot convert to JSON. </p>\n\n<blockquote>\n  <p>{ \"Email\": \"xxxxx\",\n  \"DeletedBy\":\n  {\"Int64\":2,\"Valid\":true}\n  }</p>\n</blockquote>\n\n<p>For that, I tried <a href=\"https://gist.github.com/smagch/bc34f861df65c8ea2e90\" rel=\"nofollow noreferrer\">https://gist.github.com/smagch/bc34f861df65c8ea2e90</a>\nBut Gorm send query condition value as <strong>\"[{2, true}]\"</strong></p>\n"}, {"tags": ["go", "cgi"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1493509337, "post_id": 43701302, "comment_id": 74447954, "body": "Your request <code>r</code> is <code>nil</code>, calling <code>ParseForm</code> on it will result in a panic. Go will not magically allocate that request for you, instead try using the <a href=\"https://golang.org/pkg/net/http/cgi/\" rel=\"nofollow noreferrer\">net/http/cgi</a> package and calling the <code>cgi.Request()</code> function to retrieve the request you want to call <code>ParseForm</code> on."}, {"owner": {"reputation": 31, "user_id": 7942132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eea6f054caccf563aba5091c6edd768?s=128&d=identicon&r=PG&f=1", "display_name": "jdaws", "link": "https://stackoverflow.com/users/7942132/jdaws"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493584962, "post_id": 43701302, "comment_id": 74466233, "body": "Thank you for the response. Please see my edit above, where I try using cgi.Request() as suggested."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493585916, "post_id": 43701302, "comment_id": 74466476, "body": "Please include the error from the compiler @jdaws."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493586210, "post_id": 43701302, "comment_id": 74466568, "body": "<code>ParseForm</code> returns a value of type <code>error</code>, so in your edited code <code>r</code> is of type <code>error</code> which has no <code>FormValue</code>, that&#39;s why it won&#39;t compile. Instead try something like this: <a href=\"https://play.golang.org/p/-oQ2P6VMEn\" rel=\"nofollow noreferrer\">play.golang.org/p/-oQ2P6VMEn</a>"}, {"owner": {"reputation": 31, "user_id": 7942132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eea6f054caccf563aba5091c6edd768?s=128&d=identicon&r=PG&f=1", "display_name": "jdaws", "link": "https://stackoverflow.com/users/7942132/jdaws"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493587324, "post_id": 43701302, "comment_id": 74466859, "body": "Thank you @mkopriva, I copy/pasted that code snippet, which compiles, but I still get a 502 error in nginx with the same error log as in my original post. This is Go 1.8. My little &quot;ip&quot; program above works, so I know CGI is working in nginx, and I also did a test C program which correctly showed my POST data."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493587552, "post_id": 43701302, "comment_id": 74466934, "body": "Does the Go app output anything to Stderr?"}, {"owner": {"reputation": 31, "user_id": 7942132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eea6f054caccf563aba5091c6edd768?s=128&d=identicon&r=PG&f=1", "display_name": "jdaws", "link": "https://stackoverflow.com/users/7942132/jdaws"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493589066, "post_id": 43701302, "comment_id": 74467431, "body": "No, it doesn&#39;t output anything to Stderr."}], "answers": [{"comments": [{"owner": {"reputation": 1335, "user_id": 92795, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4f9179800a79378e74fae4f9d09d1237?s=128&d=identicon&r=PG", "display_name": "\u0411\u0435\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/92795/%d0%91%d0%b5%d1%80%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1609683510, "post_id": 43711864, "comment_id": 115893392, "body": "If I understand well You are saying that the fcgi server will gracefully degrade to CGI mode. I compiled your code after adding &quot;net/http&quot; to the import section, but the script panics with the following error:    panic: file file+net /dev/stdin: getsockopt: socket operation on non-socket I would like to make a Go program which gracefully degrades to CGI mode if FASTCGI mode is not present."}, {"owner": {"reputation": 1335, "user_id": 92795, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4f9179800a79378e74fae4f9d09d1237?s=128&d=identicon&r=PG", "display_name": "\u0411\u0435\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/92795/%d0%91%d0%b5%d1%80%d0%be%d0%b2"}, "edited": false, "score": 0, "creation_date": 1609683935, "post_id": 43711864, "comment_id": 115893526, "body": "Is this the same thing like yours what BEEGO is doing here? <a href=\"https://github.com/beego/beego/blob/f6b75434781631db394461d9f4778838e4abf58e/server/web/server.go#L104\" rel=\"nofollow noreferrer\">github.com/beego/beego/blob/&hellip;</a> Thanks!"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1335, "user_id": 92795, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4f9179800a79378e74fae4f9d09d1237?s=128&d=identicon&r=PG", "display_name": "\u0411\u0435\u0440\u043e\u0432", "link": "https://stackoverflow.com/users/92795/%d0%91%d0%b5%d1%80%d0%be%d0%b2"}, "edited": false, "score": 1, "creation_date": 1609745410, "post_id": 43711864, "comment_id": 115908576, "body": "@\u0411\u0435\u0440\u043e\u0432 AFAICT fcgi will <i>not</i> gracefully degrade to cgi by itself, also I don&#39;t think I made that claim in the answer. However you should be able to degrade gracefully yourself if you want to by checking the error from <code>fcgi.Serve</code> and, instead of panicking when the error is non-nil, handling the request with cgi."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 4, "last_activity_date": 1493590132, "creation_date": 1493590132, "answer_id": 43711864, "question_id": 43701302, "link": "https://stackoverflow.com/questions/43701302/simplest-golang-cgi-form-example/43711864#43711864", "title": "Simplest Golang CGI form example", "body": "<p>Since <a href=\"https://golang.org/pkg/net/http/cgi/\" rel=\"nofollow noreferrer\">net/http/cgi</a> is not working for you and looking at the error log from nginx mentioning FastCGI, you might need to use the <a href=\"https://golang.org/pkg/net/http/fcgi/\" rel=\"nofollow noreferrer\">net/http/fcgi</a> package.</p>\n\n<p>If you look at its documentation you can see that you'll need to do a little bit more work to get access to the request.</p>\n\n<p>First declare a function that will be used to handle the requests:</p>\n\n<pre><code>func myhandler(_ http.ResponseWriter, r *http.Request) {\n    // handle request\n}\n</code></pre>\n\n<p>Then pass your new handler to the <a href=\"https://golang.org/pkg/net/http/fcgi/#Serve\" rel=\"nofollow noreferrer\">fcgi.Serve</a> function.</p>\n\n<pre><code>fcgi.Serve(nil, http.HandlerFunc(myhandler))\n</code></pre>\n\n<p><code>Serve</code> takes two parameters. The first one is a <code>net.Listener</code>, if passed in as <code>nil</code>, <code>Serve</code> will read the requests from <code>stdin</code>. The second one, is of type <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow noreferrer\">http.Handler</a> which is an interface that the <code>myhandler</code> function, as is, does not implement but given its specific signature (<code>func(http.ResponseWriter, *http.Request)</code>) you can convert <code>myhandler</code> to an <code>http.Handler</code> using the <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow noreferrer\">http.HandlerFunc</a> type.  </p>\n\n<p>Full example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http/fcgi\"\n    \"os\"\n)\n\nfunc myhandler(_ http.ResponseWriter, r *http.Request) {\n    if err := r.ParseForm(); err != nil {\n        fmt.Fprintf(os.Stderr, err.Error())\n        os.Exit(1)\n    }\n\n    username := r.FormValue(\"username\")\n    password := r.FormValue(\"password\")\n\n    fmt.Printf(\"Content-type: text/html\\n\\n\")\n    fmt.Printf(\"&lt;!DOCTYPE html&gt;\\n\")\n    fmt.Printf(\"&lt;p&gt;username: %s\\n\", username)\n    fmt.Printf(\"&lt;p&gt;password: %s\\n\", password)\n}\n\nfunc main() {\n    if err := fcgi.Serve(nil, http.HandlerFunc(myhandler)); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7942132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eea6f054caccf563aba5091c6edd768?s=128&d=identicon&r=PG&f=1", "display_name": "jdaws", "link": "https://stackoverflow.com/users/7942132/jdaws"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4554, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1493590132, "creation_date": 1493507214, "last_edit_date": 1493584924, "question_id": 43701302, "link": "https://stackoverflow.com/questions/43701302/simplest-golang-cgi-form-example", "title": "Simplest Golang CGI form example", "body": "<p>I'd appreciate some help with the most basic possible CGI program with a form input.  I don't want to run a listener or use a framework or do anything beyond the most basic possible example.  This is just to get my feet in the door, and I will add the bells and whistles later.</p>\n\n<p>Here's a simple CGI app without a form input:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"os\"\n\nfunc main() {\n        ip := os.Getenv(\"REMOTE_ADDR\")\n        fmt.Printf(\"Content-type: text/plain\\n\\n\")\n        fmt.Println(ip)\n}\n</code></pre>\n\n<p>This prints my IP address when I go to <a href=\"https://example.com/cgi-bin/ip\" rel=\"nofollow noreferrer\">https://example.com/cgi-bin/ip</a></p>\n\n<p>However, the following code results in a 502 error:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net/http\"\n        s \"strings\"\n)\n\nfunc main() {\n        var r *http.Request\n\n        fmt.Printf(\"Content-type: text/html\\n\\n\")\n        fmt.Println(\"&lt;!DOCTYPE html&gt;\")\n        fmt.Println(\"&lt;title&gt;login&lt;/title&gt;\")\n        r.ParseForm()\n        username := r.FormValue(\"username\")\n        password := r.FormValue(\"password\")\n        if s.Compare(password, username) == 0 {\n                fmt.Println(\"&lt;p&gt;invalid username/password\")\n        }\n}\n</code></pre>\n\n<p>The nginx log says:</p>\n\n<p>2017/04/29 22:55:12 [error] 45768#0: *802 upstream prematurely closed FastCGI stdout while reading response header from upstream, client: 192.0.2.80, server: example.com, request: \"POST /cgi-bin/login HTTP/2.0\", upstream: \"fastcgi://unix:run/slowcgi.sock:\", host: \"example.com\", referrer: \"<a href=\"https://example.com/login.html\" rel=\"nofollow noreferrer\">https://example.com/login.html</a>\"</p>\n\n<p>The HTML for this form is:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;title&gt;Username and password&lt;/title&gt;\n\n&lt;form action=\"/cgi-bin/login\" method=\"post\"&gt;\n&lt;table&gt;\n&lt;tr&gt;&lt;td&gt;Username:&lt;/td&gt;&lt;td&gt;&lt;input type=\"text\" name=\"username\"&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt;Password:&lt;/td&gt;&lt;td&gt;&lt;input type=\"password\" name=\"password\"&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt;&lt;input type=\"submit\" value=\"Submit\"&gt;&lt;/td&gt;&lt;/tr&gt;\n&lt;/table&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Another note: this is nginx on OpenBSD, using slowcgi(8).  Since my toy \"ip\" program works, I believe my Go code is the problem.</p>\n\n<p>What am I doing wrong in my Go code?  Thank you!</p>\n\n<p>EDIT: I now have the following code, which doesn't compile. What am I doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"net/http/cgi\"\n)\n\nfunc main() {\n        httpReq, err := cgi.Request()\n        if err != nil {\n                fmt.Fprintf(os.Stderr, err.Error())\n                os.Exit(1)\n        }\n\n        r := httpReq.ParseForm()\n        username := r.FormValue(\"username\")\n        password := r.FormValue(\"password\")\n\n        fmt.Printf(\"Content-type: text/html\\n\\n\")\n        fmt.Printf(\"&lt;!DOCTYPE html&gt;\\n\")\n        fmt.Printf(\"&lt;p&gt;username: %s\\n\", username)\n        fmt.Printf(\"&lt;p&gt;password: %s\\n\", password)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1493504826, "post_id": 43700989, "comment_id": 74447106, "body": "If you have two separate types and you want them to behave the same way you need to define that behaviour for both of them."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1493510242, "post_id": 43700989, "comment_id": 74448111, "body": "I think reflection is the only way you can have one function do that for two different types, and it&#39;s probably not worth it. The way you&#39;ve written it is the normal way to do something like that."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1493513214, "post_id": 43700989, "comment_id": 74448584, "body": "Can you use a slice instead of arrays?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1493622712, "creation_date": 1493622712, "answer_id": 43715579, "question_id": 43700989, "link": "https://stackoverflow.com/questions/43700989/same-method-on-different-array-types-in-go/43715579#43715579", "title": "Same method on different array types in Go", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Ten [10]byte\n\ntype Twenty [20]byte\n\ntype Number []byte\n\nfunc (n Number) GetByte(i int) byte {\n    return n[i]\n}\n\nfunc main() {\n    t10 := Ten{10}\n    fmt.Println(t10)\n    n10 := Number(t10[:])\n    fmt.Println(n10.GetByte(0))\n\n    t20 := Twenty{10, 20}\n    fmt.Println(t20)\n    fmt.Println(Number(t20[:]).GetByte(1))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[10 0 0 0 0 0 0 0 0 0]\n10\n[10 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]\n20\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7810481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151c50e01b504025804decc836bc8c18?s=128&d=identicon&r=PG&f=1", "display_name": "Sa&#250;l Ortega", "link": "https://stackoverflow.com/users/7810481/sa%c3%bal-ortega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "accepted_answer_id": 43715579, "answer_count": 1, "score": 1, "last_activity_date": 1493855638, "creation_date": 1493504215, "last_edit_date": 1495541886, "question_id": 43700989, "link": "https://stackoverflow.com/questions/43700989/same-method-on-different-array-types-in-go", "title": "Same method on different array types in Go", "body": "<p>I've seen some similar questions (<a href=\"https://stackoverflow.com/questions/31505587/how-can-two-different-types-implement-the-same-method-in-golang-using-interfaces\">How can two different types implement the same method in golang using interfaces?</a>), but in my case my types do not have the same base type. My types are arrays of different sizes.</p>\n\n<pre><code>type Ten [10]byte\ntype Twenty [20]byte\n\nfunc (t *Ten) GetByte0() byte {\n    return t[0]\n}\n\nfunc (t *Twenty) GetByte0() byte {\n    return t[0]\n}\n</code></pre>\n\n<p>So, it's possible don't to repeat the two methods GetByte0()?</p>\n"}, {"tags": ["sockets", "http", "parsing", "go", "get"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493504521, "post_id": 43700838, "comment_id": 74447038, "body": "You can call <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">ReadString</a> inside a loop until you hit <code>EOF</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5641635"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493507628, "post_id": 43700838, "comment_id": 74447617, "body": "I want to do that, but ReadString seems to require a single bit to use as a delimiter. I am not sure how to proceed with that. I have searched and searched for other methods but have not found any, I am pretty new to GO. I must be missing something simple."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5641635"}, "edited": false, "score": 1, "creation_date": 1493514614, "post_id": 43701367, "comment_id": 74448810, "body": "Actually, breaking on EOF does not work, but I am much further. Currently working on a solution."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1493507787, "creation_date": 1493507787, "answer_id": 43701367, "question_id": 43700838, "link": "https://stackoverflow.com/questions/43700838/server-socket-programming-read-http-header/43701367#43701367", "title": "Server Socket Programming - Read HTTP header", "body": "<p>You can call <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">ReadString</a> inside a loop until you hit <code>EOF</code>.</p>\n\n<p>Something like this:</p>\n\n<pre><code>func handleClient(c net.Conn) {\n  defer c.Close()\n  r := bufio.NewReader(c)\n  for {\n      req, err := r.ReadString('\\n')\n      if err != nil &amp;&amp; err != io.EOF {\n          panic(err)\n      }\n      fmt.Println(req)\n\n      // break the loop if the err is eof\n      if err == io.EOF {\n          break\n      }\n  }\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5641635"}, "is_accepted": false, "score": 0, "last_activity_date": 1493515169, "creation_date": 1493515169, "answer_id": 43701992, "question_id": 43700838, "link": "https://stackoverflow.com/questions/43700838/server-socket-programming-read-http-header/43701992#43701992", "title": "Server Socket Programming - Read HTTP header", "body": "<p>mkopriva pointed me in the right direction, however, EOF is not the correct way to break the loop. I need to stop looping when I run into a line that is blank. Technically it is never EOF.</p>\n\n<p>To do this, I have adjusted the if condition to break the loop to the following:</p>\n\n<pre><code>if len(req) &lt;=2 {\n</code></pre>\n\n<p>After all the headers are read / printed, an HTTP request will end with \"\\r\\n\" I believe. I can confirm that the last line is intact of length 2. </p>\n\n<p>Thanks for the help! </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5641635"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493545590, "creation_date": 1493502822, "last_edit_date": 1493545590, "question_id": 43700838, "link": "https://stackoverflow.com/questions/43700838/server-socket-programming-read-http-header", "title": "Server Socket Programming - Read HTTP header", "body": "<p>I am trying to write an HTTP server in Go for school. I am required to AVOID any libraries that make this task easy (the net/http for example). </p>\n\n<p>My problem is that I cannot seem to display the HTTP Response headers correctly. I want to print each header to my terminal, line by line.</p>\n\n<p>I have written this program in Java, and it works well, however, I would like to have this working with a Go program.</p>\n\n<p>I have a function called 'handleClient' that takes an accepted socket.</p>\n\n<pre><code>func handleClient(c net.Conn) {\n  defer c.Close()\n  req, _ := bufio.NewReader(c).ReadString('\\n')\n  fmt.Print(string(req))\n</code></pre>\n\n<p>When using a web browser to connect to 'localhost:8080', my terminal displays \"GET / HTTP/1.1\", which is correct, however, I need the additional lines to be posted as well. I understand that 'ReadString('\\n') is what is stopping this from happening, however, it is the only way I know of to end that line. </p>\n\n<p>How to I start additional lines?</p>\n"}, {"tags": ["sql", "database", "postgresql", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493501704, "post_id": 43700597, "comment_id": 74446389, "body": "What db driver are you using to talk to postgres?"}, {"owner": {"reputation": 43, "user_id": 7941941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb33c4c46c9281e6e8a245ba55a6b21?s=128&d=identicon&r=PG&f=1", "display_name": "Yakkodash", "link": "https://stackoverflow.com/users/7941941/yakkodash"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493502045, "post_id": 43700597, "comment_id": 74446472, "body": "@mkopriva <a href=\"http://github.com/lib/pq\" rel=\"nofollow noreferrer\">link</a> pq"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7941941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb33c4c46c9281e6e8a245ba55a6b21?s=128&d=identicon&r=PG&f=1", "display_name": "Yakkodash", "link": "https://stackoverflow.com/users/7941941/yakkodash"}, "edited": false, "score": 0, "creation_date": 1493506682, "post_id": 43700931, "comment_id": 74447463, "body": "It works, but could you explain how <code>nil</code> is translated to named parameter in postgres? I expected postgres throw some kind of error considering assigning parameter to type, which is not expected."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 43, "user_id": 7941941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb33c4c46c9281e6e8a245ba55a6b21?s=128&d=identicon&r=PG&f=1", "display_name": "Yakkodash", "link": "https://stackoverflow.com/users/7941941/yakkodash"}, "edited": false, "score": 0, "creation_date": 1493507378, "post_id": 43700931, "comment_id": 74447566, "body": "I believe <code>nil</code> gets translated into <code>NULL</code> and calling the postgres function like this <code>SELECT read_user(_id := 2, _phone := NULL, _type := NULL...)</code> is valid."}, {"owner": {"reputation": 538, "user_id": 7202475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o2EPV.jpg?s=128&g=1", "display_name": "Pat", "link": "https://stackoverflow.com/users/7202475/pat"}, "edited": false, "score": 0, "creation_date": 1569954045, "post_id": 43700931, "comment_id": 102760113, "body": "This solution also works with the snowflake implementation of go :) <a href=\"https://godoc.org/github.com/snowflakedb/gosnowflake\" rel=\"nofollow noreferrer\">godoc.org/github.com/snowflakedb/gosnowflake</a>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1493505505, "last_edit_date": 1493505505, "creation_date": 1493503779, "answer_id": 43700931, "question_id": 43700597, "link": "https://stackoverflow.com/questions/43700597/executing-sql-query-with-variable-number-of-named-parameters-in-golang/43700931#43700931", "title": "Executing SQL query with variable number of named parameters in Golang", "body": "<p>You can construct your one statement by enumerating <strong>all</strong> the parameters with their placeholders and then you could pass <code>nil</code> explicitly where you don't have the parameter value.</p>\n\n<pre><code>stmt, err := db.Prepare(\"SELECT read_user(_id := $1, _phone := $2, _type := $3, _last := $4, _first := $5)\")\nif err != nil {\n    // ...\n}\nstmt.Query(2, nil, nil, nil, nil) // result should be equivalent to `SELECT read_user(_id := 2)`\nstmt.Query(nil, nil, nil, \"Doe\", \"John\") // result should be equivalent to `SELECT read_user(_first := 'John', _last := 'Doe')`\n</code></pre>\n\n<p>And if you want to have named parameters in Go as well, you can create a struct type to represent the parameters and a wrapper func that'll map that parameter type's fields into the query:</p>\n\n<pre><code>type readUserParams struct {\n    Id    interface{}\n    Phone interface{}\n    Type  interface{}\n    Last  interface{}\n    First interface{}\n}\n\nfunc readUser(p *readUserParams) {\n    stmt.Query(p.Id, p.Phone, p.Type, p.Last, p.First)\n    // ...\n}\n\nreadUser(&amp;readUserParams{Id: 2})\nreadUser(&amp;readUserParams{First: \"John\", Last:\"Doe\"})\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7941941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9eb33c4c46c9281e6e8a245ba55a6b21?s=128&d=identicon&r=PG&f=1", "display_name": "Yakkodash", "link": "https://stackoverflow.com/users/7941941/yakkodash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5607, "favorite_count": 2, "accepted_answer_id": 43700931, "answer_count": 1, "score": 4, "last_activity_date": 1493505505, "creation_date": 1493500808, "last_edit_date": 1493502136, "question_id": 43700597, "link": "https://stackoverflow.com/questions/43700597/executing-sql-query-with-variable-number-of-named-parameters-in-golang", "title": "Executing SQL query with variable number of named parameters in Golang", "body": "<p>So I have this PostgreSQL function, which takes variable number of named arguments and returns list of corresponding items:</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION read_user(\n  _id BIGINT DEFAULT NULL,\n  _phone VARCHAR(30) DEFAULT NULL,\n  _type VARCHAR(15) DEFAULT NULL,\n  _last VARCHAR(50) DEFAULT NULL,\n  _first VARCHAR(50) DEFAULT NULL\n) \nRETURNS setof T_USERS\nAS $$ \nBEGIN\n  RETURN QUERY\n  SELECT * FROM T_USERS\n  WHERE ( id = _id OR _id IS NULL )\n    AND ( phone = _phone OR _phone IS NULL )\n    AND ( type = _type OR _type IS NULL )\n    AND ( last = _last OR _last IS NULL )\n    AND ( first = _first OR _first IS NULL );\n    EXCEPTION WHEN others THEN\n      RAISE WARNING 'Transaction failed and was rolled back';\n      RAISE NOTICE '% %', SQLERRM, SQLSTATE;\nEND\n$$ LANGUAGE plpgsql;\n</code></pre>\n\n<p>So I can run polymorphic queries like these:</p>\n\n<pre><code>SELECT read_user(_id := 2);\nSELECT read_user(_first := 'John', _last := 'Doe');\n</code></pre>\n\n<p>In Golang I can make something like:</p>\n\n<pre><code>stmt, err := db.Prepare(\"SELECT read_user(_id = ?)\")\n</code></pre>\n\n<p>But how can I do the same, but with variable amount of <code>read_user</code> arguments? I'm using <code>pq</code> driver <a href=\"https://github.com/lib/pq\" rel=\"nofollow noreferrer\">https://github.com/lib/pq</a>.</p>\n"}, {"tags": ["csv", "parsing", "go"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 1713830, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d3595c3be077d804c8c2b6228c36c0bc?s=128&d=identicon&r=PG", "display_name": "mr0il", "link": "https://stackoverflow.com/users/1713830/mr0il"}, "edited": false, "score": 0, "creation_date": 1493502532, "post_id": 43700782, "comment_id": 74446581, "body": "Woops! And in the context of my problem that made so much sense."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 61, "user_id": 1713830, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d3595c3be077d804c8c2b6228c36c0bc?s=128&d=identicon&r=PG", "display_name": "mr0il", "link": "https://stackoverflow.com/users/1713830/mr0il"}, "edited": false, "score": 0, "creation_date": 1493502803, "post_id": 43700782, "comment_id": 74446635, "body": "@mr0il Just remember what I said about <code>Error</code>. I didn&#39;t include it in the deferred function call, but that doesn&#39;t mean it&#39;s not important. Imagine that while you were writing to the writer&#39;s buffer, another process changed the permissions or owner of the file. That means when you call <code>Flush</code>, you might suddenly be unable to write to the file. While you can rarely do anything about it, such as trying again, you can at least log the issue and refer users to the log file."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": true, "score": 4, "last_activity_date": 1493502216, "creation_date": 1493502216, "answer_id": 43700782, "question_id": 43700580, "link": "https://stackoverflow.com/questions/43700580/golang-writing-csv-file-result-file-sometimes-empty/43700782#43700782", "title": "Golang, writing csv file result file sometimes empty", "body": "<p>You need to call the <a href=\"https://golang.org/pkg/encoding/csv/#Writer.Flush\" rel=\"nofollow noreferrer\"><code>Flush</code></a> method of your CSV writer to ensure all buffered data is written to your file before closing the file. You can use the following modification:</p>\n\n<pre><code>f, err := os.Create(\"tableFile3.csv\")\nCheck(err)\nw := csv.NewWriter(f)\ndefer func() {\n    w.Flush()\n    f.Close()\n}()\n</code></pre>\n\n<p>This concept can be extended to apply to all writers that use buffers.</p>\n\n<p>Oddly enough, the <code>Flush</code> method doesn't return anything, unlike the <a href=\"https://golang.org/pkg/bufio/#Writer.Flush\" rel=\"nofollow noreferrer\"><code>error</code> returned by the <code>Flush</code> method of a <code>*bufio.Writer</code></a> but you can use the <a href=\"https://golang.org/pkg/encoding/csv/#Writer.Error\" rel=\"nofollow noreferrer\"><code>Error</code></a> method to check for errors that might have occurred during a preceding <code>Write</code> or <code>Flush</code> call.</p>\n"}], "owner": {"reputation": 61, "user_id": 1713830, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d3595c3be077d804c8c2b6228c36c0bc?s=128&d=identicon&r=PG", "display_name": "mr0il", "link": "https://stackoverflow.com/users/1713830/mr0il"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1560, "favorite_count": 0, "accepted_answer_id": 43700782, "answer_count": 1, "score": 2, "last_activity_date": 1493502216, "creation_date": 1493500714, "question_id": 43700580, "link": "https://stackoverflow.com/questions/43700580/golang-writing-csv-file-result-file-sometimes-empty", "title": "Golang, writing csv file result file sometimes empty", "body": "<p>I'm working on a parsetable and decided I'd like to see the table in a readable format. When I created the csv with a large grammar, it successfully outputs the results. However, the parse table isn't correct. So, I'm trying to test with a more simple grammar. For some reason this code produces a csv file with my large grammar, but with the simple grammar the file is blank. What am I doing wrong here?</p>\n\n<pre><code>func WriteTableToFile() {\n    f, err := os.Create(\"tableFile3.csv\")\n    Check(err)\n    defer f.Close()\n    w := csv.NewWriter(f)\n    var tsl []string\n    tsl = append(tsl, \" \")\n    tsl, _ = UnionSlices(tsl, TerminalSymbolList)\n    w.Write(tsl)\n    fmt.Println(tsl)\n\n    for ntk := range ParseTable {\n        var writeSlice []string\n        writeSlice = append(writeSlice, ntk)\n        for _, tk := range TerminalSymbolList {\n            for _, p := range ParseTable[ntk][tk] {\n                writeSlice = append(writeSlice, p)\n                fmt.Println(\"appending \", p)\n            }\n        }\n        w.Write(writeSlice)\n        fmt.Println(\"wrote \", writeSlice)\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1493497977, "creation_date": 1493497977, "answer_id": 43700199, "question_id": 43700000, "link": "https://stackoverflow.com/questions/43700000/json-string-array-without-keys-into-a-golang-struct/43700199#43700199", "title": "JSON string array without Keys into a GoLang struct", "body": "<p>Both <code>cc</code> and <code>to</code> are json arrays which you can unmarshal into Go slices without worrying about the length.</p>\n\n<pre><code>type emailData struct {\n    Body struct {\n        Template string            `json:\"template\"`\n        Params   map[string]string `json:\"params\"`\n    } `json:\"body\"`\n    To      []string `json:\"to\"`\n    CC      []string `json:\"cc\"`\n    ReplyTo struct {\n        Email string `json:\"email\"`\n        Name  string `json:\"name\"`\n    }\n    BCC     string `json:\"bcc\"`\n    Subject string `json:\"subject\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Pi_5aSs922\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Pi_5aSs922</a></p>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 2068742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531732e06128a2c69f720d9abefbc464?s=128&d=identicon&r=PG", "display_name": "AvnishSingh", "link": "https://stackoverflow.com/users/2068742/avnishsingh"}, "is_accepted": false, "score": 1, "last_activity_date": 1493557518, "creation_date": 1493557518, "answer_id": 43706709, "question_id": 43700000, "link": "https://stackoverflow.com/questions/43700000/json-string-array-without-keys-into-a-golang-struct/43706709#43706709", "title": "JSON string array without Keys into a GoLang struct", "body": "<p>Use the below to convert the json to struct in golang:</p>\n\n<p><a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">Json-goStruct</a></p>\n\n<p>Take care of the maps, which might be go struct and vice-versa.</p>\n"}], "owner": {"reputation": 301, "user_id": 5527640, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b19c42bf47996be5da5694e2b484f9e1?s=128&d=identicon&r=PG&f=1", "display_name": "chaseshak", "link": "https://stackoverflow.com/users/5527640/chaseshak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2103, "favorite_count": 0, "accepted_answer_id": 43700199, "answer_count": 2, "score": 1, "last_activity_date": 1493557518, "creation_date": 1493496255, "question_id": 43700000, "link": "https://stackoverflow.com/questions/43700000/json-string-array-without-keys-into-a-golang-struct", "title": "JSON string array without Keys into a GoLang struct", "body": "<p>I am trying to parse JSON that is submitted from a <code>POST</code> request into a struct in a web service to send email. The following JSON is submitted in the body of the request.</p>\n\n<pre><code>{\n  \"body\": {\n    \"template\": \"abctemplate.html\",\n    \"params\": {\n      \"name\": \"Chase\",\n      \"email\": \"1234@gmail.com\"\n    }\n  },\n  \"to\": [\n    \"abc@gmail.com\",\n    \"xyz@gmail.com\"\n  ],\n  \"cc\": [\n    \"xxx@example.com\",\n    \"yyy@example.com\"\n  ],\n  \"replyTo\": {\n    \"email\": \"aaa@gmail.com\",\n    \"name\": \"Jack\"\n  },\n  \"bcc\": \"ccc@gmail.com\",\n  \"subject\": \"Hello, world!\"\n}\n</code></pre>\n\n<p>This is mapped and read into the following struct</p>\n\n<pre><code>type emailData struct {\n    Body struct {\n        Template string            `json:\"template\"`\n        Params   map[string]string `json:\"params\"`\n    } `json:\"body\"`\n    To      map[string]string `json:\"To\"` // TODO This is wrong\n    CC      string            `json:\"cc\"` // TODO this is wrong\n    ReplyTo struct {\n        Email string `json:\"email\"`\n        Name  string `json:\"name\"`\n    }\n    BCC     string `json:\"bcc\"`\n    Subject string `json:\"subject\"`\n}\n</code></pre>\n\n<p>Both the 'to' and 'cc' JSON fields are string arrays of unknown length and do not have keys. Is there a way to map the string arrays into the struct fields? I've tried the two different ways where there are <code>// TODO</code> tags with no luck. Thanks!</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493500090, "post_id": 43700326, "comment_id": 74445986, "body": "How could this be converted to floats and int not strings?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493500169, "post_id": 43700326, "comment_id": 74446007, "body": "Are you sure you want ints and not floats? All those strings contain a floating point number..."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493500386, "post_id": 43700326, "comment_id": 74446070, "body": "Some are floats ( bid/ask/spread) and one is int (producttype) rest is string ( symbol )"}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493501708, "post_id": 43700326, "comment_id": 74446390, "body": "Only problem with that func is it drops off symbol...only dose number conversion."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493501811, "post_id": 43700326, "comment_id": 74446420, "body": "Good catch @user2777145, fixed it."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493504966, "post_id": 43700326, "comment_id": 74447128, "body": "Is their a simple way to compare the current bid / ask result to previous bid / ask result and update current if their is a change?  What would be the simple way to do that."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1493505263, "post_id": 43700326, "comment_id": 74447189, "body": "You could hash the bytes, store the resulting hash, and next time you retrieve the bytes hash them as well and compare the new hash against the stored one. If you have problems with that you should open a new question."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1493501778, "last_edit_date": 1493501778, "creation_date": 1493498974, "answer_id": 43700326, "question_id": 43699741, "link": "https://stackoverflow.com/questions/43699741/golang-json-array-unmarshal-into-type-struct/43700326#43700326", "title": "golang json array unmarshal into type struct", "body": "<p>In the returned json <code>Bid</code>, <code>Ask</code>, and <code>Spread</code> are json strings not integers, so change your type definition to this:</p>\n\n<pre><code>type MsgRateQuoteJson struct {\n    SymbolName   string `json:\"Symbol\"`\n    SymbolBid    string `json:\"Bid\"`\n    SymbolAsk    string `json:\"Ask\"`\n    SymbolSpread string `json:\"Spread\"`\n    SymbolPT     string `json:\"ProductType\"`\n}\n</code></pre>\n\n<p>And marshaling a json string to get json bytes is not the correct way, just convert the string to a byte slice like this:</p>\n\n<pre><code>jsonBytes2 := []byte(result)\n</code></pre>\n\n<p>... and you're good to go:</p>\n\n<pre><code>// Parse JSON !\nerr = ffjson.Unmarshal(jsonBytes2, &amp;msg)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<p>If you want to convert those strings into specific types during the json unmarshaling, you can do so by defining an <code>UnmarshalJSON</code> method on the <code>*MsgRateQuoteJson</code> type, plus with the help of the <code>strconv</code> package, like this:</p>\n\n<pre><code>type MsgRateQuoteJson struct {\n    SymbolName   string  `json:\"Symbol\"`\n    SymbolBid    float64 `json:\"Bid\"`\n    SymbolAsk    float64 `json:\"Ask\"`\n    SymbolSpread float64 `json:\"Spread\"`\n    SymbolPT     int64   `json:\"ProductType\"`\n}\n\nfunc (msg *MsgRateQuoteJson) UnmarshalJSON(data []byte) (err error) {\n    m := map[string]string{}\n    if err = ffjson.Unmarshal(data, &amp;m); err != nil {\n        return err\n    }\n\n    msg.SymbolName = m[\"Symbol\"]\n    if msg.SymbolBid, err = strconv.ParseFloat(m[\"Bid\"], 64); err != nil {\n        return err\n    }\n    if msg.SymbolAsk, err = strconv.ParseFloat(m[\"Ask\"], 64); err != nil {\n        return err\n    }\n    if msg.SymbolSpread, err = strconv.ParseFloat(m[\"Spread\"], 64); err != nil {\n        return err\n    }\n    if msg.SymbolPT, err = strconv.ParseInt(m[\"ProductType\"], 10, 64); err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 1, "accepted_answer_id": 43700326, "answer_count": 1, "score": 0, "last_activity_date": 1493501778, "creation_date": 1493494635, "last_edit_date": 1493498942, "question_id": 43699741, "link": "https://stackoverflow.com/questions/43699741/golang-json-array-unmarshal-into-type-struct", "title": "golang json array unmarshal into type struct", "body": "<p>What is causing this to not break apart json?  Anyone have an idea on how type is wrong?</p>\n\n<p>With error of:</p>\n\n<blockquote>\n  <p>{\"Rates\":[{\"Symbol\":\"EURAUD\",\"Bid\":\"1.45492\",\"Ask\":\"1.45608\",\"Spread\":\"11.60\",\"ProductType\":\"1\",},{\"Symbol\":\"Copper\",\"Bid\":\"2.6068\",\"Ask\":\"2.6088\",\"Spread\":\"2.00\",\"ProductType\":\"3\",},{\"Symbol\":\"AUDNZD\",\"Bid\":\"1.08999\",\"Ask\":\"1.09177\",\"Spread\":\"17.80\",\"ProductType\":\"1\",},{\"Symbol\":\"EURSEK\",\"Bid\":\"9.63786\",\"Ask\":\"9.65569\",\"Spread\":\"178.30\",\"ProductType\":\"1\",},{\"Symbol\":\"CADJPY\",\"Bid\":\"81.629\",\"Ask\":\"81.708\",\"Spread\":\"7.90\",\"ProductType\":\"1\",},{\"Symbol\":\"USDCHF\",\"Bid\":\"0.99463\",\"Ask\":\"0.99527\",\"Spread\":\"6.40\",\"ProductType\":\"1\",},{\"Symbol\":\"USDCNH\",\"Bid\":\"6.8973\",\"Ask\":\"6.8993\",\"Spread\":\"20.00\",\"ProductType\":\"1\",},{\"Symbol\":\"US30\",\"Bid\":\"20950.00\",\"Ask\":\"20952.00\",\"Spread\":\"2.00\",\"ProductType\":\"2\",},{\"Symbol\":\"XAGUSD\",\"Bid\":\"17.202\",\"Ask\":\"17.25\",\"Spread\":\"4.80\",\"ProductType\":\"5\",},{\"Symbol\":\"USDSEK\",\"Bid\":\"8.84794\",\"Ask\":\"8.85542\",\"Spread\":\"74.80\",\"ProductType\":\"1\",},{\"Symbol\":\"AUDCHF\",\"Bid\":\"0.74417\",\"Ask\":\"0.74588\",\"Spread\":\"17.10\",\"ProductType\":\"1\",},{\"Symbol\":\"GER30\",\"Bid\":\"12431.05\",\"Ask\":\"12433.45\",\"Spread\":\"2.40\",\"ProductType\":\"2\",},{\"Symbol\":\"USOil\",\"Bid\":\"49.16\",\"Ask\":\"49.21\",\"Spread\":\"5.00\",\"ProductType\":\"3\",},{\"Symbol\":\"GBPNZD\",\"Bid\":\"1.88546\",\"Ask\":\"1.88762\",\"Spread\":\"21.60\",\"ProductType\":\"1\",},{\"Symbol\":\"EURCAD\",\"Bid\":\"1.48748\",\"Ask\":\"1.48893\",\"Spread\":\"14.50\",\"ProductType\":\"1\",},{\"Symbol\":\"EURUSD\",\"Bid\":\"1.08977\",\"Ask\":\"1.08997\",\"Spread\":\"2.00\",\"ProductType\":\"1\",},{\"Symbol\":\"AUS200\",\"Bid\":\"5922.00\",\"Ask\":\"5924.00\",\"Spread\":\"2.00\",\"ProductType\":\"2\",},{\"Symbol\":\"EURJPY\",\"Bid\":\"121.512\",\"Ask\":\"121.57\",\"Spread\":\"5.80\",\"ProductType\":\"1\",},{\"Symbol\":\"EURGBP\",\"Bid\":\"0.84132\",\"Ask\":\"0.84208\",\"Spread\":\"7.60\",\"ProductType\":\"1\",},{\"Symbol\":\"EURNOK\",\"Bid\":\"9.34136\",\"Ask\":\"9.36364\",\"Spread\":\"222.80\",\"ProductType\":\"1\",},{\"Symbol\":\"USDCAD\",\"Bid\":\"1.36524\",\"Ask\":\"1.36588\",\"Spread\":\"6.40\",\"ProductType\":\"1\",},{\"Symbol\":\"GBPCHF\",\"Bid\":\"1.28753\",\"Ask\":\"1.28922\",\"Spread\":\"16.90\",\"ProductType\":\"1\",},{\"Symbol\":\"GBPAUD\",\"Bid\":\"1.72838\",\"Ask\":\"1.7303\",\"Spread\":\"19.20\",\"ProductType\":\"1\",},{\"Symbol\":\"USDJPY\",\"Bid\":\"111.51\",\"Ask\":\"111.537\",\"Spread\":\"2.70\",\"ProductType\":\"1\",},{\"Symbol\":\"USDNOK\",\"Bid\":\"8.57607\",\"Ask\":\"8.58684\",\"Spread\":\"107.70\",\"ProductType\":\"1\",},{\"Symbol\":\"AUDCAD\",\"Bid\":\"1.02173\",\"Ask\":\"1.02347\",\"Spread\":\"17.40\",\"ProductType\":\"1\",},{\"Symbol\":\"FRA40\",\"Bid\":\"5259.60\",\"Ask\":\"5267.30\",\"Spread\":\"7.70\",\"ProductType\":\"2\",},{\"Symbol\":\"AUDUSD\",\"Bid\":\"0.74858\",\"Ask\":\"0.74899\",\"Spread\":\"4.10\",\"ProductType\":\"1\",},{\"Symbol\":\"USDHKD\",\"Bid\":\"7.77769\",\"Ask\":\"7.77956\",\"Spread\":\"18.70\",\"ProductType\":\"1\",},{\"Symbol\":\"NZDCHF\",\"Bid\":\"0.68192\",\"Ask\":\"0.68406\",\"Spread\":\"21.40\",\"ProductType\":\"1\",},{\"Symbol\":\"EURTRY\",\"Bid\":\"3.86851\",\"Ask\":\"3.87478\",\"Spread\":\"62.70\",\"ProductType\":\"1\",},{\"Symbol\":\"AUDJPY\",\"Bid\":\"83.469\",\"Ask\":\"83.543\",\"Spread\":\"7.40\",\"ProductType\":\"1\",},{\"Symbol\":\"USDZAR\",\"Bid\":\"13.3464\",\"Ask\":\"13.3941\",\"Spread\":\"477.00\",\"ProductType\":\"1\",},{\"Symbol\":\"Bund\",\"Bid\":\"161.78\",\"Ask\":\"161.81\",\"Spread\":\"3.00\",\"ProductType\":\"4\",},{\"Symbol\":\"USDMXN\",\"Bid\":\"18.81249\",\"Ask\":\"18.83178\",\"Spread\":\"192.90\",\"ProductType\":\"1\",},{\"Symbol\":\"USDTRY\",\"Bid\":\"3.54925\",\"Ask\":\"3.5536\",\"Spread\":\"43.50\",\"ProductType\":\"1\",},{\"Symbol\":\"USDOLLAR\",\"Bid\":\"12232.00\",\"Ask\":\"12237.00\",\"Spread\":\"5.00\",\"ProductType\":\"7\",},{\"Symbol\":\"JPN225\",\"Bid\":\"19195.00\",\"Ask\":\"19205.00\",\"Spread\":\"10.00\",\"ProductType\":\"2\",},{\"Symbol\":\"UK100\",\"Bid\":\"7197.80\",\"Ask\":\"7198.90\",\"Spread\":\"1.10\",\"ProductType\":\"2\",},{\"Symbol\":\"HKG33\",\"Bid\":\"24650.00\",\"Ask\":\"24655.00\",\"Spread\":\"5.00\",\"ProductType\":\"2\",},{\"Symbol\":\"CADCHF\",\"Bid\":\"0.72748\",\"Ask\":\"0.72979\",\"Spread\":\"23.10\",\"ProductType\":\"1\",},{\"Symbol\":\"NAS100\",\"Bid\":\"5582.80\",\"Ask\":\"5583.80\",\"Spread\":\"1.00\",\"ProductType\":\"2\",},{\"Symbol\":\"NGAS\",\"Bid\":\"3.2645\",\"Ask\":\"3.2755\",\"Spread\":\"11.00\",\"ProductType\":\"3\",},{\"Symbol\":\"ZARJPY\",\"Bid\":\"8.323\",\"Ask\":\"8.361\",\"Spread\":\"3.80\",\"ProductType\":\"1\",},{\"Symbol\":\"GBPCAD\",\"Bid\":\"1.76724\",\"Ask\":\"1.76912\",\"Spread\":\"18.80\",\"ProductType\":\"1\",},{\"Symbol\":\"ESP35\",\"Bid\":\"10712.00\",\"Ask\":\"10720.00\",\"Spread\":\"8.00\",\"ProductType\":\"2\",},{\"Symbol\":\"GBPUSD\",\"Bid\":\"1.29452\",\"Ask\":\"1.29527\",\"Spread\":\"7.50\",\"ProductType\":\"1\",},{\"Symbol\":\"SPX500\",\"Bid\":\"2384.18\",\"Ask\":\"2384.68\",\"Spread\":\"5.00\",\"ProductType\":\"2\",},{\"Symbol\":\"GBPJPY\",\"Bid\":\"144.336\",\"Ask\":\"144.448\",\"Spread\":\"11.20\",\"ProductType\":\"1\",},{\"Symbol\":\"EUSTX50\",\"Bid\":\"3554.00\",\"Ask\":\"3555.00\",\"Spread\":\"1.00\",\"ProductType\":\"2\",},{\"Symbol\":\"TRYJPY\",\"Bid\":\"31.378\",\"Ask\":\"31.44\",\"Spread\":\"6.20\",\"ProductType\":\"1\",},{\"Symbol\":\"NZDCAD\",\"Bid\":\"0.93642\",\"Ask\":\"0.93862\",\"Spread\":\"22.00\",\"ProductType\":\"1\",},{\"Symbol\":\"EURNZD\",\"Bid\":\"1.58644\",\"Ask\":\"1.58916\",\"Spread\":\"27.20\",\"ProductType\":\"1\",},{\"Symbol\":\"XAUUSD\",\"Bid\":\"1267.79\",\"Ask\":\"1268.26\",\"Spread\":\"47.00\",\"ProductType\":\"5\",},{\"Symbol\":\"NZDUSD\",\"Bid\":\"0.68587\",\"Ask\":\"0.68692\",\"Spread\":\"10.50\",\"ProductType\":\"1\",},{\"Symbol\":\"NZDJPY\",\"Bid\":\"76.489\",\"Ask\":\"76.607\",\"Spread\":\"11.80\",\"ProductType\":\"1\",},{\"Symbol\":\"UKOil\",\"Bid\":\"51.84\",\"Ask\":\"51.89\",\"Spread\":\"5.00\",\"ProductType\":\"3\",},{\"Symbol\":\"CHFJPY\",\"Bid\":\"112.02\",\"Ask\":\"112.148\",\"Spread\":\"12.80\",\"ProductType\":\"1\",},{\"Symbol\":\"EURCHF\",\"Bid\":\"1.08416\",\"Ask\":\"1.08459\",\"Spread\":\"4.30\",\"ProductType\":\"1\",}]}\n  {\"Rates\":[{\"Symbol\":\"EURAUD\",\"Bid\":\"1.45492\",\"Ask\":\"1.45608\",\"Spread\":\"11.60\",\"ProductType\":\"1\"},{\"Symbol\":\"Copper\",\"Bid\":\"2.6068\",\"Ask\":\"2.6088\",\"Spread\":\"2.00\",\"ProductType\":\"3\"},{\"Symbol\":\"AUDNZD\",\"Bid\":\"1.08999\",\"Ask\":\"1.09177\",\"Spread\":\"17.80\",\"ProductType\":\"1\"},{\"Symbol\":\"EURSEK\",\"Bid\":\"9.63786\",\"Ask\":\"9.65569\",\"Spread\":\"178.30\",\"ProductType\":\"1\"},{\"Symbol\":\"CADJPY\",\"Bid\":\"81.629\",\"Ask\":\"81.708\",\"Spread\":\"7.90\",\"ProductType\":\"1\"},{\"Symbol\":\"USDCHF\",\"Bid\":\"0.99463\",\"Ask\":\"0.99527\",\"Spread\":\"6.40\",\"ProductType\":\"1\"},{\"Symbol\":\"USDCNH\",\"Bid\":\"6.8973\",\"Ask\":\"6.8993\",\"Spread\":\"20.00\",\"ProductType\":\"1\"},{\"Symbol\":\"US30\",\"Bid\":\"20950.00\",\"Ask\":\"20952.00\",\"Spread\":\"2.00\",\"ProductType\":\"2\"},{\"Symbol\":\"XAGUSD\",\"Bid\":\"17.202\",\"Ask\":\"17.25\",\"Spread\":\"4.80\",\"ProductType\":\"5\"},{\"Symbol\":\"USDSEK\",\"Bid\":\"8.84794\",\"Ask\":\"8.85542\",\"Spread\":\"74.80\",\"ProductType\":\"1\"},{\"Symbol\":\"AUDCHF\",\"Bid\":\"0.74417\",\"Ask\":\"0.74588\",\"Spread\":\"17.10\",\"ProductType\":\"1\"},{\"Symbol\":\"GER30\",\"Bid\":\"12431.05\",\"Ask\":\"12433.45\",\"Spread\":\"2.40\",\"ProductType\":\"2\"},{\"Symbol\":\"USOil\",\"Bid\":\"49.16\",\"Ask\":\"49.21\",\"Spread\":\"5.00\",\"ProductType\":\"3\"},{\"Symbol\":\"GBPNZD\",\"Bid\":\"1.88546\",\"Ask\":\"1.88762\",\"Spread\":\"21.60\",\"ProductType\":\"1\"},{\"Symbol\":\"EURCAD\",\"Bid\":\"1.48748\",\"Ask\":\"1.48893\",\"Spread\":\"14.50\",\"ProductType\":\"1\"},{\"Symbol\":\"EURUSD\",\"Bid\":\"1.08977\",\"Ask\":\"1.08997\",\"Spread\":\"2.00\",\"ProductType\":\"1\"},{\"Symbol\":\"AUS200\",\"Bid\":\"5922.00\",\"Ask\":\"5924.00\",\"Spread\":\"2.00\",\"ProductType\":\"2\"},{\"Symbol\":\"EURJPY\",\"Bid\":\"121.512\",\"Ask\":\"121.57\",\"Spread\":\"5.80\",\"ProductType\":\"1\"},{\"Symbol\":\"EURGBP\",\"Bid\":\"0.84132\",\"Ask\":\"0.84208\",\"Spread\":\"7.60\",\"ProductType\":\"1\"},{\"Symbol\":\"EURNOK\",\"Bid\":\"9.34136\",\"Ask\":\"9.36364\",\"Spread\":\"222.80\",\"ProductType\":\"1\"},{\"Symbol\":\"USDCAD\",\"Bid\":\"1.36524\",\"Ask\":\"1.36588\",\"Spread\":\"6.40\",\"ProductType\":\"1\"},{\"Symbol\":\"GBPCHF\",\"Bid\":\"1.28753\",\"Ask\":\"1.28922\",\"Spread\":\"16.90\",\"ProductType\":\"1\"},{\"Symbol\":\"GBPAUD\",\"Bid\":\"1.72838\",\"Ask\":\"1.7303\",\"Spread\":\"19.20\",\"ProductType\":\"1\"},{\"Symbol\":\"USDJPY\",\"Bid\":\"111.51\",\"Ask\":\"111.537\",\"Spread\":\"2.70\",\"ProductType\":\"1\"},{\"Symbol\":\"USDNOK\",\"Bid\":\"8.57607\",\"Ask\":\"8.58684\",\"Spread\":\"107.70\",\"ProductType\":\"1\"},{\"Symbol\":\"AUDCAD\",\"Bid\":\"1.02173\",\"Ask\":\"1.02347\",\"Spread\":\"17.40\",\"ProductType\":\"1\"},{\"Symbol\":\"FRA40\",\"Bid\":\"5259.60\",\"Ask\":\"5267.30\",\"Spread\":\"7.70\",\"ProductType\":\"2\"},{\"Symbol\":\"AUDUSD\",\"Bid\":\"0.74858\",\"Ask\":\"0.74899\",\"Spread\":\"4.10\",\"ProductType\":\"1\"},{\"Symbol\":\"USDHKD\",\"Bid\":\"7.77769\",\"Ask\":\"7.77956\",\"Spread\":\"18.70\",\"ProductType\":\"1\"},{\"Symbol\":\"NZDCHF\",\"Bid\":\"0.68192\",\"Ask\":\"0.68406\",\"Spread\":\"21.40\",\"ProductType\":\"1\"},{\"Symbol\":\"EURTRY\",\"Bid\":\"3.86851\",\"Ask\":\"3.87478\",\"Spread\":\"62.70\",\"ProductType\":\"1\"},{\"Symbol\":\"AUDJPY\",\"Bid\":\"83.469\",\"Ask\":\"83.543\",\"Spread\":\"7.40\",\"ProductType\":\"1\"},{\"Symbol\":\"USDZAR\",\"Bid\":\"13.3464\",\"Ask\":\"13.3941\",\"Spread\":\"477.00\",\"ProductType\":\"1\"},{\"Symbol\":\"Bund\",\"Bid\":\"161.78\",\"Ask\":\"161.81\",\"Spread\":\"3.00\",\"ProductType\":\"4\"},{\"Symbol\":\"USDMXN\",\"Bid\":\"18.81249\",\"Ask\":\"18.83178\",\"Spread\":\"192.90\",\"ProductType\":\"1\"},{\"Symbol\":\"USDTRY\",\"Bid\":\"3.54925\",\"Ask\":\"3.5536\",\"Spread\":\"43.50\",\"ProductType\":\"1\"},{\"Symbol\":\"USDOLLAR\",\"Bid\":\"12232.00\",\"Ask\":\"12237.00\",\"Spread\":\"5.00\",\"ProductType\":\"7\"},{\"Symbol\":\"JPN225\",\"Bid\":\"19195.00\",\"Ask\":\"19205.00\",\"Spread\":\"10.00\",\"ProductType\":\"2\"},{\"Symbol\":\"UK100\",\"Bid\":\"7197.80\",\"Ask\":\"7198.90\",\"Spread\":\"1.10\",\"ProductType\":\"2\"},{\"Symbol\":\"HKG33\",\"Bid\":\"24650.00\",\"Ask\":\"24655.00\",\"Spread\":\"5.00\",\"ProductType\":\"2\"},{\"Symbol\":\"CADCHF\",\"Bid\":\"0.72748\",\"Ask\":\"0.72979\",\"Spread\":\"23.10\",\"ProductType\":\"1\"},{\"Symbol\":\"NAS100\",\"Bid\":\"5582.80\",\"Ask\":\"5583.80\",\"Spread\":\"1.00\",\"ProductType\":\"2\"},{\"Symbol\":\"NGAS\",\"Bid\":\"3.2645\",\"Ask\":\"3.2755\",\"Spread\":\"11.00\",\"ProductType\":\"3\"},{\"Symbol\":\"ZARJPY\",\"Bid\":\"8.323\",\"Ask\":\"8.361\",\"Spread\":\"3.80\",\"ProductType\":\"1\"},{\"Symbol\":\"GBPCAD\",\"Bid\":\"1.76724\",\"Ask\":\"1.76912\",\"Spread\":\"18.80\",\"ProductType\":\"1\"},{\"Symbol\":\"ESP35\",\"Bid\":\"10712.00\",\"Ask\":\"10720.00\",\"Spread\":\"8.00\",\"ProductType\":\"2\"},{\"Symbol\":\"GBPUSD\",\"Bid\":\"1.29452\",\"Ask\":\"1.29527\",\"Spread\":\"7.50\",\"ProductType\":\"1\"},{\"Symbol\":\"SPX500\",\"Bid\":\"2384.18\",\"Ask\":\"2384.68\",\"Spread\":\"5.00\",\"ProductType\":\"2\"},{\"Symbol\":\"GBPJPY\",\"Bid\":\"144.336\",\"Ask\":\"144.448\",\"Spread\":\"11.20\",\"ProductType\":\"1\"},{\"Symbol\":\"EUSTX50\",\"Bid\":\"3554.00\",\"Ask\":\"3555.00\",\"Spread\":\"1.00\",\"ProductType\":\"2\"},{\"Symbol\":\"TRYJPY\",\"Bid\":\"31.378\",\"Ask\":\"31.44\",\"Spread\":\"6.20\",\"ProductType\":\"1\"},{\"Symbol\":\"NZDCAD\",\"Bid\":\"0.93642\",\"Ask\":\"0.93862\",\"Spread\":\"22.00\",\"ProductType\":\"1\"},{\"Symbol\":\"EURNZD\",\"Bid\":\"1.58644\",\"Ask\":\"1.58916\",\"Spread\":\"27.20\",\"ProductType\":\"1\"},{\"Symbol\":\"XAUUSD\",\"Bid\":\"1267.79\",\"Ask\":\"1268.26\",\"Spread\":\"47.00\",\"ProductType\":\"5\"},{\"Symbol\":\"NZDUSD\",\"Bid\":\"0.68587\",\"Ask\":\"0.68692\",\"Spread\":\"10.50\",\"ProductType\":\"1\"},{\"Symbol\":\"NZDJPY\",\"Bid\":\"76.489\",\"Ask\":\"76.607\",\"Spread\":\"11.80\",\"ProductType\":\"1\"},{\"Symbol\":\"UKOil\",\"Bid\":\"51.84\",\"Ask\":\"51.89\",\"Spread\":\"5.00\",\"ProductType\":\"3\"},{\"Symbol\":\"CHFJPY\",\"Bid\":\"112.02\",\"Ask\":\"112.148\",\"Spread\":\"12.80\",\"ProductType\":\"1\"},{\"Symbol\":\"EURCHF\",\"Bid\":\"1.08416\",\"Ask\":\"1.08459\",\"Spread\":\"4.30\",\"ProductType\":\"1\"}]}</p>\n  \n  <p>panic: json: cannot unmarshal string into Go value of type\n  main.MsgRatesArray</p>\n  \n  <p>goroutine 1 [running]:</p>\n  \n  <p>main.main()</p>\n\n<pre><code>    /tmp/test.go:50 +0x52c\n</code></pre>\n</blockquote>\n\n<p>With this code:</p>\n\n<pre><code>package main\n\nimport (\n        \"log\"\n        \"fmt\"\n        \"net/http\"\n        \"bytes\"\n        \"io/ioutil\"\n        \"strings\"\n        \"github.com/pquerna/ffjson/ffjson\"\n)\n\n\ntype MsgRatesArray struct {\n        RateQuote []MsgRateQuoteJson `json:\"Rates\"`\n}\ntype MsgRateQuoteJson struct {\n        SymbolName string `json:\"Symbol\"`\n        SymbolBid int64 `json:\"Bid\"`\n        SymbolAsk int64 `json:\"Ask\"`\n        SymbolSpread int64 `json:\"Spread\"`\n        SymbolPT string `json:\"ProductType\"`\n}\n\nvar respBytes []byte\n\nfunc main() {\n    var msg MsgRatesArray\n    response,err := http.Get(\"https://ratesjson.fxcm.com/DataDisplayer\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer response.Body.Close()\n    respBytes, err := ioutil.ReadAll(response.Body)\n    //Get bad JSON into string\n    jsonBytes := respBytes[bytes.Index(respBytes, []byte(\"{\")):bytes.LastIndex(respBytes, []byte(\"}\"))+1]\n    jsonString := string(jsonBytes)\n    fmt.Println(jsonString)\n    // Use a positive number to indicate max replacement count to fix bad JSON string so we can remove comma in JSON ARRAY.\n    result := strings.Replace(jsonString, \"\\\",}\", \"\\\"}\", -1)\n    fmt.Println(result)\n    // Turn GOOD JSON string back to JSON BYTES (BIN)\n    jsonBytes2, err := ffjson.Marshal(result)\n    if err != nil {\n        panic(err)\n    }\n    // Parse JSON !\n    err = ffjson.Unmarshal(jsonBytes2, &amp;msg)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>What is wrong with type for json array?</p>\n"}, {"tags": ["go"], "owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1670, "favorite_count": 0, "closed_date": 1493495494, "answer_count": 0, "score": 6, "last_activity_date": 1493486466, "creation_date": 1493486466, "question_id": 43698487, "link": "https://stackoverflow.com/questions/43698487/difference-between-golang-new-vs-struct-literal-especially-in-memory-allocati", "closed_reason": "Duplicate", "title": "Difference between golang new() vs struct literal, especially in memory allocation", "body": "<p>Say I have a struct:</p>\n\n<pre><code>type foo struct {\n}\n</code></pre>\n\n<p>Are there any difference between</p>\n\n<pre><code>f := &amp;foo{}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>f := new(foo)\n</code></pre>\n\n<p>in terms of the machine code it gets compiled into, or it's just merely a syntax difference?</p>\n\n<p>A more specific question:</p>\n\n<p>As for struct literal (<code>&amp;foo{}</code>), the memory can be allocated in stack or heap, depends on the escape analysis.</p>\n\n<p>However for <code>new(foo)</code>, I am not quite sure:</p>\n\n<p><code>calloc()</code> in c is similar to <code>new()</code> in golang from my understanding. But <code>calloc()</code> always allocate on heap. I am wondering if <code>new()</code> always allocate in heap?</p>\n\n<p>The golang spec (<a href=\"https://golang.org/ref/spec#Allocation\" rel=\"noreferrer\">https://golang.org/ref/spec#Allocation</a>) only mentioned:</p>\n\n<blockquote>\n  <p>The built-in function new takes a type T, allocates storage for a\n  variable of that type at run time, and returns a value of type *T\n  pointing to it. The variable is initialized as described in the\n  section on initial values.</p>\n</blockquote>\n\n<p>It does not say where <code>new()</code> will allocate the memory. So does <code>new()</code> always allocate on heap, or it can also be allocated in stack as well --- Exactly same as struct literal in memory allocation?</p>\n"}, {"tags": ["go", "neo4j", "neoism"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7695748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af02370a1aa34bf0c878dbd7922c184?s=128&d=identicon&r=PG&f=1", "display_name": "amerikiwi", "link": "https://stackoverflow.com/users/7695748/amerikiwi"}, "edited": false, "score": 0, "creation_date": 1493487436, "post_id": 43698019, "comment_id": 74442120, "body": "My question is how to parse the results of the query. Your suggestion is just another way to get the same response. The path query I am using returns both the nodes as relationships already. How to parse the query response for the nodes and relationships?"}], "tags": [], "owner": {"reputation": 26608, "user_id": 92359, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/664d3d4c50c731d90a32db5f9e01b4b9?s=128&d=identicon&r=PG", "display_name": "InverseFalcon", "link": "https://stackoverflow.com/users/92359/inversefalcon"}, "is_accepted": false, "score": 0, "last_activity_date": 1493483512, "creation_date": 1493483512, "answer_id": 43698019, "question_id": 43697960, "link": "https://stackoverflow.com/questions/43697960/neoism-how-to-parse-query-with-path-result/43698019#43698019", "title": "neoism how to parse query with &quot;path&quot; result", "body": "<p>You can always return these from the query itself, instead of the path:</p>\n\n<pre><code>...\nreturn nodes(path) as nodes, relationships(path) as relationships\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7695748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3af02370a1aa34bf0c878dbd7922c184?s=128&d=identicon&r=PG&f=1", "display_name": "amerikiwi", "link": "https://stackoverflow.com/users/7695748/amerikiwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493483512, "creation_date": 1493483170, "question_id": 43697960, "link": "https://stackoverflow.com/questions/43697960/neoism-how-to-parse-query-with-path-result", "title": "neoism how to parse query with &quot;path&quot; result", "body": "<p>I have this query:\nmatch path =  (test:Test {t_name:\"Test-1\"})-[r*]->(child) return path</p>\n\n<p>Json response:\nresults [1]\n - columns[1]\n    - 0: path\n - data[6]\n    - row[1]\n    - meta[1]\n    - graph\n        - nodes[2]\n        - relationships[1]</p>\n\n<p>How to parse this query result in Neoism? I want to get the nodes and relationships in the response result.</p>\n"}]