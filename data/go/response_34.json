[{"tags": ["shell", "go", "command-line-interface", "tty", "stty"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1441233497, "post_id": 32364252, "comment_id": 52601006, "body": "You&#39;re looking for: <a href=\"https://github.com/nsf/termbox-go/\" rel=\"nofollow noreferrer\">github.com/nsf/termbox-go</a>"}, {"owner": {"reputation": 7957, "user_id": 243568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6vWWf.jpg?s=128&g=1", "display_name": "Robert Hurst", "link": "https://stackoverflow.com/users/243568/robert-hurst"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1441234689, "post_id": 32364252, "comment_id": 52601373, "body": "@TimCooper Much appreciated tim :)"}], "answers": [{"tags": [], "owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "is_accepted": true, "score": 4, "last_activity_date": 1441234407, "last_edit_date": 1441234407, "creation_date": 1441233558, "answer_id": 32364289, "question_id": 32364252, "link": "https://stackoverflow.com/questions/32364252/making-a-full-screen-terminal-application-with-go/32364289#32364289", "title": "Making a full screen Terminal application with Go", "body": "<p>The easiest way to clear the terminal and set position is via ansi escape codes. However, this may not be the ideal way as variation in terminals may come back to bite you.</p>\n\n<pre><code>fmt.Print(\"\\033[2J\") //Clear screen\nfmt.Printf(\"\\033[%d;%dH\", line, col) // Set cursor position\n</code></pre>\n\n<p>A better alternative would be to use a library like <a href=\"https://github.com/rthornton128/goncurses\" rel=\"nofollow\">goncurses</a> or <a href=\"https://github.com/nsf/termbox-go/\" rel=\"nofollow\">termbox-go</a> (credit: second is from Tim Cooper's comment).</p>\n\n<p>With such a library you can do things like this: </p>\n\n<pre><code>import (\n    gc \"code.google.com/p/goncurses\"\n)\n\nfunc main() {\n    s, err := gc.Init()\n    if err != nil {\n        panic(err)\n    }\n    defer gc.End()\n    s.Move(5, 2)\n    s.Println(\"Hello\")\n    s.GetChar()\n}\n</code></pre>\n\n<p>Code above copied from <a href=\"http://rosettacode.org/wiki/Terminal_control/Cursor_positioning#Ncurses\" rel=\"nofollow\">Rosetta Code</a></p>\n"}, {"tags": [], "owner": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "is_accepted": false, "score": 0, "last_activity_date": 1564690998, "creation_date": 1564690998, "answer_id": 57316508, "question_id": 32364252, "link": "https://stackoverflow.com/questions/32364252/making-a-full-screen-terminal-application-with-go/57316508#57316508", "title": "Making a full screen Terminal application with Go", "body": "<p>To stop the terminal from printing keys pressed you can use the below code:</p>\n\n<pre>\n    import (\n        \"fmt\"\n        \"syscall\"\n        \"golang.org/x/crypto/ssh/terminal\"\n    )\n\n    func main(){\n        fmt.Print(\"Enter Value: \")\n        byteInput, _ := terminal.ReadPassword(int(syscall.Stdin))\n        input:= string(byteInput)\n        fmt.Println() // it's necessary to add a new line after user's input\n        fmt.Printf(\"Your input is '%s'\", input)\n    }\n</pre>\n"}, {"tags": [], "owner": {"reputation": 3571, "user_id": 2693875, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b7853fb2bdc0b5958a28da6984178c82?s=128&d=identicon&r=PG", "display_name": "Greg Dubicki", "link": "https://stackoverflow.com/users/2693875/greg-dubicki"}, "is_accepted": false, "score": 0, "last_activity_date": 1577346761, "creation_date": 1577346761, "answer_id": 59485485, "question_id": 32364252, "link": "https://stackoverflow.com/questions/32364252/making-a-full-screen-terminal-application-with-go/59485485#59485485", "title": "Making a full screen Terminal application with Go", "body": "<p>As of December 2019, I would recommend using <a href=\"https://github.com/rivo/tview\" rel=\"nofollow noreferrer\">rivo/tview</a> library.</p>\n\n<p>(<a href=\"https://github.com/rthornton128/goncurses\" rel=\"nofollow noreferrer\">goncurses</a> mentioned by @vastlysuperiorman has not been updated since June 2019 and <a href=\"https://github.com/nsf/termbox-go/\" rel=\"nofollow noreferrer\">termbox-go</a> is explicitly declared unmaintained).</p>\n\n<p><br/></p>\n\n<p>Here's the \"hello world\" app, taken from the project's README (reformatted for readability):</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/rivo/tview\"\n)\n\nfunc main() {\n\n    box := tview.NewBox().\n        SetBorder(true).\n        SetTitle(\"Hello, world!\")\n\n    if err := tview.NewApplication().SetRoot(box, true).Run(); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><br/></p>\n\n<p>tview provides <a href=\"https://github.com/rivo/tview/wiki\" rel=\"nofollow noreferrer\">screenshots and example code</a> as well as the standard <a href=\"https://godoc.org/github.com/rivo/tview\" rel=\"nofollow noreferrer\">godoc reference</a>.</p>\n"}], "owner": {"reputation": 7957, "user_id": 243568, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6vWWf.jpg?s=128&g=1", "display_name": "Robert Hurst", "link": "https://stackoverflow.com/users/243568/robert-hurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "accepted_answer_id": 32364289, "answer_count": 3, "score": 3, "last_activity_date": 1577346761, "creation_date": 1441233360, "last_edit_date": 1441233529, "question_id": 32364252, "link": "https://stackoverflow.com/questions/32364252/making-a-full-screen-terminal-application-with-go", "title": "Making a full screen Terminal application with Go", "body": "<p>I'm trying to build a full screen terminal application. I'm using Go as my language of choice. I've figured out how to read from <code>os.Stdin</code>, but I'm unclear on how to clear the terminal window and manipulate the cursor position. I also want to capture the terminal input without it being printed (echoed back).</p>\n\n<p>My questions are:</p>\n\n<ol>\n<li>How can I effectively clear and print to the terminal with column/row coordinates?</li>\n<li>How do I stop the terminal from printing keys pressed</li>\n</ol>\n\n<p>My intent:</p>\n\n<p>I want to create a full screen terminal application that renders it's own UI and handles input internally (hot keys/navigation/etc...).</p>\n\n<p>If there are any libraries that cover this sort of use case please feel free to suggest them.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "edited": false, "score": 0, "creation_date": 1441401538, "post_id": 32364027, "comment_id": 52681600, "body": "Was my answer helpful? Did it solve your problem? If not, could you add clarification to the question so that we can better address any remaining issues?"}], "answers": [{"tags": [], "owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "is_accepted": true, "score": 13, "last_activity_date": 1441293121, "last_edit_date": 1441293121, "creation_date": 1441232496, "answer_id": 32364093, "question_id": 32364027, "link": "https://stackoverflow.com/questions/32364027/reference-a-boolean-for-assignment-in-a-struct/32364093#32364093", "title": "Reference a boolean for assignment in a struct", "body": "<p>You can do this by storing true in a memory location and then accessing it as seen here:</p>\n\n<pre><code>type MyStruct struct {\n    IsEnabled *bool\n}\n\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n    t := true // Save \"true\" in memory\n    m := MyStruct{&amp;t} // Reference the location of \"true\"\n    fmt.Println(*m.IsEnabled) // Prints: true\n}\n</code></pre>\n\n<p>From the <a href=\"https://golang.org/ref/spec#TypeName\" rel=\"noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>Named instances of the boolean, numeric, and string types are\n  predeclared. Composite types\u2014array, struct, pointer, function,\n  interface, slice, map, and channel types\u2014may be constructed using type\n  literals.</p>\n</blockquote>\n\n<p>Since boolean values are predeclared, you can't create them via a composite literal (they're not composite types). The type <code>bool</code> has two <code>const</code> values <code>true</code> and <code>false</code>. This rules out the creation of a literal boolean in this manner: <code>b := &amp;bool{true}</code> or similar.</p>\n\n<p>It should be noted that setting a *bool to <code>false</code> is quite a bit easier as <code>new()</code> will initialize a bool to that value. Thus:</p>\n\n<pre><code>m.IsEnabled = new(bool)\nfmt.Println(*m.IsEnabled) // False\n</code></pre>\n"}], "owner": {"reputation": 10043, "user_id": 389161, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c77a349e89f6e9c0f109e528f90ca6f1?s=128&d=identicon&r=PG", "display_name": "Taranfx", "link": "https://stackoverflow.com/users/389161/taranfx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5081, "favorite_count": 1, "accepted_answer_id": 32364093, "answer_count": 1, "score": 6, "last_activity_date": 1441299677, "creation_date": 1441232070, "last_edit_date": 1441299677, "question_id": 32364027, "link": "https://stackoverflow.com/questions/32364027/reference-a-boolean-for-assignment-in-a-struct", "title": "Reference a boolean for assignment in a struct", "body": "<pre><code>type MyStruct struct {\n\n    IsEnabled *bool\n}\n</code></pre>\n\n<p>How do I change value of *IsEnabled = true</p>\n\n<p>None of these work: </p>\n\n<pre><code>*(MyStruct.IsEnabled) = true\n*MyStruct.IsEnabled = true\nMyStruct.*IsEnabled = true\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "edited": false, "score": 0, "creation_date": 1441226788, "post_id": 32362718, "comment_id": 52598330, "body": "I&#39;m getting:  <code>controllers&#47;resize_controller.go:26: multiple-value strconv.ParseUint() in single-value context controllers&#47;resize_controller.go:27: multiple-value strconv.ParseUint() in single-value context</code> now"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "edited": false, "score": 0, "creation_date": 1441226929, "post_id": 32362718, "comment_id": 52598409, "body": "Thank you so much! Perfect."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 28, "last_activity_date": 1599427426, "last_edit_date": 1599427426, "creation_date": 1441226500, "answer_id": 32362718, "question_id": 32362612, "link": "https://stackoverflow.com/questions/32362612/how-to-convert-a-uint64-into-uint/32362718#32362718", "title": "How to convert a uint64 into uint?", "body": "<p>No need to use any of the <code>strconv</code> functions; just do a <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">type conversion</a> to <code>uint</code>:</p>\n<pre><code>h64, err := strconv.ParseUint(height, 10, 32)\nif err != nil {\n    // TODO: handle error\n}\nw64, err := strconv.ParseUint(width, 10, 32)\nif err != nil {\n    // TODO: handle error\n}\nh := uint(h64)\nw := uint(w64)\n</code></pre>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13324, "favorite_count": 2, "accepted_answer_id": 32362718, "answer_count": 1, "score": 9, "last_activity_date": 1599427426, "creation_date": 1441226154, "last_edit_date": 1575163946, "question_id": 32362612, "link": "https://stackoverflow.com/questions/32362612/how-to-convert-a-uint64-into-uint", "title": "How to convert a uint64 into uint?", "body": "<p>I have the following function:</p>\n\n<pre><code>func (rc ResizeController) Resize(c *gin.Context) {\n\n    height := c.Query(\"height\")\n    width := c.Query(\"width\")\n    filepath := c.Query(\"file\")\n\n    h, err := strconv.ParseUint(height, 10, 32)\n    w, err := strconv.ParseUint(width, 10, 32)\n\n    file, err := os.Open(\"./test_images/\" + filepath)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    image, err := jpeg.Decode(file)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    m := resize.Resize(1000, 100, image, resize.Lanczos3)\n\n    buf := new(bytes.Buffer)\n    jpeg.Encode(buf, m, nil)\n    response := buf.Bytes()\n\n    c.Data(200, \"image/jpeg\", response)\n}\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>controllers/resize_controller.go:41: cannot use h (type uint64) as type uint in argument to resize.Resize\ncontrollers/resize_controller.go:41: cannot use w (type uint64) as type uint in argument to resize.Resize\n</code></pre>\n\n<p>I've tried a few different functions from the strconv lib with no luck! </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13757, "user_id": 2126755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/8QFus.jpg?s=128&g=1", "display_name": "robbmj", "link": "https://stackoverflow.com/users/2126755/robbmj"}, "edited": false, "score": 3, "creation_date": 1441223829, "post_id": 32361934, "comment_id": 52596781, "body": "An important thing to note is that you can attach a function receiver to any type in go, it need not be a struct."}, {"owner": {"reputation": 1421, "user_id": 776800, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7ac9d1b0bc23a30e97d462673b50dfa?s=128&d=identicon&r=PG", "display_name": "pogopaule", "link": "https://stackoverflow.com/users/776800/pogopaule"}, "edited": false, "score": 1, "creation_date": 1441223974, "post_id": 32361934, "comment_id": 52596867, "body": "Great! Thank you! I didn&#39;t yet make it to <a href=\"http://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">methods in the go tour</a> :-/"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 13757, "user_id": 2126755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/8QFus.jpg?s=128&g=1", "display_name": "robbmj", "link": "https://stackoverflow.com/users/2126755/robbmj"}, "edited": false, "score": 0, "creation_date": 1441227914, "post_id": 32361934, "comment_id": 52598879, "body": "@robbmj: Weirdest use of that I have seen yet is attaching a function to a function pointer."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1441230992, "post_id": 32361934, "comment_id": 52600177, "body": "@ZanLynx A good example of that would be attaching a <code>ServeHTTP</code> method on a custom function type so that it implements <code>http.Handler</code>. Not that weird at all!"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441231244, "post_id": 32361934, "comment_id": 52600273, "body": "@elithrar: It starts to look like code obfuscation when you&#39;ve got to dig through <code>f.ServeHTTP()</code>, <code>f()</code>, <code>f().PerformAction()</code>, etc."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441231558, "post_id": 32361934, "comment_id": 52600386, "body": "That&#39;s a variable naming problem: if you&#39;re using short names beyond a short scope (i.e. a 10 line function) then it certainly becomes confusing! If that was (e.g.) <code>authHandler.ServeHTTP(w, r)</code> it&#39;d be much clearer. I don&#39;t think that&#39;s an argument for <i>not</i> having methods on any types, though."}], "tags": [], "owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "is_accepted": true, "score": 12, "last_activity_date": 1441223856, "last_edit_date": 1441223856, "creation_date": 1441223569, "answer_id": 32361934, "question_id": 32361778, "link": "https://stackoverflow.com/questions/32361778/what-do-the-brackets-after-func-mean-in-go/32361934#32361934", "title": "What do the brackets after func mean in Go?", "body": "<p>This is not a function but a method. In this case, it adds the MarshalJSON method to the Version struct type.</p>\n\n<p>The <code>v</code> is the name for the received value (and would be analogous to <em>this</em> in a Java method or <em>self</em> in Python), the Version specifies the type we're adding the method to.</p>\n\n<p>See <a href=\"https://gobyexample.com/methods\">go by example</a> for, well, an example, and the <a href=\"https://golang.org/ref/spec#Method_declarations\">specification</a> for more details.</p>\n"}], "owner": {"reputation": 1421, "user_id": 776800, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a7ac9d1b0bc23a30e97d462673b50dfa?s=128&d=identicon&r=PG", "display_name": "pogopaule", "link": "https://stackoverflow.com/users/776800/pogopaule"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 32361934, "answer_count": 1, "score": 8, "last_activity_date": 1441223856, "creation_date": 1441222978, "question_id": 32361778, "link": "https://stackoverflow.com/questions/32361778/what-do-the-brackets-after-func-mean-in-go", "title": "What do the brackets after func mean in Go?", "body": "<p>As a Go beginner, I <a href=\"https://github.com/getlantern/lantern/blob/2.0.2/src/github.com/blang/semver/json.go#L8\" rel=\"noreferrer\">stumbled across code</a> where there are brackets directly after <code>func</code></p>\n\n<pre><code>func (v Version) MarshalJSON() ([]byte, error) {\n  return json.Marshal(v.String())\n}\n</code></pre>\n\n<p>So what does <code>(v Version)</code> mean?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1441222461, "creation_date": 1441222461, "answer_id": 32361655, "question_id": 32361627, "link": "https://stackoverflow.com/questions/32361627/create-bufio-interface-from-string-in-golang/32361655#32361655", "title": "Create bufio interface from string in golang", "body": "<p><a href=\"https://godoc.org/strings#Reader\" rel=\"noreferrer\"><code>strings.Reader</code></a> implements the <a href=\"https://godoc.org/io#Reader\" rel=\"noreferrer\"><code>io.Reader</code></a> interface. You can construct a new instance of it using <a href=\"https://godoc.org/strings#NewReader\" rel=\"noreferrer\"><code>strings.NewReader</code></a>:</p>\n\n<pre><code>s := \"this is my input\"\nb := strings.NewReader(s)\nt := NewTestStruct(b)\nt.doSomething()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1353, "user_id": 743158, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/b57f29f8e0fa3d10dc11f02a08226062?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Lin", "link": "https://stackoverflow.com/users/743158/jimmy-lin"}, "is_accepted": false, "score": 1, "last_activity_date": 1594016356, "creation_date": 1594016356, "answer_id": 62750283, "question_id": 32361627, "link": "https://stackoverflow.com/questions/32361627/create-bufio-interface-from-string-in-golang/62750283#62750283", "title": "Create bufio interface from string in golang", "body": "<p>This should be correct way:</p>\n<pre><code>reader := bufio.NewReader(strings.NewReader(&quot;some string&quot;))\n</code></pre>\n"}], "owner": {"reputation": 4756, "user_id": 272425, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/af6977727f08b19d0701465099e54aac?s=128&d=identicon&r=PG", "display_name": "Fabian", "link": "https://stackoverflow.com/users/272425/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1789, "favorite_count": 0, "accepted_answer_id": 32361655, "answer_count": 2, "score": 2, "last_activity_date": 1594016356, "creation_date": 1441222344, "question_id": 32361627, "link": "https://stackoverflow.com/questions/32361627/create-bufio-interface-from-string-in-golang", "title": "Create bufio interface from string in golang", "body": "<p>I want to write unit tests in golang for a struct which accepts an io.Reader in the constructor. Usually the io.Reader interface is coming from a TCP connection.</p>\n\n<p>Now I want to use a predefined string and use this as input to the io.Reader interface.</p>\n\n<p>Something like:</p>\n\n<pre><code>s := \"this is my input\"\nb := io.NewReader(s)\nt := NewTestStruct(b)\nt.doSomething()\n</code></pre>\n"}, {"tags": ["go", "projects-and-solutions"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441217198, "post_id": 32360022, "comment_id": 52593184, "body": "What do you mean by &quot;precompile build directives&quot;? (BTW, you can look at the <code>os</code>, <code>syscall</code>, and <code>net</code> packages if you want more confirmation on how to do handle multiple platforms)"}, {"owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441217379, "post_id": 32360022, "comment_id": 52593267, "body": "*build constraints, I&#39;ve updated the question"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441217430, "post_id": 32360022, "comment_id": 52593299, "body": "These <i>are</i> build constraints. They work exactly the same."}, {"owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441217624, "post_id": 32360022, "comment_id": 52593386, "body": "My understanding is that the build tool won&#39;t even read the file using the underscore method"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441217700, "post_id": 32360022, "comment_id": 52593416, "body": "In that sense, yes, the build tool will &quot;read&quot; the build constraint line then skip the file, but the outcome is the same."}, {"owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441218115, "post_id": 32360022, "comment_id": 52593640, "body": "@JimB Great suggestion on reading the source for those packages. Really sheds some light on organization"}], "answers": [{"comments": [{"owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "edited": false, "score": 0, "creation_date": 1441218864, "post_id": 32360560, "comment_id": 52594074, "body": "Thanks. The interfaces were starting to make me ask &quot;why don&#39;t I just have the same method in each of these files?&quot; Just to make sure I&#39;ve got it, in looking in the net library, there&#39;s this <a href=\"https://github.com/golang/net/blob/master/ipv4/icmp_stub.go\" rel=\"nofollow noreferrer\">_stub</a> file. That&#39;s only there so that the implementation doesn&#39;t break when built on windows, but also because there is no _windows file, correct?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "edited": false, "score": 0, "creation_date": 1441219761, "post_id": 32360560, "comment_id": 52594593, "body": "@scottm: yes, there&#39;s nothing special about _stub.go, it just has a <code>!linux</code> build constraint to provide an empty implementation for all other platforms.   If <code>sysICMPFilter</code> was added to a <code>_windows.go</code> file one day , they could add <code>!windows</code> in the stub file constraints to make the build work again."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1441218355, "creation_date": 1441218355, "answer_id": 32360560, "question_id": 32360022, "link": "https://stackoverflow.com/questions/32360022/how-should-i-organize-my-go-files-to-support-cross-platform-builds-and-enforce-c/32360560#32360560", "title": "How should I organize my go files to support cross platform builds and enforce consistency?", "body": "<p>The use of interfaces is an orthogonal concept. Use an interface where an interface makes sense, but it's often simpler just provide an implementation by the same name in the proper GOOS and GOARCH files. </p>\n\n<p>The method of using a common constructor name (from your example) is also used in places in the std lib, as is the method of assigning a global variable name to a function (which is similar in concept to the former method). </p>\n\n<p>Because Go is statically typed, and you can't redeclare global identifiers, the build system will always catch problems; it's just a matter of testing for all applicable systems to ensure that no OS or ARCH has an out of date implementation.</p>\n"}], "owner": {"reputation": 26363, "user_id": 53007, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/9bf3ccd1cf9b015cfb86d947f09aa77d?s=128&d=identicon&r=PG", "display_name": "scottm", "link": "https://stackoverflow.com/users/53007/scottm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 32360560, "answer_count": 1, "score": 0, "last_activity_date": 1441218355, "creation_date": 1441216499, "last_edit_date": 1441217648, "question_id": 32360022, "link": "https://stackoverflow.com/questions/32360022/how-should-i-organize-my-go-files-to-support-cross-platform-builds-and-enforce-c", "title": "How should I organize my go files to support cross platform builds and enforce consistency?", "body": "<p>I'm currently using a method where I have a \"base\" file that defines the types, interfaces and a basic API for the package. I then create an <code>_windows.go</code> and <code>_linux.go</code> file and add platform specific types that I can apply the interface to. The setup is basically like this: <a href=\"http://play.golang.org/p/2DJxTuSAIh\" rel=\"nofollow\">http://play.golang.org/p/2DJxTuSAIh</a>.</p>\n\n<ol>\n<li>Is this considered best practice? </li>\n<li>Would this assist in a team setting where some developers are linux focused and some windows focused, i.e. if the interface changes both teams will be notified via build failure? </li>\n</ol>\n"}, {"tags": ["go", "path"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1441202758, "post_id": 32355314, "comment_id": 52583677, "body": "Tests are run in a temp directory. You need to include the test data in the package, or provide an absolute path to the files in some other way, e.g. env variable, flag, etc."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441202902, "post_id": 32355314, "comment_id": 52583786, "body": "@JimB an envvar is simpler to handle with tests than flags, that&#39;s what I usually use"}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1441205550, "post_id": 32356198, "comment_id": 52585785, "body": "Are you assuming your app will always run from within the source and not be deployed as a stand-alone executable, ever?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1441206400, "post_id": 32356198, "comment_id": 52586437, "body": "This is a poor way to handle configuration. Not to mention your binary&#39;s directory and working directory are almost never the same when you deploy an application."}, {"owner": {"reputation": 1685, "user_id": 1291512, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFnuz.jpg?s=128&g=1", "display_name": "WhiteAngel", "link": "https://stackoverflow.com/users/1291512/whiteangel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441207302, "post_id": 32356198, "comment_id": 52587125, "body": "@JimB, so after deployment the structure won&#39;t be the same as in <code>src</code> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441207627, "post_id": 32356198, "comment_id": 52587342, "body": "Depends on how you&#39;re deploying, but using <code>go run</code> from within the source directory is definitely <i>not</i> how to do it. Install your binary properly, and make sure it has a way to locate a configuration other than depending on the layout of the source directory."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "edited": false, "score": 1, "creation_date": 1441227107, "post_id": 32356198, "comment_id": 52598514, "body": "@WhiteAngel For configuration files I think the best way is to store them on a hidden folder in the user&#39;s home directory if it&#39;s a peruser config, or in your platform default folder like <code>etc&#47;YOUR_APP</code> if it&#39;s global configuration."}, {"owner": {"reputation": 1685, "user_id": 1291512, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFnuz.jpg?s=128&g=1", "display_name": "WhiteAngel", "link": "https://stackoverflow.com/users/1291512/whiteangel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441267303, "post_id": 32356198, "comment_id": 52611730, "body": "@JimB, I see your point. Thank you for mentioning this. I will have to change this behavior after deployment for sure, but for the moment of development this way suits me really well."}], "tags": [], "owner": {"reputation": 1685, "user_id": 1291512, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFnuz.jpg?s=128&g=1", "display_name": "WhiteAngel", "link": "https://stackoverflow.com/users/1291512/whiteangel"}, "is_accepted": true, "score": -1, "last_activity_date": 1441204811, "creation_date": 1441204811, "answer_id": 32356198, "question_id": 32355314, "link": "https://stackoverflow.com/questions/32355314/how-to-access-configuration-file-from-subfolder-in-go/32356198#32356198", "title": "How to access configuration file from subfolder in Go", "body": "<p>Finally, I've finished with changing the behavior how configuration file is being loaded. Before, the load was done in <code>config</code> packed inside <code>init()</code> method.</p>\n\n<p>Instead of this I've created method <code>Load(path string)</code> that performs load of the configuration file according to <code>path</code> variable that is passed.</p>\n\n<p>Now, I call it from <code>main.go</code> like this:</p>\n\n<pre><code>config.Load(\"config/\")   \n</code></pre>\n\n<p>And from <code>api_test.go</code> like this:</p>\n\n<pre><code>config.Load(\"../config/\")\n</code></pre>\n\n<p>This is not very neat solution but in that case user is not required to specify any additional parameters while running tests.</p>\n"}], "owner": {"reputation": 1685, "user_id": 1291512, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/QFnuz.jpg?s=128&g=1", "display_name": "WhiteAngel", "link": "https://stackoverflow.com/users/1291512/whiteangel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 32356198, "answer_count": 1, "score": 0, "last_activity_date": 1441204811, "creation_date": 1441202526, "question_id": 32355314, "link": "https://stackoverflow.com/questions/32355314/how-to-access-configuration-file-from-subfolder-in-go", "title": "How to access configuration file from subfolder in Go", "body": "<p>I got a structure of my project that looks pretty like this:</p>\n\n<pre><code>project/\n    api/\n        api.go\n    config/\n        config.go\n        config.toml\n    tests/\n        api_test.go\n    main.go\n</code></pre>\n\n<p>So, whenever I initialize config package I'm trying to read config file using relative path: <code>config/config.toml</code>.\nThis works fine as soon as I run my program: <code>go run main.go</code></p>\n\n<p>The problem appears when I try to run my tests: <code>go test project/tests</code>. My config package cannot find file <code>config/config.toml</code> because current work directory is not <code>project/</code> as in first case but <code>project/tests/</code>.</p>\n\n<p>Is there any convenient way to access config file from both <code>run</code> and <code>test</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1441217458, "post_id": 32353942, "comment_id": 52593310, "body": "By the way, if you only have a single <code>case</code> within the <code>select</code> (including no <code>default</code> case) then your whole loop is almost exactly the same as the simplified: <code>for zip := range zipGen { uploadToServer(zip) }</code>. (The one difference is that the simplified version handles the channel closing much better; your code would busy loop calling <code>uploadToServer(nil)</code> as quickly as it can if the channel closed)."}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441230671, "post_id": 32353942, "comment_id": 52600061, "body": "@DaveC thanks for spotting this"}], "answers": [{"comments": [{"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 0, "creation_date": 1441200879, "post_id": 32354048, "comment_id": 52582300, "body": "I like simple. Thanks!"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 1, "creation_date": 1441201323, "post_id": 32354048, "comment_id": 52582646, "body": "@orcaman I&#39;m using a more complicated pattern when the limit is very big, and the required concurrency might change, so I don&#39;t want to run a constant number of goroutines if most of them are idle. But in small numbers this is the best option."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 3, "last_activity_date": 1441199232, "creation_date": 1441199232, "answer_id": 32354048, "question_id": 32353942, "link": "https://stackoverflow.com/questions/32353942/golang-limit-concurrency-levels-of-a-blocking-operation/32354048#32354048", "title": "Golang: limit concurrency levels of a blocking operation", "body": "<p>The simplest option - prespawn N goroutines that take input from the channel, and upload it, in a loop. In each goroutine's context the operation will be blocking, but N goroutines do this. Only one goroutine will receive each message, of course.</p>\n\n<pre><code>func listenToZips(concurrent int) {\n\n    for i:=0; i &lt; concurrent; i++ {\n\n      // spawn a listener goroutine\n      go func() {\n\n         for {\n            select {\n            case zip := &lt;-zipGen:\n               uploadToServer(zip) // this is blocking\n            }\n         }\n      }()\n\n   }\n\n}\n</code></pre>\n\n<p>Of course you can then add stop condition, probably using a different channel, but the basic idea is just the same.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 2203147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96ba51dad76abd641a3ff2a6b018616c?s=128&d=identicon&r=PG", "display_name": "korovkin", "link": "https://stackoverflow.com/users/2203147/korovkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1494700539, "creation_date": 1494700539, "answer_id": 43956674, "question_id": 32353942, "link": "https://stackoverflow.com/questions/32353942/golang-limit-concurrency-levels-of-a-blocking-operation/43956674#43956674", "title": "Golang: limit concurrency levels of a blocking operation", "body": "<p>try this: \n<a href=\"https://github.com/korovkin/limiter\" rel=\"nofollow noreferrer\">https://github.com/korovkin/limiter</a></p>\n\n<pre><code> limiter := NewConcurrencyLimiter(10)\n limiter.Execute(func() {\n        uploadToServer()\n })\n limiter.Wait()\n</code></pre>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1072, "favorite_count": 0, "accepted_answer_id": 32354048, "answer_count": 2, "score": 2, "last_activity_date": 1494700539, "creation_date": 1441198925, "question_id": 32353942, "link": "https://stackoverflow.com/questions/32353942/golang-limit-concurrency-levels-of-a-blocking-operation", "title": "Golang: limit concurrency levels of a blocking operation", "body": "<p>I have the following scenario:\nI am receiving a message on a channel telling me to upload a file. The upload is made by the blocking function <code>uploadToServer</code>. The <code>zipGen</code> channel may receive several messages per second, and I want to upload maximum 5 files simultaneously (not more, but possibly less - depending on how many messages are sent on <code>zipGen</code> by a third worker that is out of the scope of this question).</p>\n\n<p>The <code>listenToZips</code> function runs inside a go routine (<code>go listenToZips()</code> on the file's <code>init</code> function):</p>\n\n<pre><code>func listenToZips() {\n    for {\n        select {\n        case zip := &lt;-zipGen:\n          uploadToServer(zip) // this is blocking\n        }\n    }\n}\n</code></pre>\n\n<p>If I launch <code>go uploadToServer(zip)</code> instead of just <code>uploadToServer(zip)</code> - I get too much concurrency (so for example my program will try to upload 10 files at the same time, but I want a maximum of 5). </p>\n\n<p>On the other hand, without <code>go uploadToServer(zip)</code> (just using <code>uploadToServer(zip)</code> like in the above function), I only upload one file at a time (since the <code>uploadToServer(zip)</code> is blocking). </p>\n\n<p>How can I achieve this level of control to allow me a max upload of 5 files simultaneously? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 3, "creation_date": 1441187616, "post_id": 32349807, "comment_id": 52573149, "body": "Do you really need a &quot;cryptographically secure pseudorandom number&quot; ? (from the doc <a href=\"https://godoc.org/crypto/rand\" rel=\"nofollow noreferrer\">godoc.org/crypto/rand</a>) If you do not, you can use <a href=\"https://godoc.org/math/rand\" rel=\"nofollow noreferrer\">godoc.org/math/rand</a>"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 1, "creation_date": 1441187848, "post_id": 32349807, "comment_id": 52573317, "body": "I need it to generate secure tokens. Like the one I showed above. I would like it if it could include all characters from the alphabet including digits."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441188746, "post_id": 32349807, "comment_id": 52573943, "body": "Just saw your edit. An alternate way could be to generate a really big random int (like between 0 and the max int64) and to encode it in hexadecimal or base32. I&#39;ll add it to my answer"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1441189072, "post_id": 32349807, "comment_id": 52574133, "body": "Normally if someone needs a cryptographically strong random number she won&#39;t need a range of [0,27] (which is 5 bit) but something <b>much</b> larger, more like 2048 bits which just does not fit into an int64. So a big.int is returned. Maybe you should generate a long bit sequence and simply base32 encode it?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1441191181, "post_id": 32349807, "comment_id": 52575385, "body": "&quot;Cryptographically secure PRNG&quot; and &quot;5 bits&quot; does not go together. At a minimum a token (say, for CSRF or session IDs) should be 256 bits. I would rethink your approach."}], "answers": [{"comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441189741, "post_id": 32350135, "comment_id": 52574532, "body": "Also see <a href=\"https://www.socketloop.com/tutorials/golang-how-to-generate-random-string\" rel=\"nofollow noreferrer\">socketloop.com/tutorials/golang-how-to-generate-random-strin&zwnj;&#8203;g</a> (using base64, so more than just the alphabet and numbers <a href=\"https://en.wikipedia.org/wiki/Base64\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Base64</a>)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1441191311, "post_id": 32350135, "comment_id": 52575474, "body": "I&#39;d suggest at least 24 (if not 32) bytes for any kind of tokens."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 32, "last_activity_date": 1441192668, "last_edit_date": 1441192668, "creation_date": 1441187990, "answer_id": 32350135, "question_id": 32349807, "link": "https://stackoverflow.com/questions/32349807/how-can-i-generate-a-random-int-using-the-crypto-rand-package/32350135#32350135", "title": "How can I generate a random int using the &quot;crypto/rand&quot; package?", "body": "<p>Here is some working code :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"crypto/rand\"\n    \"math/big\"\n)\n\nfunc main() {\n    nBig, err := rand.Int(rand.Reader, big.NewInt(27))\n    if err != nil {\n        panic(err)\n    }\n    n := nBig.Int64()\n    fmt.Printf(\"Here is a random %T in [0,27) : %d\\n\", n, n)\n}\n</code></pre>\n\n<hr>\n\n<p>But to generate a random token, I'd do something like this :</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rand\"\n    \"encoding/base32\"\n    \"fmt\"\n)\n\nfunc main() {\n    token := getToken(10)\n    fmt.Println(\"Here is a random token : \", token)\n}\n\nfunc getToken(length int) string {\n    randomBytes := make([]byte, 32)\n    _, err := rand.Read(randomBytes)\n    if err != nil {\n        panic(err)\n    }\n    return base32.StdEncoding.EncodeToString(randomBytes)[:length]\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 2, "creation_date": 1441190328, "post_id": 32350455, "comment_id": 52574857, "body": "About the playground, there is this issue which was marked as fixed but actually isn&#39;t : <a href=\"https://github.com/golang/go/issues/5096\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/5096</a> . I left a comment there"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1441188961, "creation_date": 1441188961, "answer_id": 32350455, "question_id": 32349807, "link": "https://stackoverflow.com/questions/32349807/how-can-i-generate-a-random-int-using-the-crypto-rand-package/32350455#32350455", "title": "How can I generate a random int using the &quot;crypto/rand&quot; package?", "body": "<p>If you only need a small number (i.e. [0, 255]), you could just read a byte out of the package's <code>Reader</code>:</p>\n\n<pre><code>b := []byte{0}\nif _, err := rand.Reader.Read(b); err != nil {\n    panic(err)\n}\nn := b[0]\nfmt.Println(n)\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/4VO52LiEVh\" rel=\"nofollow\">http://play.golang.org/p/4VO52LiEVh</a> (the example won't work there, I don't know if it's working as intended or it's a playground bug).</p>\n"}, {"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1441238244, "post_id": 32351471, "comment_id": 52602318, "body": "Hi elithrar, I edited my posts. I wanted to use it to create tokens for different things such as password resets and for keys to be dealt out to people for registration for a closed website and so on."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 2, "creation_date": 1441246578, "post_id": 32351471, "comment_id": 52604120, "body": "@Aiden In that case you don&#39;t need random integers. A sufficiently random string (base64, hex, whatever) would be more than fine. My snippet above uses <code>base64.URLEncoding</code> to generate strings you can use in a URL - e.g. <code>yourdomain.com&#47;resetpassword?token=YW55m5hbCIGNhcm5hbCBwbGVh&zwnj;&#8203;c3U=</code> would cover that use-case. As a tip: make sure you strictly enforce a single-use and expiry date on the tokens in your backend (SQL, Redis, etc.) as  there are lots of sharp edges around re-using password reset tokens that don&#39;t expire &quot;correctly&quot;."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 27, "last_activity_date": 1441203089, "last_edit_date": 1441203089, "creation_date": 1441191986, "answer_id": 32351471, "question_id": 32349807, "link": "https://stackoverflow.com/questions/32349807/how-can-i-generate-a-random-int-using-the-crypto-rand-package/32351471#32351471", "title": "How can I generate a random int using the &quot;crypto/rand&quot; package?", "body": "<p>If you're generating secure tokens for session IDs, OAuth Bearer tokens, CSRF or similar: you want to generate a token of (ideally) 256 bits (32 bytes) or no less than 192 bits (24 bytes). </p>\n\n<p>A token with values between (0-27) can be brute-forced in less than a second and could not be considered secure. </p>\n\n<p>e.g. </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rand\"\n    \"encoding/base64\"\n)\n\n// GenerateRandomBytes returns securely generated random bytes.\n// It will return an error if the system's secure random\n// number generator fails to function correctly, in which\n// case the caller should not continue.\nfunc GenerateRandomBytes(n int) ([]byte, error) {\n    b := make([]byte, n)\n    _, err := rand.Read(b)\n    // Note that err == nil only if we read len(b) bytes.\n    if err != nil {\n        return nil, err\n    }\n\n    return b, nil\n}\n\n// GenerateRandomString returns a URL-safe, base64 encoded\n// securely generated random string.\nfunc GenerateRandomString(s int) (string, error) {\n    b, err := GenerateRandomBytes(s)\n    return base64.URLEncoding.EncodeToString(b), err\n}\n\nfunc main() {\n    // Example: this will give us a 44 byte, base64 encoded output\n    token, err := GenerateRandomString(32)\n    if err != nil {\n        // Serve an appropriately vague error to the\n        // user, but log the details internally.\n    }\n}\n</code></pre>\n\n<p>The base64 output is safe for headers, HTTP forms, JSON bodies, etc. </p>\n\n<p>If you need an integer it may help to explain your use-case, as it would be odd for a system to require tokens as ints. </p>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27364, "favorite_count": 9, "accepted_answer_id": 32351471, "answer_count": 3, "score": 26, "last_activity_date": 1441238176, "creation_date": 1441187051, "last_edit_date": 1441238176, "question_id": 32349807, "link": "https://stackoverflow.com/questions/32349807/how-can-i-generate-a-random-int-using-the-crypto-rand-package", "title": "How can I generate a random int using the &quot;crypto/rand&quot; package?", "body": "<p>Say I would like to generate a secure random int between 0 and 27 using:</p>\n\n<pre><code>func Int(rand io.Reader, max *big.Int) (n *big.Int, err error)\n</code></pre>\n\n<p>in the <code>\"crypto/rand\"</code> package.</p>\n\n<p>How would I do that?</p>\n\n<p>I do not really understand how this works, why does it not return one of the built in Go ints instead of pointer to some big.Int type?</p>\n\n<p>EDIT:</p>\n\n<p>Would this be considered secure enough for tokens?</p>\n\n<pre><code>func getToken(length int) string {\n    token := \"\"\n    codeAlphabet := \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    codeAlphabet += \"abcdefghijklmnopqrstuvwxyz\"\n    codeAlphabet += \"0123456789\"\n\n    for i := 0; i &lt; length; i++ {\n        token += string(codeAlphabet[cryptoRandSecure(int64(len(codeAlphabet)))])\n    }\n    return token\n}\n\nfunc cryptoRandSecure(max int64) int64 {\n    nBig, err := rand.Int(rand.Reader, big.NewInt(max))\n    if err != nil {\n        log.Println(err)\n    }\n    return nBig.Int64()\n}\n\nfunc main() {\n    fmt.Println(getToken(32))\n}\n</code></pre>\n\n<p>This would output something like this:</p>\n\n<pre><code>qZDbuPwNQGrgVmZCU9A7FUWbp8eIfn0Z\n\nEwZVoQ5D5SEfdhiRsDfH6dU6tAovILCZ\n\ncOqzODVP0GwbiNBwtmqLA78rFgV9d3VT\n</code></pre>\n"}, {"tags": ["eclipse", "go", "cross-reference", "goclipse"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1441185508, "post_id": 32347729, "comment_id": 52571739, "body": "Probably (I do not use Goclipse) you&#39;ll have to install the Oracle tool: <a href=\"https://godoc.org/golang.org/x/tools/cmd/oracle\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/cmd/oracle</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1480077197, "last_edit_date": 1480077197, "creation_date": 1441187497, "answer_id": 32349947, "question_id": 32347729, "link": "https://stackoverflow.com/questions/32347729/how-to-cross-reference-in-goclipse/32349947#32349947", "title": "How to cross-reference in GoClipse?", "body": "<p>As Voker suggested, GoClipse is just an Eclipse plugin. For it to compile, build, run your Go packages and applications, it requires the Go tools.</p>\n\n<p>You can set the standard Go tool on the settings page:</p>\n\n<pre><code>Window -&gt; Preferences -&gt; Go\n</code></pre>\n\n<p>You can set some non-standard, differnet Go tools on the page:</p>\n\n<pre><code>Window -&gt; Preferences -&gt; Go -&gt; Tools\n</code></pre>\n\n<p>This is where you can tell GoClipse where your oracle and gocode programs are located.</p>\n\n<p>You have to download oracle yourself, but the settings page above provides you a button:</p>\n\n<p><kbd>Download Go oracle (run: `go get -u golang.org/x/tools/cmd/oracle`)</kbd></p>\n\n<p>So you have to <code>go get</code> it either manually or by the above-mentioned button. Install it using <code>go install</code>, so you will have the executable binary <code>oracle</code>. You have to set the full path of <code>oracle</code> on the <code>Go -&gt; Tools</code> settings page, and it will work.</p>\n\n<p>While we're at it: I also recommend you to install gocode (<a href=\"https://github.com/nsf/gocode\" rel=\"nofollow noreferrer\">https://github.com/nsf/gocode</a>) which will provide you the auto-complete feature (<kbd>CTRL+SPACE</kbd> or <kbd>CMD+SPACE</kbd> for a list of exported identifiers in package, list of methods etc.). Just also use the button on the same settings page:</p>\n\n<p><kbd>Download gocode (run: `go get -u github.com/nsf/gocode`)</kbd></p>\n\n<p>Install it and set the full path of the resulted executable binary <code>gocode</code>.</p>\n"}], "owner": {"reputation": 7073, "user_id": 978360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/J7u43.jpg?s=128&g=1", "display_name": "TieDad", "link": "https://stackoverflow.com/users/978360/tiedad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2056, "favorite_count": 1, "accepted_answer_id": 32349947, "answer_count": 1, "score": 3, "last_activity_date": 1480077197, "creation_date": 1441181032, "last_edit_date": 1448284903, "question_id": 32347729, "link": "https://stackoverflow.com/questions/32347729/how-to-cross-reference-in-goclipse", "title": "How to cross-reference in GoClipse?", "body": "<p>I have installed Eclipse (Mars) with Goclipse plugin on my Macbook yesterday. They initially work perfectly. But today I found I cannot do cross reference (that means cmd+click on a keyword cannot jump the definition). And the console shows:</p>\n\n<blockquote>\n<pre><code>Running: oracle -pos=/Users/myname/coreos/naas/server/src/mycompany.com/hh/naas-server/main.go:#389,#389\n-format=json describe mycompany.com/hh/naas-server\nFAILED: Could not start process:    \nReason: Cannot run program \"oracle\": error=2, No such file or directory\n</code></pre>\n</blockquote>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1441180705, "post_id": 32346117, "comment_id": 52568804, "body": "One idea that pops to my head but seems sub-optimal is to implement an <code>io.Reader</code> which adds the <code>[</code> before a single <code>gcmd</code> structure and <code>]</code> at the end of it and then unmarshal from that reader."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441216945, "post_id": 32346117, "comment_id": 52593038, "body": "In addition to the existing answers\u2026 you make request type A and get response type RA, you make request type B and get response type RB\u2026 perhaps you shouldn&#39;t try to read two different things (RA and RB) with the exact same code. It could be as simple as <code>type ResponseOne struct { Gwrcmdc struct { Gwrcmd GwCmdType } }</code> and <code>type ResponseMany struct { Gwrcmds struct { Gwrcmd []GwCmdType } }</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 4, "last_activity_date": 1441182912, "last_edit_date": 1441182912, "creation_date": 1441182056, "answer_id": 32348042, "question_id": 32346117, "link": "https://stackoverflow.com/questions/32346117/unmarshalling-a-json-that-may-or-may-not-return-an-array/32348042#32348042", "title": "Unmarshalling a JSON that may or may not return an array?", "body": "<p>You can try to make custom json unmarshal method, like </p>\n\n<pre><code>func (a *GwrcmCustom) UnmarshalJSON(b []byte) (err error) {\n    g, ga := Gwrcmd{}, []Gwrcmd{}\n    if err = json.Unmarshal(b, &amp;g); err == nil {\n        *a = make([]Gwrcmd, 1)\n        []Gwrcmd(*a)[0] = Gwrcmd(g)\n        return\n    }\n    if err = json.Unmarshal(b, &amp;ga); err == nil {\n        *a = GwrcmCustom(ga)\n        return\n    }\n    return\n}\n</code></pre>\n\n<p><code>GwrcmCustom</code> is a custom type, slice of <code>Gwrcm</code></p>\n\n<pre><code>type GwrcmCustom []Gwrcmd\n</code></pre>\n\n<p>So we will get slice always</p>\n\n<p>Try this on <kbd><a href=\"https://play.golang.org/p/A20Cnn-sC4\" rel=\"nofollow\">Go playground</a></kbd></p>\n\n<p>I hope this will help</p>\n"}, {"comments": [{"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441186971, "post_id": 32349435, "comment_id": 52572720, "body": "Link to json.RawMessage documentation : <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#RawMessage</a>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441187061, "post_id": 32349435, "comment_id": 52572774, "body": "@HectorJ wanted to add this, but forgot. Thanks!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 8, "last_activity_date": 1537693354, "last_edit_date": 1537693354, "creation_date": 1441186030, "answer_id": 32349435, "question_id": 32346117, "link": "https://stackoverflow.com/questions/32346117/unmarshalling-a-json-that-may-or-may-not-return-an-array/32349435#32349435", "title": "Unmarshalling a JSON that may or may not return an array?", "body": "<p>Usually, whenever you have a JSON value of unknown type, you will use <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a> to get it, peek into it, and unmarshal it correctly into the corresponding type. A simplified example:</p>\n\n<pre><code>// The A here can be either an object, or a JSON array of objects.\ntype Response struct {\n    RawAWrapper struct {\n        RawA json.RawMessage `json:\"a\"`\n    }\n    A  A   `json:\"-\"`\n    As []A `json:\"-\"`\n}\n\ntype A struct {\n    B string\n}\n\nfunc (r *Response) UnmarshalJSON(b []byte) error {\n    if err := json.Unmarshal(b, &amp;r.RawAWrapper); err != nil {\n        return err\n    }\n    if r.RawAWrapper.RawA[0] == '[' {\n        return json.Unmarshal(r.RawAWrapper.RawA, &amp;r.As)\n    }\n    return json.Unmarshal(r.RawAWrapper.RawA, &amp;r.A)\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/2d_OrGltDu\" rel=\"nofollow noreferrer\">http://play.golang.org/p/2d_OrGltDu</a>.</p>\n\n<p>Guessing the content based on the first byte doesn't seem too robust to me though. Usually you'll have some sort of a clue in your JSON (like a <code>length</code> or <code>type</code> field on the same level as the dynamic one) that tells you whether you have an object or an array.</p>\n\n<p>See also:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/23053563/1892060\">How can you decode multiple message types with golang websockets?</a></li>\n<li><a href=\"https://stackoverflow.com/q/11066946/1892060\">Partly JSON unmarshal into a map in Go</a></li>\n</ul>\n"}], "owner": {"reputation": 1387, "user_id": 2301484, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/05301156f430e42f5e4022f46ebc2220?s=128&d=identicon&r=PG", "display_name": "Grayda", "link": "https://stackoverflow.com/users/2301484/grayda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2058, "favorite_count": 1, "accepted_answer_id": 32349435, "answer_count": 2, "score": 6, "last_activity_date": 1537693354, "creation_date": 1441175692, "last_edit_date": 1447134480, "question_id": 32346117, "link": "https://stackoverflow.com/questions/32346117/unmarshalling-a-json-that-may-or-may-not-return-an-array", "title": "Unmarshalling a JSON that may or may not return an array?", "body": "<p>I'm retrieving JSON from a third party website (home electricity usage), and depending on what I've requested from the site, the JSON returned may or may not be an array. For example, if I request a list of my smart meters, I get this (results truncated, due to large size):</p>\n\n<pre><code>{\"gwrcmds\":{\"gwrcmd\":{\"gcmd\":\"SPA_UserGetSmartMeterList\",\"gdata\":{\"gip\":{\"version\":\"1\"...\n</code></pre>\n\n<p>Where <strong>gwrcmd</strong> is a single element.</p>\n\n<p>But if I request electricity usage for the last half hour, I get this:</p>\n\n<pre><code>{\"gwrcmds\":{\"gwrcmd\":[{\"gcmd\":\"DeviceGetChart\",\"gdata\":{\"gip\":{\"version\":\"1\" ...\n</code></pre>\n\n<p>See how <strong>gwrcmd</strong> is now an array?</p>\n\n<p>Within my Go app, I have a struct that looks like this (again, truncated, as it goes on for a while. There's more sub-structs and properties beneath \"Version\":</p>\n\n<pre><code>type Response struct {\n    Gwrcmds struct {\n        Gwrcmd struct {\n            Gcmd  string\n            Gdata struct {\n                Gip struct {\n                    Version string\n</code></pre>\n\n<p>If <code>gwrcmd</code> is an array, <code>Gwrcmd</code> needs to be a <code>[]struct { }</code>, but if it's not, it's just a regular old <code>struct { }</code></p>\n\n<p>The problem is that <code>json.Unmarshal</code> just returns an error if the JSON has an array and the struct does not have a slice (or vice versa).</p>\n\n<p>Would I need to create a second struct that duplicates the first one (except with a <code>[]struct { }</code> instead), or is there a better way to do it? I thought of something with interfaces, but I haven't really touched those yet, so I'm not 100% sure on them.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": false, "score": 3, "last_activity_date": 1441176522, "last_edit_date": 1441176522, "creation_date": 1441175595, "answer_id": 32346093, "question_id": 32345760, "link": "https://stackoverflow.com/questions/32345760/accept-function-in-argument-with-empty-interface-return-type/32346093#32346093", "title": "Accept function in argument with empty interface return type", "body": "<p>As the <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow\">Go specification</a> states:</p>\n\n<blockquote>\n  <p>A function type denotes the set of all functions with the same parameter and <em>result types</em></p>\n</blockquote>\n\n<p>In your case, your <em>result types</em> differ (<code>string</code> vs <code>interface{}</code>)</p>\n\n<p>To be able to receive a function with any kind of result type, <code>test</code> would have to be defined as:</p>\n\n<pre><code>func text(x interface{}) { ... }\n</code></pre>\n\n<p>and then you will have to use <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\">reflect package</a> to call the function stored in <code>x</code>.</p>\n\n<p><strong>Edit</strong></p>\n\n<p>Such a <code>test</code> function would look like this:</p>\n\n<pre><code>func test(x interface{}) {\n    v := reflect.ValueOf(x)\n\n    if v.Kind() != reflect.Func {\n        panic(\"Test requires a function\")\n    }\n\n    t := v.Type()\n\n    if t.NumIn() != 0 &amp;&amp; t.NumOut() != 1 {\n        panic(\"Function type must have no input parameters and a single return value\")\n    }\n\n    values := v.Call(nil)\n\n    val := values[0].Interface()\n    // some more code..\n}\n</code></pre>\n\n<p><strong>Playground:</strong> <a href=\"https://play.golang.org/p/trC2lOSLNE\" rel=\"nofollow\">https://play.golang.org/p/trC2lOSLNE</a></p>\n"}, {"comments": [{"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "edited": false, "score": 0, "creation_date": 1441176671, "post_id": 32346212, "comment_id": 52566452, "body": "I agree with your solution more :) . If it is possible, it is better to avoid reflection."}, {"owner": {"reputation": 3439, "user_id": 1887281, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xV9qF.jpg?s=128&g=1", "display_name": "devinbost", "link": "https://stackoverflow.com/users/1887281/devinbost"}, "edited": false, "score": 2, "creation_date": 1578722594, "post_id": 32346212, "comment_id": 105540073, "body": "This is like the difference between pressing any key and pressing the &quot;any&quot; key."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 18, "last_activity_date": 1441176094, "creation_date": 1441176094, "answer_id": 32346212, "question_id": 32345760, "link": "https://stackoverflow.com/questions/32345760/accept-function-in-argument-with-empty-interface-return-type/32346212#32346212", "title": "Accept function in argument with empty interface return type", "body": "<p>You tripped over a very common misconception for Go newcomers: The empty interface <code>interface{}</code> does <em>not</em> mean \"any type\". Really, it does not. Go is statically typed. The empty interface <code>interface {}</code> is an actual (strongly typed type) like e.g. <code>string</code> or <code>struct{Foo int}</code> or <code>interface{Explode() bool}</code>.</p>\n\n<p>That means if something has the type <code>interface{}</code> it has that type and not \"any type\".</p>\n\n<p>Your function</p>\n\n<pre><code>func test(x func() interface{})\n</code></pre>\n\n<p>takes one parameter. This parameter is a (parameterless function) which returns a specific type, the type <code>interface{}</code>. You can pass any function to <code>test</code> which matches this signature: \"No parameters and return <code>interface{}</code>\". None of your functions <code>a</code> and <code>b</code> match this signature.</p>\n\n<p>As said above: <code>interface {}</code> is not a magical abbreviation for \"whatever\",it is a distinct static type.</p>\n\n<p>You have to change e.g. a to:</p>\n\n<pre><code>func a() interface{} {\n    return \"hello\"\n}\n</code></pre>\n\n<p>Now this might look strange as you return a <code>string</code> which is not of type <code>interface{}</code>.  This works because any type is assignable to variables of type <code>interface{}</code> (as every type has at least no methods :-). </p>\n"}], "owner": {"reputation": 4106, "user_id": 3634032, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PDCW3.jpg?s=128&g=1", "display_name": "Sam Herrmann", "link": "https://stackoverflow.com/users/3634032/sam-herrmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8285, "favorite_count": 0, "accepted_answer_id": 32346212, "answer_count": 2, "score": 10, "last_activity_date": 1569573672, "creation_date": 1441174197, "last_edit_date": 1569573672, "question_id": 32345760, "link": "https://stackoverflow.com/questions/32345760/accept-function-in-argument-with-empty-interface-return-type", "title": "Accept function in argument with empty interface return type", "body": "<p>I would like to understand why the code snippet below does not compile. What is the Go way of accepting a function as a function argument that may have any return type?</p>\n\n<pre><code>package main\n\nfunc main() {\n    test(a) // Error: cannot use a (type func() string) as type func() interface {} in argument to test\n    test(b) // Error: cannot use b (type func() int) as type func() interface {} in argument to test\n}\n\nfunc a() string {\n    return \"hello\"\n}\n\nfunc b() int {\n    return 1\n}\n\nfunc test(x func() interface{}) {\n\n    // some code...\n    v := x()\n    // some more code....\n}\n</code></pre>\n\n<p>Play: <a href=\"https://play.golang.org/p/CqbuEZGy12\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CqbuEZGy12</a></p>\n\n<p><strong>My solution based on Volker's answer:</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    // Wrap function a and b with an anonymous function\n    // that has an empty interface return type. With this\n    // anonymous function, the call signature of test\n    // can be satisfied without needing to modify the return\n    // type of function a and b.\n\n    test(func() interface{} {\n        return a()\n    })\n\n    test(func() interface{} {\n        return b()\n    })\n}\n\nfunc a() string {\n     return \"hello\"\n}\n\nfunc b() int {\n    return 1\n}\n\nfunc test(x func() interface{}) {\n    v := x()\n    fmt.Println(v)  \n}\n</code></pre>\n\n<p>Play: <a href=\"https://play.golang.org/p/waOGBZZwN7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/waOGBZZwN7</a></p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "is_accepted": false, "score": 0, "last_activity_date": 1441172019, "creation_date": 1441172019, "answer_id": 32345296, "question_id": 32345124, "link": "https://stackoverflow.com/questions/32345124/why-does-sql-open-return-nil-as-error-when-it-should-not/32345296#32345296", "title": "Why does sql.Open() return nil as error when it should not?", "body": "<p>It turns out that this does not actually connect to the database right away.</p>\n\n<p>Source: <a href=\"http://go-database-sql.org/accessing.html\" rel=\"nofollow\">http://go-database-sql.org/accessing.html</a></p>\n\n<p>To check the validity of connection, we can do this:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root@tcp(127.0.0.1:3306)/dbname?charset=utf8\")\nerr = db.Ping() // Need to do this to check that the connection is valid\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 6, "last_activity_date": 1441172074, "creation_date": 1441172074, "answer_id": 32345308, "question_id": 32345124, "link": "https://stackoverflow.com/questions/32345124/why-does-sql-open-return-nil-as-error-when-it-should-not/32345308#32345308", "title": "Why does sql.Open() return nil as error when it should not?", "body": "<p>SQL.Open only creates the DB object, but dies not open any connections to the database. If you want to test your connections you have to execute a query to force opening a connection. The common way for this is to call Ping() on your DB object.</p>\n\n<p>See <a href=\"http://golang.org/pkg/database/sql/#Open\" rel=\"noreferrer\">http://golang.org/pkg/database/sql/#Open</a> and <a href=\"http://golang.org/pkg/database/sql/#DB.Ping\" rel=\"noreferrer\">http://golang.org/pkg/database/sql/#DB.Ping</a></p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1480891480, "last_edit_date": 1480891480, "creation_date": 1441173490, "answer_id": 32345607, "question_id": 32345124, "link": "https://stackoverflow.com/questions/32345124/why-does-sql-open-return-nil-as-error-when-it-should-not/32345607#32345607", "title": "Why does sql.Open() return nil as error when it should not?", "body": "<p>Quoting from the doc of <a href=\"https://golang.org/pkg/database/sql/#Open\" rel=\"nofollow noreferrer\"><code>sql.Open()</code></a>:</p>\n\n<blockquote>\n  <p>Open may just validate its arguments without creating a connection to the database. To verify that the data source name is valid, call Ping.</p>\n</blockquote>\n\n<p>As stated, <code>Open()</code> may not open any physical connection to the database server, but it will validate its arguments. That being said if arguments are valid, it may return <code>nil</code> error even if the database server is not reachable, or even if the host denoted by <code>dataSourceName</code> does not exist.</p>\n\n<p>To answer your other question:</p>\n\n<blockquote>\n  <p>What is the point of check for errors after this function if it does not return errors?</p>\n</blockquote>\n\n<p>You have to check returned errors because it <em>can</em> return errors. For example if the specified <code>driverName</code> is invalid, a non-nil error will be returned (see below).</p>\n\n<p>To test if the database server is reachable, use <a href=\"https://golang.org/pkg/database/sql/#DB.Ping\" rel=\"nofollow noreferrer\"><code>DB.Ping()</code></a>. But you can only use this if the returned error is <code>nil</code>, else the returned <code>DB</code> might also be <code>nil</code> (and thus calling the <code>Ping()</code> method on it may result in run-time panic):</p>\n\n<pre><code>if db, err := sql.Open(\"nonexistingdriver\", \"somesource\"); err != nil {\n    fmt.Println(\"Error creating DB:\", err)\n    fmt.Println(\"To verify, db is:\", db)\n} else {\n    err = db.Ping()\n    if err != nil {\n        fmt.Println(\"db.Ping failed:\", err)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/5U4BL5CQq3\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Error creating DB: sql: unknown driver \"nonexistingdriver\" (forgotten import?)\nTo verify, db is: &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2064, "favorite_count": 0, "accepted_answer_id": 32345308, "answer_count": 3, "score": 2, "last_activity_date": 1480891480, "creation_date": 1441171116, "last_edit_date": 1441177960, "question_id": 32345124, "link": "https://stackoverflow.com/questions/32345124/why-does-sql-open-return-nil-as-error-when-it-should-not", "title": "Why does sql.Open() return nil as error when it should not?", "body": "<p>I am trying to connect to a mysql database.</p>\n\n<p>I tried to see if I would get an error if I gave it wrong connection information but it still returns <code>nil</code> as error. Even If I shut down mysql completely it still does not return an error. What is the point of check for errors after this function if it does not return errors?</p>\n\n<p>This is on Windows, I am using XAMPP and I don't have a password for the database. Username is <code>\"root\"</code>.</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"log\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"root@tcp(127.0.0.1:3306)/dbname?charset=utf8\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer db.Close()\n}\n</code></pre>\n"}, {"tags": ["sql-server-2008", "go", "transactions", "gorp"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1441182895, "post_id": 32344117, "comment_id": 52570126, "body": "Did you try looking at the trace using the sql profiler from the SQL management tools suite? I&#39;d check if the expected commands are really sent over the wire."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1441183004, "post_id": 32344117, "comment_id": 52570198, "body": "The next thing to check is to verify the autocommit mode is not somehow gets enabled as otherwise every single command you send is essentially in a separate transaction."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1441183209, "post_id": 32344117, "comment_id": 52570322, "body": "And a crucial bit of information is missing: what are you using as the driver? <code>gorp</code> IUUC is a mapper, not an access layer."}, {"owner": {"reputation": 719, "user_id": 740165, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87c1e04a4db3550c89de947fef393a4?s=128&d=identicon&r=PG", "display_name": "Matthew Clark", "link": "https://stackoverflow.com/users/740165/matthew-clark"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1441213429, "post_id": 32344117, "comment_id": 52590965, "body": "You are, of course, right about the driver. I had meant to include it in the info, but forgot I guess. <code>github.com&#47;denisenkom&#47;go-mssqldb</code> I&#39;ll also add it to the OP."}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1441978407, "post_id": 32344117, "comment_id": 52907266, "body": "Can you try this example on <code>MSSQL 2008</code> <a href=\"https://play.golang.org/p/0L3Vgk8C_F\" rel=\"nofollow noreferrer\">play.golang.org/p/0L3Vgk8C_F</a> ? That works for me, but using <code>MSSQL 2012</code>. If it works, so there is some errors in <code>gorp</code> package. If not, maybe bug in <code>github.com&#47;denisenkom&#47;go-mssqldb</code> with <code>MSSQL 2008</code>"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1442394012, "post_id": 32344117, "comment_id": 53059852, "body": "So can you try example?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1442585767, "post_id": 32344117, "comment_id": 53154957, "body": "I&#39;ve just tested my example on MSSQL 2008 and it works"}, {"owner": {"reputation": 719, "user_id": 740165, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87c1e04a4db3550c89de947fef393a4?s=128&d=identicon&r=PG", "display_name": "Matthew Clark", "link": "https://stackoverflow.com/users/740165/matthew-clark"}, "edited": false, "score": 0, "creation_date": 1442602934, "post_id": 32344117, "comment_id": 53164879, "body": "I just tried that example and it worked, so I&#39;m guessing that means the problem is on gorp&#39;s side. Anyone have any info that may be helpful? I&#39;m about to dig through the gorp transaction code, but yeah... (PS sorry for the delay in responding, we are in a crazy tight crunch time right now)"}], "answers": [{"comments": [{"owner": {"reputation": 719, "user_id": 740165, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87c1e04a4db3550c89de947fef393a4?s=128&d=identicon&r=PG", "display_name": "Matthew Clark", "link": "https://stackoverflow.com/users/740165/matthew-clark"}, "edited": false, "score": 0, "creation_date": 1444749335, "post_id": 33096062, "comment_id": 54027531, "body": "That makes a TON of sense, but I can&#39;t find anything about autocommit in either of the projects involved: <a href=\"https://github.com/go-gorp/gorp/tree/v1\" rel=\"nofollow noreferrer\">github.com/go-gorp/gorp/tree/v1</a> for my wrapper and <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">github.com/denisenkom/go-mssqldb</a> for the driver itself. Is there any other term they may call it by? I also just searched for commit, but none of that led to anything either. Thanks!"}], "tags": [], "owner": {"reputation": 535, "user_id": 5109754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7agq.png?s=128&g=1", "display_name": "Sedy Vlk", "link": "https://stackoverflow.com/users/5109754/sedy-vlk"}, "is_accepted": false, "score": 2, "last_activity_date": 1444719435, "creation_date": 1444719435, "answer_id": 33096062, "question_id": 32344117, "link": "https://stackoverflow.com/questions/32344117/sql-db-transaction-not-rolling-back-properly-with-ms-sql/33096062#33096062", "title": "sql/db transaction not rolling back properly with ms sql", "body": "<p>Check you don't have autocomit enabled. Many command line tools, uis and even drivers enable it by default</p>\n"}, {"comments": [{"owner": {"reputation": 719, "user_id": 740165, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87c1e04a4db3550c89de947fef393a4?s=128&d=identicon&r=PG", "display_name": "Matthew Clark", "link": "https://stackoverflow.com/users/740165/matthew-clark"}, "edited": false, "score": 0, "creation_date": 1444773432, "post_id": 33107608, "comment_id": 54041006, "body": "&quot;A connection to an instance of the Database Engine operates in autocommit mode until a BEGIN TRANSACTION statement starts an explicit transaction, or implicit transaction is set on. When the explicit transaction is committed or rolled back, or when implicit transaction mode is turned off, the connection returns to autocommit mode.&quot; Good thought, but that makes me think, that&#39;s not it. :-("}], "tags": [], "owner": {"reputation": 535, "user_id": 5109754, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b7agq.png?s=128&g=1", "display_name": "Sedy Vlk", "link": "https://stackoverflow.com/users/5109754/sedy-vlk"}, "is_accepted": false, "score": 0, "last_activity_date": 1444753609, "last_edit_date": 1444753609, "creation_date": 1444752713, "answer_id": 33107608, "question_id": 32344117, "link": "https://stackoverflow.com/questions/32344117/sql-db-transaction-not-rolling-back-properly-with-ms-sql/33107608#33107608", "title": "sql/db transaction not rolling back properly with ms sql", "body": "<p>According to this( I read just a few lines) <a href=\"https://technet.microsoft.com/en-us/library/ms187878(v=sql.105).aspx\" rel=\"nofollow\">https://technet.microsoft.com/en-us/library/ms187878(v=sql.105).aspx</a></p>\n\n<p>autocommit seems to be ON by defauly, that leads me to conclusion that if the author of go-mssqldb didn't implement on/off for this feature its ON.</p>\n\n<p>You can toggle it yourself just search for SET IMPLICIT_TRANSACTIONS </p>\n"}], "owner": {"reputation": 719, "user_id": 740165, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a87c1e04a4db3550c89de947fef393a4?s=128&d=identicon&r=PG", "display_name": "Matthew Clark", "link": "https://stackoverflow.com/users/740165/matthew-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "answer_count": 2, "score": 11, "last_activity_date": 1444753609, "creation_date": 1441163913, "last_edit_date": 1442603739, "question_id": 32344117, "link": "https://stackoverflow.com/questions/32344117/sql-db-transaction-not-rolling-back-properly-with-ms-sql", "title": "sql/db transaction not rolling back properly with ms sql", "body": "<p>So I can't get too specific, but I think what I can tell you will be enough to figure this out. First I'm using gorp to set things up and get the transaction. I am using the <code>github.com/denisenkom/go-mssqldb</code> driver. </p>\n\n<p>Then I run through a series of operations and if of them fails I <code>rollback</code> and if all have success I <code>commit</code>. The problem is that it's only rolling back the statement that failed and not the rest of the operations. Am I wrong that this is not how that is suppose to work?</p>\n\n<p>Here is some rough psudocode to give you a better idea of what I'm talking about:</p>\n\n<pre><code>trans,err := dbmap.Begin()\n//assume all errors are received and checked before continuing\nid := trans.Exec(\"insert thing\") //successful, persists after rollback \nthing := trans.Select(\"Select thing\") //successful\ntrans.Exec(\"update other_thing with thing\") //successful, persists after rollback\nnewthing := trans.Exec(\"insert new_thing with thing\") //fails, rollsback\nif err != nil{\n   trans.Rollback() //No errors\n   return\n}\ntrans.Commit()\n</code></pre>\n\n<p>Am I wrong that that should <code>rollback</code> everything since <code>dbmap.Begin()</code>? Is this a bug in the driver implementation? Any and all help is GREATLY welcome. Thanks!</p>\n\n<p><strong>Update</strong></p>\n\n<p>Tested <a href=\"https://play.golang.org/p/0L3Vgk8C_F\" rel=\"nofollow\">https://play.golang.org/p/0L3Vgk8C_F</a> and it worked so I'm guessing that means it something to do with gorp. I'm using the v1 branch since this will be production soon and so stability is key. I'll be picking through it, but it looks like it's just wrapping it lightly.</p>\n"}, {"tags": ["go", "goclipse"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1441164887, "post_id": 32343875, "comment_id": 52562525, "body": "How did you install Go (source? installer? Homebrew) and did you install the cross-compilers as well? As per @OneofOne&#39;s answer, if you have cgo dependencies then cross-compiling becomes complicated (oft. easier to just spin up a small Vagrant box)."}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1441169382, "post_id": 32343875, "comment_id": 52563631, "body": "cross compiling  try <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow noreferrer\">gox</a> ?"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441187277, "post_id": 32343875, "comment_id": 52572908, "body": "Here is the line printing this error : <a href=\"https://github.com/golang/go/blob/21ec72c2ca5168f3f10b4594a553b3a038c8df29/src/cmd/go/tool.go#L61\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "edited": false, "score": 0, "creation_date": 1441187320, "post_id": 32343875, "comment_id": 52572940, "body": "Can you give the full output of <code>go env</code> ?"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 0, "last_activity_date": 1441164803, "creation_date": 1441164803, "answer_id": 32344234, "question_id": 32343875, "link": "https://stackoverflow.com/questions/32343875/go-tool-no-such-tool-compile/32344234#32344234", "title": "go tool: no such tool &quot;compile&quot;", "body": "<p>You might be able to get away with that if you install Go 1.5, however if you use anything that depends on <code>cgo</code>, you will have to install a cross-compiler linker or install Linux on a virtual machine to be able to cross compile for Linux.</p>\n"}, {"tags": [], "owner": {"reputation": 1729, "user_id": 4911382, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/4755742a47e2493a9609a048364df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Scharbau", "link": "https://stackoverflow.com/users/4911382/benjamin-scharbau"}, "is_accepted": true, "score": 1, "last_activity_date": 1441242103, "creation_date": 1441242103, "answer_id": 32365433, "question_id": 32343875, "link": "https://stackoverflow.com/questions/32343875/go-tool-no-such-tool-compile/32365433#32365433", "title": "go tool: no such tool &quot;compile&quot;", "body": "<p>I installed it via the binary packages provided by google. In the end I actually got it back to work by just reinstalling it. Sometimes I'm just blind to the easy solution.</p>\n\n<p>After that, I succeeded in cross compiling for linux machine after compiling the necessary cross-compilers by running <code>env GOOS=linux GOARCH=arm GOROOT_BOOTSTRAP=/usr/local/go ./make.bash --no-clean</code> from the Go sources directory.</p>\n\n<p>Thanks for all you efforts, sorry to have kept you busy on such a simple matter.</p>\n"}, {"tags": [], "owner": {"reputation": 930, "user_id": 3120528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IXNii.jpg?s=128&g=1", "display_name": "Kehe CAI", "link": "https://stackoverflow.com/users/3120528/kehe-cai"}, "is_accepted": false, "score": 0, "last_activity_date": 1512211497, "creation_date": 1512211497, "answer_id": 47607040, "question_id": 32343875, "link": "https://stackoverflow.com/questions/32343875/go-tool-no-such-tool-compile/47607040#47607040", "title": "go tool: no such tool &quot;compile&quot;", "body": "<p>In my case is due to the fact that GOPATH and GOROOT are not set correctly, maybe you can check <code>go env</code>. <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/iTCTqG_JcW0\" rel=\"nofollow noreferrer\">Here is a discussion</a> may be useful.</p>\n"}, {"comments": [{"owner": {"reputation": 715, "user_id": 452647, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f93c853f56d4c2ac29a98be6a4dbcf58?s=128&d=identicon&r=PG", "display_name": "meadlai", "link": "https://stackoverflow.com/users/452647/meadlai"}, "edited": false, "score": 0, "creation_date": 1603954566, "post_id": 47736434, "comment_id": 114200404, "body": "I got same error, as my x64 PC runs the &#39;go build&#39; with the x32/386 go package"}], "tags": [], "owner": {"reputation": 868, "user_id": 1318010, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/38b084703fd4c779f88af01e6ccd0fb7?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/1318010/andy"}, "is_accepted": false, "score": 1, "last_activity_date": 1512886789, "creation_date": 1512886789, "answer_id": 47736434, "question_id": 32343875, "link": "https://stackoverflow.com/questions/32343875/go-tool-no-such-tool-compile/47736434#47736434", "title": "go tool: no such tool &quot;compile&quot;", "body": "<p>You have the wrong x64 or x386 package installed most likely. I had 32 installed running 64 bit. Reinstall fixed. Good luck.</p>\n"}], "owner": {"reputation": 1729, "user_id": 4911382, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/4755742a47e2493a9609a048364df3f0?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Scharbau", "link": "https://stackoverflow.com/users/4911382/benjamin-scharbau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7882, "favorite_count": 1, "accepted_answer_id": 32365433, "answer_count": 4, "score": 3, "last_activity_date": 1512886789, "creation_date": 1441162043, "question_id": 32343875, "link": "https://stackoverflow.com/questions/32343875/go-tool-no-such-tool-compile", "title": "go tool: no such tool &quot;compile&quot;", "body": "<p>I recently started trying go to program some web based applications. At first, everything went fine, until I wanted to cross compile a binary for a different platform. I'm running MacOS and I wanted to compile a binary for linux, so I changed <code>GOOS</code> to <code>linux</code> and <code>GOARCH</code> to <code>amd64</code>. Since then, I always get the error message </p>\n\n<pre><code>go tool: no such tool \"compile\"\n</code></pre>\n\n<p>I'm using GoClipse, but running the compile manually by</p>\n\n<pre><code>go install hello.go\n</code></pre>\n\n<p>I get the same error. When changing back to compiling for darwin architecture, I get the same error now, so basically I'm totally unable to compile any code written in Go at the moment.</p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1441145940, "last_edit_date": 1441145940, "creation_date": 1441145363, "answer_id": 32341647, "question_id": 32341589, "link": "https://stackoverflow.com/questions/32341589/how-to-escape-space-characters-in-golang-get-request/32341647#32341647", "title": "How to escape space characters in golang GET request", "body": "<p>Use this:</p>\n\n<pre><code>resp, err := http.Get(\"http://api.example.com/tutor?message=\" + url.QueryEscape(\"how can I do this\"))\n</code></pre>\n\n<p>Where <code>url</code> the <a href=\"http://godoc.org/net/url\" rel=\"noreferrer\">net/url package</a>.</p>\n\n<p>If you have multiple query parameters, you can use</p>\n\n<pre><code>p := url.Values{\"message\": {\"hown ca I do this\"}, \"other\": \"whatever\"}\nresp, err := http.Get(`http://api.example.com/tutor?` + p.Encode())\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4305917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001241510496/picture?type=large", "display_name": "Shailesh", "link": "https://stackoverflow.com/users/4305917/shailesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4744, "favorite_count": 0, "accepted_answer_id": 32341647, "answer_count": 1, "score": 4, "last_activity_date": 1441145940, "creation_date": 1441144955, "question_id": 32341589, "link": "https://stackoverflow.com/questions/32341589/how-to-escape-space-characters-in-golang-get-request", "title": "How to escape space characters in golang GET request", "body": "<p>I want to send a text string in get request using net/http package in golang. But I'm unable to find out how to do that. Like I want to hit the following url:</p>\n\n<pre><code>\"http://api.example.com/tutor?message=how can I do this\"\n</code></pre>\n\n<p>Please let me know how can I do this.</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "edited": false, "score": 0, "creation_date": 1441120050, "post_id": 32334950, "comment_id": 52544302, "body": "Please give a valid reason before downvoting this post."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441120223, "post_id": 32334950, "comment_id": 52544423, "body": "That error is when you try to compile that string in the source (like it says, <code>\\&#47;</code> isn&#39;t a valid escape sequence). You can&#39;t be operating on strings like that in your program, so what is it you&#39;re trying to do? (Please show a executable example)"}, {"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441120327, "post_id": 32334950, "comment_id": 52544492, "body": "That string is coming from remote json call. I cannot control it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1441120472, "post_id": 32334950, "comment_id": 52544587, "body": "It doesn&#39;t matter where it comes from, that error isn&#39;t from string handling; it&#39;s a compilation error from incorrectly formatting it in a go source file."}, {"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441120693, "post_id": 32334950, "comment_id": 52544723, "body": "I am not formetting anything. The string is as it is. I am just printing it as it is."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441120993, "post_id": 32334950, "comment_id": 52544907, "body": "Please show an example of what you&#39;re <i>actually</i> doing in your code. That error can&#39;t come from your program execution (it comes from the go lexer), and <code>fmt.Println</code> will take any string, regardless of the bytes it contains."}, {"owner": {"reputation": 691, "user_id": 4777392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5PqIx.png?s=128&g=1", "display_name": "vmovva", "link": "https://stackoverflow.com/users/4777392/vmovva"}, "edited": false, "score": 1, "creation_date": 1441121226, "post_id": 32334950, "comment_id": 52545054, "body": "Is it what you are looking for ? <a href=\"http://play.golang.org/p/9bL57jJLeq\" rel=\"nofollow noreferrer\">play.golang.org/p/9bL57jJLeq</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441121401, "post_id": 32334950, "comment_id": 52545169, "body": "yes, that&#39;s an incorrectly formatted string in the source, see <a href=\"http://play.golang.org/p/R3KZOEu_xC\" rel=\"nofollow noreferrer\">play.golang.org/p/R3KZOEu_xC</a>. Are you just looking to replace remove the extra <code>\\&#47;</code> characters?"}, {"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "reply_to_user": {"reputation": 691, "user_id": 4777392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5PqIx.png?s=128&g=1", "display_name": "vmovva", "link": "https://stackoverflow.com/users/4777392/vmovva"}, "edited": false, "score": 1, "creation_date": 1441121408, "post_id": 32334950, "comment_id": 52545186, "body": "@vmovva, thats exactly what I am looking for. Thanks a lot for saving my day!"}], "answers": [{"tags": [], "owner": {"reputation": 691, "user_id": 4777392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/5PqIx.png?s=128&g=1", "display_name": "vmovva", "link": "https://stackoverflow.com/users/4777392/vmovva"}, "is_accepted": true, "score": 1, "last_activity_date": 1441121689, "creation_date": 1441121689, "answer_id": 32335615, "question_id": 32334950, "link": "https://stackoverflow.com/questions/32334950/string-error-unknown-escape-sequence/32335615#32335615", "title": "String Error : unknown escape sequence: /", "body": "<p>If you are just trying to get a valid string : </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport(\"strings\")\n\nfunc main() {\n\n    s := `data-url==\\\"\\/entity\\/id\\/2439918080\\\"`\n    s = strings.Replace(s,\"\\\\\",\"\",-1)\n    println(s)\n\n    //Replace \\/ with \\u002F works fine\n    fmt.Println(\"data-url==\\\"\\u002Fentity\\u002Fid\\u002F2439918080\\\"\")\n}\n</code></pre>\n"}], "owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2424, "favorite_count": 0, "closed_date": 1441121737, "accepted_answer_id": 32335615, "answer_count": 1, "score": -3, "last_activity_date": 1441121689, "creation_date": 1441119691, "last_edit_date": 1441121028, "question_id": 32334950, "link": "https://stackoverflow.com/questions/32334950/string-error-unknown-escape-sequence", "closed_reason": "Duplicate", "title": "String Error : unknown escape sequence: /", "body": "<p>I have an incoming string that looks like this </p>\n\n<pre><code>data-url==\\\"\\/entity\\/id\\/2439918080\\\"\n</code></pre>\n\n<p>If I <code>Println</code> on this string, it throws an error  <code>unknown escape sequence: /</code></p>\n\n<p>See <a href=\"http://play.golang.org/p/IbURcPc_gZ\" rel=\"nofollow\">http://play.golang.org/p/IbURcPc_gZ</a> (comment the first statement and it works)</p>\n\n<p>However if I replace <code>\\/</code> with <code>\\u002F</code> it prints perfectly. The actual incoming data is full of such encoded urls. Is there anyway I can print it without having to change it to <code>\\u002F</code> ?</p>\n\n<p>Here is the actual string that comes from json</p>\n\n<pre><code>  &amp;lt;div class=&amp;quot;card2 media-container portrait&amp;quot; data-card2-name=&amp;quot;summary_large_image&amp;quot;&amp;gt;&amp;#10;    &amp;#10;    &amp;lt;div class=&amp;quot;js-macaw-cards-iframe-container&amp;quot;&amp;#10;  data-src=&amp;quot;\\/i\\/entity\\/tfw\\/v1\\/3298718080?cardname=summary_large_image&amp;amp;amp;earned=true&amp;quot;&amp;#10;  data-autoplay-src=&amp;quot;\\/i\\/cards\\/tfw\\/v1\\/632987845439918080?cardname=summary_large_image&amp;amp;amp;earned=true&amp;quot;&amp;#10;  data-card-name=&amp;quot;summary_large_image&amp;quot;&amp;#10;  data-card-url=&amp;quot;http:\\/\\/t.co\\/QqWvUQMs5B&amp;quot;&amp;#10;  data-publisher-id=&amp;quot;6721522&amp;quot;&amp;#10;  data-creator-id=&amp;quot;&amp;quot;&amp;#10;  data-amplify-content-id=&amp;quot;&amp;quot;&amp;#10;  data-amplify-playlist-url=&amp;quot;&amp;quot;&amp;#10;  data-full-card-iframe-url=&amp;quot;\\/i\\/cards\\/tfw\\/v1\\/632987845439918080?cardname=summary_large_image&amp;amp;amp;earned=true&amp;quot;&amp;#10;  data-has-autoplayable-media=&amp;quot;false&amp;quot;&amp;gt;&amp;#10;&amp;lt;\\/div&amp;gt;&amp;#10;&amp;#10;&amp;lt;\\/div&amp;gt;&amp;#10;&amp;#10;&amp;#10;&amp;#10;        &amp;lt;div class=&amp;quot;entities-media-container js-media-container&amp;quot; style=&amp;quot;min-height:0px&amp;quot;&amp;gt;&amp;#10;        &amp;lt;\\/div&amp;gt;&amp;#10;&amp;#10;  &amp;lt;div class=&amp;quot;machine-translated-container&amp;quot;&amp;gt;&amp;lt;\\/div&amp;gt;&amp;#10;    &amp;lt;div class=&amp;quot;stats-container stats-container &amp;quot;&amp;gt;&amp;#10;    &amp;lt;\\/div&amp;gt;&amp;#10;&amp;#10;  &amp;lt;div class=&amp;quot;client-and-actions&amp;quot;&amp;gt;&amp;#10;  &amp;lt;span class=&amp;quot;metadata&amp;quot;&amp;gt;&amp;#10;    &amp;lt;span&amp;gt;2:50 PM - 16 Aug 2015&amp;lt;\\/span&amp;gt;&amp;#10;&amp;#10;       &amp;amp;middot; &amp;lt;a class=&amp;quot;permalink-link js-permalink js-nav&amp;quot; href=&amp;quot;\\/intifada\\/status\\/632987845439918080&amp;quot;  tabindex=&amp;quot;-1&amp;quot;&amp;gt;Details&amp;lt;\\/a&amp;gt;&amp;#10;    &amp;#10;&amp;#10;&amp;#10;  &amp;lt;\\/span&amp;gt;&amp;#10;&amp;lt;\\/div&amp;gt;&amp;#10;&amp;#10;&amp;#10;&amp;lt;\\/div&amp;gt;&amp;#10;\\\"\\n\\n\\n\\n\\n\\n\\n\\n data-you-follow=\\\"true\\\"\\n data-follows-you=\\\"false\\\"\\n data-you-block=\\\"false\\\"\\n\\n\\n\\n\\n\\u003e\\n\\n\\n    \\u003cdiv class=\\\"context\\\"\\u003e\\n      \\n      \\n    \\u003c\\/div\\u003e\\n    \\u003cdiv class=\\\"content\\\"\\u003e\\n\\n      \\n      \\u003cdiv class=\\\"stream-item-header\\\"\\u003e\\n \n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 23234, "user_id": 4333555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i9zgM.jpg?s=128&g=1", "display_name": "chris85", "link": "https://stackoverflow.com/users/4333555/chris85"}, "edited": false, "score": 0, "creation_date": 1441121038, "post_id": 32334904, "comment_id": 52544931, "body": "Not familiar with <code>go</code> but if you just want everything between <code>{}</code> what about just <code>\\{.+?\\}</code>?"}, {"owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "reply_to_user": {"reputation": 23234, "user_id": 4333555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/i9zgM.jpg?s=128&g=1", "display_name": "chris85", "link": "https://stackoverflow.com/users/4333555/chris85"}, "edited": false, "score": 0, "creation_date": 1441121225, "post_id": 32334904, "comment_id": 52545052, "body": "I need to identify the 3 types of sequences above; edited that part above."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441121966, "post_id": 32334904, "comment_id": 52545538, "body": "It&#39;s often easier to write a small parser for complicated syntax, rather than try to engineer a single regex. Alternatively you could break it down with a series of regexes too."}, {"owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "edited": false, "score": 0, "creation_date": 1441136755, "post_id": 32334904, "comment_id": 52553865, "body": "its not that complicated and requiring its own parser, this is the bulk of it here; i just need a better grasp on regex."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441143468, "post_id": 32334904, "comment_id": 52557127, "body": "&quot;parsing&quot; doesn&#39;t need to be complicated, and breaking the problem down into smaller steps will only make the code easier to understand."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1441224039, "last_edit_date": 1441224039, "creation_date": 1441143796, "answer_id": 32341369, "question_id": 32334904, "link": "https://stackoverflow.com/questions/32334904/fine-tuning-go-regular-expressions/32341369#32341369", "title": "fine tuning go regular expressions", "body": "<p>The problem is easier to tackle if you break the parsing down into steps. You could start with something like:</p>\n\n<p><a href=\"http://play.golang.org/p/ugqMmaeKEs\" rel=\"nofollow\">http://play.golang.org/p/ugqMmaeKEs</a></p>\n\n<pre><code>s := \"{aa,bb,cc,  dd}, {a+,\\tb+,c+}, {1-9}, {1-9,10,19,20-52}, {a-f}, {A-F}, {x-C}, {}\"\n\n// finds the groups of characters captured in {}\nmatchGroups := regexp.MustCompile(`\\{(.+?)\\}`)\n// splits each captured group of characters\nsplitParts := regexp.MustCompile(`\\s*,\\s*`)\n\nparts := [][]string{}\nfor _, match := range matchGroups.FindAllStringSubmatch(s, -1) {\n    parts = append(parts, splitParts.Split(match[1], -1))\n}\n</code></pre>\n\n<p>Now you have all the parts grouped into slices, and can parse the syntax of the individual pieces without having to match all combinations via a regex.</p>\n"}], "owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441224039, "creation_date": 1441119543, "last_edit_date": 1441121293, "question_id": 32334904, "link": "https://stackoverflow.com/questions/32334904/fine-tuning-go-regular-expressions", "title": "fine tuning go regular expressions", "body": "<p>I am working with some regular expressions in go, and its not a direct process, ie takes time to work through and understand from items I've found and reading fast through the manual; any input on refining the following would be appreciated to speed up the process.</p>\n\n<pre><code>// {aa,bb,cc,dd, etc.}, {a+,b+,c+}\nregexp.MustCompile(`\\B\\{([\\w-]+)(.*,)([\\w-]+)(?:,[\\w-]+=[\\w-]+)*\\}`)\n// above captures {a+, b+, c}, but not {a+,b+,c+}\n\n// {1-9}, {1-9,10,19,20-52}\nregexp.MustCompile(`\\B\\{([\\d]?)-([\\d]?)(?:,[\\d]?=[\\d]?)*\\}`)\n// the first is fine, but no idea on how to do the latter, i.e. multiple ranges that might have free standing addons, tricky, maybe beyond a regexp\n\n// {a-f}, {A-F}, {x-C}\nregexp.MustCompile(`\\B\\{([a-zA-Z]?)-([a-zA-Z]?)(?:,[a-zA-Z]?=[a-zA-Z]?)*\\}`)\n</code></pre>\n\n<p>I'm not sure I need the (?: part, it is something found, I just need to recognize separate instances of sequences above (comma separated, number range, character range) bracketed by {} in text I'm parsing. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1441119494, "post_id": 32333981, "comment_id": 52543873, "body": "What is <code>c.foo</code> and where does <code>gn</code> (the function, not method) come from?"}, {"owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1441119598, "post_id": 32333981, "comment_id": 52543964, "body": "@Ainar-G Ah sorry, updated"}], "answers": [{"comments": [{"owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "edited": false, "score": 0, "creation_date": 1441117800, "post_id": 32334181, "comment_id": 52542681, "body": "I know this solution, but I&#39;m confused if this is an improvement to that. I kind of don&#39;t like this way as we need to have an extra function to set/get the values of struct fields. Is there any certain go-pher logic for which this version is better than my dummy code?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "edited": false, "score": 0, "creation_date": 1441118169, "post_id": 32334181, "comment_id": 52542928, "body": "@Fallen without a concrete example of what you have <i>and</i> what you would like, I don&#39;t think you can get a better solution. Your dummy example seems like the perfect use-case for interfaces."}, {"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1441118295, "post_id": 32334181, "comment_id": 52543012, "body": "I think the main functional difference between the two is that if you have a variable that holds a function (op&#39;s code), the variable can be <code>nil</code> and uncallable, but if you&#39;re trying to make a struct that will use the interface then either the struct will have the function or it won&#39;t match the interface (i.e. if it matches the interface, then you know the function has to be defined and callable)"}, {"owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1441118552, "post_id": 32334181, "comment_id": 52543191, "body": "@CoreyOgburn: Right you are. Sorry for not having &quot;not necessarily have to have all the methods&quot; type of example. have just added one. So in this case, an interface will fail to provide what I want to have."}, {"owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "edited": false, "score": 0, "creation_date": 1441165729, "post_id": 32334181, "comment_id": 52562730, "body": "@Ainar-G: Your solution looks good. But I&#39;m still not convinced why it&#39;s better than the solution in the question. Is there any golang philosophy or design related flaws? Thanks :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "edited": false, "score": 1, "creation_date": 1441175709, "post_id": 32334181, "comment_id": 52566017, "body": "@Fallen The big difference is that your <code>fv</code> and <code>gn</code> fields are just <i>fields</i>, not methods. Your <code>c.fv()</code> is not a method call, it&#39;s just a function call, calling the function value of the <code>fv</code> field of the <code>c</code> struct whose type is <code>calc</code>. With your solution, you lose the flexibility of Go&#39;s interface system. E.g. noone will be able to convert your type to an interface like this: <code>type Doer interface{ Do(a, b int) int }</code>. While Ainar-G&#39;s values of <code>Op</code> types can be."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1441120031, "last_edit_date": 1441120031, "creation_date": 1441117511, "answer_id": 32334181, "question_id": 32333981, "link": "https://stackoverflow.com/questions/32333981/prototyping-struct-in-go/32334181#32334181", "title": "Prototyping struct in Go", "body": "<p>Use interfaces.</p>\n\n<pre><code>type Op interface {\n    Name() string\n    Do(a, b int) int\n}\n\ntype Add struct{}\n\nfunc (Add) Name() string    { return \"add\" }\nfunc (Add) Do(a, b int) int { return a + b }\n\ntype Sub struct{}\n\nfunc (Sub) Name() string    { return \"sub\" }\nfunc (Sub) Do(a, b int) int { return a - b }\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/LjJt6D0hNF\" rel=\"nofollow\">http://play.golang.org/p/LjJt6D0hNF</a>.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Since you've edited your question, here is an example of how you could use asserting and interface to a broader interface for your task:</p>\n\n<pre><code>type RevOp interface {\n    Op\n    ReverseDo(a, b int) int\n}\n\n// ...\n\nfunc (Add) ReverseDo(a, b int) int { return a - b }\n\n// ...\n\nfmt.Printf(\"%s(10, 15) returned: %d\\n\", op.Name(), op.Do(10, 15))\nif op, ok := op.(RevOp); ok {\n    fmt.Printf(\"reverse of %s(10, 15) returned: %d\\n\", op.Name(), op.ReverseDo(10, 15))\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/MQ6LlPDcEi\" rel=\"nofollow\">http://play.golang.org/p/MQ6LlPDcEi</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "is_accepted": false, "score": 0, "last_activity_date": 1441463138, "creation_date": 1441463138, "answer_id": 32414155, "question_id": 32333981, "link": "https://stackoverflow.com/questions/32333981/prototyping-struct-in-go/32414155#32414155", "title": "Prototyping struct in Go", "body": "<p>I've discussed with some people in person and apparently my solution was correct. While it can be rewritten using interface, that's not necessarily an improvement.</p>\n"}], "owner": {"reputation": 4236, "user_id": 2231905, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/0d4a1b6ef81bd93c9dd8896880995b77?s=128&d=identicon&r=PG", "display_name": "Fallen", "link": "https://stackoverflow.com/users/2231905/fallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1441463138, "creation_date": 1441116975, "last_edit_date": 1441119581, "question_id": 32333981, "link": "https://stackoverflow.com/questions/32333981/prototyping-struct-in-go", "title": "Prototyping struct in Go", "body": "<p>My use case is, I need to have several structs in Go, who will have methods of same signatures and not necessarily have to have all the methods. The following code describes the requirements and also represents my current solution.</p>\n\n<pre><code>type calc struct {\n    fn func(a, b int) int\n    gn func(a string) bool\n    name string\n}\n\nfunc add(a, b int) int {\n    return a + b\n}\n\nfunc bar(foo string) bool {\n    // do something\n}\n\nfunc sub(a, b int) int {\n    return a - b\n}\n\nfunc main() {\n    for c := range []calc{{\n        fn: add,\n        gn: bar,\n        name: \"addition\",\n    }, {\n        fn: sub,\n        name: \"subtraction\",\n    }} {\n        fmt.Printf(\"%s(10, 15) returned: %d\\n\", c.name, c.fn(10, 15))\n        if c.gn != nil {\n            c.gn(c.name)\n        }\n    }\n}\n</code></pre>\n\n<p>My question is how to improve this code? What's the best way to achieve this in Go? Can I achieve a better solution using interface?</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1441115349, "post_id": 32333279, "comment_id": 52540942, "body": "are you using <code>text&#47;template</code> or <code>html&#47;template</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1441115633, "post_id": 32333415, "comment_id": 52541182, "body": "If you want an example of exposing an XML escaping function to the template I&#39;ll add it to my answer."}, {"owner": {"reputation": 21, "user_id": 2115775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50a20f36db82ccf1f8f01a4f1780cc1?s=128&d=identicon&r=PG", "display_name": "Alexandre Stein", "link": "https://stackoverflow.com/users/2115775/alexandre-stein"}, "edited": false, "score": 0, "creation_date": 1441115926, "post_id": 32333415, "comment_id": 52541402, "body": "I was thinking that only values past into the template was escape. So my bad.  Thanks"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 21, "user_id": 2115775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50a20f36db82ccf1f8f01a4f1780cc1?s=128&d=identicon&r=PG", "display_name": "Alexandre Stein", "link": "https://stackoverflow.com/users/2115775/alexandre-stein"}, "edited": false, "score": 0, "creation_date": 1441116851, "post_id": 32333415, "comment_id": 52542046, "body": "@AlexandreStein it actually looks like a bug, but using the text/template will still fix it."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 2, "last_activity_date": 1441117072, "last_edit_date": 1441117072, "creation_date": 1441115404, "answer_id": 32333415, "question_id": 32333279, "link": "https://stackoverflow.com/questions/32333279/golang-template-escape-first-char/32333415#32333415", "title": "golang template escape first char", "body": "<p>Your example shows you're using the <code>html/template</code> package, which auto-escapes text for html usage. </p>\n\n<p>If you want a raw template engine, use the <code>text/template</code> package instead - the html one just wraps it with context-aware escaping. </p>\n\n<p>However, you'll need to make sure by yourself that the texts you output with the raw template engine are XML-safe. You can do this by exposing some <code>escape</code> function to your template, and passing all texts via this function instead of writing them directly. </p>\n\n<p><strong>[EDIT]</strong> It looks like a bug in <code>html/template</code>, if you omit the <code>?</code> from the xml declaration it works okay. But still my advice stands - if it's not html you're better off using the <code>text/template</code> package. Actually, even better, describe the site map as a struct and don't use a template at all, just XML serialization. </p>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 1, "last_activity_date": 1444860557, "last_edit_date": 1444860557, "creation_date": 1444853352, "answer_id": 33134669, "question_id": 32333279, "link": "https://stackoverflow.com/questions/32333279/golang-template-escape-first-char/33134669#33134669", "title": "golang template escape first char", "body": "<p>Also see issue #12496 on github which confirms they are not planning to fix this.</p>\n\n<p><a href=\"https://github.com/golang/go/issues/12496\" rel=\"nofollow\">https://github.com/golang/go/issues/12496</a></p>\n\n<blockquote>\n  <p>Probably because this is the HTML templating package and you're trying\n  to produce XML. I suspect that it doesn't know how to parse the \n  directives with the question mark there.</p>\n  \n  <p>You probably want to use the text/template package instead, if you're\n  not going to be taking advantage of any of the HTML auto-escaping\n  features.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 2115775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f50a20f36db82ccf1f8f01a4f1780cc1?s=128&d=identicon&r=PG", "display_name": "Alexandre Stein", "link": "https://stackoverflow.com/users/2115775/alexandre-stein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444860557, "creation_date": 1441115054, "last_edit_date": 1441116426, "question_id": 32333279, "link": "https://stackoverflow.com/questions/32333279/golang-template-escape-first-char", "title": "golang template escape first char", "body": "<p>I'm trying to build sitemap XML file with the standard template package.<br>\nBut the first charset \"<strong>&lt;</strong>\" become \"<strong>&amp;lt ;</strong>\", and make the XML unreadable for clients.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"html/template\"\n)\n\nconst (\n    tmplStr = `{{define \"indexSitemap\"}}&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;sitemapindex xmlns=\"http://www.sitemaps.org/schemas/sitemap/0.9\"&gt;\n&lt;sitemap&gt;\n    &lt;loc&gt;https://www.test.com/sitemap.xml&lt;/loc&gt;\n&lt;/sitemap&gt;\n&lt;sitemap&gt;\n    &lt;loc&gt;https://www.test.com/events-sitemap.xml&lt;/loc&gt;\n&lt;/sitemap&gt;\n&lt;sitemap&gt;\n    &lt;loc&gt;https://www.test.com/gamesAndTeams-sitemap.xml&lt;/loc&gt;\n&lt;/sitemap&gt;\n&lt;/sitemapindex&gt;{{end}}`\n)\n\nfunc main() {\n    // Parse the template and check for error\n    tmpl, parseErr := template.New(\"test\").Parse(tmplStr)\n    if parseErr != nil {\n        fmt.Println(parseErr)\n        return\n    }\n\n    // Init the writer\n    buf := new(bytes.Buffer)\n\n    // Execute and get the template error if any\n    tmplExErr := tmpl.ExecuteTemplate(buf, \"indexSitemap\", nil)\n    if tmplExErr != nil {\n        fmt.Println(tmplExErr)\n        return\n    }\n\n    // Print the content malformed\n    fmt.Println(buf)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/PUylzjxJfW\" rel=\"nofollow\">playground golang</a></p>\n\n<p>Is that normal?<br>\nHow can I make it works normaly.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1441109465, "post_id": 32330744, "comment_id": 52536586, "body": "I am not sure if I understand your problem. I <i>think</i> all youn eed is to implement ServeHTTP  on your mypackage.Handler and do the routing yourself i.e. look at the path and call the entry of your chained handler functions if /protected is hit."}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1441109566, "post_id": 32330744, "comment_id": 52536655, "body": "@Volker that code above is implemented, and when /protected is hit, the function Protected is not getting called. ServeHTTP is implemented on <code>mypackage.Handler</code>"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441109671, "post_id": 32330744, "comment_id": 52536717, "body": "I&#39;d suggest moving away from <code>http.HandlerFunc</code> (which is a concrete type) and accepting <code>http.Handler</code> - which is where having a ServeHTTP method comes in."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441110261, "post_id": 32330744, "comment_id": 52537147, "body": "To respond to your update: where is Protected getting invoked? If you have a <code>ServeHTTP</code> method, you need to call it from within there, otherwise it won&#39;t be called."}], "answers": [{"comments": [{"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1441111182, "post_id": 32331558, "comment_id": 52537808, "body": "Thank you. would this solution only work with using http.NewServeMux()? For example, if you just create a custom Handler with a ServeHTTP method and then inside serve http switched on r.URL.Path? Do I need to use http.NewServeMux if not using the DefaultServeMux?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 0, "creation_date": 1441111371, "post_id": 32331558, "comment_id": 52537952, "body": "You can use the default ServeMux if you want - it works either way. I find it good practice to create your own ServeMux to avoid any implicit behaviour (i.e. if you turn profiling on, the default mux exposes your internal goroutine state)"}, {"owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "edited": false, "score": 1, "creation_date": 1441113138, "post_id": 32331558, "comment_id": 52539336, "body": "I got my code to work by calling the AuthorizationMiddleware directly like this <code>h.(w,r, Protected)</code>, bypassing my <code>AuthorizationHandlerFunc</code> entirely. However your code showed me how to get it to work as well and it&#39;s a better solution so I accepted your answer."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 1, "last_activity_date": 1441112138, "last_edit_date": 1441112138, "creation_date": 1441110196, "answer_id": 32331558, "question_id": 32330744, "link": "https://stackoverflow.com/questions/32330744/how-to-implement-handlerfunc-without-using-defaultservemux/32331558#32331558", "title": "How to implement HandlerFunc without using DefaultServeMux", "body": "<p>Re-implement your authorization middleware as a <code>http.Handler</code> :</p>\n\n<pre><code>type auth struct {\n   DB *sql.DB\n   UnauthorizedHandler http.Handler\n}\n\nfunc NewAuth(db *sql.DB, unauthorized http.Handler) *auth {\n    return auth{db, unauthorized}\n}\n\nfunc (a *auth) Protected(h http.Handler) http.Handler {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        // Check whether the request is valid\n        // If it's invalid, call your error func and make sure to *return* early!\n        if !valid {\n            a.UnauthorizedHandler.ServeHTTP(w, r)\n            return\n        }\n        // Call the next handler on success\n        h.ServeHTTP(w, r)\n        return\n    }\n\n    return http.HandlerFunc(fn)\n}\n\nfunc someHandler(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello!\\n\")\n}\n\nfunc main() {\n    auth := NewAuth(db, errorHandler)\n    r := http.NewServeMux()\n    // We have a http.Handler implementation that wraps a http.HandlerFunc\n    // ... so we call r.Handle on our ServeMux and type-cast the wrapped func\n    r.Handle(\"/protected\", auth.Protected(http.HandlerFunc(someHandler)))\n    // Just a simple http.HandlerFunc here\n    r.HandleFunc(\"/public\", someOtherHandler)\n\n    log.Fatal(http.ListenAndServe(\":8000\", r))\n}\n</code></pre>\n\n<p>Take a look at the <a href=\"https://github.com/goji/httpauth/blob/master/basic_auth.go\" rel=\"nofollow\">httpauth lib I wrote</a> for a different example with a <code>ServeHTTP</code> method. Both the above and explicitly creating a <code>ServeHTTP</code> method on your type are valid approaches.</p>\n"}], "owner": {"reputation": 10253, "user_id": 1647484, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/W7T7D.png?s=128&g=1", "display_name": "BrainLikeADullPencil", "link": "https://stackoverflow.com/users/1647484/brainlikeadullpencil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 32331558, "answer_count": 1, "score": 0, "last_activity_date": 1441112138, "creation_date": 1441107885, "last_edit_date": 1441109636, "question_id": 32330744, "link": "https://stackoverflow.com/questions/32330744/how-to-implement-handlerfunc-without-using-defaultservemux", "title": "How to implement HandlerFunc without using DefaultServeMux", "body": "<p>If I were to use the DefaultServeMux (which I designate by passing <code>nil</code> as the second argument to ListenAndServe), then I have access to <code>http.HandleFunc</code>, which you see used below in this example from the Go wiki: </p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Hi there, I love %s!\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>In my current code, I am not able to use the DefaultServeMux i.e. I'm passing a custom handler to ListenAndServe</p>\n\n<pre><code>    h := &amp;mypackage.Handler{\n        Database: mydb\n    }\n    http.ListenAndServe(\":8080\", h)\n</code></pre>\n\n<p>so I don't get the <code>http.HandleFunc</code> built in. However, I have to adapt some authorization code to my code base that requires something like <code>http.HandleFunc</code>. For example, if I had been using DefaultServeMux,  when I hit the <code>\"/protected\"</code> route, I would want to go to the <code>Protected</code> handler, but only after passing through the <code>h.AuthorizationHandlerFunc</code> like this</p>\n\n<pre><code>   h.AuthorizationHandlerFunc(Protected)\n</code></pre>\n\n<p>However, since I'm not using DefaultServeMux, it's not working i.e. I'm not able to pass the <code>Protected</code> function (and have it called) to the <code>AuthorizationHandlerFunc</code>. This is the implementation of the AuthorizationHandlerFunc below. You can see below that <code>Protected</code> never gets called. </p>\n\n<p>Question: how do I implement <code>HandlerFunc</code> in this situation (without using DefaultServeMux)? </p>\n\n<pre><code>func (h *Handler) AuthorizationHandlerFunc(next http.HandlerFunc) http.Handler{\n     return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n         h.AuthorizationMiddleWare(w, r, next)\n   })\n}\n\nfunc (h *Handler) AuthorizationMiddleWare(w http.ResponseWriter, r *http.Request, next http.HandlerFunc){\n     //other stuff happens\n     log.Println(\"this is never getting called\")\n     next(w,r)\n}\nfunc (h *Handler)Protected(w http.ResponseWriter, r *http.Request){\n\n      log.Println(\"this is never getting called\")\n}\n</code></pre>\n\n<p><strong>Update</strong>\nServeHTTP is implemented on mypackage.Handler. Why is the Protected function not getting called, or, for that matter, the relevant code in the AuthorizationMiddleWare?</p>\n"}, {"tags": ["go", "flags"], "answers": [{"comments": [{"owner": {"reputation": 2062, "user_id": 5347169, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/c9RlU.png?s=128&g=1", "display_name": "sphoenix", "link": "https://stackoverflow.com/users/5347169/sphoenix"}, "edited": false, "score": 0, "creation_date": 1559020644, "post_id": 32330783, "comment_id": 99276758, "body": "How to know which flag has been passed? i.e. how would I know if the flag <code>-a</code> has been passed or flag <code>-b</code> has been passed?"}], "tags": [], "owner": {"reputation": 14317, "user_id": 182402, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/de96aa2f424a48b2510a7d29c65a8ace?s=128&d=identicon&r=PG", "display_name": "Wander Nauta", "link": "https://stackoverflow.com/users/182402/wander-nauta"}, "is_accepted": true, "score": 3, "last_activity_date": 1441107981, "creation_date": 1441107981, "answer_id": 32330783, "question_id": 32330631, "link": "https://stackoverflow.com/questions/32330631/how-to-find-number-of-flags-coming-from-console-in-golang/32330783#32330783", "title": "How to find number of flags coming from console in Golang", "body": "<p>If you use the standard <code>flag</code> package to parse command-line flags, you can call the NFlag function to get the number of flags:</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"flag\"\n\nfunc main() {\n        flag.Bool(\"a\", true, \"A value\");\n        flag.Bool(\"b\", true, \"B value\");\n        flag.Parse();\n\n        fmt.Println(flag.NFlag())\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>$ go run test.go \n0\n$ go run test.go -a\n1\n$ go run test.go -a -b\n2\n</code></pre>\n"}], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 32330783, "answer_count": 1, "score": -1, "last_activity_date": 1441107981, "creation_date": 1441107452, "question_id": 32330631, "link": "https://stackoverflow.com/questions/32330631/how-to-find-number-of-flags-coming-from-console-in-golang", "title": "How to find number of flags coming from console in Golang", "body": "<p>I'm passing argument from console. There are some flags too. Like:</p>\n\n<pre><code>go run test.go \"-IP=10.10.10.10\" \"-db=kite\" \"-wv=45\" \"-cv=75\" \"A = value1\" \"B = value2\" \"C = 100\" \"D := ((A-B)/A)*C\" \"D ?\"\n</code></pre>\n\n<p>Here, <code>-IP</code>, <code>-db</code>, <code>-wv</code>, <code>-wc</code> these four are flags and others are passing as normal argument as I know.</p>\n\n<p>Number of flags can be variable.</p>\n\n<p>How can I know how many flags are passed to my program. In this case <code>4</code> flags are passed.</p>\n"}, {"tags": ["encryption", "go", "aes"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1441112445, "post_id": 32329512, "comment_id": 52538824, "body": "I strongly suggest using <a href=\"http://golang.org/x/crypto/nacl/secretbox\" rel=\"nofollow noreferrer\">golang.org/x/crypto/nacl/secretbox</a> if you need to encrypt files, as it also correctly authenticates the encrypted data."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441118102, "post_id": 32329512, "comment_id": 52542883, "body": "Do not roll your own encryption. Just using a secure primitive (AES) is not sufficient/secure if you don&#39;t use it correctly (IV, key, block mode, etc, etc). E.g. don&#39;t ever use a passphrase raw the way you do (there are key derivation functions such as is <code>golang.org&#47;x&#47;crypto&#47;pbkdf2</code> for that); use a cryptographically secure completely random IV, etc. Unless you&#39;re a cryptography expert you should be using a complete implementation written by an expert that handles all the details so you don&#39;t get it wrong."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441118273, "post_id": 32329512, "comment_id": 52543003, "body": "Also, <a href=\"https://crypto.stackexchange.com/\">crypto.stackexchange.com</a> may be better for crypto questions such as &quot;how do I generate an IV&quot; or &quot;how do I use a passphrase as an encryption key&quot; (which are largely programming language agnostic questions)."}, {"owner": {"reputation": 43, "user_id": 3030913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067c103eb343d44f9213421d96872c06?s=128&d=identicon&r=PG&f=1", "display_name": "W Khan", "link": "https://stackoverflow.com/users/3030913/w-khan"}, "edited": false, "score": 0, "creation_date": 1441119432, "post_id": 32329512, "comment_id": 52543819, "body": "I did consider secretbox but there is very little documentation. I cant find any examples on there either. I wish there was better docs for it"}], "answers": [{"tags": [], "owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "is_accepted": true, "score": 10, "last_activity_date": 1441117435, "last_edit_date": 1441117435, "creation_date": 1441108774, "answer_id": 32331063, "question_id": 32329512, "link": "https://stackoverflow.com/questions/32329512/golang-file-encryption-with-crypto-aes-lib/32331063#32331063", "title": "Golang file encryption with crypto/aes lib", "body": "<p>There is an example in the <code>crypto/cipher</code> package <a href=\"https://golang.org/pkg/crypto/cipher/#example_NewCFBEncrypter\" rel=\"noreferrer\">documentation</a>.</p>\n\n<p>I've tweaked the example to make new example for you:</p>\n\n<pre><code>func main() {\n    // read content from your file\n    plaintext, err := ioutil.ReadFile(\"you_file_to_be_encrypted\")\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // this is a key\n    key := []byte(\"example key 1234\")\n\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        panic(err)\n    }\n\n    // The IV needs to be unique, but not secure. Therefore it's common to\n    // include it at the beginning of the ciphertext.\n    ciphertext := make([]byte, aes.BlockSize+len(plaintext))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        panic(err)\n    }\n\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(ciphertext[aes.BlockSize:], plaintext)\n\n    // create a new file for saving the encrypted data.\n    f, err := os.Create(\"a_aes.txt\")\n    if err != nil {\n        panic(err.Error())\n    }\n    _, err = io.Copy(f, bytes.NewReader(ciphertext))\n    if err != nil {\n        panic(err.Error())\n    }\n\n    // done\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 3030913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/067c103eb343d44f9213421d96872c06?s=128&d=identicon&r=PG&f=1", "display_name": "W Khan", "link": "https://stackoverflow.com/users/3030913/w-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10599, "favorite_count": 3, "accepted_answer_id": 32331063, "answer_count": 1, "score": 3, "last_activity_date": 1441117435, "creation_date": 1441103950, "question_id": 32329512, "link": "https://stackoverflow.com/questions/32329512/golang-file-encryption-with-crypto-aes-lib", "title": "Golang file encryption with crypto/aes lib", "body": "<p>I am trying to encrypt a file using the Go crypto/aes package. I have so far:</p>\n\n<pre><code>func encrypt(source string, localdir string) error {\n\n    src := filepath.Join(\"/home/bacula/cloud-backup/\"+localdir, source)\n    dst := filepath.Join(src + \".aes\")\n\n    fmt.Println(src)\n    fmt.Println(dst)\n    key := []byte(\"example key 1234\")\n\n    iv := []byte(key)[:aes.BlockSize]\n\n    aesBlockEncrypter, err := aes.NewCipher([]byte(key))\n    if err != nil {\n            return err\n    }\n    aesEncrypter := cipher.NewCFBEncrypter(aesBlockEncrypter, iv)\n    aesEncrypter.XORKeyStream([]byte(dst), []byte(src))\n    return nil\n}\n</code></pre>\n\n<p>My first question is, how can I improve the way I am generating the IV? And secondly, there is no output file, so how do I stream the file through XORKeyStream? </p>\n"}, {"tags": ["rest", "go", "coding-style"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 2, "last_activity_date": 1441122880, "last_edit_date": 1441122880, "creation_date": 1441106317, "answer_id": 32330262, "question_id": 32329444, "link": "https://stackoverflow.com/questions/32329444/how-to-separate-routes-handlers-3rd-party-interfaces-and-business-logic-in-rea/32330262#32330262", "title": "How to separate routes, handlers, 3rd-party interfaces and business logic in real world Go project", "body": "<p>I can share a bit from my own experience.</p>\n\n<ol>\n<li><p>In application code:</p>\n\n<ul>\n<li><p>as opposed to library code, separating into packages and sub-packages is less important - as long as you don't have too much complexity in your code. I mostly design apps as integrating self contained libraries, so the app code itself is usually rather small. In general, try to avoid package separation if you don't really need it. But don't just slap tons of code in one package - that's also bad.</p></li>\n<li><p>but don't have general packages like \"util\", they soon start to accumulate baggage and suck. I have a separate repo for generic utils reusable across projects, and under it each utility API is a sub package. e.g. <code>github.com/me/myutils/countrycodes</code>, <code>github.com/me/myutils/set</code>, <code>github.com/me/myutils/whatevs</code>.</p></li>\n</ul></li>\n<li><p>Regardless of the package structure, the most important thing is to separate internal APIs from handler code. The handlers code should be a very thin layer that handles input, and calls an internal, self contained API, that can be tested without handlers, or tied to other handlers. Looks like you're doing this. Then you can separate your internal API into another package or not, it doesn't really matter.</p></li>\n<li><p>When you're deciding what parts of the code should be separated into libraries, think in terms of code reuse. If this code will be used only by your app, there's no point in that.</p></li>\n<li><p>I like to wrap integration with third party APIs in an interface that is defined in a secondary package. For example if you have something like sending emails with AWS SES, I'd create a pakcage called <code>github.com/my_org/mailer</code>, with an abstract interface, and under it an <code>github.com/my_org/mailer/ses</code> package that implements the SES integration. The application code imports the <code>mailer</code> package and its interface, and only in <code>main</code> do I somehow inject the usage of SES and integrate things together.</p></li>\n<li><p>re middleware - I usually keep it in the same package as the API itself.</p></li>\n</ol>\n"}], "owner": {"reputation": 1621, "user_id": 486998, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0f0a1ee2c9b6c87792a2637a95f272cf?s=128&d=identicon&r=PG", "display_name": "klotz", "link": "https://stackoverflow.com/users/486998/klotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 32330262, "answer_count": 1, "score": 0, "last_activity_date": 1441122880, "creation_date": 1441103728, "question_id": 32329444, "link": "https://stackoverflow.com/questions/32329444/how-to-separate-routes-handlers-3rd-party-interfaces-and-business-logic-in-rea", "title": "How to separate routes, handlers, 3rd-party interfaces and business logic in real world Go project", "body": "<p>After reading the <a href=\"https://golang.org/doc/code.html#Command\" rel=\"nofollow\">official guide</a> on how to structure projects and going through various (<a href=\"http://thenewstack.io/make-a-restful-json-api-go/\" rel=\"nofollow\">1</a>, <a href=\"https://github.com/wibblymat/ioweb2015/tree/master/backend\" rel=\"nofollow\">2</a>, <a href=\"http://manuel.kiessling.net/2012/09/28/applying-the-clean-architecture-to-go-applications/\" rel=\"nofollow\">3</a> to name a few) examples and projects I can't help wondering whether my approach of structuring my REST-API server app is structured <em>properly</em>.</p>\n\n<h2>What is the API meant to do?</h2>\n\n<h3>POST <code>/auth/sign-in</code></h3>\n\n<p>Accepts a <code>username</code> and <code>password</code> and issues a <a href=\"http://jwt.io\" rel=\"nofollow\">JWT</a> (JSON Web Token).</p>\n\n<h3>GET <code>/auth/sign-out</code></h3>\n\n<p>Adds the JWT to a blacklist to invalidate the auth session.</p>\n\n<h3>GET <code>/resources</code></h3>\n\n<p>Retrieves a list of all resources.</p>\n\n<h3>POST <code>/resources</code> (requires valid JWT authentication)</h3>\n\n<p>Accepts a JSON body, creates a new resource and sends out an email and notification to everyone about the new resource.</p>\n\n<h2>What my project looks like</h2>\n\n<p>Currently I'm not creating any libraries. Everything is sitting in the main package, the overarching server setup with routes etc. all done in <code>main.go</code>. I didn't go for the MVC pattern found \u00e0 la Rails or Django to avoid overcomplicating things just for the sake of it. Also my impression was it doesn't really comply with the recommended structure for commands and libraries as described in the <a href=\"https://golang.org/doc/code.html#Command\" rel=\"nofollow\">guide</a> already mentioned above.</p>\n\n<pre><code>auth.go # generates, validates JWT, etc\nauth-handler.go # Handles sign-in/out requests; includes middleware for required authentication\nmailer.go # Provides methods to send out transactional email, loads correct template etc.\nmain.go # set up routes, runs server; inits mailer and notification instance for the request context\nmodels.go # struct definition for User, Resource\nnotifications.go # Provides methods to publish push notifications\nresource-handler.go # Handles request for resources, uses mailer and notifications instances for the POST request\n</code></pre>\n\n<h2>What should it look like?</h2>\n\n<p>Should routes be separated? What about middleware? And how do you deal with interfaces to 3rd party code \u2013 imagine <code>mailer.go</code> in the outlined sample app talking to Mandrill and <code>notifications.go</code> to Amazon AWS SNS?</p>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3107902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fba4145f14385be1a4b87af33e7871?s=128&d=identicon&r=PG&f=1", "display_name": "HsNamed", "link": "https://stackoverflow.com/users/3107902/hsnamed"}, "edited": false, "score": 0, "creation_date": 1441100802, "post_id": 32328174, "comment_id": 52531111, "body": "In that way how can i parallelize using goroutine ?"}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 53, "user_id": 3107902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fba4145f14385be1a4b87af33e7871?s=128&d=identicon&r=PG&f=1", "display_name": "HsNamed", "link": "https://stackoverflow.com/users/3107902/hsnamed"}, "edited": false, "score": 1, "creation_date": 1441101859, "post_id": 32328174, "comment_id": 52531835, "body": "Using a goroutine for that kind of thing sounds like a bad idea: you can&#39;t really multiplex the reading of a file..."}, {"owner": {"reputation": 53, "user_id": 3107902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fba4145f14385be1a4b87af33e7871?s=128&d=identicon&r=PG&f=1", "display_name": "HsNamed", "link": "https://stackoverflow.com/users/3107902/hsnamed"}, "edited": false, "score": 0, "creation_date": 1441105070, "post_id": 32328174, "comment_id": 52533862, "body": "Idea is : default buffer size about 1kb, <b>1)</b> Set begin offset to M <b>2)</b> move pointer to offset M+1024 , <b>3)</b> read rune if its not json delimeter move forward to closest delimeter and find it on N position, <b>4)</b> call goroutine func with begin offset (M), end ofsset (1024+N),  repeat steps."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 0, "last_activity_date": 1441100490, "last_edit_date": 1441100490, "creation_date": 1441100117, "answer_id": 32328174, "question_id": 32328030, "link": "https://stackoverflow.com/questions/32328030/which-is-the-best-way-to-process-big-json-replace-specific-values/32328174#32328174", "title": "Which is the best way to process big json &amp; replace specific values?", "body": "<p>I would make a struct that implements the <code>io.Reader</code> interface, and use that reader as a translation ground: you can use it to get you JSON input chunk by chunk, and detect when you are on a key that need to be changed, so translate it on the fly.</p>\n\n<p>Then, you just have to use a <code>io.Copy</code> to read the whole file into another.</p>\n\n<p>See the <a href=\"https://godoc.org/golang.org/x/text/transform\" rel=\"nofollow\">text.transform</a> package dependency graph for examples\u2026</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 3107902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fba4145f14385be1a4b87af33e7871?s=128&d=identicon&r=PG&f=1", "display_name": "HsNamed", "link": "https://stackoverflow.com/users/3107902/hsnamed"}, "edited": false, "score": 0, "creation_date": 1441380971, "post_id": 32388916, "comment_id": 52671795, "body": "Thanks , its what i need"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 0, "last_activity_date": 1441331551, "creation_date": 1441331551, "answer_id": 32388916, "question_id": 32328030, "link": "https://stackoverflow.com/questions/32328030/which-is-the-best-way-to-process-big-json-replace-specific-values/32388916#32388916", "title": "Which is the best way to process big json &amp; replace specific values?", "body": "<p>You can use a streaming JSON decoder like <a href=\"http://github.com/benbjohnson/megajson/scanner\" rel=\"nofollow\">megajson</a>:</p>\n\n<pre><code>// Transform 'title' strings into Title case\nfunc TitleizeJSON(r io.Reader, w io.Writer) error {\n    buf := new(bytes.Buffer)\n    r = io.TeeReader(r, buf)\n\n    s := scanner.NewScanner(r)\n    var prevTok int\n    var prevPos int\n    wasTitle := false\n    titleField := []byte(\"title\")\n    for {\n        // read the next json token\n        tok, data, err := s.Scan()\n        if err == io.EOF {\n            return nil\n        } else if err != nil {\n            return err\n        }\n        // calculate the position in the buffer\n        pos := s.Pos()\n        off := pos - prevPos\n\n        switch tok {\n        // if this is a string\n        case scanner.TSTRING:\n            // if the previous string before a : was 'title', then\n            // titlelize it\n            if prevTok == scanner.TCOLON &amp;&amp; wasTitle {\n                // grab the first part of the buffer and skip\n                // the first \", the titleize the rest\n                data = buf.Bytes()[:off][1:]\n                copy(data, bytes.Title(data))\n                wasTitle = false\n            } else {\n                wasTitle = bytes.Equal(data, titleField)\n            }\n        }\n\n        // now send the data to the writer\n        data = buf.Bytes()\n        _, err = w.Write(data[:off])\n        if err != nil {\n            return err\n        }\n\n        // reset the buffer (so it doesn't grow forever)\n        nbuf := make([]byte, len(data)-off)\n        copy(nbuf, data[off:])\n        buf.Reset()\n        buf.Write(nbuf)\n\n        // for the next go-around\n        prevTok = tok\n        prevPos = pos\n    }\n}\n</code></pre>\n\n<p>This should do the titleizing on the fly. The one case I can think of where it will have a problem is if you have a really really big string.</p>\n"}], "owner": {"reputation": 53, "user_id": 3107902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31fba4145f14385be1a4b87af33e7871?s=128&d=identicon&r=PG&f=1", "display_name": "HsNamed", "link": "https://stackoverflow.com/users/3107902/hsnamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 32388916, "answer_count": 2, "score": 1, "last_activity_date": 1441331551, "creation_date": 1441099718, "last_edit_date": 1441105458, "question_id": 32328030, "link": "https://stackoverflow.com/questions/32328030/which-is-the-best-way-to-process-big-json-replace-specific-values", "title": "Which is the best way to process big json &amp; replace specific values?", "body": "<p>I have a big json (30mb) which contains \"title\" fields in different objects , structure of json is unknown.</p>\n\n<p>Known only that json contains keys \"title\" and string value of this key must be translated into another.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>{\n    \"data1\" : {\n        \"title\" : \"alpha\",\n        \"color\" : \"green\"\n    },\n    \"data2\" : {\n        \"someInnerData1\" : {\n            \"title\" : \"beta\"\n            \"color\" : \"red\"\n        },\n        \"someInnerData2\" : {\n            \"someArray\" : [\n            {\n                \"title\" : \"gamme\",\n                \"color\" : \"orange\"\n            },\n            {\n                \"title\" : \"delta\",\n                \"color\" : \"purple\"\n            }\n            ],\n            \"title\" : \"epsilon\"\n        }\n    }\n}\n</code></pre>\n\n\n\n<p>Replace example\n\"alpha\" -> \"\u0391\"\n\"beta\" -> \"B\"\netc..</p>\n\n<p>Which the best way achieve that in Golang , without decoding into struct ?</p>\n\n<p><strong>P.S.</strong> Json is received from network.</p>\n"}, {"tags": ["sockets", "tcp", "go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "edited": false, "score": 6, "creation_date": 1522246636, "post_id": 32325509, "comment_id": 86080565, "body": "If you are increasing your ulimit, you will still run out of file descriptors eventually.  Try using a buffered channel and limit the number of go-routines that open a file to below the ulimit.  1000 open files at a time should be more then enough..."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 41, "last_activity_date": 1567717083, "last_edit_date": 1567717083, "creation_date": 1441091093, "answer_id": 32325509, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/32325509#32325509", "title": "Go, tcp too many open files debug", "body": "<p>I think you need to change your max file descriptors.  I have run into the same problem on one of my development VMs before and needed to change the file descriptors max, not anything with inotify settings.  </p>\n\n<p>FWIW, your program runs fine on my VM.</p>\n\n<pre><code>\u00b7&gt; ulimit -n\n120000\n</code></pre>\n\n<p>But after I run</p>\n\n<pre><code>\u00b7&gt; ulimit -n 500\n\u00b7&gt; ulimit -n\n500\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>panic: Get http://127.0.0.1:51227: dial tcp 127.0.0.1:51227: socket: too many open files\n</code></pre>\n\n<p>** Don't fall into the trap that Praveen did **</p>\n\n<p>Note <code>ulimit</code> != <code>ulimit -n</code>.</p>\n\n<pre><code>\u279c  cmd git:(wip-poop) \u2717 ulimit -a\n-t: cpu time (seconds)              unlimited\n-f: file size (blocks)              unlimited\n-d: data seg size (kbytes)          unlimited\n-s: stack size (kbytes)             8192\n-c: core file size (blocks)         0\n-v: address space (kbytes)          unlimited\n-l: locked-in-memory size (kbytes)  unlimited\n-u: processes                       1418\n-n: file descriptors                4864\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 4230910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yi7lM.jpg?s=128&g=1", "display_name": "Matt Borowiec", "link": "https://stackoverflow.com/users/4230910/matt-borowiec"}, "is_accepted": false, "score": 1, "last_activity_date": 1461713069, "creation_date": 1461713069, "answer_id": 36877539, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/36877539#36877539", "title": "Go, tcp too many open files debug", "body": "<p>I had to also to manually set the close connection header to avoid the file descriptor issue:</p>\n\n<pre><code>r, _ := http.NewRequest(http.MethodDelete, url, nil)\nr.Close = true\nres, err := c.Do(r)\nres.Body.Close();\n</code></pre>\n\n<p>Without r.Close = true and res.Body.Close() I hit the file descriptor limit. With both I could fire off as many as I needed.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8483119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b6ce5d107310459b4cd4adbd8cdc95?s=128&d=identicon&r=PG&f=1", "display_name": "sp111", "link": "https://stackoverflow.com/users/8483119/sp111"}, "is_accepted": false, "score": 1, "last_activity_date": 1503051608, "creation_date": 1503051608, "answer_id": 45754270, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/45754270#45754270", "title": "Go, tcp too many open files debug", "body": "<p>change the ulimit to avoid the error \"too many open files\"\nby default max ulimit is 4096 for linux and 1024 for mac,\nu can change ulimit to 4096 by typing\nulimit -n 4096\nfor beyond 4096 you need to modify limits.conf in etc/security folder for linux and set hard limit to 100000 by adding this line  \"*  hard  core  100000\"</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 6371390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0804df1e7c23a4e4262e583cbaa45307?s=128&d=identicon&r=PG&f=1", "display_name": "\u4f59\u4e91\u9e4f", "link": "https://stackoverflow.com/users/6371390/%e4%bd%99%e4%ba%91%e9%b9%8f"}, "is_accepted": false, "score": 3, "last_activity_date": 1522145237, "creation_date": 1522145237, "answer_id": 49510046, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/49510046#49510046", "title": "Go, tcp too many open files debug", "body": "<pre><code>HTTP/1.1 uses persistent connections by default:\nA significant difference between HTTP/1.1 and earlier versions of HTTP is that persistent connections are the default behavior of any HTTP connection.\nhttp://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html\nThe solution was to inform the server that the client wants to close the connection after the transaction is complete. This can be done by setting the Connection header,\nreq.Header.Set(\"Connection\", \"close\") or by setting the Close property to true on the http.Request:\nreq.Close = true After doing that, the \u201ctoo many open files\u201d issue went away as the program was no longer keeping HTTP connections open and thus not using up file descriptors.\n</code></pre>\n\n<p>I solved this by adding req.Close = true and req.Header.Set(\"Connection\", \"close\"). I think it's better than changing ulimit.</p>\n\n<p>source: <a href=\"http://craigwickesser.com/2015/01/golang-http-to-many-open-files/\" rel=\"nofollow noreferrer\">http://craigwickesser.com/2015/01/golang-http-to-many-open-files/</a></p>\n"}, {"comments": [{"owner": {"reputation": 1771, "user_id": 2736037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/FJzsN.jpg?s=128&g=1", "display_name": "elijahcarrel", "link": "https://stackoverflow.com/users/2736037/elijahcarrel"}, "edited": false, "score": 2, "creation_date": 1578593522, "post_id": 49539724, "comment_id": 105498619, "body": "I believe this has a (very unlikely but possible) race condition bug\u2014 you should <code>wg.Add(1)</code> outside of and just before <code>go func(...) { ... }</code>. Otherwise, if the first <code>n</code> goroutines finish before the <code>n + 1</code>th goroutine begins (which is, again, extremely unlikely), then the <code>wg.Wait()</code> command might actually terminate before the <code>n+1</code>th and remaining goroutines get run. (They will still get run, but the downstream code won&#39;t have waited for it.)"}], "tags": [], "owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "is_accepted": false, "score": 10, "last_activity_date": 1584025506, "last_edit_date": 1584025506, "creation_date": 1522254511, "answer_id": 49539724, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/49539724#49539724", "title": "Go, tcp too many open files debug", "body": "<p>If you want to run millions of go routines that open/read/close a socket, well you better up your ulimit, or open/read/close the socket and pass the value read in to the go-routine, but I would use a buffered channel to control how many file descriptors you want to be able to open.</p>\n\n<pre><code>const (\n    // this is where you can specify how many maxFileDescriptors\n    // you want to allow open\n    maxFileDescriptors = 100\n)\n\nfunc main() {\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintln(w, \"Hello, client\")\n    }))\n    defer ts.Close()\n    var wg sync.WaitGroup\n    maxChan := make(chan bool, maxFileDescriptors)\n    for i := 0; i &lt; 1000; i++ {\n        maxChan &lt;- true\n        wg.Add(1)\n        go func(url string, i int, maxChan chan bool, wg *sync.WaitGroup) {\n            defer wg.Done()\n            defer func(maxChan chan bool) { &lt;-maxChan }(maxChan)\n            resp, err := http.Get(url)\n            if err != nil {\n                panic(err)\n            }\n            greeting, err := ioutil.ReadAll(resp.Body)\n            if err != nil {\n                panic(err)\n            }\n            err = resp.Body.Close()\n            if err != nil {\n                panic(err)\n            }\n            fmt.Printf(\"%d: %s\", i, string(greeting))\n        }(ts.URL, i, maxChan, &amp;wg)\n    }\n    wg.Wait()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 815, "user_id": 179741, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2a08c737c924d7569fe1e9c2f88f7809?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/179741/daniel"}, "edited": false, "score": 2, "creation_date": 1559635339, "post_id": 52690915, "comment_id": 99472921, "body": "Excellent, this is exactly the practical wisdom I am seeking."}], "tags": [], "owner": {"reputation": 3588, "user_id": 1842743, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AUYWV.png?s=128&g=1", "display_name": "PodTech.io", "link": "https://stackoverflow.com/users/1842743/podtech-io"}, "is_accepted": false, "score": 12, "last_activity_date": 1538932191, "creation_date": 1538932191, "answer_id": 52690915, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug/52690915#52690915", "title": "Go, tcp too many open files debug", "body": "<p>Go\u2019s http package doesn\u2019t specify request timeouts by default. You should always include a timeout in your service. What if a client doesn't close their session? Your process will keep alive old sessions hitting ulimits. A bad actor could intentionally open thousands of sessions, DOSing your server. Heavy load services should adjust ulimits as well but timeouts for backstop.</p>\n\n<p>Ensure you specify a timeout:</p>\n\n<pre><code>http.DefaultClient.Timeout = time.Minute * 10\n</code></pre>\n\n<p>You can validate before and after by monitoring files opened by your process: </p>\n\n<pre><code>lsof -p [PID_ID]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47633, "favorite_count": 9, "accepted_answer_id": 32325509, "answer_count": 6, "score": 26, "last_activity_date": 1584025506, "creation_date": 1441090528, "question_id": 32325343, "link": "https://stackoverflow.com/questions/32325343/go-tcp-too-many-open-files-debug", "title": "Go, tcp too many open files debug", "body": "<p>Here's a straightforward Go http (tcp) connection test script</p>\n\n<pre><code>func main() {\n    ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintln(w, \"Hello, client\")\n    }))\n    defer ts.Close()\n    var wg sync.WaitGroup\n    for i := 0; i &lt; 2000; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            resp, err := http.Get(ts.URL)\n            if err != nil {\n                panic(err)\n            }\n            greeting, err := ioutil.ReadAll(resp.Body)\n            resp.Body.Close()\n            if err != nil {\n                panic(err)\n            }\n            fmt.Printf(\"%s\", i, greeting)\n        }(i)\n    }\n    wg.Wait()\n}\n</code></pre>\n\n<p>And If I run this in Ubuntu I get:</p>\n\n<p><code>panic: Get http://127.0.0.1:33202: dial tcp 127.0.0.1:33202: too many open files</code></p>\n\n<p>Other posts say to make sure <code>Close</code> the connection, which I am doing it all here.\nAnd others say to increase the limit of maximum connection with <code>ulimit</code> or try <code>sudo sysctl -w fs.inotify.max_user_watches=100000</code> but still does not work.</p>\n\n<p>How do I run millions of tcp connection goroutines in a single server?\nIt crashes only with 2,000 connections.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["mysql", "utf-8", "go"], "comments": [{"owner": {"reputation": 4702, "user_id": 2842324, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zCIOj.png?s=128&g=1", "display_name": "Paresh Gami", "link": "https://stackoverflow.com/users/2842324/paresh-gami"}, "edited": false, "score": 0, "creation_date": 1441083683, "post_id": 32323816, "comment_id": 52522245, "body": "what is Collation in field of table.?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 4702, "user_id": 2842324, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zCIOj.png?s=128&g=1", "display_name": "Paresh Gami", "link": "https://stackoverflow.com/users/2842324/paresh-gami"}, "edited": false, "score": 0, "creation_date": 1441084396, "post_id": 32323816, "comment_id": 52522466, "body": "It&#39;s this latin1_swedish_ci"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1441086687, "post_id": 32323816, "comment_id": 52523357, "body": "I think the long-term best thing to do here is convert your input from MacRoman to UTF-8, because UTF-8 is a more widely used and more flexible encoding. You can call a program called <code>iconv</code> to do it, and there are library bindings to call iconv functionality from Go code. I&#39;m not sure which is the best, but <a href=\"https://godoc.org/github.com/qiniu/iconv\" rel=\"nofollow noreferrer\"><code>github.com&#47;qiniu&#47;iconv</code></a> came up on a search. Unfortunately I don&#39;t have time to come up with the full steps to use it on your input here."}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441084505, "post_id": 32323995, "comment_id": 52522511, "body": "I did that and it said 0 rows were affected"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441084595, "post_id": 32323995, "comment_id": 52522551, "body": "That establishes that macroman is the encoding on the <i>client</i> side.  So, perhaps the data is already stored wrong?  Please run <code>SELECT col, HEX(col) FROM tbl WHERE ...</code> to see what is actually in the table."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441085179, "post_id": 32323995, "comment_id": 52522740, "body": "Find the &quot;mysql commandline tool&quot; or &quot;phpmyadmin&quot;.  Construct a <code>SELECT</code> statement similar to what I wrote, but reaching for Do&#241;a.  Run it.  Report back on what you see."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441085198, "post_id": 32323995, "comment_id": 52522746, "body": "Let&#39;s see the code by which you are connecting to the database."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441085314, "post_id": 32323995, "comment_id": 52522790, "body": "there is no Dona in the table - that&#39;s the first time I&#39;m inserting, I&#39;ll post the go code used to connect and insert into the db."}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441085539, "post_id": 32323995, "comment_id": 52522888, "body": "There may be a row with just <code>Do</code> (truncated).  Or perhaps the insert aborted without doing anything.  Anyway, please provide <code>SHOW CREATE TABLE</code>."}], "tags": [], "owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "is_accepted": false, "score": 0, "last_activity_date": 1441084468, "creation_date": 1441084468, "answer_id": 32323995, "question_id": 32323816, "link": "https://stackoverflow.com/questions/32323816/dealing-with-spanish-tilde-in-golang/32323995#32323995", "title": "Dealing with spanish tilde in Golang", "body": "<p>Running on an Apple?  I assume that should have said <code>Do\u00f1a Merced Elementary</code>?  Yet, to get <code>\u00f1</code> from x96, you must have started with text in the \"MacRoman\" encoding.</p>\n\n<p>The simple solution <em>might</em> be to do <code>SET NAMES macroman</code> right after connecting to MySQL.</p>\n"}, {"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1441084945, "post_id": 32324058, "comment_id": 52522654, "body": "how do I do that? I already tried <a href=\"http://stackoverflow.com/questions/742205/how-to-change-the-default-collation-of-a-table\" title=\"how to change the default collation of a table\">stackoverflow.com/questions/742205/&hellip;</a>, and it didn&#39;t work"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1441085090, "post_id": 32324058, "comment_id": 52522707, "body": "Won&#39;t work because the 96 is encoded in &quot;macroman&quot;, not utf8."}], "tags": [], "owner": {"reputation": 4702, "user_id": 2842324, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/zCIOj.png?s=128&g=1", "display_name": "Paresh Gami", "link": "https://stackoverflow.com/users/2842324/paresh-gami"}, "is_accepted": true, "score": 0, "last_activity_date": 1441084833, "creation_date": 1441084833, "answer_id": 32324058, "question_id": 32323816, "link": "https://stackoverflow.com/questions/32323816/dealing-with-spanish-tilde-in-golang/32324058#32324058", "title": "Dealing with spanish tilde in Golang", "body": "<p>Please change collation to <code>utf8_general_ci</code>. it should work</p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 32324058, "answer_count": 2, "score": -1, "last_activity_date": 1441085375, "creation_date": 1441083429, "last_edit_date": 1441085375, "question_id": 32323816, "link": "https://stackoverflow.com/questions/32323816/dealing-with-spanish-tilde-in-golang", "title": "Dealing with spanish tilde in Golang", "body": "<p>So I'm trying to enter this string into a mysql database using a sql driver. I get this error - </p>\n\n<pre><code>Do?a Merced Elementary\npanic: Error 1366: Incorrect string value: '\\x96a Mer...' for column 'name' at row 1\n</code></pre>\n\n<p>I thought about excluding this entry, but haven't been able to do so. I've tried -</p>\n\n<pre><code>if !strings.ContainsAny(splitStr[2], \"U+0303\") {\nif !strings.ContainsAny(splitStr[2], '\\x96') {\n</code></pre>\n\n<p>but that has not worked. </p>\n\n<p>It would be better to have mysql deal with this, but I'm not sure how.</p>\n\n<p>Any suggestions? </p>\n\n<p>EDIT</p>\n\n<p>This is how I connect to my db</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"psanker:123@/education_data\")\nerr = db.Ping()\n\ndb.SetMaxOpenConns(0)\ncheck(err)\nif err != nil {\n    fmt.Println(\"Failed to prepare connection to database\")\n    log.Fatal(\"Error:\", err.Error())\n}\n</code></pre>\n\n<p>This is where my issue comes</p>\n\n<pre><code>districtResult, err := db.Exec(\"INSERT INTO districts(name) VALUES(?)\", strings.TrimSpace(splitStr[2]))\ncheck(err)\n</code></pre>\n\n<p>Output of SHOW CREATE TABLE</p>\n\n<pre><code>---------------------------------+\n| Table     | Create Table                                                                                                                                                                                                                   |\n+-----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| districts | CREATE TABLE `districts` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=35 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci |\n</code></pre>\n"}, {"tags": ["oop", "go"], "answers": [{"tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": true, "score": 29, "last_activity_date": 1441084980, "last_edit_date": 1441084980, "creation_date": 1441081417, "answer_id": 32323502, "question_id": 32323363, "link": "https://stackoverflow.com/questions/32323363/interface-inherit-from-other-interface-in-golang/32323502#32323502", "title": "Interface inherit from other interface in golang", "body": "<p>You can embed other interfaces inside an interface, which gives you basicaly the same benefits:</p>\n\n<p>A Good Example is the <code>ReadWriteCloser</code> in the io package: \n<a href=\"http://golang.org/pkg/io/#ReadWriteCloser\" rel=\"noreferrer\">http://golang.org/pkg/io/#ReadWriteCloser</a></p>\n\n<p>It embeds a <code>Reader</code>, a <code>Writer</code> and a <code>Closer</code> interface.</p>\n"}, {"comments": [{"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1494656063, "post_id": 43912013, "comment_id": 74931885, "body": "That&#39;s a need for the sake of documentation and cohesion."}], "tags": [], "owner": {"reputation": 253, "user_id": 1682383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ff32fb9a0a0483e7f3e6d4ef1cc586f?s=128&d=identicon&r=PG", "display_name": "Sadok", "link": "https://stackoverflow.com/users/1682383/sadok"}, "is_accepted": false, "score": 0, "last_activity_date": 1494496250, "creation_date": 1494496250, "answer_id": 43912013, "question_id": 32323363, "link": "https://stackoverflow.com/questions/32323363/interface-inherit-from-other-interface-in-golang/43912013#43912013", "title": "Interface inherit from other interface in golang", "body": "<p>I guess that you don't need inheritance,\nGolang tests if your struct implements related method in interface so a struct can implement many interfaces</p>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11140, "favorite_count": 0, "accepted_answer_id": 32323502, "answer_count": 2, "score": 12, "last_activity_date": 1494496250, "creation_date": 1441080452, "question_id": 32323363, "link": "https://stackoverflow.com/questions/32323363/interface-inherit-from-other-interface-in-golang", "title": "Interface inherit from other interface in golang", "body": "<p>Interface inheritance looks like the following in C#:</p>\n\n<pre><code>interface IA{\n    void MethodX();\n}\n\ninterface IB : IA{\n    void MethodY();\n}\n</code></pre>\n\n<p>How can I reuse interface definition in go?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "gae-search"], "answers": [{"tags": [], "owner": {"reputation": 2037, "user_id": 1519956, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/332c8a876c00458a13283520f2cec7b3?s=128&d=identicon&r=PG&f=1", "display_name": "Omair Shamshir", "link": "https://stackoverflow.com/users/1519956/omair-shamshir"}, "is_accepted": true, "score": 1, "last_activity_date": 1441089522, "creation_date": 1441089522, "answer_id": 32325080, "question_id": 32323225, "link": "https://stackoverflow.com/questions/32323225/gae-full-text-search-api-on-datastore-entities-using-golang/32325080#32325080", "title": "GAE Full Text Search API on datastore entities using Golang", "body": "<p>You cannot run full text search on the datastore entities. To perform full text search you need to create separate Documents in the text search indexes, which is independent from the datastore. If you want to do text search on what data you have in the datastore, iterate over it and create the documents from the entities in full text search indexes.</p>\n\n<p>For documentation , the link you provided </p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/go/search/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/search/</a></p>\n\n<p>have the information in it.</p>\n"}], "owner": {"reputation": 802, "user_id": 2018909, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/10ebdad579fc333db3830e893baf977e?s=128&d=identicon&r=PG", "display_name": "srini", "link": "https://stackoverflow.com/users/2018909/srini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1244, "favorite_count": 2, "accepted_answer_id": 32325080, "answer_count": 1, "score": 2, "last_activity_date": 1475211518, "creation_date": 1441079336, "last_edit_date": 1475211518, "question_id": 32323225, "link": "https://stackoverflow.com/questions/32323225/gae-full-text-search-api-on-datastore-entities-using-golang", "title": "GAE Full Text Search API on datastore entities using Golang", "body": "<p>I heard that we have <a href=\"https://cloud.google.com/appengine/docs/go/search/\" rel=\"nofollow\">app engine Search API support for Golang</a>. but it is not clear if we have can use this search API on GAE datastore entities (the <a href=\"https://youtu.be/7B7FyU9wW8Y?t=30m5s\" rel=\"nofollow\">Google IO 2011 video</a> says it is possible, but not sure if that is really supported using Golang). Any thoughts about this? and any good documentation with examples? really appreciate your help.</p>\n"}, {"tags": ["json", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 178, "user_id": 2099971, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee26f7a1e5c40283aaf5e0f4a564bec6?s=128&d=identicon&r=PG", "display_name": "mbridges", "link": "https://stackoverflow.com/users/2099971/mbridges"}, "edited": false, "score": 1, "creation_date": 1441077903, "post_id": 32322125, "comment_id": 52520794, "body": "<code>interface{}</code> is the closest thing to a generic-type you will get in Go, you can pass any type using it, json then uses <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> to handle it."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1441069963, "creation_date": 1441069963, "answer_id": 32322125, "question_id": 32322013, "link": "https://stackoverflow.com/questions/32322013/how-to-write-a-go-function-to-accept-different-structs/32322125#32322125", "title": "How to write a Go function to accept different structs?", "body": "<p>Use <code>interface{}</code>:</p>\n\n<pre><code>func ParseJSON(file string, val interface{}) {\n    configFile, err := ioutil.ReadFile(file)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = json.Unmarshal(configFile, val)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Calling the function is the same.</p>\n"}], "owner": {"reputation": 178, "user_id": 2099971, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ee26f7a1e5c40283aaf5e0f4a564bec6?s=128&d=identicon&r=PG", "display_name": "mbridges", "link": "https://stackoverflow.com/users/2099971/mbridges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 1, "accepted_answer_id": 32322125, "answer_count": 1, "score": 5, "last_activity_date": 1441069963, "creation_date": 1441068919, "last_edit_date": 1441069421, "question_id": 32322013, "link": "https://stackoverflow.com/questions/32322013/how-to-write-a-go-function-to-accept-different-structs", "title": "How to write a Go function to accept different structs?", "body": "<p>I am writing a function that parses a config JSON file and using json.Unmarshal stores its data in a struct. I've done some research and it's gotten me the point where I have a Config struct and a Server_Config struct as a field in config to allow me to add more fields as I want different config-like structs. </p>\n\n<p>How can I write one parseJSON function to work for different types of structs? </p>\n\n<p>Code:</p>\n\n<p><strong>Server.go</strong></p>\n\n<pre><code>type Server_Config struct {\n    html_templates string\n}\n\ntype Config struct {\n    Server_Config\n}\n\nfunc main() {\n    config := Config{}\n    ParseJSON(\"server_config.json\", &amp;config)\n    fmt.Printf(\"%T\\n\", config.html_templates)\n    fmt.Printf(config.html_templates)\n}\n</code></pre>\n\n<p><strong>config.go</strong></p>\n\n<pre><code>package main\nimport(\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"log\"\n)\n\nfunc ParseJSON(file string, config Config) {\n    configFile, err := ioutil.ReadFile(file)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = json.Unmarshal(configFile, &amp;config)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Or if there is a better way to do all this let me know that as well. Pretty new to Go and I have Java conventions carved into my brain. </p>\n"}, {"tags": ["go", "portaudio", "libsndfile"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1441066910, "post_id": 32319854, "comment_id": 52518545, "body": "I recommend upgrading to 1.5 and trying again, then update the question if you still have the same problem."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1441068112, "post_id": 32319854, "comment_id": 52518778, "body": "you can make a prof to find out the <code>laggy</code> codes"}, {"owner": {"reputation": 718, "user_id": 420617, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/064b90a36fe64e985097e116e9044133?s=128&d=identicon&r=PG", "display_name": "Joel Auterson", "link": "https://stackoverflow.com/users/420617/joel-auterson"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1441089349, "post_id": 32319854, "comment_id": 52524492, "body": "@OneOfOne Thanks, that seems to have helped with the first issue - I&#39;m still getting a lot of these odd audio artefacts, though."}, {"owner": {"reputation": 718, "user_id": 420617, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/064b90a36fe64e985097e116e9044133?s=128&d=identicon&r=PG", "display_name": "Joel Auterson", "link": "https://stackoverflow.com/users/420617/joel-auterson"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1441090178, "post_id": 32319854, "comment_id": 52524923, "body": "@OneOfOne Looks like using float32s instead of int32s in the buffer fixed the previous issue - I checked with sndfile-info and it seems the track I was using has places where the signal is above 1, which mustn&#39;t be represented correctly in the ints? Not sure exactly. If you want to add the above as an answer I&#39;ll mark it correct. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1441125426, "creation_date": 1441125426, "answer_id": 32336786, "question_id": 32319854, "link": "https://stackoverflow.com/questions/32319854/portaudio-playback-lag-at-default-frames-per-buffer/32336786#32336786", "title": "PortAudio: Playback lag at default frames-per-buffer", "body": "<p>Moving to the comment to an answer:</p>\n\n<p>Always test with the latest version of Go.</p>\n\n<p>Also, @Joel figured out that you need to use <code>float32</code> instead of <code>int32</code>.</p>\n"}], "owner": {"reputation": 718, "user_id": 420617, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/064b90a36fe64e985097e116e9044133?s=128&d=identicon&r=PG", "display_name": "Joel Auterson", "link": "https://stackoverflow.com/users/420617/joel-auterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 32336786, "answer_count": 1, "score": 1, "last_activity_date": 1441125426, "creation_date": 1441054639, "last_edit_date": 1441054992, "question_id": 32319854, "link": "https://stackoverflow.com/questions/32319854/portaudio-playback-lag-at-default-frames-per-buffer", "title": "PortAudio: Playback lag at default frames-per-buffer", "body": "<p>I'm trying to play audio in Go, asynchronously, using PortAudio. As far as I'm aware PortAudio handles its own threading, so I don't need to use any of Go's build-in concurrency stuff. I'm using libsndfile to load the file (also Go bindings). Here is my code:</p>\n\n<pre><code>type Track struct {\n    stream   *portaudio.Stream\n    playhead int\n    buffer   []int32\n}\n\nfunc LoadTrackFilesize(filename string, loop bool, bytes int) *Track {\n    // Load file\n    var info sndfile.Info\n    soundFile, err := sndfile.Open(filename, sndfile.Read, &amp;info)\n    if err != nil {\n        fmt.Printf(\"Could not open file: %s\\n\", filename)\n        panic(err)\n    }\n    buffer := make([]int32, bytes)\n    numRead, err := soundFile.ReadItems(buffer)\n    if err != nil {\n        fmt.Printf(\"Error reading from file: %s\\n\", filename)\n        panic(err)\n    }\n    defer soundFile.Close()\n\n    // Create track\n    track := Track{\n        buffer: buffer[:numRead],\n    }\n\n    // Create stream\n    stream, err := portaudio.OpenDefaultStream(\n        0, 2, float64(44100), portaudio.FramesPerBufferUnspecified, track.playCallback,\n    )\n    if err != nil {\n        fmt.Printf(\"Couldn't get stream for file: %s\\n\", filename)\n    }\n    track.stream = stream\n\n    return &amp;track\n}\n\nfunc (t *Track) playCallback(out []int32) {\n    for i := range out {\n        out[i] = t.buffer[(t.playhead+i)%len(t.buffer)]\n    }\n    t.playhead += len(out) % len(t.buffer)\n}\n\nfunc (t *Track) Play() {\n    t.stream.Start()\n}\n</code></pre>\n\n<p>Using these functions, after initialising PortAudio and all the rest, plays the audio track I supply - just. It's <em>very</em> laggy, and slows down the rest of my application (a game loop).</p>\n\n<p>However, if I change the frames per buffer value from <code>FramesPerBufferUnspecified</code> to something high, say, 1024, the audio plays fine and doesn't interfere with the rest of my application.</p>\n\n<p>Why is this? The PortAudio documentation suggests that using the unspecified value will 'choose a value for optimum latency', but I'm definitely not seeing that.</p>\n\n<p>Additionally, when playing with this very high value, I notice some tiny artefacts - little 'popping' noises - in the audio.</p>\n\n<p>Is there something wrong with my callback function, or anything else, that could be causing one or both of these problems?</p>\n\n<p>I'm using OSX 10.10.5, with Go 1.3.3 and the libsndfile and portaudio from Homebrew.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1441063721, "post_id": 32319424, "comment_id": 52517832, "body": "Try to catch error from <code>c.Bind()</code> call and print it to the screen. Probably there is an error, and reservations are empty, thus Insert() is failing. Also, why some of the fields have &#39;bson&#39; tag, and others don&#39;t?"}], "answers": [{"comments": [{"owner": {"reputation": 936, "user_id": 3473483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDHex.jpg?s=128&g=1", "display_name": "CABascourt", "link": "https://stackoverflow.com/users/3473483/cabascourt"}, "edited": false, "score": 0, "creation_date": 1441111151, "post_id": 32321776, "comment_id": 52537783, "body": "yes Im trying to insert multiple objects at a time..I tried inserting one at a time using a foreach and it works...something like this :                        for _, reserv := range reservations {            err := x.Insert(&amp;Reservation{Date: reserv.Date, From: reserv.From, To: reserv.To, Office: reserv.Office, Client_id: reserv.Client_id})                          if err != nil {                   panic(err)             }        }"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 936, "user_id": 3473483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDHex.jpg?s=128&g=1", "display_name": "CABascourt", "link": "https://stackoverflow.com/users/3473483/cabascourt"}, "edited": false, "score": 0, "creation_date": 1441153018, "post_id": 32321776, "comment_id": 52559923, "body": "You should be able to do it with a single call to Insert(), as I suggest in the answer.  The <code>...</code> syntax calls the method as if each element of the slice was passed as a separate argument."}, {"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1550725161, "post_id": 32321776, "comment_id": 96376233, "body": "the above is not working for me throwing error like <code>insert.documents.0&#39; is the wrong type &#39;array&#39;, expected type &#39;object&#39;</code>"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 4, "last_activity_date": 1441066900, "creation_date": 1441066900, "answer_id": 32321776, "question_id": 32319424, "link": "https://stackoverflow.com/questions/32319424/inserting-isodate-field-using-mgo-error/32321776#32321776", "title": "Inserting ISODate field using mgo error", "body": "<p>From the look of the error, MongoDB is seeing an array where it expects to see a single object.  It looks like the problem is that you're trying to insert the <code>[]Reservation</code> slice as a single object.</p>\n\n<p>Rather than taking a slice of objects to insert, <a href=\"http://godoc.org/gopkg.in/mgo.v2#Collection.Insert\" rel=\"nofollow\"><code>Collection.Insert</code></a> takes each object to insert as a separate argument.  You probably want to use <a href=\"http://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow\">the special <code>...</code> syntax for calling a variadic function</a>:</p>\n\n<pre><code>err := x.Insert(reservations...)\n</code></pre>\n"}], "owner": {"reputation": 936, "user_id": 3473483, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hDHex.jpg?s=128&g=1", "display_name": "CABascourt", "link": "https://stackoverflow.com/users/3473483/cabascourt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2019, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441070286, "creation_date": 1441052813, "last_edit_date": 1441070286, "question_id": 32319424, "link": "https://stackoverflow.com/questions/32319424/inserting-isodate-field-using-mgo-error", "title": "Inserting ISODate field using mgo error", "body": "<p>I'm really new in using go, mgo and gin gonic ...I've been creating a mini app and I have a problem inserting a new register into mongoDB using mgo. My error says:</p>\n\n<blockquote>\n  <p>\"PANIC: error parsing element 0 of field documents :: caused by ::\n  wrong type for '0' field, expected object, found 0: [ { date: new\n  Date(1441051152939), from: \"11\", to: \"12\", office: \"2\", client_id:\n  \"1368465545\" } ]_\"</p>\n</blockquote>\n\n<p>My struct is the next one:</p>\n\n<pre><code>type Reservation struct {\n      ID        bson.ObjectId `bson:\"_id,omitempty\" json:\"_id\"`\n      Date      time.Time     `bson:\"date\" json:\"date\"`\n      From      string        `bson:\"from\" json:\"from\"`\n      To        string        `json:\"to\"`\n      Office     string       `json:\"office\"`\n      Client_id string        `json:\"client_id\"` }\n</code></pre>\n\n<p>And I'm trying to insert it as follows using gin-gonic and mgo:</p>\n\n<pre><code>    func addReservation(c *gin.Context) {\n\n          x := session.DB(\"projXXXX\").C(\"reservation\")\n          var reservations []Reservation\n          c.Bind(&amp;reservations)&gt;             \n          err := x.Insert(&amp;reservations)\n          if err != nil {\n                panic(err)\n          }\n          c.String(200,\"whatever\")  \n}\n</code></pre>\n\n<p>My collection in mongoDB is like this:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"55ba2e611cb87b9a6d75e94b\"),\n    \"date\" : ISODate(\"2015-10-22T00:00:00.000Z\"),\n    \"from\" : \"9\",\n    \"to\" : \"10\",\n    \"office\" : \"4\",\n    \"client_id\" : \"1123456469797\"\n}\n</code></pre>\n\n<p>Thanks a lot for your help</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 10, "last_activity_date": 1441049987, "last_edit_date": 1441049987, "creation_date": 1441049504, "answer_id": 32318606, "question_id": 32318583, "link": "https://stackoverflow.com/questions/32318583/golang-print-nil/32318606#32318606", "title": "Golang print &quot;nil&quot;", "body": "<p>The <code>fmt</code> package uses reflection to determine what to print. Since the type of <code>z</code> is a slice, <code>fmt</code> uses the <code>[]</code> notation.</p>\n\n<p>Since slices, channels, interfaces and pointers can all be nil, it helpful if <code>fmt</code> prints something different when it can. If you want more context, use the <code>%v</code> format: <a href=\"http://play.golang.org/p/I1SAVzlv9f\">http://play.golang.org/p/I1SAVzlv9f</a></p>\n\n<pre><code>var a []int\nvar b chan int\nvar c *int\nvar e error\nfmt.Printf(\"a:%#v\\n\", a)\nfmt.Printf(\"b:%#v\\n\", b)\nfmt.Printf(\"c:%#v\\n\", c)\nfmt.Printf(\"e:%#v\\n\", e)\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>a:[]int(nil)\nb:(chan int)(nil)\nc:(*int)(nil)\ne:&lt;nil&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 607, "user_id": 6001349, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PTE_eA98cOE/AAAAAAAAAAI/AAAAAAAAACI/GhBOo8gJQbU/photo.jpg?sz=128", "display_name": "harold ramos", "link": "https://stackoverflow.com/users/6001349/harold-ramos"}, "is_accepted": false, "score": -1, "last_activity_date": 1463532432, "creation_date": 1463532432, "answer_id": 37288422, "question_id": 32318583, "link": "https://stackoverflow.com/questions/32318583/golang-print-nil/37288422#37288422", "title": "Golang print &quot;nil&quot;", "body": "<p>The word nil means : not initialized.\nIn this case you are initializing  the slide but no values have bean assigned yet.\nRemember PICS (Pointers, Interfaces, CHANNELS , and SLIDES )are all already\ninitialized.</p>\n"}], "owner": {"reputation": 577, "user_id": 1075870, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5ee326c803355a02b32c266c5830a167?s=128&d=identicon&r=PG", "display_name": "otm", "link": "https://stackoverflow.com/users/1075870/otm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6247, "favorite_count": 0, "accepted_answer_id": 32318606, "answer_count": 2, "score": 1, "last_activity_date": 1463532432, "creation_date": 1441049407, "question_id": 32318583, "link": "https://stackoverflow.com/questions/32318583/golang-print-nil", "title": "Golang print &quot;nil&quot;", "body": "<p>i am reading the golang tutorial: <a href=\"https://tour.golang.org/moretypes/10\" rel=\"nofollow\">https://tour.golang.org/moretypes/10</a>\nAnd i am confused about how <code>fmt.Println</code> prints the <code>nil</code> value, hope you could help me out.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    var z []int\n    fmt.Println(\"z: \", z)\n    if z == nil {\n        fmt.Println(\"z is nil!\")\n    } \n    fmt.Println(\"nil:\", nil)\n}\n</code></pre>\n\n<p>the result is:</p>\n\n<pre><code>z:  []\nz is nil!\nnil: &lt;nil&gt;\n</code></pre>\n\n<p>Since z is a nil, why is z printed as <code>[]</code> but not <code>&lt;nil&gt;</code>?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441038691, "post_id": 32315648, "comment_id": 52506640, "body": "I don&#39;t understand, you&#39;re setting a 100ms timeout, and hitting that timeout when there&#39;s no message, which seems to work as intended. Are you sending a message within that 100ms? Are you sure you want to retry <i>and</i> PING 10 times per second?"}, {"owner": {"reputation": 1611, "user_id": 1331805, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7985acb19e3ef9ba868d32397ef1e5f2?s=128&d=identicon&r=PG", "display_name": "GeoffreyB", "link": "https://stackoverflow.com/users/1331805/geoffreyb"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441096807, "post_id": 32315648, "comment_id": 52528592, "body": "I just took their example to see how it works, and adapt it to my needs afterwards"}], "answers": [{"comments": [{"owner": {"reputation": 1611, "user_id": 1331805, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7985acb19e3ef9ba868d32397ef1e5f2?s=128&d=identicon&r=PG", "display_name": "GeoffreyB", "link": "https://stackoverflow.com/users/1331805/geoffreyb"}, "edited": false, "score": 0, "creation_date": 1441097358, "post_id": 32319061, "comment_id": 52528941, "body": "Switching to <code>Receive</code> did the trick. Next time I&#39;ll read the docs! Thanks"}], "tags": [], "owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "is_accepted": true, "score": 4, "last_activity_date": 1441051394, "creation_date": 1441051394, "answer_id": 32319061, "question_id": 32315648, "link": "https://stackoverflow.com/questions/32315648/golang-redis-pubsub-timeout/32319061#32319061", "title": "Golang Redis PubSub timeout", "body": "<p>Some things to note:</p>\n\n<ul>\n<li>(implementation detail) When redis goes into PubSub mode, the only thing that happens on that socket afterwards is PubSub events, which is why PubSub in go-redis is abstracted into its own type</li>\n<li>A PubSub client can potentially subscribe to multiple topics in a single subscriber, hence why there are subscribe/unsubscribe events throughout.</li>\n<li>the interface has both <code>Receive()</code> and <code>ReceiveTimeout(duration)</code> methods, both of which return the next <em>event</em> on the wire; which can be subscribe/unsubscribe events and message events;  (you don't necessarily know which) the only difference between them that Receive blocks forever until there's a new message, and ReceiveTimeout will error on timeout.</li>\n</ul>\n\n<p>With that in mind, unless you have messages far more than 10/second consistently (in other words, &lt;100 milliseconds between messages), it's inefficient to use that short of a timeout; and I'd argue that due to golang having goroutines, you should almost never use <code>ReceiveTimeout</code> for real applications, or use a sufficiently long timeout like a minute.</p>\n\n<p>with that in mind, your receive loop should look like:</p>\n\n<pre><code>    for {\n        msgi, err := this.PubSub.Receive()\n        if err != nil {\n            Logger.Error(nil, \"PubSub error:\", err.Error())\n            return err\n        }\n        switch msg := msgi.(type) {\n            case *_redis.Message:\n                Logger.Log(nil, \"Received\", msg.Payload, \"on channel\", msg.Channel)\n            default:\n                Logger.Log(nil, \"Got control message\", msg)\n        }\n    }\n</code></pre>\n\n<p>If your application really warranted using a timeout, then you should use a type assertion to assert the <code>*net.OpError</code> that signifies a timeout and distinguish it from other more serious errors.</p>\n"}], "owner": {"reputation": 1611, "user_id": 1331805, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7985acb19e3ef9ba868d32397ef1e5f2?s=128&d=identicon&r=PG", "display_name": "GeoffreyB", "link": "https://stackoverflow.com/users/1331805/geoffreyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3746, "favorite_count": 1, "accepted_answer_id": 32319061, "answer_count": 1, "score": 0, "last_activity_date": 1441051394, "creation_date": 1441037985, "question_id": 32315648, "link": "https://stackoverflow.com/questions/32315648/golang-redis-pubsub-timeout", "title": "Golang Redis PubSub timeout", "body": "<p>So far I've been doing this:</p>\n\n<pre><code>import (\n    _redis \"gopkg.in/redis.v3\"\n    \"strconv\"\n    \"time\"\n)\n\ntype Redis struct {\n    Connector   *_redis.Client\n    PubSub      *_redis.PubSub\n}\n\nvar redis *Redis = nil\n\nfunc NewRedis() bool {\n    if redis == nil {\n        redis = new(Redis)\n        redis.Connector = _redis.NewClient(&amp;_redis.Options{\n            Addr: config.RedisHostname + \":\" + strconv.FormatInt(config.RedisPort, 10),\n            Password: \"\",\n            DB: 0,\n        })\n        Logger.Log(nil, \"Connected to Redis\")\n        err := redis.Init()\n        if err != nil {\n            Logger.Fatal(nil, \"Cannot setup Redis:\", err.Error())\n            return false\n        }\n        return true\n    }\n    return false\n}\n\nfunc (this *Redis) Init() error {\n    pubsub, err := this.Connector.Subscribe(\"test\")\n    if err != nil {\n        return err\n    }\n    defer pubsub.Close()\n    this.PubSub = pubsub\n    for {\n        msgi, err := this.PubSub.ReceiveTimeout(100 * time.Millisecond)\n        if err != nil {\n            Logger.Error(nil, \"PubSub error:\", err.Error())\n            err = this.PubSub.Ping(\"\")\n            if err != nil {\n                Logger.Error(nil, \"PubSub failure:\", err.Error())\n                break\n            }\n            continue\n        }\n        switch msg := msgi.(type) {\n            case *_redis.Message:\n                Logger.Log(nil, \"Received\", msg.Payload, \"on channel\", msg.Channel)\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>My Connector is a redis.Client, it's working because I was able to publish messages as well.</p>\n\n<p>When I run my program, I get the following error:\n<code>PubSub error: WSARecv tcp 127.0.0.1:64505: i/o timeout</code></p>\n\n<p>Do you have any idea of what I'm doing wrong ? I'm using this package: <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow\">https://github.com/go-redis/redis</a></p>\n"}, {"tags": ["file-upload", "go", "beego"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441027443, "post_id": 32310838, "comment_id": 52499701, "body": "If the request isn&#39;t hitting the server, this code is being executed at all, so there&#39;s not much we can help with. Also not sure what beego has to do with this, since you&#39;re not importing or using beego for anything."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441027895, "post_id": 32310838, "comment_id": 52499984, "body": "You&#39;re ignoring the error from <code>http.ListenAndServer</code>, are you certain that you&#39;re only running one server?"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441082009, "post_id": 32310838, "comment_id": 52521804, "body": "@JimB, yes only one server is running"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441115261, "post_id": 32310838, "comment_id": 52540867, "body": "You&#39;re naming the new file <code>uploadfile</code>. What doesn&#39;t work if you use the file name instead?"}, {"owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1441264719, "post_id": 32310838, "comment_id": 52610202, "body": "it will show no permission.. since its just directory without uploadFile"}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 307826, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YiVIy.jpg?s=128&g=1", "display_name": "Stef K", "link": "https://stackoverflow.com/users/307826/stef-k"}, "is_accepted": false, "score": 6, "last_activity_date": 1441436913, "creation_date": 1441436913, "answer_id": 32410485, "question_id": 32310838, "link": "https://stackoverflow.com/questions/32310838/upload-file-with-same-format-using-beego/32410485#32410485", "title": "upload file with same format using beego", "body": "<p>You are not using a Beego controller to handle the upload</p>\n\n<pre><code>package controllers\n\nimport (\n        \"github.com/astaxie/beego\"\n)\n\ntype MainController struct {\n        beego.Controller\n}\n\nfunction (this *MainController) GetFiles() {\n    this.TplNames = \"aTemplateFile.html\"\n\n    file, header, er := this.GetFile(\"file\") // where &lt;&lt;this&gt;&gt; is the controller and &lt;&lt;file&gt;&gt; the id of your form field\n    if file != nil {\n        // get the filename\n        fileName := header.Filename\n        // save to server\n        err := this.SaveToFile(\"file\", somePathOnServer)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2920, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441436913, "creation_date": 1441022708, "last_edit_date": 1441088393, "question_id": 32310838, "link": "https://stackoverflow.com/questions/32310838/upload-file-with-same-format-using-beego", "title": "upload file with same format using beego", "body": "<p>File Uploading is done but not with the same name as filename \ni have tried this in html file</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;html&gt;\r\n &lt;title&gt;Go upload&lt;/title&gt;\r\n &lt;body&gt;\r\n\r\n &lt;form action=\"http://localhost:8080/receive\" method=\"post\" enctype=\"multipart/form-data\"&gt;\r\n &lt;label for=\"file\"&gt;Filename:&lt;/label&gt;\r\n &lt;input type=\"file\" name=\"file\" id=\"file\"&gt;\r\n &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\r\n &lt;/form&gt;\r\n\r\n &lt;/body&gt;\r\n &lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>and in beego/go receive.go</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>package main\r\n\r\nimport (\r\n\t\"fmt\"\r\n\t\"io\"\r\n\t\"net/http\"\r\n\t\"os\"\r\n)\r\n\r\nfunc uploadHandler(w http.ResponseWriter, r *http.Request) {\r\n\r\n\t// the FormFile function takes in the POST input id file\r\n\tfile, header, err := r.FormFile(\"file\")\r\n\r\n\tif err != nil {\r\n\t\tfmt.Fprintln(w, err)\r\n\t\treturn\r\n\t}\r\n\r\n\tdefer file.Close()\r\n\r\n\tout, err := os.Create(\"/home/vijay/Desktop/uploadfile\")\r\n\tif err != nil {\r\n\t\tfmt.Fprintf(w, \"Unable to create the file for writing. Check your write access privilege\")\r\n\t\treturn\r\n\t}\r\n\r\n\tdefer out.Close()\r\n\r\n\t// write the content from POST to the file\r\n\t_, err = io.Copy(out, file)\r\n\tif err != nil {\r\n\t\tfmt.Fprintln(w, err)\r\n\t}\r\n\r\n\tfmt.Fprintf(w, \"File uploaded successfully : \")\r\n\tfmt.Fprintf(w, header.Filename)\r\n}\r\n\r\nfunc main() {\r\n\thttp.HandleFunc(\"/\", uploadHandler)\r\n\thttp.ListenAndServe(\":8080\", nil)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>i am able to achieve uploading file here with same format... but not with the same name..\nnow i want this file to be uploaded with same name as file name</p>\n"}, {"tags": ["templates", "go"], "comments": [{"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1494412163, "post_id": 32309830, "comment_id": 74813546, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/25745701/parseglob-what-is-the-pattern-to-parse-all-templates-recursively-within-a-direc\">ParseGlob: What is the pattern to parse all templates recursively within a directory?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "edited": false, "score": 0, "creation_date": 1441021838, "post_id": 32310472, "comment_id": 52496091, "body": "Thanks for the clarification."}, {"owner": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1590927561, "post_id": 32310472, "comment_id": 109860188, "body": "pattern: \t{ term } term: \t&#39;<i>&#39;         matches any sequence of non-Separator characters \t&#39;?&#39;         matches any single non-Separator character \t&#39;[&#39; [ &#39;^&#39; ] { character-range } &#39;]&#39; \t            character class (must be non-empty) \tc           matches character c (c != &#39;</i>&#39;, &#39;?&#39;, &#39;\\\\&#39;, &#39;[&#39;) \t&#39;\\\\&#39; c      matches character c  character-range: \tc           matches character c (c != &#39;\\\\&#39;, &#39;-&#39;, &#39;]&#39;) \t&#39;\\\\&#39; c      matches character c \tlo &#39;-&#39; hi   matches character c for lo &lt;= c &lt;= hi"}, {"owner": {"reputation": 2672, "user_id": 9208887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64b42a62830357a073f912ce786822e1?s=128&d=identicon&r=PG&f=1", "display_name": "The Fool", "link": "https://stackoverflow.com/users/9208887/the-fool"}, "edited": false, "score": 0, "creation_date": 1590927588, "post_id": 32310472, "comment_id": 109860195, "body": "what does it even mean?"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 4, "last_activity_date": 1441021497, "creation_date": 1441021497, "answer_id": 32310472, "question_id": 32309830, "link": "https://stackoverflow.com/questions/32309830/can-template-parseglob-parse-templates-in-subdirectories/32310472#32310472", "title": "Can template.ParseGlob() parse templates in subdirectories?", "body": "<p>No it cannot.</p>\n\n<p>The documentation is pretty clear here: Globbing for <code>template.ParseGlob</code> works like in <code>filepath.Glob</code> and <code>filepath.Glob</code> uses the syntax of <code>filepath.Match</code> (<a href=\"https://godoc.org/path/filepath#Match\" rel=\"nofollow\">https://godoc.org/path/filepath#Match</a>) which has no <code>**</code> for a deep match.</p>\n\n<p>(It <em>really</em> helps to read the documentation carefully.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14593180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QdZof.jpg?s=128&g=1", "display_name": "Reindert Vetter", "link": "https://stackoverflow.com/users/14593180/reindert-vetter"}, "is_accepted": false, "score": 0, "last_activity_date": 1604702942, "creation_date": 1604702942, "answer_id": 64722575, "question_id": 32309830, "link": "https://stackoverflow.com/questions/32309830/can-template-parseglob-parse-templates-in-subdirectories/64722575#64722575", "title": "Can template.ParseGlob() parse templates in subdirectories?", "body": "<p>You can load multiple subdirectories this way. Here we ignore if subdirectories do not exist. But we want to make sure that the first directory with templates can be loaded.</p>\n<pre><code>func ParseTemplates() (*template.Template, error) {\n    templateBuilder := template.New(&quot;&quot;)\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    if t, _ := templateBuilder.ParseGlob(&quot;/*/*.tmpl&quot;); t != nil {\n        templateBuilder = t\n    }\n    return templateBuilder.ParseGlob(&quot;/*.tmpl&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 1424, "user_id": 3147268, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/1f90d4a9d7382ddd2447f782a65ba008?s=128&d=identicon&r=PG&f=1", "display_name": "user3147268", "link": "https://stackoverflow.com/users/3147268/user3147268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1808, "favorite_count": 0, "accepted_answer_id": 32310472, "answer_count": 2, "score": 2, "last_activity_date": 1610531576, "creation_date": 1441019248, "last_edit_date": 1441369265, "question_id": 32309830, "link": "https://stackoverflow.com/questions/32309830/can-template-parseglob-parse-templates-in-subdirectories", "title": "Can template.ParseGlob() parse templates in subdirectories?", "body": "<p>To clean up the template folder I would like to save common templates inside a subfolder. Currently I've the following file structure:</p>\n\n<pre><code>main.go\ntemplates/index.tpl            # Main template for the main page\ntemplates/includes/head.tpl\ntemplates/includes/footer.tpl\n</code></pre>\n\n<p><code>head.tpl</code> and <code>footer.tpl</code> will be called within <code>index.tpl</code>, which looks like this:</p>\n\n<pre><code>{{ template \"head\" . }}\n    &lt;h1&gt;My content&lt;/h1&gt;\n{{ template \"footer\" .}}\n</code></pre>\n\n<p>Furthermore the files are parsed using <code>template.ParseGlob()</code>. Here's an excerpt from <code>main.go</code>:</p>\n\n<pre><code>var views = template.Must(template.ParseGlob(\"src/templates/**/*\"))\n\nfunc Render(rw http.ResponseWriter, temp string, data interface{}) {\n    err := views.ExecuteTemplate(rw, temp, data)\n\n    if err != nil {\n        http.Error(rw, err.Error(), http.StatusInternalServerError)\n    }\n}\n\nfunc Index(rw http.ResponseWriter, req *http.Request) {\n    Render(rw, \"index.tpl\", nil)\n}\n</code></pre>\n\n<p>Everytime I open my browser I get this  error message: <code>html/template: \"index.tpl\" is undefined</code>.</p>\n\n<p>Is it possible, that <code>index.tpl</code> is ignored with this glob pattern? \nI found <a href=\"http://grokbase.com/t/gg/golang-nuts/137tj3axkn/go-nuts-template-parseglob-pattern-to-parse-all-files-in-a-directory-recursively\" rel=\"nofollow\">this</a> similar question, but the answers present only a work around.</p>\n"}, {"tags": ["go", "cross-compiling", "libgit2", "cgo", "gccgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1441033013, "post_id": 32309030, "comment_id": 52503419, "body": "Setting up arch linux on qemu or virtualbox should be trivial to compile for linux, and you can follow <i>my</i> <a href=\"http://www.limitlessfx.com/cross-compile-golang-app-for-windows-from-linux.html\" rel=\"nofollow noreferrer\">guide</a> to cross-compile from there to windows."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1441033094, "post_id": 32309030, "comment_id": 52503473, "body": "You probably want to skip up to the last compile step if you&#39;re using 1.5."}, {"owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1442982128, "post_id": 32309030, "comment_id": 53303551, "body": "@OneOfOne your comment helped alot, it&#39;s fairly easy to cross compile for Windows from a Linux container. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 5127, "user_id": 6449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda08117336cfde6562315df04b976e8?s=128&d=identicon&r=PG", "display_name": "Dave Cheney", "link": "https://stackoverflow.com/users/6449/dave-cheney"}, "is_accepted": true, "score": 11, "last_activity_date": 1441020570, "creation_date": 1441020570, "answer_id": 32310182, "question_id": 32309030, "link": "https://stackoverflow.com/questions/32309030/go-1-5-cross-compile-using-cgo-on-os-x-to-linux-and-windows/32310182#32310182", "title": "go 1.5 cross compile using cgo on OS X to linux and windows", "body": "<p>cgo is not enabled by default when cross compiling. If you enable cgo, with CGO_ENABLED=1 you will need to have a cross compiling c compiler for the target machine. This is non trivial.</p>\n\n<p>I recommend, if you need cgo, to compile natively.</p>\n"}, {"tags": [], "owner": {"reputation": 1229, "user_id": 1316499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b4c6fd1a383d486b48c254b6d5a480c?s=128&d=identicon&r=PG", "display_name": "Astockwell", "link": "https://stackoverflow.com/users/1316499/astockwell"}, "is_accepted": false, "score": 1, "last_activity_date": 1454815800, "creation_date": 1454815800, "answer_id": 35249386, "question_id": 32309030, "link": "https://stackoverflow.com/questions/32309030/go-1-5-cross-compile-using-cgo-on-os-x-to-linux-and-windows/35249386#35249386", "title": "go 1.5 cross compile using cgo on OS X to linux and windows", "body": "<p>If you need cgo cross compilation, I'd point you to <a href=\"https://github.com/karalabe/xgo\" rel=\"nofollow\">xgo</a>, which I found immensely helpful. It didn't work in 100% of my use cases, but with some minor (compared to maintaining native VMs for cross-compiling) changes to my code, it was sufficient.</p>\n"}], "owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5550, "favorite_count": 1, "accepted_answer_id": 32310182, "answer_count": 2, "score": 8, "last_activity_date": 1454815800, "creation_date": 1441016449, "last_edit_date": 1441017295, "question_id": 32309030, "link": "https://stackoverflow.com/questions/32309030/go-1-5-cross-compile-using-cgo-on-os-x-to-linux-and-windows", "title": "go 1.5 cross compile using cgo on OS X to linux and windows", "body": "<p>I'm having trouble compiling the <a href=\"https://github.com/libgit2/git2go\" rel=\"noreferrer\"><code>git2go</code></a> library on OS X to linux amd64 after upgrading go 1.4.2 to go 1.5.</p>\n\n<p>I think this is about cross compiling any go app that uses C code with go 1.5.</p>\n\n\n\n<p>Using <code>CGO_ENABLED=1</code>, I get:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ CGO_ENABLED=1 GOOS=linux GOARCH=amd64 ./script/with-static.sh go install ./...\n# runtime/cgo\nld: unknown option: --build-id=none\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Using <code>-compiler=gccgo</code>, I get:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ GOOS=linux GOARCH=amd64 ./script/with-static.sh go install -compiler gccgo ./...\ngo build github.com/libgit2/git2go: : fork/exec : no such file or directory\n</code></pre>\n\n<p>If not supplying any of those, I get:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ GOOS=linux GOARCH=amd64 ./script/with-static.sh go install ./...\ncan't load package: package github.com/libgit2/git2go: C source files not allowed when not using cgo or SWIG: wrapper.c\n</code></pre>\n\n<p>I installed go using homebrew, and I have the <code>$GOPATH</code> pointing to the default <code>~/go</code> location, nothing fancy.</p>\n"}, {"tags": ["json", "google-app-engine", "go", "google-cloud-endpoints"], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 3599936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9534bef06c3f3e2c9e9e72944f2261e5?s=128&d=identicon&r=PG", "display_name": "Jonathan Pick", "link": "https://stackoverflow.com/users/3599936/jonathan-pick"}, "edited": false, "score": 0, "creation_date": 1441030354, "post_id": 32312032, "comment_id": 52501698, "body": "Password  string <code>json:&quot;password,omitempty&quot; datastore:&quot;Password&quot; endpoints:&quot;req,desc=The business password&quot;</code>  this is what i use but the param still gose out included in the json .."}], "tags": [], "owner": {"reputation": 4544, "user_id": 1337127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88c5c900e5e61ec5d73e63fbb1f8242d?s=128&d=identicon&r=PG", "display_name": "Mark Doyle", "link": "https://stackoverflow.com/users/1337127/mark-doyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1441114624, "last_edit_date": 1441114624, "creation_date": 1441026401, "answer_id": 32312032, "question_id": 32308562, "link": "https://stackoverflow.com/questions/32308562/golang-appengine-outgoing-json/32312032#32312032", "title": "golang appengine outgoing json", "body": "<p>Maybe you would like to try one or a combination of the following approaches:</p>\n\n<ul>\n<li><strong>Tag</strong> of \"-\" so that the field is ignored.  e.g. <code>json:\"-\"</code></li>\n<li><strong>omitempty</strong> can be included in your 'json:' and will cause the field not to be included in the resulting json.  So you could set the fields you want to hide to nil, prior to serializing to json.  e.g. <code>json:\"myName,omitempty\"</code></li>\n<li><strong>copier</strong> - there are some projects like: <a href=\"http://github.com/jinzhu/copier\" rel=\"nofollow\">jinzhu's copier</a> that would allow you to copy your entity to a simplified structure, or you could roll your own.  (a combination of JSON un-marshalling and marshalling can produce similar results).</li>\n</ul>\n\n<p>For more details about the JSON package see <a href=\"http://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">Golang Json marshal docs</a></p>\n"}], "owner": {"reputation": 71, "user_id": 3599936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9534bef06c3f3e2c9e9e72944f2261e5?s=128&d=identicon&r=PG", "display_name": "Jonathan Pick", "link": "https://stackoverflow.com/users/3599936/jonathan-pick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441114624, "creation_date": 1441015001, "last_edit_date": 1441015652, "question_id": 32308562, "link": "https://stackoverflow.com/questions/32308562/golang-appengine-outgoing-json", "title": "golang appengine outgoing json", "body": "<p>So I run golang appengine with go endpoints package ... </p>\n\n<p>I use structs to marshal and un marshal my json incoming requests and out going responses .. </p>\n\n<pre><code>type BusinessWorker struct {\n    Wid   string `json:\"wid\" datastore:\"Worker_id\" endpoints:\"req,desc=Worker id. string value\"`\n    Phone string `json:\"phone\" datastore:\"Phone\" endpoints:\"req,desc=Worker phone number. string value\"`\n}\n</code></pre>\n\n<p>So as you can see after I validate the data this obj is saved or loaded to/from the datastore .. </p>\n\n<p>My question is .. \nthere are many cases I dont want to respond with all my data that is saved in the datastore .. is there some sort of attribute that I can give to the param that i dont wanna include in my response only in my incoming requests ? </p>\n\n<p>It seems so elementary .. and I cant find it .. ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1441004580, "post_id": 32305176, "comment_id": 52486865, "body": "@Ainar-G They differ slightly in whether you assert to another interface (as in this case) or to a non-interface type (as in the other question)"}], "answers": [{"tags": [], "owner": {"reputation": 59918, "user_id": 694331, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/gxxid.png?s=128&g=1", "display_name": "ANisus", "link": "https://stackoverflow.com/users/694331/anisus"}, "is_accepted": true, "score": 6, "last_activity_date": 1441019286, "last_edit_date": 1441019286, "creation_date": 1441004356, "answer_id": 32305551, "question_id": 32305176, "link": "https://stackoverflow.com/questions/32305176/wrap-it-in-a-bufio-newreader-if-it-doesnt-support-readbyte-pattern/32305551#32305551", "title": "&quot;wrap it in a bufio.NewReader if it doesn&#39;t support ReadByte&quot; pattern", "body": "<p><code>r.(byteReader)</code> is called a <em>type assertion</em>. Even if <code>io.Reader</code> doesn't implement the <code>byteReader</code> interface in itself, it it still possible that the value stored in <code>r</code> might implement <code>byteReader</code>. So, by doing the type assertion, you can assert if that is the case:</p>\n\n<p><a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">The specification</a> states:</p>\n\n<blockquote>\n  <p>x.(T) asserts that x is not nil and that the value stored in x is of\n  type T. The notation x.(T) is called a type assertion.<br>\n  ...<br>\n  If T is\n  an interface type, x.(T) asserts that the dynamic type of x implements\n  the interface T.</p>\n</blockquote>\n\n<p><strong>Edit</strong></p>\n\n<p>The comment, <em>\"wrap it in a bufio.NewReader\"</em>, refers to <code>makeReader</code>'s provided <code>io.Reader</code>; if it doesn't implement <code>byteReader</code>, <code>makeReader</code> will wrap it in a <code>bufio.Reader</code> which does implement <code>bytesReader</code>, and return it instead.</p>\n"}], "owner": {"reputation": 1224, "user_id": 2052755, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/ec83e8c62d4ad62a26ab4ee7771177d1?s=128&d=identicon&r=PG", "display_name": "user31986", "link": "https://stackoverflow.com/users/2052755/user31986"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1441044954, "accepted_answer_id": 32305551, "answer_count": 1, "score": 1, "last_activity_date": 1441019286, "creation_date": 1441002823, "question_id": 32305176, "link": "https://stackoverflow.com/questions/32305176/wrap-it-in-a-bufio-newreader-if-it-doesnt-support-readbyte-pattern", "closed_reason": "Duplicate", "title": "&quot;wrap it in a bufio.NewReader if it doesn&#39;t support ReadByte&quot; pattern", "body": "<p>Following is a snippet from one of the Go libs. Could anyone please point out the significance of <code>r.(byteReader)</code>? The syntax usage is not very obvious to a novice. <code>byteReader</code> is a defined interface and does not seem to be the member of <code>io.Reader</code>. Since, this seems to be some kind of nifty code, can anyone provide some insight.</p>\n\n<p>The author mentions: \"wrap it in a bufio.NewReader if it doesn't support ReadByte\" pattern. <a href=\"https://github.com/dave-andersen/deltagolomb/blob/master/deltagolomb.go\" rel=\"nofollow\">https://github.com/dave-andersen/deltagolomb/blob/master/deltagolomb.go</a></p>\n\n<pre><code>type byteReader interface {\n    io.Reader\n    ReadByte() (c byte, err error)\n}\n\nfunc makeReader(r io.Reader) byteReader {\n    if rr, ok := r.(byteReader); ok {\n        return rr\n    }\n    return bufio.NewReader(r)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441041484, "post_id": 32303873, "comment_id": 52508102, "body": "Of course instead of <code>header.Typeflag = &#39;0&#39;</code> or <code>header.Typeflag = &#39;5&#39;</code> you should use <code>header.Typeflag = tar.TypeReg</code> and <code>header.Typeflag = tar.TypeDir</code> (and only if you want/need something different than what <a href=\"https://golang.org/pkg/archive/tar/#FileInfoHeader\" rel=\"nofollow noreferrer\"><code>tar.FileInfoHeader</code></a> will do for you)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 4459142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ooM1Ra_ttvI/AAAAAAAAAAI/AAAAAAAAAU4/GVUI94dk7fw/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/4459142/tim"}, "edited": false, "score": 0, "creation_date": 1441036294, "post_id": 32303936, "comment_id": 52505348, "body": "I am aware of that, I&#39;m not sure how to set it during tar&#39;ing files if I am passing 0 for file or 5 for directory."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 51, "user_id": 4459142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ooM1Ra_ttvI/AAAAAAAAAAI/AAAAAAAAAU4/GVUI94dk7fw/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/4459142/tim"}, "edited": false, "score": 0, "creation_date": 1441041209, "post_id": 32303936, "comment_id": 52507955, "body": "@Tim, I believe sberry is saying you shouldn&#39;t be building the <code>tar.Header</code> from scratch (i.e. don&#39;t use <code>header := new(tar.Header)</code>) but start with <code>header, err := tar.FileInfoHeader(fileInfo, name)</code> (where name is something like your <code>path.Join(dir.Name(), fileInfo.Name())</code>) and then only change the fields that doesn&#39;t fill in for you or that you want to override."}, {"owner": {"reputation": 51, "user_id": 4459142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ooM1Ra_ttvI/AAAAAAAAAAI/AAAAAAAAAU4/GVUI94dk7fw/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/4459142/tim"}, "edited": false, "score": 1, "creation_date": 1441060260, "post_id": 32303936, "comment_id": 52516896, "body": "I think that helps but I&#39;m still having issues <i>sigh</i>.  Apparently it&#39;s not walking hidden directories also."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1440994642, "creation_date": 1440994642, "answer_id": 32303936, "question_id": 32303873, "link": "https://stackoverflow.com/questions/32303873/tar-typeflag-directory-or-file-when-taring-directories-in-golang/32303936#32303936", "title": "tar typeflag directory or file when tar&#39;ing directories in golang", "body": "<p>If the files are on disk, which it looks like they are, then that part is done for you.  Have a look at <a href=\"https://golang.org/src/archive/tar/common.go?s=1401:2114#L198\" rel=\"nofollow\">FileInfoHeader</a>.  That will set the Typeflag based on what it can extrapolate from the resource (directory or file in your case.)</p>\n\n<p>For a complete list of the available options see <a href=\"http://www.gnu.org/software/tar/manual/html_node/Standard.html\" rel=\"nofollow\">the tar standard docs</a></p>\n"}], "owner": {"reputation": 51, "user_id": 4459142, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ooM1Ra_ttvI/AAAAAAAAAAI/AAAAAAAAAU4/GVUI94dk7fw/photo.jpg?sz=128", "display_name": "Tim", "link": "https://stackoverflow.com/users/4459142/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 907, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1440994642, "creation_date": 1440994205, "question_id": 32303873, "link": "https://stackoverflow.com/questions/32303873/tar-typeflag-directory-or-file-when-taring-directories-in-golang", "title": "tar typeflag directory or file when tar&#39;ing directories in golang", "body": "<p>I'm not sure how to set Header.Typeflag when tar'ing a directory with files and subdirectories.  I know if I add </p>\n\n<pre><code>header.Typeflag = '0'\n</code></pre>\n\n<p>It will only tar files but not directories.  How do I set the Typeflag when it is a file or directory so when untar'ing I can pass it in a case statement to tar.TypeDir</p>\n\n<p>Example taken from <a href=\"https://www.socketloop.com/tutorials/golang-archive-directory-with-tar-and-gzip\" rel=\"nofollow\">https://www.socketloop.com/tutorials/golang-archive-directory-with-tar-and-gzip</a></p>\n\n<pre><code>package main\n\n import (\n         \"archive/tar\"\n         \"compress/gzip\"\n         \"flag\"\n         \"fmt\"\n         \"io\"\n         \"os\"\n         \"strings\"\n         \"path/filepath\"\n )\n\n func checkerror(err error) {\n\n         if err != nil {\n                 fmt.Println(err)\n                 os.Exit(1)\n         }\n }\n\n func main() {\n\n         flag.Parse() // get the arguments from command line\n\n         destinationfile := flag.Arg(0)\n\n         if destinationfile == \"\" {\n                 fmt.Println(\"Usage : gotar destinationfile.tar.gz source\")\n                 os.Exit(1)\n         }\n\n         sourcedir := flag.Arg(1)\n\n         if sourcedir == \"\" {\n                 fmt.Println(\"Usage : gotar destinationfile.tar.gz source-directory\")\n                 os.Exit(1)\n         }\n\n         dir, err := os.Open(sourcedir)\n\n         checkerror(err)\n\n         defer dir.Close()\n\n         files, err := dir.Readdir(0) // grab the files list\n\n         checkerror(err)\n\n         tarfile, err := os.Create(destinationfile)\n\n         checkerror(err)\n\n         defer tarfile.Close()\n         var fileWriter io.WriteCloser = tarfile\n\n         if strings.HasSuffix(destinationfile, \".gz\") {\n                 fileWriter = gzip.NewWriter(tarfile) // add a gzip filter\n                 defer fileWriter.Close()            // if user add .gz in the destination filename\n         }\n\n         tarfileWriter := tar.NewWriter(fileWriter)\n         defer tarfileWriter.Close()\n\n         for _, fileInfo := range files {\n\n                 if fileInfo.IsDir() {\n                    continue\n                 }\n\n                 // see https://www.socketloop.com/tutorials/go-file-path-independent-of-operating-system\n\n                 file, err := os.Open(dir.Name() + string(filepath.Separator) + fileInfo.Name())\n\n                 checkerror(err)\n\n                 defer file.Close()\n\n\n                 // prepare the tar header\n\n                 header := new(tar.Header)\n                 header.Name = file.Name()\n                 header.Size = fileInfo.Size()\n                 header.Mode = int64(fileInfo.Mode())\n                 header.ModTime = fileInfo.ModTime()\n\n\n                 err = tarfileWriter.WriteHeader(header)\n\n                 checkerror(err)\n\n                 _, err = io.Copy(tarfileWriter, file)\n\n                 checkerror(err)\n         }\n\n }\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1441040800, "post_id": 32303655, "comment_id": 52507717, "body": "If you look at the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">specification of type assertions</a> you&#39;ll see your <code>convert</code> function is just <code>base, _ := conc.(Base)</code>. It will return the zero value (nil for a pointer) as appropriate. However, ignoring the boolean is rarely desired. If your code expects that it&#39;s the only thing adding elements then using <code>base := conc.(Base)</code> is appropriate. You want the runtime to panic when it detects a mistake in your code just as a failed slice/array bounds check will panic."}, {"owner": {"reputation": 354, "user_id": 607102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8959c1702ab20b4c16f06f674d6a94e6?s=128&d=identicon&r=PG", "display_name": "deathly809", "link": "https://stackoverflow.com/users/607102/deathly809"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441049607, "post_id": 32303655, "comment_id": 52512196, "body": "@DaveC The reason I have a method is because I call it in a few places.  If I change the underlying type I don&#39;t want to have to change it in a bunch of places.  The only reason I left the boolean check was because I liked how it looked."}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1441040483, "post_id": 32303656, "comment_id": 52507582, "body": "You almost never want to use a pointer to an interface. E.g. <code>*bytes.Buffer</code> (a pointer to a struct type) is common but <code>*io.Reader</code> is almost always a mistake. To really understand why might require reading something like: <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">Go Data Structures: Interfaces</a>."}, {"owner": {"reputation": 354, "user_id": 607102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8959c1702ab20b4c16f06f674d6a94e6?s=128&d=identicon&r=PG", "display_name": "deathly809", "link": "https://stackoverflow.com/users/607102/deathly809"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441050139, "post_id": 32303656, "comment_id": 52512469, "body": "@DaveC Thanks for the link will check it out.  The one thing that throws me is that if I want to convert a pointer to some struct to an interface then I don&#39;t keep it as a pointer.  The one question I have is what happens to the pointer part.  How can I convert from a pointer to a non-pointer type/interface?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441058146, "post_id": 32303656, "comment_id": 52516199, "body": "It&#39;s all explained at that link. The interface value will point to whatever the underlying type is and if that&#39;s <code>*Concrete</code> so be it. A pointer to an interface doesn&#39;t implement that interface (e.g. <code>func f(r io.Reader, rp *io.Reader)</code> can call <code>r.Read</code> but cannot call <code>rp.Read</code>)."}], "tags": [], "owner": {"reputation": 354, "user_id": 607102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8959c1702ab20b4c16f06f674d6a94e6?s=128&d=identicon&r=PG", "display_name": "deathly809", "link": "https://stackoverflow.com/users/607102/deathly809"}, "is_accepted": true, "score": 0, "last_activity_date": 1440992301, "creation_date": 1440992301, "answer_id": 32303656, "question_id": 32303655, "link": "https://stackoverflow.com/questions/32303655/in-go-given-an-interface-in-which-i-know-what-interface-it-implements-how-ca/32303656#32303656", "title": "In Go, Given an interface{} in which I know what interface it implements, how can I convert to it", "body": "<p>Now that I have finished writing this long explanation I had an idea and  figured out the solution:</p>\n\n<pre><code>func convert(val interface{}) Base {\n    if con,ok := val.(Base); ok {\n        return con\n    }\n    return nil\n}\n</code></pre>\n\n<p>Don't try to cast to a pointer but rather just the Base interface.  </p>\n\n<p>I am not sure why this is the case.  When I do reflect.TypeOf(val) inside of convert it gives the output</p>\n\n<pre><code>*main.Concrete\n</code></pre>\n\n<p>I hope that other people find this useful and that someone else can answer the <strong>why</strong> portion of this answer.</p>\n"}], "owner": {"reputation": 354, "user_id": 607102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8959c1702ab20b4c16f06f674d6a94e6?s=128&d=identicon&r=PG", "display_name": "deathly809", "link": "https://stackoverflow.com/users/607102/deathly809"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 32303656, "answer_count": 1, "score": 1, "last_activity_date": 1440993764, "creation_date": 1440992301, "last_edit_date": 1440993764, "question_id": 32303655, "link": "https://stackoverflow.com/questions/32303655/in-go-given-an-interface-in-which-i-know-what-interface-it-implements-how-ca", "title": "In Go, Given an interface{} in which I know what interface it implements, how can I convert to it", "body": "<p>My current problem is that I am implementing data-structures and I have written iterators for them.  I have visible interfaces for my data-structures, iterators, and all other required objects.  In the back I have concrete implementations which I wish to hide from the end user.</p>\n\n<p>This requires many of my functions to return interface{} objects so that I can store any type of object (and leave validation up to the end-user).</p>\n\n<p>One problem I have is that I iterate over a Graph.  My iterator{} for my graph implementation returns a concrete vertex type but the Iterator interface returns interface{}.  Since the end-users can only my base Vertex interface I have to try to convert to a Vertex interface so they can use it.</p>\n\n<p>Here is the smallest example that I could think of at this point which illustrates my issue:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\ntype Base interface {\n    Required() string\n}\n\ntype Concrete struct {\n    _data int\n}\nfunc (con *Concrete) Required() string {\n    return strconv.Itoa(con._data)\n}\n\nfunc convert(val interface{}) *Base {\n    if con,ok := val.(*Base); ok {\n        return con\n    }\n    return nil\n}\n\nfunc main() {\n    conc := new(Concrete)\n    conc._data = 5\n\n    base := convert(conc)\n\n    fmt.Println(base)\n}\n</code></pre>\n\n<p>In the code above I really wish that convert would convert the type to *Base.  The function convert will return the value nil instead of the lovely value I wish it to be.</p>\n\n<hr>\n\n<p>Edit: Removed unused code, I thought I had already removed it but I guess not.</p>\n"}, {"tags": ["redirect", "go", "https"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1440987418, "post_id": 32302777, "comment_id": 52482305, "body": "if you just want to fix this problem, i suggest to change the http package source."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1440994978, "post_id": 32302777, "comment_id": 52483823, "body": "I have a feeling something else is amiss here.  Not only does that request work from telnet / curl without a single redirect, but your example program (once I do something with response) works as well without any redirects.  Are you going through some sort of proxy perhaps and that is what is causing the redirects?"}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1441093573, "post_id": 32302777, "comment_id": 52526790, "body": "Does it work using curl?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1441031093, "post_id": 32303438, "comment_id": 52502193, "body": "He is getting a redirect-loop. Checking the redirects isn&#39;t going to prevent whatever is causing the server to send them."}, {"owner": {"reputation": 1209, "user_id": 83879, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5c4e03b2704fefb2529a2d63c744145f?s=128&d=identicon&r=PG", "display_name": "golliher", "link": "https://stackoverflow.com/users/83879/golliher"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1441032325, "post_id": 32303438, "comment_id": 52502965, "body": "Good point.   I had not thought about why he was running up against the default policy of 10 redirects.    I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 1209, "user_id": 83879, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5c4e03b2704fefb2529a2d63c744145f?s=128&d=identicon&r=PG", "display_name": "golliher", "link": "https://stackoverflow.com/users/83879/golliher"}, "is_accepted": false, "score": 0, "last_activity_date": 1441032630, "last_edit_date": 1441032630, "creation_date": 1440990265, "answer_id": 32303438, "question_id": 32302777, "link": "https://stackoverflow.com/questions/32302777/wikipedia-url-stopped-after-10-redirects-error-golang/32303438#32303438", "title": "Wikipedia url stopped after 10 redirects error GoLang", "body": "<p>As others have pointed out, you should first give thought to why you are encountering so many HTTP redirects.   Go's default policy of stopping at 10 redirects is reasonable.   More than 10 redirects could mean you are in a redirect loop.   That could be caused outside your code.  It could be induced by something about your network configuration, proxy servers between you and the website, etc.</p>\n\n<p>That said, if you really do need to change the default policy, you do not need to resort to editing the net/http source as someone suggested. </p>\n\n<p>To change the default handling of redirects you will need to create a Client and set CheckRedirect.</p>\n\n<p>For your reference:\n<a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"nofollow\">http://golang.org/pkg/net/http/#Client</a></p>\n\n<pre><code>// If CheckRedirect is nil, the Client uses its default policy,\n// which is to stop after 10 consecutive requests.\nCheckRedirect func(req *Request, via []*Request) error\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1916, "user_id": 207702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0823fc763f312bdc7e2c145fa14cc554?s=128&d=identicon&r=PG", "display_name": "rjp", "link": "https://stackoverflow.com/users/207702/rjp"}, "is_accepted": false, "score": 0, "last_activity_date": 1448014434, "creation_date": 1448014434, "answer_id": 33824078, "question_id": 32302777, "link": "https://stackoverflow.com/questions/32302777/wikipedia-url-stopped-after-10-redirects-error-golang/33824078#33824078", "title": "Wikipedia url stopped after 10 redirects error GoLang", "body": "<p>I had this issue with Wikipedia URLs containing <code>%26</code> because they redirect to a version of the URL with <code>&amp;</code> which Go then encodes to <code>%26</code> which Wikipedia redirects to <code>&amp;</code> and ...</p>\n\n<p>Oddly, removing <code>gcc-go</code> (v1.4) from my Arch box and replacing it with <code>go</code> (v1.5) has fixed the problem.</p>\n\n<p>I'm guessing this can be put down to the changes in <code>net/http</code> between v1.4 and v1.5 then. </p>\n"}], "owner": {"reputation": 85, "user_id": 1660498, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66ecf0fbabf2df6ba85d68aa1246a867?s=128&d=identicon&r=PG", "display_name": "Tim Haggard", "link": "https://stackoverflow.com/users/1660498/tim-haggard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1648, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1448014434, "creation_date": 1440983746, "last_edit_date": 1440985109, "question_id": 32302777, "link": "https://stackoverflow.com/questions/32302777/wikipedia-url-stopped-after-10-redirects-error-golang", "title": "Wikipedia url stopped after 10 redirects error GoLang", "body": "<p>Upon executing an HTTP Get request, I receive the following error: </p>\n\n<pre><code>2015/08/30 16:42:09 Get https://en.wikipedia.org/wiki/List_of_S%26P_500_companies: \nstopped after 10 redirects\n</code></pre>\n\n<p>In the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n)\n\nfunc main() {\n    response, err := http.Get(\"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I know that according to the documentation, </p>\n\n<pre><code>// Get issues a GET to the specified URL. If the response is one of\n// the following redirect codes, Get follows the redirect, up to a\n// maximum of 10 redirects:\n//\n//    301 (Moved Permanently)\n//    302 (Found)\n//    303 (See Other)\n//    307 (Temporary Redirect)\n//\n// An error is returned if there were too many redirects or if there\n// was an HTTP protocol error. A non-2xx response doesn't cause an\n// error.\n</code></pre>\n\n<p>I was hoping that somebody knows what the solution would be in this case. It seems rather odd that this simple url results in more than ten redirects. Makes me think that there may be more going on behind the scenes.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "subprocess", "stdout"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1440984962, "post_id": 32302726, "comment_id": 52481842, "body": "The Go program cannot read data from the Perl program until the Perl program flushes the data to the operating system.  Modify the Perl program to autoflush stdout using <code>local $| = 1;</code>."}, {"owner": {"reputation": 2596, "user_id": 438039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16dc9a9ba1826f5e89204a7df84cfde0?s=128&d=identicon&r=PG", "display_name": "kagali-san", "link": "https://stackoverflow.com/users/438039/kagali-san"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1441010180, "post_id": 32302726, "comment_id": 52489538, "body": "@BravadaZadada I stated that <code>it doesn&#39;t works well with real apps</code>, for example - iperf3. I can&#39;t modify all apps to get byte-by-byte output. So I expected something &quot;use <code>termios</code> package to simulate real TTY which will work like real terminal with no flush delays&quot;"}, {"owner": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 1, "creation_date": 1441021929, "post_id": 32302726, "comment_id": 52496148, "body": "Flushing is something that can only be controlled from the writer, not the reader AFAIK. Although if you are on a system with GNU tooling you might be able to use <a href=\"https://www.gnu.org/software/coreutils/manual/html_node/stdbuf-invocation.html\" rel=\"nofollow noreferrer\">gnu.org/software/coreutils/manual/html_node/&hellip;</a>"}, {"owner": {"reputation": 2596, "user_id": 438039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16dc9a9ba1826f5e89204a7df84cfde0?s=128&d=identicon&r=PG", "display_name": "kagali-san", "link": "https://stackoverflow.com/users/438039/kagali-san"}, "reply_to_user": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 0, "creation_date": 1441035281, "post_id": 32302726, "comment_id": 52504758, "body": "@Evan thanks :) at least it works now"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 5661, "user_id": 3179857, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/74a01200b8e1bc8b9b57ddd5633288bc?s=128&d=identicon&r=PG", "display_name": "Evan", "link": "https://stackoverflow.com/users/3179857/evan"}, "edited": false, "score": 1, "creation_date": 1441039978, "post_id": 32302726, "comment_id": 52507313, "body": "Specifics of buffering of pipes between programs tends to be OS specific. You could look to see if your OS provides an easy way to change/set this. Edit: I see @Evan mentions GNU&#39;s <code>stdbuf</code>; FreeBSD also has it&#39;s own version of <a href=\"https://www.freebsd.org/cgi/man.cgi?query=stdbuf\" rel=\"nofollow noreferrer\"><code>stdbuf</code></a> that appears to have fewer restrictions."}], "owner": {"reputation": 2596, "user_id": 438039, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/16dc9a9ba1826f5e89204a7df84cfde0?s=128&d=identicon&r=PG", "display_name": "kagali-san", "link": "https://stackoverflow.com/users/438039/kagali-san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1147, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1440983120, "creation_date": 1440983120, "question_id": 32302726, "link": "https://stackoverflow.com/questions/32302726/golang-cmd-exec-how-i-can-read-non-buffered-stdout-of-apps", "title": "golang: cmd.Exec(): How I can read non-buffered stdout of apps?", "body": "<p>So I have the simple app which starts other apps and reads their output.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"io\"\n    \"log\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"perl\", \"-e\", \"my $x = 0; while (1) { print ++$x.qx'date'; sleep 1; }\")\n    stdout, _ := cmd.StdoutPipe()\n    stderr, _ := cmd.StderrPipe()\n\n    in := bufio.NewReaderSize(io.MultiReader(stdout, stderr), 100)\n    cmd.Start()\n    defer cmd.Wait()\n    for {\n        log.Printf(\"....\")\n        time.Sleep(1 * time.Second)\n        l, _ := in.ReadString('\\n')\n        log.Printf(string(l))\n    }\n}\n</code></pre>\n\n<p>The point of the real app is to read output of running process and parse it.. however it doesn't works well with real apps which don't explicitly sync/flush their stdout (it takes ~60 lines of <code>iperf</code> output before starting printing).</p>\n\n<p>What is the most efficient way to read output byte-by-byte?</p>\n"}, {"tags": ["http", "go", "character-encoding"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1440978418, "post_id": 32301463, "comment_id": 52480704, "body": "I assume you mean the Go HTTP server, not Chrome? Just <code>w.Header().Set(&quot;Content-Type&quot;, &quot;text&#47;html; charset=utf-8&quot;)</code> (if that&#39;s the content type) in the relevant handlers, and/or in middleware to apply it to multiple handlers."}, {"owner": {"reputation": 3048, "user_id": 352740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GpZsR.jpg?s=128&g=1", "display_name": "growse", "link": "https://stackoverflow.com/users/352740/growse"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441018384, "post_id": 32301463, "comment_id": 52494064, "body": "Erk, fixed the typo. I&#39;m using the fileserver to serve a directory of different files and mimetypes, so setting it manually might not really work, unless I reimplement the existing content type sniffing."}], "answers": [{"comments": [{"owner": {"reputation": 3048, "user_id": 352740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GpZsR.jpg?s=128&g=1", "display_name": "growse", "link": "https://stackoverflow.com/users/352740/growse"}, "edited": false, "score": 0, "creation_date": 1441018965, "post_id": 32303957, "comment_id": 52494378, "body": "I tried to <code>mime.AddExtensionType(&quot;.js&quot;,&quot;application&#47;javascript; charset=utf8&quot;)</code> as the first line in <code>main()</code> but it made no difference. Also, while I&#39;m testing on OSX, doing the same test on linux resulted in the <code>js</code> file being just served as <code>application&#47;javascript</code> without a charset parameter."}, {"owner": {"reputation": 3048, "user_id": 352740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GpZsR.jpg?s=128&g=1", "display_name": "growse", "link": "https://stackoverflow.com/users/352740/growse"}, "edited": false, "score": 0, "creation_date": 1441019416, "post_id": 32303957, "comment_id": 52494650, "body": "<i>edit</i> this program seems to still serve javascript as <code>application&#47;javascript</code> on a mac: <a href=\"http://play.golang.org/p/AIWPjrOGOt\" rel=\"nofollow noreferrer\">play.golang.org/p/AIWPjrOGOt</a>"}, {"owner": {"reputation": 3048, "user_id": 352740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GpZsR.jpg?s=128&g=1", "display_name": "growse", "link": "https://stackoverflow.com/users/352740/growse"}, "edited": false, "score": 0, "creation_date": 1441030200, "post_id": 32303957, "comment_id": 52501607, "body": "Ok, that&#39;s weird - it works for me now as well.  I think I was running into a chrome caching issue."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1440994742, "creation_date": 1440994742, "answer_id": 32303957, "question_id": 32301463, "link": "https://stackoverflow.com/questions/32301463/setting-the-charset-property-on-the-content-type-header-in-the-golang-http-fil/32303957#32303957", "title": "Setting the &#39;charset&#39; property on the Content-Type header in the golang HTTP FileServer", "body": "<p>FileServer calls <a href=\"http://godoc.org/mime#TypeByExtension\" rel=\"nofollow\">mime.TypeByExtension</a> to get the content type. If no type is registered for the extension, then FileServer calls <a href=\"http://godoc.org/net/http#DetectContentType\" rel=\"nofollow\">http.DetectContentType</a> to guess the type from the contents of the file.</p>\n\n<p>If a text/ content type does not specify a charset parameter, then the mime package automatically adds the 'charset=utf-8' parameter to the content type.</p>\n\n<p>To debug this problem, check to see if the system mime.types file specifies a content type for the file extension and that the charset parameter is'charset=utf-8' or the charset parameter is not set.</p>\n\n<p>If the system mime.types entry is missing or incorrect, then call <a href=\"http://godoc.org/mime#AddExtensionType\" rel=\"nofollow\">mime.AddExtensionType</a> to override the system setting. This can be called once before any content is served.</p>\n"}], "owner": {"reputation": 3048, "user_id": 352740, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/GpZsR.jpg?s=128&g=1", "display_name": "growse", "link": "https://stackoverflow.com/users/352740/growse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2860, "favorite_count": 1, "accepted_answer_id": 32303957, "answer_count": 1, "score": 2, "last_activity_date": 1467105642, "creation_date": 1440971184, "last_edit_date": 1467105642, "question_id": 32301463, "link": "https://stackoverflow.com/questions/32301463/setting-the-charset-property-on-the-content-type-header-in-the-golang-http-fil", "title": "Setting the &#39;charset&#39; property on the Content-Type header in the golang HTTP FileServer", "body": "<p>I've got an issue when testing a golang web app. In the deployed version, nginx fronts the application and explicitly sets <code>charset utf8;</code> so that all textual content types are appended with a charset declaration.</p>\n\n<p>In testing, I'm hitting the golang application directly, and here the content type does not have a charset set. This is causing problems when trying to serve libraries like <a href=\"https://github.com/mbostock/d3/blob/v3.5.6/d3.js#L1261\" rel=\"nofollow\">d3</a> which has lines like:</p>\n\n<pre><code>var \u03b5 = 1e-6, \u03b52 = \u03b5 * \u03b5, \u03c0 = Math.PI, \u03c4 = 2 * \u03c0, \u03c4\u03b5 = \u03c4 - \u03b5, half\u03c0 = \u03c0 / 2, d3_radians = \u03c0 / 180, d3_degrees = 180 / \u03c0;\n</code></pre>\n\n<p>Because golang doesn't specify the charset, these are rendered in chrome as:</p>\n\n<pre><code>var \u00ce\u00b5 = 1e-6, \u00ce\u00b52 = \u00ce\u00b5 * \u00ce\u00b5....\n</code></pre>\n\n<p>What's the best way of getting the golang http server to output the charset=utf8 declaration on the HTTP headers?</p>\n"}, {"tags": ["go", "xml-parsing", "html-parsing"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 1660498, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66ecf0fbabf2df6ba85d68aa1246a867?s=128&d=identicon&r=PG", "display_name": "Tim Haggard", "link": "https://stackoverflow.com/users/1660498/tim-haggard"}, "edited": false, "score": 0, "creation_date": 1440967627, "post_id": 32298921, "comment_id": 52478324, "body": "Thank you. Just one more thing: Adding an error handler results in &quot;Get <a href=\"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/List_of_S%26P_500_companies</a>: stopped after 10 redirects&quot; Any idea about how to mitigate this?"}], "tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": false, "score": 6, "last_activity_date": 1440954461, "last_edit_date": 1440954461, "creation_date": 1440953341, "answer_id": 32298921, "question_id": 32298769, "link": "https://stackoverflow.com/questions/32298769/parsing-sp-500-data-from-wikipedia-in-golang/32298921#32298921", "title": "Parsing S&amp;P 500 Data from Wikipedia in GoLang", "body": "<p>I'd use this lib: <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"noreferrer\">https://github.com/PuerkitoBio/goquery</a> </p>\n\n<p>It gives you easy to use jquery like selectors. </p>\n\n<p>I made an example with your data:\n<a href=\"http://play.golang.org/p/KdWUiiPxSU\" rel=\"noreferrer\">http://play.golang.org/p/KdWUiiPxSU</a></p>\n"}], "owner": {"reputation": 85, "user_id": 1660498, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/66ecf0fbabf2df6ba85d68aa1246a867?s=128&d=identicon&r=PG", "display_name": "Tim Haggard", "link": "https://stackoverflow.com/users/1660498/tim-haggard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440954461, "creation_date": 1440952237, "question_id": 32298769, "link": "https://stackoverflow.com/questions/32298769/parsing-sp-500-data-from-wikipedia-in-golang", "title": "Parsing S&amp;P 500 Data from Wikipedia in GoLang", "body": "<p>I am trying to figure out how to parse the table of S&amp;P 500 stock from this page: <a href=\"https://en.wikipedia.org/wiki/List_of_S%26P_500_companies\" rel=\"nofollow\">https://en.wikipedia.org/wiki/List_of_S%26P_500_companies</a>.</p>\n\n<p>Python has nice libraries like lxml that help to take care of this but I'm trying to do the same thing in GoLang. I have already looked into making GET requests with \"net/http\" but am not sure how to perform the actual parsing.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 591, "user_id": 1403472, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94153a445bca08d18b8bae928e85c9d6?s=128&d=identicon&r=PG", "display_name": "Raul Gomez", "link": "https://stackoverflow.com/users/1403472/raul-gomez"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1440967613, "post_id": 32298363, "comment_id": 52478320, "body": "so i will have to loop and change it myself for all records?, isnt there  like a concat array with string to become string or a casting or something, sure?"}], "answers": [{"tags": [], "owner": {"reputation": 591, "user_id": 1403472, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94153a445bca08d18b8bae928e85c9d6?s=128&d=identicon&r=PG", "display_name": "Raul Gomez", "link": "https://stackoverflow.com/users/1403472/raul-gomez"}, "is_accepted": false, "score": 0, "last_activity_date": 1440973802, "creation_date": 1440973802, "answer_id": 32301787, "question_id": 32298363, "link": "https://stackoverflow.com/questions/32298363/mgo-find-convert-a-single-value-array-to-string/32301787#32301787", "title": "mgo find convert a single value array to string", "body": "<p>very limited comments i need 2000 poits for editing my post and add more things it seems, this is not answer but maybe, so i have to loop it?, isnt better way?</p>\n\n<pre><code>err := r.Coll.Find(bson.M{}).Select(bson.M{\"name\": bson.M{\"$slice\": []int{1, 1}}}).All(&amp;result.Data)                                            \n  if err != nil {                                                                                                                                 \n      return result, err                                                                                                                          \n  }                                                                                                                                               \n\n  type skillnew struct {                                                                                                                          \n      Id   bson.ObjectId `json:\"id,omitempty\" bson:\"_id,omitempty\"`                                                                               \n      Name string        `bson:\"name,omitempty\" json:\"name,omitempty\"`                                                                            \n  }                                                                                                                                               \n\n  skillsallnew := make([]skillnew, len(result.Data))                                                                                              \n  for i := range result.Data {                                                                                                                    \n      skillsallnew[i] = skillnew{result.Data[i].Id, result.Data[i].Name[0]}                                                                       \n  }    \n</code></pre>\n"}], "owner": {"reputation": 591, "user_id": 1403472, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/94153a445bca08d18b8bae928e85c9d6?s=128&d=identicon&r=PG", "display_name": "Raul Gomez", "link": "https://stackoverflow.com/users/1403472/raul-gomez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440973802, "creation_date": 1440949771, "question_id": 32298363, "link": "https://stackoverflow.com/questions/32298363/mgo-find-convert-a-single-value-array-to-string", "title": "mgo find convert a single value array to string", "body": "<p>This is part of my collection schema in mongodb:</p>\n\n<pre><code>{ \"_id\" : ObjectId(\"55e1eef5255da6d384754642\"), \"name\" : [ \"Web, Mobile &amp; Software Dev\", \"Movil y desarrollo de software\" ] } { \"_id\" : ObjectId(\"55e1f2d0255da6d38475464b\"), \"name\" : [ \"IT &amp; Networking\", \"TI y Redes\" ] } ...\n</code></pre>\n\n<p>Right now i can get the info like this:</p>\n\n<pre><code> err := r.Coll.Find(bson.M{}).Select(bson.M{\"name\": bson.M{\"$slice\": []int{1, 1}}}).All(&amp;result.Data)\n</code></pre>\n\n<p>but i want \"name\" to return a string instead of a single value array, so i dont have to index it inside my frontend if no need.</p>\n"}, {"tags": ["go", "revel"], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 1, "last_activity_date": 1440957789, "creation_date": 1440957789, "answer_id": 32299591, "question_id": 32297598, "link": "https://stackoverflow.com/questions/32297598/how-to-debug-revel-build-crash-log/32299591#32299591", "title": "how to debug revel build crash log?", "body": "<p>You probably need to get familiar with Go stack traces. Here is nice tutorial: <a href=\"http://www.goinggo.net/2015/01/stack-traces-in-go.html\" rel=\"nofollow\">http://www.goinggo.net/2015/01/stack-traces-in-go.html</a></p>\n\n<p>Basically, you have to look for the goroutine in the <code>[running]</code> state (it usually on the very top of the stack trace) and find out line, which triggered panic.</p>\n\n<p>In this example, <code>github.com/revel/cmd/revel/util.go:96</code> looks like this:</p>\n\n<pre><code>        if info.IsDir() {\n            err := os.MkdirAll(path.Join(destDir, relSrcPath), 0777)\n            if !os.IsExist(err) {\n                panicOnError(err, \"Failed to create directory\")\n            }\n            return nil\n        }\n</code></pre>\n\n<p>Panic says <code>panic: runtime error: invalid memory address or nil pointer dereference</code>, so it must be <code>info</code> to be <code>nil</code> (you can see it also as 0x0 in the call to path/filepath.Walk.</p>\n\n<p>Looks like revel bug, not sure without full code/env information.</p>\n"}], "owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 32299591, "answer_count": 1, "score": 0, "last_activity_date": 1440957789, "creation_date": 1440944921, "question_id": 32297598, "link": "https://stackoverflow.com/questions/32297598/how-to-debug-revel-build-crash-log", "title": "how to debug revel build crash log?", "body": "<p>I want to put my app in production but I am having trouble understanding this error log that I am getting while trying to do <code>revel build app</code></p>\n\n<p>This is part of log:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference [recovered]\n    panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x20 pc=0x40c485]\n\ngoroutine 1 [running]:\nmain.func\u00b7002()\n    /home/johnny/data/go/src/github.com/revel/cmd/revel/rev.go:71 +0x7e\nmain.func\u00b7003(0xc208a4a400, 0x1001, 0x0, 0x0, 0x7ff4863a9238, 0xc2081ee420, 0x0, 0x0)\n    /home/johnny/data/go/src/github.com/revel/cmd/revel/util.go:96 +0x2b5\npath/filepath.walk(0xc208617000, 0xff1, 0x7ff4863a9260, 0xc20883cff0, 0xc2085799c8, 0x0, 0x0)\n    /usr/lib/go/src/path/filepath/path.go:368 +0x430\n</code></pre>\n\n<p>Other lines in log always reffer to this <code>/usr/lib/go/src/path/filepath/path.go</code></p>\n\n<p>and at the end of log is this:</p>\n\n<pre><code>goroutine 5 [syscall]:\nos/signal.loop()\n    /usr/lib/go/src/os/signal/signal_unix.go:21 +0x1f\ncreated by os/signal.init\u00b71\n    /usr/lib/go/src/os/signal/signal_unix.go:27 +0x35\n</code></pre>\n\n<p>This log reminds me of objective C and I know how is hard to debug that.</p>\n\n<p>Maybe I am missing something in routes somewhere? I have some files in .gitignore (i am not sure if that has to do something with a crash?) </p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 0, "creation_date": 1450861112, "post_id": 32295038, "comment_id": 56604726, "body": "Is your problem getting data out of the database, or adding it to the template?"}], "owner": {"reputation": 31, "user_id": 5272318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f879d816924d7daa598da8111d6321?s=128&d=identicon&r=PG&f=1", "display_name": " GeoLyu", "link": "https://stackoverflow.com/users/5272318/geolyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 905, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1508742786, "creation_date": 1440926504, "last_edit_date": 1440927594, "question_id": 32295038, "link": "https://stackoverflow.com/questions/32295038/beego-raw-queryrows-template", "title": "Beego Raw.QueryRows, template", "body": "<p>I try to make board paging used beego.</p>\n\n<p>So i did like this,</p>\n\n<h1>In controller</h1>\n\n<pre><code>var articles []*models.Board\nboard.Data[\"startCount\"] = startCount\nboard.Data[\"endCount\"] = endCount\n\n/* Template Test Query\nnum, err := o.QueryTable(\"board\").Filter(\"Idx\", 21).OrderBy(\"-idx\").All(&amp;articles)\n*/\n\nnum, err := o.Raw(\"SELECT board.* FROM(SELECT @ROWNUM := @ROWNUM + 1 AS ROWNUM, board.* FROM board, (SELECT @ROWNUM := 0) R) board WHERE board.ROWNUM &gt; ?;\", 0).QueryRows(&amp;articles)\nif num == 0 || err == orm.ErrNoRows {\n    board.Data[\"user_error\"] = err\n}\nif err != orm.ErrNoRows &amp;&amp; num &gt; 0 {\n    board.Data[\"nums\"] = num\n    board.Data[\"articles\"] = articles\n}\n</code></pre>\n\n<h1>In veiw file</h1>\n\n<pre><code>&lt;tbody&gt;\n    {{ if not .articles }}\n    &lt;tr&gt;\n      &lt;td colspan=\"5\"&gt;No articles.&lt;/td&gt;\n    &lt;/tr&gt;\n    {{ else }}\n    {{ $uri := .article_uri}}\n    {{range $articles := .articles}}\n    &lt;tr&gt;\n      &lt;td&gt;{{$articles.Idx}}&lt;/td&gt;\n      &lt;td&gt;&lt;a href=\"{{urlfor \"BoardController.Content\" \":id\" $articles.Idx}}\"&gt;{{$articles.Title}}&lt;/a&gt;&lt;/td&gt;\n      &lt;td&gt;{{$articles.Nick}}&lt;/td&gt;\n      &lt;td&gt;{{date $articles.Date \"y.m.d H:i\"}}&lt;/td&gt;\n      &lt;td&gt;0&lt;/td&gt;\n    &lt;/tr&gt;\n    {{ end }}\n    {{ end }}\n&lt;/tbody&gt;\n</code></pre>\n\n<p>When i used Template Test Query, i saw success print.</p>\n\n<p>but i can see just empty table, since be changed to o.Raw( ... ).QueryRows(&amp;articles)</p>\n\n<p>Plz someone help me..</p>\n\n<p><a href=\"https://i.stack.imgur.com/JoC7n.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JoC7n.png\" alt=\"Current status\"></a></p>\n\n<h1>models</h1>\n\n<pre><code>type Board struct{\nIdx int64       `orm:\"pk\";form:\"-\"`\nId string       `form:\"id\"`\nTitle string    `form:\"title\"`\nBody string     `form:\"content\"`\nNick string     `form:\"nick\"`\nDate time.Time  `orm:\"auto_now_add;type(datetime)\"`\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/vQEmJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vQEmJ.png\" alt=\"table\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "edited": false, "score": 0, "creation_date": 1440926077, "post_id": 32294975, "comment_id": 52466777, "body": "Why would you not just compare a to b?"}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1440926236, "post_id": 32294975, "comment_id": 52466809, "body": "This works: <code>if ((a == &quot;ALL&quot;) != (b == &quot;ALL&quot;)) == true {</code>. This is strange, I see nothing in the spec explaining this."}, {"owner": {"reputation": 121, "user_id": 2218116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fba174d27f13e57b5083514edb0e47f?s=128&d=identicon&r=PG", "display_name": "cnkid", "link": "https://stackoverflow.com/users/2218116/cnkid"}, "edited": false, "score": 0, "creation_date": 1440926307, "post_id": 32294975, "comment_id": 52466822, "body": "i want to treat all non-ALL string as the same. e.g. print nothing if a==&quot;some string&quot;, b==&quot;some other string&quot;"}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1440926357, "post_id": 32294975, "comment_id": 52466832, "body": "The second form can be reduced to <code>if c:=(a == &quot;ALL&quot;) != (b == &quot;ALL&quot;); c {</code>"}, {"owner": {"reputation": 1256, "user_id": 1946396, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bd8fc3b20061700ebd6eac590a0494c1?s=128&d=identicon&r=PG", "display_name": "shieldstroy", "link": "https://stackoverflow.com/users/1946396/shieldstroy"}, "edited": false, "score": 0, "creation_date": 1440926437, "post_id": 32294975, "comment_id": 52466849, "body": "Oh duh that makes sense. It&#39;s late."}, {"owner": {"reputation": 121, "user_id": 2218116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fba174d27f13e57b5083514edb0e47f?s=128&d=identicon&r=PG", "display_name": "cnkid", "link": "https://stackoverflow.com/users/2218116/cnkid"}, "edited": false, "score": 0, "creation_date": 1440926573, "post_id": 32294975, "comment_id": 52466876, "body": "the thing I have no idea is, since (a == &quot;ALL&quot;) != (b == &quot;ALL&quot;) is true, why not falling to the if case? just don&#39;t know why the first piece does not work"}, {"owner": {"reputation": 9933, "user_id": 678410, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/57083a995514ca4e66842dec135edd6f?s=128&d=identicon&r=PG", "display_name": "Anders Forsgren", "link": "https://stackoverflow.com/users/678410/anders-forsgren"}, "edited": false, "score": 1, "creation_date": 1440928082, "post_id": 32294975, "comment_id": 52467249, "body": "An observation: it works as expected for integers."}, {"owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "edited": false, "score": 0, "creation_date": 1440928343, "post_id": 32294975, "comment_id": 52467307, "body": "Another observation, it works when if (a == &quot;ALL&quot;) == (b == &quot;ALL&quot;)  you compare for equality. It&#39;s definitely the bug, because it doesn&#39;t work as people expect."}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1440928510, "post_id": 32294975, "comment_id": 52467339, "body": "I just asked the golang-nuts mailing list. We&#39;ll see."}, {"owner": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1440928647, "post_id": 32294975, "comment_id": 52467371, "body": "@DenysS&#233;guret please post link to your question here"}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 1737, "user_id": 824167, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Gl9ya.jpg?s=128&g=1", "display_name": "Vlad Miller", "link": "https://stackoverflow.com/users/824167/vlad-miller"}, "edited": false, "score": 3, "creation_date": 1440929282, "post_id": 32294975, "comment_id": 52467543, "body": "@VladMiller I don&#39;t see my question, it might be quarantined. I just tested on my computer, I don&#39;t have the problem (go1.4.2 linux/amd64)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1441781402, "post_id": 32294975, "comment_id": 52806526, "body": "Fixed in go 1.5.1. Voting to close this question."}], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 7, "last_activity_date": 1441886053, "last_edit_date": 1441886053, "creation_date": 1440934613, "answer_id": 32296130, "question_id": 32294975, "link": "https://stackoverflow.com/questions/32294975/a-comparison-equals-to-true-but-when-i-put-it-as-if-condition-why-it-is-not-ev/32296130#32296130", "title": "a comparison equals to true, but when i put it as if condition, why it is not evaluated as true?", "body": "<p>It is a go 1.5 bug, and looks similiar to this one : <a href=\"https://github.com/golang/go/issues/12226\" rel=\"nofollow\">https://github.com/golang/go/issues/12226</a></p>\n\n<p>It is fixed on the master branch, so you can either downgrade to 1.4.2 and wait for the next release, or compile the tip of master.</p>\n\n<p>Edit : Go1.5.1 has been released and it contains the fix to this issue</p>\n"}], "owner": {"reputation": 121, "user_id": 2218116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fba174d27f13e57b5083514edb0e47f?s=128&d=identicon&r=PG", "display_name": "cnkid", "link": "https://stackoverflow.com/users/2218116/cnkid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 3, "answer_count": 1, "score": 12, "last_activity_date": 1441886053, "creation_date": 1440925912, "last_edit_date": 1440926089, "question_id": 32294975, "link": "https://stackoverflow.com/questions/32294975/a-comparison-equals-to-true-but-when-i-put-it-as-if-condition-why-it-is-not-ev", "title": "a comparison equals to true, but when i put it as if condition, why it is not evaluated as true?", "body": "<pre><code>a := \"ALL\"\nb := \"not all\"\n\nif (a == \"ALL\") != (b == \"ALL\") {\n    fmt.Printf(\"why not falling into this case?\\n\")\n}\n</code></pre>\n\n<p>Here is a piece of Go code I wrote, to print something if a and b have exactly one to be \"ALL\". But why the fmt.Printf is not triggered?</p>\n\n<p>However the following does print:</p>\n\n<pre><code>c := (a == \"ALL\") != (b == \"ALL\")\nif c {\n    fmt.Printf(\"if assign to c, do fall in here\\n\")\n}\n</code></pre>\n\n<p>But what's the difference between the two pieces? </p>\n\n<p>I also pasted the above code in the go playground: <a href=\"http://play.golang.org/p/e5tNai_d20\">http://play.golang.org/p/e5tNai_d20</a> Anyone's explanation will be greatly appreciated! Thanks in advance.</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 7151, "user_id": 1346207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/91ec3aaf921cb7fd4adaaf8ddc7e5b19?s=128&d=identicon&r=PG", "display_name": "Markus Malkusch", "link": "https://stackoverflow.com/users/1346207/markus-malkusch"}, "edited": false, "score": 0, "creation_date": 1440924697, "post_id": 32294767, "comment_id": 52466480, "body": "@MarkusMalkusch sorry the profiler?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 7151, "user_id": 1346207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/91ec3aaf921cb7fd4adaaf8ddc7e5b19?s=128&d=identicon&r=PG", "display_name": "Markus Malkusch", "link": "https://stackoverflow.com/users/1346207/markus-malkusch"}, "edited": false, "score": 0, "creation_date": 1440924878, "post_id": 32294767, "comment_id": 52466526, "body": "@MarkusMalkusch no I&#39;m not sure how to do that. I just have a middleware that tells me how long a response took in this case it was 11 seconds which is brutal."}, {"owner": {"reputation": 7151, "user_id": 1346207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/91ec3aaf921cb7fd4adaaf8ddc7e5b19?s=128&d=identicon&r=PG", "display_name": "Markus Malkusch", "link": "https://stackoverflow.com/users/1346207/markus-malkusch"}, "edited": false, "score": 2, "creation_date": 1440924994, "post_id": 32294767, "comment_id": 52466557, "body": "Well, then learn to use the profiler. It might very much point you to the offending code. And if that is a MySQL query you will then have to do an <code>Explain</code> on that query to see if you&#39;ve missed putting an index on a field."}], "answers": [{"comments": [{"owner": {"reputation": 7151, "user_id": 1346207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/91ec3aaf921cb7fd4adaaf8ddc7e5b19?s=128&d=identicon&r=PG", "display_name": "Markus Malkusch", "link": "https://stackoverflow.com/users/1346207/markus-malkusch"}, "edited": false, "score": 0, "creation_date": 1440925284, "post_id": 32294900, "comment_id": 52466625, "body": "&quot;Put profiling timing statement&quot; is this how you do profiling in Go? Such a  Hipster language!"}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "reply_to_user": {"reputation": 7151, "user_id": 1346207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/91ec3aaf921cb7fd4adaaf8ddc7e5b19?s=128&d=identicon&r=PG", "display_name": "Markus Malkusch", "link": "https://stackoverflow.com/users/1346207/markus-malkusch"}, "edited": false, "score": 0, "creation_date": 1440925430, "post_id": 32294900, "comment_id": 52466655, "body": "time.Now(), but I would save profiling to the db rather than stream it out. Have a little record of things"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440958900, "post_id": 32294900, "comment_id": 52475839, "body": "Using <code>time.Since(start)</code> can be useful for very small localized things where you just want something very quick and dirty. For <i>anything</i> else use the <a href=\"https://golang.org/pkg/cmd/pprof/\" rel=\"nofollow noreferrer\">Go profiling tools</a>, see <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">The Go Blog: Profiling Go Programs</a>. (Note, if you already serve HTTP with your Go code you can just <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\"><code>import _ &quot;net&#47;http&#47;pprof&quot;</code></a> to get your HTTP server to serve out profiling information)."}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1440959197, "post_id": 32294900, "comment_id": 52475923, "body": "the OP could have given me the profiling info, and the table structures with indexes, and rowcounts, in 5 minutes. I guess he figured it out"}], "tags": [], "owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "is_accepted": false, "score": 2, "last_activity_date": 1440925291, "last_edit_date": 1440925291, "creation_date": 1440925156, "answer_id": 32294900, "question_id": 32294767, "link": "https://stackoverflow.com/questions/32294767/why-this-small-bit-of-code-takes-11-seconds-to-execute-these-few-database-calls/32294900#32294900", "title": "Why this small bit of code takes 11 seconds to execute these few database calls?", "body": "<p><strong>Specimen A:</strong></p>\n\n<pre><code>rows, err := Db.Query(\"SELECT DepositedBy, Price FROM skinbank \nWHERE tradeofferid=? AND accepted=?\", sTradeId, 0)\n</code></pre>\n\n<p><strong>Specimen B: (inside for loop)</strong></p>\n\n<pre><code>_, err := Db.Query(\"UPDATE accounts SET credits = credits + ? WHERE steamid=?\", price, depositedby)\n</code></pre>\n\n<p><strong>Specimen C:</strong></p>\n\n<pre><code>_, err = Db.Query(\"UPDATE skinbank SET accepted=? WHERE tradeofferid=?\", 1, sTradeId)\n</code></pre>\n\n<p>Put profiling timing statement around these. If you don't know how, ask. Show the table schemas if you need more help by issuing <code>show create table skinbank</code> and <code>show create table credits</code>. This will enable some clue on indexes. Tell us the rowcounts of the two tables.</p>\n\n<p>If you have a ton of rows, it is possible without proper indexes that you are performing tablescans, not fast lookups, to get to the rows in the update where clause. Heck, in the select too. Right now you don't know the timings.</p>\n\n<p>At the very least, have indexes on </p>\n\n<pre><code>skinbank(tradeofferid,accepted) -- a composite index, useful for Specimen A\ncredits(steamid) -- useful for Specimen B\n</code></pre>\n\n<p>As for specimen C, it should pick up the left-most of the composite index just suggested. So a separate index on just skinbank(tradeofferid) is overkill if you are going the composite route.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539829855, "creation_date": 1440923955, "last_edit_date": 1539829855, "question_id": 32294767, "link": "https://stackoverflow.com/questions/32294767/why-this-small-bit-of-code-takes-11-seconds-to-execute-these-few-database-calls", "title": "Why this small bit of code takes 11 seconds to execute these few database calls?", "body": "<p>I have this bit of code:</p>\n\n<pre><code>package tradebot\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"strconv\"\n\n    \"github.com/Philipp15b/go-steam/tradeoffer\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc AcceptTrade(w http.ResponseWriter, r *http.Request) {\n\n    vars := mux.Vars(r)\n    var tradeId tradeoffer.TradeOfferId\n    var sTradeId string\n    if _, has := vars[\"TradeId\"]; has {\n        var err error\n        sTradeId = vars[\"TradeId\"]\n        id, err := strconv.ParseUint(vars[\"TradeId\"], 10, 64)\n        if err != nil {\n            http.Error(w, \"Error accepting trade offer\", 500)\n        }\n        tradeId = tradeoffer.TradeOfferId(id)\n    }\n\n    err := Trader.Accept(tradeId)\n    if err != nil {\n        log.Println(err.Error())\n        http.Error(w, \"Failed to accept trade try again after\", 500)\n    }\n    rows, err := Db.Query(\"SELECT DepositedBy, Price FROM skinbank WHERE tradeofferid=? AND accepted=?\", sTradeId, 0)\n    if err != nil {\n        log.Println(err)\n        http.Error(w, \"Your trade offer was accepted but there was an error on our side. Please open a ticket with the trade ID: \"+sTradeId+\" so we can address this issue. Thank you and sorry for the inconvenience\", 500)\n    }\n    foundRows := false\n    for rows.Next() {\n        foundRows = true\n        var price float64\n        var depositedby string\n        err = rows.Scan(&amp;depositedby, &amp;price)\n        if err != nil {\n            log.Println(err)\n            http.Error(w, \"Your trade offer was accepted but there was an error on our side. Please open a ticket with the trade ID: \"+sTradeId+\" so we can address this issue. Thank you and sorry for the inconvenience\", 500)\n        }\n        if err != nil {\n            log.Println(err)\n            http.Error(w, \"Your trade offer was accepted but there was an error on our side. Please open a ticket with the trade ID: \"+sTradeId+\" so we can address this issue. Thank you and sorry for the inconvenience\", 500)\n        }\n        log.Println(depositedby, price)\n        _, err := Db.Query(\"UPDATE accounts SET credits = credits + ? WHERE steamid=?\", price, depositedby)\n        if err != nil {\n            log.Println(err)\n            http.Error(w, \"Your trade offer was accepted but there was an error on our side. Please open a ticket with the trade ID: \"+sTradeId+\" so we can address this issue. Thank you and sorry for the inconvenience\", 500)\n        }\n    }\n\n    _, err = Db.Query(\"UPDATE skinbank SET accepted=? WHERE tradeofferid=?\", 1, sTradeId)\n    if err != nil {\n        log.Println(err)\n        http.Error(w, \"Your trade offer was accepted but there was an error on our side. Please open a ticket with the trade ID: \"+sTradeId+\" so we can address this issue. Thank you and sorry for the inconvenience\", 500)\n    }\n    log.Println(\"Trade accepted: \" + sTradeId)\n    if foundRows {\n        http.Redirect(w, r, \"/profile\", 303)\n    } else {\n        http.Error(w, \"No trade with that id, either doesn't exist or already accepted.\", 500)\n    }\n}\n</code></pre>\n\n<p>It is mostly just a few MySQL calls to the database to update / get a bit of information, I was wondering if anybody can tell me what I have done inefficiently here that it's causing this to take 11 seconds to run (with about 6 items to loop in the <code>for rows.Next()</code> call.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1440936286, "post_id": 32294476, "comment_id": 52469447, "body": "No. <a href=\"http://golang.org/pkg/database/sql/#NullString\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#NullString</a> is the answer for this."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1440958565, "post_id": 32294476, "comment_id": 52475748, "body": "A number of your items assume that an SQL NULL should be treated as &quot;&quot; or 0. That&#39;s almost never the case, if it was the database wouldn&#39;t bother using NULL (which normally means, &quot;unset&quot;, &quot;unavailable&quot;, &quot;inapplicable&quot;, etc). For programming languages that don&#39;t have a concept of NULL basic types (e.g. a pointer can be nil but not an int) you have to use either two variables (e.g. <code>value int</code> &amp; <code>valid bool</code> as with <code>sql.NullString</code>) per null-able column or flags field per row/record or some such to record the validity state. This simply is not an issue that can be waved away by magic code."}, {"owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "edited": false, "score": 1, "creation_date": 1441001509, "post_id": 32294476, "comment_id": 52485593, "body": "Indeed. In our database some people have middle names. The middle name is truly not &quot;&quot;, so a NULL appears. This saves me from the error of thinking that people literally have &quot;&quot; as their middle name. And inadvertently trying to email them at address &quot;&quot; or call them on phone number 0. But seriously I think the database makers used NULL just because it was there, and it was slightly more correct than an empty string."}, {"owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441760564, "post_id": 32294476, "comment_id": 52800599, "body": "@elithrar sql.Nullstring is not the answer for this; please see point 3. The database uses null values extensively. The null value means nothing more special than &quot;not there&quot;. I will not perform a dance for each potentially null database field.  Not using Go would be a better answer."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1441760806, "post_id": 32294476, "comment_id": 52800659, "body": "I commented having read #3 - it is the most appropriate option &lt;i&gt;if you are going to use Go&lt;/i&gt;\u2014which is a fair assumption given you posted it under the &#39;go&#39; tag. You could easily write an <code>isNil</code> helper to simplify this. You&#39;re welcome to use another language that has a <code>null</code> zero value for types."}, {"owner": {"reputation": 840, "user_id": 1028939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61801c8fb992a44d5506b6a557831003?s=128&d=identicon&r=PG", "display_name": "MattyB", "link": "https://stackoverflow.com/users/1028939/mattyb"}, "edited": false, "score": 0, "creation_date": 1441973474, "post_id": 32294476, "comment_id": 52903975, "body": "I don&#39;t see why #6 is any better than #3. Your code will just be filled with <code>MiddleName != &quot;&quot;</code> instead of <code>MiddleName.Valid</code>."}, {"owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "reply_to_user": {"reputation": 840, "user_id": 1028939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61801c8fb992a44d5506b6a557831003?s=128&d=identicon&r=PG", "display_name": "MattyB", "link": "https://stackoverflow.com/users/1028939/mattyb"}, "edited": false, "score": 0, "creation_date": 1442142535, "post_id": 32294476, "comment_id": 52954151, "body": "@MattyB Well if MiddleName is &quot;&quot;, Go is happy and won&#39;t crash; therefore I don&#39;t need to check for it, unless I want to (say) use someone&#39;s middle initial. The only reason for me to do null checks is because Go crashes whenever it encounters a null, and I have to prevent that. (This is from my perspective; I realise nulls must be important to others.)  Anyway I&#39;ve got an alternative approach, which I&#39;ll put as an answer."}], "answers": [{"comments": [{"owner": {"reputation": 840, "user_id": 1028939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61801c8fb992a44d5506b6a557831003?s=128&d=identicon&r=PG", "display_name": "MattyB", "link": "https://stackoverflow.com/users/1028939/mattyb"}, "edited": false, "score": 0, "creation_date": 1442504896, "post_id": 32550768, "comment_id": 53117953, "body": "This is fine if you need the json anyway. Marshaling is slow though, and if you don&#39;t need the json, this is a big waste of computation."}, {"owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "reply_to_user": {"reputation": 840, "user_id": 1028939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61801c8fb992a44d5506b6a557831003?s=128&d=identicon&r=PG", "display_name": "MattyB", "link": "https://stackoverflow.com/users/1028939/mattyb"}, "edited": false, "score": 1, "creation_date": 1442626462, "post_id": 32550768, "comment_id": 53172721, "body": "@MattyB You could stop the function just before the marshalling line and return &quot;records&quot; variable if you didn&#39;t want the marshalling, but then you need to deal with those potentially nil pointers some other way before using the data. For me the marshalling seems plenty fast; it is sent over a network and consumed by JavaScript in a web browser."}], "tags": [], "owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "is_accepted": true, "score": 4, "last_activity_date": 1442313545, "last_edit_date": 1442313545, "creation_date": 1442154995, "answer_id": 32550768, "question_id": 32294476, "link": "https://stackoverflow.com/questions/32294476/bypass-sql-null-value-problems-in-go/32550768#32550768", "title": "Bypass sql null value problems in Go", "body": "<p>The use of pointers for the sql-scanning destination variables enables the data to be scanned in, worked with (subject to checking if != nil) and marshalled to json, to be sent out from the API, <em>without</em> having to put hundreds of sql.Nullstring, sql.Nullfloat64 etc everywhere. Nulls are miraculously preserved and sent out through the marshalled json. (See Fathername at the bottom).  At the other end, the client can work with the nulls in javascript which is better equipped to handle them.</p>\n\n<pre><code>func queryToJson(db *sql.DB) []byte {\n    rows, err := db.Query(\n      \"select mothername, fathername, surname from fams\" +\n      \"where surname = ?\", \"Nullfather\"\n    )\n    defer rows.Close()\n\n    type record struct {\n        Mname, Fname, Surname *string  // the key: use pointers\n    }\n    records := []record{}\n\n    for rows.Next() {\n        var r record\n        err := rows.Scan(r.Mname, r.Fname, r.Surname) // no need for \"&amp;\"\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(r)\n        records = append(records, r)\n    }\n    j, err := json.Marshal(records)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return j\n}\nj := queryToJson(db)\nfmt.Println(string(j)) // [{\"Mothername\":\"Mary\", \"Fathername\":null, \"Surname\":\"Nullfather\"}]\n</code></pre>\n"}], "owner": {"reputation": 277, "user_id": 3051750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c6d2cd4a40bf0cdc61d4cc414f9d422?s=128&d=identicon&r=PG&f=1", "display_name": "Josh B", "link": "https://stackoverflow.com/users/3051750/josh-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3232, "favorite_count": 3, "accepted_answer_id": 32550768, "answer_count": 1, "score": 10, "last_activity_date": 1442313545, "creation_date": 1440921625, "last_edit_date": 1440924911, "question_id": 32294476, "link": "https://stackoverflow.com/questions/32294476/bypass-sql-null-value-problems-in-go", "title": "Bypass sql null value problems in Go", "body": "<p>I want to use Go to make an API for an existing database that uses null values extensively. Go will not scan nulls to empty strings (or equivalent), and so I need to implement a workaround. </p>\n\n<p>The workarounds I have discovered have left me unsatisfied. In fact I went looking for a dynamic language because of this problem, but Go has certain attractions and I would like to stick with it if possible. Here are the workarounds that did not satisfy:</p>\n\n<ol>\n<li>Don't use nulls in the database. Unsuitable because the database is pre-existing and I do not have liberty to interfere with its structure. The database is more important than my app, not the other way around.</li>\n<li>In sql queries, use COALESCE, ISNULL, etc to convert nulls to empty strings (or equiv) before the data gets to my app. Unsuitable because there are many fields and many tables. Apart from a couple of obvious ones (primary key, surname), I don't know for sure which fields can be relied upon not to give me a null value, so I would be defensively cluttering my sql queries everywhere.</li>\n<li>Use <a href=\"http://golang.org/pkg/database/sql/#NullString\" rel=\"noreferrer\">sql.NullString</a>, sql.NullInt64, sql.NullFloat64, etc to convert nulls to empty strings (or equiv) as an intermediate step before settling them into their destination type.  This suffers from the same problem as above, only I am cluttering my Go code instead of my sql queries.</li>\n<li>Use a combination of *pointers and []byte, to scan each item in to a memory location without committing it to a particular type (other than []byte), and then somehow work with the raw data.  But to do something meaningful with the data you have to convert it to something more useful, and then you are back to sql.Nullstring or if x==nil{handle it}, and this again is happening on a case by case basis for any field that I need to work with.  So, again, we are looking at cluttered, messy, error-prone code and I'm repeating myself all the time instead of being DRY in my coding.</li>\n<li>Look to the Go ORM libraries for help. Well I did that, but to my surprise none of them tackle this issue.</li>\n<li><p>Make my own helper package to convert all null strings to \"\", null ints to 0, null floats to 0.00, null bools to false, etc, and make it part of the process of scanning in from the sql driver, resulting in regular, normal strings, ints, floats and bools.</p>\n\n<p>Unfortunately if 6 is the solution, I do not have the expertise. I suspect the solution would involve something like \"if the intended type of the item to be scanned to is a string, make it an sql.NullString and extract an empty string from it. But if the item to be scanned to is an int, make it a NullInt64 and get a zero from that. But if ...(etc)\"</p></li>\n</ol>\n\n<p>Is there anything I have missed? Thank you.</p>\n"}, {"tags": ["arrays", "dictionary", "go"], "comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 2, "creation_date": 1440888170, "post_id": 32291185, "comment_id": 52460264, "body": "What do you mean by &quot;when I send?&quot; Do you Marshall this into JSON and then Unmarshall it? How are you Unmarshalling it? Are you sending GOB instead of JSON? What code you &quot;receives it as array of interface{}?&quot; There is no standard web protocol that sends &quot;interface{}&quot;. Have you looked at the examples in <code>encoding&#47;json</code>?"}, {"owner": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "edited": false, "score": 2, "creation_date": 1440888332, "post_id": 32291185, "comment_id": 52460295, "body": "Agreed. I provided an admittedly dumb answer below - you can Unmarshal the JSON payload on a struct and get type safety and more code clarity....."}], "answers": [{"tags": [], "owner": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "is_accepted": false, "score": 1, "last_activity_date": 1440888144, "last_edit_date": 1440888144, "creation_date": 1440887040, "answer_id": 32291262, "question_id": 32291185, "link": "https://stackoverflow.com/questions/32291185/what-is-the-best-way-to-convert-array-of-interface-into-array-of-map-in-golang/32291262#32291262", "title": "What is the best way to convert array of interface into array of map in golang?", "body": "<p>The easiest thing you can do is a type assertion on the values:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    var source []interface{}\n    var test = make(map[string]string, 0)\n    test[\"hello\"] = \"World\"\n    source = append(source, test)\n    var dest = source[0].(map[string]string)\n    fmt.Println(reflect.TypeOf(dest).Kind())\n    fmt.Println(dest[\"hello\"])\n}\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 4305917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100001241510496/picture?type=large", "display_name": "Shailesh", "link": "https://stackoverflow.com/users/4305917/shailesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2992, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1440888144, "creation_date": 1440886495, "last_edit_date": 1440887548, "question_id": 32291185, "link": "https://stackoverflow.com/questions/32291185/what-is-the-best-way-to-convert-array-of-interface-into-array-of-map-in-golang", "title": "What is the best way to convert array of interface into array of map in golang?", "body": "<p>I've created a web server and this server is able to get POST request. However, when I send array of map[string]string in POST data, server receives it as array of interface{}. How can I convert it back to array of map[string]string?</p>\n\n<p>Example : Like when I send following example in POST request,</p>\n\n<pre><code>params : [{\"name\" : \"shail\", \"age\" : 24}]\n</code></pre>\n\n<p>I'm sending params as </p>\n\n<pre><code>[](map[string]string)\n</code></pre>\n\n<p>but when server receives this data, it treats params as </p>\n\n<pre><code>[]interface{}\n</code></pre>\n\n<p>.How do I assign params in a variable defined by </p>\n\n<pre><code>[](map[string]interface{})\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "edited": false, "score": 4, "creation_date": 1440887280, "post_id": 32291180, "comment_id": 52460070, "body": "I am sure you understand that there is very little we can say without understanding more about what is being done. The way you describe it sounds too simple to be that slow."}, {"owner": {"reputation": 116, "user_id": 1208122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406307eed77015484c1a86f2715954b9?s=128&d=identicon&r=PG", "display_name": "singron", "link": "https://stackoverflow.com/users/1208122/singron"}, "edited": false, "score": 2, "creation_date": 1440889685, "post_id": 32291180, "comment_id": 52460541, "body": "database/sql already has connection pooling, so if you wrote some kind of pool on top of that, it would be hurting you. You should really only need to call sql.Open once for the lifetime of your process.  If your sql is anything non-trivial, you may not be able to get more throughput out of MySQL. MySQL doesn&#39;t always have good performance with concurrent complex queries."}, {"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 3, "creation_date": 1440889693, "post_id": 32291180, "comment_id": 52460544, "body": "when you say putting it into a map, that could mean just about anything. Why don&#39;t you profile the subcomponents and figure it out better"}, {"owner": {"reputation": 21, "user_id": 5280699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7e21e9f341071ab73daf5409b90b40?s=128&d=identicon&r=PG&f=1", "display_name": "Medo Demo", "link": "https://stackoverflow.com/users/5280699/medo-demo"}, "edited": false, "score": 0, "creation_date": 1440891988, "post_id": 32291180, "comment_id": 52460967, "body": "The query by itself is not really complicated. Just a select query from a well structured DB table. It takes 0.06 to run (Not cached). Of-course this number will drop when it get&#39;s cached by the DB."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1440893026, "post_id": 32291180, "comment_id": 52461179, "body": "Post the code for an endpoint/handler. Common issues include a) creating new DB pools per-request instead of re-using pool members; b) copying thousands of rows into new maps/slices; c) reflecting too much. Saying that, 4548ms is a LOT and likely caused by something at the network level (is MySQL configured to allow more than 100 conns?)"}, {"owner": {"reputation": 21, "user_id": 5280699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7e21e9f341071ab73daf5409b90b40?s=128&d=identicon&r=PG&f=1", "display_name": "Medo Demo", "link": "https://stackoverflow.com/users/5280699/medo-demo"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1440893649, "post_id": 32291180, "comment_id": 52461267, "body": "@elithrar, I will try to put some smaller version of the code together.   A) No, the DB is defined globally  B)  Basically copying 13 rows to the Map C) Yes, Mysql is configured for even higher number than 100 conn. If not then I would have got mysql errors while running the test (as suggested by the link I provided above) D) The bottleneck happens when I try to run this function when I call QueryDbToMap from github.com/elgs/gosqljson/blob/master/gosqljson.go"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5280699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7e21e9f341071ab73daf5409b90b40?s=128&d=identicon&r=PG&f=1", "display_name": "Medo Demo", "link": "https://stackoverflow.com/users/5280699/medo-demo"}, "edited": false, "score": 0, "creation_date": 1440891827, "post_id": 32291664, "comment_id": 52460935, "body": "Thank you for your Input Sir. However, I was able to pinpoint the issue using Mock DB response. Without calling the DB function I get 7000  request per second. However, when  I call QueryDbToMap  <a href=\"https://github.com/elgs/gosqljson/blob/master/gosqljson.go\" rel=\"nofollow noreferrer\">github.com/elgs/gosqljson/blob/master/gosqljson.go</a>   the number drops to 20 request per second. I tried running the query by itself it takes 0.06 to run (Not cached)."}, {"owner": {"reputation": 21, "user_id": 5280699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7e21e9f341071ab73daf5409b90b40?s=128&d=identicon&r=PG&f=1", "display_name": "Medo Demo", "link": "https://stackoverflow.com/users/5280699/medo-demo"}, "edited": false, "score": 0, "creation_date": 1440892922, "post_id": 32291664, "comment_id": 52461164, "body": "I ran the same test with a Mock DB response I got 5821 req/ second. If you had to guess how many requests you can serve per second ; what will it be with a well structured DB table ?"}], "tags": [], "owner": {"reputation": 561, "user_id": 465384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b87db7cb568865952699c5afa3b591d0?s=128&d=identicon&r=PG", "display_name": "pwaller", "link": "https://stackoverflow.com/users/465384/pwaller"}, "is_accepted": false, "score": 3, "last_activity_date": 1440890750, "creation_date": 1440890750, "answer_id": 32291664, "question_id": 32291180, "link": "https://stackoverflow.com/questions/32291180/our-server-cant-handle-more-than-20-requests-second/32291664#32291664", "title": "Our Server can&#39;t handle more than 20 requests/second", "body": "<p>Your post doesn't have enough information to address why your program is not performing how you expect, but I think this question alone is worth an answer:</p>\n\n<blockquote>\n  <p><strong>How did the number suddenly spike from 72.623 to 4548 ms in the second test?</strong></p>\n</blockquote>\n\n<p>In your first test, you did one single request (<code>-n 1</code>). In your second test, you did 100 requests in flight simultaneously (<code>-c 100 -n 100</code>).</p>\n\n<p>You mention that your program communicates to an external database, your program has to wait for that resource to respond. Do you understand how your database performs when you send it 1,000 requests simultaneously? You made no mention of this. Go can certainly handle many hundreds of concurrent requests a second without breaking a sweat, but it depends what you're doing and how you're doing it. If your program can't complete requests as fast as they are coming in, they will pile up, leading to a high latency.</p>\n\n<p>Neither of those tests you told us about are useful to understand how your server performs under \"normal\" circumstances - which you said would be \"thousands of requests per day\" (which isn't very specific, but I'll take to mean, \"a few a second\"). Then it would be much more interesting to look at <code>-c 4 -n 1000</code>, or something that exercises the server over a longer period of time, with a number of concurrent requests which is more like what you expect to get.</p>\n"}, {"tags": [], "owner": {"reputation": 1044, "user_id": 1949322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5b49c06625a28488b90d2b7f960163f?s=128&d=identicon&r=PG", "display_name": "WaltPurvis", "link": "https://stackoverflow.com/users/1949322/waltpurvis"}, "is_accepted": false, "score": 0, "last_activity_date": 1440935611, "creation_date": 1440935611, "answer_id": 32296269, "question_id": 32291180, "link": "https://stackoverflow.com/questions/32291180/our-server-cant-handle-more-than-20-requests-second/32296269#32296269", "title": "Our Server can&#39;t handle more than 20 requests/second", "body": "<p>I'm not familiar with gosqljson package, but you say your \"query by itself is not really complicated\" and you're running it against \"a well structured DB table,\" so I'd suggest dropping the gosqljson and binding your query results to structs, then marshalling those structs to json. That should be faster and incur less memory thrashing than using a map[string]interface{} for everything.</p>\n\n<p>But I don't think gosqljson could possibly be <em>that</em> slow, so it's likely not the main culprit.</p>\n\n<p>The way you're doing your second benchmark is not helpful. </p>\n\n<blockquote>\n  <p>Test 2: ab -n 100 -c 100 <a href=\"http://localhost:8000/sales/report\" rel=\"nofollow\">http://localhost:8000/sales/report</a></p>\n</blockquote>\n\n<p>That's not testing how fast you can handle concurrent requests so much as it's testing how fast you can make connections to MySQL. You're only doing 100 queries and using 100 requests, which means Go is probably spending most of its time making up to 100 connections to MySQL. Go probably doesn't even have time to reuse any of the db connections, considering all the other stuff it's doing to satisfy each query, and then, boom, the test is over. You would need to set the max connections to something like 50 and run 10,000 queries to see how long concurrent requests take once a pool of db connections is already established; right now you're basically testing how long it takes Go to build up a pool of db connections.</p>\n"}], "owner": {"reputation": 21, "user_id": 5280699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7e21e9f341071ab73daf5409b90b40?s=128&d=identicon&r=PG&f=1", "display_name": "Medo Demo", "link": "https://stackoverflow.com/users/5280699/medo-demo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3663, "favorite_count": 1, "answer_count": 2, "score": -3, "last_activity_date": 1440935611, "creation_date": 1440886475, "last_edit_date": 1495542833, "question_id": 32291180, "link": "https://stackoverflow.com/questions/32291180/our-server-cant-handle-more-than-20-requests-second", "title": "Our Server can&#39;t handle more than 20 requests/second", "body": "<p>So after 3 months of hard work in developing &amp; switching the company API from PHP to Go I found out that our Go server can't handle more than 20 req/second. </p>\n\n<p><strong>So basically how our API works:</strong></p>\n\n<ul>\n<li>takes in a request</li>\n<li>validates the request</li>\n<li>fetches the data from the DB using MYSQL</li>\n<li>put's the data in a Map</li>\n<li>send's it back to the Client in a JSON format</li>\n</ul>\n\n<p>So after writing about 30 APIs I decided to take it for a spin and see how it performance under load test. </p>\n\n<p><strong>Test 1:</strong>  ab -n 1 -c 1 <a href=\"http://localhost:8000/sales/report\" rel=\"nofollow noreferrer\">http://localhost:8000/sales/report</a> the results are \"Time per request: 72.623 [ms] (mean)\" . </p>\n\n<p><strong>Test 2:</strong>   ab -n 100 -c 100 <a href=\"http://localhost:8000/sales/report\" rel=\"nofollow noreferrer\">http://localhost:8000/sales/report</a> the results are \"Time per request: 4548.155 [ms] (mean)\" (No MYSQL errors).</p>\n\n<p><strong>How did the number suddenly spike from 72.623 to 4548 ms</strong> in the second test?. We expect thousands of requests per day so I need to solve this issue before we finally release it . I was surprised when I saw the numbers ; I couldn't believe it. I know GO can do much better.</p>\n\n<p><strong>So basic info about the server and settings:</strong></p>\n\n<ul>\n<li>Using GO 1.5</li>\n<li>16GB RAM</li>\n<li>GOMAXPROCS is using all 8 Cores</li>\n<li>db.SetMaxIdleConns(1000)</li>\n<li>db.SetMaxOpenConns(1000) (also made sure we are using pool of\nconnections)</li>\n<li>Connecting to MYSQL through unix socket</li>\n<li>System is running under Ubuntu</li>\n</ul>\n\n<p><strong>External libraries that we are using:</strong></p>\n\n<ul>\n<li><p>github.com/go-sql-driver/mysql</p></li>\n<li><p>github.com/gorilla/mux</p></li>\n<li><p>github.com/elgs/gosqljson</p></li>\n</ul>\n\n<p>Any ideas what might be causing this? . I took a look at this <a href=\"https://stackoverflow.com/questions/26564084/golang-restful-api-load-testing-causing-too-many-database-connections\">post</a> but didn't work as I mentioned above I never got any MYSQL error. Thank you in advance for any help you can provide.</p>\n"}, {"tags": ["go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 48731, "user_id": 329700, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/41910a452554b187d044c00c576866b1?s=128&d=identicon&r=PG", "display_name": "Kevin Burke", "link": "https://stackoverflow.com/users/329700/kevin-burke"}, "edited": false, "score": 1, "creation_date": 1504027777, "post_id": 32292887, "comment_id": 78848478, "body": "Note, method #2 will only capture queries issued by that instance of the Go Mongo client. It will not capture queries issued by other Mongo clients."}, {"owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "edited": false, "score": 0, "creation_date": 1507734689, "post_id": 32292887, "comment_id": 80331188, "body": "This didnt work for me. I can see a lot of output from mgo but I do not see the query."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": false, "score": 4, "last_activity_date": 1491345410, "last_edit_date": 1491345410, "creation_date": 1440905526, "answer_id": 32292887, "question_id": 32288754, "link": "https://stackoverflow.com/questions/32288754/log-all-queries-that-mgo-fire-in-the-application/32292887#32292887", "title": "Log all queries that mgo fire in the application", "body": "<p>An answer from Gustavo Niemeyer, author of mgo : <a href=\"http://grokbase.com/t/gg/mgo-users/152571ky82/how-to-show-query-log#20150209zwzki7mxjfigdzuqp245wskkl4\" rel=\"nofollow noreferrer\">http://grokbase.com/t/gg/mgo-users/152571ky82/how-to-show-query-log#20150209zwzki7mxjfigdzuqp245wskkl4</a></p>\n\n<blockquote>\n  <p>There are two ways you can handle this issue:</p>\n  \n  <ol>\n  <li><p>By enabling MongoDB logging</p>\n  \n  <p>This is independent from the driver (mgo in this case), and can be\n  enabled in the shell or by running the respective command via mgo:</p>\n  \n  <p><a href=\"http://docs.mongodb.org/manual/reference/method/db.setProfilingLevel/\" rel=\"nofollow noreferrer\">http://docs.mongodb.org/manual/reference/method/db.setProfilingLevel/</a></p></li>\n  <li><p>By enabling mgo logging</p>\n  \n  <p>You can do this by creating a Logger via the standard package's\n  log.New function and providing it to mgo's SetLogger function:</p>\n  \n  <p><a href=\"http://golang.org/pkg/log/#New\" rel=\"nofollow noreferrer\">http://golang.org/pkg/log/#New</a>, <a href=\"http://gopkg.in/mgo.v2#SetLogger\" rel=\"nofollow noreferrer\">http://gopkg.in/mgo.v2#SetLogger</a></p></li>\n  </ol>\n  \n  <p>Use mgo.SetDebug to increase the verbosity:</p>\n  \n  <p><a href=\"http://gopkg.in/mgo.v2#SetDebug\" rel=\"nofollow noreferrer\">http://gopkg.in/mgo.v2#SetDebug</a></p>\n</blockquote>\n\n<p>So if you already have the Logger set, enable the debug mode.</p>\n"}, {"tags": [], "owner": {"reputation": 3428, "user_id": 2138200, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/61faabd8b9d251ddbe957c15517160eb?s=128&d=identicon&r=PG", "display_name": "sthomps", "link": "https://stackoverflow.com/users/2138200/sthomps"}, "is_accepted": false, "score": 3, "last_activity_date": 1507736437, "creation_date": 1507736437, "answer_id": 46692422, "question_id": 32288754, "link": "https://stackoverflow.com/questions/32288754/log-all-queries-that-mgo-fire-in-the-application/46692422#46692422", "title": "Log all queries that mgo fire in the application", "body": "<p>I couldn't get mgo to log queries using SetLogger and SetDebug. Instead, I solved this by marshaling to json string and then printing:</p>\n\n<pre><code>q = bson.M{}\njsonString, _ := json.Marshal(q)\nfmt.Printf(\"mgo query: %s\\n\", jsonString)\n</code></pre>\n\n<p>You can also copy/paste the output of this into a standard mongo client if you need to debug a query.</p>\n"}], "owner": {"reputation": 2419, "user_id": 458066, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1c3ec3c0e9c5ccfddc62ebc4d3dfdc22?s=128&d=identicon&r=PG", "display_name": "Plastic Rabbit", "link": "https://stackoverflow.com/users/458066/plastic-rabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3439, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1507736437, "creation_date": 1440868734, "question_id": 32288754, "link": "https://stackoverflow.com/questions/32288754/log-all-queries-that-mgo-fire-in-the-application", "title": "Log all queries that mgo fire in the application", "body": "<p>How to log every query with mgo in standard output?\nI set logger but it shows a lot of information without actual queries.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1440897410, "post_id": 32288048, "comment_id": 52461846, "body": "Take a look at the <code>Subrouter</code> method on Gorilla&#39;s <code>mux</code> - specifically in here - <a href=\"http://www.gorillatoolkit.org/pkg/mux\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/mux</a> (which I can&#39;t link to internally). The example around using <code>PathPrefix</code> to separate your &#39;sub-routers&#39; is likely what you&#39;re after."}], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 2, "last_activity_date": 1440897974, "creation_date": 1440897974, "answer_id": 32292335, "question_id": 32288048, "link": "https://stackoverflow.com/questions/32288048/how-to-use-go-lang-server-as-both-file-server-and-back-end-logic-server/32292335#32292335", "title": "How to use go-lang server as both file server and back-end logic server", "body": "<p>You can serve static files and implement your backend logic handlers with mux router. Use PathPrefix() and StripPrefix() for that:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/mux\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    r.PathPrefix(\"/portals/\").Handler(http.StripPrefix(\"/portals/\", http.FileServer(http.Dir(\"./portals/\"))))\n    r.PathPrefix(\"/dependencies/\").Handler(http.StripPrefix(\"/dependencies/\", http.FileServer(http.Dir(\"./dependencies/\"))))\n    r.HandleFunc(\"/registeruser\", UserRegistrationHandler)\n    r.HandleFunc(\"/deleteuser/{username}\", DeleteUserHandler)\n    http.Handle(\"/\", r)\n\n    log.Println(\"Listening...\")\n    http.ListenAndServe(\":8000\", r)\n}\n</code></pre>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 32292335, "answer_count": 1, "score": 0, "last_activity_date": 1440897974, "creation_date": 1440864562, "last_edit_date": 1440864625, "question_id": 32288048, "link": "https://stackoverflow.com/questions/32288048/how-to-use-go-lang-server-as-both-file-server-and-back-end-logic-server", "title": "How to use go-lang server as both file server and back-end logic server", "body": "<p>In php we can host application and use the same server,port to handle the back-end logic calls.</p>\n\n<p>I've used the following way to achieve this in go-lang. Is there a better way to achieve this?.</p>\n\n<pre><code>r := mux.NewRouter()\n\nhttp.HandleFunc(\"/dependencies/\", DependencyHandler) //file serving\n\nhttp.HandleFunc(\"/portals/\", PortalsHandler) //file serving\n\nr.HandleFunc(\"/registeruser\", UserRegistrationHandler)\n\nr.HandleFunc(\"/deleteuser/{username}\", DeleteUserHandler)\n\nhttp.Handle(\"/\",r)\n\ns := &amp;http.Server{\n    Addr:           \":\" + strconv.Itoa(serverConfigs.HttpPort),\n    Handler:        nil,\n    ReadTimeout:    time.Duration(serverConfigs.ReadTimeOut) * time.Second,\n    WriteTimeout:   time.Duration(serverConfigs.WriteTimeOut) * time.Second,\n    MaxHeaderBytes: 1 &lt;&lt; 20,\n}\n</code></pre>\n"}, {"tags": ["go", "negroni"], "answers": [{"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 0, "last_activity_date": 1441102978, "last_edit_date": 1441102978, "creation_date": 1440898063, "answer_id": 32292346, "question_id": 32286407, "link": "https://stackoverflow.com/questions/32286407/can-a-custom-http-handler-be-used-globally-when-using-negroni-or-only-per-reques/32292346#32292346", "title": "Can a custom HTTP handler be used globally when using Negroni or only per request?", "body": "<p>You can write a wrapper around <code>r.Handle</code> if you want. You can't do it globally with Negroni as not all middleware you use assumes your <code>handler</code> type. </p>\n\n<p>e.g.</p>\n\n<pre><code>// Named to make the example clear.\nfunc wrap(r *mux.Router, pattern string, h handler) *mux.Route {\n    return r.Handle(pattern, h)\n}\n\nfunc index(w http.ResponseWriter, r *http.Request) error {\n    io.WriteString(w, \"Hello\")\n    return nil\n}\n\nfunc main() {\n    r := mux.NewRouter()\n    wrap(r, \"/\", index)\n\n    http.ListenAndServe(\":8000\", r)\n}\n</code></pre>\n\n<p>I'd argue that this is not much better than just explicitly type-casting your handlers (which is clear, if a little repetitive), or turning your handler type into a struct. The latter you can later extend to contain thread-safe fields (your DB pool, app config, etc) that you can then explicitly pass alongside each handler).</p>\n\n<p>In reality your current router code is still clear and easy to read, and makes it obvious (to others) what type underpins your handlers.</p>\n"}], "owner": {"reputation": 1621, "user_id": 486998, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0f0a1ee2c9b6c87792a2637a95f272cf?s=128&d=identicon&r=PG", "display_name": "klotz", "link": "https://stackoverflow.com/users/486998/klotz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 1, "accepted_answer_id": 32292346, "answer_count": 1, "score": 2, "last_activity_date": 1441102978, "creation_date": 1440853767, "question_id": 32286407, "link": "https://stackoverflow.com/questions/32286407/can-a-custom-http-handler-be-used-globally-when-using-negroni-or-only-per-reques", "title": "Can a custom HTTP handler be used globally when using Negroni or only per request?", "body": "<p>To make sure error results are handled correctly across all requests I'm implementing a custom handler as described in <a href=\"http://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">http://blog.golang.org/error-handling-and-go</a>. So instead of only accepting the <code>w http.ResponseWriter, r *http.Request</code> params the handler optionally returns an <code>error</code>.</p>\n\n<p>I'm using Negroni and wondered whether I can set it up once to wrap all requests into <code>handler</code> or if it will always have to be set up on a per-request basis as done for <code>/</code> and <code>/foo</code> in the following example?</p>\n\n<pre><code>type handler func(w http.ResponseWriter, r *http.Request) error\n\n// ServeHTTP checks for error results and handles them globally\nfunc (fn handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    if err := fn(w, r); err != nil {\n        http.Error(w, err, http.StatusInternalServerError)\n    }\n}\n\n// Index matches the `handler` type and returns an error\nfunc Index(w http.ResponseWriter, r *http.Request) error {\n    return errors.New(\"something went wrong\")\n}\n\nfunc main() {\n    router := mux.NewRouter()\n    // note how `Index` is wrapped into `handler`. Is there a way to \n    // make this global? Or will the handler(fn) pattern be required \n    // for every request?\n    router.Handle(\"/\", handler(Index)).Methods(\"GET\")\n    router.Handle(\"/foo\", handler(Index)).Methods(\"GET\")\n\n    n := negroni.New(\n        negroni.NewRecovery(),\n        negroni.NewLogger(),\n        negroni.Wrap(router),\n    )\n\n    port := os.Getenv(\"PORT\")\n    n.Run(\":\" + port)\n}\n</code></pre>\n"}, {"tags": ["go", "download", "http-status-code-403", "user-profile", "google-domain-api"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 4460533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62c7476d0b4abad1e9e876381840b0a?s=128&d=identicon&r=PG&f=1", "display_name": "Ameerkhan", "link": "https://stackoverflow.com/users/4460533/ameerkhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1447828624, "creation_date": 1447828624, "answer_id": 33773319, "question_id": 32284040, "link": "https://stackoverflow.com/questions/32284040/golang-program-for-retrieving-google-domain-profile-returns-403-forbidden/33773319#33773319", "title": "Golang program for retrieving google+ Domain profile returns 403 Forbidden", "body": "<p>Forbidden error will occur due to token problem with plus API. After you got token for the person you are authenticating, you can simply write code as below to get people information.</p>\n\n<pre><code>func (p *GoogleAUTH) sendGoogleAuthReq(){\n   baseUrl := \"https://www.googleapis.com/plus/v1/people/me\"\n   authbear := \"Bearer \"\n   authbear += &lt;access_token&gt;\n   cli := &amp;http.Client{}\n   req, _ := http.NewRequest(\"GET\", baseUrl, nil)\n   req.Header.Set(\"Authorization\", authbear)\n   res, _ := cli.Do(req)\n   bo, _ := ioutil.ReadAll(res.Body)\n   fmt.Println(string(bo))\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5279355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/562501e0497836503e85c7726907b116?s=128&d=identicon&r=PG&f=1", "display_name": "Pradyumna Prasad", "link": "https://stackoverflow.com/users/5279355/pradyumna-prasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1447828624, "creation_date": 1440836254, "question_id": 32284040, "link": "https://stackoverflow.com/questions/32284040/golang-program-for-retrieving-google-domain-profile-returns-403-forbidden", "title": "Golang program for retrieving google+ Domain profile returns 403 Forbidden", "body": "<p>Can you please help me with the below problem.</p>\n\n<p>I am just writing a simple code to retrieve my google+ Domain user profile.\n1. I am using a google+ Domain Account with the domain name spaceandhow.com</p>\n\n<ol start=\"2\">\n<li><p>I have provided all the privileges as listed in <a href=\"https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority\" rel=\"noreferrer\">https://developers.google.com/identity/protocols/OAuth2ServiceAccount#delegatingauthority</a></p></li>\n<li><p>Both Google+ API and Google+ Domain Api are enabled on the account.</p></li>\n</ol>\n\n<p>This is the function I have written.</p>\n\n<pre><code>func (p *GoogleAUTH) sendGoogleAuthReq(){\n\n    fmt.Println(\"GoogleAUTH package: Enter sendGoogleAuthReq\")\n\n\n    data, err := ioutil.ReadFile(\"D:\\\\Cygwin\\\\home\\\\praprasa\\\\pragna2.json\")\n    if err != nil {\n        fmt.Printf(\"ReadFile error: %s\", err)\n    }\n\n\n    conf, err := google.JWTConfigFromJSON(data, \"https://www.googleapis.com/auth/plus.me\")\n    if err != nil {\n        fmt.Println(\"json error\")\n\n    }\n\n    client := conf.Client(oauth2.NoContext)\n\n    resp, err := client.Get(\"https://www.googleapis.com/plusDomains/v1/people/me\")\n    if err != nil {\n        fmt.Printf(\"GoogleAUTH package: request execution failed: %s\", err)\n        return\n    }\n    defer resp.Body.Close()\n\n    fmt.Println(\"GoogleAUTH package: response Status:\", resp.Status)\n    fmt.Println(\"GoogleAUTH package: response Headers:\", resp.Header)\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Printf(\"GoogleAUTH package: cannot fetch token: %v\", err)\n        return\n    }\n\n    fmt.Println(\"GoogleAUTH package: response Body:\", string(body))\n\n    fmt.Println(\"GoogleAUTH package: Exit sendGoogleAuthReq\")   \n}\n</code></pre>\n\n<p>This is the error message i get</p>\n\n<pre><code>GoogleAUTH package: response Status: 403 Forbidden\nGoogleAUTH package: response Headers: map[Vary:[Origin X-Origin] X-Frame-Options:[SAMEORIGIN] X-Xss-Protection:[1; mode=block] Cache-Control:[private, max-age=0] Server:[GSE] Date:[Sat, 29 Aug 2015 07:55:47 GMT] Content-Type:[application/json; charset=UTF-8] Expires:[Sat, 29 Aug 2015 07:55:47 GMT] X-Content-Type-Options:[nosniff] Alternate-Protocol:[443:quic,p=1] Alt-Svc:[quic=\":443\"; p=\"1\"; ma=604800]]\nGoogleAUTH package: response Body: {\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"forbidden\",\n    \"message\": \"Forbidden\"\n   }\n  ],\n  \"code\": 403,\n  \"message\": \"Forbidden\"\n }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6344, "user_id": 1960180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ScAeW.png?s=128&g=1", "display_name": "Aaron D", "link": "https://stackoverflow.com/users/1960180/aaron-d"}, "edited": false, "score": 0, "creation_date": 1440830622, "post_id": 32283403, "comment_id": 52444915, "body": "This kind of question is rather subjective and is going to attract opinionated answers. That said, my opinion is that your function should do what it says on the lid, and if you need to sleep between running your bot, the caller should wait, not the <code>StartTradeBot()</code> function."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 6344, "user_id": 1960180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ScAeW.png?s=128&g=1", "display_name": "Aaron D", "link": "https://stackoverflow.com/users/1960180/aaron-d"}, "edited": false, "score": 0, "creation_date": 1440830761, "post_id": 32283403, "comment_id": 52444936, "body": "@AaronD Does that mean the second part of calling the goroutine would be your preference?"}, {"owner": {"reputation": 6344, "user_id": 1960180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ScAeW.png?s=128&g=1", "display_name": "Aaron D", "link": "https://stackoverflow.com/users/1960180/aaron-d"}, "edited": false, "score": 1, "creation_date": 1440830844, "post_id": 32283403, "comment_id": 52444948, "body": "Yes. It makes the <code>StartTradeBot</code> function reusable without the built-in sleep call. That is, unless you <i>always</i> want to sleep as part of calling the bot function."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 6344, "user_id": 1960180, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ScAeW.png?s=128&g=1", "display_name": "Aaron D", "link": "https://stackoverflow.com/users/1960180/aaron-d"}, "edited": false, "score": 0, "creation_date": 1440830896, "post_id": 32283403, "comment_id": 52444956, "body": "@AaronD Yeah its just a poll to see if any trades are active and it runs all the time"}, {"owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "edited": false, "score": 2, "creation_date": 1440839614, "post_id": 32283403, "comment_id": 52446871, "body": "the two  do different things. the first one does ... waits until finished  and waits then 20 seconds , the second one starts the ... async, every 20 seconds. but the previous one could still be executing.  If you want to poll every 20 seconds, as you write, i&#39;d do: <code>for range time.Tick(20*time.Second) {    &#47;&#47; do stuff}</code>"}, {"owner": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "edited": false, "score": 0, "creation_date": 1440839854, "post_id": 32283403, "comment_id": 52446948, "body": "Agreed with Adam - the fundamental question is why you wait? Also, have you considered the use of a channel to trigger the processing?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "edited": false, "score": 0, "creation_date": 1440840537, "post_id": 32283403, "comment_id": 52447103, "body": "@AlessandroSantini Basically it&#39;s a bot that polls every 20 seconds to see if any new trades have came in, it polls a remote API provided by Steam I want it up and running as soon as my program starts"}, {"owner": {"reputation": 1878, "user_id": 1176867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6eb5b6ce0fb206463e1fbf6729737c1?s=128&d=identicon&r=PG", "display_name": "Alessandro Santini", "link": "https://stackoverflow.com/users/1176867/alessandro-santini"}, "edited": false, "score": 0, "creation_date": 1440841386, "post_id": 32283403, "comment_id": 52447272, "body": "@Datsik I think it could get more complicated then - how critical is that you poll each 20 seconds? In the first case you will poll each 20 seconds + routine processing time; in the second case, if the processing takes more than 20 seconds, you may end up having two goroutines possibly contending resources because they run in parallel."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1440906240, "creation_date": 1440906240, "answer_id": 32292942, "question_id": 32283403, "link": "https://stackoverflow.com/questions/32283403/is-it-more-efficient-to-put-the-entire-function-in-a-infinite-loop-with-a-time-s/32292942#32292942", "title": "Is it more efficient to put the entire function in a infinite loop with a time.Sleep at the end or loop a go routine?", "body": "<p>There are at least three variations on how do this, each with different functionality. Because the interval is 20 seconds, the difference in performance is negligible. Pick the variation that best meets the application's functionality requirements.</p>\n\n<p>Option 1: Pause 20 seconds between each operation. </p>\n\n<pre><code>for {\n    // Do stuff\n    time.Sleep(20 * time.Second)\n}\n</code></pre>\n\n<p>Option 2: Start an operation every 20 seconds, even if previous operation is still executing.</p>\n\n<pre><code>for {\n   go func() {\n      // Do stuff\n   }()\n   time.Sleep(20 * time.Second)\n}\n</code></pre>\n\n<p>Option 3: Start operation every 20 seconds or after previous operation completes, whichever is later.</p>\n\n<pre><code>t := time.NewTicker(20 * time.Second)\nfor range t.C {\n   // Do stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440906240, "creation_date": 1440830422, "question_id": 32283403, "link": "https://stackoverflow.com/questions/32283403/is-it-more-efficient-to-put-the-entire-function-in-a-infinite-loop-with-a-time-s", "title": "Is it more efficient to put the entire function in a infinite loop with a time.Sleep at the end or loop a go routine?", "body": "<p>I have a function that I want to poll every 20 seconds or so right now it's called in a go routine like so:</p>\n\n<p><code>go StartTradeBot()</code></p>\n\n<p>then in the body of the function:</p>\n\n<pre><code>func StartTradeBot() {\n    for {\n        // All the stuff to do\n        time.Sleep(20 * time.Second)\n    }\n}\n</code></pre>\n\n<p>Is it more efficient like this?</p>\n\n<p>or should I wrap my goroutine instead like</p>\n\n<pre><code>for {\n    go StartTradeBot()\n    time.Sleep(20 * time.Second)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440851454, "post_id": 32282967, "comment_id": 52449765, "body": "<a href=\"https://golang.org/pkg/strconv/#FormatUint\" rel=\"nofollow noreferrer\"><code>strconv.FormatUint</code></a> takes two arguments."}], "tags": [], "owner": {"reputation": 155397, "user_id": 978917, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/92d059913eace78a868a3e87f98e0a57?s=128&d=identicon&r=PG", "display_name": "ruakh", "link": "https://stackoverflow.com/users/978917/ruakh"}, "is_accepted": true, "score": 5, "last_activity_date": 1440859546, "last_edit_date": 1440859546, "creation_date": 1440825672, "answer_id": 32282967, "question_id": 32282922, "link": "https://stackoverflow.com/questions/32282922/how-can-i-convert-a-custom-type-to-a-string/32282967#32282967", "title": "How can I convert a custom type to a string?", "body": "<p><code>ClassId</code> is declared as <code>type ClassId uint64</code>, so although a <code>ClassId</code> isn't exactly the same as a <code>uint64</code>, they have the same <em>underlying type</em>, and you can therefore <em>convert</em> from one to the other. To convert a value <code>x</code> to type <code>T</code> (when permitted), you write <code>T(x)</code>. So, in your case:</p>\n\n<pre><code> funcThatTakesAString(strconv.FormatUint(uint64(classId), 10))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 939, "user_id": 4648046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932ac0b92feea46110e78577f7047c74?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy R.", "link": "https://stackoverflow.com/users/4648046/eddy-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1440830431, "creation_date": 1440830431, "answer_id": 32283406, "question_id": 32282922, "link": "https://stackoverflow.com/questions/32282922/how-can-i-convert-a-custom-type-to-a-string/32283406#32283406", "title": "How can I convert a custom type to a string?", "body": "<p>Another approach that is perhaps more idiomatic is to use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow\">fmt.Sprintf</a> using Go's <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\">format string specification</a>.</p>\n\n<p>Two examples...</p>\n\n<p>The following converts the classId into a string base 10 number:</p>\n\n<p><code>classIDStr := fmt.Sprintf(\"%d\", classId)</code></p>\n\n<p>The following converts it into a string hexadecimal number, with a-f digits in lower case:</p>\n\n<p><code>classIDHex := fmt.Sprintf(\"%x\", classId)</code></p>\n"}, {"tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": false, "score": 6, "last_activity_date": 1440833841, "creation_date": 1440833841, "answer_id": 32283779, "question_id": 32282922, "link": "https://stackoverflow.com/questions/32282922/how-can-i-convert-a-custom-type-to-a-string/32283779#32283779", "title": "How can I convert a custom type to a string?", "body": "<p>more generally you could implement the stringer interface on your type <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"noreferrer\">https://golang.org/pkg/fmt/#Stringer</a> </p>\n\n<pre><code>func (c ClassId) String() string {\n    return strconv.FormatUint(uint64(c),10)\n}\n</code></pre>\n\n<p>and use that otherFunc(classId.String())</p>\n\n<p><a href=\"http://play.golang.org/p/cgdQZNR8GF\" rel=\"noreferrer\">http://play.golang.org/p/cgdQZNR8GF</a></p>\n\n<p>PS: also acronymes (ID) should be all capitals </p>\n\n<p><a href=\"http://talks.golang.org/2014/names.slide#6\" rel=\"noreferrer\">http://talks.golang.org/2014/names.slide#6</a></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4600, "favorite_count": 0, "accepted_answer_id": 32282967, "answer_count": 3, "score": 3, "last_activity_date": 1440859546, "creation_date": 1440825047, "question_id": 32282922, "link": "https://stackoverflow.com/questions/32282922/how-can-i-convert-a-custom-type-to-a-string", "title": "How can I convert a custom type to a string?", "body": "<p>I'm using a package and instead of returning a <code>string</code>, it returns a <code>economy.ClassId</code> You can see <a href=\"http://godoc.org/github.com/Philipp15b/go-steam/economy\" rel=\"nofollow\">here</a></p>\n\n<p>I want to pass the <code>economy.ClassId</code> which is just a string of numbers like \"531569319\" to a function that takes a string not a <code>economy.ClassId</code> so is there a way to convert this type to a string or no. Thanks.</p>\n\n<p>I know you could like <code>strconv.FormatUint()</code> but what would I use for a custom type.</p>\n"}, {"tags": ["json", "struct", "go"], "comments": [{"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440814388, "post_id": 32281711, "comment_id": 52442405, "body": "The struct in my answer is quite similar to where you are right now, see the latest edit."}], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440815038, "post_id": 32281923, "comment_id": 52442531, "body": "We have the exact same stuff but I&#39;m getting: <code>json: cannot unmarshal bool into Go value of type gosm.Numbered</code>"}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440815414, "post_id": 32281923, "comment_id": 52442594, "body": "I wasn&#39;t checking my error return on the <code>Unmarshal</code>, a similar message shows for me. It&#39;s the <code>success</code>, it can&#39;t go into the struct."}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440815840, "post_id": 32281923, "comment_id": 52442664, "body": "It happens because <code>&quot;success&quot;</code> only has the <code>true</code> value, not the full struct which I&#39;m calling <code>Numbered</code>. We need to use <code>json.RawMessage</code> to separate it, I&#39;ll post another edit."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440816335, "post_id": 32281923, "comment_id": 52442752, "body": "Thanks I&#39;m going to try this out and see if it works... Why does this seem so much more convoluted than it needs to be?"}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1440816472, "post_id": 32281923, "comment_id": 52442782, "body": "Check hobbs&#39; answer too, he is more concise and I think arrives at a better solution. In my opinion, the json string is very weird, it doesn&#39;t map well to any struct I can think of. In these cases we need to do extra work."}], "tags": [], "owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "is_accepted": false, "score": 1, "last_activity_date": 1440816148, "last_edit_date": 1440816148, "creation_date": 1440812953, "answer_id": 32281923, "question_id": 32281711, "link": "https://stackoverflow.com/questions/32281711/how-do-i-format-a-json-struct-with-multiple-object-returns-dynamic/32281923#32281923", "title": "How do I format a json struct with multiple object returns? (Dynamic)", "body": "<p>I suggest playing with the base <code>map[string]interface{}</code> type and iterating  from the json string until you can build the whole struct. For the parts where you don't really know the keys, such as the 0-20, the map may be all you'll have.</p>\n\n<p>For example, suppose the string your example is in variable <code>j</code>. You could start with:</p>\n\n<pre><code>type AssetInfo struct {\n    Result map[string]interface{}\n}\n</code></pre>\n\n<p>and start unmarshaling and printing in order to find the full struct:</p>\n\n<pre><code>var ai AssetInfo\njson.Unmarshal([]byte(j), &amp;ai)\nfmt.Printf(\"%#v\\n\", ai)\n</code></pre>\n\n<p>This prints the entire map built after unmarshaling. Trying to build the whole struct beforehand with such a complex structure is unlikely to get you results.</p>\n\n<p>EDIT: If you treat Result as a <code>map[string]struct</code> like you did with <code>Descriptions</code> the Success bool is \"lost\" and goes into the map but the rest of the json unmarshals correctly. I don't see a way to support the <code>Success</code> bool as well as a map for the rest of the structure. As for the numbered keys, if you need a slice, you'll have to do some work after the unmarshal.</p>\n\n<pre><code>type AssetInfo struct {\n    Result map[string]Numbered\n}\n\ntype Numbered struct {\n    IconUrl          string                 `json:\"icon_url\"`\n    IconUrlLarge     string                 `json:\"icon_url_large\"`\n    IconDragUrl      string                 `json:\"icon_drag_url\"`\n    Name             string                 `json:\"name\"`\n    MarketHashName   string                 `json:\"market_hash_name\"`\n    MarketName       string                 `json:\"market_name\"`\n    NameColor        string                 `json:\"name_color\"`\n    BGColor          string                 `json:\"background_color\"`\n    Type             string                 `json:\"type\"`\n    Tradable         string                 `json:\"tradable\"`\n    Marketable       string                 `json:\"marketable\"`\n    Commodity        string                 `json:\"commodity\"`\n    TradeRestrict    string                 `json:\"market_tradeable_restriction\"`\n    FraudWarnings    string                 `json:\"fraudwarnings\"`\n    Descriptions     map[string]description `json:\"descriptions\"`\n    OwnerDescription string                 `json:\"owner_descriptions\"`\n    Tags             map[string]tag         `json:\"tags\"`\n    ClassID          string                 `json:\"classid\"`\n}\n\ntype description struct {\n    Type    string `json:\"type\"`\n    Value   string `json:\"value\"`\n    Color   string `json:\"color,omitempty\"`\n    AppData string `json:\"appdata\"`\n}\n\ntype tag struct {\n    InternalName string `json:\"internal_name\"`\n    Name         string `json:\"name\"`\n    Category     string `json:\"category\"`\n    Color        string `json:\"color,omitempty\"`\n    CategoryName string `json:\"category_name\"`\n}\n\nfunc main() {\n    var ai AssetInfo\n    json.Unmarshal([]byte(j), &amp;ai)\n    fmt.Printf(\"%+v\\n\", ai.Result[\"720268538\"].Tags)\n}\n</code></pre>\n\n<p>The output of the <code>Tags</code> is <code>map[0:{InternalName:CSGO_Type_WeaponCase Name:Container Category:Type Color: CategoryName:Type} 1:{InternalName:set_community_6 Name:The Chroma Collection Category:ItemSet Color: CategoryName:Collection} (...)</code></p>\n\n<p>EDIT 2: After discussion in the comments I ended up at some code which is very similar to hobbs' answer. His might be better organized.</p>\n\n<p>We need to use <code>json.RawMessage</code> since the <code>true</code> value for <code>\"success\"</code> can't go into the <code>Numbered</code> struct.</p>\n\n<pre><code>type AssetInfo struct {\n    Result map[string]json.RawMessage\n}\n\nerr := json.Unmarshal([]byte(j), &amp;ai)\nfmt.Println(\"outer error\", err) // prints &lt;nil&gt;\nfor k, v := range ai.Result {\n    // this is very similar to the example on the docs: https://golang.org/pkg/encoding/json/#RawMessage\n    var dst interface{} \n    if k == \"success\" {\n        dst = new(bool)\n    } else {\n        dst = new(Numbered)\n    }\n    err := json.Unmarshal(v, dst)\n    fmt.Println(\"inner error\", err) // prints &lt;nil&gt;\n    if k == \"success\" {\n        b := dst.(*bool)\n        fmt.Printf(\"%t\\n\", *b) // true\n    } else {\n        fmt.Printf(\"%+v\\n\", dst) // the whole Numbered struct\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440816560, "post_id": 32282090, "comment_id": 52442796, "body": "Thanks for the reply, in <code>range intermediate</code> what is <code>intermediate</code> in this, is this some variable somewhere or?"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440816634, "post_id": 32282090, "comment_id": 52442804, "body": "@Datsik it&#39;s the <code>AssetIntermediate</code> that you decoded the original JSON into."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440821185, "post_id": 32282090, "comment_id": 52443492, "body": "Damn you&#39;re good! Would it be too much to ask for you to comment out your answer just to explain what exactly is happening that would be fantastic. Thanks. I&#39;ve only been using Go for maybe 2-3 weeks I&#39;m not sure why you need a <code>Reader</code> in this"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440822041, "post_id": 32282090, "comment_id": 52443596, "body": "@Datsik I added some comments and fixed a small error. Better?"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440822091, "post_id": 32282090, "comment_id": 52443607, "body": "@Datsik actually you don&#39;t, force of habit. I&#39;ll change it to use <code>Unmarshal</code> :)"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440822625, "post_id": 32282090, "comment_id": 52443686, "body": "Hey thanks a lot that&#39;s awesome, I&#39;m also used to using <code>json.NewDecoder().Decode()</code> but to each their own haha - <a href=\"https://github.com/Gacnt/go-steam-market\" rel=\"nofollow noreferrer\">github.com/Gacnt/go-steam-market</a> is what I was working on and it&#39;s now up to my liking :)"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440822746, "post_id": 32282090, "comment_id": 52443693, "body": "<code>NewDecoder</code> only takes an <code>io.Reader</code>, <code>Unmarshal</code> takes a <code>[]byte</code>. We already have a <code>[]byte</code> so it is kind of silly to wrap it in a <code>bytes.Reader</code> just to be able to use <code>NewDecoder</code> :)"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1440822357, "last_edit_date": 1440822357, "creation_date": 1440814746, "answer_id": 32282090, "question_id": 32281711, "link": "https://stackoverflow.com/questions/32281711/how-do-i-format-a-json-struct-with-multiple-object-returns-dynamic/32282090#32282090", "title": "How do I format a json struct with multiple object returns? (Dynamic)", "body": "<p>You're going to kick yourself for the first mistake -- your JSON has <code>result</code> but your struct tag has <code>response</code>.</p>\n\n<p>The second problem is a trickier one. The thing is that you declared that your <code>Asset</code> map is nested inside the result as a key called \"asset\", but that's not true. Actually it's just all of the keys of the result <em>other</em> than success/error. Unfortunately, <code>encoding/json</code> doesn't have any way to express this. You can say that <code>result</code> is a <code>map[string]interface{}</code>, and then success/error if they exist will be bool/string, and the assets will be more <code>map[string]interface{}</code>s containing keys for all of the other fields. That works, but it's a bit ugly/inefficient, and a lot of work if you want to convert into a proper struct type so that you can have methods on it.</p>\n\n<p>Maybe a better way to go is to decode into this type:</p>\n\n<pre><code>type AssetIntermediate struct {\n    Result map[string]json.RawMessage `json:\"result\"`\n}\n</code></pre>\n\n<p>as well as having</p>\n\n<pre><code>type Asset struct { /* all those fields */ }\ntype AssetInfo struct {\n    Success bool\n    Error string\n    Assets map[string]Asset\n}\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>var intermediate AssetIntermediate\nerr := json.Unmarshal(data, &amp;intermediate)\n/* handle err */\n\nvar ai AssetInfo\n\n/* At this point, intermediate.Result is a map\n * of strings to json.RawMessage, which is just a []byte\n * containing not-yet-decoded JSON. We want to take\n * each field and put it into ai where it belongs.\n */\nfor k, v := range intermediate.Result {\n    var err error\n    // error and success keys are decoded into the respective fields\n    if k == \"error\" {\n        err = json.Unmarshal(v, &amp;ai.Error)\n    } else if k == \"success\" {\n        err = json.Unmarshal(v, &amp;ai.Success)\n    } else {\n        // Otherwise, we have an asset. First decode it...\n        var asset Asset\n        err = json.Unmarshal(v, &amp;asset)\n        if err == nil {\n            // Create the Assets map if it doesn't exist yet\n            if ai.Assets == nil {\n                ai.Assets = map[string]Asset{}\n            }\n            // And store the asset in the map under the key k.\n            ai.Assets[k] = asset\n        }\n    }\n    /* handle err if non-nil */\n}\n</code></pre>\n\n<p>which is a lot more work than a single <code>Decode</code> call, but it should basically do the right thing.</p>\n\n<p>If all of this is inside a function that returns <code>(*AssetInfo, error)</code> then the right thing to put in place of <code>/* Handle err */</code> might be</p>\n\n<pre><code>if err != nil {\n    return nil, err\n}\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 32282090, "answer_count": 2, "score": 2, "last_activity_date": 1440822357, "creation_date": 1440810320, "last_edit_date": 1440821917, "question_id": 32281711, "link": "https://stackoverflow.com/questions/32281711/how-do-i-format-a-json-struct-with-multiple-object-returns-dynamic", "title": "How do I format a json struct with multiple object returns? (Dynamic)", "body": "<p>I have an API call and it returns like this:</p>\n\n<pre><code>{\n    \"result\": {\n        \"720268538\": {\n            \"icon_url\": \"-9a81dlWLwJ2UUGcVs_nsVtzdOEdtWwKGZZLQHTxDZ7I56KU0Zwwo4NUX4oFJZEHLbXU5A1PIYQNqhpOSV-fRPasw8rsUFJ5KBFZv668FFEuh_KQJTtEuI63xIXbxqOtauyClTMEsJV1jruS89T3iQKx_BBqa2j3JpjVLFH1xpp0EQ\",\n            \"icon_url_large\": \"\",\n            \"icon_drag_url\": \"\",\n            \"name\": \"Chroma Case\",\n            \"market_hash_name\": \"Chroma Case\",\n            \"market_name\": \"Chroma Case\",\n            \"name_color\": \"D2D2D2\",\n            \"background_color\": \"\",\n            \"type\": \"Base Grade Container\",\n            \"tradable\": \"1\",\n            \"marketable\": \"1\",\n            \"commodity\": \"1\",\n            \"market_tradable_restriction\": \"7\",\n            \"fraudwarnings\": \"\",\n            \"descriptions\": {\n                \"0\": {\n                    \"type\": \"html\",\n                    \"value\": \" \",\n                    \"app_data\": \"\"\n                },\n                \"1\": {\n                    \"type\": \"html\",\n                    \"value\": \"Container Series #38\",\n                    \"color\": \"99ccff\",\n                    \"app_data\": \"\"\n                },\n                \"2\": {\n                    \"type\": \"html\",\n                    \"value\": \" \",\n                    \"app_data\": \"\"\n                },\n                \"3\": {\n                    \"type\": \"html\",\n                    \"value\": \"Contains one of the following:\",\n                    \"app_data\": \"\"\n                },\n                \"4\": {\n                    \"type\": \"html\",\n                    \"value\": \"Glock-18 | Catacombs\",\n                    \"color\": \"4b69ff\",\n                    \"app_data\": \"\"\n                },\n                \"5\": {\n                    \"type\": \"html\",\n                    \"value\": \"M249 | System Lock\",\n                    \"color\": \"4b69ff\",\n                    \"app_data\": \"\"\n                },\n                \"6\": {\n                    \"type\": \"html\",\n                    \"value\": \"MP9 | Deadly Poison\",\n                    \"color\": \"4b69ff\",\n                    \"app_data\": \"\"\n                },\n                \"7\": {\n                    \"type\": \"html\",\n                    \"value\": \"SCAR-20 | Grotto\",\n                    \"color\": \"4b69ff\",\n                    \"app_data\": \"\"\n                },\n                \"8\": {\n                    \"type\": \"html\",\n                    \"value\": \"XM1014 | Quicksilver\",\n                    \"color\": \"4b69ff\",\n                    \"app_data\": \"\"\n                },\n                \"9\": {\n                    \"type\": \"html\",\n                    \"value\": \"Dual Berettas | Urban Shock\",\n                    \"color\": \"8847ff\",\n                    \"app_data\": \"\"\n                },\n                \"10\": {\n                    \"type\": \"html\",\n                    \"value\": \"Desert Eagle | Naga\",\n                    \"color\": \"8847ff\",\n                    \"app_data\": \"\"\n                },\n                \"11\": {\n                    \"type\": \"html\",\n                    \"value\": \"MAC-10 | Malachite\",\n                    \"color\": \"8847ff\",\n                    \"app_data\": \"\"\n                },\n                \"12\": {\n                    \"type\": \"html\",\n                    \"value\": \"Sawed-Off | Serenity\",\n                    \"color\": \"8847ff\",\n                    \"app_data\": \"\"\n                },\n                \"13\": {\n                    \"type\": \"html\",\n                    \"value\": \"AK-47 | Cartel\",\n                    \"color\": \"d32ce6\",\n                    \"app_data\": \"\"\n                },\n                \"14\": {\n                    \"type\": \"html\",\n                    \"value\": \"M4A4 | \u9f8d\u738b (Dragon King)\",\n                    \"color\": \"d32ce6\",\n                    \"app_data\": \"\"\n                },\n                \"15\": {\n                    \"type\": \"html\",\n                    \"value\": \"P250 | Muertos\",\n                    \"color\": \"d32ce6\",\n                    \"app_data\": \"\"\n                },\n                \"16\": {\n                    \"type\": \"html\",\n                    \"value\": \"AWP | Man-o'-war\",\n                    \"color\": \"eb4b4b\",\n                    \"app_data\": \"\"\n                },\n                \"17\": {\n                    \"type\": \"html\",\n                    \"value\": \"Galil AR | Chatterbox\",\n                    \"color\": \"eb4b4b\",\n                    \"app_data\": \"\"\n                },\n                \"18\": {\n                    \"type\": \"html\",\n                    \"value\": \"or an Exceedingly Rare Special Item!\",\n                    \"color\": \"ffd700\",\n                    \"app_data\": \"\"\n                },\n                \"19\": {\n                    \"type\": \"html\",\n                    \"value\": \" \",\n                    \"app_data\": \"\"\n                },\n                \"20\": {\n                    \"type\": \"html\",\n                    \"value\": \"\",\n                    \"color\": \"00a000\",\n                    \"app_data\": {\n                        \"limited\": \"1\"\n                    }\n                }\n            },\n            \"owner_descriptions\": \"\",\n            \"tags\": {\n                \"0\": {\n                    \"internal_name\": \"CSGO_Type_WeaponCase\",\n                    \"name\": \"Container\",\n                    \"category\": \"Type\",\n                    \"category_name\": \"Type\"\n                },\n                \"1\": {\n                    \"internal_name\": \"set_community_6\",\n                    \"name\": \"The Chroma Collection\",\n                    \"category\": \"ItemSet\",\n                    \"category_name\": \"Collection\"\n                },\n                \"2\": {\n                    \"internal_name\": \"normal\",\n                    \"name\": \"Normal\",\n                    \"category\": \"Quality\",\n                    \"category_name\": \"Category\"\n                },\n                \"3\": {\n                    \"internal_name\": \"Rarity_Common\",\n                    \"name\": \"Base Grade\",\n                    \"category\": \"Rarity\",\n                    \"color\": \"b0c3d9\",\n                    \"category_name\": \"Quality\"\n                }\n            },\n            \"classid\": \"720268538\"\n        },\n        \"success\": true\n    }\n}\n</code></pre>\n\n<p>Result can have multiple returns I was wondering how the struct should look, this is what I have so far but it returns like nothing.</p>\n\n<pre><code>type AssetInfo struct {\n    Result `json:\"result\"`\n}\n\ntype Result struct {\n    Asset   map[string]Asset `json:\"asset\"`\n    Success bool             `json:\"success,omitempty\"`\n}\n\ntype Asset struct {\n    IconUrl           string                   `json:\"icon_url,omitempty\"`\n    IconUrlLarge      string                   `json:\"icon_url_large,omitempty\"`\n    IconDragUrl       string                   `json:\"icon_drag_url,omitempty\"`\n    Name              string                   `json:\"name,omitempty\"`\n    MarketHashName    string                   `json:\"market_hash_name,omitempty\"`\n    MarketName        string                   `json:\"market_name,omitempty\"`\n    NameColor         string                   `json:\"name_color,omitempty\"`\n    BGColor           string                   `json:\"background_color,omitempty\"`\n    Type              string                   `json:\"type,omitempty\"`\n    Tradable          string                   `json:\"tradable,omitempty\"`\n    Marketable        string                   `json:\"marketable,omitempty\"`\n    Commodity         string                   `json:\"commodity,omitempty\"`\n    TradeRestrict     string                   `json:\"market_tradeable_restriction,omitempty\"`\n    FraudWarnings     string                   `json:\"fraudwarnings,omitempty\"`\n    Descriptions      map[string]*Descriptions `json:\"descriptions,omitempty\"`\n    OwnerDescriptions string                   `json:\"owner_descriptions,omitempty\"`\n    Tags              map[string]*Tags         `json:\"tags,omitempty\"`\n    ClassId           string                   `json:\"classid,omitempty\"`\n}\n\ntype Descriptions struct {\n    Type    string `json:\"type\"`\n    Value   string `json:\"value\"`\n    Color   string `json:\"color,omitempty\"`\n    AppData string `json:\"appdata\"`\n}\n\ntype Tags struct {\n    InternalName string `json:\"internal_name\"`\n    Name         string `json:\"name\"`\n    Category     string `json:\"category\"`\n    Color        string `json:\"color,omitempty\"`\n    CategoryName string `json:\"category_name\"`\n}\n</code></pre>\n\n<p>If anybody could tell me what's wrong with my struct that would be great thanks.</p>\n\n<p>The thing that confuses me is like how Descriptions returns not an array but multiple objects that could range from 0-20 how do I prepare a struct for this when I don't know how many objects are going to return, as well <code>result</code> can return multiple <code>\"720616831\"</code> so how should this look?</p>\n"}, {"tags": ["memory", "go", "cpu-usage"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440812426, "post_id": 32281591, "comment_id": 52442137, "body": "Are these both on Go 1.5? (Or both 1.4?) And is that really all the code running on the server? I&#39;d try running with gctrace=1 to see if GC behavior is different between them."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440812505, "post_id": 32281591, "comment_id": 52442149, "body": "As a minor thing--you want <code>log.Println</code> instead of <code>log.Printf</code> to avoid the <code>EXTRA</code> output you&#39;re getting."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440812748, "post_id": 32281591, "comment_id": 52442188, "body": "Oh--if the test requests are all local to your Mac on the first test, but remote over the Internet on the second test, you could be measuring network delay, not computation. <code>ReadFrom(pRequest.Body)</code> will take as long as it takes for the request body to be transmitted. That&#39;s my best guess right now. You could use <code>top</code> or some tool to see if there is high CPU usage on the server."}, {"owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440813530, "post_id": 32281591, "comment_id": 52442286, "body": "@twotwotwo version server linux go1.3.3 linux/amd64 , version mac go version go1.4 darwin/amd64, the test are remote and are executed by ssh terminal , so that nothing is travelling over the internet all is execute in the server"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440819579, "post_id": 32281591, "comment_id": 52443259, "body": "OK -- I would run both tests under the same version, and I suggest 1.5, which <a href=\"https://stackoverflow.com/questions/31684862/how-fast-is-the-go-1-5-gc-with-terabytes-of-ram\">could improve responsiveness a lot if it&#39;s a GC issue</a>. And I&#39;d run them with <a href=\"http://godoc.org/runtime\" rel=\"nofollow noreferrer\"><code>GODEBUG=gctrace=1</code></a> and add results to the question by editing."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440819984, "post_id": 32281591, "comment_id": 52443318, "body": "If <i>SoapUI</i> pauses at the wrong time, that could also affect your timings. Java versions could also be a factor. You could try getting results with a different, non-Java-based load generator like <a href=\"https://github.com/rakyll/boom\" rel=\"nofollow noreferrer\">github.com/rakyll/boom</a> or <code>ab</code>, or see if odd timings remain if you copy to <code>ioutil.Discard</code> instead of a <code>bytes.Buffer</code>."}], "owner": {"reputation": 1153, "user_id": 1371064, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/NnrmE.jpg?s=128&g=1", "display_name": "Carlos Andr&#233;s Garc&#237;a", "link": "https://stackoverflow.com/users/1371064/carlos-andr%c3%a9s-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1441151518, "creation_date": 1440809261, "last_edit_date": 1495541174, "question_id": 32281591, "link": "https://stackoverflow.com/questions/32281591/bad-performance-of-buffer-in-linux-golang", "title": "Bad Performance of Buffer in Linux + Golang", "body": "<p>I've got this code</p>\n\n<pre><code>package main\nimport (\n    \"bytes\"\n    \"log\"\n    \"net/http\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n\n    http.HandleFunc(\"/\", Method)\n    log.Printf(\"Server Started\")\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n\n}\n\nfunc Method(pResponse http.ResponseWriter, pRequest *http.Request) {\n    timeInitial := time.Now()\n    log.Printf(strconv.Itoa(timeInitial.Nanosecond()),     strconv.FormatFloat(time.Now().Sub(timeInitial).Seconds()*1000, 'f', 2, 64))\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(pRequest.Body)\n    buf.Bytes() \n    log.Printf(strconv.Itoa(timeInitial.Nanosecond()), strconv.FormatFloat(time.Now().Sub(timeInitial).Seconds()*1000, 'f', 2, 64))\n\n}\n</code></pre>\n\n<p>In this machine:</p>\n\n<ul>\n<li>Processor : 2 GHz Intel Core i7  </li>\n<li>Memory:  8 GB 1600 MHz DDR3  </li>\n<li>OS: Yosemite version 10.10.5</li>\n</ul>\n\n<p>The result is this:</p>\n\n<pre><code>2015/08/28 23:09:59 444255510%!(EXTRA string=0.00)\n2015/08/28 23:09:59 444255510%!(EXTRA string=0.06)\n2015/08/28 23:09:59 472140004%!(EXTRA string=0.00)\n2015/08/28 23:09:59 472140004%!(EXTRA string=1.06)\n2015/08/28 23:09:59 473322028%!(EXTRA string=0.00)\n2015/08/28 23:09:59 473322028%!(EXTRA string=0.01)\n2015/08/28 23:09:59 473377991%!(EXTRA string=0.00)\n2015/08/28 23:09:59 473377991%!(EXTRA string=0.02)\n2015/08/28 23:09:59 483981504%!(EXTRA string=0.00)\n2015/08/28 23:09:59 483981504%!(EXTRA string=0.06)\n2015/08/28 23:09:59 487652426%!(EXTRA string=0.00)\n2015/08/28 23:09:59 487652426%!(EXTRA string=0.07)\n2015/08/28 23:09:59 488064359%!(EXTRA string=0.00)\n2015/08/28 23:09:59 488064359%!(EXTRA string=0.07)\n2015/08/28 23:09:59 493007447%!(EXTRA string=0.00)\n2015/08/28 23:09:59 493007447%!(EXTRA string=0.36)\n2015/08/28 23:09:59 506383690%!(EXTRA string=0.00)\n2015/08/28 23:09:59 506383690%!(EXTRA string=0.02)\n2015/08/28 23:09:59 516324968%!(EXTRA string=0.00)\n2015/08/28 23:09:59 516324968%!(EXTRA string=0.02)\n2015/08/28 23:09:59 516484292%!(EXTRA string=0.00)\n2015/08/28 23:09:59 516484292%!(EXTRA string=0.02)\n2015/08/28 23:09:59 526459027%!(EXTRA string=0.00)\n2015/08/28 23:09:59 526459027%!(EXTRA string=0.03)\n2015/08/28 23:09:59 526568984%!(EXTRA string=0.00)\n2015/08/28 23:09:59 526568984%!(EXTRA string=0.02)\n2015/08/28 23:09:59 526645341%!(EXTRA string=0.00)\n2015/08/28 23:09:59 526645341%!(EXTRA string=0.01)\n2015/08/28 23:09:59 533764558%!(EXTRA string=0.00)\n2015/08/28 23:09:59 533764558%!(EXTRA string=0.02)\n2015/08/28 23:09:59 533872219%!(EXTRA string=0.00)\n2015/08/28 23:09:59 533872219%!(EXTRA string=0.02)\n2015/08/28 23:09:59 542355931%!(EXTRA string=0.00)\n2015/08/28 23:09:59 542355931%!(EXTRA string=0.04)\n2015/08/28 23:09:59 549176497%!(EXTRA string=0.00)\n2015/08/28 23:09:59 549176497%!(EXTRA string=0.03)\n2015/08/28 23:09:59 559803436%!(EXTRA string=0.00)\n2015/08/28 23:09:59 559803436%!(EXTRA string=0.05)\n2015/08/28 23:09:59 559913211%!(EXTRA string=0.00)\n2015/08/28 23:09:59 559913211%!(EXTRA string=0.01)\n2015/08/28 23:09:59 579428530%!(EXTRA string=0.00)\n2015/08/28 23:09:59 579428530%!(EXTRA string=0.05)\n2015/08/28 23:09:59 585453710%!(EXTRA string=0.00)\n2015/08/28 23:09:59 585453710%!(EXTRA string=0.03)\n2015/08/28 23:09:59 587231793%!(EXTRA string=0.00)\n2015/08/28 23:09:59 587231793%!(EXTRA string=0.02)\n2015/08/28 23:09:59 601407050%!(EXTRA string=0.00)\n2015/08/28 23:09:59 601407050%!(EXTRA string=0.02)\n2015/08/28 23:09:59 609160787%!(EXTRA string=0.00)\n2015/08/28 23:09:59 609160787%!(EXTRA string=0.02)\n2015/08/28 23:09:59 617953845%!(EXTRA string=0.00)\n2015/08/28 23:09:59 617953845%!(EXTRA string=0.03)\n2015/08/28 23:09:59 618042591%!(EXTRA string=0.00)\n2015/08/28 23:09:59 618042591%!(EXTRA string=0.02)\n2015/08/28 23:09:59 629055567%!(EXTRA string=0.00)\n2015/08/28 23:09:59 629055567%!(EXTRA string=0.03)\n2015/08/28 23:09:59 642409323%!(EXTRA string=0.00)\n2015/08/28 23:09:59 642409323%!(EXTRA string=0.02)\n2015/08/28 23:09:59 668017861%!(EXTRA string=0.00)\n2015/08/28 23:09:59 668017861%!(EXTRA string=0.12)\n2015/08/28 23:09:59 677003700%!(EXTRA string=0.00)\n2015/08/28 23:09:59 677003700%!(EXTRA string=0.06)\n2015/08/28 23:09:59 692284984%!(EXTRA string=0.00)\n2015/08/28 23:09:59 692284984%!(EXTRA string=0.03)\n2015/08/28 23:09:59 705532147%!(EXTRA string=0.00)\n2015/08/28 23:09:59 705532147%!(EXTRA string=0.06)\n2015/08/28 23:09:59 712790204%!(EXTRA string=0.00)\n2015/08/28 23:09:59 712790204%!(EXTRA string=0.12)\n2015/08/28 23:09:59 737197885%!(EXTRA string=0.00)\n2015/08/28 23:09:59 737197885%!(EXTRA string=0.07)\n2015/08/28 23:09:59 743503323%!(EXTRA string=0.00)\n2015/08/28 23:09:59 743503323%!(EXTRA string=0.14)\n2015/08/28 23:09:59 745206360%!(EXTRA string=0.00)\n2015/08/28 23:09:59 745206360%!(EXTRA string=0.06)\n2015/08/28 23:09:59 763185757%!(EXTRA string=0.00)\n2015/08/28 23:09:59 763185757%!(EXTRA string=0.55)\n2015/08/28 23:09:59 769112727%!(EXTRA string=0.00)\n2015/08/28 23:09:59 769112727%!(EXTRA string=0.08)\n2015/08/28 23:09:59 805816057%!(EXTRA string=0.00)\n2015/08/28 23:09:59 805816057%!(EXTRA string=0.12)\n2015/08/28 23:09:59 809677378%!(EXTRA string=0.00)\n2015/08/28 23:09:59 809677378%!(EXTRA string=0.08)\n2015/08/28 23:09:59 828063305%!(EXTRA string=0.00)\n2015/08/28 23:09:59 828063305%!(EXTRA string=0.12)\n2015/08/28 23:09:59 828338407%!(EXTRA string=0.00)\n2015/08/28 23:09:59 828338407%!(EXTRA string=0.03)\n2015/08/28 23:09:59 835510888%!(EXTRA string=0.00)\n2015/08/28 23:09:59 835510888%!(EXTRA string=0.07)\n2015/08/28 23:09:59 882626159%!(EXTRA string=0.00)\n2015/08/28 23:09:59 882626159%!(EXTRA string=0.03)\n2015/08/28 23:09:59 897746270%!(EXTRA string=0.00)\n2015/08/28 23:09:59 897746270%!(EXTRA string=0.03)\n2015/08/28 23:09:59 931674931%!(EXTRA string=0.00)\n2015/08/28 23:09:59 931674931%!(EXTRA string=0.03)\n2015/08/28 23:09:59 936024259%!(EXTRA string=0.00)\n2015/08/28 23:09:59 936024259%!(EXTRA string=0.05)\n</code></pre>\n\n<p>In this other machine :</p>\n\n<ul>\n<li>vendor_id    : GenuineIntel\n\n<ul>\n<li>cpu family  : 6   </li>\n<li>model   : 63</li>\n<li>model name  : Intel(R) Xeon(R) CPU E5-2630 v3 @ 2.40GHz</li>\n</ul></li>\n<li>MemTotal:       65845252 kB</li>\n<li>OS : Linux  3.13.0-32-generic #57-Ubuntu SMP Tue Jul 15 03:51:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</li>\n</ul>\n\n<p>The result is this</p>\n\n<pre><code>2015/08/29 01:16:54 471552059%!(EXTRA string=15.81)\n2015/08/29 01:16:54 480068871%!(EXTRA string=15.67)\n2015/08/29 01:16:54 507398302%!(EXTRA string=0.00)\n2015/08/29 01:16:54 521398742%!(EXTRA string=0.00)\n2015/08/29 01:16:54 202533461%!(EXTRA string=2327.37)\n2015/08/29 01:16:54 338831795%!(EXTRA string=1191.18)\n2015/08/29 01:16:54 531039526%!(EXTRA string=1037.30)\n2015/08/29 01:16:54 593472114%!(EXTRA string=0.00)\n2015/08/29 01:16:54 609973091%!(EXTRA string=0.00)\n2015/08/29 01:16:54 593472114%!(EXTRA string=16.54)\n2015/08/29 01:16:54 609973091%!(EXTRA string=15.73)\n2015/08/29 01:16:54 394071392%!(EXTRA string=1238.16)\n2015/08/29 01:16:54 638164663%!(EXTRA string=0.00)\n2015/08/29 01:16:54 638164663%!(EXTRA string=15.53)\n2015/08/29 01:16:54 667631670%!(EXTRA string=0.00)\n2015/08/29 01:16:54 675844627%!(EXTRA string=0.00)\n2015/08/29 01:16:54 675844627%!(EXTRA string=14.16)\n2015/08/29 01:16:54 711898262%!(EXTRA string=0.00)\n2015/08/29 01:16:54 300566416%!(EXTRA string=424.26)\n2015/08/29 01:16:54 711898262%!(EXTRA string=13.02)\n2015/08/29 01:16:54 632385443%!(EXTRA string=1115.35)\n2015/08/29 01:16:54 753118239%!(EXTRA string=0.00)\n2015/08/29 01:16:54 753118239%!(EXTRA string=14.15)\n2015/08/29 01:16:54 767381818%!(EXTRA string=0.00)\n2015/08/29 01:16:54 801314950%!(EXTRA string=0.00)\n2015/08/29 01:16:54 767381818%!(EXTRA string=33.99)\n2015/08/29 01:16:54 816438476%!(EXTRA string=0.00)\n2015/08/29 01:16:54 372179187%!(EXTRA string=2457.93)\n2015/08/29 01:16:54 836926824%!(EXTRA string=0.00)\n2015/08/29 01:16:54 836926824%!(EXTRA string=51.60)\n2015/08/29 01:16:54 889729894%!(EXTRA string=0.00)\n2015/08/29 01:16:54 890430388%!(EXTRA string=0.00)\n2015/08/29 01:16:54 891713727%!(EXTRA string=0.00)\n2015/08/29 01:16:54 732229063%!(EXTRA string=1163.04)\n2015/08/29 01:16:54 332690466%!(EXTRA string=1571.52)\n2015/08/29 01:16:54 904336456%!(EXTRA string=0.00)\n2015/08/29 01:16:54 926288167%!(EXTRA string=0.00)\n2015/08/29 01:16:54 384796519%!(EXTRA string=1549.14)\n2015/08/29 01:16:54 941601994%!(EXTRA string=0.00)\n2015/08/29 01:16:54 431987970%!(EXTRA string=1516.20)\n2015/08/29 01:16:54 888973901%!(EXTRA string=1082.22)\n2015/08/29 01:16:54 977186277%!(EXTRA string=0.00)\n2015/08/29 01:16:54 977186277%!(EXTRA string=0.06)\n2015/08/29 01:16:54 977367193%!(EXTRA string=0.00)\n2015/08/29 01:16:55 977367193%!(EXTRA string=56.33)\n2015/08/29 01:16:55 46374447%!(EXTRA string=0.00)\n2015/08/29 01:16:55 46374447%!(EXTRA string=0.28)\n2015/08/29 01:16:55 869929721%!(EXTRA string=1176.83)\n2015/08/29 01:16:55 46916778%!(EXTRA string=0.00)\n2015/08/29 01:16:55 66407207%!(EXTRA string=0.00)\n2015/08/29 01:16:55 80231754%!(EXTRA string=0.00)\n2015/08/29 01:16:55 66407207%!(EXTRA string=13.88)\n2015/08/29 01:16:55 80231754%!(EXTRA string=12.10)\n2015/08/29 01:16:55 99556642%!(EXTRA string=0.00)\n2015/08/29 01:16:55 105395202%!(EXTRA string=0.00)\n2015/08/29 01:16:55 121157010%!(EXTRA string=0.00)\n2015/08/29 01:16:55 105395202%!(EXTRA string=15.83)\n2015/08/29 01:16:55 121157010%!(EXTRA string=12.82)\n2015/08/29 01:16:55 134107839%!(EXTRA string=0.00)\n2015/08/29 01:16:55 134107839%!(EXTRA string=15.98)\n2015/08/29 01:16:55 162712352%!(EXTRA string=0.00)\n2015/08/29 01:16:55 162712352%!(EXTRA string=16.46)\n2015/08/29 01:16:55 179288920%!(EXTRA string=0.00)\n2015/08/29 01:16:55 194490367%!(EXTRA string=0.00)\n2015/08/29 01:16:55 202206415%!(EXTRA string=0.00)\n2015/08/29 01:16:55 49113060%!(EXTRA string=1165.79)\n2015/08/29 01:16:55 473214551%!(EXTRA string=1760.64)\n2015/08/29 01:16:55 239858481%!(EXTRA string=0.00)\n2015/08/29 01:16:55 32855481%!(EXTRA string=1213.72)\n2015/08/29 01:16:55 56811869%!(EXTRA string=1231.75)\n2015/08/29 01:16:55 295414269%!(EXTRA string=0.00)\n2015/08/29 01:16:55 295491576%!(EXTRA string=0.00)\n2015/08/29 01:16:55 889729894%!(EXTRA string=423.76)\n2015/08/29 01:16:55 891713727%!(EXTRA string=427.99)\n2015/08/29 01:16:55 121465765%!(EXTRA string=1204.92)\n2015/08/29 01:16:55 904336456%!(EXTRA string=428.21)\n2015/08/29 01:16:55 121526643%!(EXTRA string=1233.79)\n2015/08/29 01:16:55 310004280%!(EXTRA string=1051.71)\n2015/08/29 01:16:55 858909173%!(EXTRA string=2502.90)\n2015/08/29 01:16:55 367541741%!(EXTRA string=0.00)\n2015/08/29 01:16:55 367541741%!(EXTRA string=18.04)\n2015/08/29 01:16:55 393589632%!(EXTRA string=0.00)\n2015/08/29 01:16:55 407450080%!(EXTRA string=0.00)\n2015/08/29 01:16:55 46916778%!(EXTRA string=378.70)\n2015/08/29 01:16:55 896338456%!(EXTRA string=1529.38)\n2015/08/29 01:16:55 431101598%!(EXTRA string=0.00)\n2015/08/29 01:16:55 431101598%!(EXTRA string=8.42)\n2015/08/29 01:16:55 462833623%!(EXTRA string=0.00)\n2015/08/29 01:16:55 462833623%!(EXTRA string=13.67)\n2015/08/29 01:16:55 484103852%!(EXTRA string=0.00)\n2015/08/29 01:16:55 492334586%!(EXTRA string=0.00)\n2015/08/29 01:16:55 492410130%!(EXTRA string=0.00)\n2015/08/29 01:16:55 492334586%!(EXTRA string=13.06)\n2015/08/29 01:16:55 511300492%!(EXTRA string=0.00)\n2015/08/29 01:16:55 511300492%!(EXTRA string=19.36)\n2015/08/29 01:16:55 537223305%!(EXTRA string=0.00)\n2015/08/29 01:16:55 544019226%!(EXTRA string=0.00)\n2015/08/29 01:16:55 544019226%!(EXTRA string=16.19)\n2015/08/29 01:16:55 560322064%!(EXTRA string=0.00)\n2015/08/29 01:16:55 993395050%!(EXTRA string=1566.96)\n2015/08/29 01:16:55 560322064%!(EXTRA string=39.26)\n2015/08/29 01:16:55 599688803%!(EXTRA string=0.00)\n2015/08/29 01:16:55 179288920%!(EXTRA string=421.14)\n2015/08/29 01:16:55 157717567%!(EXTRA string=1443.31)\n2015/08/29 01:16:55 507398302%!(EXTRA string=1093.78)\n2015/08/29 01:16:55 609900746%!(EXTRA string=0.00)\n2015/08/29 01:16:55 239858481%!(EXTRA string=370.10)\n2015/08/29 01:16:55 609900746%!(EXTRA string=14.23)\n2015/08/29 01:16:55 993465302%!(EXTRA string=1644.50)\n2015/08/29 01:16:55 655129719%!(EXTRA string=0.00)\n2015/08/29 01:16:55 66651321%!(EXTRA string=1601.79)\n2015/08/29 01:16:55 521398742%!(EXTRA string=1156.10)\n2015/08/29 01:16:55 295491576%!(EXTRA string=382.10)\n2015/08/29 01:16:55 295414269%!(EXTRA string=389.39)\n2015/08/29 01:16:55 702701065%!(EXTRA string=0.00)\n2015/08/29 01:16:55 137363675%!(EXTRA string=1574.04)\n2015/08/29 01:16:55 393589632%!(EXTRA string=339.33)\n2015/08/29 01:16:55 667631670%!(EXTRA string=1071.18)\n2015/08/29 01:16:55 407450080%!(EXTRA string=338.06)\n2015/08/29 01:16:55 484103852%!(EXTRA string=293.32)\n2015/08/29 01:16:55 786006965%!(EXTRA string=0.00)\n2015/08/29 01:16:55 801314950%!(EXTRA string=998.25)\n2015/08/29 01:16:55 816438476%!(EXTRA string=1008.98)\n2015/08/29 01:16:55 848323630%!(EXTRA string=0.00)\n2015/08/29 01:16:55 655129719%!(EXTRA string=225.32)\n2015/08/29 01:16:55 900971628%!(EXTRA string=0.00)\n2015/08/29 01:16:55 702701065%!(EXTRA string=212.15)\n2015/08/29 01:16:55 953092419%!(EXTRA string=0.00)\n2015/08/29 01:16:56 786006965%!(EXTRA string=225.37)\n2015/08/29 01:16:56 848323630%!(EXTRA string=263.25)\n2015/08/29 01:16:56 890430388%!(EXTRA string=1221.25)\n2015/08/29 01:16:56 99556642%!(EXTRA string=1013.02)\n2015/08/29 01:16:56 599688803%!(EXTRA string=513.94)\n2015/08/29 01:16:56 900971628%!(EXTRA string=213.58)\n2015/08/29 01:16:56 114683782%!(EXTRA string=0.00)\n2015/08/29 01:16:56 194490367%!(EXTRA string=926.51)\n2015/08/29 01:16:56 941601994%!(EXTRA string=1179.50)\n2015/08/29 01:16:56 202206415%!(EXTRA string=944.82)\n2015/08/29 01:16:56 953092419%!(EXTRA string=201.68)\n2015/08/29 01:16:56 280223380%!(EXTRA string=0.00)\n2015/08/29 01:16:56 926288167%!(EXTRA string=1373.12)\n2015/08/29 01:16:56 114683782%!(EXTRA string=213.67)\n2015/08/29 01:16:56 365730070%!(EXTRA string=0.00)\n2015/08/29 01:16:56 537223305%!(EXTRA string=882.31)\n2015/08/29 01:16:56 272782462%!(EXTRA string=4147.48)\n2015/08/29 01:16:56 632615696%!(EXTRA string=0.00)\n2015/08/29 01:16:56 634781232%!(EXTRA string=0.00)\n2015/08/29 01:16:56 280223380%!(EXTRA string=360.50)\n2015/08/29 01:16:56 365730070%!(EXTRA string=275.11)\n2015/08/29 01:16:56 492410130%!(EXTRA string=1354.29)\n2015/08/29 01:16:56 632615696%!(EXTRA string=214.78)\n2015/08/29 01:16:56 634781232%!(EXTRA string=219.21)\n2015/08/29 01:16:57 65374683%!(EXTRA string=0.00)\n2015/08/29 01:16:57 65573396%!(EXTRA string=0.00)\n2015/08/29 01:16:57 65374683%!(EXTRA string=300.96)\n2015/08/29 01:16:57 53842402%!(EXTRA string=5317.02)\n2015/08/29 01:16:57 65573396%!(EXTRA string=305.82)\n2015/08/29 01:16:58 26171685%!(EXTRA string=10149.46)\n</code></pre>\n\n<p>The same code on different machines producing different results. The time in the results is in milliseconds, and as you can, see the Linux machine prints form 5 seconds to 10 seconds only doing the simple code that I show before, but on the mac machine this does not happen. Unfortunately my final product should be on Linux, so the time executing this code is affecting  the final result of a high-performance product. I don't what is the trouble with this code in Linux. I will appreciate any help; for the moment, I'm stuck.</p>\n\n<p>How I tested the code:</p>\n\n<p>With a load test I sent 100 threads for 1 minute with a simple strategy, a test delay  1 second and a Random 0.5 on SoapUI 5.2.0</p>\n\n<p>The request is this:</p>\n\n<pre><code>{\n   \"Field1\":{\n      \"Key1\":\"HHHHHH\",\n      \"Key2\":\"[branch code]\",\n      \"Key3\":\"HHHHHHtest\"\n   },\n   \"Field2\":{\n      \"Key1\":\"HHH\"\n   },\n   \"Field3\":{\n      \"Key1\":[\n         {\n            \"Value1\":0,\n            \"Value2\":\"HHHHHHH\",\n            \"Value3\":\"HHH\"\n         },\n         {\n            \"Value1\":0,\n            \"Value2\":\"HHHH\",\n            \"Value3\":\"HH\"\n         },\n         {\n            \"Value1\":1,\n            \"Value2\":\"HHHHHHHHHHHHH\",\n            \"Value3\":\"\"\n         },\n         {\n            \"Value1\":1,\n            \"Value2\":\"HHHHHHHHHHHHHHHHHHH\",\n            \"Value3\":\"1\"\n         },\n         {\n            \"Value1\":2,\n            \"Value2\":\"HHHHHHHHHHHHHHHHHHHH\",\n            \"Value3\":\"3\"\n         },\n         {\n            \"Value1\":2,\n            \"Value2\":\"HHHHHHHH\",\n            \"Value3\":\"1\"\n         },\n         {\n            \"Value1\":1,\n            \"Value2\":\"HHHHHHHHHHHHH\",\n            \"Value3\":\"4\"\n         },\n         {\n            \"Value1\":2,\n            \"Value2\":\"HHHHHHHHHHHH\",\n            \"Value3\":\"BB\"\n         }\n      ]\n   },\n   \"Field4\":{\n      \"key1\":11111111,\n      \"key2\":11111111\n   },\n   \"Field5\":{\n      \"key1\":[\n         {\n            \"Value1\":1,\n            \"Value2\":2\n         },\n         {\n            \"Value1\":1,\n            \"Value2\":2\n         },\n         {\n            \"Value1\":[\n               {\n                  \"Value2\":5\n               }\n            ],\n            \"Value1\":1,\n            \"Value2\":2,\n            \"children3\":1\n         }\n      ]\n   },\n   \"Field6\":\"HHH_HHHH_HHHHHHHH_HHHH\",\n   \"Field7\":\"HHHHHHHHHHHHHH_HHHHH\",\n   \"Field8\":\"4.1\",\n   \"Field9\":\"12312312\"\n}\n</code></pre>\n\n<p>Note: I know from <a href=\"https://stackoverflow.com/questions/9644139/from-io-reader-to-string-in-go\">this post</a> that the code is not the most efficient, but I was not able to find an efficient solution. </p>\n\n<p>EDIT 1 : Run the code with GODEBUG=gctrace=1 and go version go1.4.2 linux/amd64</p>\n\n<p><a href=\"http://pastebin.com/jvV8wAz7\" rel=\"nofollow noreferrer\">http://pastebin.com/jvV8wAz7</a></p>\n\n<p>EDIT 2 : Run the code with GODEBUG=gctrace=1 and go version go1.5 linux/amd64</p>\n\n<p><a href=\"http://pastebin.com/sM8TVzXW\" rel=\"nofollow noreferrer\">http://pastebin.com/sM8TVzXW</a></p>\n"}, {"tags": ["http", "ssl", "go", "https", "proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440789432, "post_id": 32278109, "comment_id": 52435309, "body": "Yes you can. It&#39;s the exact same process as an http proxy, but you use a TLS listener. Do you have a specific question?"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440790163, "post_id": 32278109, "comment_id": 52435707, "body": "@JimB So, i created server which listen &quot;TLS port&quot;. However, the browser is still sending CONNECT method. What&#39;s next ?  If not too much trouble, can you show the sample code ?! Preferably on golang :) !?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440790481, "post_id": 32278109, "comment_id": 52435843, "body": "I&#39;m not sure what to show you. If you can already handle CONNECT in your proxy, changing the underlying protocol to TLS shouldn&#39;t affect how you handle the request. Have you tried anything?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440808311, "post_id": 32278109, "comment_id": 52441532, "body": "I think Jim&#39;s saying to use <code>http.ListenAndServeTLS</code> so the client establishes a secure session <i>to your proxy</i>, you see content and can add headers, vs. what you&#39;re currently doing by listening on the socket directly and forwarding the CONNECT and so on back and forth."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1441098779, "post_id": 32278109, "comment_id": 52529821, "body": "@twotwotwo Thx for your answer. What about certificate ? For example. Browser request <a href=\"https://google.com\" rel=\"nofollow noreferrer\">google.com</a> with use my proxy. I decrypt this message with my self-signed certificate or with some CA signed certificate. Then browser show me error \u0438ecause my certificate, but rather the fingerprint does not match the one that is registered for the google.com and browser show me thet is untrusted connection. Or I&#39;m wrong ?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1441125832, "post_id": 32278109, "comment_id": 52547922, "body": "Yes. Sometimes clients load a CA certificate that effectively allows the proxy to impersonate any Web site. You can only do this with some arrangement like that; from SSL&#39;s perspective, adding a header is no different from replacing the Google login screen with a phishing page."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "edited": false, "score": 0, "creation_date": 1441131401, "post_id": 32278109, "comment_id": 52550895, "body": "Sometimes ? What do you mean :) ? That is, the browser chrome or firefox, give me a warning, and for example curl react normally ?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1441337120, "post_id": 32278109, "comment_id": 52648157, "body": "Businesses sometimes set up their machines to trust their firewall, which decrypts SSL connections then starts its own SSL connection to the outside world. That is, they actually tell their machines to allow the firewall to perform a man-in-the-middle-attack--otherwise, by design, it&#39;s impossible."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1465302522, "post_id": 32278109, "comment_id": 62835688, "body": "@sintanial did you solve this problem, if yes and If not too much trouble, can you show the sample code, thx"}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1465379208, "post_id": 32278109, "comment_id": 62872431, "body": "@Aziz it&#39;s impossible (can only if remote server trusted all certificate include self-signed ;)"}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1465460709, "post_id": 32278109, "comment_id": 62913419, "body": "@sintanial i see, thx :)"}], "owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440790330, "creation_date": 1440788554, "last_edit_date": 1440790330, "question_id": 32278109, "link": "https://stackoverflow.com/questions/32278109/how-to-add-additional-headers-in-https-proxy", "title": "How to add additional headers in https proxy?", "body": "<p>I created on golang double HTTP proxy server. Server receives request, adds additional headers in this request and sends this changed request to another proxy server, which read this headers, remove it from request, and finally make request into destination.</p>\n\n<p>With HTTP it works perfect. But how create this with HTTPS ?!</p>\n\n<p>In HTTPS request browser send http CONNECT request, and then send encrypted data. Can i decrypted this data with CA signed server certificate, then add headers, send HTTPS request to another server, and then send HTTPS request to destination !?</p>\n"}, {"tags": ["go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1440788417, "post_id": 32278042, "comment_id": 52434818, "body": "sorry to nitpick, but you mean <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">&quot;type assertion&quot;</a> (since &quot;casting&quot; can mean something different)"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 27, "last_activity_date": 1440788777, "last_edit_date": 1440788777, "creation_date": 1440788322, "answer_id": 32278042, "question_id": 32277884, "link": "https://stackoverflow.com/questions/32277884/golang-type-interface-is-interface-with-no-methods/32278042#32278042", "title": "Golang type interface {} is interface with no methods", "body": "<p>You have to <a href=\"https://golang.org/doc/effective_go.html#interface_conversions\">type assert</a> it to a compatible type before you can access its fields. </p>\n\n<pre><code>id := v.(struct{Id int}).Id\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14229, "favorite_count": 2, "accepted_answer_id": 32278042, "answer_count": 1, "score": 13, "last_activity_date": 1440788777, "creation_date": 1440787707, "question_id": 32277884, "link": "https://stackoverflow.com/questions/32277884/golang-type-interface-is-interface-with-no-methods", "title": "Golang type interface {} is interface with no methods", "body": "<p>Currently Im having something like this</p>\n\n<p>main.go</p>\n\n<pre><code>gojob.NewJob(\"every 2 second\", \"pene\", func() {\n        t := gojob.Custom(\"pene\")\n        log.Println(t)\n    }, struct {\n        Id int\n    }{\n        1,\n    })\n</code></pre>\n\n<p>And my gojob package</p>\n\n<pre><code>func NewJob(t string, name string, c func(), v interface{}) {\n    e := strings.Split(t, \" \")\n    job := process(e)\n    job.log = false\n    job.name = name\n    job.action = c\n    job.custom = v\n    jobs = append(jobs, job)\n}\n</code></pre>\n\n<p>And </p>\n\n<pre><code>func Custom(name string) interface{} {\n    for i := range jobs {\n        if jobs[i].name != name {\n            continue\n        }\n        return jobs[i].custom\n    }\n    return nil\n}\n</code></pre>\n\n<p>Thing is the function Im passing to NewJob is beeing executed every 2 seconds on a goroutine but I want to access the anonymous struct I passed... however when I try to access</p>\n\n<blockquote>\n  <p>t.Id</p>\n</blockquote>\n\n<p>Im getting </p>\n\n<blockquote>\n  <p>t.Id undefined (type interface {} is interface with no methods)</p>\n</blockquote>\n\n<p>However printing t gives me the expected result</p>\n\n<blockquote>\n  <p>{1}</p>\n</blockquote>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440791543, "post_id": 32277442, "comment_id": 52436364, "body": "Your field is named <code>Xmlsn</code> only. The tag you added will only be used by the <code>encoding&#47;xml</code> package, not on the rest of your go code."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1440801944, "creation_date": 1440801944, "answer_id": 32280808, "question_id": 32277442, "link": "https://stackoverflow.com/questions/32277442/building-mrss-feed-in-go/32280808#32280808", "title": "Building MRSS feed in Go", "body": "<p>You've already done everything necessary to make it work, your composite literal is just wrong, you're using the xml attribute name rather than the field name. One of the main reason for annotation is to provide flexibility on your field names for some obvious reasons like the fact that lower cased fields aren't supported and the naming rules for json and xml aren't consistent with Go. Here is a working example of your code;</p>\n\n<pre><code>type RSS struct {\nXMLName xml.Name `xml:\"rss\"`\nXmlns   string   `xml:\"xmlns:media,attr\"`\nVersion string  `xml:\"version,attr\"`\nChannel Channel `xml:\"channel\"`\n}\n\nrss := &amp;RSS{Version: \"2.0\", Xmlns: \"http://search.yahoo.com/mrss\"}\n</code></pre>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1440801944, "creation_date": 1440785949, "question_id": 32277442, "link": "https://stackoverflow.com/questions/32277442/building-mrss-feed-in-go", "title": "Building MRSS feed in Go", "body": "<p>Im trying to get the result:</p>\n\n<pre><code>&lt;rss version=\"2.0\" xmlns:media=\"http://search.yahoo.com/mrss\"&gt;\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>type RSS struct {\nXMLName xml.Name `xml:\"rss\"`\nXmlns   string   `xml:\"xmlns:media,attr\"`\nVersion string  `xml:\"version,attr\"`\nChannel Channel `xml:\"channel\"`\n}\n\nrss := &amp;RSS{Version: \"2.0\", Xmlns:media: \"http://search.yahoo.com/mrss\"}\n</code></pre>\n\n<p>But I get a syntax error because of the colon. Without the \":media\" there are no errors. How can I add that? Thanks. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1440786705, "post_id": 32277268, "comment_id": 52433941, "body": "The third call doesn&#39;t call MarshalJSON(), it uses reflect to guess the type and encode as best is possible. Take a look at json.(*Encode).Encode() function: <a href=\"http://golang.org/src/encoding/json/stream.go?s=4283:4330#L173\" rel=\"nofollow noreferrer\">golang.org/src/encoding/json/stream.go?s=4283:4330#L173</a>"}, {"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "reply_to_user": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1440786946, "post_id": 32277268, "comment_id": 52434058, "body": "@divan how come that doesn&#39;t happen in the second example?"}], "answers": [{"comments": [{"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 0, "creation_date": 1475120970, "post_id": 32277998, "comment_id": 66817630, "body": "In the second example, the struct literal is being created on the stack, and is then copied into <code>Encode</code>s stack frame. Why is it not considered &quot;addressable&quot;? Values on the stack are addressable."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 0, "creation_date": 1475152865, "post_id": 32277998, "comment_id": 66835543, "body": "@iliacholy: whether it&#39;s on the stack or not is irrelevant to the specification of addressability, but in the second example a <i>copy</i> of the struct literal is allocated in the <code>interface{}</code> argument in the stack. A value in an interface is not addressable."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1440788855, "last_edit_date": 1440788855, "creation_date": 1440788174, "answer_id": 32277998, "question_id": 32277268, "link": "https://stackoverflow.com/questions/32277268/pointer-receiver-confusion/32277998#32277998", "title": "Pointer receiver confusion", "body": "<p>When calling a method on any <a href=\"http://golang.org/ref/spec#Address_operators\" rel=\"nofollow\">addressable value</a>, Go will automatically reference the value to call methods with a pointer receiver. </p>\n\n<pre><code>type Foo struct{}\nfunc (f *Foo) Call() {}\n\n// f isn't a pointer, but is addressable\nf := Foo{}\nf.Call()\n</code></pre>\n\n<p>Also, if a non-pointer value is in an addressable struct, it can also be reference for methods requiring a pointer receiver.</p>\n\n<pre><code>type Bar struct {\n    Foo Foo\n}\n\n// b is addressable, therefor so is b.Foo\nb := Bar{\n    Foo: f,\n}\nb.Foo.Call()\n</code></pre>\n\n<p>Your last example uses the address of the outer struct to get the address of the Foo field, and call <code>MarshalJSON</code>.</p>\n"}], "owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 32277998, "answer_count": 1, "score": 1, "last_activity_date": 1440788855, "creation_date": 1440785266, "question_id": 32277268, "link": "https://stackoverflow.com/questions/32277268/pointer-receiver-confusion", "title": "Pointer receiver confusion", "body": "<p>I'm confused about the behaviour of the following code. <a href=\"http://play.golang.org/p/NOyjfYPuik\" rel=\"nofollow\">playground</a></p>\n\n<pre><code>var foo json.RawMessage\n_ = json.Unmarshal([]byte(`{ \"zoo\": 123 }`), &amp;foo)\n\nenc := json.NewEncoder(os.Stdout)\n\n// Works as expected\n_ = enc.Encode(struct{ Foo *json.RawMessage }{&amp;foo})\n\n// MarshalJSON has a pointer reciever, so it doesn't get invoked here\n_ = enc.Encode(struct{ Foo json.RawMessage }{foo})\n\n// How is MarshalJSON being invoked if .Foo is not a pointer?\n_ = enc.Encode(&amp;struct{ Foo json.RawMessage }{foo})\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{\"Foo\":{\"zoo\":123}}\n{\"Foo\":\"eyAiem9vIjogMTIzIH0=\"}\n{\"Foo\":{\"zoo\":123}}\n</code></pre>\n\n<p>I don't understand why the third call to <code>json.Encoder.Encode</code> is able to access <code>json.RawMessage.MarshalJSON</code> even though it's not a pointer.</p>\n"}, {"tags": ["go", "uuid"], "answers": [{"comments": [{"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 2, "creation_date": 1440783956, "post_id": 32276862, "comment_id": 52432507, "body": "code.google.com is about to be shutdown. The <code>go-uuid</code> package moved to <a href=\"https://github.com/pborman/uuid\" rel=\"nofollow noreferrer\">github.com/pborman/uuid</a>."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 5, "last_activity_date": 1440783743, "last_edit_date": 1495539865, "creation_date": 1440783743, "answer_id": 32276862, "question_id": 32276773, "link": "https://stackoverflow.com/questions/32276773/generating-unique-file-name-using-uuid-in-golang/32276862#32276862", "title": "Generating unique file name using UUID in golang", "body": "<p>There isn't a guid or uuid type in the standard library for Go but there are some other ways to do it, like using a third party package such as this; <a href=\"https://godoc.org/code.google.com/p/go-uuid/uuid\" rel=\"nofollow noreferrer\">https://godoc.org/code.google.com/p/go-uuid/uuid</a> or <a href=\"https://github.com/nu7hatch/gouuid\" rel=\"nofollow noreferrer\">https://github.com/nu7hatch/gouuid</a></p>\n\n<pre><code>import \"github.com/nu7hatch/gouuid\"\n\nid, err := uuid.NewV4()\n</code></pre>\n\n<p>This answer has another option as well which makes use of Unix command line utils; <a href=\"https://stackoverflow.com/questions/15130321/is-there-a-method-to-generate-a-uuid-with-go-language\">Is there a method to generate a UUID with go language</a> though it doesn't seem to perform very well.</p>\n"}, {"tags": [], "owner": {"reputation": 21557, "user_id": 1122270, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1ab0e19086582d27abe75b0635f57f43?s=128&d=identicon&r=PG", "display_name": "cnst", "link": "https://stackoverflow.com/users/1122270/cnst"}, "is_accepted": false, "score": 4, "last_activity_date": 1515305979, "creation_date": 1515305979, "answer_id": 48134820, "question_id": 32276773, "link": "https://stackoverflow.com/questions/32276773/generating-unique-file-name-using-uuid-in-golang/48134820#48134820", "title": "Generating unique file name using UUID in golang", "body": "<p>I believe you have an impedance mismatch in your problem statement, and your Python code would not work as you expect it should.</p>\n\n<p>As can be deduced by some answers at \u201c<em><a href=\"https://stackoverflow.com/questions/15130321/is-there-a-method-to-generate-a-uuid-with-go-language\">Is there a method to generate a UUID with go language</a></em>\u201d, as well as is clearly described in <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_1_(date-time_and_MAC_address)\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_1_(date-time_and_MAC_address)</a>, <strong><em>UUIDs</em></strong> are very likely to be unique only when taken in full, not in parts, and are not necessarily random at all, especially with the Version 1 actually being rather predictable, as it's based on the date/time and MAC address of the host generating it.</p>\n\n<p>As such, the best approach may be to use something similar to the code in one of the <a href=\"//stackoverflow.com/a/25736155/1122270\">answers to the prior mentioned question</a>, to actually generate a random filename based on <a href=\"https://golang.org/pkg/crypto/rand/\" rel=\"nofollow noreferrer\"><code>crypto/rand</code></a> yourself to your own specification, and without the misuse of the libraries not necessarily intended to provide the required randomness for the task at hand.</p>\n\n<p><a href=\"https://play.golang.org/p/k2V-Mc5Y31e\" rel=\"nofollow noreferrer\">https://play.golang.org/p/k2V-Mc5Y31e</a></p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/rand\"\n    \"fmt\"\n)\n\nfunc random_filename_16_char() (s string, err error) {\n    b := make([]byte, 8)\n    _, err = rand.Read(b)\n    if err != nil {\n        return\n    }\n    s = fmt.Sprintf(\"%x\", b)\n    return\n}\n\nfunc main() {\n    s, _ := random_filename_16_char()\n    fmt.Println(s)\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5270337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8108, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1515305979, "creation_date": 1440783447, "question_id": 32276773, "link": "https://stackoverflow.com/questions/32276773/generating-unique-file-name-using-uuid-in-golang", "title": "Generating unique file name using UUID in golang", "body": "<p>I need to generate an unique file name with UUID1.</p>\n\n<p>My current python code is:</p>\n\n<pre><code>uuid.uuid1().hex[:16] // i need 16 chars file name\n</code></pre>\n\n<p>What could be the golang equivalent?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1440799235, "post_id": 32273218, "comment_id": 52439398, "body": "Not quite answer worthy, but <a href=\"http://stackoverflow.com/questions/31734215/multithreaded-console-output\">in a question I asked about console interlacing</a> I was told that using the <code>log</code> import would prevent it."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 21585, "user_id": 160527, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f2af00f8b669405a2a068ddae153ff48?s=128&d=identicon&r=PG", "display_name": "Corey Ogburn", "link": "https://stackoverflow.com/users/160527/corey-ogburn"}, "edited": false, "score": 0, "creation_date": 1440849387, "post_id": 32273218, "comment_id": 52449161, "body": "@CoreyOgburn that won&#39;t help when the problem here is that <code>main</code> doesn&#39;t wait for the goroutines to run (so output doesn&#39;t happen at all, interleaved/interlaced or not)"}], "answers": [{"comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 1, "creation_date": 1440772357, "post_id": 32273463, "comment_id": 52425836, "body": "+1. You can also read this good article about this matter: <a href=\"http://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2014/02/15/&hellip;</a>"}, {"owner": {"reputation": 323, "user_id": 2599571, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3ecc404d6949674687386ae0480e8135?s=128&d=identicon&r=PG", "display_name": "DCameronMauch", "link": "https://stackoverflow.com/users/2599571/dcameronmauch"}, "edited": false, "score": 0, "creation_date": 1440773420, "post_id": 32273463, "comment_id": 52426631, "body": "Awesome!  Thanks so much for the solution Jim, and the article pointer Elwinar."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1440772924, "last_edit_date": 1440772924, "creation_date": 1440772309, "answer_id": 32273463, "question_id": 32273218, "link": "https://stackoverflow.com/questions/32273218/issue-with-channel-go-routine-synchronization-in-go/32273463#32273463", "title": "Issue with channel / go routine synchronization in Go", "body": "<p>Your program is exiting before all goroutines are done. You need to wait for both the <code>foo</code> and <code>bar</code> goroutines to finish before returning from <code>main</code>. </p>\n\n<p>The usual way of doing this is by using a <code>sync.WaitGroup</code>, but since <code>main</code> isn't the producer for the <code>d</code> channel, you will have to ensure that all sends on that channel are finished before closing that with a second WaitGroup (or equivalent).</p>\n\n<pre><code>var (\n    fooWG sync.WaitGroup\n    barWG sync.WaitGroup\n)\n\nfunc main() {\n    d := make(chan uint)\n\n    barWG.Add(1)\n    go bar(d)\n\n    c1 := make(chan uint)\n    c2 := make(chan uint)\n    c3 := make(chan uint)\n\n    fooWG.Add(3)\n    go foo(c1, d)\n    go foo(c2, d)\n    go foo(c3, d)\n\n    c1 &lt;- 1\n    c2 &lt;- 2\n    c3 &lt;- 3\n\n    c1 &lt;- 4\n    c2 &lt;- 5\n    c3 &lt;- 6\n\n    c1 &lt;- 7\n    c2 &lt;- 8\n    c3 &lt;- 9\n\n    // close the channels so the foo goroutines can exit\n    close(c1)\n    close(c2)\n    close(c3)\n    fooWG.Wait()\n\n    // all foo are done, so it's safe to close d and wait for bar\n    close(d)\n    barWG.Wait()\n}\n\nfunc foo(c chan uint, d chan uint) {\n    defer fooWG.Done()\n    fmt.Println(\"foo start\")\n\n    for stuff := range c {\n        time.Sleep(1)\n        d &lt;- stuff * 2\n    }\n\n    fmt.Println(\"foo end\")\n}\n\nfunc bar(d chan uint) {\n    defer barWG.Done()\n    fmt.Println(\"bar start\")\n\n    for stuff := range d {\n        fmt.Printf(\"bar received %d\\n\", stuff)\n    }\n\n    fmt.Println(\"bar end\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1665, "user_id": 4638952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03791badf72f6918a8910148dfc4401e?s=128&d=identicon&r=PG&f=1", "display_name": "SnoProblem", "link": "https://stackoverflow.com/users/4638952/snoproblem"}, "is_accepted": false, "score": 1, "last_activity_date": 1440798851, "creation_date": 1440798851, "answer_id": 32280323, "question_id": 32273218, "link": "https://stackoverflow.com/questions/32273218/issue-with-channel-go-routine-synchronization-in-go/32280323#32280323", "title": "Issue with channel / go routine synchronization in Go", "body": "<p>JimB's answer definitely works, but it's adding more complexity than is actually needed in the code.  A simple complete channel would suffice to synchronize this code though completion.  </p>\n\n<p>Also, with channel synchronization, the <code>time.Sleep(1)</code> command is no longer needed for functionality: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    d := make(chan uint)\n    complete := make(chan bool)\n    go bar(d, complete)\n\n    c1 := make(chan uint)\n    c2 := make(chan uint)\n    c3 := make(chan uint)\n\n    go foo(c1, d)\n    go foo(c2, d)\n    go foo(c3, d)\n\n    c1 &lt;- 1\n    c2 &lt;- 2\n    c3 &lt;- 3\n\n    c1 &lt;- 4\n    c2 &lt;- 5\n    c3 &lt;- 6\n\n    c1 &lt;- 7\n    c2 &lt;- 8\n    c3 &lt;- 9\n\n    //If you know the number of inputs, count them to ensure completion\n    for i:=0; i &lt; 9; i++{\n        &lt;-complete\n    }\n\n    //Clean up after yourself, to keep away the memory leaks\n    close(c1)\n    close(c2)\n    close(c3)\n    close(d)\n\n    //Verify bar is done and closed correctly\n    &lt;-complete\n    close(complete)\n}\n\nfunc foo(c chan uint, d chan uint) {\n    fmt.Println(\"foo start\")\n\n    for stuff := range c {\n        time.Sleep(1)      //Not needed for the program to function\n        d &lt;- stuff * 2\n    }\n\n    fmt.Println(\"foo end\")\n}\n\nfunc bar(d chan uint, cmp chan bool) {\n    fmt.Println(\"bar start\")\n\n    for stuff := range d {\n        fmt.Printf(\"bar received %d\\n\", stuff)\n        cmp &lt;- true\n    }\n\n    fmt.Println(\"bar end\")\n\n    //verify that cmp can be closed (all output is done, and d is closed)\n    cmp &lt;- true\n}\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 2599571, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3ecc404d6949674687386ae0480e8135?s=128&d=identicon&r=PG", "display_name": "DCameronMauch", "link": "https://stackoverflow.com/users/2599571/dcameronmauch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 32273463, "answer_count": 2, "score": 1, "last_activity_date": 1440798851, "creation_date": 1440771519, "question_id": 32273218, "link": "https://stackoverflow.com/questions/32273218/issue-with-channel-go-routine-synchronization-in-go", "title": "Issue with channel / go routine synchronization in Go", "body": "<p>Here is a small example program with the basic architecture/flow that I am trying to get working.  How do I get all the numbers and \"end\" messages to print out?  I have tried putting close statements here and there, but it either doesn't work, or I get panics about trying to close an already closed channel...</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    d := make(chan uint)\n\n    go bar(d)\n\n    c1 := make(chan uint)\n    c2 := make(chan uint)\n    c3 := make(chan uint)\n\n    go foo(c1, d)\n    go foo(c2, d)\n    go foo(c3, d)\n\n    c1 &lt;- 1\n    c2 &lt;- 2\n    c3 &lt;- 3\n\n    c1 &lt;- 4\n    c2 &lt;- 5\n    c3 &lt;- 6\n\n    c1 &lt;- 7\n    c2 &lt;- 8\n    c3 &lt;- 9\n}\n\nfunc foo(c chan uint, d chan uint) {\n    fmt.Println(\"foo start\")\n\n    for stuff := range c {\n        time.Sleep(1)\n        d &lt;- stuff * 2\n    }\n\n    fmt.Println(\"foo end\")\n}\n\nfunc bar(d chan uint) {\n    fmt.Println(\"bar start\")\n\n    for stuff := range d {\n        fmt.Printf(\"bar received %d\\n\", stuff)\n    }\n\n    fmt.Println(\"bar end\")\n}\n</code></pre>\n\n<p>The output I am getting looks like this.  Notice the last set of numbers and the \"end\" outputs are missing.</p>\n\n<pre><code>foo start\nbar start\nfoo start\nfoo start\nbar received 6\nbar received 2\nbar received 4\nbar received 12\nbar received 8\nbar received 10\n</code></pre>\n\n<p>In my actual program, each \"foo\" function is doing filtering and a bunch of heavy string regexp stuff.  And I need the \"bar\" function, because it has the job of reordering based on a timestamp, and serializing printing, so output doesn't get interlaced.</p>\n"}, {"tags": ["google-app-engine", "go", "dependencies"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1440774709, "post_id": 32271148, "comment_id": 52427540, "body": "I&#39;m confused. Is this resolved? Was it only because you never fetched your dependencies?"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 1, "creation_date": 1440779696, "post_id": 32271148, "comment_id": 52430332, "body": "Have you tried just <code>import &quot;appengine&quot;</code>? I assume Go should realize from <code>$GOPATH</code> without explicitly stating the full path."}, {"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440785073, "post_id": 32271148, "comment_id": 52433123, "body": "It&#39;s not resolved - reading about it and found something here: <a href=\"https://github.com/golang/appengine#2-update-import-paths\" rel=\"nofollow noreferrer\">github.com/golang/appengine#2-update-import-paths</a>"}, {"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440785119, "post_id": 32271148, "comment_id": 52433142, "body": "It looks like there&#39;s a transition to fully qualified import paths for appengine and thus lots of inconsistencies..."}], "answers": [{"comments": [{"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440830901, "post_id": 32280565, "comment_id": 52444957, "body": "Yes that seems to be the way...just makes me wonder if there are some things that can go bad when you use both in parallel. E.g. thinking of same object but different size..."}, {"owner": {"reputation": 6099, "user_id": 211176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1098198f10f2890217a272bf037e58f5?s=128&d=identicon&r=PG&f=1", "display_name": "adam_0", "link": "https://stackoverflow.com/users/211176/adam-0"}, "reply_to_user": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1441165979, "post_id": 32280565, "comment_id": 52562789, "body": "Sure, there could be some wonky implementation details that don&#39;t match up nicely if you pass from one package to the other. The idea, I think, is to only use one of the same package from either old or new (so for example, either <code>&quot;appengine&quot;</code> or <code>&quot;google.golang.org&#47;appengine&quot;</code>) and transition the packages over, one at a time. You don&#39;t want to be using the old one anyways since it&#39;s deprecated, unless you&#39;re using something that doesn&#39;t work in the newer packages. But if you <i>have</i> to, the packages can coexist for a little while, I&#39;d bet."}], "tags": [], "owner": {"reputation": 6099, "user_id": 211176, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1098198f10f2890217a272bf037e58f5?s=128&d=identicon&r=PG&f=1", "display_name": "adam_0", "link": "https://stackoverflow.com/users/211176/adam-0"}, "is_accepted": true, "score": 10, "last_activity_date": 1440800316, "creation_date": 1440800316, "answer_id": 32280565, "question_id": 32271148, "link": "https://stackoverflow.com/questions/32271148/how-to-correctly-import-golang-appengine/32280565#32280565", "title": "How to correctly import Golang appengine?", "body": "<p>It's like your update says; you can use <em>both types</em> of imports in parallel (in the same chunk of code) while they're deprecating the old API and finishing up the new one:</p>\n\n<blockquote>\n  <p>Most App Engine services are available with exactly the same API. A few APIs were cleaned up, and some are not available yet.</p>\n</blockquote>\n\n<p>(<a href=\"https://github.com/golang/appengine#user-content-3-update-code-using-deprecated-removed-or-modified-apis\" rel=\"noreferrer\">source</a>, a little further down from one of your links)</p>\n\n<p>If you need to use both <code>appengine</code> and <code>google.golang.org/appengine</code> then you can alias the import paths to make this possible. Something like:</p>\n\n<pre><code>import (\n   oldAppengine \"appengine\"\n   \"google.golang.org/appengine\"\n)\n</code></pre>\n\n<p>Or whatever you want to name them.</p>\n\n<p>If something's not available when you deploy, you'll get errors on build and it won't deploy to App Engine, so you don't have to worry about it.</p>\n"}, {"tags": [], "owner": {"reputation": 3036, "user_id": 1431972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TlLSH.jpg?s=128&g=1", "display_name": "Lawrence Mok", "link": "https://stackoverflow.com/users/1431972/lawrence-mok"}, "is_accepted": false, "score": 1, "last_activity_date": 1460024852, "creation_date": 1460024852, "answer_id": 36473434, "question_id": 32271148, "link": "https://stackoverflow.com/questions/32271148/how-to-correctly-import-golang-appengine/36473434#36473434", "title": "How to correctly import Golang appengine?", "body": "<p>If you are using gosdk, just run <code>goapp get</code> in the same directory as your .go file and it will download and install the dependencies to your gosdk installation. You then deploy the app again and it should compile without problem.</p>\n\n<p>When it's working there's no prompt and files will be downloaded to gosdk\\gopath\\src</p>\n\n<p>After fininshing there will be a warning message which can be ignored:</p>\n\n<blockquote>\n  <p>go install: no install location for directory\n  C:\\your_current_directory outside GOPATH\n          For more details see: go help gopath</p>\n</blockquote>\n"}], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6093, "favorite_count": 4, "accepted_answer_id": 32280565, "answer_count": 2, "score": 16, "last_activity_date": 1460024852, "creation_date": 1440765001, "last_edit_date": 1440785835, "question_id": 32271148, "link": "https://stackoverflow.com/questions/32271148/how-to-correctly-import-golang-appengine", "title": "How to correctly import Golang appengine?", "body": "<p>In my Google App Engine project written in Go I've been using e.g.</p>\n\n<pre><code>import \"appengine/datastore\"\n</code></pre>\n\n<p>with success for a long time and assuming the import locates things where I have the App Engine SDK. However, now I want to use a third party library also from Google that uses things from App Engine as well, but imports with the full path:</p>\n\n<pre><code>import \"google.golang.org/appengine\"\n</code></pre>\n\n<p>Running the app</p>\n\n<pre><code>$ goapp serve\n</code></pre>\n\n<p>fails with not finding appengine:</p>\n\n<pre><code>...go/src/golang.org/x/oauth2/client_appengine.go:16: can't find import: \"google.golang.org/appengine/urlfetch\"\n\nCan't find package \"google.golang.org/appengine\" in $GOPATH\n</code></pre>\n\n<p>Obviously I want to use the same App Engine parts to not have other problems. My first through is that I want to tell the third party library to use the App Engine SDK libraries, but I don't know how as it has a different prefix in the import.</p>\n\n<p>Should I use the full path in my project for all App Engine imports? This would be opposite to what is in all what I have read on the Google's App Engine for Golang webpages. E.g. <a href=\"https://cloud.google.com/appengine/docs/go/gettingstarted/usingusers\">here</a>.</p>\n\n<p><strong>Generally, what is the way to set up things so that it finds the right appengine libraries both in development and production on App Engine as well as from third party libraries?</strong></p>\n\n<p>Thanks in advance for any help!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I can also see that after adding the third party library and running <code>go get</code> it fetched all kinds of stuff into <code>$GOPATH/src/google.golang.org/api/...</code>. Lots of stuff there and appengine as well etc. It seems to be all Golang Google APIs...!</p>\n\n<p>So it's not resolved but I have learned that there's a change that changes to <a href=\"https://github.com/golang/appengine#2-update-import-paths\">fully qualified appengine import paths</a>.</p>\n\n<p>Now I have my app running locally as I pulled in the new appengine to satisfy the oauth library that uses the new import paths.</p>\n\n<pre><code>go get google.golang.org/appengine\n</code></pre>\n\n<p>According to <a href=\"https://github.com/golang/oauth2#app-engine\">this</a>:</p>\n\n<p><em>If you don't want to update your entire app to use the new App Engine packages, you may use both sets of packages in parallel, using only the new packages with the oauth2 package.</em></p>\n\n<p>Actually very confusing and I don't know what is available when I deploy on App Engine. Does anyone know?</p>\n"}, {"tags": ["templates", "go", "render"], "comments": [{"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440762806, "post_id": 32268954, "comment_id": 52419403, "body": "This? <a href=\"http://play.golang.org/p/EZJt-y-mMJ\" rel=\"nofollow noreferrer\">play.golang.org/p/EZJt-y-mMJ</a>"}, {"owner": {"reputation": 11, "user_id": 5170123, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2f5e55fce224cf6f6a6ec7b00c28687?s=128&d=identicon&r=PG&f=1", "display_name": "Gopher", "link": "https://stackoverflow.com/users/5170123/gopher"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440767063, "post_id": 32268954, "comment_id": 52422181, "body": "Great! This is what i want! Thank you VERY MUCH! Little question little bit ;)"}, {"owner": {"reputation": 11, "user_id": 5170123, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2f5e55fce224cf6f6a6ec7b00c28687?s=128&d=identicon&r=PG&f=1", "display_name": "Gopher", "link": "https://stackoverflow.com/users/5170123/gopher"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440767527, "post_id": 32268954, "comment_id": 52422519, "body": "Great! This is what i want! Thank you VERY MUCH! Little question little bit ;)  When i read json from file. If i print json file: <code>[{test1 test1}]</code> Ok, convert to byte: <code>byt := []byte(config.Social)</code> it types this: <code>cannot convert config.Social (type []struct { Employer string &quot;json:\\&quot;url\\&quot;&quot;; Title string &quot;json:\\&quot;Role\\&quot;&quot; }) to type []byte</code>"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440767767, "post_id": 32268954, "comment_id": 52422679, "body": "What you want to acheive? You want to marshall your structure to byte array? Please provide an example"}, {"owner": {"reputation": 11, "user_id": 5170123, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2f5e55fce224cf6f6a6ec7b00c28687?s=128&d=identicon&r=PG&f=1", "display_name": "Gopher", "link": "https://stackoverflow.com/users/5170123/gopher"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440768357, "post_id": 32268954, "comment_id": 52423099, "body": "<a href=\"https://gist.github.com/liamka/e25ef01d6e8736066769\" rel=\"nofollow noreferrer\">gist.github.com/liamka/e25ef01d6e8736066769</a> Here!"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440770305, "post_id": 32268954, "comment_id": 52424469, "body": "If I understand you correct, you don&#39;t need to use unmarshall on your &#39;config&#39;. Just copy values from your config. I can&#39;t provide answer right now, I am driving now. I will help later"}, {"owner": {"reputation": 11, "user_id": 5170123, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2f5e55fce224cf6f6a6ec7b00c28687?s=128&d=identicon&r=PG&f=1", "display_name": "Gopher", "link": "https://stackoverflow.com/users/5170123/gopher"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440773699, "post_id": 32268954, "comment_id": 52426845, "body": "Thanks! I look forward! Drive safety!"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1441015760, "post_id": 32268954, "comment_id": 52492608, "body": "Sorry, I was out from my computer. Try this <a href=\"https://play.golang.org/p/YoWER5AKNK\" rel=\"nofollow noreferrer\">play.golang.org/p/YoWER5AKNK</a>"}], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1440778070, "post_id": 32271033, "comment_id": 52429532, "body": "That still isn&#39;t an entirely accurate representation of his data."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1440779544, "post_id": 32271033, "comment_id": 52430238, "body": "Its sufficient, and he doesn&#39;t use the remaining attribute."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1440780395, "post_id": 32271033, "comment_id": 52430650, "body": "Yeah that&#39;s true, the other property isn&#39;t needed. I think it&#39;s worth detailing though because OP&#39;s problem is arising from not understanding the structure of the json and/or how it is modeled in Go."}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": false, "score": 0, "last_activity_date": 1440769141, "last_edit_date": 1440769141, "creation_date": 1440764658, "answer_id": 32271033, "question_id": 32268954, "link": "https://stackoverflow.com/questions/32268954/add-to-array-from-json-and-execute-data-in-template/32271033#32271033", "title": "Add to array from json and execute data in template", "body": "<p>First thing, your <code>dat</code> var isn't of the right type. You should have something like that:</p>\n\n<pre><code>dat := struct {\n    Jobs []*Job\n}\n</code></pre>\n\n<p>That way, when unmarshalling your JSON string into <code>dat</code>, the <code>Jobs</code> key will be filled with a array of <code>*Job</code> initialized with your data's array.\nI'm using an anonymous struct, but you could also have a named struct (see @RoninDev's comment for an example).</p>\n\n<p>Then, just add them to the person array, something like that:</p>\n\n<pre><code>person.Jobs = append(person.Jobs, jobs.Jobs...)\n</code></pre>\n\n<p>Note the <code>...</code> operator, which use an array as a variadic argument.</p>\n\n<p>You can see the full working code on this <kbd><a href=\"http://play.golang.org/p/eCRM2u_pCN\" rel=\"nofollow\">playground</a></kbd>.</p>\n"}, {"comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440779626, "post_id": 32275453, "comment_id": 52430285, "body": "I think that <code>jobs := dat[&quot;Jobs&quot;].([]Job)</code> would fail, as unmarshalling of <code>interface{}</code> to <code>[]type</code> isn&#39;t a single operatin\u2026"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440780196, "post_id": 32275453, "comment_id": 52430557, "body": "@Elwinar yeah that&#39;s true, it&#39;s actually a lot more work to unbox that data."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1440780252, "last_edit_date": 1440780252, "creation_date": 1440778387, "answer_id": 32275453, "question_id": 32268954, "link": "https://stackoverflow.com/questions/32268954/add-to-array-from-json-and-execute-data-in-template/32275453#32275453", "title": "Add to array from json and execute data in template", "body": "<p>You're unmarshalling the json fine, it's just into the most ambiguous type the language offers... You could unbox it with a series of type asserts but I don't recommend it. The json can easily be modeled in Go with a structure like the following;</p>\n\n<pre><code>type Wrapper struct {\n    Num float64 `json:\"num\"`\n    Jobs []*Job  `json:\"Jobs\"`\n}\n</code></pre>\n\n<p>Here's an updated example of your code using that struct; <a href=\"http://play.golang.org/p/aNLK_Uk2km\" rel=\"nofollow\">http://play.golang.org/p/aNLK_Uk2km</a></p>\n\n<p>After you've deserialized them you can just use <code>append</code> to add them to the jobs array in the person object like <code>person.Jobs = append(person.Jobs, dat.Jobs...)</code></p>\n"}], "owner": {"reputation": 11, "user_id": 5170123, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d2f5e55fce224cf6f6a6ec7b00c28687?s=128&d=identicon&r=PG&f=1", "display_name": "Gopher", "link": "https://stackoverflow.com/users/5170123/gopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1440780252, "creation_date": 1440757914, "last_edit_date": 1440763786, "question_id": 32268954, "link": "https://stackoverflow.com/questions/32268954/add-to-array-from-json-and-execute-data-in-template", "title": "Add to array from json and execute data in template", "body": "<p>I have a little qiestion!</p>\n\n<p>How add to array data from json and execute template. Simple. But Not working!</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html/template\"\n    \"os\"\n    \"encoding/json\"\n)\n\ntype Person struct {\n    Name   string\n    Jobs   []*Job\n}\n\ntype Job struct {\n    Employer string\n    Role     string\n}\n\nconst templ = `The name is {{.Name}}.\n\n{{with .Jobs}}\n    {{range .}}\n        An employer is {{.Employer}}\n        and the role is {{.Role}}\n    {{end}}\n{{end}}\n`\n\nfunc main() {\n    job1 := Job{Employer: \"Monash\", Role: \"Honorary\"}\n    job2 := Job{Employer: \"Box Hill\", Role: \"Head of HE\"}\n\n    byt := []byte(`{\"num\":6.13,\"Jobs\":[{\"Employer\": \"test1\", \"Role\": \"test1\"},{\"Employer\": \"test2\", \"Role\": \"test2\"}]}`)\n\n    var dat map[string]interface{}\n\n    if err := json.Unmarshal(byt, &amp;dat); err != nil {\n             panic(err)\n        }\n        fmt.Println(dat)\n\n\n\n\n    // HOW ADD FROM ARRAY 'dat' TO STRUCT 'Job'\n    // LINE 54\n\n\n\n\n    person := Person{\n        Name:   \"jan\",\n        Jobs:   []*Job{&amp;job1, &amp;job2},\n    }\n\n    t := template.New(\"Person template\")\n    t, err := t.Parse(templ)\n    checkError(err)\n\n    err = t.Execute(os.Stdout, person)\n    checkError(err)\n}\n\n\n\n\n\nfunc checkError(err error) {\n    if err != nil {\n        fmt.Println(\"Fatal error \", err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>Here you can play/test code: <a href=\"http://play.golang.org/p/AB8hGLrLRy\" rel=\"nofollow\">http://play.golang.org/p/AB8hGLrLRy</a></p>\n\n<p>Watch line 46.</p>\n\n<p>Thank you very much!</p>\n"}, {"tags": ["performance", "go", "append", "slice"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440742288, "post_id": 32264208, "comment_id": 52407848, "body": "Growing more slices means more allocations. If the format of the data you&#39;re storing is in fact static, you can declare them statically so there is no bookkeeping to do.: <code>type Vec3 struct { X, Y, Z float32 }; type Vec4 struct { X, Y, Z, W float32 }; type Color struct { R, G, B, A byte }</code> and then you have <code>type VertexInfo { Translations, Scales [4]Vec3; Rotations [4]Vec4; Colors [4]Color }</code> (or maybe drop the internal arrays and use a <code>[4]VertexInfo</code> if it&#39;s all the same)."}, {"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440768749, "post_id": 32264208, "comment_id": 52423359, "body": "this is a good idea, i will try it when I get home"}, {"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440775796, "post_id": 32264208, "comment_id": 52428239, "body": "thought about this.. cant implement in this way in structs because they have to go in &quot;arrays&quot; for opengl cgo anyways."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440799892, "post_id": 32264208, "comment_id": 52439621, "body": "Ah, bummer. It might also be that it&#39;s mostly GC making this expensive. Tuning memory layout makes sense to me, but it could also help to recycle with <a href=\"http://godoc.org/sync#Pool\" rel=\"nofollow noreferrer\"><code>sync.Pool</code></a> or, if you have RAM to spare, using <a href=\"https://godoc.org/runtime/debug#SetGCPercent\" rel=\"nofollow noreferrer\"><code>runtme.SetGCPercent</code></a> to make GCs less frequent at the cost of using more RAM."}, {"owner": {"reputation": 15557, "user_id": 390807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f64fce01ffa86130c3fae06b1fcadef?s=128&d=identicon&r=PG", "display_name": "chill", "link": "https://stackoverflow.com/users/390807/chill"}, "edited": false, "score": 2, "creation_date": 1440826637, "post_id": 32264208, "comment_id": 52444251, "body": "@efel what do you do with the slices between frames? If you&#39;re setting them to <code>nil</code> it would cause reallocation on the next appends. You can set a slice to zero length and nonzero capacity with <code>a = a[:0]</code> - it will not reallocate if, for example, on the next frame the slice is the same length."}], "answers": [{"comments": [{"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "edited": false, "score": 0, "creation_date": 1440763810, "post_id": 32264367, "comment_id": 52420032, "body": "Initializing with the items did save some fps but i&#39;m still losing about 4 fps with initializing items.. This doesnt make sense how can doing only 4 iterations of 3-4 things cost that much cpu overhead??"}, {"owner": {"reputation": 195, "user_id": 1035704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c883fb6c6f1304c1b4b6eb1b0147b792?s=128&d=identicon&r=PG", "display_name": "szablica", "link": "https://stackoverflow.com/users/1035704/szablica"}, "reply_to_user": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "edited": false, "score": 0, "creation_date": 1440787505, "post_id": 32264367, "comment_id": 52434359, "body": "@efel Did yoyu specify a length and/or a capacity when using <code>make</code>? If you&#39;re doing this every frame, then you should probably reuse a single slice instead of creating a new one each frame. Depending on how you create and use the slices Go might need to allocate on the heap and create garbage (both of which will slow you down in different ways)."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 4, "last_activity_date": 1440742110, "creation_date": 1440742110, "answer_id": 32264367, "question_id": 32264208, "link": "https://stackoverflow.com/questions/32264208/appending-to-slice-bad-performance-why/32264367#32264367", "title": "Appending to slice bad performance.. why?", "body": "<p>An empty slice is empty. To append, it must allocate memory. And then you do more appends, which have to allocate even more memory.</p>\n\n<p>To speed it up use a fixed size array or use <code>make</code> to create a slice with the correct length, or initialize the slice with the items when you declare it.</p>\n"}, {"comments": [{"owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "edited": false, "score": 0, "creation_date": 1440763257, "post_id": 32264631, "comment_id": 52419697, "body": "I tried putting all 4 iterations inside like this and it did increase fps by about 4.  However; I&#39;m still losing about ~4 fps from creating this slice the way you mentioned, why??"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "edited": false, "score": 0, "creation_date": 1440763853, "post_id": 32264631, "comment_id": 52420054, "body": "@efel Seeing so little from your code I can&#39;t really tell. Maybe in other places of your code you append more which will need reallocation. If this is the case, you can allocate a bigger slice (e.g with <code>make()</code>)."}, {"owner": {"reputation": 2379, "user_id": 2341555, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/476ecfbcabcf62dc4dcacf98b846ac81?s=128&d=identicon&r=PG", "display_name": "ben schwartz", "link": "https://stackoverflow.com/users/2341555/ben-schwartz"}, "edited": false, "score": 1, "creation_date": 1440801548, "post_id": 32264631, "comment_id": 52440139, "body": "Note in the <code>make([]float64, 16, 32)</code> ex, the 16 is the slice Len, and the 32 is the array (allocation) size. So it can be appended to up to 32 elements without needing to reallocate"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1440772366, "last_edit_date": 1440772366, "creation_date": 1440743334, "answer_id": 32264631, "question_id": 32264208, "link": "https://stackoverflow.com/questions/32264208/appending-to-slice-bad-performance-why/32264631#32264631", "title": "Appending to slice bad performance.. why?", "body": "<p>The builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow\"><code>append()</code></a> needs to create a new backing array if the capacity of the destination slice is less than what the length of the slice would be after the append. This also requires to copy the current elements from destination to the newly allocated array, so there are much overhead.</p>\n\n<p>Slices you append to are most likely empty slices since you used a slice literal to create your <code>Opengl.OpenGLVertexInfo</code> value. Even though <code>append()</code> thinks for the future and allocates a bigger array than what is needed to append the specified elements, chances are that in your case multiple reallocations will be needed to complete the 4 iterations.</p>\n\n<p>You may avoid reallocations if you create and initialize <code>vertexInfo</code> like this:</p>\n\n<pre><code>vertexInfo := Opengl.OpenGLVertexInfo{\n    Translations: []float32{float32(s.x), float32(s.y), 0, float32(s.x), float32(s.y), 0, float32(s.x), float32(s.y), 0, float32(s.x), float32(s.y), 0},\n    Rotations:    []float64{0, 0, 1, s.rot, 0, 0, 1, s.rot, 0, 0, 1, s.rot, 0, 0, 1, s.rot},\n    Scales:       []float64{s.xS, s.yS, 0, s.xS, s.yS, 0, s.xS, s.yS, 0, s.xS, s.yS, 0},\n    Colors:       []float64{s.r, s.g, s.b, s.a, s.r, s.g, s.b, s.a, s.r, s.g, s.b, s.a, s.r, s.g, s.b, s.a},\n}\n</code></pre>\n\n<p>Also note that this struct literal will take care of not having to reallocate arrays behind the slices. But if in other places of your code (which we don't see) you append further elements to these slices, they may cause reallocations. If this is the case, you should create slices with bigger capacity covering \"future\" allocations (e.g. <code>make([]float64, 16, 32)</code>).</p>\n"}], "owner": {"reputation": 876, "user_id": 2305723, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/23e6e73c52938ec01c706097cf4e8943?s=128&d=identicon&r=PG", "display_name": "efel", "link": "https://stackoverflow.com/users/2305723/efel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8011, "favorite_count": 1, "accepted_answer_id": 32264631, "answer_count": 2, "score": 7, "last_activity_date": 1440818761, "creation_date": 1440741289, "last_edit_date": 1440818761, "question_id": 32264208, "link": "https://stackoverflow.com/questions/32264208/appending-to-slice-bad-performance-why", "title": "Appending to slice bad performance.. why?", "body": "<p>I'm currently creating a game using GoLang.  I'm measuring the FPS. I'm noticing about a 7 fps loss using a for loop to append to a slice like so:</p>\n\n<pre><code>vertexInfo := Opengl.OpenGLVertexInfo{}\n\nfor i := 0; i &lt; 4; i = i + 1 {\n    vertexInfo.Translations = append(vertexInfo.Translations, float32(s.x), float32(s.y), 0)\n    vertexInfo.Rotations = append(vertexInfo.Rotations, 0, 0, 1, s.rot)\n    vertexInfo.Scales = append(vertexInfo.Scales, s.xS, s.yS, 0)\n    vertexInfo.Colors = append(vertexInfo.Colors, s.r, s.g, s.b, s.a)\n\n}\n</code></pre>\n\n<p>I'm doing this for every sprite, every draw. The question is why do I get such a huge performance hit with just looping for times and appending the same thing to these slices? Is there a more efficient way to do this?  It is not like I'm adding exuberant amount of data. Each slice contains about 16 elements as shown above (4 x 4).  </p>\n\n<p>When I simply put all 16 elements in one <code>[]float32{1..16}</code> then fps is improved by about 4. </p>\n\n<p><strong>Update:</strong> I benchmarked each append and it seems that each one takes 1 fps to perform.. That seems like a lot considering this data is pretty static.. I only need 4 iterations...</p>\n\n<p><strong>Update:</strong>  Added github repo <a href=\"https://github.com/Triangle345/GT\" rel=\"noreferrer\">https://github.com/Triangle345/GT</a></p>\n"}, {"tags": ["amazon-web-services", "go", "docker", "amazon-elastic-beanstalk"], "comments": [{"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440763363, "post_id": 32263096, "comment_id": 52419759, "body": "Can you get the snapshot logs from the web interface? It can give you more information. I don&#39;t know if it&#39;s also accessible with the <code>eb</code> command, but it should be."}, {"owner": {"reputation": 21, "user_id": 2723042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AYLPv.jpg?s=128&g=1", "display_name": "AlexNa", "link": "https://stackoverflow.com/users/2723042/alexna"}, "reply_to_user": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440779925, "post_id": 32263096, "comment_id": 52430442, "body": "Thank you for the reply. Here is the detailed debug log. Hopefully you can see something here. <a href=\"https://docs.google.com/document/d/1pR_10oNtDqCvg0df4Jhh9G18LsydbRNmt9H00X_gROM/edit?usp=sharing\" rel=\"nofollow noreferrer\">log file</a>"}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440781435, "post_id": 32263096, "comment_id": 52431214, "body": "I don&#39;t see what the error was in that log. The log I had in mind has a different format from what I can remember. It would show logs from docker as well. You can get it if you go to your environment, click on Logs on the menu to the left then &quot;Last 100 Lines&quot; in the &quot;Request Logs&quot; dropdown. You could ask for &quot;Full Logs&quot; too,  but last 100 is usually enough."}, {"owner": {"reputation": 21, "user_id": 2723042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AYLPv.jpg?s=128&g=1", "display_name": "AlexNa", "link": "https://stackoverflow.com/users/2723042/alexna"}, "reply_to_user": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440787931, "post_id": 32263096, "comment_id": 52434576, "body": "Here are the last 100 lines of log: <a href=\"https://docs.google.com/document/d/1xqxYvDCXNdanGh5eVgFG8ofdIg6L9g3Vib9cZzbpZkI/edit?usp=sharing\" rel=\"nofollow noreferrer\">Last 100 lines</a>"}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 0, "creation_date": 1440788133, "post_id": 32263096, "comment_id": 52434686, "body": "I&#39;m not sure what to tell you, the only thing that seems relevant is <code>no buildable Go source files in &#47;go&#47;src&#47;app</code>. It looks like it can&#39;t find your go source files but I have no idea why. :("}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440957185, "post_id": 32292618, "comment_id": 52475366, "body": "Instead of a second answer I suggest you <a href=\"http://stackoverflow.com/posts/32290477/edit\">edit</a> the first to contain this information (and then delete this answer). In general if more answers get added there is no guarantee on the order in which someone will see/read the answers (default sort is by votes) so your correction/reference to your first answer doesn&#39;t work well."}], "tags": [], "owner": {"reputation": 21, "user_id": 2723042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AYLPv.jpg?s=128&g=1", "display_name": "AlexNa", "link": "https://stackoverflow.com/users/2723042/alexna"}, "is_accepted": false, "score": 0, "last_activity_date": 1440965932, "last_edit_date": 1440965932, "creation_date": 1440901965, "answer_id": 32292618, "question_id": 32263096, "link": "https://stackoverflow.com/questions/32263096/aws-docker-golang-eb-deploy-error/32292618#32292618", "title": "AWS Docker Golang. &#39;eb deploy&#39; error", "body": "<p>Move your project folder into </p>\n\n<pre><code>/go/src/{your_project}\n</code></pre>\n\n<p>The problem was that my project folder was outside $GOPATH folder. Once I fixed that, 'eb deploy' starts to work.</p>\n"}], "owner": {"reputation": 21, "user_id": 2723042, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AYLPv.jpg?s=128&g=1", "display_name": "AlexNa", "link": "https://stackoverflow.com/users/2723042/alexna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 812, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1440965932, "creation_date": 1440734182, "last_edit_date": 1440735710, "question_id": 32263096, "link": "https://stackoverflow.com/questions/32263096/aws-docker-golang-eb-deploy-error", "title": "AWS Docker Golang. &#39;eb deploy&#39; error", "body": "<p>I am trying to deploy golang docker to AWS. </p>\n\n<ol>\n<li>I use predefined  FROM golang:1.4.2-onbuild</li>\n<li>eb local run - works beautifully, no problem.</li>\n<li>If I zip and upload the zip file, it works on AWS no problem.</li>\n<li>...but when I try 'eb deploy' I keep getting this error. </li>\n</ol>\n\n<p>Any suggestion, please.</p>\n\n<p>Thank you.</p>\n\n<pre><code>bash-3.2$ eb deploy\nWARNING: Deploying a previously deployed commit.\nINFO: Environment update is starting.                               \nINFO: Deploying new version to instance(s).                         \nWARN: Failed to build Docker image aws_beanstalk/staging-app, retrying...\nERROR: Failed to build Docker image aws_beanstalk/staging-app: urce files in /go/src/app\n[0mtime=\"2015-08-28T03:48:44Z\" level=\"info\" msg=\"The command [/bin/sh -c go-wrapper install] returned a non-zero code: 1\" . Check snapshot logs for details.\nERROR: [Instance: i-bf189879] Command failed on instance. Return code: 1 Output: (TRUNCATED)...n-zero code: 1\" \nFailed to build Docker image aws_beanstalk/staging-app: urce files in /go/src/app\n[0mtime=\"2015-08-28T03:48:44Z\" level=\"info\" msg=\"**The command [/bin/sh -c go-wrapper install] returned a non-zero code: 1**\" . Check snapshot logs for details. \nHook /opt/elasticbeanstalk/hooks/appdeploy/pre/03build.sh failed. For more detail, check /var/log/eb-activity.log using console or EB CLI.\nINFO: Command execution completed on all instances. Summary: [Successful: 0, Failed: 1].\nERROR: Unsuccessful command execution on instance id(s) 'i-bf189879'. Aborting the operation.\nERROR: Failed to deploy application. \n</code></pre>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440743742, "post_id": 32262108, "comment_id": 52408424, "body": "&quot;When I import fred.go&quot; ... I hope you mean <code>import &quot;fred&quot;</code>, you do not import individual *.go files by name."}], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 612829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wB0H0.jpg?s=128&g=1", "display_name": "Martin Ellison", "link": "https://stackoverflow.com/users/612829/martin-ellison"}, "edited": false, "score": 0, "creation_date": 1447775382, "post_id": 32266589, "comment_id": 55289942, "body": "I&#39;m using version 15 of Intellij Idea and version 0.10.607 of the plugin now, and I still do not have this working properly. I cannot find any instructions that cover the current version of the plugin."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": false, "score": 1, "last_activity_date": 1440750514, "creation_date": 1440750514, "answer_id": 32266589, "question_id": 32262108, "link": "https://stackoverflow.com/questions/32262108/golang-plugin-in-intellij-idea-not-finding-all-files/32266589#32266589", "title": "Golang plugin in intellij-Idea not finding all files", "body": "<p>Please don't use 0.9.15.3. The latest plugin should work properly for your case, if not please open a issue.</p>\n\n<p>To get the latest plugin, please follow the instructions from here: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin#pre-release-builds\" rel=\"nofollow\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin#pre-release-builds</a></p>\n"}], "owner": {"reputation": 564, "user_id": 612829, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/wB0H0.jpg?s=128&g=1", "display_name": "Martin Ellison", "link": "https://stackoverflow.com/users/612829/martin-ellison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440750514, "creation_date": 1440726375, "last_edit_date": 1440727442, "question_id": 32262108, "link": "https://stackoverflow.com/questions/32262108/golang-plugin-in-intellij-idea-not-finding-all-files", "title": "Golang plugin in intellij-Idea not finding all files", "body": "<p>This relates to the go language plugin (version 0.9.15.3) for IntelliJ IDEA. </p>\n\n<p>I have a directory structure in the following format:</p>\n\n<ul>\n<li>src/</li>\n<li><ul>\n<li>fred/</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>fred.go</li>\n</ul></li>\n</ul></li>\n<li><ul>\n<li>bill/</li>\n</ul></li>\n<li><ul>\n<li><ul>\n<li>bill.go</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>In (say) bill/bill.go, I import fred.go, and the compiler picks up references to fred.Something (when run from the command line). </p>\n\n<p>But IntelliJ IDEA does not recognise the references to fred.Something; they come up in red, and actions such as 'go to definition' do not work.</p>\n\n<p>Is there anything I can do to make this work?</p>\n\n<p>I don't want to upgrade to the alpha version of the plugin if I can help it, unless it is stable (in which case, it should not be alpha).</p>\n"}, {"tags": ["http", "url", "go", "routing", "server"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5274876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1eed74cc638f55ccd7a0e5f4f383b1?s=128&d=identicon&r=PG", "display_name": "Sawood Alam", "link": "https://stackoverflow.com/users/5274876/sawood-alam"}, "edited": false, "score": 2, "creation_date": 1440795704, "post_id": 32263700, "comment_id": 52438075, "body": "Thanks @OneOfOne for the elaborated example. It did what I wanted.  You are awesome!"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1440738648, "creation_date": 1440738648, "answer_id": 32263700, "question_id": 32261308, "link": "https://stackoverflow.com/questions/32261308/golang-modify-http-request-parameters-such-as-url-path-before-routing/32263700#32263700", "title": "Golang Modify HTTP Request Parameters Such As URL Path Before Routing", "body": "<p>You can implement a wrapper mux, that falls back to the default one, here's a very simple example:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/blah\", func(w http.ResponseWriter, req *http.Request) {\n        w.Write([]byte(\"w00t\"))\n    })\n    http.ListenAndServe(\":9090\", http.HandlerFunc(func(w http.ResponseWriter, req *http.Request) {\n        p := strings.SplitN(req.URL.RequestURI()[1:] /*trim the first slash*/, \"/\", 3)\n        if len(p) != 3 || p[0] != \"web\" {\n            http.DefaultServeMux.ServeHTTP(w, req)\n            return\n        }\n\n        t, err := time.Parse(\"20060102150405\", p[1])\n        if err != nil {\n            http.Error(w, \"invalid time\", 400)\n            return\n        }\n        url := p[2]\n        fmt.Fprintf(w, \"requested url %v @ %v\", url, t)\n    }))\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5274876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e1eed74cc638f55ccd7a0e5f4f383b1?s=128&d=identicon&r=PG", "display_name": "Sawood Alam", "link": "https://stackoverflow.com/users/5274876/sawood-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6396, "favorite_count": 0, "accepted_answer_id": 32263700, "answer_count": 1, "score": 3, "last_activity_date": 1440738648, "creation_date": 1440719944, "question_id": 32261308, "link": "https://stackoverflow.com/questions/32261308/golang-modify-http-request-parameters-such-as-url-path-before-routing", "title": "Golang Modify HTTP Request Parameters Such As URL Path Before Routing", "body": "<p>It's common practice in some cases to pass plain URIs as suffix of the path instead of a query parameter. Here is an example from Internet Archive's Wayback Machine.</p>\n\n<pre><code>https://web.archive.org/web/20150825082012/http://example.com/\n</code></pre>\n\n<p>In this example, user is requesting a copy of <code>http://example.com/</code> as captured at <code>2015-08-25 08:20:12</code>. If we were to implement similar service in Go, we probably would have a router as follows:</p>\n\n<pre><code>http.HandleFunc(\"/web/\", returnArchivedCopy)\n</code></pre>\n\n<p>Then in the <code>returnArchivedCopy</code> handler function, we will split <code>r.URL.Path</code> (where <code>r</code> is the Request object) to extract the date-time and the target URL. However there is a problem in this style of URL scheme; Go's net/http package calls <code>cleanPath</code> function on the path portion to sanitize it. This sanitization process does various cleanup tasks such as eeliminating <code>.</code> and <code>..</code> from the path and replace multiple slashes with a single one. This later operation makes sense when because in Unix systems <code>//</code> in the file path are same as <code>/</code>. However this causes an issue in the above described use case as <code>http://example</code> becomes <code>http:/example</code> and the server internally returns a redirect response to the client with the sanitized path.</p>\n\n<p>I am wondering, what are my options in this case? Is there a way to ask HTTP not to sanitize the request path while still utilizing all the default behavior that is shipped with the default (or slightly modified) server, multiplexer, and handler? Or is there a way to modify the request parameters (path in this case) before it hits the multiplexer's routing patterns. If the later is possible, we might try to perform something like URL encoding to avoid the redirect and later decode the URL back in the handler function before extracting desired bits.</p>\n\n<p>I have experimented with some custom handlers and multiplexers, but I am new to Go, hence I was not quite sure how to delegate the routing back to the default handlers after making changes in the request.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440743481, "post_id": 32260883, "comment_id": 52408317, "body": "Also, <code>io.Reader</code> allows a reader to return as much or as little data as it wants to on each <code>Read</code> call; it&#39;s fully allowed to return one byte per call if it wants. <code>gzip.Reader</code> doesn&#39;t say otherwise."}], "answers": [{"comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 1, "creation_date": 1440718919, "post_id": 32260942, "comment_id": 52401916, "body": "Not sure how I missed the returned number of bytes read. The advantage of bytes.Buffer is it needs no initialization ?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1440722265, "post_id": 32260942, "comment_id": 52402790, "body": "You have to initialise the buffer. The advantage to using a pool is that you don&#39;t &#39;throw it away&#39; (generate garbage) after use - you just reset the contents, return it to the pool and get it again. Initialisation is therefore a &#39;startup time cost&#39; only. A package like <a href=\"https://github.com/oxtoacart/bpool\" rel=\"nofollow noreferrer\">github.com/oxtoacart/bpool</a> provides a simple pool implementation."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 4, "last_activity_date": 1440717527, "creation_date": 1440717527, "answer_id": 32260942, "question_id": 32260883, "link": "https://stackoverflow.com/questions/32260883/is-there-a-better-way-to-read-unzipped-data-into-a-slice/32260942#32260942", "title": "Is there a better way to read unzipped data into a slice?", "body": "<p>For starters, <code>.Read</code> returns the numbers of bytes read, so you can do something like:</p>\n\n<pre><code>n, err = gzr.Read(ubs)\nubs = ubs[:n]\n</code></pre>\n\n<p>Also you can use a <code>bytes.Buffer</code> pool and do something like:</p>\n\n<pre><code>buf := getBufferFromPool()\nio.Copy(buf, gzr)\n</code></pre>\n"}], "owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 32260942, "answer_count": 1, "score": 0, "last_activity_date": 1440717527, "creation_date": 1440717195, "question_id": 32260883, "link": "https://stackoverflow.com/questions/32260883/is-there-a-better-way-to-read-unzipped-data-into-a-slice", "title": "Is there a better way to read unzipped data into a slice?", "body": "<p>I'm reading gzip data from a http request like this:</p>\n\n<pre><code>gzr, err := gzip.NewReader(resp.Body)\nhandle(err)\n</code></pre>\n\n<p>And then conservatively allocating a slice for the unzipped data.</p>\n\n<pre><code>cl := resp.Header.Get(\"Content-Length\")\nicl, err := strconv.Atoi(cl)\nhandle(err)\nubs := make([]byte, icl*3)\n</code></pre>\n\n<p>And finally trimming the slice after reading</p>\n\n<pre><code>_, err = gzr.Read(ubs)\nubs = bytes.TrimRightFunc(ubs, sliceFunc)\n</code></pre>\n\n<p>Is there a better way to do this ?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1440717569, "post_id": 32260877, "comment_id": 52401548, "body": "You&#39;ve got no json labels on your structs"}], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "is_accepted": true, "score": 2, "last_activity_date": 1440717581, "creation_date": 1440717581, "answer_id": 32260952, "question_id": 32260877, "link": "https://stackoverflow.com/questions/32260877/unmarshaling-string-with-repeated-fields-into-json/32260952#32260952", "title": "Unmarshaling string with repeated fields into json", "body": "<p>The names of your variables don't match the names of the json keys and both of them are <code>[]string</code>. You can do</p>\n\n<pre><code>type HeaderStruct struct {\n    A []string `json:\"Encoding-Type\"`\n    B []string `json:\"Bytes\"\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1440717835, "creation_date": 1440717835, "answer_id": 32260995, "question_id": 32260877, "link": "https://stackoverflow.com/questions/32260877/unmarshaling-string-with-repeated-fields-into-json/32260995#32260995", "title": "Unmarshaling string with repeated fields into json", "body": "<p>You need json annotations to tell the unmarshaller which data goes where, also the type of <code>A</code> in your model is wrong, it should also be an array. I'm also going to change the names of your fields to something meaningful...</p>\n\n<pre><code>type HeaderStruct struct {\n    Encoding []string `json:\"Encoding-Type\"`\n    Bytes []string `json:\"Bytes\"\n}\n</code></pre>\n"}], "owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 32260952, "answer_count": 2, "score": 0, "last_activity_date": 1440717835, "creation_date": 1440717119, "question_id": 32260877, "link": "https://stackoverflow.com/questions/32260877/unmarshaling-string-with-repeated-fields-into-json", "title": "Unmarshaling string with repeated fields into json", "body": "<p>Trying to unmarshal a string into json, but my struct definitions don't work. How can it be fixed? </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"encoding/json\"\n\nfunc main() {\n    x := `{\n    \"Header\": {\n        \"Encoding-Type\": [\n            \"gzip\"\n        ],\n        \"Bytes\": [\n            \"29\"\n        ]\n    }\n}`\n\n    type HeaderStruct struct {\n        A string\n        B []string\n    }\n    type Foo struct {\n        Header HeaderStruct\n    }\n\n\n    var f Foo \n    if e := json.Unmarshal([]byte(x), &amp;f); e != nil {\n        fmt.Println(\"Failed:\", e)\n    } else {\n        fmt.Println(\"unmarshalled=\", f)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1440716290, "post_id": 32260337, "comment_id": 52401219, "body": "Did you try with go1.5? that seems more like a bug."}, {"owner": {"reputation": 1139, "user_id": 675283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/447f06617d5f30dbbcdd6d1b47d402fe?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/675283/justin"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1440777253, "post_id": 32260337, "comment_id": 52429074, "body": "I did but it didn&#39;t change the way it was acting."}], "owner": {"reputation": 1139, "user_id": 675283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/447f06617d5f30dbbcdd6d1b47d402fe?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/675283/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1440720902, "creation_date": 1440713853, "question_id": 32260337, "link": "https://stackoverflow.com/questions/32260337/why-does-os-isnotexist-not-return-the-current-response-when-looking-at-a-windows", "title": "Why does os.IsNotExist not return the current response when looking at a windows share? GoLang", "body": "<p>When I run this code.</p>\n\n<pre><code>fileInfo, err := os.Stat(\"\\\\\\\\server\\\\sharedFolder\\\\file.txt\") //The file is located on a windows share.\nif err != nil {\n    if os.IsNotExist(err) {\n        log.Fatal(\"-&gt;File does not exist. \",) \n    }\n} else {\n    fmt.Println(\"File does exist.\")\n}\n</code></pre>\n\n<p>The thing is it always says the file does not exist but I get the file size and other information from fileInfo. The file does exist and i can open it. I do open it and read information from it later on in my code but the os.IsNotExist always returns false information saying it does not exist when it does. Why is this?</p>\n\n<p>Thank you for your help!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1440710809, "post_id": 32259624, "comment_id": 52399328, "body": "Can you add a few more requirements. When do I stop? Does it have to be capable of making strings of any length? Also, what about <code>bb</code> ect? Sounds like you just want to preappend a&#39;s, is that true?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1440711665, "post_id": 32259624, "comment_id": 52399689, "body": "you&#39;re right...that didn&#39;t make much sense. I&#39;ve made an edit....so when aa runs out then start aaa, aab, aac, etc."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1440716023, "post_id": 32259624, "comment_id": 52401147, "body": "kristen that&#39;s cool. The problem is a lot simpler if the prefix is always a string of a&#39;s. I provided an answer that produces the expected output though it might not be exactly what you&#39;re looking for."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1440712028, "creation_date": 1440712028, "answer_id": 32259992, "question_id": 32259624, "link": "https://stackoverflow.com/questions/32259624/how-to-create-a-repeating-alphabetic-string/32259992#32259992", "title": "How to create a repeating alphabetic string?", "body": "<p>Below is a rewrite of your function that should do the trick. You'll note that is uses the fact that the letters A-Z have a sequential unicode numbering, meaning the alphabet does not have to be stored. </p>\n\n<pre><code>func NextAlias(last string) string {\n    if last == \"\" {\n        return \"a\"\n    } else if last[len(last)-1] == 'z' {\n        return last[:len(last)-1] + \"aa\"\n    } else {\n        return last[:len(last)-1] + string(last[len(last)-1] + 1)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Y2ViJKs_T4\" rel=\"nofollow\">https://play.golang.org/p/Y2ViJKs_T4</a></p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1440715867, "last_edit_date": 1440715867, "creation_date": 1440713158, "answer_id": 32260213, "question_id": 32259624, "link": "https://stackoverflow.com/questions/32259624/how-to-create-a-repeating-alphabetic-string/32260213#32260213", "title": "How to create a repeating alphabetic string?", "body": "<p>Rather than making use of your code I just re-wrote a little simpler algorithm to do this; <a href=\"https://play.golang.org/p/Iv6X8-SXY3\" rel=\"nofollow\">https://play.golang.org/p/Iv6X8-SXY3</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    letters := []string{\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\"}\n\n    prefix := \"a\"\n    for i := 0; i &lt; 5; i++ {\n        for i, _ := range letters {\n            letters = append(letters, prefix+letters[i%26])\n        }\n        prefix += \"a\"\n    }   \n\n    for j, _ := range letters {\n         fmt.Println(letters[j])\n    }\n}\n</code></pre>\n\n<p>You could also expand this so there is a variant prefix to get things like ba, bc, bd, bba, ect. To do that you'd want to change the outer loop to make use of the existing items in letters rather than statically calculating a prefix made only of a's. To increase the length of the strings just make <code>i</code> larger on the outer loop. You could also wrap this in a function and make that an argument to it. Lastly, if performance is a concern I recommend making your slice with a large initial capacity because this is making liberal use of append which will cause a lot or realloc's.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 32259992, "answer_count": 2, "score": 0, "last_activity_date": 1440715867, "creation_date": 1440710420, "last_edit_date": 1440711606, "question_id": 32259624, "link": "https://stackoverflow.com/questions/32259624/how-to-create-a-repeating-alphabetic-string", "title": "How to create a repeating alphabetic string?", "body": "<p>How do I create a bunch of alphabetic strings so that the first is \"a\", the 26th is \"z\", 27th is \"aa\"....e.g.:</p>\n\n<pre><code>a\nb\nc\nd\n...\n...\n...\nx\ny\nz\naa\nab\nac\nad\n...\n...\n...\nax\nay\naz\naaa\naab\naac\n...\n...\n...\naax\naay    \naaz\naaaa\naaab\n...\n...\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/SfwRGwNVsY\" rel=\"nofollow\">I have the following playground code</a>, but number 27 is \"za\" (s/b \"aa\"). I want to ultimately have the ability to create an infinite-length string w/ that pattern.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440709591, "post_id": 32259259, "comment_id": 52398714, "body": "You need to declare db outside of main."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440709744, "post_id": 32259259, "comment_id": 52398790, "body": "Will this cause my any issues with unit testing? I haven&#39;t done much with the testing framework yet, in Python I pull things in as a from/include with unittest but I doubt it&#39;s like that here."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440709962, "post_id": 32259259, "comment_id": 52398892, "body": "I don&#39;t see how it would be a problem in testing. Plus, you can&#39;t do <i>anything</i> with a <code>db</code> that only exists in main, so you either declare it at the package scope, or you create a context and pass that around to all handlers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440710199, "post_id": 32259259, "comment_id": 52399012, "body": "Works for me, I&#39;ll look at contexts as well. Thanks much!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440710340, "post_id": 32259259, "comment_id": 52399095, "body": "FYI, the most common package for context handling is <a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow noreferrer\">x/net/context</a>, but I would put that off until you know you need it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1440709462, "post_id": 32259353, "comment_id": 52398661, "body": "Yeah I&#39;m missing the defer in the example since it was a quick &#39;put an example&#39; together however I&#39;m still not getting how I could access the &#39;db&#39; object from main_handler, get_handler, set_handler. Trying to access &#39;db&#39; from any of those functions just comes up with &#39;undefined: db&#39;. I could do a closure in the scope but I feel like there has to be a way people are doing this where it&#39;s accessible from a function (perhaps included from another file). I suppose I could pass a pointer to the object through if I had to, I&#39;m still iffy on what namespace tomfoolery I can do in golang."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1440709709, "post_id": 32259353, "comment_id": 52398768, "body": "@RyanM yeah the other option would be to pass a reference to it into the scope where the handlers are defined. Yet another option would be to open the connection in that scope. If you just declare it in the main package, outside of the method I believe it will give it a global scope."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1440709823, "post_id": 32259353, "comment_id": 52398822, "body": "Will doing that (ie declaring in the global scope) cause any issues with unit tests? I haven&#39;t tinkered with the testing framework yet."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1440710019, "post_id": 32259353, "comment_id": 52398917, "body": "@RyanM I don&#39;t think it will be an issue but I can&#39;t guarantee that for lack of personal experience."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1440710226, "post_id": 32259353, "comment_id": 52399030, "body": "Others seem to think it&#39;ll work okay, or that I could use contexts to get around this. I think I&#39;m good to go."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1440709561, "last_edit_date": 1440709561, "creation_date": 1440709217, "answer_id": 32259353, "question_id": 32259259, "link": "https://stackoverflow.com/questions/32259259/golang-best-practice-to-access-shared-connection-resources/32259353#32259353", "title": "Golang best practice to access shared connection resources?", "body": "<p>There's a lot of ways you could deal with this. Firstly, having opened the connection in this scope, you probably want to defer it's close here.</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", \"user=root dbname=root\")\n        if err != nil {\n        log.Fatal(err)\n    }\ndefer db.Close()\n</code></pre>\n\n<p>Which will ensure the connection gets cleaned up when you're leaving this scope. Regarding your handlers... It would be simple to write them as closures in the same scope as the connection so you can use it freely.</p>\n\n<p>EDIT: To clarify, you said you don't think you can nest functions in main. You can do this with something like;</p>\n\n<pre><code>get_handler := func() {\n      return db.ReadTheData()\n}\nhttp.HandleFunc(\"get\", get_handler)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1440710522, "post_id": 32259592, "comment_id": 52399193, "body": "So I can just create a global sql.DB type variable and load the actual db object data in it later? Nice, thanks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440710680, "post_id": 32259592, "comment_id": 52399272, "body": "@RyanM: You&#39;re actually only creating the <code>db</code> variable of type <code>*sql.DB</code>, there is no pointer yet, and the value is <code>nil</code> until you assign something. It&#39;s sort of a semantic difference, but it&#39;s important to understand."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "edited": false, "score": 0, "creation_date": 1440710866, "post_id": 32259592, "comment_id": 52399358, "body": "Yeah I misspoke originally, editing the comment afterwards once I got my head wrapped around what was happening."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 0, "last_activity_date": 1440710275, "creation_date": 1440710275, "answer_id": 32259592, "question_id": 32259259, "link": "https://stackoverflow.com/questions/32259259/golang-best-practice-to-access-shared-connection-resources/32259592#32259592", "title": "Golang best practice to access shared connection resources?", "body": "<p>It's common for most apps to start out with the DB handler at the global scope. <code>sql.DB</code> is defined to be safe for concurrent access, and therefor can be simultaneously used by all handlers that need it. </p>\n\n<pre><code>var db *sql.DB\n\nfunc main() {\n    var err error\n    db, err = sql.Open(\"postgres\", \"user=root dbname=root\")\n    if err != nil {\n        log.Fatal(err)\n    }\n...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5076297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1061, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1524207268, "creation_date": 1440708838, "last_edit_date": 1524207268, "question_id": 32259259, "link": "https://stackoverflow.com/questions/32259259/golang-best-practice-to-access-shared-connection-resources", "title": "Golang best practice to access shared connection resources?", "body": "<p>What is the best practice for handling scope with dealing with shared connection resources to outside services in golang (RabbitMQ, database, etc)? For example, given this code using database/sql, pq, and http:</p>\n\n<pre><code>func main() {\n    db, err := sql.Open(\"postgres\", \"user=root dbname=root\")\n        if err != nil {\n        log.Fatal(err)\n    }\n\n    http.HandleFunc(\"/\", front_handler)\n    http.HandleFunc(\"/get\", get_handler)\n    http.HandleFunc(\"/set\", set_handler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>What's the best way to make the <code>db</code> object available to my registered handlers? </p>\n\n<p>Do I put the <code>db</code> declaration outside the main scope (this would cause me unit testing problems in Python but might be okay here)?</p>\n\n<p>Do I put the handler declarations inside the main scope (it doesn't seem like I'm allowed to nest functions)?</p>\n\n<p>Is there an addressing scheme I can use to access the main scope (I'd do something like that in puppet)?</p>\n\n<p>Some other option?</p>\n"}, {"tags": ["struct", "go", "reserved-words"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 5, "creation_date": 1440707865, "post_id": 32258946, "comment_id": 52397882, "body": "Read the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">package documentation</a> (preferably before asking questions). It&#39;ll tell you two important things, a) you need to export your fields and b) you can use a struct tag to rename the fields to/from JSON."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 27, "last_activity_date": 1440707924, "creation_date": 1440707924, "answer_id": 32259008, "question_id": 32258946, "link": "https://stackoverflow.com/questions/32258946/struct-field-with-reserved-name-golang/32259008#32259008", "title": "Struct field with reserved name golang", "body": "<p>That won't work to begin with, since you're not exporting the fields names. </p>\n\n<p>Otherwise, you can use struct tags to name the json fields as you need</p>\n\n<pre><code>type Card struct {\n    CardID  string `json:\"cardId\"`\n    Name    string `json:\"name\"`\n    CardSet string `json:\"cardSet\"`\n    Type    string `json:\"type\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1440708017, "creation_date": 1440708017, "answer_id": 32259033, "question_id": 32258946, "link": "https://stackoverflow.com/questions/32258946/struct-field-with-reserved-name-golang/32259033#32259033", "title": "Struct field with reserved name golang", "body": "<p>You have to use json annotations on your model. Also, the fields have to be exported (upper case) or the unmarshaller won't be able to make use of them. </p>\n\n<pre><code>type Card struct {\n  CardId  string `json:\"cardId\"`\n  Name    string `json:\"name\"`\n  CardSet string `json:\"cardSet\"`\n  TheType    string  `json:\"type\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 4324, "user_id": 1259923, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/eSrTO.png?s=128&g=1", "display_name": "Eefret", "link": "https://stackoverflow.com/users/1259923/eefret"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6346, "favorite_count": 0, "accepted_answer_id": 32259008, "answer_count": 2, "score": 19, "last_activity_date": 1440708017, "creation_date": 1440707694, "question_id": 32258946, "link": "https://stackoverflow.com/questions/32258946/struct-field-with-reserved-name-golang", "title": "Struct field with reserved name golang", "body": "<p>Hi Im doing an API client and I want to use a struct to pull out the json, the problem is that one of the json fields should be named type, as far as I know it is a reserved keyword, how can I create a struct with a \"type\" field in it?</p>\n\n<p>Example:</p>\n\n<p>What I want to do:</p>\n\n<pre><code>type Card struct {\n  cardId  string\n  name    string\n  cardSet string\n  type    string\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 2, "creation_date": 1440704416, "post_id": 32258023, "comment_id": 52396078, "body": "Golang&#39;s <code>http.Client</code> keeps a connection pool to make requests. A tcp connection is not made until you&#39;re actually ready to make the request."}, {"owner": {"reputation": 11, "user_id": 5274333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5a05f96eb7a6d2ba9ec6048d096189?s=128&d=identicon&r=PG&f=1", "display_name": "Socome23", "link": "https://stackoverflow.com/users/5274333/socome23"}, "reply_to_user": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 0, "creation_date": 1440705566, "post_id": 32258023, "comment_id": 52396692, "body": "So if for example I do client.Get(&quot;www.google.com&quot;) how will i be able to get the connection information."}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "edited": false, "score": 0, "creation_date": 1440706123, "post_id": 32258023, "comment_id": 52396982, "body": "<code>http.Client</code> doesn&#39;t expose the connection itself. If you want to be able to grab the connection you&#39;ll need to use <code>net.Conn</code>. From the looks of it, <code>http.Transport</code> Dial gives you the network and the address so you could probably work off that as it should only Dial when the request is made."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440706128, "post_id": 32258023, "comment_id": 52396986, "body": "@Socome23: you don&#39;t (well, you could log it form the Dialer, but you can&#39;t definitively link it to the client&#39;s call). Unless you set it yourself, the ip address used is determined by the OS, so you should be able to determine what it will be at any point."}], "owner": {"reputation": 11, "user_id": 5274333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e5a05f96eb7a6d2ba9ec6048d096189?s=128&d=identicon&r=PG&f=1", "display_name": "Socome23", "link": "https://stackoverflow.com/users/5274333/socome23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1123, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1605693055, "creation_date": 1440704058, "last_edit_date": 1605693055, "question_id": 32258023, "link": "https://stackoverflow.com/questions/32258023/getting-ip-address-and-port-number-from-http-client", "title": "Getting IP address and port number from http.Client", "body": "<p>I'm making a http Client that keeps an open connection. I want to get the IP address of the client made. I know that I can give it its own ip address by using transport's Dial function. However is there a way that I can obtain its address after declaring the client?</p>\n<pre><code>var tr= &amp;http.Transport{DisableKeepAlives:false}\nvar client = http.Client{Transport :tr}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1440701512, "post_id": 32256616, "comment_id": 52394588, "body": "@AerofoilKite it&#39;s pseudo code which I haven&#39;t tested, I suppose I can modify it for you if you can&#39;t make it work..."}, {"owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1440701704, "post_id": 32256616, "comment_id": 52394693, "body": "It will be helpful for me. I didn&#39;t get it yet"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "edited": false, "score": 0, "creation_date": 1440701980, "post_id": 32256616, "comment_id": 52394827, "body": "@AerofoilKite alright, here&#39;s a working example; <a href=\"https://play.golang.org/p/55V3HK9eSs\" rel=\"nofollow noreferrer\">play.golang.org/p/55V3HK9eSs</a> I left out the first line for the sake of simplicity."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1440700346, "last_edit_date": 1440700346, "creation_date": 1440699075, "answer_id": 32256616, "question_id": 32256407, "link": "https://stackoverflow.com/questions/32256407/in-go-language-how-to-take-input-step-by-step-from-file-as-like-freopen-in-c-c/32256616#32256616", "title": "In Go language how to take input step by step from file as like freopen in c/c++", "body": "<p>Your C program is just scanning the tokens one by one. Of course there are many ways to accomplish this in Go. I'd recommend the <code>bufio</code> package but really all you need is a reader and something to convert string to int. Below is an example that is similar to your C program.</p>\n\n<pre><code>import \"bufio\"\nimport \"strconv\"\n\nfile, err := os.Open(\"in.txt\")\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\n\nscanner := bufio.NewScanner(file)\n\nbase := 0\n\nif scanner.Scan() {\n    base += strconv.Atoi(scanner.Text())\n}\n\nscanner.Split(bufio.ScanWords)\n\nfor scanner.Scan() {\n    base += strconv.Atoi(scanner.Text())\n}\n\nif err := scanner.Err(); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Println(base)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 3, "last_activity_date": 1440699133, "creation_date": 1440699133, "answer_id": 32256632, "question_id": 32256407, "link": "https://stackoverflow.com/questions/32256407/in-go-language-how-to-take-input-step-by-step-from-file-as-like-freopen-in-c-c/32256632#32256632", "title": "In Go language how to take input step by step from file as like freopen in c/c++", "body": "<p>You don't need to scan only from stdin, open the file directly.</p>\n\n<p>The <code>fmt</code> package has a series of <a href=\"http://golang.org/pkg/fmt/#Fscanf\" rel=\"nofollow\"><code>fmt.Fscan*</code></a> functions for this.</p>\n"}], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 32256616, "answer_count": 2, "score": -2, "last_activity_date": 1440700346, "creation_date": 1440698390, "question_id": 32256407, "link": "https://stackoverflow.com/questions/32256407/in-go-language-how-to-take-input-step-by-step-from-file-as-like-freopen-in-c-c", "title": "In Go language how to take input step by step from file as like freopen in c/c++", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    freopen(\"in.txt\", \"r\", stdin);\n\n    int n, val, sum=0;\n    scanf(\"%d\", &amp;n);\n\n    for(int i=0; i&lt;n; i++)\n    {\n        scanf(\"%d\", &amp;val);\n        sum += val;\n    }\n\n    printf(\"%d\\n\", sum);  \n}\n</code></pre>\n\n<p>Input (<strong>in.txt</strong>):</p>\n\n<pre><code>5\n1 2 3 4 5\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>15\n</code></pre>\n\n<p>In C language above program will automatically take data from <strong>in.txt</strong> file. I do not need to provide data in console. </p>\n\n<p>Is there any way to do this in <strong>GO</strong> language? So that I do not need to provide huge amount of data manually or add that in code.</p>\n"}, {"tags": ["go", "ravendb", "ravendb-http"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1440695923, "post_id": 32255599, "comment_id": 52391377, "body": "I assume <code>curl -X POST -d &#39;{&quot;title&quot;: &quot;Buy cheese and bread for breakfast.&quot;}&#39; -H &#39;X-Custom-Header: myvalue&#39; -H &#39;Content-Type: application&#47;json&#39; http:&#47;&#47;localhost:8083&#47;databases&#47;drone&#47;docs&#47;1</code> works then?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440696018, "post_id": 32255599, "comment_id": 52391431, "body": "If you want a PATCH request, why are you making a POST?"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440696080, "post_id": 32255599, "comment_id": 52391472, "body": "Ha, good catch @JimB (didn&#39;t pay enough attention to the title)"}, {"owner": {"reputation": 2803, "user_id": 3186914, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/kkIb4.jpg?s=128&g=1", "display_name": "Prashant", "link": "https://stackoverflow.com/users/3186914/prashant"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440696137, "post_id": 32255599, "comment_id": 52391504, "body": "Sorry @JimB I was trying with post, get etc. I am getting same error for all these requests. I will edit the code :)"}], "answers": [{"comments": [{"owner": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "edited": false, "score": 3, "creation_date": 1465933175, "post_id": 32255735, "comment_id": 63105354, "body": "Using this code with a rails server I needed to include <code>req.Header.Set(&quot;Content-Type&quot;, &quot;application&#47;json&quot;)</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 8149, "user_id": 616644, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wVwGC.png?s=128&g=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/616644/rick-smith"}, "edited": false, "score": 0, "creation_date": 1465939855, "post_id": 32255735, "comment_id": 63108587, "body": "@RickSmith yeah the content-type header is going to be required more often than not. Checking your header is always worth while if an HTTP request is failing for unkown reasons."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1440696487, "last_edit_date": 1440696487, "creation_date": 1440696170, "answer_id": 32255735, "question_id": 32255599, "link": "https://stackoverflow.com/questions/32255599/how-to-make-http-patch-request-to-raven-db-server-using-golang/32255735#32255735", "title": "How to make HTTP Patch request to raven db server using golang?", "body": "<p><code>PATCH</code> and <code>POST</code> are different http verbs.</p>\n\n<p>I think you just need to change this;</p>\n\n<pre><code> req, _ := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonStr))\n</code></pre>\n\n<p>to</p>\n\n<pre><code> req, _ := http.NewRequest(\"PATCH\", url, bytes.NewBuffer(jsonStr))\n</code></pre>\n\n<p>Or at least that is the first thing. Based on comments I would speculate the body of your request is also bad.</p>\n"}, {"tags": [], "owner": {"reputation": 28312, "user_id": 258674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b4e8521656065d6f86ef3f35e7bfc964?s=128&d=identicon&r=PG", "display_name": "dev-null-dweller", "link": "https://stackoverflow.com/users/258674/dev-null-dweller"}, "is_accepted": true, "score": 6, "last_activity_date": 1440700359, "last_edit_date": 1440700359, "creation_date": 1440699698, "answer_id": 32256794, "question_id": 32255599, "link": "https://stackoverflow.com/questions/32255599/how-to-make-http-patch-request-to-raven-db-server-using-golang/32256794#32256794", "title": "How to make HTTP Patch request to raven db server using golang?", "body": "<p>For <a href=\"http://ravendb.net/docs/article-page/2.0/csharp/http-api/http-api-single#patch\" rel=\"noreferrer\"><strong>PATCH</strong></a> request, you need to pass an array with patch commands (in json format) to execute.</p>\n\n<p>To change the <code>title</code> attribute, it will look like:</p>\n\n<pre><code>var jsonStr = []byte(`[{\"Type\": \"Set\", \"Name\": \"title\", \"Value\": \"Buy cheese and bread for breakfast.\"}]`)\n</code></pre>\n"}], "owner": {"reputation": 2803, "user_id": 3186914, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/kkIb4.jpg?s=128&g=1", "display_name": "Prashant", "link": "https://stackoverflow.com/users/3186914/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5373, "favorite_count": 0, "accepted_answer_id": 32256794, "answer_count": 2, "score": 5, "last_activity_date": 1440700359, "creation_date": 1440695669, "last_edit_date": 1440696163, "question_id": 32255599, "link": "https://stackoverflow.com/questions/32255599/how-to-make-http-patch-request-to-raven-db-server-using-golang", "title": "How to make HTTP Patch request to raven db server using golang?", "body": "<p>I have written the following code to add a title field to the document 1 in my raven database.</p>\n\n<pre><code>url := \"http://localhost:8083/databases/drone/docs/1\"\nfmt.Println(\"URL:&gt;\", url)\n\nvar jsonStr = []byte(`{\"title\":\"Buy cheese and bread for breakfast.\"}`)\nreq, _ := http.NewRequest(\"PATCH\", url, bytes.NewBuffer(jsonStr))\nreq.Header.Set(\"X-Custom-Header\", \"myvalue\")\nreq.Header.Set(\"Content-Type\", \"application/json\")\n\nclient := &amp;http.Client{}\nresp, err := client.Do(req)\nif err != nil {\n    panic(err)\n}\ndefer resp.Body.Close()\n\nbody, _ := ioutil.ReadAll(resp.Body)\nfmt.Println(\"response Body:\", string(body))\n</code></pre>\n\n<p>I don't understand why it is not working? I am getting the following response Body which is not what I am expecting. I am expecting a success response.</p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n    &lt;h1&gt;Could not figure out what to do&lt;/h1&gt;\n    &lt;p&gt;Your request didn't match anything that Raven knows to do, sorry...&lt;/p&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>Can someone please point out what am I missing in the above code?</p>\n"}, {"tags": ["c++", "macos", "go", "compilation", "zeromq"], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 1520360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cefb7c450948c41bfad15187676e30da?s=128&d=identicon&r=PG", "display_name": "saintech", "link": "https://stackoverflow.com/users/1520360/saintech"}, "is_accepted": false, "score": 0, "last_activity_date": 1443698101, "creation_date": 1443698101, "answer_id": 32886199, "question_id": 32254876, "link": "https://stackoverflow.com/questions/32254876/issue-compiling-go-program-when-linking-to-a-compiled-version-of-zeromq-on-mac/32886199#32886199", "title": "Issue compiling Go program when linking to a compiled version of zeromq on Mac", "body": "<p>If you build libzmq yourself, configure with <code>--disable-shared --enable-static</code> keys. If you use homebrew, uninstall zmq and build the library manually. If you need \"fat\" universal static library use this script:\n<a href=\"https://github.com/drewcrawford/libzmq-ios\" rel=\"nofollow\">https://github.com/drewcrawford/libzmq-ios</a></p>\n"}], "owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1443698101, "creation_date": 1440692893, "question_id": 32254876, "link": "https://stackoverflow.com/questions/32254876/issue-compiling-go-program-when-linking-to-a-compiled-version-of-zeromq-on-mac", "title": "Issue compiling Go program when linking to a compiled version of zeromq on Mac", "body": "<p>I've compiled ZeroMQ on Mac OSX 10.9.5 in order to then link to a simple Go program using <code>github.com/pebbe/zmq4</code>, but I'm getting this error I don't understand or know exactly how to remedy.</p>\n\n<pre><code># github.com/pebbe/zmq4\nld: warning: ignoring file /usr/local/lib/libzmq.dylib, file was built for x86_64 which is not the architecture being linked (i386): /usr/local/lib/libzmq.dylib\nUndefined symbols for architecture i386:\n  \"_zmq_bind\", referenced from:\n      __cgo_59814aec404b_C2func_zmq_bind in zmq4.cgo2.o\n      __cgo_59814aec404b_Cfunc_zmq_bind in zmq4.cgo2.o\n     (maybe you meant: __cgo_59814aec404b_Cfunc_zmq_bind, __cgo_59814aec404b_C2func_zmq_bind )\n  \"_zmq_close\", referenced from:\n      __cgo_59814aec404b_C2func_zmq_close in zmq4.cgo2.o\n      __cgo_59814aec404b_Cfunc_zmq_close in zmq4.cgo2.o\n     (maybe you meant: __cgo_59814aec404b_C2func_zmq_close, \n...\n  \"_zmq_z85_encode\", referenced from:\n      __cgo_59814aec404b_Cfunc_zmq_z85_encode in zmq4.cgo2.o\n     (maybe you meant: __cgo_59814aec404b_Cfunc_zmq_z85_encode)\nld: symbol(s) not found for architecture i386\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I think it makes sense that the dylib is made for x86_64 (the Mac) but why Go is trying to link with i386?  How do I control that and make it link differently? or even if it's correct?</p>\n"}, {"tags": ["go", "gzip", "tar"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 2, "last_activity_date": 1440695181, "creation_date": 1440695181, "answer_id": 32255486, "question_id": 32254757, "link": "https://stackoverflow.com/questions/32254757/extract-from-tar-file-in-go/32255486#32255486", "title": "Extract from tar file in Go", "body": "<p>It looks to me like there are two problems.</p>\n\n<ol>\n<li><p>You are using defer to close your tar writer and gzip writer, however defers only execute when the current scope ends.  Since you are running this all in one function your file handles will still be open when you attempt to read to untar and that may cause issues (perhaps file has not flushed fully for example).</p></li>\n<li><p>You are not setting the <code>Typeflag</code> in the header when you create the tarball.  While GNU tar may deal with this, assuming Typeflag '0', Go may not.  According to the docs <a href=\"http://www.gnu.org/software/tar/manual/html_node/Standard.html\" rel=\"nofollow\">http://www.gnu.org/software/tar/manual/html_node/Standard.html</a> the Typeflag for a regular file is byte '0'.  This may mean you need to set the Typeflag on a per resource in your code (directories, files, links, etc).  </p></li>\n</ol>\n\n<p>I rewrote you code like the following, and it is working for me now. (note: storing everything as REGTYPE)</p>\n\n<p><a href=\"http://play.golang.org/p/3B7F_axr-i\" rel=\"nofollow\">http://play.golang.org/p/3B7F_axr-i</a></p>\n\n<p><strong>EDIT</strong><br>\nAh-ha, I know the problem with #2 now.  The Go library for tar uses <a href=\"https://golang.org/src/archive/tar/common.go?s=1401:2114#L198\" rel=\"nofollow\">FileInfoHeader</a> in order to determine parts of the header, like Typeflag.  Since your <em>files</em> are not really files on the system it cannot fill out the appropriate Typeflag.</p>\n\n<p>GNU tar obviously knows how to deal with this, or perhaps tries its best to figure it out and is successful in this case.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4211028"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2669, "favorite_count": 0, "accepted_answer_id": 32255486, "answer_count": 1, "score": 0, "last_activity_date": 1440695349, "creation_date": 1440692472, "last_edit_date": 1440695349, "question_id": 32254757, "link": "https://stackoverflow.com/questions/32254757/extract-from-tar-file-in-go", "title": "Extract from tar file in Go", "body": "<p>This code tries to tar some texts into a <code>tar</code> file and untar it.\nThe code for <code>tar</code> works but seems like I am doing something wrong\nbecause <code>untar</code> the same file does not work.</p>\n\n<p>When I untar the file that I manually tar.gz with OS GUI, it works but\nnot in this code.</p>\n\n<p><a href=\"http://play.golang.org/p/diTOojUuBX\" rel=\"nofollow\">http://play.golang.org/p/diTOojUuBX</a></p>\n\n<pre><code>func main() {\n        mpath := \"a.tar.gz\"\n        // defer os.Remove(mpath)\n        f, err := overwrite(mpath)\n        defer f.Close()\n        if err != nil {\n                panic(err)\n        }\n        gw := gzip.NewWriter(f)\n        defer gw.Close()\n        if err != nil {\n                panic(err)\n        }\n        tw := tar.NewWriter(gw)\n        for _, file := range files {\n                hdr := &amp;tar.Header{\n                        Name: file.Name,\n                        Mode: 0600,\n                        Size: int64(len(file.Body)),\n                }\n                if err := tw.WriteHeader(hdr); err != nil {\n                        panic(err)\n                }\n                if _, err := tw.Write([]byte(file.Body)); err != nil {\n                        panic(err)\n                }\n        }\n        // Make sure to check the error on Close.\n        if err := tw.Close(); err != nil {\n                panic(err)\n        }\n\n        fr, err := read(mpath)\n        defer fr.Close()\n        if err != nil {\n                panic(err)\n        }\n        gr, err := gzip.NewReader(fr)\n        defer gr.Close()\n        if err != nil {\n                panic(err)\n        }\n        tr := tar.NewReader(gr)\n        for {\n                hdr, err := tr.Next()\n                if err == io.EOF {\n                        // end of tar archive\n                        break\n                }\n                if err != nil {\n                        panic(err)\n                }\n                path := hdr.Name\n                switch hdr.Typeflag {\n                case tar.TypeDir:\n                        if err := os.MkdirAll(path, os.FileMode(hdr.Mode)); err != nil {\n                                panic(err)\n                        }\n                case tar.TypeReg:\n                        ow, err := overwrite(path)\n                        defer ow.Close()\n                        if err != nil {\n                                panic(err)\n                        }\n                        if _, err := io.Copy(ow, tr); err != nil {\n                                panic(err)\n                        }\n                default:\n                        fmt.Printf(\"Can't: %c, %s\\n\", hdr.Typeflag, path)\n                }\n        }\n}\n</code></pre>\n"}, {"tags": ["string", "go", "type-conversion", "type-alias"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1440690663, "post_id": 32253768, "comment_id": 52388216, "body": "It helps to remember that <i>everything</i> in Go is a value, and all assignments are a copy of that value. <code>foo(ms(s))</code> does make a copy, but not because of the conversion."}], "answers": [{"comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 3, "creation_date": 1440691200, "post_id": 32253871, "comment_id": 52388595, "body": "This is correct. Here is some <code>unsafe.Pointer</code> hacking to prove that the string headers are indeed the same: <a href=\"http://play.golang.org/p/0khVz09-Jc\" rel=\"nofollow noreferrer\">play.golang.org/p/0khVz09-Jc</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1440690119, "creation_date": 1440690119, "answer_id": 32253871, "question_id": 32253768, "link": "https://stackoverflow.com/questions/32253768/does-conversion-between-alias-types-in-go-create-copies/32253871#32253871", "title": "Does conversion between alias types in Go create copies?", "body": "<p><a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">Spec: Conversions:</a></p>\n\n<blockquote>\n  <p>Specific rules apply to (non-constant) conversions between numeric types or to and from a string type. These conversions may change the representation of <code>x</code> and incur a run-time cost. <strong>All other conversions only change the type but not the representation of <code>x</code>.</strong></p>\n</blockquote>\n\n<p>So converting to and from the underlying type of your custom type does not make a copy if it.</p>\n\n<p>When you pass a value to a function or method, a copy is made and passed. If you pass a <code>string</code> to a function, only the structure describing the <code>string</code> will be copied and passed, since <code>string</code>s are immutable.</p>\n\n<p>Same is true if you pass a slice (slices are also descriptors). Passing a slice will make a copy of the slice descriptor but it will refer to the same underlying array.</p>\n"}], "owner": {"reputation": 6730, "user_id": 297094, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/08a7e4ec1109264bc3d18a519d15146c?s=128&d=identicon&r=PG", "display_name": "Robert Zaremba", "link": "https://stackoverflow.com/users/297094/robert-zaremba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 3, "accepted_answer_id": 32253871, "answer_count": 1, "score": 5, "last_activity_date": 1588450829, "creation_date": 1440689844, "last_edit_date": 1588450829, "question_id": 32253768, "link": "https://stackoverflow.com/questions/32253768/does-conversion-between-alias-types-in-go-create-copies", "title": "Does conversion between alias types in Go create copies?", "body": "<p>Example:</p>\n\n<pre><code>type MyString string \nvar s = \"very long string\"\nvar ms = MyString(s)\nvar s2 = string(s)\n</code></pre>\n\n<p>Are <code>ms</code> or <code>s2</code> a full copy of <code>s</code> (as it would be done with <code>[]byte(s)</code>)? Or they are just a string struct copies (which keeps the real value in a pointer)?</p>\n\n<p>What if we are passing this to a function? E.g.:</p>\n\n<pre><code>func foo(s MyString){\n  ...\n}\nfoo(ms(s))  // do we copy s here?\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1440688457, "post_id": 32253183, "comment_id": 52386699, "body": "Those values are much larger than a float64 can accurately hold, what did you expect?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1440688943, "post_id": 32253183, "comment_id": 52387038, "body": "Constants are represented using an arbitrary precision, while <code>float64</code> values aren&#39;t. Your constants will not fit into the <code>float64</code> variables and will get truncated. See this question: <a href=\"http://stackoverflow.com/questions/30897208/how-to-change-a-float64-number-to-uint64-in-a-right-way\">How to change a float64 number to uint64 in a right way?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 5, "last_activity_date": 1440689545, "creation_date": 1440689545, "answer_id": 32253659, "question_id": 32253183, "link": "https://stackoverflow.com/questions/32253183/how-can-i-add-two-arbitrary-large-numbers-in-go/32253659#32253659", "title": "How can I add two arbitrary large numbers in Go?", "body": "<blockquote>\n  <p>who can help me? in php has bcadd function</p>\n</blockquote>\n\n<p><code>bcadd</code> and its friends are <strong>arbitrary precision</strong> arithmetic functions (that's why they operate on strings and not floats). A float has limited precision. In effect, <code>bcmath</code> offers infinitely more precision than a float.</p>\n\n<p>Use <a href=\"http://golang.org/pkg/math/big/\" rel=\"noreferrer\"><code>math/big</code></a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 5273494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbfbf892bbb5a830f7e7a1ff1f3ce79?s=128&d=identicon&r=PG&f=1", "display_name": "ohko", "link": "https://stackoverflow.com/users/5273494/ohko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 32253659, "answer_count": 1, "score": -9, "last_activity_date": 1504394500, "creation_date": 1440688347, "last_edit_date": 1504394500, "question_id": 32253183, "link": "https://stackoverflow.com/questions/32253183/how-can-i-add-two-arbitrary-large-numbers-in-go", "title": "How can I add two arbitrary large numbers in Go?", "body": "<p>When I add two very large floats I get the wrong output. How can I do this in Go? PHP has the <code>bcadd</code> function.</p>\n\n<pre><code>var a float64 = 12959653081233191386469183112744623843489338314724603559902557916087872259523073406440221030943397504960564327459290759156915189196536625503825265749393408\nvar b float64 = 1302494993937727547864388263735304125561725318351673964024430436931705604299209078600534362879064309484886438718428990856894006118477463552\n// correct value: 12959653081233192688964177050472171707877602050028729121627876267761836283953510338145825330152476105494927206523600244043353907625527482397831384226856960\n// actual output: 12959653081233192875034890470147535688504496869357889916160064603715259716015001328389483087182344476999836189247073027598559438829669033382689401152208896\nfmt.Println(strconv.FormatFloat(a+b, 'f', 0, 64))\n</code></pre>\n"}, {"tags": ["go", "virtual-machine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1440686976, "post_id": 32252604, "comment_id": 52385619, "body": "You mean using <a href=\"http://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec</a>? What have your tried?"}, {"owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440687031, "post_id": 32252604, "comment_id": 52385660, "body": "yes using os/exec in golang"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440687822, "post_id": 32252604, "comment_id": 52386276, "body": "What problem are you having? What are the <a href=\"http://golang.org/pkg/os/exec/#pkg-examples\" rel=\"nofollow noreferrer\">examples</a> in the documentation missing?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1440693814, "post_id": 32252604, "comment_id": 52390212, "body": "For future reference: when you have a StackOverflow question closed, instead of re-asking it slightly differently, you should instead just edit <a href=\"http://stackoverflow.com/questions/32250001/golang-shows-panic-when-executing-a-command\">your existing question</a>. If your edit fixed the question, it would be re-opened."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1440688012, "creation_date": 1440688012, "answer_id": 32253071, "question_id": 32252604, "link": "https://stackoverflow.com/questions/32252604/installing-virtual-machine-with-virt-install-in-golang/32253071#32253071", "title": "Installing virtual Machine with virt-install in Golang", "body": "<p>The <a href=\"http://golang.org/pkg/os/exec/\" rel=\"nofollow\"><code>os/exec</code></a> package is what you're looking for:</p>\n\n<pre><code>cmdName := \"virt-install\"\nargs := []string{\n    \"-n\", \"NAME\",\n    \"-r\", \"1024\",\n    \"--import\",\n    \"--disk\", \"path=1703_Disk.img\"\n    \"--accelerate\",\n    \"--network\", \"network=default\",\n    \"--connect=qemu:///system\",\n    \"-vnc\",\n    \"-v\",\n}\ncmd := exec.Command(cmdName, args...)\nif err := cmd.Start(); err != nil {\n    log.Fatal(err)\n}\nif err := cmd.Wait(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5252482, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/6la8h.jpg?s=128&g=1", "display_name": "Murali Manohar", "link": "https://stackoverflow.com/users/5252482/murali-manohar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 1, "accepted_answer_id": 32253071, "answer_count": 1, "score": -2, "last_activity_date": 1440688012, "creation_date": 1440686889, "question_id": 32252604, "link": "https://stackoverflow.com/questions/32252604/installing-virtual-machine-with-virt-install-in-golang", "title": "Installing virtual Machine with virt-install in Golang", "body": "<p>virt-install -n \"NAME\" -r 1024 --import  --disk path=\"1703_Disk.img\" --accelerate --network network=default --connect=qemu:///system --vnc -v</p>\n\n<p>Can someone explain me how to execute this in golang</p>\n"}, {"tags": ["struct", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "edited": false, "score": 0, "creation_date": 1440688260, "post_id": 32250399, "comment_id": 52386576, "body": "Well, true, it works. Next time I will read the error messages from the compiler more thoroughly... Thanks for your answer!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1479070616, "last_edit_date": 1479070616, "creation_date": 1440681256, "answer_id": 32250399, "question_id": 32250277, "link": "https://stackoverflow.com/questions/32250277/how-to-set-fields-of-a-struct-inside-a-slice/32250399#32250399", "title": "How to set fields of a struct inside a slice?", "body": "<p>You posted this:</p>\n\n<pre><code>kdata := make([]Klabel, 10)\n\nkdata[0].label = \"test\"\n</code></pre>\n\n<p>And it works. When printing the <code>kdata</code> slice, output is (<a href=\"http://play.golang.org/p/XcnP4RcOXH\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[{[] test} {[] } {[] } {[] } {[] } {[] } {[] } {[] } {[] } {[] }]\n</code></pre>\n\n<p>The output shows <code>kdata</code> has 10 elements, and the first has the label value: <code>\"test\"</code>.</p>\n\n<p>To be more clear, print it with:</p>\n\n<pre><code>fmt.Printf(\"%+v\", kdata)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[{values:[] label:test} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:} {values:[] label:}]\n</code></pre>\n\n<hr>\n\n<p>Slices (unlike maps) are addressable. You can change the fields of the elements (that are structs) by simply indexing the slice and assigning new values to the fields.</p>\n\n<p>For example:</p>\n\n<pre><code>kdata[0].label = \"test\"\nkdata[0].values = []float64{1.1, 2.2}\nkdata[0].values = append(kdata[0].values, 3.3)\n\nfmt.Printf(\"%+v\", kdata[0])\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{values:[1.1 2.2 3.3] label:test}\n</code></pre>\n\n<p>If you want to append a slice of floats to the <code>values</code> field of an element:</p>\n\n<pre><code>vals := []float64{1.2, 2.3}\n\nkdata[0].values = append(kdata[0].values, vals...) // Note the 3 dot ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19346, "user_id": 2793118, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5da03d2e233e1a40a4f1923acfb9d433?s=128&d=identicon&r=PG", "display_name": "Filipe Gon&#231;alves", "link": "https://stackoverflow.com/users/2793118/filipe-gon%c3%a7alves"}, "is_accepted": false, "score": 1, "last_activity_date": 1440681437, "creation_date": 1440681437, "answer_id": 32250480, "question_id": 32250277, "link": "https://stackoverflow.com/questions/32250277/how-to-set-fields-of-a-struct-inside-a-slice/32250480#32250480", "title": "How to set fields of a struct inside a slice?", "body": "<p>As an alternative to the other answer, you could also do this:</p>\n\n<pre><code>kdata := []Klabel{{label: \"test\"}}\n</code></pre>\n\n<p>(<a href=\"http://play.golang.org/p/KRacFPUR0a\" rel=\"nofollow\">See on Go Playground</a>)</p>\n\n<p>But note that the slice length will be 1 rather than 10, so it's not exactly equivalent.</p>\n"}], "owner": {"reputation": 673, "user_id": 921051, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/09bf092eb87afa75958cdc6624bd5b54?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/921051/steffen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 32250399, "answer_count": 2, "score": 1, "last_activity_date": 1479070616, "creation_date": 1440680908, "last_edit_date": 1440692147, "question_id": 32250277, "link": "https://stackoverflow.com/questions/32250277/how-to-set-fields-of-a-struct-inside-a-slice", "title": "How to set fields of a struct inside a slice?", "body": "<p>I declared a type like this</p>\n\n<pre><code>type Klabel struct {\n    values []float64\n    label  string\n}\n</code></pre>\n\n<p>Then, I created a slice of this type like this</p>\n\n<pre><code>kdata := []Klabel\n</code></pre>\n\n<p>How can I set the label variable or append a slice of floats to values?</p>\n\n<p>I tried </p>\n\n<pre><code>kdata[0].label = \"test\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>kdata := make([]Klabel, 10)\n\nkdata[0].label = \"test\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>kdata = append(kdata[0], kdata[0].label = \"test\")\n</code></pre>\n\n<p>Well, with no success...</p>\n\n<p>So any help is appreciated! Thanks in advance!</p>\n"}, {"tags": ["c++", "tcp", "go", "boost-asio"], "comments": [{"owner": {"reputation": 48017, "user_id": 1053968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f892f0e96a3615ae44f6d815c5b0f?s=128&d=identicon&r=PG", "display_name": "Tanner Sansbury", "link": "https://stackoverflow.com/users/1053968/tanner-sansbury"}, "edited": false, "score": 0, "creation_date": 1440776712, "post_id": 32248489, "comment_id": 52428760, "body": "At a cursory glance: there are thread safety violations for the <code>socket</code> which may result in undefined behavior; the <code>async_write()</code> operation fails to meet the requirement that the underlying buffer will remain valid until the completion handler is invoked; the <code>stop()</code> and <code>reset()</code> flow can result in the socket connecting then disconnecting every second; and even with a clean <code>reset()</code>, enqueued completion handlers may force disconnections. Is the application protocol full-duplex? Will the connection be concurrently accessed by multiple threads (including the one running the <code>io_service</code>)?"}, {"owner": {"reputation": 11, "user_id": 5272579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwgDF.jpg?s=128&g=1", "display_name": "Mehdi Omidali", "link": "https://stackoverflow.com/users/5272579/mehdi-omidali"}, "reply_to_user": {"reputation": 48017, "user_id": 1053968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f892f0e96a3615ae44f6d815c5b0f?s=128&d=identicon&r=PG", "display_name": "Tanner Sansbury", "link": "https://stackoverflow.com/users/1053968/tanner-sansbury"}, "edited": false, "score": 0, "creation_date": 1440872684, "post_id": 32248489, "comment_id": 52456232, "body": "I agree with you that the async_write is not thread safe. I first want to solve the above problem then will deal with thread safety. The connection will be duplex for the smpp protocol."}, {"owner": {"reputation": 48017, "user_id": 1053968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f892f0e96a3615ae44f6d815c5b0f?s=128&d=identicon&r=PG", "display_name": "Tanner Sansbury", "link": "https://stackoverflow.com/users/1053968/tanner-sansbury"}, "edited": false, "score": 0, "creation_date": 1440890031, "post_id": 32248489, "comment_id": 52460606, "body": "The lack of thread safety and buffer management may result in undefined behavior being invoked.  It seems like a futile effort and test of patience to try to solve a problem in the presence of undefined behavior (including having it not connect).  I will try to find some time to provide a solution to the above issues, but resolving the above identified issues <i>should</i> fix the problem."}, {"owner": {"reputation": 7042, "user_id": 1671032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FfJD4.jpg?s=128&g=1", "display_name": "PSIAlt", "link": "https://stackoverflow.com/users/1671032/psialt"}, "edited": false, "score": 0, "creation_date": 1441633441, "post_id": 32248489, "comment_id": 52744385, "body": "Where your <code>MyTCPConnection::Run()</code> is actually called?"}, {"owner": {"reputation": 11, "user_id": 5272579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwgDF.jpg?s=128&g=1", "display_name": "Mehdi Omidali", "link": "https://stackoverflow.com/users/5272579/mehdi-omidali"}, "reply_to_user": {"reputation": 7042, "user_id": 1671032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FfJD4.jpg?s=128&g=1", "display_name": "PSIAlt", "link": "https://stackoverflow.com/users/1671032/psialt"}, "edited": false, "score": 0, "creation_date": 1441648145, "post_id": 32248489, "comment_id": 52751190, "body": "@PSIAlt: In Start() of the IRunnable, which is the parent of MyTCPConnection (conn.Start() in the main function)"}], "owner": {"reputation": 11, "user_id": 5272579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwgDF.jpg?s=128&g=1", "display_name": "Mehdi Omidali", "link": "https://stackoverflow.com/users/5272579/mehdi-omidali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440682391, "creation_date": 1440675816, "last_edit_date": 1440682391, "question_id": 32248489, "link": "https://stackoverflow.com/questions/32248489/reconnect-asio-connection-when-the-server-is-alive", "title": "Reconnect asio connection when the server is alive", "body": "<p>I want to keep an asio connection responsive, that I mean to check the server every second till it become alive and then send and receive. Here is my code</p>\n\n<p>---irunnable.h---</p>\n\n<pre><code>#ifndef IRUNNABLE_H\n#define IRUNNABLE_H\n\n#include &lt;condition_variable&gt;\n#include &lt;atomic&gt;\n#include &lt;thread&gt;\n\nclass IRunnable\n{\npublic:\n    IRunnable(): mThread(nullptr) {\n        mRunning.store(false);\n    }\n\n    virtual ~IRunnable() {\n        if (mRunning.load())\n            Stop();\n        delete mThread;\n    }\n\n\n    virtual void Start() {\n        mRunning.store(true);\n        mThread = new std::thread(&amp;IRunnable::Run, this);\n    }\n\n    virtual void Stop() {\n        mRunning.store(false);\n        if (mThread &amp;&amp; mThread-&gt;joinable())\n            mThread-&gt;join();\n    }\n\n    virtual bool IsRunning() {return mRunning.load();}\n\nprotected:\n    virtual void Run() = 0;\n\n    std::atomic&lt;bool&gt; mRunning;\n\nprivate:\n    std::thread *mThread;\n};\n\n#endif // IRUNNABLE_H\n</code></pre>\n\n<p>---mytcpconnection.h---</p>\n\n<pre><code>#ifndef MYTCPCONNECTION_H\n#define MYTCPCONNECTION_H\n\n#include &lt;asio/io_service.hpp&gt;\n#include &lt;asio/ip/tcp.hpp&gt;\n#include \"irunnable.h\"\n\n\nclass MyTCPConnection : public IRunnable\n{\npublic:\n    MyTCPConnection(const std::string &amp;ip, const std::string &amp;port);\n\n    ~MyTCPConnection();\n\n    void Stop();\n\n    void Write(const std::string &amp;msg);\n\n    void Connect();\nprotected:\n    void Run();\n\nprivate:\n    void readHeader();\n\nprivate:\n    std::string mIP;\n    std::string mPort;\n    asio::io_service mIOService;\n    asio::ip::tcp::socket mSocket;\n};\n\n#endif // MYTCPCONNECTION_H\n</code></pre>\n\n<p>---mytcpconnection.cpp</p>\n\n<pre><code>#include \"mytcpconnection.h\"\n#include &lt;iostream&gt;\n#include &lt;asio/connect.hpp&gt;\n#include &lt;asio/write.hpp&gt;\n#include &lt;asio/read.hpp&gt;\n\nMyTCPConnection::MyTCPConnection(const std::string &amp;ip, const std::string &amp;port):\n    mIP(ip),\n    mPort(port),\n    mSocket(mIOService)\n{\n    Connect();\n}\n\nMyTCPConnection::~MyTCPConnection()\n{\n    Stop();\n}\n\nvoid MyTCPConnection::Stop()\n{\n    mIOService.stop();\n    mSocket.close();\n    IRunnable::Stop();\n}\n\nvoid MyTCPConnection::Write(const std::string &amp;msg)\n{\n    asio::async_write(mSocket,\n                    asio::buffer(msg.c_str(),\n                                msg.length()),\n                    [this, msg](std::error_code ec, std::size_t /*length*/)\n    {\n        if (!ec)\n        {\n            std::cout &lt;&lt;  msg &lt;&lt; std::endl;\n        }\n        else\n        {\n            mSocket.close();\n        }\n    });\n}\n\n\n\nvoid MyTCPConnection::Run()\n{\n\n    while (mRunning.load()) {\n        sleep(1);\n//        Connect();\n        std::cout &lt;&lt; \"before run\\n\";\n        mIOService.run();\n        std::cout &lt;&lt; \"after run\\n\";\n    }\n\n}\n\nvoid MyTCPConnection::Connect()\n{\n    asio::ip::tcp::resolver resolver(mIOService);\n    asio::async_connect(mSocket, resolver.resolve({mIP, mPort}),\n                        [this](std::error_code ec, asio::ip::tcp::resolver::iterator)\n    {\n        if (!ec)\n        {\n            std::cout &lt;&lt; \"readHeader called\\n\";\n            readHeader();\n        }\n        else {\n            std::cout &lt;&lt; \"can not connect\\n\";\n            mSocket.close();\n            mIOService.reset();\n            std::cout &lt;&lt; \"after stopping io_service\\n\";\n        }\n    });\n}\n\nvoid MyTCPConnection::readHeader()\n{\n    const int header_length = 16;\n    std::shared_ptr&lt;char&gt; msg(new char[header_length]{0},\n        [](char *c) {\n            delete[] c;\n    });\n    asio::async_read(mSocket,\n                    asio::buffer(msg.get(), header_length),\n                    [this, msg](std::error_code ec, std::size_t s/*length*/)\n    {\n        if (!ec)\n        {\n            std::cout &lt;&lt; \"Message read \" &lt;&lt; s &lt;&lt; std::endl;\n            readHeader();\n        }\n        else\n        {\n            std::cout &lt;&lt; \"closing socket\\n\";\n            mSocket.close();\n            mIOService.stop();\n        }\n    });\n}\n</code></pre>\n\n<p>---main.cpp---</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include \"mytcpconnection.h\"\n\nusing namespace std;\n\nint main()\n{\n    MyTCPConnection conn(\"127.0.0.1\", \"12345\");\n    conn.Start();\n\n    while (true)\n    {\n        conn.Write(\"Hello server\");\n\n        sleep(1);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>---server.go---</p>\n\n<pre><code>package main\n\nimport (\n        \"time\"\n        \"fmt\"\n        \"net\"\n)\n\nfunc handle_conn(conn net.Conn) {\n    b := make([]byte, 1028)\n    for {\n        n, err:= conn.Read(b)\n        if err != nil {\n            fmt.Println(err.Error())\n            break\n        }\n        fmt.Println(string(b[:n]))\n        _, _ = conn.Write([]byte(\"hellohellohello1\"))\n        time.Sleep(time.Second*1)\n    }\n}\n\nfunc main() {\n        ln, err := net.Listen(\"tcp\", \":12345\")\n        if err != nil {\n                fmt.Println(err.Error())\n        }\n        fmt.Println(\"server started\")\n        for {\n                conn, err := ln.Accept()\n        fmt.Println(\"connection from\", conn.RemoteAddr())\n                if err != nil {\n                        fmt.Println(err.Error())\n                        continue\n                }\n                go handle_conn(conn)\n        }\n}\n</code></pre>\n\n<p>In this form, the client connects to the server (when the server is running) and keeps reading and writing. If I move the Connect() method in the mytcpconnection constructor to the Run() function (where it is commented now), the connection is not able to connect to the server. </p>\n\n<p>How can I fix this problem?</p>\n"}, {"tags": ["go", "opml"], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 1, "last_activity_date": 1440675735, "creation_date": 1440675735, "answer_id": 32248464, "question_id": 32247493, "link": "https://stackoverflow.com/questions/32247493/unmarshal-a-nested-opml-document/32248464#32248464", "title": "Unmarshal a nested OPML Document", "body": "<p>you need use pointer</p>\n\n<pre><code>type Outline struct {\n    Text string `xml:\"text,attr\"`\n    Note string `xml:\"_note,attr\"`\n    Outline *Outline `xml:\"outline\"`\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/f1UqEkJq4S\" rel=\"nofollow\">http://play.golang.org/p/f1UqEkJq4S</a></p>\n"}], "owner": {"reputation": 1912, "user_id": 331160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/19bb055a5d678985c2757b9c20dd56bf?s=128&d=identicon&r=PG", "display_name": "Kunal Jha", "link": "https://stackoverflow.com/users/331160/kunal-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 32248464, "answer_count": 1, "score": 1, "last_activity_date": 1440675735, "creation_date": 1440672914, "question_id": 32247493, "link": "https://stackoverflow.com/questions/32247493/unmarshal-a-nested-opml-document", "title": "Unmarshal a nested OPML Document", "body": "<p>I am trying to unmarshal a simple nested opml document. The problem comes when I have nested opml and I am unable to decide on structure. I am putting the code below. Please let me know how can I parse the multi level of nesting of the <code>Outline</code> struct.</p>\n\n<p><a href=\"http://play.golang.org/p/FobiL1JDdb\" rel=\"nofollow\">http://play.golang.org/p/FobiL1JDdb</a></p>\n\n<pre><code>    package main\n\n    import (\n        \"encoding/xml\"\n        \"fmt\"\n    )\n\n    var response = `&lt;opml version='1.0'&gt;\n     &lt;head&gt;\n      &lt;title&gt;More Cases&lt;/title&gt;\n      &lt;expansionState&gt;1,6,26&lt;/expansionState&gt;\n     &lt;/head&gt;\n     &lt;body&gt;\n      &lt;outline text='Testing' _note='indeterminate'&gt;\n       &lt;outline text='Weekly' _status='indeterminate'&gt;\n       &lt;/outline&gt;\n       &lt;/outline&gt;\n     &lt;/body&gt;\n    &lt;/opml&gt;`\n\n    type Opml struct {\n        XMLName xml.Name\n        Version string `xml:\"version,attr\"`\n        Head    Head   `xml:\"head\"`\n        Body    Body   `xml:\"body\"`\n    }\n\n    type Head struct {\n        Title          string `xml:\"title\"`\n        ExpansionState string `xml:\"expansionState\"`\n    }\n\n    type Body struct {\n        Outline Outline `xml:\"outline\"`\n    }\n    type Outline struct {\n        Text string `xml:\"text,attr\"`\n        Note string `xml:\"_note,attr\"`\n    }\n\n    func main() {\n\n        fmt.Println(\"UnMrashal XML\")\n        opml := &amp;Opml{}\n        xml.Unmarshal([]byte(response), opml)\n        fmt.Println(opml)\n    }\n</code></pre>\n"}, {"tags": ["regex", "go", "inotify"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1440666230, "post_id": 32244450, "comment_id": 52370879, "body": "Please try <a href=\"https://regex101.com/r/cT6dE2/4\" rel=\"nofollow noreferrer\"><code>\\.[^.][^o]$|\\.[^g][^.]$|\\.[^.][^.][^.]+$</code></a>."}, {"owner": {"reputation": 183, "user_id": 1451193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8976787c54009e1803fa0532e10bb0?s=128&d=identicon&r=PG", "display_name": "Ashish Gaurav", "link": "https://stackoverflow.com/users/1451193/ashish-gaurav"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1440678327, "post_id": 32244450, "comment_id": 52379000, "body": "@stribizhev : Sorry mate. That wont work for all names without or with single char extensions eg <code>main.a</code> or <code>main</code> ."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1440679072, "post_id": 32244450, "comment_id": 52379549, "body": "I did not assume there are 1-symbol extensions, true, but I added that in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1440679312, "post_id": 32249534, "comment_id": 52379742, "body": "It is fine you found a working solution. Just note that grouping is a nice regex feature that makes regex patterns more readable and just shorter."}, {"owner": {"reputation": 183, "user_id": 1451193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8976787c54009e1803fa0532e10bb0?s=128&d=identicon&r=PG", "display_name": "Ashish Gaurav", "link": "https://stackoverflow.com/users/1451193/ashish-gaurav"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1440679659, "post_id": 32249534, "comment_id": 52379999, "body": "yeah.. had i done that, i wouldn&#39;t have even need to use the identifier. +1"}], "tags": [], "owner": {"reputation": 183, "user_id": 1451193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8976787c54009e1803fa0532e10bb0?s=128&d=identicon&r=PG", "display_name": "Ashish Gaurav", "link": "https://stackoverflow.com/users/1451193/ashish-gaurav"}, "is_accepted": false, "score": 1, "last_activity_date": 1440678770, "creation_date": 1440678770, "answer_id": 32249534, "question_id": 32244450, "link": "https://stackoverflow.com/questions/32244450/regex-to-exclude-non-golang-files-not-working-with-inotifywait/32249534#32249534", "title": "regex to exclude non golang files not working with inotifywait", "body": "<p>Got the issue. It seems <code>[:graph:]</code> not <code>\\S</code> the class identifier for non-space chars in extended posix. The below is good to go.</p>\n\n<p><code>^[[:graph:]]*[^.][^g][^o]$|^[[:graph:]]{1,2}$|^[[:graph:]]*.[^g].$|^[[:graph:]]*..[^o]$|^[[:graph:]]*[^.]..$</code></p>\n\n<p>or even a better one from stribizhev comment <code>[^.][^g][^o]$|^..$|.[^g].$|..[^o]$|[^.]..$</code></p>\n"}, {"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 1, "last_activity_date": 1440679025, "creation_date": 1440679025, "answer_id": 32249609, "question_id": 32244450, "link": "https://stackoverflow.com/questions/32244450/regex-to-exclude-non-golang-files-not-working-with-inotifywait/32249609#32249609", "title": "regex to exclude non golang files not working with inotifywait", "body": "<p>You may use</p>\n\n<pre><code>\\.[^.][^.][^.]+$|\\.[^.][^o]$|\\.[^g][^.]$|\\.[^.]$\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/cT6dE2/6\" rel=\"nofollow\">demo</a></p>\n\n<p>Or if you can group:</p>\n\n<pre><code>\\.([^.][^.][^.]+|[^.][^o]|[^g][^.]|[^.])$\n</code></pre>\n\n<p>See <a href=\"https://regex101.com/r/cT6dE2/7\" rel=\"nofollow\">demo</a></p>\n\n<p>See explanation:</p>\n\n<ul>\n<li><code>\\.</code> - a literal dot</li>\n<li><code>([^.][^.][^.]+|[^.][^o]|[^g][^.]|[^.])</code> - a group of alternatives:\n\n<ul>\n<li><code>[^.][^.][^.]+</code> - 2 characters other than <code>.</code> and 1 or more characters other than <code>.</code>...</li>\n<li><code>[^.][^o]</code> - a character other than a dot and a character other than <code>o</code>...</li>\n<li><code>[^g][^.]</code> - a character other than <code>g</code> and  a character other than a dot...</li>\n<li><code>[^.]</code> - a character other than a dot...</li>\n</ul></li>\n<li><code>$</code> - right before the end of string.</li>\n</ul>\n"}], "owner": {"reputation": 183, "user_id": 1451193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb8976787c54009e1803fa0532e10bb0?s=128&d=identicon&r=PG", "display_name": "Ashish Gaurav", "link": "https://stackoverflow.com/users/1451193/ashish-gaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 32249609, "answer_count": 2, "score": 1, "last_activity_date": 1440679025, "creation_date": 1440664537, "question_id": 32244450, "link": "https://stackoverflow.com/questions/32244450/regex-to-exclude-non-golang-files-not-working-with-inotifywait", "title": "regex to exclude non golang files not working with inotifywait", "body": "<p>Below are the regex for filtering out all the non go files (i.e those with '.go' extension)</p>\n\n<pre><code>^([\\S]*[^.][^g][^o]|[\\S]*.[^g].|[\\S]*..[^o]$|[\\S]*[^.]..|[\\S]{1,2})$\n\n^([^.]*)($|[.]($|[\\S]$|g[^o]$|[^g]o$|[^g][^o]$|([\\S]+)\\.($|.$|g[^o]$|[^g]o$|[^g][^o]$|[^.]{3,}$)|[^.]{3,}$))\n</code></pre>\n\n<p>You can test them here (click on try it 'Go' in the menu below the regex)</p>\n\n<p><a href=\"http://fiddle.re/80kvh6\" rel=\"nofollow\">http://fiddle.re/80kvh6</a></p>\n\n<p><a href=\"http://fiddle.re/mhv1h6\" rel=\"nofollow\">http://fiddle.re/mhv1h6</a></p>\n\n<p>While they seem to work correctly in go but not with <code>inotifywait</code>'s exclude filter (which uses posix ERE format) </p>\n\n<p>I am trying to setup a \"watch and reload\" task in my Makefile for a golang project. Also i am assuming file or folders names dont have spaces.</p>\n"}]