[{"tags": ["linux", "multithreading", "go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1440631485, "post_id": 32238161, "comment_id": 52358767, "body": "You&#39;ll likely get more help if you post the full program, so others can try/debug it."}, {"owner": {"reputation": 74087, "user_id": 214790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f878c8230342730990acd21f889301d4?s=128&d=identicon&r=PG", "display_name": "matt", "link": "https://stackoverflow.com/users/214790/matt"}, "edited": false, "score": 2, "creation_date": 1440634762, "post_id": 32238161, "comment_id": 52359601, "body": "Not your main issue, but when you are collecting the results into <code>results</code> I  don\u2019t think you need <code>append</code>, just do <code>results[i] = &lt;-c</code>, otherwise you end up with <code>numcpu</code> zeros at the beginning of <code>results</code>. You\u2019ve already made <code>results</code> big enough in the call to <code>make</code>."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1440640261, "post_id": 32238161, "comment_id": 52360764, "body": "the program run too fast for htop, i think. you can print nanoseconds in your function to check the <code>parallelize </code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1440647040, "post_id": 32238161, "comment_id": 52362246, "body": "Nitpick: <code>runtime.GOMAXPROCS(numcpu)</code> is pre Go1.5 and even then it was considered a bad habit."}], "owner": {"reputation": 11, "user_id": 5270465, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-acMyXIT2e1g/AAAAAAAAAAI/AAAAAAAAASw/bhu9GEB4mz4/photo.jpg?sz=128", "display_name": "Andrew Ryabchun", "link": "https://stackoverflow.com/users/5270465/andrew-ryabchun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440684265, "creation_date": 1440630720, "last_edit_date": 1440684265, "question_id": 32238161, "link": "https://stackoverflow.com/questions/32238161/golang-threads-automatically-suspends-in-linux", "title": "Golang - threads automatically suspends in Linux", "body": "<p>I've tried to parallelize some calculations for range of uint32 using all CPU cores on my Raspberry PI 2:</p>\n\n<pre><code>...\nnumcpu := runtime.NumCPU()\nruntime.GOMAXPROCS(numcpu) //4 cores\nc := make(chan int, numcpu) //buffered channel\nresults := make([]int, numcpu)\npart := math.MaxUint32/numcpu\n\nfor i:=0; i&lt;numcpu; i++ {\n    go calculate(c,i*part,(i+1)*part,i)\n}\nfor i:=0; i&lt;numcpu; i++ {\n    results = append(results,&lt;-c)\n}\n...\n\nfunc calculate(c chan int, from, to, i int) {\n    ... //calculating result\n    c&lt;-result\n    println(\"Goroutine #\", i, \" stopped\") //just for debug\n}\n</code></pre>\n\n<p>But during execution <em><a href=\"http://i.stack.imgur.com/XnlS3.png\" rel=\"nofollow\">htop</a></em> shows me that program has 4 subthreads. One of them has no processing time and others are suspended. Could it be that all goroutines migrated to main thread? If it is, how can I prevent it?</p>\n\n<p>Update: </p>\n\n<p>When I cross-compiled binary by the Windows using gox, the problem was solved, despite the fact that performance has rapidly decreased.\nBut why when I using binary built by <em>go build</em> on my RaspPI these subthreads are suspending?</p>\n\n<p>Update:</p>\n\n<p>After updating from standard <code>apt-get</code>ed golang v1.03 for Debian Wheezy to <strong>golang v1.5</strong> the problems seems to be solved (despite the fact that <em>all.bash</em> cgo-tests was failed). Thank you all for optimization tips. I'm beginner in golang and don't know much about version-specific optimization.\nBut if you still want to inspect code: <a href=\"http://pastebin.com/kzuJJX3c\" rel=\"nofollow\">pastebin</a></p>\n"}, {"tags": ["sockets", "networking", "tcp", "go"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 1, "creation_date": 1440631134, "post_id": 32238082, "comment_id": 52358662, "body": "Set a socket read timeout."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440662118, "post_id": 32238082, "comment_id": 52368349, "body": "@EJP How to do this in golang ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440793025, "post_id": 32238082, "comment_id": 52436987, "body": "@sintanial: <a href=\"http://golang.org/pkg/net/#TCPConn.SetReadDeadline\" rel=\"nofollow noreferrer\"><code>conn.SetReadDeadline</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440640441, "post_id": 32239407, "comment_id": 52360800, "body": "&quot;ping&quot; is four bytes; a TCP header is at least 20 bytes; and the IP header is another 20. Total 44."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440640558, "post_id": 32239407, "comment_id": 52360816, "body": "well my mistake, it should be less than 30 bytes, not 20, as ip should not included. because almost everything has ip layer, we can not avoid it."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440646092, "post_id": 32239407, "comment_id": 52362036, "body": "So it&#39;s free? Come off it. 44 bytes."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440647323, "post_id": 32239407, "comment_id": 52362306, "body": "@EJP 1st, tcp keep live and other ways also need IP overload. 2nd, if you want to count the bytes in whole stack, we need 802.3/802.11/3G-mobile/4G-mobile/EDGE/GPRS ... all level. final, that not make scene."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "edited": false, "score": 3, "creation_date": 1440659827, "post_id": 32239407, "comment_id": 52367122, "body": "@JiangYD why is business session things ? I need to detect broken connection, for this problem invented heartbeat like keepalive. Why I must use my implementation over tcp ?  And somebody explain to me why does not work SetWriteDeadline ?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1440660466, "post_id": 32239407, "comment_id": 52367436, "body": "because it is easy and more clear doing heatbeat in application level. SetWriteDeadline just check socket write, and socket write just move data from application to kernel tcp buffer, it always no error if the buffer not full."}, {"owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "edited": false, "score": 0, "creation_date": 1440667692, "post_id": 32239407, "comment_id": 52371813, "body": "@JiangYD thx for answer. Why SetWriteDeadline created, if we have Write method which return error immediately, if failed write to socket ? And why need ACK in TCP proto if i can&#39;t detected, when data is transferred to client successfully"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1440675377, "post_id": 32239407, "comment_id": 52376977, "body": "it&#39;s for blocking i think, you can use this to avoid the write operation blocked forever; you need a ACK and a timeout to check whether you lost the client, because a <code>TCPConn</code> can not tell you the data is transferred to client successfully."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1440790833, "post_id": 32239407, "comment_id": 52436026, "body": "I haven&#39;t said anything about keepalive, and not all &#39;other ways need IP overhead&#39;. I suggested a read timeout. Space cost: zero."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 1, "last_activity_date": 1440640554, "last_edit_date": 1440640554, "creation_date": 1440640143, "answer_id": 32239407, "question_id": 32238082, "link": "https://stackoverflow.com/questions/32238082/the-right-way-to-detect-tcp-broken-connection-manual-keepalive-idle-and-don/32239407#32239407", "title": "The right way to detect tcp broken connection ? Manual keepalive idle , and don&#39;t worked SetWriteDeadLine", "body": "<p>to make thing simple, please do not use TCP level things to make sure your business session things. what you need in real is detecting broken session, so keep sending ping-pong in business level. you can calculate the load simply, like a \"ping\" string with tcp header, should be in 30bytes.</p>\n"}], "owner": {"reputation": 99, "user_id": 2637522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f1810c5e4b326854c64d804af00ad3a?s=128&d=identicon&r=PG", "display_name": "sintanial", "link": "https://stackoverflow.com/users/2637522/sintanial"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2212, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440790684, "creation_date": 1440630165, "last_edit_date": 1440790684, "question_id": 32238082, "link": "https://stackoverflow.com/questions/32238082/the-right-way-to-detect-tcp-broken-connection-manual-keepalive-idle-and-don", "title": "The right way to detect tcp broken connection ? Manual keepalive idle , and don&#39;t worked SetWriteDeadLine", "body": "<p>I have some problem with a TCP connection.</p>\n\n<p>I have a server written in go which listen tcp connection on some port.\nAnd I have client written in Java for Android.\nClient establish connection with server, and then exchange some data both without any laws.</p>\n\n<p>When Android changes the network type, for example from mobile network to wifi. Connection is broken, but server don't know about this problem, and think that client all ready to take a some data.</p>\n\n<p>I need to detect this problem on my server so quick as possible. Ideally immediately</p>\n\n<p>First I used in go <code>SetKeepAlive(true)</code> and <code>SetKeepAlivePeriod(10 * time.Second)</code>. It's worked, but not quickly as I need. Because go SetKeepAlivePeriod, set <strong>tcp keepalive time(idle)</strong> and <strong>tcp keepalive interval</strong> to same. For example in linux <strong>tcp keepalive retry=8</strong>, then problem with connection detected after (10 + 8*10) = 90sec = 1 min 30sec. It is very very slow :(. How to set idle and interval manual ? I watching this lib <a href=\"https://github.com/felixge/tcpkeepalive\" rel=\"nofollow\">https://github.com/felixge/tcpkeepalive</a>, but I don't trust this lib, because, in this lib socket fd copying without clear.</p>\n\n<p>I can set <code>SetKeepAlivePeriod(1 * time.Second)</code>, but whats about performance ? In my case, connection may be a heavily loaded or idle.</p>\n\n<p>Then, i think about SetWriteDeadline. It's very useful for me, because i don't know when i receive message from client, but i know when i send message to client. But when i used SetWriteDeadline, is not working.\nFor example</p>\n\n\n\n<pre class=\"lang-go prettyprint-override\"><code>var request *http.Request\n\nconn.SetWriteDeadline(time.Now().Add(10 * time.Second))\nerr := request.Write(conn)\nif err != nil {\n    if neterr, ok := err.(net.Error); ok &amp;&amp; neterr.Timeout() {\n        log.Println(\"Connection WriteDeadline timeout\")\n    }\n    conn.Close();\n} else {\n    conn.SetWriteDeadline(time.Time{})\n}\n</code></pre>\n\n<p>When after connection broken on client, I Write some data into connection, method Write return nil without error. As though data already send and server success accepted ACK from client, but how ?</p>\n\n<p><strong>Update 28.10.2015 22:35</strong></p>\n\n<p>I decided to try this <a href=\"https://github.com/felixge/tcpkeepalive\" rel=\"nofollow\">https://github.com/felixge/tcpkeepalive</a> library. And yet it works perfectly for my problem :).</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>ka, _ := tcpkeepalive.EnableKeepAlive(conn)\nka.SetKeepAliveCount(2)\nka.SetKeepAliveInterval(3 * time.Second)\nka.SetKeepAliveIdle(10 * time.Second)\n</code></pre>\n"}, {"tags": ["go", "negroni"], "answers": [{"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1440619917, "post_id": 32235726, "comment_id": 52353969, "body": "Hmmm - seem like overkill to me - might stick with global variable to be honest."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 1, "creation_date": 1440620009, "post_id": 32235726, "comment_id": 52354013, "body": "@tommyd456 until you need more than one stateful variable, or you need more than one instance of your middleware. If neither&#39;s the case, then a closure would be enough. I&#39;ll add it to my answer."}, {"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1440620375, "post_id": 32235726, "comment_id": 52354182, "body": "I like the closure approach - I gave this a go myself and was almost there. Cheers for this. Gonna give it a go in the morning!"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1440621501, "post_id": 32235726, "comment_id": 52354819, "body": "@tommyd456 If you use a global make sure you don&#39;t have data races (try the <a href=\"https://blog.golang.org/race-detector\" rel=\"nofollow noreferrer\">Go race detector</a>). You&#39;ll probably find that adding synchronization to remove data races is (often/usually) more work."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440622092, "post_id": 32235726, "comment_id": 52355121, "body": "@DaveC right, unless it&#39;s some immutable state like a configuration struct you initialize in main() or something. Usually I use closures if there&#39;s little persistent state, and structs if there is, especially if it&#39;s mutable."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1440620184, "last_edit_date": 1440620184, "creation_date": 1440619484, "answer_id": 32235726, "question_id": 32234714, "link": "https://stackoverflow.com/questions/32234714/passing-arguments-to-negroni-middleware/32235726#32235726", "title": "Passing arguments to Negroni middleware", "body": "<p>The best way would be to encapsulate your middleware as a struct that holds its state, not just a stateless function. (You could also wrap it as a closure but a struct is cleaner IMO):</p>\n\n<pre><code>type MyMiddleware struct {\n    someval string\n}\n\nfunc NewMyMiddleware(someval string) *MyMiddleware {\n    return &amp;MyMiddleware{\n       someval: someval,\n    }\n}\n\n\nfunc (m *MyMiddleware) ServeHTTP(w http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n\n    // Do Something with someval\n    fmt.Println(m.someval)\n\n    next(w, req)\n}\n</code></pre>\n\n<p>and initializing it is simply:</p>\n\n<pre><code>n.Use(NewMyMiddleware(\"foo\"))\n</code></pre>\n\n<p>EDIT: Perhaps a closure would actually be simple:</p>\n\n<pre><code> someval := foo\n\n n.Use(negroni.HandlerFunc(func(rw http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n   // Do Something with someval\n   fmt.Println(someval)\n\n   next(w, req)\n}))\n</code></pre>\n\n<p>Or you could have a function that returns a middleware function:</p>\n\n<pre><code>func NewMiddleware(someval string) negroni.HandlerFunc {\n     return negroni.HandlerFunc(func(rw http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n       // Do Something with someval\n       fmt.Println(someval)\n\n       next(w, req)\n    })\n}\n</code></pre>\n\n<p>and then </p>\n\n<pre><code>n.Use(NewMiddleware(\"foo\"))\n</code></pre>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1014, "favorite_count": 0, "accepted_answer_id": 32235726, "answer_count": 1, "score": 3, "last_activity_date": 1450517067, "creation_date": 1440615886, "last_edit_date": 1440616191, "question_id": 32234714, "link": "https://stackoverflow.com/questions/32234714/passing-arguments-to-negroni-middleware", "title": "Passing arguments to Negroni middleware", "body": "<p>Every request to my application should use some middleware. Using the Negroni docs I have implemented it like so:</p>\n\n<pre><code>func MyMiddleware(rw http.ResponseWriter, r *http.Request, next http.HandlerFunc) {\n  // do some stuff before\n  next(rw, r)\n}\n</code></pre>\n\n<p>and elsewhere I use:</p>\n\n<pre><code>n.Use(negroni.HandlerFunc(MyMiddleware))\n</code></pre>\n\n<p>However, the middleware needs to receive an extra argument and I'm not sure how to build this in. At the moment I'm just setting the value as a global variable to make it available but I'm sure there's a more elegant way?</p>\n\n<p>I would like to be able to do something like this:</p>\n\n<pre><code>n.Use(negroni.HandlerFunc(MyMiddleware(val)))\n</code></pre>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 11, "creation_date": 1440609648, "post_id": 32232655, "comment_id": 52348085, "body": "This isn&#39;t a <code>go</code> error, <code>git</code> is returning &quot;terminal prompts disabled&quot;. Can you run <code>git clone https:&#47;&#47;github.com&#47;examplesite&#47;myprivaterepo</code> on your laptop?"}, {"owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440626886, "post_id": 32232655, "comment_id": 52357261, "body": "Thank you. The git clone worked. Then the go get worked. What&#39;s the deal? Do I have to &quot;prime the pump&quot; like this every time or did I misconfigure something?"}, {"owner": {"reputation": 4936, "user_id": 102852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd1a03727472c03ab6628d437a24e00?s=128&d=identicon&r=PG", "display_name": "alex vasi", "link": "https://stackoverflow.com/users/102852/alex-vasi"}, "edited": false, "score": 2, "creation_date": 1440684784, "post_id": 32232655, "comment_id": 52383987, "body": "@tomcam, you can add ssh keys to github account and go get will work from the start, see <a href=\"https://help.github.com/articles/generating-ssh-keys/\" rel=\"nofollow noreferrer\">help.github.com/articles/generating-ssh-keys</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4936, "user_id": 102852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd1a03727472c03ab6628d437a24e00?s=128&d=identicon&r=PG", "display_name": "alex vasi", "link": "https://stackoverflow.com/users/102852/alex-vasi"}, "edited": false, "score": 0, "creation_date": 1440698147, "post_id": 32232655, "comment_id": 52392771, "body": "@alexvasi: that only works if he clones the repo himself over ssh first, since it will request from <code>https:&#47;&#47;github.com&#47;</code> if the import path doesn&#39;t exist. The git process should be able to prompt for the username/password, so there must be something different in the laptop configuration -- different shell, different .gitconfig, an env variable, etc."}, {"owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "edited": false, "score": 0, "creation_date": 1440707074, "post_id": 32232655, "comment_id": 52397462, "body": "All of this has helped me, but I&#39;m not sure how to mark as answered and/or resolved. Here&#39;s what I have so far."}, {"owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440707643, "post_id": 32232655, "comment_id": 52397761, "body": "(Continued)  Not sure how to mark as answered and/or resolved because I am still not sure what the most robust solution is. Here&#39;s what I have so far.  @JimB suggested I use <code>git clone https:&#47;&#47;github.com&#47;examplesite&#47;myprivaterepo</code> and that worked, but I dont&#39; quite understand why.  @alexvasi mentioned ssh keys. I have one already--but that&#39;s for my other Github account. I created a new ssh key &amp; file:  <code>ssh-keygen -t rsa -C &quot;myemail@example.com&quot; -f id_rsa_myuser_name</code>  Then copied that key into my private Github account. Maybe the best solution?"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 853178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e4d7f811cc5ff1705e63ab0cdc9e457?s=128&d=identicon&r=PG", "display_name": "Eric Dorsey", "link": "https://stackoverflow.com/users/853178/eric-dorsey"}, "edited": false, "score": 1, "creation_date": 1464842134, "post_id": 34885303, "comment_id": 62651795, "body": "I have 2FA and this worked for me -- generated a token (with full privs), did a <code>git clone</code> of one of my own existing repos (it is public actually), was prompted for my <code>username</code>, put in my GitHub username, then put in the generated token for <code>password</code> -- deleted the cloned repo, then reran the <code>go get</code> command and all was well - thanks! (OSX here as well)"}, {"owner": {"reputation": 2637, "user_id": 3794873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c258eb86d1af81ca35a4ce16efc71797?s=128&d=identicon&r=PG", "display_name": "dragon788", "link": "https://stackoverflow.com/users/3794873/dragon788"}, "edited": false, "score": 3, "creation_date": 1508347854, "post_id": 34885303, "comment_id": 80579132, "body": "This is also really great because you can limit the scope of the token to only &quot;read&quot; for private repos so even if it somehow gets into an image in the wild, they can only read your code and not push things into it and you can revoke the token really easily. I can&#39;t recall if they have auto expiration built in yet."}], "tags": [], "owner": {"reputation": 4579, "user_id": 1114274, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ebd3b90b30e78d29cc01c13ba6ebb090?s=128&d=identicon&r=PG", "display_name": "Mike Graf", "link": "https://stackoverflow.com/users/1114274/mike-graf"}, "is_accepted": false, "score": 39, "last_activity_date": 1542829804, "last_edit_date": 1542829804, "creation_date": 1453231482, "answer_id": 34885303, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/34885303#34885303", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>1st -- <code>go get</code> will refuse to authenticate on the command line. So you need to cache the credentials in git.  Because I use osx I can use osxkeychain credential helper. </p>\n\n<p>2nd For me, I have 2FA enabled and thus could not use my password to auth. Instead I had to generate a personal access token to use in place of the password.</p>\n\n<ol>\n<li>setup osxkeychain credential helper <a href=\"https://help.github.com/articles/caching-your-github-password-in-git/\" rel=\"noreferrer\">https://help.github.com/articles/caching-your-github-password-in-git/</a></li>\n<li>If using TFA instead of using your password, generate a personal access token with repo scope <a href=\"https://github.com/settings/tokens\" rel=\"noreferrer\">https://github.com/settings/tokens</a></li>\n<li>git clone a private repo just to make it cache the password     <code>git clone https://github.com/user/private_repo</code>   and used your github.com username for username and the generated personal access token for password.</li>\n<li><p>Removed the just cloned repo and retest to ensure creds were cached -- <code>git clone https://github.com/user/private_repo</code> and this time wasnt asked for creds. </p>\n\n<ol start=\"5\">\n<li>go get will work with any repos that the personal access token can access.  You may have to repeat the steps with other accounts / tokens as permissions vary.</li>\n</ol></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 711, "user_id": 3125693, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/a3872b84555f5d5abe102f041780200f?s=128&d=identicon&r=PG&f=1", "display_name": "user3125693", "link": "https://stackoverflow.com/users/3125693/user3125693"}, "edited": false, "score": 1, "creation_date": 1604613262, "post_id": 38237165, "comment_id": 114408356, "body": "I&#39;ve tried all of the top answers here (set environment variable above, update git config using insteadOf, running git clone before go get) and go get is still failing with that issue. Anything else i can try?"}, {"owner": {"reputation": 555, "user_id": 2579927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JcYch.jpg?s=128&g=1", "display_name": "Ferrarezi", "link": "https://stackoverflow.com/users/2579927/ferrarezi"}, "edited": false, "score": 5, "creation_date": 1608867286, "post_id": 38237165, "comment_id": 115704226, "body": "This did the trick:  go env -w GOPRIVATE=github.com/{your-github-user-here}/*"}, {"owner": {"reputation": 7988, "user_id": 584947, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5c0e998a5b4fdce4f95cbec31e6dab22?s=128&d=identicon&r=PG", "display_name": "anon58192932", "link": "https://stackoverflow.com/users/584947/anon58192932"}, "edited": false, "score": 0, "creation_date": 1611022247, "post_id": 38237165, "comment_id": 116311269, "body": "If it helps anyone I copied the <code>go.mod</code> and <code>go.sum</code> files from another repo and tried to use those. This gave me git login prompts whenever I tried to go <code>go build</code> because git kept trying to authenticate to someone else&#39;s github repo.   To fix this you can run <code>go mod init</code> and then you should stop seeing these login prompts."}], "tags": [], "owner": {"reputation": 2244, "user_id": 6463368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28107a3d5003979d11097260caf86662?s=128&d=identicon&r=PG&f=1", "display_name": "Shafreeck Sea", "link": "https://stackoverflow.com/users/6463368/shafreeck-sea"}, "is_accepted": true, "score": 212, "last_activity_date": 1542446185, "last_edit_date": 1542446185, "creation_date": 1467862433, "answer_id": 38237165, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/38237165#38237165", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>go get disables the \"terminal prompt\" by default. This can be changed by setting an environment variable of git:</p>\n\n<pre><code>env GIT_TERMINAL_PROMPT=1 go get github.com/examplesite/myprivaterepo\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1059, "user_id": 485349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIz37.jpg?s=128&g=1", "display_name": "slatunje", "link": "https://stackoverflow.com/users/485349/slatunje"}, "edited": false, "score": 12, "creation_date": 1502450361, "post_id": 44247040, "comment_id": 78226753, "body": "I recommend adding <b>--add</b> flag so that you do not overwrite existing settings you may have  For example: <code>git config --global --add url.&quot;git@github.com:&quot;.insteadOf &quot;https:&#47;&#47;github.com&#47;&quot;</code>"}, {"owner": {"reputation": 6399, "user_id": 5800592, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/783606718977/picture?type=large", "display_name": "Wylliam Judd", "link": "https://stackoverflow.com/users/5800592/wylliam-judd"}, "reply_to_user": {"reputation": 1059, "user_id": 485349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIz37.jpg?s=128&g=1", "display_name": "slatunje", "link": "https://stackoverflow.com/users/485349/slatunje"}, "edited": false, "score": 0, "creation_date": 1507664087, "post_id": 44247040, "comment_id": 80297544, "body": "Thanks slatunje, added the flag to my answer based on your feedback."}, {"owner": {"reputation": 414, "user_id": 2476492, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hJcz1.jpg?s=128&g=1", "display_name": "bodecker", "link": "https://stackoverflow.com/users/2476492/bodecker"}, "edited": false, "score": 5, "creation_date": 1508226126, "post_id": 44247040, "comment_id": 80516119, "body": "This is the best solution IMO. It&#39;s more secure and less effort (once setup) to use SSH keys for auth instead of username/password"}, {"owner": {"reputation": 46757, "user_id": 207661, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CFPkp.jpg?s=128&g=1", "display_name": "Shital Shah", "link": "https://stackoverflow.com/users/207661/shital-shah"}, "edited": false, "score": 2, "creation_date": 1525322345, "post_id": 44247040, "comment_id": 87312228, "body": "Don&#39;t do this on Windows. I ended up with error <code>git@github.com: Permission denied (publickey). fatal: Could not read from remote repository.</code>."}, {"owner": {"reputation": 819, "user_id": 681629, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c9b628c5f4dcb81f3637afddedbb1ca2?s=128&d=identicon&r=PG", "display_name": "Chiptus", "link": "https://stackoverflow.com/users/681629/chiptus"}, "edited": false, "score": 1, "creation_date": 1542629368, "post_id": 44247040, "comment_id": 93624354, "body": "works for linux too. should work for everyone if you&#39;re using ssh globaly"}, {"owner": {"reputation": 5914, "user_id": 134848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a52afd6c788eb27121003a9a8a4a9333?s=128&d=identicon&r=PG", "display_name": "krystan honour", "link": "https://stackoverflow.com/users/134848/krystan-honour"}, "edited": false, "score": 1, "creation_date": 1570456700, "post_id": 44247040, "comment_id": 102909157, "body": "this is great until your company blocks all ssh outbound transport."}, {"owner": {"reputation": 148, "user_id": 6437038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c596350e2ea582befee1bbdb042d641b?s=128&d=identicon&r=PG", "display_name": "Andrey Klochkov", "link": "https://stackoverflow.com/users/6437038/andrey-klochkov"}, "edited": false, "score": 0, "creation_date": 1586790634, "post_id": 44247040, "comment_id": 108250108, "body": "I use bitbucket, so this command helped me: <code>git config --global --add url.&quot;git@bitbucket.org:&quot;.insteadOf &quot;https:&#47;&#47;bitbucket.org&#47;&quot;</code>"}, {"owner": {"reputation": 1280, "user_id": 1973651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jvzoF.jpg?s=128&g=1", "display_name": "Circle Hsiao", "link": "https://stackoverflow.com/users/1973651/circle-hsiao"}, "reply_to_user": {"reputation": 46757, "user_id": 207661, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/CFPkp.jpg?s=128&g=1", "display_name": "Shital Shah", "link": "https://stackoverflow.com/users/207661/shital-shah"}, "edited": false, "score": 1, "creation_date": 1607271700, "post_id": 44247040, "comment_id": 115214147, "body": "I&#39;m using windows and now I&#39;m stuck(should spot the warning by @ShitalShah earlier...) any way to undo this?"}, {"owner": {"reputation": 1280, "user_id": 1973651, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/jvzoF.jpg?s=128&g=1", "display_name": "Circle Hsiao", "link": "https://stackoverflow.com/users/1973651/circle-hsiao"}, "edited": false, "score": 3, "creation_date": 1607358215, "post_id": 44247040, "comment_id": 115241027, "body": "So for whoever wondering how to undo this, it will add a section in <code>C:\\Users\\&lt;you&gt;\\.gitconfig</code> which you can remove directly"}], "tags": [], "owner": {"reputation": 6399, "user_id": 5800592, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/783606718977/picture?type=large", "display_name": "Wylliam Judd", "link": "https://stackoverflow.com/users/5800592/wylliam-judd"}, "is_accepted": false, "score": 387, "last_activity_date": 1572792455, "last_edit_date": 1572792455, "creation_date": 1496075765, "answer_id": 44247040, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/44247040#44247040", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>I found this extremely helpful, and it solved my problem. This command will allow your 2FA to do its thing (and save you the trouble of entering your username and password):</p>\n\n<pre><code>git config --global --add url.\"git@github.com:\".insteadOf \"https://github.com/\"\n</code></pre>\n\n<p>Source: <a href=\"http://albertech.blogspot.com/2016/11/fix-git-error-could-not-read-username.html\" rel=\"noreferrer\">http://albertech.blogspot.com/2016/11/fix-git-error-could-not-read-username.html</a></p>\n\n<p>If you're not using 2FA, you can still use SSH and this will work.</p>\n\n<p>Edit: added the <code>--add</code> flag as suggested by <a href=\"https://stackoverflow.com/users/485349/slatunje\">slatunje</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 2908, "user_id": 136087, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e416152346ae8c9229b87d9f004e656?s=128&d=identicon&r=PG&f=1", "display_name": "EdH", "link": "https://stackoverflow.com/users/136087/edh"}, "is_accepted": false, "score": 18, "last_activity_date": 1503467302, "last_edit_date": 1503467302, "creation_date": 1503463869, "answer_id": 45830854, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/45830854#45830854", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>If you just want <code>go get</code> to work real fast, and move along with your work...</p>\n\n<p>Just export <code>GIT_TERMINAL_PROMPT=1</code></p>\n\n<pre><code>$ export GIT_TERMINAL_PROMPT=1\n$ go get [whatever]\n</code></pre>\n\n<p>It will now prompt you for a user/pass for the rest of your shell session. Put this in your <code>.profile</code> or setup <code>git</code> as above for a more permanent solution.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 1164210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdeb86f462864bf4f99ba1dbcb016b67?s=128&d=identicon&r=PG&f=1", "display_name": "Nick Proto", "link": "https://stackoverflow.com/users/1164210/nick-proto"}, "is_accepted": false, "score": 0, "last_activity_date": 1561582324, "creation_date": 1561582324, "answer_id": 56780724, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/56780724#56780724", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>I had the same problem on windows \"error: failed to execute prompt script (exit code 1)\nfatal: could not read Username for '<a href=\"https://github.com\" rel=\"nofollow noreferrer\">https://github.com</a>': No error\" trying to login to github through the login dialog. When I canceled the dialog git asked me for login and password in the command line and it worked fine.</p>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 3681925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/awO7I.png?s=128&g=1", "display_name": "cooljl86", "link": "https://stackoverflow.com/users/3681925/cooljl86"}, "is_accepted": false, "score": 0, "last_activity_date": 1563707924, "creation_date": 1563707924, "answer_id": 57132689, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/57132689#57132689", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>If you configure your gitconfig with this option, you will later have a problem cloning other repos of GitHub</p>\n\n<pre><code>git config --global --add url. \"Git@github.com\". Instead, \"https://github.com/\"\n</code></pre>\n\n<p>Instead, I recommend that you use this option</p>\n\n<pre><code>echo \"export GIT_TERMINAL_PROMPT=1\" &gt;&gt; ~/.bashrc || ~/.zshrc\n</code></pre>\n\n<p>and do not forget to generate an access token from your private repository. When prompted to enter your password, just paste the access token. Happy clone :)</p>\n"}, {"comments": [{"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 5, "creation_date": 1591352801, "post_id": 60323360, "comment_id": 110029445, "body": "<code>GOPRIVATE</code> (<code>go env -w GOPRIVATE=github.com&#47;mycompany&#47;*</code>) is the only thing that worked for me. I might suggest putting that under its own heading or even in an answer of its own to highlight it a bit more."}, {"owner": {"reputation": 153, "user_id": 2106178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tpkld.jpg?s=128&g=1", "display_name": "Pavel Gordon", "link": "https://stackoverflow.com/users/2106178/pavel-gordon"}, "edited": false, "score": 2, "creation_date": 1597309699, "post_id": 60323360, "comment_id": 112092702, "body": "For me as well , only <code>go env -w GOPRIVATE=gitlab.companyname.com</code>  helped.  This should be an accepted answer. Thank you for this thorough answer."}, {"owner": {"reputation": 1095, "user_id": 2555111, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/f7545e20b9c9e6edb7eadb9e8d01aa42?s=128&d=identicon&r=PG", "display_name": "Merouane Benthameur", "link": "https://stackoverflow.com/users/2555111/merouane-benthameur"}, "edited": false, "score": 1, "creation_date": 1610491367, "post_id": 60323360, "comment_id": 116149991, "body": "GOPRIVATE and .netrc file worked for me"}], "tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 56, "last_activity_date": 1582215006, "last_edit_date": 1582215006, "creation_date": 1582212544, "answer_id": 60323360, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/60323360#60323360", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>It complains because it needs to use <code>ssh</code> instead of <code>https</code> but your git is still configured with https. so basically as others mentioned previously you need to either enable prompts or to configure git to use <code>ssh</code> instead of <code>https</code>. a simple way to do this by running the following: </p>\n\n<pre><code>git config --global --add url.\"git@github.com:\".insteadOf \"https://github.com/\"\n</code></pre>\n\n<p>or if you already use <code>ssh</code> with <code>git</code> in your machine, you can safely edit <code>~/.gitconfig</code> and add the following line at the very bottom</p>\n\n<p><strong>Note:</strong> This covers all SVC, source version control, that depends on what you exactly use, github, gitlab, bitbucket) </p>\n\n<pre><code># Enforce SSH\n[url \"ssh://git@github.com/\"]\n  insteadOf = https://github.com/\n[url \"ssh://git@gitlab.com/\"]\n        insteadOf = https://gitlab.com/\n[url \"ssh://git@bitbucket.org/\"]\n  insteadOf = https://bitbucket.org/\n</code></pre>\n\n<ul>\n<li><p>If you want to keep password pompts disabled, you need to cache password. For more information on how to cache your github password on mac, windows or linux, please visit <a href=\"https://help.github.com/en/github/using-git/caching-your-github-password-in-git\" rel=\"noreferrer\">this page</a>. </p></li>\n<li><p>For more information on how to add ssh to your github account, please visit <a href=\"https://help.github.com/en/enterprise/2.18/user/github/authenticating-to-github/adding-a-new-ssh-key-to-your-github-account\" rel=\"noreferrer\">this page</a>.</p></li>\n</ul>\n\n<p>Also, more importantly, if this is a private repository for a company or for your self, you may need to skip using proxy or checksum database for such repos to avoid exposing them publicly. </p>\n\n<p>To do this, you need to set <code>GOPRIVATE</code> environment variable that controls which modules the go command considers to be private (not available publicly) and should therefore <strong>NOT</strong> use the proxy or checksum database. </p>\n\n<p>The variable is a comma-separated list of patterns (same syntax of Go's <code>path.Match</code>) of module path prefixes. For example,</p>\n\n<pre><code>export GOPRIVATE=*.corp.example.com,github.com/mycompany/*\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>go env -w GOPRIVATE=github.com/mycompany/*\n</code></pre>\n\n<ul>\n<li>For more information on how to solve private packages/modules checksum validation issues, please read <a href=\"https://medium.com/mabar/today-i-learned-fix-go-get-private-repository-return-error-reading-sum-golang-org-lookup-93058a058dd8\" rel=\"noreferrer\">this article</a>. </li>\n<li>For more information about go 13 modules and new enhancements, please check out <a href=\"https://golang.org/doc/go1.13#modules\" rel=\"noreferrer\">Go 1.13 Modules Release notes</a>.</li>\n</ul>\n\n<p>One last thing not to forget to mention, you can still configure <code>go get</code> to authenticate and fetch over <code>https</code>, all you need to do is to add the following line to <code>$HOME/.netrc</code> </p>\n\n<pre><code>machine github.com login USERNAME password APIKEY\n</code></pre>\n\n<ul>\n<li>For GitHub accounts, the password can be a <a href=\"https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/\" rel=\"noreferrer\">personal access tokens</a>.</li>\n<li>For more information on how to do this, please check Go <a href=\"https://golang.org/doc/faq#git_https\" rel=\"noreferrer\">FAQ</a> page.</li>\n</ul>\n\n<p>I hope this helps the community and saves others' time to solve described issues quickly. please feel free to leave a comment in case you want more support or help. </p>\n"}, {"tags": [], "owner": {"reputation": 1397, "user_id": 4940278, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/06NHi.jpg?s=128&g=1", "display_name": "Luna Lovegood", "link": "https://stackoverflow.com/users/4940278/luna-lovegood"}, "is_accepted": false, "score": 5, "last_activity_date": 1608374420, "creation_date": 1608374420, "answer_id": 65368910, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo/65368910#65368910", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>From go 1.13 onwards, if you had already configured your terminal with the git credentials and yet facing this issue, then you could try setting the <code>GOPRIVATE</code> environment variable. Setting this environment variable solved this issue for me.</p>\n<pre><code>export GOPRIVATE=github.com/{organizationName/userName of the package}/*  \n</code></pre>\n"}], "owner": {"reputation": 2867, "user_id": 478311, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f33a325b11dd39195f5f1249586e791b?s=128&d=identicon&r=PG", "display_name": "tomcam", "link": "https://stackoverflow.com/users/478311/tomcam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223294, "favorite_count": 71, "accepted_answer_id": 38237165, "answer_count": 8, "score": 237, "last_activity_date": 1608374420, "creation_date": 1440609013, "last_edit_date": 1483763538, "question_id": 32232655, "link": "https://stackoverflow.com/questions/32232655/go-get-results-in-terminal-prompts-disabled-error-for-github-private-repo", "title": "go get results in &#39;terminal prompts disabled&#39; error for github private repo", "body": "<p>I created the private repo examplesite/myprivaterepo using the Github UI from my browser.</p>\n\n<p>Then I went to my go directory (on the desktop) and cloned it:</p>\n\n<pre><code>$ cd $GOPATH\n$ go get github.com/examplesite/myprivaterepo\n</code></pre>\n\n<p>So far so good. Created the file scheduler.go, added to repo, and pushed.</p>\n\n<pre><code>$ vim scheduler.go\n$ git add scheduler.go\n$ git commit\n$ git push\n</code></pre>\n\n<p>Everythng's OK. But when I went to a clean laptop  and tried to clone the repo, I got an error:</p>\n\n<pre><code># Now on laptop, which doesn't yet know about the repo\n$ cd $GOPATH\n$ go get github.com/examplesite/myprivaterepo\n# At this point it should ask for my user ID and password ,right? But it doesn't.\n# Instead, this error occurs:\ncd .; git clone https://github.com/examplesite/myprivaterepo /Users/tom/go/src/github.com/examplesite/myprivaterepo\nCloning into '/Users/tom/go/src/github.com/examplesite/myprivaterepo'...\nfatal: could not read Username for 'https://github.com': terminal prompts disabled\npackage github.com/examplesite/myprivaterepo: exit status 128\n</code></pre>\n\n<p>Why is my laptop hating on my own repo and how can I get it to accept its fate? Thanks.</p>\n"}, {"tags": ["string", "go"], "answers": [{"comments": [{"owner": {"reputation": 950, "user_id": 2379112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29014e98d9b4e559ad68e0122aee5630?s=128&d=identicon&r=PG", "display_name": "Brainstorm", "link": "https://stackoverflow.com/users/2379112/brainstorm"}, "edited": false, "score": 1, "creation_date": 1440651729, "post_id": 32230210, "comment_id": 52363498, "body": "Note that this could panic if the second call to index returns <code>-1</code> because <code>&quot;&#47;&quot;</code> was not found. Then <code>i &gt; j</code> in <code>s[i:j]</code> which causes panic."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1440601446, "creation_date": 1440601446, "answer_id": 32230210, "question_id": 32230044, "link": "https://stackoverflow.com/questions/32230044/splitting-string-before-and-after-certain-parameters-in-go/32230210#32230210", "title": "Splitting string before and after certain parameters in Go", "body": "<p><a href=\"http://golang.org/pkg/strings/#Index\"><code>strings.Index</code></a> can help you with this:</p>\n\n<pre><code>s := \"https://docs.google.com/spreadsheets/d/1k2RNDSh6K7jH3fezjjfgVrHqVstBF569al4F28hqAM/edit#gid=0\"\ni := strings.Index(s, \"/d/\") + len(\"/d/\")\nj := strings.Index(s[i:], \"/\") + i\nfmt.Println(s[i:j]) // Prints \"1k2RNDSh6K7jH3fezjjfgVrHqVstBF569al4F28hqAM\"\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/Mqnnc_tNFk\">http://play.golang.org/p/Mqnnc_tNFk</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 5268335, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kqecr.jpg?s=128&g=1", "display_name": "RCZiegler", "link": "https://stackoverflow.com/users/5268335/rcziegler"}, "is_accepted": false, "score": 3, "last_activity_date": 1440601521, "creation_date": 1440601521, "answer_id": 32230238, "question_id": 32230044, "link": "https://stackoverflow.com/questions/32230044/splitting-string-before-and-after-certain-parameters-in-go/32230238#32230238", "title": "Splitting string before and after certain parameters in Go", "body": "<p>I have never used \"go\" but it looks like you could utilize</p>\n\n<pre><code>func Split(s, set string) []string\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>fmt.Printf(\"%q\\n\", strings.Split(\"https://docs.google.com/spreadsheets/d/1234567890/edit#gid...\", \"/\"))\n</code></pre>\n\n<p>would return the array</p>\n\n<pre><code>[\"https:\" \"\" \"docs.google.com\" \"spreadsheets\" \"d\" \"1234567890\" \"edit#gid...\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1440639371, "post_id": 32238808, "comment_id": 52360572, "body": "<a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\">Benchmarks in Go</a> are easy so it&#39;s not opinion if it will be &quot;more faster&quot;. Using a regexp for such a simple task is <a href=\"https://play.golang.org/p/OM8a51129d\" rel=\"nofollow noreferrer\">~17&#215; slower</a> and does three vs zero allocations (and that&#39;s with precompiling the regexp only once in a global)."}], "tags": [], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "is_accepted": false, "score": -1, "last_activity_date": 1440641891, "last_edit_date": 1440641891, "creation_date": 1440635245, "answer_id": 32238808, "question_id": 32230044, "link": "https://stackoverflow.com/questions/32230044/splitting-string-before-and-after-certain-parameters-in-go/32238808#32238808", "title": "Splitting string before and after certain parameters in Go", "body": "<p>There are many alternatives to do this, here is the one which I used regular expression.</p>\n\n<pre><code>s := \"https://docs.google.com/spreadsheets/d/1k2RNDSh6K7jH3fezjjfgVrHqVstBF569al4F28hqAM/edit#gid=0\"\nre := regexp.MustCompile(\"/d/(.*)?/\").FindAllStringSubmatch(s, -1)\nfmt.Println(\"found the pattern :\", re[0][1])\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/l6B4AE-4to\" rel=\"nofollow\">https://play.golang.org/p/l6B4AE-4to</a></p>\n"}], "owner": {"reputation": 521, "user_id": 5142896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a6bbe0b8d0b678f1fb3b95493d42e8?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/5142896/conor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 32230210, "answer_count": 3, "score": 2, "last_activity_date": 1440641891, "creation_date": 1440601010, "last_edit_date": 1440614711, "question_id": 32230044, "link": "https://stackoverflow.com/questions/32230044/splitting-string-before-and-after-certain-parameters-in-go", "title": "Splitting string before and after certain parameters in Go", "body": "<p>My string splitting skills are really poor using Go. I don't know why but I just can't wrap my head around this one and I've tried different ways to do what I need but I always get the wrong output.</p>\n\n<p>I have this string:</p>\n\n<pre><code>https://docs.google.com/spreadsheets/d/1k2RNDSh6K7jH3fezjjfgVrHqVstBF569al4F28hqAM/edit#gid=0\n</code></pre>\n\n<p>I need to get a key from this URL that is found after '/d/' up until the next '/'. </p>\n\n<p>So the key in this case would be:</p>\n\n<pre><code>1k2RNDSh6K7jH3fezjjfgVrHqVstBF569al4F28hqAM\n</code></pre>\n\n<p>How would I go about doing this?</p>\n"}, {"tags": ["go", "byte", "bytearray"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1440659664, "post_id": 32229680, "comment_id": 52367032, "body": "Do we have any guarantees about the numbers in the input? E.g. are they always positive or can they be negative too? Also may the numbers have preceeding zeros, for example the number <code>10</code> may be written as <code>00010</code>?"}, {"owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1440775112, "post_id": 32229680, "comment_id": 52427802, "body": "there are no guarantees about the input, its all parsed []byte from a configuration file at this point"}], "answers": [{"comments": [{"owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "edited": false, "score": 0, "creation_date": 1440601252, "post_id": 32229848, "comment_id": 52342692, "body": "hmm, still I&#39;d like to elide the jumps from byte to string to int to byte, if there is a smoother way; if its not problem its not, it just seems less fluid and more trouble than it should"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "edited": false, "score": 0, "creation_date": 1440601428, "post_id": 32229848, "comment_id": 52342814, "body": "@blueblank: If you want to parse the characters into integers (and it seems that&#39;s what you want fin order to do the numerical comparison), then you need to convert to string in order to pass it into <code>strconv.ParseInt</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1440603289, "last_edit_date": 1440603289, "creation_date": 1440600518, "answer_id": 32229848, "question_id": 32229680, "link": "https://stackoverflow.com/questions/32229680/working-a-bytes-buffer-without-resorting-to-strings-strvconv-etc/32229848#32229848", "title": "working a bytes.Buffer without resorting to strings, strvconv, etc", "body": "<p>There is no <code>[]byte</code> equivalent to the strconv.Parse* functions (see <a href=\"https://golang.org/issue/2632\" rel=\"nofollow\">issue 2632</a>). Using strconv is currently the easiest way to handle this.</p>\n\n<p>You are ignoring the first error however, which is a bug. You can also shorten a couple things, and use the more common idiom of returning early instead of increasing indentation. I would also return an error, instead of a bool for more contextual information. </p>\n\n<pre><code>func rangeSeq(b *bytes.Buffer) ([][]byte, error) {\n    q := bytes.Split(b.Bytes(), sep)\n    if len(q) != 2 {\n        return nil, fmt.Errorf(\"invalid value: %s\", b)\n    }\n\n    var ret [][]byte\n\n    initial, err := strconv.Atoi(string(q[0]))\n    if err != nil {\n        return nil, err\n    }\n\n    last, err := strconv.Atoi(string(q[1]))\n    if err != nil {\n        return nil, err\n    }\n\n    if initial &lt; last {\n        for i := initial; i &lt;= last; i++ {\n            ret = append(ret, strconv.AppendInt(nil, i, 10))\n        }\n    }\n    return ret, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 4034, "user_id": 697364, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d74e445b43c9fcc11524fa8c382409b3?s=128&d=identicon&r=PG", "display_name": "blueblank", "link": "https://stackoverflow.com/users/697364/blueblank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 32229848, "answer_count": 1, "score": 1, "last_activity_date": 1440603289, "creation_date": 1440600098, "question_id": 32229680, "link": "https://stackoverflow.com/questions/32229680/working-a-bytes-buffer-without-resorting-to-strings-strvconv-etc", "title": "working a bytes.Buffer without resorting to strings, strvconv, etc", "body": "<p>I would simply like to do this without resorting to strconv &amp; strings, but I am not proficient working in bytes only:</p>\n\n<pre><code>func rangeSeq(b *bytes.Buffer) ([][]byte, bool) {\n    q := bytes.Split(b.Bytes(), []byte{SEQ_RANGE})\n    if len(q) == 2 {\n        var ret [][]byte\n        il, lt := string(q[0]), string(q[1])\n        initial, err := strconv.ParseInt(il, 10, 64)\n        last, err := strconv.ParseInt(lt, 10, 64)\n        if err == nil {\n            if initial &lt; last {\n                for i := initial; i &lt;= last; i++ {\n                    out := strconv.AppendInt([]byte{}, i, 10)\n                    ret = append(ret, out)\n                }\n            }\n            return ret, true\n        }\n    }\n    return nil, false\n}\n</code></pre>\n\n<p>suggestions?</p>\n"}, {"tags": ["go", "rabbitmq"], "answers": [{"tags": [], "owner": {"reputation": 68895, "user_id": 93448, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e592bd1326b1e80188ed4c0bf26b9f75?s=128&d=identicon&r=PG", "display_name": "Derick Bailey", "link": "https://stackoverflow.com/users/93448/derick-bailey"}, "is_accepted": false, "score": 2, "last_activity_date": 1440600103, "creation_date": 1440600103, "answer_id": 32229681, "question_id": 32228910, "link": "https://stackoverflow.com/questions/32228910/removing-queue-before-nack-freezes-my-app/32229681#32229681", "title": "Removing queue before nack freezes my app", "body": "<blockquote>\n  <p>The problem with this code is that our queues are created/deleted based on a coordinator external to our dispatcher, </p>\n</blockquote>\n\n<p>that is the problem, right there. i would question why you want to do this, instead of allowing the consumer to define the queue and binding that it needs?</p>\n\n<p>barring the ability to question / change that, an error handler around the <code>deliver.Nack</code> is probably your best option. but i think that's an unpleasant workaround for a problem caused by larger design issue</p>\n"}], "owner": {"reputation": 505, "user_id": 344725, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EA9T8.jpg?s=128&g=1", "display_name": "richardalberto", "link": "https://stackoverflow.com/users/344725/richardalberto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440600103, "creation_date": 1440597875, "question_id": 32228910, "link": "https://stackoverflow.com/questions/32228910/removing-queue-before-nack-freezes-my-app", "title": "Removing queue before nack freezes my app", "body": "<p>I'm kind of new to rabbitmq and i was wondering what is the best way to handle an error I'm having when a delete a queue before I can ack a delivery on that queue. </p>\n\n<pre><code>if err := handle(); err != nil {\n  delivery.Nack(false, true)\n} else {\n  delivery.Ack(false)\n}\n</code></pre>\n\n<p>The problem with this code is that our queues are created/deleted based on a coordinator external to our dispatcher, so when delivery is Nack and the queue was deleted the system hangs because it keeps trying to requeue the delivery. </p>\n\n<p>To solve the problem I can just check if the:</p>\n\n<pre><code>delivery.Nack(false, true)\n</code></pre>\n\n<p>returns an error and I can handle it there. But what would be the best approach to drop this delivery if the Nack method returned an error?</p>\n\n<p>Note: I'm using <a href=\"https://github.com/streadway/amqp\" rel=\"nofollow\">https://github.com/streadway/amqp</a></p>\n"}, {"tags": ["go", "rpc"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1440597498, "creation_date": 1440597498, "answer_id": 32228739, "question_id": 32228143, "link": "https://stackoverflow.com/questions/32228143/go-rpc-request-returns-empty/32228739#32228739", "title": "Go: rpc request returns empty", "body": "<p>The bug is in server/domain.go</p>\n\n<pre><code>rsp = &amp;GetAllDomainsResponse{\n    Domains: []string{\"dom1.de\", \"dom2.de\"},\n}\n</code></pre>\n\n<p>where you are not updating the response value provided during the call but assign a new one to your local variable. It should be something like</p>\n\n<pre><code>rsp.Domains = []string{\"dom1.de\", \"dom2.de\"}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 921, "favorite_count": 0, "accepted_answer_id": 32228739, "answer_count": 1, "score": 1, "last_activity_date": 1440597498, "creation_date": 1440596104, "last_edit_date": 1440596883, "question_id": 32228143, "link": "https://stackoverflow.com/questions/32228143/go-rpc-request-returns-empty", "title": "Go: rpc request returns empty", "body": "<p>Ok I have a rpc server package and a rpc client package.\nI'd like to ask the server to return all domains.</p>\n\n<p>In server.go I import server.DomainServer and serve it over http.</p>\n\n<p>In client.go I import client.DomainClient and send a rpc call to the listening server.</p>\n\n<p>The response is empty <code>[]</code>.</p>\n\n<p>The expected response is <code>[\"dom1.de\",\"dom2.de\"]</code></p>\n\n<p>Why is the response empty? How can I debug this?</p>\n\n<p>Do I have to share the GetAllDomainsRequest and GetAllDomainsRequest struct so they have the same type, e.g. in a package called common?</p>\n\n<p>Update: Ran wireshark to capture the response, and the response was, amongst other stuff, []string</p>\n\n<p>server.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/rpc\"\n\n    \"bitbucket.org/idalu/hostd/server\"\n)\n\nfunc main() {\n    var authkey = \"123\"\n    ds := &amp;server.DomainServer{\n        Authkey: authkey,\n    }\n\n    rpc.Register(ds)\n    rpc.HandleHTTP()\n    log.Fatalln(http.ListenAndServe(\":1312\", nil))\n}\n</code></pre>\n\n<p>server/domain.go</p>\n\n<pre><code>package server\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\ntype DomainServer struct {\n    Authkey string\n}\n\ntype GetAllDomainsRequest struct {\n    Authkey string\n}\n\ntype GetAllDomainsResponse struct {\n    Domains []string\n}\n\nfunc (s *DomainServer) GetAllDomains(req GetAllDomainsRequest, rsp *GetAllDomainsResponse) error {\n    if req.Authkey != s.Authkey {\n        return errors.New(\"forbidden\")\n    }\n    rsp = &amp;GetAllDomainsResponse{\n        Domains: []string{\"dom1.de\", \"dom2.de\"},\n    }\n    fmt.Println(rsp)\n    return nil\n}\n</code></pre>\n\n<p>client.go</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"bitbucket.org/idalu/hostd/client\"\n)\n\nfunc main() {\n    dc := &amp;client.DomainClient{\n        Authkey:    \"123\",\n        ServerAddr: \"127.0.0.1:1312\",\n    }\n    if e := dc.GetAllDomains(); e != nil {\n        log.Fatalln(e.Error())\n    }\n}\n</code></pre>\n\n<p>client/domain.go</p>\n\n<pre><code>package client\n\nimport (\n    \"fmt\"\n    \"net/rpc\"\n)\n\ntype DomainClient struct {\n    ServerAddr string\n    Authkey    string\n}\n\ntype GetAllDomainsRequest struct {\n    Authkey string\n}\n\ntype GetAllDomainsResponse struct {\n    Domains []string\n}\n\nfunc (c *DomainClient) GetAllDomains() error {\n    client, e := rpc.DialHTTP(\"tcp\", c.ServerAddr)\n    if e != nil {\n        return e\n    }\n    req := GetAllDomainsRequest{\n        Authkey: c.Authkey,\n    }\n    rsp := GetAllDomainsResponse{}\n    if e := client.Call(\"DomainServer.GetAllDomains\", req, &amp;rsp); e != nil {\n        return e\n    }\n    fmt.Println(rsp.Domains)\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "pool", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1440597953, "post_id": 32227857, "comment_id": 52340166, "body": "It&#39;s very uncommon to use a pool of goroutines, since managing them is usually more overhead than dispatching them when needed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440598398, "post_id": 32227857, "comment_id": 52340529, "body": "Also, if you&#39;re not aware, the stack for a single goroutine is only 2k, and that stack space isn&#39;t (currently) reclaimed but saved for future goroutines. If a pool does make the solution easier, adjusting it dynamically doesn&#39;t save you much, if anything."}, {"owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440598887, "post_id": 32227857, "comment_id": 52340928, "body": "Thing is, I have multiple task queues and a single go process takes tasks from those queues. If some queue is depleted but eventually had work to allow 1000 concurrency(1000 simultaneously running goroutines) I have 1000 idle goroutines right now, but I could use them in handling stuff from another queue... Though probably i&#39;m digging to deep and over-optimizing"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1440599130, "post_id": 32227857, "comment_id": 52341123, "body": "Just create new goroutines for each job. Creating a goroutine literally takes  nanoseconds. If you need to limit the concurrency, you can used a buffered channel."}, {"owner": {"reputation": 1039, "user_id": 382733, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e3f31a7fa1e87dbeaeabc38476f595cd?s=128&d=identicon&r=PG", "display_name": "Vitor De Mario", "link": "https://stackoverflow.com/users/382733/vitor-de-mario"}, "edited": false, "score": 1, "creation_date": 1440625396, "post_id": 32227857, "comment_id": 52356648, "body": "I agree with JimB&#39;s suggestion of creating a goroutine for each job. You could also keep a count of how many are running with sync/atomic and do some profiling to find a max number of goroutines so your program doesn&#39;t blow up with a bump."}, {"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1456456663, "post_id": 32227857, "comment_id": 58966622, "body": "You might consider a sync.Pool  <a href=\"https://godoc.org/sync#Pool\" rel=\"nofollow noreferrer\">godoc.org/sync#Pool</a>"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1457693575, "post_id": 32227857, "comment_id": 59532899, "body": "Me too; still looking for the best way to do this. Meanwhile I&#39;ve implemented a worker pool I use <a href=\"https://github.com/dc0d/workerpool\" rel=\"nofollow noreferrer\">github.com/dc0d/workerpool</a>."}, {"owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 0, "creation_date": 1459273502, "post_id": 32227857, "comment_id": 60208081, "body": "Do <i>not</i> create a goroutine per job if you want it to scale well. Read about how someone did the same thing <a href=\"https://www.facebook.com/ben1sandler\" rel=\"nofollow noreferrer\">here</a> (using a pool of workers and a queue).  The article is titled &quot;Handling 1 Million Requests per Minute with Go&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 348, "user_id": 6634768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2WCdT.png?s=128&g=1", "display_name": "Pavel Kazhevets", "link": "https://stackoverflow.com/users/6634768/pavel-kazhevets"}, "is_accepted": false, "score": 1, "last_activity_date": 1469535736, "last_edit_date": 1469535736, "creation_date": 1469519329, "answer_id": 38583971, "question_id": 32227857, "link": "https://stackoverflow.com/questions/32227857/the-best-way-to-manage-a-dynamic-goroutine-pool/38583971#38583971", "title": "The best way to manage a dynamic goroutine pool", "body": "<p>Well, I'm not sure that a pool is what you need. Goroutines are fast to launch, and you probably don't need to keep them ready all the time.</p>\n\n<p>For this task I would use a simple semaphore. It's really easy to implement a semaphore in Go using channels. You can see my personal example <a href=\"https://github.com/pavel-kazhavets/syncx/blob/master/semaphore.go\" rel=\"nofollow\">here</a>.</p>\n\n<p>You just create a semaphore with a desired capacity (which will be your maximum number of allowed goroutines) and then:</p>\n\n<ol>\n<li>Acqiure the semaphore on goroutine start</li>\n<li>Release it on goroutine end</li>\n</ol>\n\n<p>Simple as that.\nAnd don't worry about the need to launch them on demand; it is really over-optimizing.</p>\n"}], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1427, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1469535736, "creation_date": 1440595308, "last_edit_date": 1440597500, "question_id": 32227857, "link": "https://stackoverflow.com/questions/32227857/the-best-way-to-manage-a-dynamic-goroutine-pool", "title": "The best way to manage a dynamic goroutine pool", "body": "<p>Let's say I have a task provider - readable channel, it may or may not provide a task(depends on work load)\nSpecific is so that there may be no work for hours and then there can be a sudden bump in tasks</p>\n\n<p>I want to let my goroutine pool grow from 1 to N where N is the max concurrency when work appears and then automatically collapse down to 1 where there was no work for a goroutine for longer than X sec to avoid memory/cpu waste.</p>\n\n<p>I could have used just a fixed pool, as goroutines are dirt cheap, but I don't like an idea of having thousands of idling goroutines I may have a better use for those resources(should be mostly ram but still)</p>\n\n<p>Collapsing part is rather easy</p>\n\n<pre><code>for {\n    timeoutTimer := time.NewTimer(WORKER_ROUTINE_TIMEOUT)\n\n    select {\n    case taskContext, isBatchRunning := &lt;-runner.tasksCh:\n        if !isBatchRunning {\n            log.Print(\"task provider is closed, quit worker goroutine\")\n            return\n        }\n\n        runner.job.Process(&amp;taskContext)\n    case &lt;-timeoutTimer.C:\n        return\n    }\n}\n</code></pre>\n\n<p>But i'm not sure how to make pool grow dynamically, i.e. on which condition spawn a new one</p>\n\n<p>A priority for this pool is being able to react fast on increased loading and expand up to N(max concurrency) goroutines, with ability to eventually collapse to a more reasonable numbers(1 at min) when work load decreased</p>\n\n<p>P.S. I saw a <a href=\"https://github.com/Jeffail/tunny\" rel=\"nofollow\">https://github.com/Jeffail/tunny</a> package, but it looks like it does not have anything similar to adaptive scaling of the current pool size. Am I missing something?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "rpc", "json-rpc", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1440586373, "creation_date": 1440586373, "answer_id": 32224692, "question_id": 32224644, "link": "https://stackoverflow.com/questions/32224644/gorilla-jsonrpc-getting-empty-response/32224692#32224692", "title": "Gorilla jsonrpc getting empty response", "body": "<p>Your <code>Response</code> fields are unexported. The names should be uppercase:</p>\n\n<pre><code>type Response struct {\n    Sum     int\n    Message string\n}\n</code></pre>\n"}], "owner": {"reputation": 1870, "user_id": 3274255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc7087b3d24f5a0a0ec683010e70a7c9?s=128&d=identicon&r=PG", "display_name": "theRemix", "link": "https://stackoverflow.com/users/3274255/theremix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 32224692, "answer_count": 1, "score": 1, "last_activity_date": 1440586643, "creation_date": 1440586242, "last_edit_date": 1440586643, "question_id": 32224644, "link": "https://stackoverflow.com/questions/32224644/gorilla-jsonrpc-getting-empty-response", "title": "Gorilla jsonrpc getting empty response", "body": "<p>Why does my jsonrpc method return an empty response?</p>\n\n<pre><code>type Args struct {\n  A, B int\n}\n\ntype Response struct {\n  sum int\n  message string\n}\n\ntype Arith int\n\nfunc (t *Arith) Add(r *http.Request, args *Args, reply *Response) error {\n  reply.sum = args.A + args.B\n  reply.message = \"Do math\"\n\n  // this does not work either\n\n  //*reply = Response{\n  //  sum : 12,\n  //  message : \"Do math\",\n  //}\n\n  return nil\n}\n</code></pre>\n\n<p>Request:</p>\n\n<pre><code>{\"method\":\"Arith.Add\",\"params\":[{\"A\": 10, \"B\":2}], \"id\": 1}\n</code></pre>\n\n<p>Response:</p>\n\n<pre><code>{\n  \"result\": {},\n  \"error\": null,\n  \"id\": 1\n}\n</code></pre>\n\n<p>However, if I set the type of <code>reply</code> to <code>*string</code>, then this will work fine:</p>\n\n<pre><code>*reply = \"Responding with strings works\"\n</code></pre>\n\n<p>Response:</p>\n\n<pre><code>{\n  \"result\": \"Responding with strings works\",\n  \"error\": null,\n  \"id\": 1\n}\n</code></pre>\n\n<p>I'm using <a href=\"http://www.gorillatoolkit.org/pkg/rpc\" rel=\"nofollow\">http://www.gorillatoolkit.org/pkg/rpc</a>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 0, "last_activity_date": 1440588265, "creation_date": 1440588265, "answer_id": 32225334, "question_id": 32224003, "link": "https://stackoverflow.com/questions/32224003/httprouter-setting-custom-notfound/32225334#32225334", "title": "httprouter setting custom NotFound", "body": "<p>Since commit 70708e4600 in httprouter the <code>router.NotFound</code> is no longer a <code>http.HandlerFunc</code> but a <code>http.Handler</code>. So you will have to adapt your functions with via <a href=\"http://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow\">http://golang.org/pkg/net/http/#HandlerFunc</a> if you use a recent commit of httprouter.</p>\n\n<p>The following should work (untested):</p>\n\n<pre><code>router.NotFound = http.HandlerFunc(customNotFound)\n</code></pre>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 32225334, "answer_count": 1, "score": 0, "last_activity_date": 1440588265, "creation_date": 1440584551, "last_edit_date": 1495541861, "question_id": 32224003, "link": "https://stackoverflow.com/questions/32224003/httprouter-setting-custom-notfound", "title": "httprouter setting custom NotFound", "body": "<p>I'm using <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"nofollow noreferrer\">https://github.com/julienschmidt/httprouter</a> in my Go project.</p>\n\n<p>I asked this question a while back which was solved by @icza: <a href=\"https://stackoverflow.com/questions/30500322/httprouter-configuring-notfound\">httprouter configuring NotFound</a> but now, starting a new project and using very similar code I appear to be getting errors in the console.</p>\n\n<p>Trying to configure custom handlers <code>NotFound</code> and <code>MethodNotAllowed</code> I'm using:</p>\n\n<pre><code>router.NotFound = customNotFound\nrouter.MethodNotAllowed = customMethodNotAllowed\n</code></pre>\n\n<p>produces:</p>\n\n<pre><code>cannot use customNotFound (type func(http.ResponseWriter, *http.Request)) as type http.Handler in assignment:                                                                               \n        func(http.ResponseWriter, *http.Request) does not implement http.Handler (missing ServeHTTP method)                                                                                                   \n\ncannot use customMethodNotAllowed (type func(http.ResponseWriter, *http.Request)) as type http.Handler in assignment:                                                                       \n        func(http.ResponseWriter, *http.Request) does not implement http.Handler (missing ServeHTTP method)  \n</code></pre>\n\n<p>My functions look like this:</p>\n\n<pre><code>func customNotFound(w http.ResponseWriter, r *http.Request) {\n    core.WriteError(w, \"PAGE_NOT_FOUND\", \"Requested resource could not be found\")\n    return\n}\n\nfunc customMethodNotAllowed(w http.ResponseWriter, r *http.Request) {\n    core.WriteError(w, \"METHOD_NOT_PERMITTED\", \"Request method not supported by that resource\")\n    return\n}\n</code></pre>\n\n<p>Has there been some breaking changes in this package in the last couple of months as I can't work out why I'm getting the error in one project and not in the other?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5267918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9e4a7313590d14c71b2d4a63ea2116?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Gu", "link": "https://stackoverflow.com/users/5267918/kevin-gu"}, "edited": false, "score": 0, "creation_date": 1440592376, "post_id": 32224083, "comment_id": 52335869, "body": "Nice solution! Actually I have another solution. I will post it. But I like your solution better."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 9, "last_activity_date": 1440584772, "creation_date": 1440584772, "answer_id": 32224083, "question_id": 32223562, "link": "https://stackoverflow.com/questions/32223562/how-to-convert-uintptr-to-byte-in-golang/32224083#32224083", "title": "How to convert uintptr to []byte in golang?", "body": "<p>That depends on what's your machine's architecture (32- or 64-bit) and how do you want it to be encoded (little- or big-endian). Either way, <a href=\"http://golang.org/pkg/encoding/binary/\"><code>encoding/binary</code></a> is your answer:</p>\n\n<pre><code>var u uintptr = 42\nsize := unsafe.Sizeof(u)\nb := make([]byte, size)\nswitch size {\ncase 4:\n    binary.LittleEndian.PutUint32(b, uint32(u))\ncase 8:\n    binary.LittleEndian.PutUint64(b, uint64(u))\ndefault:\n    panic(fmt.Sprintf(\"unknown uintptr size: %v\", size))\n}\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/tIocqy-rAJ\">http://play.golang.org/p/tIocqy-rAJ</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5267918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9e4a7313590d14c71b2d4a63ea2116?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Gu", "link": "https://stackoverflow.com/users/5267918/kevin-gu"}, "is_accepted": false, "score": 4, "last_activity_date": 1440592609, "creation_date": 1440592609, "answer_id": 32226893, "question_id": 32223562, "link": "https://stackoverflow.com/questions/32223562/how-to-convert-uintptr-to-byte-in-golang/32226893#32226893", "title": "How to convert uintptr to []byte in golang?", "body": "<pre><code>package main\n\nimport \"fmt\"\nimport \"unsafe\"\n\nconst sizeOfUintPtr = unsafe.Sizeof(uintptr(0))\n\nfunc uintptrToBytes(u *uintptr) []byte {\n    return (*[sizeOfUintPtr]byte)(unsafe.Pointer(u))[:]\n}\n\nfunc main() {\n\n   var u = uintptr(1025)\n   fmt.Println(uintptrToBytes(&amp;u))\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/tIocqy-rAJ\" rel=\"nofollow\">http://play.golang.org/p/tIocqy-rAJ</a></p>\n"}], "owner": {"reputation": 99, "user_id": 5267918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9e4a7313590d14c71b2d4a63ea2116?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Gu", "link": "https://stackoverflow.com/users/5267918/kevin-gu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3702, "favorite_count": 1, "accepted_answer_id": 32224083, "answer_count": 2, "score": 3, "last_activity_date": 1440592609, "creation_date": 1440583352, "question_id": 32223562, "link": "https://stackoverflow.com/questions/32223562/how-to-convert-uintptr-to-byte-in-golang", "title": "How to convert uintptr to []byte in golang?", "body": "<p>I don't know how to do it.\nIt doesn't compile using <code>[]byte(uintptr(0))</code>.</p>\n\n<p>Please show me an example.</p>\n"}, {"tags": ["google-app-engine", "go", "facebook-login", "google-login", "google-identity-toolkit"], "comments": [{"owner": {"reputation": 37983, "user_id": 1843331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVX5R.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/1843331/tim"}, "edited": false, "score": 1, "creation_date": 1440573648, "post_id": 32220196, "comment_id": 52323603, "body": "<i>which needs to be validated by contacting Facebook.</i> why validate it? You made the app, you already know where the token came from and whether it&#39;s valid or not"}, {"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "reply_to_user": {"reputation": 37983, "user_id": 1843331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVX5R.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/1843331/tim"}, "edited": false, "score": 0, "creation_date": 1440574385, "post_id": 32220196, "comment_id": 52324061, "body": "@TimCastelijns could you maybe provide a more elaborate answer? Yes, the app is in my control but any other program might also access my API."}, {"owner": {"reputation": 37983, "user_id": 1843331, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aVX5R.jpg?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/1843331/tim"}, "edited": false, "score": 0, "creation_date": 1440574747, "post_id": 32220196, "comment_id": 52324273, "body": "Oh ok, I wasn&#39;t aware this would be a public api, sorry"}], "answers": [{"comments": [{"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440624374, "post_id": 32233813, "comment_id": 52356199, "body": "Thanks @Ying for the answer. It sounds like I do not want to pass the gtoken around as it&#39;s too heavy to validate, and it also doesn&#39;t seem good to pass Facebook tokens around as I would like to have a federated login. Hence, option number 2 seems best."}], "tags": [], "owner": {"reputation": 76, "user_id": 4976542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/baaf28e0472f9d4204d098ea2ec1ba42?s=128&d=identicon&r=PG&f=1", "display_name": "Ying", "link": "https://stackoverflow.com/users/4976542/ying"}, "is_accepted": true, "score": 6, "last_activity_date": 1440612816, "creation_date": 1440612816, "answer_id": 32233813, "question_id": 32220196, "link": "https://stackoverflow.com/questions/32220196/how-to-allow-mobile-apps-to-login-with-facebook-and-google-to-access-web-service/32233813#32233813", "title": "How to allow mobile apps to login with Facebook and Google to access web service on GAE?", "body": "<p>Looks like you have an app and a backend on GAE.\nIf you are using google identity toolkit, it will allow you to signin with Facebook, Google, and email/password.</p>\n\n<p>When user successfully signs in to your app using identity toolkit, your server should receive a gtoken. You have two options here:</p>\n\n<ol>\n<li>Pass the gtoken to your app and save it there. When your app makes API calls to your backend, you app should attach the gtoken to every request. Your backend should verify the gtoken(<a href=\"https://developers.google.com/identity/toolkit/web/required-endpoints\">https://developers.google.com/identity/toolkit/web/required-endpoints</a>) for every API that needs authorization.</li>\n<li>Verify the gtoken, generate a token that your backend can recognize/identify the user. Then pass the token to your app and everything else is the same as option 1.</li>\n</ol>\n\n<p>If you do not want to use identity toolkit, you can implement facebook login on your app/backend and use facebook token to communicate between your app and backend.</p>\n\n<p>Whatever your decision is, apps that use your API should pass you something that your backend can recognize/authorize the user.</p>\n"}, {"comments": [{"owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "edited": false, "score": 0, "creation_date": 1440624465, "post_id": 32234244, "comment_id": 52356242, "body": "Thanks for the detailed answer @Dan. Very good and validates some of my own thoughts."}], "tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": false, "score": 3, "last_activity_date": 1531630647, "last_edit_date": 1531630647, "creation_date": 1440614286, "answer_id": 32234244, "question_id": 32220196, "link": "https://stackoverflow.com/questions/32220196/how-to-allow-mobile-apps-to-login-with-facebook-and-google-to-access-web-service/32234244#32234244", "title": "How to allow mobile apps to login with Facebook and Google to access web service on GAE?", "body": "<p>The answer is about using Google Identity Toolkit (GIT). GIT itself is an identity provider, which would be integrated with your apps <strong>and</strong> backend. The flow works along these lines:</p>\n\n<ul>\n<li>your app requests login via its GIT API</li>\n<li>GIT will perform the federated login with Facebook or other 3rd party provider (transparent to your app) and returns a <a href=\"https://developers.google.com/identity/toolkit/web/required-endpoints#id_token_desc\" rel=\"nofollow noreferrer\"><strong>GIT</strong> token</a> to the app (representing a unique user from your end-to-end system perspective, i.e. apps plus backend)</li>\n<li>the app makes a request to the backend in which it passes the GIT token</li>\n<li>the backend verifies the GIT token validity (using <a href=\"https://github.com/google/identity-toolkit-go-client/blob/master/gitkit/token.go#L62\" rel=\"nofollow noreferrer\">this go GIT client API</a>, for example) and from it can extract the identity of the user and thus validate the request</li>\n</ul>\n\n<p>You can find more detailed info about the backend token validation in <a href=\"https://developers.google.com/identity/toolkit/web/required-endpoints\" rel=\"nofollow noreferrer\">the backent endpoint doc</a>, look for these sections in particular:</p>\n\n<ul>\n<li>Understanding the Identity Toolkit cookie/token</li>\n<li>Getting information for users</li>\n</ul>\n\n<p>Now the actual token validation on the backend may take a few seconds, so it <em>might</em> not be practical to do it for each and every REST request from the app. If so you'd need to somehow: </p>\n\n<ul>\n<li>save the info that the user of that specific app instance is\nauthenticated in something like a \"session\" managed between your app and the backend</li>\n<li>map a specific REST request received by the backend to a specific such authenticated \"session\"</li>\n</ul>\n\n<p>But I'm not sure how exactly is this \"session\" functionality done in the apps+backend context, I didn't write any apps yet.</p>\n"}], "owner": {"reputation": 5515, "user_id": 534005, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/aa6285532343827af4b4811de7d52277?s=128&d=identicon&r=PG", "display_name": "murrekatt", "link": "https://stackoverflow.com/users/534005/murrekatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 32233813, "answer_count": 2, "score": 3, "last_activity_date": 1531630647, "creation_date": 1440573346, "last_edit_date": 1495542192, "question_id": 32220196, "link": "https://stackoverflow.com/questions/32220196/how-to-allow-mobile-apps-to-login-with-facebook-and-google-to-access-web-service", "title": "How to allow mobile apps to login with Facebook and Google to access web service on GAE?", "body": "<p>This is in relation to <a href=\"https://stackoverflow.com/questions/32210332/do-i-need-to-create-a-facebook-app-to-use-facebook-login\">my other question about the need to create a Facebook app</a>.</p>\n\n<p>I've been reading a lot about how to best approach login for mobile apps users (iOS and Android) that access my web service running on Google App Engine. I'm still not clear how to best do it as I would like to offer login with both Google and Facebook. The app and the web service does nothing with Facebook or Google other than I would like to piggyback on their login.</p>\n\n<p>Having only login with Google for GAE is very easy and the same goes for using OpenIDConnect. Facebook unfortunately does not support this.</p>\n\n<p>Reading an <a href=\"https://stackoverflow.com/questions/4623974/design-for-facebook-authentication-in-an-ios-app-that-also-accesses-a-secured-we\">old question here on SO</a> where someone wanted to do the same as I it looks like the app should do Facebook Login and then get a token that it passes to my backend which needs to be validated by contacting Facebook. Is this how to do it today?</p>\n\n<p>I also found Google Identity Toolkit, which seem to be what I need. However, I do not have a website or just apps. I would need to have the apps do the Facebook login and somehow provide my web service with something so it can validate the login info.</p>\n\n<p>Later on an app user should be able to log in using randomly Facebook, Google and my custom username/password. The app and the web service should know the user is logged in and authorize it to access the REST API.</p>\n\n<p>How do I accomplish this? BTW, I'm using Go on GAE.</p>\n\n<p>I would really appreciate if someone could explain if there are several options how to do this, pros and cons, and provide an overview of the best approach and what needs to be done.</p>\n\n<p>Many thanks for any help with this!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>OK, thanks a lot everyone for the help and pointers. I have successfully run the <a href=\"https://developers.google.com/identity/toolkit/ios/quickstart\" rel=\"nofollow noreferrer\">quickstart sample app for iOS</a> for my GAE backend. Basically, created a Facebook app and permissions credentials on my web service on GAE so that the sample iOS app can log in.</p>\n\n<p>A bit of a gap still before I have an authenticated user in the datastore and can authorize successive API calls.</p>\n\n<p>Main open questions at this point:</p>\n\n<ol>\n<li>how to get the gtoken in the iOS app after successful Facebook or Google login?</li>\n<li>should I explicitly call an API on my web service to pass in the gtoken or is this somehow automatic with Gitkit API enabled?</li>\n</ol>\n\n<p>Thanks for any help!</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>To answer #1 and #2 myself, there's a \"successful sign-in url\" that can be given in the app engine config so the app knows where to call with the gtoken. Then after that it's like explained in the answers.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1440576457, "post_id": 32220095, "comment_id": 52325300, "body": "What&#39;s wrong with using buffered channels for the workers? That way they won&#39;t be &quot;synchronized&quot; (up until the buffer is filled which will be the &quot;throughput&quot;). E.g. <code>rq.ch = make(chan int, 20)</code>"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1440577395, "post_id": 32220095, "comment_id": 52325843, "body": "Buffered channels would just move that synchronization back a bit, not really changing anything. However yes, that is a possibility."}, {"owner": {"reputation": 4624, "user_id": 863924, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/J9N3K.jpg?s=128&g=1", "display_name": "km6zla", "link": "https://stackoverflow.com/users/863924/km6zla"}, "edited": false, "score": 0, "creation_date": 1440628275, "post_id": 32220095, "comment_id": 52357782, "body": "offtopic: in your actual implementation you might want to use a <code>sync.WaitGroup</code> to make sure each of your workers has finished in the case that they will have cleanup to do. i believe in the example code, it is not guaranteed that each of your workers will enter the case receiving from <code>shutdown</code> since once you pass the closed channel in the main func, the program exits."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 4624, "user_id": 863924, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/J9N3K.jpg?s=128&g=1", "display_name": "km6zla", "link": "https://stackoverflow.com/users/863924/km6zla"}, "edited": false, "score": 0, "creation_date": 1440634205, "post_id": 32220095, "comment_id": 52359464, "body": "@ogc-nick yea I know, that is just a quick mock of the functionality, not the actual exit conditions. The actual code uses waitgroups, thanks though!"}], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1440634321, "post_id": 32228931, "comment_id": 52359500, "body": "Was kinda hoping there was some silly obvious solution that I missed like is normally the case when I ask questions here. The problem with speeding up the slow worker is that it is limited by making http requests, I guess I can toss some more goroutines its way to try to give it more priority and see how that helps."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1440597931, "creation_date": 1440597931, "answer_id": 32228931, "question_id": 32220095, "link": "https://stackoverflow.com/questions/32220095/distribute-the-same-keyword-to-multiple-goroutines/32228931#32228931", "title": "Distribute the same keyword to multiple goroutines", "body": "<p><strong>Let's assume I understand the problem correctly:</strong></p>\n\n<p>There's not too much you can do about it I'm afraid. You have limited resources (assuming all resources are limited) so if data to your input is written faster then you process it, there will be some synchronisation needed. At the end the whole process will run as quickly as the <em>slowest</em> worker anyway.</p>\n\n<p>If you really need data from the workers available as soon as possible, the best you can do is to add some kind of buffering. But the buffer must be limited in size (even if you run in the cloud it would be limited by your wallet) so assuming never ending torrent of input it will only postpone the choke until some time in the future where you will start seeing \"synchronisation\" again.</p>\n\n<p>All the ideas you presented in your questions are based on buffering the data. Even if you run a routine for every keyword-worker pair, this will buffer one element in every routine and, unless you implement the limit on total number of routines, you'll run out of memory. And even if you always leave some room for the quickest worker to spawn a new routine, the input queue won't be able to deliver new items as it would be choked on the slowest worker.</p>\n\n<p>Buffering <em>would</em> solve your problem if on average you input is slower than processing time, but you have occasional spikes. If your buffer is big enough you can than accommodate the increase of throughput and maybe your quickest worker won't notice a thing.</p>\n\n<p><strong>Solution?</strong></p>\n\n<p>As go comes with buffered channels, this is the easiest to implement (also suggested by icza in the comment). Just give each worker a buffer. If you know which worker is the slowest, you can give it a bigger buffer. In this scenario you're limited by the memory of your machine.</p>\n\n<p>If you're not happy with the single-machine memory limit then yes, per one of your ideas, you can \"simply\" store the buffer (queue) for each worker on the hard drive. But this is also limited and just postpones the blocking scenario until later. This is essentially the same as your Amazon SQS proposal (you could keep buffer in the cloud, but you need either limit it reasonably or prepare for the bill.)</p>\n\n<p>The final note, depending on the system you're building, it might be not a good idea to buffer items in such a massive scale allowing to build up the backlog for the slower workers \u2013 it's often not desirable to have a worker hours, days, weeks behind the input flow and this is what would happen with an infinite buffer. The real answer then would be: improve your slowest worker to process things faster. (And add <em>some</em> buffering to improve the experience.)</p>\n"}], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1440597931, "creation_date": 1440573061, "last_edit_date": 1440577878, "question_id": 32220095, "link": "https://stackoverflow.com/questions/32220095/distribute-the-same-keyword-to-multiple-goroutines", "title": "Distribute the same keyword to multiple goroutines", "body": "<p>I have something like this mock (code below) which distributes the same keyword out to multiple goroutines, except the goroutines all take different amount of times doing things with the keyword but can operate independently of each other so they don't need any synchronization. The solution given below to distribute clearly synchronizes the goroutines. </p>\n\n<p>I just want to toss this idea out there to see how other people would deal with this type of distribution, as I assume it is fairly common and someone else has thought about it before.</p>\n\n<p>Here are some other solutions I have thought up and why they seem kinda meh to me:</p>\n\n<h3>One goroutine for each keyword</h3>\n\n<p>Each time a new keyword comes in spawn a goroutine to handle the distribution</p>\n\n<h3>Give the keyword a bitmask or something for each goroutine to update</h3>\n\n<p>This way once all of the workers have touched the keyword it can be deleted and we can move on</p>\n\n<h3>Give each worker its own stack to work off of</h3>\n\n<p>This seems kinda appealing, just give each worker a stack to add each keyword to, but we would eventually run into a problem of a ton of memory being taken up since it is planned to run so long</p>\n\n<p>The problem with all of these is that my code is supposed to run for a long time, unwatched, and that would lead to either a huge build up of keywords or goroutines due to the lazy worker taking longer than the others. It almost seems like it'd be nice to give each worker its own Amazon SQS queue or implement something similar to that myself.</p>\n\n<p>EDIT:</p>\n\n<h3>Store the keyword outside the program</h3>\n\n<p>I just thought of doing it this way instead, I could perhaps just store the keyword outside the program until they all grab it and then delete it once it has been used up. This sits ok with me actually, I don't have a problem with using up disk space</p>\n\n<p>Anyway here is an example of the approach that waits for all to finish:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"math/rand\"\n    \"os\"\n    \"os/signal\"\n    \"strconv\"\n    \"time\"\n)\n\nvar (\n    shutdown chan struct{}\n    count    = flag.Int(\"count\", 5, \"number to run\")\n)\n\ntype sleepingWorker struct {\n    name  string\n    sleep time.Duration\n    ch    chan int\n}\n\nfunc NewQuicky(n string) sleepingWorker {\n    var rq sleepingWorker\n    rq.name = n\n    rq.ch = make(chan int)\n    rq.sleep = time.Duration(rand.Intn(5)) * time.Second\n    return rq\n}\n\nfunc (r sleepingWorker) Work() {\n    for {\n        fmt.Println(r.name, \"is about to sleep, number:\", &lt;-r.ch)\n        time.Sleep(r.sleep)\n    }\n}\n\nfunc NewLazy() sleepingWorker {\n    var rq sleepingWorker\n    rq.name = \"Lazy slow worker\"\n    rq.ch = make(chan int)\n    rq.sleep = 20 * time.Second\n    return rq\n}\n\nfunc distribute(gen chan int, workers ...sleepingWorker) {\n    for kw := range gen {\n        for _, w := range workers {\n            fmt.Println(\"sending keyword to:\", w.name)\n            select {\n            case &lt;-shutdown:\n                return\n            case w.ch &lt;- kw:\n                fmt.Println(\"keyword sent to:\", w.name)\n            }\n        }\n    }\n}\n\nfunc main() {\n    flag.Parse()\n    shutdown = make(chan struct{})\n    go func() {\n        c := make(chan os.Signal, 1)\n        signal.Notify(c, os.Interrupt)\n        &lt;-c\n        close(shutdown)\n    }()\n\n    x := make([]sleepingWorker, *count)\n    for i := 0; i &lt; (*count)-1; i++ {\n        x[i] = NewQuicky(strconv.Itoa(i))\n        go x[i].Work()\n    }\n    x[(*count)-1] = NewLazy()\n    go x[(*count)-1].Work()\n\n    gen := make(chan int)\n    go distribute(gen, x...)\n    go func() {\n        i := 0\n        for {\n            i++\n            select {\n            case &lt;-shutdown:\n                return\n            case gen &lt;- i:\n            }\n        }\n    }()\n    &lt;-shutdown\n    os.Exit(0)\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ec2"], "comments": [{"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1440573289, "post_id": 32220044, "comment_id": 52323396, "body": "Shouldn&#39;t have to do anything special, try using <code>nmap</code> on your EC2 instance to make sure the port is really open."}, {"owner": {"reputation": 1260, "user_id": 840419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/94d4a370033a41eea3288ed269784339?s=128&d=identicon&r=PG", "display_name": "Sanath Ballal", "link": "https://stackoverflow.com/users/840419/sanath-ballal"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 1, "creation_date": 1440573836, "post_id": 32220044, "comment_id": 52323707, "body": "I changed the router.Run from router.Run(&quot;127.0.0.1:8080&quot;) to router.Run(&quot;:8080&quot;) and it is working fine now"}, {"owner": {"reputation": 1260, "user_id": 840419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/94d4a370033a41eea3288ed269784339?s=128&d=identicon&r=PG", "display_name": "Sanath Ballal", "link": "https://stackoverflow.com/users/840419/sanath-ballal"}, "reply_to_user": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1440573957, "post_id": 32220044, "comment_id": 52323775, "body": "But aren&#39;t they both mean the same?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 4, "creation_date": 1440574204, "post_id": 32220044, "comment_id": 52323936, "body": "No. 127.0.0.1 (local host) is only the loop back interface on the machine. Binding to &quot;:8080&quot; means 0.0.0.0:8080 - which means all interfaces. Your external IP address isn&#39;t 127.0.0.1 but likely an IP on another interface (use ifconfig to discover them)."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 1, "creation_date": 1440574299, "post_id": 32220044, "comment_id": 52324005, "body": "Sorry I read it quickly and didn&#39;t see the <code>127.0.0.1:8080</code>, that isn&#39;t binding it to <code>0.0.0.0:8080</code> so you&#39;re only listening on loopback"}], "answers": [{"tags": [], "owner": {"reputation": 1260, "user_id": 840419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/94d4a370033a41eea3288ed269784339?s=128&d=identicon&r=PG", "display_name": "Sanath Ballal", "link": "https://stackoverflow.com/users/840419/sanath-ballal"}, "is_accepted": true, "score": 4, "last_activity_date": 1440576521, "creation_date": 1440576521, "answer_id": 32221185, "question_id": 32220044, "link": "https://stackoverflow.com/questions/32220044/unable-to-access-go-server-when-hosted-on-aws/32221185#32221185", "title": "Unable to access Go server when hosted on AWS", "body": "<p>Changed the router.Run from <code>router.Run(\"127.0.0.1:8080\")</code> to <code>router.Run(\":8080\")</code> and it works.\nAs suggested by @elithrar and @user3591723\n127.0.0.1 (local host) is only the loop back interface on the machine\nBinding to \":8080\" means 0.0.0.0:8080 - which means all interfaces</p>\n"}], "owner": {"reputation": 1260, "user_id": 840419, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/94d4a370033a41eea3288ed269784339?s=128&d=identicon&r=PG", "display_name": "Sanath Ballal", "link": "https://stackoverflow.com/users/840419/sanath-ballal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "accepted_answer_id": 32221185, "answer_count": 1, "score": 0, "last_activity_date": 1440576521, "creation_date": 1440572854, "last_edit_date": 1440576124, "question_id": 32220044, "link": "https://stackoverflow.com/questions/32220044/unable-to-access-go-server-when-hosted-on-aws", "title": "Unable to access Go server when hosted on AWS", "body": "<p>I have created a project in Go using gin and it is working fine locally. However, when I tried deploying this on an EC2 instance on AWS, I was unable to access the APIs on the server. </p>\n\n<p>I did a ssh into the hosted machine and gave a curl request (<code>curl localhost:8080</code>) and it gave a proper response. But any request from outside is not reachable. </p>\n\n<p>The server is running on port 8080. I have opened the ports in the AWS security groups.</p>\n\n<p>Is there any setting in Go/gin that I need to make for it to be accessible from the internet?</p>\n\n<p>Sample code:</p>\n\n<pre><code>package main\n\nimport (\n    \"myConstants\"\n    \"myDatabase\"\n    \"myMiddleware\"\n    \"onboarding\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n\n    var db = myDatabase.DBConnect()\n\n    router := gin.Default()\n\n    router.Use(myMiddleware.RestrictInputContent)\n    router.Use(myMiddleware.CheckToken(db))\n    router.Use(myMiddleware.RequestLoggerMiddleware())\n\n    router.POST(\"/signup\", onboarding.Signup(db))\n    router.POST(\"/login\", onboarding.Login(db))\n    router.POST(\"/logout\", onboarding.Logout(db))\n    router.GET(\"/\", onboarding.Hello(db))\n\n    defer db.Close()\n\n    //Listen and serve\n    router.Run(\"127.0.0.1:8080\")\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440572847, "post_id": 32219491, "comment_id": 52323171, "body": "What does wrapping <code>[]interface{}</code> in <code>()</code> do exactly?"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1440571861, "last_edit_date": 1440571861, "creation_date": 1440570764, "answer_id": 32219491, "question_id": 32219364, "link": "https://stackoverflow.com/questions/32219364/gorilla-web-toolikit-lensession-flashes-is-0/32219491#32219491", "title": "Gorilla web toolikit: len(session.Flashes()) is 0", "body": "<p>It's not very well documented, but apparently <code>Flashes</code> <em>removes</em> flashes from the session and returns them:</p>\n\n<pre><code>func (s *Session) Flashes(vars ...string) []interface{} {\n    var flashes []interface{}\n    key := flashesKey\n    if len(vars) &gt; 0 {\n        key = vars[0]\n    }\n    if v, ok := s.Values[key]; ok {\n        // Drop the flashes and return it.\n        delete(s.Values, key)\n        flashes = v.([]interface{})\n    }\n    return flashes\n}\n</code></pre>\n\n<p>Source code <a href=\"https://github.com/gorilla/sessions/blob/460e18584b819b2ffc92706c71e9c4791aba65ea/sessions.go#L60\" rel=\"nofollow\">here</a>.</p>\n\n<p>The solution here is to use a separate variable to save the validation state:</p>\n\n<pre><code>valid := true\nif username == \"\" || len(username) &lt; 4 {\n    valid = false\n    session.AddFlash(\"Username is too short\")\n    session.Save(r, w)\n}\n// ...\nif !valid {\n    // ...\n} else {\n    // ...\n}\n</code></pre>\n\n<p><strong>EDIT:</strong> Another way to get flashes without deleting them is to get them from <code>Values</code> directly:</p>\n\n<pre><code>flashes := session.Values[\"_flash\"].([]interface{})\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 32219491, "answer_count": 1, "score": 0, "last_activity_date": 1440571861, "creation_date": 1440570231, "last_edit_date": 1440571416, "question_id": 32219364, "link": "https://stackoverflow.com/questions/32219364/gorilla-web-toolikit-lensession-flashes-is-0", "title": "Gorilla web toolikit: len(session.Flashes()) is 0", "body": "<p>I have a register form I'm trying to put together, with simple logic I have form validation checked on the server side with simple ifs e.g.</p>\n\n<pre><code>if username == \"\" || &lt; 5 {\n    session.AddFlash(\"Username is too short\")\n    session.Save(r, w)\n}\n</code></pre>\n\n<p>That works fine then at the end of the validation I do (for debugging purposes)</p>\n\n<pre><code>fmt.Println(len(session.Flashes())) which returns 3\n</code></pre>\n\n<p>Then I check to see if there were any form errors like so</p>\n\n<pre><code>if len(session.Flashes()) != 0 {\n    // Perform Redirect and show flashes\n} else {\n    // Set proper session variables and log user in\n}\n</code></pre>\n\n<p>So if <code>3 &gt; 0</code> why is the <code>else</code> statement being triggered and not the first part of the if statement? I'm just unsure why this is happening the way it is. Thanks if you need anymore information let me know, actual code snippet: </p>\n\n<pre><code>if username == \"\" || len(username) &lt; 4 {\n    session.AddFlash(\"Username is too short\")\n    session.Save(r, w)\n}\nif email == \"\" || len(email) &lt; 5 {\n    session.AddFlash(\"Email is too short\")\n    session.Save(r, w)\n}\nif firstname == \"\" || len(firstname) &lt; 3 {\n    session.AddFlash(\"Firstname is too short\")\n    session.Save(r, w)\n}\nif lastname == \"\" || len(lastname) &lt; 3 {\n    session.AddFlash(\"Lastname is too short\")\n    session.Save(r, w)\n}\n\nfmt.Println(len(session.Flashes()) &gt; 0) // true\n\nif len(session.Flashes()) != 0 {\n    fmt.Println(\"Why am I here also\")\n    type Page struct {\n        Title    string\n        Username interface{}\n        Errors   []interface{}\n    }\n\n    session, _ := common.GetSession(r)\n    data := &amp;Page{\"Register\", session.Values[\"username\"], session.Flashes()}\n    session.Save(r, w)\n\n    tmpl, err := template.ParseFiles(\"views/register/register.html\")\n    if err != nil {\n        http.Error(w, \"Failed to load page.\", 500)\n    }\n    tmpl.ExecuteTemplate(w, \"register\", data)\n} else {\n    fmt.Println(\"Why am I here\")\n    _, err := db.Query(\"// Perform DB Query\")\n    if err != nil {\n        http.Error(w, \"Sorry we had trouble saving your account to the database, try again in a bit.\", 500)\n    }\n\n    session.Values[\"username\"] = r.FormValue(\"username\")\n    session.Values[\"authenticated\"] = true\n\n    session.Save(r, w)\n\n    http.Redirect(w, r, \"/\", 303)\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 3, "last_activity_date": 1440561843, "last_edit_date": 1440561843, "creation_date": 1440561430, "answer_id": 32217749, "question_id": 32217683, "link": "https://stackoverflow.com/questions/32217683/go-type-assert-nil-to-pointer-type/32217749#32217749", "title": "Go type assert nil to pointer type", "body": "<p>You can't type assert something with no type.</p>\n\n<blockquote>\n  <p>The static type (or just type) of a variable is the type given in its\n  declaration, the type provided in the new call or composite literal,\n  or the type of an element of a structured variable. <strong>Variables of\n  interface type also have a distinct dynamic type, which is the\n  concrete type of the value assigned to the variable at run time\n  (unless the value is the predeclared identifier nil, which has no\n  type).</strong> The dynamic type may vary during execution but values stored in\n  interface variables are always assignable to the static type of the\n  variable.</p>\n</blockquote>\n\n<p>Straight from the <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow\">spec</a> (emphasis mine)</p>\n\n<p>Interfaces know the type of the underlying value. For instance if I have a interface with a <code>type MyType</code> it can't be type asserted to <code>*string</code> either. You could perhaps convert its type with some work, but type assertion and type conversion are different.</p>\n\n<p>Also take a look <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">here</a></p>\n\n<blockquote>\n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n  \n  <p>x.(T) </p>\n  \n  <p><strong>asserts that x is not nil</strong> and that the value stored in x is of\n  type T. The notation x.(T)</p>\n</blockquote>\n"}], "owner": {"reputation": 5363, "user_id": 1941755, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/cc1a65240d9b52374b0f084dbe7344cc?s=128&d=identicon&r=PG", "display_name": "ealfonso", "link": "https://stackoverflow.com/users/1941755/ealfonso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4736, "favorite_count": 0, "closed_date": 1440569308, "accepted_answer_id": 32217749, "answer_count": 1, "score": 0, "last_activity_date": 1440561843, "creation_date": 1440560978, "question_id": 32217683, "link": "https://stackoverflow.com/questions/32217683/go-type-assert-nil-to-pointer-type", "closed_reason": "Duplicate", "title": "Go type assert nil to pointer type", "body": "<p>Why can't I type-assert a nil to a pointer type? What is the logic behind this?</p>\n\n<pre><code>package main\n\nfunc main() {\n    var s interface{} = nil\n    var p *string = nil\n    var q *string = s.(*string)\n    _ = q\n    _ = p\n}\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "go"], "comments": [{"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 1, "creation_date": 1440557795, "post_id": 32217256, "comment_id": 52318089, "body": "here is Your answer: <a href=\"http://stackoverflow.com/questions/17840963/create-a-map-in-golang-from-database-rows\" title=\"create a map in golang from database rows\">stackoverflow.com/questions/17840963/&hellip;</a>"}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1440558538, "post_id": 32217256, "comment_id": 52318232, "body": "If you don&#39;t want to use one of those packages it is fairly straightforward to come up with your own solution using the <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1440574359, "post_id": 32217256, "comment_id": 52324048, "body": "It is certainly not &quot;fairly straightforward&quot;. Value types, pointer types, nested structs, byte arrays, time.Time, custom types, etc: you&#39;ll likely have to handle all of those cases and the reflect package can be brittle (panics if you mess it up). <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a> has been around for a while and solves this."}], "owner": {"reputation": 7376, "user_id": 2171928, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a2dc8a6d4e15c61451d70f695ac18ae9?s=128&d=identicon&r=PG", "display_name": "Kishore Vaishnav", "link": "https://stackoverflow.com/users/2171928/kishore-vaishnav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 1, "closed_date": 1440557984, "answer_count": 0, "score": 0, "last_activity_date": 1440557519, "creation_date": 1440557519, "question_id": 32217256, "link": "https://stackoverflow.com/questions/32217256/are-there-any-solution-for-select-from-in-golang-sql-drivers", "closed_reason": "Duplicate", "title": "Are there any solution for SELECT * FROM in golang SQL drivers", "body": "<p>I tried googling a lot &amp; also looked at stackoverflow and to my surprise none has raised this question.</p>\n\n<p>Is there a way to convert the output of SQL SELECT statement's (especially <code>SELECT * FROM</code>) result into an array or some kind of map to be utilized in the code.</p>\n\n<p>E.g., <code>SELECT * FROM table1</code>, without really knowing the fields can we scan and get an array / map?</p>\n\n<p>What is possible &amp; I know is, e.g., <code>SELECT name, age FROM table1</code> &amp; using the below statements will retrieve <code>name</code> &amp; <code>age</code>.</p>\n\n<pre><code>temp_result, _ :=db.Query('SELECT name, age FROM table1')\nfor temp_result.Next() {\n    m_name, m_age := \"\", \"\"\n    err := result.Scan(&amp;m_name, &amp;m_age)\n    if err != nil {\n       log.Fatal(err)\n    }\n    fmt.Println(m_name, m_age)\n}\n</code></pre>\n\n<p>Or any other alternatives to handle this ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 2020214, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/EvyEn.jpg?s=128&g=1", "display_name": "shackra", "link": "https://stackoverflow.com/users/2020214/shackra"}, "edited": false, "score": 1, "creation_date": 1570920276, "post_id": 32217273, "comment_id": 103070812, "body": "the live code example provided currently does not work"}], "tags": [], "owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "is_accepted": true, "score": 3, "last_activity_date": 1440558141, "last_edit_date": 1440558141, "creation_date": 1440557657, "answer_id": 32217273, "question_id": 32217169, "link": "https://stackoverflow.com/questions/32217169/how-to-get-array-in-http-request/32217273#32217273", "title": "How to get array in http request", "body": "<p>Use the <a href=\"https://golang.org/pkg/net/url/\" rel=\"nofollow\">net/url</a> package</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/url\"\n)\n\nfunc main() {\n    utmp := \"GET http://localhost:8080/path?my_key%5B%5D=3&amp;my_key%5B%5D=4&amp;my_key%5B%5D=5\"\n    u, err := url.Parse(utmp)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(u.Query()[\"my_key[]\"])\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/8aQ00qaa9j\" rel=\"nofollow\">http://play.golang.org/p/8aQ00qaa9j</a></p>\n\n<p>Your key is <code>\"my_key[]\"</code> not <code>\"my_key\"</code></p>\n"}], "owner": {"reputation": 2879, "user_id": 4335588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gNlDI.jpg?s=128&g=1", "display_name": "Thellimist", "link": "https://stackoverflow.com/users/4335588/thellimist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2277, "favorite_count": 0, "accepted_answer_id": 32217273, "answer_count": 1, "score": 0, "last_activity_date": 1440565518, "creation_date": 1440557063, "last_edit_date": 1440565518, "question_id": 32217169, "link": "https://stackoverflow.com/questions/32217169/how-to-get-array-in-http-request", "title": "How to get array in http request", "body": "<p>For this request <code>GET http://localhost:8080/path?my_key%5B%5D=3&amp;my_key%5B%5D=4&amp;my_key%5B%5D=5</code></p>\n\n<p>I can't get the data from <code>my_key</code>. I tried <code>req.URL.Query()[\"my_key\"]</code>. I can get it if I change the request encoding to from <code>my_key%5B%5D=4&amp;my_key%5B%5D=5</code> to <code>my_key=4&amp;my_key=5</code></p>\n\n<p>How can I get request URL's in form of <code>my_key[]=value</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 1, "creation_date": 1440581966, "post_id": 32217055, "comment_id": 52328783, "body": "besides: using reflect in (the) loop will dramatically drop performance. From &quot;laws of reflection&quot; (<a href=\"http://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">blog.golang.org/laws-of-reflection</a>):  &#39;&#39;It&#39;s a powerful tool that should be used with care and avoided unless strictly necessary.&#39;&#39;"}, {"owner": {"reputation": 956, "user_id": 1667207, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/w3ttm.jpg?s=128&g=1", "display_name": "verygoodsoftwarenotvirus", "link": "https://stackoverflow.com/users/1667207/verygoodsoftwarenotvirus"}, "reply_to_user": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1440604533, "post_id": 32217055, "comment_id": 52345045, "body": "I was only using reflect to try and figure out what variable type I was working with, that obviously wouldn&#39;t have been left in production code."}], "tags": [], "owner": {"reputation": 956, "user_id": 1667207, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/w3ttm.jpg?s=128&g=1", "display_name": "verygoodsoftwarenotvirus", "link": "https://stackoverflow.com/users/1667207/verygoodsoftwarenotvirus"}, "is_accepted": false, "score": 1, "last_activity_date": 1440556289, "creation_date": 1440556289, "answer_id": 32217055, "question_id": 32216985, "link": "https://stackoverflow.com/questions/32216985/how-to-access-ycbcr-color-attributes-in-go/32217055#32217055", "title": "How to access YCbCr color attributes in Go", "body": "<p>It turns out the method I needed was <code>img.At(x, y).RGBA()</code>, this returns those values respectively.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1440604092, "creation_date": 1440604092, "answer_id": 32231151, "question_id": 32216985, "link": "https://stackoverflow.com/questions/32216985/how-to-access-ycbcr-color-attributes-in-go/32231151#32231151", "title": "How to access YCbCr color attributes in Go", "body": "<p>Adding this for future reference, but to access the underling <code>color.YCbCr</code> you just need to type assert the value, example:</p>\n\n<pre><code>for y := bounds.Min.Y; y &lt; bounds.Max.Y; y++ {\n    for x := bounds.Min.X; x &lt; bounds.Max.X; x++ {\n        if c, ok := img.At(x, y).(color.YCbCr); ok {\n            fmt.Println(c.Y, c.Cb, c.Cr)\n        } else {\n            fmt.Println(reflect.TypeOf(img.At(x, y)))\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 956, "user_id": 1667207, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/w3ttm.jpg?s=128&g=1", "display_name": "verygoodsoftwarenotvirus", "link": "https://stackoverflow.com/users/1667207/verygoodsoftwarenotvirus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1440604092, "creation_date": 1440555687, "question_id": 32216985, "link": "https://stackoverflow.com/questions/32216985/how-to-access-ycbcr-color-attributes-in-go", "title": "How to access YCbCr color attributes in Go", "body": "<p>I'm iterating over an image's pixels trying to get the individual color values and average them out. When I do this:</p>\n\n<pre><code>bounds := img.Bounds()\n\nfor y := bounds.Min.Y; y &lt; bounds.Max.Y; y++ {\n  for x := bounds.Min.X; x &lt; bounds.Max.X; x++ {\n    fmt.Println(reflect.TypeOf(img.At(x, y)))     \n  }\n}\n</code></pre>\n\n<p>I get <code>color.YCbCr</code> a billion times. If I print it without <code>reflect.TypeOf</code>, I get a result like this:</p>\n\n<pre><code>{154 135 124}   \n{153 135 124}   \n{152 135 124}   \n{152 135 124}   \n{151 135 124}   \n{149 135 124}   \n{147 135 124}   \n</code></pre>\n\n<p>I need to be able to access the individual Y, Cb and Cr colors, but when I try <code>img.At(x, y).Cb</code> or <code>img.At(x, y)['Y']</code> or even <code>img.At(x, y)[0]</code>, I get various compile-time errors telling me that <code>color.Color</code> doesn't have those methods or doesn't support indexing.</p>\n"}, {"tags": ["eclipse", "go"], "comments": [{"owner": {"reputation": 91778, "user_id": 354577, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dI6cA.jpg?s=128&g=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/354577/chris"}, "edited": false, "score": 3, "creation_date": 1440555570, "post_id": 32216448, "comment_id": 52317581, "body": "&quot;\u2026I just get errors&quot;. This isn&#39;t helpful. Please edit your question and add the <i>exact</i> error messages you receive."}, {"owner": {"reputation": 40596, "user_id": 1677912, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/craWj.png?s=128&g=1", "display_name": "Mogsdad", "link": "https://stackoverflow.com/users/1677912/mogsdad"}, "edited": false, "score": 1, "creation_date": 1440561890, "post_id": 32216448, "comment_id": 52318976, "body": "Welcome to Stack Overflow! The tags you chose are not appropriate for this question. Please review <a href=\"//stackoverflow.com/help/tagging\">What are tags, and how should I use them?</a> The &quot;source&quot; tag specifically shouts &quot;DON&#39;T USE THIS TAG&quot;."}, {"owner": {"reputation": 12051, "user_id": 656243, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/3afyW.png?s=128&g=1", "display_name": "Lynn Crumbling", "link": "https://stackoverflow.com/users/656243/lynn-crumbling"}, "edited": false, "score": 2, "creation_date": 1440561990, "post_id": 32216448, "comment_id": 52318997, "body": "I&#39;m voting to close this question as off-topic because Stack Overflow is not for requests-to-compile an application."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 1, "last_activity_date": 1440648201, "creation_date": 1440648201, "answer_id": 32240494, "question_id": 32216448, "link": "https://stackoverflow.com/questions/32216448/cant-compile-install-plugin-on-windows/32240494#32240494", "title": "Cant compile/install plugin on Windows", "body": "<p>The errors you are seeing are because the code is broken. </p>\n\n<pre><code>src\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:54: cannot use client (type *http.Client) as type *rbxweb.Client in argument to asset.Upload\nsrc\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:54: assignment count mismatch: 3 = 2\nsrc\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:70: undefined: rbxweb.DoRawPost\nsrc\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:97: cannot use client (type *http.Client) as type *rbxweb.Client in argument to asset.Upload\nsrc\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:97: assignment count mismatch: 3 = 2\nsrc\\github.com\\anaminus\\rbxplugin\\rbxplugin.go:111: undefined: rbxweb.Login\n</code></pre>\n\n<p>You will either need to get the project owner to fix these compilation errors or fork the project and fix them yourself.</p>\n\n<p>Not every project on github is guaranteed to actually work.</p>\n"}], "owner": {"reputation": 11, "user_id": 5266492, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-KWHYuXPL_DE/AAAAAAAAAAI/AAAAAAAAACA/0iRL__pSsqY/photo.jpg?sz=128", "display_name": "Nyanodesu chu", "link": "https://stackoverflow.com/users/5266492/nyanodesu-chu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1441570665, "answer_count": 1, "score": -1, "last_activity_date": 1440768746, "creation_date": 1440551311, "last_edit_date": 1440768746, "question_id": 32216448, "link": "https://stackoverflow.com/questions/32216448/cant-compile-install-plugin-on-windows", "closed_reason": "Needs details or clarity", "title": "Cant compile/install plugin on Windows", "body": "<p>I've been trying to install this, I installed go, and also git, but when I follow the instructions to write:</p>\n\n<pre><code>go get github.com/anaminus/rbxplugin\ngo install github.com/anaminus/rbxplugin\n</code></pre>\n\n<p>into CMD I just get errors.</p>\n\n<p>Is there any way someone can compile this for me into an exe or something so I can use it? </p>\n\n<p>It wont compile with eclipse either. I have tried this on git, and also set my Gitroot and project location, it still wont install it. </p>\n\n<p>This is the <a href=\"http://github.com/anaminus/rbxplugin\" rel=\"nofollow\">github project</a>. I am trying to compile : </p>\n"}, {"tags": ["c", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440546804, "post_id": 32215509, "comment_id": 52315551, "body": "Are you exporting via cgo? The document you link to says: &quot;The only callable symbols will be those marked as exported (by any package), as described in the <a href=\"https://golang.org/cmd/cgo/#hdr-C_references_to_Go\" rel=\"nofollow noreferrer\">cgo documentation</a>.&quot; That link to the cgo documentation mentions a generated <code>_cgo_export.h</code>."}, {"owner": {"reputation": 8256, "user_id": 937324, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/5sD0l.jpg?s=128&g=1", "display_name": "Gabriel Southern", "link": "https://stackoverflow.com/users/937324/gabriel-southern"}, "edited": false, "score": 1, "creation_date": 1440546948, "post_id": 32215509, "comment_id": 52315593, "body": "An earlier question said the answer is no.  I&#39;d be curious if anything has changed in 1.5, but I doubt it: <a href=\"http://stackoverflow.com/questions/6125683/call-go-functions-from-c\" title=\"call go functions from c\">stackoverflow.com/questions/6125683/call-go-functions-from-c</a>"}, {"owner": {"reputation": 1338, "user_id": 1772510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/507de10a282f571a93a2ad2193b5b9e0?s=128&d=identicon&r=PG", "display_name": "dreadiscool", "link": "https://stackoverflow.com/users/1772510/dreadiscool"}, "edited": false, "score": 2, "creation_date": 1440551244, "post_id": 32215509, "comment_id": 52316636, "body": "The reason I mentioned Go 1.5 was because that document specifically mentions being able to create shared object files or archive files that can be called by systems that don&#39;t expect Go code  It&#39;s marked under the section called &quot;Go code linked into, and called from, a non-Go program&quot; in this link <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/edit?pli=1#heading=h.1gw5ytjfcoke\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440553625, "post_id": 32215509, "comment_id": 52317174, "body": "Dave C&#39;s on the trail--<a href=\"https://blog.filippo.io/building-python-modules-with-go-1-5/\" rel=\"nofollow noreferrer\">blog.filippo.io/building-python-modules-with-go-1-5</a> has more (in the context of connecting Go to Python via <code>c-shared</code> archive and <code>cgo</code> exports), but I don&#39;t have the time to piece that into a coherent answer right now. It does seem that you can use Go from C now, though."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440609663, "post_id": 32215509, "comment_id": 52348097, "body": "I mentioned cgo <b>not</b> as a way to interact with C code, but as the way you need to <b>mark</b> which functions you wish to be exported and callable from C (basically just a <code>&#47;&#47;export \u2026</code> comment). As my comment mentions, this is described in the exact document linked to."}], "answers": [{"comments": [{"owner": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 0, "creation_date": 1476590719, "post_id": 32217287, "comment_id": 67407175, "body": "misc question: is there any way to get this to work when cross-compiling for windows from OSX? this part will fail: <code>GOOS=windows GOARCH=amd64 go build -buildmode=c-archive foo.go</code>"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 2366, "user_id": 3160967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/1d5285da7116b41a824dd9cf0e77e4ea?s=128&d=identicon&r=PG", "display_name": "mwag", "link": "https://stackoverflow.com/users/3160967/mwag"}, "edited": false, "score": 1, "creation_date": 1476695612, "post_id": 32217287, "comment_id": 67437630, "body": "IIRC, CGo gets disabled by default when cross-building.  You can re-enable it with <code>CGO_ENABLED=1</code>, but you&#39;ll also need to provide C/C++ compilers for the target arch with <code>CC_FOR_TARGET</code> and <code>CXX_FOR_TARGET</code> as described in <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">golang.org/cmd/cgo</a>.  I don&#39;t have specific advice for building for Windows on OSX though."}, {"owner": {"reputation": 4123, "user_id": 195787, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b9620cb172292493f9c02c8f37c6cc7?s=128&d=identicon&r=PG", "display_name": "Royi", "link": "https://stackoverflow.com/users/195787/royi"}, "edited": false, "score": 0, "creation_date": 1618748281, "post_id": 32217287, "comment_id": 118690545, "body": "How would you do it on Windows? Especially what would be the replacement for <code>pthread</code>?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 4123, "user_id": 195787, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4b9620cb172292493f9c02c8f37c6cc7?s=128&d=identicon&r=PG", "display_name": "Royi", "link": "https://stackoverflow.com/users/195787/royi"}, "edited": false, "score": 0, "creation_date": 1618847079, "post_id": 32217287, "comment_id": 118720568, "body": "@Royi: It&#39;s ages since I&#39;ve developed for Windows.  If you wouldn&#39;t normally need a special compiler flag to build a C program that uses threads, then odds are you don&#39;t need to do anything special here either."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 59, "last_activity_date": 1470141708, "last_edit_date": 1470141708, "creation_date": 1440557788, "answer_id": 32217287, "question_id": 32215509, "link": "https://stackoverflow.com/questions/32215509/using-go-code-in-an-existing-c-project/32217287#32217287", "title": "Using Go code in an existing C project", "body": "<p>To build an archive callable from C, you will need to mark them as exported CGo symbols.<br>\nFor example, if I create a file <code>foo.go</code> with the following contents:</p>\n\n<pre><code>package main\n\nimport (\n    \"C\"\n    \"fmt\"\n)\n\n//export PrintInt\nfunc PrintInt(x int) {\n    fmt.Println(x)\n}\n\nfunc main() {}\n</code></pre>\n\n<p>The important things to note are:</p>\n\n<ul>\n<li>The package needs to be called <code>main</code></li>\n<li>You need to have a <code>main</code> function, although it can be empty.</li>\n<li>You need to import the package <code>C</code></li>\n<li>You need special <code>//export</code> comments to mark the functions you want callable from C.</li>\n</ul>\n\n<p>I can compile it as a C callable static library with the following command:</p>\n\n<pre><code>go build -buildmode=c-archive foo.go\n</code></pre>\n\n<p>The results will be an archive <code>foo.a</code> and a header <code>foo.h</code>.  In the header, we get the following (eliding irrelevant parts):</p>\n\n<pre><code>...\ntypedef long long GoInt64;\n...\ntypedef GoInt64 GoInt;\n...\nextern void PrintInt(GoInt p0);\n...\n</code></pre>\n\n<p>So that's enough to call the exported function.  We can write a simple C program that calls it like so:</p>\n\n<pre><code>#include \"foo.h\"\n\nint main(int argc, char **argv) {\n    PrintInt(42);\n    return 0;\n}\n</code></pre>\n\n<p>We can compile it with a command like:</p>\n\n<pre><code>gcc -pthread foo.c foo.a -o foo\n</code></pre>\n\n<p>The <code>-pthread</code> option is needed because the Go runtime makes use of threads.  When I run the resulting executable it prints <code>42</code>.</p>\n"}], "owner": {"reputation": 1338, "user_id": 1772510, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/507de10a282f571a93a2ad2193b5b9e0?s=128&d=identicon&r=PG", "display_name": "dreadiscool", "link": "https://stackoverflow.com/users/1772510/dreadiscool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7946, "favorite_count": 29, "accepted_answer_id": 32217287, "answer_count": 1, "score": 38, "last_activity_date": 1470141708, "creation_date": 1440543890, "last_edit_date": 1440551345, "question_id": 32215509, "link": "https://stackoverflow.com/questions/32215509/using-go-code-in-an-existing-c-project", "title": "Using Go code in an existing C project", "body": "<p>Ever since Go 1.5 came out, I started taking another look at how I could integrate it into an existing project of mine.</p>\n\n<p>The project's codebase is written entirely in C for low level access to to hardware and other fun stuff. However, some of the higher level things are tedious, and I would like to start writing them in a higher level language (Go)</p>\n\n<p>Is there any way I can call Go code from a C program? I installed Go 1.5, which added <code>-buildmode=c-archive</code> (<a href=\"https://golang.org/s/execmodes\">https://golang.org/s/execmodes</a>) which I am trying to get working.</p>\n\n<p>However, I can't seem to get Go to generate the appropriate header files to allow my project to actually compile. When I generate the archive, I see the function in the exported symbols (using objdump), but without the header files to include gcc complains about the function not existing (as expected)</p>\n\n<p>I'm quite new to Go - however, I love the language and would like to make use of it. Is there any idiomatic way (\"idiomatic\" gets used a lot in the world of Go I see...) to get this to play nicely with each other?</p>\n\n<p>The reason I asked this question and specifically mentioned Go 1.5 is that according to this document, <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/edit?pli=1#heading=h.1gw5ytjfcoke\">https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/edit?pli=1#heading=h.1gw5ytjfcoke</a>\nGo 1.5 added support for non-Go programs to call Go code. Specifically, mentioned under the section \"Go code linked into, and called from, a non-Go program\"</p>\n"}, {"tags": ["go", "jpeg"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 7, "last_activity_date": 1440534034, "creation_date": 1440534034, "answer_id": 32213335, "question_id": 32213093, "link": "https://stackoverflow.com/questions/32213093/golang-how-do-you-crop-a-circular-image-out-of-a-rectangular-jpeg/32213335#32213335", "title": "Golang how do you crop a circular image out of a rectangular jpeg.", "body": "<p>This example using the drawing package from the golang blog should do roughly what you want;</p>\n\n<pre><code>type circle struct {\n    p image.Point\n    r int\n}\n\nfunc (c *circle) ColorModel() color.Model {\n    return color.AlphaModel\n}\n\nfunc (c *circle) Bounds() image.Rectangle {\n    return image.Rect(c.p.X-c.r, c.p.Y-c.r, c.p.X+c.r, c.p.Y+c.r)\n}\n\nfunc (c *circle) At(x, y int) color.Color {\n    xx, yy, rr := float64(x-c.p.X)+0.5, float64(y-c.p.Y)+0.5, float64(c.r)\n    if xx*xx+yy*yy &lt; rr*rr {\n        return color.Alpha{255}\n    }\n    return color.Alpha{0}\n}\n\n    draw.DrawMask(dst, dst.Bounds(), src, image.ZP, &amp;circle{p, r}, image.ZP, draw.Over)\n</code></pre>\n\n<p>Note that it takes a rectangle and masks everything but the circle beginning at point <code>p</code> with radius <code>r</code>. The full article can be found here <a href=\"http://blog.golang.org/go-imagedraw-package\" rel=\"noreferrer\">http://blog.golang.org/go-imagedraw-package</a></p>\n\n<p>In your case you would like the mask to just be your normal background and the src to be the currently rectangular image you'd like to use part of.</p>\n"}], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1728, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1440534034, "creation_date": 1440533160, "question_id": 32213093, "link": "https://stackoverflow.com/questions/32213093/golang-how-do-you-crop-a-circular-image-out-of-a-rectangular-jpeg", "title": "Golang how do you crop a circular image out of a rectangular jpeg.", "body": "<p>In Golang how do you crop a circular image out of a rectangular jpeg. The rectangle can vary in size. If you have an image.Image would you crop out a circle from the center of the image where the circle takes up as much space as possible? I want to keep the circle and remove the rest.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1440524728, "post_id": 32210655, "comment_id": 52305151, "body": "Go <i>cannot</i> detect any deadlock at compile time, and only a specific case as runtime. The second point is probably incorrect too, but the wording is imprecise. Many goroutines can access send and receive operations on a single goroutine."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440525661, "post_id": 32210655, "comment_id": 52305711, "body": "oops, that last &quot;goroutine&quot; was supposed to be &quot;channel&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1440524797, "creation_date": 1440524797, "answer_id": 32210736, "question_id": 32210655, "link": "https://stackoverflow.com/questions/32210655/key-reasons-for-golang-to-make-concurrency-easier/32210736#32210736", "title": "Key reasons for golang to make concurrency easier", "body": "<p>No, the first is completely wrong and the second is at least stated unclear or strange.</p>\n"}, {"comments": [{"owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "edited": false, "score": 0, "creation_date": 1440526146, "post_id": 32210745, "comment_id": 52305987, "body": "Yes, a <code>chan</code> is just like a <code>queue</code> but its concurrent access is scheduled  by not <code>app</code> but <code>go</code> ."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1440525261, "last_edit_date": 1440525261, "creation_date": 1440524818, "answer_id": 32210745, "question_id": 32210655, "link": "https://stackoverflow.com/questions/32210655/key-reasons-for-golang-to-make-concurrency-easier/32210745#32210745", "title": "Key reasons for golang to make concurrency easier", "body": "<p>I wouldn't say that's accurate. On the first point there aren't any compile time guarantees about dead locking, if you use a mutex poorly you will be dead locking, no compiler can prevent that. You can test for race conditions easily, but that's different.</p>\n\n<p>On the second point, the channel serializes your asynchronous operations but I don't think how you state it makes much sense. A bunch of goroutines can be writing to and reading from it. It's just like a queue to put the data in, no coordination is guaranteed. You won't panic due to multiple routines reading off it or writing to it at the same time but if you have that happening Go isn't doing anything to make your program work well, you have to coordinate the routines yourself using channels. </p>\n"}, {"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1440532262, "post_id": 32211689, "comment_id": 52309510, "body": "At <i>runtime</i>, not compile time as stated by the OP."}], "tags": [], "owner": {"reputation": 83, "user_id": 1625844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a567417e9185fca9bc3cced9e8102d7?s=128&d=identicon&r=PG", "display_name": "Dave Rose", "link": "https://stackoverflow.com/users/1625844/dave-rose"}, "is_accepted": false, "score": -2, "last_activity_date": 1440528168, "creation_date": 1440528168, "answer_id": 32211689, "question_id": 32210655, "link": "https://stackoverflow.com/questions/32210655/key-reasons-for-golang-to-make-concurrency-easier/32211689#32211689", "title": "Key reasons for golang to make concurrency easier", "body": "<p>According to this tutorial, it can catch some deadlocks. I've not gone though this tutorial though... </p>\n\n<p><a href=\"http://guzalexander.com/2013/12/06/golang-channels-tutorial.html\" rel=\"nofollow\">http://guzalexander.com/2013/12/06/golang-channels-tutorial.html</a><a href=\"http://guzalexander.com/2013/12/06/golang-channels-tutorial.html\" rel=\"nofollow\">enter link description here</a></p>\n"}], "owner": {"reputation": 7193, "user_id": 363663, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c59cd40f0edcd3feea80c7ca09bc8e76?s=128&d=identicon&r=PG", "display_name": "sof", "link": "https://stackoverflow.com/users/363663/sof"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "closed_date": 1442923921, "answer_count": 3, "score": -1, "last_activity_date": 1483433450, "creation_date": 1440524536, "last_edit_date": 1483433450, "question_id": 32210655, "link": "https://stackoverflow.com/questions/32210655/key-reasons-for-golang-to-make-concurrency-easier", "closed_reason": "Needs more focus", "title": "Key reasons for golang to make concurrency easier", "body": "<p>Is my understanding roughly right below?</p>\n\n<ul>\n<li><p><code>go</code> can <em>mostly</em> detect <code>dead lock</code> at compile-time.</p></li>\n<li><p>That <code>go</code> can use <code>chan</code> to minimize <code>race condition</code> is because only single sender or receiver <code>goroutine</code> can have access to any specific <code>chan</code> at a time.</p></li>\n</ul>\n"}, {"tags": ["linux", "go", "process", "systemd"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440519643, "post_id": 32208782, "comment_id": 52302257, "body": "SystemD probably kills everything in the process group (or cgroup, I haven&#39;t looked at the systemd setup in a while). Are you actually trying to emulate daemon behavior, or is this just for an example?"}, {"owner": {"reputation": 501, "user_id": 5265057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18279bf7f94658a5f0f50eb748ac9ac?s=128&d=identicon&r=PG&f=1", "display_name": "monkey snow", "link": "https://stackoverflow.com/users/5265057/monkey-snow"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440520364, "post_id": 32208782, "comment_id": 52302658, "body": "@JimB: My actual code spawns child processes that run ffmpeg. I&#39;m basically using the pattern above to emulate daemon behavior, yes."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440520860, "post_id": 32208782, "comment_id": 52302948, "body": "Why not leave the parent running, and let systemd manage it normally? I think there might be a way to spawn the child and notify system of the new process, but the former would be much easier."}, {"owner": {"reputation": 501, "user_id": 5265057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18279bf7f94658a5f0f50eb748ac9ac?s=128&d=identicon&r=PG&f=1", "display_name": "monkey snow", "link": "https://stackoverflow.com/users/5265057/monkey-snow"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440521653, "post_id": 32208782, "comment_id": 52303391, "body": "@JimB: The child processes are expensive to restart, so they must not die when main process is restarted or crashes. However, thanks to your cgroup hint I found that the solution is to say <code>KillMode=process</code> (defaults to  <code>control-group</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 3, "creation_date": 1468978296, "post_id": 32209842, "comment_id": 64345611, "body": "Would there be a way to move the process out of the group instead?"}, {"owner": {"reputation": 1223, "user_id": 4518057, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/VKFF6.jpg?s=128&g=1", "display_name": "DonutGaz", "link": "https://stackoverflow.com/users/4518057/donutgaz"}, "edited": false, "score": 0, "creation_date": 1553111380, "post_id": 32209842, "comment_id": 97269196, "body": "This saved me. Thank you."}, {"owner": {"reputation": 1076, "user_id": 1657933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e5eececad35acb02c5bf5221eda8c0?s=128&d=identicon&r=PG", "display_name": "rien333", "link": "https://stackoverflow.com/users/1657933/rien333"}, "edited": false, "score": 0, "creation_date": 1602003637, "post_id": 32209842, "comment_id": 113580019, "body": "Today, the manual tells us that &quot;If set to &#39;process&#39;, only the main process itself is killed <b>(not recommended!)</b>&quot;. Any idea why this is discouraged?"}], "tags": [], "owner": {"reputation": 501, "user_id": 5265057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18279bf7f94658a5f0f50eb748ac9ac?s=128&d=identicon&r=PG&f=1", "display_name": "monkey snow", "link": "https://stackoverflow.com/users/5265057/monkey-snow"}, "is_accepted": true, "score": 33, "last_activity_date": 1440521824, "creation_date": 1440521824, "answer_id": 32209842, "question_id": 32208782, "link": "https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd/32209842#32209842", "title": "Can&#39;t detach child process when main process is started from systemd", "body": "<p>Solution is to add</p>\n\n<pre><code>KillMode=process\n</code></pre>\n\n<p>to the service block. Default value is <code>control-group</code> which means systemd cleans up any child processes.</p>\n\n<p>From <a href=\"http://www.freedesktop.org/software/systemd/man/systemd.kill.html\" rel=\"noreferrer\">man systemd.kill</a></p>\n\n<blockquote>\n  <p>KillMode= Specifies how processes of this unit shall be killed. One of\n  control-group, process, mixed, none.</p>\n  \n  <p>If set to control-group, all remaining processes in the control group\n  of this unit will be killed on unit stop (for services: after the stop\n  command is executed, as configured with ExecStop=). If set to process,\n  only the main process itself is killed. If set to mixed, the SIGTERM\n  signal (see below) is sent to the main process while the subsequent\n  SIGKILL signal (see below) is sent to all remaining processes of the\n  unit's control group. If set to none, no process is killed. In this\n  case, only the stop command will be executed on unit stop, but no\n  process be killed otherwise. Processes remaining alive after stop are\n  left in their control group and the control group continues to exist\n  after stop unless it is empty.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3237, "user_id": 1470436, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/3763046d63dc53080092f70c0828bbd6?s=128&d=identicon&r=PG", "display_name": "Beto Neto", "link": "https://stackoverflow.com/users/1470436/beto-neto"}, "is_accepted": false, "score": 0, "last_activity_date": 1576603572, "creation_date": 1576603572, "answer_id": 59379246, "question_id": 32208782, "link": "https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd/59379246#59379246", "title": "Can&#39;t detach child process when main process is started from systemd", "body": "<p>If you cannot (like me) to change the <code>KillMode</code> of the service for some reason, you could try the <code>at</code> command (see <a href=\"https://linux.die.net/man/1/at\" rel=\"nofollow noreferrer\">man</a>).</p>\n\n<p>You can schedule your command to run 1 minute ahead. See an example:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code># this will remove all .tmp files from \"/path/\" in 1 minute ahead (this task will run once)\necho rm /path/*.tmp | at now + 1 minute\n</code></pre>\n"}], "owner": {"reputation": 501, "user_id": 5265057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18279bf7f94658a5f0f50eb748ac9ac?s=128&d=identicon&r=PG&f=1", "display_name": "monkey snow", "link": "https://stackoverflow.com/users/5265057/monkey-snow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8826, "favorite_count": 5, "accepted_answer_id": 32209842, "answer_count": 2, "score": 17, "last_activity_date": 1576603572, "creation_date": 1440518528, "last_edit_date": 1440519883, "question_id": 32208782, "link": "https://stackoverflow.com/questions/32208782/cant-detach-child-process-when-main-process-is-started-from-systemd", "title": "Can&#39;t detach child process when main process is started from systemd", "body": "<p>I want to spawn long-running child processes that survive when the main process restarts/dies. This works fine when running from the terminal:</p>\n\n<pre><code>$ cat exectest.go\npackage main\n\nimport (\n        \"log\"\n        \"os\"\n        \"os/exec\"\n        \"syscall\"\n        \"time\"\n)\n\nfunc main() {\n        if len(os.Args) == 2 &amp;&amp; os.Args[1] == \"child\" {\n                for {   \n                        time.Sleep(time.Second)\n                }\n        } else {\n                cmd := exec.Command(os.Args[0], \"child\")\n                cmd.SysProcAttr = &amp;syscall.SysProcAttr{Setsid: true}\n                log.Printf(\"child exited: %v\", cmd.Run())\n        }\n}\n$ go build\n$ ./exectest\n^Z\n[1]+  Stopped                 ./exectest\n$ bg\n[1]+ ./exectest &amp;\n$ ps -ef | grep exectest | grep -v grep | grep -v vim\nsnowm     7914  5650  0 23:44 pts/7    00:00:00 ./exectest\nsnowm     7916  7914  0 23:44 ?        00:00:00 ./exectest child\n$ kill -INT 7914 # kill parent process\n[1]+  Exit 2                  ./exectest\n$ ps -ef | grep exectest | grep -v grep | grep -v vim\nsnowm     7916     1  0 23:44 ?        00:00:00 ./exectest child\n</code></pre>\n\n<p>Note that the child process is still alive after parent process was killed. However, if I start the main process from systemd like this...</p>\n\n<pre><code>[snowm@localhost exectest]$ cat /etc/systemd/system/exectest.service \n[Unit]\nDescription=ExecTest\n\n[Service]                        \nType=simple\nExecStart=/home/snowm/src/exectest/exectest\nUser=snowm\n\n[Install]\nWantedBy=multi-user.target\n$ sudo systemctl enable exectest\nln -s '/etc/systemd/system/exectest.service' '/etc/systemd/system/multi-user.target.wants/exectest.service'\n$ sudo systemctl start exectest\n</code></pre>\n\n<p>... then the child also dies when I kill the main process:</p>\n\n<pre><code>$ ps -ef | grep exectest | grep -v grep | grep -v vim\nsnowm     8132     1  0 23:55 ?        00:00:00 /home/snowm/src/exectest/exectest\nsnowm     8134  8132  0 23:55 ?        00:00:00 /home/snowm/src/exectest/exectest child\n$ kill -INT 8132\n$ ps -ef | grep exectest | grep -v grep | grep -v vim\n$\n</code></pre>\n\n<p>How can I make the child survive?</p>\n\n<p>Running go version go1.4.2 linux/amd64 under CentOS Linux release 7.1.1503 (Core).</p>\n"}, {"tags": ["go", "constructor", "pass-by-value"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440518700, "post_id": 32208363, "comment_id": 52301673, "body": "If you pass the <code>*Gender</code> to some other code, it can change it. Not so with the <code>Gender</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1440519678, "post_id": 32208363, "comment_id": 52302275, "body": "Related/duplicate of: <a href=\"http://stackoverflow.com/questions/31932822/why-should-constructor-of-go-return-address\">Why should constructor of Go return address?</a>"}, {"owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "edited": false, "score": 0, "creation_date": 1440874304, "post_id": 32208363, "comment_id": 52456731, "body": "the question is not exactly the same and I think @Ainar-G answer is better than the accepted for that tentative duplicate"}, {"owner": {"reputation": 11, "user_id": 8952645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/550277b17a77b8506cdc20c3792c7fdd?s=128&d=identicon&r=PG&f=1", "display_name": "Anish Mathew", "link": "https://stackoverflow.com/users/8952645/anish-mathew"}, "edited": false, "score": 0, "creation_date": 1585091150, "post_id": 32208363, "comment_id": 107642904, "body": "link to where I had explained it <a href=\"https://stackoverflow.com/a/60840366/8952645\">stackoverflow.com/a/60840366/8952645</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 16, "last_activity_date": 1440519230, "creation_date": 1440519230, "answer_id": 32209021, "question_id": 32208363, "link": "https://stackoverflow.com/questions/32208363/returning-value-vs-pointer-in-go-constructor/32209021#32209021", "title": "returning value vs pointer in Go constructor", "body": "<p>The question is a really broad one, and it depends heavily on the rest of your API. So here are just some things you might need to consider when choosing one over another (in no particular order):</p>\n\n<ul>\n<li><p>Unnecessary pointers lead to more work for the GC. You might win some time by returning a pointer (one word) rather than a struct (zero to many words), but some of that time might later be consumed by the GC scan.</p></li>\n<li><p>Pointers can also signal presence or absence of a thing, although it's generally better to use comma-ok idiom for that, or return an error.</p></li>\n<li><p>Speaking of errors, if you return <code>nil</code> with an error, the chance that the error will be ignored is smaller (because nil pointer dereference will result in panic). Then again, I don't think people who ignore errors are something you should really take into account.</p></li>\n<li><p>If you need some form of tracking (for example, a possibility to inspect all instances ever created by your constructor), you have to return a pointer, so that all changes to the value would be visible to the inspector.</p></li>\n<li><p>If most of the type's methods have a pointer receiver, or most functions in the API accept pointers to the type rather than values, it's more ergonomic to return a pointer.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 4, "last_activity_date": 1440519704, "creation_date": 1440519704, "answer_id": 32209144, "question_id": 32208363, "link": "https://stackoverflow.com/questions/32208363/returning-value-vs-pointer-in-go-constructor/32209144#32209144", "title": "returning value vs pointer in Go constructor", "body": "<p>The first item returned is a value, the second is a pointer. The pointer works much like a pointer in C or C++ only the value it points to is garbage collected like in C# or Java. Go offers something of a compromise between those two paradigms. The pointer is explicit and exposed, however it's still garbage collected. Here are a few somewhat obvious differences;</p>\n\n<p>1) If you pass the value to a method or it is the receiver (which is often confusing) you will not be able to modify it's value, it will be a 'pass by value' like in the other languages where you are modifying a copy. Yes, even the method <code>func (g Gender) ChangeGender()</code> will not change the gender of the object you call it on. <a href=\"https://play.golang.org/\" rel=\"nofollow\">https://play.golang.org/</a></p>\n\n<p>2) You can only call methods defined for the type. For example if you have <code>g *Gender</code> and you want to call the <code>ChangeGender</code> method above you will not be able to without dereferencing your pointer, just like in C/C++. The opposite is true going in the opposite direction.</p>\n\n<p>3) The alternative to passing by value is by reference, you probably know how that works but in case you don't I'll explain. If you have a method <code>func (g *Gender) ModifyGender()</code> and an instance <code>g := &amp;Gender{}</code> then when calling <code>ModifyGender</code> a pointer of the OS' word size will get pushed onto the stack as an argument rather than the value itself and the method will use that address to modify the memory there, persisting changes when control returns to the caller. This can vastly improve performance if you have method which work on objects that have a large memory foot print.</p>\n\n<p>I'm not going to speak to performance. That should give you enough information to consider how it works in your application. </p>\n"}], "owner": {"reputation": 94522, "user_id": 7595, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/99108829176dfbbc5d0bf3c041542a26?s=128&d=identicon&r=PG", "display_name": "Pablo Fernandez", "link": "https://stackoverflow.com/users/7595/pablo-fernandez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4255, "favorite_count": 0, "accepted_answer_id": 32209021, "answer_count": 2, "score": 17, "last_activity_date": 1440525049, "creation_date": 1440517293, "last_edit_date": 1440525049, "question_id": 32208363, "link": "https://stackoverflow.com/questions/32208363/returning-value-vs-pointer-in-go-constructor", "title": "returning value vs pointer in Go constructor", "body": "<p>When building a simple object in go, what's the difference between these alternatives?</p>\n\n<pre><code>func NewGender(value string) Gender {\n    return Gender{strings.TrimSpace(value)}\n}\n\nfunc NewGender(value string) *Gender {\n    return &amp;Gender{strings.TrimSpace(value)}\n}\n</code></pre>\n"}, {"tags": ["javascript", "ajax", "file-upload", "go"], "answers": [{"comments": [{"owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "edited": false, "score": 0, "creation_date": 1440520126, "post_id": 32203015, "comment_id": 52302539, "body": "It was a Javascript error, not sending the attached content at all, I tested with the library you provided and it worked well"}], "tags": [], "owner": {"reputation": 1312, "user_id": 3932944, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Snr64.png?s=128&g=1", "display_name": "Muhammad Usman", "link": "https://stackoverflow.com/users/3932944/muhammad-usman"}, "is_accepted": true, "score": 1, "last_activity_date": 1440502753, "creation_date": 1440502753, "answer_id": 32203015, "question_id": 32202699, "link": "https://stackoverflow.com/questions/32202699/uploading-file-via-xmlhttprequest-generates-multipart-nextpart-eof/32203015#32203015", "title": "uploading file via xmlhttprequest generates multipart: NextPart: EOF", "body": "<p>For uploading you can use PlUploader <a href=\"http://www.plupload.com/example_queuewidget.php\" rel=\"nofollow\">Code example</a> (that is also used for large file uploading).</p>\n"}], "owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 32203015, "answer_count": 1, "score": 1, "last_activity_date": 1440502753, "creation_date": 1440501664, "question_id": 32202699, "link": "https://stackoverflow.com/questions/32202699/uploading-file-via-xmlhttprequest-generates-multipart-nextpart-eof", "title": "uploading file via xmlhttprequest generates multipart: NextPart: EOF", "body": "<p>I'm trying to upload a file via XMLHttpRequest, currently i'm using golang</p>\n\n<p>When I use CURL to test the upload everything goes fine, and the file is uploaded to Amazon S3 bucket, but when using Javascript I get the following error : <code>multipart: NextPart: EOF</code></p>\n\n<p>this is the JS part :</p>\n\n<pre><code>document.getElementById(\"attachment\").addEventListener(\"change\", function(e) {\n    var file = this.files[0];\n    var xhr = new XMLHttpRequest();\n    var formdata = new FormData();\n    formdata.append(\"attachment\", file);\n    boundary=Math.random().toString().substr(2);\n\n    xhr.onreadystatechange = function(e) {\n        if ( 4 == this.readyState ) {\n            console.log([\"xhr upload complete\", e]);\n        }\n    };\n    xhr.open(\"POST\", \"https://upload_host:8443/upload\", true);\n    xhr.setRequestHeader(\"Content-Type\",\"multipart/form-data; charset=utf-8; boundary=---------------------------\"+boundary+\";\");\n    xhr.send(formdata);\n}, false);\n</code></pre>\n\n<p>For the go handler :</p>\n\n<pre><code>func upload_handler(w http.ResponseWriter, r *http.Request, m render.Render) {\n  w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n  file, header, err := r.FormFile(\"C.Storage.FieldName\")\n  if err != nil {\n    // ERROR THROWN HERE\n    ServeHTTP(400, err.Error(), m)\n    return\n  }\n\n  content, err := ioutil.ReadAll(file)\n\n  if err != nil {\n    ServeHTTP(400, err.Error(), m)\n    return\n  }\n\n  fileSize, err := file.Seek(0, 2) //2 = from end\n  if err != nil {\n    ServeHTTP(400, err.Error(), m)\n    return\n  }\n\n  if fileSize &gt; int64(C.Storage.FileSize) {\n    ServeHTTP(400, \"File size limit exceeded\", m)\n    return\n  }\n\n  ftype := http.DetectContentType(content)\n\n  if !strings.Contains(C.Storage.AllowedMimes, ftype) {\n    ServeHTTP(400, \"File type not allowed\", m)\n    return\n  }\n\n  //FUNCTION TO UPLOAD TO AMAZON S3 \n\n  file.Close()\n}\n</code></pre>\n"}, {"tags": ["go", "cassandra", "google-compute-engine"], "comments": [{"owner": {"reputation": 10756, "user_id": 3618671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkWEF.png?s=128&g=1", "display_name": "Misha Brukman", "link": "https://stackoverflow.com/users/3618671/misha-brukman"}, "edited": false, "score": 0, "creation_date": 1440513053, "post_id": 32201384, "comment_id": 52297591, "body": "Your VM&#39;s operating system may have a firewall blocking access to port 9042, and GCE may also have a firewall rule blocking access. You need to open up access in both of these firewalls."}, {"owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "reply_to_user": {"reputation": 10756, "user_id": 3618671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkWEF.png?s=128&g=1", "display_name": "Misha Brukman", "link": "https://stackoverflow.com/users/3618671/misha-brukman"}, "edited": false, "score": 0, "creation_date": 1440516538, "post_id": 32201384, "comment_id": 52300214, "body": "@MishaBrukman , I have opened up the access the creating a new firewall rule , <code>tcp:1-65535</code> is the permission I&#39;ve given"}, {"owner": {"reputation": 10756, "user_id": 3618671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JkWEF.png?s=128&g=1", "display_name": "Misha Brukman", "link": "https://stackoverflow.com/users/3618671/misha-brukman"}, "edited": false, "score": 0, "creation_date": 1440519445, "post_id": 32201384, "comment_id": 52302130, "body": "I&#39;m not sure what else to do here to fix your issue, but please note that this is not a secure installation: you&#39;re giving access to your Cassandra database to the entire world, without access control. Ideally, it should only be accessible on the local private GCE network and the client should be running on GCE as well, and support some authentication / authorization mechanism itself."}], "answers": [{"tags": [], "owner": {"reputation": 3027, "user_id": 3895774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5RG68.png?s=128&g=1", "display_name": "Kamran", "link": "https://stackoverflow.com/users/3895774/kamran"}, "is_accepted": false, "score": 1, "last_activity_date": 1441289659, "last_edit_date": 1441289659, "creation_date": 1440622496, "answer_id": 32236535, "question_id": 32201384, "link": "https://stackoverflow.com/questions/32201384/issue-connecting-to-click-to-deploy-cassandra-instance/32236535#32236535", "title": "Issue connecting to Click to Deploy Cassandra instance", "body": "<p>You just need to open CQL native transport port <code>(tcp:9042)</code> on your GCE firewall to be able to connect to your cluster nodes remotely. You can use <code>telnet &lt;public ip&gt; 9042</code> command to test if the port is open and listening. Also make sure the outgoing traffics to the port <code>9042</code> is not blocked on your remote network/firewall. </p>\n\n<p>If the firewall is configured properly and you could telnet to the port but still receiving the mentioned error, then something is wrong with your gocql setup.</p>\n"}], "owner": {"reputation": 3234, "user_id": 2067919, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ee20c28be7254efecd50ce7a471b4876?s=128&d=identicon&r=PG", "display_name": "Karthic Rao", "link": "https://stackoverflow.com/users/2067919/karthic-rao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441289659, "creation_date": 1440497940, "last_edit_date": 1440499169, "question_id": 32201384, "link": "https://stackoverflow.com/questions/32201384/issue-connecting-to-click-to-deploy-cassandra-instance", "title": "Issue connecting to Click to Deploy Cassandra instance", "body": "<p>I'm trying to write data into Click To Deploy cassandra cluster using Golang <code>gocql</code> driver from a remote machine , But it fails to connect . </p>\n\n<p>Here is my cassandra.yaml configuration , </p>\n\n<pre><code>native_transport: true\nlisten_address: &lt;public ip&gt;\nbroadcast_address: &lt;public ip&gt;\nrpc_address: 0.0.0.0\nnative_transport_port : 9042\n</code></pre>\n\n<p>And here is the Golang Code using which I'm remotely trying to connect </p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/gocql/gocql\"\n)\n\nfunc main() {\n// connect to the cluster\n    cluster := gocql.NewCluster(&lt;public ip of cassandra nodes&gt;)\n\n    cluster.Keyspace = \"demo\"\n    session, _ := cluster.CreateSession()\n    defer session.Close()\n    if err := session.Query(\"INSERT INTO users (lastname, firstname) VALUES ('Karthic', 'Rao')\").Exec(); err != nil {\n    fmt.Printf(\"ERror writing : \", err.Error())\n    }\n}\n</code></pre>\n\n<p>Here is the error , \n<code>connect: failed to connect to \"&lt;public ip&gt;:9042\": dial tcp &lt;public ip&gt; :9042: i/o timeout</code></p>\n\n<p>Any idea on how to fix this to make i/o on the cassandra nodes ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "edited": false, "score": 0, "creation_date": 1441537710, "post_id": 32408806, "comment_id": 52711089, "body": "I actually want to parse the output of &quot;numactl -H&quot;, but I don&#39;t know where to start, can you help me with that?"}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "reply_to_user": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "edited": false, "score": 1, "creation_date": 1441561818, "post_id": 32408806, "comment_id": 52718262, "body": "I am afraid NUMA is beyond my knowledge at this point. It does appear that what you are looking for <i>may</i> reside in <code>&#47;sys&#47;devices&#47;system&#47;node&#47;node*</code> i.e. <code>&#47;sys&#47;devices&#47;system&#47;node&#47;node0&#47;numastat</code> and other locations under <code>&#47;sys&#47;devices&#47;system&#47;node&#47;node*</code>"}, {"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "edited": false, "score": 0, "creation_date": 1441562139, "post_id": 32408806, "comment_id": 52718345, "body": "Thanks for the response, I figured it out. :)"}], "tags": [], "owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "is_accepted": false, "score": 2, "last_activity_date": 1441418249, "creation_date": 1441418249, "answer_id": 32408806, "question_id": 32201338, "link": "https://stackoverflow.com/questions/32201338/how-to-find-the-cpu-topology-in-go-language/32408806#32408806", "title": "How to find the cpu topology in go language?", "body": "<p>Do you need it to be cross platform? You could parse /proc/cpuinfo on linux.</p>\n\n<p>This individual seems to have <a href=\"https://github.com/shirou/gopsutil/tree/master/cpu\" rel=\"nofollow\">a start on getting CPU</a> topology.</p>\n"}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441418249, "creation_date": 1440497802, "question_id": 32201338, "link": "https://stackoverflow.com/questions/32201338/how-to-find-the-cpu-topology-in-go-language", "title": "How to find the cpu topology in go language?", "body": "<p>So I want to use cpu topology in go language. By topology, I mean, NUMA topology. Is there any package out there to do that? Or may be, a package that returns cpu topology, and I can modify on top of that to return NUMA topology.</p>\n\n<p>TIA.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 1, "creation_date": 1440497413, "post_id": 32201177, "comment_id": 52286677, "body": "Ahhhhhh shoot. Completely overlooked that.... Thanks!! Can&#39;t accept for 7 mins but I will"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1440497379, "creation_date": 1440497379, "answer_id": 32201177, "question_id": 32201053, "link": "https://stackoverflow.com/questions/32201053/how-come-i-get-cannot-use-type-sql-row-as-type-error-when-doing-err-sql-errn/32201177#32201177", "title": "How come I get cannot use type *sql.Row as type error when doing err == sql.ErrNoRows", "body": "<p>You've missed the <code>Scan</code> part of the example, which actually returns an error:</p>\n\n<pre><code>err := db.QueryRow(\"SELECT ...\").Scan(&amp;id, &amp;secret, &amp;shortname)\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1228, "favorite_count": 0, "accepted_answer_id": 32201177, "answer_count": 1, "score": 2, "last_activity_date": 1440497379, "creation_date": 1440496982, "last_edit_date": 1495541677, "question_id": 32201053, "link": "https://stackoverflow.com/questions/32201053/how-come-i-get-cannot-use-type-sql-row-as-type-error-when-doing-err-sql-errn", "title": "How come I get cannot use type *sql.Row as type error when doing err == sql.ErrNoRows", "body": "<p>I was trying to follow the example in the answer given here:\n<a href=\"https://stackoverflow.com/questions/28034652/golang-how-to-check-for-empty-array-array-of-struct\">Golang: How to check for empty array (array of struct)</a></p>\n\n<p>on how to check if a database return is empty</p>\n\n<p>So I have this:</p>\n\n<pre><code>err = db.QueryRow(\"SELECT FROM accounts WHERE steamid=?\", steamid)\nswitch {\n        case err == sql.ErrNoRows:\n        case err != nil:\n        default:\n                //do stuff\n}\n</code></pre>\n\n<p>But I get the error:</p>\n\n<pre><code>cannot use db.QueryRow(\"SELECT FROM accounts WHERE steamid=?\", steamid) (type *sql.Row) as type error in assignment:\n    *sql.Row does not implement error (missing Error method)\n</code></pre>\n\n<p>Not sure why it worked in his example but not when I try to implement it. Thanks.</p>\n"}, {"tags": ["go", "erlang"], "answers": [{"tags": [], "owner": {"reputation": 11978, "user_id": 774651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d174682a9c2469488ac0cd91f0253215?s=128&d=identicon&r=PG&f=1", "display_name": "Lol4t0", "link": "https://stackoverflow.com/users/774651/lol4t0"}, "is_accepted": false, "score": 1, "last_activity_date": 1440503987, "creation_date": 1440503987, "answer_id": 32203450, "question_id": 32200352, "link": "https://stackoverflow.com/questions/32200352/buffer-size-in-erlang-golang-port-example/32203450#32203450", "title": "Buffer size in Erlang / Golang port example", "body": "<ol>\n<li>2^8 is 256, not 65536 which is 2^16 (or 2 bytes).</li>\n<li>For excluding golang program you can simply replace your <code>echo</code> with GNU <code>cat</code></li>\n<li>Default message max size for port communication is 64k, so when your port receives messages, the first one is leading 64k of the string. You can read port <em>again</em>  to gain remaining data but you just drop them in your code.</li>\n<li>If you really want to communicate on line-based protocol you should configure your port <a href=\"http://www.erlang.org/doc/man/erlang.html#open_port-2\" rel=\"nofollow\">accordingly</a>:</li>\n</ol>\n\n<blockquote>\n  <p><code>{line, L}</code> </p>\n  \n  <p>Messages are delivered on a per line basis. Each line\n  (delimited by the OS-dependent newline sequence) is delivered in one\n  single message. The message data format is {Flag, Line}, where Flag is\n  either eol or noeol and Line is the actual data delivered (without the\n  newline sequence).</p>\n  \n  <p><code>L</code> specifies the maximum line length in bytes. Lines longer than this\n  will be delivered in more than one message, with the Flag set to noeol\n  for all but the last message. If end of file is encountered anywhere\n  else than immediately following a newline sequence, the last line will\n  also be delivered with the Flag set to noeol. In all other cases,\n  lines are delivered with Flag set to eol.</p>\n  \n  <p>The <code>{packet, N}</code> and <code>{line, L}</code> settings are mutually exclusive.</p>\n</blockquote>\n\n<p>So your code would be </p>\n\n<pre><code>Port = open_port({spawn, ExtPrg}, [{line, ?PACKET_SIZE]),\n%%...\n{call, Caller, Msg} -&gt;\n    Port ! {self(), {command, Msg++?DELIMITER}},\n    D = read_data(Port, []),\n    Caller ! {myname, D},\n    loop(Port);\n%%...\nread_data(Port, Prefix) -&gt;\nreceive\n    {Port, {data, {noeol, Data}}} -&gt;\n        read_data(Port, Prefix ++ Data);\n    {Port, {data, {eol, Data}}} -&gt;\n        Prefix ++ Data\nend.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "edited": false, "score": 0, "creation_date": 1440513662, "post_id": 32203868, "comment_id": 52298069, "body": "Your <code>receice_all&#47;3</code> is O(N^2) due <code>Data ++ New</code>. It is not good practice."}], "tags": [], "owner": {"reputation": 15767, "user_id": 2457, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1cbf5f896e05660e2b78b1b89e9befd?s=128&d=identicon&r=PG", "display_name": "Adam Lindberg", "link": "https://stackoverflow.com/users/2457/adam-lindberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1440518415, "last_edit_date": 1440518415, "creation_date": 1440505209, "answer_id": 32203868, "question_id": 32200352, "link": "https://stackoverflow.com/questions/32200352/buffer-size-in-erlang-golang-port-example/32203868#32203868", "title": "Buffer size in Erlang / Golang port example", "body": "<p>If you use <code>start_link</code> instead, you'll see that the port crashes after the first command:</p>\n\n<pre class=\"lang-erlang prettyprint-override\"><code>1&gt; port:start('go run port.go').\n&lt;0.118.0&gt;\n2&gt; port:ping(65000).\n65000\n** exception error: port_terminated\n</code></pre>\n\n<p>If you change the Go code to run in a loop, this crash can be avoided:</p>\n\n<pre><code>func main() {\n    for {\n        // reader := bufio:NewReader(os.Stdin)\n        reader := bufio.NewReaderSize(os.Stdin, 1677216) // 2**24;\n        bytes, _ := reader.ReadBytes(Delimiter)\n        os.Stdout.Write(bytes[:len(bytes)-1])\n    }\n}\n</code></pre>\n\n<p>Now we can see another interesting result:</p>\n\n<pre class=\"lang-erlang prettyprint-override\"><code>33&gt; c(port).\n{ok,port}\n40&gt; port:ping(66000).\n65536\n41&gt; port:ping(66000).\n464\n42&gt; port:ping(66000).\n65536\n43&gt; port:ping(66000).\n464\n</code></pre>\n\n<p>Now we can see that no data is actually lost, it's just buffered in the port. Since you have not specified a framing protocol (using <code>{packet, N}</code> or <code>{line, N}</code> you are responsible yourself for collecting the data. It also seems that the internal buffer size of an Erlang port is 64K (although I found no documentation of this and no way to change it).</p>\n\n<p>If you change your receive to get all data before returning, you'll every byte each time:</p>\n\n<pre class=\"lang-erlang prettyprint-override\"><code>loop(Port) -&gt;\n    receive\n    {call, Caller, Msg} -&gt;\n        Port ! {self(), {command, Msg++?DELIMITER}},\n        Caller ! {myname, receive_all(Port, 10)},\n        loop(Port);\n    stop -&gt;\n        Port ! {self(), close},\n        receive\n        {Port, closed} -&gt;\n            exit(normal)\n        end;\n    {'EXIT', Port, _Reason} -&gt;\n        exit(port_terminated)\n    end.\n\nreceive_all(Port, Timeout) -&gt; receive_all(Port, Timeout, []).\n\nreceive_all(Port, Timeout, Data) -&gt;\n    receive\n    {Port, {data, New}} -&gt;\n        receive_all(Port, Timeout, [New|Data])\n    after Timeout -&gt;\n        lists:flatten(lists:reverse(Data))\n    end.\n</code></pre>\n\n<p>Running this, we get:</p>\n\n<pre class=\"lang-erlang prettyprint-override\"><code>1&gt; c(port).\n{ok,port}\n2&gt;\n3&gt; port:start('go run port.go').\n&lt;0.311.0&gt;\n4&gt; port:ping(66000).\n66000\n5&gt; port:ping(66000).\n66000\n6&gt; port:ping(66000).\n66000\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 867, "user_id": 330251, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/fbd229f15c2935bf8a389725088ce894?s=128&d=identicon&r=PG", "display_name": "Anton Prokofiev", "link": "https://stackoverflow.com/users/330251/anton-prokofiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1593524397, "creation_date": 1593524397, "answer_id": 62658796, "question_id": 32200352, "link": "https://stackoverflow.com/questions/32200352/buffer-size-in-erlang-golang-port-example/62658796#62658796", "title": "Buffer size in Erlang / Golang port example", "body": "<p>I have been struggling with the similar problem.\nHere the complete code of pipe module.</p>\n<p>It allows sent text data to port and read all replies.</p>\n<pre><code>-module(apr_pipe).\n\n-export([open_pipe/2,send/2,close/1]).\n\n-export([loop/1,status/1,init/1]).\n\n-include_lib(&quot;kernel/include/logger.hrl&quot;).\n\n-define(MAX_LINE_LEN,4096).\n\nopen_pipe(Path,Cmd) -&gt;\n   State = #{path =&gt; Path, cmd =&gt; Cmd},\n    Pid = spawn(?MODULE,init,[State]),\n    Pid.\n\ninit(State) -&gt;\n    #{path := Path,cmd := Cmd} = State,\n    FullFn = filename:join(Path,Cmd),\n    Settings = [{line,?MAX_LINE_LEN},use_stdio,stderr_to_stdout,hide,binary,exit_status],\n    Port = erlang:open_port({spawn_executable,FullFn},Settings),\n    State2 = State#{port =&gt; Port, data =&gt; #{}},\n    loop(State2).\n\n\nsend(Pid,Data)  -&gt; Pid!{self(),send,Data}.\nclose(Pid)      -&gt; Pid!{self(),send,close}.\nstatus(Pid)     -&gt; Pid!{self(),status}.\n\nget_eol() -&gt; &lt;&lt;&quot;\\n&quot;&gt;&gt;.\n\nloop(State) -&gt;\n    receive\n        {_Pid,send,close} -&gt; \n                    ?LOG(notice,&quot;got cmd: Close&quot;,[]),\n                    Port = maps:get(port,State),\n                    port_close(Port),\n                    exit(normal);\n        {Pid,send,Data} -&gt;\n                    ?LOG(notice,&quot;Send Data ...&quot;,[]),\n                    Port = maps:get(port,State),\n                    port_command(Port,Data),\n                    port_command(Port,get_eol()),\n                    State2 = State#{status =&gt; data_sent, client =&gt; Pid},\n                    loop(State2);\n         {Pid,status} -&gt; \n                    Port = maps:get(port,State),\n                    ?LOG(notice,&quot;Status: Port: ~p State: ~p&quot;,[Port,State]),\n                    Pid!{status,Port,State},\n                    loop(State);\n        % port messages.\n        {Port, {data,{noeol,Data}}} -&gt;\n                ?LOG(notice,&quot;Port: ~p Data: ~p&quot;,[Port,Data]),\n                CurData = maps:get(cur_data,State,[]),\n                State2 = State#{cur_data =&gt; [Data | CurData]},\n                loop(State2);\n\n        {Port, {data, {eol,Data}}} -&gt;\n                ?LOG(notice,&quot;Port: ~p Data: ~p&quot;,[Port,Data]),\n                CurData = [Data | maps:get(cur_data,State,[])],\n                CurData2 = lists:reverse(CurData),\n                Reply    = list_to_binary(CurData2),\n                Client = maps:get(client,State,undefined),\n                State2 = State#{cur_data =&gt; [], client =&gt; undefined},\n                case Client of\n                    undefined -&gt; ?LOG(error,&quot;can not sent reply. Client: ~p Reply: ~p&quot;, [Client,Reply]),\n                                 loop(State2);\n                    _ -&gt; Client!{reply,Reply},\n                         loop(State2)\n                 end;\n        {_Port, closed} -&gt;\n                ?LOG(warning, &quot;Port: ~p closed&quot;,[]),\n                exit(normal);\n        {'EXIT',  Port, Reason} -&gt;\n                 ?LOG(notice,&quot;Port: ~p exit. Reason: ~p&quot;,[Port,Reason]),\n                 exit(Reason);\n        _Other -&gt; ?LOG(error,&quot;unexpected message: ~p&quot;,[_Other]),\n                  exit({error,{unexpected_message,_Other}})\n    end.\n</code></pre>\n"}], "owner": {"reputation": 4183, "user_id": 124179, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/977471a7792cba5ccfbd569f77d805b8?s=128&d=identicon&r=PG", "display_name": "Justin", "link": "https://stackoverflow.com/users/124179/justin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 833, "favorite_count": 0, "accepted_answer_id": 32203868, "answer_count": 3, "score": 4, "last_activity_date": 1593524397, "creation_date": 1440494994, "last_edit_date": 1440499754, "question_id": 32200352, "link": "https://stackoverflow.com/questions/32200352/buffer-size-in-erlang-golang-port-example", "title": "Buffer size in Erlang / Golang port example", "body": "<p>I have a crude Erlang-to-Golang port example, passing data from Erlang to Golang and echoing the response. </p>\n\n<p>Problem is the amount of data I can transfer seems to be limited to 2^8 bytes (see below). I thought the problem was probably on the Golang side (not creating a big enough buffer) but replacing bufio.NewReader with bufio.NewReaderSize didn't work. So am now thinking the problem is maybe on the Erlang side.</p>\n\n<p>What do I need to do to increase the buffer size / be able to echo a message larger than 2^8 bytes ?</p>\n\n<p>TIA</p>\n\n<pre><code>justin@justin-ThinkPad-X240:~/work/erlang_golang_port$ erl -pa ebin\nErlang/OTP 17 [erts-6.4.1] [source] [64-bit] [smp:4:4] [async-threads:10] [kernel-poll:false]\n\nEshell V6.4.1  (abort with ^G)\n1&gt; port:start(\"./echo\").\n&lt;0.35.0&gt;\n2&gt; port:ping(65000).\n65000\n3&gt; port:ping(66000).\n** exception error: bad argument\n     in function  port:call_port/1 (port.erl, line 20)\n4&gt; port:start(\"./echo\").\n&lt;0.40.0&gt;\n5&gt; port:ping(66000).    \n65536\n</code></pre>\n\n<hr>\n\n<p><strong>Go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"os\"\n)\n\nconst Delimiter = '\\n'\n\nfunc main() {\n    // reader := bufio:NewReader(os.Stdin)\n    reader := bufio.NewReaderSize(os.Stdin, 1677216) // 2**24;\n    bytes, _ := reader.ReadBytes(Delimiter)\n    os.Stdout.Write(bytes[:len(bytes)-1])\n}\n</code></pre>\n\n<hr>\n\n<p><strong>Erlang</strong></p>\n\n<pre><code>-module(port).\n\n-export([start/1, stop/0, init/1]).\n\n-export([ping/1]).\n\n-define(DELIMITER, [10]).\n\nstart(ExtPrg) -&gt;\n    spawn(?MODULE, init, [ExtPrg]).\n\nstop() -&gt;\n    myname ! stop.\n\nping(N) -&gt;\n    Msg=[round(65+26*random:uniform()) || _ &lt;- lists:seq(1, N)],\n    call_port(Msg).\n\ncall_port(Msg) -&gt;\n    myname ! {call, self(), Msg},\n    receive\n    {myname, Result} -&gt;\n        length(Result)\n    end.\n\ninit(ExtPrg) -&gt;\n    register(myname, self()),\n    process_flag(trap_exit, true),\n    Port = open_port({spawn, ExtPrg}, []),\n    loop(Port).\n\nloop(Port) -&gt;\n    receive\n    {call, Caller, Msg} -&gt;\n        Port ! {self(), {command, Msg++?DELIMITER}},\n        receive\n        {Port, {data, Data}} -&gt;\n            Caller ! {myname, Data}\n        end,\n        loop(Port);\n    stop -&gt;\n        Port ! {self(), close},\n        receive\n        {Port, closed} -&gt;\n            exit(normal)\n        end;\n    {'EXIT', Port, _Reason} -&gt;\n        exit(port_terminated)\n    end.\n</code></pre>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 1, "creation_date": 1440489888, "post_id": 32198387, "comment_id": 52281822, "body": "<code>reflectedMethod.Type</code> returns a function. You have to call that function to get the type, so <code>methodType := reflectedMethod.Type()</code>."}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 0, "creation_date": 1440490854, "post_id": 32198387, "comment_id": 52282438, "body": "@alvivi:Thank you, it worked!"}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1530738981, "creation_date": 1530738981, "answer_id": 51180820, "question_id": 32198387, "link": "https://stackoverflow.com/questions/32198387/convert-reflect-value-to-reflect-method/51180820#51180820", "title": "Convert reflect.value to reflect.method", "body": "<p>To be more specific:</p>\n\n<ul>\n<li><code>reflectedMethod.Type</code> returns the function <a href=\"https://golang.org/pkg/reflect/#Value.Type\" rel=\"nofollow noreferrer\"><code>func (v Value) Type() Type</code></a></li>\n<li><code>reflectedMethod.Type()</code> returns the result, meaning  v's type. </li>\n</ul>\n\n<p>You can see a more complete example in \"<a href=\"https://coderwall.com/p/b5dpwq/fun-with-the-reflection-package-to-analyse-any-function\" rel=\"nofollow noreferrer\">Fun with the reflection package to analyse any function.</a>\"</p>\n\n<pre><code>func FuncAnalyse(m interface{}) {\n\n    //Reflection type of the underlying data of the interface\n    x := reflect.TypeOf(m)\n\n    numIn := x.NumIn()   //Count inbound parameters\n    numOut := x.NumOut() //Count outbounding parameters\n\n    fmt.Println(\"Method:\", x.String())\n    fmt.Println(\"Variadic:\", x.IsVariadic()) // Used (&lt;type&gt; ...) ?\n    fmt.Println(\"Package:\", x.PkgPath())\n}\n</code></pre>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1530738981, "creation_date": 1440489098, "question_id": 32198387, "link": "https://stackoverflow.com/questions/32198387/convert-reflect-value-to-reflect-method", "title": "Convert reflect.value to reflect.method", "body": "<p>I have the fallowing:</p>\n\n<pre><code>func NewMethodDescriptor(typ interface{}) *MethodDescriptor {\n\n    reflectedMethod := reflect.ValueOf(typ)\n    methodType := reflectedMethod.Type\n    paramCount := methodType.NumIn() - 1\n    ...\n</code></pre>\n\n<p>But when I try:</p>\n\n<pre><code>NewMethodDescriptor(func(){})\n</code></pre>\n\n<p>I get this compile time error:</p>\n\n<pre><code>methodType.NumIn undefined (type func() reflect.Type has no field or method NumIn)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12494, "user_id": 1402929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IORgE.jpg?s=128&g=1", "display_name": "Matt Harrison", "link": "https://stackoverflow.com/users/1402929/matt-harrison"}, "edited": false, "score": 0, "creation_date": 1440488440, "post_id": 32198153, "comment_id": 52281010, "body": "How will your users be &quot;connected&quot;? Is there a persistent connection to the server, i.e with websocket?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 12494, "user_id": 1402929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IORgE.jpg?s=128&g=1", "display_name": "Matt Harrison", "link": "https://stackoverflow.com/users/1402929/matt-harrison"}, "edited": false, "score": 0, "creation_date": 1440488527, "post_id": 32198153, "comment_id": 52281046, "body": "Yes sorry they will be connected through websockets or a fallback to a ping from ajax if websockets isn&#39;t supported"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1440488290, "creation_date": 1440488290, "question_id": 32198153, "link": "https://stackoverflow.com/questions/32198153/golang-how-do-i-simulate-users-idling-on-a-webpage", "title": "Golang how do I simulate users idling on a webpage?", "body": "<p>Hi guys I was wondering how I might simulate users idling a webpage</p>\n\n<p>I'm currently making a part of my website that will show how many concurrent connections there are to the server right now I don't really have access to more than 1 computer.</p>\n\n<p>It works and shows 1 person online, but I want to write a small little go program that I can set a variable to say, 100 people, and launch it, it will stay running and then see if my site correctly shows 100 people connected to it.</p>\n\n<p>I had something like</p>\n\n<p>package main</p>\n\n<p>import (\n    \"net\"\n)</p>\n\n<pre><code>func main() {\n    go connectToServer()\n    go connectToServer()\n    go connectToServer()\n}\n\nfunc connectToServer() {\n    servAddr := \"http://localhost:1337\"\n    tcpAddr, err := net.ResolveTCPAddr(\"tcp\", servAddr)\n    if err != nil {\n        panic(err)\n    }\n\n    _, err = net.DialTCP(\"tcp\", nil, tcpAddr)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>It runs but I don't know if this is the right way to do it, also since they're go routines and are ending almost instantly my program starts then stops right away so I need a way to keep the connections alive without the program stopping right away, any information would be great. Thanks!</p>\n"}, {"tags": ["mysql", "session", "go"], "comments": [{"owner": {"reputation": 4936, "user_id": 102852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd1a03727472c03ab6628d437a24e00?s=128&d=identicon&r=PG", "display_name": "alex vasi", "link": "https://stackoverflow.com/users/102852/alex-vasi"}, "edited": false, "score": 0, "creation_date": 1440515501, "post_id": 32196888, "comment_id": 52299457, "body": "Try replacing <code>&quot;appCookie&quot;</code> -&gt; <code>&quot;session-name&quot;</code> in your GetCookies handler."}, {"owner": {"reputation": 1802, "user_id": 754854, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4acefbd570391b3abbae9cab3beeb7f1?s=128&d=identicon&r=PG", "display_name": "JoeMoe1984", "link": "https://stackoverflow.com/users/754854/joemoe1984"}, "reply_to_user": {"reputation": 4936, "user_id": 102852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd1a03727472c03ab6628d437a24e00?s=128&d=identicon&r=PG", "display_name": "alex vasi", "link": "https://stackoverflow.com/users/102852/alex-vasi"}, "edited": false, "score": 0, "creation_date": 1440517098, "post_id": 32196888, "comment_id": 52300615, "body": "@alexvasi Sorry that was my bad. I didn&#39;t edit/paste the code properly on my end . Thanks for pointing that out, however, it still doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 498, "user_id": 7280962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8181c2901a87288eef3d3a62589b0bd4?s=128&d=identicon&r=PG", "display_name": "Nicholas Martinez", "link": "https://stackoverflow.com/users/7280962/nicholas-martinez"}, "edited": false, "score": 0, "creation_date": 1579550437, "post_id": 32288322, "comment_id": 105796695, "body": "I have this problem with those params being passed in. Table create works, the session is there, but when <code>Mysqlstore.Get(r, &quot;auth-session&quot;)</code> is called, it throws the error. Not sure why after finding your answer."}], "tags": [], "owner": {"reputation": 1802, "user_id": 754854, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4acefbd570391b3abbae9cab3beeb7f1?s=128&d=identicon&r=PG", "display_name": "JoeMoe1984", "link": "https://stackoverflow.com/users/754854/joemoe1984"}, "is_accepted": true, "score": 1, "last_activity_date": 1440866199, "creation_date": 1440866199, "answer_id": 32288322, "question_id": 32196888, "link": "https://stackoverflow.com/questions/32196888/golang-sessions-with-mysqlstore-not-working/32288322#32288322", "title": "Golang sessions with MysqlStore not working", "body": "<p>So I figured it out with some digging around. When I was logging some errors within the mysqlstore package I found this little error which led me to the solution:</p>\n\n<p><code>panic: sql: Scan error on column index 2: unsupported driver -&gt; Scan pair: []uint8 -&gt; *time.Time</code></p>\n\n<p>I then googled around a bit and found a discussion on the issue here:</p>\n\n<p><a href=\"https://github.com/go-sql-driver/mysql/issues/9\" rel=\"nofollow\">https://github.com/go-sql-driver/mysql/issues/9</a></p>\n\n<p>Basically I didn't read the Examples too well. This was in the packages Readme file the whole time. I forgot to add the query string <code>?parseTime=true&amp;loc=Local</code> at the end of my mysql connection credentials.</p>\n\n<p>So basically the solution was this when setting up my database:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"username:password@/dbname?parseTime=true&amp;loc=Local\")\n</code></pre>\n"}], "owner": {"reputation": 1802, "user_id": 754854, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4acefbd570391b3abbae9cab3beeb7f1?s=128&d=identicon&r=PG", "display_name": "JoeMoe1984", "link": "https://stackoverflow.com/users/754854/joemoe1984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 32288322, "answer_count": 1, "score": 1, "last_activity_date": 1440866199, "creation_date": 1440483907, "last_edit_date": 1440516994, "question_id": 32196888, "link": "https://stackoverflow.com/questions/32196888/golang-sessions-with-mysqlstore-not-working", "title": "Golang sessions with MysqlStore not working", "body": "<p>I am having issues setting sessions on one request and getting them on another page request.</p>\n\n<p>I am using the mysqlstore package which was recommended on the gorilla sessions github page under the \"Store Implementations\" section in there readme file.</p>\n\n<p><a href=\"https://github.com/srinathgs/mysqlstore\" rel=\"nofollow\">https://github.com/srinathgs/mysqlstore</a></p>\n\n<p>I setup a simple request to test it out and it wasn't working. Here is the code:</p>\n\n<p><strong>HomeController</strong></p>\n\n<pre><code>func (this *HomeController) SetCookie(ctx types.AppContext) web.HandlerType {\n\n    return func(c web.C, w http.ResponseWriter, r *http.Request) {\n\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n\n        fmt.Printf(\"%v\\n\\n\", r)\n        ctx.SetCookies(r, w)\n    }\n}\n\nfunc (this *HomeController) GetCookie(ctx types.AppContext) web.HandlerType {\n\n    return func(c web.C, w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n\n        fmt.Printf(\"%v\\n\\n\", r)\n        ctx.GetCookies(r)\n    }\n}\n</code></pre>\n\n<p><strong>types.AppContext</strong></p>\n\n<pre><code>func (this *AppContext) SetCookies(r *http.Request, w http.ResponseWriter) {\n\n    fmt.Println(\"Setting cookies\")\n    session, _ := this.store.Get(r, \"session-name\")\n    // Set some session values.\n    session.Values[\"foo\"] = \"bar\"\n    session.Values[42] = 43\n    // Save it before we write to the response/return from the handler.\n    err := session.Save(r, w)\n\n    if err != nil {\n        fmt.Println(\"Problem Saving session data\")\n    }\n\n}\nfunc (this *AppContext) GetCookies(r *http.Request) {\n\n    session, _ := this.store.Get(r, \"session-name\")\n    fmt.Println(\"Getting cookies\")\n    // get some session values\n    for k, v := range session.Values {\n        fmt.Println(\"Key:\", k)\n        fmt.Println(\"Value:\", v)\n    }\n\n}\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>ctx.SetStore(\"sessions\", \"/\", 3600, []byte(\"somesecret\"))\n\n....\n\ngoji.Get(\"/set-cookie\", homeCtrl.SetCookie(ctx))\ngoji.Get(\"/get-cookie\", homeCtrl.GetCookie(ctx))\n</code></pre>\n\n<p>When I visit both pages I get no errors and I can see in the database a session was saved. However, when I try to retrieve the saved cookie, the session.Values map is empty. </p>\n\n<p>When I print out the request I get the following (formatted for easy viewing):</p>\n\n<pre><code>&amp;{\n    GET /get-cookie HTTP/1.1 1 1 \n    map[\n        Connection:[keep-alive] \n        User-Agent:[Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.107 Safari/537.36] \n        Cookie:[session-name=MTQ0MDQ4MjU0M3xCUXdBQWpJM3x3xeRstTXbooJerGOhzP2pvEmqIkisE1XjS76zI365pA==] \n        Accept-Language:[en,en-CA;q=0.8,en-US;q=0.6,ja;q=0.4] \n        Cache-Control:[max-age=0] \n        Accept:[text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8] \n        Upgrade-Insecure-Requests:[1] \n        Accept-Encoding:[gzip, deflate, sdch]\n    ] \n    0x66a9a0 0 [] \n    false localhost:8000 map[] \n    map[] \n    &lt;nil&gt; \n    map[] \n    [::1]:62375 \n    /get-cookie \n    &lt;nil&gt;\n}\n</code></pre>\n\n<p>As you can see I am sending a cookie and it is the \"session-name\" one. In Chrome when I look at the cookies I can see it locally as well.</p>\n\n<pre><code>Name: session-name\nValue: MTQ0MDQ4MjU0M3xCUXdBQWpJM3x3xeRstTXbooJerGOhzP2pvEmqIkisE1XjS76zI365pA\nDomain: localhost\nPath: /\nExpires/Max-Age: 2015-08-25T07:02:23.347Z (it was about 10:50pm - 11:00pm when I tested this out)\n</code></pre>\n\n<p>I have been looking at this and can't figure out why it doesn't work. This is as simple as I can make it and according to the examples this should work but it doesn't. Is there something I am missing in my code to make it work?</p>\n"}, {"tags": ["image", "go", "jpeg"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440460246, "post_id": 32193395, "comment_id": 52272078, "body": "If there&#39;s a problem with the file you&#39;re passing to the decoder, you need to show us how you&#39;re generating that file."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 2, "creation_date": 1440471803, "post_id": 32193395, "comment_id": 52274836, "body": "why not save to a file and check? is the right image in jpeg format?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1440493408, "post_id": 32193395, "comment_id": 52284023, "body": "Are you sure that (<code>defer pic.Close()</code>) is not called before <code>ConvertImageToThumbnail</code>? Please post more code."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440511805, "post_id": 32193395, "comment_id": 52296628, "body": "Please don&#39;t put code in the comments, it&#39;s hard to read and belongs in the question. Also, That doesn&#39;t show <i>how</i> you&#39;re creating the file, nor does it show if it is actually a jpeg image. You need to debug what you&#39;re sending and receiving, not how you&#39;re decoding the image."}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1440531523, "post_id": 32193395, "comment_id": 52309057, "body": "i would first check if img is a valid image by writing it out to a file or simply by fmt.Println(img.Pix) (do not forget to import &quot;fmt&quot;) if the image is not to big."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "is_accepted": false, "score": 3, "last_activity_date": 1440532056, "creation_date": 1440532056, "answer_id": 32212776, "question_id": 32193395, "link": "https://stackoverflow.com/questions/32193395/golang-io-reader-issue-with-jpeg-decode-returning-eof/32212776#32212776", "title": "Golang io.Reader issue with jpeg.Decode returning EOF", "body": "<p>pic.Seek(0,0) before the decode fixed the issue. </p>\n"}], "owner": {"reputation": 183, "user_id": 4697005, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/IcWqw.jpg?s=128&g=1", "display_name": "Kody Doherty", "link": "https://stackoverflow.com/users/4697005/kody-doherty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1504, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1440532056, "creation_date": 1440459534, "last_edit_date": 1440531809, "question_id": 32193395, "link": "https://stackoverflow.com/questions/32193395/golang-io-reader-issue-with-jpeg-decode-returning-eof", "title": "Golang io.Reader issue with jpeg.Decode returning EOF", "body": "<p>I am trying to take a multipart.File that is an io.Reader and decode it as a jpeg to covert into a Thumbnail using github.com/disintegration/imaging's library. I know in advance the data is going to be a jpeg. When I send the multipart.File to a ConvertImageToThumbnail function and it returns Unexpected EOF every time. What am I doing wrong?</p>\n\n<pre><code>package images\n\nimport (\n    \"github.com/disintegration/imaging\"\n    \"image\"\n    \"image/jpeg\"\n    \"mime/multipart\"\n)\n\nfunc ConvertImageToThumbnail(pic multipart.File) (image.Image, error) {\n    pic.Seek(0,0) // The solution was to seek back to the beginning of the file\n    img,err := jpeg.Decode(pic)\n    if err != nil {\n        return nil, err\n    }\n    thumb := imaging.Thumbnail(img, 100, 100, imaging.CatmullRom)\n\n    return thumb, nil\n}\n\n\npic, header, err := r.FormFile(\"avatar\") \n// check error\ndefer pic.Close()\n</code></pre>\n"}, {"tags": ["sorting", "types", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1440442230, "post_id": 32189487, "comment_id": 52264261, "body": "BTW, the documentation for <code>strings.Compare</code> explicitly states you shouldn&#39;t normally use it; just do <code>return objs[i] &lt; objs[j]</code> (or if that complains then cast them to <code>string</code>)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1440442277, "post_id": 32189487, "comment_id": 52264293, "body": "Also, idiomatic <code>Swap</code> would be: <code>func (p MyObjects) Swap(i, j int) { p[i], p[j] = p[j], p[i] }</code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 4, "creation_date": 1440442501, "post_id": 32189487, "comment_id": 52264427, "body": "With those simplifications the <a href=\"https://play.golang.org/p/EcoRDa-M0r\" rel=\"nofollow noreferrer\">idiomatic way of doing it</a> isn&#39;t bad at all."}, {"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440487005, "post_id": 32189487, "comment_id": 52280182, "body": "Lesson learned: I need to write more Go to become more idiomatic."}], "answers": [{"comments": [{"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "edited": false, "score": 0, "creation_date": 1440486800, "post_id": 32189675, "comment_id": 52280069, "body": "The <code>p[i], p[j] = p[j], p[i]</code> notation (thanks for reminding me of that :) and compact function bodies reduce the boilerplate to a bare minimum, so I&#39;ll go with that."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1440455226, "last_edit_date": 1440455226, "creation_date": 1440442594, "answer_id": 32189675, "question_id": 32189487, "link": "https://stackoverflow.com/questions/32189487/how-can-i-sort-go-slices-whose-element-type-is-an-alias-of-string-but-not-strin/32189675#32189675", "title": "How can I sort Go slices whose element type is an alias of string, but not string itself?", "body": "<p>No. Since Go doesn't allow the implicit conversion of types within slices (there is also no covariance with interfaces), you need to supply the appropriate methods for your type. </p>\n\n<pre><code>type MyObjects []MyObject\n\nfunc (p MyObjects) Len() int           { return len(p) }\nfunc (p MyObjects) Swap(i, j int)      { p[i], p[j] = p[j], p[i] }\nfunc (p MyObjects) Less(i, j int) bool { return p[i] &lt; p[j] }\n</code></pre>\n\n<p>If you <em>really</em> want to do this, you could use unsafe (but please don't). I doubt those 3 extra lines of <em>safe</em> code are going to make that big a difference for you.</p>\n\n<p><a href=\"http://play.golang.org/p/d6ciFjjr2c\" rel=\"nofollow\">http://play.golang.org/p/d6ciFjjr2c</a></p>\n\n<pre><code>objects := []MyObject{\"one\", \"two\", \"three\", \"four\"}\nsort.Strings(*(*[]string)(unsafe.Pointer(&amp;objects)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "edited": false, "score": 0, "creation_date": 1440486745, "post_id": 32189982, "comment_id": 52280033, "body": "I see. Unfortunately, <code>type MyObjects []string</code> is not an option for me. The <code>MyObject</code> instances have quite some logic attached to them, so I need the specific type."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1440443684, "last_edit_date": 1495542583, "creation_date": 1440443684, "answer_id": 32189982, "question_id": 32189487, "link": "https://stackoverflow.com/questions/32189487/how-can-i-sort-go-slices-whose-element-type-is-an-alias-of-string-but-not-strin/32189982#32189982", "title": "How can I sort Go slices whose element type is an alias of string, but not string itself?", "body": "<p><em>IF</em> your <code>MyObject</code> type is an \"alias\" with <code>string</code> being its underlying type, you can't. See <a href=\"https://stackoverflow.com/a/32189675/1705598\">@JimB's answer</a> here.</p>\n\n<p>The underlying type of <code>MyObject</code> is the same as the underlying type of <code>string</code> (which is itself: <code>string</code>), but the underlying type of <code>[]MyObject</code> is not the same as the underlying type of <code>[]string</code>.</p>\n\n<p>See further explanations here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/29031353/conversion-of-a-slice-of-string-into-a-slice-of-custom-type\">Conversion of a slice of string into a slice of custom type</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/31891493/why-are-you-unable-convert-slice-types\">Why are you unable convert Slice types?</a></p>\n\n<p>But if you happen to refactor a little your type system, your problems go away:</p>\n\n<pre><code>type MyObjects []string\n\nvar objects MyObjects\n\nfunc main() {\n    objects = MyObjects{\"abc\", \"aaa\"}\n    sort.Strings(objects)\n    fmt.Println(objects)\n}\n</code></pre>\n\n<p>Output (try it on the <kbd><a href=\"http://play.golang.org/p/tM2KhCd1TG\" rel=\"nofollow noreferrer\">Go Playground</a></kbd>):</p>\n\n<pre><code>[aaa abc]\n</code></pre>\n\n<p>For convenience, you can even provide a <code>Sort()</code> method on it if you want to:</p>\n\n<pre><code>func (m MyObjects) Sort() {\n    sort.Strings(m)\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>objects = MyObjects{\"abc\", \"aaa\"}\nobjects.Sort()\nfmt.Println(objects)\n</code></pre>\n\n<p>(Output is the same.)</p>\n"}], "owner": {"reputation": 5147, "user_id": 334761, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZXRM5.jpg?s=128&g=1", "display_name": "Stefan Majewsky", "link": "https://stackoverflow.com/users/334761/stefan-majewsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 32189675, "answer_count": 2, "score": 3, "last_activity_date": 1440455226, "creation_date": 1440441852, "question_id": 32189487, "link": "https://stackoverflow.com/questions/32189487/how-can-i-sort-go-slices-whose-element-type-is-an-alias-of-string-but-not-strin", "title": "How can I sort Go slices whose element type is an alias of string, but not string itself?", "body": "<pre><code>type MyObject string\nvar objects []MyObject\n</code></pre>\n\n<p>I want to sort these objects. The standard library has <code>sort.Strings</code>, but that requires an instance of <code>[]string</code> instead of <code>[]MyObject</code>.</p>\n\n<p>My current solution is to implement <code>sort.Interface</code> (as shown below) and use <code>sort.Sort</code>, but I'd like to get rid of that boilerplate code. Is there a nicer way?</p>\n\n<pre><code>type MyObjects []MyObject\n\nfunc (objs MyObjects) Len() int {\n    return len(objs)\n}\n\nfunc (objs MyObjects) Less(i, j int) bool {\n    return strings.Compare(string(objs[i]), string(objs[j])) &lt; 0\n}\n\nfunc (objs MyObjects) Swap(i, j int) {\n    o := objs[i]\n    objs[i] = objs[j]\n    objs[j] = o\n}\n</code></pre>\n"}, {"tags": ["inheritance", "go", "idioms"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 16, "creation_date": 1440440052, "post_id": 32188653, "comment_id": 52263065, "body": "It&#39;s hard to tell what you&#39;re doing from a generic example, but this is not idiomatic Go code. In general, you need to avoid thinking about solutions via classes and inheritance altogether. Use composition to your advantage, and remember that not everything needs to be a struct represented by an interface -- sometimes functions are all you need."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 14, "creation_date": 1440440425, "post_id": 32188653, "comment_id": 52263288, "body": "Redesign your solution. Go has no inheritance. Trying to remodel inheritance with what Go provides most likely will fail."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 14, "creation_date": 1440444791, "post_id": 32188653, "comment_id": 52265744, "body": "Don&#39;t understand why you&#39;re being downvoted; you asked if this was an appropriate approach, and if not, what you could do to make it better. At the risk of looking like the odd guy out, I think your question is fine. With that being said, the two commenters above me hit it spot on."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1440456227, "post_id": 32188653, "comment_id": 52270864, "body": "Your code example confuses me. You probably just want to define the &#39;common methods&#39; on a single type and embed it in the types you want to offer those methods. You said you had a problem &#39;because struct methods only have acces to the structs own fields&#39; but that&#39;s not really true. If you embed some type <code>Base</code> inside of types <code>A</code> and <code>B</code> then they can access an exported field for <code>Base</code> inside their methods directly. If <code>Base</code> has a method <code>One</code> and you want to override it you can redefine it in <code>A</code> and still call <code>A.Base.One()</code> from in that context just like you would in those OO languages."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 2, "creation_date": 1440466920, "post_id": 32188653, "comment_id": 52273698, "body": "I think you need to give a more concrete example of what you&#39;re trying to do and why you think this approach is necessary. I gave you an upvote to neutralize the rating because I agree with @william.taylor.09."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1440471907, "post_id": 32188653, "comment_id": 52274863, "body": "you need struct embedding feature of golang. check this <a href=\"http://stackoverflow.com/questions/32125832/after-renaming-a-type-i-cannot-access-some-of-its-methods/\" title=\"after renaming a type i cannot access some of its methods\">stackoverflow.com/questions/32125832/&hellip;</a> vote if you like the answer."}, {"owner": {"reputation": 10223, "user_id": 221650, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/68a2471aa6fae5bfec71d8d09afbb2f1?s=128&d=identicon&r=PG&f=1", "display_name": "Petruza", "link": "https://stackoverflow.com/users/221650/petruza"}, "edited": false, "score": 0, "creation_date": 1569417783, "post_id": 32188653, "comment_id": 102590702, "body": "Go <code>does</code> have inheritance, it&#39;s called embedding and behaves the same (or almost) <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#embedding</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1441381253, "post_id": 32389151, "comment_id": 52671971, "body": "Except you almost never want to use a pointer to an interface. Your <code>MyReadWriter</code> should <b>not</b> be using pointers to interfaces but should instead be <code>type MyReadWriter struct { Reader, Writer }</code>. That allows for (e.g.) <code>rw := MyReadWriter{ strings.NewReader(&quot;foo&quot;), new(bytes.Buffer) }</code>."}, {"owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441415051, "post_id": 32389151, "comment_id": 52684939, "body": "Thanks for the heads up, that&#39;s good to know. Do you have a link that explains why? Also, this example is straight from the effective go page."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1441418374, "post_id": 32389151, "comment_id": 52685433, "body": "A good place to get some more details about interfaces is <a href=\"http://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">a blog article by Russ Cox</a>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1441418629, "post_id": 32389151, "comment_id": 52685476, "body": "I had to re-read <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">the relevant section</a> carefully to notice the context that you lost. The first example is showing the definition of <code>io.Reader</code> and <code>io.Writer</code> which are interfaces (and there also is an <a href=\"https://golang.org/pkg/io#ReadWriter\" rel=\"nofollow noreferrer\"><code>io.ReadWriter</code></a>). The later is showing <code>*bufio.Reader</code> and <code>*bufio.Writer</code> which are (both pointers to struct types) being embedded into a type to implement <code>io.ReadWriter</code>. Those two excerpts come from different packages and you can&#39;t just cut-n-paste them together."}, {"owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1448617149, "post_id": 32389151, "comment_id": 55666556, "body": "@DaveC, you&#39;re right!  I updated the answer with fixed examples."}, {"owner": {"reputation": 1041, "user_id": 5419599, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/SbCyV.png?s=128&g=1", "display_name": "Wildcard", "link": "https://stackoverflow.com/users/5419599/wildcard"}, "edited": false, "score": 0, "creation_date": 1588977494, "post_id": 32389151, "comment_id": 109118614, "body": "Your edits have lost an &quot;either\u2014or&quot;, replacing it with a hanging &quot;either&quot; that doesn&#39;t connect to any later text.  Confusing."}], "tags": [], "owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "is_accepted": false, "score": 37, "last_activity_date": 1560697581, "last_edit_date": 1560697581, "creation_date": 1441333451, "answer_id": 32389151, "question_id": 32188653, "link": "https://stackoverflow.com/questions/32188653/golang-and-inheritance/32389151#32389151", "title": "Golang and inheritance", "body": "<p>As mentioned in people's comments, Go encourages composition over inheritance.</p>\n\n<p>To address your question about reducing code duplication, you would want to use <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"noreferrer\">embedding</a>.</p>\n\n<p>Using the example from <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"noreferrer\">Effective Go</a> linked above, you start with very narrow interfaces that only do a few things:</p>\n\n<pre><code>type Reader interface {\n    Read(p []byte) (n int, err error)\n}\n\ntype Writer interface {\n    Write(p []byte) (n int, err error)\n}\n</code></pre>\n\n<p>Then you can either compose interfaces together into another interface:</p>\n\n<pre><code>// ReadWriter is the interface that combines the Reader and Writer interfaces.\ntype ReadWriter interface {\n    Reader\n    Writer\n}\n</code></pre>\n\n<p>It works similarly for structs, where you can compose structs that implement Reader and Writer together in another struct:</p>\n\n<pre><code>type MyReader struct {}\nfunc (r *MyReader) Read(p []byte) (n int, err error) {\n    // Implements Reader interface.\n}\ntype MyWriter struct {}\nfunc (w *MyWriter) Write(p []byte) (n int, err error) {\n    // Implements Writer interface.\n}\n\n// MyReadWriter stores pointers to a MyReader and a MyWriter.\n// It implements ReadWriter.\ntype MyReadWriter struct {\n    *MyReader\n    *MyWriter\n}\n</code></pre>\n\n<p>Basically, anything that implements a <code>Reader</code> or a <code>Writer</code> can be reused by composing them together in a struct, and that outer struct will automatically implement the <code>ReadWriter</code> interface.</p>\n\n<p>This is basically doing <a href=\"https://en.wikipedia.org/wiki/Dependency_injection\" rel=\"noreferrer\">Dependency Injection</a>, and it's super useful for testing too.</p>\n\n<p>Example from the struct code above:</p>\n\n<pre><code>func (rw *MyReadWriter) DoCrazyStuff() {\n    data := []byte{}\n    // Do stuff...\n    rw.Read(data)\n    rw.Write(data)\n    // You get the idea...\n}\n\nfunc main() {\n    rw := &amp;MyReadWriter{&amp;MyReader{}, &amp;MyWriter{}}\n    rw.DoCrazyStuff()\n}\n</code></pre>\n\n<p>One thing to point out that's slightly different from other languages' composition paradigm is that the <code>MyReadWriter</code> struct can now act as both a <code>Reader</code> and a <code>Writer</code>.  That's why in <code>DoCrazyStuff()</code> we do <code>rw.Read(data)</code> instead of <code>rw.Reader.Read(data)</code>.</p>\n\n<p>UPDATE: Fixed incorrect example.</p>\n"}, {"comments": [{"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 4, "creation_date": 1574734099, "post_id": 32743807, "comment_id": 104327543, "body": "This is commentary and not an answer to the question."}], "tags": [], "owner": {"reputation": 74157, "user_id": 82219, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ac2affc83317e12b56694ba7926d7f5?s=128&d=identicon&r=PG", "display_name": "tux21b", "link": "https://stackoverflow.com/users/82219/tux21b"}, "is_accepted": false, "score": 6, "last_activity_date": 1443022532, "creation_date": 1443022532, "answer_id": 32743807, "question_id": 32188653, "link": "https://stackoverflow.com/questions/32188653/golang-and-inheritance/32743807#32743807", "title": "Golang and inheritance", "body": "<p>Sorry to disappoint you, but you are asking the wrong question. I had a similar problem when I started writing Go code.</p>\n\n<p>You can not simply take a class hierarchy and translate it to Go code, at least not with satisfying results. Usually there is a very elegant and simple way to solve such things in Go, but to discover them, you need to think a bit differently as you are used to.</p>\n\n<p>Unfortunately, your question doesn't say anything about <strong>what</strong> problem you are trying to solve. You have just described <strong>how</strong> you would like to solve it. Therefore I am a bit reluctant to give a general answer, since it will not lead to idiomatic Go code. I understand if you are disappointed by that answer, but in my opinion, that`s the most value-able answer you can get :)</p>\n"}], "owner": {"reputation": 2692, "user_id": 625791, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/996a20b9eae1def21e8db462e9bf1cf7?s=128&d=identicon&r=PG", "display_name": "theduke", "link": "https://stackoverflow.com/users/625791/theduke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17620, "favorite_count": 9, "answer_count": 2, "score": 32, "last_activity_date": 1560697581, "creation_date": 1440438964, "question_id": 32188653, "link": "https://stackoverflow.com/questions/32188653/golang-and-inheritance", "title": "Golang and inheritance", "body": "<p>I want to provide a base struct with methods in my library that can be 'extended'.</p>\n\n<p>The methods of this base struct rely on methods from the extending struct.\nThis is not directly possible in Go, because struct methods only have acces to the structs own fields, not to parent structs.</p>\n\n<p><strong>The point is to have functionality that I do not have to repeat in each extending class.</strong></p>\n\n<p>I have come up with this pattern, which works fine,\nbut looks quite convoluted due to it's cyclical structure.</p>\n\n<p>I have never found anything like it in other Go code.\nIs this very un-go?\nWhat different approach could I take?</p>\n\n<pre><code>type MyInterface interface {\n  SomeMethod(string)\n  OtherMethod(string)\n}\n\ntype Base struct{\n  B MyInterface\n}\n\nfunc (b *Base) SomeMethod(x string) {\n  b.B.OtherMethod(x)\n}\n\ntype Extender struct {\n  Base\n}\n\nfunc (b *Extender) OtherMethod(x string) {\n  // Do something...\n}\n\nfunc NewExtender() *Extender { \n  e := Extender{}\n  e.Base.B = &amp;e\n  return &amp;e\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "slice", "xml-deserialization"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1440434366, "post_id": 32187067, "comment_id": 52260070, "body": "Do not unmarshal the XML: Decode it element for element with a xml.Decoder by calling the Token method. (Sorry, I do not have an example at hand.)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1440440540, "post_id": 32187067, "comment_id": 52263348, "body": "...or use <a href=\"http://godoc.org/gopkg.in/xmlpath.v2\" rel=\"nofollow noreferrer\"><code>XPath</code></a> to query your document for all nodes named &quot;offer&quot; located under the element &quot;items&quot;. <code>XPath</code> works reasonably OK on short-to-mid-sized documents, otherwise I&#39;d go with what @Volker proposed."}], "answers": [{"tags": [], "owner": {"reputation": 160456, "user_id": 89391, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bb5230985aa2c9ea7d022d1a16890f16?s=128&d=identicon&r=PG", "display_name": "miku", "link": "https://stackoverflow.com/users/89391/miku"}, "is_accepted": true, "score": 8, "last_activity_date": 1470746289, "creation_date": 1470746289, "answer_id": 38850984, "question_id": 32187067, "link": "https://stackoverflow.com/questions/32187067/mixed-xml-decoding-in-golang-preserving-order/38850984#38850984", "title": "mixed XML decoding in golang preserving order", "body": "<p>One way would be to overwrite the <code>UnmarshalXML</code> method. Let's say our input looks like this:</p>\n\n<pre><code>&lt;doc&gt;\n    &lt;head&gt;My Title&lt;/head&gt;\n    &lt;p&gt;A first paragraph.&lt;/p&gt;\n    &lt;p&gt;A second one.&lt;/p&gt;\n&lt;/doc&gt;\n</code></pre>\n\n<p>We want to deserialize the document and preserve the order of the head and paragraphs. For order we will need a slice. To accommodate both <code>head</code> and <code>p</code>, we will need an interface. We could define our document like this:</p>\n\n<pre><code>type Document struct {\n    XMLName  xml.Name `xml:\"doc\"`\n    Contents []Mixed  `xml:\",any\"`\n}\n</code></pre>\n\n<p>The <code>,any</code> annotation will collect <em>any</em> element into <code>Contents</code>. It is a <code>Mixed</code> type, which we need to define as a type:</p>\n\n<pre><code>type Mixed struct {\n    Type  string      // just keep \"head\" or \"p\" in here\n    Value interface{} // keep the value, we could use string here, too\n}\n</code></pre>\n\n<p>We need more control over the deserialization process, so we turn <code>Mixed</code> into an <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"noreferrer\"><code>xml.Unmashaler</code></a> by implementing <code>UnmarshalXML</code>. We decide on the code path based on the name of the start element, e.g. <code>head</code> or <code>p</code>. Here, we only populate our <code>Mixed</code> struct with some values, but you can basically do anything here:</p>\n\n<pre><code>func (m *Mixed) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    switch start.Name.Local {\n    case \"head\", \"p\":\n        var e string\n        if err := d.DecodeElement(&amp;e, &amp;start); err != nil {\n            return err\n        }\n        m.Value = e\n        m.Type = start.Name.Local\n    default:\n        return fmt.Errorf(\"unknown element: %s\", start)\n    }\n    return nil\n}\n</code></pre>\n\n<p>Putting it all together, usage of the above structs could look like this:</p>\n\n<pre><code>func main() {\n    s := `\n    &lt;doc&gt;\n        &lt;head&gt;My Title&lt;/head&gt;\n        &lt;p&gt;A first paragraph.&lt;/p&gt;\n        &lt;p&gt;A second one.&lt;/p&gt;\n    &lt;/doc&gt;\n    `\n\n    var doc Document\n    if err := xml.Unmarshal([]byte(s), &amp;doc); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"#%v\", doc)\n}   \n</code></pre>\n\n<p>Which would print.</p>\n\n<pre><code>#{{ doc} [{head My Title} {p A first paragraph.} {p A second one.}]}\n</code></pre>\n\n<p>We preserved order and kept some type information. Instead of a single type, like <code>Mixed</code> you could use many different types for the deserialization. The cost of this approach is that your container - here the <code>Contents</code> field of the document - is an interface. To do anything element-specific, you'll need a type assertion or some helper method.</p>\n\n<p>Complete code on play: <a href=\"https://play.golang.org/p/fzsUPPS7py\" rel=\"noreferrer\">https://play.golang.org/p/fzsUPPS7py</a></p>\n"}], "owner": {"reputation": 1900, "user_id": 551451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d24ae0178ef74467c97c7956cc1ac16?s=128&d=identicon&r=PG", "display_name": "Miroslav", "link": "https://stackoverflow.com/users/551451/miroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1325, "favorite_count": 3, "accepted_answer_id": 38850984, "answer_count": 1, "score": 6, "last_activity_date": 1470746289, "creation_date": 1440433187, "question_id": 32187067, "link": "https://stackoverflow.com/questions/32187067/mixed-xml-decoding-in-golang-preserving-order", "title": "mixed XML decoding in golang preserving order", "body": "<p>I need to extract offers from an XML, but taking into consideration nodes order:</p>\n\n<pre>\n&lt;items&gt;\n  &lt;offer/&gt;\n  &lt;product&gt;\n    &lt;offer/&gt;\n    &lt;offer/&gt;\n  &lt;/product&gt;\n  &lt;offer/&gt;\n  &lt;offer/&gt;\n&lt;/items&gt;\n</pre>\n\n<p>The following struct would decode the values, but into two different slices, which will cause loss of original order:</p>\n\n<pre>\ntype Offers struct {\n    Offers   []offer `xml:\"items>offer\"`\n    Products []offer `xml:\"items>product>offer\"`\n}\n</pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "compilation", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1440430927, "post_id": 32186342, "comment_id": 52258084, "body": "There is no difference in how <code>go run</code> works, other than it compiles, runs, and cleans up the binary for you."}, {"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440432014, "post_id": 32186342, "comment_id": 52258836, "body": "So you&#39;re saying go run compiles it, runs it the removes the binary? and so to my main question, is the garbage collector compiled into the binary?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1440432331, "post_id": 32186342, "comment_id": 52259001, "body": "How else would it have a garbage collector if it wasn&#39;t compiled into the binary? (or at least linked in at runtime, though that&#39;s not currently available) A garbage collector can&#39;t really run as a separate process."}, {"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440432748, "post_id": 32186342, "comment_id": 52259240, "body": "I never said another process, just running concurrently, so a thread."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1440432834, "post_id": 32186342, "comment_id": 52259278, "body": "A thread would need to be spawned from within the code, so again, it would need to be compiled into the binary in some way."}, {"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1440432872, "post_id": 32186342, "comment_id": 52259295, "body": "Yeah, that&#39;s been said."}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1440440087, "post_id": 32186777, "comment_id": 52263078, "body": "For <code>linux&#47;amd64</code>, <code>import runtime</code> is 1.1 MB and  <code>import runtime</code> plus <code>import fmt</code> is 2.4 MB."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1440485029, "post_id": 32186777, "comment_id": 52279084, "body": "@peterSO For <code>windows&#47;amd64</code> the runtime is 0.99 MB, and with <code>fmt</code> included it is 2.36 MB."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 17, "last_activity_date": 1440432953, "last_edit_date": 1440432953, "creation_date": 1440432188, "answer_id": 32186777, "question_id": 32186342, "link": "https://stackoverflow.com/questions/32186342/how-does-golangs-garbage-collector-work-when-compiled/32186777#32186777", "title": "How does golang&#39;s garbage collector work when compiled?", "body": "<p>The compiled object files do not contain any garbage collector \"code\".</p>\n\n<p>When a program is run with <code>go run</code>, the <code>go</code> command will compile your sources, create and start an executable binary in a temp folder. See below.</p>\n\n<p>When an application is compiled and linked into an executable binary, a go <em>runtime</em> is also included in the executable which is loaded when the binary is started. This runtime provides the garbage collector amongst other services such as runtime reflection and stacktrace information. This is the main reason why a simple Hello World application results in like a 2 MB executable binary.</p>\n"}], "owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1713, "favorite_count": 4, "accepted_answer_id": 32186777, "answer_count": 1, "score": 11, "last_activity_date": 1440432953, "creation_date": 1440430835, "question_id": 32186342, "link": "https://stackoverflow.com/questions/32186342/how-does-golangs-garbage-collector-work-when-compiled", "title": "How does golang&#39;s garbage collector work when compiled?", "body": "<p>I'm trying to understand how does golang's garbage collector work when the golang code is compiled and I guess when using go run as well.  I figure go run is a little more straight forward and just runs the garbage collector along with the .go files you are running.  But is the garbage collector compiled into the binaries as well when compiling to an executable?</p>\n"}, {"tags": ["bash", "go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1440429308, "post_id": 32180434, "comment_id": 52257034, "body": "(Not an answer but still...) IIUC, you&#39;re not supposed to ever call <code>go build</code> if you&#39;re using <code>go install</code>. I mean, <code>go build</code> is for one-off builds while <code>go install</code> is what anyone should use for edit-run-reedit workflow. While this might be counter-intuitive for people coming from different environments (the verb &quot;install&quot; suggests <code>go install</code> is sort of <i>final</i> i.e. <i>deployment</i> step), in fact <code>go install</code> reuses already compiled <i>dependent</i> packages while <code>go build</code> recompiles the whole thing each time and then throws the intermediate object files away."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1440431889, "post_id": 32180434, "comment_id": 52258758, "body": "i completely agree with you @kostix. I use go build to to generate builds and test immediately but without doing go install, go build takes lot&#39;s of time to build every time."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1440432154, "post_id": 32180434, "comment_id": 52258909, "body": "Moreover point is whether go install behavior is changed or not."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440440177, "post_id": 32180434, "comment_id": 52263141, "body": "@MayankPatel, if <code>go build</code> takes longer than <code>go install</code> it&#39;s almost certainly because you have un-installed dependencies (you can run <code>go build -v</code> to see what it&#39;s doing). Doing either <code>go install</code> <i>or</i> <code>go build -i</code> should install the dependant packages such that further <code>go build</code>s will only need to build things that have changed."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 8, "last_activity_date": 1449719921, "last_edit_date": 1449719921, "creation_date": 1440414407, "answer_id": 32180800, "question_id": 32180434, "link": "https://stackoverflow.com/questions/32180434/go-1-5-is-go-install-behaviour-changed-removing-stale-executables/32180800#32180800", "title": "go 1.5 : Is &quot;go install&quot; behaviour changed? Removing stale executables?", "body": "<p>Yes, the behaviour has <a href=\"https://go-review.googlesource.com/#/c/10682/\" rel=\"nofollow noreferrer\">changed</a> in Go 1.5:</p>\n\n<blockquote>\n  <p>If 'go install' (with no arguments, meaning the current directory) succeeds, remove the executable written by 'go build', if present. This avoids leaving a stale binary behind during a sequence like:</p>\n\n<pre><code>go build\n&lt;test, mostly works, make small change&gt;\ngo install\n</code></pre>\n  \n  <p>Before this CL, the current directory still has the stale binary from 'go build'. If $PATH contains dot, running the name of the program will find this stale binary instead of the new, installed one.</p>\n</blockquote>\n\n<p>I can't find anything mentioning that in the <a href=\"http://golang.org/doc/go1.5\" rel=\"nofollow noreferrer\">release notes</a> though. Might be a documentation issue.</p>\n\n<p>It seems like the solution is to use the binary that <code>go install</code> has produced.</p>\n\n<p><strong>EDIT:</strong> <a href=\"https://github.com/golang/go/issues/12288\" rel=\"nofollow noreferrer\">Here</a> is the issue on the Go issue tracker if you want to follow on updates. Should be fixed by 1.5.1.</p>\n"}], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 32180800, "answer_count": 1, "score": 8, "last_activity_date": 1449719921, "creation_date": 1440413303, "last_edit_date": 1440425118, "question_id": 32180434, "link": "https://stackoverflow.com/questions/32180434/go-1-5-is-go-install-behaviour-changed-removing-stale-executables", "title": "go 1.5 : Is &quot;go install&quot; behaviour changed? Removing stale executables?", "body": "<p>Till Go 1.4.2 when i run go install after running go build, i could find binary file in my current folder. Hence following Linux command was working</p>\n\n<blockquote>\n  <p>$ go build &amp;&amp; go install &amp;&amp; ./executable</p>\n</blockquote>\n\n<p>But after installing go 1.5, when i run same command i get,</p>\n\n<blockquote>\n  <p>-bash: ./executable: No such file or directory</p>\n</blockquote>\n\n<p>and when i checked, there is no executable to find. Did go install behavior changed in Go 1.5?</p>\n"}, {"tags": ["testing", "go", "internal"], "answers": [{"comments": [{"owner": {"reputation": 1797, "user_id": 633626, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/VacBs.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/633626/george"}, "edited": false, "score": 1, "creation_date": 1587989218, "post_id": 32180469, "comment_id": 108717317, "body": "Go supports declaring a package suffixed &quot;_test&quot; in the same folder as the main package - see <a href=\"https://tip.golang.org/cmd/go/#hdr-Test_packages\" rel=\"nofollow noreferrer\">tip.golang.org/cmd/go/#hdr-Test_packages</a> &quot;test files that declare a package with the suffix &quot;_test&quot; will be compiled as a separate package, and then linked and run with the main test binary&quot;.  That&#39;s specifically so that you can have tests inline with source without having to include them in the same package, which I&#39;d argue is generally an antipattern because it tests internals vs exported API, and includes test methods in the exported API."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 11, "last_activity_date": 1561530041, "last_edit_date": 1561530041, "creation_date": 1440413394, "answer_id": 32180469, "question_id": 32180341, "link": "https://stackoverflow.com/questions/32180341/go-test-internal-functions/32180469#32180469", "title": "Go: test internal functions", "body": "<p>Why do you place your tests in a different package? The go testing mechanism uses <code>_test</code> as a suffix for test files so you can place tests in the same packages as the actual code, avoiding the problem you describe. Placing tests in a separate package is not idiomatic Go. Do not try to fight the Go conventions, it's not worth the effort and you are mostly going to lose the fight.</p>\n"}, {"tags": [], "owner": {"reputation": 3210, "user_id": 379906, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d0d2b9a421355f4a5bab3658c6f6b41d?s=128&d=identicon&r=PG", "display_name": "db80", "link": "https://stackoverflow.com/users/379906/db80"}, "is_accepted": false, "score": 2, "last_activity_date": 1509097520, "creation_date": 1509097520, "answer_id": 46972120, "question_id": 32180341, "link": "https://stackoverflow.com/questions/32180341/go-test-internal-functions/46972120#46972120", "title": "Go: test internal functions", "body": "<p><em>Go insists that files in the same folder belong to the same package, that is except for <code>_test.go</code> files. Moving your test code out of the package allows you to write tests as though you were a real user of the package. You cannot fiddle around with the internals, instead you focus on the exposed interface and are always thinking about any noise that you might be adding to your API.</em></p>\n\n<p>And:</p>\n\n<p><em>If you do need to unit test some internals, create another file with <code>_internal_test.go</code> as the suffix. Internal tests will necessarily be more brittle than your interface tests\u200a\u2014\u200abut they\u2019re a great way to ensure internal components are behaving, and are especially useful if you do test-driven development.</em></p>\n\n<p>Source: <a href=\"https://medium.com/@matryer/5-simple-tips-and-tricks-for-writing-unit-tests-in-golang-619653f90742\" rel=\"nofollow noreferrer\">https://medium.com/@matryer/5-simple-tips-and-tricks-for-writing-unit-tests-in-golang-619653f90742</a></p>\n\n<p>There are different opinions on how you should struct you tests within a golang project and I suggest you to read the blog above.</p>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4523, "favorite_count": 0, "accepted_answer_id": 32180469, "answer_count": 2, "score": 3, "last_activity_date": 1561530041, "creation_date": 1440413021, "question_id": 32180341, "link": "https://stackoverflow.com/questions/32180341/go-test-internal-functions", "title": "Go: test internal functions", "body": "<p>Suppose I have a type <code>MyType</code> with a private method <code>(mt *MyType) private()</code> in a package <code>mypackage</code>.\nI also have a directory <code>tests</code>, where I want to store tests for my package. This is how <code>tests/mypackage_test.go</code> looks like:</p>\n\n<pre><code>package mypackage_test\n\nimport (\n    \"testing\"\n    \"myproj/mypackage\"\n)\n\nfunc TestPrivate(t *testing.T) {\n    // Some test code\n}\n</code></pre>\n\n<p>However, when I run <code>go test</code> I get the <code>cannot refer to unexported field or method my package.(*MyType).\"\".private)</code> error. I've googled a bit and found out that functions starting with lower case can not be seen outside their own package (and this seems to be true, 'cause upper case functions are freely callable from the tests).</p>\n\n<p>I also read somewhere that adding <code>&lt;...&gt;_internal_test.go</code> to the test file could solve my problem like this (<code>tests/mypackage_internal_test.go</code>):</p>\n\n<pre><code>package mypackage\n\nimport (\n    \"testing\"\n)\n\nfunc TestPrivate(t *testing.T) {\n\n    mt := &amp;MyType{}\n    // Some test code\n}  \n</code></pre>\n\n<p>But with this I only get <code>undefined: MyType</code>. So, my question: how can I test internal/private methods?</p>\n"}, {"tags": ["go", "configuration", "ide", "geany"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1440411072, "post_id": 32179428, "comment_id": 52244668, "body": "What version of Geany are you running? The updated symbol parser for Go was added in 1.25."}, {"owner": {"reputation": 11, "user_id": 1149593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de5027b536dd17ad30a675f7b239027?s=128&d=identicon&r=PG", "display_name": "user1149593", "link": "https://stackoverflow.com/users/1149593/user1149593"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1440413577, "post_id": 32179428, "comment_id": 52246280, "body": "Thank you Tim. I was using 1.23. I installed 1.25 from the source and now it works"}], "answers": [{"tags": [], "owner": {"reputation": 6360, "user_id": 2915834, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/26a24857b307c5372dd62b545083a6c2?s=128&d=identicon&r=PG&f=1", "display_name": "frlan", "link": "https://stackoverflow.com/users/2915834/frlan"}, "is_accepted": false, "score": 0, "last_activity_date": 1442339088, "creation_date": 1442339088, "answer_id": 32592460, "question_id": 32179428, "link": "https://stackoverflow.com/questions/32179428/geany-symbol-list-for-golang/32592460#32592460", "title": "Geany Symbol list for golang", "body": "<p>The parser has been added with <a href=\"https://github.com/geany/geany/blob/1.25.0/NEWS#L78\" rel=\"nofollow\">release 1.25</a> and will be enabled, once Geany is detecting you are editing a Go file. In default this is done e.g. by loading a *.go file or by manual setting via document menu. </p>\n"}], "owner": {"reputation": 11, "user_id": 1149593, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de5027b536dd17ad30a675f7b239027?s=128&d=identicon&r=PG", "display_name": "user1149593", "link": "https://stackoverflow.com/users/1149593/user1149593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1442339088, "creation_date": 1440410306, "question_id": 32179428, "link": "https://stackoverflow.com/questions/32179428/geany-symbol-list-for-golang", "title": "Geany Symbol list for golang", "body": "<p>How can I configure Geany to display structs and functions in the sidebar's  Symbols list?</p>\n\n<p>Currently it says \"No tags found\".</p>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440411887, "post_id": 32176683, "comment_id": 52245169, "body": "Do we talk about <a href=\"https://en.wikipedia.org/wiki/Communicating_sequential_processes\" rel=\"nofollow noreferrer\">Communicating Sequential Processes</a> or <a href=\"https://en.wikipedia.org/wiki/Constraint_Satisfaction_Problem\" rel=\"nofollow noreferrer\">Constraint Satisfaction Problem</a> ? I would tend for the first, but who knows ?"}, {"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "reply_to_user": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440415332, "post_id": 32176683, "comment_id": 52247397, "body": "Given the tags I&#39;d say it pretty obvious (one of them is Communicating Sequential Processes) , but I&#39;ll edit the question to aid the unobservant."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440420593, "post_id": 32176683, "comment_id": 52250876, "body": "Didin&#39;t looked at the tag... however, the edit should prove useful."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440420783, "post_id": 32176683, "comment_id": 52250997, "body": "And I don&#39;t know of any standard graphical modeling language, even if I don&#39;t doubt that UML can do it."}, {"owner": {"reputation": 15641, "user_id": 1567738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1065193e064ef75f6278754f7f02abb6?s=128&d=identicon&r=PG", "display_name": "Intermernet", "link": "https://stackoverflow.com/users/1567738/intermernet"}, "edited": false, "score": 1, "creation_date": 1440424384, "post_id": 32176683, "comment_id": 52253495, "body": "Some UML to CSP related PDFs: <a href=\"http://www.ijcsi.org/papers/IJCSI-8-2-368-374.pdf\" rel=\"nofollow noreferrer\">ijcsi.org/papers/IJCSI-8-2-368-374.pdf</a> , <a href=\"http://www.informatik.uni-marburg.de/~swt/agtive-contest/UML-to-CSP.pdf\" rel=\"nofollow noreferrer\">informatik.uni-marburg.de/~swt/agtive-contest/UML-to-CSP.pdf</a> . The first link references the second, but there are a few more references in there as well, including <a href=\"http://www-i3.informatik.rwth-aachen.de/files/agtivetc/UML_to_CSP.pdf\" rel=\"nofollow noreferrer\">www-i3.informatik.rwth-aachen.de/files/agtivetc/UML_to_CSP.p&zwnj;&#8203;df</a> (&quot;Using PROGRES for Transforming UML Activity Diagrams into CSP Expressions &quot;) <i>&quot;In this paper, we describe how an UML activity diagram can be transformed into a corresponding CSP expression by using the graph rewriting language PROGRES&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 232, "user_id": 1125516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/544b3eab335264edb1547e485885e23a?s=128&d=identicon&r=PG", "display_name": "user1125516", "link": "https://stackoverflow.com/users/1125516/user1125516"}, "edited": false, "score": 0, "creation_date": 1504028597, "post_id": 33962679, "comment_id": 78848952, "body": "Hi Jim, I tried to use TERRA but I find it quite difficult to understand the errors generated by the validation. Is there some sort of documentation or tutorial on how to use the interface. The docs listed in the project web site are just the papers regarding the tool.  Also, if you have a link to your course or the materials, it would be nice because I am myself learning CSP"}, {"owner": {"reputation": 844, "user_id": 4721873, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/fRpem.jpg?s=128&g=1", "display_name": "Jim McAdams", "link": "https://stackoverflow.com/users/4721873/jim-mcadams"}, "reply_to_user": {"reputation": 232, "user_id": 1125516, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/544b3eab335264edb1547e485885e23a?s=128&d=identicon&r=PG", "display_name": "user1125516", "link": "https://stackoverflow.com/users/1125516/user1125516"}, "edited": false, "score": 0, "creation_date": 1504556025, "post_id": 33962679, "comment_id": 79047215, "body": "@user1125516 Sure, it&#39;s quite a lot of material though. You might want to have a quick look at the video material, recorded during the course, first. <a href=\"https://vimeo.com/search?q=%22Real-time+Software+Development%22+16-17\" rel=\"nofollow noreferrer\">vimeo.com/search?q=%22Real-time+Software+Development%22+16-1&zwnj;&#8203;7</a> You&#39;ll find my contact details in my profile for more questions."}], "tags": [], "owner": {"reputation": 844, "user_id": 4721873, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/fRpem.jpg?s=128&g=1", "display_name": "Jim McAdams", "link": "https://stackoverflow.com/users/4721873/jim-mcadams"}, "is_accepted": false, "score": 1, "last_activity_date": 1448647041, "creation_date": 1448647041, "answer_id": 33962679, "question_id": 32176683, "link": "https://stackoverflow.com/questions/32176683/modelling-concurrent-programs-implemented-using-csp/33962679#33962679", "title": "Modelling concurrent programs implemented using CSP", "body": "<p>A little bit off-topic but for my thesis I used a tool framework called <a href=\"http://www.ce.utwente.nl/ECSSoftware/\" rel=\"nofollow noreferrer\">TERRA/LUNA</a> which aims for software development for Embedded Control Systems but is used heavily for all sorts of software development at my institute.\nI don't think there is a \" recognised graphical modelling language\" yet but\nTERRA is a graphical CSP and software architecture editor so maybe it'll help checking how they implement CSP graphically.\nIn a nut-shell you've got Readers, Writers and Ports in order to use the CSP channels which connect the CSP processes and you can put them all in a relation to other processes like \"parallel\" or \"sequential\". \nA typical construct could look like this:\n<a href=\"https://i.stack.imgur.com/8mNSg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8mNSg.png\" alt=\"enter image description here\"></a></p>\n\n<p>There is also <a href=\"http://www.ce.utwente.nl/ECSSoftware/documentation.php\" rel=\"nofollow noreferrer\">material</a> that documents the development of the framework and explains the motivation behind how the implementation was chosen for.</p>\n"}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1483433465, "creation_date": 1440401563, "last_edit_date": 1483433465, "question_id": 32176683, "link": "https://stackoverflow.com/questions/32176683/modelling-concurrent-programs-implemented-using-csp", "title": "Modelling concurrent programs implemented using CSP", "body": "<p>Is there a recognised graphical modelling language for Communicating Sequential Processes? </p>\n\n<p>I'm learning how to implement concurrent programs via CSP using Go. Before I write code I want to explore and model various patterns/designs.</p>\n\n<p>======== EDIT ========</p>\n\n<p>Have starting reading this <a href=\"http://www.usingcsp.com/cspbook.pdf\" rel=\"nofollow\">http://www.usingcsp.com/cspbook.pdf</a></p>\n"}, {"tags": ["google-app-engine", "go", "webrtc"], "owner": {"reputation": 55, "user_id": 2881801, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a197c9b72e5498a7255f6b65a7dcfcb8?s=128&d=identicon&r=PG&f=1", "display_name": "Draft 7.30", "link": "https://stackoverflow.com/users/2881801/draft-7-30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1440430427, "creation_date": 1440400023, "last_edit_date": 1440430427, "question_id": 32176276, "link": "https://stackoverflow.com/questions/32176276/goapprtc-works-on-google-appengine-but-not-locally", "title": "&#39;goapprtc&#39; works on Google Appengine but not locally", "body": "<p>I'm working with '<a href=\"https://github.com/dgv/goapprtc.appspot.com\" rel=\"nofollow\">goapprtc</a>' without any code change.</p>\n\n<p>When I delployed it on Google Appengine, it works very well. But when I run it on local server with 'dev_appserver.py':</p>\n\n<pre><code>dev_appserver.py goapprtc --host 0.0.0.0\n</code></pre>\n\n<p>remote two peers can connect to server, but cannot meet together.\nThey show only themselves, and 'connecting' message remain bottom.\nI stopped firewall of local server, but the result was same.</p>\n\n<p>1) So, why is that? What should I care about? Is this a problem with TURN Server or something?</p>\n\n<p>2) If I want to run this server without 'dev_appserver.py', how can I modify the code? What packages can I use instead of 'appengine' packages:</p>\n\n<pre><code>\"appengine\"\n\"appengine/channel\"\n\"appengine/datastore\"\n\"appengine/urlfetch\"\n</code></pre>\n\n<p>Command line messages here:    </p>\n\n<pre><code>C:\\&gt;dev_appserver.py goapprtc.appspot.com-master --host 0.0.0.0\nINFO     2015-08-24 16:14:08,477 sdk_update_checker.py:229] Checking for updates\n to the SDK.\nINFO     2015-08-24 16:14:10,634 sdk_update_checker.py:257] The SDK is up to dat\ne.\nINFO     2015-08-24 16:14:10,711 api_server.py:205] Starting API server at: http\n://localhost:49641\nINFO     2015-08-24 16:14:10,727 dispatcher.py:197] Starting module \"default\" ru\nnning at: http://0.0.0.0:8080\nINFO     2015-08-24 16:14:10,727 admin_server.py:118] Starting admin server at:\nhttp://localhost:8000\n2015/08/24 16:15:02 INFO: Applying media constraints: &amp;{true true}\n2015/08/24 16:15:02 INFO: User 66666666 added to room 1234\n2015/08/24 16:15:02 INFO: Room 1234 has state &amp;{66666666  false false}\nINFO     2015-08-24 16:15:02,305 module.py:808] default: \"GET /?r=1234 HTTP/1.1\"\n 200 1681\nINFO     2015-08-24 16:15:02,384 module.py:808] default: \"GET /css/main.css HTTP\n/1.1\" 304 -\nINFO     2015-08-24 16:15:02,390 module.py:808] default: \"GET /js/main.js HTTP/1\n.1\" 304 -\nINFO     2015-08-24 16:15:02,391 module.py:808] default: \"GET /js/adapter.js HTT\nP/1.1\" 304 -\nINFO     2015-08-24 16:15:02,394 module.py:808] default: \"GET /images/goapprtc.g\nif HTTP/1.1\" 304 -\n2015/08/24 16:15:03 INFO: User 66666666 connected to room 1234\n2015/08/24 16:15:03 INFO: Room 1234 has state &amp;{66666666  true false}\nINFO     2015-08-24 16:15:03,486 module.py:808] default: \"POST /_ah/channel/conn\nected/ HTTP/1.1\" 200 -\n2015/08/24 16:15:26 INFO: Applying media constraints: &amp;{true true}\n2015/08/24 16:15:26 INFO: User 44444444 added to room 1234\n2015/08/24 16:15:26 INFO: Room 1234 has state &amp;{66666666 44444444 true false}\nINFO     2015-08-24 16:15:26,638 module.py:808] default: \"GET /?r=1234 HTTP/1.1\"\n 200 1691\nINFO     2015-08-24 16:15:26,796 module.py:808] default: \"GET /css/main.css HTTP\n/1.1\" 304 -\nINFO     2015-08-24 16:15:26,801 module.py:808] default: \"GET /js/main.js HTTP/1\n.1\" 304 -\nINFO     2015-08-24 16:15:26,802 module.py:808] default: \"GET /js/adapter.js HTT\nP/1.1\" 304 -\nINFO     2015-08-24 16:15:26,805 module.py:808] default: \"GET /images/goapprtc.g\nif HTTP/1.1\" 304 -\n2015/08/24 16:15:28 INFO: User 44444444 connected to room 1234\n2015/08/24 16:15:28 INFO: Room 1234 has state &amp;{66666666 44444444 true true}\nINFO     2015-08-24 16:15:28,387 module.py:808] default: \"POST /_ah/channel/conn\nected/ HTTP/1.1\" 200 -\n2015/08/24 16:15:29 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:29,716 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:29 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:29,806 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:30,772 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:30,871 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:30,938 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\n2015/08/24 16:15:30 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:30,967 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:30,970 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:30,970 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:31 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:31,825 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:31 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:31,927 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:31 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:31,996 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 66666666\n2015/08/24 16:15:32 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:32,065 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 66666666\nINFO     2015-08-24 16:15:32,069 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:32,075 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\nINFO     2015-08-24 16:15:32,104 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\nINFO     2015-08-24 16:15:32,121 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\nINFO     2015-08-24 16:15:32,147 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\n2015/08/24 16:15:32 INFO: Delivered message to user 44444444\nINFO     2015-08-24 16:15:32,188 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:32,190 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:32,191 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: User 44444444 removed from room 1234\n2015/08/24 16:15:32 INFO: Room 1234 has state &amp;{66666666  true false}\n2015/08/24 16:15:32 INFO: Sent BYE to 66666666\n2015/08/24 16:15:32 WARNING: User 44444444 disconnected from room 1234\nINFO     2015-08-24 16:15:32,848 module.py:808] default: \"POST /_ah/channel/disc\nonnected/ HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:32,904 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:32 INFO: User 66666666 removed from room 1234\n2015/08/24 16:15:32 INFO: Room 1234 has state &amp;{  false false}\n2015/08/24 16:15:32 WARNING: User 66666666 disconnected from room 1234\nINFO     2015-08-24 16:15:32,969 module.py:808] default: \"POST /_ah/channel/disc\nonnected/ HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,022 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,082 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,131 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,151 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,183 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,191 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,206 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,213 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,220 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,223 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:33,957 module.py:808] default: \"POST /message?r=1234&amp;u\n=44444444 HTTP/1.1\" 200 -\n2015/08/24 16:15:34 ERROR: datastore: datastore: no such entity\n2015/08/24 16:15:34 WARNING: Unexpected Connect Message to room 1234\nINFO     2015-08-24 16:15:34,072 module.py:808] default: \"POST /_ah/channel/conn\nected/ HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,148 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,170 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,239 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,243 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,243 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:34,346 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:35,153 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\nINFO     2015-08-24 16:15:35,183 module.py:808] default: \"POST /message?r=1234&amp;u\n=66666666 HTTP/1.1\" 200 -\n2015/08/24 16:15:35 ERROR: datastore: datastore: no such entity\n2015/08/24 16:15:35 WARNING: Unexpected Connect Message to room 1234\nINFO     2015-08-24 16:15:35,255 module.py:808] default: \"POST /_ah/channel/conn\nected/ HTTP/1.1\" 200 -\n</code></pre>\n\n<p>Thank you for reading.\nSorry for poor question!</p>\n"}, {"tags": ["ssl", "go", "https"], "answers": [{"tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": false, "score": 2, "last_activity_date": 1440400016, "creation_date": 1440400016, "answer_id": 32176274, "question_id": 32175300, "link": "https://stackoverflow.com/questions/32175300/http-listenandservetls-with-multiple-certificates/32176274#32176274", "title": "http.ListenAndServeTLS with multiple certificates", "body": "<p>I'm no Go user myself but if you want to use multiple certificates on the same TLS listener you must have some way to decide which certificate should be used once a client connects because only a single certificate + chain can be sent inside the TLS handshake.</p>\n\n<p>The main use case for this is <a href=\"https://en.wikipedia.org/wiki/Server_Name_Indication\" rel=\"nofollow\">Server Name Indication (SNI)</a>. With SNI you have multiple certificates and you want to select the appropriate one based on the name the client asked for within the TLS handshake.</p>\n\n<p>Searching for <a href=\"https://www.google.com/search?q=go+sni+server\" rel=\"nofollow\">go sni server</a> results in <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/rUm2iYTdrU4\" rel=\"nofollow\">this post from 2013</a>. This post shows that using multiple certificates with ListenAndServeTLS is not possible (or was in 2013) but it also shows how to achieve the necessary functionality.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 12, "last_activity_date": 1440429703, "last_edit_date": 1440429703, "creation_date": 1440426542, "answer_id": 32184828, "question_id": 32175300, "link": "https://stackoverflow.com/questions/32175300/http-listenandservetls-with-multiple-certificates/32184828#32184828", "title": "http.ListenAndServeTLS with multiple certificates", "body": "<p><code>http.ListenAndServeTLS</code> is meant to be present a bare minimal configuration. If you want to add other options, you can create an <code>http.Server</code> with a custom <code>tls.Config</code>. You can then either manually map names in <code>tls.Config.NameToCertificate</code>, or call <code>BuildNameToCertificate()</code> to build the map programatically.</p>\n\n<p>You can still use <code>Server.ListenAndServeTLS</code> however, since it will load the certs in the config as well a cert passed in via the methods args.</p>\n\n<pre><code>cfg := &amp;tls.Config{}\n\ncert, err := tls.LoadX509KeyPair(\"cert_one.pem\", \"key_one.pem\")\nif err != nil {\n    log.Fatal(err)\n}\n\ncfg.Certificates = append(cfg.Certificates, cert)\n// keep adding remaining certs to cfg.Certificates\n\ncfg.BuildNameToCertificate()\n\nserver := http.Server{\n    Addr:      \"127.0.0.1:443\",\n    Handler:   myHandler,\n    TLSConfig: cfg,\n}\n\nserver.ListenAndServeTLS(\"\", \"\")\n</code></pre>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2535, "favorite_count": 4, "accepted_answer_id": 32184828, "answer_count": 2, "score": 5, "last_activity_date": 1440429703, "creation_date": 1440395907, "question_id": 32175300, "link": "https://stackoverflow.com/questions/32175300/http-listenandservetls-with-multiple-certificates", "title": "http.ListenAndServeTLS with multiple certificates", "body": "<p>How do I ListenAndServeTLS with multiple domains? I see the function accepts a cert and key file, but I believe the key file may only contain a single private key. I have a few private keys, for different certificate chains.</p>\n"}, {"tags": ["windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 7726, "user_id": 395461, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de67dae243e2d6f4654aa3ea48ee8626?s=128&d=identicon&r=PG", "display_name": "Shannon Matthews", "link": "https://stackoverflow.com/users/395461/shannon-matthews"}, "edited": false, "score": 0, "creation_date": 1440395548, "post_id": 32174988, "comment_id": 52236442, "body": "Thanks Icza! I was pulling my hair out there. :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7726, "user_id": 395461, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de67dae243e2d6f4654aa3ea48ee8626?s=128&d=identicon&r=PG", "display_name": "Shannon Matthews", "link": "https://stackoverflow.com/users/395461/shannon-matthews"}, "edited": false, "score": 0, "creation_date": 1440396832, "post_id": 32174988, "comment_id": 52236941, "body": "@Shannon That&#39;s a good indication that it&#39;s time to post on SO :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1440396780, "last_edit_date": 1440396780, "creation_date": 1440394152, "answer_id": 32174988, "question_id": 32173871, "link": "https://stackoverflow.com/questions/32173871/show-file-in-windows-explorer-using-go/32174988#32174988", "title": "Show file in Windows Explorer using Go?", "body": "<p>You can get it to work if you separate the <code>/select,</code> action and the actual path, and you pass them as separate parameters:</p>\n\n<pre><code>exec.Command(`explorer`, `/select,`, `C:\\data\\My File.txt`)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9395, "user_id": 79125, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/UyhpI.jpg?s=128&g=1", "display_name": "idbrii", "link": "https://stackoverflow.com/users/79125/idbrii"}, "is_accepted": false, "score": 2, "last_activity_date": 1552081687, "creation_date": 1552081687, "answer_id": 55071466, "question_id": 32173871, "link": "https://stackoverflow.com/questions/32173871/show-file-in-windows-explorer-using-go/55071466#55071466", "title": "Show file in Windows Explorer using Go?", "body": "<p>A more complete answer for the golang newbies (like myself):</p>\n\n<pre><code>package main\nimport (\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(`explorer`, `/select,`, `C:\\data\\My File.txt`)\n    cmd.Run()\n}\n</code></pre>\n"}], "owner": {"reputation": 7726, "user_id": 395461, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/de67dae243e2d6f4654aa3ea48ee8626?s=128&d=identicon&r=PG", "display_name": "Shannon Matthews", "link": "https://stackoverflow.com/users/395461/shannon-matthews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "accepted_answer_id": 32174988, "answer_count": 2, "score": 2, "last_activity_date": 1552607911, "creation_date": 1440384941, "last_edit_date": 1552607911, "question_id": 32173871, "link": "https://stackoverflow.com/questions/32173871/show-file-in-windows-explorer-using-go", "title": "Show file in Windows Explorer using Go?", "body": "<p>How do you show a file in windows explorer using Go?</p>\n\n<p>This command works as expected from the command line:</p>\n\n<pre><code>explorer /select,C:\\data\\My File.txt\n</code></pre>\n\n<p>I can't get the same command to work using Go's <code>exec.Command()</code> method, no matter what combination of arguments tried. </p>\n\n<p>This works: </p>\n\n<pre><code>exec.Command(`explorer`, `/select,C:\\data\\MyFile.txt`) // SUCCEEDS \n</code></pre>\n\n<p>but fails with a space in the filename.</p>\n\n<pre><code>exec.Command(`explorer`, `/select,C:\\data\\My File.txt`) // FAILS \n</code></pre>\n\n<p>Notes: </p>\n\n<ul>\n<li><a href=\"https://support.microsoft.com/en-us/kb/152457\" rel=\"nofollow noreferrer\">Explorer command line flag documentation</a> </li>\n<li><a href=\"https://golang.org/pkg/os/exec/#Command\" rel=\"nofollow noreferrer\">os/exec Command() documentation.</a> </li>\n</ul>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1440427656, "post_id": 32173373, "comment_id": 52255867, "body": "Avoid using builtin <code>print</code>/<code>println</code>, as the implementation is is different than that of <code>fmt</code>. Even better, if you&#39;re debugging anything concurrent, use <code>log</code>, as it serializes concurrent calls, and can automatically add timestamps, filenames, etc."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": true, "score": 3, "last_activity_date": 1440382760, "creation_date": 1440382760, "answer_id": 32173644, "question_id": 32173373, "link": "https://stackoverflow.com/questions/32173373/go-lang-channel-processing-sequence/32173644#32173644", "title": "Go lang, channel processing sequence", "body": "<p>In your first example, <code>x, y := &lt;-c, &lt;-c</code> will block until it reads off <code>c</code> twice, and then assign values to <code>x, y</code>.  Channels aside, you have an assignment, a print statement, then another print statement.  Those are all synchronous things, and will happen in the order you state them in.  There's no way the second print statement would print first.</p>\n\n<p>The second one is because <code>fmt.Println</code> writes to STDOUT and <code>println</code> to STDERR. If you are consistent (say use <code>println</code> everywhere) then you see:</p>\n\n<pre><code>10\nCalled\n20\n20\n</code></pre>\n\n<p>That's cause there's a race between the first <code>println(t.i)</code> in the main and the <code>println(\"Called\")</code> that's happening in the goroutine.  I'm guessing with <code>GOMAXPROCS</code> set to 1, this will happen consistently.  With <code>GOMAXPROCS</code> set to <code>NumCPU</code>, I get a mix of results, sometimes looking like the above, and sometimes like this:</p>\n\n<pre><code>10Called\n\n20\n20\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4967469, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/060c156e1c1ec768a0fbbee0d03dc739?s=128&d=identicon&r=PG&f=1", "display_name": "Nerd", "link": "https://stackoverflow.com/users/4967469/nerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 32173644, "answer_count": 1, "score": 0, "last_activity_date": 1440382760, "creation_date": 1440380332, "question_id": 32173373, "link": "https://stackoverflow.com/questions/32173373/go-lang-channel-processing-sequence", "title": "Go lang, channel processing sequence", "body": "<p>I'm studying Go lang through 'A tour of Go', and it's hard to understand Go channel running sequence,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc sum(a []int, c chan int) {\n\n    sum := 0\n    for _, v := range a {\n        time.Sleep(1000 * time.Millisecond)\n        sum += v\n    }\n    c &lt;- sum // send sum to c\n}\n\nfunc main() {\n    a := []int{7, 2, 8, -9, 4, 0}\n\n    c := make(chan int)\n    go sum(a[:len(a)/2], c)\n    go sum(a[len(a)/2:], c)\n    x, y := &lt;-c, &lt;-c // receive from c\n\n    fmt.Println(x, y, x+y)\n    fmt.Println(\"Print this first,\")\n}\n</code></pre>\n\n<p>If run above the code, I expected, </p>\n\n<pre><code>Print this first,\n17 -5 12\n</code></pre>\n\n<p>Because, Go routine runs as non-blocking, a But, actually it prints,</p>\n\n<pre><code>17 -5 12\nPrint this first,\n</code></pre>\n\n<p>The other example that I found in internet,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Data struct {\n    i int\n}\n\nfunc func1(c chan *Data ) {\n    fmt.Println(\"Called\")\n    for {\n        var t *Data;\n        t = &lt;-c //receive\n        t.i += 10 //increment\n        c &lt;- t   //send it back\n    }\n}\n\nfunc main() {\n    c := make(chan *Data)\n    t := Data{10}\n    go func1(c)\n    println(t.i)\n    c &lt;- &amp;t //send a pointer to our t\n    i := &lt;-c //receive the result\n    println(i.i)\n    println(t.i)\n}\n</code></pre>\n\n<p>Also, I expected, it prints \"Called\" first, but the result is </p>\n\n<pre><code>10\n20\n20\nCalled\n</code></pre>\n\n<p>What I am misunderstanding? please help me to understand Go routine and channel.  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1440394539, "post_id": 32173352, "comment_id": 52236075, "body": "1. Scheduling means determining which goroutine runs when for how long on which of the available CPU cores. 2. The operating system kernel is not involved in running or scheduling goroutines. 3. Goroutines are not forcefully stopped once they are running, their scheduling is cooperative."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1440413079, "post_id": 32173352, "comment_id": 52245996, "body": "This is the original article: <a href=\"http://dave.cheney.net/2014/06/07/five-things-that-make-go-fast\" rel=\"nofollow noreferrer\">Five things that make Go fast</a>. This article explains the phrase in more detail: <a href=\"http://dave.cheney.net/2015/08/08/performance-without-the-event-loop\" rel=\"nofollow noreferrer\">Performance without the event loop</a>. These articles are available in English and many other languages: <a href=\"https://en.wikipedia.org/wiki/Computer_multitasking#Cooperative_multitasking\" rel=\"nofollow noreferrer\">Cooperative multitasking</a> and <a href=\"https://en.wikipedia.org/wiki/Non-preemptive_multitasking\" rel=\"nofollow noreferrer\">Non-preemptive multitasking</a>."}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 4910125, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-QdookrlbU_g/AAAAAAAAAAI/AAAAAAAAABM/lOy93Mm4Vrc/photo.jpg?sz=128", "display_name": "WALID BELRHALMIA", "link": "https://stackoverflow.com/users/4910125/walid-belrhalmia"}, "edited": false, "score": 0, "creation_date": 1440415084, "post_id": 32179833, "comment_id": 52247249, "body": "the Go runtime is it self a thread ,than when it&#39;s time come to run it become it self a sheduler and shedule the execution of goroutines"}], "tags": [], "owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "is_accepted": true, "score": 3, "last_activity_date": 1440411402, "creation_date": 1440411402, "answer_id": 32179833, "question_id": 32173352, "link": "https://stackoverflow.com/questions/32173352/the-goroutines-and-the-scheduled/32179833#32179833", "title": "The Goroutines and the scheduled", "body": "<p><em>Disclaimer: this is a rough and inaccurate description of the scheduling in the kernel and in the go runtime aimed at explaining the concepts, not at being an exact or detailed explanation of the real system.</em></p>\n\n<p>As you may (or not know), a CPU can't actually run two programs at the same time: a CPU only have one <em>execution thread</em>, which can execute one instruction at a time. The direct consequence on early systems was that you couldn't run two programs at the same time, each program needing (system-wise) a dedicated thread.</p>\n\n<p>The solution currently adopted is called <em>pseudo-parallelism</em>: given a number of <em>logical threads</em> (e.g multiple programs), the system will execute one of the logical threads during a certain amount of time then switch to the next one. Using really small amounts of time (in the order of milliseconds), you give the human user the illusion of parallelism. This operation is called scheduling.</p>\n\n<p>The Go language doesn't use this system directly: it itself implement a scheduler that run on top of the system scheduler, and schedule the execution of the goroutines itself, bypassing the performance cost of using a real thread for each routine. This type of system is called <em>light/green thread</em>.</p>\n"}], "owner": {"reputation": 441, "user_id": 4910125, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-QdookrlbU_g/AAAAAAAAAAI/AAAAAAAAABM/lOy93Mm4Vrc/photo.jpg?sz=128", "display_name": "WALID BELRHALMIA", "link": "https://stackoverflow.com/users/4910125/walid-belrhalmia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 32179833, "answer_count": 1, "score": 0, "last_activity_date": 1440411402, "creation_date": 1440380163, "question_id": 32173352, "link": "https://stackoverflow.com/questions/32173352/the-goroutines-and-the-scheduled", "title": "The Goroutines and the scheduled", "body": "<p>i didn't understand this sentence plz explain me in detail and use an easy english to do that\nGo routines are cooperatively scheduled, rather than relying on the kernel to manage their time sharing.</p>\n"}, {"tags": ["optimization", "go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1440373536, "post_id": 32172287, "comment_id": 52231628, "body": "It was my impression that Go does inlining before escape analysis. So, are you <i>sure</i> NewFoo in your example allocates on the heap? I suspect it is inlined into the caller and if it doesn&#39;t escape the caller, it won&#39;t be heap allocated."}, {"owner": {"reputation": 121, "user_id": 4390258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce74681190579b09edd8dcc87a38daf?s=128&d=identicon&r=PG&f=1", "display_name": "sqroot raypin", "link": "https://stackoverflow.com/users/4390258/sqroot-raypin"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1440374612, "post_id": 32172287, "comment_id": 52231848, "body": "@Zan No, I am not sure, but now that you mentioned it I looked it up and Go does indeed do inlining. I am sorry, I had looked at three year old SO questions and go-nuts posts, which claimed that gc would allocate data on the heap when using the NewFoo idiom. I&#39;ll test this now."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440385068, "post_id": 32172287, "comment_id": 52233931, "body": "Dave C&#39;s answer is part of it: reasonably often the constructor gets inlined. When you need to pinch allocations of something, a common pattern is <code>thing.Reset()</code> to reuse an empty <code>Thing</code> and a <code>sync.Pool</code> to manage them. Of course, you can then also use <code>f.Reset()</code> in place of <code>NewFoo(f)</code> in your construction, but that isn&#39;t idiomatic--I&#39;d only do it if it led to a measurable improvement in a critical part of your program (like, a spot where a lot of garbage is generated, in a program where performance needs tuning and collection time is an important factor in that)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440385518, "post_id": 32172287, "comment_id": 52234035, "body": "Though you asked a pretty reasonable q (behavior here isn&#39;t obvious), my general advice is to build the functionality you want, then measure and tune the fatty bits only when you have nothing better to do. Life&#39;s too precious to spend too much of it sweating processor cycles. :)"}, {"owner": {"reputation": 121, "user_id": 4390258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce74681190579b09edd8dcc87a38daf?s=128&d=identicon&r=PG&f=1", "display_name": "sqroot raypin", "link": "https://stackoverflow.com/users/4390258/sqroot-raypin"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440412766, "post_id": 32172287, "comment_id": 52245778, "body": "@two Of course. My issue was that I thought of a particular compiler optimization that could&#39;ve been possible in Go but didn&#39;t know if this was even possible or if this exists. I am usually the first to try to prove myself wrong, but I couldn&#39;t come up with cases where the approach fails, and I couldn&#39;t find what I was looking for either, so I decided to ask on SO, because someone here might be able to prove me wrong or even point me in the right direction. In the end I still managed to find it myself."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 4390258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce74681190579b09edd8dcc87a38daf?s=128&d=identicon&r=PG&f=1", "display_name": "sqroot raypin", "link": "https://stackoverflow.com/users/4390258/sqroot-raypin"}, "edited": false, "score": 0, "creation_date": 1440414820, "post_id": 32172980, "comment_id": 52247076, "body": "I am accepting this answer instead of my own because my question was arguably too broad and more about optimizing away heap allocations in cases like I mentioned instead of being specifically about optimizing it via RVO."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 6, "last_activity_date": 1440376726, "creation_date": 1440376726, "answer_id": 32172980, "question_id": 32172287, "link": "https://stackoverflow.com/questions/32172287/optimizing-away-heap-allocations/32172980#32172980", "title": "Optimizing away heap allocations", "body": "<p>(Not quite an answer but too big for a comment.)</p>\n\n<p>From the comments it seems you might be interested in this small example:</p>\n\n<pre><code>package main\n\ntype Foo struct {\n    i, j, k int\n}\n\nfunc NewFoo() *Foo {\n    return &amp;Foo{i: 42}\n}\n\nfunc F1() {\n    f := NewFoo()\n    f.i++\n}\n\nfunc main() {\n    F1()\n}\n</code></pre>\n\n<p>On Go1.5 running <code>go build -gcflags=\"-m\"</code> gives:</p>\n\n<pre><code>./new.go:7: can inline NewFoo\n./new.go:11: can inline F1\n./new.go:12: inlining call to NewFoo\n./new.go:16: can inline main\n./new.go:17: inlining call to F1\n./new.go:17: inlining call to NewFoo\n./new.go:8: &amp;Foo literal escapes to heap\n./new.go:12: F1 &amp;Foo literal does not escape\n./new.go:17: main &amp;Foo literal does not escape\n</code></pre>\n\n<p>So it inlines <code>NewFoo</code> into <code>F1</code> into <code>main</code> (and says that it could further inline <code>main</code> if someone was to call it).\nAlthough it does say that in <code>NewFoo</code> itself <code>&amp;Foo</code> escapes, it does <em>not</em> escape when inlined.</p>\n\n<p>The output from <code>go build -gcflags=\"-m -S\"</code> confirms this with a <code>main</code> initializing the object on the stack and not doing any function calls.</p>\n\n<p>Of course this is a very simple example and any complications (e.g.\u00a0calling <code>fmt.Print</code> with <code>f</code>) could easily cause it to escape.\nIn general, you shouldn't worry about this too much unless profiling has told you that you have a problem area(s) and you are trying to optimize a specific section of code.\nIdiomatic and readable code should trump optimization.</p>\n\n<p>Also note that using <code>go test -bench -benchmem</code> (or preferably using <code>testing.B</code>'s <a href=\"https://golang.org/pkg/testing/#B.ReportAllocs\"><code>ReportAllocs</code></a> method) can report on allocations of benchmarked code which can help identify something doing more allocations than expected/desired.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 4390258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce74681190579b09edd8dcc87a38daf?s=128&d=identicon&r=PG&f=1", "display_name": "sqroot raypin", "link": "https://stackoverflow.com/users/4390258/sqroot-raypin"}, "is_accepted": false, "score": 2, "last_activity_date": 1440379179, "last_edit_date": 1495535195, "creation_date": 1440379179, "answer_id": 32173245, "question_id": 32172287, "link": "https://stackoverflow.com/questions/32172287/optimizing-away-heap-allocations/32173245#32173245", "title": "Optimizing away heap allocations", "body": "<p>After doing some more research I found what I was looking for.</p>\n\n<p>What I was describing is apparently called \"Return value optimization\" and is well doable, which pretty much answers my question about whether this was possible in Go as well.</p>\n\n<p>Further information about this can be found here:\n<a href=\"https://stackoverflow.com/questions/12953127/what-are-copy-elision-and-return-value-optimization\">What are copy elision and return value optimization?</a></p>\n"}], "owner": {"reputation": 121, "user_id": 4390258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ce74681190579b09edd8dcc87a38daf?s=128&d=identicon&r=PG&f=1", "display_name": "sqroot raypin", "link": "https://stackoverflow.com/users/4390258/sqroot-raypin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 32172980, "answer_count": 2, "score": -1, "last_activity_date": 1440379179, "creation_date": 1440369947, "last_edit_date": 1440370624, "question_id": 32172287, "link": "https://stackoverflow.com/questions/32172287/optimizing-away-heap-allocations", "title": "Optimizing away heap allocations", "body": "<p><em>When I am talking about Go, I am speaking about the gc compiler implementation.</em></p>\n\n<p>As far as I know, Go performs escape analysis.\nThe following idiom is seen pretty often in Go code:</p>\n\n<pre><code>func NewFoo() *Foo\n</code></pre>\n\n<p>Escape analysis would notice that Foo escapes NewFoo and allocate Foo on the heap.</p>\n\n<p>This function could also be written as:</p>\n\n<pre><code>func NewFoo(f *Foo)\n</code></pre>\n\n<p>and would be used like</p>\n\n<pre><code>var f Foo\nNewFoo(&amp;f)\n</code></pre>\n\n<p>In this case, as long as f doesn't escape anywhere else, f could be allocated on the stack.</p>\n\n<p>Now to my actual question.</p>\n\n<p>Would it be possible for the compiler to optimize every <code>foo() *Foo</code> into <code>foo(f *Foo)</code>, even possibly over multiple levels where Foo is returned in each?</p>\n\n<p>If not, in what kind of cases does this approach fail?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["unit-testing", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 22340, "user_id": 664108, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cbc8378de58e66705678686057cffac9?s=128&d=identicon&r=PG", "display_name": "Fabian Schmengler", "link": "https://stackoverflow.com/users/664108/fabian-schmengler"}, "edited": false, "score": 0, "creation_date": 1440395523, "post_id": 32172218, "comment_id": 52236431, "body": "Thanks! This explains both, my stupid mistake and the origin of <code>T.common</code>. Of course, <code>Errorf</code> was the method I wanted."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1440371936, "last_edit_date": 1440371936, "creation_date": 1440369279, "answer_id": 32172218, "question_id": 32172132, "link": "https://stackoverflow.com/questions/32172132/using-testing-t-as-anonymous-struct-field-too-many-arguments-in-call-to-this-t/32172218#32172218", "title": "Using testing.T as anonymous struct field: &quot;too many arguments in call to this.T.common.Fail&quot;", "body": "<blockquote>\n  <p><a href=\"http://golang.org/src/testing/testing.go\" rel=\"nofollow\">Source file src/testing/testing.go</a></p>\n\n<pre><code>// Fail marks the function as having failed but continues execution.\nfunc (c *common) Fail() {\n  c.mu.Lock()\n  defer c.mu.Unlock()\n  c.failed = true\n}\n\n// common holds the elements common between T and B and\n// captures common methods such as Errorf.\ntype common struct {\n  mu       sync.RWMutex // guards output and failed\n  output   []byte       // Output generated by test or benchmark.\n  failed   bool         // Test or benchmark has failed.\n  skipped  bool         // Test of benchmark has been skipped.\n  finished bool\n\n  start    time.Time // Time test or benchmark started\n  duration time.Duration\n  self     interface{}      // To be sent on signal channel when done.\n  signal   chan interface{} // Output for serial tests.\n}\n\n// T is a type passed to Test functions to manage test state and support formatted test logs.\n// Logs are accumulated during execution and dumped to standard error when done.\ntype T struct {\n  common\n  name          string    // Name of test.\n  startParallel chan bool // Parallel tests will wait on this.\n}\n</code></pre>\n  \n  <p><a href=\"http://golang.org/pkg/testing/#T.Fail\" rel=\"nofollow\">func (*T) Fail</a></p>\n\n<pre><code>func (c *T) Fail()\n</code></pre>\n  \n  <p>Fail marks the function as having failed but continues execution.</p>\n</blockquote>\n\n<p>There are no arguments to <code>T.common.Fail()</code>.</p>\n\n<p>Try <code>Errorf</code>:</p>\n\n<blockquote>\n  <p><a href=\"http://golang.org/pkg/testing/#T.Errorf\" rel=\"nofollow\">func (*T) Errorf</a></p>\n\n<pre><code>func (c *T) Errorf(format string, args ...interface{})\n</code></pre>\n  \n  <p>Errorf is equivalent to Logf followed by Fail.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>this.Errorf(\"Failed asserting that %v is %v\", actual, expected)\n</code></pre>\n"}], "owner": {"reputation": 22340, "user_id": 664108, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cbc8378de58e66705678686057cffac9?s=128&d=identicon&r=PG", "display_name": "Fabian Schmengler", "link": "https://stackoverflow.com/users/664108/fabian-schmengler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "accepted_answer_id": 32172218, "answer_count": 1, "score": 2, "last_activity_date": 1440371936, "creation_date": 1440368474, "question_id": 32172132, "link": "https://stackoverflow.com/questions/32172132/using-testing-t-as-anonymous-struct-field-too-many-arguments-in-call-to-this-t", "title": "Using testing.T as anonymous struct field: &quot;too many arguments in call to this.T.common.Fail&quot;", "body": "<p>I am trying to solve the <a href=\"http://codekata.com/kata/kata02-karate-chop/\" rel=\"nofollow\">Karate Chop</a> kata in Go as an exercise and stuck with this compiler error from my test case:</p>\n\n<blockquote>\n  <p>too many arguments in call to this.T.common.Fail</p>\n</blockquote>\n\n<p>I wrapped <code>testing.T</code> into a struct with additional methods, as an anonymous struct field:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\n\ntype assertions struct {\n    *testing.T\n}\nfunc (this assertions) assert_equal(expected int, actual int) {\n    if (expected != actual) {\n        this.Fail(fmt.Sprintf(\"Failed asserting that %v is %v\", actual, expected));\n    }\n}\n\nfunc TestChop(t *testing.T) {\n  test := assertions{t}\n\n  test.assert_equal(-1, Chop(3, []int{}))\n  test.assert_equal(-1, Chop(3, []int{1}))\n  ...\n}\n</code></pre>\n\n<p>I expect <code>this.Fail</code> to call <code>Fail()</code> on the anonymous <code>testing.T</code> struct field, which takes a string parameter. Why isn't this the case and where does <code>this.T.common.Fail</code> come from? I cannot find any reference to <code>common</code> in the <code>testing</code> package documentation.</p>\n"}, {"tags": ["go", "debian-packaging"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 4, "creation_date": 1440367045, "post_id": 32171867, "comment_id": 52230229, "body": "I think Debian itself needs to work this out: assuming they switch to dynamic linking, I imagine they&#39;d add a Go stdlib package, and you build against that version of the stdlib and make it a dependency of your .deb. If you require 1.5 to build (or just really want it for whatever reason) and Debian hasn&#39;t adopted it or written rules for it yet I&#39;m not sure just what you do."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 2, "creation_date": 1440387617, "post_id": 32171867, "comment_id": 52234450, "body": "It&#39;s not clear you can depend on it yet: it looks like Debian unstable is still on 1.4.2.  Ubuntu has updated to 1.5rc1 in wily, but doesn&#39;t install a shared library version of the standard lib, so you&#39;ll probably need to depend on static linking for a while longer."}, {"owner": {"reputation": 181, "user_id": 1370052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b6989ae8a3598b8fb608869299f2138?s=128&d=identicon&r=PG", "display_name": "zoliton", "link": "https://stackoverflow.com/users/1370052/zoliton"}, "edited": false, "score": 1, "creation_date": 1444985139, "post_id": 32171867, "comment_id": 54140452, "body": "It adds an extra level but <a href=\"https://github.com/niemeyer/godeb\" rel=\"nofollow noreferrer\">godeb</a> works quite fine for me. At least it leaves you in control."}, {"owner": {"reputation": 22991, "user_id": 1169096, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b4d93e08b2830786a7992e8af35514c6?s=128&d=identicon&r=PG", "display_name": "uml&#228;ute", "link": "https://stackoverflow.com/users/1169096/uml%c3%a4ute"}, "edited": false, "score": 0, "creation_date": 1446497838, "post_id": 32171867, "comment_id": 54758206, "body": "well, as of today <a href=\"https://tracker.debian.org/pkg/golang\" rel=\"nofollow noreferrer\">Debian go</a> is <code>1.5.1</code>."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1446583891, "post_id": 32171867, "comment_id": 54801172, "body": "Good to know, and the <a href=\"https://wiki.debian.org/MichaelStapelberg/GoPackaging\" rel=\"nofollow noreferrer\">Debian GoPackaging wiki</a> is already mentioning <i>&quot;Example binary + library packaging&quot;</i>. But that&#39;s about it, much more details need to be put in."}], "answers": [{"comments": [{"owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1454603225, "post_id": 34800584, "comment_id": 58128129, "body": "@xpt have you created a debian package before? dh-golang helper is just a piece of, well, the entire packaging procedure. I recommend using debuild instead (adding the dh-golang package to the build-dependencies). If you tell me what you are trying to create the package of, I could give you a more precise advice."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1454804782, "post_id": 34800584, "comment_id": 58210244, "body": "That&#39;d be super, thanks a lot @Braiam. Yes, I maintain several Debian packages myself, two of which are in the official Debian repo. Let&#39;s start with <a href=\"https://github.com/suntong/ffcvt/\" rel=\"nofollow noreferrer\">github.com/suntong/ffcvt</a>, which does not require any third part libs or its own (like <a href=\"https://github.com/suntong/easygen\" rel=\"nofollow noreferrer\">github.com/suntong/easygen</a>). Thanks!"}, {"owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1454853564, "post_id": 34800584, "comment_id": 58221145, "body": "@xpt I did a very basic branch with the debian directory here <a href=\"https://github.com/braiam/ffcvt/tree/debian\" rel=\"nofollow noreferrer\">github.com/braiam/ffcvt/tree/debian</a>, will check easygen now."}, {"owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1454856934, "post_id": 34800584, "comment_id": 58222376, "body": "@xpt I was an idiot. After packaging both I discovered this <a href=\"https://people.debian.org/~stapelberg/2015/07/27/dh-make-golang.html\" rel=\"nofollow noreferrer\">people.debian.org/~stapelberg/2015/07/27/dh-make-golang.html</a>&zwnj;&#8203;..."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1455459044, "post_id": 34800584, "comment_id": 58489247, "body": "OP updated with new info (but forgot to mention that the build is done in docker and I don&#39;t have a Debian host to try building within). Thx"}, {"owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1455460231, "post_id": 34800584, "comment_id": 58489587, "body": "@xpt ugh... that may complicate stuff."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1455520773, "post_id": 34800584, "comment_id": 58508474, "body": "I don&#39;t have a Debian host to do the building within the near future, but I managed to created a Ubuntu 15.10 (wily) env, but get the exact same problem as above, from within the Ubuntu Wily itself using <code>dh-make-golang</code> and <code>gbp buildpackage --git-pbuilder</code>, not within docker. Could you get a brand new Ubuntu Wily env and try it there please? (I bet the problem is the same for both Debian and Ubuntu, when the system is brand new. There must be some steps you&#39;ve done but I didn&#39;t do to my brand new system) Thx."}], "tags": [], "owner": {"reputation": 4332, "user_id": 792066, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/fe47011419fe78b6f8411e909cee9215?s=128&d=identicon&r=PG", "display_name": "Braiam", "link": "https://stackoverflow.com/users/792066/braiam"}, "is_accepted": false, "score": 1, "last_activity_date": 1454857217, "last_edit_date": 1454857217, "creation_date": 1452808818, "answer_id": 34800584, "question_id": 32171867, "link": "https://stackoverflow.com/questions/32171867/packaging-go-1-5-applications-for-debian-like-systems/34800584#34800584", "title": "Packaging Go 1.5 applications for Debian-like systems", "body": "<p>The easiest method is to use <a href=\"https://people.debian.org/~stapelberg/2015/07/27/dh-make-golang.html\" rel=\"nofollow\">dh-make-golang</a> and verify/correct the autogenerated files. Otherwise you must follow <a href=\"https://wiki.debian.org/IntroDebianPackaging\" rel=\"nofollow\">Debian Packaging Guide</a> and create <code>debian/*</code> directory and editing the control and rules file to <a href=\"https://anonscm.debian.org/cgit/collab-maint/dh-golang.git/plain/example\" rel=\"nofollow\">match the examples</a>.</p>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 928, "favorite_count": 3, "answer_count": 1, "score": 14, "last_activity_date": 1595677522, "creation_date": 1440366345, "last_edit_date": 1595677522, "question_id": 32171867, "link": "https://stackoverflow.com/questions/32171867/packaging-go-1-5-applications-for-debian-like-systems", "title": "Packaging Go 1.5 applications for Debian-like systems", "body": "<p>The original question, <a href=\"https://stackoverflow.com/questions/15104089/packaging-golang-application-for-debian\">Packaging Go application for Debian</a>, was asked over three years ago, when Go was statically linking executables.</p>\n\n<p>Now, with the new Go 1.5 Release, whose <a href=\"https://blog.golang.org/go1.5\" rel=\"nofollow noreferrer\">release note</a> says,</p>\n\n<blockquote>\n  <p>Changes to the linker <strong>enable distributing Go packages as shared libraries to link into Go programs</strong>, and building Go packages into archives or shared libraries that may be linked into or loaded by C programs</p>\n</blockquote>\n\n<p>I headed to <a href=\"https://wiki.debian.org/MichaelStapelberg/GoPackaging\" rel=\"nofollow noreferrer\">Debian GoPackaging wiki</a>, but only to find out that it has not been updated to Go 1.5 yet, maybe the wiki is not maintained, or maybe not, but,</p>\n\n<p>I just want to know, if I want to package a tool that depends on nothing but the official Go packages, how should I take advantage of the shared libraries, instead of building my app into a humongous statically linked executable?</p>\n\n<p>I know the official answer may take some time, but I can wait.</p>\n\n<p>Thanks to Braiam's answer, I moved a bit further. </p>\n\n<ul>\n<li><p>I followed the blog to the step <code>head -100 debian/**/*</code>, but my output is completely different from the blog's. Mine is just the following. Anyone knows why and how to fix?</p>\n\n<pre><code>$ head -100 debian/**/*\n3.0 (quilt)\n</code></pre></li>\n<li><p>I tried to run <code>gbp buildpackage --git-pbuilder</code> but bumped into error:</p>\n\n<pre><code>gbp:info: Building with (cowbuilder) for sid\nBase directory /var/cache/pbuilder/base.cow does not exist\ngbp:error: 'git-pbuilder' failed: it exited with 1\n</code></pre></li>\n<li><p>I checked and verified that I already have <code>cowbuilder</code> &amp; <code>pbuilder</code> installed:</p>\n\n<pre><code>ii cowbuilder  amd64 pbuilder running on cowdancer\nii pbuilder  all personal package builder for Debian packages\n</code></pre></li>\n</ul>\n\n<p>What's wrong? This <code>pbuilder</code> thing is new to me as <a href=\"https://sfxpt.wordpress.com/2013/11/17/debianubuntu-package-developing-with-docker-continued/\" rel=\"nofollow noreferrer\">I build Debian/Ubuntu Package with Docker</a>.</p>\n"}, {"tags": ["go", "goquery"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440364286, "post_id": 32171498, "comment_id": 52229495, "body": "You should clearly ask your question in sentences and paragraphs rather than relying on the title and comments in a code block."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440364332, "post_id": 32171498, "comment_id": 52229506, "body": "Is <a href=\"https://godoc.org/golang.org/x/net/html/\" rel=\"nofollow noreferrer\">the <code>golang.org&#47;x&#47;net&#47;html</code> package</a> relevant/helpful?"}, {"owner": {"reputation": 2634, "user_id": 1868277, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/oi5jr.jpg?s=128&g=1", "display_name": "Puzzled Boy", "link": "https://stackoverflow.com/users/1868277/puzzled-boy"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440364632, "post_id": 32171498, "comment_id": 52229584, "body": "@DaveC i have also tried with this package but problem is this it does not gives the css selectors.."}, {"owner": {"reputation": 1079, "user_id": 3591723, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/226c74589745a877b4dbd474fb66951e?s=128&d=identicon&r=PG&f=1", "display_name": "user3591723", "link": "https://stackoverflow.com/users/3591723/user3591723"}, "edited": false, "score": 0, "creation_date": 1440467351, "post_id": 32171498, "comment_id": 52273790, "body": "@PuzzledBoy What do you mean by that? You can every attribute/tag with that package just fine. You just don&#39;t get the syntax of <code>doc.Find(&quot;tag.classattr&quot;)</code> although writing your own function do that is actually really easy once you get familiar with that package."}], "answers": [{"comments": [{"owner": {"reputation": 2634, "user_id": 1868277, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/oi5jr.jpg?s=128&g=1", "display_name": "Puzzled Boy", "link": "https://stackoverflow.com/users/1868277/puzzled-boy"}, "edited": false, "score": 0, "creation_date": 1440365767, "post_id": 32171761, "comment_id": 52229905, "body": "ahh i was just reading <a href=\"https://github.com/PuerkitoBio/goquery/issues/46\" rel=\"nofollow noreferrer\">github.com/PuerkitoBio/goquery/issues/46</a> .. Thanx Sir,"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 9, "last_activity_date": 1440365591, "creation_date": 1440365591, "answer_id": 32171761, "question_id": 32171498, "link": "https://stackoverflow.com/questions/32171498/how-to-get-value-of-attribute-href-value-in-go-language/32171761#32171761", "title": "how to get value of attribute href value in Go language", "body": "<p><a href=\"https://godoc.org/github.com/PuerkitoBio/goquery#Selection.Attr\" rel=\"noreferrer\"><code>Selection.Attr</code></a> returns two values: the attribute value, and a boolean stating whether the attribute existed or not (the attribute value will be the empty if this is false).</p>\n\n<p>Go doesn't like it when you ignore multiple return values, so you'll have to change your code to the following:</p>\n\n<pre><code>doc.Find(\"table.v65-productDisplay a.productnamecolor\").Each(func(i int, s *goquery.Selection) {\n    band, ok := s.Attr(\"href\")\n    if ok {\n        fmt.Printf(band)\n    }\n})\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 4555196, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3krROnkery4/AAAAAAAAAAI/AAAAAAAAACk/eZobzBIMgWk/photo.jpg?sz=128", "display_name": "Dami", "link": "https://stackoverflow.com/users/4555196/dami"}, "is_accepted": false, "score": 0, "last_activity_date": 1595999534, "creation_date": 1595999534, "answer_id": 63146716, "question_id": 32171498, "link": "https://stackoverflow.com/questions/32171498/how-to-get-value-of-attribute-href-value-in-go-language/63146716#63146716", "title": "how to get value of attribute href value in Go language", "body": "<p>You can also use the <a href=\"https://pkg.go.dev/golang.org/x/net/html?tab=doc#example-Parse\" rel=\"nofollow noreferrer\">golang.org/pkg/net/html</a> package.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;log&quot;\n    &quot;strings&quot;\n\n    &quot;golang.org/x/net/html&quot;\n)\n\nfunc main() {\n    s := `&lt;a class=&quot;productnamecolor colors_productname&quot; href=&quot;http://www.cccxcxc.com/Nautical-Bubble-Romper-p/s15brpnt03.htm&quot;&gt;*/\n      &lt;a class=&quot;productnamecolor colors_productname&quot; href=&quot;http://www.dewewe.com/Nautical-Bubble-Romper-p/erewrwer.htm&quot;&gt;\n    &lt;a class=&quot;productnamecolor colors_productname&quot; href=&quot;http://www.sdsddsd.com/Nautical-Bubble-Romper-p/dsadadasd.htm&quot;&gt;`\n    doc, err := html.Parse(strings.NewReader(s))\n    if err != nil {\n        log.Fatal(err)\n    }\n    var f func(*html.Node)\n    f = func(n *html.Node) {\n        if n.Type == html.ElementNode &amp;&amp; n.Data == &quot;a&quot; {\n            for _, a := range n.Attr {\n                if a.Key == &quot;href&quot; {\n                    fmt.Println(a.Val)\n                    break\n                }\n            }\n        }\n        for c := n.FirstChild; c != nil; c = c.NextSibling {\n            f(c)\n        }\n    }\n    f(doc)\n}\n// outputs\n// http://www.cccxcxc.com/Nautical-Bubble-Romper-p/s15brpnt03.htm\n// http://www.dewewe.com/Nautical-Bubble-Romper-p/erewrwer.htm\n// http://www.sdsddsd.com/Nautical-Bubble-Romper-p/dsadadasd.htm\n\n</code></pre>\n<p>Hope this helps someone.</p>\n"}], "owner": {"reputation": 2634, "user_id": 1868277, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/oi5jr.jpg?s=128&g=1", "display_name": "Puzzled Boy", "link": "https://stackoverflow.com/users/1868277/puzzled-boy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6642, "favorite_count": 0, "accepted_answer_id": 32171761, "answer_count": 2, "score": 5, "last_activity_date": 1617962626, "creation_date": 1440363727, "last_edit_date": 1617962626, "question_id": 32171498, "link": "https://stackoverflow.com/questions/32171498/how-to-get-value-of-attribute-href-value-in-go-language", "title": "how to get value of attribute href value in Go language", "body": "<p>I want to parse anchor link from the html content.\n/* My HTML Content Sample</p>\n\n<pre><code>&lt;a class=\"productnamecolor colors_productname\" href=\"http://www.cccxcxc.com/Nautical-Bubble-Romper-p/s15brpnt03.htm\"&gt;*/\n      &lt;a class=\"productnamecolor colors_productname\" href=\"http://www.dewewe.com/Nautical-Bubble-Romper-p/erewrwer.htm\"&gt;\n    &lt;a class=\"productnamecolor colors_productname\" href=\"http://www.sdsddsd.com/Nautical-Bubble-Romper-p/dsadadasd.htm\"&gt; \n</code></pre>\n\n<p>*/\nThe Anchor have <strong>href</strong> and i want to get the value of <strong>Href</strong> . But this is giving me error..</p>\n\n<p><strong>Error: multiple-value s.Attr() in single-value context</strong></p>\n\n<pre><code>package main\n\n    import (\n      \"fmt\"\n      \"log\"\n\n      \"github.com/PuerkitoBio/goquery\"\n    )\n\n    func ExampleScrape() {\n      doc, err := goquery.NewDocument(\"http://www.myurl.com/category-s/1828.htm\") \n      if err != nil {\n        log.Fatal(err)\n      }\n\n    /* **my sample html after http open** &lt;a class=\"productnamecolor colors_productname\" href=\"http://www.cccxcxc.com/Nautical-Bubble-Romper-p/s15brpnt03.htm\"&gt;*/\n      &lt;a class=\"productnamecolor colors_productname\" href=\"http://www.dewewe.com/Nautical-Bubble-Romper-p/erewrwer.htm\"&gt;\n    &lt;a class=\"productnamecolor colors_productname\" href=\"http://www.sdsddsd.com/Nautical-Bubble-Romper-p/dsadadasd.htm\"&gt; ***/\n\n    doc.Find(\"table.v65-productDisplay a.productnamecolor\").Each(func(i int, s *goquery.Selection) {\n        band := s.Attr(\"href\") // here i want to get attribute \" href \" value. this is not working here.\n        fmt.Printf(band)\n      })\n    }\n\n    func main() {\n      ExampleScrape()\n    }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1440355835, "post_id": 32170109, "comment_id": 52227101, "body": "Try this solution: <a href=\"https://play.golang.org/p/o3i-f8PnvV\" rel=\"nofollow noreferrer\">play.golang.org/p/o3i-f8PnvV</a>"}], "answers": [{"tags": [], "owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "is_accepted": true, "score": 11, "last_activity_date": 1440355486, "creation_date": 1440355486, "answer_id": 32170186, "question_id": 32170109, "link": "https://stackoverflow.com/questions/32170109/sscanf-of-multiple-string-fields-in-golang/32170186#32170186", "title": "Sscanf of multiple string fields in golang", "body": "<p><code>%s</code> is greedy and gobbles up to the next space, which means it eats up the colon. After processing the <code>%s</code>, it then tries to scan in the colon, but wait, that\u2019s already been consumed, and the next character is actually a space, not a colon! So it fails.</p>\n\n<p>In C you\u2019d get around this by using <code>%[^:]</code> rather than <code>%s</code>, but it appears Go doesn\u2019t support this. You might need to find some way to parse your string without <code>Sscanf</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 5257867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16db2b90b1c22ca2a4fd7d455654e804?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Nelson", "link": "https://stackoverflow.com/users/5257867/ben-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4616, "favorite_count": 1, "accepted_answer_id": 32170186, "answer_count": 1, "score": 8, "last_activity_date": 1440355486, "creation_date": 1440355109, "question_id": 32170109, "link": "https://stackoverflow.com/questions/32170109/sscanf-of-multiple-string-fields-in-golang", "title": "Sscanf of multiple string fields in golang", "body": "<p>I am trying to use sscanf to parse multiple string fields.  Here is an example code snippet:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n        var name, currency string\n\n    _, err := fmt.Sscanf(\"transaction benson: dollars\", \"transaction %s: %s\", &amp;name, &amp;currency)\n\n    fmt.Println(err, name, currency)\n}\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>input does not match format benson: \n\nProgram exited.\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "go", "upsert"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1440353434, "post_id": 32169641, "comment_id": 52226345, "body": "Not sure what language/library you&#39;re working with but are you sure you&#39;re getting an <code>id</code> out of that INSERT...SELECT? Are you perhaps trying to insert a duplicate row so that the <code>not exists</code> is finding something and the INSERT is never done?"}, {"owner": {"reputation": 3614, "user_id": 1569930, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7bc43a689388dd4697947ffe8f4c9dcd?s=128&d=identicon&r=PG", "display_name": "eirikir", "link": "https://stackoverflow.com/users/1569930/eirikir"}, "edited": false, "score": 0, "creation_date": 1440365738, "post_id": 32169641, "comment_id": 52229896, "body": "You should tag the question with your language/framework/library to get users who understand it to respond."}, {"owner": {"reputation": 11, "user_id": 5249618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc031d691b9cda5e3eb98fc23dd6c4a?s=128&d=identicon&r=PG&f=1", "display_name": "sasms", "link": "https://stackoverflow.com/users/5249618/sasms"}, "edited": false, "score": 0, "creation_date": 1440381667, "post_id": 32169641, "comment_id": 52233255, "body": "I am working with go lang and database sql. I have a id var that is defined above (as an int64). I&#39;ll check if it by outputting it and then running it by manually."}, {"owner": {"reputation": 11, "user_id": 5249618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc031d691b9cda5e3eb98fc23dd6c4a?s=128&d=identicon&r=PG&f=1", "display_name": "sasms", "link": "https://stackoverflow.com/users/5249618/sasms"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1440382757, "post_id": 32169641, "comment_id": 52233478, "body": "Ok so @muistooshort was right. My code, not heroku is broken. Any suggestions on how to fix it? Its essentially an upsert returning the id."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5249618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc031d691b9cda5e3eb98fc23dd6c4a?s=128&d=identicon&r=PG&f=1", "display_name": "sasms", "link": "https://stackoverflow.com/users/5249618/sasms"}, "is_accepted": false, "score": 0, "last_activity_date": 1440385754, "creation_date": 1440385754, "answer_id": 32173954, "question_id": 32169641, "link": "https://stackoverflow.com/questions/32169641/upsert-postgresql-returning-id/32173954#32173954", "title": "Upsert postgresql returning id", "body": "<p>So changing it to QueryRow solved my issues. I believe it had to due with a concurrency issue. Hopefully this is useful to someone down the road. </p>\n"}], "owner": {"reputation": 11, "user_id": 5249618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc031d691b9cda5e3eb98fc23dd6c4a?s=128&d=identicon&r=PG&f=1", "display_name": "sasms", "link": "https://stackoverflow.com/users/5249618/sasms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440385754, "creation_date": 1440352151, "last_edit_date": 1440383168, "question_id": 32169641, "link": "https://stackoverflow.com/questions/32169641/upsert-postgresql-returning-id", "title": "Upsert postgresql returning id", "body": "<p>Initially I thought this was a heroku issue as, for some bizarre reason this code runs fine locally, but on further investigation I realized id was returning 0 all the time. Essentially I am trying to code an upsert that returns the id. I am working in go with the sql library. </p>\n\n<pre><code>-- ----------------------------\n--  Table structure for books\n-- ----------------------------\nDROP TABLE IF EXISTS \"public\".\"books\" CASCADE;\nCREATE TABLE \"public\".\"books\" (\n    \"id\" serial primary key,\n    \"title\" varchar(255) NOT NULL COLLATE \"default\",\n    \"first\" varchar(40) NOT NULL COLLATE \"default\",\n    \"last\" varchar(40) NOT NULL COLLATE \"default\",\n    \"class\" varchar(40) NOT NULL COLLATE \"default\"\n)\nWITH (OIDS=FALSE);\n-- ----------------------------\n--  Table structure for bookitems\n-- ----------------------------\nDROP TABLE IF EXISTS \"public\".\"bookitem\";\nCREATE TABLE \"public\".\"bookitem\" (\n\n    \"id\" serial primary key,\n    \"price\" int NOT NULL,\n    \"condition\" int NOT NULL,\n    \"views\" int NOT NULL,\n    \"seller\" bigint NOT NULL,\n    \"book\" int REFERENCES books(id),\n    \"saletype\" int NOT NULL,\n    \"date\" bigint NOT NULL,\n    \"description\" varchar(255) NOT NULL COLLATE \"default\",\n    \"bucket\" int NOT NULL,\n    \"status\" int NOT NULL --This is for showing what the staus of the item is (bought sold etc.)\n    --FOREIGN KEY (book) REFERENCES books(id)\n)\nWITH (OIDS=FALSE);\n</code></pre>\n\n<p>Here is the code that triggers the error: </p>\n\n<pre><code>rows, err := db.Query(`with vals as (\n      select $1::VARCHAR as title, $2::VARCHAR as first, $3::VARCHAR as last, $4::VARCHAR as class\n    )\n    insert into books (title, first, last, class)\n    select v.title, v.first, v.last, v.class\n    from vals as v\n    where not exists (select * from books as t where t.title = v.title and t.last = v.last and t.first = v.first and t.class = v.class)\n    RETURNING id`, r.FormValue(\"title\"),\n            r.FormValue(\"first\"),\n            r.FormValue(\"last\"),\n            r.FormValue(\"class\"))\n        //defer rows.Close()\n        rows.Scan(&amp;id)\n\n        PanicIf(err)\n\n        _, err = db.Query(\"INSERT INTO bookitem (price, condition, views, seller, book, saletype,   date, description, bucket, status) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10)\",\n            r.FormValue(\"price\"),\n            r.FormValue(\"condition\"),\n            0,\n            0,\n            id,\n            r.FormValue(\"saletype\"),\n            0,\n            r.FormValue(\"description\"),\n            0,\n            0)\n\n        PanicIf(err)\n</code></pre>\n\n<p>The error I get when I run it deployed to heroku is: </p>\n\n<pre><code>pq: insert or update on table \"bookitem\" violates foreign key constraint\"bookitem_book_fkey\"\n</code></pre>\n\n<p>At this point any suggestions would be appreciated as I have tried twice to fix this to no avail. </p>\n\n<p>P.S. Thank you to all of you who helped me realize the issue was my code and not heroku!</p>\n"}, {"tags": ["go", "deferred"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1440341924, "creation_date": 1440341924, "answer_id": 32168056, "question_id": 32168017, "link": "https://stackoverflow.com/questions/32168017/how-to-defer-executing-argument-in-defer-function/32168056#32168056", "title": "how to defer executing argument in defer function", "body": "<p>If you wrap the <code>fmt.Println</code> call in another function (an anonymous function, in this case), the evaluation of <code>Even()</code> will happen after the other calls to <code>Even</code> have completed:</p>\n\n<pre><code>func main() {\n    Even := MakeEvenNumber()\n\n    defer func() {\n      fmt.Println(\"a \", Even())\n    }()\n\n    fmt.Println(\"b \", Even())\n    fmt.Println(\"c \", Even())\n    fmt.Println(\"d \", Even())\n}\n</code></pre>\n"}], "owner": {"reputation": 11023, "user_id": 1924666, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YzCUy.jpg?s=128&g=1", "display_name": "Shahriar", "link": "https://stackoverflow.com/users/1924666/shahriar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "closed_date": 1440347916, "accepted_answer_id": 32168056, "answer_count": 1, "score": 1, "last_activity_date": 1440341924, "creation_date": 1440341753, "question_id": 32168017, "link": "https://stackoverflow.com/questions/32168017/how-to-defer-executing-argument-in-defer-function", "closed_reason": "Duplicate", "title": "how to defer executing argument in defer function", "body": "<p><code>defer</code> in <code>go</code> schedules a function call to be run after the function completes.\nSo <code>1st</code> print function <code>fmt.Println(\"a \", Even())</code> is defered. But as argument is executed when defer is called, <code>Even()</code> function is called immediately. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc MakeEvenNumber() func() int {\n    num :=0\n    return func() (ret int) {\n        ret = num\n        num = num + 2\n        return ret\n    }\n}\n\nfunc main() {\n\n    Even := MakeEvenNumber()\n\n    defer fmt.Println(\"a \", Even())\n\n    fmt.Println(\"b \", Even())\n    fmt.Println(\"c \", Even())\n    fmt.Println(\"d \", Even())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>b  2\nc  4\nd  6\na  0\n</code></pre>\n\n<p>This is happened in defer. I just want to know any way to stop executing argument in defer function?</p>\n\n<p>like in this case, output will be:</p>\n\n<pre><code>b 0\nc 2\nd 4\na 6\n</code></pre>\n\n<p><code>defer fmt.Println(\"a \", **Even()**)</code> this <code>Even()</code> function will be executed along with <code>Println</code>.</p>\n\n<p>Any way to do this?</p>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 442, "user_id": 1044695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65678b0d2827c55c82b6a9711fe4bb6a?s=128&d=identicon&r=PG", "display_name": "jineff", "link": "https://stackoverflow.com/users/1044695/jineff"}, "edited": false, "score": 0, "creation_date": 1440364239, "post_id": 32169387, "comment_id": 52229480, "body": "- Indeed, <code>syscall.EPIPE</code> is an errno value, not a &quot;direct&quot; return status value. My bad, thanks. - &quot;After returning ten pipe errors [...] killing it.&quot; do you know the reason of such behavior ? - Why <code>Notify</code> catches <code>kill -13</code> (SIGPIPE) but not the real one ?"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 0, "last_activity_date": 1440365751, "last_edit_date": 1440365751, "creation_date": 1440350584, "answer_id": 32169387, "question_id": 32168006, "link": "https://stackoverflow.com/questions/32168006/getting-a-pipe-status-in-go/32169387#32169387", "title": "Getting a pipe status in Go", "body": "<p>The error returned is not a plain <code>syscall.Error</code> but instead wrapped within <code>*os.PathError</code> as illustrated with the following variation of your code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"syscall\"\n)\n\nfunc main() {\n    // open previously created named pipe (`mkfifo /tmp/test`)\n    pipe, _ := os.OpenFile(\"/tmp/test\", os.O_WRONLY, 0)\n    for {\n        n, err := pipe.Write([]byte(\"foo\\n\"))\n        fmt.Printf(\"write: n=%v, err=(%T) %[2]v\\n\", n, err)\n        if err == syscall.EPIPE {\n            fmt.Println(\"EPIPE error\")\n        } else if perr, ok := err.(*os.PathError); ok {\n            fmt.Printf(\"op: %q; path=%q; err=(%T) %[3]q\\n\",\n                perr.Op, perr.Path, perr.Err)\n            if perr.Err == syscall.EPIPE {\n                fmt.Println(\"os.PathError.Err is EPIPE\")\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Running this after doing <code>mkfifo /tmp/test; head /tmp/test</code> elsewhere gives me:</p>\n\n<pre><code>write: n=4, err=(&lt;nil&gt;) &lt;nil&gt;\n[\u2026 repeated nine more times, as the head command reads ten lines \u2026]\nwrite: n=0, err=(*os.PathError) write /tmp/test: broken pipe\nop: \"write\"; path=\"/tmp/test\"; err=(syscall.Errno) \"broken pipe\"\nos.PathError.Err is EPIPE\n[\u2026 above three lines repeated nine more times \u2026]\nsignal: broken pipe\nExit 1\n</code></pre>\n\n<p>After returning ten pipe errors on an individual file the Go runtine stops catching/blocking SIGPIPE and lets it through to your program killing it.\nI don't believe the Go runtime lets you catch or ignore SIGPIPE as it uses that signal itself internally.</p>\n\n<p>So two things: one, to look for <code>syscall.EPIPE</code> you need to check for <code>*os.PathError</code> as shown and two, don't continue on when <code>err != nil</code> when you haven't actually handled the error.</p>\n\n<p>I don't know the details of why Go handles SIGPIPE in this way; perhaps a search of Go's bug tracker and/or the go-nuts list may help answer that.\nWith Go 1.5's additions to the <code>os/signal</code> package doing <code>signal.Reset(syscall.SIGPIPE)</code> (before any <code>signal.Notify</code> calls) changes this behaviour.</p>\n"}], "owner": {"reputation": 442, "user_id": 1044695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/65678b0d2827c55c82b6a9711fe4bb6a?s=128&d=identicon&r=PG", "display_name": "jineff", "link": "https://stackoverflow.com/users/1044695/jineff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1382, "favorite_count": 0, "accepted_answer_id": 32169387, "answer_count": 1, "score": 2, "last_activity_date": 1440365751, "creation_date": 1440341701, "last_edit_date": 1495542572, "question_id": 32168006, "link": "https://stackoverflow.com/questions/32168006/getting-a-pipe-status-in-go", "title": "Getting a pipe status in Go", "body": "<p>I'm unable to get a pipe state in Go (1.5).</p>\n\n<p>While writing on a <code>mkfifo</code> created pipe, I try to get the state of this output pipe:</p>\n\n<ul>\n<li>using the <code>Write</code> return status <code>EPIPE</code></li>\n<li>using the <code>Write</code> return status <code>EPIPE</code> and <code>signal.Ignore</code> on SIGPIPE (just in case)</li>\n<li>using <code>signal.Notify</code> on SIGPIPE</li>\n</ul>\n\n<p>I can see that:</p>\n\n<ul>\n<li><code>EPIPE</code> is never returned</li>\n<li>when I use <code>kill -13</code>, the signal handler is called: \"Got signal: broken pipe\"</li>\n<li>when I <code>ctrl-c</code> the reader, the signal handler is not called and my program exits with output: \"signal: broken pipe\"</li>\n</ul>\n\n<p>Would you, please, indicate my error ?</p>\n\n<pre><code>// tee.go\npackage main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n\n    sys \"golang.org/x/sys/unix\"\n)\n\n// wait for a signal and print it\nfunc handleSignal(csig chan os.Signal) {\n    for {\n        fmt.Println(\"Wait signal\")\n        s := &lt;-csig\n        fmt.Println(\"Got signal:\", s)\n    }\n}\n\nfunc main() {\n    csig := make(chan os.Signal, 1)\n\n    // `kill -13` outputs\u00a0\"Got signal: broken pipe\" =&gt; ok\n    signal.Notify(csig, sys.SIGPIPE)\n\n    // OR disable the previous `Notify` just to be sure ?\n    // maybe it will help to get the EPIPE error status on `Write` ?\n    //signal.Ignore(sys.SIGPIPE)\n\n    go handleSignal(csig)\n\n    // open previously created named pipe (`mkfifo /tmp/test`)\n    pipe, _ := os.OpenFile(\"/tmp/test\", os.O_WRONLY, 0)\n\n    for {\n        _, err := pipe.Write([]byte(\"foo\\n\"))\n        if err == syscall.EPIPE {\n            // never called =&gt; ko\n            fmt.Println(\"EPIPE error\")\n        }\n    }\n}\n</code></pre>\n\n<p><strong>Note:</strong> as a simple Go exercise, I try to implement a command which almost acts like <code>tee -a &lt;a_file&gt;</code> (print stdin to stdout and <code>&lt;a_file&gt;</code>) with the following specificity: <a href=\"https://stackoverflow.com/questions/7360473/linux-non-blocking-fifo-on-demand-logging\">non blocking write on a named pipe and optional reader</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1542229575, "post_id": 32166642, "comment_id": 93498169, "body": "Just hit the same discovery as a newcomer to golang. Any idea if something has changed in 2018?"}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "reply_to_user": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1542272419, "post_id": 32166642, "comment_id": 93511494, "body": "Some has changed. Go modules is now supported (as of 1.11) if you are outside of <code>GOPATH</code> or set the env var <code>GO111MODULE=on</code>. It still doesn&#39;t solve the fundamental problem, and is one of my major gripes with go. Ignoring languages, I always have strongly felt that node packaging got it right: arbitrary name inside files in the package, and a &quot;mapping file&quot; (<code>package.json</code> or whatever) to map to absolute locations. Oh well."}, {"owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1542276007, "post_id": 32166642, "comment_id": 93513754, "body": "I looked briefly at Go modules until I saw the word &quot;experimental&quot;. The solution seems to be to clone into repos that are named the same as the upstream repo, while pushing to origin (fork) for private changes. It&#39;s all pretty lame."}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "reply_to_user": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "edited": false, "score": 0, "creation_date": 1542286863, "post_id": 32166642, "comment_id": 93520101, "body": "Golang module structure is pretty lame. Its adoption is despite its weaknesses. :-("}], "answers": [{"comments": [{"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 1, "creation_date": 1440337320, "post_id": 32166819, "comment_id": 52221202, "body": "So go&#39;s idea of a package is absolute. Period. You can put directories above/below each other, but if one thing requires another, and is not in the same package, it is an absolute import. Which means either don&#39;t build software composed of packages that build together and aren&#39;t absolute, or accept lots of wasteful rewrites. I don&#39;t get it. Weren&#39;t they thinking of this when they designed the package namespace?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1440337525, "post_id": 32166819, "comment_id": 52221269, "body": "Google&#39;s philosophy on this is that they vendor everything into one source tree and that&#39;s it. So it kinda makes this whole idea of forking dependencies redundant, as every dependency is already forked in a sense."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 0, "creation_date": 1440337620, "post_id": 32166819, "comment_id": 52221297, "body": "It&#39;s funny because I&#39;m just about to fork a library and I&#39;m not sure which way to go :)"}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 1, "creation_date": 1440339654, "post_id": 32166819, "comment_id": 52221928, "body": "&quot;they vendor everything into one source tree ... every dependency is already forked.&quot; So the way the rest of the world writes software - larger package, sub files and folders that allow us to organize and build things together into a single release, and be self-encapsulated, and lets things like github forking and subversion check out, etc. work - Google and therefore go just don&#39;t work that way?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 1, "creation_date": 1440340707, "post_id": 32166819, "comment_id": 52222312, "body": "@deitch I&#39;m not a googler, this is just based on what I&#39;ve read from the go authors, but in essence - yes. Go doesn&#39;t dictate how you should work, and this problem around forks doesn&#39;t stem from the way packages are organized, but from the (wrong) assumption that <code>go get</code> is a good enough dependency manager, and that import path == git url."}, {"owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "edited": false, "score": 3, "creation_date": 1440342380, "post_id": 32166819, "comment_id": 52222893, "body": "In other words, a just fine philosophy for internal corporate project management, not a very good one for collaborative open source management. That&#39;s a pity. I really like many of the things go does. This isn&#39;t one of them"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 3, "last_activity_date": 1440334510, "last_edit_date": 1440334510, "creation_date": 1440334147, "answer_id": 32166819, "question_id": 32166642, "link": "https://stackoverflow.com/questions/32166642/how-to-handle-go-import-absolute-paths-and-github-forks/32166819#32166819", "title": "how to handle go import absolute paths and github forks?", "body": "<p>As for the reasoning behind not allowing relative imports, you can read this discussion for some perspective: <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/n9d8RzVnadk/07f9RDlwLsYJ\" rel=\"nofollow\">https://groups.google.com/forum/#!msg/golang-nuts/n9d8RzVnadk/07f9RDlwLsYJ</a></p>\n\n<p>Personally I'd rather have them enabled, at least for internal imports, exactly for the reason you are describing.</p>\n\n<p>Now, how to deal with the situation? </p>\n\n<ol>\n<li><p>If your fork is just a small fix from another project that will probably be accepted as a PR soon - just manually edit the git remotes for it to refer to your own git repo and not the original one. If you're using a vendoring solution like godep, it will work smoothly since saving it will just vendor your forked code, and <code>go get</code> is never used directly.</p></li>\n<li><p>If your fork is a big change and you intend to remain forked, rewrite all the import paths. You can automate it with <code>sed</code> or you can use <code>gofmt -r</code> that supports rewriting of the code being formatted. </p></li>\n</ol>\n\n<p>[EDIT] I also found this tool which is designed to help with that situation: <a href=\"https://github.com/rogpeppe/govers\" rel=\"nofollow\">https://github.com/rogpeppe/govers</a></p>\n\n<p>I've done both 1 and 2 - when I just had a small bugfix to some library I just changed the remote and verndored it. When I actually forked a library without intent of merging my changes back, I changed all the import paths and continued to use my repo only.</p>\n\n<p>I can also think of an addition to vendoring tools allowing automation of this stuff, but I don't think any of them support it currently. </p>\n"}], "owner": {"reputation": 12031, "user_id": 736714, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/70d2c699f89a1f7f76b436bc79b4d5be?s=128&d=identicon&r=PG", "display_name": "deitch", "link": "https://stackoverflow.com/users/736714/deitch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1477, "favorite_count": 1, "accepted_answer_id": 32166819, "answer_count": 1, "score": 7, "last_activity_date": 1536450193, "creation_date": 1440332877, "question_id": 32166642, "link": "https://stackoverflow.com/questions/32166642/how-to-handle-go-import-absolute-paths-and-github-forks", "title": "how to handle go import absolute paths and github forks?", "body": "<p>There are plenty of questions around this, including why you shouldn't use <code>import \"./my/path\"</code> and why it only works because some legacy go code requires it.</p>\n\n<p>If this is correct, how do you handle encapsulation of a project and by extension github forks? In every other lang, I can do a github fork of a project, or git clone, and everything is encapsulated there. How do I get the same behaviour out of a go project?</p>\n\n<p>Simple example using the go \"hello world\" example.</p>\n\n<p>hello.go</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n    \"github.com/golang/examples/stringutil\")\n\nfunc main() {\n    fmt.Printf(stringutil.Reverse(\"hello, world\")+\"\\n\")\n}\n</code></pre>\n\n<p>The above works great. But if I want to use my own stringutil which is in a subdirectory and will compile to a single binary, I <em>still</em> need the complete path:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n    \"github.com/myrepo/examples/util/stringutil\")\n\nfunc main() {\n    fmt.Printf(stringutil.Reverse(\"hello, world\")+\"\\n\")\n}\n</code></pre>\n\n<p>Now, if someone copies or forks my repo, it has a direct dependency on \"github.com/myrepo/\", <strong>even though this is used entirely internally!</strong> </p>\n\n<p>What if there are 20 different files that import <code>utils/</code>? I need to change each one each time someone forks? That is a lot of extraneous changes and a nonsensical git commit.</p>\n\n<p>What am I missing here? Why are relative paths such a bad thing? How do I fork a project that refers to its own subsidiary directories (and their packages) without changing dozens of files?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440324964, "post_id": 32164223, "comment_id": 52218042, "body": "If I make a trick with <code>oauth2.NoContext</code> I get an error &quot;not an App Engine context&quot;"}, {"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440487398, "post_id": 32164223, "comment_id": 52280405, "body": "There is function <code>BackgroundContext() context.Context</code> but it&#39;s intended for managed vm only <a href=\"https://github.com/golang/appengine/blob/master/appengine_vm.go#L30\" rel=\"nofollow noreferrer\">github.com/golang/appengine/blob/master/appengine_vm.go#L30</a> It seems like I should use Managed VM for my task"}], "answers": [{"comments": [{"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440331006, "post_id": 32166229, "comment_id": 52219574, "body": "The problem is I want to make background work and can&#39;t pass context.Context through runtime.RunInBackground(c, func(ctx appengine.Context)  call. It&#39;s only appengine.Context can pass over"}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "reply_to_user": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440468844, "post_id": 32166229, "comment_id": 52274170, "body": "Can you use the delay package? <a href=\"https://cloud.google.com/appengine/docs/go/taskqueue/delay\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/taskqueue/delay</a>. The newer libraries have a context.Context: <a href=\"http://godoc.org/google.golang.org/appengine/delay\" rel=\"nofollow noreferrer\">godoc.org/google.golang.org/appengine/delay</a>"}, {"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440482787, "post_id": 32166229, "comment_id": 52278045, "body": "No, I need to run goroutine on the same instance. It should flush buffered data to Cloud Storage"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 2, "last_activity_date": 1440329794, "creation_date": 1440329794, "answer_id": 32166229, "question_id": 32164223, "link": "https://stackoverflow.com/questions/32164223/how-can-i-create-cloud-context-context-from-appengine-context/32166229#32166229", "title": "How can I create cloud context.Context from appengine.Context", "body": "<p>Do this:</p>\n\n<pre><code>func getCloudContext(appengineContext context.Context) context.Context {\n    hc := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: google.AppEngineTokenSource(appengineContext, storage.ScopeFullControl),\n            Base:   &amp;urlfetch.Transport{Context: appengineContext},\n        },\n    }\n\n    return cloud.NewContext(appengine.AppID(appengineContext), hc)\n}\n</code></pre>\n\n<p>Or if passing the credentials through the dev server isn't working, you can also use explicit credentials:</p>\n\n<pre><code>func getCloudContext(aeCtx context.Context) (context.Context, error) {\n    data, err := ioutil.ReadFile(\"/path/to/credentials.json\")\n    if err != nil {\n        return nil, err\n    }\n\n    conf, err := google.JWTConfigFromJSON(\n        data,\n        storage.ScopeFullControl,\n    )\n    if err != nil {\n        return nil, err\n    }\n\n    tokenSource := conf.TokenSource(aeCtx)\n\n    hc := &amp;http.Client{\n        Transport: &amp;oauth2.Transport{\n            Source: tokenSource,\n            Base:   &amp;urlfetch.Transport{Context: aeCtx},\n        },\n    }\n\n    return cloud.NewContext(appengine.AppID(aeCtx), hc), nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440488667, "post_id": 32197987, "comment_id": 52281125, "body": "1) Sorry, but code.google.com is deprecated as a whole and code.google.com/p/goauth2 in particular (it&#39;s said to use <a href=\"https://github.com/golang/oauth2\" rel=\"nofollow noreferrer\">github.com/golang/oauth2</a> that have no clue about &quot;appengine&quot;)"}, {"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440493586, "post_id": 32197987, "comment_id": 52284176, "body": "2) Sorry, your second option get &quot;not an App Engine context&quot; on attempt to write to Cloud Storage"}, {"owner": {"reputation": 1039, "user_id": 1201422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b52a61797037f989c609529e16c414?s=128&d=identicon&r=PG", "display_name": "Chris Pushbullet", "link": "https://stackoverflow.com/users/1201422/chris-pushbullet"}, "reply_to_user": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440524425, "post_id": 32197987, "comment_id": 52304989, "body": "1) Yes it is deprecated, but does it work?  You can find the library at <a href=\"https://code.google.com/p/goauth2/source/browse/\" rel=\"nofollow noreferrer\">code.google.com/p/goauth2/source/browse</a>"}, {"owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "edited": false, "score": 0, "creation_date": 1440575774, "post_id": 32197987, "comment_id": 52324890, "body": "It does not matter if deprecated code works or not. I won&#39;t use it in a new project."}], "tags": [], "owner": {"reputation": 1039, "user_id": 1201422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b52a61797037f989c609529e16c414?s=128&d=identicon&r=PG", "display_name": "Chris Pushbullet", "link": "https://stackoverflow.com/users/1201422/chris-pushbullet"}, "is_accepted": false, "score": 1, "last_activity_date": 1440525089, "last_edit_date": 1440525089, "creation_date": 1440487797, "answer_id": 32197987, "question_id": 32164223, "link": "https://stackoverflow.com/questions/32164223/how-can-i-create-cloud-context-context-from-appengine-context/32197987#32197987", "title": "How can I create cloud context.Context from appengine.Context", "body": "<p>Here is how you can do what you want:</p>\n\n<pre><code>import (\n    \"code.google.com/p/goauth2/appengine/serviceaccount\"\n    \"golang.org/x/net/context\"\n    \"appengine\"\n)\n\n// oauth2 module requires a context.Context so use goauth2 for now\nfunc CloudContext(c appengine.Context, scopes ...string) context.Context {\n    client, _ := serviceaccount.NewClient(c, scopes...)\n    return cloud.WithContext(context.Background(), appengine.AppID(c), client)\n}\n</code></pre>\n\n<p>You can get the goauth2 library from <a href=\"https://code.google.com/p/goauth2/source/browse/\" rel=\"nofollow\">https://code.google.com/p/goauth2/source/browse/</a></p>\n"}, {"tags": [], "owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "is_accepted": true, "score": 3, "last_activity_date": 1440656581, "creation_date": 1440656581, "answer_id": 32242057, "question_id": 32164223, "link": "https://stackoverflow.com/questions/32164223/how-can-i-create-cloud-context-context-from-appengine-context/32242057#32242057", "title": "How can I create cloud context.Context from appengine.Context", "body": "<p>At the moment there is no way to get cloud <code>context.Context</code> from (old) <code>appengine.Context</code>. </p>\n\n<p><strong>Solution for Managed VM</strong></p>\n\n<p>A month ago <code>BackgroundContext()</code> method <a href=\"https://github.com/golang/appengine/commit/61bec684bd7bce2d7960be6735d0d62fe6c2b99a\" rel=\"nofollow\">was added</a> to <code>google.golang.org/appengine</code> (available for Managed VM only). This allows start goroutine and get cloud <code>context.Context</code> without passing it into.</p>\n\n<p><strong>Solution for classic Appengine</strong></p>\n\n<p>There is no solution at the moment.</p>\n"}], "owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2670, "favorite_count": 0, "accepted_answer_id": 32242057, "answer_count": 3, "score": 6, "last_activity_date": 1440656581, "creation_date": 1440314735, "last_edit_date": 1440325015, "question_id": 32164223, "link": "https://stackoverflow.com/questions/32164223/how-can-i-create-cloud-context-context-from-appengine-context", "title": "How can I create cloud context.Context from appengine.Context", "body": "<p>I can't figure out how to call <code>cloud.WithContext</code> and <code>google.DefaultClient</code> if I have <code>appengine.Context</code> and not <code>context.Context</code>. </p>\n\n<p>There are (old) \"appengine\" and (new) \"google.golang.org/appengine\" packages. The first one brings custom <code>appengine.Context</code> when second one comes with <code>context.Context</code> from <code>\"golang.org/x/net/context\"</code></p>\n\n<p>The whole <code>google.golang.org/cloud</code> expects <code>context.Context</code> only.</p>\n\n<p>I would be happy to move to using new <code>\"google.golang.org/appengine\"</code>, but I've stuck with <code>runtime.RunInBackground</code> that have not been ported yet. From <a href=\"https://github.com/golang/appengine\" rel=\"noreferrer\">https://github.com/golang/appengine</a>:</p>\n\n<blockquote>\n  <p><code>appengine/aetest</code>, <code>appengine/cloudsql</code> and <code>appengine/runtime</code> have not been ported yet.</p>\n</blockquote>\n\n<p>What I could write if <code>appengine/runtime</code> have been ported already:</p>\n\n<pre><code>import (\n    \"golang.org/x/net/context\"\n\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/runtime\"\n    \"google.golang.org/cloud\"\n    \"google.golang.org/cloud/storage\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    runtime.RunInBackground(c, func(ctx context.Context) {\n        hc, _ := google.DefaultClient(ctx, storage.ScopeFullControl)\n        cc := cloud.WithContext(ctx, appengine.AppID(ctx), hc)\n        \u2026\n   })\n}\n</code></pre>\n\n<p>but there is no <code>\"google.golang.org/appengine/runtime\"</code> yet. So I have </p>\n\n<pre><code>runtime.RunInBackground(c, func(ctx appengine.Context) {\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1592946300, "post_id": 32163888, "comment_id": 110606270, "body": "When I ran a quick test of this the current file was in <code>runtime.Caller(3)</code> when I was debugging a test so <code>(0)</code> is not guaranteed to be the value you want."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1592985625, "post_id": 32163888, "comment_id": 110617719, "body": "@jcollum you only need to increase this number if you wrapped the <code>runtime.Caller</code> call in functions which are not in the dir you want.  Typically if you made a helper function out of this snippet, you&#39;d replace 0 by 1"}, {"owner": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1593020115, "post_id": 32163888, "comment_id": 110636013, "body": "I think that there&#39;s no way to really determine which level of runtime.Caller you need at runtime. Better to not rely on it if you can."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1593070072, "post_id": 32163888, "comment_id": 110651519, "body": "You can, even statically. Here is what the documentation says: <code>The argument skip is the number of stack frames to ascend, with 0 identifying the caller of Caller.</code>"}, {"owner": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1593119339, "post_id": 32163888, "comment_id": 110676960, "body": "Yes, but that doesn&#39;t address my comment. How do you know how many frames to skip? You can&#39;t, really, so it&#39;s better to not rely on it if you can."}, {"owner": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1593120707, "post_id": 32163888, "comment_id": 110677495, "body": "And really in a compiled language you should probably get over the notion of loading files from a relative path -- that path could be pointing anywhere in the OS. If you really need that file as part of your regular operations it should be packed in to the binary. If it&#39;s an input argument, ok cool, try to load it."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 36339, "user_id": 30946, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/350f30695a2ab75b99d3fce947e856b9?s=128&d=identicon&r=PG", "display_name": "jcollum", "link": "https://stackoverflow.com/users/30946/jcollum"}, "edited": false, "score": 0, "creation_date": 1593165008, "post_id": 32163888, "comment_id": 110690262, "body": "It&#39;s mostly useful in tests. Once compiled, the notion of &quot;path of the source file&quot; is indeed useless."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 36, "last_activity_date": 1440311664, "creation_date": 1440311664, "answer_id": 32163888, "question_id": 32163425, "link": "https://stackoverflow.com/questions/32163425/how-to-get-the-directory-of-the-package-the-file-is-in-not-the-current-working/32163888#32163888", "title": "How to get the directory of the package the file is in, not the current working directory", "body": "<p><a href=\"https://golang.org/pkg/runtime/#Caller\">runtime.Caller</a> is what you want I believe.</p>\n\n<p>Here is a demonstration :</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"path\"\n)\n\nfunc main() {\n    _, filename, _, ok := runtime.Caller(0)\n    if !ok {\n        panic(\"No caller information\")\n    }\n    fmt.Printf(\"Filename : %q, Dir : %q\\n\", filename, path.Dir(filename))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vVa2q-Er6D\">https://play.golang.org/p/vVa2q-Er6D</a></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11702, "favorite_count": 6, "accepted_answer_id": 32163888, "answer_count": 1, "score": 17, "last_activity_date": 1554705162, "creation_date": 1440307040, "last_edit_date": 1554705162, "question_id": 32163425, "link": "https://stackoverflow.com/questions/32163425/how-to-get-the-directory-of-the-package-the-file-is-in-not-the-current-working", "title": "How to get the directory of the package the file is in, not the current working directory", "body": "<p>I'm making a package to make API calls to a service.</p>\n\n<p>I have a test package that I use just to test the API calls and test the functions of the main package which I just <code>include</code> the other package into.</p>\n\n<p>In my main package that I'm working on I have </p>\n\n<p><code>ioutil.ReadFile(filepath.Abs(\"Filename.pub\"))</code></p>\n\n<p>Which is ok, but when I call it from my test package e.g.</p>\n\n<p><code>/Users/####/gocode/src/github.com/testfolder go run main.go</code></p>\n\n<p>it tells me </p>\n\n<p><code>panic: open /Users/####/gocode/src/github.com/testfolder/public.pub: no such file or directory</code></p>\n\n<p>The problem is, is it is looking for <code>public.pub</code> inside of <code>testfolder</code> instead of <code>github.com/apipackage/</code> which is where it is.</p>\n\n<p>Just to clarify this mess of words:</p>\n\n<p>The API Package has a function that reads from the same directory</p>\n\n<p>But because I'm including the API package and Testfolder is the CWD when I <code>go run main.go</code> it is instead trying to get it from the <code>testfolder</code> instead even though the main.go doesn't have the function and is just including it.</p>\n"}, {"tags": ["node.js", "go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440305024, "post_id": 32163233, "comment_id": 52213819, "body": "what about the publicEncrypt? Thanks."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440305299, "post_id": 32163233, "comment_id": 52213859, "body": "When I do <code>fmt.Println(rand.Read(b))</code> it just says 32, is that normal?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 2, "creation_date": 1440305338, "post_id": 32163233, "comment_id": 52213863, "body": "@Datsik: It stores the result in <code>b</code> and returns the number of bytes read (as well as an error \u2013 which you should check), so yes."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 5, "last_activity_date": 1440304986, "creation_date": 1440304986, "answer_id": 32163233, "question_id": 32163173, "link": "https://stackoverflow.com/questions/32163173/what-would-be-the-equivalent-in-golang-of-crypto-randombytes32-in-the-node-cry/32163233#32163233", "title": "What would be the equivalent in Golang of crypto.randomBytes(32) in the Node crypto package?", "body": "<p><a href=\"https://golang.org/pkg/crypto/rand/#Read\" rel=\"noreferrer\"><code>rand.Read</code></a>:</p>\n\n<pre><code>import \"crypto/rand\"\n\u2026\nb := make([]byte, 32)\n_, err := rand.Read(b)\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440304986, "creation_date": 1440304380, "question_id": 32163173, "link": "https://stackoverflow.com/questions/32163173/what-would-be-the-equivalent-in-golang-of-crypto-randombytes32-in-the-node-cry", "title": "What would be the equivalent in Golang of crypto.randomBytes(32) in the Node crypto package?", "body": "<p>Hi guys I'm basically trying to recreate this node package:</p>\n\n<p><a href=\"https://github.com/seishun/node-steam-crypto/blob/master/index.js\" rel=\"nofollow\">https://github.com/seishun/node-steam-crypto/blob/master/index.js</a></p>\n\n<p>In <code>golang</code> so I can make API calls to the Steam API that requires these encrypted <code>sessionKeys</code> and what not.</p>\n\n<p>I was looking through the <code>crypto</code> package but there is so many different hashing methods to use I'm not sure which one would be the closest to the </p>\n\n<p><code>crypto.randomBytes(32)</code> in the node package. </p>\n\n<p>Also the</p>\n\n<p><code>crypto.publicEncrypt()</code></p>\n\n<p>Sorry if this question is crap, not sure how else to word it as I haven't really dealt with this kind of stuff before. Any information would be great thanks.</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440307094, "post_id": 32162698, "comment_id": 52214163, "body": "Ideally you could use <code>go test -c -o &#47;dev&#47;null</code> but the go tool doesn&#39;t let you specify <code>&#47;dev&#47;null</code>. Personally I just put <code>go test -c</code> as my editor&#39;s &quot;make&quot; command and don&#39;t worry about the <code>pkg.test</code> file it produces."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1440297836, "creation_date": 1440297836, "answer_id": 32162698, "question_id": 32162657, "link": "https://stackoverflow.com/questions/32162657/check-tests-compile-without-running-them-or-creating-a-binary/32162698#32162698", "title": "Check tests compile without running them or creating a binary", "body": "<p>I use any non-matching regex for the run flag, like </p>\n\n<pre><code>go test -run NONE ./...\n</code></pre>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 32162698, "answer_count": 1, "score": 1, "last_activity_date": 1440297836, "creation_date": 1440297310, "question_id": 32162657, "link": "https://stackoverflow.com/questions/32162657/check-tests-compile-without-running-them-or-creating-a-binary", "title": "Check tests compile without running them or creating a binary", "body": "<p>How with Go can I check that my tests compile without creating any binaries or executing the tests?</p>\n\n<p>The test equivalent of <code>go build ./...</code>, which does this but ignores tests.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440305006, "post_id": 32162401, "comment_id": 52213817, "body": "Does it matter? Shouldn&#39;t it just be considered an implementation detail. (It closes the <code>Done()</code> channel and removes the new child context from the list of children the parent context knows of, this allows the child context to be garbage collected.)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1440341698, "post_id": 32162401, "comment_id": 52222658, "body": "@DaveC: It&#39;s not that it matters... it&#39;s that I&#39;m curious. And in so far as understanding what the code you write <i>does</i> matters, it matters :)"}], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1440306735, "creation_date": 1440306735, "answer_id": 32163395, "question_id": 32162401, "link": "https://stackoverflow.com/questions/32162401/what-does-net-contexts-cancel-function-do/32163395#32163395", "title": "What does net/context&#39;s cancel() function do?", "body": "<p>The code example you give comes from <a href=\"https://godoc.org/golang.org/x/net/context/#WithTimeout\" rel=\"nofollow\">the <code>context.WithTimeout</code> documentation</a>, here it is again slightly modified:</p>\n\n<pre><code>func slowOperationWithTimeout(parentContxt context.Context) (Result, error) {\n    childContext, cancel := context.WithTimeout(parentContxt, 100*time.Millisecond)\n    defer cancel()  // releases resources if slowOperation completes before timeout elapses\n    return slowOperation(childContext)\n}\n</code></pre>\n\n<p>(Here I've renamed <code>ctx</code> to make it clear which I'm talking about, in real code it's better to just use <code>ctx</code> as you don't want or need to distinguish the parent/child contextes.)</p>\n\n<p>Calling the returned cancel function does (at least) two important things.\nFirst, it closes the channel that <code>childContext.Done()</code> returns. This might be import if, for example, <code>slowOperation</code> started something in a goroutine with that context (or a [grand]child context).</p>\n\n<p>Second, cancelling <code>childContext</code> tells <code>parentContext</code> to forget about it.\nThere are references to the child context in the local variable and another in the parent's list of all it's children (and any references <code>slowOperation</code> may have kept). If it's not cancelled when it's no longer needed, the parent wastes space keeping it around until the child context eventually times out and cancels itself, among other things that can delay the child context and it's done channel from being garbage collected.</p>\n\n<p>It's also possible a context implementation (or a future change) could have other resources used until cancelled.\nIf the documentation says you should do something, then do it (even if it were to do nothing in current implementations).\nIn that sense, the answer to \"Why?\" for such things is simply, \"Because the documentation said that's the correct way to use it\".</p>\n"}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 711, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440306735, "creation_date": 1440294070, "question_id": 32162401, "link": "https://stackoverflow.com/questions/32162401/what-does-net-contexts-cancel-function-do", "title": "What does net/context&#39;s cancel() function do?", "body": "<p><a href=\"https://godoc.org/golang.org/x/net/context\" rel=\"nofollow\">net/context</a>'s <code>WithDeadline()</code> and <code>WithTimeout()</code> functions both return a <code>cancel</code> function, which docs say to always call with a defer, such as:</p>\n\n<pre><code>func slowOperationWithTimeout(ctx context.Context) (Result, error) {\n    ctx, cancel := context.WithTimeout(ctx, 100*time.Millisecond)\n    defer cancel()  // releases resources if slowOperation completes before timeout elapses\n</code></pre>\n\n<p>But what \"resources\" are actually being released in this function?</p>\n"}, {"tags": ["go", "switch-statement"], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 8, "last_activity_date": 1440276918, "creation_date": 1440276918, "answer_id": 32160702, "question_id": 32160648, "link": "https://stackoverflow.com/questions/32160648/switch-case-different-types-with-go/32160702#32160702", "title": "Switch case Different Types with go", "body": "<p>Just use a generic switch:</p>\n\n<pre><code>func main() {\n    i := 5\n    switch {\n    case i == 4:\n        fmt.Println(\"4\")\n    case i &gt; 8:\n        fmt.Println(\"i is greator than 8\")\n    default: \n        fmt.Printf(\"i = (%v), i != 4 &amp;&amp; i &lt;= 8\\n\", i)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31539, "user_id": 367985, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/761edb9c3cf7a0a643e73ef40666a1f7?s=128&d=identicon&r=PG", "display_name": "CuriousMind", "link": "https://stackoverflow.com/users/367985/curiousmind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 32160702, "answer_count": 1, "score": 0, "last_activity_date": 1440276918, "creation_date": 1440276605, "question_id": 32160648, "link": "https://stackoverflow.com/questions/32160648/switch-case-different-types-with-go", "title": "Switch case Different Types with go", "body": "<p>The following program doesn't compile due to type mismatch error(int vs bool)</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    i := 5\n    switch i {\n    case 4:\n        fmt.Println(\"4\")\n    case i &gt; 8:\n        fmt.Println(\"i is greator than 8\")\n    }\n}\n</code></pre>\n\n<p>As someone from Dynamic Typing background, this the above is bit of a culture shock. so wondering what's the idiomatic way do this in GO?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 2, "creation_date": 1440269130, "post_id": 32159402, "comment_id": 52206924, "body": "You have to understand that the statement <code>go thread_1()</code> returns immediately, so all of your goroutines are created in a really short time, so all of the 200 Sleep calls will return almost at the same time."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 3, "last_activity_date": 1440268383, "creation_date": 1440268383, "answer_id": 32159476, "question_id": 32159402, "link": "https://stackoverflow.com/questions/32159402/need-help-to-understand-this-weird-bahaviour-of-go-routines/32159476#32159476", "title": "Need help to understand this weird bahaviour of go routines", "body": "<p>You span 100 goroutines running thread_1 and 100 goroutines running thread_2 in one big batch. Each of these 200 goroutines sleeps for one second and then prints and ends. So yes, the behavior is to be expected: 200 goroutines sleeping each 1 second in parallel and then 200 goroutines printing in parallel.</p>\n\n<p>(And I do not understand your second question)</p>\n"}], "owner": {"reputation": 53, "user_id": 1969267, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/2q2ve.jpg?s=128&g=1", "display_name": "sameer oak", "link": "https://stackoverflow.com/users/1969267/sameer-oak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1440268919, "creation_date": 1440267870, "last_edit_date": 1440268919, "question_id": 32159402, "link": "https://stackoverflow.com/questions/32159402/need-help-to-understand-this-weird-bahaviour-of-go-routines", "title": "Need help to understand this weird bahaviour of go routines", "body": "<p>I've following code using go routines:</p>\n\n<pre><code>package main\n\nimport  ( \n    \"fmt\"\n    \"time\"\n)\n\nfunc thread_1(i int)    {\n    time.Sleep(time.Second * 1)\n    fmt.Println(\"thread_1: i: \",i)\n}   \n\nfunc thread_2(i int)    {\n    time.Sleep(time.Second * 1)\n    fmt.Println(\"thread_2: i: \",i)\n}\n\nfunc main() {\n    for i := 0; i &lt; 100; i++    {\n        go thread_1(i)\n        go thread_2(i)\n    }\n\n    var input string\n    fmt.Scanln(&amp;input)\n} \n</code></pre>\n\n<p>I was expecting each go routine would wait for a second and then print its value of i.</p>\n\n<p>However, both the go routines waited for 1 second each and printed all the values of i at once.</p>\n\n<p>Another question in the same context is:\nI've a server-client application where server spawns a receiver go routine to receive data from client one for each client connection. Then the receiver go routine spawns a worker go routine called processor to process the data. There could be multiple receiver go routines and hence multiple processor go routines.\nIn such a case some receiver and processor go routines may hog indefinitely.</p>\n\n<p>Please help me understand this behaviour.</p>\n"}, {"tags": ["go", "floating-accuracy"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 4, "creation_date": 1440257845, "post_id": 32157833, "comment_id": 52203671, "body": "Read <a href=\"http://floating-point-gui.de/\" rel=\"nofollow noreferrer\">floating-point-gui.de</a> and consider using some <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">bignum</a> library"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1440262193, "post_id": 32157833, "comment_id": 52204869, "body": "You asked basically the same thing yesterday: <a href=\"http://stackoverflow.com/questions/32143511/accuracy-in-go-programs\">Accuracy in Go Programs</a>"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 3, "creation_date": 1440262966, "post_id": 32157833, "comment_id": 52205108, "body": "Notice that the argument of <code>SetFloat64()</code> has type <code>float64</code>, thus your high precision is being truncated to the precision of a <code>float64</code> before being converted to a big float."}, {"owner": {"reputation": 64746, "user_id": 157957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBRE7.jpg?s=128&g=1", "display_name": "IMSoP", "link": "https://stackoverflow.com/users/157957/imsop"}, "edited": false, "score": 3, "creation_date": 1440263069, "post_id": 32157833, "comment_id": 52205146, "body": "If I read this right, you&#39;re creating a bunch of high-accuracy variables, and then immediately converting them back to standard floats <i>before</i> doing anything with them. So you might as well skip the use of big.Float entirely."}, {"owner": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "edited": false, "score": 0, "creation_date": 1440263358, "post_id": 32157833, "comment_id": 52205236, "body": "Yes the Go math.Pow function only accepts float64 types not big.Float. I need to find an alternative way of raising powers that will work with larger datatypes"}, {"owner": {"reputation": 64746, "user_id": 157957, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MBRE7.jpg?s=128&g=1", "display_name": "IMSoP", "link": "https://stackoverflow.com/users/157957/imsop"}, "edited": false, "score": 0, "creation_date": 1440263550, "post_id": 32157833, "comment_id": 52205301, "body": "OK, so that&#39;s the question you should be asking then - you know why this code doesn&#39;t work (it&#39;s using float64 values, which have limited accuracy), because it&#39;s effectively the same as you posted in your previous question."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1440265390, "post_id": 32157833, "comment_id": 52205830, "body": "@Kevin you should use <code>SetString</code>"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "edited": false, "score": 0, "creation_date": 1440260322, "post_id": 32158058, "comment_id": 52204332, "body": "Thank you for your answer. I guess I am trying to avoid loops which will not perform so well when the input to fib is high. Your solution is great when you pass 100 but performs more slowly as the numbers increase. Which is why I am trying out Binet&#39;s method."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "edited": false, "score": 3, "creation_date": 1440262826, "post_id": 32158058, "comment_id": 52205063, "body": "@Kevin The fastest way to compute Fibonacci numbers is via repeated matrix squaring as described <a href=\"https://en.wikipedia.org/wiki/Fibonacci_number#Matrix_form\" rel=\"nofollow noreferrer\">here</a>. You don&#39;t really want to mess with floating point numbers as the results get imprecise."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "edited": false, "score": 0, "creation_date": 1440401065, "post_id": 32158058, "comment_id": 52238913, "body": "@Kevin, adding 100 <code>big.Int</code>s could be faster than calling calculating Binet&#39;s formula using <code>big.Float</code>."}, {"owner": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "edited": false, "score": 0, "creation_date": 1440506473, "post_id": 32158058, "comment_id": 52292559, "body": "Agreed, but will adding 4 millions ints be faster?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 6, "last_activity_date": 1440283803, "last_edit_date": 1440283803, "creation_date": 1440259206, "answer_id": 32158058, "question_id": 32157833, "link": "https://stackoverflow.com/questions/32157833/float-accuracy-in-go/32158058#32158058", "title": "Float Accuracy in Go", "body": "<p>You are using <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">IEEE 754 64-bit floating point</a>.</p>\n\n<p>In Go, to calculate <code>fib(100)</code> accurately you could simply say:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc fib(n int) *big.Int {\n    f := big.NewInt(0)\n    a, b := big.NewInt(0), big.NewInt(1)\n    for i := 0; i &lt;= n; i++ {\n        f.Set(a)\n        a.Set(b)\n        b.Add(f, b)\n    }\n    return f\n}\n\nfunc main() {\n    fmt.Println(fib(100))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>354224848179261915075\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 2581199, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d73ec3d17f22435cfb35fd03ccaab721?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/2581199/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 1, "closed_date": 1610957591, "answer_count": 1, "score": 1, "last_activity_date": 1440298136, "creation_date": 1440257649, "last_edit_date": 1495541678, "question_id": 32157833, "link": "https://stackoverflow.com/questions/32157833/float-accuracy-in-go", "closed_reason": "Duplicate", "title": "Float Accuracy in Go", "body": "<p>This question is a follow on from <a href=\"https://stackoverflow.com/questions/32143511/accuracy-in-go-programs\">a previous question I asked</a>. The answers I received suggested that I make use of the Go math.Big library. In this question I use the library but unfortunately to little effect.</p>\n\n<p>I am trying to using the Binet formula to calculate fib(100). I am using\nGo's Big.Float but without success. I get accuracy to about 10 decimal\nplaces. Please advise.</p>\n\n<p>I am trying to avoid loops/recursion as I think these approaches will\nnot scale well. Hence my attempt to leverage Binet's formula</p>\n\n<p>// currently produces inaccurate results as the input increases.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n    \"math\"\n    \"strconv\"\n)\n\nfunc fib(n int) float64  {\n    var sroot5 = new(big.Float).SetPrec(200).SetFloat64(2.236067977499789696409173668731276235440618359611525724270897)\n    var phi = new(big.Float).SetPrec(200).SetFloat64(1.61803398874989484820458683436563811772030917980576286213544862)\n    var minusPhi = new(big.Float).SetPrec(200).SetFloat64(-0.61803398874989484820458683436563811772030917980576)\n\n    var fltP float64;\n    fltP, _ = phi.Float64()\n\n    var fltN float64;\n    fltN, _ = minusPhi.Float64()\n\n    var denom float64\n    denom, _ = sroot5.Float64()\n\n    // Magic fib formula (Binet) is:\n    // (Phi ^ n - (-phi ^ n)) / sqrt(5)\n\n    z := (math.Pow(fltP, float64(n)) - math.Pow(fltN, float64(n))) / denom \n\n    return math.Ceil(z) \n\n}\n\nfunc main() {\n\n    fib(100)\n\n    fmt.Println(strconv.FormatFloat(fib(100), 'f', 0, 64))\n    fmt.Println(\"true answer of fib(100) should be -&gt; 354224848179261915075\")\n\n}\n</code></pre>\n"}, {"tags": ["http", "redirect", "go"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440252337, "post_id": 32156078, "comment_id": 52202115, "body": "The <code>Client.CheckRedirect</code> allows me to capture redirect URLs, but I would also like to know their status codes, i.e. 301, 302 etc, for which I believe <a href=\"http://stackoverflow.com/questions/24577494/how-to-get-the-http-redirect-status-codes-in-golang\">this SO answer</a> says I need to create my own RoundTripper. I tried the CancelRequest here but that made no difference - I made the server sleep 5 seconds, and timeout at one second, and still no luck. The updated code with the sleep and cancelrequest is <a href=\"http://play.golang.org/p/zOxvQdCjOz\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440286616, "post_id": 32156078, "comment_id": 52211264, "body": "@AbhishekShivanna: I&#39;m not sure why the CancelRequest doesn&#39;t work for you without the code and error, but I put in a minimal example. I would also avoid putting the <code>Do</code>method in the <code>Transport</code>, since that&#39;s belongs to the <code>Client</code>, and makes the code confusing with a circular reference between the two."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440317561, "post_id": 32156078, "comment_id": 52216223, "body": "Thanks Alot ! I&#39;ve decided to go with the approach of embedding. When you talk about concurrency protection, is it because the same transport wrapper might be used in another client as well ? I plan on creating a new transport wrapper and client for each URL that I want all its redirects for. In this case I shouldn&#39;t need locks right ? Or are the locks for some internal magic and go routines that the default transport performs ?"}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440318642, "post_id": 32156078, "comment_id": 52216468, "body": "I made the server sleep for 5 seconds before giving a response. This causes a <code>panic: runtime error: invalid memory address or nil pointer dereference</code> . It points to <code>t.reqMu.Lock()</code> <a href=\"http://golang.org/src/net/http/transport.go\" rel=\"nofollow noreferrer\">line 280 of transport.go</a>  ."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440320159, "post_id": 32156078, "comment_id": 52216799, "body": "It also seems to be calling CancelRequest even after I have got a response. I&#39;ve tested this by running a sleep after the request has finished successfully. I figured out that this is because I did not do a <code>resp.Body.Close()</code>. On a successful run, I can do this, but what about in the round tripper  ? I wouldnt want to close the body there right ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440424810, "post_id": 32156078, "comment_id": 52253810, "body": "@AbhishekShivanna: the nil pointer dereference is because you&#39;re not assigning a transport to your wrapper. I added a default assignment in my example now. You <i>always</i> need to close the response Body. Yes, you also need to read the entire body to finish the request, or the timeout will get called. You should also try to read any body (up to a limit) in the redirect responses in case there is data there so the connections can be reused. Look at the source of <code>doFollowingRedirects</code> in the source of <code>http&#47;client.go</code> for example."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440579223, "post_id": 32156078, "comment_id": 52326972, "body": "Thanks. Its working properly now. Just to clarify - Do I have to close every single redirect response body inside roundtripper, or only the final response - I figured, since I am returning the response, the caller will close it - not the roundtripper. Also, <code>t.Transport=transport</code> works, but I dont understand how and why - I went down a completely different path looking at go source code to debug this - before you answered it. Also - isn&#39;t it a good idea not to touch the response body as the caller would want to use it, not the roundtripper ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440595887, "post_id": 32156078, "comment_id": 52338564, "body": "@AbhishekShivanna: You only have to ensure that every Body is closed <i>eventually</i>. When you return a response to the client, that becomes the client&#39;s responsibility. <code>t.Transport = transport</code> is because the <code>Transport</code> needs to be assigned for the <code>CancelRequest</code> call later on, otherwise it will still be <code>nil</code>."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440679813, "post_id": 32156078, "comment_id": 52380111, "body": "But why will it be nil - given that I am the one creating the transport wrapper and making the request - does it somehow go out of scope and removed by the time CancelRequest kicks in ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440682353, "post_id": 32156078, "comment_id": 52382106, "body": "@AbhishekShivanna: There&#39;s is no scope issue, it&#39;s nil because you never assigned it anywhere else. It would be more clear to put it in the constructor anyway -- I&#39;ll move the assignment and see if that clarifies things for you."}, {"owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "edited": false, "score": 0, "creation_date": 1440691265, "post_id": 32156078, "comment_id": 52388637, "body": "Thanks I get it now. We never assigned it so cancel request if ever called would always panic because of the nil. By now putting it in the constructor , I can eliminate that code in the round trip right ?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1440682476, "last_edit_date": 1440682476, "creation_date": 1440246183, "answer_id": 32156078, "question_id": 32154712, "link": "https://stackoverflow.com/questions/32154712/go-lang-capture-redirect-urls-and-status-codes-with-timeouts/32156078#32156078", "title": "Go lang Capture Redirect urls and status codes with timeouts", "body": "<p>There is already a hook for checking redirects, <a href=\"http://golang.org/pkg/net/http/#Client\" rel=\"nofollow\"><code>Client.CheckRedirect</code></a>.</p>\n\n<p>You can supply a callback to do what you want.</p>\n\n<p>If you really want to create you're own transport to extend other functionality, you would need to supply a <code>CancelRequest</code> method like the error says to handle <code>Client.Timeout</code>.</p>\n\n<pre><code>func (t *TransportWrapper) CancelRequest(req *Request) {\n    t.Transport.CancelRequest(req)\n}\n</code></pre>\n\n<p>More commonly, you would embed the <code>Transport</code>, so that all the methods and fields are automatically promoted. You should avoid writable fields in the transport however, since it's expected to be safe to use concurrently, otherwise you should have all access protected with a mutex, or you must make sure it's only used in one goroutine. </p>\n\n<p>A minimal example would look like:</p>\n\n<pre><code>type TransportWrapper struct {\n    *http.Transport\n    RedirectUrls []Redirect\n}\n\nfunc (t *TransportWrapper) RoundTrip(req *http.Request) (*http.Response, error) {\n    transport := t.Transport\n    if transport == nil {\n        transport = http.DefaultTransport.(*http.Transport)\n    }\n\n    resp, err := transport.RoundTrip(req)\n    if err != nil {\n        return resp, err\n    }\n\n    // Remember redirects\n    if resp.StatusCode &gt;= 300 &amp;&amp; resp.StatusCode &lt;= 399 {\n        fmt.Println(\"redirected\")\n        t.RedirectUrls = append(\n            t.RedirectUrls, Redirect{resp.StatusCode, req.URL.String()},\n        )\n    }\n    return resp, err\n}\n</code></pre>\n\n<p>And you can then use the timeout in the client:</p>\n\n<pre><code>client := &amp;http.Client{\n    Transport: &amp;TransportWrapper{\n        Transport: http.DefaultTransport.(*http.Transport),\n    },\n    Timeout: 5 * time.Second,\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5254533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c00b9efb070b91c7750a9301a4effcc2?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Shivanna", "link": "https://stackoverflow.com/users/5254533/abhishek-shivanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1723, "favorite_count": 1, "accepted_answer_id": 32156078, "answer_count": 1, "score": 5, "last_activity_date": 1440682476, "creation_date": 1440237117, "last_edit_date": 1495542126, "question_id": 32154712, "link": "https://stackoverflow.com/questions/32154712/go-lang-capture-redirect-urls-and-status-codes-with-timeouts", "title": "Go lang Capture Redirect urls and status codes with timeouts", "body": "<p>I am trying to make a request to a given url, and capture the redirect urls and their status codes that were followed.</p>\n\n<p>I've tried looking for an answer to my specific question - <a href=\"https://stackoverflow.com/questions/24577494/how-to-get-the-http-redirect-status-codes-in-golang\">this</a> came close .</p>\n\n<p>However, I need to also add proxy, user agent and timeouts on the entire connection i.e. No matter how many redirects / proxy latency etc, the amount of time should not exceed X seconds.</p>\n\n<p>I've handled user-agent by setting request header, and proxy by adding it to the Transport struct.\nI tried exploring CheckRedirect for redirects - but that gives me only Url, I needed the status code as well, so I had to implement the RoundTrip function.</p>\n\n<p>Everything works well as of now - except for the Timeout.\nHeres what I have so far - <a href=\"http://play.golang.org/p/m6-ukzykSQ\" rel=\"nofollow noreferrer\">playground link</a>\nI've pasted the relevant code here as well - the playground has a full version with a mock redirect server in place - Unfortunately it panics saying connection refused possibly because of playground restrictions - It works completely locally though.</p>\n\n<pre><code>type Redirect struct {\n    StatusCode int\n    URL string\n}\n\ntype TransportWrapper struct {\n    Transport http.RoundTripper\n    Url string\n    Proxy string\n    UserAgent string\n    TimeoutInSeconds int\n    FinalUrl string\n    RedirectUrls []Redirect\n}\n// Implementing Round Tripper to capture intermediate urls\nfunc (t *TransportWrapper) RoundTrip(req *http.Request) (*http.Response, error) {\n    transport := t.Transport\n    if transport == nil {\n        transport = http.DefaultTransport\n    }\n\n    resp, err := transport.RoundTrip(req)\n    if err != nil {\n        return resp, err\n    }\n\n    // Remember redirects\n    if resp.StatusCode &gt;= 300 &amp;&amp; resp.StatusCode &lt;= 399 {\n        t.RedirectUrls = append(\n            t.RedirectUrls, Redirect{resp.StatusCode, req.URL.String()},\n        )\n    }\n    return resp, err\n}\n\nfunc (t *TransportWrapper) Do() (*http.Response, error) {\n    t.Transport = &amp;http.Transport{}\n    if t.Proxy != \"\" {\n        proxyUrl, err := url.Parse(t.Proxy)\n        if err != nil {\n            return nil, err\n        }\n\n        t.Transport = &amp;http.Transport{Proxy:http.ProxyURL(proxyUrl)}\n        // HELP\n        // Why does this fail\n        // t.Transport.Proxy = http.ProxyUrl(proxyUrl)\n    }\n\n    client := &amp;http.Client{\n        Transport: t, // Since I've implemented RoundTrip I can pass this\n        // Timeout: t.TimeoutInSeconds * time.Second, // This Fails \n    }\n\n    req, err := http.NewRequest(\"GET\", t.Url, nil)\n    if err != nil {\n        return nil, err\n    }\n\n    if t.UserAgent != \"\" {\n        req.Header.Set(\"User-Agent\", t.UserAgent)\n    }\n\n    resp, err := client.Do(req)\n    if err != nil {\n        return nil, err\n    }\n\n    t.FinalUrl = resp.Request.URL.String()\n    return resp, nil\n}\n\nfunc startClient() {\n    t := &amp;TransportWrapper {\n        Url: \"http://127.0.0.1:8080/temporary/redirect?num=5\",\n        // Proxy\n        // UserAgent\n        // Timeout\n    }\n\n    _, err := t.Do()\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"Intermediate Urls: \\n\")\n    for i, v := range t.RedirectUrls {\n        fmt.Printf(\"[%d] %s\\n\", i, v)\n    }\n\n}\n</code></pre>\n\n<p>Question 1 : How do I Add the timeout ? </p>\n\n<p>Attempt #1 :  </p>\n\n<pre><code>client := &amp;http.Client{ Transport: t, Timeout: myTimeout }\n</code></pre>\n\n<p>But Go complains saying \" *main.TransportWrapper doesn't support CancelRequest; Timeout not supported \"</p>\n\n<p>Attempt #2 :</p>\n\n<pre><code>// Adding a CancelRequest\nfunc (t *TransportWrapper) CancelRequest(req *http.Request) {\n    dt := http.DefaultTransport\n    dt.CancelRequest(req)\n}\n</code></pre>\n\n<p>But Go complains saying \"dt.CancelRequest undefined (type http.RoundTripper has no field or method CancelRequest)\"</p>\n\n<p>How do I implement this CancelRequest without doing too much and just let default CancelRequest take over ?</p>\n\n<p>Question 2 : Have I gone down a bad path and is there an alternative to solving the problem , </p>\n\n<p>Given a Url, Proxy, UserAgent and Timeout - return the response along with the redirect urls and their status codes followed to get there.</p>\n\n<p>I hope I've worded this appropriately.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["sockets", "tcp", "go"], "answers": [{"comments": [{"owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 1, "creation_date": 1440234016, "post_id": 32154146, "comment_id": 52196905, "body": "That means without knowing the expected length, there is no way to gracefully discard the current ill-formatted command? Server&#39;s read() blocks for more data (in fact all data has been read), yet client will not send the next command until it receives server&#39;s response. Setting a timeout for read() can break the deadlock, but is that good practice?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 2, "creation_date": 1440237118, "post_id": 32154146, "comment_id": 52197703, "body": "@NeoWang If you receive junk you should close the connection. There&#39;s nothing wrong with using read timeouts: I&#39;ve frequently stated that you can&#39;t write practical networking code without them."}, {"owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "reply_to_user": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "edited": false, "score": 2, "creation_date": 1440242877, "post_id": 32154146, "comment_id": 52199290, "body": "@NeoWang this answer is correct, but you can also fail fast by strictly enforcing the format of the first line. Try to read a command, length and newline and if any of those is wrong close the connection."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1440248081, "post_id": 32154146, "comment_id": 52200866, "body": "&#39;That means without knowing the expected length, there is no way to gracefully discard the current ill-formatted command?&#39; - that depends on how bad your protocol is.  If there is no header that is easily and quickly detected as invalid, then no, you cannot recover easily.  Sending the packet length as a network-aligned int is not easily rejected as a bad header.  An SOH, followed by fixed-length ASCII decimal data length, a header CRC and an ETX is easily and quickly rejected if bad."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 7, "last_activity_date": 1440232917, "creation_date": 1440232917, "answer_id": 32154146, "question_id": 32153961, "link": "https://stackoverflow.com/questions/32153961/how-can-i-read-all-data-in-one-message-a-client-sends-over-tcp-connection-withou/32154146#32154146", "title": "How can I read all data in one message a client sends over TCP connection without blocking in Go?", "body": "<ul>\n<li>There is no such thing as a message in TCP.</li>\n<li>There is no guarantee that all the bytes sent by a single <code>send()</code> will arrive together, or that they will all fit into the receiver's socket receive buffer.</li>\n<li>It is therefore impossible to accomplish your objective.</li>\n</ul>\n\n<p>It is also pointless. You can't do anything until the entire command arrives, and you are certainly goino to be blocking between commands anyway. Blocking during reception of a command doesn't do any further harm.</p>\n"}], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 32154146, "answer_count": 1, "score": 0, "last_activity_date": 1440232917, "creation_date": 1440231515, "last_edit_date": 1440232623, "question_id": 32153961, "link": "https://stackoverflow.com/questions/32153961/how-can-i-read-all-data-in-one-message-a-client-sends-over-tcp-connection-withou", "title": "How can I read all data in one message a client sends over TCP connection without blocking in Go?", "body": "<p>I am implementing the server of a procotol in Go. In this protocol, the client connects to server and can send a bunch of commands, and expects a response from server after each command is sent. The command message is of this format:<code>COMMAND &lt;BODY_LENGTH&gt;\\r\\n BODY\\r\\n</code>, where the BODY_LENGTH is arbiturary, and specified on the command line.</p>\n\n<p>The way I am parsing the command is: Read the first few bytes from <code>net.Conn</code>, parse the command and body length, and read the entire body with another read, process the message, send a response, and loops to wait for the next command message on the connection:</p>\n\n<pre><code>func handler(c net.Conn) {\n    defer c.Close()\n    for {\n        msg := make([]byte, 1024)\n\n        n, err := c.Read(msg)\n        cmd, bodyLength = parseCommand(msg)\n        // read the body of body length here\n        if err == io.EOF {\n            fmt.Printf(\"Client has closed the connection\")\n            break\n        } \n\n        response := handleCommand(cmd, body)\n        n, err := c.Write(response)\n        if err != nil {\n            fmt.Printf(\"ERROR: write\\n\")\n            fmt.Print(err)\n        }\n        fmt.Printf(\"SERVER: sent %v bytes\\n\", n)\n    }\n}\n</code></pre>\n\n<p><em>I assume (Go documentation isn't clear on this) <code>net.Conn.Read()</code> to block when waiting for the next message from client and only return io.EOF when the client has close the connection. Correct me if I am wrong.</em></p>\n\n<p>If the command is well-formatted, everything is fine. But if the command is ill-formatted, and I don't get a body length in the first line, I wish I can still read the rest of message, discard it, and wait for the next possibly valid message. The problem is, if I don't know the length of data to expect, I may start a read() that blocks if I have just read the last byte.</p>\n\n<p>How can I read the entire message (everything buffered) without knowing its length? Or do I have to close the connection, and tell client to start a new connection for the next command?</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 4746, "user_id": 394572, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/1572070193/picture?type=large", "display_name": "alioygur", "link": "https://stackoverflow.com/users/394572/alioygur"}, "edited": false, "score": 1, "creation_date": 1455928998, "post_id": 32153927, "comment_id": 58725836, "body": "how about this question ? I have same problem"}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "edited": false, "score": 0, "creation_date": 1488682065, "post_id": 32153927, "comment_id": 72338057, "body": "I would think you want m.User = u in that nested loop."}], "answers": [{"comments": [{"owner": {"reputation": 11718, "user_id": 143880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2df1e203c8603d13e199df6fa9e8ecab?s=128&d=identicon&r=PG", "display_name": "johntellsall", "link": "https://stackoverflow.com/users/143880/johntellsall"}, "edited": false, "score": 0, "creation_date": 1503617991, "post_id": 43774498, "comment_id": 78703639, "body": "Note <code>$lookup</code> is Mongo version 3.2+"}], "tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": false, "score": 3, "last_activity_date": 1493875548, "creation_date": 1493875548, "answer_id": 43774498, "question_id": 32153927, "link": "https://stackoverflow.com/questions/32153927/how-to-dereference-dbref-in-mgo/43774498#43774498", "title": "How to dereference dbref in mgo?", "body": "<p>Instead of using <a href=\"https://docs.mongodb.com/manual/reference/database-references/#dbref-explanation\" rel=\"nofollow noreferrer\">DBRef</a>, you can just use <a href=\"https://docs.mongodb.com/manual/reference/database-references/#document-references\" rel=\"nofollow noreferrer\">manual reference</a> method for connecting two or more related documents. For example your struct can just look as below: </p>\n\n<pre><code>type User struct{\n    Id bson.ObjectId `bson:\"_id\"`\n    Name string `json:\"name\"`\n}\n\ntype Post struct{\n    UserId bson.ObjectId `json:\"userid\"` // manual ref to User\n    Title string\n}\n</code></pre>\n\n<p>You can then use <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/\" rel=\"nofollow noreferrer\">$lookup aggregation stage</a> to perform a left outer join. For example, to find out all posts based on users: </p>\n\n<pre><code>pipeline := []bson.M{ \n        bson.M{\"$lookup\": bson.M{\n                            \"from\": \"posts\", \n                            \"foreignField\":\"userid\",\n                            \"localField\":\"_id\",\n                            \"as\":\"posts\",\n                            },\n              },\n        }\n\nresult := []bson.M{}    \nerr := coll_users.Pipe(pipeline).All(&amp;result)\n</code></pre>\n\n<p>Example result: </p>\n\n<pre><code>{\n  \"_id\": ObjectId(\"590ab726f4bab950360c2dbe\"),\n  \"name\": \"test\",\n  \"posts\": [\n    {\n      \"_id\": ObjectId(\"590ab72619663bad7743ff9e\"),\n      \"userid\": ObjectId(\"590ab726f4bab950360c2dbe\"),\n      \"title\": \"test manual reference\"\n    }\n  ]\n}\n</code></pre>\n\n<p>Alternative to storing users and posts in separate collections, you could also embed/sub-document. See also <a href=\"https://docs.mongodb.com/manual/core/data-modeling-introduction/\" rel=\"nofollow noreferrer\">Data Modelling</a></p>\n"}], "owner": {"reputation": 121, "user_id": 4609881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a7a89befa0359c305f7fb91d4d3644?s=128&d=identicon&r=PG&f=1", "display_name": "benyu", "link": "https://stackoverflow.com/users/4609881/benyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 1, "answer_count": 1, "score": 10, "last_activity_date": 1493875548, "creation_date": 1440231226, "last_edit_date": 1440231664, "question_id": 32153927, "link": "https://stackoverflow.com/questions/32153927/how-to-dereference-dbref-in-mgo", "title": "How to dereference dbref in mgo?", "body": "<pre><code>var (\n    type User struct{\n        Id bson.ObjectId `bson:\"_id\"`\n        Name string\n    }\n\ntype Post struct{\n    Id bson.ObjectId `bson:\"_id\"`\n    Uid string\n    User User\n    ref mgo.DBRef\n    Title string\n    }\n)\n</code></pre>\n\n<blockquote>\n  <p>//try 10000 times inserts</p>\n</blockquote>\n\n<pre><code>id := bson.NewObjectId()\nuser := &amp;User{ id, \"test\"}\ndb.C(\"users\").insert(user)\n\npost := db.C(\"Post\").insert(&amp;Post{Uid: id.hex(), ref: mgo.DBRef{\"ref\":\"users\", \"id\": id}, Title:\"test dbref\"})\n</code></pre>\n\n<blockquote>\n  <blockquote>\n    <p>//first way so dirty -_-!</p>\n  </blockquote>\n</blockquote>\n\n<p>//mysql: left join users on user.id=post.uid, how to do in mgo \uff1f</p>\n\n<pre><code>posts := new([]User)\ndb.C(\"posts\").Find(nil).All(posts)\n\nids := []bson.ObjectId\nfor _, p := range posts{\n  ids = append(ids, p.Uid)\n}\n\nusers := make([]User, len(ids))\ndb.C(\"users\").Find(bson.M{\"_id\": {\"$in\": ids}}).All(users)\n\n//and then set the User attribute?\nfor _,u := range users {\n   for _, m := range m{\n       if m.Uid == u.Id {\n          m.User = m\n       }\n   }\n}\n</code></pre>\n\n<blockquote>\n  <p>secondary way\uff0cwith ref attribute, but mgo.session will try to findid</p>\n</blockquote>\n\n<pre><code>for _,m := range posts{\n   db.FindRef(m.ref).One(&amp;m.User)\n}\n</code></pre>\n\n<blockquote>\n  <p>//3th way, with mapReduce ??</p>\n</blockquote>\n\n<p>it's my first golang + mongodb, so what is the best way to archive dbref or joins?</p>\n\n<p>Thx</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 7, "last_activity_date": 1440335398, "last_edit_date": 1495539908, "creation_date": 1440226295, "answer_id": 32153284, "question_id": 32153093, "link": "https://stackoverflow.com/questions/32153093/what-does-rob-pike-mean-by-the-synchronization-nature-of-the-channels-in-go/32153284#32153284", "title": "What does Rob Pike mean by &quot;the synchronization nature of the channels&quot; in Go?", "body": "<p>It just means <a href=\"https://stackoverflow.com/a/25795236/6309\">those channels are unbuffered</a>.</p>\n\n<pre><code>    fmt.Println(&lt;-joe)\n    fmt.Println(&lt;-ann)\n</code></pre>\n\n<p>The second line won't be able to execute before the first completes.<br>\nAnd the first won't complete until something writes in joe's channel.</p>\n\n<p>Ann won't be able to write in Ann's channel if that channel has already a value.<br>\nAnd that channel won't be read (<code>fmt.Println(&lt;-ann)</code>) until joe's channel is read first (<code>fmt.Println(&lt;-joe)</code>).</p>\n\n<p>Both channels are independent (unaware of each other), but the sequential nature of the read operations make one waiting for the other to be read first.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1440226589, "creation_date": 1440226589, "answer_id": 32153317, "question_id": 32153093, "link": "https://stackoverflow.com/questions/32153093/what-does-rob-pike-mean-by-the-synchronization-nature-of-the-channels-in-go/32153317#32153317", "title": "What does Rob Pike mean by &quot;the synchronization nature of the channels&quot; in Go?", "body": "<p>The channels are unbuffered.</p>\n\n<pre><code>c := make(chan string)\n</code></pre>\n\n<blockquote>\n  <p>The capacity, in number of elements, sets the size of the buffer in\n  the channel. If the capacity is zero or absent, the channel is\n  unbuffered and communication succeeds only when both a sender and\n  receiver are ready. Otherwise, the channel is buffered and\n  communication succeeds without blocking if the buffer is not full\n  (sends) or not empty (receives). A nil channel is never ready for\n  communication.</p>\n</blockquote>\n\n<p>The receives will be in sequence, joe followed by ann.</p>\n\n<pre><code>fmt.Println(&lt;-joe)\nfmt.Println(&lt;-ann)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "is_accepted": false, "score": 2, "last_activity_date": 1440226611, "creation_date": 1440226611, "answer_id": 32153319, "question_id": 32153093, "link": "https://stackoverflow.com/questions/32153093/what-does-rob-pike-mean-by-the-synchronization-nature-of-the-channels-in-go/32153319#32153319", "title": "What does Rob Pike mean by &quot;the synchronization nature of the channels&quot; in Go?", "body": "<p>You are characterizing the situation incorrectly when you say that \"a channel builds the communication between two goroutines and synchronizes their executions\".</p>\n\n<p>The synchronization that's happening is within the channel. When you try to read data from the channel, the read action is blocked until data has been written to the channel.</p>\n\n<p>There are two different channels in this example, and neither one of them knows anything about the other. The significant detail is that this line blocks until data has been written to the <code>joe</code> channel:</p>\n\n<pre><code>fmt.Println(&lt;-joe)\n</code></pre>\n\n<p>That is what prevents the following line from being executed until \"Joe\" has been printed.</p>\n"}], "owner": {"reputation": 977, "user_id": 1419809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Plto.jpg?s=128&g=1", "display_name": "Pauli", "link": "https://stackoverflow.com/users/1419809/pauli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 3, "accepted_answer_id": 32153284, "answer_count": 3, "score": 4, "last_activity_date": 1440335398, "creation_date": 1440224807, "last_edit_date": 1440228615, "question_id": 32153093, "link": "https://stackoverflow.com/questions/32153093/what-does-rob-pike-mean-by-the-synchronization-nature-of-the-channels-in-go", "title": "What does Rob Pike mean by &quot;the synchronization nature of the channels&quot; in Go?", "body": "<p>Here is a code example taken from \"<a href=\"https://www.youtube.com/watch?v=f6kdp27TYZs\" rel=\"nofollow\">Google I/O 2012 - Go Concurrency Patterns</a>\" (<a href=\"https://talks.golang.org/2012/concurrency.slide#25\" rel=\"nofollow\">slides</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    joe := boring(\"Joe\")\n    ann := boring(\"Ann\")\n    for i := 0; i &lt; 5; i++ {\n        fmt.Println(&lt;-joe)\n        fmt.Println(&lt;-ann)\n    }\n    fmt.Println(\"The end\")\n}\n\nfunc boring(msg string) &lt;-chan string {\n    c := make(chan string)\n    go func() {\n        for i := 0; ; i++ {\n            c &lt;- fmt.Sprintf(\"%s %d\", msg, i)\n            time.Sleep(time.Second)\n        }\n    }()\n    return c\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Joe 0\nAnn 0\nJoe 1\nAnn 1\nJoe 2\nAnn 2\nJoe 3\nAnn 3\nJoe 4\nAnn 4\nThe end\n</code></pre>\n\n<p>This is the explanation by Rob Pike, the speaker (16:33 in the video): \"...we're reading a value from Joe and a value from Ann. And because of the synchronization nature of the channels, the two guys are taking turns, not only in printing the values out, but also in executing them. Because if Ann is ready to send a value but Joe hasn't done that yet, Ann will still be blocked, waiting to deliver the value to main.\"</p>\n\n<p>This confused me. What's the meaning of \"if Ann is ready to send a value but Joe hasn't done that yet, Ann will still be blocked\"? As we know, a channel builds the communication between two goroutines and synchronizes their executions. But we have crated two channels here (<code>joe</code> and <code>ann</code>). The main goroutine talks with two new goroutines via <code>joe</code> and <code>ann</code>, respectively. Does that mean the synchronization nature is also valid between channels? Or that the main goroutine can talk with only one other goroutine at a time?</p>\n"}, {"tags": ["json", "api", "go", "character"], "answers": [{"comments": [{"owner": {"reputation": 763, "user_id": 3088712, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c022b56380e0bb014f70e1da6409ce53?s=128&d=identicon&r=PG&f=1", "display_name": "lawonga", "link": "https://stackoverflow.com/users/3088712/lawonga"}, "edited": false, "score": 1, "creation_date": 1440286375, "post_id": 32152793, "comment_id": 52211227, "body": "Excellent! I am starting to understand... should have looked around more first :) Thank you very much!"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1440222728, "last_edit_date": 1440222728, "creation_date": 1440222365, "answer_id": 32152793, "question_id": 32152724, "link": "https://stackoverflow.com/questions/32152724/golang-json-query-from-bitcoin-api-returns-invalid-character/32152793#32152793", "title": "Golang json query from bitcoin api returns invalid character", "body": "<p>That is NOT json data at all, you'd have to write a custom parser.</p>\n\n<p>Example:</p>\n\n<pre><code>.........\ndata := readData(httpresp.Body)\n........\n\nfunc readData(r io.Reader) (out [][3]float64) {\n    br := bufio.NewScanner(r)\n    for br.Scan() {\n        parts := strings.Split(br.Text(), \",\")\n        if len(parts) != 3 {\n            continue\n        }\n        var fparts [3]float64\n        for i, p := range parts {\n            // bad idea to ignore errors, but it's left as exercise for the reader.\n            fparts[i], _ = strconv.ParseFloat(p, 64)\n        }\n        out = append(out, fparts)\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/crfw_BsRcp\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 763, "user_id": 3088712, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c022b56380e0bb014f70e1da6409ce53?s=128&d=identicon&r=PG&f=1", "display_name": "lawonga", "link": "https://stackoverflow.com/users/3088712/lawonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "accepted_answer_id": 32152793, "answer_count": 1, "score": -1, "last_activity_date": 1440222728, "creation_date": 1440221802, "question_id": 32152724, "link": "https://stackoverflow.com/questions/32152724/golang-json-query-from-bitcoin-api-returns-invalid-character", "title": "Golang json query from bitcoin api returns invalid character", "body": "<p>Something tells me I'm not understanding json correctly. I'm trying to grab some data off <a href=\"http://api.bitcoincharts.com/v1/trades.csv?symbol=rockUSD\" rel=\"nofollow\">http://api.bitcoincharts.com/v1/trades.csv?symbol=rockUSD</a>, but my Unmarshal seems to not be able to read the json data. I'm a fresh beginner to golang (and json as well), and I'm wondering how I am able to skip that wrong character error I'm making.</p>\n\n<p>My error:</p>\n\n<pre><code>invalid character ',' after top-level value\npanic: invalid character ',' after top-level value\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n    \"net/http\"\n    \"io/ioutil\"\n    \"encoding/json\"\n)\n\ntype Prices struct {\n    Data string\n}\n\nfunc main() {\n    url := \"http://api.bitcoincharts.com/v1/trades.csv?symbol=rockUSD\"\n    httpresp, err := http.Get(url)\n    if err != nil{\n        fmt.Println(err)\n        panic(err)\n    }\n    defer httpresp.Body.Close()\n    htmldata, err := ioutil.ReadAll(httpresp.Body)\n    if err != nil{\n        fmt.Println(err)\n        panic (err)\n    }\n    var jsonData []Prices\n    err = json.Unmarshal([]byte(htmldata), &amp;jsonData)\n    if err != nil {\n        fmt.Println(err)\n        panic (err)\n    }\n    fmt.Println(jsonData)\n\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 14145, "user_id": 1255956, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a6a3498ebb173fb2373fded6f46d65fd?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1255956/chris"}, "edited": false, "score": 2, "creation_date": 1449094903, "post_id": 32152005, "comment_id": 55862668, "body": "For community knowledge, why does this question receive a negative rating? It is asking a clear question, has  sufficient code, and seemingly correct ref tags. +1 for Q and A for me.."}], "answers": [{"comments": [{"owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "edited": false, "score": 0, "creation_date": 1440248277, "post_id": 32152142, "comment_id": 52200916, "body": "with both solutions the content length of the saved file is 0, when I try to write the file on local storage I can read it contents"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 6, "last_activity_date": 1440215847, "creation_date": 1440215847, "answer_id": 32152142, "question_id": 32152005, "link": "https://stackoverflow.com/questions/32152005/golang-upload-http-request-formfile-to-amazon-s3/32152142#32152142", "title": "Golang upload Http request FormFile to Amazon S3", "body": "<p>Use <code>ioutil.ReadAll</code>:</p>\n\n<pre><code>bs, err := ioutil.ReadAll(file)\n// ...\nerr = bucket.Put(\n    header.Filename, \n    bs, \n    header.Header.Get(\"Content-Type\"), \n    s3.ACL(\"public-read\"),\n)\n</code></pre>\n\n<p><code>Read</code> is a lower-level function which has subtle behavior:</p>\n\n<blockquote>\n  <p>Read reads data into p. It returns the number of bytes read into p. It calls Read at most once on the underlying Reader, hence <strong>n may be less than len(p)</strong>. At EOF, the count will be zero and err will be io.EOF.</p>\n</blockquote>\n\n<p>So what was probably happening was some subset of the file data was being written to S3 along with a bunch of 0s. </p>\n\n<p><code>ioutil.ReadAll</code> works by calling <code>Read</code> over and over again filling a dynamically expanding buffer until it reaches the end of the file. (so there's no need for the <code>bufio.Reader</code> either)</p>\n\n<p>Also the <code>Put</code> function will have issues with large files (using <code>ReadAll</code> means the entire file must fit in memory) so you may want to use <a href=\"http://godoc.org/launchpad.net/goamz/s3#Bucket.PutReader\" rel=\"noreferrer\"><code>PutReader</code></a> instead:</p>\n\n<pre><code>bucket.PutReader(\n    header.Filename, \n    file, \n    fileSize, \n    header.Header.Get(\"Content-Type\"), \n    s3.ACL(\"public-read\"),\n)\n</code></pre>\n"}], "owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3002, "favorite_count": 2, "accepted_answer_id": 32152142, "answer_count": 1, "score": 4, "last_activity_date": 1440215847, "creation_date": 1440214474, "question_id": 32152005, "link": "https://stackoverflow.com/questions/32152005/golang-upload-http-request-formfile-to-amazon-s3", "title": "Golang upload Http request FormFile to Amazon S3", "body": "<p>I'm creating a micro service to handle some attachments uploads to Amazon S3, What I'm trying to achieve is accept a file and then store it directly to my Amazon S3 bucket, my current function :</p>\n\n<pre><code>func upload_handler(w http.ResponseWriter, r *http.Request) {\n  file, header, err := r.FormFile(\"attachment\")\n\n  if err != nil {\n    fmt.Fprintln(w, err)\n    return\n  }\n\n  defer file.Close()\n\n  fileSize, err := file.Seek(0, 2) //2 = from end\n    if err != nil {\n         panic(err)\n    }\n\n    fmt.Println(\"File size : \", fileSize)\n\n  bytes := make([]byte, fileSize)\n  // read into buffer\n  buffer := bufio.NewReader(file)\n  _, err = buffer.Read(bytes)\n\n  auth := aws.Auth{\n        AccessKey: \"XXXXXXXXXXX\",\n        SecretKey: \"SECRET_KEY_HERE\",\n  }\n  client := s3.New(auth, aws.EUWest)\n  bucket := client.Bucket(\"attachments\")\n\n  err = bucket.Put(header.Filename, bytes, header.Header.Get(\"Content-Type\"), s3.ACL(\"public-read\"))\n\n  if err != nil {\n    fmt.Println(err)\n    os.Exit(1)\n  }\n}\n</code></pre>\n\n<p>The problem is that the files stored in S3 are all corrupted, After a small verification it seems that the file payload is not read as bytes</p>\n\n<p>How to convert the file to bytes and store it correctly to S3 ?</p>\n"}, {"tags": ["session", "cookies", "go"], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1440246148, "post_id": 32152014, "comment_id": 52200283, "body": "Yes, make all requests through a client with a jar, then login first and access protected stuff afterwards with the same client. If requests fail because of missing/wrong authorization: Do the login again."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1440281594, "post_id": 32152014, "comment_id": 52210153, "body": "I&#39;ll let you know how this turns out once I can do it thanks!"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 2, "last_activity_date": 1440214551, "creation_date": 1440214551, "answer_id": 32152014, "question_id": 32151546, "link": "https://stackoverflow.com/questions/32151546/how-can-i-get-cookie-session-information-so-that-i-can-use-it-with-an-api/32152014#32152014", "title": "How can I get cookie/session information so that I can use it with an API?", "body": "<p>Use a <a href=\"http://golang.org/pkg/net/http/cookiejar/\" rel=\"nofollow\"><code>cookiejar</code></a> to remember cookies. </p>\n\n<pre><code>// make a client with a cookie jar\nclient := &amp;http.Client{Jar:cookiejar.New(nil)}\n// post to the auth url\nclient.Post(\"...\", \"application/json\", data)\n// with the same client make your request \nclient.Get(\"...\")\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440214551, "creation_date": 1440209139, "last_edit_date": 1440211122, "question_id": 32151546, "link": "https://stackoverflow.com/questions/32151546/how-can-i-get-cookie-session-information-so-that-i-can-use-it-with-an-api", "title": "How can I get cookie/session information so that I can use it with an API?", "body": "<p>I'm trying to use this API:</p>\n\n<p><a href=\"https://developer.valvesoftware.com/wiki/Steam_Web_API/IEconService\" rel=\"nofollow\">https://developer.valvesoftware.com/wiki/Steam_Web_API/IEconService</a></p>\n\n<p>But it basically requires me to have a session/cookies in place already so I need to basically make my <code>Go</code> program simulate a connection and <code>Authenticate</code> to steam following this format: <a href=\"https://github.com/SteamDatabase/SteamTracking/blob/master/API/ISteamUserAuth.json\" rel=\"nofollow\">https://github.com/SteamDatabase/SteamTracking/blob/master/API/ISteamUserAuth.json</a></p>\n\n<p>But I'm not exactly sure how I can put this all together to get my Go program to <code>login</code> so that I can make calls to the logged in portion of the API. Thanks for any help sorry if this isn't very clear, if needing more information just ask.</p>\n"}, {"tags": ["go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1440227811, "post_id": 32149306, "comment_id": 52195492, "body": "Thanks, I have understood this capability from documentation.  However as described in question, my goal is not to expose app.conf for end user instead example.conf as product configuration. Any clue/approach to workaround this?"}], "tags": [], "owner": {"reputation": 368, "user_id": 1171706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e893c1d664ec913b5e752dd7c60393?s=128&d=identicon&r=PG", "display_name": "notzippy", "link": "https://stackoverflow.com/users/1171706/notzippy"}, "is_accepted": false, "score": 1, "last_activity_date": 1440191513, "creation_date": 1440191513, "answer_id": 32149306, "question_id": 32148903, "link": "https://stackoverflow.com/questions/32148903/external-configuration-beside-app-conf-environment-variables-for-revel-go-fram/32149306#32149306", "title": "External configuration beside app.conf &amp; environment variables for revel go framework", "body": "<p>It appears you are working against the design of the app.conf. It is already setup to be sectioned, for example all this is in a single app.conf file</p>\n\n<pre><code>[dev]\nresults.pretty = true\nwatch = true\nhttp.addr = 192.168.1.2\n\n[test]\nresults.pretty = true\nwatch = true\nhttp.addr = 192.168.1.22\n\n[prod]\nresults.pretty = false\nwatch = false\nhttp.addr = 192.168.1.100\n</code></pre>\n\n<p>you can launch 3 different scenarios by using three different command line options</p>\n\n<pre><code>revel run bitbucket.org/mycorp/my-app dev\n\nrevel run bitbucket.org/mycorp/my-app test\n\nrevel run bitbucket.org/mycorp/my-app prod\n</code></pre>\n\n<p>I know this is not exactly what your goal is but you can acheive a similar result.</p>\n"}, {"comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1440253840, "post_id": 32155463, "comment_id": 52202537, "body": "@jeevatkm tell me what you think about this?"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1440267039, "post_id": 32155463, "comment_id": 52206304, "body": "Thanks, I&#39;m glad to extend framework via some interface which is supported by framework, so when new version comes it will be compatible with that. Else I may have to may maintain my version of revel code and sync it with every release. I have been in that road, not fun efforts"}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1440268181, "post_id": 32155463, "comment_id": 52206638, "body": "There is <a href=\"https://github.com/revel/revel/blob/master/server.go#L92\" rel=\"nofollow noreferrer\">hook for startup functions</a> via OnAppStart. do you aware of hooks for config override?"}], "tags": [], "owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "is_accepted": false, "score": 1, "last_activity_date": 1440242007, "creation_date": 1440242007, "answer_id": 32155463, "question_id": 32148903, "link": "https://stackoverflow.com/questions/32148903/external-configuration-beside-app-conf-environment-variables-for-revel-go-fram/32155463#32155463", "title": "External configuration beside app.conf &amp; environment variables for revel go framework", "body": "<p>In github.com/revel/revel/revel.go around line 152 you have something like </p>\n\n<p><code>Config, err = LoadConfig(\"app.conf\")</code>. </p>\n\n<p>Maybe you can try and modify that with this </p>\n\n<pre><code>if len(os.Getenv(\"SOME ENV VAR\")) &gt; 0 {\n    Config, err = LoadConfig(\"path/to/your/example.conf\")\n} else {\n    Config, err = LoadConfig(\"app.conf\")\n}\n</code></pre>\n\n<p>You just need to set env var on your prod server.</p>\n\n<p>That way you will not be using app.conf but your example.conf.</p>\n"}], "owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1440242007, "creation_date": 1440189503, "last_edit_date": 1440190708, "question_id": 32148903, "link": "https://stackoverflow.com/questions/32148903/external-configuration-beside-app-conf-environment-variables-for-revel-go-fram", "title": "External configuration beside app.conf &amp; environment variables for revel go framework", "body": "<p>I have read revel <a href=\"http://revel.github.io/manual/appconf.html\" rel=\"nofollow\">app.conf manual</a> for custom configuration and environment variables. however I couldn't find way to use additional external configuration along with app.conf.</p>\n\n<p>My goal is to achieve external configuration file in addition to internal app.conf. Let's say creating a product called <strong>example</strong> and example product maintains it's sensible defaults with app.conf (not exposing to end user) instead  product exposes config attributes via example.conf (default location could be /etc/example/example.conf) for product users.</p>\n\n<p>For example: http config field from app.conf</p>\n\n<pre><code>http.addr =\nhttp.port = 9000\n</code></pre>\n\n<p>extend it to example.conf</p>\n\n<pre><code>http.addr =\nhttp.port = 9000\n\n[database]\nhost = \"localhost\"\nport = 8080\nuser = \"username\"\npassword = \"password\"\n# etc...\n</code></pre>\n\n<p>Then I read example.conf during an application start use values also apply values on top of app.conf (overriding). Finally revel server starts!</p>\n\n<p>How to achieve this goal with revel go framework?</p>\n"}, {"tags": ["go", "resources", "blocking"], "answers": [{"tags": [], "owner": {"reputation": 18961, "user_id": 1094941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gVU2.jpg?s=128&g=1", "display_name": "mna", "link": "https://stackoverflow.com/users/1094941/mna"}, "is_accepted": true, "score": 28, "last_activity_date": 1440189851, "creation_date": 1440189851, "answer_id": 32148983, "question_id": 32147421, "link": "https://stackoverflow.com/questions/32147421/behavior-of-sleep-and-select-in-go/32148983#32148983", "title": "Behavior of sleep and select in go", "body": "<p>That's a very interesting question, so I did <code>cd</code> into my Go source to start looking.</p>\n\n<h2>time.Sleep</h2>\n\n<p><code>time.Sleep</code> is defined like this:</p>\n\n<pre><code>// src/time/sleep.go\n\n// Sleep pauses the current goroutine for at least the duration d.\n// A negative or zero duration causes Sleep to return immediately.\nfunc Sleep(d Duration)\n</code></pre>\n\n<p>No body, no definition in an OS-specific <code>time_unix.go</code>!?! A little search and the answer is because <code>time.Sleep</code> is actually defined in the runtime:</p>\n\n<pre><code>// src/runtime/time.go\n\n// timeSleep puts the current goroutine to sleep for at least ns nanoseconds.\n//go:linkname timeSleep time.Sleep\nfunc timeSleep(ns int64) {\n  // ...\n}\n</code></pre>\n\n<p>Which in retrospect makes a lot of sense, as it has to interact with the goroutine scheduler. It ends up calling <code>goparkunlock</code>, which \"puts the goroutine into a waiting state\". <code>time.Sleep</code> creates a <code>runtime.timer</code> with a callback function that is called when the timer expires - that callback function wakes up the goroutine by calling <code>goready</code>. See next section for more details on the <code>runtime.timer</code>.</p>\n\n<h2>time.NewTicker</h2>\n\n<p><code>time.NewTicker</code> creates a <code>*Ticker</code> (and <code>time.Tick</code> is a helper function that does the same thing but directly returns <code>*Ticker.C</code>, the ticker's receive channel, instead of <code>*Ticker</code>, so you could've written your code with it instead) has similar hooks into the runtime: a ticker is a struct that holds a <code>runtimeTimer</code> and a channel on which to signal the ticks.</p>\n\n<p><code>runtimeTimer</code> is defined in the <code>time</code> package but it must be kept in sync with <code>timer</code> in <code>src/runtime/time.go</code>, so it is effectively a <code>runtime.timer</code>. Remember that in <code>time.Sleep</code>, the timer had a callback function to wake up the sleeping goroutine? In the case of <code>*Ticker</code>, the timer's callback function sends the current time on the ticker's channel.</p>\n\n<p>Then, the real waiting/scheduling happens on the receive from the channel, which is essentially the same as the <code>select</code> statement unless <code>otherChan</code> sends something before the tick, so let's look at what happens on a blocking receive.</p>\n\n<h2>&lt;- chan</h2>\n\n<p>Channels are implemented (now in Go!) in <code>src/runtime/chan.go</code>, by the <code>hchan</code> struct. Channel operations have matching functions, and a receive is implemented by <code>chanrecv</code>:</p>\n\n<pre><code>// chanrecv receives on channel c and writes the received data to ep.\n// ep may be nil, in which case received data is ignored.\n// If block == false and no elements are available, returns (false, false).\n// Otherwise, if c is closed, zeros *ep and returns (true, false).\n// Otherwise, fills in *ep with an element and returns (true, true).\nfunc chanrecv(t *chantype, c *hchan, ep unsafe.Pointer, block bool) (selected, received bool) {\n  // ...\n}\n</code></pre>\n\n<p>This part has a lot of different cases, but in your example, it is a blocking receive from an asynchronous channel (<code>time.NewTicker</code> creates a channel with a buffer of 1), but anyway it ends up calling... <code>goparkunlock</code>, again to allow other goroutines to proceed while this one is stuck waiting.</p>\n\n<h2>So...</h2>\n\n<p>In all cases, the goroutine ends up being parked (which is not really shocking - it can't make progress, so it has to leave its thread available for a different goroutine if there's any available). A glance at the code seems to suggest that the channel has a bit more overhead than a straight-up <code>time.Sleep</code>. However, it allows far more powerful patterns, such as the last one in your example: the goroutine can be woken up by another channel, whichever comes first.</p>\n\n<p>To answer your other questions, regarding polling, the timers are managed by a goroutine that sleeps until the next timer in its queue, so it's working only when it knows a timer has to be triggered. When the next timer has expired, it wakes up the goroutine that called <code>time.Sleep</code> (or sends the value on the ticker's channel, it does whatever the callback function does).</p>\n\n<p>There's no polling in channels, the receive is unlocked when a send is made on the channel, in <code>chansend</code> of the chan.go file:</p>\n\n<pre><code>// wake up a waiting receiver\nsg := c.recvq.dequeue()\nif sg != nil {\n    recvg := sg.g\n    unlock(&amp;c.lock)\n    if sg.releasetime != 0 {\n        sg.releasetime = cputicks()\n    }\n    goready(recvg, 3)\n} else {\n    unlock(&amp;c.lock)\n}\n</code></pre>\n\n<p>That was an interesting dive into Go's source code, very interesting question! Hope I answered at least part of it!</p>\n"}], "owner": {"reputation": 1447, "user_id": 3570747, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RKIuH.png?s=128&g=1", "display_name": "vastlysuperiorman", "link": "https://stackoverflow.com/users/3570747/vastlysuperiorman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4121, "favorite_count": 3, "accepted_answer_id": 32148983, "answer_count": 1, "score": 20, "last_activity_date": 1440189851, "creation_date": 1440182913, "question_id": 32147421, "link": "https://stackoverflow.com/questions/32147421/behavior-of-sleep-and-select-in-go", "title": "Behavior of sleep and select in go", "body": "<p>I'm trying to understand a bit more about what happens under the surface during various blocking/waiting types of operations in Go. Take the following example:</p>\n\n<pre><code>otherChan = make(chan int)\nt = time.NewTicker(time.Second)\nfor {\n    doThings()\n\n    // OPTION A: Sleep\n    time.Sleep(time.Second)\n\n    // OPTION B: Blocking ticker\n    &lt;- t.C\n\n    // OPTION C: Select multiple\n    select {\n        case &lt;- otherChan:\n        case &lt;- t.C:\n    }\n}\n</code></pre>\n\n<p>From a low level view (system calls, cpu scheduling) what is the difference between these while waiting? </p>\n\n<p>My understanding is that <code>time.Sleep</code> leaves the CPU free to perform other tasks until the specified time has elapsed. Does the blocking ticker <code>&lt;- t.C</code> do the same? Is the processor polling the channel or is there an interrupt involved? Does having multiple channels in a select change anything? </p>\n\n<p>In other words, assuming that <code>otherChan</code> never had anything put into it, would these three options execute in an identical way, or would one be less resource intensive than the others? </p>\n"}, {"tags": ["go", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 4448, "user_id": 1354978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e04efd06db0188e49ce01b806e599717?s=128&d=identicon&r=PG", "display_name": "earlonrails", "link": "https://stackoverflow.com/users/1354978/earlonrails"}, "edited": false, "score": 3, "creation_date": 1440258666, "post_id": 32157866, "comment_id": 52203887, "body": "Wow very nice man, thnx. Very cool to see how this is done in go. It is funny how much code you need sometimes just to parse yaml!"}], "tags": [], "owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "is_accepted": true, "score": 14, "last_activity_date": 1440257878, "creation_date": 1440257878, "answer_id": 32157866, "question_id": 32147325, "link": "https://stackoverflow.com/questions/32147325/how-to-parse-yaml-with-dynamic-key-in-golang/32157866#32157866", "title": "How to parse YAML with dynamic key in Golang", "body": "<p>First, you are trying to parse the root as an <code>Environment</code>, but its actual type is <code>map[string]Environment</code>. Second, you are going to need a custom <a href=\"https://github.com/go-yaml/yaml/blob/v2/yaml.go#L31\" rel=\"noreferrer\"><code>Unmarshaler</code></a> if you want to keep that type structure. Something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\nvar data = `\n---\ndevelopment:\n  skip-header-validation: true\n  V1:\n    current: \"1.0.0\"\n    mime_types:\n      - application/vnd.company.jk.identity+json;\n      - application/vnd.company.jk.user+json;\n      - application/vnd.company.jk.role+json;\n      - application/vnd.company.jk.scope+json;\n      - application/vnd.company.jk.test+json;\n    skip-mime-type-validation: true\n    skip-version-validation: true\n  V2:\n    current: \"2.0.0\"\n    mime_types:\n      - application/vnd.company.jk.identity+json;\n      - application/vnd.company.jk.user+json;\n      - application/vnd.company.jk.role+json;\n      - application/vnd.company.jk.scope+json;\n      - application/vnd.company.jk.test+json;\n\n`\n\ntype MajorVersion struct {\n    Current                string   `yaml:\"current\"`\n    MimeTypes              []string `yaml:\"mime_types\"`\n    SkipVersionValidation  bool     `yaml:\"skip-version-validation\"`\n    SkipMimeTypeValidation bool     `yaml:\"skip-mime-type-validation\"`\n}\n\ntype Environment struct {\n    SkipHeaderValidation bool\n    Versions             map[string]MajorVersion\n}\n\nfunc (e *Environment) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    var params struct {\n        SkipHeaderValidation bool `yaml:\"skip-header-validation\"`\n    }\n    if err := unmarshal(&amp;params); err != nil {\n        return err\n    }\n    var versions map[string]MajorVersion\n    if err := unmarshal(&amp;versions); err != nil {\n        // Here we expect an error because a boolean cannot be converted to a\n        // a MajorVersion\n        if _, ok := err.(*yaml.TypeError); !ok {\n            return err\n        }\n    }\n    e.SkipHeaderValidation = params.SkipHeaderValidation\n    e.Versions = versions\n    return nil\n}\n\nfunc main() {\n    var e map[string]Environment\n    if err := yaml.Unmarshal([]byte(data), &amp;e); err != nil {\n        fmt.Println(err.Error())\n    }\n    fmt.Printf(\"%#v\\n\", e)\n}\n</code></pre>\n\n<p>Output (after using <a href=\"http://godoc.org/github.com/kr/pretty\" rel=\"noreferrer\">makeup</a>):</p>\n\n<pre><code>map[string]main.Environment{\n    \"development\": {\n        SkipHeaderValidation: true,\n        Versions:             {\n            \"V2\": {\n                Current:                \"2.0.0\",\n                MimeTypes:              {\"application/vnd.company.jk.identity+json;\", \"application/vnd.company.jk.user+json;\", \"application/vnd.company.jk.role+json;\", \"application/vnd.company.jk.scope+json;\", \"application/vnd.company.jk.test+json;\"},\n                SkipVersionValidation:  false,\n                SkipMimeTypeValidation: false,\n            },\n            \"V1\": {\n                Current:                \"1.0.0\",\n                MimeTypes:              {\"application/vnd.company.jk.identity+json;\", \"application/vnd.company.jk.user+json;\", \"application/vnd.company.jk.role+json;\", \"application/vnd.company.jk.scope+json;\", \"application/vnd.company.jk.test+json;\"},\n                SkipVersionValidation:  true,\n                SkipMimeTypeValidation: true,\n            },\n        },\n    },\n}\n</code></pre>\n"}], "owner": {"reputation": 4448, "user_id": 1354978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e04efd06db0188e49ce01b806e599717?s=128&d=identicon&r=PG", "display_name": "earlonrails", "link": "https://stackoverflow.com/users/1354978/earlonrails"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8053, "favorite_count": 2, "accepted_answer_id": 32157866, "answer_count": 1, "score": 12, "last_activity_date": 1564922205, "creation_date": 1440182477, "last_edit_date": 1564922205, "question_id": 32147325, "link": "https://stackoverflow.com/questions/32147325/how-to-parse-yaml-with-dynamic-key-in-golang", "title": "How to parse YAML with dynamic key in Golang", "body": "<p>I am trying to parse a YAML file with Go. The problem is that the keys in the YAML file might not always be the same. This is to do API versioning so the user can define the versions they support. For instance V1, V2, V3 etc. They do not need to be in order and can omit versions they don't support i.e,  V0, V2, V5 etc.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"gopkg.in/yaml.v2\"\n)\n\nvar data = `\n---\ndevelopment:\n  skip-header-validation: true\n  V1:\n    current: \"1.0.0\"\n    mime_types:\n      - application/vnd.company.jk.identity+json;\n      - application/vnd.company.jk.user+json;\n      - application/vnd.company.jk.role+json;\n      - application/vnd.company.jk.scope+json;\n      - application/vnd.company.jk.test+json;\n    skip-mime-type-validation: true\n    skip-version-validation: true\n  V2:\n    current: \"2.0.0\"\n    mime_types:\n      - application/vnd.company.jk.identity+json;\n      - application/vnd.company.jk.user+json;\n      - application/vnd.company.jk.role+json;\n      - application/vnd.company.jk.scope+json;\n      - application/vnd.company.jk.test+json;\n\n`\n\ntype MajorVersion struct {\n  Current                 string    `yaml:\"current\"`\n  MimeTypes               []string  `yaml:\"mime_types\"`\n  SkipVersionValidation   bool      `yaml:\"skip-version-validation\"`\n  SkipMimeTypeValidation  bool      `yaml:\"skip-mime-type-validation\"`\n}\n\ntype Environment struct {\n  SkipHeaderValidation  bool        `yaml:\"skip-header-validation\"`\n  Version               map[string]MajorVersion\n}\n\nfunc main() {\n  e := Environment{}\n\n  yaml.Unmarshal([]byte(data), &amp;e)\n  fmt.Println(e)\n}\n</code></pre>\n\n<p>I saw a <a href=\"https://stackoverflow.com/questions/18412126/golang-parse-a-json-with-dynamic-key\">similar question asked here</a></p>\n\n<p>This is at the top level and I haven't quite figured out how to do this from inside the struct.</p>\n"}, {"tags": ["sql", "go", "gorp"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1440175147, "post_id": 32145324, "comment_id": 52180164, "body": "Why are you using MySQL dialect with an SQLite database?"}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1440175261, "post_id": 32145324, "comment_id": 52180241, "body": "@Ainar-G could you please explain me about the dialect, I took the code sample from the <a href=\"http://nathanleclaire.com/blog/2013/11/04/want-to-work-with-databases-in-golang-lets-try-some-gorp/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2013/11/04/&hellip;</a>. I am using sqlite3."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1440175339, "post_id": 32145324, "comment_id": 52180278, "body": "There are different kinds of databases. That example used MySQL, while you are using SQLite. Each database needs its own dialect. See my answer."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440176724, "post_id": 32145324, "comment_id": 52181001, "body": "BTW, you almost never want/need to directly call <code>Error()</code>; just do <code>fmt.Println(&quot;table not created:&quot;, err)</code>. (And please tell me that you don&#39;t actually ignore error returns with <code>_</code> in the real code but just did that here to stream line the question)."}, {"owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440181653, "post_id": 32145324, "comment_id": 52183518, "body": "thanks @DaveC for the suggestion +1."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1440175271, "creation_date": 1440175271, "answer_id": 32145408, "question_id": 32145324, "link": "https://stackoverflow.com/questions/32145324/gorp-near-auto-increment-syntax-error/32145408#32145408", "title": "gorp: near &quot;auto_increment&quot;: syntax error", "body": "<p>You're using MySQL dialect with an SQLite database. Change</p>\n\n<pre><code>dbmap := &amp;gorp.DbMap{Db: db, Dialect: gorp.MySQLDialect{\"InnoDB\", \"UTF8\"}}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>dbmap := &amp;gorp.DbMap{Db: db, Dialect: gorp.SqliteDialect{}}\n</code></pre>\n"}], "owner": {"reputation": 2466, "user_id": 844409, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f2794079e054eefacace0906449800cf?s=128&d=identicon&r=PG", "display_name": "subhash kumar singh", "link": "https://stackoverflow.com/users/844409/subhash-kumar-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 32145408, "answer_count": 1, "score": -1, "last_activity_date": 1440175271, "creation_date": 1440174936, "question_id": 32145324, "link": "https://stackoverflow.com/questions/32145324/gorp-near-auto-increment-syntax-error", "title": "gorp: near &quot;auto_increment&quot;: syntax error", "body": "<p>I am trying to write simple program to insert the row in the table using the <code>gorp</code> but I am getting error on creating the table.</p>\n\n<p>Following is the code:</p>\n\n<pre><code>package main\n\nimport _ \"github.com/mattn/go-sqlite3\"\nimport \"database/sql\"\nimport \"fmt\"\nimport \"github.com/go-gorp/gorp\"\n\nfunc main() {\n\n        type Person struct {\n                Identi  int64\n                Created int64\n                FName   string\n                LName   string\n        }\n\n        db, _ := sql.Open(\"sqlite3\", \"mydb.db\")\n\n        dbmap := &amp;gorp.DbMap{Db: db, Dialect: gorp.MySQLDialect{\"InnoDB\", \"UTF8\"}}\n\n        _ = dbmap.AddTable(Person{}).SetKeys(true, \"Identi\")\n\n        err := dbmap.CreateTables()\n        if err != nil {\n                fmt.Println(\"table not created : \" + err.Error())\n        }\n\n        person := &amp;Person{\n                FName: \"Joe\",\n                LName: \"Smith\",\n        }\n        err = dbmap.Insert(person)\n\n        if err != nil {\n                fmt.Println(\"err\" + err.Error())\n        }\n}\n</code></pre>\n\n<p>I am getting following error:</p>\n\n<pre><code>table not created : near \"auto_increment\": syntax error\nerr no such table: Person\n</code></pre>\n\n<p>I would appreciate your help!</p>\n"}, {"tags": ["reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1440185294, "post_id": 32145130, "comment_id": 52185305, "body": "Perfect! I was missing the .Elem() call right after the TypeOf(i)."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1440174191, "creation_date": 1440174191, "answer_id": 32145130, "question_id": 32144977, "link": "https://stackoverflow.com/questions/32144977/go-reflect-how-to-instantiate-an-arbitrary-type-and-set-a-known-embedded-fiel/32145130#32145130", "title": "go (reflect): How to Instantiate an arbitrary type and set a known embedded field", "body": "<p>Using reflection, you can do it like that:</p>\n\n<ul>\n<li>get the type of the struct from the type of the pointer to it</li>\n<li>instantiate and deref it</li>\n<li>set the value of the field (looking it up by name) with the value of your pointer</li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>v := reflect.New(reflect.TypeOf(i).Elem()).Elem()\nf := reflect.ValueOf(field)\nv.FieldByName(\"Embedded\").Set(f)\nreturn v.Interface()\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/fX413svXDv\" rel=\"nofollow\">http://play.golang.org/p/fX413svXDv</a></p>\n"}], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 32145130, "answer_count": 1, "score": 3, "last_activity_date": 1440174191, "creation_date": 1440173604, "last_edit_date": 1495540280, "question_id": 32144977, "link": "https://stackoverflow.com/questions/32144977/go-reflect-how-to-instantiate-an-arbitrary-type-and-set-a-known-embedded-fiel", "title": "go (reflect): How to Instantiate an arbitrary type and set a known embedded field", "body": "<p>Consider the following type declaration:</p>\n\n<pre><code>type (\n    Embedded struct{}\n    Actual1 struct{ *Embedded }\n    Actual2 struct{ *Embedded }\n    Actual3 struct{ *Embedded }\n)\n</code></pre>\n\n<p>Now consider the following function, where <code>i</code> may be of type <code>Actual1</code>, <code>Actual2</code>, or <code>Actual3</code> (or any other type that embeds <code>Embedded</code> in like manner). I can't do a type assertion or a type switch because I can't know how many types contain <code>Embedded</code>, all I know about <code>i</code> is that it does indeed embed the <code>Embedded</code> type. This function will instantiate a new instance of the same type as <code>i</code> and set <code>embed</code> on that newly instantiated copy instance.</p>\n\n<pre><code>func New(i interface{}, field *Embedded) interface{} {\n    // Step 1. instantiate new instance of `i`, of same underlying type as `i`\n    // Step 2. set `i.Embedded` to `field`\n    // Step 3. return the new instance.\n}\n</code></pre>\n\n<p>Here's what usage would look like:</p>\n\n<pre><code>func main() {\n    actual := &amp;Actual1{}\n    embed := &amp;Embedded{}\n    copied := New(actual, embed)\n    if copied.(Actual1).Embedded != embed {\n        log.Fatal(\"It didn't work!\")\n    }\n}\n</code></pre>\n\n<p><strong>A correct implementation of the <code>New(...)</code> function cannot use type assertions or a type switch and would also not result in the call to <code>log.Fatal</code> shown above.</strong></p>\n\n<p>I think what I'm asking for is a combination of these two questions:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/7850140/how-do-you-create-a-new-instance-of-a-struct-from-its-type-at-runtime-in-go?rq=1\">How do you create a new instance of a struct from it's Type at runtime in Go?</a></li>\n<li><a href=\"https://stackoverflow.com/questions/6395076/in-golang-using-reflect-how-do-you-set-the-value-of-a-struct-field\">in golang, using reflect, how do you set the value of a struct field?</a></li>\n</ul>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 15, "last_activity_date": 1440379270, "last_edit_date": 1440379270, "creation_date": 1440172392, "answer_id": 32144586, "question_id": 32144379, "link": "https://stackoverflow.com/questions/32144379/is-it-possible-to-redirect-stdin-stdout-with-gogenerate/32144586#32144586", "title": "Is it possible to redirect stdin/stdout with go:generate", "body": "<p>I figured out how to do it:</p>\n\n<pre><code>//go:generate sh -c \"tool &lt; file.txt &gt; file.go\"\n</code></pre>\n"}], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 0, "accepted_answer_id": 32144586, "answer_count": 1, "score": 11, "last_activity_date": 1463119509, "creation_date": 1440171684, "question_id": 32144379, "link": "https://stackoverflow.com/questions/32144379/is-it-possible-to-redirect-stdin-stdout-with-gogenerate", "title": "Is it possible to redirect stdin/stdout with go:generate", "body": "<p>I have a tool that acts as a pipe, it reads data from stdin and writes go source code to stdout.</p>\n\n<p>Is it possible to setup input/output redirection and use such tool with go:generate? Something like:</p>\n\n<pre><code>//go:generate tool &lt; file.txt &gt; file.go\n</code></pre>\n"}, {"tags": ["java", "go", "rpc"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1440213994, "post_id": 32144067, "comment_id": 52192946, "body": "I was trying something similar earlier and ran into a dead end. To the best of my knowledge the Go rpc package only supports Go servers and clients, not those written in another language. Here is one ref on the Golang-Nuts google group: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/F0cuNKsH7c4\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/F0cuNKsH7c4</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5252510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4420a48a92dd3c7e5ba96bd318ddcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "\u98ce\u751f\u6c34\u8d77", "link": "https://stackoverflow.com/users/5252510/%e9%a3%8e%e7%94%9f%e6%b0%b4%e8%b5%b7"}, "edited": false, "score": 1, "creation_date": 1440420473, "post_id": 32172839, "comment_id": 52250796, "body": "Thanks for your answer. You solve the problem in a very clever way. But I had it worked out finally. There are 3 key points. Firstly, golang&#39;s json-rpc has obey the rules of its rpc, which the function should have only one income pramater. Secondly, the method name registered in java json-rpc is not like golang, it&#39;s just the name of the method, not including the class name. Thirdly,  keep programs communicate in socket, not Http. <a href=\"http://www.cnblogs.com/geomantic/p/4751859.html\" rel=\"nofollow noreferrer\">Here is my demo code if you are intrested</a>, Sorry for write it in Chinese, you could just look through the code."}], "tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1440375013, "creation_date": 1440375013, "answer_id": 32172839, "question_id": 32144067, "link": "https://stackoverflow.com/questions/32144067/golang-jsonrpc-call-java-json-rpc/32172839#32172839", "title": "golang jsonrpc call java json rpc", "body": "<p>I wish I had a better answer. This is something that I was trying to make work earlier and couldn't get to happen. I've read that only Go clients can rpc to Go servers.</p>\n\n<p>There are two means which I resorted to after trying to make json/rpc work between Java and Go, maybe you can tailor something similar to your needs.</p>\n\n<p>In one case I used the net/http package and did a basic web server in Go and then used HandlerFunc to call functions/methods based on url requests. The requests were based on simple http form actions. I then redirected back to the main page as I wanted the \"app\" to stay in front of the user as I just needed the \"/submit\" url to trigger a method with the values passed in from the form.</p>\n\n<p>Not all that elegant but it worked in a pinch to rapidly set up a way to gather information and it could be instantly \"deployed\" by letting my colleagues know what port I was listening on.</p>\n\n<p>In the second case, since a friend of mine was programming the Java side I set up a socket a listed for a pattern of bytes that we had agreed on which would call a particular function.</p>\n\n<p>Not so adaptable but if you what what you're getting  from the client it works out fine.</p>\n"}], "owner": {"reputation": 1, "user_id": 5252510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4420a48a92dd3c7e5ba96bd318ddcb1c?s=128&d=identicon&r=PG&f=1", "display_name": "\u98ce\u751f\u6c34\u8d77", "link": "https://stackoverflow.com/users/5252510/%e9%a3%8e%e7%94%9f%e6%b0%b4%e8%b5%b7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 813, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1440375013, "creation_date": 1440170614, "last_edit_date": 1440172414, "question_id": 32144067, "link": "https://stackoverflow.com/questions/32144067/golang-jsonrpc-call-java-json-rpc", "title": "golang jsonrpc call java json rpc", "body": "<p>I was trying to connect golang programs with java programs by json rpc, but ran into some trouble. I use the \"net/rpc/jsonrpc\" package from golang native packages, and \"jsonrpc4j\" for java. I use stream mode to create a server in java, because golang's jsonrpc just supports tcp invoke. But it still gets the error response in golang client:</p>\n\n<blockquote>\n  <p>err: invalid error map[code:-32602 message:Invalid method parameters]</p>\n</blockquote>\n\n<p>Meanwhile the java server is also encountering error:</p>\n\n<blockquote>\n  <p>com.fasterxml.jackson.databind.JsonMappingException: No content to map due to end-of-input\n   at [Source: com.googlecode.jsonrpc4j.NoCloseInputStream@385b5b5c; line: 1, column: 1]\n      at com.fasterxml.jackson.databind.JsonMappingException.from(JsonMappingException.java:148)\n      at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:3747)\n      at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:3687)\n      at com.fasterxml.jackson.databind.ObjectMapper.readTree(ObjectMapper.java:2202)\n      at com.googlecode.jsonrpc4j.JsonRpcServer.handle(JsonRpcServer.java:224)\n      at com.googlecode.jsonrpc4j.StreamServer$Server.run(StreamServer.java:214)\n      at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n      at java.util.concurrent.FutureTask.run(FutureTask.java:266)\n      at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n      at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n      at java.lang.Thread.run(Thread.java:744)</p>\n</blockquote>\n\n<p>I don't understand why it does not work, is there any discipline that exists in the jsonrpc protocol that golang can't invoke java or do I just not do it right?</p>\n"}, {"tags": ["time", "go"], "answers": [{"tags": [], "owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "is_accepted": true, "score": 6, "last_activity_date": 1440168104, "last_edit_date": 1440168104, "creation_date": 1440163001, "answer_id": 32141303, "question_id": 32140980, "link": "https://stackoverflow.com/questions/32140980/get-the-first-and-last-day-of-a-year-from-a-timestamp/32141303#32141303", "title": "Get the first and last day of a year from a timestamp", "body": "<p>You can use your Time struct object and create new Time struct object using <a href=\"http://golang.org/src/time/time.go?s=29954:30037#L1011\" rel=\"nofollow\">time.Date</a> and <a href=\"http://golang.org/src/time/time.go?s=10009:10033#L286\" rel=\"nofollow\">time.Time.Year()</a> functions. So, if current time is <code>t := time.Now()</code> then last day in this year in UTC will be <code>lt := time.Date(t.Year(), time.December, 31, 0, 0, 0, 0, time.UTC)</code> </p>\n\n<p>Here's an example:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\nfunc main() {\n    t := time.Now()\n    last := time.Date(t.Year(), time.December,31, 0, 0, 0, 0, time.UTC)\n    first := time.Date(t.Year(), time.January,1, 0, 0, 0, 0, time.UTC)\n\n    fmt.Println(\"Current: \", t)\n    fmt.Println(\"First: \", first)\n    fmt.Println(\"Last: \", last)\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/jahjd_mi6K\" rel=\"nofollow\">http://play.golang.org/p/jahjd_mi6K</a></p>\n"}], "owner": {"reputation": 269, "user_id": 3956916, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d8cf7cb0fe1b4286665943c2e00f940e?s=128&d=identicon&r=PG&f=1", "display_name": "Bebbs", "link": "https://stackoverflow.com/users/3956916/bebbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 32141303, "answer_count": 1, "score": 1, "last_activity_date": 1440168104, "creation_date": 1440162004, "question_id": 32140980, "link": "https://stackoverflow.com/questions/32140980/get-the-first-and-last-day-of-a-year-from-a-timestamp", "title": "Get the first and last day of a year from a timestamp", "body": "<p>Given a time object, <code>t := time.Now()</code>, is there a way I could get a timestamp for the first and last days of that year? </p>\n\n<p>I could do something like <code>d := t.YearDay()</code> to get the number of days through the year, and then <code>t.AddDate(0, 0, -d)</code> to get the start of the year, and <code>t.AddDate(0, 0, 365-d)</code> to get the end of the year, but that seems to brittle as it doesn't deal with leap years etc.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 1, "creation_date": 1440156109, "post_id": 32138895, "comment_id": 52167728, "body": "Well, <i>do</i> you have a table called <code>articles</code>?"}, {"owner": {"reputation": 217, "user_id": 4105858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3uIZ5sTHTRw/AAAAAAAAAAI/AAAAAAAAABE/uZgde_XPRQ8/photo.jpg?sz=128", "display_name": "Oladayo Oyelade", "link": "https://stackoverflow.com/users/4105858/oladayo-oyelade"}, "reply_to_user": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 0, "creation_date": 1440156821, "post_id": 32138895, "comment_id": 52168089, "body": "I have a database called orm_test.db; orm.RegisterDataBase(&quot;default&quot;, &quot;sqlite3&quot;, &quot;database/orm_test.db&quot;)"}, {"owner": {"reputation": 217, "user_id": 4105858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3uIZ5sTHTRw/AAAAAAAAAAI/AAAAAAAAABE/uZgde_XPRQ8/photo.jpg?sz=128", "display_name": "Oladayo Oyelade", "link": "https://stackoverflow.com/users/4105858/oladayo-oyelade"}, "reply_to_user": {"reputation": 12342, "user_id": 1300892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f3a5c87c28be1e3d1d31281c613deb?s=128&d=identicon&r=PG", "display_name": "Sverri M. Olsen", "link": "https://stackoverflow.com/users/1300892/sverri-m-olsen"}, "edited": false, "score": 0, "creation_date": 1440156875, "post_id": 32138895, "comment_id": 52168121, "body": "Not sure if I need to Sync my database.."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440175216, "post_id": 32138895, "comment_id": 52180213, "body": "Whenever you get &quot;%!(EXTRA&quot; from <code>fmt</code> please go and fix your broken format string (or use <code>Print</code>/<code>Println</code> instead of <code>Printf</code> if you don&#39;t want a format string)."}, {"owner": {"reputation": 217, "user_id": 4105858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3uIZ5sTHTRw/AAAAAAAAAAI/AAAAAAAAABE/uZgde_XPRQ8/photo.jpg?sz=128", "display_name": "Oladayo Oyelade", "link": "https://stackoverflow.com/users/4105858/oladayo-oyelade"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440260081, "post_id": 32138895, "comment_id": 52204251, "body": "@Dave, is that the solution to the question. Please read the question very well"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440261835, "post_id": 32138895, "comment_id": 52204758, "body": "@OladayoOyelade, it&#39;s a <i>comment</i>, not an <i>answer</i>. Please learn the difference."}], "answers": [{"tags": [], "owner": {"reputation": 217, "user_id": 4105858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3uIZ5sTHTRw/AAAAAAAAAAI/AAAAAAAAABE/uZgde_XPRQ8/photo.jpg?sz=128", "display_name": "Oladayo Oyelade", "link": "https://stackoverflow.com/users/4105858/oladayo-oyelade"}, "is_accepted": true, "score": 0, "last_activity_date": 1440157308, "creation_date": 1440157308, "answer_id": 32139428, "question_id": 32138895, "link": "https://stackoverflow.com/questions/32138895/couldnt-insert-new-article-reason-extra-sqlite3-error-no-such-table-artic/32139428#32139428", "title": "Couldn&#39;t insert new article. Reason: %!(EXTRA sqlite3.Error=no such table: articles) Beego", "body": "<p>I got the answer, I need to Sync my database(similar with Django >> <code>python manage.py makemigrations/migrate</code>). So I edited my main function inside main.go to:</p>\n\n<pre><code>func main() {\n    err := orm.RunSyncdb(\"default\", false, false)\n    if err != nil {\n        beego.Error(err)\n    }\n    beego.Run()\n}\n</code></pre>\n\n<p>This works for me.</p>\n"}], "owner": {"reputation": 217, "user_id": 4105858, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3uIZ5sTHTRw/AAAAAAAAAAI/AAAAAAAAABE/uZgde_XPRQ8/photo.jpg?sz=128", "display_name": "Oladayo Oyelade", "link": "https://stackoverflow.com/users/4105858/oladayo-oyelade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 32139428, "answer_count": 1, "score": 0, "last_activity_date": 1440157308, "creation_date": 1440155656, "question_id": 32138895, "link": "https://stackoverflow.com/questions/32138895/couldnt-insert-new-article-reason-extra-sqlite3-error-no-such-table-artic", "title": "Couldn&#39;t insert new article. Reason: %!(EXTRA sqlite3.Error=no such table: articles) Beego", "body": "<p>Getting this error <code>Couldn't insert new article. Reason: %!(EXTRA sqlite3.Error=no such table: articles</code> when trying to add an article to table articles. </p>\n\n<p>\\\n     <strong>models.go</strong></p>\n\n<pre><code>package models\n\ntype Article struct {\n    Id     int    `form:\"-\"`\n    Name   string `form:\"name,text,name:\" valid:\"MinSize(5);MaxSize(20)\"`\n    Client string `form:\"client,text,client:\"`\n    Url    string `form:\"url,text,url:\"`\n}\n\nfunc (a *Article) TableName() string {\n    return \"articles\"\n}\n</code></pre>\n\n<p>\\\n    <strong>part of my Add function</strong></p>\n\n<pre><code>if err == orm.ErrNoRows || err == orm.ErrMissPK {\n     beego.Debug(\"No article found matching details supplied. Attempting to insert article: \", article)\n     id, err := o.Insert(&amp;article)\n     if err == nil {\n         msg := fmt.Sprintf(\"Article inserted with id:\", id)\n         beego.Debug(msg)\n         flash.Notice(msg)\n         flash.Store(&amp;manage.Controller)\n      } else {\n         msg := fmt.Sprintf(\"Couldn't insert new article. Reason: \", err)\n         beego.Debug(msg)\n         flash.Error(msg)\n         flash.Store(&amp;manage.Controller)\n      }\n} else {\n     beego.Debug(\"Article found matching details supplied. Cannot insert\")\n}\n</code></pre>\n\n<p>Please assist. I don't know what am doing wrong.</p>\n"}, {"tags": ["go", "gvm"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1440158526, "post_id": 32137772, "comment_id": 52169191, "body": "Also look at <a href=\"https://github.com/travis-ci/gimme\" rel=\"nofollow noreferrer\">github.com/travis-ci/gimme</a>"}, {"owner": {"reputation": 5711, "user_id": 562258, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c1ff0c6732f0c710138235dc5f676bb9?s=128&d=identicon&r=PG", "display_name": "Andreas Steffan", "link": "https://stackoverflow.com/users/562258/andreas-steffan"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1440164974, "post_id": 32137772, "comment_id": 52173362, "body": "Interesting. At least  since it does  not conflict  with groovy  gvm.  Still, I wonder about  the motivation behind it  since most people seem to use  gvm."}, {"owner": {"reputation": 7802, "user_id": 3472656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sg0vU.jpg?s=128&g=1", "display_name": "Elwinar", "link": "https://stackoverflow.com/users/3472656/elwinar"}, "edited": false, "score": 0, "creation_date": 1440167812, "post_id": 32137772, "comment_id": 52175585, "body": "Did you think about Vagrant to get isolated environment ?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440175113, "post_id": 32137772, "comment_id": 52180144, "body": "&quot;since most people seem to use gvm&quot; \u2026 I very much doubt the accuracy of this statement; it&#39;s more likely a small minority of probably 10% at best (just going by some quick searches, github stars, etc)."}, {"owner": {"reputation": 5711, "user_id": 562258, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c1ff0c6732f0c710138235dc5f676bb9?s=128&d=identicon&r=PG", "display_name": "Andreas Steffan", "link": "https://stackoverflow.com/users/562258/andreas-steffan"}, "edited": false, "score": 0, "creation_date": 1440175639, "post_id": 32137772, "comment_id": 52180419, "body": "I don&#39;t like Vagrant because its based on virtual machines which I find way to heavy for this kind of usage. I&#39;d rather use a docker container (I am on Linux). My &quot;most people&quot; statement was based on a quick populartiy comparision of gimme vs. gvm on github."}], "answers": [{"comments": [{"owner": {"reputation": 5711, "user_id": 562258, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c1ff0c6732f0c710138235dc5f676bb9?s=128&d=identicon&r=PG", "display_name": "Andreas Steffan", "link": "https://stackoverflow.com/users/562258/andreas-steffan"}, "edited": false, "score": 0, "creation_date": 1440153842, "post_id": 32138084, "comment_id": 52166528, "body": "Thanks.  Looks like I have to resolve the conflict with groovy gvm again. :( <a href=\"https://github.com/moovweb/gvm/issues/103\" rel=\"nofollow noreferrer\">github.com/moovweb/gvm/issues/103</a>"}], "tags": [], "owner": {"reputation": 4936, "user_id": 102852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd1a03727472c03ab6628d437a24e00?s=128&d=identicon&r=PG", "display_name": "alex vasi", "link": "https://stackoverflow.com/users/102852/alex-vasi"}, "is_accepted": true, "score": 1, "last_activity_date": 1440152955, "creation_date": 1440152955, "answer_id": 32138084, "question_id": 32137772, "link": "https://stackoverflow.com/questions/32137772/is-gvm-outdated/32138084#32138084", "title": "Is gvm outdated?", "body": "<p>Yes, please update <code>gvm</code>. Also note, there are still some issues with Go1.5 and GVM, look at <a href=\"https://github.com/moovweb/gvm/issues?q=is%3Aissue%201.5\" rel=\"nofollow\">github.com/moovweb/gvm/issues</a> for tips.</p>\n\n<pre><code>$ bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)\n\n$ source /Users/vasi/.gvm/scripts/gvm\n\n$ gvm listall | grep 1.5\n   go1.5\n   go1.5beta1\n   go1.5beta2\n   go1.5beta3\n   go1.5rc1\n</code></pre>\n"}], "owner": {"reputation": 5711, "user_id": 562258, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c1ff0c6732f0c710138235dc5f676bb9?s=128&d=identicon&r=PG", "display_name": "Andreas Steffan", "link": "https://stackoverflow.com/users/562258/andreas-steffan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "accepted_answer_id": 32138084, "answer_count": 1, "score": 1, "last_activity_date": 1440152955, "creation_date": 1440151860, "question_id": 32137772, "link": "https://stackoverflow.com/questions/32137772/is-gvm-outdated", "title": "Is gvm outdated?", "body": "<p>The latest version <code>gvm listall</code> offers me is <code>go1.4</code>.</p>\n\n<p>Am I missing something or is <code>gvm</code> outdated?</p>\n\n<p>What's the recommended way to manage (potentially multiple) installations?</p>\n"}, {"tags": ["http", "go"], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 2, "last_activity_date": 1440148632, "creation_date": 1440148632, "answer_id": 32136737, "question_id": 32136093, "link": "https://stackoverflow.com/questions/32136093/how-can-i-upload-a-file-to-server-without-browser-using-go/32136737#32136737", "title": "How can I upload a file to server, without browser, using go?", "body": "<p>you need use the <code>\"mime/multipart\"</code>package to make the http body. like this.</p>\n\n<p><a href=\"http://matt.aimonetti.net/posts/2013/07/01/golang-multipart-file-upload-example/\" rel=\"nofollow\">http://matt.aimonetti.net/posts/2013/07/01/golang-multipart-file-upload-example/</a></p>\n\n<pre><code>func newfileUploadRequest(uri string, params map[string]string, paramName, path string) (*http.Request, error) {\n  file, err := os.Open(path)\n  if err != nil {\n      return nil, err\n  }\n  defer file.Close()\n\n  body := &amp;bytes.Buffer{}\n  writer := multipart.NewWriter(body)\n  part, err := writer.CreateFormFile(paramName, filepath.Base(path))\n  if err != nil {\n      return nil, err\n  }\n  _, err = io.Copy(part, file)\n\n  for key, val := range params {\n      _ = writer.WriteField(key, val)\n  }\n  err = writer.Close()\n  if err != nil {\n      return nil, err\n  }\n\n  return http.NewRequest(\"POST\", uri, body)\n}\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5079180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3a77279683cb902b6ffc5f817acff5?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5079180/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 2, "accepted_answer_id": 32136737, "answer_count": 1, "score": 1, "last_activity_date": 1440148632, "creation_date": 1440146849, "question_id": 32136093, "link": "https://stackoverflow.com/questions/32136093/how-can-i-upload-a-file-to-server-without-browser-using-go", "title": "How can I upload a file to server, without browser, using go?", "body": "<pre><code>trsp := &amp;http.Transport{\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\nUrl := \"https://127.0.0.1:8080\"\nclient := &amp;http.Client{Transport: trsp}\nrequest, _ := http.NewRequest(\"POST\", Url, nil)\nk, _ := os.Open(nameOfFile)\nrequest.Header.Set(\"Action\", \"download\"+k.Name())\n...\n...\nclient.Do(request)\n</code></pre>\n\n<p>I have server, and I need to upload to server a file. What should I do with request? As I think I shoud write into request.Body and then, from server handle this query</p>\n"}, {"tags": ["tcp", "go", "websocket", "socks"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1440146973, "post_id": 32135763, "comment_id": 52162451, "body": "Did you mean something like <a href=\"https://www.npmjs.com/package/wstunnel\" rel=\"nofollow noreferrer\">wstunnel</a>  or <a href=\"https://github.com/dmajda/websockets-proxy\" rel=\"nofollow noreferrer\">websockets-proxy</a> ?"}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1440147892, "post_id": 32135763, "comment_id": 52162979, "body": "yeah, it seems wstunnel is what I mean though javascript is not my thing."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1440148505, "post_id": 32135763, "comment_id": 52163439, "body": "websockets-proxy seems to do the same thing too... is there any Go equivalent?"}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1440154428, "post_id": 32135763, "comment_id": 52166822, "body": "I don&#39;t know of an Go equivalent."}], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1440186885, "post_id": 32148179, "comment_id": 52185977, "body": "just now I was thinking to use a &quot;fake&quot; listener and Dial to create the TCP connection.. I will try that and let you know how it goes."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1440193959, "post_id": 32148179, "comment_id": 52188864, "body": "I&#39;ve tried this and it seems to be a dead end. I&#39;ve updated my answer with the code I&#39;ve tried. The ideal to have a &quot;fake&quot; listener and dialer just to construct a TCP connection seems wrong and doesn&#39;t work."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1440194642, "post_id": 32148179, "comment_id": 52189044, "body": "It&#39;s worth to note that in your example you have only two parties but I have 3 (NAT, Server and IE)."}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1440197437, "post_id": 32148179, "comment_id": 52189910, "body": "I&#39;ve updated my answer with the final solution. Indeed I had to Dial a fake listener which I find very awkward (i.e. keeping listening on a local port and dialing it with the data received through websockets). I&#39;m wondering if it would be possible to create a constructor for the net package to read from websockets (an io.ReadWriter) and return *net.Conn without the fake dialer/listener."}], "tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 5, "last_activity_date": 1440186245, "creation_date": 1440186245, "answer_id": 32148179, "question_id": 32135763, "link": "https://stackoverflow.com/questions/32135763/is-it-possible-to-transport-a-tcp-connection-over-websockets-or-another-protocol/32148179#32148179", "title": "Is it possible to transport a TCP connection over websockets or another protocol?", "body": "<p>This shouldn't be any problem. I've built TCP forwarders over a number of protocols. Never WebSockets, but I don't see a reason it would be different.</p>\n\n<p>You have two problems:</p>\n\n<ul>\n<li>The correct way to make a connection is with <code>net.Dial</code>, not by just creating a <code>net.TCPConn</code>.</li>\n<li>You're only copying in one direction. You need to copy in both directions.</li>\n</ul>\n\n<p>Here's a super simple proxy that I built this morning for a different purpose (my full code corrupts a packet every so often so I can test bad connectoins). It should be convertible to many other purposes:</p>\n\n<pre><code>func run(inPort int, dest string) {\n    l, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", inPort))\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n    fmt.Printf(\"http://%v -&gt; %s\\n\", l.Addr(), dest)\n\n    for {\n        conn, err := l.Accept()\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        fmt.Printf(\"Connection from %s\\n\", conn.RemoteAddr())\n        go proxy(conn, dest)\n    }\n}\n\nfunc proxy(in net.Conn, dest string) {\n    out, err := net.Dial(\"tcp\", dest)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n\n    go io.Copy(out, in)\n    io.Copy(in, out)\n    fmt.Printf(\"Disconnect from %s\\n\", in.RemoteAddr())\n}\n</code></pre>\n\n<p>You just need to replace the <code>net.Dial</code> here with a WS call to your server, and on the server side use <code>net.Dial</code> to forward it along.</p>\n\n<p>But probably the most key point is the last few lines. You have to copy in both directions and people forget that.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2255, "favorite_count": 2, "accepted_answer_id": 32148179, "answer_count": 1, "score": 6, "last_activity_date": 1440197172, "creation_date": 1440145852, "last_edit_date": 1440182998, "question_id": 32135763, "link": "https://stackoverflow.com/questions/32135763/is-it-possible-to-transport-a-tcp-connection-over-websockets-or-another-protocol", "title": "Is it possible to transport a TCP connection over websockets or another protocol?", "body": "<p>I'm wondering, is it possible to transport/tunnel a TCP connection though the websockets protocol?</p>\n\n<p>There is a <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\">websockets package</a> and it seems I could io.copy the TCP connection into the websockets connection but I don't know how to reassemble it as TCPConn on the other end. </p>\n\n<p>For example I would like to create a socks5 \nServerN(behind NAT) on one end and a ServerIE on the other end. An internet user would make a socks5 request (though the socks5 protocol) to ServerIE and ServerIE would send the socks5 request through the websocket connection to ServerNAT. ServerNAT will then process the socks5 request(i.e. it's a socks5 server).</p>\n\n<p><strong>EDIT:</strong>\nI've wrote some code but unfortunately it gets stuck on reading from the TCP connection into WS.   To run it: <code>go run main.go -logtostderr</code></p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n\n    log \"github.com/golang/glog\"\n    \"golang.org/x/net/websocket\"\n    \"bufio\"\n    \"net\"\n    \"net/http\"\n    \"time\"\n//  \"io\"\n)\n\nfunc main() {\n    flag.Parse()\n    defer log.Flush()\n    log.Infof(\"wsServer()\")\n    wsCh := wsServer()\n    log.Infof(\"wsNAT()\")\n    natWS, err := wsNAT()\n    if err != nil {\n        log.Error(err)\n        return\n    }\n    done := make(chan struct{}, 1)\n        log.Infof(\"listenTCP()\")\n        conn := listenTCP()\n        buf := bufio.NewReader(conn)\n    go func() {\n        log.Infof(\"Write TCP to WS\")\n        n, err := buf.WriteTo(natWS)\n        if err != nil {\n            log.Fatal(err)\n            return\n        }\n        log.Infof(\"newConn.ws.ReadFrom(conn) %v\", n)\n        close(done)\n    }()\n    wsToTCP(&lt;- wsCh)\n    &lt;-done\n}\n// wsNAT dials /ws endpoint and returns a websocket connection.\nfunc wsNAT() (*websocket.Conn, error) {\n    time.Sleep(1 * time.Second)\n    origin := \"http://localhost/\"\n    url := \"ws://localhost:12345/ws\"\n    return websocket.Dial(url, \"\", origin)\n}\n // wsServer returns the websocket\n // connections received on /ws endpoint\nfunc wsServer() chan *websocket.Conn {\n    wsCh := make(chan *websocket.Conn, 1)\n    http.Handle(\"/ws\", websocket.Handler(func(ws *websocket.Conn) {\n        wsCh &lt;- ws\n        time.Sleep(1 *time.Hour)\n    }))\n    go func() {\n        err := http.ListenAndServe(\":12345\", nil)\n        if err != nil {\n            panic(\"ListenAndServe: \" + err.Error())\n        }\n    }()\n    return wsCh\n}\n// wsToTCP reads a ws connection and converts its payload\n// to a TCP connection.\nfunc wsToTCP(ws *websocket.Conn) {\n    conn := &amp;net.TCPConn{}\n    var msg []byte\n    if _, err := ws.Read(msg); err != nil {\n        log.Error(err)\n        return\n    }\n    log.Infof(\"msg %v\", msg)\n    n, err := conn.Write(msg)\n    if err != nil {\n        log.Errorf(\"conn.Write %v, msg %v\", err, msg)\n        return\n    }\n    log.Infof(\"conn is %v, copied %v\", conn, n)\n    // END: do something with the connection\n    // ..... \n}\n//ListenTCP returns the first TCP connection received on port 8080\nfunc listenTCP() *net.TCPConn {\n    addr := &amp;net.TCPAddr{IP: net.ParseIP(\"0.0.0.0\"), Port: 8080}\n    lr, err := net.ListenTCP(\"tcp\", addr)\n    if err != nil {\n        panic(err)\n\n    }\n    defer lr.Close()\n    ieConn, err := lr.AcceptTCP()\n    if err != nil {\n        panic(err)\n    }\n    log.Infof(\"connection accepted\")\n    return ieConn\n}\n</code></pre>\n\n<p>To trigger the TCP listener you can issue a request on port 8080 (e.g. <code>curl --socks5 localhost:8080 google.com -v</code> or <code>curl localhost:8080 -v</code>)</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "edited": false, "score": 0, "creation_date": 1440132562, "post_id": 32132064, "comment_id": 52155750, "body": "The only thing I can think about is generating code that calls a register function in <code>init()</code> for you."}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 197, "user_id": 1295863, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7d891db1c3cffd1c11b393d6d6816f97?s=128&d=identicon&r=PG", "display_name": "THUNDERGROOVE", "link": "https://stackoverflow.com/users/1295863/thundergroove"}, "edited": false, "score": 0, "creation_date": 1440133605, "post_id": 32132064, "comment_id": 52156030, "body": "Yeah @THUNDERGROOVE , that&#39;s basically what I&#39;ve implemented. But I don&#39;t want to generate code. I rather run <code>go test</code> and have the library discover all the types, instantiate them, and then invoke them. All in one process execution. It&#39;s a doozy of the problem."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -1, "last_activity_date": 1440144702, "creation_date": 1440144702, "answer_id": 32135428, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime/32135428#32135428", "title": "How to discover all package types at runtime?", "body": "<p>No there is not.</p>\n\n<p>If you want to 'know' your types you'll have to register them.</p>\n"}, {"comments": [{"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 1, "creation_date": 1440185356, "post_id": 32135558, "comment_id": 52185331, "body": "Yes, I still may open an issue as it would be really nice to have something like <code>reflect.PackageOf(&quot;path&quot;).Types()</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1440145108, "creation_date": 1440145108, "answer_id": 32135558, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime/32135558#32135558", "title": "How to discover all package types at runtime?", "body": "<p>Unfortunately, I don't think this is possible. Packages are not \"actionable\" in Go, you can't \"call a function\" on it. You can't call a function on a type either, but you can call <code>reflect.TypeOf</code> on an instance of the type and get <code>reflect.Type</code> which is a runtime abstraction of a type. There just isn't such mechanism for packages, there isn't a <code>reflect.Package</code>.</p>\n\n<p>With that said, you could <a href=\"https://github.com/golang/go/issues/new\" rel=\"nofollow\">file an issue</a> about the absence of (and practicality of adding) <code>reflect.PackageOf</code> etc.</p>\n"}, {"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1440148898, "post_id": 32135975, "comment_id": 52163691, "body": "That&#39;s a nice one ;-)"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1440168318, "post_id": 32135975, "comment_id": 52175937, "body": "@thwd: Wow, that&#39;s crazy. Now for the golden question: After invoking typelinks() to get the []string type names, can I somehow hook into the reflect package to instantiate new instances of those names?"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1440185127, "post_id": 32135975, "comment_id": 52185237, "body": "Thanks for the additional info. I&#39;m interested to see if it works."}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1440371504, "post_id": 32135975, "comment_id": 52231231, "body": "@mdwhatcott I&#39;ve tested everything and it works. I have linked a working gist in the answer. This was on Go 1.4.2."}, {"owner": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 1, "creation_date": 1547458457, "post_id": 32135975, "comment_id": 95185998, "body": "@thwd, this answer <i>could</i> be everything I&#39;ve been looking for, for weeks! Now it&#39;s 2019, are there any other updates? Also, out of interest, if I&#39;m building this on MacOS then zasm_linux_amd64.h won&#39;t exist - what&#39;s the alternative I&#39;m looking for?"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 1, "creation_date": 1547464769, "post_id": 32135975, "comment_id": 95189246, "body": "@Jimbo I amended the answer ;)"}, {"owner": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 0, "creation_date": 1547545838, "post_id": 32135975, "comment_id": 95219477, "body": "@thwd I&#39;ve been playing with this for the past day, does it <i>definitely</i> pluck out all of the structs available in all packages?? I created a basic struct in the main package with some vars and obviously named methods and this doesn&#39;t seem, pick it up."}, {"owner": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 0, "creation_date": 1547553481, "post_id": 32135975, "comment_id": 95223435, "body": "PS - given this struct type, I would like to instantiate it. That is my goal :-)"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "reply_to_user": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 1, "creation_date": 1547556485, "post_id": 32135975, "comment_id": 95224985, "body": "@Jimbo wups, another change I hadnt noticed is that now they only include pointer, channel, map, slice and array types in typelinks. It&#39;s documented in src/reflect/type.go :("}, {"owner": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 0, "creation_date": 1547558212, "post_id": 32135975, "comment_id": 95225870, "body": "So effectively there\u2019s no way for us to go from the string \u201cMyStruct\u201d -&gt; an instance of MyStruct without writing the type literal in-code... this was my last hope! Thanks for the update anyway @thwd."}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1550984629, "post_id": 32135975, "comment_id": 96470178, "body": "@thwd - Your 2019 update works like a charm! Thanks very much for coming back."}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1551225963, "post_id": 32135975, "comment_id": 96561125, "body": "I&#39;m noticing that the typelinks (<code>tl</code>) code/package can&#39;t be contained inside my own github package. I get a compilation failure: &quot;github.com/smartystreets/gunit/tl.Typelinks: relocation target github.com/smartystreets/gunit/tl.typelinks not defined &quot; Is there a way around that? @thwd"}, {"owner": {"reputation": 23964, "user_id": 736809, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/en4t4.jpg?s=128&g=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/736809/jimbo"}, "edited": false, "score": 0, "creation_date": 1565271162, "post_id": 32135975, "comment_id": 101307768, "body": "Are you guys all using old version of Go? I&#39;d give anything to have this working on modern Go versions."}, {"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "edited": false, "score": 1, "creation_date": 1578960527, "post_id": 32135975, "comment_id": 105602067, "body": "Excellent work, thwd :) mdwhatcott, if you want to have the tl package live inside a package you can instead define &quot;TEXT &#183;typelinks(SB), $0-0&quot;, and Go will know it&#39;s in your package (<a href=\"https://golang.org/doc/asm#symbols\" rel=\"nofollow noreferrer\">golang.org/doc/asm#symbols</a>, starting &quot;Most hand-written assembly files do not include the full package path&quot;). In Go 1.13.4 I&#39;m getting some errors about reflect.add, but I&#39;ve successfully copied its definition into tl.go from <a href=\"https://github.com/golang/go/blob/563287ae0636a592880dc616b50fde217fa1100f/src/reflect/type.go#L1026-L1035\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a> and the solution here works as described."}], "tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 14, "last_activity_date": 1547464756, "last_edit_date": 1547464756, "creation_date": 1440146491, "answer_id": 32135975, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime/32135975#32135975", "title": "How to discover all package types at runtime?", "body": "<p>(see bottom for 2019 update)</p>\n\n<p><strong>Warning</strong>: untested and hacky. Can break whenever a new version of Go is released.</p>\n\n<p>It is possible to get all types the runtime knows of by hacking around Go's runtime a little. Include a small assembly file in your own package, containing:</p>\n\n<pre><code>TEXT yourpackage\u00b7typelinks(SB), NOSPLIT, $0-0\n    JMP reflect\u00b7typelinks(SB)\n</code></pre>\n\n<p>In <code>yourpackage</code>, declare the function prototype (without body):</p>\n\n<pre><code>func typelinks() []*typeDefDummy\n</code></pre>\n\n<p>Alongside a type definition:</p>\n\n<pre><code>type typeDefDummy struct {\n    _      uintptr           // padding\n    _      uint64            // padding\n    _      [3]uintptr        // padding\n    StrPtr *string           \n}\n</code></pre>\n\n<p>Then just call typelinks, iterate over the slice and read each StrPtr for the name. Seek those starting with <code>yourpackage</code>. Note that if there are two packages called <code>yourpackage</code> in different paths, this method won't work unambiguously.</p>\n\n<blockquote>\n  <p>can I somehow hook into the reflect package to instantiate new instances of those names?</p>\n</blockquote>\n\n<p>Yeah, assuming <code>d</code> is a value of type <code>*typeDefDummy</code> (note the asterisk, very important):</p>\n\n<pre><code>t := reflect.TypeOf(*(*interface{})(unsafe.Pointer(&amp;d)))\n</code></pre>\n\n<p>Now <code>t</code> is a <code>reflect.Type</code> value which you can use to instantiate <code>reflect.Value</code>s.</p>\n\n<hr>\n\n<p>Edit: I tested and executed this code successfully and have <a href=\"https://gist.github.com/thwd/00956dde67346cbed5f8\" rel=\"nofollow noreferrer\">uploaded it as a gist</a>.</p>\n\n<p>Adjust package names and include paths as necessary.</p>\n\n<h2>Update 2019</h2>\n\n<p>A lot has changed since I originally posted this answer. Here's a short description of how the same can be done with Go 1.11 in 2019.</p>\n\n<p><code>$GOPATH/src/tl/tl.go</code></p>\n\n<pre><code>package tl\n\nimport (\n    \"unsafe\"\n)\n\nfunc Typelinks() (sections []unsafe.Pointer, offset [][]int32) {\n    return typelinks()\n}\n\nfunc typelinks() (sections []unsafe.Pointer, offset [][]int32)\n\nfunc Add(p unsafe.Pointer, x uintptr, whySafe string) unsafe.Pointer {\n    return add(p, x, whySafe)\n}\n\nfunc add(p unsafe.Pointer, x uintptr, whySafe string) unsafe.Pointer\n</code></pre>\n\n<p><code>$GOPATH/src/tl/tl.s</code></p>\n\n<pre><code>TEXT tl\u00b7typelinks(SB), $0-0\n    JMP reflect\u00b7typelinks(SB)\n\nTEXT tl\u00b7add(SB), $0-0\n    JMP reflect\u00b7add(SB)\n</code></pre>\n\n<p><code>main.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"tl\"\n    \"unsafe\"\n)\n\nfunc main() {\n    sections, offsets := tl.Typelinks()\n    for i, base := range sections {\n        for _, offset := range offsets[i] {\n            typeAddr := tl.Add(base, uintptr(offset), \"\")\n            typ := reflect.TypeOf(*(*interface{})(unsafe.Pointer(&amp;typeAddr)))\n            fmt.Println(typ)\n        }\n    }\n}\n</code></pre>\n\n<p>Happy hacking!</p>\n"}, {"comments": [{"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1440168062, "post_id": 32142080, "comment_id": 52175759, "body": "Wow, didn&#39;t know this new functionality existed. What good timing! Now for the golden question: After getting retrieving pkg.Scope().Names(), can I somehow hook into the reflect package to instantiate new instances of the Names() that represent types?"}, {"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "reply_to_user": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 1, "creation_date": 1440168616, "post_id": 32142080, "comment_id": 52176141, "body": "Seems that you are looking for the plugin architecture. Right now, it is not implemented in Go 1.5 . Read <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/edit#\" rel=\"nofollow noreferrer\">docs.google.com/document/d/&hellip;</a> for more information"}, {"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 0, "creation_date": 1516231049, "post_id": 32142080, "comment_id": 83608955, "body": "@hlin117 Well, what I need is the ability to load all types in the executing package and instantiate new instances of many of them at runtime during test execution. Can the code in this answer be extended/modified to accomplish that?"}, {"owner": {"reputation": 641, "user_id": 1974520, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o7Guw.jpg?s=128&g=1", "display_name": "vda8888", "link": "https://stackoverflow.com/users/1974520/vda8888"}, "edited": false, "score": 0, "creation_date": 1517361865, "post_id": 32142080, "comment_id": 84061730, "body": "Could you elaborate on this answer more? I got error cannot find pkg &quot;time&quot; <a href=\"https://play.golang.org/p/yuCFQ8r0DrS\" rel=\"nofollow noreferrer\">play.golang.org/p/yuCFQ8r0DrS</a>"}, {"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "reply_to_user": {"reputation": 641, "user_id": 1974520, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o7Guw.jpg?s=128&g=1", "display_name": "vda8888", "link": "https://stackoverflow.com/users/1974520/vda8888"}, "edited": false, "score": 0, "creation_date": 1517384931, "post_id": 32142080, "comment_id": 84068948, "body": "@vda8888 That is because the playground runs on sandboxed environment. <i>&quot;The playground can use most of the standard library, with some exceptions. The only communication a playground program has to the outside world is by writing to standard output and standard error.&quot;</i> This example is still working on a standard environment with go 1.9."}, {"owner": {"reputation": 641, "user_id": 1974520, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o7Guw.jpg?s=128&g=1", "display_name": "vda8888", "link": "https://stackoverflow.com/users/1974520/vda8888"}, "edited": false, "score": 0, "creation_date": 1517805619, "post_id": 32142080, "comment_id": 84228770, "body": "@Alvivi Does this mean that this would not work if I only have access to the built binary at runtime (i.e. no access to Golang source code or my source code)?"}, {"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "reply_to_user": {"reputation": 641, "user_id": 1974520, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/o7Guw.jpg?s=128&g=1", "display_name": "vda8888", "link": "https://stackoverflow.com/users/1974520/vda8888"}, "edited": false, "score": 0, "creation_date": 1517823748, "post_id": 32142080, "comment_id": 84235681, "body": "@vda8888, nope. This is based on importer (<a href=\"https://golang.org/pkg/go/importer/\" rel=\"nofollow noreferrer\">golang.org/pkg/go/importer</a>) which needs access to golang environment."}, {"owner": {"reputation": 4514, "user_id": 362754, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4f94dacdb4bdf32a0a48f4a50233dd95?s=128&d=identicon&r=PG", "display_name": "minghua", "link": "https://stackoverflow.com/users/362754/minghua"}, "edited": false, "score": 0, "creation_date": 1538091287, "post_id": 32142080, "comment_id": 92032497, "body": "If the package is under GOPATH, run <code>go install &lt;package-path&gt;</code> first to install the .a file to the GOPATH/pkg/... or else the package will not be found. This works for me with go 1.10.4 on windows 10."}], "tags": [], "owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "is_accepted": false, "score": 27, "last_activity_date": 1440165082, "creation_date": 1440165082, "answer_id": 32142080, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime/32142080#32142080", "title": "How to discover all package types at runtime?", "body": "<p><strong>In Go 1.5</strong>, you can use the new package <a href=\"http://golang.org/pkg/go/types/\" rel=\"noreferrer\">types</a> and <a href=\"http://golang.org/pkg/go/importer/\" rel=\"noreferrer\">importer</a> to inspect binary and source packages. For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"go/importer\"\n)\n\nfunc main() {\n    pkg, err := importer.Default().Import(\"time\")\n    if err != nil {\n        fmt.Printf(\"error: %s\\n\", err.Error())\n        return\n    }\n    for _, declName := range pkg.Scope().Names() {\n        fmt.Println(declName)\n    }\n}\n</code></pre>\n\n<p>You can use the package <a href=\"http://golang.org/pkg/go/build/\" rel=\"noreferrer\">go/build</a> to extract all the packages installed. Or you can configure the <a href=\"http://golang.org/pkg/go/importer/#Lookup\" rel=\"noreferrer\"><code>Lookup</code></a> importer to inspect binaries outside the environment.</p>\n\n<p><strong>Before 1.5</strong>, the only no-hacky way is to use the package <a href=\"http://golang.org/pkg/go/ast/\" rel=\"noreferrer\">ast</a> to compile the source code.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12721465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e834e84ba2740e9a517c6de49359e61?s=128&d=identicon&r=PG&f=1", "display_name": "EricHe", "link": "https://stackoverflow.com/users/12721465/eriche"}, "is_accepted": false, "score": 2, "last_activity_date": 1579140955, "creation_date": 1579140955, "answer_id": 59762148, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime/59762148#59762148", "title": "How to discover all package types at runtime?", "body": "<p>Thanks @thwd and @icio, follow your direction it still worked on 1.13.6 today. </p>\n\n<p>Follow your way the tl.s will be:</p>\n\n<pre><code>TEXT \u00b7typelinks(SB), $0-0\n    JMP reflect\u00b7typelinks(SB)\n</code></pre>\n\n<p>yes, no package name and no \"add\" function in it.</p>\n\n<p>then follow @icio's way change \"add\" function to:</p>\n\n<pre><code>func add(p unsafe.Pointer, x uintptr, whySafe string) unsafe.Pointer {\n    return unsafe.Pointer(uintptr(p) + x)\n}\n</code></pre>\n\n<p>then all worked now. :)</p>\n"}], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7911, "favorite_count": 8, "accepted_answer_id": 32135975, "answer_count": 5, "score": 16, "last_activity_date": 1579140955, "creation_date": 1440128927, "last_edit_date": 1550058058, "question_id": 32132064, "link": "https://stackoverflow.com/questions/32132064/how-to-discover-all-package-types-at-runtime", "title": "How to discover all package types at runtime?", "body": "<p>As far as I'm aware (see <a href=\"https://stackoverflow.com/a/22188310/605022\">here</a>, and <a href=\"https://stackoverflow.com/a/20805018/605022\">here</a>) there is no type discovery mechanism in the <a href=\"http://golang.org/pkg/reflect/\" rel=\"noreferrer\">reflect package</a>, which expects that you already have an instance of the type or value you want to inspect. </p>\n\n<p><strong>Is there any <em>other</em> way to discover all exported types (especially the structs) in a running go package?</strong></p>\n\n<p>Here's what I wish I had (but it doesn't exist):</p>\n\n<pre><code>import \"time\"\nimport \"fmt\"\n\nfunc main() {\n    var types []reflect.Type\n    types = reflect.DiscoverTypes(time)\n    fmt.Println(types)\n}\n</code></pre>\n\n<p>The end goal is to be able to discover all the structs of a package that meet certain criteria, then be able to instantiate new instances of those structs.</p>\n\n<p>BTW, a registration function that identifies the types is <strong>not</strong> a valid approach for my use case.</p>\n\n<hr>\n\n<p><em>Whether you think it's a good idea or not, here's why I want this capability (because I know you're going to ask):</em></p>\n\n<p>I've written a <a href=\"https://github.com/smartystreets/gunit\" rel=\"noreferrer\">code generation utility</a> that loads go source files and builds an AST to scan for types that embed a specified type. The output of the utility is a set of go test functions based on the discovered types. I invoke this utility using <code>go generate</code> to create the test functions then run <code>go test</code> to execute the generated test functions. Every time the tests change (or a new type is added) I must re-run go generate before re-running <code>go test</code>. This is why a registration function is not a valid option. I'd like to avoid the <code>go generate</code> step but that would require my utility to become a library that is imported by the running package. The library code would need to somehow scan the running namespace during <code>init()</code> for types that embed the expected library type.</p>\n"}, {"tags": ["graph", "go", "trace", "demo"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1440136234, "post_id": 32131339, "comment_id": 52156929, "body": "what is the question?"}], "answers": [{"tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 14, "last_activity_date": 1506434907, "last_edit_date": 1506434907, "creation_date": 1440139514, "answer_id": 32133997, "question_id": 32131339, "link": "https://stackoverflow.com/questions/32131339/the-go-1-5-trace-command/32133997#32133997", "title": "The go 1.5 trace command", "body": "<p>There are two ways you can generate trace files.</p>\n\n<p><strong>Method 1</strong> </p>\n\n<ol>\n<li><p>Add following line at the start of your program</p>\n\n<pre><code>f, err := os.Create(time.Now().Format(\"2006-01-02T150405.pprof\"))\nif err != nil {\n    panic(err)\n}\ndefer f.Close()\n\nif err := trace.Start(f); err != nil {\n    panic(err)\n}\ndefer trace.Stop()\n</code></pre></li>\n<li><p>build the program</p>\n\n<blockquote>\n  <p>go build</p>\n</blockquote></li>\n<li>Run your program (for example <code>./myprogram</code>)</li>\n<li>Run go trace.\n\n<blockquote>\n  <p>go tool trace myprogram 2015-08-21T115354.pprof</p>\n</blockquote></li>\n</ol>\n\n<p><strong>Method 2</strong></p>\n\n<ol>\n<li>Write a testing function utilizing testing package.</li>\n<li><p>Run Test with trace flag</p>\n\n<blockquote>\n  <p>go test -trace trace.out</p>\n</blockquote></li>\n<li><p>Run trace tool with generated .test and .out file</p>\n\n<blockquote>\n  <p>go tool trace pkg.test trace.out</p>\n</blockquote></li>\n</ol>\n\n<p><strong>In both cases your browser will open something like this</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/i3p2W.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/i3p2W.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/LTMVS.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/LTMVS.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/t46my.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/t46my.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2102, "favorite_count": 3, "accepted_answer_id": 32133997, "answer_count": 1, "score": 10, "last_activity_date": 1506434907, "creation_date": 1440123139, "question_id": 32131339, "link": "https://stackoverflow.com/questions/32131339/the-go-1-5-trace-command", "title": "The go 1.5 trace command", "body": "<p>The Go 1.5 release note says, </p>\n\n<blockquote>\n  <p>The new \"go tool trace\" command enables the visualisation of  program traces generated by new tracing infrastructure in the runtime. </p>\n</blockquote>\n\n<p>This is really exciting, and I want to know more about it. But its official document at <a href=\"https://golang.org/cmd/trace/\">https://golang.org/cmd/trace/</a> is really dry. </p>\n\n<p>Found that <a href=\"https://github.com/golang/go/issues/11605\">Rob Pike complained about it</a>, requesting that <em>\"shortly after the 1.5 release, there should be a blog post about the feature.\"</em></p>\n\n<p>If anyone has posted/spotted such a blog, please add a link here. Or, if you like to answer directly here, it is also welcome as well.  </p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "compiler-construction", "programming-languages"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1440108882, "post_id": 32129220, "comment_id": 52149783, "body": "Bootstrapping has nothing to do with it. &#39;Bootstrapped compiler&#39; and &#39;compiler written in C&#39; are not mutually exclusive. What you are really asking is between &#39;compiler written in Go&#39; and &#39;compiler written in C&#39;."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1440115621, "post_id": 32129220, "comment_id": 52151672, "body": "Title didn&#39;t convey the specifics in the question body (is <i>Go 1.5&#39;s</i> bootstrapped compiler slower than <i>1.4&#39;s</i> compiler in C), so I edited it to be clearer, but it seems like a reasonable question, even if we don&#39;t entirely love the answer (yes, builds in 1.5 are slower)."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440112489, "post_id": 32129456, "comment_id": 52150823, "body": "Unfortunately, I don&#39;t think this is quite right--Go 1.5 compilation is slower than 1.4 (still quick compared to a lot of things, but that wasn&#39;t the question). The Go authors are hopeful they can make up some of that difference over time through performance tuning and better parallelization. Sorry not to have great cites for this, but, e.g., there&#39;s this thread starting July 5: <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/uBFzGIturOA\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/uBFzGIturOA</a>"}, {"owner": {"reputation": 547, "user_id": 1392922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a711bea966a6ffd9b095ef5aac3f666c?s=128&d=identicon&r=PG", "display_name": "Paul Marrington", "link": "https://stackoverflow.com/users/1392922/paul-marrington"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440113458, "post_id": 32129456, "comment_id": 52151109, "body": "I also can only go on what I heard on a podcast with one of the go team. I would expect the compiler to be slower because it can now do more. Are the compiled applications slower also?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1440114631, "post_id": 32129456, "comment_id": 52151381, "body": "No, the speed of the code it generates is independent of the speed of the compiler in this case. Programs that had long GC pauses generally have almost all of that work pushed into the background now (I <a href=\"https://stackoverflow.com/questions/31684862/how-fast-is-the-go-1-5-gc-with-terabytes-of-ram/31686469\">answered about this elsewhere</a>). If you have tons of goroutines and context switches the scheduler changes may help you. <a href=\"http://kokizzu.blogspot.com/2015/07/go-142-vs-15-beta-1-benchmark.html\" rel=\"nofollow noreferrer\">Otherwise many programs might see smallish changes</a>."}], "tags": [], "owner": {"reputation": 547, "user_id": 1392922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a711bea966a6ffd9b095ef5aac3f666c?s=128&d=identicon&r=PG", "display_name": "Paul Marrington", "link": "https://stackoverflow.com/users/1392922/paul-marrington"}, "is_accepted": false, "score": 0, "last_activity_date": 1440109566, "creation_date": 1440109566, "answer_id": 32129456, "question_id": 32129220, "link": "https://stackoverflow.com/questions/32129220/is-go-1-5s-bootstrapped-compiler-slower-than-the-go-1-4-compiler-written-in-c/32129456#32129456", "title": "Is Go 1.5&#39;s bootstrapped compiler slower than the Go 1.4 compiler written in C?", "body": "<p>Well, PyPy is written in Python and it is known to be faster (sometimes) than CPython written in C.</p>\n\n<p>In the case of Go, the language makes it easier to write more efficient code, so it should not be slower than the older C version. The writers were careful to make sure of this. Rather than faster it is easier to maintain and extend.</p>\n\n<p>C is fast because it is close to the CPU, but the speed of a language is mostly more about the algorithms to produce the more 'advanced' feature (simple to use but advanced compared to CPU features).</p>\n\n<p>A classic example is memory management. The C malloc/free is inherently slow as it reorganises free memory whenever you release it. A garbage collector sounds a lot slower because of the work it needs to do, but your program can release memory and continue on at full speed.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 7, "last_activity_date": 1440116185, "last_edit_date": 1440116185, "creation_date": 1440115050, "answer_id": 32130328, "question_id": 32129220, "link": "https://stackoverflow.com/questions/32129220/is-go-1-5s-bootstrapped-compiler-slower-than-the-go-1-4-compiler-written-in-c/32130328#32130328", "title": "Is Go 1.5&#39;s bootstrapped compiler slower than the Go 1.4 compiler written in C?", "body": "<p>Yes, the Go 1.5 compiler is slower, as <a href=\"https://golang.org/doc/go1.5#performance\">discussed in the release notes</a>:</p>\n\n<blockquote>\n  <p>Builds in Go 1.5 will be slower by a factor of about two. The automatic translation of the compiler and linker from C to Go resulted in unidiomatic Go code that performs poorly compared to well-written Go. Analysis tools and refactoring helped to improve the code, but much remains to be done. Further profiling and optimization will continue in Go 1.6 and future releases. For more details, see these <a href=\"https://talks.golang.org/2015/gogo.slide#1\">slides</a> and associated <a href=\"https://www.youtube.com/watch?v=cF1zJYkBW4A\">video</a>.</p>\n</blockquote>\n\n<p>Again, the compiler was (initially) automatically translated, so after the translation it output the same code as before: your programs aren't slower because the compiler is. <a href=\"https://golang.org/doc/go1.5#implementation\">The rest of the release notes</a> and the links above shed more light. There are considerations other than compile speeds involved: the authors intend to move faster in Go than they could in C.</p>\n\n<p>I'd recommend upgrading: open-source code will come to depend on 1.5, and if you stay behind you lose a lot of cool stuff, like big reductions in GC latency from pushing most of that work into the background (also discussed in the Performance section linked above; I wrote a bit more about it <a href=\"https://stackoverflow.com/questions/31684862/how-fast-is-the-go-1-5-gc-with-terabytes-of-ram/31686469\">responding to another question</a>). </p>\n\n<p>You should, as with any big upgrade, test to make sure that stuff like the new default of using all available cores, tweaks to scheduling, or any of the little <a href=\"https://golang.org/doc/go1.5#library\">library behavior changes</a> don't bite you.</p>\n"}], "owner": {"reputation": 1438, "user_id": 607722, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d7271d14cd6e627cfed8ecb1950ee832?s=128&d=identicon&r=PG", "display_name": "user607722", "link": "https://stackoverflow.com/users/607722/user607722"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 0, "accepted_answer_id": 32130328, "answer_count": 2, "score": 3, "last_activity_date": 1440116185, "creation_date": 1440108436, "last_edit_date": 1440115639, "question_id": 32129220, "link": "https://stackoverflow.com/questions/32129220/is-go-1-5s-bootstrapped-compiler-slower-than-the-go-1-4-compiler-written-in-c", "title": "Is Go 1.5&#39;s bootstrapped compiler slower than the Go 1.4 compiler written in C?", "body": "<p>Go 1.5 managed to release a bootstrapped compiler written in Go.\nAssuming Go is slower than C, and the earlier Go compiler is written in C, is the bootstrapped compiler going to be slower in compilation time?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1440104347, "post_id": 32127246, "comment_id": 52147832, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/12990338/cannot-convert-string-to-interface\">Cannot convert &#91;&#93;string to &#91;&#93;interface {}</a>"}], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 1351792, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/750ce24f442f49822e30776706ee0e7e?s=128&d=identicon&r=PG", "display_name": "Oriam", "link": "https://stackoverflow.com/users/1351792/oriam"}, "edited": false, "score": 0, "creation_date": 1440105246, "post_id": 32127693, "comment_id": 52148268, "body": "Thanks, I already figured it out, but is exactly as you say :) It&#39;s working like a charm"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 5, "last_activity_date": 1440102246, "creation_date": 1440102246, "answer_id": 32127693, "question_id": 32127246, "link": "https://stackoverflow.com/questions/32127246/go-generic-type-of-array-in-function-parameter/32127693#32127693", "title": "GO Generic type of array in function parameter", "body": "<p>You can't do it that way, however you can easily do this:</p>\n\n<pre><code>func functionX(collection interface{}) error {\n    ...\n    response, err := json.MarshalIndent(collection, \"\", \"  \")\n    ...\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/EcUG3AYVqY\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 593, "user_id": 1351792, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/750ce24f442f49822e30776706ee0e7e?s=128&d=identicon&r=PG", "display_name": "Oriam", "link": "https://stackoverflow.com/users/1351792/oriam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 32127693, "answer_count": 1, "score": 1, "last_activity_date": 1440102246, "creation_date": 1440100745, "question_id": 32127246, "link": "https://stackoverflow.com/questions/32127246/go-generic-type-of-array-in-function-parameter", "title": "GO Generic type of array in function parameter", "body": "<p>I have this function:</p>\n\n<pre><code>func functionX(collection []*interface{}) {\n    ...\n    response, err := json.MarshalIndent(collection, \"\", \"  \")\n    ...\n}\n</code></pre>\n\n<p>I want the <strong>collection</strong> parameter to allow arrays of any kind, that's why I tried with <strong>*interface{}</strong> but I'm receiving errors like this:</p>\n\n<pre><code>cannot use MyDataType (type []*model.MyDataType) as type []*interface {} in argument to middleware.functionX\n</code></pre>\n"}, {"tags": ["networking", "go", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": false, "score": 2, "last_activity_date": 1440096444, "creation_date": 1440096444, "answer_id": 32126041, "question_id": 32125980, "link": "https://stackoverflow.com/questions/32125980/tell-whether-net-listener-is-dead/32126041#32126041", "title": "Tell whether net.Listener is dead", "body": "<p>Figured it out. Errors returned by the <code>net</code> package may be of the <a href=\"http://golang.org/pkg/net/#Error\" rel=\"nofollow\"><code>net.Error</code></a> type, which defines the <code>Temporary() bool</code> method which reports whether the error is temporary.</p>\n"}], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1440096444, "creation_date": 1440096243, "question_id": 32125980, "link": "https://stackoverflow.com/questions/32125980/tell-whether-net-listener-is-dead", "title": "Tell whether net.Listener is dead", "body": "<p>In Go, a call to the <a href=\"http://golang.org/pkg/net/#Listener\" rel=\"nofollow\"><code>net.Listener</code></a> type's <code>Accept</code> method returns an error. However, is there a way to tell the difference between a transient error (ie, this connection failed to set up) vs a permanent error (ie, the listener is dead, such as a Unix domain socket file that was forcibly removed)? If I can't tell the difference, I run the risk of infinite looping and spitting out errors as fast as I can since each <code>Accept</code> call will immediately return an error.</p>\n"}, {"tags": ["methods", "types", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1440104032, "post_id": 32125832, "comment_id": 52147656, "body": "The <code>draw2dimg</code> package defines type <code>GraphicContext</code> as embedding another type that implements most of those methods. However, the <code>FillStroke</code> method is implemented directly on <code>GraphicContext</code> only. If you use embedding it will work as you seem to expect, if not it won&#39;t. See <a href=\"https://play.golang.org/p/mvRCew6UpC\" rel=\"nofollow noreferrer\">this simplified example</a>. (I.e. <code>type Foo Bar</code> does <b><i>not</i></b> make <code>Bar</code>&#39;s methods available, use embedding for that)."}, {"owner": {"reputation": 427, "user_id": 842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2932b4cb65bdd93525965de548a24139?s=128&d=identicon&r=PG", "display_name": "Willyfrog", "link": "https://stackoverflow.com/users/842262/willyfrog"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440107062, "post_id": 32125832, "comment_id": 52149083, "body": "while I still don&#39;t know the reason behind that decission, I can see by your example what is wrong in my code. If you answer the question (instead of commenting) I&#39;ll mark your answer as valid :D"}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": true, "score": 3, "last_activity_date": 1440120218, "creation_date": 1440120218, "answer_id": 32130968, "question_id": 32125832, "link": "https://stackoverflow.com/questions/32125832/after-renaming-a-type-i-cannot-access-some-of-its-methods/32130968#32130968", "title": "After renaming a type, I cannot access some of its methods", "body": "<p>you should use struct embedding rather than type define. check the struct '<a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a>' document:</p>\n\n<blockquote>\n  <p>but then to promote the methods of the fields and to satisfy the io\n  interfaces, we would also need to provide forwarding methods, like\n  this:</p>\n  \n  <p>func (rw *ReadWriter) Read(p []byte) (n int, err error) {\n         return rw.reader.Read(p)    }</p>\n  \n  <p>By embedding the structs directly, we avoid this bookkeeping.</p>\n</blockquote>\n"}], "owner": {"reputation": 427, "user_id": 842262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2932b4cb65bdd93525965de548a24139?s=128&d=identicon&r=PG", "display_name": "Willyfrog", "link": "https://stackoverflow.com/users/842262/willyfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 32130968, "answer_count": 1, "score": 4, "last_activity_date": 1440120218, "creation_date": 1440095768, "last_edit_date": 1440117395, "question_id": 32125832, "link": "https://stackoverflow.com/questions/32125832/after-renaming-a-type-i-cannot-access-some-of-its-methods", "title": "After renaming a type, I cannot access some of its methods", "body": "<p>In order to prevent having multiple dependencies along different files of my project and since I might change how data will be presented, I decided to make an \"interface\" (not in the golang sense but in an architectural way) to the <a href=\"https://github.com/llgcode/draw2d\" rel=\"nofollow\">draw2d package</a></p>\n\n<p>As I didn't need anything else, I just renamed one of the types:</p>\n\n<pre><code>type CanvasContext draw2dimg.GraphicContext\n</code></pre>\n\n<p>In one of my modules I had the following code (path is a CanvasContext variable):</p>\n\n<pre><code>// initialization and some code omitted for clarity\npath.SetFillColor(color.RGBA{0x44, 0xff, 0x44, 0xff})\npath.SetStrokeColor(color.RGBA{0x44, 0x44, 0x44, 0xff})\npath.SetLineWidth(5)\n// some more code here\npath.Close()\npath.FillStroke()\n</code></pre>\n\n<p>Among all those method calls on path, only the FillStroke failed with the compile error:</p>\n\n<blockquote>\n  <p>path.FillStroke undefined (type *drawing.CanvasContext has no field or\n  method FillStroke)</p>\n</blockquote>\n\n<p>In order to prevent it I have to redefine the FillStroke, but not any other method, with:</p>\n\n<pre><code>func (cc *CanvasContext) FillStroke() {\n    gc := draw2dimg.GraphicContext(*cc)\n    gc.FillStroke()\n}\n</code></pre>\n\n<p>Why do I have to redefine only that one and not any of the other calls?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4075678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496073aea7e52bf410efc39bcfb6a3b6?s=128&d=identicon&r=PG&f=1", "display_name": "amachure", "link": "https://stackoverflow.com/users/4075678/amachure"}, "edited": false, "score": 0, "creation_date": 1440099291, "post_id": 32126528, "comment_id": 52145072, "body": "Thanks Nicolas! I edited my comment based on your response, and it seems that this will run without issue, but the result is simply empty."}, {"owner": {"reputation": 2754, "user_id": 1621232, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/4ca2ea1416fa3dc15d1037e6502ac4da?s=128&d=identicon&r=PG", "display_name": "Nicolas Marshall", "link": "https://stackoverflow.com/users/1621232/nicolas-marshall"}, "reply_to_user": {"reputation": 43, "user_id": 4075678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496073aea7e52bf410efc39bcfb6a3b6?s=128&d=identicon&r=PG&f=1", "display_name": "amachure", "link": "https://stackoverflow.com/users/4075678/amachure"}, "edited": false, "score": 0, "creation_date": 1440104219, "post_id": 32126528, "comment_id": 52147766, "body": "Looks like I&#39;m a bit late, and that Jay Crumb is right ! Uppercase first letters in your structs all the way !"}], "tags": [], "owner": {"reputation": 2754, "user_id": 1621232, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/4ca2ea1416fa3dc15d1037e6502ac4da?s=128&d=identicon&r=PG", "display_name": "Nicolas Marshall", "link": "https://stackoverflow.com/users/1621232/nicolas-marshall"}, "is_accepted": true, "score": 2, "last_activity_date": 1440107506, "last_edit_date": 1440107506, "creation_date": 1440098117, "answer_id": 32126528, "question_id": 32125816, "link": "https://stackoverflow.com/questions/32125816/unmarshaling-xml-in-go/32126528#32126528", "title": "Unmarshaling XML in Go", "body": "<p>You can do it like this :</p>\n\n<pre><code>xmlReader := bytes.NewReader([]byte(your_xml_as_a_string_here))\nyourPinnacleLineFeed := new(Pinnacle_Line_Feed)\nif err := xml.NewDecoder(xmlReader).Decode(yourPinnacleLineFeed); err != nil {\n    return // or log.Panic(err.Error()) if in main\n}\n</code></pre>\n\n<p>This is if your xml \"file\" is a string. If you're getting it from the internet (as the body of an http response for instance), resp.Body is already going to satisfy a Reader, so you can skip the first line. If you're opening a real file on the OS, you can also open it as a Reader, same thing.</p>\n\n<p><strong>EDIT:</strong> Two more things:</p>\n\n<ul>\n<li>You can nest the structs and drop the xml.Name fields for simplicity and clarity</li>\n<li>I also noticed you forgot the participants level in the structs, leading for no participants to be unmarshaled</li>\n</ul>\n\n<p>Here's a more simple version that works, with an optional function to check what you have inside the results :</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Pinnacle_Line_Feed struct {\n    PinnacleFeedTime string `xml:\"PinnacleFeedTime\"`\n    LastContest      string `xml:\"lastContest\"`\n    LastGame         string `xml:\"lastGame\"`\n    Events           struct {\n        Event []struct {\n            Event_datetimeGMT string `xml:\"event_datetimeGMT\"`\n            Gamenumber        string `xml:\"gamenumber\"`\n            Sporttype         string `xml:\"sporttype\"`\n            League            string `xml:\"league\"`\n            IsLive            string `xml:\"IsLive\"`\n            Participants      struct {\n                Participant []struct {\n                    Participant_name   string `xml:\"participant_name\"`\n                    Contestantnum      int    `xml:\"contestantnum\"`\n                    Rotnum             int    `xml:\"rotnum\"`\n                    Visiting_home_draw string `xml:\"visiting_home_draw\"`\n                } `xml:\"participant\"`\n            } `xml:\"participants\"`\n        } `xml:\"event\"`\n    } `xml:\"events\"`\n}\n\nfunc main() {\n    pinny_xml := `\n         &lt;pinnacle_line_feed&gt;\n            &lt;PinnacleFeedTime&gt;1439954818555&lt;/PinnacleFeedTime&gt;\n            &lt;lastContest&gt;34317132&lt;/lastContest&gt;\n            &lt;lastGame&gt;218491030&lt;/lastGame&gt;\n            &lt;events&gt;\n                &lt;event&gt;\n                    &lt;event_datetimeGMT&gt;2015-08-21 09:50&lt;/event_datetimeGMT&gt;\n                    &lt;gamenumber&gt;483406220&lt;/gamenumber&gt;\n                    &lt;sporttype&gt;Aussie Rules&lt;/sporttype&gt;\n                    &lt;league&gt;AFL&lt;/league&gt;\n                    &lt;IsLive&gt;No&lt;/IsLive&gt;\n                    &lt;participants&gt;\n                        &lt;participant&gt;\n                            &lt;participant_name&gt;Hawthorn Hawks&lt;/participant_name&gt;\n                            &lt;contestantnum&gt;1251&lt;/contestantnum&gt;\n                            &lt;rotnum&gt;1251&lt;/rotnum&gt;\n                            &lt;visiting_home_draw&gt;Visiting&lt;/visiting_home_draw&gt;\n                        &lt;/participant&gt;\n                        &lt;participant&gt;\n                            &lt;participant_name&gt;Port Adelaide Power&lt;/participant_name&gt;\n                            &lt;contestantnum&gt;1252&lt;/contestantnum&gt;\n                            &lt;rotnum&gt;1252&lt;/rotnum&gt;\n                            &lt;visiting_home_draw&gt;Home&lt;/visiting_home_draw&gt;\n                        &lt;/participant&gt;\n                    &lt;/participants&gt;\n                    &lt;periods&gt;&lt;/periods&gt;\n                &lt;/event&gt;\n            &lt;/events&gt;\n        &lt;/pinnacle_line_feed&gt;\n    `\n\n    xmlReader := bytes.NewReader([]byte(pinny_xml))\n    yourPinnacleLineFeed := new(Pinnacle_Line_Feed)\n    if err := xml.NewDecoder(xmlReader).Decode(yourPinnacleLineFeed); err != nil {\n        log.Panic(err.Error())\n    }\n\n    printX(yourPinnacleLineFeed)\n}\n\nfunc printX(x interface{}) (err error) {\n    var xBytes []byte\n    xBytes, err = json.MarshalIndent(x, \"\", \"  \")\n    if err != nil {\n        return\n    }\n    fmt.Println(string(xBytes))\n    return\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 131, "user_id": 3803704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V1eKg.jpg?s=128&g=1", "display_name": "Jay Crumb", "link": "https://stackoverflow.com/users/3803704/jay-crumb"}, "is_accepted": false, "score": 1, "last_activity_date": 1440102381, "creation_date": 1440102381, "answer_id": 32127740, "question_id": 32125816, "link": "https://stackoverflow.com/questions/32125816/unmarshaling-xml-in-go/32127740#32127740", "title": "Unmarshaling XML in Go", "body": "<p>You need to uppercase all of the fields in your structs. The xml decoder needs the fields to be exported in order to work properly. Go playground <a href=\"http://play.golang.org/p/J7Ecoxuv76\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 43, "user_id": 4075678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496073aea7e52bf410efc39bcfb6a3b6?s=128&d=identicon&r=PG&f=1", "display_name": "amachure", "link": "https://stackoverflow.com/users/4075678/amachure"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1381, "favorite_count": 1, "accepted_answer_id": 32126528, "answer_count": 2, "score": 2, "last_activity_date": 1535453795, "creation_date": 1440095694, "last_edit_date": 1535453795, "question_id": 32125816, "link": "https://stackoverflow.com/questions/32125816/unmarshaling-xml-in-go", "title": "Unmarshaling XML in Go", "body": "<p>I have the following xml \"file\":</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;pinnacle_line_feed&gt;\r\n    &lt;PinnacleFeedTime&gt;1439954818555&lt;/PinnacleFeedTime&gt;\r\n    &lt;lastContest&gt;34317132&lt;/lastContest&gt;\r\n    &lt;lastGame&gt;218491030&lt;/lastGame&gt;\r\n    &lt;events&gt;\r\n        &lt;event&gt;\r\n            &lt;event_datetimeGMT&gt;2015-08-21 09:50&lt;/event_datetimeGMT&gt;\r\n            &lt;gamenumber&gt;483406220&lt;/gamenumber&gt;\r\n            &lt;sporttype&gt;Aussie Rules&lt;/sporttype&gt;\r\n            &lt;league&gt;AFL&lt;/league&gt;\r\n            &lt;IsLive&gt;No&lt;/IsLive&gt;\r\n            &lt;participants&gt;\r\n                &lt;participant&gt;\r\n                    &lt;participant_name&gt;Hawthorn Hawks&lt;/participant_name&gt;\r\n                    &lt;contestantnum&gt;1251&lt;/contestantnum&gt;\r\n                    &lt;rotnum&gt;1251&lt;/rotnum&gt;\r\n                    &lt;visiting_home_draw&gt;Visiting&lt;/visiting_home_draw&gt;\r\n                    &lt;/participant&gt;\r\n                &lt;participant&gt;\r\n                    &lt;participant_name&gt;Port Adelaide Power&lt;/participant_name&gt;\r\n                    &lt;contestantnum&gt;1252&lt;/contestantnum&gt;\r\n                    &lt;rotnum&gt;1252&lt;/rotnum&gt;\r\n                    &lt;visiting_home_draw&gt;Home&lt;/visiting_home_draw&gt;\r\n                &lt;/participant&gt;\r\n            &lt;/participants&gt;\r\n            &lt;periods&gt;&lt;/periods&gt;\r\n        &lt;/event&gt;\r\n    &lt;/events&gt;\r\n&lt;/pinnacle_line_feed&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I am attempting to parse this with Golang, and have written the below thus far:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>package main\r\nimport (\r\n\t\"fmt\"\r\n\t\"encoding/xml\"\r\n)\r\n\r\ntype Participant struct {\r\n\tXMLName            xml.Name `xml:\"participant\"`\r\n\tparticipant_name   string `xml:\"participant_name\"`\r\n\tcontestantnum      int `xml:\"contestantnum\"`\r\n\trotnum             int `xml:\"rotnum\"`\r\n\tvisiting_home_draw string `xml:\"visiting_home_draw\"`\r\n}\r\n\r\ntype Event struct {\r\n\tXMLName           xml.Name `xml:\"event\"`\r\n\tevent_datetimeGMT string `xml:\"event_datetimeGMT\"`\r\n\tgamenumber        string `xml:\"gamenumber\"`\r\n\tsporttype         string `xml:\"sporttype\"`\r\n\tleague            string `xml:\"league\"`\r\n\tIsLive            string `xml:\"IsLive\"`\r\n\tParticipant       []Participant `xml:\"participant\"`\r\n}\r\n\r\ntype Events struct {\r\n\tXMLName xml.Name `xml:\"events\"`\r\n\tEvent   []Event `xml:\"event\"`\r\n}\r\n\r\ntype Pinnacle_Line_Feed struct {\r\n\tXMLName          xml.Name `xml:\"pinnacle_line_feed\"`\r\n\tPinnacleFeedTime string `xml:\"PinnacleFeedTime\"`\r\n\tlastContest      string `xml:\"lastContest\"`\r\n\tlastGame         string `xml:\"lastGame\"`\r\n\tEvents           []Events `xml:\"events\"`\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Frankly, I have researched quite a bit on deep nested xml parsing in Golang, and I haven't found much to help with the Unmarshal portion of this code. Ideally, the code would return something similar to a python dictionary, such as, </p>\n\n<p>{event_datetimeGMT: 2015-08-21, gamenumber: 483406220, ... , visiting_home_draw: \"Home\"}</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Based on Nicolas's comment below, I added the following. This runs without error, but produces an empty result.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code> func main() {\r\n         pinny_xml := `\r\n         &lt;pinnacle_line_feed&gt;\r\n            &lt;PinnacleFeedTime&gt;1439954818555&lt;/PinnacleFeedTime&gt;\r\n            &lt;lastContest&gt;34317132&lt;/lastContest&gt;\r\n            &lt;lastGame&gt;218491030&lt;/lastGame&gt;\r\n            &lt;events&gt;\r\n                &lt;event&gt;\r\n                    &lt;event_datetimeGMT&gt;2015-08-21 09:50&lt;/event_datetimeGMT&gt;\r\n                    &lt;gamenumber&gt;483406220&lt;/gamenumber&gt;\r\n                    &lt;sporttype&gt;Aussie Rules&lt;/sporttype&gt;\r\n                    &lt;league&gt;AFL&lt;/league&gt;\r\n                    &lt;IsLive&gt;No&lt;/IsLive&gt;\r\n                    &lt;participants&gt;\r\n                        &lt;participant&gt;\r\n                            &lt;participant_name&gt;Hawthorn Hawks&lt;/participant_name&gt;\r\n                            &lt;contestantnum&gt;1251&lt;/contestantnum&gt;\r\n                            &lt;rotnum&gt;1251&lt;/rotnum&gt;\r\n                            &lt;visiting_home_draw&gt;Visiting&lt;/visiting_home_draw&gt;\r\n                            &lt;/participant&gt;\r\n                        &lt;participant&gt;\r\n                            &lt;participant_name&gt;Port Adelaide Power&lt;/participant_name&gt;\r\n                            &lt;contestantnum&gt;1252&lt;/contestantnum&gt;\r\n                            &lt;rotnum&gt;1252&lt;/rotnum&gt;\r\n                            &lt;visiting_home_draw&gt;Home&lt;/visiting_home_draw&gt;\r\n                        &lt;/participant&gt;\r\n                    &lt;/participants&gt;\r\n                    &lt;periods&gt;&lt;/periods&gt;\r\n                &lt;/event&gt;\r\n            &lt;/events&gt;\r\n        &lt;/pinnacle_line_feed&gt;\r\n        `\r\n\r\n        xmlReader := bytes.NewReader([]byte(pinny_xml))\r\n        yourPinnacleLineFeed := new(Pinnacle_Line_Feed)\r\n        if err := xml.NewDecoder(xmlReader).Decode(yourPinnacleLineFeed); err != nil {\r\n            return // or log.Panic(err.Error()) if in main\r\n        }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["sql-server", "database", "go"], "answers": [{"comments": [{"owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "edited": false, "score": 0, "creation_date": 1440159263, "post_id": 32129711, "comment_id": 52169617, "body": "That seems to work now; it was strange to me because I was using a &quot;test application&quot; while creating the package, and it used the same method of querying the database as the application I was actually using the package in but the application failed while the test application worked! Not sure how it knew the proper schema and database. I&#39;ll have to keep poking. Thanks!"}], "tags": [], "owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "is_accepted": true, "score": 3, "last_activity_date": 1440138441, "last_edit_date": 1440138441, "creation_date": 1440111025, "answer_id": 32129711, "question_id": 32125030, "link": "https://stackoverflow.com/questions/32125030/golang-mssql-driver-returns-mssql-invalid-object-name/32129711#32129711", "title": "Golang mssql driver returns &quot;mssql: Invalid object name&quot;", "body": "<blockquote>\n  <p>I checked the database and there is a database called MyDatabase with\n  a table called MyTable and the table has information in those three\n  columns...</p>\n</blockquote>\n\n<p>It seems like the driver is working just like it should. In order to query a table in SQL Server you should use <code>[Database].[Schema].[TableName]</code>. If you have not defined a particular schema name for your table then it will be created under the <code>dbo</code> schema by default.\nIn saying that you don't really need to specify the database name in your query. You rather define that on the connection string. I'm not sure how you have defined your connection details but have a look at the below and adapt accordingly to your needs.</p>\n\n<pre><code>var (\n    debug = flag.Bool(\"debug\", false, \"enable debugging\")\n    password = flag.String(\"password\", \"mypwd\", \"the database password\")\n    port *int = flag.Int(\"port\", 1433, \"the database port\")\n    server = flag.String(\"server\", \"MyServer\", \"the database server\")\n    user = flag.String(\"user\", \"MyUser\", \"the database user\")\n    connStr = fmt.Sprintf(\"server=%s;Initial Catalog=MySchema;userid=%s;password=%s;port=%d\", *server, *user, *password, *port)\n        )\n\n    func main() {\n        db, err := sql.Open(\"mssql\", connStr)\n    }\n</code></pre>\n\n<p>Then you can query your table like this:</p>\n\n<pre><code>rows, err := db.Query(\"SELECT source, timestamp, content FROM MySchema.MyTable\")\n</code></pre>\n"}], "owner": {"reputation": 2731, "user_id": 74361, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/adca63afb01fa2d56850114c337476fb?s=128&d=identicon&r=PG", "display_name": "Bart Silverstrim", "link": "https://stackoverflow.com/users/74361/bart-silverstrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1310, "favorite_count": 0, "accepted_answer_id": 32129711, "answer_count": 1, "score": 2, "last_activity_date": 1440138441, "creation_date": 1440093039, "question_id": 32125030, "link": "https://stackoverflow.com/questions/32125030/golang-mssql-driver-returns-mssql-invalid-object-name", "title": "Golang mssql driver returns &quot;mssql: Invalid object name&quot;", "body": "<p>In an application I have a globally scoped</p>\n\n<pre><code>var db *sql.DB\n</code></pre>\n\n<p>that is later called with</p>\n\n<pre><code>slcstrSource, slcint64Timestamp, slcstrContent, err := DB_functions.GetContent(db)\n            if err != nil {\n                 fmt.Println(\"Error: \" + err.Error())\n            }\n</code></pre>\n\n<p>GetContent is this:</p>\n\n<pre><code>func GetContent(db *sql.DB) ([]string, []int64, []string, error) {\n\n    var slcstrContent []string\n    var slcint64Timestamp []int64\n    var slcstrSource []string\n\n    // Run the query\n    rows, err := db.Query(\"SELECT source, timestamp, content FROM MyDatabase.MyTable\")\n    if err != nil {\n            return slcstrSource, slcint64Timestamp, slcstrContent, err\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n\n            // Holding variables for the content in the columns\n            var source, content string\n            var timestamp int64\n\n            // Get the results of the query\n            err := rows.Scan(&amp;source, &amp;timestamp, &amp;content)\n            if err != nil {\n                    return slcstrSource, slcint64Timestamp, slcstrContent, err\n            }\n\n            // Append them into the slices that will eventually be returned to the caller\n            slcstrSource = append(slcstrSource, source)\n            slcstrContent = append(slcstrContent, content)\n            slcint64Timestamp = append(slcint64Timestamp, timestamp)\n    }\n\n    return slcstrSource, slcint64Timestamp, slcstrContent, nil\n}\n</code></pre>\n\n<p>When I run the application and these sections of code are hit, I get an:</p>\n\n<pre><code>Error: mssql: Invalid object name 'MyDatabase.MyTable'.\n</code></pre>\n\n<p>When I db.Ping() the database, it seems to work. From what I've narrowed down the error is happening right at the query, but I can't find what's wrong. I checked the database and there is a database called MyDatabase with a table called MyTable and the table has information in those three columns...</p>\n\n<p>Is there something I'm missing before making the query, or in making the query? </p>\n"}, {"tags": ["go", "server-sent-events"], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "edited": false, "score": 0, "creation_date": 1440152477, "post_id": 32130752, "comment_id": 52165809, "body": "Thanks for your answer. My problemme is that the package i&#39;m using doesn&#39;t propose the ConsumerCount() function."}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 3, "last_activity_date": 1440118498, "creation_date": 1440118498, "answer_id": 32130752, "question_id": 32123546, "link": "https://stackoverflow.com/questions/32123546/eventsource-golang-how-to-detect-client-disconnection/32130752#32130752", "title": "Eventsource golang : how to detect client disconnection?", "body": "<p>You could check <code>ConsumersCount()</code>:</p>\n\n<pre><code>    go func() {\n        var id int\n        for es.ConsumersCount() &gt; 0 {\n            id++\n            es.SendEventMessage(\"blabla\", \"message\", strconv.Itoa(id))\n            time.Sleep(1 * time.Second)\n        }\n        fmt.Println(\"closed\")\n    }()\n</code></pre>\n\n<p>Kinda hacky, but it seems to work. </p>\n\n<p>You may be better off using a different package or rolling your own so you could have better control over the lifetime of your goroutines. You can detect a closed connection on <code>.Write</code> (which this package isn't exposing).  </p>\n\n<p>If you want here's an example chat server in TCP: <a href=\"https://github.com/golang-book/bootcamp-examples/blob/master/week2/day2/chat-server/main.go\" rel=\"nofollow\">chat-server</a>. \nAnd a video tutorial to go with it: <a href=\"https://youtu.be/cNxfgXrHeAg?t=5m48s\" rel=\"nofollow\">tutorial</a>. </p>\n\n<p>The same basic pattern should work for SSE.</p>\n"}, {"tags": [], "owner": {"reputation": 3381, "user_id": 183753, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/0f59545fe4b3d43c7e98710b0c17af9f?s=128&d=identicon&r=PG", "display_name": "Marconi", "link": "https://stackoverflow.com/users/183753/marconi"}, "is_accepted": false, "score": 6, "last_activity_date": 1458345084, "creation_date": 1458345084, "answer_id": 36096126, "question_id": 32123546, "link": "https://stackoverflow.com/questions/32123546/eventsource-golang-how-to-detect-client-disconnection/36096126#36096126", "title": "Eventsource golang : how to detect client disconnection?", "body": "<p>You can use <a href=\"https://golang.org/pkg/net/http/#CloseNotifier\" rel=\"noreferrer\">CloseNotifier</a> which lets you know if the underlying http connection has closed. Like:</p>\n\n<pre><code>notify := w.(http.CloseNotifier).CloseNotify()\ngo func() {\n    &lt;-notify\n    // connection close, do cleanup, etc.\n}()\n</code></pre>\n\n<p>HTH</p>\n"}, {"comments": [{"owner": {"reputation": 12784, "user_id": 1401034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vBXk9.png?s=128&g=1", "display_name": "Ewan", "link": "https://stackoverflow.com/users/1401034/ewan"}, "edited": false, "score": 0, "creation_date": 1564746383, "post_id": 53966322, "comment_id": 101141583, "body": "Do you have a complete example that fits in with the original question as I couldn&#39;t get this to work?  Thanks."}, {"owner": {"reputation": 645, "user_id": 186034, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6947a30c2c06632bf3ff1cd9e25acd97?s=128&d=identicon&r=PG", "display_name": "ymerej", "link": "https://stackoverflow.com/users/186034/ymerej"}, "edited": false, "score": 0, "creation_date": 1580427197, "post_id": 53966322, "comment_id": 106104231, "body": "@anderspitman Is there a way to differentiate between a graceful client disconnect versus an abrupt client disconnect using this?"}, {"owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "reply_to_user": {"reputation": 645, "user_id": 186034, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6947a30c2c06632bf3ff1cd9e25acd97?s=128&d=identicon&r=PG", "display_name": "ymerej", "link": "https://stackoverflow.com/users/186034/ymerej"}, "edited": false, "score": 1, "creation_date": 1580430576, "post_id": 53966322, "comment_id": 106104933, "body": "@ymerej not that I know of. Detecting TCP disconnects can actually be rather tricky."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1599256137, "post_id": 53966322, "comment_id": 112728832, "body": "no need for the <code>done</code> channel - just use <code>&lt;-req.Context().Done()</code> directly - and use <code>select</code> with <code>default</code> to do a non-blocking poll."}], "tags": [], "owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "is_accepted": false, "score": 8, "last_activity_date": 1561383968, "last_edit_date": 1561383968, "creation_date": 1546052093, "answer_id": 53966322, "question_id": 32123546, "link": "https://stackoverflow.com/questions/32123546/eventsource-golang-how-to-detect-client-disconnection/53966322#53966322", "title": "Eventsource golang : how to detect client disconnection?", "body": "<p>As of December 2018, <a href=\"https://golang.org/pkg/net/http/#CloseNotifier\" rel=\"noreferrer\">apparently CloseNotifier is deprecated</a>. The recommended solution is to use the <code>Request</code> Context. The following worked for me:</p>\n\n<pre><code>done := make(chan bool)\ngo func() {\n        &lt;-req.Context().Done()\n        done &lt;- true\n}()\n&lt;-done\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4034, "favorite_count": 3, "answer_count": 3, "score": 13, "last_activity_date": 1561383968, "creation_date": 1440088050, "last_edit_date": 1442938862, "question_id": 32123546, "link": "https://stackoverflow.com/questions/32123546/eventsource-golang-how-to-detect-client-disconnection", "title": "Eventsource golang : how to detect client disconnection?", "body": "<p>I'm developing chat rooms based on Twitter hashtag with Server sent events, with the package <a href=\"https://github.com/antage/eventsource\" rel=\"noreferrer\">https://github.com/antage/eventsource</a></p>\n\n<p>I have a problem concerning the disconnection of the client. I run a goroutine to send messages to the client, but when the client disconnects, the goroutine still runs.</p>\n\n<p>I don't know how to detect on the server side that the client is disconnected.</p>\n\n<pre><code>func (sh StreamHandler) ServeHTTP(resp http.ResponseWriter, req *http.Request) {\n\n    es := eventsource.New(\n        &amp;eventsource.Settings{\n            Timeout:        2 * time.Second,\n            CloseOnTimeout: true,\n            IdleTimeout:    2 * time.Second,\n            Gzip:           true,\n        },\n        func(req *http.Request) [][]byte {\n            return [][]byte{\n                []byte(\"X-Accel-Buffering: no\"),\n                []byte(\"Access-Control-Allow-Origin: *\"),\n            }\n        },\n    )\n\n    es.ServeHTTP(resp, req)\n\n    go func() {\n        var id int\n        for {\n            id++\n            time.Sleep(1 * time.Second)\n            es.SendEventMessage(\"blabla\", \"message\", strconv.Itoa(id))\n        }\n    }()\n\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1440087176, "post_id": 32122902, "comment_id": 52138621, "body": "Where is this json coming from? Do you really have no control over it? The empty key is just asking for trouble. I would recommend just making UnknownDevices an array instead of an object."}, {"owner": {"reputation": 54458, "user_id": 722762, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/TpESY.png?s=128&g=1", "display_name": "Halcyon", "link": "https://stackoverflow.com/users/722762/halcyon"}, "edited": false, "score": 0, "creation_date": 1440087249, "post_id": 32122902, "comment_id": 52138654, "body": "An empty string is a valid key in JSON. Make sure your marshalling method is lossless. Also, in the sample code the empty key is <code>devices</code> instead. Why?"}, {"owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 0, "creation_date": 1440087403, "post_id": 32122902, "comment_id": 52138732, "body": "In your sample code you have key <code>devices</code>, so you just need to add tag, try this: <a href=\"https://play.golang.org/p/dACrsAkadN\" rel=\"nofollow noreferrer\">play.golang.org/p/dACrsAkadN</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "edited": false, "score": 1, "creation_date": 1440087558, "post_id": 32122902, "comment_id": 52138829, "body": "@RoninDev I am asssuming he is stuck with the empty key in the json. If he can change the json it is easy. Unfortunately, it looks to me like <code>encoding&#47;json</code> can marshall empty keys, but for some reason won&#39;t unmarshal them. See <a href=\"https://play.golang.org/p/ut5D5bR16l\" rel=\"nofollow noreferrer\">play.golang.org/p/ut5D5bR16l</a> EDIT: It won&#39;t marshal them either."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440087573, "post_id": 32122902, "comment_id": 52138839, "body": "Some (now deleted) answers changed the type of the <code>Udevices</code> field. Instead you can implement <code>json.Unmarshaller</code> like so: <a href=\"https://play.golang.org/p/_TMi53hJ3o\" rel=\"nofollow noreferrer\">play.golang.org/p/_TMi53hJ3o</a> (you can also implement a custom marshaller). There may be better solutions."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440087661, "post_id": 32122902, "comment_id": 52138889, "body": "@DaveC I think the custom marshaller is the correct answer. You should make an answer of that."}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1440087767, "post_id": 32122902, "comment_id": 52138952, "body": "@captncraig unfortunately i have no control on the json, that is the json i am receiving from one of the website. And i  have to parse the json for the device id&#39;s"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1440087826, "post_id": 32122902, "comment_id": 52138980, "body": "@GirishSatyanarayana It would probably be fragile, but if the json is consistent a simple strings.Replace may be able to preprocess it for you to add a key?"}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440088095, "post_id": 32122902, "comment_id": 52139118, "body": "Trying the custom marshaller as mentioned by @DaveC."}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "edited": false, "score": 0, "creation_date": 1440090336, "post_id": 32122902, "comment_id": 52140230, "body": "Sorry folks i might be sounding dumb here, i am relatively new so thanks for your patience. when i am trying the custom marshaller as mentioned above i am finding something very funny"}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440090396, "post_id": 32122902, "comment_id": 52140261, "body": "if the input is as pointed out by @DaveC it works but if the input is in a single line like   <code>{&quot;status_code&quot;:200,&quot;status_message&quot;:&quot;OK&quot;,&quot;response&quot;:{&quot;Messag&zwnj;&#8203;es&quot;:[&quot;CODE_NOT_AVAIL&zwnj;&#8203;ABLE&quot;],&quot;UnknownDevic&zwnj;&#8203;es&quot;:{&quot;devices&quot;:[&quot;6&quot;,&zwnj;&#8203;&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;]}}}</code>  it does not seem to parse  <a href=\"http://play.golang.org/p/Zwc9kQBQN9\" rel=\"nofollow noreferrer\">play.golang.org/p/Zwc9kQBQN9</a>  what am i missing here. thanks in advance"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440090567, "post_id": 32122902, "comment_id": 52140358, "body": "@GirishSatyanarayana That&#39;s completely different JSON from what you asked about. If you want something that parses/handles X and Y you need to write something that can parse X or Y."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "edited": false, "score": 0, "creation_date": 1440090518, "post_id": 32123568, "comment_id": 52140328, "body": "When i am trying something like this  <a href=\"http://play.golang.org/p/Zwc9kQBQN9\" rel=\"nofollow noreferrer\">play.golang.org/p/Zwc9kQBQN9</a>  it does not work, however, the following works, can what am i missing play.golang.org/p/ut5D5bR16l"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "edited": false, "score": 0, "creation_date": 1440090662, "post_id": 32123568, "comment_id": 52140398, "body": "You&#39;ve changed the structure of the JSON so you need to adjust the unmarshalling to handle that. Your question was about unmarshalling <code>&quot;&quot;: \u2026</code>"}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "edited": false, "score": 0, "creation_date": 1440091007, "post_id": 32123568, "comment_id": 52140565, "body": "oh ok got it. The reason is I am getting the json as string, so i cannot change it and need to parse it. Sure let me see how i can adjust the unmarshall thanks a lot @Dave"}, {"owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "edited": false, "score": 0, "creation_date": 1440091052, "post_id": 32123568, "comment_id": 52140585, "body": "Also sorry i sent the wrong code.   <a href=\"http://play.golang.org/p/zmGeFE8o0V\" rel=\"nofollow noreferrer\">play.golang.org/p/zmGeFE8o0V</a>  the input looks this way. sorry for the confusion"}, {"owner": {"reputation": 282, "user_id": 3163732, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/1522365429/picture?type=large", "display_name": "Raul H", "link": "https://stackoverflow.com/users/3163732/raul-h"}, "edited": false, "score": 0, "creation_date": 1517843142, "post_id": 32123568, "comment_id": 84247776, "body": "What if is only an empty array of strings the &quot;json&quot; response I get how to unmarshall something like this       [         &quot;some&quot;,         &quot;som2&quot;,         &quot;som3&quot;     ]"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 5, "last_activity_date": 1440088128, "creation_date": 1440088128, "answer_id": 32123568, "question_id": 32122902, "link": "https://stackoverflow.com/questions/32122902/parsing-json-without-index-name-in-golang/32123568#32123568", "title": "Parsing json without index name in golang", "body": "<p>There may be other options, but whenever you see strange JSON you can always fall back to implementing your own custom (un)marshalling by implementing <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"noreferrer\"><code>json.Unmarshaler</code></a> and/or <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"noreferrer\"><code>json.Marshaler</code></a>.</p>\n\n<p>Perhaps something like:</p>\n\n<pre><code>type devices struct {\n    Udevices []string\n}\n\nfunc (d *devices) UnmarshalJSON(b []byte) error {\n    var x map[string][]string\n    err := json.Unmarshal(b, &amp;x)\n    if err == nil {\n        // perhaps check that only a single\n        // key exists in the map as well\n        d.Udevices = x[\"\"]\n    }\n    return err\n}\n\nfunc (d devices) MarshalJSON() ([]byte, error) {\n    x := map[string][]string{\"\": d.Udevices}\n    return json.Marshal(x)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O8Hva-IJ51\" rel=\"noreferrer\"><kbd>Playground</kbd></a></p>\n"}], "owner": {"reputation": 53, "user_id": 5040436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9369bc187313efe7522b68fd3bf2920f?s=128&d=identicon&r=PG&f=1", "display_name": "Girish Satyanarayana", "link": "https://stackoverflow.com/users/5040436/girish-satyanarayana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1535, "favorite_count": 0, "accepted_answer_id": 32123568, "answer_count": 1, "score": 3, "last_activity_date": 1440119043, "creation_date": 1440086123, "last_edit_date": 1440119043, "question_id": 32122902, "link": "https://stackoverflow.com/questions/32122902/parsing-json-without-index-name-in-golang", "title": "Parsing json without index name in golang", "body": "<p>I have a json in the following format</p>\n\n<pre><code>{\n    \"status_code\": 200,\n    \"status_message\": \"OK\",\n    \"response\": {\n        \"Messages\": [\n            \"CODE_NOT_AVAILABLE\"\n        ],\n        \"UnknownDevices\": {\n            \"\": [\n                \"6\",\n                \"7\",\n                \"8\",\n                \"9\",\n                \"10\"\n            ]\n        }\n    }\n}\n</code></pre>\n\n<p>As we see we are missing one index key, after unknownDevices, i am trying to unmarshal this json using golan in the following way</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype pushWooshResponse struct {\n    Status     int    `json:\"status_code\"`\n    Status_msg string `json:\"status_message\"`\n    Response   response\n}\n\ntype response struct {\n    Message        []string `json:\"Messages\"`\n    UnknownDevices devices\n}\n\ntype devices struct {\n    Udevices []string `json:\"\"`\n}\n\nfunc main() {\n    itemInfoR := `{\"status_code\":200,\"status_message\":\"OK\",\"response\":{\"Messages\":[\"CODE_NOT_AVAILABLE\"],\"UnknownDevices\":{\"devices\":[\"6\",\"7\",\"8\",\"9\",\"10\"]}}}`\n    itemInfoBytes := []byte(itemInfoR)\n    var ItemInfo pushWooshResponse\n    er := json.Unmarshal(itemInfoBytes, &amp;ItemInfo)\n    if er != nil {\n        fmt.Println(\"Error\", er.Error())\n    } else {\n        fmt.Println(ItemInfo)\n    }\n}\n</code></pre>\n\n<p>Output is </p>\n\n<pre><code>{200 OK {[CODE_NOT_AVAILABLE] {[]}}}\n</code></pre>\n\n<p>Everything is working fine except for the last part, which i am not able to unmarshall this. Can you help me out to umarshal the last part of the json.</p>\n"}, {"tags": ["c", "go", "build", "compilation"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 1405695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iChib.jpg?s=128&g=1", "display_name": "JohnGalt", "link": "https://stackoverflow.com/users/1405695/johngalt"}, "edited": false, "score": 1, "creation_date": 1454853963, "post_id": 32115271, "comment_id": 58221303, "body": "Thanks a lot. This solved my problems too.  I had two imports of &quot;imports runtime&quot; and tried everything - I even removed code that I added because I didn&#39;t expect that a upgrade from go1.4 to go1.5 could have caused this."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1469854110, "post_id": 32115271, "comment_id": 64721581, "body": "Could you explain a little more @deFreitas"}, {"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1469854785, "post_id": 32115271, "comment_id": 64721695, "body": "@MayankPatel Even after run as you suggest and installing <code>golang 1.6.2</code> I still getting <code>C source files not allowed when not using cgo or SWIG</code> the error example is <a href=\"https://github.com/mageddo/go-examples/tree/master/id\" rel=\"nofollow noreferrer\">here</a>. my CGO_ENABLED=&quot;1&quot; env is enabled and gcc installed but simply no work"}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1469867068, "post_id": 32115271, "comment_id": 64724066, "body": "There can be many reason for getting this error. Make sure correct version (32/64 bit) of gcc is installed. Try Adding a new file in the package and importing C package in it. something like package p import &quot;C&quot; @deFreitas"}, {"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1469891599, "post_id": 32115271, "comment_id": 64730549, "body": "@MayankPatel By the code <a href=\"https://github.com/davecheney/junk/issues/2#issuecomment-236319172\" rel=\"nofollow noreferrer\">author comment</a> apparently that is a deprecated code style for the new golang compiles"}], "tags": [], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "is_accepted": true, "score": 55, "last_activity_date": 1500748644, "last_edit_date": 1500748644, "creation_date": 1440064993, "answer_id": 32115271, "question_id": 32115229, "link": "https://stackoverflow.com/questions/32115229/go-1-5-error-imports-runtime-c-source-files-not-allowed-when-not-using-cgo/32115271#32115271", "title": "Go 1.5+ : Error - imports runtime: C source files not allowed when not using cgo or SWIG", "body": "<blockquote>\n  <p>Remove Old 1.4.x go installation and then install go 1.5.</p>\n</blockquote>\n\n<p>I faced the same problem after installing go 1.5. The issue is that I installed go 1.5 at the same place of 1.4.2. Go 1.5 does not use C anymore and if old C installation files are present it throws the error as you are shown.</p>\n\n<p>if you want the old installation to be present as well then install 1.5 to some other location and set GOROOT to that location.</p>\n\n<p>Hope it helps.</p>\n\n<p><strong>Edit 1: For Linux Users:</strong></p>\n\n<p>if you downloaded go1.5*.tar.gz then you did this: </p>\n\n<blockquote>\n  <p>tar -C /usr/local/ -xvf go1.5.linux-amd64.tar.gz</p>\n</blockquote>\n\n<p>Your old folder C files are not deleted, so the correct process is: </p>\n\n<p>First: You should delete you old go folder.</p>\n\n<blockquote>\n  <p>sudo rm -rf /usr/local/go/</p>\n</blockquote>\n\n<p>Second: Then run  </p>\n\n<blockquote>\n  <p>tar -C /usr/local/ -xvf go1.5.x.linux-amd64.tar.gz</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1440691860, "post_id": 32240332, "comment_id": 52389022, "body": "Although cleaning out <code>$GOPATH&#47;pkg</code> can be helpful (it&#39;s not strictly required as <code>go build</code> and <code>go install</code> should just recognize the contents as stale and re-build things as required) it is unrelated to the OP&#39;s issue which was having old <code>*.c</code> source files from Go1.4 left in <code>$GOROOT&#47;src</code>. You should never install a new verion of Go over-top a previous installation but into a fresh location (i.e. move/delete the old installation first)."}, {"owner": {"reputation": 144, "user_id": 200778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91750b5204b8aeeceb6e9621386f7422?s=128&d=identicon&r=PG", "display_name": "user200778", "link": "https://stackoverflow.com/users/200778/user200778"}, "edited": false, "score": 0, "creation_date": 1441095266, "post_id": 32240332, "comment_id": 52527755, "body": "I can&#39;t use go1.4.2, (because I need to import encoding/json), what can I resolve this problem in go1.5?"}, {"owner": {"reputation": 305, "user_id": 382775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a05c691ed1349d80fbd2aed10a043d9a?s=128&d=identicon&r=PG", "display_name": "dmikalova", "link": "https://stackoverflow.com/users/382775/dmikalova"}, "edited": false, "score": 0, "creation_date": 1441760940, "post_id": 32240332, "comment_id": 52800683, "body": "This just happened to me with brew - it does indeed install to different folders, but for some reason the go tool uses the old install until I start a new terminal session. Reloading the terminal fixes the issue."}, {"owner": {"reputation": 1162, "user_id": 1316907, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vl9Qn.jpg?s=128&g=1", "display_name": "Evan Lin", "link": "https://stackoverflow.com/users/1316907/evan-lin"}, "reply_to_user": {"reputation": 305, "user_id": 382775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a05c691ed1349d80fbd2aed10a043d9a?s=128&d=identicon&r=PG", "display_name": "dmikalova", "link": "https://stackoverflow.com/users/382775/dmikalova"}, "edited": false, "score": 0, "creation_date": 1441761187, "post_id": 32240332, "comment_id": 52800731, "body": "@dmikalova Yes, thats&#39;s what I mean. I just edit my answer for that. Reloading terminal(console) session."}], "tags": [], "owner": {"reputation": 1162, "user_id": 1316907, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/vl9Qn.jpg?s=128&g=1", "display_name": "Evan Lin", "link": "https://stackoverflow.com/users/1316907/evan-lin"}, "is_accepted": false, "score": 5, "last_activity_date": 1441761121, "last_edit_date": 1441761121, "creation_date": 1440647019, "answer_id": 32240332, "question_id": 32115229, "link": "https://stackoverflow.com/questions/32115229/go-1-5-error-imports-runtime-c-source-files-not-allowed-when-not-using-cgo/32240332#32240332", "title": "Go 1.5+ : Error - imports runtime: C source files not allowed when not using cgo or SWIG", "body": "<p>If you use <code>brew</code> to upgrade your go to Go 1.5.  Here is my step to make it work:</p>\n\n<ol>\n<li>Remove pkg folder in %GOPATH%</li>\n<li>Reload terminal(console) session, make sure <code>Go env</code> goes to Go 1.5 folder.</li>\n</ol>\n\n<p>BTW: You need do the same thing if you want to switch from Go 1.5 back Go 1.4.2 via <code>brew switch go 1.4.2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 729, "user_id": 2737876, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/4ed49a00e66b2cbd39e55212cb2d70f2?s=128&d=identicon&r=PG&f=1", "display_name": "user2737876", "link": "https://stackoverflow.com/users/2737876/user2737876"}, "is_accepted": false, "score": 0, "last_activity_date": 1441436851, "creation_date": 1441436851, "answer_id": 32410475, "question_id": 32115229, "link": "https://stackoverflow.com/questions/32115229/go-1-5-error-imports-runtime-c-source-files-not-allowed-when-not-using-cgo/32410475#32410475", "title": "Go 1.5+ : Error - imports runtime: C source files not allowed when not using cgo or SWIG", "body": "<p>I experienced this issue within my editor (sublime text 2). I call go build upon saving, it would appear my editor was pointing to go 1.4.x rather than the newly installed 1.5. </p>\n\n<ul>\n<li>I solved this by simply quitting and reopening my editor. </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 630195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40d8191a1fff4ed9b649b21d4adc2ec7?s=128&d=identicon&r=PG", "display_name": "RoCry", "link": "https://stackoverflow.com/users/630195/rocry"}, "is_accepted": false, "score": 2, "last_activity_date": 1444715747, "creation_date": 1444715747, "answer_id": 33095123, "question_id": 32115229, "link": "https://stackoverflow.com/questions/32115229/go-1-5-error-imports-runtime-c-source-files-not-allowed-when-not-using-cgo/33095123#33095123", "title": "Go 1.5+ : Error - imports runtime: C source files not allowed when not using cgo or SWIG", "body": "<p>I have the same problem because I installed two version of golang on my machine, one from offical site and the other is from homebrew.</p>\n\n<p>And the GOROOT isn't match the go binary, I just replace the GOROOT with the right one, then done.</p>\n\n<pre><code>export GOROOT=/usr/local/opt/go/libexec # install via brew\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 3094829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed9627215060e17cfeaab1a80b7ab53?s=128&d=identicon&r=PG&f=1", "display_name": "user3094829", "link": "https://stackoverflow.com/users/3094829/user3094829"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9501, "favorite_count": 4, "accepted_answer_id": 32115271, "answer_count": 4, "score": 20, "last_activity_date": 1500748644, "creation_date": 1440064899, "last_edit_date": 1454495065, "question_id": 32115229, "link": "https://stackoverflow.com/questions/32115229/go-1-5-error-imports-runtime-c-source-files-not-allowed-when-not-using-cgo", "title": "Go 1.5+ : Error - imports runtime: C source files not allowed when not using cgo or SWIG", "body": "<p>My program was building perfectly with go 1.4.2. After installing go 1.5, I am getting following error.</p>\n\n<blockquote>\n  <p>imports runtime: C source files not allowed when not using cgo or\n  SWIG: atomic_amd64x.c defs.c float.c heapdump.c lfstack.c malloc.c\n  mcache.c mcentral.c mem_linux.c mfixalloc.c mgc0.c mheap.c msize.c\n  os_linux.c panic.c parfor.c proc.c runtime.c signal.c signal_amd64x.c\n  signal_unix.c stack.c string.c sys_x86.c vdso_linux_amd64.c</p>\n</blockquote>\n\n<p>The error is not program dependent. Even a \"Hello world\" programs is throwing the same error.</p>\n"}, {"tags": ["go", "dependencies"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 2, "creation_date": 1440064637, "post_id": 32115109, "comment_id": 52122959, "body": "What do you mean by &quot;not available in other files&quot;? Are you using <code>go run</code>?"}, {"owner": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1440064841, "post_id": 32115109, "comment_id": 52123120, "body": "I&#39;m using &quot;go build&quot;"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1440066401, "post_id": 32115109, "comment_id": 52124153, "body": "How do you invoke <code>go build</code>? What errors are you getting? Add this to your question."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "edited": false, "score": 2, "creation_date": 1440069808, "post_id": 32116602, "comment_id": 52126276, "body": "I see, but is it the same instance of Log? If I configure (i.e., setting log format) Log in main.go, will the changes also work for Log.*  calls in cache.go?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "edited": false, "score": 0, "creation_date": 1440070450, "post_id": 32116602, "comment_id": 52126726, "body": "Yes, it should be the same."}, {"owner": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "edited": false, "score": 0, "creation_date": 1440075022, "post_id": 32116602, "comment_id": 52129833, "body": "Wow, you&#39;re right, setting log formatter in main.go, does influence it&#39;s behavior in other packages as well. I didn&#39;t expect this to work. Is there any doc or reference what would explain this behavior?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "edited": false, "score": 0, "creation_date": 1440077773, "post_id": 32116602, "comment_id": 52131925, "body": "See <a href=\"http://golang.org/ref/spec#Package_initialization\" rel=\"nofollow noreferrer\">the Go Language Specification on package initialization</a>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 3, "last_activity_date": 1440068817, "creation_date": 1440068817, "answer_id": 32116602, "question_id": 32115109, "link": "https://stackoverflow.com/questions/32115109/how-can-i-access-my-log-instance-from-other-files/32116602#32116602", "title": "How can I access my log instance from other files", "body": "<p>You need to add packages you use into the import section of <em>every</em> file that's using the package. So in your <code>cache.go</code>, write</p>\n\n<pre><code>import  (\n    \"github.com/bradfitz/gomemcache/memcache\"\n    Log \"github.com/Sirupsen/logrus\"\n    // List all packages mentioned in cache.go.\n)\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 1910754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8bbae6c9d075819002ba6128dc932c6?s=128&d=identicon&r=PG", "display_name": "Matrix", "link": "https://stackoverflow.com/users/1910754/matrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 32116602, "answer_count": 1, "score": -3, "last_activity_date": 1440068817, "creation_date": 1440064550, "last_edit_date": 1440067170, "question_id": 32115109, "link": "https://stackoverflow.com/questions/32115109/how-can-i-access-my-log-instance-from-other-files", "title": "How can I access my log instance from other files", "body": "<p>I've recently started learning Go and when I decided to put my code in more than 1 file (main.go), a problem emerged. None of the commonly used stuff like log, cache, config, metrics, etc, that I often need are available in other files, even though it belongs to the same \"package main\". I want to configure my log instance (logrus package) once, based on data from config (viper package). And this is just the beginning, I will soon have a DB instance(?), Cache instance, etc.</p>\n\n<p>What's the best way to solve my problem, what's the best Go practice? How can I follow DRY principle?</p>\n\n<p>If I put my initial log setup into \"mylog\" package and then import it in each file of each package, how many mylog instances will there be? One for each file/package/? ? Is it efficient?</p>\n\n<p>Also Log and Config depend on each other. I need to log config errors and I need the config to configure the log.</p>\n\n<pre><code>user@host:~/dev/go/src/helloworld$ go build &amp;&amp; ./helloworld  \n# helloworld\n./cache.go:10: undefined: Log\n./cache.go:17: undefined: Log\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n    \"github.com/julienschmidt/httprouter\"\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    // \"github.com/gin-gonic/gin\"\n    \"net\"\n    \"net/http\"\n    Log \"github.com/Sirupsen/logrus\"\n    // \"io/ioutil\"\n    \"encoding/json\"\n    \"encoding/hex\"\n    \"encoding/base64\"\n    \"golang.org/x/crypto/bcrypt\"\n    \"github.com/asaskevich/govalidator\"\n    \"gopkg.in/gomail.v2-unstable\"\n    \"github.com/spf13/viper\"\n)\n.\n.\n.\n</code></pre>\n\n<p>cache.go:</p>\n\n<pre><code>package main\n\nimport  (\n    \"github.com/bradfitz/gomemcache/memcache\"\n)\n\nvar conn = memcache.New(\"10.1.11.1:11211\")\n\nfunc Set(key string, value []byte, ttl int32) error {\n    Log.Info(\"Cache: Set: key: \" + key)\n    err := conn.Set(&amp;memcache.Item{Key: key, Value: value, Expiration: ttl})\n    // fmt.Println(err)\n    return err\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1440074777, "post_id": 32114128, "comment_id": 52129636, "body": "I suggest you to ask on the <a href=\"https://groups.google.com/forum/#!forum/golang-nuts\" rel=\"nofollow noreferrer\">mailing list</a> instead because the latter is read by the <code>gccgo</code> maintainer (Ian Taylor) which doesn&#39;t frequent SO."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440083569, "post_id": 32114128, "comment_id": 52136322, "body": "Assuming steps #1 and #2 are a non-main package and that step #2 is <code>go install</code> \u2026 you do realize that step #1 just does a build and then throws away the results? You&#39;d need to put any flags with the <code>go install</code> of step #2."}, {"owner": {"reputation": 31, "user_id": 993218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3cb6e8e142271ca57aebfe5a111245?s=128&d=identicon&r=PG", "display_name": "avd", "link": "https://stackoverflow.com/users/993218/avd"}, "edited": false, "score": 0, "creation_date": 1440092753, "post_id": 32114128, "comment_id": 52141522, "body": "In fact, the same happens if I combine steps #1 and #2: <code>go install --buildmode=shared -linkshared</code>  In that case <code>go build -linkshared</code> produces the same result."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 993218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3cb6e8e142271ca57aebfe5a111245?s=128&d=identicon&r=PG", "display_name": "avd", "link": "https://stackoverflow.com/users/993218/avd"}, "is_accepted": true, "score": 0, "last_activity_date": 1440170206, "creation_date": 1440170206, "answer_id": 32143928, "question_id": 32114128, "link": "https://stackoverflow.com/questions/32114128/go-v-1-5-with-linkshared-option-produces-linking-error/32143928#32143928", "title": "Go v 1.5 with -linkshared option produces linking error", "body": "<p><a href=\"https://github.com/golang/go/issues/12236/\" rel=\"nofollow\">Here</a> is a bug on github. It turned out that go tool generated wrong names.</p>\n"}], "owner": {"reputation": 31, "user_id": 993218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f3cb6e8e142271ca57aebfe5a111245?s=128&d=identicon&r=PG", "display_name": "avd", "link": "https://stackoverflow.com/users/993218/avd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 32143928, "answer_count": 1, "score": 1, "last_activity_date": 1440170206, "creation_date": 1440061816, "question_id": 32114128, "link": "https://stackoverflow.com/questions/32114128/go-v-1-5-with-linkshared-option-produces-linking-error", "title": "Go v 1.5 with -linkshared option produces linking error", "body": "<p>Go v 1.5.</p>\n\n<p>1) Compile the package worker:</p>\n\n<pre><code>go build -buildmode=shared -linkshared\n</code></pre>\n\n<p>2) Install this package</p>\n\n<p>3) Try to compile another package, which imports worker:</p>\n\n<pre><code>go build -linkshared\ngo/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\ngcc: error: missing argument to \u2018-l\u2019\n</code></pre>\n\n<p>The same command with '<strong>-x --compiler=gccgo</strong>' option produces the following:</p>\n\n<pre><code>/usr/bin/gccgo -o $WORK/godev/testgo/_obj/exe/a.out $WORK/godev/testgo/_obj/_go_.o -Wl,-( -m64 -Wl,-) -L/home/user/dev/godev/pkg/gccgo_linux_amd64_fPIC/shlibs -Wl,-rpath=/home/user/dev/godev/pkg/gccgo_linux_amd64_fPIC/shlibs -l -Wl,-E -fPIC\n</code></pre>\n"}, {"tags": ["reflection", "go", "interface"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1440084436, "post_id": 32113597, "comment_id": 52136915, "body": "editing your &quot;fixed&quot; [0] link to make it work <a href=\"https://play.golang.org/p/zjPUT_POF-\" rel=\"nofollow noreferrer\">play.golang.org/p/zjPUT_POF-</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 3, "creation_date": 1440084202, "post_id": 32114853, "comment_id": 52136744, "body": "What&#39;s wrong with just doing <code>_, ok := x.(io.Reader)</code>? Then <code>ok</code> is true if <code>x</code> implements <code>io.Reader</code> and false otherwise."}], "tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 8, "last_activity_date": 1440064758, "last_edit_date": 1440064758, "creation_date": 1440063826, "answer_id": 32114853, "question_id": 32113597, "link": "https://stackoverflow.com/questions/32113597/checking-of-variable-implements-interface-without-compiling/32114853#32114853", "title": "Checking of variable implements interface without compiling", "body": "<p>It is perfectly possible to do what you want with the reflect package. Here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"reflect\"\n)\n\ntype Other int\n\ntype MyPoint struct {\n    X, Y int\n}\n\nfunc (pnt *MyPoint) Read(p []byte) (n int, err error) {\n    return 42, nil\n}\n\nfunc check(x interface{}) bool {\n    // Declare a type object representing io.Reader\n    reader := reflect.TypeOf((*io.Reader)(nil)).Elem()\n    // Get a type object of the pointer on the object represented by the parameter\n    // and see if it implements io.Reader\n    return reflect.PtrTo(reflect.TypeOf(x)).Implements(reader)\n}\n\nfunc main() {\n\n    x := MyPoint{0, 0}\n    y := Other(1)\n\n    fmt.Println(check(x)) // true\n    fmt.Println(check(y)) // false\n}\n</code></pre>\n\n<p>The tricky point is to pay attention to how pointers are handled.</p>\n"}, {"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 5, "last_activity_date": 1440065550, "creation_date": 1440065550, "answer_id": 32115490, "question_id": 32113597, "link": "https://stackoverflow.com/questions/32113597/checking-of-variable-implements-interface-without-compiling/32115490#32115490", "title": "Checking of variable implements interface without compiling", "body": "<blockquote>\n  <p>Exists one solution to check whether p implements the interface without compiling?</p>\n</blockquote>\n\n<p>Yes: Careful reading of the code :-)</p>\n\n<p>How could that be possible? p implements some interface i if the method set of p covers i. You will always have to compile the code.</p>\n\n<p>I assume you want to fail not during compilation but just print during runtime.\nThe trick is getting a non-nil interface type which can be tested with the <code>Implements</code> method of <code>reflect.Type</code>:</p>\n\n<pre><code>pt := reflect.TypeOf(&amp;MyPoint{})\nioReaderType := reflect.TypeOf((*io.Reader)(nil)).Elem()\nfmt.Println(pt.Implements(ioReaderType))  //  ==&gt; true\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/2Qcpfjm4ft\" rel=\"noreferrer\">http://play.golang.org/p/2Qcpfjm4ft</a></p>\n"}], "owner": {"reputation": 43, "user_id": 5246553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda652c94bcbce1136931d168a4376d0?s=128&d=identicon&r=PG&f=1", "display_name": "wak", "link": "https://stackoverflow.com/users/5246553/wak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3167, "favorite_count": 0, "accepted_answer_id": 32114853, "answer_count": 2, "score": 4, "last_activity_date": 1440071765, "creation_date": 1440060344, "last_edit_date": 1495541336, "question_id": 32113597, "link": "https://stackoverflow.com/questions/32113597/checking-of-variable-implements-interface-without-compiling", "title": "Checking of variable implements interface without compiling", "body": "<p>I want to know whether a concrete type implements a specefic interface and print it out.\nI have written an example [0] with a self defined struct (MyPoint) beeing not an interface-type. MyPoint has the function Read as defined in the interface of io.Reader:</p>\n\n<pre><code>type MyPoint struct {\n   X, Y int\n}\n\nfunc (pnt *MyPoint) Read(p []byte) (n int, err error) {\n    return 42, nil\n}\n</code></pre>\n\n<p>The aim is to get the information that the concrete type p implements the interface io.Writer.\nTherefore I have written a short main trieng to get a true for the check.</p>\n\n<pre><code>func main() {\n     p := MyPoint{1, 2}\n}\n</code></pre>\n\n<p>The first idea was to check it with the help of reflection and a type-switch and adding <code>check(p)</code> to to the main-function. </p>\n\n<pre><code>func checkType(tst interface{}) {\n    switch tst.(type) {\n    case nil:\n        fmt.Printf(\"nil\")\n    case *io.Reader:\n        fmt.Printf(\"p is of type io.Reader\\n\")\n    case MyPoint:\n        fmt.Printf(\"p is of type MyPoint\\n\")\n    default:\n        fmt.Println(\"p is unknown.\")\n    }\n}\n</code></pre>\n\n<p>The output is: <code>p is of type MyPoint</code>. After a bit of research I know that I should have expected that because Go's types are static and therefore the type of p is MyPoint and not io.Reader. In addition to that io.Reader is an interface-type which is different to type MyPoint.</p>\n\n<p>I found one solution e.g. at [1] which checks whether MyPoint can be an io.Reader at compile time. It works. </p>\n\n<pre><code>var _ io.Reader = (*MyPoint)(nil)\n</code></pre>\n\n<p>But that isn't the solution I wanted. Tries like below fails, too. I think it's because of the reason above, isn't it?</p>\n\n<pre><code>i := interface{}(new(MyPoint))\n    if _, ok := i.(io.Reader); ok {\n        fmt.Println(\"i is an io.Reader\")\n}\npType := reflect.TypeOf(p)\nif _, ok := pType.(io.Reader); ok {\n    fmt.Println(\"The type of p is compatible to io.Reader\")\n}\n\nreaderType := reflect.TypeOf((*io.Reader)(nil)).Elem()\nfmt.Printf(\"p impl. Reader %t \\n\", pType.Implements(readerType))\n</code></pre>\n\n<p>Exists one solution to check whether p implements the interface without compiling? I hope that someone can help me. </p>\n\n<p>[0] <a href=\"http://play.golang.org/p/JCsFf7y74C\" rel=\"nofollow noreferrer\">http://play.golang.org/p/JCsFf7y74C</a> (fixed)\n<a href=\"http://play.golang.org/p/cIStOOI84Y\" rel=\"nofollow noreferrer\">http://play.golang.org/p/cIStOOI84Y</a> (old)</p>\n\n<p>[1] <a href=\"https://stackoverflow.com/questions/27803654/explanation-of-checking-if-value-implements-interface-golang\">Explanation of checking if value implements interface. Golang</a></p>\n"}, {"tags": ["go", "packages"], "answers": [{"comments": [{"owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1440050785, "post_id": 32110593, "comment_id": 52114864, "body": "Aah!! My eyes seem bad. It was really a stupid mistake. Another pair of eyes looking at it was helpful! It works now."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "edited": false, "score": 0, "creation_date": 1440050822, "post_id": 32110593, "comment_id": 52114879, "body": "@Bharat 11PM in SF... I understand ;) I&#39;ve been there many times."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1440050419, "creation_date": 1440050419, "answer_id": 32110593, "question_id": 32110524, "link": "https://stackoverflow.com/questions/32110524/go-run-cannot-find-package/32110593#32110593", "title": "Go run cannot find package", "body": "<p>That might be because of a typo:</p>\n\n<pre><code>goloang\ninstead of\ngolang\n</code></pre>\n\n<p>You have:</p>\n\n<pre><code>$ echo $GOPATH\n/Users/Bharat/Dev/golang/fooproject\n                  ^^^^^^\n$ pwd\n/Users/Bharat/Dev/goloang/fooproject/src/fooer\n                  ^^^^^^^\n</code></pre>\n"}], "owner": {"reputation": 2312, "user_id": 317512, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/8c33f38cdc152bb55b69c9192e401733?s=128&d=identicon&r=PG", "display_name": "Bharat", "link": "https://stackoverflow.com/users/317512/bharat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1625, "favorite_count": 1, "accepted_answer_id": 32110593, "answer_count": 1, "score": 0, "last_activity_date": 1459430826, "creation_date": 1440050128, "last_edit_date": 1459430826, "question_id": 32110524, "link": "https://stackoverflow.com/questions/32110524/go-run-cannot-find-package", "title": "Go run cannot find package", "body": "<p>I have a sample project setup based on <a href=\"http://blog.pivotal.io/pivotal-labs/labs/next-steps-in-go-code-organization\" rel=\"nofollow\">this</a> article. </p>\n\n<p>This is my directory structure:</p>\n\n<pre><code>goloang/\n\u2514\u2500\u2500 fooproject\n\u00a0\u00a0  \u2514\u2500\u2500 src\n\u00a0\u00a0     \u251c\u2500\u2500 foo\n\u00a0\u00a0     \u2502\u00a0\u00a0 \u2514\u2500\u2500 foo.go\n\u00a0\u00a0     \u2514\u2500\u2500 fooer\n\u00a0\u00a0         \u2514\u2500\u2500 fooer.go\n</code></pre>\n\n<p>I have set the <code>GOTPATH</code></p>\n\n<pre><code>$ echo $GOPATH\n/Users/Bharat/Dev/golang/fooproject\n</code></pre>\n\n<p>I am trying to run <code>foor.go</code> but I get a cannot find package error even though it exists in the location referenced by <code>GOPATH</code> i.e. in <code>src/foo</code>. </p>\n\n<p>This is how I am running it:</p>\n\n<pre><code>$ pwd\n/Users/Bharat/Dev/goloang/fooproject/src/fooer\n\n$ go run fooer.go \nfooer.go:4:3: cannot find package \"foo\" in any of:\n    /usr/local/go/src/foo (from $GOROOT)\n    /Users/Bharat/Dev/golang/fooproject/src/foo (from $GOPATH)\n</code></pre>\n\n<p>These are the file contents.</p>\n\n<p><code>src/foo/foo.go</code>:</p>\n\n<pre><code>package foo\n\nimport (\n  \"fmt\"\n)\n\nfunc Bar() {\n  fmt.Println(\"bar\")\n}\n</code></pre>\n\n<p><code>src/fooer/fooer.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n  \"foo\"\n)\n\nfunc main() {\n  foo.Bar()\n}\n</code></pre>\n\n<p>I get the same error when I try to do <code>go build fooer.go</code>. </p>\n\n<p>Where am I going wrong with the project structure? </p>\n"}, {"tags": ["go", "ctags", "exuberant-ctags"], "answers": [{"comments": [{"owner": {"reputation": 249, "user_id": 4460434, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e284baeb830754a30047a316e20e3224?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/4460434/manoj-kumar"}, "edited": false, "score": 0, "creation_date": 1440050390, "post_id": 32110508, "comment_id": 52114676, "body": "I&#39;m currently using sublime editor. But separately i need print the outline of go files separately. So i&#39;m using ctags -x filename.go command. But the thing is i&#39;m not provided with all the imports i used in the file. So i need to configure it to provide import statements too. gotags is not printing outline when there is an error in code. So i&#39;m comfortable with ctags."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 3, "last_activity_date": 1440050067, "creation_date": 1440050067, "answer_id": 32110508, "question_id": 32110397, "link": "https://stackoverflow.com/questions/32110397/configure-ctags-to-show-also-the-imports-in-go-source-file/32110508#32110508", "title": "Configure ctags to show also the imports in go source file", "body": "<p>First, I recommend using an editor that supports <code>gocode</code> (SublimeText + Gosublime, Atom + go-plus, vim + vim-go to name a few).</p>\n\n<p>If you really want ctags, check <a href=\"https://github.com/jstemmer/gotags\" rel=\"nofollow\">gotags</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 441, "user_id": 4910125, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-QdookrlbU_g/AAAAAAAAAAI/AAAAAAAAABM/lOy93Mm4Vrc/photo.jpg?sz=128", "display_name": "WALID BELRHALMIA", "link": "https://stackoverflow.com/users/4910125/walid-belrhalmia"}, "is_accepted": false, "score": 0, "last_activity_date": 1440614851, "creation_date": 1440614851, "answer_id": 32234417, "question_id": 32110397, "link": "https://stackoverflow.com/questions/32110397/configure-ctags-to-show-also-the-imports-in-go-source-file/32234417#32234417", "title": "Configure ctags to show also the imports in go source file", "body": "<p>Go version 1.1 or higher is required. Install or update gotags using the go get command:   </p>\n\n<pre><code>go get -u github.com/jstemmer/gotags  \n</code></pre>\n\n<p>or  </p>\n\n<pre><code>brew install gotags  \n</code></pre>\n\n<p>the commands for generating tags is :  </p>\n\n<pre><code>gotags -R *.go &gt;&gt; tags  \n</code></pre>\n\n<p>you have to use an editor that support catgs personnaly i use vim+tagbar  </p>\n\n<p>and there is the configuration that i use for tagbar in my  .vimrc :  </p>\n\n<p>let g:tagbar_type_go = {<br>\n    \\ 'ctagstype' : 'go',<br>\n    \\ 'kinds'     : [<br>\n        \\ 'p:package',<br>\n        \\ 'i:imports:1',<br>\n        \\ 'c:constants',<br>\n        \\ 'v:variables',<br>\n        \\ 't:types',<br>\n        \\ 'n:interfaces',<br>\n        \\ 'w:fields',<br>\n        \\ 'e:embedded',<br>\n        \\ 'm:methods',<br>\n        \\ 'r:constructor',<br>\n        \\ 'f:functions'<br>\n    \\ ],<br>\n    \\ 'sro' : '.',<br>\n    \\ 'kind2scope' : {<br>\n        \\ 't' : 'ctype',<br>\n        \\ 'n' : 'ntype'<br>\n    \\ },<br>\n    \\ 'scope2kind' : {<br>\n        \\ 'ctype' : 't',<br>\n        \\ 'ntype' : 'n'<br>\n    \\ },<br>\n    \\ 'ctagsbin'  : 'gotags',<br>\n    \\ 'ctagsargs' : '-sort -silent'<br>\n\\ }  </p>\n\n<p><a href=\"https://i.stack.imgur.com/VTIfs.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VTIfs.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 249, "user_id": 4460434, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e284baeb830754a30047a316e20e3224?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/4460434/manoj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1440614851, "creation_date": 1440049503, "last_edit_date": 1440050145, "question_id": 32110397, "link": "https://stackoverflow.com/questions/32110397/configure-ctags-to-show-also-the-imports-in-go-source-file", "title": "Configure ctags to show also the imports in go source file", "body": "<p>I'm using <a href=\"http://ctags.sourceforge.net/\" rel=\"nofollow\">exeburent-ctags</a> for tagging my go source files. By default ctags is not showing import statements in my go files. How to configure ctags to display also the import statements in the file. \nI'm using latest version of ctags in linux. So it has default support for go lang. I need to override the ctags configuration.</p>\n"}]