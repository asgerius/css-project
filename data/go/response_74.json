[{"tags": ["performance", "http", "go", "webserver"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1465428383, "post_id": 37714210, "comment_id": 62902621, "body": "www.google.com serves more than just &quot;hello&quot;. Throughput and request rate are hardly related."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 4, "creation_date": 1465429724, "post_id": 37714210, "comment_id": 62903015, "body": "To elaborate on that, I&#39;d imagine you&#39;d get a much higher throughput if your hello world function returned the contents of a large file on disk."}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465429811, "post_id": 37714210, "comment_id": 62903050, "body": "@JimB Are the benchmark results that I got, nearer to theoretical maximum of golang http server ? It is only 90k results per second.  I read that java server implementation supports much more concurrent connections- <a href=\"http://shenfeng.me/600k-concurrent-connection-http-kit.html\" rel=\"nofollow noreferrer\">shenfeng.me/600k-concurrent-connection-http-kit.html</a>"}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465430127, "post_id": 37714210, "comment_id": 62903153, "body": "@JoshWilson If you see the linkedin performance results link that I posted, they did the benchmarks with 50 million 100 byte records.  &quot;For this first test I create a topic with six partitions and no replication. Then I produce 50 million small (100 byte) records as quickly as possible from a single thread. The reason for focusing on small records in these tests is that it is the harder case for a messaging system (generally). It is easy to get good throughput in MB/sec if the messages are large, but much harder to get good throughput when the messages are small&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465431108, "post_id": 37714210, "comment_id": 62903449, "body": "Concurrent connections and request rate are also unrelated. You seem to be targeting random benchmarks from random unrelated technologies. What is the point of all this?"}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465431252, "post_id": 37714210, "comment_id": 62903493, "body": "@JimB I am not concerned about the concurrent connections. That is a secondary factor. My  problem is only on request rate."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 1, "creation_date": 1465432641, "post_id": 37714210, "comment_id": 62903814, "body": "I honestly don&#39;t know how well golang preforms in comparison to other languages, but you are comparing an http server to one that takes in log messages. There is probably a bit of overhead parsing the http request and encoding the response. You&#39;ll also have a little overhead on the flexibility of the framework. If you want to test pure speed, try making something  like <a href=\"https://coderwall.com/p/wohavg/creating-a-simple-tcp-server-in-go\" rel=\"nofollow noreferrer\">coderwall.com/p/wohavg/creating-a-simple-tcp-server-in-go</a> and then add pooling so you don&#39;t reallocate new buffers. You may never get quite to the performance of kafka, but at that would be a good comparison."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 1, "creation_date": 1465432713, "post_id": 37714210, "comment_id": 62903826, "body": "And there&#39;s a reasonable chance when you hit google.com every single one of your requests is going to a different server, so again a pretty bad comparison."}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465456866, "post_id": 37714210, "comment_id": 62911083, "body": "@JoshWilson can you explain bit more about pooling? What would be the best way to benchmark the server tcp performance ? I see that most of tools like iperf, needs server and client running the same tool. I couldn&#39;t find any tool to test the performance of a tcp server. (like wrk,ab for http servers)"}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465489625, "post_id": 37714210, "comment_id": 62934075, "body": "What exactly is your use case? Rarely is network speed going to be the bottleneck."}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465490498, "post_id": 37714210, "comment_id": 62934600, "body": "@JoshWilson I needed a high performant server than can accept maximum number of requests per sec. I was trying to see the benchmark values of  golang http server because I was doubtful of the overhead added due to the language implementation.  Having 100k req/sec was not very impressive."}, {"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465492371, "post_id": 37714210, "comment_id": 62935679, "body": "so you&#39;re going to accept the connections and then just drop them on the floor?"}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1465539417, "post_id": 37714210, "comment_id": 62952615, "body": "@JoshWilson You can see the light weight java server <a href=\"https://www.techempower.com/blog/2014/03/04/one-million-http-rps-without-load-balancing-is-easy/\" rel=\"nofollow noreferrer\">techempower.com/blog/2014/03/04/&hellip;</a> can give around 1M http request per second while in golang, i am just getting around 1/10th(100k requests per second) for almost same kind of setup. Hence I was wondering if I am missing out something or is it the maximum that I can achieve in golang http implementation"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1465553252, "post_id": 37714210, "comment_id": 62960757, "body": "did you run that java server in the same setup or are you taking their numbers, because that is useless. If you want some kind of real comparison you should run that java server on the same box as the golang one and test that."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1465553372, "post_id": 37714210, "comment_id": 62960819, "body": "also your latency is ridiculously high. I suspect more a problem with your testbox or network here. I have a nginx/uwsgi/django server runnning doing real work at &lt;20ms, so i think you are really testing network latency here."}, {"owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1465581386, "post_id": 37714210, "comment_id": 62978316, "body": "@RickyA  I also noticed the latency value. I am not sure how to debug this issue.  Iperf command between these machines  show 8-10 Gbps. Hence, I have less suspicion on the network. Any other ideas?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1465595771, "post_id": 37714210, "comment_id": 62984669, "body": "Latency is not bandwidth. In fact the only correlation is that when you consume all your bandwidth, your latency will rise. Latency normally stems from other things like the type of networking (wireless == crap) topology of network, load on the servers themself (not io). I really cannot tell you something meaningful here."}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "is_accepted": false, "score": 2, "last_activity_date": 1465591185, "creation_date": 1465591185, "answer_id": 37756840, "question_id": 37714210, "link": "https://stackoverflow.com/questions/37714210/go-http-server-slow-benchmark-performance/37756840#37756840", "title": "Go http server slow benchmark performance", "body": "<p>\"premature optimization is the root of all evil\"<a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow\">1</a></p>\n\n<p>I would suggest building something for your use case and then attempting to optimize. It is difficult to build a good benchmark that tests what you want so make sure you are testing what you want and not something like the speed of your router.</p>\n"}, {"tags": [], "owner": {"reputation": 539, "user_id": 2352611, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0fY8c.jpg?s=128&g=1", "display_name": "Larytet", "link": "https://stackoverflow.com/users/2352611/larytet"}, "is_accepted": false, "score": 3, "last_activity_date": 1528361668, "last_edit_date": 1528361668, "creation_date": 1528303472, "answer_id": 50725559, "question_id": 37714210, "link": "https://stackoverflow.com/questions/37714210/go-http-server-slow-benchmark-performance/50725559#50725559", "title": "Go http server slow benchmark performance", "body": "<p>Golang net/http is rather slow. If the goal is to maximize the requests rate there are other implementations. For example <a href=\"https://github.com/valyala/fasthttp\" rel=\"nofollow noreferrer\">https://github.com/valyala/fasthttp</a> In my tests fasthttp doubles the query rate. My test is a short request and short reply.</p>\n\n<p>The library comes with limitations, like no HTTP/2 support. If you need HTTP for REST API and you are not looking for interoperability fasthttp will fit nicely</p>\n"}], "owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8024, "favorite_count": 2, "answer_count": 2, "score": 5, "last_activity_date": 1583594189, "creation_date": 1465426255, "last_edit_date": 1495540432, "question_id": 37714210, "link": "https://stackoverflow.com/questions/37714210/go-http-server-slow-benchmark-performance", "title": "Go http server slow benchmark performance", "body": "<p>I was trying to find the maximum throughput of a go webserver. I ran simplewebserver on a 8 core machine(Intel Xeon 2.5 Mhz) and ran wrk tool on a different 8 core machine. Iperf command shows around 8-10Gbps between these machines . Initially, I made a mistake by using apache ab tool that gave only 16k requests/second. The problem was same as <a href=\"https://stackoverflow.com/questions/30352725/why-is-my-hello-world-go-server-getting-crushed-by-apachebench\">link</a>. Now when I switched to wrk tool,  I am getting around 90k requests per second and ~ 11MB/sec. </p>\n\n<p>on the first 8 core machine, I ran simplewebserver.go</p>\n\n<pre><code>package main\n\nimport (\n   \"io\"\n    \"net/http\"\n    \"runtime\"\n)\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world!\")\n}\n\n func main() {\n    runtime.GOMAXPROCS(8)\n    http.HandleFunc(\"/\", hello)\n    http.ListenAndServe(\":8000\", nil)\n }\n</code></pre>\n\n<p>On a different 8 core machine, i ran</p>\n\n<pre><code> ./wrk -t8 -c1000 -d10s http://10.0.0.6:8000/\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Running 10s test @ http://10.0.0.6:8000/\n8 threads and 1000 connections\nThread Stats   Avg      Stdev     Max   +/- Stdev\nLatency    42.65ms  114.89ms   1.96s    91.33%\nReq/Sec    11.54k     3.01k   25.10k    74.88%\n923158 requests in 10.10s, 113.57MB read\nSocket errors: connect 0, read 0, write 0, timeout 20\nRequests/sec:  91415.11\nTransfer/sec:     11.25MB\n</code></pre>\n\n<p>Can i say that I have reached maximum throughput of a golang web server?  I am getting 11 MB/sec which looks quite small for the basic program. If I run the wrk tool on www.google.com page, I am getting around 200 MB/sec. Even for larger complex computing systems like kafka(java server), the benchmark results get more than  70 MB/sec(<a href=\"https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines\" rel=\"nofollow noreferrer\">https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines</a>). How can a golang server handle extreme workloads of millions of requests per second(more than 100MB/sec minimum)? Am I wrong in any assumptions?</p>\n\n<p>UPDATE:</p>\n\n<p>I ran the same program on a 16 core machine with the same specs. I changed the maxprocs to 16 and results went higher to 120k requests/sec. I feel that I have the reached the maximum of golang http server and hence I am not finding any significant increment in the requests/sec. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6652, "user_id": 411229, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4iIBw.jpg?s=128&g=1", "display_name": "Ryan Walls", "link": "https://stackoverflow.com/users/411229/ryan-walls"}, "edited": false, "score": 0, "creation_date": 1465426337, "post_id": 37713982, "comment_id": 62901988, "body": "Yep, that was it.  Thanks for the help!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1465477099, "last_edit_date": 1465477099, "creation_date": 1465424834, "answer_id": 37713982, "question_id": 37713749, "link": "https://stackoverflow.com/questions/37713749/unmarshal-into-array-of-structs-determined-at-runtime-in-go/37713982#37713982", "title": "Unmarshal into array of structs determined at runtime in Go", "body": "<p>You're building a <code>[]*myObj</code> using reflect, but you're then passing an <code>*interface{}</code> to <code>json.Unmarshal</code>. The json package sees the target of the pointer as the type <code>interface{}</code>, and therefore uses its default types to unmarshal into. You need to create a pointer to the slice type you create, so the call to the <code>Interface()</code> method returns the exactly type you want to unmarshal into, which is <code>*[]*myObj</code>.</p>\n\n<pre><code>sliceType := reflect.SliceOf(reflect.TypeOf(&amp;myObj{}))\nslicePtr := reflect.New(sliceType)\n\nerr = json.Unmarshal([]byte(input), slicePtr.Interface())\n</code></pre>\n"}], "owner": {"reputation": 6652, "user_id": 411229, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/4iIBw.jpg?s=128&g=1", "display_name": "Ryan Walls", "link": "https://stackoverflow.com/users/411229/ryan-walls"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 37713982, "answer_count": 1, "score": 3, "last_activity_date": 1465477099, "creation_date": 1465423495, "question_id": 37713749, "link": "https://stackoverflow.com/questions/37713749/unmarshal-into-array-of-structs-determined-at-runtime-in-go", "title": "Unmarshal into array of structs determined at runtime in Go", "body": "<p>I'm trying to dynamically create a slice of structs that I can marshal my data into, but doing it at runtime based on some unknown struct type.  I'm doing this because I want to have one common bit of code that can unmarshal anything that implements a specific interface.  </p>\n\n<p>e.g. (pseudo code)</p>\n\n<pre><code>func unmarshalMyData(myInterface MyInterface, jsonData []byte) {\n   targetSlice := myInterface.EmptySlice()\n   json.Unmarshal(jsonData, &amp;targetSlice)\n}\n</code></pre>\n\n<p>I've tried several different alternatives.  The one that seems the most promising is using the <code>reflect</code> package to construct the slice.  Unfortunately, after unmarshalling, the dynamically created slice has a type of <code>[]interface{}</code>.  If I print out the type of the dynamically created slice before unmarshalling it prints <code>[]*main.myObj</code>.  Can anyone explain why?  See playground link: <a href=\"https://play.golang.org/p/vvf1leuQeY\" rel=\"nofollow\">https://play.golang.org/p/vvf1leuQeY</a></p>\n\n<p>Is there some other way to dynamically create a slice of structs that unmarshals correctly?    </p>\n\n<p>I'm aware of <code>json.RawMessage</code>, but there are a few reasons I can't use it... there is no \"type\" field in my json.  Also, the code where I am unmarshalling has no compile time knowledge of the struct that it is unmarshalling.  It only knows that the struct implements a specific interface.  </p>\n\n<p>Some code that baffles me as to why dynamically created slice doesn't maintain its type after unmarshalling: </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    input := `[{\"myField\":\"one\"},{\"myField\":\"two\"}]`\n    myObjSlice := []*myObj{}\n    fmt.Printf(\"Type of myObjSlice before unmarshalling %T\\n\", myObjSlice)\n    err := json.Unmarshal([]byte(input), &amp;myObjSlice)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Type of myObjSlice after unmarshalling %T\\n\", myObjSlice)\n\n    myConstructedObjSlice := reflect.MakeSlice(reflect.SliceOf(reflect.TypeOf(&amp;myObj{})), 0, 0).Interface()\n    fmt.Printf(\"Type of myConstructedObjSlice before unmarshalling %T\\n\", myConstructedObjSlice)\n    err = json.Unmarshal([]byte(input), &amp;myConstructedObjSlice)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Type of myConstructedObjSlice after unmarshalling %T\\n\", myConstructedObjSlice)\n}\n\ntype myObj struct {\n    myField string\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Type of myObjSlice before unmarshalling []*main.myObj\nType of myObjSlice after unmarshalling []*main.myObj\nType of myConstructedObjSlice before unmarshalling []*main.myObj\nType of myConstructedObjSlice after unmarshalling []interface {}\n</code></pre>\n"}, {"tags": ["go", "get", "streaming"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1465422056, "post_id": 37713337, "comment_id": 62900413, "body": "I don&#39;t think you need to do anything at all. It is already a stream and works with chunked encoding by default. Remember the type of the response body."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465422207, "post_id": 37713337, "comment_id": 62900482, "body": "But when I run the body is empty. No data is returned because the connection is closes. The behavior is the same with python if I switch the stream flag to false"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465422493, "post_id": 37713337, "comment_id": 62900603, "body": "Are you getting an error from ReadBytes? If the body is json, there no guarantee it contains a <code>\\n</code> character at all. Why not just read the entire body in one shot to make sure you&#39;re getting what you expect in the first place?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465427727, "post_id": 37713337, "comment_id": 62902416, "body": "@JimB no i&#39;m not getting an error from Readbytes.  Also, this response is around 2gb of data.  Which is why I don&#39;t read it all at once.  With python, if the stream value is True, I read the 512 bytes at a time until the stream stops. I do have an idea, I&#39;ll post back if that fixes the issue or if it doesn&#39;t fix the issue lol."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465428192, "post_id": 37713337, "comment_id": 62902562, "body": "@evanmcdonnal thank you I didn&#39;t know that"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465428262, "post_id": 37713337, "comment_id": 62902582, "body": "@JimB Fixed, thank you had you not mentioned trying to read the entire body I wouldn&#39;t have checked the time stamp on the request.  Changing the time stamp fixed the issue."}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1306, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465421730, "creation_date": 1465421730, "question_id": 37713337, "link": "https://stackoverflow.com/questions/37713337/how-do-you-stream-get-request-golang", "title": "How do you stream get request Golang", "body": "<p>I've done quiet a bit of searching and I haven't really found any answers to this question.  How do you download a chunked response with Go.  I'm more familiar with python.  In python I would do something like this</p>\n\n<pre><code>    with closing(requests.get('some_url' ,stream=True)) as res:\n      for chunk in res.iter_content(chunk_size=512):\n        #do something with chunk\n</code></pre>\n\n<p>I've tried a few different ways with go to this effect.  Here is my latest attempt.</p>\n\n<pre><code>func DownloadLogs(start int, end int) {\n    url := \"removed for security\"\n    client := &amp;http.Client{}\n    req, _ := http.NewRequest(\"GET\", url, nil)\n    req.Header.Set(\"Content-Type\", \"application/json\")\n    req.Header.Set(\"X-Auth-Key\", \"removed for security\")\n    req.Header.Set(\"X-Auth-Email\", \"removed for security\")\n\n    res, err := client.Do(req)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer res.Body.Close()\n\n    // output, err := os.Create(\"test.txt\")\n    //   if err != nil {\n    //     fmt.Println(\"Error while creating\", \"test\", \"-\", err)\n    //     return\n    //   }\n    //   defer output.Close()\n\n    reader := bufio.NewReader(res.Body)\n    for {\n        line, err := reader.ReadBytes('\\n')\n        if err != nil {\n            return\n        }\n        println(string(line))\n    }\n}\n</code></pre>\n\n<p>I'm using Go's http library, but i've also tried go's napping library.</p>\n"}, {"tags": ["go", "jenkins"], "answers": [{"comments": [{"owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "edited": false, "score": 0, "creation_date": 1465426528, "post_id": 37713344, "comment_id": 62902041, "body": "I just found <a href=\"https://github.com/AlekSi/gocov-xml\" rel=\"nofollow noreferrer\">github.com/AlekSi/gocov-xml</a>, I think it will do what we need!"}, {"owner": {"reputation": 105809, "user_id": 234938, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e509dcb9852f237fe0412caccc335ac9?s=128&d=identicon&r=PG", "display_name": "Christopher Orr", "link": "https://stackoverflow.com/users/234938/christopher-orr"}, "reply_to_user": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "edited": false, "score": 0, "creation_date": 1465551259, "post_id": 37713344, "comment_id": 62959518, "body": "Ah, nice. Good to know!"}], "tags": [], "owner": {"reputation": 105809, "user_id": 234938, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e509dcb9852f237fe0412caccc335ac9?s=128&d=identicon&r=PG", "display_name": "Christopher Orr", "link": "https://stackoverflow.com/users/234938/christopher-orr"}, "is_accepted": false, "score": 0, "last_activity_date": 1465421761, "creation_date": 1465421761, "answer_id": 37713344, "question_id": 37710108, "link": "https://stackoverflow.com/questions/37710108/go-coverage-report-integration-with-jenkins/37713344#37713344", "title": "Go Coverage Report Integration with Jenkins", "body": "<p>There isn't a dedicated plugin for Go coverage reports, nor really for generic code coverage.</p>\n\n<p>For reports like this, I use the <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin\" rel=\"nofollow\">HTML Publisher Plugin</a> to publish <code>.html</code> files created during a build.</p>\n"}, {"tags": [], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "is_accepted": true, "score": 2, "last_activity_date": 1520608695, "last_edit_date": 1520608695, "creation_date": 1466201102, "answer_id": 37891016, "question_id": 37710108, "link": "https://stackoverflow.com/questions/37710108/go-coverage-report-integration-with-jenkins/37891016#37891016", "title": "Go Coverage Report Integration with Jenkins", "body": "<p><a href=\"https://github.com/AlekSi/gocov-xml\" rel=\"nofollow noreferrer\">https://github.com/AlekSi/gocov-xml</a></p>\n\n<p>This is what we need.  Use Coberuta plugin to generate the coverage profile.</p>\n"}, {"tags": [], "owner": {"reputation": 25907, "user_id": 509706, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/yedDa.png?s=128&g=1", "display_name": "Wilfred Hughes", "link": "https://stackoverflow.com/users/509706/wilfred-hughes"}, "is_accepted": false, "score": 12, "last_activity_date": 1520611936, "creation_date": 1520611936, "answer_id": 49197822, "question_id": 37710108, "link": "https://stackoverflow.com/questions/37710108/go-coverage-report-integration-with-jenkins/49197822#49197822", "title": "Go Coverage Report Integration with Jenkins", "body": "<p>There are several go tools for converting coverage data from <code>go test</code> to Cobertura for Jenkins: <a href=\"https://github.com/t-yuki/gocover-cobertura\" rel=\"noreferrer\">gocover-cobertura</a>, or <a href=\"https://github.com/axw/gocov/\" rel=\"noreferrer\">gocov</a> with <a href=\"https://github.com/AlekSi/gocov-xml\" rel=\"noreferrer\">gocov-xml</a>.</p>\n\n<p>You can use <code>gocover-cobertura</code> as follows:</p>\n\n<pre><code>$ go get github.com/t-yuki/gocover-cobertura\n\n$ go test -coverprofile=cover.out example.com/demo/...\nok      example.com/demo    0.008s  coverage: 0.0% of statements\nok      example.com/demo/cmd/demo   0.020s  coverage: 23.4% of statements\n\n$ gocover-cobertura &lt; cover.out &gt; coverage.xml\n\n$ head coverage.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE coverage SYSTEM \"http://cobertura.sourceforge.net/xml/coverage-04.dtd\"&gt;\n&lt;coverage line-rate=\"0.35415787\" branch-rate=\"0\" version=\"\" timestamp=\"1520609235359\" lines-covered=\"839\" lines-valid=\"2369\" branches-covered=\"0\" branches-valid=\"0\" complexity=\"0\"&gt;\n        &lt;sources&gt;\n                &lt;source&gt;/usr/local/go/src&lt;/source&gt;\n                &lt;source&gt;/Users/wilfred/workspace/go-scratch/src&lt;/source&gt;\n        &lt;/sources&gt;\n        &lt;packages&gt;\n                &lt;package name=\"example.com/demo/cmd/demo\" line-rate=\"0.4848485\" branch-rate=\"0\" complexity=\"0\"&gt;\n                        &lt;classes&gt;\n</code></pre>\n\n<p>Note that you'll need Go 1.10+ to <a href=\"https://github.com/golang/go/commit/283558e42b88a6afa39da6ad4ae87558dc053776\" rel=\"noreferrer\">run <code>-coverprofile</code> against multiple packages in one run</a>.</p>\n"}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7554, "favorite_count": 3, "accepted_answer_id": 37891016, "answer_count": 3, "score": 8, "last_activity_date": 1520611936, "creation_date": 1465410195, "question_id": 37710108, "link": "https://stackoverflow.com/questions/37710108/go-coverage-report-integration-with-jenkins", "title": "Go Coverage Report Integration with Jenkins", "body": "<p>I wonder if there's any tool that can convert <code>go test -coverprofile=cover.out</code> into the formats that Jenkins can accept?  I found some tools like <a href=\"https://github.com/jstemmer/go-junit-report\" rel=\"noreferrer\">go-junit-report</a> and <a href=\"https://bitbucket.org/tebeka/go2xunit\" rel=\"noreferrer\">go2xunit</a>, but they actually just convert output from <code>go test -v</code>, which is not the coverage report.</p>\n\n<p>I want to know the detailed test coverage in Jenkins directly.  Basically, I want to see the output from <code>go tool cover -func=cover.out</code> and <code>go tool cover -html=cover.out</code> in Jenkins webpage.</p>\n"}, {"tags": ["windows", "go", "timer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465400704, "post_id": 37706834, "comment_id": 62888285, "body": "What is the current behavior in the go1.7rc? There have been more changes around the windows timers due to their performance. You may want to read through the many windows timer related issues in GH."}, {"owner": {"reputation": 668, "user_id": 1003971, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/e75102beeb0bf6d568bf85a48457f20a?s=128&d=identicon&r=PG", "display_name": "m4r73n", "link": "https://stackoverflow.com/users/1003971/m4r73n"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465450794, "post_id": 37706834, "comment_id": 62908168, "body": "Timers seem to have a higher resolution with the current beta of Go 1.7. Thanks for your help."}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "edited": false, "score": 1, "creation_date": 1488695306, "post_id": 37706834, "comment_id": 72340465, "body": "It&#39;s probably a good idea to add that as an answer and mark it as accepted if you&#39;re happy with it. Then people looking to answer unanswered questions can skip this."}], "answers": [{"tags": [], "owner": {"reputation": 765, "user_id": 7246614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83eccd212e4687fc66e13aad21796b0b?s=128&d=identicon&r=PG", "display_name": "timotree", "link": "https://stackoverflow.com/users/7246614/timotree"}, "is_accepted": false, "score": 3, "last_activity_date": 1497735090, "creation_date": 1497735090, "answer_id": 44609556, "question_id": 37706834, "link": "https://stackoverflow.com/questions/37706834/high-resolution-timers-millisecond-precision-in-go-on-windows/44609556#44609556", "title": "High resolution timers (millisecond precision) in Go on Windows", "body": "<p>Since Go 1.7, timers now have a higher resolution and this problem should not occur.</p>\n"}], "owner": {"reputation": 668, "user_id": 1003971, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/e75102beeb0bf6d568bf85a48457f20a?s=128&d=identicon&r=PG", "display_name": "m4r73n", "link": "https://stackoverflow.com/users/1003971/m4r73n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1873, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1497735090, "creation_date": 1465399704, "question_id": 37706834, "link": "https://stackoverflow.com/questions/37706834/high-resolution-timers-millisecond-precision-in-go-on-windows", "title": "High resolution timers (millisecond precision) in Go on Windows", "body": "<p>I'm trying to use Go's <code>time.Timer</code>s to schedule tasks that need to be run in the right order with a precision in the order of half a millisecond. This works perfectly fine on OSX and on Linux, but fails every time on Windows.</p>\n\n<p>The following code demonstrates the issue. It sets 5 timers, the first one to 1 ms, the second to 2 ms, ..., and the last one to 5 ms. Once a timer fires, its number is printed. On OSX and Linux, this obviously produced \"12345\" as output, but on Windows the numbers are more or less random (tested on Win 7 and Windows Server 2012).</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var timer1, timer2, timer3, timer4, timer5 *time.Timer\n\n    timer1 = time.NewTimer(1 * time.Millisecond)\n    timer2 = time.NewTimer(2 * time.Millisecond)\n    timer3 = time.NewTimer(3 * time.Millisecond)\n    timer4 = time.NewTimer(4 * time.Millisecond)\n    timer5 = time.NewTimer(5 * time.Millisecond)\n\n    // should print 12345\n    for {\n        select {\n        case &lt;-timer1.C:\n            fmt.Print(\"1\")\n        case &lt;-timer2.C:\n            fmt.Print(\"2\")\n        case &lt;-timer3.C:\n            fmt.Print(\"3\")\n        case &lt;-timer4.C:\n            fmt.Print(\"4\")\n        case &lt;-timer5.C:\n            fmt.Print(\"5\")\n        case &lt;-time.After(200 * time.Millisecond):\n            return // exit the program\n        }\n    }\n}\n</code></pre>\n\n<p>I think this behavior is due to the changes made in Go 1.6 (<a href=\"https://golang.org/doc/go1.6#runtime\" rel=\"noreferrer\">https://golang.org/doc/go1.6#runtime</a>, 4th paragraph), where the Windows timer precision was reduced from 1 ms to 16 ms, although it should also have occurred with shorter intervals (of the order of 100 \u03bcs) before.</p>\n\n<p>Is there any way to reset the global Windows timer precision back to 1 ms, or to access a high resolution timer that would make the example above work?</p>\n"}, {"tags": ["go", "travis-ci"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465398688, "post_id": 37706297, "comment_id": 62886676, "body": "Are you checking the error when you try to start your server?"}, {"owner": {"reputation": 63, "user_id": 4994975, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f74c39b754e96e46c5f04212e58f21ed?s=128&d=identicon&r=PG&f=1", "display_name": "cphelps", "link": "https://stackoverflow.com/users/4994975/cphelps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465398982, "post_id": 37706297, "comment_id": 62886923, "body": "Yes, it&#39;s set to fail the test on any error produced from the go <code>http.ListenAndServeTLS</code> command. Though the failure is happening when I create a test client to try and connect to the server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465399406, "post_id": 37706297, "comment_id": 62887242, "body": "You need to show how you&#39;re creating the server and client first. This doesn&#39;t necessarily have anything to do with travis."}, {"owner": {"reputation": 63, "user_id": 4994975, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f74c39b754e96e46c5f04212e58f21ed?s=128&d=identicon&r=PG&f=1", "display_name": "cphelps", "link": "https://stackoverflow.com/users/4994975/cphelps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465401036, "post_id": 37706297, "comment_id": 62888546, "body": "Added code samples for client and sever."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465401492, "post_id": 37706297, "comment_id": 62888855, "body": "You have nothing synchronizing the start of your server. You&#39;re not showing where you call Start, but there&#39;s no guarantee that the server is listening at any point after. (You should also be using an httptest.Server which handles binding a random port and tls certs for you)"}, {"owner": {"reputation": 63, "user_id": 4994975, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f74c39b754e96e46c5f04212e58f21ed?s=128&d=identicon&r=PG&f=1", "display_name": "cphelps", "link": "https://stackoverflow.com/users/4994975/cphelps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465402446, "post_id": 37706297, "comment_id": 62889463, "body": "Sorry about that added the code I have in my test for  starting a server. So I looked at the httptest.Server but I&#39;m trying to test a server I built how would using the httptest.Server class help?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465402636, "post_id": 37706297, "comment_id": 62889586, "body": "The httptest.Server won&#39;t fix this problem, it&#39;s just better suited for tests. A good first guess is that you&#39;re trying to connect before the server is listening. Put a long sleep between starting the server and executing the tests to check. If that works, fix your synchronization (well, you should fix that anyway, but this will confirm it&#39;s the root cause)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465403239, "post_id": 37706297, "comment_id": 62889994, "body": "(also your server error handling is in another goroutine without synchronization, so it&#39;s entirely possible that the server fails, but the client&#39;s failure is reported first)"}, {"owner": {"reputation": 63, "user_id": 4994975, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f74c39b754e96e46c5f04212e58f21ed?s=128&d=identicon&r=PG&f=1", "display_name": "cphelps", "link": "https://stackoverflow.com/users/4994975/cphelps"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465403716, "post_id": 37706297, "comment_id": 62890307, "body": "Ok so the sleep fixed my travis problem. This might be a novice question but how would you suggest I go about fixing the synchronization issues you mentioned? (Also would you mind adding the sleep suggestion as the answer so I can accept it?)"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1465407287, "last_edit_date": 1465407287, "creation_date": 1465404615, "answer_id": 37708457, "question_id": 37706297, "link": "https://stackoverflow.com/questions/37706297/travis-ci-failing-when-trying-to-test-golang-http-server/37708457#37708457", "title": "Travis CI failing when trying to test Golang HTTP Server", "body": "<p>You have no synchronization between starting the server and trying to connect. Adding a <code>time.Sleep</code> after starting the server should highlight the issue.</p>\n\n<p>One way to reduce the window where the server isn't ready is to create the <code>net.Listener</code> synchronously, and then add the open listener to the <code>http.Server</code> config before starting the server. The <a href=\"https://golang.org/pkg/net/http/httptest/#Server\" rel=\"nofollow\"><code>httptest.Server</code></a> can do this for you, as well as bind to random ports to prevent conflicts during tests, and using local test TLS certificates. </p>\n"}], "owner": {"reputation": 63, "user_id": 4994975, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f74c39b754e96e46c5f04212e58f21ed?s=128&d=identicon&r=PG&f=1", "display_name": "cphelps", "link": "https://stackoverflow.com/users/4994975/cphelps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 37708457, "answer_count": 1, "score": 0, "last_activity_date": 1465407287, "creation_date": 1465398314, "last_edit_date": 1465402339, "question_id": 37706297, "link": "https://stackoverflow.com/questions/37706297/travis-ci-failing-when-trying-to-test-golang-http-server", "title": "Travis CI failing when trying to test Golang HTTP Server", "body": "<p>I'm very new to travis and Go. I have a test for a https server and it runs fine with I run <code>go test -v ./...</code> on my local machine but it will fail most of the time on Travis due to a <code>getsocketopt: connection refused</code> error when trying to connect to the server. It should be listening on <code>https://localhost:8081</code>. Is there something in my <code>.travis.yml</code> I can do to prevent this from happening?</p>\n\n<p>Here is my <code>.travis.yml</code></p>\n\n<pre><code>language: go\ngo:\n - 1.6\n - tip\nmatrix:\n  allow_failures:\n - go: tip\nbefore_install:\n - go get -v github.com/golang/lint/golint\ninstall:\n - go get -v -d -t ./...\n</code></pre>\n\n<p>Here's my server creation code:</p>\n\n<pre><code>func (webserver *WebServer) Start(keyLocation string, certLocation string) &lt;-chan error {\n    errors := make(chan error, 1)\n    go func() {\n        defer close(errors)\n        errors &lt;- http.ListenAndServeTLS(fmt.Sprintf(\":%v\", webserver.config.WebServerPort), certLocation, keyLocation, nil)\n    }()\n    return errors\n}\n</code></pre>\n\n<p>And the client code:</p>\n\n<pre><code>func createHTTPClient(t *testing.T) *http.Client {\n    t.Log(\"Creating a test client...\")\n    tr := &amp;http.Transport {\n        TLSClientConfig: &amp;tls.Config {InsecureSkipVerify: true},\n    }\n\n    t.Log(\"Created a test client\")\n    return &amp;http.Client {Transport: tr}\n}\n</code></pre>\n\n<p>Sample request with client</p>\n\n<pre><code>request, _ := http.NewRequest(httpmethod, fmt.Sprintf(\"https://localhost:%d/token\", port), nil)\nclient.Do(request)\n</code></pre>\n\n<p>Sample starting the server in a test</p>\n\n<pre><code>errors := server.Start(testKeyLocation, testCertLocation)\n//Handle errors from server\ngo func() {\n    select {\n        case err := &lt;-errors:\n            if err != nil {\n                t.Fatalf(\"Error with server: %s\", err.Error())\n            }\n    }\n}()\n</code></pre>\n"}, {"tags": ["c#", "go", "tcp", "server"], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6271067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545455343a235bb780f89d1afbdf0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "lyger", "link": "https://stackoverflow.com/users/6271067/lyger"}, "edited": false, "score": 0, "creation_date": 1465394851, "post_id": 37704766, "comment_id": 62883631, "body": "but how to connect them?"}, {"owner": {"reputation": 116487, "user_id": 80274, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cdf128a0ee0cf38f0a673dbc82a74449?s=128&d=identicon&r=PG", "display_name": "Scott Chamberlain", "link": "https://stackoverflow.com/users/80274/scott-chamberlain"}, "reply_to_user": {"reputation": 49, "user_id": 6271067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545455343a235bb780f89d1afbdf0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "lyger", "link": "https://stackoverflow.com/users/6271067/lyger"}, "edited": false, "score": 3, "creation_date": 1465395309, "post_id": 37704766, "comment_id": 62884016, "body": "@lyger he told you, you need to have both sides agree on &quot;messages&quot; then you write the code in each of the languages to write and read the messages on a TCP/IP connection."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 3, "last_activity_date": 1465394582, "creation_date": 1465394582, "answer_id": 37704766, "question_id": 37704474, "link": "https://stackoverflow.com/questions/37704474/how-to-connect-a-client-server-written-in-different-language/37704766#37704766", "title": "how to connect a client-server written in different language", "body": "<blockquote>\n  <p>is that even possible?</p>\n</blockquote>\n\n<p>Sure and it's done on a regular basis when web clients written in C, C++, go, Python, Perl, C#, Ruby etc communicate with web servers written in C, C++, Javascript, Ruby... whatever. All they need is to agree on a common protocol to use on the \"wire\", like HTTP, HTTPS etc.</p>\n"}], "owner": {"reputation": 49, "user_id": 6271067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545455343a235bb780f89d1afbdf0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "lyger", "link": "https://stackoverflow.com/users/6271067/lyger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "closed_date": 1465426635, "accepted_answer_id": 37704766, "answer_count": 1, "score": -4, "last_activity_date": 1465394582, "creation_date": 1465393884, "question_id": 37704474, "link": "https://stackoverflow.com/questions/37704474/how-to-connect-a-client-server-written-in-different-language", "closed_reason": "Needs more focus", "title": "how to connect a client-server written in different language", "body": "<p>How to connect a client-server written in different language?<br>\nfor example I have a server written in GO and a client written in C# they are both using Tcp/IP.<br>\nis that even possible?</p>\n"}, {"tags": ["c", "go", "binding", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465393487, "post_id": 37703779, "comment_id": 62882507, "body": "Have you read through <a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/cgo</a>? There&#39;s a number of examples there."}, {"owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465394390, "post_id": 37703779, "comment_id": 62883250, "body": "@JimB, couldn&#39;t find a single appropriate example there, can you point to one?"}], "answers": [{"tags": [], "owner": {"reputation": 1090, "user_id": 905927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290786897f51fbd76a589169d2170607?s=128&d=identicon&r=PG", "display_name": "rouzier", "link": "https://stackoverflow.com/users/905927/rouzier"}, "is_accepted": false, "score": 0, "last_activity_date": 1493238223, "creation_date": 1493238223, "answer_id": 43643865, "question_id": 37703779, "link": "https://stackoverflow.com/questions/37703779/pass-go-function-to-c-as-callback/43643865#43643865", "title": "Pass Go function to C as callback", "body": "<p>You could create an array of callbacks and have the bridge iterate the array of callbacks if the there is no return value (void function).</p>\n"}], "owner": {"reputation": 3577, "user_id": 1814909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/04ca8b6a14373e9cfe5aaea6096f4c01?s=128&d=identicon&r=PG", "display_name": "kaspersky", "link": "https://stackoverflow.com/users/1814909/kaspersky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1250, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1493238223, "creation_date": 1465392194, "last_edit_date": 1495539193, "question_id": 37703779, "link": "https://stackoverflow.com/questions/37703779/pass-go-function-to-c-as-callback", "title": "Pass Go function to C as callback", "body": "<p>Suppose I have a C library with code like this:</p>\n\n<pre><code>typedef int (callback_t)(int);\nvoid register_callback(callback_t cb);\n</code></pre>\n\n<p>I want to write go bindings for this function and pass arbitrary go callbacks.</p>\n\n<p>I found an excellent answer <a href=\"https://stackoverflow.com/questions/6125683/call-go-functions-from-c\">here</a>. However, it is a trick that makes use of the fact that the callback accepts a <code>void *</code>, through which Go passes the function pointer to C and receives it back. However, this can't be applied in my example since there isn't a user <code>void *</code>.</p>\n\n<p>The best I could do is:</p>\n\n<pre><code>/*\nextern int gobridge(int data);\n\nstatic int cbridge(void)\n{\n    register_callback(gobridge);\n}\n*/\nimport \"C\"\n\ntype Callback func (int) int\n\nvar g_cb Callback\n\n//export gobridge\nfunc gobridge(data C.int) C.int {\n    return C.int(g_cb(int(data)))\n}\n\nfunc RegisterCallback(cb Callback) {\n    g_cb = cb //save callback in a global\n    C.cbridge()\n}\n\nfunc Count(left, right int) {\n    C.count(C.int(left), C.int(right))\n}\n</code></pre>\n\n<p>This only works for a single register_callback (because of the global variable), but the C library can register many callbacks and invoke them all.</p>\n\n<p>I hoped to achieve something like this, but this doesn't compile (put aside the clojure, it can't convert the go function to c function even though the signature is the same):</p>\n\n<pre><code>import \"C\"\n\nfunc RegisterCallback(cb Callback) {\n    f := func (d C.int) C.int {\n        return C.int(cb(int(d)))\n    }\n    C.register_callback(f)\n}\n\nfunc Count(left, right int) {\n    C.count(C.int(left), C.int(right))\n}\n</code></pre>\n\n<p>Is there a way to properly bind the C library?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1465391438, "post_id": 37703447, "comment_id": 62880909, "body": "How is your JSON object coming through on the backend? Is it coming through a request body?"}, {"owner": {"reputation": 29, "user_id": 6409193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74fe2dc455f43510d03ce009300e51cf?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/6409193/elliott"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1465391663, "post_id": 37703447, "comment_id": 62881061, "body": "Check the edit for the updated code"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1465392381, "post_id": 37703447, "comment_id": 62881631, "body": "Just add the &quot;[&quot; and &quot;]&quot; to the string you get after marshaling. No need for cleverness here."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1327717"}, "is_accepted": true, "score": 2, "last_activity_date": 1465391714, "creation_date": 1465391714, "answer_id": 37703586, "question_id": 37703447, "link": "https://stackoverflow.com/questions/37703447/store-a-json-object-in-a-json-array-golang/37703586#37703586", "title": "Store a JSON object in a JSON array golang", "body": "<p>You just crate a slice of Output structs, and you can just Marshal that.</p>\n\n<pre><code>output := Output{\n    Name:  url[0],\n    Milli: ms,\n    Epoch: time.Now().Unix(),\n    }\n\noutputs := []Output{output}\nout1, _ := json.Marshal(outputs)\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6409193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74fe2dc455f43510d03ce009300e51cf?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/6409193/elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "accepted_answer_id": 37703586, "answer_count": 1, "score": 0, "last_activity_date": 1465391788, "creation_date": 1465391357, "last_edit_date": 1465391563, "question_id": 37703447, "link": "https://stackoverflow.com/questions/37703447/store-a-json-object-in-a-json-array-golang", "title": "Store a JSON object in a JSON array golang", "body": "<p>I have this JSON Object :</p>\n\n<pre><code>  {\n    \"name\": \"test.counter\",\n    \"value\": 1.234,\n    \"ts\": 1234567890  \n  } \n</code></pre>\n\n<p>And I would like to store the entire thing in a JSON array so it could look like this:</p>\n\n<pre><code>[\n  {\n    \"name\": \"test.counter\",\n    \"value\": 1.234,\n    \"ts\": 1234567890\n  }\n]\n</code></pre>\n\n<p>How can I do this? I'm kind of new to Golang.\n<strong>EDIT:</strong>\nI'm creating the JSON object</p>\n\n<pre><code>output := &amp;Output{\n    Name:  url[0],\n    Milli: ms,\n    Epoch: time.Now().Unix(),\n    }\nout1, _ := json.Marshal(output)\n</code></pre>\n"}, {"tags": ["json", "go", "encoding"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465390609, "post_id": 37701584, "comment_id": 62880295, "body": "What have you tried? You use the builtin <code>len</code> to get the length of strings, slices, maps, and buffered channels."}, {"owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465390736, "post_id": 37701584, "comment_id": 62880393, "body": "objectInJson, err := json.Marshal(object); len(objectInJson) works well. But I  would prefer to not use json.Marshal as I use json.Encode for another purpose. I would like to get the string length from json.Encode somehow"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465391025, "post_id": 37701584, "comment_id": 62880601, "body": "If you&#39;re using a <code>json.Encoder</code>, what are you writing to? Can you just write to a buffer and check its length after?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1482070678, "last_edit_date": 1482070678, "creation_date": 1465395018, "answer_id": 37704940, "question_id": 37701584, "link": "https://stackoverflow.com/questions/37701584/size-in-bits-of-object-encoded-to-json/37704940#37704940", "title": "Size in bits of object encoded to JSON?", "body": "<p><a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> and <a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"nofollow noreferrer\"><code>json.Encoder</code></a> does not expose nor maintain number of written bytes.</p>\n\n<p>One way would be to first marshal the value using <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal()</code></a> into a <code>[]byte</code> whose length we can get with the builtin <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len()</code></a> function. The bit count you seek for is the length multiplied by 8 (1 byte is 8 bits). After that you have to manually write the byte slice to your output. For small types, this is not a problem, but it may be undesirable for large structs / values. Also there is unnecessary work marshalling it, getting its length and writing the slice manually.</p>\n\n<p>A much better and more elegant way is to extend the functionality of any writers to manage the written bytes, using <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\"><em>embedding</em></a>:</p>\n\n<pre><code>type CounterWr struct {\n    io.Writer\n    Count int\n}\n\nfunc (cw *CounterWr) Write(p []byte) (n int, err error) {\n    n, err = cw.Writer.Write(p)\n    cw.Count += n\n    return\n}\n</code></pre>\n\n<p>This <code>CounterWr</code> type automatically manages the number of written bytes in its <code>Count</code> field which you can check / examine at any time.</p>\n\n<p>Now you create a value of our <code>CounterWr</code> passing the <code>io.Writer</code> that you currently use, and then pass this <code>CounterWr</code> value to <a href=\"https://golang.org/pkg/encoding/json/#NewEncoder\" rel=\"nofollow noreferrer\"><code>json.NewEncoder()</code></a>, and you can access number of written bytes from <code>CounterWr.Count</code> directly.</p>\n\n<p>Example usage:</p>\n\n<pre><code>type Something struct {\n    S string\n    I int\n}\n\n\nbuf := &amp;bytes.Buffer{}\n\n// Any writer, not just a buffer!\nvar out io.Writer = buf\ncw := &amp;CounterWr{Writer: out}\n\ns := Something{\"hello\", 4}\nif err := json.NewEncoder(cw).Encode(s); err != nil {\n    panic(err)\n}\n\nfmt.Printf(\"Count: %d bytes, %d bits\\n\", cw.Count, cw.Count*8)\nfmt.Printf(\"Verif: %d bytes, %d bits\\n\", buf.Len(), buf.Len()*8)\n</code></pre>\n\n<p>For verification purposes we're also printing the length of the <code>bytes.Buffer</code> we used as our output (<code>CounterWr.Count</code> and <a href=\"https://golang.org/pkg/bytes/#Buffer.Len\" rel=\"nofollow noreferrer\"><code>Buffer.Len()</code></a> should match).</p>\n\n<p>Output:</p>\n\n<pre><code>Count: 20 bytes, 160 bits\nVerif: 20 bytes, 160 bits\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/7LEdJUDZbv\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Notes:</strong></p>\n\n<p>If you encode other values too, <code>cw.Count</code> will be the number of total bytes of course (and not just that of the last value). If you want to get the size of the last encoded value only, store <code>cw.Count</code> before calling <code>Encoder.Encode()</code>, and calculate the difference to the count you get after encoding it. Or simply set <code>cw.Count</code> to <code>0</code> before encoding (yes, you can also change that field):</p>\n\n<pre><code>cw.Count = 0\n</code></pre>\n"}], "owner": {"reputation": 12496, "user_id": 1283776, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/abb815001c365007d50d2bdb3226e70a?s=128&d=identicon&r=PG", "display_name": "user1283776", "link": "https://stackoverflow.com/users/1283776/user1283776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2367, "favorite_count": 1, "accepted_answer_id": 37704940, "answer_count": 1, "score": -1, "last_activity_date": 1482070678, "creation_date": 1465386235, "last_edit_date": 1465395825, "question_id": 37701584, "link": "https://stackoverflow.com/questions/37701584/size-in-bits-of-object-encoded-to-json", "title": "Size in bits of object encoded to JSON?", "body": "<p>I have an object. I encode the object to json using <code>json.Encoder</code>.</p>\n\n<p>How can I measure the size of the json string in either bits?</p>\n"}, {"tags": ["go", "bytearray"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 3, "creation_date": 1465381833, "post_id": 37699755, "comment_id": 62874300, "body": "Without a minimal working example of your code we won&#39;t be able to help you much."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465389586, "post_id": 37699755, "comment_id": 62879533, "body": "<code>iotuil.ReadFile</code> just reads the bytes from the file, it doesn&#39;t know how to interpret those as a data structure other than <code>[]byte</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1465394538, "creation_date": 1465394538, "answer_id": 37704748, "question_id": 37699755, "link": "https://stackoverflow.com/questions/37699755/reading-bytes-from-file-into-memory/37704748#37704748", "title": "Reading bytes from file into memory", "body": "<p>You wrote it wrong to the file. Its human readable format, should be binary.</p>\n\n<p>My guess you used something like <code>fmt.Fprintln(file, byte_slice)</code> or variants.</p>\n\n<p>It must be <code>fmt.Fprintf(file, \"%s\", byte_slice)</code> or similar.</p>\n\n<p>Please, show us code how you write to the file.</p>\n"}, {"tags": [], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "is_accepted": false, "score": 0, "last_activity_date": 1465545870, "creation_date": 1465545870, "answer_id": 37743058, "question_id": 37699755, "link": "https://stackoverflow.com/questions/37699755/reading-bytes-from-file-into-memory/37743058#37743058", "title": "Reading bytes from file into memory", "body": "<p>So what think is happening is that the content inside of that file is a string. When you pull it out of the file it converts that string to bytes. What you need to do is convert those bytes to a string before you append to the file and then convert them back when you pull from the file</p>\n\n<p><a href=\"https://play.golang.org/p/PyBXAU9rVW\" rel=\"nofollow\">https://play.golang.org/p/PyBXAU9rVW</a></p>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1465545870, "creation_date": 1465381237, "last_edit_date": 1465381797, "question_id": 37699755, "link": "https://stackoverflow.com/questions/37699755/reading-bytes-from-file-into-memory", "title": "Reading bytes from file into memory", "body": "<p>I am using <code>bufio</code> to append byte arrays to a file. When I use <code>cat</code> on it I get:</p>\n\n<pre><code>[176 0 0 0 4 0 0 0 1 0 0 0 57 12 127 47 4 0 0 0 1 0 0 0 215 136 47 0 64 0 0 0 2 0 0 0 57 0 97 0 53 0 52 0 100 0 98 0 99 0 52 0 98 0 100 0 100 0 49 0 54 0 99 0 49 0 97 0 49 0 57 0 56 0 48 0 52 0 55 0 53 0 49 0 100 0 49 0 49 0 51 0 99 0 52 0 52 0 98 0 24 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 99 0 108 0 105 0 101 0 110 0 116 0 0 0 36 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 111 0 116 0 104 0 101 0 114 0 32 0 112 0 97 0 114 0 116 0 110 0 101 0 114 0][176 0 0 0 4 0 0 0 1 0 0 0 4 162 127 47 4 0 0 0 1 0 0 0 215 136 47 0 64 0 0 0 2 0 0 0 57 0 97 0 53 0 52 0 100 0 98 0 99 0 52 0 98 0 100 0 100 0 49 0 54 0 99 0 49 0 97 0 49 0 57 0 56 0 48 0 52 0 55 0 53 0 49 0 100 0 49 0 49 0 51 0 99 0 52 0 52 0 98 0 24 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 99 0 108 0 105 0 101 0 110 0 116 0 0 0 36 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 111 0 116 0 104 0 101 0 114 0 32 0 112 0 97 0 114 0 116 0 110 0 101 0 114 0][176 0 0 0 4 0 0 0 1 0 0 0 35 200 127 47 4 0 0 0 1 0 0 0 215 136 47 0 64 0 0 0 2 0 0 0 57 0 97 0 53 0 52 0 100 0 98 0 99 0 52 0 98 0 100 0 100 0 49 0 54 0 99 0 49 0 97 0 49 0 57 0 56 0 48 0 52 0 55 0 53 0 49 0 100 0 49 0 49 0 51 0 99 0 52 0 52 0 98 0 24 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 99 0 108 0 105 0 101 0 110 0 116 0 0 0 36 0 0 0 2 0 0 0 83 0 111 0 109 0 101 0 32 0 111 0 116 0 104 0 101 0 114 0 32 0 112 0 97 0 114 0 116 0 110 0 101 0 114 0]\n</code></pre>\n\n<p>So arrays of bytes. Now I want to read the file into memory, so I use:</p>\n\n<pre><code>content, err := ioutil.ReadFile(filename)\n</code></pre>\n\n<p>But when I display the <code>content</code> variable I get a completely different output than the contents of the file (and one array instead of many). What's wrong?</p>\n"}, {"tags": ["go", "code-organization"], "answers": [{"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": true, "score": 2, "last_activity_date": 1465381472, "creation_date": 1465381472, "answer_id": 37699843, "question_id": 37699721, "link": "https://stackoverflow.com/questions/37699721/golang-code-organization-where-should-i-put-custom-error-types-that-are-only-re/37699843#37699843", "title": "golang code organization: where should I put custom error types that are only relevant to one function?", "body": "<p>\"Same package\" would be my initial thought. There may be cases where having them in a different package would make sense, but that would only be if they're legitimately \"the same error\" from functions in multiple packages, with none of those packages being the logical \"most owner\".</p>\n"}], "owner": {"reputation": 3, "user_id": 6439704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ptWlo.png?s=128&g=1", "display_name": "peter rabbit", "link": "https://stackoverflow.com/users/6439704/peter-rabbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 37699843, "answer_count": 1, "score": 0, "last_activity_date": 1465381472, "creation_date": 1465381171, "question_id": 37699721, "link": "https://stackoverflow.com/questions/37699721/golang-code-organization-where-should-i-put-custom-error-types-that-are-only-re", "title": "golang code organization: where should I put custom error types that are only relevant to one function?", "body": "<p>I have just started working on my first golang project and really like the idea of returning custom error types from functions and using type assertion in the calling code, to check for specific errors. I find this solution cleaner than always comparing error messages.</p>\n\n<p>My only question is: where do you best put these custom error types?</p>\n\n<p>Say a number of custom error types is only used (returned) by one utility function, should they go in the same package as the function? Should I group them somehow? Or maybe there's a better way of doing this kind of thing..</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1465380294, "post_id": 37699297, "comment_id": 62873242, "body": "what&#39;s your Go datastructure look like?"}, {"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1465380987, "post_id": 37699297, "comment_id": 62873737, "body": "Also, is 1111, la1, lb1 etc meanful hardcoded properties. Or are you thinking more like (pseudo-code) <code>Map (int, Map(string, Map(string, int) )</code>. Odd structure, maybe share with us what you intend to acheive."}, {"owner": {"reputation": 719, "user_id": 1330374, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/uQQuJ.png?s=128&g=1", "display_name": "tripRev", "link": "https://stackoverflow.com/users/1330374/triprev"}, "reply_to_user": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1465381010, "post_id": 37699297, "comment_id": 62873753, "body": "@NathanCooper That&#39;s basically my question. What Go datastructure would I use to replace the Go &#39;if&#39; logic i&#39;m using in &#39;getVal&#39;?"}, {"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1465381858, "post_id": 37699297, "comment_id": 62874318, "body": "I&#39;m assuming you santisied the property name in some way? Given that la1, lb1 etc I&#39;m going to take it that these are fairly consistant meanful properties. Where &quot;1111&quot; looks like a Key in a Map/Dictionary, la1 looks more like &quot;Wheel&quot; on a car. Is that correct?"}, {"owner": {"reputation": 719, "user_id": 1330374, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/uQQuJ.png?s=128&g=1", "display_name": "tripRev", "link": "https://stackoverflow.com/users/1330374/triprev"}, "reply_to_user": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1465381943, "post_id": 37699297, "comment_id": 62874381, "body": "@NathanCooper what I&#39;m trying to achieve is maintain a list of unique ids, which need to be accessed based on provided vars varA, varB, varC - I will be given those and need to return the unique id based on the specific combination. Sorry if that&#39;s a silly way to explain it!"}], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 3, "last_activity_date": 1465390433, "creation_date": 1465390433, "answer_id": 37703098, "question_id": 37699297, "link": "https://stackoverflow.com/questions/37699297/storing-accessing-nested-data-in-go-use-structs/37703098#37703098", "title": "Storing/accessing nested data in Go - use structs?", "body": "<p>Your way of approaching the problem is very peculiar. Maybe you already know this but on the off-chance you don't: <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">use maps</a>.</p>\n\n<p>I made an example with badly-named types (since I don't know your use-case) and I also made everything a string to keep it simple.</p>\n\n<pre><code>type l3Map map[string]string\ntype l2Map map[string]l3Map\ntype l1Map map[string]l2Map\n\nfunc main() {\n\n    data := l1Map{\n        \"1111\": l2Map{\n            \"la1\": l3Map{\n                \"lb1\": \"1343584765\",\n                \"lb2\": \"1545438458\",\n            },\n        },\n    }\n\n    fmt.Printf(\"%v\\n\", data[\"1111\"][\"la1\"][\"lb2\"])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/daKjDbX8Ao\" rel=\"nofollow\">https://play.golang.org/p/daKjDbX8Ao</a></p>\n"}], "owner": {"reputation": 719, "user_id": 1330374, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/uQQuJ.png?s=128&g=1", "display_name": "tripRev", "link": "https://stackoverflow.com/users/1330374/triprev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37703098, "answer_count": 1, "score": 0, "last_activity_date": 1465390433, "creation_date": 1465380031, "last_edit_date": 1465381209, "question_id": 37699297, "link": "https://stackoverflow.com/questions/37699297/storing-accessing-nested-data-in-go-use-structs", "title": "Storing/accessing nested data in Go - use structs?", "body": "<p>I need to maintain some data internally in my go code: an ID nested multiple levels deep, which is to be accessed when the names of the parent props are provided. If writing in JavaScript for example, I'd do something like:</p>\n\n<pre><code>var data = {\n    1111: {\n        la1: {\n            lb1: 1343584765,\n            lb2: 1545438458\n        },\n        la2: {\n            lb1: 1263268535,\n            lb2: 1468904679\n        }\n    },\n    2222: {\n        la1: {\n            lb1: 1645078365,\n            lb2: 1457732458\n        },\n        la2: {\n            lb1: 1682974682,\n            lb2: 1782975685\n        }\n    }\n}\n</code></pre>\n\n<p>and then access like this (yes the top prop needs to be an int):</p>\n\n<pre><code>data[1111]['la1']['la2'] //gets 1343584765\n</code></pre>\n\n<p>but I can't see how to build this structure with Go structs, and most things I read advise against doing it that way. The only other way I can see is to use this logic in Go, but it feels messy and this may get bigger and therefore hard to maintain:</p>\n\n<pre><code>func getVal(\n    varA int,\n    varB string,\n    varC string,\n) int {\n    if varA == 1111 {\n        if varB == \"la1\" {\n            if varC == \"lb1\" {\n                return 1343584765\n            }\n            if varC == \"lb2\" {\n                return 1545438458\n            }\n        }\n        if varB == \"la2\" {\n            if varC == \"lb1\" {\n                return 1263268535\n            }\n            if varC == \"lb2\" {\n                return 1468904679\n            }\n        }\n    }\n    if varA == 2222 {\n    ....etc\n</code></pre>\n\n<p>and then access with:</p>\n\n<pre><code>getVal(1111, \"la1\", \"lb1\") //gets 1343584765\n</code></pre>\n\n<p>Big thanks to anyone who can help me out a bit!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465389722, "post_id": 37698624, "comment_id": 62879643, "body": "I&#39;m fairly certain that was a bug in go1.4. go1.4 is no longer supported for anything other than bootstrapping the compiler, so it would be much better to upgrade to a current version."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465389804, "post_id": 37698624, "comment_id": 62879706, "body": "IIRC a workaround for go1.4 may have been to build the entire toolchain with <code>CGO_ENABLED=0</code>, you can give that a try."}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1465378348, "creation_date": 1465378348, "question_id": 37698624, "link": "https://stackoverflow.com/questions/37698624/compile-statically-linked-test-binary-for-code-using-net-package-in-go-1-4-2", "title": "compile statically linked test binary for code using net package in go 1.4.2", "body": "<p>I am trying to create statically linked test binary for code which uses <code>net</code> package. But it gives me dynamically linked test binary. \nMy code:</p>\n\n<pre><code>package main\n\nimport \"net\"\n\nfunc main() {\n    net.ParseIP(\"1.1.1.1\")\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc TestMain(t *testing.T) {\n    main()\n}\n</code></pre>\n\n<p>I run command:</p>\n\n<pre><code>CGO_ENABLED=0 go test -c -installsuffix netgo -a -o ./static  &amp;&amp; file ./static &amp;&amp; ldd ./static\n</code></pre>\n\n<p>it gives:</p>\n\n<pre><code>./static: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), not stripped\nlinux-vdso.so.1 =&gt;  (0x00007fffa1491000)\nlibpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f3ed433c000)\nlibc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f3ed3f77000)\n/lib64/ld-linux-x86-64.so.2 (0x00007f3ed455a000)\n</code></pre>\n\n<p>If create non-test binary it works as I expect:</p>\n\n<pre><code>CGO_ENABLED=0 go build -installsuffix netgo -a -o ./static  &amp;&amp; file ./static &amp;&amp; ldd ./static\n./static: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), statically linked, not stripped\nnot a dynamic executable\n</code></pre>\n\n<p>If I remove <code>net</code> package dependency or use go <code>1.6</code>, I can compile statically linked test binary. But I need do it with go 1.4.2 and <code>net</code> package dependency.</p>\n\n<p>Also, I tried more flags:</p>\n\n<pre><code>go test -c -installsuffix netgo,cgo -tags netgo,cgo -ldflags '-s' -a -o ./static &amp;&amp; file ./static &amp;&amp; ldd ./static\n</code></pre>\n\n<p>But it gives me dynamically linked binary anyway.</p>\n"}, {"tags": ["go", "time"], "answers": [{"comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 25, "creation_date": 1465381686, "post_id": 37697537, "comment_id": 62874208, "body": "I&#39;d prefer <code>AddDate</code> to subtracting 24 hours. If nothing else, there&#39;s a small window where &quot;subtract 24 hours&quot; may get you into &quot;2 days ago&quot; (between 00:00 and 00:59, day after the spring DST transition) and one where it may get you to &quot;today&quot; (23:00-24:00, day of autumn DST transition)."}, {"owner": {"reputation": 4572, "user_id": 1691769, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ca0f18d3562f80f2fb3f421e1c516ec7?s=128&d=identicon&r=PG", "display_name": "Peter Oram", "link": "https://stackoverflow.com/users/1691769/peter-oram"}, "edited": false, "score": 0, "creation_date": 1582648891, "post_id": 37697537, "comment_id": 106846680, "body": ".Add(-24*time.Hour) won&#39;t work. Mixing types. Will give error: invalid operation: -24 * time.Hour (mismatched types int and time.Duration)"}, {"owner": {"reputation": 71, "user_id": 5768508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eEZrN.png?s=128&g=1", "display_name": "ntsd", "link": "https://stackoverflow.com/users/5768508/ntsd"}, "edited": false, "score": 0, "creation_date": 1609830829, "post_id": 37697537, "comment_id": 115937395, "body": "what about <code>time.Now().Sub(24*time.Hour)</code>"}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 108, "last_activity_date": 1465382595, "last_edit_date": 1465382595, "creation_date": 1465375550, "answer_id": 37697537, "question_id": 37697285, "link": "https://stackoverflow.com/questions/37697285/how-to-get-yesterdays-date-in-golang/37697537#37697537", "title": "How to get yesterday&#39;s date in golang?", "body": "<p>Here's one way with <a href=\"https://golang.org/pkg/time/#Time.AddDate\"><code>AddDate</code></a>:</p>\n\n<pre><code>time.Now().AddDate(0, 0, -1)\n</code></pre>\n\n<h3>EDIT</h3>\n\n<p>The original answer also had a <a href=\"https://golang.org/pkg/time/#Time.Add\"><code>time.Add</code></a> suggestion: </p>\n\n<pre><code>fmt.Printf(\"Yesterday: %v\\n\", time.Now().Add(-24*time.Hour))\n</code></pre>\n\n<p>See Vatine's comment for reasons to prefer <code>AddDate</code>.</p>\n"}], "owner": {"reputation": 511, "user_id": 2950382, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/30JTb.jpg?s=128&g=1", "display_name": "saggaf.arsyad", "link": "https://stackoverflow.com/users/2950382/saggaf-arsyad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34373, "favorite_count": 4, "accepted_answer_id": 37697537, "answer_count": 1, "score": 44, "last_activity_date": 1537954401, "creation_date": 1465374943, "last_edit_date": 1537954401, "question_id": 37697285, "link": "https://stackoverflow.com/questions/37697285/how-to-get-yesterdays-date-in-golang", "title": "How to get yesterday&#39;s date in golang?", "body": "<p>How do I get yesterday's date in the <code>time.Time</code> struct in Go?</p>\n"}, {"tags": ["heroku", "go", "buildpack"], "answers": [{"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1465396261, "post_id": 37696761, "comment_id": 62884823, "body": "yes, Heroku basically does &quot;go install ./...&quot; which does exactly that, make a binary named after the dir that contains go files with the package declared as main"}, {"owner": {"reputation": 1025, "user_id": 4863734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/60aebd5ddf87a8d93a5f74eea8bc9a1d?s=128&d=identicon&r=PG", "display_name": "Ilya Rusin", "link": "https://stackoverflow.com/users/4863734/ilya-rusin"}, "edited": false, "score": 0, "creation_date": 1510345618, "post_id": 37696761, "comment_id": 81411771, "body": "I have the same error and can&#39;t make it work. I tried different names, but nothing happens, still <code>not found</code>..."}, {"owner": {"reputation": 301, "user_id": 2544072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1cd13f617f26cfdb405b4fae505b409?s=128&d=identicon&r=PG&f=1", "display_name": "brianarpie", "link": "https://stackoverflow.com/users/2544072/brianarpie"}, "edited": false, "score": 0, "creation_date": 1522557389, "post_id": 37696761, "comment_id": 86197040, "body": "Incase this might help others, it meant having a Procfile that looked like: &quot;web: &lt;app-directory-name&gt;&quot;"}], "tags": [], "owner": {"reputation": 1948, "user_id": 1548601, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fabb1f3db767a21f84f19a077ef5d83d?s=128&d=identicon&r=PG", "display_name": "Entalpi", "link": "https://stackoverflow.com/users/1548601/entalpi"}, "is_accepted": true, "score": 7, "last_activity_date": 1465373355, "creation_date": 1465373355, "answer_id": 37696761, "question_id": 37696549, "link": "https://stackoverflow.com/questions/37696549/heroku-golang-command-main-not-found/37696761#37696761", "title": "Heroku Golang - command &#39;main&#39; not found", "body": "<p>This was super simple once I realised this;</p>\n\n<blockquote>\n  <p>All main packages in the repo are compiled and binaries placed in the /app/bin directory, which is in the PATH. <strong>Binaries are named after the directory that contains them.</strong></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 1086647, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/14e5b65b387ab3a473ff1b116f9c0934?s=128&d=identicon&r=PG", "display_name": "blamblambunny", "link": "https://stackoverflow.com/users/1086647/blamblambunny"}, "is_accepted": false, "score": 0, "last_activity_date": 1552317912, "creation_date": 1552317912, "answer_id": 55105204, "question_id": 37696549, "link": "https://stackoverflow.com/questions/37696549/heroku-golang-command-main-not-found/55105204#55105204", "title": "Heroku Golang - command &#39;main&#39; not found", "body": "<p>Another thing to note: Like other Go programs, the code in <code>main.go</code> has to belong to package <code>main</code>:</p>\n\n<pre><code>package main\n\nfunc main() {\n    // your code here\n}\n\n</code></pre>\n\n<p>I'm afraid I totally forgot about this at first and it stumped me for a while.</p>\n"}], "owner": {"reputation": 1948, "user_id": 1548601, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/fabb1f3db767a21f84f19a077ef5d83d?s=128&d=identicon&r=PG", "display_name": "Entalpi", "link": "https://stackoverflow.com/users/1548601/entalpi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1370, "favorite_count": 0, "accepted_answer_id": 37696761, "answer_count": 2, "score": 4, "last_activity_date": 1552317912, "creation_date": 1465372745, "question_id": 37696549, "link": "https://stackoverflow.com/questions/37696549/heroku-golang-command-main-not-found", "title": "Heroku Golang - command &#39;main&#39; not found", "body": "<p>I got a Go API up on Heroku to which I push some code; in my procfile I have the following</p>\n\n<pre><code>web: main\n</code></pre>\n\n<p>In order to launch the Go built binary on Heroku's side. When I build it on my side with </p>\n\n<pre><code>go build cmd/main.go\n</code></pre>\n\n<p>It produces a binary file namned 'main' in my project root and works as expected but on Heroku I get </p>\n\n<pre><code>app[web.1]: bash: main: No such file or directory\n</code></pre>\n\n<p>The build process on Heroku seems fine, it finds all my dependencies and installs/compiles it all.</p>\n"}, {"tags": ["go", "websocket", "ping", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 485, "user_id": 5404251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca2027ddbfb95aec818ebc21e7b3717?s=128&d=identicon&r=PG&f=1", "display_name": "Anil", "link": "https://stackoverflow.com/users/5404251/anil"}, "edited": false, "score": 0, "creation_date": 1550497312, "post_id": 37705481, "comment_id": 96279180, "body": "In the chat example, the frontend side seems to have nothing about ping-pong. Is it handled only on the backend side?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 485, "user_id": 5404251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ca2027ddbfb95aec818ebc21e7b3717?s=128&d=identicon&r=PG&f=1", "display_name": "Anil", "link": "https://stackoverflow.com/users/5404251/anil"}, "edited": false, "score": 1, "creation_date": 1550502889, "post_id": 37705481, "comment_id": 96282600, "body": "@anil  The front end automatically responds to PING with a PONG.  No code is required."}, {"owner": {"reputation": 847, "user_id": 3172290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MIH9i.jpg?s=128&g=1", "display_name": "aniztar", "link": "https://stackoverflow.com/users/3172290/aniztar"}, "edited": false, "score": 0, "creation_date": 1600673620, "post_id": 37705481, "comment_id": 113150144, "body": "Would re-setting read dead line after every read alone work?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 847, "user_id": 3172290, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MIH9i.jpg?s=128&g=1", "display_name": "aniztar", "link": "https://stackoverflow.com/users/3172290/aniztar"}, "edited": false, "score": 1, "creation_date": 1600703936, "post_id": 37705481, "comment_id": 113164567, "body": "@aniztar Setting the read deadline before each read works if the application has a known upper bound for when the next message should be received at that upper bound is acceptable for detecting disconnects."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 19, "last_activity_date": 1465396369, "creation_date": 1465396369, "answer_id": 37705481, "question_id": 37696527, "link": "https://stackoverflow.com/questions/37696527/go-gorilla-websockets-on-ping-pong-fail-user-disconnct-call-function/37705481#37705481", "title": "Go Gorilla Websockets ~ On ping/pong fail (user disconnct) call function?", "body": "<p>The application should close the connection and cleanup variables and such when the read methods (NextReader, ReadMessage) return an error.</p>\n\n<p>Use ping/pong to detect disconnects.  The <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"noreferrer\">chat example</a> shows how to do this.</p>\n\n<ul>\n<li><a href=\"https://github.com/gorilla/websocket/blob/a68708917c6a4f06314ab4e52493cc61359c9d42/examples/chat/conn.go#L111\" rel=\"noreferrer\">Send pings</a> on a regular interval.</li>\n<li><a href=\"https://github.com/gorilla/websocket/blob/a68708917c6a4f06314ab4e52493cc61359c9d42/examples/chat/conn.go#L56\" rel=\"noreferrer\">Set read deadline</a> to a time less than next expected pong.</li>\n<li><a href=\"https://github.com/gorilla/websocket/blob/a68708917c6a4f06314ab4e52493cc61359c9d42/examples/chat/conn.go#L57\" rel=\"noreferrer\">Reset the read deadline</a> when a pong is received.</li>\n</ul>\n\n<p>If a pong goes missing, the read methods will return with the read past deadline error.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10517, "favorite_count": 7, "accepted_answer_id": 37705481, "answer_count": 1, "score": 5, "last_activity_date": 1465396369, "creation_date": 1465372660, "question_id": 37696527, "link": "https://stackoverflow.com/questions/37696527/go-gorilla-websockets-on-ping-pong-fail-user-disconnct-call-function", "title": "Go Gorilla Websockets ~ On ping/pong fail (user disconnct) call function?", "body": "<p>I'm writing a chat program with Golang and Gorilla's Websocket toolkit.</p>\n\n<p>I'm wondering if there is a way to run a function whenever a user disconnects or a ping/pong message fails. I need this to remove them from variables and such. Is there any easy way to do this?</p>\n"}, {"tags": ["http", "go", "concurrency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1465373369, "post_id": 37696019, "comment_id": 62868626, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/37529511/process-management-for-the-go-webserver\">Process Management for the Go Webserver</a>"}], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 1, "last_activity_date": 1465371996, "creation_date": 1465371996, "answer_id": 37696318, "question_id": 37696019, "link": "https://stackoverflow.com/questions/37696019/golang-http-server-implementation/37696318#37696318", "title": "Golang http server implementation", "body": "<p>Job/Worker pattern is a well common go concurrency pattern suited for this task. </p>\n\n<p>Multiple goroutines can read from a single channel, distributing an amount of work between CPU cores, hence the workers name. In Go, this pattern is easy to implement - just start a number of goroutines with channel as parameter, and just send values to that channel - distributing and multiplexing will be done by Go runtime.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc worker(tasksCh &lt;-chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n    for {\n        task, ok := &lt;-tasksCh\n        if !ok {\n            return\n        }\n        d := time.Duration(task) * time.Millisecond\n        time.Sleep(d)\n        fmt.Println(\"processing task\", task)\n    }\n}\n\nfunc pool(wg *sync.WaitGroup, workers, tasks int) {\n    tasksCh := make(chan int)\n\n    for i := 0; i &lt; workers; i++ {\n        go worker(tasksCh, wg)\n    }\n\n    for i := 0; i &lt; tasks; i++ {\n        tasksCh &lt;- i\n    }\n\n    close(tasksCh)\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(36)\n    go pool(&amp;wg, 36, 50)\n    wg.Wait()\n}\n</code></pre>\n\n<p>All goroutines run in parallel, waiting for channel to give them work. The goroutines receive their work almost immediately one after another.</p>\n\n<p>Here is a great article about how you can handle 1 million requests per minute in go: <a href=\"http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/\" rel=\"nofollow\">http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/</a></p>\n"}], "owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 37696318, "answer_count": 1, "score": 0, "last_activity_date": 1465371996, "creation_date": 1465371140, "question_id": 37696019, "link": "https://stackoverflow.com/questions/37696019/golang-http-server-implementation", "title": "Golang http server implementation", "body": "<p>I have read that net/http starts a go subroutine for each connection. I have few questions. But I haven't seen any parameter to limit the number of spawned new go subroutines. For example, If I have to handle 1 million concurrent requests per second,  what will happen? Do we have any control over spawned go subroutines? If it spawns one go subroutine per connection, won't it choke my entire system? What is the recommended way of handling huge number of concurrent requests for a go webserver? I have to handle both cases of responses being asynchronous and synchronous.  </p>\n"}, {"tags": ["sorting", "go"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": false, "score": 20, "last_activity_date": 1465368801, "creation_date": 1465368801, "answer_id": 37695248, "question_id": 37695209, "link": "https://stackoverflow.com/questions/37695209/golang-sort-slice-ascending-or-descending/37695248#37695248", "title": "golang sort slice ascending or descending", "body": "<p>You're looking for <a href=\"https://golang.org/pkg/sort/#example_Reverse\" rel=\"noreferrer\"><code>sort.Reverse</code></a>. That will let you say:</p>\n\n<pre><code>sort.Sort(sort.Reverse(fooAscending(s)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 0, "creation_date": 1589528829, "post_id": 40932847, "comment_id": 109335630, "body": "Sadly it&#39;s restricted on int type"}, {"owner": {"reputation": 8155, "user_id": 2008247, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wis7M.jpg?s=128&g=1", "display_name": "Jan Bodnar", "link": "https://stackoverflow.com/users/2008247/jan-bodnar"}, "reply_to_user": {"reputation": 573, "user_id": 6328514, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yae7F.jpg?s=128&g=1", "display_name": "Lewis Chan", "link": "https://stackoverflow.com/users/6328514/lewis-chan"}, "edited": false, "score": 4, "creation_date": 1603193593, "post_id": 40932847, "comment_id": 113953171, "body": "@LewisChan it is not restricted on int types; the int parameters are indexes to the slice, which can be a slice of strings."}], "tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": true, "score": 74, "last_activity_date": 1571583855, "last_edit_date": 1571583855, "creation_date": 1480683628, "answer_id": 40932847, "question_id": 37695209, "link": "https://stackoverflow.com/questions/37695209/golang-sort-slice-ascending-or-descending/40932847#40932847", "title": "golang sort slice ascending or descending", "body": "<p>As of Go 1.8, there is an easier way to sort a slice that does not require you to define new types. You simply pass an anonymous function to the <code>sort.Slice</code> function.</p>\n\n<pre><code>a := []int{5, 3, 4, 7, 8, 9}\nsort.Slice(a, func(i, j int) bool {\n    return a[i] &lt; a[j]\n})\nfor _, v := range a {\n    fmt.Println(v)\n}\n</code></pre>\n\n<p>This will sort in ascending order, if you want the opposite, simply write <code>a[i] &gt; a[j]</code> in the anonymous function.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1820956"}, "is_accepted": false, "score": 13, "last_activity_date": 1493618213, "creation_date": 1493618213, "answer_id": 43714927, "question_id": 37695209, "link": "https://stackoverflow.com/questions/37695209/golang-sort-slice-ascending-or-descending/43714927#43714927", "title": "golang sort slice ascending or descending", "body": "<p>My answer below is based on the assumption that the slice that you are receiving from a third party package is of a basic Go type.</p>\n\n<p>To sort slices of basic types, use the sort package utilities. Here is an example that sorts a slice of string and a slice of int.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc main() {\n    sl := []string{\"mumbai\", \"london\", \"tokyo\", \"seattle\"}\n    sort.Sort(sort.StringSlice(sl))\n    fmt.Println(sl)\n\n    intSlice := []int{3,5,6,4,2,293,-34}\n    sort.Sort(sort.IntSlice(intSlice))\n    fmt.Println(intSlice)\n}\n</code></pre>\n\n<p>The output of the above is:</p>\n\n<pre><code>[london mumbai seattle tokyo]\n[-34 2 3 4 5 6 293]\n</code></pre>\n\n<p>Go to <a href=\"https://play.golang.org/p/_b8RCL3NpI\" rel=\"noreferrer\">Go Playground here</a> to try it out yourself.</p>\n\n<p>A few things of note:</p>\n\n<ol>\n<li><p>Sorting basic Go types does not require implementing functions such as Len() that belong to sort.Interface. You need to take that route only for composite types.</p></li>\n<li><p>Just wrap the type of a basic type using an appropriate Interface method provider, e.g. <a href=\"https://golang.org/pkg/sort/#StringSlice\" rel=\"noreferrer\">StringSlice</a>, <a href=\"https://golang.org/pkg/sort/#IntSlice\" rel=\"noreferrer\">IntSlice</a>, or <a href=\"https://golang.org/pkg/sort/#Float64Slice\" rel=\"noreferrer\">Float64Slice</a>, and sort.</p></li>\n<li><p>The slice is sorted in-place, and hence does not return a copy of the sorted slice.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 7237632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4a011acefeebe877179809773b53184?s=128&d=identicon&r=PG&f=1", "display_name": "Golang", "link": "https://stackoverflow.com/users/7237632/golang"}, "is_accepted": false, "score": -1, "last_activity_date": 1597290443, "creation_date": 1597290443, "answer_id": 63387856, "question_id": 37695209, "link": "https://stackoverflow.com/questions/37695209/golang-sort-slice-ascending-or-descending/63387856#63387856", "title": "golang sort slice ascending or descending", "body": "<pre><code>`var names = []string{&quot;b&quot;, &quot;a&quot;, &quot;e&quot;, &quot;c&quot;, &quot;d&quot;}\n    sort.Strings(names)\n    fmt.Println(&quot;Sorted in alphabetical order&quot;, names)\n    sort.Sort(sort.Reverse(sort.StringSlice(names)))\n    fmt.Println(&quot;Sorted in reverse order&quot;, names)`\n</code></pre>\n<p>link for The Go Playgound <a href=\"https://play.golang.org/p/Q8KY_JE__kx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Q8KY_JE__kx</a></p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45829, "favorite_count": 5, "accepted_answer_id": 40932847, "answer_count": 4, "score": 33, "last_activity_date": 1597290443, "creation_date": 1465368700, "last_edit_date": 1545820127, "question_id": 37695209, "link": "https://stackoverflow.com/questions/37695209/golang-sort-slice-ascending-or-descending", "title": "golang sort slice ascending or descending", "body": "<p>I need to sort a slice of a type that is coming from a 3rdparty package. Based on some condition the order must be ascending or descending.</p>\n\n<p>The solution I come up with is:</p>\n\n<pre><code>type fooAscending []foo\n\nfunc (v fooAscending) Len() int           { return len(v) }\nfunc (v fooAscending) Swap(i, j int)      { v[i], v[j] = v[j], v[i] }\nfunc (v fooAscending) Less(i, j int) bool { return v[i].Amount &lt; v[j].Amount }\n\ntype fooDescending []foo\n\nfunc (v fooDescending) Len() int           { return len(v) }\nfunc (v fooDescending) Swap(i, j int)      { v[i], v[j] = v[j], v[i] }\nfunc (v fooDescending) Less(i, j int) bool { return v[i].Amount &gt; v[j].Amount }\n\nif someCondition {\n    sort.Sort(fooAscending(array))\n} else {\n    sort.Sort(fooDescending(array))\n}\n</code></pre>\n\n<p>Is there a better way to do this. 13 lines of code for this task and most of it is duplicated, seems a bit too much.</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1465368450, "post_id": 37694980, "comment_id": 62865706, "body": "To convert it directly to int64 is not enough? <code>y := int64(x)</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465369057, "post_id": 37694980, "comment_id": 62866058, "body": "Related, answers your question as well: <a href=\"http://stackoverflow.com/questions/34701187/go-byte-to-little-big-endian-signed-integer-or-float\">Go byte slice to Little/Big-Endian Signed Integer or Float?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 5, "last_activity_date": 1465369041, "last_edit_date": 1465369041, "creation_date": 1465368676, "answer_id": 37695202, "question_id": 37694980, "link": "https://stackoverflow.com/questions/37694980/convert-one-pointer-to-another-type-in-golang/37695202#37695202", "title": "Convert one pointer to another type in golang", "body": "<blockquote>\n  <p>That is, I want to read the binary contents of the float64 register as\n  if it is a int64 value.</p>\n</blockquote>\n\n<p>Try <code>math.Float64bits</code>:</p>\n\n<pre><code>x := float64(1.2)\nfmt.Printf(\"Ans:  %x\", math.Float64bits(x))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/QB4jqwJD0f\" rel=\"nofollow\">https://play.golang.org/p/QB4jqwJD0f</a></p>\n\n<p>Prints <code>Ans: 3ff3333333333333</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": false, "score": 1, "last_activity_date": 1465487563, "creation_date": 1465487563, "answer_id": 37730825, "question_id": 37694980, "link": "https://stackoverflow.com/questions/37694980/convert-one-pointer-to-another-type-in-golang/37730825#37730825", "title": "Convert one pointer to another type in golang", "body": "<p>Go doesn't allow conversions between different types of pointers as it is inherently unsafe. But, if you still want to do it there is a <code>Pointer</code> type in <code>unsafe</code> package, which represents a pointer to an arbitrary type. </p>\n\n<p>Any type of pointer can be converted to <code>unsafe.Pointer</code> and <code>unsafe.Pointer</code> can be converted to any type of pointer as long as they have the same memory structure. This allows you to ignore the type system and interpret any type of data as data of any other type.</p>\n\n<p>The exact equivalent of the C code in your example in Go would be:</p>\n\n<pre><code>var y int64\nvar x float64 = 1.2\ny = *(*int64)(unsafe.Pointer(&amp;x))\n</code></pre>\n\n<p>So first we convert <code>&amp;x</code> to <code>unsafe.Pointer</code>, then convert that to <code>*int64</code> and finally dereference that to get an <code>int64</code> with the same bit structure as <code>x</code>.</p>\n\n<p>Remember that there is a reason this is in <code>unsafe</code> package. If you just want to know what the bits are, it's better to use <code>math.Float64bits()</code>. But if for example you must use bitwise operators on <code>float</code> then of course you have to convert it to <code>int</code> (and back).</p>\n"}], "owner": {"reputation": 513, "user_id": 5673789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ade403dabcac1cdd5cd25bbd600f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jsmith", "link": "https://stackoverflow.com/users/5673789/jsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3276, "favorite_count": 0, "accepted_answer_id": 37695202, "answer_count": 2, "score": 1, "last_activity_date": 1465487563, "creation_date": 1465367959, "question_id": 37694980, "link": "https://stackoverflow.com/questions/37694980/convert-one-pointer-to-another-type-in-golang", "title": "Convert one pointer to another type in golang", "body": "<p>I want to convert a float64 number into int64 number. That is, I want to read the binary contents of the float64 register as if it is a int64 value. I mean, I want the go equivalent of the following C code</p>\n\n<pre><code>long y;\nfloat x = 1.2;\ny  = * ( long * ) &amp;x;\n</code></pre>\n\n<p>How do I do that?</p>\n\n<p>Here is my try which is not working.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    x := float64(1.2)\n    y := *((*int64)(&amp;x))\n\n    fmt.Println(\"Ans:  \", y)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 588, "user_id": 1039765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1b26b10cbaeb0be72a8232a1056d19d?s=128&d=identicon&r=PG", "display_name": "Reekdeb Mal", "link": "https://stackoverflow.com/users/1039765/reekdeb-mal"}, "is_accepted": true, "score": 1, "last_activity_date": 1465367210, "last_edit_date": 1495542709, "creation_date": 1465367210, "answer_id": 37694779, "question_id": 37694272, "link": "https://stackoverflow.com/questions/37694272/what-does-mean-about-the-jsonmake-at-the-end-of-make-string-in-golang/37694779#37694779", "title": "What does mean about the `json:&quot;make&quot;` at the end of Make string in Golang?", "body": "<p>Tags are used by encoding packages like <code>encoding/json</code> or <code>encoding/xml</code> to control how fields are interpreted during encoding and decoding. Uses of tags are already discussed in this thread: <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">What are the use(s) for tags in Go?</a></p>\n"}], "owner": {"reputation": 248, "user_id": 5510414, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/CyqIu.png?s=128&g=1", "display_name": "Will_Z", "link": "https://stackoverflow.com/users/5510414/will-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "closed_date": 1465391546, "accepted_answer_id": 37694779, "answer_count": 1, "score": -1, "last_activity_date": 1465367210, "creation_date": 1465365215, "question_id": 37694272, "link": "https://stackoverflow.com/questions/37694272/what-does-mean-about-the-jsonmake-at-the-end-of-make-string-in-golang", "closed_reason": "Duplicate", "title": "What does mean about the `json:&quot;make&quot;` at the end of Make string in Golang?", "body": "<p>I am working on some Golang source code, and confusing on Program syntax as below.\nWhat does mean about the <code>json:\"make\"</code> at the end of Make string in Golang?</p>\n\n<pre><code>type Vehicle struct {\n    Make            string `json:\"make\"`\n    Model           string `json:\"model\"`\n    Reg             string `json:\"reg\"`\n    VIN             int    `json:\"VIN\"`                 \n    Owner           string `json:\"owner\"`\n    Scrapped        bool   `json:\"scrapped\"`\n    Status          int    `json:\"status\"`\n    Colour          string `json:\"colour\"`\n    V5cID           string `json:\"v5cID\"`\n    LeaseContractID string `json:\"leaseContractID\"`\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 2, "creation_date": 1465364727, "post_id": 37693940, "comment_id": 62863984, "body": "Consider posting the relevant code here. We do need <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a> in here."}, {"owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "reply_to_user": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1465364967, "post_id": 37693940, "comment_id": 62864066, "body": "@J.Chomel sorry for that, but the code is too long, stackoverflow does not allow to post if the question contains most of code."}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 1, "creation_date": 1465365723, "post_id": 37693940, "comment_id": 62864383, "body": "Code too long: That is why I advise you should create an MVCE. But if you don&#39;t have it, someone might take the required time to help you, who knows."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465390532, "post_id": 37693940, "comment_id": 62880235, "body": "What are <code>errors(IO wait)</code>? (and there are much better tools than <code>ab</code>, which might be part of your problem)"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1465399167, "creation_date": 1465399167, "answer_id": 37706622, "question_id": 37693940, "link": "https://stackoverflow.com/questions/37693940/what-is-wrong-in-my-gos-codeio-wait/37706622#37706622", "title": "What is wrong in my go&#39;s code(IO wait)?", "body": "<p>First: no reason to use reflect here.  Has nothing to do with your problem, but it isn't needed.</p>\n\n<p>In your setup of Context, you are using a global var for ctx.</p>\n\n<p>go's http server is concurrent, so what you are doing is having multiple goroutines update the same global var and then pass that to the handler.</p>\n\n<p>This causes your handlers to sometimes get the same ResponseWriter instance and attempt to write to it.  This can cause <code>ab</code> to fail since you are writing invalid http responses by mixing what gets sent on the wire.</p>\n\n<p>Get rid of global ctx variable and use a local one, like below:</p>\n\n<pre><code>func handler(rw http.ResponseWriter, r *http.Request) {\n    ctx := &amp;Context{ // notice that this is a local var now\n        names:make([]string, 0),\n        rw:rw,\n        r:r,\n    }\n\n    for i := 0; i &lt; len(middlewareInfos); i++ {\n        middleware := reflect.New(middlewareInfos[i].t)\n\n        setContextMethod := middleware.MethodByName(\"SetContext\")\n        setContextMethod.Call([]reflect.Value{reflect.ValueOf(ctx)})\n\n        handleMethod := middleware.MethodByName(\"Handle\")\n        values := handleMethod.Call([]reflect.Value{})\n\n        if value, ok := values[0].Interface().(bool); !ok || !value {\n            return\n        }\n    }\n\n    // fmt.Printf(\"%v\\n\", ctx)\n\n    fmt.Fprint(rw, \"Hello World.\")\n}\n</code></pre>\n"}], "owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 37706622, "answer_count": 1, "score": 0, "last_activity_date": 1465399167, "creation_date": 1465363877, "question_id": 37693940, "link": "https://stackoverflow.com/questions/37693940/what-is-wrong-in-my-gos-codeio-wait", "title": "What is wrong in my go&#39;s code(IO wait)?", "body": "<p>What is wrong in my go's code(IO wait)?</p>\n\n<p>I design my middlewares but reached errors(IO wait) when i run the command:</p>\n\n<pre><code>ab -c 100 -n 100000 -k  http://127.0.0.1:10000/\n</code></pre>\n\n<p>The complete code is as follows:\n<a href=\"https://github.com/HeadwindFly/examples/blob/master/middleware.go\" rel=\"nofollow\">https://github.com/HeadwindFly/examples/blob/master/middleware.go</a></p>\n"}, {"tags": ["rest", "go", "firebase"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1465356941, "post_id": 37692197, "comment_id": 62861615, "body": "This might be better asked on the Go mailing list: <a href=\"https://groups.google.com/forum/?fromgroups#!forum/golang-nuts\" rel=\"nofollow noreferrer\">groups.google.com/forum/?fromgroups#!forum/golang-nuts</a>"}, {"owner": {"reputation": 9476, "user_id": 1155801, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2ZLGy.png?s=128&g=1", "display_name": "appbootup", "link": "https://stackoverflow.com/users/1155801/appbootup"}, "edited": false, "score": 3, "creation_date": 1470136844, "post_id": 37692197, "comment_id": 64814062, "body": "The question makes sense to me. Stack overflow is now just filled with dead end queries closed by zealots :("}, {"owner": {"reputation": 75620, "user_id": 23643, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Efp8C.jpg?s=128&g=1", "display_name": "Alex B", "link": "https://stackoverflow.com/users/23643/alex-b"}, "edited": false, "score": 0, "creation_date": 1479991650, "post_id": 37692197, "comment_id": 68796115, "body": "This is a good question and I don&#39;t know why it&#39;s closed."}], "owner": {"reputation": 79, "user_id": 5880988, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kblClddhVTo/AAAAAAAAAAI/AAAAAAACB7k/CymW6_KcP6g/photo.jpg?sz=128", "display_name": "lee preimesberger", "link": "https://stackoverflow.com/users/5880988/lee-preimesberger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 3, "closed_date": 1465369572, "answer_count": 0, "score": 7, "last_activity_date": 1465352019, "creation_date": 1465352019, "question_id": 37692197, "link": "https://stackoverflow.com/questions/37692197/any-documented-rest-golang-api-for-the-new-firebase", "closed_reason": "Not suitable for this site", "title": "Any documented REST/Golang API for the &#39;new&#39; Firebase?", "body": "<p>Has anyone seen note of if the <strong>REST</strong> API's are being continued for the new Firebase (I don't know what to call it other than 'new' - the current updates that were announced at Google I/O).  I asked support - but I'm a few days in without a response.  Just trying REST with random parameters on a new format index didn't do anything useful.</p>\n\n<p>The updates look really good - but I have a lot of already existing REST code (mostly from Go) and I don't know what to do other than dig through the JavaScript and start hacking the Go libraries.  If I'm going to get cut off there's not point even starting, and if there's an official interface on the way it's definitely not worth messing with.  </p>\n\n<p>Any help appreciated.  :)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1465353280, "post_id": 37692170, "comment_id": 62860836, "body": "run <code>godoc -http=:6060</code> then navigate to localhost:6060 you will have godocs to lookup context (context is the best choice)"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1465353888, "post_id": 37692170, "comment_id": 62860961, "body": "i have used <code>gin-gonic&#47;gin</code> for middlewares and used <code>func (c *Context) Set(key string, value interface{}) { ... }</code> to store <code>value</code> by <code>key</code> on the context, and <code>func (c *Context) Get(key string) (value interface{}, exists bool) { ... }</code> to look them up. You may need to type cast <code>value</code>"}, {"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1465354844, "post_id": 37692170, "comment_id": 62861176, "body": "This is the discussion thread about the new net/context implementation in go 1.7.1 <a href=\"https://github.com/golang/go/issues/14660\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14660</a> . If you cannot get 1.7.1 yet here is a variation which is easy and fast. <a href=\"https://github.com/goodfoo/requestcontext/blob/master/example/example.go\" rel=\"nofollow noreferrer\">github.com/goodfoo/requestcontext/blob/master/example/&hellip;</a>"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465360369, "post_id": 37692170, "comment_id": 62862539, "body": "Viper can be nice to: <a href=\"https://github.com/spf13/viper/\" rel=\"nofollow noreferrer\">github.com/spf13/viper</a>"}], "owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1465351821, "creation_date": 1465351821, "question_id": 37692170, "link": "https://stackoverflow.com/questions/37692170/how-to-share-data-in-go-s-middlewares-efficiently", "title": "How to share data in go\u2018s middlewares efficiently?", "body": "<p>How to share data in go\u2018s middlewares efficiently?</p>\n\n<p>Known solutions:</p>\n\n<ol>\n<li><p>Global map[interface{}]interface{}, it need type assertion and mutex, it is not i want.</p></li>\n<li><p>Standard library: <strong>x/net/context</strong>, but I can not visit the <strong>golang.org</strong>(blocked by Great Firewall of China), \ncan somebody provides some examples or articles? Thanks.</p></li>\n</ol>\n\n<p>Could somebody tell me what other efficient solution?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1465350654, "post_id": 37691904, "comment_id": 62860283, "body": "Some background here: <a href=\"https://cloud.google.com/appengine/articles/deadlineexceedederrors#Slow_Loading_Apps\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/articles/&hellip;</a>"}, {"owner": {"reputation": 437, "user_id": 1922771, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UTA6Q.jpg?s=128&g=1", "display_name": "Javier Carmona", "link": "https://stackoverflow.com/users/1922771/javier-carmona"}, "reply_to_user": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 0, "creation_date": 1465351198, "post_id": 37691904, "comment_id": 62860391, "body": "There is nothing in the code that should cause this timeout... in my local this returns in less than 1 second. Removing the GetAll call and redeploying makes the timeout go away. I am experiencing the same error if I use a put instead of a GetAll..."}, {"owner": {"reputation": 3036, "user_id": 1431972, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TlLSH.jpg?s=128&g=1", "display_name": "Lawrence Mok", "link": "https://stackoverflow.com/users/1431972/lawrence-mok"}, "edited": false, "score": 0, "creation_date": 1465352825, "post_id": 37691904, "comment_id": 62860741, "body": "how many rows do you have in Google&#39;s datastore vs local?"}, {"owner": {"reputation": 437, "user_id": 1922771, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UTA6Q.jpg?s=128&g=1", "display_name": "Javier Carmona", "link": "https://stackoverflow.com/users/1922771/javier-carmona"}, "edited": false, "score": 0, "creation_date": 1465353103, "post_id": 37691904, "comment_id": 62860794, "body": "I dont have a local datastore, just the local developer web server that talks to the Google&#39;s Datastore, which only contains 1 row."}], "answers": [{"tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": false, "score": 1, "last_activity_date": 1465885797, "creation_date": 1465885797, "answer_id": 37804505, "question_id": 37691904, "link": "https://stackoverflow.com/questions/37691904/using-datastore-from-app-engine-times-out-every-time/37804505#37804505", "title": "Using datastore from app engine times out every time", "body": "<p>The <code>datastore</code> packages uses <a href=\"https://google.golang.org/grpc\" rel=\"nofollow\">gRPC</a> to connect to the datastore service. You can't use this directly on App Engine, since you can't make TCP connections directly.</p>\n\n<p>You'll need to use the <code>sockets</code> API to make the TCP connection for you:</p>\n\n\n\n<pre class=\"lang-go prettyprint-override\"><code>import \"google.golang.org/appengine/socket\" // et al\n\nctx := appengine.NewContext(r)\nctx, cancel := context.WithTimeout(ctx, 5*time.Second)\ndefer cancel()\n\ndialer := func(addr string, timeout time.Duration) (net.Conn, error) {\n    return socket.DialTimeout(ctx, \"tcp\", addr, timeout)\n}\n\nclient, err := datastore.NewClient(ctx, \"app-id\", cloud.WithGRPCDialOption(grpc.WithDialer(dialer)))\n</code></pre>\n\n<p>You can also invoke <code>dialer</code> directly when debugging to make sure it is able to reach datastore.googleapis.com:443 as expected:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>conn, err := dialer(\"datastore.googleapis.com:443\", 5*time.Second)\nif err != nil {\n    log.Errorf(ctx, \"Dial: %v\", err)\n    http.Error(w, \"Dial failed: \"+err.Error(), http.StatusInternalServerError)\n    return\n}\nfmt.Fprintf(w, \"Addr: %v\\n\", conn.RemoteAddr())\nconn.Close()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 1, "creation_date": 1465988355, "post_id": 37815808, "comment_id": 63128159, "body": "This is definitely the right choice if you want to access the data for your own application! If you need to access the datastore from another project/app then you will need to use the <code>&#47;cloud&#47;</code> version instead unfortunately."}], "tags": [], "owner": {"reputation": 437, "user_id": 1922771, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UTA6Q.jpg?s=128&g=1", "display_name": "Javier Carmona", "link": "https://stackoverflow.com/users/1922771/javier-carmona"}, "is_accepted": true, "score": 1, "last_activity_date": 1465917374, "last_edit_date": 1465917374, "creation_date": 1465916880, "answer_id": 37815808, "question_id": 37691904, "link": "https://stackoverflow.com/questions/37691904/using-datastore-from-app-engine-times-out-every-time/37815808#37815808", "title": "Using datastore from app engine times out every time", "body": "<p>The solution for my problem was to switch the datastore library </p>\n\n<p>from: <code>\"google.golang.org/cloud/datastore\"</code></p>\n\n<p>to: <code>\"google.golang.org/appengine/datastore\"</code></p>\n\n<p>appengine/datastore seems to use a different protocol and makes it so that you do not have to use the GOOGLE_APPLICATION_CREDENTIALS environment variable to authenticate. It will use the dev server for the different app engine services when used locally and the cloud resources when deployed.</p>\n"}], "owner": {"reputation": 437, "user_id": 1922771, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/UTA6Q.jpg?s=128&g=1", "display_name": "Javier Carmona", "link": "https://stackoverflow.com/users/1922771/javier-carmona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 37815808, "answer_count": 2, "score": 0, "last_activity_date": 1474211373, "creation_date": 1465349356, "last_edit_date": 1474211373, "question_id": 37691904, "link": "https://stackoverflow.com/questions/37691904/using-datastore-from-app-engine-times-out-every-time", "title": "Using datastore from app engine times out every time", "body": "<p>I am playing with the google cloud environment for the first time specially with the google app engine and the datastore, everything works fine when I run it locally. I am authenticating with the datastore by setting the environment variable GOOGLE_APPLICATION_CREDENTIALS as per the documentation. But once I deploy to app engine the requests always time out, it seems as if the GetAll method never returns. Below is the code for my application:</p>\n\n<pre><code>package app\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n    \"golang.org/x/net/context\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/cloud/datastore\"\n)\n\ntype User struct {\n    FirstName string\n    LastName string\n    Email string\n    Created time.Time\n    id      int64\n}\n\nfunc init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    var err error\n    var dbClient *datastore.Client\n    var ctx context.Context\n\n    ctx = appengine.NewContext(r)\n\n    dbClient, err = datastore.NewClient(ctx, \"app-id\")//this has the real app id, not sure if this is meant to be secret\n    if err != nil {\n        fmt.Fprintf(w, \"Could not create datastore client: %+v\", err)\n        return\n    }\n    defer dbClient.Close()\n\n    var users []*User\n\n    query := datastore.NewQuery(\"User\").Filter(\"Email=\", \"jcarm010@fiu.edu\")\n    keys, err := dbClient.GetAll(ctx, query, &amp;users)\n    if err != nil {\n        fmt.Fprintf(w, \"Could not query users: %+v\", err)\n        return\n    }\n\n    for i, key := range keys {\n        users[i].id = key.ID()\n        fmt.Fprintf(w, \"%+v\\n\",users[i])\n    }\n    fmt.Fprintf(w, \"done!!!\")\n}\n</code></pre>\n\n<p>The errors in the App Engine logs have the following two lines:</p>\n\n<pre><code>This request caused a new process to be started for your application, and thus caused your application code to be loaded for the first time. This request may thus take longer and use more CPU than a typical request for your application.\n\nProcess terminated because the request deadline was exceeded. (Error code 123)\n</code></pre>\n\n<p>Btw, this finishes lightning fast on my local and there is only one record in my datastore. Any guess as to why this could be happening or how to debug it?\nThanks</p>\n"}, {"tags": ["go", "timer", "ticker"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465352782, "post_id": 37691887, "comment_id": 62860733, "body": "I don&#39;t understand the question. 12sec is always longer than 5sec; can you explain your rationale of how the time.After <i>would</i> fire in less than 5sec?"}, {"owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465353384, "post_id": 37691887, "comment_id": 62860856, "body": "I am not expecting it to fire in less than 5 seconds. I am expecting a tick at 5 seconds, another tick at 10 seconds and at 12 seconds, <code>time.After</code> should fire. However, unless I use <code>time.NewTimer</code> to create the timer, <code>time.After</code> never fires no matter how long I wait."}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": true, "score": 8, "last_activity_date": 1465353504, "creation_date": 1465353504, "answer_id": 37692361, "question_id": 37691887, "link": "https://stackoverflow.com/questions/37691887/why-does-time-after-never-fire-when-it-is-paired-with-a-ticker-in-a-select-block/37692361#37692361", "title": "Why does time.After never fire when it is paired with a ticker in a select block?", "body": "<p>A <code>select</code> blocks until one of its cases is ready, then it executes that case. In your example time.After() never gets called.</p>\n\n<pre><code>func main() {\n\n    ticker := time.NewTicker(5 * time.Second)\n    for {\n        select {\n        case z := &lt;-ticker.C:\n            fmt.Printf(\"tick %d\\n\", z)\n\n        //This never gets chance to be ready. It'll work if you make it less than 5 seconds.\n        case &lt;-time.After(12 * time.Second): \n            fmt.Println(\"12 seconds elapsed!\")\n        }\n    }\n}\n</code></pre>\n\n<p>You can get it working by having timer declared before <code>for</code> loop. </p>\n\n<pre><code>func main() {\n\n        ticker := time.NewTicker(5 * time.Second)\n        timer := time.After(12 * time.Second)\n        for {\n                select {\n                case z := &lt;-ticker.C:\n                        fmt.Printf(\"tick %d\\n\", z)\n\n                case &lt;-timer:\n                        fmt.Println(\"12 seconds elapsed!\")\n                }   \n        }   \n}   \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 2271091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7V94W.jpg?s=128&g=1", "display_name": "whiledoing", "link": "https://stackoverflow.com/users/2271091/whiledoing"}, "is_accepted": false, "score": 2, "last_activity_date": 1593141348, "creation_date": 1593141348, "answer_id": 62587485, "question_id": 37691887, "link": "https://stackoverflow.com/questions/37691887/why-does-time-after-never-fire-when-it-is-paired-with-a-ticker-in-a-select-block/62587485#62587485", "title": "Why does time.After never fire when it is paired with a ticker in a select block?", "body": "<p>The key is, when select is called, it will re-create the channel in all case clause. If you create a timer in <code>case &lt;- newCreateTimerChannel</code>, it will start a new timer. So put the timer creation outside the for loop to make it as a global timer.</p>\n"}], "owner": {"reputation": 28206, "user_id": 624884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/04a353473303cb908cd95f25277a4ba2?s=128&d=identicon&r=PG&f=1", "display_name": "F21", "link": "https://stackoverflow.com/users/624884/f21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1186, "favorite_count": 0, "accepted_answer_id": 37692361, "answer_count": 2, "score": 2, "last_activity_date": 1593141348, "creation_date": 1465349195, "question_id": 37691887, "link": "https://stackoverflow.com/questions/37691887/why-does-time-after-never-fire-when-it-is-paired-with-a-ticker-in-a-select-block", "title": "Why does time.After never fire when it is paired with a ticker in a select block?", "body": "<p>I have a select block that is listening on 2 channels, a ticker and a timer:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    ticker := time.NewTicker(5 * time.Second)\n    for {\n        select {\n        case z := &lt;-ticker.C:\n            fmt.Printf(\"tick %d\\n\", z)\n\n        case &lt;-time.After(12 * time.Second):\n            fmt.Println(\"12 seconds elapsed!\")\n        }\n    }\n}\n</code></pre>\n\n<p>If I run the code, the <code>time.After</code> case never runs, but the ticker works correctly.</p>\n\n<p>If I remove the ticker, <code>time.After</code> fires correctly:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    for {\n        select {\n        case &lt;-time.After(12 * time.Second):\n            fmt.Println(\"12 seconds elapsed!\")\n        }\n    }\n}\n</code></pre>\n\n<p>It works correctly if I used a timer rather than <code>time.After</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    ticker := time.NewTicker(5 * time.Second)\n    timer := time.NewTimer(12 * time.Second)\n    for {\n        select {\n        case z := &lt;-ticker.C:\n            fmt.Printf(\"tick %d\\n\", z)\n\n        case &lt;-timer.C:\n            fmt.Println(\"12 seconds elapsed!\")\n        }\n    }\n}\n</code></pre>\n\n<p>Why does this happen?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 714258, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/684d9992d72e5985bb177d5752ad80fc?s=128&d=identicon&r=PG", "display_name": "branco", "link": "https://stackoverflow.com/users/714258/branco"}, "is_accepted": false, "score": 1, "last_activity_date": 1465766080, "creation_date": 1465766080, "answer_id": 37779147, "question_id": 37691719, "link": "https://stackoverflow.com/questions/37691719/trying-to-put-an-entity-in-the-datastore-appears-to-put-only-a-key-and-not-the-a/37779147#37779147", "title": "Trying to put an entity in the datastore appears to put only a key and not the associated property I had in mind", "body": "<p>I found out that the problem was simply they way I was defining my structs. Instead of</p>\n\n<pre><code>type uemail_struct{\n    user_email string\n}\n</code></pre>\n\n<p>simply writing</p>\n\n<pre><code>type Uemail_struct{\n    User_email string\n}\n</code></pre>\n\n<p>fixes the program and now both adding new users and their login work.</p>\n"}], "owner": {"reputation": 107, "user_id": 714258, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/684d9992d72e5985bb177d5752ad80fc?s=128&d=identicon&r=PG", "display_name": "branco", "link": "https://stackoverflow.com/users/714258/branco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474211359, "creation_date": 1465347678, "last_edit_date": 1474211359, "question_id": 37691719, "link": "https://stackoverflow.com/questions/37691719/trying-to-put-an-entity-in-the-datastore-appears-to-put-only-a-key-and-not-the-a", "title": "Trying to put an entity in the datastore appears to put only a key and not the associated property I had in mind", "body": "<p>This is where I try to insert the entity with the email property. In the browser U can see that db_success is received. In the datastore viewer I can see that the entity was inserted by way of 2 writes which is suspiciously low, and browsing to the entity I can see the entity kind, the entity key and the ID, but nothing else:</p>\n\n<pre><code>    c := appengine.NewContext(r)\n    u := user.Current(c)\n\n    if u == nil || !user.IsAdmin(c) {\n        return\n    }\n\n    addrmv := r.FormValue(\"addrmv\")\n    user_email := r.FormValue(\"user_email\")\n    if addrmv == \"add\" {\n        if user_email == \"\" {\n            return\n        }\n        uemail := uemail_struct{\n            user_email: user_email,\n        }\n        _,err :=    datastore.Put(c,datastore.NewIncompleteKey(c,\"users\",nil),&amp;uemail)\n        if err != nil {\n            io.WriteString(w, \"\\\"result\\\":\\\"db_error\\\"\")\n        } else {\n            io.WriteString(w, \"\\\"result\\\":\\\"db_success\\\"\")\n        }\n    } else if addrmv == \"rmv\"{\n        return\n        //TODO expand\n    }\n</code></pre>\n\n<p>The other piece of code is where I want to restrict user access based on email. I try to do a datastore query on the email property of the entity that I inserted previously and redirect authorized accounts to the intended page and unauthorized accounts back to the app entry url:</p>\n\n<pre><code>c := appengine.NewContext(r)\nu := user.Current(c)\nif u == nil {\n    http.Redirect(w, r, \"/\", http.StatusSeeOther)\n} else if user.IsAdmin(c) {\n    io.WriteString(w, admins_choice_html)\n} else {\n    var emails []uemail_struct\n    q := datastore.NewQuery(\"users\").Filter(\"user_email =\", u.Email)\n    _,err := q.GetAll(c,&amp;emails)\n    if err != nil {\n        http.Redirect(w, r, \"/\", http.StatusSeeOther)\n    }\n    if len(emails) == 0 {\n        url, err := user.LogoutURL(c, \"/\")\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.Header().Set(\"Location\", url)\n        w.WriteHeader(http.StatusFound)\n\n    } else {\n        http.Redirect(w, r, \"/dist/index.html\", http.StatusSeeOther)\n    }\n}\n</code></pre>\n\n<p>I am certain that my test data and functionality for adding user emails was ok. Meaning that I executed the first piece of code for the data user@example.com email address and executed the second piece of code for the same user@example.com email address. The only conclusion I can come to is that the datastore put in the first piece of code did not insert the required property user_email with value user@example.com in the datastore.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8533, "user_id": 11792, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/057dba7b6fe7b933e5ee23f7dc64dcb5?s=128&d=identicon&r=PG", "display_name": "Pavel Nikolov", "link": "https://stackoverflow.com/users/11792/pavel-nikolov"}, "is_accepted": true, "score": 3, "last_activity_date": 1465367951, "last_edit_date": 1465367951, "creation_date": 1465342514, "answer_id": 37691095, "question_id": 37691028, "link": "https://stackoverflow.com/questions/37691028/command-line-application-install-using-golang/37691095#37691095", "title": "Command line application install using GoLang", "body": "<p>Check the documentation for the <a href=\"https://golang.org/cmd/go/\" rel=\"nofollow\">go build command</a></p>\n\n<pre><code>go build [-o output] [-i] [build flags] [packages]\n</code></pre>\n\n<blockquote>\n  <p>When compiling a single main package, build writes the resulting\n  executable to an output file named after the first source file ('go\n  build ed.go rx.go' writes 'ed' or 'ed.exe') or the source code\n  directory ('go build unix/sam' writes 'sam' or 'sam.exe'). The '.exe'\n  suffix is added when writing a Windows executable.</p>\n  \n  <p>When compiling multiple packages or a single non-main package, build\n  compiles the packages but discards the resulting object, serving only\n  as a check that the packages can be built.</p>\n  \n  <p>The -o flag, only allowed when compiling a single package, forces\n  build to write the resulting executable or object to the named output\n  file, instead of the default behavior described in the last two\n  paragraphs.</p>\n</blockquote>\n\n<p>Try building it like this <code>go build -o greet</code> and do not forget to add the resulting executable to your <code>$PATH</code> if you want it to be accessible from everywhere.   </p>\n\n<hr>\n\n<p>Alternatively, you can just 1) create an alias; or 2) symlink to the actual executable:</p>\n\n<ol>\n<li><code>alias greet='myproject'</code></li>\n<li><code>ln -s $GOPATH/bin/myproject greet</code> (the link will be created in the current dir)</li>\n</ol>\n"}], "owner": {"reputation": 25076, "user_id": 207524, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7204a1f9d3a10e3b044e2e8ca58c877?s=128&d=identicon&r=PG", "display_name": "Crystal", "link": "https://stackoverflow.com/users/207524/crystal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "accepted_answer_id": 37691095, "answer_count": 1, "score": 1, "last_activity_date": 1606561208, "creation_date": 1465342055, "last_edit_date": 1606561208, "question_id": 37691028, "link": "https://stackoverflow.com/questions/37691028/command-line-application-install-using-golang", "title": "Command line application install using GoLang", "body": "<p>I'm not sure how this would work but I'm basically trying to write a command line app that I can run commands and subcommands from.  I'm using this popular third party library for parsing command line parameters:</p>\n<p><a href=\"https://github.com/urfave/cli\" rel=\"nofollow noreferrer\">https://github.com/urfave/cli</a></p>\n<p>My problem is I have a project folder where my .go files will live:</p>\n<pre><code>MyProject\n</code></pre>\n<p>so even if in the code in my main.go file, using their example, I have:</p>\n<pre><code>package main\n\nimport (\n  &quot;fmt&quot;\n  &quot;os&quot;\n\n  &quot;github.com/urfave/cli&quot;\n)\n\nfunc main() {\n  app := cli.NewApp()\n  app.Name = &quot;greet&quot;\n  app.Usage = &quot;fight the loneliness!&quot;\n  app.Action = func(c *cli.Context) error {\n    fmt.Println(&quot;Hello friend!&quot;)\n    return nil\n  }\n\n  app.Run(os.Args)\n}\n</code></pre>\n<p>when I run <code>go install</code>,</p>\n<p>in my $GOPATH/bin directory, I actually get MyProject built.  And then when I run <code>MyProject</code> from the terminal, I get</p>\n<pre><code>USAGE:\nmyproject [global options] command [command options] [arguments...]\n</code></pre>\n<p>But in reality, I don't need the <code>myproject</code> command first.  Is there a way this is normally done with command line apps or third party packages to create command line apps so that I can run <code>greet</code> from the command line instead of <code>myproject</code> as the first command?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465343573, "post_id": 37690898, "comment_id": 62858825, "body": "what clients at causing the errors?"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465343811, "post_id": 37690898, "comment_id": 62858871, "body": "Google Chrome browser on PC."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465343876, "post_id": 37690898, "comment_id": 62858890, "body": "Or, maybe it is not me but crawlers? I don&#39;t know. How can I check the clients on the serverside?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465352840, "post_id": 37690898, "comment_id": 62860746, "body": "It&#39;s either malicious or broken clients. You normally ignore them."}], "answers": [{"comments": [{"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1465344227, "post_id": 37691230, "comment_id": 62858969, "body": "If there reason are crawlers, then how can I ignore errors and not log them if they are from crawlers? Or how can I know if an error is TLS handshake error?"}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1465344539, "post_id": 37691230, "comment_id": 62859047, "body": "There is a handshakeErr inside Conn struct, in <a href=\"https://golang.org/src/crypto/tls/conn.go\" rel=\"nofollow noreferrer\">golang.org/src/crypto/tls/conn.go</a>. But I do not know how to reach it from another package and compare if the errors are the same."}, {"owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1465354410, "post_id": 37691230, "comment_id": 62861087, "body": "Thanks for answer! I also get this error now: 2016/06/07 22:48:21 http2: server: error reading preface from client 46.249.229.7:49752: timeout waiting for client preface. Do you know what that might be?"}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "reply_to_user": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "edited": false, "score": 0, "creation_date": 1465357759, "post_id": 37691230, "comment_id": 62861814, "body": "i think its self explanatory =) Client connected using http2 and after initial connection he didnt sent preface frame in 10 seconds. After preface exchange connection is considered established. It is the first step after connection was passed over to your server from OS. <a href=\"https://github.com/bradfitz/http2/blob/master/server.go#L683\" rel=\"nofollow noreferrer\">github.com/bradfitz/http2/blob/master/server.go#L683</a>"}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1465351559, "last_edit_date": 1465351559, "creation_date": 1465343515, "answer_id": 37691230, "question_id": 37690898, "link": "https://stackoverflow.com/questions/37690898/keep-getting-random-tls-handshake-errors-in-go/37691230#37691230", "title": "Keep getting random TLS handshake errors in Go", "body": "<p>If I remember correctly. It is the issue when remote host does not support TLS connection even it was told to do. If you log those connection it will probably be crawlers with plain text HTTP request.</p>\n\n<p><strong>UDP</strong></p>\n\n<p>You error comes from here <a href=\"https://golang.org/src/crypto/tls/conn.go?s=17185:17253#L594\" rel=\"nofollow\">https://golang.org/src/crypto/tls/conn.go?s=17185:17253#L594</a> and it means client sends you bad Ciphertext (too big).  And it happens when you trying to Read from tls.Conn (or during handshake since it reads from connection itself). It returns you tls.RecordHeaderError as error, you can parse it's Msg field looking for this string.</p>\n\n<p>Anyway it happens because client send malformed request, it could be damaged packet or client how dont respect your TLS config, or portscanner, or bad proxy, lots of reasons. But at that state connection is unrecoverable.</p>\n\n<p>Check IP address you provided: <a href=\"http://169.229.3.91/\" rel=\"nofollow\">http://169.229.3.91/</a>, it says \"This is a research scanning machine from the University of California at Berkeley. This machine regularly conducts scans of the entire Internet so you may have been scanned as part of an ongoing research project.\"</p>\n"}], "owner": {"reputation": 911, "user_id": 4748214, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408837d80439552ffbc5b9b8a88a8dd?s=128&d=identicon&r=PG&f=1", "display_name": "Aiden", "link": "https://stackoverflow.com/users/4748214/aiden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1534, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465351559, "creation_date": 1465341124, "question_id": 37690898, "link": "https://stackoverflow.com/questions/37690898/keep-getting-random-tls-handshake-errors-in-go", "title": "Keep getting random TLS handshake errors in Go", "body": "<p>I keep getting this \"random\" TLS handshake error from time to time but I do not know specifically when this occurs, it just shows up all over the place in the logs.</p>\n\n<pre><code>2016/06/07 18:27:05 http: TLS handshake error from 169.229.3.91:53522: tls: oversized record received with length 34831\n</code></pre>\n\n<p>I got a Comodo PositiveSSL Certificate from namecheap.com. They sent me two files in email. One of the files they called the \"Apache bundle\"</p>\n\n<pre><code>Your Apache \"bundle\" file - mydomainname_com.ca-bundle\n</code></pre>\n\n<p>And the other one specific for my domain:</p>\n\n<pre><code>Your PositiveSSL Certificate - mydomainname_com.crt\n</code></pre>\n\n<p>I concatenated both of these files into an ssl-bundle.crt file. And use it with my private key which I generated on the server.</p>\n\n<p>I use them like this:</p>\n\n<pre><code>router := httprouter.New()\n\n// ...\n\ncertificate := \"/srv/ssl-bundle.crt\"\nprivateKey := \"/srv/mydomainname.com-2016.01.01.key\"\nlog.Fatal(http.ListenAndServeTLS(\":443\", certificate, privateKey, router))\n</code></pre>\n\n<p>Why do I keep getting this TLS handshake error? What can I do to prevent this from happening? It is not really breaking the site or denying connections. It doesn't seem that way. It looks like things are working. But I still get this error or warning in my logs and I do not know what to do about it. Am I not correctly using the files I have gotten from the certificate issuer?</p>\n\n<p>Let us assume that the Apache \"bundle\" file - mydomainname_com.ca-bundle, looked like this:</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\n(apache bundle block of string 1)\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n(apache bundle block of string 2)\n-----END CERTIFICATE-----\n</code></pre>\n\n<p>Basically two big blocks of generated string.</p>\n\n<p>And that my PositiveSSL Certificate - mydomainname_com.crt looked like this:</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\n(positivessl block of string)\n-----END CERTIFICATE-----\n</code></pre>\n\n<p>These were concatenated into a single ssl-bundle.crt file in this order:</p>\n\n<pre><code>-----BEGIN CERTIFICATE-----\n(positivessl block of string)\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n(apache bundle block of string 1)\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\n(apache bundle block of string 2)\n-----END CERTIFICATE-----\n</code></pre>\n\n<p>In the network tab in Chrome it says that it is valid https:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Ptm0P.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ptm0P.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What should I do?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "edited": false, "score": 0, "creation_date": 1465340913, "post_id": 37690778, "comment_id": 62858192, "body": "Thanks, what about the next one then? We already push the msg to messages. The first case should be executed, why still the default one?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1465342151, "post_id": 37690778, "comment_id": 62858514, "body": "You haven&#39;t sent <code>msg</code> to <code>messages</code>. That send doesn&#39;t execute because it would block; that&#39;s why the text printed from that case is &quot;no message sent&quot;."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": false, "score": 3, "last_activity_date": 1465340478, "creation_date": 1465340478, "answer_id": 37690778, "question_id": 37690753, "link": "https://stackoverflow.com/questions/37690753/select-in-channel/37690778#37690778", "title": "Select in channel", "body": "<p><code>messages</code> is unbuffered, and no other Go routine is blocked waiting for something to be received. Since the send operation will block, the <code>default</code> case is executed.</p>\n\n<p>Compare this to the behaviour of a <a href=\"https://play.golang.org/p/YM7iOtPsew\" rel=\"nofollow\">buffered channel</a> or <a href=\"https://play.golang.org/p/mn0YfQpV8j\" rel=\"nofollow\">when another Go routine is blocked reading on the channel</a>.</p>\n\n<p>From the <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow\">language specification</a>:</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. </li>\n  </ol>\n</blockquote>\n"}], "owner": {"reputation": 2820, "user_id": 1804543, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/u2EW6.jpg?s=128&g=1", "display_name": "WhatABeautifulWorld", "link": "https://stackoverflow.com/users/1804543/whatabeautifulworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1465341895, "creation_date": 1465340345, "last_edit_date": 1465341895, "question_id": 37690753, "link": "https://stackoverflow.com/questions/37690753/select-in-channel", "title": "Select in channel", "body": "<p>The following is one example code for select. I don't understand why the second select doesn't execute the first case? The output seems to be:</p>\n\n<pre><code>messages := make(chan string)\nsignals := make(chan bool)\n\n// Here's a non-blocking receive. If a value is\n// available on `messages` then `select` will take\n// the `&lt;-messages` `case` with that value. If not\n// it will immediately take the `default` case.\nselect {\ncase msg := &lt;-messages:\n    fmt.Println(\"received message\", msg)\ndefault:\n    fmt.Println(\"no message received\")\n}\n\n// A non-blocking send works similarly.\nmsg := \"hi\"\nselect {\ncase messages &lt;- msg:\n    fmt.Println(\"sent message\", msg)\ndefault:\n    fmt.Println(\"no message sent\")\n}\n\n// We can use multiple `case`s above the `default`\n// clause to implement a multi-way non-blocking\n// select. Here we attempt non-blocking receives\n// on both `messages` and `signals`.\nselect {\ncase msg := &lt;-messages:\n    fmt.Println(\"received message\", msg)\ncase sig := &lt;-signals:\n    fmt.Println(\"received signal\", sig)\ndefault:\n    fmt.Println(\"no activity\")\n}\n</code></pre>\n\n<p>After I run the code, the output:</p>\n\n<pre><code>no message received\nno message sent\nno activity\n</code></pre>\n\n<p>Updated: I know why the second select goes to default now. What about the third one?</p>\n"}, {"tags": ["go", "channel", "buffered"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1465339969, "post_id": 37690666, "comment_id": 62857949, "body": "A slice&#39;s type does not determine if it is buffered or not; that is determined when you <code>make</code> the channel."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 12, "last_activity_date": 1465340811, "last_edit_date": 1465340811, "creation_date": 1465340232, "answer_id": 37690735, "question_id": 37690666, "link": "https://stackoverflow.com/questions/37690666/create-a-slice-of-buffered-channel-in-golang/37690735#37690735", "title": "Create a slice of buffered channel in golang", "body": "<p>This statement <code>channels := make([]ch,5)</code> is simply allocating the container (the slice of channels which has a length of 5). In addition to that you have to initialize each channel individually which is when you would declare them as buffered rather than unbuffered. So extending your example just do this:</p>\n\n<pre><code>for i, _ := range channels {\n     channels[i] = make(chan int, BufferSize)\n}\n</code></pre>\n"}], "owner": {"reputation": 485, "user_id": 1352179, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9d5486c6e0256290898d2b48f0204049?s=128&d=identicon&r=PG", "display_name": "GoT", "link": "https://stackoverflow.com/users/1352179/got"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4809, "favorite_count": 0, "accepted_answer_id": 37690735, "answer_count": 1, "score": 3, "last_activity_date": 1465340811, "creation_date": 1465339825, "question_id": 37690666, "link": "https://stackoverflow.com/questions/37690666/create-a-slice-of-buffered-channel-in-golang", "title": "Create a slice of buffered channel in golang", "body": "<p>I couldn't find a way to create a slice of buffered channels in golang. I know how to create slice of unbuffered channel given as below</p>\n\n<pre><code>type ch chan int\nchannels := make([]ch,5)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1465332705, "post_id": 37688953, "comment_id": 62855145, "body": "From the documentation: &quot;Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new. &quot;"}, {"owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "edited": false, "score": 0, "creation_date": 1465338549, "post_id": 37688953, "comment_id": 62857537, "body": "Check out @jussius answer. Clear explanation"}], "answers": [{"comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1465332618, "post_id": 37689048, "comment_id": 62855110, "body": "The documentation would suggest that this isn&#39;t the case: <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Short_variable_declarations</a>"}, {"owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1465332923, "post_id": 37689048, "comment_id": 62855238, "body": "...may redeclare variables provided they were originally declared earlier in the <b>same block</b> (not the case @Dale)"}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 0, "creation_date": 1465337457, "post_id": 37689048, "comment_id": 62857127, "body": "Your code is correct, but the doc quote you posted is not actually what is happening here, as the redeclaration actually happens in a different block. Which, unlike short variable declarations in the same block, creates a whole new variable (which in this case is never used). See my answer for details."}, {"owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "reply_to_user": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 0, "creation_date": 1465338163, "post_id": 37689048, "comment_id": 62857400, "body": "You&#39;re right <code>redeclaring</code> was not the best word to define it. Thanks @jussius"}], "tags": [], "owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "is_accepted": false, "score": 5, "last_activity_date": 1465338260, "last_edit_date": 1465338260, "creation_date": 1465332427, "answer_id": 37689048, "question_id": 37688953, "link": "https://stackoverflow.com/questions/37688953/value-assigned-and-not-used-in-if-statement/37689048#37689048", "title": "Value assigned and not used in if statement", "body": "<p>You're creating a new variable <code>foo</code> in <code>if</code> <em>block</em>  with <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow\"><code>:=</code></a></p>\n\n<pre><code>foo, found := os.LookupEnv(\"GOPATH\")\n</code></pre>\n\n<p>Check <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow\">blocks</a> and the scoping <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">rules</a>.</p>\n\n<p>The correct <a href=\"https://play.golang.org/p/MvfUFit9RA\" rel=\"nofollow\">code</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    var foo string\n    var found bool\n    if true {\n        foo = \"foo\"\n    } else {\n        foo, found = os.LookupEnv(\"GOPATH\")\n        if !found {\n            fmt.Printf(\"who cares.\\n\")\n        }\n    }\n    println(foo)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1465364165, "post_id": 37690203, "comment_id": 62863767, "body": "My take away from the documentation for the &quot;:=&quot; operator was that it declares variables only if they haven&#39;t been declared and sets previously declared variables as expected.  It looks like there&#39;s another layer of nuance with scoping I hadn&#39;t considered.  Your second example is good, because this is the typical use case and would naively suggest my given example to be &quot;correct&quot;."}], "tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 2, "last_activity_date": 1465337146, "creation_date": 1465337146, "answer_id": 37690203, "question_id": 37688953, "link": "https://stackoverflow.com/questions/37688953/value-assigned-and-not-used-in-if-statement/37690203#37690203", "title": "Value assigned and not used in if statement", "body": "<p>From Go documentation:</p>\n\n<blockquote>\n  <p>An identifier declared in a block may be redeclared in an inner block.\n  While the identifier of the inner declaration is in scope, it denotes\n  the entity declared by the inner declaration.</p>\n</blockquote>\n\n<p>:= in the else block redeclares foo, so that foo now refers to a whole new variable with the same name, a variable which is never used. Even if we somehow reached the else block, the println(foo) at last line wouldn't print our $GOPATH as that's stored to the other foo variable (or was until the whole variable went out of scope)</p>\n\n<p>Correct code would be:</p>\n\n<pre><code>func main() {\n    var foo string\n    if true {\n        foo = \"foo\"\n    } else {\n        var found bool\n        foo, found = os.LookupEnv(\"GOPATH\")\n        if !found {\n            fmt.Printf(\"who cares.\\n\")\n        }\n    }\n    println(foo)\n}\n</code></pre>\n\n<p>It's easy to get confused since this code works fine even though foo is redeclared before it used:</p>\n\n<pre><code>func main() {\n    var foo string\n    foo = \"foo\"\n    foo, found := os.LookupEnv(\"GOPATH\")\n    if !found {\n        fmt.Printf(\"who cares.\\n\")\n    }\n    println(foo)\n}\n</code></pre>\n\n<p>What's happening here is that there's also another, different kind of legal redeclaration in Go:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration\n  may redeclare variables provided they were originally declared earlier\n  in the same block (or the parameter lists if the block is the function\n  body) with the same type, and at least one of the non-blank variables\n  is new. As a consequence, redeclaration can only appear in a\n  multi-variable short declaration. <strong>Redeclaration does not introduce a\n  new variable; it just assigns a new value to the original.</strong></p>\n</blockquote>\n\n<p>So in this other kind of redeclaration, no new foo variable is actually created and it works just like assignment to foo.</p>\n"}], "owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 37690203, "answer_count": 2, "score": -1, "last_activity_date": 1465338260, "creation_date": 1465332088, "last_edit_date": 1465332305, "question_id": 37688953, "link": "https://stackoverflow.com/questions/37688953/value-assigned-and-not-used-in-if-statement", "title": "Value assigned and not used in if statement", "body": "<p>I wrote an example of the problem I'm seeing in go playground:\n<a href=\"https://play.golang.org/p/rPCqAC56Ff\" rel=\"nofollow\">https://play.golang.org/p/rPCqAC56Ff</a></p>\n\n<p>It's pretty self evident, but I'm declaring a variable outside of an if statement, setting variable in if and then using outside of if.</p>\n\n<p>The question is simple, why doesn't this work?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    var foo string\n    if true {\n        foo = \"foo\"\n    } else {\n        foo, found := os.LookupEnv(\"GOPATH\")\n        if !found {\n            fmt.Printf(\"who cares.\\n\")\n        }\n    }\n    println(foo)\n}\n</code></pre>\n"}, {"tags": ["string", "go", "replace"], "answers": [{"comments": [{"owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "edited": false, "score": 0, "creation_date": 1465331169, "post_id": 37688601, "comment_id": 62854448, "body": "Thank you for the answer, +1 for &quot;Strings are immutable&quot;"}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 15, "last_activity_date": 1465330852, "creation_date": 1465330852, "answer_id": 37688601, "question_id": 37688457, "link": "https://stackoverflow.com/questions/37688457/how-to-replace-nth-char-from-a-string-in-go/37688601#37688601", "title": "How to replace nth char from a string in Go", "body": "<p>Strings are immutable.</p>\n\n<pre><code>chars = chars[:3] + \"z\" + chars[4:]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "edited": false, "score": 0, "creation_date": 1465331245, "post_id": 37688641, "comment_id": 62854488, "body": "Thank you for the explanation and very good answer, this is what I&#39;m looking for. but do I need to convert my string to byte array?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "edited": false, "score": 1, "creation_date": 1465331342, "post_id": 37688641, "comment_id": 62854541, "body": "@PankajKhairnar yeah here&#39;s another example that does that... <a href=\"https://play.golang.org/p/M_Gb1_bVCs\" rel=\"nofollow noreferrer\">play.golang.org/p/M_Gb1_bVCs</a> basically if you ahve a string <code>s</code> you can just do <code>myBytes := []byte(s)</code>"}, {"owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "edited": false, "score": 0, "creation_date": 1465331416, "post_id": 37688641, "comment_id": 62854580, "body": "Thank you so much, it make sense now :)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "edited": false, "score": 0, "creation_date": 1465331426, "post_id": 37688641, "comment_id": 62854581, "body": "@PankajKhairnar also, I left in that random <code>fmt.Printf(&quot;%T\\n&quot;, myInstance)</code> bit, that can be useful as <code>%T</code> prints the type information. In this case I added it to double check the type of <code>chars</code>"}, {"owner": {"reputation": 3551, "user_id": 2137314, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LjaqW.jpg?s=128&g=1", "display_name": "siritinga", "link": "https://stackoverflow.com/users/2137314/siritinga"}, "edited": false, "score": 0, "creation_date": 1465378668, "post_id": 37688641, "comment_id": 62872047, "body": "Beware this won&#39;t work for Unicode strings as characters may use more than one byte. Use []rune instead of []byte."}, {"owner": {"reputation": 920, "user_id": 6890234, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-aKC2DR_lnUc/AAAAAAAAAAI/AAAAAAAAABE/2KLbaG2ZxVU/photo.jpg?sz=128", "display_name": "Nikhil Wagh", "link": "https://stackoverflow.com/users/6890234/nikhil-wagh"}, "edited": false, "score": 0, "creation_date": 1514656499, "post_id": 37688641, "comment_id": 83042920, "body": "For me it gives the error : <code>cannot convert chars (type [100]byte) to type string</code>"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 13, "last_activity_date": 1465330977, "creation_date": 1465330977, "answer_id": 37688641, "question_id": 37688457, "link": "https://stackoverflow.com/questions/37688457/how-to-replace-nth-char-from-a-string-in-go/37688641#37688641", "title": "How to replace nth char from a string in Go", "body": "<p>This is happening because <code>chars</code> is actually a string and is immutable. If you declared it appropriately (as a byte slice) then you can assign to it as you're attempting. Here's an example; </p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n  var chars = []byte{'a', 'b', 'c', 'd', 'e', 'f'}\n  fmt.Println(string(chars[3]))\n  fmt.Printf(\"%T\\n\", chars)\n  chars[3] = 'z'\n  fmt.Println(string(chars))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/N1sSsfIBQY\" rel=\"noreferrer\">https://play.golang.org/p/N1sSsfIBQY</a></p>\n\n<p>Alternately you could use reslicing as demonstrated in the other answer.</p>\n"}, {"comments": [{"owner": {"reputation": 928, "user_id": 1219711, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8850196db54b82c43df90c3945497f3?s=128&d=identicon&r=PG", "display_name": "sabertooth1990", "link": "https://stackoverflow.com/users/1219711/sabertooth1990"}, "edited": false, "score": 0, "creation_date": 1566148892, "post_id": 37688838, "comment_id": 101556850, "body": "it works for both idx == 0 and idx == len(chars) - 1. Check the playground: <a href=\"https://play.golang.org/p/6eLp1C9PX23\" rel=\"nofollow noreferrer\">play.golang.org/p/6eLp1C9PX23</a>"}], "tags": [], "owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "is_accepted": false, "score": 2, "last_activity_date": 1465331683, "creation_date": 1465331683, "answer_id": 37688838, "question_id": 37688457, "link": "https://stackoverflow.com/questions/37688457/how-to-replace-nth-char-from-a-string-in-go/37688838#37688838", "title": "How to replace nth char from a string in Go", "body": "<p>Use slice indexing to remove the character at the index, and place a new character there instead.</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n  var chars = \"abcdef\"\n  fmt.Println(string(chars[3]))\n  chars = chars[:3] + \"z\" + chars[3+1:]\n  fmt.Println(string(chars[3]))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>d\nz\n</code></pre>\n\n<p><code>[:3]</code> selects everything in the slice from the beginning up until the index 3, and [3+1:] selects everything from the index (3+1) until the end of the slice. Put the character you wanted in-between the two statements and cat them all together for the effect of replacing a character at a specific index.</p>\n\n<p>If you want to replace a specific character (i.e. all (or some of) the instances of the letter 'b') you can use the <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow\">strings.Replace</a> function.</p>\n"}], "owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13052, "favorite_count": 3, "accepted_answer_id": 37688641, "answer_count": 3, "score": 13, "last_activity_date": 1590162999, "creation_date": 1465330394, "last_edit_date": 1590162999, "question_id": 37688457, "link": "https://stackoverflow.com/questions/37688457/how-to-replace-nth-char-from-a-string-in-go", "title": "How to replace nth char from a string in Go", "body": "<p>I want to replace the nth char in the original string. I can access the nth char from the string by using <code>chars[i]</code>, but when I assign a value to <code>chars[i]</code>, I get an error. </p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n  var chars = \"abcdef\"\n  fmt.Println(string(chars[3]))\n  chars[3] = \"z\" // is not working\n}\n</code></pre>\n"}, {"tags": ["parsing", "go", "yacc"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1465344951, "post_id": 37687582, "comment_id": 62859130, "body": "This doesn&#39;t look like a language for which bison isthe answer but you haven&#39;t described the structure of the &quot;modes&quot; so I could be wrong. It is easy enough to switch lexical mode in (f)lex; just search for start condition in the flex manual. That&#39;s probably all you need."}], "answers": [{"tags": [], "owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "is_accepted": true, "score": 0, "last_activity_date": 1465893133, "creation_date": 1465893133, "answer_id": 37806839, "question_id": 37687582, "link": "https://stackoverflow.com/questions/37687582/modal-parser-using-yacc/37806839#37806839", "title": "Modal parser using yacc", "body": "<p>I have solved the problem by creating pseudo-symbols which I insert using the lexer:</p>\n\n<pre><code>line\n    : TABLE_HEADING sentences ',' table_heading_columns ',' sentences\n    {\n      fmt.Println(\"TABLE_HEADING\")\n    }\n    | TABLE_BODY table_body_columns\n    {\n      fmt.Println(\"TABLE_BODY\")\n    }\n    | STATEMENT sentences\n    {\n      fmt.Println(\"STATEMENT\")\n    }\n    ;\n</code></pre>\n"}], "owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 37806839, "answer_count": 1, "score": 2, "last_activity_date": 1465893133, "creation_date": 1465327055, "question_id": 37687582, "link": "https://stackoverflow.com/questions/37687582/modal-parser-using-yacc", "title": "Modal parser using yacc", "body": "<p>I am writing my first parser in yacc. I would like to parse a file that has 3 \"modes\":</p>\n\n<ul>\n<li>Statement mode</li>\n<li>Table heading mode</li>\n<li>Table row mode</li>\n</ul>\n\n<p>I would like my parser to start out in statement mode, then when it sees a line consisting of minus signs, switch to table heading mode. When it sees another line of minus signs, switch to table row mode, and finally when it sees a third set of minus signs switch to statement mode:</p>\n\n<pre><code>statement...\nstatement...\nstatement...\n----\ntable heading\n----\ntable row\ntable row\ntable row\n----\nstatement\nstatement\nstatement\n</code></pre>\n\n<p>One thing that occures to me, is that I could have 3 separate grammars which I would switch between in my <a href=\"https://github.com/golang-samples/yacc/blob/master/simple/calc.y#L134\" rel=\"nofollow\">line feed loop</a>. However, I don't know how to create multiple grammars in one <code>.y</code> file.</p>\n\n<p>The other thing that seems like a possibility is using <a href=\"http://dinosaur.compilertools.net/yacc/\" rel=\"nofollow\">\"Lexical Tie-ins\"</a> (unfortunately, you'll have to search for that string in the document). However, the author of the yacc tutorial doesn't really tell me anything about these \"lexical tie-ins\" other than that \"This kind of ``backdoor'' approach can be elaborated to a noxious degree. Nevertheless, it represents a way of doing some things that are difficult, if not impossible, to do otherwise.\" Which is hardly encouraging.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-storage", "scorm"], "comments": [{"owner": {"reputation": 28882, "user_id": 785349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuJeX.jpg?s=128&g=1", "display_name": "quarks", "link": "https://stackoverflow.com/users/785349/quarks"}, "edited": false, "score": 0, "creation_date": 1465334074, "post_id": 37686966, "comment_id": 62855787, "body": "The best case would be AFAIK is to unzip on the client side, upload the files and implement some sort of rollback if things got broke in the middle."}, {"owner": {"reputation": 91, "user_id": 828549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4639d2e23307e439a315181d4bfce5?s=128&d=identicon&r=PG", "display_name": "nidx", "link": "https://stackoverflow.com/users/828549/nidx"}, "reply_to_user": {"reputation": 28882, "user_id": 785349, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuJeX.jpg?s=128&g=1", "display_name": "quarks", "link": "https://stackoverflow.com/users/785349/quarks"}, "edited": false, "score": 0, "creation_date": 1466194311, "post_id": 37686966, "comment_id": 63233795, "body": "It seems like google storage is a bit failure prone for some of the things I am trying to do. In the Recommended Practices section of <a href=\"https://cloud.google.com/storage/docs/xml-api/resumable-upload#step_3wzxhzdk34upload_the_file_blocks\" rel=\"nofollow noreferrer\">cloud.google.com/storage/docs/xml-api/&hellip;</a> it has a list of error http codes that should tell the client to retry using <a href=\"https://cloud.google.com/storage/docs/exponential-backoff\" rel=\"nofollow noreferrer\">cloud.google.com/storage/docs/exponential-backoff</a>"}], "owner": {"reputation": 91, "user_id": 828549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc4639d2e23307e439a315181d4bfce5?s=128&d=identicon&r=PG", "display_name": "nidx", "link": "https://stackoverflow.com/users/828549/nidx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465596426, "creation_date": 1465324984, "last_edit_date": 1465596426, "question_id": 37686966, "link": "https://stackoverflow.com/questions/37686966/dealing-with-large-zip-uploads-and-extracting-using-google-cloud", "title": "Dealing with large zip uploads and extracting using google cloud", "body": "<p>I am trying to create a site for e-learning courses (zips html/css/js/media) to be uploaded to.\nI am using go on google app engine with google cloud storage to store the zips and extracted courses.\nI will explain the development dead ends I have encountered. </p>\n\n<p>My first thought was to use the resumable upload functionality of cloud storage to send the zip file, then read it using go on app engine, unzip the files and write them back to cloud storage.\nThis took a while to read and understand the documentation and worked perfectly for my 2MB test zip. It failed when I tried it with a modest 67MB zip. I had encountered a hidden limitation when accessing cloud storage from app engine. No matter the client I used there was a 10MB/32MB limit.\nI tried both the old and new libraries as well as blobstore.\nI also looked into creating a custom oauth2 supporting client library using sockets but hit too many dead ends.</p>\n\n<p>Giving up on that approach I thought even though it would mean more uploading, perhaps just extracting on the client (browser) side then uploading each file with it's own resumable upload would make the most sense. After exploring a few libraries I had extracting in browser working ready to upload.\nI wrote my handler that created the datastore entry for the upload, selected a location for the upload and created all the upload urls.\nWhen testing this I was finding that it would take a while to go through generating the long lists of files (anything over 100). I decided that it would make sense since I was using to to make the requests concurrently. I spend a day or two getting that working. After dealing with some CORS issues that weirdly did not show up earlier I had everything working. </p>\n\n<p>Then I started getting errors when stress testing my approach with a large (500mb) zip/course. The uploads would fail and I discovered that when trying to send 300+ files to generate upload urls I was getting the following error</p>\n\n<pre><code>Post http://localhost:62394: dial tcp [::1]:62394: connectex: No connection could be made because the target machine actively refused it.\n</code></pre>\n\n<p>now I have no idea how to diagnose this. I don't know if I am hitting a rate limit and if I am I don't know how to avoid it.</p>\n\n<p>This seems like creating this should be simple, but it is anything but.</p>\n\n<p>I have a few options I can pursue</p>\n\n<ol>\n<li><del>Try to create the resumable uploads with a batch operation(<a href=\"https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch\" rel=\"nofollow\">https://cloud.google.com/storage/docs/json_api/v1/how-tos/batch</a>)</del>\n\n<ul>\n<li>batch operations to /upload are not supported.</li>\n</ul></li>\n<li>Maybe make requesting each url a one by one api call.</li>\n<li>Make requesting the url happen over a channel (<a href=\"https://cloud.google.com/appengine/docs/go/channel/reference\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/channel/reference</a>)</li>\n<li>spend the next week or more adding layers of retries and fallback error handling.</li>\n<li>Try another solution.</li>\n</ol>\n\n<p>This should be simple. How should this be done?</p>\n"}, {"tags": ["go", "segmentation-fault"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465325094, "post_id": 37686887, "comment_id": 62851154, "body": "You can&#39;t recover from a segfault. Does your package or any of its dependencies use cgo?"}, {"owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465326367, "post_id": 37686887, "comment_id": 62851854, "body": "Yeah, it uses zmq4."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465326850, "post_id": 37686887, "comment_id": 62852096, "body": "Is that the entire stack trace? (you can try adding <code>GOTRACEBACK=all</code> or <code>system</code>). Is the fault address the same every time?"}, {"owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465329763, "post_id": 37686887, "comment_id": 62853723, "body": "Yeah, that&#39;s the entire stack trace -- I&#39;ll try <code>GOTRACEBACK=all</code> or <code>system</code>.  And yeah same fault address every time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465330275, "post_id": 37686887, "comment_id": 62853982, "body": "If you can figure out where the <code>0x200015a490e0</code> value comes from, it may help trace back to the problem. I think something in the C code (zmq4) is trying to dereference that address."}, {"owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465405607, "post_id": 37686887, "comment_id": 62891501, "body": "Fwiw, the same code compiles, and tests run without errors on centos7 just fine.  It may be a Mac thing."}], "owner": {"reputation": 5392, "user_id": 361836, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/f426a26f03d7d4d61d354a3b2fc5337d?s=128&d=identicon&r=PG", "display_name": "lucidquiet", "link": "https://stackoverflow.com/users/361836/lucidquiet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 679, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465324715, "creation_date": 1465324715, "question_id": 37686887, "link": "https://stackoverflow.com/questions/37686887/how-to-debug-golang-fault-when-running-go-test-race-on-package", "title": "How to debug Golang fault when running go test --race on package?", "body": "<p>So I'm receiving a fault when running <code>go test --race my/package/ya</code>.  The output looks like this:</p>\n\n<pre><code>unexpected fault address 0x200015a490e0\nfatal error: fault\n[signal 0xb code=0x1 addr=0x200015a490e0 pc=0x47399ac]\n\ngoroutine 1 [running, locked to thread]:\nruntime.throw(0x0, 0xc820000180)\n    /opt/go1.6/src/runtime/panic.go:530 +0x90 fp=0x7fff5fbfeb80 sp=0x7fff5fbfeb68\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /opt/go1.6/src/runtime/asm_amd64.s:1998 +0x1\n</code></pre>\n\n<p>I've tried catching this fault in a TestMain, but apparently my TestMain doesn't get called.  I've tried using -trace to generate a trace file, but the file never is written although the testing file pkg.out is written.  I'm not entirely sure where to go from here since the output doesn't really provide many hints.  I suppose I can attempt gdb and delve, but haven't had luck with either of those in the past.</p>\n\n<p>I'm wondering if there is something else to consider?</p>\n\n<p>Additional notes:  this fault only occurs when the --race flag is present.  Go 1.6 darwin/amd64.  </p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465320763, "post_id": 37684902, "comment_id": 62848695, "body": "From the <a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow noreferrer\">cgo rules for passing pointers</a> state: &quot;C code may not keep a copy of a Go pointer after the call returns.&quot; and &quot;Go code may not store a Go pointer in C memory&quot;. You can&#39;t do this using a callback pattern, since it needs to store the pointer and the function returns immediately. Can you allocate and keep all the data in C from the start?"}, {"owner": {"reputation": 175, "user_id": 4219537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89bcc75841a5c4da353fc4edbe24b4b5?s=128&d=identicon&r=PG&f=1", "display_name": "mansfield", "link": "https://stackoverflow.com/users/4219537/mansfield"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465329997, "post_id": 37684902, "comment_id": 62853854, "body": "I don&#39;t think I&#39;m storing any Go pointers in C memory. Can you elaborate? I can&#39;t keep the data in C from the start, either."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465330715, "post_id": 37684902, "comment_id": 62854224, "body": "Oh, I was thinking that <code>C.iterate</code> was asynchronous, storing the pointer while it operated. Try making a C wrapper function that only takes the data pointer and indexes, then allocs the buffer and calls iterate for you. This way you&#39;re not passing a &quot;pointer to a struct containing a pointer&quot;"}], "owner": {"reputation": 175, "user_id": 4219537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89bcc75841a5c4da353fc4edbe24b4b5?s=128&d=identicon&r=PG&f=1", "display_name": "mansfield", "link": "https://stackoverflow.com/users/4219537/mansfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1465317867, "creation_date": 1465317867, "question_id": 37684902, "link": "https://stackoverflow.com/questions/37684902/how-to-handle-void-parameter-lists-holding-large-buffers-under-go-1-6s-cgo-poi", "title": "How to handle void* parameter lists holding large buffers under Go 1.6&#39;s CGo pointer rules", "body": "<p>Suppose I'm interacting with a third party C library from Go that maintains some complicated data structure. It allows me to iterate over the data structure using an API that looks something like this:</p>\n\n<pre><code>typedef void (*callback)(double x, void *params);\niterate(int64_t start_idx, int64_t end_idx, callback f, void *params);\n</code></pre>\n\n<p>With the idea being that <code>iterate</code> loops over every index between <code>start_idx</code> and <code>end_idx</code> and calls <code>f</code> on every element in that range. If you wanted to read the data out of the complicated data structure and into an array, you would write something like this:</p>\n\n<pre><code>typedef struct buffer {\n    double *data;\n    int64_t i;\n} buffer;\n\nvoid read_callback(double x, void *params) {\n    buffer *buf = (buffer*) params;\n    buf-&gt;data[i] = x;\n    buf-&gt;i++;\n}\n</code></pre>\n\n<p>Now let's suppose that I wanted to wrap this API call in a Go function where the user passes the function a pre-allocated buffer. In Go 1.5, I might have done something like this:</p>\n\n<pre><code>func Read(startIdx, endIdx int64, data []float64) {\n    buf := &amp;C.buffer{}\n    buf.data = unsafe.Pointer(&amp;data[0])\n    C.iterate(C.int64_t(startIdx), C.int64_t(endIdx),\n        (C.callback)(C.read_callback), unsafe.Pointer(buf))\n}\n</code></pre>\n\n<p>However, in Go 1.6 this is invalid. <code>data</code> is a Go-pointer and so is <code>buf</code>, meaning that the runtime panics to prevent a GC error. Allocating <code>buf</code> as a C-pointer is also not allowed. I think the intended way to handle something like this would be to allocate <code>data</code> as a C pointer, but I don't want to allocate a temporary array inside <code>Read</code> because these arrays are large enough that I can't hold two of them in memory at once (and even if I could, I wouldn't be able to deal with the heap fragmentation).</p>\n\n<p>My current (very hacky) solutions are to either pass some of the data around as global variables or to pack <code>i</code> and the array length in the first element of array (and then to swap some data around at the end of the iteration). Is there a way for me to do this which is less terrible?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 0, "last_activity_date": 1465315357, "last_edit_date": 1465315357, "creation_date": 1465314314, "answer_id": 37683840, "question_id": 37683218, "link": "https://stackoverflow.com/questions/37683218/golang-sql-drivers-prepare-statement/37683840#37683840", "title": "golang sql driver&#39;s prepare statement", "body": "<p>It depends a bit on which driver you're using, and whether your DB software supports unprepared queries.</p>\n\n<p>Prepare connects to the DB and creates a prepared statement, bound to that DB connection.  When executed, it checks if that connection is still available, and if not, creates a new connection, re-prepares the function, then runs it.</p>\n\n<p><strong>Edit:</strong> Note, if you only have one routine connecting to the DB at a time, and you're running the same query over and over with different arguments, then Prepare can be faster, because it stores the query on the DB side.  However, connection hijacking by other routines negates this, and if you're only using the query once, you get utterly no benefit from Prepare.</p>\n\n<p>Query does one of two things depending on the driver.  If the <code>Conn</code> type the driver returns from <code>Open()</code> also has a <code>Query()</code> method, and thus supports direct querying, then <code>sql.Query()</code> directly calls that, and return its results.  If the <code>Conn</code> does <em>not</em> have a <code>Query()</code> method, <code>sql.Query()</code> prepares a statement, then executes it.</p>\n\n<p>As an example, the <code>pq</code> driver for PostgreSQL (github.com/lib/pq) has a <code>Query()</code> method.  This method prepares and executes, as the <code>sql</code> package would do, but also has an alternative: if the query has no arguments, it executes using the <code>simpleQuery</code> interface, which the package notes is <em>substantially</em> faster than a prepare-and-execute cycle.</p>\n"}, {"comments": [{"owner": {"reputation": 686, "user_id": 10704601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71cae95e22c4d58d290e0e15057ed70b?s=128&d=identicon&r=PG&f=1", "display_name": "emmbee", "link": "https://stackoverflow.com/users/10704601/emmbee"}, "edited": false, "score": 0, "creation_date": 1607973515, "post_id": 37686891, "comment_id": 115434807, "body": "Broken link <a href=\"https://www.vividcortex.com/blog/2014/11/19/analyzing-prepared-statement-performance-with-vividcortex/\" rel=\"nofollow noreferrer\">vividcortex.com/blog/2014/11/19/&hellip;</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1609011807, "post_id": 37686891, "comment_id": 115730629, "body": "yes the link is broken and lead to some to advertisement <a href=\"https://www.solarwinds.com/database-performance-monitor\" rel=\"nofollow noreferrer\">solarwinds.com/database-performance-monitor</a>"}], "tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 29, "last_activity_date": 1609011854, "last_edit_date": 1609011854, "creation_date": 1465324723, "answer_id": 37686891, "question_id": 37683218, "link": "https://stackoverflow.com/questions/37683218/golang-sql-drivers-prepare-statement/37686891#37686891", "title": "golang sql driver&#39;s prepare statement", "body": "<p>The differences can be subtle, sometimes important, and sometimes effectively nonexistent.</p>\n<p>In general a prepared statement 1. gets prepared with the server (SQL parsed, execution plan generated, etc.), 2. is executed with the additional parameters, and then 3. is closed. It lets you reuse the same SQL with different parameters passed in each time, it can help guard against SQL injection, may provide some performance enhancements (driver/protocol specific, YMMV) and prevent repeated steps, as in execution plan generation and SQL parsing in the <em>prepare</em> step above.</p>\n<p>For someone writing source code a prepared statement may be more convenient than concatenating strings and sending those to the DB server.</p>\n<p>The <code>DB.Query()</code> method takes SQL as a string, and zero or more arguments (as does <code>Exec()</code>, or <code>QueryRow()</code>). A SQL string with no additional arguments will query exactly what you wrote. However, provided a SQL string with placeholders and additional arguments, a prepared statement is being done for you under the hood.</p>\n<p>The <code>DB.Prepare()</code> method explicitly performs a prepared statement, which you then pass arguments to, as in: <code>stmt.Exec(...args)</code>.</p>\n<p>There are a couple of things worth thinking about, in terms of the differences between the two and why to use one or the other.</p>\n<p>You can use <code>DB.Query()</code> without arguments. This can be very efficient since it can bypass the <em>prepare --&gt; execute --&gt; close</em> sequence that the prepared statement necessarily goes through.</p>\n<p>You can also use it with additional arguments, and placeholders in the query string, and it will execute a prepared statement under the covers as I mentioned above. The potential problem here is that when you are making a number of queries, each is resulting in an under-the-hood prepared statement. Since there are extra steps involved this can be rather inefficient as it re-prepares, executes and closes each time you do that query.</p>\n<p>With an explicit prepared statement you can possibly avoid that inefficiency as you are attempting to reuse the SQL that you earlier prepared, with potentially different arguments.</p>\n<p>But that doesn't always work out as you might expect... Because of the underlying connection pool that is managed by db/sql, your &quot;database connection&quot; is quite virtual. The <code>DB.Prepare()</code> method will prepare the statement against a particular connection and then try to get that same connection back when it is time to execute, but if that connection is unavailable it will simply grab one that is available and re-prepare and execute against that. If you're using that same prepared statement over and over again then you might, unknowingly, also be preparing it over and over again. This obviously mostly comes to light when you're dealing with heavy traffic.</p>\n<p>So obviously which you for what circumstance use depends on your specific use case, but I hope the details above help clarify for you enough that you can make the best decision in each case.</p>\n<h1>Update</h1>\n<p>Given the update in OP there is essentially no difference when the query only needs to be performed once, as queries with arguments are done as prepared statements behind the scenes.</p>\n<p>Use the direct methods, e.g. <code>DB.Query()</code> and its analogs, vs. explicitly using prepared statements, as it will result in somewhat simpler source code.</p>\n<p>Since prepared statements, in this case, are being utilized for security reasons, it may be worth the effort to handle the security concerns by other means and use plaintext queries instead, as it will improve  performance. Any gains, however, may be irrelevant unless there is sufficient traffic (or the traffic is predicted to grow considerably in the future) to  necessitate lightening the load on the server. Again it comes down to the real-world use case.</p>\n<p>For anyone interested in some metrics on the difference between prepared statements and direct plaintext queries, there is a good article <a href=\"https://web.archive.org/web/20190831042206/https://www.vividcortex.com/blog/2014/11/19/analyzing-prepared-statement-performance-with-vividcortex/\" rel=\"nofollow noreferrer\">here</a> (which also does an excellent job of explaining much of the above).</p>\n"}], "owner": {"reputation": 405, "user_id": 428467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/725758219af73359800f9e6bc990bb24?s=128&d=identicon&r=PG", "display_name": "jtuki", "link": "https://stackoverflow.com/users/428467/jtuki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13053, "favorite_count": 7, "accepted_answer_id": 37686891, "answer_count": 2, "score": 20, "last_activity_date": 1609011854, "creation_date": 1465312518, "last_edit_date": 1465362657, "question_id": 37683218, "link": "https://stackoverflow.com/questions/37683218/golang-sql-drivers-prepare-statement", "title": "golang sql driver&#39;s prepare statement", "body": "<p>With regards to golang's sql driver, what is the difference between the two statements below?</p>\n\n<pre><code>// store.DB is *sql.DB type\nrows, err := store.DB.Query(SQL, args ...)\n// err != nil\ndefer rows.Close()\n</code></pre>\n\n<p>and</p>\n\n<pre><code>// store.DB is *sql.DB type\nstmt, err := store.DB.Prepare(SQL)\n// err != nil\ndefer stmt.Close()\n\nrows, err := stmt.Query(args ...)\n// err != nil\ndefer rows.Close()\n</code></pre>\n\n<p>It seems that they are the same? Are there any subtle difference?</p>\n\n<p><strong>Update</strong>:  </p>\n\n<p>We don't need to perform many <code>stmt.Exec</code> or <code>stmt.Query</code> after <code>db.Prepare</code>, only one <code>exec</code> or <code>query</code> is performed after each <code>prepare</code>. And when we use <code>db.Query</code> or <code>db.Exec</code>, we pass arguments to the methods instead of using raw SQL string (for security consideration).  </p>\n\n<p>I have found one reference links: <a href=\"http://go-database-sql.org/prepared.html\" rel=\"noreferrer\">http://go-database-sql.org/prepared.html</a><br>\nIt seems that both way are using <strong>prepared statement</strong>, what's the difference?</p>\n"}, {"tags": ["go", "concurrency", "channels"], "answers": [{"comments": [{"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465314942, "post_id": 37683573, "comment_id": 62845202, "body": "It seems the problem was with order, thanks for answer, but it&#39;s still too slow, I updated the question, do you have any idea how to speed up?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465315181, "post_id": 37683573, "comment_id": 62845381, "body": "What type of speed are we talking about here?  Have you done any <a href=\"http://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">benchmarking</a>?  The only major speedup I can see would be to not assign the values of <code>d</code> to other variables and just use them directly, and if necessary, to pass a pointer to the structures over the channel instead of the structures.  We&#39;re starting to play with microsecond benefits here, though."}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465315340, "post_id": 37683573, "comment_id": 62845475, "body": "The raw version without routines takes ~150ms but the working version with routines takes ~13 seconds.  It doesn&#39;t even speed up."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465318914, "post_id": 37683573, "comment_id": 62847605, "body": "Ok, there&#39;s something else going on, then, because that code alone should take on the order of microseconds to complete.  Example, your code with some fill-ins for the data types and such runs incredibly fast on the playground: <a href=\"https://play.golang.org/p/vhqEHQXwEM\" rel=\"nofollow noreferrer\">play.golang.org/p/vhqEHQXwEM</a>  I suspect the slowdown is from some other portion of your program, or something that isn&#39;t apparent or present in the code samples above."}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465320042, "post_id": 37683573, "comment_id": 62848264, "body": "This time measurements are just for the for loop I provided. There is also a upper for loop but I&#39;m using <code>start2 := time.Now()</code>,<code>elapsed2 := time.Since(start2)</code>,<code>res += elapsed2</code>(res is also time duration) to have this measurements. Also, it should be noted that the size of the slices process and matrix are, 44000 and 21712000 respectively. When I set the sizes to these, it doesn&#39;t even run, says it took too long."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465321858, "post_id": 37683573, "comment_id": 62849325, "body": "With data structures of that size, you&#39;re probably running into memory thrash.  Your larger slice, for example, has a data footprint of 21-84 megabytes, depending on whether you&#39;re using an <code>int8</code> or <code>int32</code> for it (could be as much as 168 megabytes, if you&#39;re using an <code>int</code> on a 64-bit system).  That&#39;s well beyond what the cache is capable of handling, and since you&#39;re accessing that slice non-sequentially, you can&#39;t even take advantage of cache line optimization.  On the note, it might be better to access the first slice from index 0 up instead of the last index down, for the same caching."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465322141, "post_id": 37683573, "comment_id": 62849492, "body": "I think the reason you&#39;re not seeing speed-up, though, is that you took the least time-limiting portion of your code and tried to put it in a goroutine, which added the innate goroutine overhead (small as it is) without really changing anything as far as your algorithm&#39;s bottleneck (the slice accesses).  Have you considered a binary division of work?  Fire a goroutine that processes the first half of the slice, and another for the second half, and each of those recursively split it as well, and so on until it&#39;s at a reasonable of elements in each slice?"}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465328496, "post_id": 37683573, "comment_id": 62852975, "body": "So you are saying that concurrency won&#39;t help me? I couldn&#39;t understand how to do binary division of work with my problem."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 0, "last_activity_date": 1465314950, "last_edit_date": 1465314950, "creation_date": 1465313503, "answer_id": 37683573, "question_id": 37683215, "link": "https://stackoverflow.com/questions/37683215/using-go-channels-to-speed-up-for-loop/37683573#37683573", "title": "Using Go channels to speed up for loop", "body": "<p>I'm suspecting your \"if imData[ind] == e[i]\" conditional is failing in the former case, but it's hard to tell without the setup code for the channels, and more details on what those various slices hold.  Have you tried running it with a print statement to see what you get from the channels?</p>\n\n<p>Also, note that if the channels in question are buffered, there's no guarantee that the values in <code>ch</code> and <code>ch2</code> are going to be in the same order.  This is very possibly your issue.  </p>\n\n<p>Goroutine 1 could put a value on <code>ch</code>, but Goroutine 2 could have put a value on <code>ch2</code> before Goroutine 1 gets to it.  If you have 7 goroutines, it's perfectly possible to see the following ordering on the channels (or any number of others):</p>\n\n<p><code>ch</code>: 1, 2, 3, 4, 5, 6, 7</p>\n\n<p><code>ch2</code>: 1, 3, 4, 5, 6, 7, 2</p>\n\n<p>If they aren't buffered, this isn't possible with your code, but it's still technically unsafe (edit: actually, it still won't match up with <code>i</code> in the second loop).  If the data is a set of ordered pairs, you should be sending each pair as a structure over a single channel.</p>\n\n<p>Incidentally, you only need to pass variables to the <code>go func()</code> call if they are expected to change outside that call.  <code>ch</code>, <code>ch2</code>, <code>arx</code>, <code>ary</code>, <code>dirf</code>, and <code>dirg</code> all appear to be effectively constant for this block of code, and thus don't need to be passed into that <code>go func()</code>.  You only need to pass in <code>i</code>, because the loop changes it immediately after firing the enclosure into a goroutine.</p>\n\n<p>Now, from a pure speed perspective, you're probably better off moving the first loop inside the <code>go func()</code> call.  Instead of creating 7 goroutines while looping in the main routine, you can fire a single routine, and it will loop over the values and send them on the channels.  If the channels are buffered to at least that size, this becomes a VERY fast operation.  Incidentally, this also solves the issue with channel ordering (though it's still better to send ordered pairs as a structure on a single channel), since you only have a single goroutine trying to send on the channels.</p>\n"}, {"comments": [{"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465314876, "post_id": 37683625, "comment_id": 62845153, "body": "Thank you for your answer, it made the code work but still too slow, I updated the question, can you look at it also?"}], "tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 1, "last_activity_date": 1465313655, "creation_date": 1465313655, "answer_id": 37683625, "question_id": 37683215, "link": "https://stackoverflow.com/questions/37683215/using-go-channels-to-speed-up-for-loop/37683625#37683625", "title": "Using Go channels to speed up for loop", "body": "<p>In the second case, you're certain that the goroutines are executed \"in the right order\", since you wait for goroutines to complete before you continue on to the next one.</p>\n\n<p>An example would be <a href=\"https://play.golang.org/p/xF3eoK9RzZ\" rel=\"nofollow\">this minimal example</a> on the golang playground. To fix this, you probably want pass a struct of three members, your <code>nx</code>, <code>ny</code> and <code>i</code> values across the channel.</p>\n"}], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 936, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465314950, "creation_date": 1465312513, "last_edit_date": 1465314801, "question_id": 37683215, "link": "https://stackoverflow.com/questions/37683215/using-go-channels-to-speed-up-for-loop", "title": "Using Go channels to speed up for loop", "body": "<p>I'm trying to use Go's concurrency to speed up my code,</p>\n\n<p>Here's what I have:</p>\n\n<pre><code>            for i:=7; i&gt;-1; i-- {\n                go func (ch chan int32, ch2 chan int32, i int, arx int32, ary int32, dirf []int8, dirg []int8) {\n                    nx := arx + int32(dirf[i])\n                    ny := ary + int32(dirg[i])\n                    ch &lt;- nx\n                    ch2 &lt;- ny\n\n                }(ch, ch2, i, arx,ary,dirf,dirg)\n\n            }\n            for i:=7; i&gt;-1; i-- {\n                nxx := &lt;- ch\n                nyx := &lt;- ch2\n                ind := nyx*w+nxx\n                if imData[ind] == e[i]{\n                    process[c]=nxx\n                    process[c+1]=nyx\n                    c+=2\n                    matrix[ind]=1\n                }\n            }\n</code></pre>\n\n<p>After running this I'm not getting the matrix slice that I expected, it's full of zeros.</p>\n\n<p>But if I run the code below, it gives the matrix slice just as the code without channels but it's too slow.</p>\n\n<pre><code>            for i:=7; i&gt;-1; i-- {\n                go func (ch chan int32, ch2 chan int32, i int, arx int32, ary int32, dirf []int8, dirg []int8) {\n                    nx := arx + int32(dirf[i])\n                    ny := ary + int32(dirg[i])\n                    ch &lt;- nx\n                    ch2 &lt;- ny\n\n                }(ch, ch2, i, arx,ary,dirf,dirg)\n                nxx := &lt;- ch\n                nyx := &lt;- ch2\n                ind := nyx*w+nxx\n                if imData[ind] == e[i]{\n                    process[c]=nxx\n                    process[c+1]=nyx\n                    c+=2\n                    matrix[ind]=1\n                }\n            }\n</code></pre>\n\n<p>What's wrong with the first one? Any ideas? I'm very new at Go. So, please be clear when you are suggesting something.</p>\n\n<p>Edit:\nI edited the code to have values in proper order,</p>\n\n<pre><code>type data struct {\n    i int\n    nx int32\n    ny int32\n}\n\n           for i:=7; i&gt;-1; i-- {\n                go func (ch chan data, i int, arx int32, ary int32, dirf []int8, dirg []int8) {\n                    nx := arx + int32(dirf[i])\n                    ny := ary + int32(dirg[i])\n                    ch &lt;- data{i,nx,ny}\n\n                }(ch, i, arx,ary,dirf,dirg)\n\n            }\n            for i:=7; i&gt;-1; i-- {\n                d := &lt;- ch\n                nxx := d.nx\n                nyx := d.ny\n                j := d.i\n                ind := nyx*w+nxx\n                if imData[ind] == e[j]{\n                    process[c]=nxx\n                    process[c+1]=nyx\n                    c+=2\n                    matrix[ind]=1\n                }\n            }\n</code></pre>\n\n<p>It works now but it's still too slow.</p>\n\n<p>I'm trying to speed up this main code: </p>\n\n<pre><code>for i:=7; i&gt;-1; i-- {\n        nx := arx + int32(dirf[i])\n        ny := ary + int32(dirg[i])\n        ind := ny*w+nx\n        if imData[ind] == e[i]{\n            process[c]=nx\n            process[c+1]=ny\n            c+=2\n            matrix[ind]=1\n        }\n    }\n</code></pre>\n\n<p>what do you suggest with that?</p>\n"}, {"tags": ["go", "smtp", "gmail"], "comments": [{"owner": {"reputation": 11333, "user_id": 819742, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/39e2199f9782b9b9abab588071c20e68?s=128&d=identicon&r=PG", "display_name": "randominstanceOfLivingThing", "link": "https://stackoverflow.com/users/819742/randominstanceoflivingthing"}, "edited": false, "score": 1, "creation_date": 1465311616, "post_id": 37682730, "comment_id": 62842696, "body": "Are you using smtp-relay.gmail.com to send email? Did you go through <a href=\"https://support.google.com/a/answer/176600?hl=en\" rel=\"nofollow noreferrer\">this</a> page that details what servers to use for sending mail?"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 11333, "user_id": 819742, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/39e2199f9782b9b9abab588071c20e68?s=128&d=identicon&r=PG", "display_name": "randominstanceOfLivingThing", "link": "https://stackoverflow.com/users/819742/randominstanceoflivingthing"}, "edited": false, "score": 1, "creation_date": 1465312190, "post_id": 37682730, "comment_id": 62843180, "body": "I&#39;m going to be honest with you. Nothing that is on their pages is what it seems on their page! They say: &quot;From the dashboard, go to Apps &gt; Google Apps &gt; Gmail &gt; Advanced settings.&quot; Seriously, where do I even find this? None of the guidelines make sense to me, I can&#39;t find anything."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465331723, "post_id": 37682730, "comment_id": 62854720, "body": "@Alex Apps is the 3x3 square grid in the top right corner of you gmail or other google apps. If you&#39;re in gmail just navigate to advanced settings. I think you should be able to white list that device from the place you took a screen shot of though I&#39;m not exactly sure how to do it."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1465332555, "post_id": 37682730, "comment_id": 62855092, "body": "I only see settings in gmail, not advanced settings. And there is no place for me to whitelist ip addresses in gmail settings, or google account settings."}, {"owner": {"reputation": 11333, "user_id": 819742, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/39e2199f9782b9b9abab588071c20e68?s=128&d=identicon&r=PG", "display_name": "randominstanceOfLivingThing", "link": "https://stackoverflow.com/users/819742/randominstanceoflivingthing"}, "edited": false, "score": 0, "creation_date": 1465402225, "post_id": 37682730, "comment_id": 62889329, "body": "You are talking of sending from server, so you should be connecting to smtp.gmail.com and it allows sending mails from any IP address."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1465424670, "post_id": 37682730, "comment_id": 62901462, "body": "For some reason it worked after changing my gmail password. Totally random. Google or gmail didn&#39;t even ask me to do it. I read somewhere that &quot;it might help to change password&quot;."}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1181, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1465332517, "creation_date": 1465311258, "last_edit_date": 1465332517, "question_id": 37682730, "link": "https://stackoverflow.com/questions/37682730/sending-gmail-with-smtp-in-go", "title": "Sending Gmail with smtp in Go", "body": "<p>I was able to send email with gmail via smtp before, but not anymore. I am still able to send from localhost on my computer on Windows where I develop, but not from the production server. I have enabled \"Allow less secure apps\" with my gmail account. But still this is the error I get:</p>\n\n<pre><code>2016/06/07 10:27:03 534 5.7.14 &lt;https://accounts.google.com/signin/continue?sarp=1&amp;scc=1&amp;plt=AKgnsbtq\n5.7.14 ZHRyO8gjNXDZjjls6t7JWkP7y1UM8Jc44oPvw0dXO96SljvNT3d2QDMlJAT3X7p4teLYY1\n5.7.14 zj9NBwLOytlrdRXkjm7BZNWpPLLscyxEOUcyLL3EFHdnYiq_1P_PwQVcLvZlVGUdChm_\n5.7.14 6BIdD9uJLkOOG_6b6oXyJ1YfZJneoM8IiUYlWaecNECJQYF8WLYY3hSCCnNDazjJuRvjbH\n5.7.14 yqJu4xBfx-929yDQwvPmuVxL4bQv8&gt; Please log in via your web browser and\n5.7.14 then try again.\n5.7.14  Learn more at\n5.7.14  https://support.google.com/mail/answer/78754 89sm7243327qth.2 - gsmtp\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/SUY1P.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SUY1P.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It says that It has detected \"an unknown device\" which is the production server, but there is NO WAY for me to confirm that that device is legit. How am I supposed to send emails?</p>\n\n<p>This is the code I have written to send emails, note that it works when I send from localhost on my Windows development environment, just not from the production server.</p>\n\n<pre><code>type Mail struct {\n    Hostname   string\n    Port       string\n    User       string\n    Password   string\n    Header     map[string]string\n    IsHTML     bool\n    Subject    string\n    Body       string\n    Recipients []string\n}\n\nfunc New() *Mail {\n    return &amp;Mail{\n        Hostname: cfg.MailHost,\n        Port:     cfg.MailPort,\n        User:     cfg.MailUser,\n        Password: cfg.MailPass,\n        Header:   map[string]string{},\n        IsHTML:   true,\n    }\n}\n\nfunc (m *Mail) AddHeader(key, value string) {\n    m.Header[key] = value\n}\n\nfunc (m *Mail) AddRecipient(address string) {\n    m.Recipients = append(m.Recipients, address)\n    m.AddHeader(\"To\", \"&lt;\"+address+\"&gt;\")\n}\n\nfunc (m *Mail) HTML(isHTML bool) {\n    m.IsHTML = isHTML\n}\n\nfunc (m *Mail) Send() error {\n\n    if m.Subject == \"\" {\n        m.Subject = \"Some random subject...\"\n    }\n    m.AddHeader(\"Subject\", m.Subject)\n\n    if _, ok := m.Header[\"From\"]; !ok {\n        m.AddHeader(\"From\", cfg.MailName+\" &lt;\"+cfg.MailUser+\"&gt;\")\n    }\n\n    if m.IsHTML {\n        m.AddHeader(\"MIME-version\", \"1.0;\")\n        m.AddHeader(\"Content-Type\", \"text/html; charset=\\\"UTF-8\\\";\")\n    }\n\n    body := \"\"\n    for k, v := range m.Header {\n        body += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n    }\n    body += \"\\r\\n\" + m.Body\n\n    auth := smtp.PlainAuth(\"\", m.User, m.Password, m.Hostname)\n\n    err := smtp.SendMail(\n        m.Hostname+\":\"+m.Port,\n        auth,\n        m.User,\n        m.Recipients,\n        []byte(body),\n    )\n\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>I have no idea what to do now.</p>\n\n<p>Some of the variables from config.go:</p>\n\n<pre><code>MailHost = \"smtp.gmail.com\"\nMailPort = \"587\"\n</code></pre>\n\n<p>If I change the port from 587 to 465 as noted here:\n<a href=\"https://support.google.com/a/answer/176600?hl=en\" rel=\"nofollow noreferrer\">https://support.google.com/a/answer/176600?hl=en</a></p>\n\n<p>The I get the error: <code>\"EOF\"</code> when trying to send email from the production server.</p>\n\n<p>It keeps saying I should go to \"advanced settings in gmail\" to whitelist IP address. But there is no advanced settings in gmail, only settings.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Oj6q1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Oj6q1.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 2, "creation_date": 1465308308, "post_id": 37681419, "comment_id": 62840182, "body": "You can make a struct exclusively for the parts you want. This from the json package under Unmarshal():  <i>&quot;To unmarshal JSON into a struct, Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match. Unmarshal will only set exported fields of the struct.&quot;</i> If the field doesn&#39;t exist the json key/value pair should simply be ignored."}, {"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465309855, "post_id": 37681419, "comment_id": 62841338, "body": "Ah ok, I thought it would complain about unmatched fields. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465308494, "post_id": 37681616, "comment_id": 62840322, "body": "{ &quot;body&quot;: &quot;here goes \\&quot;title\\&quot;:\\&quot;pick me\\&quot;&quot;, &quot;title&quot;: &quot;catch me if you can&quot; }"}, {"owner": {"reputation": 1034, "user_id": 4983845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/52c2fde50f0b1d868778d3f36405517d?s=128&d=identicon&r=PG&f=1", "display_name": "Vale", "link": "https://stackoverflow.com/users/4983845/vale"}, "reply_to_user": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465308672, "post_id": 37681616, "comment_id": 62840450, "body": "@Darigaaz ? Is that because I&#39;m over complicating a simple solution or a ray of inspiration?"}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465308953, "post_id": 37681616, "comment_id": 62840681, "body": "Parsing &quot;structured&quot; text like json/html/xml with regex is a bad idea in general. And i gave you an example."}, {"owner": {"reputation": 1034, "user_id": 4983845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/52c2fde50f0b1d868778d3f36405517d?s=128&d=identicon&r=PG&f=1", "display_name": "Vale", "link": "https://stackoverflow.com/users/4983845/vale"}, "reply_to_user": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465309074, "post_id": 37681616, "comment_id": 62840766, "body": "Aaaah, I apologize. I won&#39;t delete the answer to serve it as an example for the future, risking my reputation nonetheless"}], "tags": [], "owner": {"reputation": 1034, "user_id": 4983845, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/52c2fde50f0b1d868778d3f36405517d?s=128&d=identicon&r=PG&f=1", "display_name": "Vale", "link": "https://stackoverflow.com/users/4983845/vale"}, "is_accepted": false, "score": -3, "last_activity_date": 1507805107, "last_edit_date": 1507805107, "creation_date": 1465308235, "answer_id": 37681616, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values/37681616#37681616", "title": "Manually read JSON values", "body": "<p><strong>Update:</strong> This answer is wrong; I'm leaving it as an example of what <em>not</em> to do.</p>\n\n<p>You should look it up with a regex then (pseudocode): </p>\n\n<pre><code>String s = {json source};\nint i = s.indexOf(\"\\\"title\\\": \\\"\")\ns.substring(i,s.indexOf(\"\\\"\",i))\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/2615749/java-method-to-get-position-of-a-match-in-a-string\">more on substrings in Java</a> </p>\n"}, {"tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 8, "last_activity_date": 1465309382, "last_edit_date": 1465309382, "creation_date": 1465308386, "answer_id": 37681669, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values/37681669#37681669", "title": "Manually read JSON values", "body": "<p>Dont declare fields you dont want.</p>\n\n<p><a href=\"https://play.golang.org/p/cQeMkUCyFy\" rel=\"noreferrer\">https://play.golang.org/p/cQeMkUCyFy</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype Struct struct {\n    Title   string  `json:\"title\"`\n}\n\nfunc main() {\n    test := `{\n        \"title\": \"Found a bug\",\n        \"body\": \"I'm having a problem with this.\",\n        \"assignee\": \"octocat\",\n        \"milestone\": 1,\n        \"labels\": [\n          \"bug\"\n        ]\n    }`\n\n    var s Struct\n    json.Unmarshal([]byte(test), &amp;s)\n\n    fmt.Printf(\"%#v\", s)\n\n}\n</code></pre>\n\n<p>Or if you want to completely get rid of structs:</p>\n\n<pre><code>var i interface{}\njson.Unmarshal([]byte(test), &amp;i)\n\nfmt.Printf(\"%#v\\n\", i)\nfmt.Println(i.(map[string]interface{})[\"title\"].(string))\n</code></pre>\n\n<p>Or. It will swallow all conversion errors. </p>\n\n<pre><code>m := make(map[string]string)\n\njson.Unmarshal([]byte(test), interface{}(&amp;m))\n\nfmt.Printf(\"%#v\\n\", m)\nfmt.Println(m[\"title\"])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1465314605, "creation_date": 1465314605, "answer_id": 37683949, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values/37683949#37683949", "title": "Manually read JSON values", "body": "<p>To extend Darigaaz's answer, you can also use an anonymous struct declared within the parsing function.  This avoids having to have package-level type declarations litter the code for single-use cases.</p>\n\n<p><a href=\"https://play.golang.org/p/MkOo1KNVbs\" rel=\"nofollow\">https://play.golang.org/p/MkOo1KNVbs</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    test := `{\n        \"title\": \"Found a bug\",\n        \"body\": \"I'm having a problem with this.\",\n        \"assignee\": \"octocat\",\n        \"milestone\": 1,\n        \"labels\": [\n          \"bug\"\n        ]\n    }`\n\n    var s struct {\n        Title string `json:\"title\"`\n    }\n    json.Unmarshal([]byte(test), &amp;s)\n\n    fmt.Printf(\"%#v\", s)\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1465388243, "post_id": 37701582, "comment_id": 62878487, "body": "Thanks but, imho, this is too trivial a problem to add an external dependency."}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 1, "creation_date": 1465388777, "post_id": 37701582, "comment_id": 62878908, "body": "@conor Of course, it all depends on your needs. I particularly like this library when I have to unit test JSON payloads for instance. But good habit to not add 3rd party libs for small tasks :)"}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 0, "last_activity_date": 1465386218, "creation_date": 1465386218, "answer_id": 37701582, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values/37701582#37701582", "title": "Manually read JSON values", "body": "<p>Check out <a href=\"https://github.com/bitly/go-simplejson\" rel=\"nofollow\">go-simplejson</a></p>\n\n<p>Example:</p>\n\n<pre><code>js, err := simplejson.NewJson([]byte(`{\n  \"test\": {\n    \"string_array\": [\"asdf\", \"ghjk\", \"zxcv\"],\n    \"string_array_null\": [\"abc\", null, \"efg\"],\n    \"array\": [1, \"2\", 3],\n    \"arraywithsubs\": [{\"subkeyone\": 1},\n    {\"subkeytwo\": 2, \"subkeythree\": 3}],\n    \"int\": 10,\n    \"float\": 5.150,\n    \"string\": \"simplejson\",\n    \"bool\": true,\n    \"sub_obj\": {\"a\": 1}\n  }\n}`))\n\nif _, ok = js.CheckGet(\"test\"); !ok {\n  // Missing test struct\n}\n\naws := js.Get(\"test\").Get(\"arraywithsubs\")\naws.GetIndex(0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1159, "user_id": 5533075, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-Doi1rGLqYCQ/AAAAAAAAAAI/AAAAAAAAv90/wqnGkGxNzkE/photo.jpg?sz=128", "display_name": "Dwhitz", "link": "https://stackoverflow.com/users/5533075/dwhitz"}, "edited": false, "score": 1, "creation_date": 1552915869, "post_id": 55222162, "comment_id": 97179861, "body": "Hi, while this code may answer the question, providing additional context regarding how and/or why it solves the problem would improve the answer&#39;s long-term value."}], "tags": [], "owner": {"reputation": 87, "user_id": 3769773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e765a3ed453bc84f1689f5707648ff32?s=128&d=identicon&r=PG&f=1", "display_name": "pa1 Raju", "link": "https://stackoverflow.com/users/3769773/pa1-raju"}, "is_accepted": false, "score": 0, "last_activity_date": 1552914563, "creation_date": 1552914563, "answer_id": 55222162, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values/55222162#55222162", "title": "Manually read JSON values", "body": "<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\n\ntype Seller struct {\n  Name string\n  ShareName string\n  Holdings int\n  Quantity int\n  PerShare float64\n}\n\ntype Buyer struct {\n  Name string\n  ShareName string\n  Holdings int\n  Quantity int\n  PerShare float64\n\n}\nfunc validateTransaction(seller Seller,buyer Buyer) bool{         \n    var isallowTransact bool =false\n    if (seller.Quantity &gt;=buyer.Quantity &amp;&amp;seller.PerShare == buyer.PerShare &amp;&amp; seller.ShareName ==buyer.ShareName){\n         isallowTransact=true; \n    }  \n\n    return isallowTransact\n    }\n\nfunc executeTransaction(seller Seller,buyer Buyer) {         \n       seller.Holdings -=seller.Quantity;\n       buyer.Holdings +=seller.Quantity;\n    fmt.Printf(\"seller current holding : %d, \\n buyyer current holding: %d\",seller.Holdings,buyer.Holdings)\n\n}\n\nfunc main() {   \n    sellerJson :=`{\"name\":\"pavan\",\"ShareName\":\"TCS\",\"holdings\":100,\"quantity\":30,\"perShare\":11.11}`\n    buyerJson :=`{\"name\":\"Raju\",\"ShareName\":\"TCS\",\"holdings\":0,\"quantity\":30,\"perShare\":14.11}`\n    var seller Seller \n    var buyer Buyer \n    json.Unmarshal([]byte(sellerJson ), &amp;seller)\n    json.Unmarshal([]byte(buyerJson ), &amp;buyer)\n\n    //fmt.Printf(\"seller name : %s, shares of firm: %s,total holdings: %d, want to sell: %d,unit cost: %f\", seller.Name , seller.ShareName,seller.Holdings , seller.Quantity,seller.PerShare )\n      var isallowExecute bool =false\n    isallowExecute  =validateTransaction(seller,buyer)\n\n    if(isallowExecute){ \n    executeTransaction(seller,buyer)\n    }else{\n     fmt.Print(\"\\n seems buyer quotes are not matching with seller so we are not able to perform transacrion ,Please check and try again\");\n\n    }\n    fmt.Println(\"\\n Happy Trading...!!\");\n\n    }\n</code></pre>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "accepted_answer_id": 37683949, "answer_count": 5, "score": 5, "last_activity_date": 1552914563, "creation_date": 1465307707, "question_id": 37681419, "link": "https://stackoverflow.com/questions/37681419/manually-read-json-values", "title": "Manually read JSON values", "body": "<p>In Go I usually unmarshal my JSON into a struct and read values from the struct.. it works very well.</p>\n\n<p>This time around I am only concerned with a certain element of a JSON object and because the overall JSON object is very large, I don't want to have to create a struct.</p>\n\n<p>Is there a way in Go so that I can lookup values in the JSON object using keys or iterate arrays as per usual.</p>\n\n<p>Considering the following JSON how could I pull out the <code>title</code> field only.</p>\n\n<pre><code>{\n  \"title\": \"Found a bug\",\n  \"body\": \"I'm having a problem with this.\",\n  \"assignee\": \"octocat\",\n  \"milestone\": 1,\n  \"labels\": [\n    \"bug\"\n  ]\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1465306331, "post_id": 37680437, "comment_id": 62838657, "body": "check out <code>https:&#47;&#47;github.com&#47;spf13&#47;cobra</code> you will point it at <code>cmd&#47;main.go</code> and other command source files will be used as e.g. <code>main doX</code> <code>main printY</code>"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465306775, "post_id": 37680437, "comment_id": 62839033, "body": "You can add subcommands with cobra, but it does not produce multiple binaries as intended."}], "answers": [{"tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": false, "score": 10, "last_activity_date": 1465306530, "creation_date": 1465306530, "answer_id": 37680958, "question_id": 37680437, "link": "https://stackoverflow.com/questions/37680437/how-to-build-multiple-package-binaries-at-once/37680958#37680958", "title": "How to build multiple package binaries at once", "body": "<p>The command:</p>\n\n<pre><code>go install ./...\n</code></pre>\n\n<p>should build all binaries under your current directory (i.e. <code>./...</code>) and put them on <code>$GOPATH/bin</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 10, "last_activity_date": 1465310296, "last_edit_date": 1465310296, "creation_date": 1465306590, "answer_id": 37680987, "question_id": 37680437, "link": "https://stackoverflow.com/questions/37680437/how-to-build-multiple-package-binaries-at-once/37680987#37680987", "title": "How to build multiple package binaries at once", "body": "<p>From the <code>go build</code> help:</p>\n\n<blockquote>\n  <p>When compiling multiple packages or a single non-main package,\n  build compiles the packages but discards the resulting object,\n  serving only as a check that the packages can be built.</p>\n</blockquote>\n\n<p>In order to build all packages under a directory, you can run <code>go install ./...</code>. All of your packages will be built and installed (i.e. put under $GOPATH/bin).</p>\n\n<p>With your example, you'd have two executables produced: <code>$GOPATH/bin/bin1</code> and <code>$GOPATH/bin/bin2</code></p>\n\n<p>There is also the alternative of writing a simple Makefile to do what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 10797, "user_id": 269106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vQlAg.jpg?s=128&g=1", "display_name": "AlexBrand", "link": "https://stackoverflow.com/users/269106/alexbrand"}, "is_accepted": true, "score": 15, "last_activity_date": 1465307216, "creation_date": 1465307216, "answer_id": 37681238, "question_id": 37680437, "link": "https://stackoverflow.com/questions/37680437/how-to-build-multiple-package-binaries-at-once/37681238#37681238", "title": "How to build multiple package binaries at once", "body": "<p>If you don't want to install the binaries into <code>$GOPATH/bin</code>, you could do what other open source projects do, which is create a script.</p>\n\n<p>Most of the projects out there have make files and build scripts for producing multiple binaries.</p>\n\n<p>In your case, you could build a script that iterates over the packages in <code>cmd</code>, and run <code>go build</code> on each.</p>\n\n<pre><code>cd $GOPATH/someProject\nfor CMD in `ls cmd`; do\n  go build ./cmd/$CMD\ndone\n</code></pre>\n\n<p>This results in:</p>\n\n<pre><code>[root@node1 test]# ls $GOPATH/someProject\nbin1  bin2  cmd\n</code></pre>\n\n<p>Couple of trending projects that you can look at:</p>\n\n<ul>\n<li>Grafana - <a href=\"https://github.com/grafana/grafana/blob/master/build.go\" rel=\"noreferrer\">https://github.com/grafana/grafana/blob/master/build.go</a></li>\n<li>Torus - <a href=\"https://github.com/coreos/torus/blob/master/Makefile\" rel=\"noreferrer\">https://github.com/coreos/torus/blob/master/Makefile</a></li>\n<li>Caddy - <a href=\"https://github.com/mholt/caddy/blob/master/dist/automate.go\" rel=\"noreferrer\">https://github.com/mholt/caddy/blob/master/dist/automate.go</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 2945598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee3351ab3881744efc337b15387062c?s=128&d=identicon&r=PG", "display_name": "Kesava", "link": "https://stackoverflow.com/users/2945598/kesava"}, "is_accepted": false, "score": 3, "last_activity_date": 1610555422, "creation_date": 1610555422, "answer_id": 65705998, "question_id": 37680437, "link": "https://stackoverflow.com/questions/37680437/how-to-build-multiple-package-binaries-at-once/65705998#65705998", "title": "How to build multiple package binaries at once", "body": "<p>you can use -o flag of git build. From official documentation</p>\n<blockquote>\n<p>The -o flag forces build to write the resulting executable or object to the named output file or directory, instead of the default behavior described in the last two paragraphs. If the named output is a directory that exists, then any resulting executables will be written to that directory.</p>\n</blockquote>\n<p>So you can try something like\n<code>go build  -o . ./...</code> this essentially making go to write resulting executables in current folder (the . value of -o) for all packages in the current module/folder/project</p>\n"}], "owner": {"reputation": 25893, "user_id": 353820, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/32b29e1dc23c2c5abe0283ab7b9541d3?s=128&d=identicon&r=PG", "display_name": "Doug", "link": "https://stackoverflow.com/users/353820/doug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11365, "favorite_count": 1, "accepted_answer_id": 37681238, "answer_count": 4, "score": 8, "last_activity_date": 1617738659, "creation_date": 1465305184, "last_edit_date": 1617738659, "question_id": 37680437, "link": "https://stackoverflow.com/questions/37680437/how-to-build-multiple-package-binaries-at-once", "title": "How to build multiple package binaries at once", "body": "<p>I've seen this discussed in various places, with answers like 'use a cmd/foo, cmd/bar' type folder structure.</p>\n\n<p>This does not work for me. </p>\n\n<p>This works:</p>\n\n<pre><code>$ du -a\n8   ./src/cmd/bin1/main.go\n8   ./src/cmd/bin1\n8   ./src/cmd/bin2/main.go\n8   ./src/cmd/bin2\n16  ./src/cmd\n8   ./src/shared/foo/foo.go\n8   ./src/shared/foo\n8   ./src/shared\n24  ./src\n</code></pre>\n\n<p>and building it:</p>\n\n<pre><code>go build ./src/cmd/bin2\ngo build ./src/cmd/bin1\n</code></pre>\n\n<p>However, I can't figure out what variation on:</p>\n\n<pre><code>go build ./src/...\n</code></pre>\n\n<p>I might need to build all such binaries in one step.</p>\n\n<p>This layout:</p>\n\n<pre><code>$ du -a\n8   ./cmd/bin1/main.go\n8   ./cmd/bin1\n8   ./cmd/bin2/main.go\n8   ./cmd/bin2\n16  ./cmd\n8   ./src/shared/foo/foo.go\n8   ./src/shared/foo\n8   ./src/shared\n8   ./src\n24  .\n</code></pre>\n\n<p>Seems totally unusable. No combination of <code>go build ...</code> commands seems to build bin1 or bin2. </p>\n\n<p>The best I can get is <code>go build cmd/bin1/main.go</code> which gives me a binary called 'main'. Not helpful.</p>\n\n<p>So, specifically and in detail, including the <code>go build</code> command, that actually builds the individual binaries, how do you do this?</p>\n\n<p>...and why is the default advice that people keep giving to use a top level <code>cmd</code> folder? How do you build these binaries if you do?</p>\n"}, {"tags": ["go", "ssh", "command-line-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465307671, "post_id": 37679939, "comment_id": 62839742, "body": "Do you want to use the openssh binary, or do you want to use crypto/ssh like here: <a href=\"http://stackoverflow.com/questions/35906991/\">stackoverflow.com/questions/35906991</a> ?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465307659, "post_id": 37680243, "comment_id": 62839731, "body": "You can use the <code>-W</code> option in ssh rather than spawning an <code>nc</code> process"}, {"owner": {"reputation": 980, "user_id": 2486083, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/pZudJ.jpg?s=128&g=1", "display_name": "Chetan", "link": "https://stackoverflow.com/users/2486083/chetan"}, "edited": false, "score": 3, "creation_date": 1487142416, "post_id": 37680243, "comment_id": 71643980, "body": "What if the remote machine needs a password ? Is there a way to pass password along with this?"}, {"owner": {"reputation": 37340, "user_id": 1696153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7069459e5a4adfbf0fcb089d25c651c3?s=128&d=identicon&r=PG", "display_name": "Katie", "link": "https://stackoverflow.com/users/1696153/katie"}, "edited": false, "score": 0, "creation_date": 1534354558, "post_id": 37680243, "comment_id": 90679446, "body": "How can I make the output be in utf8 form? I just see a bunch of digits :/"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 37340, "user_id": 1696153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7069459e5a4adfbf0fcb089d25c651c3?s=128&d=identicon&r=PG", "display_name": "Katie", "link": "https://stackoverflow.com/users/1696153/katie"}, "edited": false, "score": 0, "creation_date": 1588796814, "post_id": 37680243, "comment_id": 109041467, "body": "@Katie are you trying to render the bytes.Buffer value? <code>byte</code>s will render as lists of <code>int8</code> values if you use <code>printf</code>&#39;s <code>%v</code> directive. To render as a printable string ensure to use <code>%s</code>."}], "tags": [], "owner": {"reputation": 881, "user_id": 276186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c5627ef10f7577e6994bc424aa830f2?s=128&d=identicon&r=PG", "display_name": "PerroVerd", "link": "https://stackoverflow.com/users/276186/perroverd"}, "is_accepted": true, "score": 14, "last_activity_date": 1465304670, "creation_date": 1465304670, "answer_id": 37680243, "question_id": 37679939, "link": "https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli/37680243#37680243", "title": "How do I execute a command on a remote machine in a golang CLI?", "body": "<p>Try with os/exec <a href=\"https://golang.org/pkg/os/exec/\" rel=\"noreferrer\">https://golang.org/pkg/os/exec/</a> to execute a ssh </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"ssh\", \"remote-machine\", \"bash-command\")\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    err := cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>To jump over machines use the ProxyCommand directive in a ssh config file.</p>\n\n<pre><code>Host remote_machine_name\n  ProxyCommand ssh -q bastion nc remote_machine_ip 22\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1093, "user_id": 2023507, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e0ab68024b68668fb29b5defc4c58012?s=128&d=identicon&r=PG", "display_name": "user2023507", "link": "https://stackoverflow.com/users/2023507/user2023507"}, "edited": false, "score": 0, "creation_date": 1498506335, "post_id": 41528181, "comment_id": 76516101, "body": "latest changes require hostkey checks. Issue resolution here - <a href=\"https://go-review.googlesource.com/c/38701/\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/38701</a>"}, {"owner": {"reputation": 1669, "user_id": 1497207, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xob9P.png?s=128&g=1", "display_name": "TheSporkboy", "link": "https://stackoverflow.com/users/1497207/thesporkboy"}, "edited": false, "score": 0, "creation_date": 1529096940, "post_id": 41528181, "comment_id": 88767604, "body": "The dangerous way to solve this it to add the InsecureIgnoreHostKey() supplied by the ssh library to the above: ``` config := &amp;ssh.ClientConfig{ \t\tUser: user, \t\tHostKeyCallback: ssh.InsecureIgnoreHostKey(), \t\tAuth: []ssh.AuthMethod{ &lt;snip&gt; ``` The proper way would be to add them to your allows_hosts file and validate against that. Hopefully someone else can add that example."}, {"owner": {"reputation": 189, "user_id": 3771509, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/n9UxM.jpg?s=128&g=1", "display_name": "Ricardo Silva", "link": "https://stackoverflow.com/users/3771509/ricardo-silva"}, "edited": false, "score": 0, "creation_date": 1562924035, "post_id": 41528181, "comment_id": 100541308, "body": "Every time I run this piece of code, it returns the following message:  ssh: no key found. Any ideas on fixing it? because the key exists and its valid. I use it to connect to any other server."}], "tags": [], "owner": {"reputation": 667, "user_id": 7058050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/307b8a4eb324c043ff6bba1370750097?s=128&d=identicon&r=PG&f=1", "display_name": "djd0", "link": "https://stackoverflow.com/users/7058050/djd0"}, "is_accepted": false, "score": 11, "last_activity_date": 1615552486, "last_edit_date": 1615552486, "creation_date": 1483835550, "answer_id": 41528181, "question_id": 37679939, "link": "https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli/41528181#41528181", "title": "How do I execute a command on a remote machine in a golang CLI?", "body": "<p>You can run commands on a remote machine over SSH using the <code>&quot;golang.org/x/crypto/ssh&quot;</code> package.</p>\n<p>Here is an example function demonstrating simple usage of running a single command on a remote machine and returning the output:</p>\n<pre><code>//e.g. output, err := remoteRun(&quot;root&quot;, &quot;MY_IP&quot;, &quot;PRIVATE_KEY&quot;, &quot;ls&quot;)\nfunc remoteRun(user string, addr string, privateKey string, cmd string) (string, error) {\n    // privateKey could be read from a file, or retrieved from another storage\n    // source, such as the Secret Service / GNOME Keyring\n    key, err := ssh.ParsePrivateKey([]byte(privateKey))\n    if err != nil {\n        return &quot;&quot;, err\n    }\n    // Authentication\n    config := &amp;ssh.ClientConfig{\n        User: user,\n        // https://github.com/golang/go/issues/19767 \n        // as clientConfig is non-permissive by default \n        // you can set ssh.InsercureIgnoreHostKey to allow any host \n        HostKeyCallback: ssh.InsecureIgnoreHostKey(),\n        Auth: []ssh.AuthMethod{\n            ssh.PublicKeys(key),\n        },\n        //alternatively, you could use a password\n        /*\n            Auth: []ssh.AuthMethod{\n                ssh.Password(&quot;PASSWORD&quot;),\n            },\n        */\n    }\n    // Connect\n    client, err := ssh.Dial(&quot;tcp&quot;, net.JoinHostPort(addr, &quot;22&quot;), config)\n    if err != nil {\n        return &quot;&quot;, err\n    }\n    // Create a session. It is one session per command.\n    session, err := client.NewSession()\n    if err != nil {\n        return &quot;&quot;, err\n    }\n    defer session.Close()\n    var b bytes.Buffer  // import &quot;bytes&quot;\n    session.Stdout = &amp;b // get output\n    // you can also pass what gets input to the stdin, allowing you to pipe\n    // content from client to server\n    //      session.Stdin = bytes.NewBufferString(&quot;My input&quot;)\n\n    // Finally, run the command\n    err = session.Run(cmd)\n    return b.String(), err\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37340, "user_id": 1696153, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7069459e5a4adfbf0fcb089d25c651c3?s=128&d=identicon&r=PG", "display_name": "Katie", "link": "https://stackoverflow.com/users/1696153/katie"}, "is_accepted": false, "score": 3, "last_activity_date": 1534371328, "creation_date": 1534371328, "answer_id": 51867184, "question_id": 37679939, "link": "https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli/51867184#51867184", "title": "How do I execute a command on a remote machine in a golang CLI?", "body": "<p>The other solutions here will work, but I'll throw out another option you could try: <strong><a href=\"https://github.com/sfreiberg/simplessh\" rel=\"nofollow noreferrer\">simplessh</a></strong>. I think it is easier to use. For this question, <strong>I would use option 3 below where you can ssh using your key.</strong></p>\n\n<p><strong>Option 1: SSH to a machine with a password, then run a command</strong></p>\n\n<pre><code>import (\n    \"log\"\n\n    \"github.com/sfreiberg/simplessh\"\n)\n\nfunc main() error {\n    var client *simplessh.Client\n    var err error\n\n    if client, err = simplessh.ConnectWithPassword(\"hostname_to_ssh_to\", \"username\", \"password\"); err != nil {\n        return err\n    }\n\n    defer client.Close()\n\n    // Now run the commands on the remote machine:\n    if _, err := client.Exec(\"cat /tmp/somefile\"); err != nil {\n        log.Println(err)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p><strong>Option 2: SSH to a machine using a <em>set</em> of possible passwords, then run a command</strong></p>\n\n<pre><code>import (\n    \"log\"\n\n    \"github.com/sfreiberg/simplessh\"\n)\n\ntype access struct {\n    login    string\n    password string\n}\n\nvar loginAccess []access\n\nfunc init() {\n    // Initialize all password to try\n    loginAccess = append(loginAccess, access{\"root\", \"rootpassword1\"})\n    loginAccess = append(loginAccess, access{\"someuser\", \"newpassword\"})\n}\n\nfunc main() error {\n    var client *simplessh.Client\n    var err error\n\n    // Try to connect with first password, then tried second else fails gracefully\n    for _, credentials := range loginAccess {\n        if client, err = simplessh.ConnectWithPassword(\"hostname_to_ssh_to\", credentials.login, credentials.password); err == nil {\n            break\n        }\n    }\n\n    if err != nil {\n        return err\n    }\n\n    defer client.Close()\n\n    // Now run the commands on the remote machine:\n    if _, err := client.Exec(\"cat /tmp/somefile\"); err != nil {\n        log.Println(err)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p><strong>Option 3: SSH to a machine using your key</strong> </p>\n\n<pre><code>import (\n    \"log\"\n\n    \"github.com/sfreiberg/simplessh\"\n)\n\nfunc SshAndRunCommand() error {\n    var client *simplessh.Client\n    var err error\n\n    // Option A: Using a specific private key path:\n    //if client, err = simplessh.ConnectWithKeyFile(\"hostname_to_ssh_to\", \"username\", \"/home/user/.ssh/id_rsa\"); err != nil {\n\n    // Option B: Using your default private key at $HOME/.ssh/id_rsa:\n    //if client, err = simplessh.ConnectWithKeyFile(\"hostname_to_ssh_to\", \"username\"); err != nil {\n\n    // Option C: Use the current user to ssh and the default private key file:\n    if client, err = simplessh.ConnectWithKeyFile(\"hostname_to_ssh_to\"); err != nil {\n        return err\n    }\n\n    defer client.Close()\n\n    // Now run the commands on the remote machine:\n    if _, err := client.Exec(\"cat /tmp/somefile\"); err != nil {\n        log.Println(err)\n    }\n\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 998718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/265bcbb56e831266de7a9f9281aab57a?s=128&d=identicon&r=PG", "display_name": "appleboy", "link": "https://stackoverflow.com/users/998718/appleboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1564076791, "creation_date": 1564076791, "answer_id": 57207607, "question_id": 37679939, "link": "https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli/57207607#57207607", "title": "How do I execute a command on a remote machine in a golang CLI?", "body": "<p>Try the package <a href=\"https://github.com/appleboy/easyssh-proxy\" rel=\"nofollow noreferrer\">https://github.com/appleboy/easyssh-proxy</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/appleboy/easyssh-proxy\"\n)\n\nfunc main() {\n    // Create MakeConfig instance with remote username, server address and path to private key.\n    ssh := &amp;easyssh.MakeConfig{\n        User:   \"appleboy\",\n        Server: \"example.com\",\n        // Optional key or Password without either we try to contact your agent SOCKET\n        //Password: \"password\",\n        // Paste your source content of private key\n        // Key: `-----BEGIN RSA PRIVATE KEY-----\n        // MIIEpAIBAAKCAQEA4e2D/qPN08pzTac+a8ZmlP1ziJOXk45CynMPtva0rtK/RB26\n        // 7XC9wlRna4b3Ln8ew3q1ZcBjXwD4ppbTlmwAfQIaZTGJUgQbdsO9YA==\n        // -----END RSA PRIVATE KEY-----\n        // `,\n        KeyPath: \"/Users/username/.ssh/id_rsa\",\n        Port:    \"22\",\n        Timeout: 60 * time.Second,\n    }\n\n    // Call Run method with command you want to run on remote server.\n    stdout, stderr, done, err := ssh.Run(\"ls -al\", 60*time.Second)\n    // Handle errors\n    if err != nil {\n        panic(\"Can't run remote command: \" + err.Error())\n    } else {\n        fmt.Println(\"don is :\", done, \"stdout is :\", stdout, \";   stderr is :\", stderr)\n    }\n\n}\n</code></pre>\n\n<p>See <a href=\"https://github.com/appleboy/easyssh-proxy/tree/8dc53bb50b6f620642c2dd551f328180baf46781/example\" rel=\"nofollow noreferrer\">more example</a>.</p>\n"}], "owner": {"reputation": 1620, "user_id": 1183758, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/a2Bxf.jpg?s=128&g=1", "display_name": "n8gard", "link": "https://stackoverflow.com/users/1183758/n8gard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20937, "favorite_count": 3, "accepted_answer_id": 37680243, "answer_count": 4, "score": 15, "last_activity_date": 1615552486, "creation_date": 1465303920, "question_id": 37679939, "link": "https://stackoverflow.com/questions/37679939/how-do-i-execute-a-command-on-a-remote-machine-in-a-golang-cli", "title": "How do I execute a command on a remote machine in a golang CLI?", "body": "<p>How do I execute a command on a remote machine in a golang CLI? I need to write a golang CLI that can SSH into a remote machine via a key and execute a shell command. Furthermore, I need to be able to do this one hop away. e.g. SSH into a machine (like a cloud bastion) and then SSH into another, internal, machine and execute a shell command.</p>\n\n<p>I haven't (yet) found any examples for this.</p>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 6155, "user_id": 4378314, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7935867003690df779b06563293f6293?s=128&d=identicon&r=PG", "display_name": "MarsAndBack", "link": "https://stackoverflow.com/users/4378314/marsandback"}, "edited": false, "score": 0, "creation_date": 1510702929, "post_id": 37679503, "comment_id": 81545571, "body": "Here&#39;s a date package that may be useful for this: <a href=\"https://github.com/aodin/date\" rel=\"nofollow noreferrer\">github.com/aodin/date</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "edited": false, "score": 0, "creation_date": 1465305681, "post_id": 37679972, "comment_id": 62838134, "body": "Thanks this is a good solution for me! Just note that the third part of the for loop should have an assignment to d - d = d.AddDate(0, 0, 1). Unless you will get stuck in an infinite loop."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 3, "creation_date": 1465305801, "post_id": 37679972, "comment_id": 62838229, "body": "Close but that won&#39;t do it. <code>First Parse()</code> returns two values, so you need to minimally do <code>start, _ := time.Parse(&quot;2006-1-2&quot;, &quot;2016-4-1&quot;)</code> and obviously in reality you usually would want to handle and not discard an error. Second <code>AddDate()</code> returns a time.Time, so to use it to increment the value of d you should write <code>for d := start; d.Month() == start.Month(); d = d.AddDate(0, 0, 1)</code>"}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 1, "creation_date": 1465306033, "post_id": 37679972, "comment_id": 62838408, "body": "You&#39;re right of course. I should be more careful. Anyways I edited the answer so it works now."}, {"owner": {"reputation": 157, "user_id": 9703809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9e630139bd3e5f4dd10fe2ff60540b?s=128&d=identicon&r=PG&f=1", "display_name": "gourav", "link": "https://stackoverflow.com/users/9703809/gourav"}, "edited": false, "score": 0, "creation_date": 1526369490, "post_id": 37679972, "comment_id": 87704978, "body": "@jussius What should I do i have a start date and the end date and i Want to find the only monday between them can you help me? If yes can you see this <a href=\"https://stackoverflow.com/questions/50342293/using-golang-how-i-will-print-the-specific-days-mentioned-bettwen-the-range-of-t\">Question</a>"}], "tags": [], "owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "is_accepted": true, "score": 30, "last_activity_date": 1465305957, "last_edit_date": 1465305957, "creation_date": 1465304005, "answer_id": 37679972, "question_id": 37679503, "link": "https://stackoverflow.com/questions/37679503/is-there-a-way-to-iterate-over-specific-month-or-week/37679972#37679972", "title": "Is there a way to iterate over specific month or week", "body": "<p>There is no time.Date object defined in the standard library. Only time.Time object. There's also no way to range loop them, but looping them manually is quite simple:</p>\n\n<pre><code>// set the starting date (in any way you wish)\nstart, err := time.Parse(\"2006-1-2\", \"2016-4-1\")\n// handle error\n\n// set d to starting date and keep adding 1 day to it as long as month doesn't change\nfor d := start; d.Month() == start.Month(); d = d.AddDate(0, 0, 1) {\n    // do stuff with d\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1536858952, "post_id": 49398348, "comment_id": 91584753, "body": "endDate can be a time greater than the last addition of timestamp += oneDay, thus skipping the last day"}, {"owner": {"reputation": 21, "user_id": 781727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b087b6bda07c05868988c452bfec6615?s=128&d=identicon&r=PG", "display_name": "Huang Qi Victor", "link": "https://stackoverflow.com/users/781727/huang-qi-victor"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1538232317, "post_id": 49398348, "comment_id": 92075774, "body": "@LorenzoBelli yes, need to be careful of the endDate, might need to process it first to make sure the last day is not skipped."}], "tags": [], "owner": {"reputation": 21, "user_id": 781727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b087b6bda07c05868988c452bfec6615?s=128&d=identicon&r=PG", "display_name": "Huang Qi Victor", "link": "https://stackoverflow.com/users/781727/huang-qi-victor"}, "is_accepted": false, "score": -1, "last_activity_date": 1521607498, "creation_date": 1521607498, "answer_id": 49398348, "question_id": 37679503, "link": "https://stackoverflow.com/questions/37679503/is-there-a-way-to-iterate-over-specific-month-or-week/49398348#49398348", "title": "Is there a way to iterate over specific month or week", "body": "<p>@jessius way can only work if the iteration is within a month.\nBetter way to iterate is to use epoch format of the time.</p>\n\n<p>for example, for oneDay we know it is 86400 seconds.\nwe can do follwing</p>\n\n<pre><code>oneDay := int64(86400) // a day in seconds.\nstartDate := int64(1519862400)\nendDate := int64(1520640000)\n\nfor timestamp := startDate; timestamp &lt;= endDate; timestamp += oneDay {\n   // do your work\n}\n</code></pre>\n\n<p>Simple and workable for iterating days.</p>\n\n<p>For month, this way cannot work, because each month has different days. I only have similar ideas as @jussius, but tweak to apply to month iteration.</p>\n"}, {"tags": [], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "is_accepted": false, "score": -1, "last_activity_date": 1538402659, "last_edit_date": 1538402659, "creation_date": 1536859035, "answer_id": 52318723, "question_id": 37679503, "link": "https://stackoverflow.com/questions/37679503/is-there-a-way-to-iterate-over-specific-month-or-week/52318723#52318723", "title": "Is there a way to iterate over specific month or week", "body": "<p>I'm keen to compare the dates</p>\n\n<pre><code>func LeqDates(a, b time.Time) bool {\n    year1, month1, day1 := a.Date()\n    year2, month2, day2 := b.Date()\n\n    if year1 &lt; year2 {\n        return true\n    } else if year1 &lt;= year2 &amp;&amp; month1 &lt; month2 {\n        return true\n    } else {\n        return year1 &lt;= year2 &amp;&amp; month1 &lt;= month2 &amp;&amp; day1 &lt;= day2\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7397, "favorite_count": 0, "accepted_answer_id": 37679972, "answer_count": 3, "score": 13, "last_activity_date": 1575669447, "creation_date": 1465302749, "last_edit_date": 1575669447, "question_id": 37679503, "link": "https://stackoverflow.com/questions/37679503/is-there-a-way-to-iterate-over-specific-month-or-week", "title": "Is there a way to iterate over specific month or week", "body": "<p>Is there a way, in <code>go</code>, to iterate over a specific month and get all <code>time.Date</code> objects from it?</p>\n\n<p>For instance iterate over April will result in <code>04012016</code> until <code>04312016</code>:</p>\n\n<pre><code>for _, dayInMonth := range date.April {\n   // do stuff with dates returned\n}\n</code></pre>\n\n<p><em>(Currently the above code will not work obviously).</em></p>\n\n<p>Or if not part of the standard library is there a third party library that equivalent to <a href=\"http://momentjs.com/\" rel=\"noreferrer\">moment.js</a>?</p>\n"}, {"tags": ["go", "unicode", "utf-8"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6434464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cdfa107813451eaa5f8901a3bcc40e?s=128&d=identicon&r=PG", "display_name": "Jackenn", "link": "https://stackoverflow.com/users/6434464/jackenn"}, "edited": false, "score": 0, "creation_date": 1465304883, "post_id": 37678764, "comment_id": 62837480, "body": "It do the job but runes does not support indexing, that&#39;s why it was a string."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 21, "user_id": 6434464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cdfa107813451eaa5f8901a3bcc40e?s=128&d=identicon&r=PG", "display_name": "Jackenn", "link": "https://stackoverflow.com/users/6434464/jackenn"}, "edited": false, "score": 0, "creation_date": 1465312800, "post_id": 37678764, "comment_id": 62843655, "body": "By &quot;not support indexing&quot; do you mean that you can&#39;t use it as a key in your hash table? If you could, post more code and explain what you want to do. Maybe I could help."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": false, "score": 1, "last_activity_date": 1465314597, "last_edit_date": 1465314597, "creation_date": 1465300727, "answer_id": 37678764, "question_id": 37677828, "link": "https://stackoverflow.com/questions/37677828/read-input-from-console-in-unicode-instead-of-utf-8-hex-in-golang/37678764#37678764", "title": "Read input from console in Unicode instead of UTF-8 (hex) in golang", "body": "<p>Unicode and utf8 are not comparable. String can be both unicode and utf8. I learned a lot of stuff about those by reading <a href=\"https://blog.golang.org/strings\" rel=\"nofollow\">Strings, bytes, runes and characters in Go</a>.</p>\n\n<p>To answer your question,</p>\n\n<p>You can use <a href=\"https://golang.org/pkg/unicode/utf8/#DecodeRuneInString\" rel=\"nofollow\">DecodeRuneInString</a> from <code>unicode/utf8</code> package.</p>\n\n<pre><code>s := \"\u00e9\"\nrune, _ := utf8.DecodeRuneInString(s)\nfmt.Printf(\"%x\", rune)\n</code></pre>\n\n<p>What <code>DecodeRuneInString(s)</code> does is, it returns the first utf8 encoded character (rune) in <code>s</code> along with that characters width in bytes. So if you want to get unicode code points of each rune in a string heres how to do it. This is the example given in the linked documentation only slightly modified.</p>\n\n<pre><code>str := \"Hello, \u4e16\u754c\"\n\nfor len(str) &gt; 0 {\n    r, size := utf8.DecodeRuneInString(str)\n    fmt.Printf(\"%x %v\\n\", r, size)\n\n    str = str[size:]\n}\n</code></pre>\n\n<p>Try in <a href=\"https://play.golang.org/p/0yp-jWuc3w\" rel=\"nofollow\">Playground</a>.</p>\n\n<p>Alternatively as Juergen points out you can use a range loop on the string to get runes contained in the string.</p>\n\n<pre><code>str := \"Hello, \u4e16\u754c\"\n\nfor _, rune := range(str) {\n    fmt.Printf(\"%x \\n\", rune)\n}\n</code></pre>\n\n<p>Try in <a href=\"https://play.golang.org/p/xL_ShVyGUq\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 215, "user_id": 5808912, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/035ed4fb917a6eafa33e1bed81c3ef4f?s=128&d=identicon&r=PG", "display_name": "Juergen Gmeiner", "link": "https://stackoverflow.com/users/5808912/juergen-gmeiner"}, "is_accepted": false, "score": 2, "last_activity_date": 1465303544, "last_edit_date": 1465303544, "creation_date": 1465300889, "answer_id": 37678827, "question_id": 37677828, "link": "https://stackoverflow.com/questions/37677828/read-input-from-console-in-unicode-instead-of-utf-8-hex-in-golang/37678827#37678827", "title": "Read input from console in Unicode instead of UTF-8 (hex) in golang", "body": "<p>Go strings are conceptually a read-only slice to a read-only bytearray.  The encoding of that bytearray is not specified, but string constants will be UTF-8 and using UTF-8 in other strings is the recommended approach.</p>\n\n<p>Go provides convenience functions for accessing the UTF-8 as unicode codepoints (or runes in go-speak).  A range loop over a string will do the utf8 decoding for you.  Converting to []rune will give you a rune slice i.e. the unicode codepoints in order.  These goodies only work on UTF-8 encoded strings/bytearrays.  I would strongly suggest using UTF-8 internally.</p>\n\n<p>An example:</p>\n\n\n\n<pre><code>package main\n\nimport (\n  \"bufio\"\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n  reader := bufio.NewReader(os.Stdin)\n  input, _ := reader.ReadString('\\n')\n\n\n  println(\"non-range loop - bytes\")\n  for i := 0; i &lt; len(input); i++ {\n    fmt.Printf(\"%d %d %[2]x\\n\", i, input[i])\n  }\n  println(\"range-loop - runes\")\n  for idx, r := range input {\n    fmt.Printf(\"%d %d %[2]c\\n\", idx, r)\n  }\n\n  println(\"converted to rune slice\")\n  rs := []rune(input)\n  fmt.Printf(\"%#v\\n\", rs)\n}\n</code></pre>\n\n<p>With the input: X \u00e9 X</p>\n\n<pre><code>    non-range loop - bytes\n    0 88 58\n    1 32 20\n    2 195 c3\n    3 169 a9\n    4 32 20\n    5 88 58\n    6 10 a\n    range-loop - runes\n    0 88 X\n    1 32\n    2 233 \u00e9\n    4 32\n    5 88 X\n    6 10\n\n    converted to rune slice\n    []int32{88, 32, 233, 32, 88, 10}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6434464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10cdfa107813451eaa5f8901a3bcc40e?s=128&d=identicon&r=PG", "display_name": "Jackenn", "link": "https://stackoverflow.com/users/6434464/jackenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1138, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1465314597, "creation_date": 1465298023, "question_id": 37677828, "link": "https://stackoverflow.com/questions/37677828/read-input-from-console-in-unicode-instead-of-utf-8-hex-in-golang", "title": "Read input from console in Unicode instead of UTF-8 (hex) in golang", "body": "<p>I am trying to read a user input with bufio in console. The text can have some special characters (\u00e9, \u00e0, \u266b, \u256c,...).</p>\n\n<p>The code look like this :</p>\n\n<pre><code>reader := bufio.NewReader(os.Stdin)\ninput, _ := reader.ReadString('\\n')\n</code></pre>\n\n<p>If I type for example \"\u00e9\", the ReadString will read it as \"c3 a9\" instead of \"00e9\". How can I read the text input in Unicode instead of UTF-8 ? I need to use this value as a hash table key.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 0, "last_activity_date": 1465293258, "creation_date": 1465293258, "answer_id": 37676061, "question_id": 37675910, "link": "https://stackoverflow.com/questions/37675910/golang-go-command-inside-script/37676061#37676061", "title": "Golang: go command inside script?", "body": "<p>If you invoke a function prefixed with the go keyword it will call the function in as goroutine. A goroutine is a function that is capable of running concurrently with other functions. </p>\n\n<p>Normally when we invoke a function it will execute all the function statements in normal order, then return to the next line following the invocation. With a goroutine we return immediately to the next line and don't wait for the function to complete.</p>\n"}], "owner": {"reputation": 1254, "user_id": 5035236, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/334edb2698f4c9829c026a69f659a54d?s=128&d=identicon&r=PG&f=1", "display_name": "hawarden_", "link": "https://stackoverflow.com/users/5035236/hawarden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 37676061, "answer_count": 1, "score": -4, "last_activity_date": 1465293258, "creation_date": 1465292820, "question_id": 37675910, "link": "https://stackoverflow.com/questions/37675910/golang-go-command-inside-script", "title": "Golang: go command inside script?", "body": "<p>I got a script written in Golang that I do not quite understand. I want to know why he wrote <code>go server.Start()</code> inside the script? Why not simply write <code>server.Start?</code></p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/miekg/dns\"\n    \"testing\"\n    \"time\"\n)\n\nconst TEST_ADDR = \"127.0.0.1:9953\"\n\nfunc TestDNSResponse(t *testing.T) {\n    server := NewDNSServer(&amp;Config{\n        dnsAddr: TEST_ADDR,\n    })\n    go server.Start()\n\n    // Allow some time for server to start\n    time.Sleep(150 * time.Millisecond)\n\n    m := new(dns.Msg)\n    m.Id = dns.Id()\n    m.Question = []dns.Question{\n        dns.Question{\"docker.\", dns.TypeA, dns.ClassINET},\n    }\n    c := new(dns.Client)\n    _, _, err := c.Exchange(m, TEST_ADDR)\n\n    if err != nil {\n        t.Error(\"Error response from the server\", err)\n    }\n\n    server.Stop()\n\n    c = new(dns.Client)\n    _, _, err = c.Exchange(m, TEST_ADDR)\n\n    if err == nil {\n        t.Error(\"Server still running but should be shut down.\")\n    }\n}\n</code></pre>\n"}, {"tags": ["web-applications", "go", "architecture", "web-deployment", "paas"], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 961786, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c583f2c2db98cd0c19a9c6bc41b66bd4?s=128&d=identicon&r=PG", "display_name": "tommy_p1ckles", "link": "https://stackoverflow.com/users/961786/tommy-p1ckles"}, "is_accepted": false, "score": 0, "last_activity_date": 1465321360, "creation_date": 1465321360, "answer_id": 37685923, "question_id": 37675268, "link": "https://stackoverflow.com/questions/37675268/suitable-architecture-for-a-small-scale-web-app/37685923#37685923", "title": "Suitable architecture for a small-scale web app", "body": "<ol>\n<li><p>You're probably better off using a database, you might be able to get away with just reading in some text file with user data but it's pretty easy to set up some minimalistic db like SQLite.</p></li>\n<li><p>You'll probably want to just use AWS or Googles thing, you're app is pretty small scale so you'll easily get away with their \"micro\" size nodes. And I think both of those services offer some kind of free tier.</p></li>\n<li><p>Correct, You'll want to use middleware such as <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">gin-gonic</a> that includes support for authentication. Also you'll probably want to familiarize yourself with <a href=\"https://crackstation.net/hashing-security.htm\" rel=\"nofollow\">password hashing</a> if you're going to be implementing an authentication system. </p></li>\n<li><p>Yes, generally most web requests are done with JSON, sometimes XML is used as well.</p></li>\n</ol>\n"}], "owner": {"reputation": 1001, "user_id": 3998255, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/90363a3d7d1cb72cb2369e1fb1221216?s=128&d=identicon&r=PG&f=1", "display_name": "crazyGamer", "link": "https://stackoverflow.com/users/3998255/crazygamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 401, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1465321360, "creation_date": 1465291150, "question_id": 37675268, "link": "https://stackoverflow.com/questions/37675268/suitable-architecture-for-a-small-scale-web-app", "title": "Suitable architecture for a small-scale web app", "body": "<p>I require to architect a web app that typically has the following specifications:</p>\n\n<ul>\n<li>Expected maximum load of <strong>tens of simultaneous users</strong></li>\n<li>A simple authentication token system, with around a <strong>few hundred unique users</strong> over the lifetime, with a proprietory nature</li>\n<li>A <strong>static data source</strong> that is common to all users, with the following characteristics:\n\n<ol>\n<li>A couple of arrays of thousand elements of a custom type (with around 4-5 attributes)</li>\n<li>A couple of square matrices (float 64-bit) of size thousand</li>\n</ol></li>\n<li>Each user may demand <strong>small computations on the common data</strong>, that must be displayed on their browser.</li>\n</ul>\n\n<hr>\n\n<h2>Queries:</h2>\n\n<ol>\n<li>Considering the size, should I use a database for storing the static data, or rely on in-memory arrays by initial reading from a file?</li>\n<li>I need a custom domain, that I can buy from popular registrar websites. Should I host the web app on cloud services such as Google App Engine, or will a private server machine at my location suffice?</li>\n<li>Security of the application code and data of the website is significantly important (even from the users!). Further I need a simple login/authentication system. How should I manage the file of registered users?</li>\n<li>For user-requested computations, I am intending to use JSON to transfer data to and from the server, over POST requests. Is that the correct approach?</li>\n</ol>\n\n<hr>\n\n<h2>Background:</h2>\n\n<p>The web app is being built using Go (Golang) for the back-end and JavaScript/CSS/HTML for the front-end.</p>\n\n<p>I am a well-versed application developer (use C# and MATLAB mostly), but this a relatively \"younger\" attempt on a web-app. My primary concern at this point is the correct architecture. Therefore please guide me to suitable resources if I have got anything fundamentally wrong.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "edited": false, "score": 2, "creation_date": 1465286612, "post_id": 37673718, "comment_id": 62824940, "body": "Just rename your init function"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1465286971, "post_id": 37673718, "comment_id": 62825146, "body": "It&#39;s not needed to call the <code>init</code> function in your case"}], "answers": [{"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 5, "last_activity_date": 1465286869, "last_edit_date": 1465286869, "creation_date": 1465286531, "answer_id": 37673738, "question_id": 37673718, "link": "https://stackoverflow.com/questions/37673718/call-function-in-golang/37673738#37673738", "title": "Call function in Golang", "body": "<p>The <code>init</code> function is a special function in Golang. It is executed the first time the file is loaded, so you never have to call it directly.</p>\n\n<p>From the official documentation:</p>\n\n<blockquote>\n  <p>Finally, each source file can define its own niladic init function to set up whatever state is required. (Actually each file can have multiple init functions.) And finally means finally: init is called after all the variable declarations in the package have evaluated their initializers, and those are evaluated only after all the imported packages have been initialized. </p>\n</blockquote>\n"}], "owner": {"reputation": 1254, "user_id": 5035236, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/334edb2698f4c9829c026a69f659a54d?s=128&d=identicon&r=PG&f=1", "display_name": "hawarden_", "link": "https://stackoverflow.com/users/5035236/hawarden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 37673738, "answer_count": 1, "score": -1, "last_activity_date": 1465286869, "creation_date": 1465286460, "question_id": 37673718, "link": "https://stackoverflow.com/questions/37673718/call-function-in-golang", "title": "Call function in Golang", "body": "<p>I have a function like this:</p>\n\n<pre><code>var flagvar int\nfunc init() {\n    flag.IntVar(&amp;flagvar, \"flagname\", 1234, \"help message for flagname\")\n}\n</code></pre>\n\n<p>I want to call it in <code>func main()</code>:</p>\n\n<pre><code>func main(){\n  init()\n}\n</code></pre>\n\n<p>But it does not work and told me <code>init()</code> is not defined.\nWhat's the problem?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1465296669, "post_id": 37670274, "comment_id": 62831535, "body": "Take a look at this: <a href=\"http://stackoverflow.com/questions/28124412/how-to-implement-two-different-interfaces-with-the-same-method-signature\" title=\"how to implement two different interfaces with the same method signature\">stackoverflow.com/questions/28124412/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1465275423, "creation_date": 1465275423, "answer_id": 37670791, "question_id": 37670274, "link": "https://stackoverflow.com/questions/37670274/interface-conversion-with-different-return-values-implementing-the-same-interfac/37670791#37670791", "title": "Interface conversion with different return values implementing the same interface", "body": "<p>Think of interfaces more as contracts.  They don't implicitly implement other interfaces simply due to the fact they don't implement anything directly.</p>\n\n<p>and interfaces are satisfied by implementations.  (hopefully that makes sense)</p>\n\n<p>In your example, having simple \"Material\" that both meachine types create would work, as in this: <a href=\"https://play.golang.org/p/ZoYJog2Xri\" rel=\"nofollow\">https://play.golang.org/p/ZoYJog2Xri</a></p>\n\n<pre><code>package main\n\ntype Machine1 interface {\n    Produce() Material\n}\n\ntype Machine2 interface {\n    Produce() Material\n}\n\ntype Material interface {\n    Use() error\n}\n\ntype PencilMachine struct{}\n\nfunc (pm *PencilMachine) Produce() Material {\n    return &amp;Pencil{}\n}\n\ntype Pencil struct{}\n\nfunc (p *Pencil) Use() error {\n    return nil\n}\n\nfunc main() {\n    pm := new(PencilMachine)\n\n    var m1 Machine1\n    m1 = Machine1(pm)\n\n    var m2 Machine2\n    m2 = Machine2(m1)\n\n    _ = m2\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1802, "user_id": 754854, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/4acefbd570391b3abbae9cab3beeb7f1?s=128&d=identicon&r=PG", "display_name": "JoeMoe1984", "link": "https://stackoverflow.com/users/754854/joemoe1984"}, "is_accepted": false, "score": 0, "last_activity_date": 1465275806, "creation_date": 1465275806, "answer_id": 37670856, "question_id": 37670274, "link": "https://stackoverflow.com/questions/37670274/interface-conversion-with-different-return-values-implementing-the-same-interfac/37670856#37670856", "title": "Interface conversion with different return values implementing the same interface", "body": "<p>Its because your pencil machine doesn't implement the Machine2 interface. Here is the culprit:</p>\n\n<pre><code>func (pm *PencilMachine) Produce() Material1 {\n    return &amp;Pencil{}\n}\n</code></pre>\n\n<p>You see that although PencilMachine has the same function <code>Produce</code> it does not return the same data type (Material1) therefor it implements Machine1 only. Machine2 requires a <code>Produce</code> function to return Material2</p>\n"}], "owner": {"reputation": 396, "user_id": 3721123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9486c6872c9266819ff8817db8e62967?s=128&d=identicon&r=PG&f=1", "display_name": "Nosajool", "link": "https://stackoverflow.com/users/3721123/nosajool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 3, "answer_count": 2, "score": 3, "last_activity_date": 1465275806, "creation_date": 1465272298, "question_id": 37670274, "link": "https://stackoverflow.com/questions/37670274/interface-conversion-with-different-return-values-implementing-the-same-interfac", "title": "Interface conversion with different return values implementing the same interface", "body": "<p>new to Go. I'm trying to write a test that involves mocking a couple of structs where one of the struct's functions returns an instance of the other struct. However I'm running into an issue that I can reproduce with the following code:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\ntype Machine1 interface {\n    Produce() Material1\n}\n\ntype Machine2 interface {\n    Produce() Material2\n}\n\ntype Material1 interface {\n    Use() error\n}\n\ntype Material2 interface {\n    Use() error\n}\n\ntype PencilMachine struct{}\n\nfunc (pm *PencilMachine) Produce() Material1 {\n    return &amp;Pencil{}\n}\n\ntype Pencil struct{}\n\nfunc (p *Pencil) Use() error {\n    return nil\n}\n\nfunc main() {\n    pm := new(PencilMachine)\n\n    var m1 Machine1\n    m1 = Machine1(pm)\n\n    var m2 Machine2\n    m2 = Machine2(m1)\n\n    _ = m2\n}\n</code></pre>\n\n<p>Which gives the following error:</p>\n\n<pre><code>prog.go:38: cannot convert m1 (type Machine1) to type Machine2:\n    Machine1 does not implement Machine2 (wrong type for Produce method)\n        have Produce() Material1\n        want Produce() Material2\n</code></pre>\n\n<p>Notice how the Pencil struct implements both the Material1 and Material2 interfaces. However the return type of (pm *PencilMachine) Produce() is Material1 and not Material2. Curious why this doesn't work because anything that implements Material1 also implements Material2.</p>\n\n<p>Thanks!</p>\n\n<p><a href=\"https://play.golang.org/p/3D2jsSLoI0\" rel=\"nofollow\">https://play.golang.org/p/3D2jsSLoI0</a></p>\n"}, {"tags": ["go", "godoc"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1465260132, "post_id": 37668656, "comment_id": 62815717, "body": "godoc doesn&#39;t support it. The present/article format does with .image; the format is described at <a href=\"https://godoc.org/golang.org/x/tools/present\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/present</a> and e.g. <a href=\"https://godoc.org/golang.org/x/tools/blog\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/blog</a> uses it for non-presentation blog articles. But once you&#39;re supplementing your documentation outside godoc, maybe it just makes more sense to write Markdown and have Hugo or GitHub render it, or write HTML. (In the godoc, you can always include the URL of images or outside pages I suppose.)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1465260252, "post_id": 37668656, "comment_id": 62815737, "body": "Worth noting that godoc is, effectively, a package reference, and much nontrivial software, including Go, has a lot of other documentation/writing about it outside of the package reference."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1465277427, "post_id": 37668656, "comment_id": 62819993, "body": "The closest to images is ASCII art in code blocks (which works okay for not too large  diagrams)."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1465259816, "creation_date": 1465259816, "answer_id": 37668816, "question_id": 37668656, "link": "https://stackoverflow.com/questions/37668656/images-in-godoc/37668816#37668816", "title": "Images in godoc?", "body": "<p>The godoc tool does not provide a way to add images to documentation.</p>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 37668816, "answer_count": 1, "score": 6, "last_activity_date": 1465259816, "creation_date": 1465258326, "question_id": 37668656, "link": "https://stackoverflow.com/questions/37668656/images-in-godoc", "title": "Images in godoc?", "body": "<p>Is there any way to add images (local or remote) to the HTML version <code>godoc</code> generates?</p>\n\n<p>This is really useful for including diagrams that just can't be explained easily with words.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1465255602, "post_id": 37668224, "comment_id": 62814745, "body": "I took your code and ran it in the playground and it works fine: <a href=\"https://play.golang.org/p/d7JwWCWVqc\" rel=\"nofollow noreferrer\">play.golang.org/p/d7JwWCWVqc</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1465255680, "post_id": 37668224, "comment_id": 62814764, "body": "@Not_a_Golfer I think the question could use some clarification, but I&#39;m pretty sure he&#39;s saying with his second example, he gets an index out of range panic (separate of the code shown, trying to index into it after returning from <code>Pic</code>) and the reason behind that is explained in my answer."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465255767, "post_id": 37668224, "comment_id": 62814791, "body": "@evanmcdonnal oh, I thought he meant the first example doesn&#39;t work."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1465255938, "post_id": 37668224, "comment_id": 62814822, "body": "@Not_a_Golfer yeah, I could be wrong, that is just something I inferred but clearly the first example works and the second doesn&#39;t cause an error either so I just assumed the second function has run then he gets the panic afterwards because he&#39;s expecting the collection to be <code>y</code> by <code>x</code> and it&#39;s actually <code>y</code> by <code>0</code>."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1465255628, "creation_date": 1465255628, "answer_id": 37668311, "question_id": 37668224, "link": "https://stackoverflow.com/questions/37668224/iterating-over-over-a-2d-slice-in-go/37668311#37668311", "title": "iterating over over a 2D slice in go", "body": "<p>The main problem is your attempt to do assignment. Check my example using your code; <a href=\"https://play.golang.org/p/lwoe79jQ70\" rel=\"nofollow\">https://play.golang.org/p/lwoe79jQ70</a></p>\n\n<p>What you actually get out of the latter implementation is a 3x0 array, all of the inner arrays are empty. The reason for this is because you're using the range variable for assignment which doesn't work. If the current index is <code>0</code>, <code>y != pic[0]</code>, <code>pic[0]</code> is assigned to <code>y</code> however, <code>y</code> is temporary storage, it typically is the same address and is over written on each iteration. So after the latter example executes, all your x direction arrays are empty, indexing into one causes a panic.</p>\n\n<p>Basically you should just be using your first implementation because it works fine and is the way you would typically do this. But the take away is, when you do <code>a, b := range Something</code> <code>b != Something[a]</code>, it is it's on instance, it goes out of scope at the bottom of the loop and assigning to it will not cause a state change to the collection <code>Something</code>, instead you must assign to <code>Something[a]</code> if you want to modify <code>Something[a]</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1465273475, "creation_date": 1465273475, "answer_id": 37670457, "question_id": 37668224, "link": "https://stackoverflow.com/questions/37668224/iterating-over-over-a-2d-slice-in-go/37670457#37670457", "title": "iterating over over a 2D slice in go", "body": "<p><strong>range copies the values from the slice you're iterating over.</strong><br>\nSee: <a href=\"http://golang.org/ref/spec#RangeClause\" rel=\"nofollow\">http://golang.org/ref/spec#RangeClause</a>  </p>\n\n<p>To clarify what happens see this simple code example and its output:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := \"hi\"\n    //s[0] = 'H' // cannot assign to s[0]\n    for _, v := range s {\n        fmt.Printf(\"%T, %[1]v, %X\\n\", v, &amp;v)\n        v = 'H' // has no effect: this is local var not ref\n    }\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>The output is:<br>\nint32, 104, C0820042D4<br>\nint32, 105, C0820042D4<br>\nhi<br>\nAs you see <strong>the address of variable v is not changing</strong> (C0820042D4) and v is local variable and range copies value to it, so changing v has no effect. \nHere v is rune (int32 alias), A rune is an integer value identifying a Unicode code point, and you cannot assign to s[0] and this won\u2019t compile: s[0] = 'H'<br>\nso v = 'H'   has no effect on s, it is just local variable.</p>\n"}], "owner": {"reputation": 67, "user_id": 4669076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42db31c862a8974778f6a2d3dcfe5e97?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel D&#39;Souza", "link": "https://stackoverflow.com/users/4669076/daniel-dsouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2434, "favorite_count": 0, "accepted_answer_id": 37668311, "answer_count": 2, "score": 0, "last_activity_date": 1465429896, "creation_date": 1465254923, "last_edit_date": 1465429896, "question_id": 37668224, "link": "https://stackoverflow.com/questions/37668224/iterating-over-over-a-2d-slice-in-go", "title": "iterating over over a 2D slice in go", "body": "<p>I am taking the \"Tour of Go\", and had a question regarding the <a href=\"https://tour.golang.org/moretypes/18\" rel=\"nofollow\">Exercise: Slices example</a>. Currently I can create the picture by iterating over each index using the the [] operator, just like you could in C.</p>\n\n<pre><code>func Pic(dx, dy int) [][]uint8 {\n    pic := make([][]uint8, dy)\n    for i := range pic {\n        pic[i] = make([]uint8, dx)\n        for j := range pic[i] {\n            pic[i][j] = uint8(1)\n        }\n    }\n    return pic\n} \n</code></pre>\n\n<p>However, when I try to do something like below, I get an <code>panic: runtime error: index out of range</code> error. I tried adding print statements and calling <code>Pic(3, 3)</code>, which printed out a 3x3 array just fine.</p>\n\n<pre><code>func Pic(dx, dy int) [][]uint8 {\n    pic := make([][]uint8, dy)\n    for _, y := range pic {\n        y = make([]uint8, dx)\n        for _, x := range y {\n            x = uint8(1)\n            _ = x // x has to be used\n            //fmt.Print(\"1\")\n        }\n        //fmt.Print(\"\\n\")\n    }\n    return pic\n}\n</code></pre>\n\n<p>Any thoughts on what I am doing wrong?</p>\n"}, {"tags": ["variables", "go"], "comments": [{"owner": {"reputation": 411, "user_id": 872346, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/54cc4f8fd0f98d9f645ac2dc68c1730e?s=128&d=identicon&r=PG", "display_name": "newpdv", "link": "https://stackoverflow.com/users/872346/newpdv"}, "edited": false, "score": 0, "creation_date": 1465238393, "post_id": 37664594, "comment_id": 62807595, "body": "I have to declare two variables (completeTime and err) for this to work, but it does not look nice"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465238986, "post_id": 37664594, "comment_id": 62807929, "body": "Go is lexically scoped using blocks: <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Declarations_and_scope</a>. There&#39;s nothing wrong with pre-declaring identifiers."}], "answers": [{"comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1465241392, "post_id": 37664697, "comment_id": 62809188, "body": "The scope of the variable is limited to <code>if {} else if {} else {}</code> so it&#39;s perfectly fine to write the <code>fmt.Println</code> in the <code>else</code> block and you do not have to declare the variable outside of the block."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1465243269, "post_id": 37664697, "comment_id": 62810065, "body": "I don&#39;t disagree, but my answer was directly related to the code OP provided."}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1465256119, "post_id": 37664697, "comment_id": 62814863, "body": "OP provided a version that he discovered worked. He asked for an explanation and how to do it right. It would have been nice to offer both versions as a solution along with an explanation. Maybe merge my answer into yours and I will delete mine?"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 2, "last_activity_date": 1465238585, "creation_date": 1465238585, "answer_id": 37664697, "question_id": 37664594, "link": "https://stackoverflow.com/questions/37664594/how-correctly-to-initialize-some-variables/37664697#37664697", "title": "How correctly to initialize some variables?", "body": "<p>You need to declare it (as you found out) before the if. The scope of the variable in your example is limited to the \"if\" block. Sorry if it doesn't look nice, but that how it be. Please note your second example requires an additional change (note the change in := on the beginning of your if line):</p>\n\n<pre><code>var completeTime time.Time\nvar err error\nif completeTime, err = time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n      return\n}\n\nfmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 3, "last_activity_date": 1465239934, "creation_date": 1465239934, "answer_id": 37665056, "question_id": 37664594, "link": "https://stackoverflow.com/questions/37664594/how-correctly-to-initialize-some-variables/37665056#37665056", "title": "How correctly to initialize some variables?", "body": "<p>You have a scope problem in your code:</p>\n\n<pre><code>if completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n      return\n}\nfmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n\n<p>In this sample, <code>completeTime</code> is defined only for local scope inside the <code>if</code> statement, which means you cannot use it outside it.</p>\n\n<pre><code>var completeTime time.Time\n\nif completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n      return\n    }\n\nfmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n\n<p>This one is a bit more tricky. You define a <code>completeTime</code> var with the correct scope at the beginning. Then, because of the <code>:=</code> operator, you define <strong>another</strong> <code>completeTime</code> inside the <code>if</code> statement, which masks the first one.</p>\n\n<p>Also, this second variable is not used, that's why you get the error. You can fix this problem by simply assigning <code>completeTime</code> and <code>err</code> outside the <code>if</code>:</p>\n\n<pre><code>completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\")\n\nif err != nil {\n    return\n}\n\nfmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 1, "last_activity_date": 1465241813, "creation_date": 1465241813, "answer_id": 37665537, "question_id": 37664594, "link": "https://stackoverflow.com/questions/37664594/how-correctly-to-initialize-some-variables/37665537#37665537", "title": "How correctly to initialize some variables?", "body": "<p>As others have said, variables inside a block are not promoted to the outside of the block. But you can use the declared variables in <code>else</code> and <code>else if</code> statements.</p>\n\n<p>For example (<a href=\"https://play.golang.org/p/2bheYhbmrC\" rel=\"nofollow\">on play</a>):</p>\n\n<pre><code>func main() {\n    if completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(time.Since(completeTime).Seconds())\n    }\n}\n</code></pre>\n\n<p>You can read more about blocks and scopes in the <a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow\">specification</a>.</p>\n"}], "owner": {"reputation": 411, "user_id": 872346, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/54cc4f8fd0f98d9f645ac2dc68c1730e?s=128&d=identicon&r=PG", "display_name": "newpdv", "link": "https://stackoverflow.com/users/872346/newpdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 37665056, "answer_count": 3, "score": 1, "last_activity_date": 1465241813, "creation_date": 1465238252, "question_id": 37664594, "link": "https://stackoverflow.com/questions/37664594/how-correctly-to-initialize-some-variables", "title": "How correctly to initialize some variables?", "body": "<p>If I use a variable declaration into <code>if</code>, I get an error <code>undefined: completeTime</code></p>\n\n<pre><code>    if completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n          return\n        }\n\n    fmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n\n<p>But if I declaration that, I get an error <code>completeTime declared and not used</code></p>\n\n<pre><code>    var completeTime time.Time\n\n    if completeTime, err := time.Parse(time.RFC3339Nano, \"2016-06-06 18:11:24.617Z\"); err != nil {\n          return\n        }\n\n    fmt.Println(time.Since(completeTime).Seconds())\n</code></pre>\n\n<p>Why and how to do it right?</p>\n"}, {"tags": ["linux", "windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465291437, "post_id": 37664425, "comment_id": 62827945, "body": "Oh right I was handling the error of the proc (in another go routine) but not on the actual wait. Do you have any suggestion on how I could recover a process that is, de facto, not a child anymore?"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465292558, "post_id": 37664425, "comment_id": 62828766, "body": "@Lomithrani I may have a few suggestions. What are you trying to do with the process after you &quot;recover&quot; it? Also, anticipating my next question: if you take a few steps back: what problem are you trying to solve?"}, {"owner": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465295321, "post_id": 37664425, "comment_id": 62830622, "body": "My program manage programs (but as it is my first go program it might panic sometimes). I can see what programs are running etc.  basically I need to know if they run and be able to kill them and to know when they crash.  just monitoring processes and not running them directly means  redoing my all app from scratch.It works the way I want on windows it&#39;s quite frustrating not to be able to do the same on linux :( I thought about creating a another process to handle the processes if my app crash with PR_SET_CHILD_SUBREAPER and give them back the same way once my app re runs"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465296167, "post_id": 37664425, "comment_id": 62831195, "body": "@Lomithrani I think this is not its intended use case but you might be able to use <code>ptrace(2)</code> for what you need (it will let you wait on other processes)."}, {"owner": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465296900, "post_id": 37664425, "comment_id": 62831697, "body": "I will look into that, it does seem that it could work thankyou"}, {"owner": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465311825, "post_id": 37664425, "comment_id": 62842871, "body": "from what I read it seems that if I attach my new process instance to the lost one with ptrace, I will send a sigstop to it. I don&#39;t want to interfere with my orphan process. Just to be able to stop it or know when it stopped. Are you sure that I can achieve this with ptrace?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465316936, "post_id": 37664425, "comment_id": 62846416, "body": "@Lomithrani, send the process <code>SIGCONT</code> and it will continue from where it was <code>SIGSTOP</code>-ped. Still, I think your whole approioach is misconsieved. Why not just persist the PIDs of those processes somewhere, zap that storage on clean exit and read it after restart?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465317074, "post_id": 37664425, "comment_id": 62846483, "body": "@Lomithrani, ...or, better, why not delegate monitoring these processed to the process which monitors your (crashing) Go program?  Say, with <code>systemd</code> I beleive this is the standard mode of operation: it places each daemon process into its own <code>cgroup</code> and makes sure that no matter how that process or its children procuced other children (calling <code>setsid()</code> et al notwithstanding) bringing down that daemon will bring down everything it spawned.  So it just works."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "edited": false, "score": 0, "creation_date": 1465317309, "post_id": 37664425, "comment_id": 62846607, "body": "@Lomithrani, if not using <code>systemd</code>, you can study <a href=\"https://en.wikipedia.org/wiki/Process_group\" rel=\"nofollow noreferrer\">Unix process groups</a> and try making a process group out of your Go program so that when it dies -- from the OS sending it a deadly signal -- that signal brings the whole process group down."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 4, "last_activity_date": 1465239424, "last_edit_date": 1465239424, "creation_date": 1465237702, "answer_id": 37664425, "question_id": 37664015, "link": "https://stackoverflow.com/questions/37664015/os-process-wait-after-os-findprocesspid-works-on-windows-not-on-linux/37664425#37664425", "title": "os.Process.Wait() after os.FindProcess(pid) works on windows not on linux", "body": "<p>You're not handing the error message from <code>Wait</code>. Try:</p>\n\n<pre><code>ps, err := proc.Cmd.Wait()\nif err != nil {\n    /* handle it */\n}\n</code></pre>\n\n<p>Also <a href=\"https://golang.org/pkg/os/#Process.Wait\" rel=\"nofollow\">the documentation</a> says:</p>\n\n<blockquote>\n  <p>Wait waits for the Process to exit, and then returns a ProcessState\n  describing its status and an error, if any. Wait releases any\n  resources associated with the Process. <strong>On most operating systems, the\n  Process must be a child of the current process or an error will be\n  returned</strong>.</p>\n</blockquote>\n\n<p>In your case since you're \"recovering\", your process is not the parent of the processes you found using <code>os.FindProcess</code>.</p>\n\n<p>So why does it work on windows? I suspect it is because <a href=\"https://golang.org/src/os/exec_windows.go\" rel=\"nofollow\">on windows</a> it boils down to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms687032\" rel=\"nofollow\"><code>WaitForSingleObject</code></a> which doesn't have that requirement.</p>\n"}], "owner": {"reputation": 1657, "user_id": 842701, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7db418318378c754068efdbd1c121ebb?s=128&d=identicon&r=PG", "display_name": "Lomithrani", "link": "https://stackoverflow.com/users/842701/lomithrani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "accepted_answer_id": 37664425, "answer_count": 1, "score": 6, "last_activity_date": 1465239424, "creation_date": 1465236157, "question_id": 37664015, "link": "https://stackoverflow.com/questions/37664015/os-process-wait-after-os-findprocesspid-works-on-windows-not-on-linux", "title": "os.Process.Wait() after os.FindProcess(pid) works on windows not on linux", "body": "<p>I have an issue when trying to recover a process in go. My go app launch a bunch of processes and when it crashes the processes are out there in the open and when I rerun my app I want to recover my processes. On windows everything works as expected I can <code>wait()</code> on the process <code>kill()</code> it etc.. but in linux it just goes trough my <code>wait()</code> without any error. \nHere is the code</p>\n\n<pre><code>func (proc *process) Recover() {\n\n    pr, err := os.FindProcess(proc.Cmd.Process.Pid)\n\n    if err != nil {\n        return\n    }\n\n    log.Info(\"Recovering \" + proc.Name + proc.Service.Version)\n\n    Processes.Lock()\n    Processes.Map[proc.Name] = proc\n    Processes.Unlock()\n    proc.Cmd.Process = pr\n\n    if proc.Service.Reload &gt; 0 {\n        proc.End = make(chan bool)\n        go proc.KillRoutine()\n    }\n\n    proc.Cmd.Wait()\n\n    if proc.Status != \"killed\" {\n        proc.Status = \"finished\"\n    }\n    proc.Time = time.Now()\n\n\n    channelProcess &lt;- proc\n\n    //confirmation that process was killed\n    if proc.End != nil {\n        proc.End &lt;- true\n    }\n\n}\n</code></pre>\n\n<p>process is my own struct to handle processes the important part is cmd which is from the package <code>\"os/exec\"</code>  I have also tried to directly call <code>pr.wait()</code> with the same issue</p>\n"}, {"tags": ["go", "initialization", "slice"], "comments": [{"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "edited": false, "score": 0, "creation_date": 1465267594, "post_id": 37663594, "comment_id": 62817325, "body": "Just a thought, <code>iota</code> might be what you remember, although this is for const and I know no way to use it on a slice."}], "answers": [{"comments": [{"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1465234718, "post_id": 37663616, "comment_id": 62805555, "body": "Did I read an one line way to do this for some other language? I am new to go."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1465234911, "post_id": 37663616, "comment_id": 62805657, "body": "@gsf probably yes. There are many languages where this can be done in one line but it&#39;s cannot be done in Go. You can use what&#39;s referred to as &#39;composite literal&#39; syntax to allocate and initialize in the same statement but that requires you to write out the values so it would not work when you have an arbitrary length <code>N</code>. One line of code, three lines of code, what difference does it really make? It&#39;s easy to read and understand at a glace, that&#39;s what&#39;s really important."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1465235077, "post_id": 37663616, "comment_id": 62805750, "body": "yeap, it does not matter, unless you are working in a  competitive company and if you miss a detail like this everyone will start picking on you"}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 2, "creation_date": 1465239789, "post_id": 37663616, "comment_id": 62808396, "body": "I think range is better <code>for i := range mySlice { mySlice[i] = i }</code>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465240122, "post_id": 37663616, "comment_id": 62808565, "body": "I would agree that it&#39;s a bit more concise however I would also say you would be much better served thinking about things other than how to most eloquently write a trivial for loop. Like I have a major pet peeve with developers who are so concerned with this kind of crap, worry about the bugs in your code or the applications performance or the user experience."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "edited": false, "score": 0, "creation_date": 1465311025, "post_id": 37663616, "comment_id": 62842240, "body": "@evanmcdonnal you make software engineering sounding so tense. There is a place for all important aspects that you are talking about, but there is also a place for enjoying what you do, and if for someone it means expressing things in the most elegant way in the language they use - so be it. It is not going to be more &quot;harmful&quot; to your project than any other hobby you might have, like watching cute puppy images."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 1, "creation_date": 1465324163, "post_id": 37663616, "comment_id": 62850587, "body": "In my experience bugs are typically introduced by something as little as changing one of the <code>N</code> in your answer but forgetting to change the other."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 8, "last_activity_date": 1465234605, "creation_date": 1465234605, "answer_id": 37663616, "question_id": 37663594, "link": "https://stackoverflow.com/questions/37663594/initialize-golang-slice-with-int-numbers-from-0-to-n/37663616#37663616", "title": "Initialize golang slice with int numbers from 0 to N", "body": "<p>You just use make passing <code>N</code> for the length then use a simple for loop to set the values...</p>\n\n<pre><code>mySlice := make([]int, N)\nfor i := 0; i &lt; N; i++ {\n      mySlice[i] = i\n}\n</code></pre>\n\n<p>Here's a full example on play; <a href=\"https://play.golang.org/p/yvyzuWxN1M\" rel=\"noreferrer\">https://play.golang.org/p/yvyzuWxN1M</a></p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2921, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1465234605, "creation_date": 1465234534, "question_id": 37663594, "link": "https://stackoverflow.com/questions/37663594/initialize-golang-slice-with-int-numbers-from-0-to-n", "title": "Initialize golang slice with int numbers from 0 to N", "body": "<p>I am almost certain that I read about a simple \"tricky\" way to initialize slice of ints with the numbers from 0 to N, but I cannot find it anymore.</p>\n\n<p>What is the simplest way to do this?</p>\n"}, {"tags": ["go", "websocket"], "comments": [{"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465233456, "post_id": 37663016, "comment_id": 62804869, "body": "&gt;the websocket.JSON.Recieve will error. | and what error is it?"}, {"owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "reply_to_user": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465234956, "post_id": 37663016, "comment_id": 62805682, "body": "@Darigaaz the error just says &quot;EOF&quot;. I&#39;ve seen other people using this library and nobody tries to recover from it, I&#39;ve only seen people completely close their application when they get any error or some that specifically close the application on &quot;EOF&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1465237187, "creation_date": 1465237187, "answer_id": 37664271, "question_id": 37663016, "link": "https://stackoverflow.com/questions/37663016/trying-to-recover-websocket-connection/37664271#37664271", "title": "Trying to recover Websocket Connection", "body": "<p>My best guess is it is somehow related to \"max open files\". It is a long shot but give it a try.</p>\n\n<p>Your server/lib does not close/release ended/staled connections properly.</p>\n\n<p>Its OS specific but i guess you are using Linux.\nSo next time you problem happens (before you restart your app) can you run</p>\n\n<pre><code># lsof -p PID | wc -l\n# lsof -a -p PID | wc -l\n</code></pre>\n\n<p>OR</p>\n\n<pre><code># cd /proc/PID/fd; ls -l | wc -l\n</code></pre>\n\n<p>where PID is your server application PID on server's console? And post it along with <code>lsof -a -p PID</code> here via link to gist or something (since i am expecting long list).</p>\n\n<p>Find PID with <code># ps aux | grep APPNAME</code> or <code># pidof APPNAME</code>.</p>\n\n<p>You can check server wide \"max open files\" with</p>\n\n<pre><code>sysctl fs.file-max\n</code></pre>\n\n<p>If it is the case you can increase max open files with <code>sysctl -w fs.file-max= 100000</code> but it will just delay the inevitable, or dig into the code and handle these unterminated connections.</p>\n\n<p>Usefull links <a href=\"http://www.cyberciti.biz/tips/linux-procfs-file-descriptors.html\" rel=\"nofollow\">list open files</a>, <a href=\"http://www.cyberciti.biz/faq/linux-increase-the-maximum-number-of-open-files/\" rel=\"nofollow\">max open files</a> or google yourself.</p>\n"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465237187, "creation_date": 1465232367, "question_id": 37663016, "link": "https://stackoverflow.com/questions/37663016/trying-to-recover-websocket-connection", "title": "Trying to recover Websocket Connection", "body": "<p>I'm using <a href=\"https://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\">this library</a>. After few hours or a day the websocket.JSON.Recieve will error and will get an EOF. I connect to the web socket again and no problems, but then I just keep getting EOF until I restart my application.</p>\n\n<pre><code>func getMessage(ws *websocket.Conn) (m Message, err error) {\n    err = websocket.JSON.Receive(ws, &amp;m)\n    if err != nil {\n        log.Printf(\"Get Message - %s - Reconnecting...\", err)\n        ws, _ = connect(token) // This just does a dial\n        err = websocket.JSON.Receive(ws, &amp;m)\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 0, "creation_date": 1465224582, "post_id": 37659402, "comment_id": 62799505, "body": "Take a look at the package golang.org/x/net/html."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 6409193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74fe2dc455f43510d03ce009300e51cf?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/6409193/elliott"}, "edited": false, "score": 0, "creation_date": 1465223709, "post_id": 37659766, "comment_id": 62798912, "body": "Thanks this helped a lot"}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": true, "score": 5, "last_activity_date": 1465222530, "creation_date": 1465222530, "answer_id": 37659766, "question_id": 37659402, "link": "https://stackoverflow.com/questions/37659402/scan-a-webpage-with-golang/37659766#37659766", "title": "Scan a Webpage with Golang", "body": "<p><a href=\"https://golang.org/pkg/net/http/\" rel=\"noreferrer\">net/http</a> is a good start.</p>\n\n<pre><code>resp, err := http.Get(\"http://example.com/\")\nif err != nil {\n    // handle error\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\n\n// explore\n// fmt.Println(string(body))\n\nif bytes.Contains(body, []byte(\"I'm Feeling Lucky\")) {\n     fmt.Println(\"Correct Website\")\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 6409193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74fe2dc455f43510d03ce009300e51cf?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott", "link": "https://stackoverflow.com/users/6409193/elliott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "closed_date": 1465230935, "accepted_answer_id": 37659766, "answer_count": 1, "score": 0, "last_activity_date": 1465222530, "creation_date": 1465221431, "question_id": 37659402, "link": "https://stackoverflow.com/questions/37659402/scan-a-webpage-with-golang", "closed_reason": "Needs more focus", "title": "Scan a Webpage with Golang", "body": "<p>I want to scan everything that's available on any webpage, then once this is done I want to compare some strings to the content on that webpage. If there's something that is found in common I want to print that it's the correct webpage.\nFor example: when you enter google.com there the \"I'm Feeling Lucky\" button. In my code I have a string that says the same, I want to compare my string to the text written on screen. If they end up the same, I'll print \"Correct Website\".\nHow can I do that?</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1465296851, "post_id": 37659195, "comment_id": 62831661, "body": "I strongly recommend reading this: <a href=\"http://dave.cheney.net/2016/04/07/constant-errors\" rel=\"nofollow noreferrer\">dave.cheney.net/2016/04/07/constant-errors</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1465228422, "post_id": 37660140, "comment_id": 62802045, "body": "Thanks for the answer. However, how am I supposed to integrate that in my table driven tests?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1465229203, "post_id": 37660140, "comment_id": 62802561, "body": "@AbhijeetRastogi: what issue do you have checking the error in your tests?"}, {"owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1465310481, "post_id": 37660140, "comment_id": 62841818, "body": "I wanted to specify error as a value in my <code>getFileTests</code> array. Trying to fit in the table driven approach with this."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "edited": false, "score": 0, "creation_date": 1465312488, "post_id": 37660140, "comment_id": 62843406, "body": "@AbhijeetRastogi: I&#39;m still not following. You can assign the error to the Err field and use <code>is.IsNotExist</code> to check it, or you could assign another known value for a non-existent file, like <code>os.ErrNotExist</code>, or your own error value."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1465223541, "creation_date": 1465223541, "answer_id": 37660140, "question_id": 37659195, "link": "https://stackoverflow.com/questions/37659195/asserting-for-a-specific-error-using-only-standard-library-in-golang/37660140#37660140", "title": "Asserting for a specific error using only standard library in golang", "body": "<p>The <code>os</code> package provides the <a href=\"https://golang.org/pkg/os/#IsNotExist\" rel=\"nofollow\"><code>os.IsNotExist</code></a> function to check the various file existence errors:</p>\n\n<pre><code>if err != nil &amp;&amp; os.IsNotExist(err) {\n    fmt.Println(\"file doesn't exist\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1465231970, "creation_date": 1465231970, "answer_id": 37662907, "question_id": 37659195, "link": "https://stackoverflow.com/questions/37659195/asserting-for-a-specific-error-using-only-standard-library-in-golang/37662907#37662907", "title": "Asserting for a specific error using only standard library in golang", "body": "<p>On a more general level, you can use a <code>strings.Contains()</code> call on <code>err.Error()</code> (which returns the string of the error message).  Example:</p>\n\n<pre><code>if err == nil || !strings.Contains(err.Error(), \"no such file or directory\") {\n    // we didn't get the error we were expecting\n}\n</code></pre>\n\n<p>Note, however, that string matching is rather fragile.  If the package author changes the error message, your test might start failing despite the correct error still being returned.</p>\n\n<p>This is why the idiom in Go is usually for packages to define the error types they return as package-level constants, or more often, variables, since <code>fmt.Errorf()</code> and <code>errors.New()</code> return <code>error</code> interface types, which by definition can't be constant, since interfaces are reference types.  As package-level constants, they can be directly tested for.  Example, the <code>sql</code> package defines <code>sql.ErrNoRows</code>, so you can quickly and easily test if the error a query returned indicates that there were no result rows.</p>\n"}, {"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 0, "last_activity_date": 1465296726, "creation_date": 1465296726, "answer_id": 37677344, "question_id": 37659195, "link": "https://stackoverflow.com/questions/37659195/asserting-for-a-specific-error-using-only-standard-library-in-golang/37677344#37677344", "title": "Asserting for a specific error using only standard library in golang", "body": "<p>You can either create a \"constant\" and use it as a reference for comparison like that :</p>\n\n<pre><code>var ErrFile = errors.New(\"Error opening image file\")\n\nfunc getFile(path string) (string, error) {\n    return \"\", ErrFile\n}\n\nfunc main() {\n    f := \"problem.txt\"\n    _, err := getFile(f)\n    if err == ErrFile {\n       fmt.Printf(\"Problem with file %s\", f)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ORU4PE3zrI\" rel=\"nofollow\">Test on playground</a></p>\n\n<p>Or, if you need more flexibility, you can create your own error type.</p>\n\n<pre><code>type FileError struct {\n    Path string\n}\n\nfunc (e *FileError) Error() string {\n    return fmt.Sprintf(\"Error opening image file: %s\", e.Path)\n}\n\nfunc getFile(path string) (string, error) {\n    return \"\", &amp;FileError{Path: path}\n}\n\nfunc main() {\n    f := \"problem.txt\"\n    _, err := getFile(f)\n    if ferr, ok := err.(* FileError); ok {\n        fmt.Println(ferr)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gduEPfo1Js\" rel=\"nofollow\">Test on playground</a></p>\n"}], "owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1013, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1465296726, "creation_date": 1465220892, "question_id": 37659195, "link": "https://stackoverflow.com/questions/37659195/asserting-for-a-specific-error-using-only-standard-library-in-golang", "title": "Asserting for a specific error using only standard library in golang", "body": "<p>Let's suppose I have a function which return <code>base64</code> encoded string for a file which is located at a specific <code>path</code>. </p>\n\n<pre><code>func getFile(path string) (string, error) {\n    imgFile, err := ioutil.ReadFile(path)\n    if err != nil {\n        return \"\", fmt.Errorf(\"Error opening image file: %s\", err)\n    }\n\n    base64 := base64.StdEncoding.EncodeToString(imgFile)\n    return base64, nil\n}\n</code></pre>\n\n<p>Now, I'm writing table driven tests for this function and they right now look like this. </p>\n\n<pre><code>func TestGetFile(t *testing.T) {\n    type getFileTest struct {\n        Path   string\n        Base64 string\n        Err    error\n    }\n\n    getFileTests := []getFileTest{\n        {\"\", \"\", nil},\n    }\n    for _, td := range getFileTests {\n        base64, err := getFile(td.Path)\n        if err != nil {\n            t.Errorf(\"TestGetFile: Error calling getFile: %s\", err)\n        }\n        if base64 != td.Base64 {\n            t.Errorf(\"TestGetFile: Return values from getFile is not expected: Expected: %s, Returned: %s\", td.Base64, base64)\n        }\n    }\n\n}\n</code></pre>\n\n<p>Now, current test fails with:- </p>\n\n<pre><code>test.go:18: TestGetFile: Error calling getFile: Error opening image file: open : no such file or directory\n</code></pre>\n\n<p>How do I assert that I get the right error when I pass empty path to <code>getFile</code>?</p>\n"}, {"tags": ["go", "amazon-s3"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465220344, "post_id": 37658930, "comment_id": 62796505, "body": "check your errors first."}, {"owner": {"reputation": 1422, "user_id": 4375843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54ce4a955fac0462fea6af3752d97742?s=128&d=identicon&r=PG", "display_name": "jbe", "link": "https://stackoverflow.com/users/4375843/jbe"}, "edited": false, "score": 1, "creation_date": 1465220559, "post_id": 37658930, "comment_id": 62796654, "body": "<a href=\"https://github.com/golang/go/wiki/CommonMistakes#using-goroutines-on-loop-iterator-variables\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/&hellip;</a>"}, {"owner": {"reputation": 7543, "user_id": 1794051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc6d765eadabca02bdd7b44d6504720?s=128&d=identicon&r=PG", "display_name": "val", "link": "https://stackoverflow.com/users/1794051/val"}, "edited": false, "score": 1, "creation_date": 1465220651, "post_id": 37658930, "comment_id": 62796708, "body": "As JimB mentions, you perform a <code>r, _, err := ...</code> but do not check your error: it&#39;s perfectly possible that something goes wrong and the returned <code>r</code> is <code>nil</code>, which would explain your crash. You should handle that case first, making sure that <code>err</code> is <code>nil</code> before attempting to access <code>r</code>."}, {"owner": {"reputation": 497, "user_id": 3003363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb34b5175fd0b3eb8259160eb3d1ae0c?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3003363/ross"}, "edited": false, "score": 0, "creation_date": 1465228251, "post_id": 37658930, "comment_id": 62801945, "body": "Sorry there was a type there. Its bytes.Buffer"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465227603, "post_id": 37659517, "comment_id": 62801557, "body": "No, if you run out of memory, you will get an &quot;out of memory&quot; error. This is a nil pointer dereference."}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465228057, "post_id": 37659517, "comment_id": 62801832, "body": "Yeah, thats exactly what happens when you ran out of memory and internal  <code>bytes.Buffer</code>&#39;s buffer is set to nil pointer. And since you did not check for the error, you are dereferencing nil pointer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465229114, "post_id": 37659517, "comment_id": 62802509, "body": "Good point, forgot that <code>bytes</code> package tries to return <code>ErrTooLarge</code> when it can. I would still check the error before making any assumptions though."}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1465221783, "creation_date": 1465221783, "answer_id": 37659517, "question_id": 37658930, "link": "https://stackoverflow.com/questions/37658930/read-multiple-files-from-s3-using-golang/37659517#37659517", "title": "Read multiple files from S3 using golang", "body": "<p>Probably you ran out of memory.</p>\n\n<p>Is it a typo <code>buf := new(bytes.Reader)</code> in your example, did you mean <code>bytes.Buffer</code>? I guess so.</p>\n\n<pre><code>r, _, err := b.GetReader(...)\n//...\nn, err := buf.ReadFrom(r)\n</code></pre>\n\n<p>Check for errors there. Probably it will be bytes.ErrTooLarge in ReadFrom call.</p>\n\n<blockquote>\n  <p>ErrTooLarge is passed to panic if memory cannot be allocated to store data in a buffer.</p>\n</blockquote>\n"}], "owner": {"reputation": 497, "user_id": 3003363, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/eb34b5175fd0b3eb8259160eb3d1ae0c?s=128&d=identicon&r=PG&f=1", "display_name": "Ross", "link": "https://stackoverflow.com/users/3003363/ross"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1372, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465237420, "creation_date": 1465220130, "last_edit_date": 1465237420, "question_id": 37658930, "link": "https://stackoverflow.com/questions/37658930/read-multiple-files-from-s3-using-golang", "title": "Read multiple files from S3 using golang", "body": "<p>I am a novice in golang.\nI want to read multiple files from Amazon S3. I am using the <a href=\"https://github.com/rlmcpherson/s3gof3r\" rel=\"nofollow\">s3gof3r</a> library. </p>\n\n<p>The go routine is as follows:</p>\n\n<pre><code>for i := 1; i &lt;= fileNo; i++ {\n    go test(i, b)\n}\n\nfunc test(i int, b *Bucket) () {\n    fmt.Println(\"Loading file no:\" + strconv.Itoa(i))\n    defer wg.Done()\n    r, _, err := b.GetReader(\"testFile_\" + strconv.Itoa(i) + \".htm\", nil)\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(r)\n    fmt.Println(err)\n    fmt.Println(\"Completed file no:\" + strconv.Itoa(i))\n    r.Close()           \n    }\n</code></pre>\n\n<p>This code works alright if I have about 200 files (i.e. 200 go routines reading from 200 files) but it crashes if I have to read more files (I have to read more than 10,000 files)</p>\n\n<p>The error that i get is</p>\n\n<pre><code> panic: runtime error: invalid memory address or nil pointer dereference\n    panic(0x39fde0, 0xc8200100f0)\n    /usr/local/go/src/runtime/panic.go:464 +0x3e6\nbytes.(*Buffer).ReadFrom(0xc8200d3f18, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/bytes/buffer.go:176 +0x239\nmain.test(0x4c, 0xc8200bc8e0)\n</code></pre>\n\n<p>The error comes from using 'ReadFrom'. Is there a problem using ReadFrom in this way? Or is this a wrong way to accomplish the task of reading so many files?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465219704, "post_id": 37658719, "comment_id": 62796056, "body": "The first argument to <code>fmt.Printf</code> is always a format string. If you&#39;re not using one, use <code>fmt.Println</code>."}, {"owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465219862, "post_id": 37658719, "comment_id": 62796175, "body": "Yes you are right. I changed it and got un readable output (big list of numbers). So still not working."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465220106, "post_id": 37658719, "comment_id": 62796332, "body": "Yes, it&#39;s a slice of bytes. Convert it to a string (or you could write it to os.Stdout yourself, possibly using fmt.Fprintf)"}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 9, "last_activity_date": 1465219909, "creation_date": 1465219909, "answer_id": 37658851, "question_id": 37658719, "link": "https://stackoverflow.com/questions/37658719/print-function-that-consumes-json-rawmessage-directly/37658851#37658851", "title": "Print function that consumes json.RawMessage directly", "body": "<p>You can use <code>%s</code> to printf:</p>\n\n<pre><code>for _, hit := range serachResult.Hits.Hits {\n   fmt.Printf(\"%s\\n\", hit.Source)\n}\n</code></pre>\n"}], "owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1491, "favorite_count": 0, "accepted_answer_id": 37658851, "answer_count": 1, "score": 5, "last_activity_date": 1465220090, "creation_date": 1465219581, "last_edit_date": 1465220090, "question_id": 37658719, "link": "https://stackoverflow.com/questions/37658719/print-function-that-consumes-json-rawmessage-directly", "title": "Print function that consumes json.RawMessage directly", "body": "<p>I'm doing some work with <code>Elasticsearch</code> and the query return a <code>Source</code> object which it's type is <code>*json.RawMessage</code>.</p>\n\n<p>I only want to print it to screen without creating struct model for it and doing the obvious <code>json.Marshal</code>.</p>\n\n<p>Is there a print function that will consume *json.RawMessage type and print it to screen?</p>\n\n<p>Code sample: </p>\n\n<pre><code> for _, hit := range serachResult.Hits.Hits {\n    fmt.Println(hit.Source, \"\\n\")\n }\n</code></pre>\n\n<p>This code run will result in un-readable array of bytes, apparently without the ability to just build a <code>string</code> from the raw message.</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465230318, "post_id": 37657772, "comment_id": 62803186, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an\">Taking a JSON string, unmarshaling it into a map, editing, and marshaling it into a byte slice seems more complicated then it should be</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 3, "last_activity_date": 1465220588, "last_edit_date": 1465220588, "creation_date": 1465220057, "answer_id": 37658908, "question_id": 37657772, "link": "https://stackoverflow.com/questions/37657772/how-to-build-dynamic-structure-in-golang/37658908#37658908", "title": "how to build dynamic structure in golang?", "body": "<p>When the keys are unknown at compile time, you really can only use <code>map[string]interface{}</code> and then some helper functions to navigate that structure.</p>\n\n<p>If the keys literally are a1, a2, a3 etc... you can make an actual struct, but it would not be pretty as you have to spell out each and every key.</p>\n\n<p>In general, when the keys of your documents are part of the data, you can't really create static structures.</p>\n\n<p>And by \"part of the data\" I mean:</p>\n\n<pre><code>{\n  \"billy\":23,\n  \"tommy\":24\n}\n</code></pre>\n\n<p>vs</p>\n\n<pre><code>[\n  {\"name\":\"billy\", \"age\":23},\n  {\"name\":\"tommy\", \"age\":24}\n]\n</code></pre>\n\n<p>This second form can be represented as:\nstruct { Name string, Age int }</p>\n\n<p>while the first one can really only be:\nmap[string]int or map[string]interface{}  (if the structure is deep)</p>\n"}, {"tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1465230084, "last_edit_date": 1495541306, "creation_date": 1465227920, "answer_id": 37661619, "question_id": 37657772, "link": "https://stackoverflow.com/questions/37657772/how-to-build-dynamic-structure-in-golang/37661619#37661619", "title": "how to build dynamic structure in golang?", "body": "<p>It's better to define your <em>desired</em> structure first (with nested structures as levels). And then implement <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">UnmarshalJSON([]byte) error</a> interface to convert incoming data do desired structure.</p>\n\n<p>I do not want to write long examples unless I am sure what do you want =)\nI would like to take similar approach as I used in <a href=\"https://stackoverflow.com/a/37599644/6248842\">Merge a dynamic data structure in Go</a>.</p>\n\n<p>Do you need those \"A1\"..\"ZN\", (\"a1\"..\"an\")...(\"z1\"..\"zn\") keys? Or slices will be enough? Like:</p>\n\n<pre><code>type S struct {\n    ID bson.ObjectId\n    Data [][][]string\n}\n</code></pre>\n\n<p>Or may be convert inner <code>[]string</code></p>\n\n<pre><code>[\n   \"abc\",\n   \"def\",\n   \"ghi\"\n]\n</code></pre>\n\n<p>to some struct, if there are only 3 elements?</p>\n"}], "owner": {"reputation": 308, "user_id": 6098460, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1182201388457702/picture?type=large", "display_name": "Chetan Kumar", "link": "https://stackoverflow.com/users/6098460/chetan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 0, "accepted_answer_id": 37658908, "answer_count": 2, "score": 0, "last_activity_date": 1465237803, "creation_date": 1465216912, "last_edit_date": 1465237803, "question_id": 37657772, "link": "https://stackoverflow.com/questions/37657772/how-to-build-dynamic-structure-in-golang", "title": "how to build dynamic structure in golang?", "body": "<p>I have this json file,In this json file there are n number of key as we see\nA1,B1......................................................................zn,\na1,a2.......................................................................an,\nb1..........................................................................bn\netc.</p>\n\n<pre><code>     {\n        \"_id\": \"5746992a54c1ae24d53ce651\",\n        \"A1\": [\n            {\n                \"a1\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n            {\n                \"a2\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n    .\n    .\n    ,\n             {\n                \"an\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            }\n        ],\n        \"B1\": [\n            {\n                \"b1\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n            {\n                \"b2\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n            {\n                \"bn\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            }\n        ],\n    .\n    .\n    .\n    ,\n        \"Bn\": [\n            {\n                \"b1\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n            {\n                \"b2\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            },\n            {\n                \"bn\": [\n                    \"abc\",\n                    \"def\",\n                    \"ghi\"\n                ]\n            }\n        ]\n    }\n</code></pre>\n\n<p>how to call their structure in golang </p>\n\n<pre><code>type Level1 struct {\n    TAGID     bson.ObjectId       `json:\"_id\" bson:\"_id\"`\n    LEVELTAG2 []Level2            `json:\"level2\" bson:\"level2\"`     \n}\n\ntype LevelTag2 struct{\n        LEVEL3 []string           `json:\"level3\" bson:\"level3\"`\n}\n</code></pre>\n\n<p>I build this structure in golang is there right way or any other way\nplease help me out</p>\n"}, {"tags": ["go", "argv", "cgo"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1465216216, "post_id": 37657326, "comment_id": 62793728, "body": "There&#39;s no other way sadly."}, {"owner": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1465216301, "post_id": 37657326, "comment_id": 62793774, "body": "Can you please post code to that? I&#39;m not exactly shure"}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "edited": false, "score": 3, "creation_date": 1465232934, "post_id": 37658302, "comment_id": 62804634, "body": "@EddynandFuchs Glad to help, if the tweaks you made made it better optimized, please post a play link here so future readers would benefit too."}, {"owner": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "edited": false, "score": 1, "creation_date": 1465414208, "post_id": 37658302, "comment_id": 62896399, "body": "I just fitted it to the code given in the question (MPI_Init instead of printArgs) and renamed some variables"}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 6, "last_activity_date": 1465218710, "last_edit_date": 1465218710, "creation_date": 1465218370, "answer_id": 37658302, "question_id": 37657326, "link": "https://stackoverflow.com/questions/37657326/go-passing-argv-to-c-function/37658302#37658302", "title": "Go: passing argv to C function", "body": "<p>Here's a minimal example, my C skills are rather rusty so there might be a better way:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\nstatic void* allocArgv(int argc) {\n    return malloc(sizeof(char *) * argc);\n}\nstatic void printArgs(int argc, char** argv) {\n    int i;\n    for (i = 0; i &lt; argc; i++) {\n        printf(\"%s\\n\", argv[i]);\n    }\n}\n*/\nimport \"C\"\n\nimport (\n    \"os\"\n    \"unsafe\"\n)\n\nfunc main() {\n    argv := os.Args\n    argc := C.int(len(argv))\n    c_argv := (*[0xfff]*C.char)(C.allocArgv(argc))\n    defer C.free(unsafe.Pointer(c_argv))\n\n    for i, arg := range argv {\n        c_argv[i] = C.CString(arg)\n        defer C.free(unsafe.Pointer(c_argv[i]))\n    }\n    C.printArgs(argc, unsafe.Pointer(c_argv))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KiRGVvrG-2\" rel=\"noreferrer\"><kbd>playground</kbd></a></p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 2264070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ymmr4.jpg?s=128&g=1", "display_name": "Vladimir Venediktov", "link": "https://stackoverflow.com/users/2264070/vladimir-venediktov"}, "is_accepted": false, "score": 3, "last_activity_date": 1522546560, "creation_date": 1522546560, "answer_id": 49594015, "question_id": 37657326, "link": "https://stackoverflow.com/questions/37657326/go-passing-argv-to-c-function/49594015#49594015", "title": "Go: passing argv to C function", "body": "<p>Can't add comment not enough points on stack-overflow , however when I run with go 1.9 I Have to cast the last line to (**C.char)</p>\n\n<pre><code>C.printArgs(argc, (**C.char)(unsafe.Pointer(c_argv)))\n</code></pre>\n"}], "owner": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 784, "favorite_count": 1, "accepted_answer_id": 37658302, "answer_count": 2, "score": 4, "last_activity_date": 1522546560, "creation_date": 1465215618, "question_id": 37657326, "link": "https://stackoverflow.com/questions/37657326/go-passing-argv-to-c-function", "title": "Go: passing argv to C function", "body": "<p>Since Go 1.6 this code:</p>\n\n<pre><code>argc := len(*argv)\nc_argc := C.int(argc)\n\nc_argv := make([]*C.char, argc)\nfor index, value := range *argv {\n    c_argv[index] = C.CString(value)\n    defer C.free(unsafe.Pointer(c_argv[index]))\n}\n\nerr := C.MPI_Init(&amp;c_argc, (***C.char)(unsafe.Pointer(&amp;c_argv)))\n</code></pre>\n\n<p>Doesn not work anymore and fails with <code>runtime error: cgo argument has Go pointer to Go pointer</code>. I have read about allocing the array in C with malloc() and then copying everything but this is very difficult to do (because the argv elements have different lengths and also very unperformant</p>\n"}, {"tags": ["go", "cmd"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465224042, "post_id": 37655888, "comment_id": 62799130, "body": "We can&#39;t tell what the actual text is from pictures of your screen. Have you compared the raw bytes input vs output? How is the output generated in the terminal (line by line, or possibly via a curses library), and how do you get it into your program?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465709795, "post_id": 37660406, "comment_id": 63010439, "body": "is there anyway to achive the same result\uff1f thinks"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465718832, "post_id": 37660406, "comment_id": 63012193, "body": "@LiumChen: Many ways. You could just modify the source code of mtr to do what you need it to do. Or use traceroute instead. Or find out if mtr uses a library that you could also use, or if you could convert the mtr code into a library."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465718978, "post_id": 37660406, "comment_id": 63012223, "body": "@LiumChen: Or possibly you could read the mtr manual and see that it has command-line options designed to produce reports."}, {"owner": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465746377, "post_id": 37660406, "comment_id": 63019690, "body": "but if you use python print\uff0cthen all is ok"}, {"owner": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465746719, "post_id": 37660406, "comment_id": 63019805, "body": "while 1: \ttry: \t\tline = sys.stdin.readline() \t\tif not line: \t\t\tbreak \t\tprint  line \texcept: \t\tsys.exit() ## python code like this ,everython goes fine"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "edited": false, "score": 0, "creation_date": 1465797528, "post_id": 37660406, "comment_id": 63032485, "body": "@LiumChen: No, the python code produces mixed up output also. Did you try it? I did, just now."}], "tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 1, "last_activity_date": 1465224418, "creation_date": 1465224418, "answer_id": 37660406, "question_id": 37655888, "link": "https://stackoverflow.com/questions/37655888/unordered-output-from-bufio-scanner/37660406#37660406", "title": "Unordered output from bufio.Scanner", "body": "<p>The <code>mtr</code> program is using special terminal escape sequences to redrawn the lines it has written. It's output is <strong>not</strong> in order.</p>\n\n<p>That is why you fail.</p>\n"}], "owner": {"reputation": 1, "user_id": 6430055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1eToNRWgXDg/AAAAAAAAAAI/AAAAAAAAAJ8/7E_Q2tog3d8/photo.jpg?sz=128", "display_name": "Lium Chen", "link": "https://stackoverflow.com/users/6430055/lium-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465226627, "creation_date": 1465211393, "last_edit_date": 1465226627, "question_id": 37655888, "link": "https://stackoverflow.com/questions/37655888/unordered-output-from-bufio-scanner", "title": "Unordered output from bufio.Scanner", "body": "<p>I use golang to receive mtr info and after some work send it to <code>os.stdout</code> \nHowever the output is in unordered.\nthe code below</p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\n    for scanner.Scan() {\n        input := scanner.Text()\n        fmt.Println(input)\n    }\n</code></pre>\n\n<p>The right order looks like this</p>\n\n<p><strong>image description here</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/odu8L.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/odu8L.png\" alt=\"enter image description here\"></a></p>\n\n<p>And this is the output from the code above:</p>\n\n<p><strong>image description here</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/BEvvg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BEvvg.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "garbage-collection", "goroutine"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1465214732, "post_id": 37655852, "comment_id": 62792708, "body": "you should post panic output here. Most likely because you modify x without any synchronization from 2 goroutines. Assigning to slice is not atomic operation."}, {"owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1465217469, "post_id": 37655852, "comment_id": 62794536, "body": "i have run this sample code for 5 minutes in my mac pro(i5 cpu) but receive no panic. @kostya"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465217937, "post_id": 37655852, "comment_id": 62794878, "body": "You&#39;re also blocking the STW GC phase with your busy loop. Sleeping for 1 nanosecond is only burning CPU."}, {"owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1465218018, "post_id": 37655852, "comment_id": 62794932, "body": "if it panic in my computer, i won&#39;t ask this question. but, i know it should panic as the reason you post.   @kostya"}, {"owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "edited": false, "score": 0, "creation_date": 1465218340, "post_id": 37655852, "comment_id": 62795169, "body": "but even i use time.Sleep(1 * time.Second). it still has not panic for 5minutes in my computer.   and @khrm say it would not panic at all."}], "answers": [{"comments": [{"owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "edited": false, "score": 0, "creation_date": 1465214955, "post_id": 37656989, "comment_id": 62792844, "body": "i want to know if &quot;y := x&quot; is atomic? if it is not.   <i>italic</i> <b>bold</b> <code>mov eax  123,  mov y eax</code>   then eax has the value of 123.... and x was point to 124, just this time, gc happened,   gc find the address of 123 is free, so it recycled 123....then y was assigned 123 which is recycled?!"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "edited": false, "score": 0, "creation_date": 1465215182, "post_id": 37656989, "comment_id": 62792985, "body": "No normal assignment is atomic in go, Or atleast guaranteed to be atomic. But it won&#39;t make your program panic."}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465215448, "post_id": 37656989, "comment_id": 62793182, "body": "i := new(int32) \tatomic.StoreInt32(i, 100) //atomic checkmate"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "edited": false, "score": 0, "creation_date": 1465215552, "post_id": 37656989, "comment_id": 62793254, "body": "@Darigaaz That&#39;s what I wrote. No normal assignment is atomic."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465215766, "post_id": 37656989, "comment_id": 62793411, "body": "Yes. There&#39;s data race because you changing x value and assigning it also. So there&#39;s a race condition. But it&#39;s not alright in production code. And it won&#39;t cause panic for your sample. But code isn&#39;t correct."}, {"owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "edited": false, "score": 0, "creation_date": 1465216177, "post_id": 37656989, "comment_id": 62793705, "body": "so,why gc not happen. and recycle the memory of 123?"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465216336, "post_id": 37656989, "comment_id": 62793799, "body": "It collects the memory of only those which aren&#39;t assign to any variable. In this case, either it is assign to y or x.  While y := x isn&#39;t atomic and x value can get updated, there&#39;s always some value in x. If gc collects 123, y can get new value. If not then old value."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465216703, "post_id": 37656989, "comment_id": 62794024, "body": "In short, only those things are gced who aren&#39;t assign to any value. Here if it has been assign to y, then there&#39;s no case for it being gc. It can only be GC if it isn&#39;t assign to any variable."}], "tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 1, "last_activity_date": 1465215599, "last_edit_date": 1465215599, "creation_date": 1465214749, "answer_id": 37656989, "question_id": 37655852, "link": "https://stackoverflow.com/questions/37655852/would-this-code-cause-a-panic-after-gc-in-go1-5/37656989#37656989", "title": "Would this code cause a panic after GC in Go1.5?", "body": "<p>No. First of all, x has a global scope. So GC won't happen until a new value with new address is assign to it. </p>\n\n<p>Now when a new value is assign, two things can happen:</p>\n\n<ol>\n<li>Goroutine assigning y to x happens. It get assign to y. Then no GC will happen.</li>\n<li>It will get new value with new address before first step happens. </li>\n</ol>\n\n<p>I don't know what you are trying to do. But there's no panic even if goroutine runs simultaneously. X always has a value.</p>\n\n<p>Since you asked that whether assignment is atomic: No normal assignment is atomic. </p>\n"}, {"comments": [{"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465215612, "post_id": 37657079, "comment_id": 62793298, "body": "It has race condition, but it won&#39;t panic."}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1465214995, "creation_date": 1465214995, "answer_id": 37657079, "question_id": 37655852, "link": "https://stackoverflow.com/questions/37655852/would-this-code-cause-a-panic-after-gc-in-go1-5/37657079#37657079", "title": "Would this code cause a panic after GC in Go1.5?", "body": "<p>\"is not really assigned\" - what, there is no such thing in go.</p>\n\n<p>Your code has a race condition <code>go run -race</code>, it writes to \"x\", reads from \"x\" and grows \"x\"'s slice at the same time.</p>\n\n<p>\"y := x\" is not atomic in general, it depends on value, but it is not atomic for slice/interface{}/map/struct for sure. There is sync.atomic package for atomic primitives.</p>\n"}], "owner": {"reputation": 371, "user_id": 5725927, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/gW2Pd.jpg?s=128&g=1", "display_name": "rongdong.bai", "link": "https://stackoverflow.com/users/5725927/rongdong-bai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 37656989, "answer_count": 2, "score": -2, "last_activity_date": 1465215599, "creation_date": 1465211274, "question_id": 37655852, "link": "https://stackoverflow.com/questions/37655852/would-this-code-cause-a-panic-after-gc-in-go1-5", "title": "Would this code cause a panic after GC in Go1.5?", "body": "<pre><code>package main\n\nimport \"time\"\n\nvar x = []string{}\n\nfunc main() {\n    go func() {\n        for {\n            y := x\n            y = append(y, \"aa\")\n        }\n    }()\n    go func() {\n        for {\n           x = []string{\"123\"}\n        }\n    }()\n    for {\n        time.Sleep(1)\n    }\n}\n</code></pre>\n\n<p>guess like when x (for example, the address of 123) is not really assigned to y, and x is assigned to a new address like 124.\nand just this time gc happened, would the address of 123 be recycled and cause a panic?</p>\n"}, {"tags": ["go", "parameters", "configuration", "beego"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465208810, "post_id": 37654105, "comment_id": 62789165, "body": "This should be an edit to your question. You can edit your question."}, {"owner": {"reputation": 5897, "user_id": 1025328, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0fa6e6dafa3dbb6123884701aed8785?s=128&d=identicon&r=PG", "display_name": "Prasad Khode", "link": "https://stackoverflow.com/users/1025328/prasad-khode"}, "edited": false, "score": 0, "creation_date": 1465211978, "post_id": 37654105, "comment_id": 62791074, "body": "Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question. - <a href=\"/review/low-quality-posts/12593858\">From Review</a>"}, {"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "reply_to_user": {"reputation": 5897, "user_id": 1025328, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d0fa6e6dafa3dbb6123884701aed8785?s=128&d=identicon&r=PG", "display_name": "Prasad Khode", "link": "https://stackoverflow.com/users/1025328/prasad-khode"}, "edited": false, "score": 0, "creation_date": 1465212880, "post_id": 37654105, "comment_id": 62791562, "body": "@Prasad Khode that&#39;s an answer actually. The problem was solved after I imported the above package."}], "tags": [], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "is_accepted": true, "score": 0, "last_activity_date": 1487169286, "last_edit_date": 1487169286, "creation_date": 1465205934, "answer_id": 37654105, "question_id": 37653932, "link": "https://stackoverflow.com/questions/37653932/undefined-beego-in-beego-appconfig-how-to-access-beego-configuration-parame/37654105#37654105", "title": "&quot;undefined: beego in beego.AppConfig&quot; - How to access Beego configuration parameters", "body": "<p>That was caused by a stupid mistake... I forgot to add the beego package... Try the following:</p>\n\n<p><code>import \"github.com/astaxie/beego\"</code></p>\n"}], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 37654105, "answer_count": 1, "score": -4, "last_activity_date": 1487169286, "creation_date": 1465205432, "question_id": 37653932, "link": "https://stackoverflow.com/questions/37653932/undefined-beego-in-beego-appconfig-how-to-access-beego-configuration-parame", "title": "&quot;undefined: beego in beego.AppConfig&quot; - How to access Beego configuration parameters", "body": "<p>As proposed here <a href=\"http://beego.me/docs/mvc/controller/config.md\" rel=\"nofollow\">http://beego.me/docs/mvc/controller/config.md</a>, I add parameters for MySQL user/password and when trying to access them (for example by using</p>\n\n<p><code>beego.AppConfig.String(\"mysqluser\")</code>)</p>\n\n<p>I get an <code>\"undefined: beego in beego.AppConfig\"</code> message. Any suggestions?</p>\n"}, {"tags": ["go", "atom-editor"], "comments": [{"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 1, "creation_date": 1465190564, "post_id": 37649988, "comment_id": 62779889, "body": "It&#39;s not a programming problem."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1465199896, "post_id": 37649988, "comment_id": 62784059, "body": "Masood, Its about a software tool commonly used by programmers. So should be <a href=\"http://stackoverflow.com/help/on-topic\">on-topic</a>."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1465199933, "post_id": 37649988, "comment_id": 62784085, "body": "Ben, check <a href=\"http://stackoverflow.com/questions/31455131/atom-editor-golang-go-to-declaration-not-working\">this question</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "is_accepted": true, "score": 2, "last_activity_date": 1476061022, "creation_date": 1476061022, "answer_id": 39950023, "question_id": 37649988, "link": "https://stackoverflow.com/questions/37649988/add-cmdclick-navigation-to-definition-in-atom-editor-with-golang/39950023#39950023", "title": "Add Cmd+Click navigation to definition in Atom editor with Golang?", "body": "<p>The \"Go to Definition\" option is built-in to Atom and requires ctags, which is a bit of work to set up for Go.  Instead, you can install the <a href=\"https://atom.io/packages/navigator-go\" rel=\"nofollow\"><code>navigator-go</code></a> package, which will allow you to jump to definition with a keyboard shortcut.</p>\n\n<p>If you prefer cmd+click as opposed to a keyboard shortcut, you can also install:</p>\n\n<ul>\n<li><a href=\"https://atom.io/packages/go-hyperclick\" rel=\"nofollow\"><code>go-hyperclick</code></a> **</li>\n<li><a href=\"https://atom.io/packages/hyperclick\" rel=\"nofollow\"><code>hyperclick</code></a></li>\n</ul>\n\n<p><em>* Note:</em> <code>navigator-go</code> was recently renamed, and <code>go-hyperclick</code> still points at the old repo, so you may get some warnings about a missing package until <a href=\"https://github.com/zheng1/go-hyperclick/pull/3\" rel=\"nofollow\">this PR</a> is merged. </p>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "accepted_answer_id": 39950023, "answer_count": 1, "score": 1, "last_activity_date": 1476061022, "creation_date": 1465190238, "question_id": 37649988, "link": "https://stackoverflow.com/questions/37649988/add-cmdclick-navigation-to-definition-in-atom-editor-with-golang", "title": "Add Cmd+Click navigation to definition in Atom editor with Golang?", "body": "<p>Does anyone know if it's possible to jump around code in a project by Control/Cmd+Click? I keep right-clicking and doing \"Go to Definition\" but that doesn't seem to work.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1465183540, "post_id": 37648288, "comment_id": 62778242, "body": "<code>A []int</code> is <b>not</b> an array, it is a slice."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1465188534, "post_id": 37648288, "comment_id": 62779315, "body": "Probably better to use closure to simulate a generator."}, {"owner": {"reputation": 5229, "user_id": 158179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DETF6.jpg?s=128&g=1", "display_name": "N0thing", "link": "https://stackoverflow.com/users/158179/n0thing"}, "edited": false, "score": 0, "creation_date": 1465191000, "post_id": 37648288, "comment_id": 62780027, "body": "I did a closure initially, but the resulting code was awfully complicated -- not something that I would be willing to use in production."}, {"owner": {"reputation": 5229, "user_id": 158179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DETF6.jpg?s=128&g=1", "display_name": "N0thing", "link": "https://stackoverflow.com/users/158179/n0thing"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1465228194, "post_id": 37648288, "comment_id": 62801910, "body": "@Volker Made correction, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 5229, "user_id": 158179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DETF6.jpg?s=128&g=1", "display_name": "N0thing", "link": "https://stackoverflow.com/users/158179/n0thing"}, "edited": false, "score": 0, "creation_date": 1465191169, "post_id": 37648948, "comment_id": 62780075, "body": "Makes total sense. So it means that basically if one really wanted to push this to work two alternating arrays would work correctly, right?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 5229, "user_id": 158179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DETF6.jpg?s=128&g=1", "display_name": "N0thing", "link": "https://stackoverflow.com/users/158179/n0thing"}, "edited": false, "score": 0, "creation_date": 1465191516, "post_id": 37648948, "comment_id": 62780179, "body": "I get what you mean about two alternating arrays, but I don&#39;t see how it would work in practice since your permutations code is keeping state in A. In principle it can work to avoid the race condition."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 4, "last_activity_date": 1465181783, "creation_date": 1465181783, "answer_id": 37648948, "question_id": 37648288, "link": "https://stackoverflow.com/questions/37648288/golang-implementing-generator-yield-with-channels-odd-channel-behavior/37648948#37648948", "title": "golang implementing generator / yield with channels: odd channel behavior", "body": "<p>It's a mistake to think this code is like generators/yield in Python, and that's what's causing your error.</p>\n\n<p>In Python, when you request the next item from a generator, the generator starts executing and stops when the next <code>yield &lt;value&gt;</code> statement is reached. There is no parallelism in Python's generators: the consumer runs until it wants a value, then the generator runs until it produces a value, then the consumer gets the value and continues execution.</p>\n\n<p>In your go code, the goroutine executes concurrently with the code that's consuming items. As soon as an item is read from the channel from the main code, the goroutine works concurrently to produce the next. The goroutine and the consumer both run until they reach the channel send/receive, then the value is sent from the goroutine to the consumer, then they both continue execution.</p>\n\n<p>That means the backing array of <code>A</code> gets modified concurrently as the goroutine works to generate the next item. And that's a race condition which causes your unexpected output. To demonstrate that this is a race, insert <code>time.Sleep(time.Second)</code> after the channel send. Then the code produces the correct results (albeit slowly): <a href=\"https://play.golang.org/p/uEa_k6Brcc\" rel=\"nofollow\">https://play.golang.org/p/uEa_k6Brcc</a></p>\n"}], "owner": {"reputation": 5229, "user_id": 158179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/DETF6.jpg?s=128&g=1", "display_name": "N0thing", "link": "https://stackoverflow.com/users/158179/n0thing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "accepted_answer_id": 37648948, "answer_count": 1, "score": 1, "last_activity_date": 1465228333, "creation_date": 1465174910, "last_edit_date": 1465228333, "question_id": 37648288, "link": "https://stackoverflow.com/questions/37648288/golang-implementing-generator-yield-with-channels-odd-channel-behavior", "title": "golang implementing generator / yield with channels: odd channel behavior", "body": "<p>The following code implements the yield pattern in golang. As an experiment I was implementing an <code>all permutations</code> generator. However, when I return the slice <code>A</code> to channel, if I do not create a new copy of the array I get an incorrect result.</p>\n\n<p>Please see the code around \"<code>???</code>\". Can someone explain what happens under the covers here? I thought that since the channel is not buffered, I was guaranteed that after publishing the array's slice to the channel I was ensured that the result would be consumed before continuing.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc swap(A []int, i int, j int) {\n    t := A[i]\n    A[i] = A[j]\n    A[j] = t\n}\n\nfunc recurse(A []int, c chan []int, depth int) {\n\n    if depth == len(A) {\n        // ??? Why do I need to copy the data?\n        // If I do c &lt;- A I get an incorrect answer.\n        ra := make([]int, len(A))\n        copy(ra, A)\n        c &lt;- ra\n        return\n    }\n\n    for i := depth; i &lt; len(A); i++ {\n        swap(A, depth, i)\n        recurse(A, c, depth+1)\n        swap(A, depth, i)\n    }\n}\n\nfunc yieldPermutations(A []int, c chan []int) {\n    recurse(A, c, 0)\n    close(c)\n}\n\nfunc main() {\n    A := []int{1, 2, 3}\n    c2 := make(chan []int)\n\n    go yieldPermutations(A, c2)\n    for v := range c2 {\n        fmt.Println(v)\n    }\n}\n</code></pre>\n\n<p>If I do not copy the data, I get the following result:</p>\n\n<pre><code>[1 3 2]\n[1 3 2]\n[2 3 1]\n[2 3 1]\n[3 1 2]\n[3 1 2]\n</code></pre>\n\n<p>Obviously, the correct result (which we get with data copy) is:</p>\n\n<pre><code>[1 2 3]\n[1 3 2]\n[2 1 3]\n[2 3 1]\n[3 2 1]\n[3 1 2]\n</code></pre>\n"}, {"tags": ["go", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 2555, "user_id": 663848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RO5jE.jpg?s=128&g=1", "display_name": "aarti", "link": "https://stackoverflow.com/users/663848/aarti"}, "edited": false, "score": 0, "creation_date": 1465157917, "post_id": 37646059, "comment_id": 62772776, "body": "I have it working now, but curious why it doesn&#39;t that work in playground <a href=\"https://play.golang.org/p/ZXLbG7hDMw\" rel=\"nofollow noreferrer\">play.golang.org/p/ZXLbG7hDMw</a>&quot; prog.go:5:5: cannot find package &quot;golang.org/x/text/width&quot;"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 2555, "user_id": 663848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RO5jE.jpg?s=128&g=1", "display_name": "aarti", "link": "https://stackoverflow.com/users/663848/aarti"}, "edited": false, "score": 2, "creation_date": 1465179002, "post_id": 37646059, "comment_id": 62777441, "body": "Because packages that are not in the standard library are not imported in the playground (security, keeping them up-to-date, space, ...)"}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 7, "last_activity_date": 1465155924, "creation_date": 1465155924, "answer_id": 37646059, "question_id": 37645902, "link": "https://stackoverflow.com/questions/37645902/how-can-i-convert-full-width-number-characters-to-ascii-in-golang/37646059#37646059", "title": "How can I convert Full-width number characters to Ascii in Golang?", "body": "<p>You can use the <a href=\"https://godoc.org/golang.org/x/text/width#Transformer\" rel=\"noreferrer\"><code>width.Transformer</code></a> of the <a href=\"https://godoc.org/golang.org/x/text\" rel=\"noreferrer\"><code>golang.org/x/text</code></a> package to do the transformation but the standard library does not have this functionality. <code>x/text</code> is one of many official sub-repositories which have weaker compatibility requirements (see <a href=\"https://golang.org/pkg/#other\" rel=\"noreferrer\">here</a>).</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"golang.org/x/text/width\"\n)\n\nfunc main() {\n    s := \"\uff11\uff12\uff13\"\n    n := width.Narrow.String(s)\n    fmt.Printf(\"%U: %s\\n\", []rune(s), s)\n    fmt.Printf(\"%U: %s\\n\", []rune(n), n)\n}\n</code></pre>\n"}], "owner": {"reputation": 2555, "user_id": 663848, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/RO5jE.jpg?s=128&g=1", "display_name": "aarti", "link": "https://stackoverflow.com/users/663848/aarti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 37646059, "answer_count": 1, "score": 3, "last_activity_date": 1465155924, "creation_date": 1465154863, "question_id": 37645902, "link": "https://stackoverflow.com/questions/37645902/how-can-i-convert-full-width-number-characters-to-ascii-in-golang", "title": "How can I convert Full-width number characters to Ascii in Golang?", "body": "<p>How do I convert full width characters into ascii characters in golang. The input in my program is full width numbers and I need to run some computations on them, so I assume I have to write a convert function like below, Before I start mapping bytes and such I was wondering if this is indeed available in the standard go library</p>\n\n<pre><code>fullWidth:=\"\uff11\uff12\uff13\"\nexpected := \"123\"\nfunc convert(input string) string {\n// body\n}\n\nexpected == convert(fullWidth)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1465157100, "post_id": 37646231, "comment_id": 62772540, "body": "Bytes buffer is the only thing I knew :D Thanks, going to play with it, looks exactly what I need :D"}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": true, "score": 4, "last_activity_date": 1465156984, "creation_date": 1465156984, "answer_id": 37646231, "question_id": 37645869, "link": "https://stackoverflow.com/questions/37645869/how-to-deal-with-io-eof-in-a-bytes-buffer-stream/37646231#37646231", "title": "How to deal with io.EOF in a bytes.Buffer stream?", "body": "<p>Are you sure you want to use bytes.Buffer? It is not a stream and it is not thread safe, thats why you get race condition. Use <a href=\"https://golang.org/pkg/io/#Pipe\" rel=\"nofollow\">io.Pipe()</a>.</p>\n\n<p><a href=\"https://play.golang.org/p/c0fLEI350w\" rel=\"nofollow\">https://play.golang.org/p/c0fLEI350w</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"time\"\n)\n\nfunc main() {\n    pr, pw := io.Pipe()\n    go background(pr)\n    i := 0\n    for i &lt; 5 {\n        i++\n        fmt.Fprintf(pw, \"%d)teststring\\n\", i)\n        time.Sleep(1 * time.Second)\n\n    }\n    time.Sleep(1 * time.Second)\n}\n\nfunc background(r io.Reader) {\n    buf := make([]byte, 64)\n    for {\n        n, err := r.Read(buf)\n        if err != nil {\n            fmt.Print(err.Error())\n            //return\n        }\n        fmt.Print(string(buf[:n]))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1942, "favorite_count": 1, "accepted_answer_id": 37646231, "answer_count": 1, "score": 2, "last_activity_date": 1465157217, "creation_date": 1465154662, "last_edit_date": 1465157217, "question_id": 37645869, "link": "https://stackoverflow.com/questions/37645869/how-to-deal-with-io-eof-in-a-bytes-buffer-stream", "title": "How to deal with io.EOF in a bytes.Buffer stream?", "body": "<p><a href=\"https://play.golang.org/p/JKXKa7Pvjd\" rel=\"nofollow\">https://play.golang.org/p/JKXKa7Pvjd</a></p>\n\n<p>I am trying to figure out how I can test my background function where there can be random io.EOF in a stream using a bytes.Buffer?</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"bytes\"\n    \"time\"\n)\n\nfunc main() {\n    buffer := new(bytes.Buffer)\n    go background(buffer)\n    i := 0\n    for i &lt; 5 {\n        i++\n        fmt.Fprintf(buffer, \"%d)teststring\\n\", i)\n        time.Sleep(1 * time.Second) // generates a io.EOF\n\n    }\n    time.Sleep(1 * time.Second)\n}\n\nfunc background(r io.Reader) {\n    buf := make([]byte, 64)\n    for {   \n        n, err := r.Read(buf)\n        if err != nil {\n            fmt.Print(err.Error())\n            return // removing `return` will result in race condition\n        }\n        fmt.Print(string(buf[:n]))\n    }\n}\n</code></pre>\n\n<p>The result I am looking for is:</p>\n\n<pre><code>1)teststring\n2)teststring\n3)teststring\n4)teststring\n5)teststring\n</code></pre>\n\n<p>How can I achieve this using <code>time.Sleep(1 * time.Second)</code> to simulate latency?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465147049, "post_id": 37643931, "comment_id": 62769133, "body": "The map read should be synchronised with the write goroutines. Try adding <code>ch &lt;- data</code> as another case in the select clause."}], "answers": [{"comments": [{"owner": {"reputation": 5971, "user_id": 5537840, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/aKRoy.jpg?s=128&g=1", "display_name": "Kenenbek Arzymatov", "link": "https://stackoverflow.com/users/5537840/kenenbek-arzymatov"}, "edited": false, "score": 0, "creation_date": 1511442838, "post_id": 37645387, "comment_id": 81867146, "body": "Have you done simulations in go? Could you share a code or just say which additional golang features or libraries you used?"}], "tags": [], "owner": {"reputation": 18961, "user_id": 1094941, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4gVU2.jpg?s=128&g=1", "display_name": "mna", "link": "https://stackoverflow.com/users/1094941/mna"}, "is_accepted": true, "score": 6, "last_activity_date": 1465152221, "last_edit_date": 1465152221, "creation_date": 1465151520, "answer_id": 37645387, "question_id": 37643931, "link": "https://stackoverflow.com/questions/37643931/event-driven-pattern-in-golang/37645387#37645387", "title": "Event driven pattern in golang", "body": "<p><strong>EDIT</strong>: I may have misread your question, I see that you mention that main will start many <strong>producer</strong> goroutines. I thought it was many <strong>consumer</strong> goroutines, and a single producer. Leaving the answer here in case it can be useful for others looking for that pattern, though the bullet points still apply to your case.</p>\n\n<p>So if I understand correctly your use-case, you can't expect to send on a channel and read the results immediately after. You don't know when the worker will process that send, you need to communicate between the goroutines, and that is done with channels. Assuming just calling a function with a return value doesn't work in your scenario, if you really need to send to a worker, then block until you have the result, you could send a channel as part of the data structure, and block-receive on it after the send, i.e.:</p>\n\n<pre><code>resCh := make(chan Result)\nch &lt;- Data{key, value, resCh}\nres := &lt;- resCh\n</code></pre>\n\n<p>But you should probably try to break down the work as a pipeline of independent steps instead, see the blog post that I linked to in the original answer.</p>\n\n<hr>\n\n<p><strong>Original answer</strong> where I thought it was a single producer - multiple consumers/workers pattern:</p>\n\n<p>This is a common pattern for which Go's goroutines and channels semantics are very well suited. There are a few things you need to keep in mind:</p>\n\n<ul>\n<li><p>The main function will not automatically wait for goroutines to finish. If there's nothing else to do in the main, then the program exits and you don't have your results.</p></li>\n<li><p>The global map that you use is not thread-safe. You need to synchronize access via a mutex, but there's a better way - use an output channel for results, which is already synchronized.</p></li>\n<li><p>You can use a for..range over a channel, and you can safely share a channel between multiple goroutines. As we'll see, that makes this pattern quite elegant to write.</p></li>\n</ul>\n\n<p>Playground: <a href=\"https://play.golang.org/p/WqyZfwldqp\" rel=\"noreferrer\">https://play.golang.org/p/WqyZfwldqp</a></p>\n\n<p>For more on Go pipelines and concurrency patterns, to introduce error handling, early cancellation, etc.: <a href=\"https://blog.golang.org/pipelines\" rel=\"noreferrer\">https://blog.golang.org/pipelines</a></p>\n\n<p>Commented code for the use-case you mention:</p>\n\n<pre><code>// could be a command-line flag, a config, etc.\nconst numGoros = 10\n\n// Data is a similar data structure to the one mentioned in the question.\ntype Data struct {\n    key   string\n    value int\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    // create the input channel that sends work to the goroutines\n    inch := make(chan Data)\n    // create the output channel that sends results back to the main function\n    outch := make(chan Data)\n\n    // the WaitGroup keeps track of pending goroutines, you can add numGoros\n    // right away if you know how many will be started, otherwise do .Add(1)\n    // each time before starting a worker goroutine.\n    wg.Add(numGoros)\n    for i := 0; i &lt; numGoros; i++ {\n        // because it uses a closure, it could've used inch and outch automaticaly,\n        // but if the func gets bigger you may want to extract it to a named function,\n        // and I wanted to show the directed channel types: within that function, you\n        // can only receive from inch, and only send (and close) to outch.\n        //\n        // It also receives the index i, just for fun so it can set the goroutines'\n        // index as key in the results, to show that it was processed by different\n        // goroutines. Also, big gotcha: do not capture a for-loop iteration variable\n        // in a closure, pass it as argument, otherwise it very likely won't do what\n        // you expect.\n        go func(i int, inch &lt;-chan Data, outch chan&lt;- Data) {\n            // make sure WaitGroup.Done is called on exit, so Wait unblocks\n            // eventually.\n            defer wg.Done()\n\n            // range over a channel gets the next value to process, safe to share\n            // concurrently between all goroutines. It exits the for loop once\n            // the channel is closed and drained, so wg.Done will be called once\n            // ch is closed.\n            for data := range inch {\n                // process the data...\n                time.Sleep(10 * time.Millisecond)\n                outch &lt;- Data{strconv.Itoa(i), data.value}\n            }\n        }(i, inch, outch)\n    }\n\n    // start the goroutine that prints the results, use a separate WaitGroup to track\n    // it (could also have used a \"done\" channel but the for-loop would be more complex, with a select).\n    var wgResults sync.WaitGroup\n    wgResults.Add(1)\n    go func(ch &lt;-chan Data) {\n        defer wgResults.Done()\n\n        // to prove it processed everything, keep a counter and print it on exit\n        var n int\n        for data := range ch {\n            fmt.Println(data.key, data.value)\n            n++\n        }\n\n        // for fun, try commenting out the wgResults.Wait() call at the end, the output\n        // will likely miss this line.\n        fmt.Println(\"&gt;&gt;&gt; Processed: \", n)\n    }(outch)\n\n    // send work, wherever that comes from...\n    for i := 0; i &lt; 1000; i++ {\n        inch &lt;- Data{\"main\", i}\n    }\n\n    // when there's no more work to send, close the inch, so the goroutines will begin\n    // draining it and exit once all values have been processed.\n    close(inch)\n\n    // wait for all goroutines to exit\n    wg.Wait()\n\n    // at this point, no more results will be written to outch, close it to signal\n    // to the results goroutine that it can terminate.\n    close(outch)\n\n    // and wait for the results goroutine to actually exit, otherwise the program would\n    // possibly terminate without printing the last few values.\n    wgResults.Wait()\n}\n</code></pre>\n\n<p>In real-life scenarios, where the amount of work is not known ahead of time, the closing of the in-channel could come from e.g. a SIGINT signal. Just make sure no code path can send work after the channel was closed as that would panic.</p>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12376, "favorite_count": 1, "accepted_answer_id": 37645387, "answer_count": 1, "score": 4, "last_activity_date": 1465152221, "creation_date": 1465142590, "question_id": 37643931, "link": "https://stackoverflow.com/questions/37643931/event-driven-pattern-in-golang", "title": "Event driven pattern in golang", "body": "<p>I am using golang to implement a simple event driven worker. It's like this: </p>\n\n<pre><code>  go func() {\n        for {\n            select {\n            case data := &lt;-ch:\n                time.Sleep(1)\n                someGlobalMap[data.key] = data.value \n            }\n        }\n    }()\n</code></pre>\n\n<p>And the main function will create <strong>several goroutines</strong>, and each of them will do thing like this:</p>\n\n<pre><code>ch &lt;- data\nfmt.Println(someGlobalMap[data.key])\n</code></pre>\n\n<p>As you can see that, because my worker need some time to do the work, I will got nil result in my main function.How can I control this workflow properly?</p>\n"}, {"tags": ["image", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1465139786, "post_id": 37643392, "comment_id": 62766776, "body": "You could multi-thread it: have several go routines work on different chunks of the image at once."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465142758, "post_id": 37643392, "comment_id": 62767677, "body": "You don&#39;t need any methods, every image is has a Pix slice containing all the pixel values."}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465142798, "post_id": 37643392, "comment_id": 62767693, "body": "@JimB since I&#39;m new, I don&#39;t know how to use it. Can u provide an example?"}], "answers": [{"comments": [{"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465163268, "post_id": 37645088, "comment_id": 62774338, "body": "Hi, thanks for detailed answer, I only could have pixlist like this <code>pixList := img.(*image.Paletted).Pix</code> because the one you provided raised the error of <code>img.Pix undefined (type image.Image has no field or method Pix)</code>. Yet, my pixlist is not giving right values(since I have a working Python implementation, I know they are wrong), I updated the question with new code. Any ideas?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465171503, "post_id": 37645088, "comment_id": 62776073, "body": "@paradoksumsu: If you&#39;re working with a paletted image, there are no &quot;red&quot; pixels -- you have to lookup the color in the image palette."}, {"owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465171718, "post_id": 37645088, "comment_id": 62776116, "body": "I understand this but I&#39;m not sure if I understood the problem correctly. I&#39;m able to get r values with Python. Why Go cannot take it? This is a png image after all, shouldn&#39;t it have all rgba values?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465172880, "post_id": 37645088, "comment_id": 62776370, "body": "@paradoksumsu: You can get the RGBA values the way you were getting them, but you asked for a faster way. If you want to avoid the overhead of the interfaces and implicit conversions, you need to handle the image data directly. I don&#39;t know what you&#39;re doing in python, but it is doing the conversion for you at some point, possibly normalizing the images to RGBA during &quot;decoding&quot;."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "edited": false, "score": 0, "creation_date": 1465177114, "post_id": 37645088, "comment_id": 62777148, "body": "@paradoksumsu: I figured I would update the answer to show the direct use of the palette color.Color if you&#39;re interested."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1465177065, "last_edit_date": 1465177065, "creation_date": 1465149685, "answer_id": 37645088, "question_id": 37643392, "link": "https://stackoverflow.com/questions/37643392/getting-all-pixel-valuesrgba/37645088#37645088", "title": "Getting all pixel values(rgba)", "body": "<p>You can't make this pattern performant, because this requires an interface method call for every pixel. For fast access to the image data, you access the image's data directly. Take the <code>image.RGBA</code> type for example: </p>\n\n<pre><code>type RGBA struct {\n        // Pix holds the image's pixels, in R, G, B, A order. The pixel at\n        // (x, y) starts at Pix[(y-Rect.Min.Y)*Stride + (x-Rect.Min.X)*4].\n        Pix []uint8\n        // Stride is the Pix stride (in bytes) between vertically adjacent pixels.\n        Stride int\n        // Rect is the image's bounds.\n        Rect Rectangle\n}\n</code></pre>\n\n<p>The docs for each image type include the data layout and indexing formula. For this type you could extract all red pixels from the <code>Pix</code> slice with:</p>\n\n<pre><code>w, h := img.Rect.Dx(), img.Rect.Dy()\npixList := make([]uint8, w*h)\n\nfor i := 0; i &lt; w*h; i++ {\n    pixList[i] = img.Pix[i*4]\n}\n</code></pre>\n\n<p>If you need to convert other image types, you can use the existing methods to do the color conversion, but first assert the correct image type and use the native <code>*At</code> method to avoid the interface call. Extracting the approximate red values from a YCbCr image :</p>\n\n<pre><code>w, h := img.Rect.Dx(), img.Rect.Dy()\npixList := make([]uint8, w*h)\n\nfor x := 0; x &lt; w; x++ {\n    for y := 0; y &lt; h; y++ {\n        r, _, _, _ := img.YCbCrAt(x, y).RGBA()\n        pixList[(x*h)+y] = uint8(r &gt;&gt; 8)\n\n    }\n}\nreturn pixList\n</code></pre>\n\n<p>Similar to how the YCbCr image above has no \"red\" pixels (the value needs to be computed for each individual pixel), a paletted image has no individual RGBA values for the pixels, and needs to be looked up in the image's palette. You could take this one step further and predetermine the color model of the palette colors to remove the <code>Color.RGBA()</code> interface call to speed this up even more like so:</p>\n\n<pre><code>palette := make([]*color.RGBA, len(img.Palette))\nfor i, c := range img.Palette {\n    palette[i] = c.(*color.RGBA)\n}\n\npixList := make([]uint8, len(img.Pix))\n\nfor i, p := range img.Pix {\n    pixList[i] = palette[p].R\n}\n</code></pre>\n"}], "owner": {"reputation": 1183, "user_id": 3416136, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/KpFq0.jpg?s=128&g=1", "display_name": "malisit", "link": "https://stackoverflow.com/users/3416136/malisit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1159, "favorite_count": 0, "accepted_answer_id": 37645088, "answer_count": 1, "score": 2, "last_activity_date": 1465177065, "creation_date": 1465139199, "last_edit_date": 1465163196, "question_id": 37643392, "link": "https://stackoverflow.com/questions/37643392/getting-all-pixel-valuesrgba", "title": "Getting all pixel values(rgba)", "body": "<p>I'm new at Go and trying to improve my skills. Currently I'm working with images and I need to have all pixels' red value of an image. I know I can use the code below to achieve this but it seemed slow to me(~485 msecs),</p>\n\n<pre><code>pixList := make([]uint8, width*height)\n\nfor y := 0; y &lt; height; y++ {\n    for x := 0; x &lt; width; x++ {\n        r, _, _, _ := img.At(x, y).RGBA()\n        var rNew uint8 = uint8(float32(r)*(255.0/65535.0))\n        pixList[(x*height)+y] = rNew\n    }\n}\n</code></pre>\n\n<p>Is there any faster way to do this? Any built-in functions to get all pixel values at once?</p>\n\n<p>Edit: I'm now using the Pix to get all pixel data but still my Pix list is not giving what I'm looking for.</p>\n\n<p>new code:</p>\n\n<pre><code>pixList := img.(*image.Paletted).Pix\nnewPixList := make([]uint8, width*height)\n\nfmt.Println(len(pixList))//gives width*height, shouldn't it be width*height*4?\nfor index := 0; index &lt; width*height; index++ {\n    newPixList[index] = pixList[index*4]//this part gives index out of range error, because the pixList is length of width*height, i dunno why\n\n}\n</code></pre>\n\n<p>I think it's not behaving my image as it's an rgba image, maybe a conversion could work. Any ideas?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1465133989, "post_id": 37642542, "comment_id": 62764992, "body": "In this specific case it could be detected, but in general it can&#39;t be. A value of <code>I</code> is a non-constant value and thus can only be evaluated at runtime (not compile time)."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465134767, "post_id": 37642542, "comment_id": 62765236, "body": "If a language is a hammer, then it&#39;s the programmer&#39;s job to not hit his fingers with it. It&#39;s nonsense to expect the hammer to give you a warning, like &quot;hey, you&#39;re running into trouble&quot;. There may be some tools to give you this warning in specific cases, but the compiler expects you to know what you&#39;re doing"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1465137562, "post_id": 37642542, "comment_id": 62766107, "body": "As @icza mentioned, it can&#39;t be detected in the general case. To add to that, if the compiler were to issue an error in this case, then it would be confusing to the programmer when they could sometimes rely on the compiler to catch this and other times not. Better to just always leave it for runtime so that the language&#39;s behavior is consistent and predictable."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1465145757, "creation_date": 1465145757, "answer_id": 37644470, "question_id": 37642542, "link": "https://stackoverflow.com/questions/37642542/statically-check-nil-interface-values/37644470#37644470", "title": "Statically Check Nil Interface Values?", "body": "<blockquote>\n  <p>Why does Go not do some static analysis at compile type to check that the underlying value of the interface is nil and throw a compile time error?</p>\n</blockquote>\n\n<p>The <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero value</a>  for <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow\">interface</a> is <code>nil</code>, and it is no more detected at compile time than any other nil value.<br>\n<a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow\">From the FAQ</a>:</p>\n\n<blockquote>\n  <p>Under the covers, interfaces are implemented as two elements, a type and a value. </p>\n  \n  <ul>\n  <li>The value, called the interface's dynamic value, is an arbitrary concrete value and </li>\n  <li>the type is that of the value. </li>\n  </ul>\n  \n  <p>An interface value is nil only if the inner value and type are both unset, <code>(nil, nil)</code>.<br>\n  In particular, a <code>nil</code> interface will always hold a <code>nil</code> type.</p>\n</blockquote>\n\n<hr>\n\n<p>This <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/wnH302gBa4I\" rel=\"nofollow\">thread adds</a>, regarding the nil value (runtime):</p>\n\n<blockquote>\n  <p>The basic answer is to never store something in an interface if you don't expect the methods to be called on it.<br>\n  The language may allow it, but that violates the semantics of the interface.  </p>\n  \n  <p>To expound, a <code>nil</code> value should usually not be stored in an interface unless it is of a type that has explicitly handled that case in its pointer-valued methods and has no value-receiver methods.</p>\n</blockquote>\n"}], "owner": {"reputation": 1274, "user_id": 852336, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4c72d46b174b7a0ab6804e6c5336f86d?s=128&d=identicon&r=PG", "display_name": "Danish Khan", "link": "https://stackoverflow.com/users/852336/danish-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 589, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1465145757, "creation_date": 1465133791, "last_edit_date": 1465133890, "question_id": 37642542, "link": "https://stackoverflow.com/questions/37642542/statically-check-nil-interface-values", "title": "Statically Check Nil Interface Values?", "body": "<p>Let's say we have the following:</p>\n\n<pre><code>type I interface {\n    M()\n}\n\nfunc main() {\n    var i I\n    i.M()\n}\n</code></pre>\n\n<p>Why does Go not do some static analysis at compile type to check that the underlying value of the interface is nil and throw a compile time error? Instead we end up throwing a runtime exception at <code>i.M()</code></p>\n\n<p>==================================================================</p>\n\n<p>Output:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0xffffffff addr=0x0 pc=0x2004d]\n\ngoroutine 1 [running]:\npanic(0x13f480, 0x1040a038)\n    /usr/local/go/src/runtime/panic.go:481 +0x700\nmain.main()\n    /tmp/sandbox469152264/main.go:12 +0x4d\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 2, "creation_date": 1465131283, "post_id": 37641573, "comment_id": 62764084, "body": "Also, if you write a program in Golang, write go code."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 2, "last_activity_date": 1465135170, "creation_date": 1465135170, "answer_id": 37642757, "question_id": 37641573, "link": "https://stackoverflow.com/questions/37641573/how-to-implement-virtual-functions-in-golang/37642757#37642757", "title": "How to implement virtual functions in golang?", "body": "<p>use Golang interface methods instead of C++ (pure) virtual functions:<br>\nfor the The Go Way to this see package sort:</p>\n\n<pre><code>type Interface interface {\n    // Len is the number of elements in the collection.\n    Len() int\n    // Less reports whether the element with\n    // index i should sort before the element with index j.\n    Less(i, j int) bool\n    // Swap swaps the elements with indexes i and j.\n    Swap(i, j int)\n}\n</code></pre>\n\n<p>and sample (custom sorting with age):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"sort\"\n\ntype Person struct {\n    name string\n    age  int\n}\ntype PS []Person\n\n// Len is part of sort.Interface.\nfunc (s PS) Len() int {\n    return len(s)\n}\n\n// Swap is part of sort.Interface.\nfunc (s PS) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n\n// Less is part of sort.Interface.\nfunc (s PS) Less(i, j int) bool {\n    return s[i].age &lt; s[j].age\n}\n\nfunc main() {\n    s := PS{Person{\"Alex\", 23}, Person{\"Jane\", 22}}\n    fmt.Println(s) // [{Alex 23} {Jane 22}]\n    sort.Sort(s)\n    fmt.Println(s) // [{Jane 22} {Alex 23}]\n}\n</code></pre>\n"}], "owner": {"reputation": 324, "user_id": 3526468, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/727862912/picture?type=large", "display_name": "user3526468", "link": "https://stackoverflow.com/users/3526468/user3526468"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3455, "favorite_count": 1, "closed_date": 1466505922, "answer_count": 1, "score": 2, "last_activity_date": 1465135170, "creation_date": 1465127598, "question_id": 37641573, "link": "https://stackoverflow.com/questions/37641573/how-to-implement-virtual-functions-in-golang", "closed_reason": "Duplicate", "title": "How to implement virtual functions in golang?", "body": "<p>How can you implement virtual functions in golang? I tried this, but i can't make it print \"B\"</p>\n\n<pre><code>type A struct {\n}\n\ntype B struct {\n  A\n}\n\nfunc (self A) myVirtualFunction() {\n    fmt.Println(\"A again :(\")\n}\n\nfunc (self A) f() {\n    self.myVirtualFunction()\n}\n\nfunc (self B) myVirtualFunction(){\n    fmt.Println(\"B :)\")\n}\n\nfunc main() {\n    var b *B = new(B)\n    b.f()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Eq59SZuC7p\" rel=\"nofollow\">https://play.golang.org/p/Eq59SZuC7p</a></p>\n"}, {"tags": ["arrays", "go", "byte", "diff", "patch"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465130850, "post_id": 37640927, "comment_id": 62763916, "body": "Do you just need to know if <code>bytesA[i] != bytesB[i]</code>? Or are you actually trying to see a delta in the value of the two bytes?"}, {"owner": {"reputation": 441, "user_id": 6077397, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d456f19ea4fc9981404a2e3dc7245b89?s=128&d=identicon&r=PG&f=1", "display_name": "Alex. b", "link": "https://stackoverflow.com/users/6077397/alex-b"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465146394, "post_id": 37640927, "comment_id": 62768902, "body": "@Snowman I need to find the delta."}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465149858, "post_id": 37640927, "comment_id": 62770082, "body": "OK. that could be trivial, or it actually could be really complex. See if this works for your use case: <a href=\"https://play.golang.org/p/NagbPPlSjn\" rel=\"nofollow noreferrer\">play.golang.org/p/NagbPPlSjn</a>. There are some things that it would <i>have</i> to take care of in actual production code which are omitted from the example, but it demonstrates the gist of what I think you&#39;re trying to make happen."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1510952259, "creation_date": 1510952259, "answer_id": 47359160, "question_id": 37640927, "link": "https://stackoverflow.com/questions/37640927/golang-calculate-diff-between-two-array-of-bytes-and-patch-an-array/47359160#47359160", "title": "Golang: calculate diff between two array of bytes and patch an array", "body": "<p>Sounds like you just want a function which takes two byte slices and returns a new slice containing the difference of each element in the input slice. The example function below asserts that the input slices are both non-nil and have the same length. It also returns a slice of int16s since the range of difference in bytes is <code>[-255,255]</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  bs1 := []byte{0, 2, 255, 0}\n  bs2 := []byte{0, 1, 0, 255}\n  delta, err := byteDiff(bs1, bs2)\n  if err != nil {\n    panic(err)\n  }\n  fmt.Printf(\"OK: delta=%v\\n\", delta)\n  // OK: delta=[0 1 255 -255]\n}\n\nfunc byteDiff(bs1, bs2 []byte) ([]int16, error) {\n  // Ensure that we have two non-nil slices with the same length.\n  if (bs1 == nil) || (bs2 == nil) {\n    return nil, fmt.Errorf(\"expected a byte slice but got nil\")\n  }\n  if len(bs1) != len(bs2) {\n    return nil, fmt.Errorf(\"mismatched lengths, %d != %d\", len(bs1), len(bs2))\n  }\n\n  // Populate and return the difference between the two.\n  diff := make([]int16, len(bs1))\n  for i := range bs1 {\n    diff[i] = int16(bs1[i]) - int16(bs2[i])\n  }\n  return diff, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 6077397, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d456f19ea4fc9981404a2e3dc7245b89?s=128&d=identicon&r=PG&f=1", "display_name": "Alex. b", "link": "https://stackoverflow.com/users/6077397/alex-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1558, "favorite_count": 3, "answer_count": 1, "score": 0, "last_activity_date": 1510952259, "creation_date": 1465123051, "last_edit_date": 1465128148, "question_id": 37640927, "link": "https://stackoverflow.com/questions/37640927/golang-calculate-diff-between-two-array-of-bytes-and-patch-an-array", "title": "Golang: calculate diff between two array of bytes and patch an array", "body": "<p>I'm trying to find the difference between two byte ararys and store the delta.</p>\n\n<p>I've read this documentation <code>https://golang.org/pkg/bytes/</code> but I didn't find anything that show how to find the diff.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1465139087, "post_id": 37640808, "comment_id": 62766561, "body": "AFAIK starting from Go 1.5 there is no need to do it."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1465141723, "post_id": 37640808, "comment_id": 62767330, "body": "i&#39;m still juggling between 1.4.3 and 1.6/1.7b1 (some projects already use 1.6+, some other bigger still using 1.4.3)"}], "answers": [{"tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 2, "last_activity_date": 1465124158, "last_edit_date": 1465124158, "creation_date": 1465122475, "answer_id": 37640859, "question_id": 37640808, "link": "https://stackoverflow.com/questions/37640808/get-golang-version-from-compiled-binary/37640859#37640859", "title": "Get golang version from compiled binary", "body": "<p>Nevermind, found the answer</p>\n\n<pre><code>[ `strings $pkg_a_file | grep 'go object' | head -n 1 | cut -f 5 -d ' '` != `go version | cut -f 3 -d ' '` ] &amp;&amp; \\     \nrm -rf $GOPATH/pkg\n</code></pre>\n\n<p><code>strings $pkg_a_file | grep 'go object' | head -n 1 | cut -f 5 -d ' '</code> part will show something like <code>go1.6.2</code></p>\n\n<p><code>pkg_a_file</code> can be something like this:</p>\n\n<pre><code>PKG_OS_ARCH=`go version | cut -d ' ' -f 4 | tr '/' '_'`\npkg_a_file=$GOPATH/pkg/$PKG_OS_ARCH/gitlab.com/kokizzu/gokil/A.a\n</code></pre>\n\n<p>External reference: <a href=\"http://kokizzu.blogspot.co.id/2016/06/solution-for-golang-slow-compile.html\" rel=\"nofollow\">http://kokizzu.blogspot.co.id/2016/06/solution-for-golang-slow-compile.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 466, "user_id": 295702, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a0b2a13734c4353b718c38ac5dd6ac?s=128&d=identicon&r=PG", "display_name": "pinguin666", "link": "https://stackoverflow.com/users/295702/pinguin666"}, "is_accepted": false, "score": 1, "last_activity_date": 1516168872, "creation_date": 1516168872, "answer_id": 48294507, "question_id": 37640808, "link": "https://stackoverflow.com/questions/37640808/get-golang-version-from-compiled-binary/48294507#48294507", "title": "Get golang version from compiled binary", "body": "<p>With 1.9.2, the grep command is</p>\n\n<pre><code>strings $pkg_a_file | grep 'Go cmd/compile' \n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 0, "accepted_answer_id": 37640859, "answer_count": 2, "score": 3, "last_activity_date": 1516168872, "creation_date": 1465122077, "question_id": 37640808, "link": "https://stackoverflow.com/questions/37640808/get-golang-version-from-compiled-binary", "title": "Get golang version from compiled binary", "body": "<p>Is there a way to get golang version from <code>pkg/</code> or from compiled binary?\nI want to automate removal of <code>$GOPATH/pkg</code> folder only when I change the golang version.</p>\n"}, {"tags": ["http", "post", "cookies", "go"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1465118946, "post_id": 37639969, "comment_id": 62760727, "body": "You have to create a Cookiejar and send it along with the POST request. See this answer <a href=\"http://stackoverflow.com/a/12756986/1357978\">stackoverflow.com/a/12756986/1357978</a>"}, {"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 0, "creation_date": 1465119235, "post_id": 37639969, "comment_id": 62760811, "body": "You can use this one. response.Request.Cookie(&quot;cookie name&quot;)"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465115922, "creation_date": 1465115922, "question_id": 37639969, "link": "https://stackoverflow.com/questions/37639969/how-to-get-a-cookie-from-a-http-get-request-to-a-consecutive-http-post-request", "title": "How to get a cookie from a HTTP Get request to a consecutive HTTP Post request", "body": "<p>For testing I like to simulate signups. I get the signup page, fill in the form and post it. Apparently the session cookie that is provided by the server is not sent in the post request. If I access the server from a web browser all works fine. I can see that the response to Get contains the cookie. How can I add it to the PostForm?   </p>\n\n<pre><code>func signup(name string, ret chan bool) {\n    var xsrf string\n\n    fmt.Println(\"Starting signup with\", name)\n    response, err := http.Get(\"http://localhost:8080/signup\")\n    if err != nil {\n        panic(err)\n    } else {\n        defer response.Body.Close()\n        buffer, _ := ioutil.ReadAll(response.Body)\n        xsrf = regXsrf.FindStringSubmatch(string(buffer))[1]\n    }   \n\n    data := url.Values{}\n    data.Set(\"name\", name)\n    data.Add(\"password\", \"111222\")\n    data.Add(\"password2\", \"111222\")\n    data.Add(\"groupcode\", \"AllesWirdGut\")\n    data.Add(\"websocketstoken\", xsrf)\n\n    response, err = http.PostForm(\"http://localhost:8080/signup\", data)\n    if err != nil {\n        panic(err)\n    } else {\n        defer response.Body.Close()\n    }   \n}\n</code></pre>\n"}, {"tags": ["go", "concurrency"], "comments": [{"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "edited": false, "score": 1, "creation_date": 1465102956, "post_id": 37636665, "comment_id": 62757751, "body": "What happens if you add <code>runtime.Gosched()</code> into the empty for loop?"}, {"owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "edited": false, "score": 3, "creation_date": 1465103828, "post_id": 37636665, "comment_id": 62757917, "body": "Try replacing <code>for {}</code> with <code>select {}</code>. It&#39;s probably a scheduler issue, which I&#39;m sure someone else will explain in more detail :)"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1465116260, "post_id": 37636665, "comment_id": 62760108, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26624959/golang-http-server-blocks-when-starts-a-goroutine-of-infinite-loop\">Golang http server blocks when starts a goroutine of infinite-loop</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "is_accepted": true, "score": 2, "last_activity_date": 1465117178, "creation_date": 1465117178, "answer_id": 37640145, "question_id": 37636665, "link": "https://stackoverflow.com/questions/37636665/strange-behaviour-with-smtp-within-goroutine/37640145#37640145", "title": "Strange behaviour with SMTP within goroutine", "body": "<p>You should replace your <code>for{}</code> with a <code>select{}</code>. Never create an empty <code>for{}</code>.</p>\n\n<p>The <code>for{}</code> creates a loop that spins forever, but because there are no function calls (or more accurately stack checks and/or allocations) in the loop, the scheduler will never be able to deschedule the main goroutine, which in turn prevents your other goroutine from being scheduled. (This will also probably eat a whole CPU, because your busy-looping a OS Thread) </p>\n\n<p>See my note about GOMAXPROCS at the end.</p>\n\n<p>By calling <code>SendEmail(\"TEST\")</code> right after your <code>go SendEmail(\"TEST\")</code> the runtime gets a chance (or rather, multiple chances) to schedule your other goroutine to run, before getting to your <code>for{}</code> loop.</p>\n\n<p>Using an empty select (<code>select{}</code>) instead, the main goroutine will wait indefinitely without consuming any CPU and instead will yield directly to the scheduler.</p>\n\n<p><strong>About GOMAXPROCS</strong></p>\n\n<p>If your GOMAXPROCS is 1 (default before Go 1.5) you will only have a single OS thread (at least for running goroutines), which will prevent any other goroutines from running, if you have a busy-loop. If you have GOMAXPROCS > 1 the runtime could still schedule other goroutines, as there is more than one thread for running goroutines, but you shouldn't rely on that. Instead, you should remove any busy-loops.</p>\n"}], "owner": {"reputation": 169, "user_id": 2232887, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d597abac74356a1595c5fe7949a270a2?s=128&d=identicon&r=PG", "display_name": "user2232887", "link": "https://stackoverflow.com/users/2232887/user2232887"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 37640145, "answer_count": 1, "score": 0, "last_activity_date": 1465117178, "creation_date": 1465091072, "question_id": 37636665, "link": "https://stackoverflow.com/questions/37636665/strange-behaviour-with-smtp-within-goroutine", "title": "Strange behaviour with SMTP within goroutine", "body": "<p>I'm puzzled by some strange behaviour I found using SMTP from within a goroutine.</p>\n\n<p>When trying to send an email using the following code, my SendMail function starts (I can see a log message) but never completes. It just hangs.</p>\n\n<pre><code>func main() {\n    go SendEmail(\"TEST\")\n    for {}\n  }\n</code></pre>\n\n<p>However, when I add another call to SendMail - two emails are both sent successfully.</p>\n\n<pre><code>func main() {\n    go SendEmail(\"TEST\")\n    SendEmail(\"TEST\")\n    for {}\n  }\n</code></pre>\n\n<p>Can anybody explain what is going on?</p>\n\n<p><em>NB this is a very simplified version of a scheduled task, hence the while loop</em></p>\n\n<p>Code to send email:</p>\n\n<pre><code>func SendEmail(message string) {\n  log.Print(\"Sending email\")\n  from, password, to := \"me@gmail.com\", \"PASSWORD\", \"me@gmail.com\"\n\n  err := smtp.SendMail(\n    \"smtp.gmail.com:587\",\n    smtp.PlainAuth(\"\", from, password, \"smtp.gmail.com\"),\n    from,\n    []string{to},\n    []byte(message),\n    )\nif err != nil {\n    log.Fatal(err)\n}\n  log.Print(\"Sending complete\")\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "go", "template-method-pattern"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6256186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/808e0875b847b8bcd8133c806688bec8?s=128&d=identicon&r=PG&f=1", "display_name": "user6256186", "link": "https://stackoverflow.com/users/6256186/user6256186"}, "edited": false, "score": 0, "creation_date": 1465109536, "post_id": 37636030, "comment_id": 62758812, "body": "Yes, now it works. But it still looks kind of ugly.. Thanks, anyway"}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 5, "last_activity_date": 1465083355, "creation_date": 1465083355, "answer_id": 37636030, "question_id": 37635769, "link": "https://stackoverflow.com/questions/37635769/elegant-way-to-implement-template-method-pattern-in-golang/37636030#37636030", "title": "Elegant way to implement template method pattern in Golang", "body": "<p><code>Logger</code> embeds a pointer which will be nil when you allocate the struct. That's because embedding does not put everything inside the struct, it actually creates a field (named <code>Runner</code> of type <code>*Runner</code> in your case) and the language gives you some syntactic sugar to access what's inside it. In your case it means that you can access <code>Runner</code> fields in two ways:</p>\n\n<pre><code>l := Logger{}\nl.needStop = false\n//or\nl.Runner.needStop = false\n</code></pre>\n\n<p>To fix the error you need to allocate <code>Runner</code> field inside the <code>Logger</code> like so:</p>\n\n<pre><code>l := Logger{Runner:&amp;Runner{}}\n</code></pre>\n\n<p>Or embed by value instead of pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 6256186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/808e0875b847b8bcd8133c806688bec8?s=128&d=identicon&r=PG&f=1", "display_name": "user6256186", "link": "https://stackoverflow.com/users/6256186/user6256186"}, "edited": false, "score": 0, "creation_date": 1465232870, "post_id": 37658862, "comment_id": 62804605, "body": "In more complex cases we need access to the state of the Logger &amp;&amp; Runner instance. In your code you could achive this only by passing Logger object to the runLog() function as an argument. I personally think that it is even more uglier than my example."}, {"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "reply_to_user": {"reputation": 103, "user_id": 6256186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/808e0875b847b8bcd8133c806688bec8?s=128&d=identicon&r=PG&f=1", "display_name": "user6256186", "link": "https://stackoverflow.com/users/6256186/user6256186"}, "edited": false, "score": 0, "creation_date": 1539190785, "post_id": 37658862, "comment_id": 92415294, "body": "@user6256186 Not necessarily, if you need a <code>Logger</code> with state then just inject in a function object, or interface instead of a pure function: <a href=\"https://play.golang.org/p/akMfRq8D5cY\" rel=\"nofollow noreferrer\">play.golang.org/p/akMfRq8D5cY</a>"}], "tags": [], "owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "is_accepted": false, "score": 6, "last_activity_date": 1570309961, "last_edit_date": 1570309961, "creation_date": 1465219933, "answer_id": 37658862, "question_id": 37635769, "link": "https://stackoverflow.com/questions/37635769/elegant-way-to-implement-template-method-pattern-in-golang/37658862#37658862", "title": "Elegant way to implement template method pattern in Golang", "body": "<p>The essence of the template method pattern is it allows you to inject in an implementation of a particular function or functions into the skeleton of an algorithm.</p>\n\n<p>You can achieve this in Go by injecting in a function or an interface into your <code>Runner</code>. To achieve the basic template method pattern you don't really need your <code>Logger</code> struct at all:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Runner struct {\n    run func()\n}\n\nfunc (r *Runner) Start() {\n    // some prepare stuff...\n    r.run()\n}\n\nfunc runLog() {\n    fmt.Println(\"Running\")\n}\n\nfunc NewLogger() *Runner {\n    return &amp;Runner{runLog}\n}\n\nfunc main() {\n    l := NewLogger()\n    l.Start()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 0, "creation_date": 1533301822, "post_id": 40072856, "comment_id": 90309440, "body": "Regarding this affair in <a href=\"https://groups.google.com/d/msg/golang-nuts/dzpJ_riiRZ4/WGnghewhMYUJ\" rel=\"nofollow noreferrer\">groups.google.com/d/msg/golang-nuts/dzpJ_riiRZ4/WGnghewhMYUJ</a>  a person suggest to use another approach (define the template method in a function with an interface as parameter with the implemention to be invoked in the abstract steps of the template). For me, without further context, both works, Anyway your example is clever and show an use of having a function type inside a struct, thanks for sharing!"}], "tags": [], "owner": {"reputation": 6518, "user_id": 220141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b153348c0e829c579d655c606da7dbda?s=128&d=identicon&r=PG", "display_name": "Paolo Maresca", "link": "https://stackoverflow.com/users/220141/paolo-maresca"}, "is_accepted": false, "score": 3, "last_activity_date": 1476636748, "creation_date": 1476636748, "answer_id": 40072856, "question_id": 37635769, "link": "https://stackoverflow.com/questions/37635769/elegant-way-to-implement-template-method-pattern-in-golang/40072856#40072856", "title": "Elegant way to implement template method pattern in Golang", "body": "<p>The key to have the <a href=\"https://en.wikipedia.org/wiki/Template_method_pattern\" rel=\"nofollow\">Template Method Design Pattern</a> work in Golang is to properly use the <em>embedding feature</em> and the <em>function assignment</em>. </p>\n\n<p>Below, a code snippet which works as expected.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Runner struct {\n    run func()  // 1. this has to get assigned the actual implementation\n}\n\nfunc NewRunner(i func()) *Runner {\n    return &amp;Runner{i}\n}\n\nfunc (r *Runner) Start() {\n    r.run()\n}\n\ntype Logger struct {\n    Runner\n}\n\nfunc NewLogger() *Logger {\n    l := Logger{}\n    l.run = l.loggerRun  // 2. the actual version is assigned\n    return &amp;l\n}\n\nfunc (l *Logger) loggerRun() {\n    fmt.Println(\"Logger is running...\")\n}\n\nfunc main() {\n    l := NewLogger()  // 3. constructor should be used, to get the assignment working\n    l.Start()\n}\n</code></pre>\n\n<p>The type Runner defines a <code>func()</code> attribute which is supposed to receive the actual implementation, according to the specific subtype. <code>Start()</code> wraps call to <code>run()</code>, and once invoked on the right receiver (the base one) it is be able to run the right version of <code>run()</code>: this happens iff in the constructor (i.e. <code>NewLogger()</code>) the actual version of the method <code>run()</code> is assigned to the attribute <code>run</code> of the embedded type. </p>\n\n<p>And, output is: </p>\n\n<pre><code>Logger is running...\n\nProgram exited.\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O6KVKtGJfH\" rel=\"nofollow\">Here</a> the code can be run, and modified to test any other variant of this design pattern.</p>\n"}], "owner": {"reputation": 103, "user_id": 6256186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/808e0875b847b8bcd8133c806688bec8?s=128&d=identicon&r=PG&f=1", "display_name": "user6256186", "link": "https://stackoverflow.com/users/6256186/user6256186"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2571, "favorite_count": 2, "accepted_answer_id": 37636030, "answer_count": 3, "score": 6, "last_activity_date": 1570309961, "creation_date": 1465080497, "question_id": 37635769, "link": "https://stackoverflow.com/questions/37635769/elegant-way-to-implement-template-method-pattern-in-golang", "title": "Elegant way to implement template method pattern in Golang", "body": "<p>Is there an elegant canonical way to implement template method pattern in Go?\nIn C++ this looks like this:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;memory&gt;\n\nclass Runner {\npublic:\n    void Start() {\n        // some prepare stuff...\n        Run();\n    }\nprivate:\n    virtual void Run() = 0;\n};\n\nclass Logger : public Runner {\nprivate:\n    virtual void Run() override {\n        std::cout &lt;&lt; \"Running...\" &lt;&lt; std::endl;\n    }\n};\n\nint main() {\n    std::unique_ptr&lt;Runner&gt; l = std::make_unique&lt;Logger&gt;();\n    l-&gt;Start();\n    return 0;\n}\n</code></pre>\n\n<p>In golang i wrote something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Runner struct {\n    doRun func()\n    needStop bool\n}\n\nfunc (r *Runner) Start() {\n    go r.doRun()\n}\n\nfunc NewRunner(f func()) *Runner {\n    return &amp;Runner{f, false}\n}\n\ntype Logger struct {\n    *Runner\n    i int\n}\n\nfunc NewLogger() *Logger {\n    l := &amp;Logger{}\n    l.doRun = l.doRunImpl\n    return l\n}\n\nfunc (l *Logger) doRunImpl() {\n    time.Sleep(1 * time.Second)\n    fmt.Println(\"Running\")\n}\n\nfunc main() {\n    l := NewLogger()\n    l.Start()\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>But this code fails with runtime null pointer error. \nBasic idea is to mix in some functionality from derived classes (go structs) to the base class routine in a way that base class state is available from this mix-in derived routine.</p>\n"}, {"tags": ["image", "go", "colors", "rgba"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1475884651, "last_edit_date": 1475884651, "creation_date": 1465081909, "answer_id": 37635896, "question_id": 37635426, "link": "https://stackoverflow.com/questions/37635426/go-image-manipulation/37635896#37635896", "title": "Go image manipulation", "body": "<p><code>img.At().RGBA()</code> is <a href=\"https://golang.org/pkg/image/color/#Color\" rel=\"nofollow\"><code>Color.RGBA()</code></a>. Quoting its doc:</p>\n\n<pre><code>// RGBA returns the alpha-premultiplied red, green, blue and alpha values\n// for the color. Each value ranges within [0, 0xffff], but is represented\n// by a uint32 so that multiplying by a blend factor up to 0xffff will not\n// overflow.\n//\n// An alpha-premultiplied color component c has been scaled by alpha (a),\n// so has valid values 0 &lt;= c &lt;= a.\n</code></pre>\n\n<p>Components returned by <code>RGBA()</code> are in range <code>0..0xffff</code>, not <code>0..0xff</code>, and they are also alpha-premultiplied.</p>\n\n<h3>Manual decoding</h3>\n\n<p>One way to get back the red, green, blue components in the <code>0..255</code> range is to shift right by 8 for example:</p>\n\n<pre><code>r, g, b, a := b.At(x, y).RGBA()\nr, g, b, a = r&gt;&gt;8, g&gt;&gt;8, b&gt;&gt;8, a&gt;&gt;8\nlog.Println(r, g, b) // Now in range 0..255\n</code></pre>\n\n<h3>Converting to <code>color.RGBA</code></h3>\n\n<p>Another way is to convert the color to <a href=\"https://golang.org/pkg/image/color/#RGBA\" rel=\"nofollow\"><code>color.RGBA</code></a> which is a struct, containing the components plain and simple:</p>\n\n<pre><code>type RGBA struct {\n        R, G, B, A uint8\n}\n</code></pre>\n\n<p>Since you are using <a href=\"https://golang.org/pkg/image/#NewRGBA\" rel=\"nofollow\"><code>image.NewRGBA()</code></a> which returns an image of type <a href=\"https://golang.org/pkg/image/#RGBA\" rel=\"nofollow\"><code>image.RGBA</code></a>, the colors returned by the <code>Image.At()</code> method will be of dynamic type <code>color.RGBA</code>, so you can simply use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a>:</p>\n\n<pre><code>rgbacol := b.At(x, y).(color.RGBA)\nlog.Println(rgbacol.R, rgbacol.G, rgbacol.B, rgbacol.A)\n</code></pre>\n\n<p>In general (if image is not of type <code>image.RGBA</code>), <code>Image.At()</code> may or may not be of concrete type <code>color.RGBA</code>.</p>\n\n<p>So in the general case you need to convert the color to a value of type <code>color.RGBA</code>. Conversions between color models are modeled by <a href=\"https://golang.org/pkg/image/color/#Model\" rel=\"nofollow\"><code>color.Model</code></a>, and the <code>image/color</code> package has predefined converters. What you need is <code>color.RGBAModel</code>. <code>color.RGBAModel.Convert()</code> will return a <code>color.Color</code> value whose dynamic type is surely <code>color.RGBA</code>.</p>\n\n<p>Example using <code>color.RGBAModel</code>:</p>\n\n<pre><code>var c color.Color\nc = color.Gray{160}\n\nrgbacol := color.RGBAModel.Convert(c).(color.RGBA)\n\nfmt.Println(rgbacol.R, rgbacol.G, rgbacol.B, rgbacol.A)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/AXA8PYPKJ3\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>160 160 160 255\n</code></pre>\n\n<p>So in your loop do:</p>\n\n<pre><code>rgbacol := color.RGBAModel.Convert(b.At(x, y).(color.RGBA)\n// rgbacol is a struct of type color.RGBA, components are in range 0..255\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Above solutions still give you back the alpha pre-multiplied components. If you want to undo the alpha pre-multiplication, you may use <code>color.NRGBAModel</code> converter (instead of <code>color.RGBAModel</code>).</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "accepted_answer_id": 37635896, "answer_count": 1, "score": 2, "last_activity_date": 1475884651, "creation_date": 1465077567, "last_edit_date": 1465082903, "question_id": 37635426, "link": "https://stackoverflow.com/questions/37635426/go-image-manipulation", "title": "Go image manipulation", "body": "<p>I need to load an image and search for colors and replace them. For example on an image I need to search for all red pixels and convert them to purple.</p>\n\n<p>I am doing the following (<code>img</code> is a valid <code>.png</code> image):</p>\n\n<pre><code>func colorize(img image.Image) {\n    b := image.NewRGBA(img.Bounds())\n    draw.Draw(b, b.Bounds(), img, image.ZP, draw.Src)\n    for x := 0; x &lt; b.Bounds().Dx(); x++ {\n        for y := 0; y &lt; b.Bounds().Dy(); y++ {\n            log.Println(b.At(x, y).RGBA())\n        }\n    }\n}\n</code></pre>\n\n<p>Thing is <code>img.At().RGBA()</code> doesn't seem to return the proper R, G, B, A codes? I am getting numbers bigger than 255 for example.</p>\n\n<p>So how should I read all the image pixels while being able to know the x and y position of them?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1465076036, "post_id": 37634686, "comment_id": 62752277, "body": "Please don&#39;t put tags in the titles. You have the tags for that."}], "answers": [{"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1465073113, "post_id": 37634729, "comment_id": 62751511, "body": "I don&#39;t know what the code is exactly for but generally, that&#39;s not the best way to process items in a channel. <code>while</code> may still has race condition depending on how items are added to the channel. I suggest using range loop and close the channel when you&#39;re finished with it."}], "tags": [], "owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "is_accepted": true, "score": 6, "last_activity_date": 1465085559, "last_edit_date": 1465085559, "creation_date": 1465072277, "answer_id": 37634729, "question_id": 37634686, "link": "https://stackoverflow.com/questions/37634686/why-does-select-case-cut-my-for-loop-in-half/37634729#37634729", "title": "Why does select case cut my for loop in half?", "body": "<p><code>len(task)</code> decreased if you read from <code>tasks</code></p>\n\n<p>Use empty <code>for</code> to iteratively read all from task.</p>\n\n<pre><code>for {\n    select {\n    case task := &lt;-tasks:\n        fmt.Println(task)\n        // Do something\n    }\n    if len(tasks) == 0 {break}\n}\n</code></pre>\n\n<p>Or alternatively you can use range:</p>\n\n<pre><code>for task := range tasks {\n\n    fmt.Println(task)\n    // Do something\n\n    if len(tasks) == 0 {break}\n}\n</code></pre>\n\n<p>Do not forget to <code>break</code> this cycles if you don't want to lock you goroutine.</p>\n"}, {"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 0, "last_activity_date": 1465073152, "last_edit_date": 1465073152, "creation_date": 1465072763, "answer_id": 37634796, "question_id": 37634686, "link": "https://stackoverflow.com/questions/37634686/why-does-select-case-cut-my-for-loop-in-half/37634796#37634796", "title": "Why does select case cut my for loop in half?", "body": "<p>Because you take element from channel, its length decreasing..\nTake a look on this sample, I think it will be clear for you:<br>\n<a href=\"https://play.golang.org/p/TC3HymIlhs\" rel=\"nofollow\">https://play.golang.org/p/TC3HymIlhs</a> </p>\n"}, {"comments": [{"owner": {"reputation": 181, "user_id": 1542017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296eaabc8a6aadac2f3b28b9415160a3?s=128&d=identicon&r=PG", "display_name": "lingz", "link": "https://stackoverflow.com/users/1542017/lingz"}, "edited": false, "score": 0, "creation_date": 1465076179, "post_id": 37634846, "comment_id": 62752312, "body": "So in the spirit of curiosity, I tried all three of these strategies. The first two work fine. The last one <code>for task := range tasks { ... }</code> has an interesting side-effect. Basically in the <code>&#47;&#47;do something</code> portion, I call a goroutine that operates on the task. When we use <code>for task := range tasks { ... }</code>, the task that the goroutine operates on is always the first one it receives from the channel, unless you pass the task variable as a parameter to the goroutine. Why is it that <code>task :=</code> defined in <code>for select</code> does not have this requirement (i.e. you can directly use the local var)?"}, {"owner": {"reputation": 181, "user_id": 1542017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296eaabc8a6aadac2f3b28b9415160a3?s=128&d=identicon&r=PG", "display_name": "lingz", "link": "https://stackoverflow.com/users/1542017/lingz"}, "edited": false, "score": 0, "creation_date": 1465076210, "post_id": 37634846, "comment_id": 62752320, "body": "Thank you for the answer btw."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 181, "user_id": 1542017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296eaabc8a6aadac2f3b28b9415160a3?s=128&d=identicon&r=PG", "display_name": "lingz", "link": "https://stackoverflow.com/users/1542017/lingz"}, "edited": false, "score": 2, "creation_date": 1465080536, "post_id": 37634846, "comment_id": 62753402, "body": "@lingz, that&#39;s the thing with loops in Go. The loop variable is allocated ones and gets overwritten on every iteration. The closure receives a pointer to it, not a copy. Because of that your goroutines will operate on the same value from the last iteration. There&#39;re two solutions - <a href=\"https://play.golang.org/p/utTHzgcx4C\" rel=\"nofollow noreferrer\">play.golang.org/p/utTHzgcx4C</a> <a href=\"https://play.golang.org/p/pJnzf_zPYX\" rel=\"nofollow noreferrer\">play.golang.org/p/pJnzf_zPYX</a>"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 6, "last_activity_date": 1465074865, "last_edit_date": 1465074865, "creation_date": 1465073077, "answer_id": 37634846, "question_id": 37634686, "link": "https://stackoverflow.com/questions/37634686/why-does-select-case-cut-my-for-loop-in-half/37634846#37634846", "title": "Why does select case cut my for loop in half?", "body": "<p><code>len(tasks)</code> is re-evaluated at each iteration. So the value is 30, then 29, then 28, ... Finally, <code>len(tasks)</code> crosses <code>i</code> at the middle, that's why it only prints half the values.</p>\n\n<p>So, what you can do is storing the length in a variable:</p>\n\n<pre><code>n := len(tasks)\nfor i := 0; i &lt; n; i++ { ... }\n</code></pre>\n\n<p>Or, you can simply write</p>\n\n<pre><code>for len(tasks) &gt; 0 { ... }\n</code></pre>\n\n<p>If you want to consume all the elements, the <code>range</code> operator works:</p>\n\n<pre><code>for task := range tasks { ... }\n</code></pre>\n\n<p>Also, remember to close the channel after you're done using it.</p>\n"}], "owner": {"reputation": 181, "user_id": 1542017, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/296eaabc8a6aadac2f3b28b9415160a3?s=128&d=identicon&r=PG", "display_name": "lingz", "link": "https://stackoverflow.com/users/1542017/lingz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 37634729, "answer_count": 3, "score": 3, "last_activity_date": 1465165631, "creation_date": 1465071985, "last_edit_date": 1465165631, "question_id": 37634686, "link": "https://stackoverflow.com/questions/37634686/why-does-select-case-cut-my-for-loop-in-half", "title": "Why does select case cut my for loop in half?", "body": "<p>In the following code snippet, <code>tasks</code> is a buffered channel of length 30 that is populated with exactly 30 elements. I'm writing a <code>for</code> loop to operate on each task, which is read in from a channel. </p>\n\n<pre><code>for i := 0; i &lt; len(tasks); i++ {\n    fmt.Println(i)\n    select {\n      case task := &lt;-tasks: \n        fmt.Println(task)\n        // Do something\n\n    }\n}\n\nfmt.Println(\"Done\")\n</code></pre>\n\n<p>However, this for loop only runs from 0 to 14. When I vary the length of this channel (which depends on the number of task elements I have), the for loop always only runs for half of <code>len(tasks)</code>. Why is this the case? </p>\n\n<p>Background: \nI use a buffered channel for the tasks because I intend to execute each task in a goroutine, and tasks are dealt with if they fail. But I've currently cut code down to a select case in a for loop, and I'm confused about why the select case causes the for loop to only execute for half the time. I confirm that this for loop has finished executing, and that after the last execution, <code>i</code> is equal to 14 (channel length is 30). </p>\n"}, {"tags": ["google-app-engine", "go", "firebase"], "owner": {"reputation": 21, "user_id": 6423978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadf8f259d8070bb736e60455003ac4?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Scheper", "link": "https://stackoverflow.com/users/6423978/jack-scheper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465070830, "creation_date": 1465070830, "question_id": 37634537, "link": "https://stackoverflow.com/questions/37634537/firebase-made-local-datastore-inaccessable-when-added-to-a-golang-app", "title": "Firebase made local datastore inaccessable when added to a Golang app", "body": "<p>I want to use Firebase Auth UI with a Google AppEngine app written in Go.  I installed Firebase and used the Firebase console to add my app.     It appears that Firebase took control of the local dev.  datastore file (something keeps making the directory it's in <em>read only</em> so Python can't open it when I issue a new data_path instruction).</p>\n\n<p>If I delete the Firebase app, a warning message indicates: \"You lose access to your entire project, including your project's apps\"<br>\nDoes this mean that the resources of my original GAE Go app will be deleted too?</p>\n\n<p>For now I just want to restore my Golang datastore connectivity in my development environment - is it safe to delete this Firebase project?  Should I remove the Firebase tools ? \nthanks!</p>\n"}, {"tags": ["rest", "google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 78, "user_id": 3620240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6ff38e08e365dc0fbd1220e22c1952ce?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep Midha", "link": "https://stackoverflow.com/users/3620240/amandeep-midha"}, "edited": false, "score": 0, "creation_date": 1465071805, "post_id": 37634447, "comment_id": 62751155, "body": "Thanks, files are well within 5 MB but hitting 60 seconds limit. What you suggest possibly here ? Any tuning / cache etc  (Already tried warmup)"}, {"owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "reply_to_user": {"reputation": 78, "user_id": 3620240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6ff38e08e365dc0fbd1220e22c1952ce?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep Midha", "link": "https://stackoverflow.com/users/3620240/amandeep-midha"}, "edited": false, "score": 1, "creation_date": 1465072201, "post_id": 37634447, "comment_id": 62751262, "body": "Your response time should be ~1 second. Then it&#39;s up to the client to get the file. If you hit 60 seconds limit, something is wrong."}], "tags": [], "owner": {"reputation": 38473, "user_id": 821657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qDRGg.png?s=128&g=1", "display_name": "Andrei Volgin", "link": "https://stackoverflow.com/users/821657/andrei-volgin"}, "is_accepted": false, "score": 1, "last_activity_date": 1465070158, "creation_date": 1465070158, "answer_id": 37634447, "question_id": 37634246, "link": "https://stackoverflow.com/questions/37634246/what-is-best-approach-to-make-large-static-binary-available-available-through-ht/37634447#37634447", "title": "What is best approach to make large static binary available available through HTTP endpoint in Go over Google App Cloud?", "body": "<p>App Engine has two limits: 60 seconds and 32MB max per request. If you need to serve large files, you need to use Google Cloud Storage which supports files up to 5GB (June 2016). You can keep these files private and serve directly from the bucket to your client using a signed URL.</p>\n"}], "owner": {"reputation": 78, "user_id": 3620240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6ff38e08e365dc0fbd1220e22c1952ce?s=128&d=identicon&r=PG&f=1", "display_name": "Amandeep Midha", "link": "https://stackoverflow.com/users/3620240/amandeep-midha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465070158, "creation_date": 1465068853, "question_id": 37634246, "link": "https://stackoverflow.com/questions/37634246/what-is-best-approach-to-make-large-static-binary-available-available-through-ht", "title": "What is best approach to make large static binary available available through HTTP endpoint in Go over Google App Cloud?", "body": "<p>Due to size of file repeatedly hitting deadline error (<a href=\"https://www.shiftedup.com/2015/03/12/deadline-errors-60-seconds-or-less-in-google-app-engine\" rel=\"nofollow\">https://www.shiftedup.com/2015/03/12/deadline-errors-60-seconds-or-less-in-google-app-engine</a> ) and cannot host these 3 binary files ( available on 3 endpoints ) over CDN. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1465145810, "post_id": 37633354, "comment_id": 62768684, "body": "Just a side note, but you don&#39;t need to explicitly convert integers to strings in order to print them: <code>fmt.Println(&quot;Receive!&quot;,&lt;-counter)</code> or <code>fmt.Printf(&quot;Receive! %d\\n&quot;, &lt;-counter)</code> would work just fine."}], "answers": [{"comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 2, "creation_date": 1465064383, "post_id": 37633561, "comment_id": 62748929, "body": "Yep. @Gert, add <code>time.Sleep(1 * time.Second)</code> to <code>default:</code> and see how the program behaves."}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465064674, "post_id": 37633561, "comment_id": 62749022, "body": "Thanks :D PS Can you add @Nadh suggestion to your answer please <a href=\"https://play.golang.org/p/YWAg9tTUqU\" rel=\"nofollow noreferrer\">play.golang.org/p/YWAg9tTUqU</a>"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 1, "creation_date": 1465064892, "post_id": 37633561, "comment_id": 62749085, "body": "@GertCuykens it&#39;s not a great suggestion \u2014 sleeping would mean spending a bunch of time doing nothing, ignoring messages that <i>are</i> available, and slowing the program down. The real solution is not to have a default if you don&#39;t need it, and not to do something silly like printing in it if you do :)"}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1465064997, "post_id": 37633561, "comment_id": 62749122, "body": "True, but it does illustrate the problem very well :)"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465101531, "post_id": 37633561, "comment_id": 62757538, "body": "@hobbs The suggestion is of course not a solution! Just a way to illustrate what happens."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 6, "last_activity_date": 1465064243, "creation_date": 1465064243, "answer_id": 37633561, "question_id": 37633354, "link": "https://stackoverflow.com/questions/37633354/select-default-channel-race-condition/37633561#37633561", "title": "select default channel race condition", "body": "<p>When a <code>select</code> has a <code>default</code>, it becomes non-blocking. To quote the spec:</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the \"select\" statement blocks until at least one of the communications can proceed.</p>\n</blockquote>\n\n<p>Without the <code>default</code>, the <code>select</code> would wait until it could receive from <code>quit</code> or send on <code>counter</code>, do that, and then continue (going through the <code>for</code> loop again, unless it ran that <code>return</code>). <em>With</em> the default, the <code>select</code> never waits for anything and the <code>default</code> simply runs every time it can, unless one of the other operations goes through.</p>\n\n<p>In theory the program still works the same, and will exit after the sixth time of printing \"Send!\" and \"Receive!\" \u2014 but it might be too busy printing \"Default!\" several billion times to get there in a reasonable time.</p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 37633561, "answer_count": 1, "score": 2, "last_activity_date": 1465064403, "creation_date": 1465062973, "last_edit_date": 1465064403, "question_id": 37633354, "link": "https://stackoverflow.com/questions/37633354/select-default-channel-race-condition", "title": "select default channel race condition", "body": "<p><a href=\"https://play.golang.org/p/FMKxtVlTL5\" rel=\"nofollow\">https://play.golang.org/p/FMKxtVlTL5</a></p>\n\n<p>Why does the <code>default:</code> in the select statement infinite loop the program?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"time\"\n)\n\nvar quit chan bool\nvar counter chan int\n\nfunc main() {\n    counter = make(chan int)\n    quit = make(chan bool)\n    go func() {\n        i := 0\n        for {\n            i++\n            select {\n            case &lt;-quit:\n                fmt.Println(\"Bye!\")\n                return\n            case counter &lt;- i:\n                fmt.Println(\"Send! \" + strconv.Itoa(i))\n            default:\n                fmt.Println(\"Default! \" + strconv.Itoa(i))\n            }\n        }\n    }()\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    fmt.Println(\"Receive! \" + strconv.Itoa(&lt;-counter))\n    quit &lt;- true\n    time.Sleep(1 * time.Second)\n}\n</code></pre>\n"}, {"tags": ["function", "pointers", "methods", "go"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 3, "creation_date": 1465061539, "post_id": 37633032, "comment_id": 62748084, "body": "You have the answer a few slides after: <a href=\"https://tour.golang.org/methods/6\" rel=\"nofollow noreferrer\">tour.golang.org/methods/6</a>"}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465061687, "post_id": 37633032, "comment_id": 62748132, "body": "@T.Claverie, I had just seen that and was posting it as an answer, lol!"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1465064351, "post_id": 37633032, "comment_id": 62748919, "body": "It is allowed because the language spec says so."}], "answers": [{"tags": [], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "is_accepted": true, "score": 2, "last_activity_date": 1465228822, "last_edit_date": 1465228822, "creation_date": 1465061642, "answer_id": 37633152, "question_id": 37633032, "link": "https://stackoverflow.com/questions/37633032/golang-why-can-i-invoke-a-pointer-receiver-method-from-a-value-type/37633152#37633152", "title": "Golang - Why can I invoke a pointer receiver method from a value type?", "body": "<p>From the same tutorial, an explanation is provided a few slides later:</p>\n\n<p>In the <a href=\"https://tour.golang.org/methods/6\" rel=\"nofollow\">Methods and pointer indirection slide</a>, the following excerpt provides an explanation:</p>\n\n<blockquote>\n  <p>For the statement v.Scale(10), even though v is a value and not a pointer, the method with the pointer receiver is called automatically. That is, as a convenience, Go interprets the statement v.Scale(10) as (&amp;v).Scale(10) since the Scale method has a pointer receiver.</p>\n</blockquote>\n"}], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "closed_date": 1465079330, "accepted_answer_id": 37633152, "answer_count": 1, "score": 1, "last_activity_date": 1465228822, "creation_date": 1465060935, "question_id": 37633032, "link": "https://stackoverflow.com/questions/37633032/golang-why-can-i-invoke-a-pointer-receiver-method-from-a-value-type", "closed_reason": "Duplicate", "title": "Golang - Why can I invoke a pointer receiver method from a value type?", "body": "<p>I am going through the <a href=\"https://tour.golang.org/list\" rel=\"nofollow\">Tour of Go</a> again, and I am confused by this <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow\">Methods Module</a></p>\n\n<p>In short a type <code>Vertex</code> is specified as well as a function with a pointer receiver</p>\n\n<pre><code>type Vertex struct {\n  X, Y float64\n}\n\nfunc (v *Vertex) Scale(f float64) {\n  v.X = v.X * f\n  v.Y = v.Y * f\n}\n</code></pre>\n\n<p>No worries here. However, my confusion comes from the main function which appears to allow a value type to invoke a method which specifies a pointer receiver.</p>\n\n<pre><code>func main() {\n  v := Vertex{3, 4}\n  v.Scale(10)\n  // v's fields have changed\n}\n</code></pre>\n\n<p>I checked the type of v just to make sure</p>\n\n<pre><code>fmt.Printf(\"v's type is %T\\n\", v)\n// v's type is main.Vertex\n</code></pre>\n\n<p>Why is this allowed? Shouldn't <code>v</code> need to be a pointer to invoke the <code>Scale</code> method e.g. <code>v := &amp;Vertex{3, 4}</code></p>\n"}, {"tags": ["go", "command-line", "compilation"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1465046002, "post_id": 37630274, "comment_id": 62743018, "body": "Static linking of external libraries/dependencies into the compiled binary."}, {"owner": {"reputation": 3510, "user_id": 4304038, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RSzjT.png?s=128&g=1", "display_name": "Adrian Krebs", "link": "https://stackoverflow.com/users/4304038/adrian-krebs"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1465046107, "post_id": 37630274, "comment_id": 62743051, "body": "to make it portable? could you explain the command line arguments to me?"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 7, "creation_date": 1465047090, "post_id": 37630274, "comment_id": 62743386, "body": "Portable, yes. &#39;netgo&#39; is a Go build tag for using a pure Go network lib instead of the host&#39;s. The rest invokes an external linker. This is a nice tutorial explaining the basics <a href=\"http://blog.hashbangbash.com/2014/04/linking-golang-statically/\" rel=\"nofollow noreferrer\">blog.hashbangbash.com/2014/04/linking-golang-statically</a>"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 2, "creation_date": 1465047417, "post_id": 37630274, "comment_id": 62743498, "body": "@Nadh is exactly correct (and should make an answer to get credit). I&#39;ve j own about these options for a while; but, I did not concive of a combined usage until I just saw your example in the question. Wow, that is a perfect use case - minimal docker image <code>from scratch</code>.  I think I&#39;m going to update all of my docker images to these tags and build options. awesome."}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1465047433, "post_id": 37630274, "comment_id": 62743502, "body": "what&#39;s the online course?"}, {"owner": {"reputation": 3510, "user_id": 4304038, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RSzjT.png?s=128&g=1", "display_name": "Adrian Krebs", "link": "https://stackoverflow.com/users/4304038/adrian-krebs"}, "reply_to_user": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 2, "creation_date": 1465139974, "post_id": 37630274, "comment_id": 62766815, "body": "thanks guys :) @eduncan911 free udacity online course about scalable microservices : <a href=\"https://www.udacity.com/course/scalable-microservices-with-kubernetes--ud615\" rel=\"nofollow noreferrer\">udacity.com/course/&hellip;</a> very recommendable!"}], "answers": [{"tags": [], "owner": {"reputation": 166, "user_id": 5661060, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gn7vFPtn9b4/AAAAAAAAAAI/AAAAAAABWUI/bSImDgKXxQA/photo.jpg?sz=128", "display_name": "Artem Kazakov", "link": "https://stackoverflow.com/users/5661060/artem-kazakov"}, "is_accepted": true, "score": 15, "last_activity_date": 1522605702, "last_edit_date": 1522605702, "creation_date": 1522605098, "answer_id": 49600956, "question_id": 37630274, "link": "https://stackoverflow.com/questions/37630274/what-do-these-go-build-flags-mean-netgo-extldflags-lm-lstdc-static/49600956#49600956", "title": "What do these Go build flags mean? netgo -extldflags &quot;-lm -lstdc++ -static&quot;&#39;", "body": "<p>--tags <a href=\"https://golang.org/src/net/net.go\" rel=\"noreferrer\">netgo is used to use go lang network stack</a> </p>\n\n<p>--ldflags <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"noreferrer\">sets the flags that are passed to 'go tool link'</a></p>\n\n<p>The value of the args to ldflags is explained in the <a href=\"https://golang.org/cmd/link/\" rel=\"noreferrer\">go tool link help</a></p>\n\n<pre><code>-extldflags flags\n    Set space-separated flags to pass to the external linker.\n</code></pre>\n\n<p>In this case the external linker is 'ld' \nso you can read <a href=\"https://linux.die.net/man/1/ld\" rel=\"noreferrer\">the man page for it</a> <br />\nMeaning of each of the arguments is:</p>\n\n<pre><code>-lm enables linking of the standard math library\n-lstdc++ enables linking of the standard c++ library\n-static means do not link against shared libraries\n</code></pre>\n"}], "owner": {"reputation": 3510, "user_id": 4304038, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/RSzjT.png?s=128&g=1", "display_name": "Adrian Krebs", "link": "https://stackoverflow.com/users/4304038/adrian-krebs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6824, "favorite_count": 8, "accepted_answer_id": 49600956, "answer_count": 1, "score": 16, "last_activity_date": 1522605702, "creation_date": 1465043575, "last_edit_date": 1465047557, "question_id": 37630274, "link": "https://stackoverflow.com/questions/37630274/what-do-these-go-build-flags-mean-netgo-extldflags-lm-lstdc-static", "title": "What do these Go build flags mean? netgo -extldflags &quot;-lm -lstdc++ -static&quot;&#39;", "body": "<p>I'm currently taking a microservice online course where I deploy small go apps to docker containers. The long and ugly command line to build the binaries is this one:</p>\n\n<pre><code>go build --tags netgo --ldflags '-extldflags \"-lm -lstdc++ -static\"'\n</code></pre>\n\n<p>till now I just used <code>go install</code> to compile my go app.</p>\n\n<p>Can anyone explain this command to me?</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "is_accepted": false, "score": 0, "last_activity_date": 1465042085, "creation_date": 1465042085, "answer_id": 37630056, "question_id": 37629947, "link": "https://stackoverflow.com/questions/37629947/go-unmarshall-xml/37630056#37630056", "title": "Go unmarshall XML", "body": "<p>Just use <code>xml.Unmarshal(xmlString, data)</code></p>\n\n<p>Here is complete example of xml unmarshalling <a href=\"https://golang.org/src/encoding/xml/example_test.go\" rel=\"nofollow\">https://golang.org/src/encoding/xml/example_test.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "is_accepted": true, "score": 2, "last_activity_date": 1465045904, "last_edit_date": 1465045904, "creation_date": 1465045285, "answer_id": 37630542, "question_id": 37629947, "link": "https://stackoverflow.com/questions/37629947/go-unmarshall-xml/37630542#37630542", "title": "Go unmarshall XML", "body": "<p>You just missed to specify XML element mapping for <code>Voices</code> :</p>\n\n<pre><code>type monsterVoice struct {\n    Voices []monsterSentence `xml:\"voice\"`\n}\n</code></pre>\n\n<p>after that small addition, unmarshalling as usual should work :</p>\n\n<pre><code>var result monster\nerr := xml.Unmarshal([]byte(your_xml_data_string), &amp;result)\n\nif err != nil {\n    fmt.Println(err)\n}\nfor _, r := range result.Voices.Voices {\n    fmt.Println(r.Sentence)\n}\n</code></pre>\n\n<p><strong><kbd><a href=\"https://play.golang.org/p/_phbETNCSh\" rel=\"nofollow\"><code>playground demo 1</code></a></kbd></strong></p>\n\n<p>better yet, drop <code>monsterVoice</code> and use child selector like so :</p>\n\n<pre><code>type monster struct {\n    XMLName xml.Name `xml:\"monster\"`\n    ....\n    Voices []monsterSentence `xml:\"voices&gt;voice\"`\n}\n</code></pre>\n\n<p>Then we can get rid of the awkward <code>result.Voices.Voices</code> in the previous demo :</p>\n\n<pre><code>for _, r := range result.Voices {\n    fmt.Println(r.Sentence)\n}\n</code></pre>\n\n<p><strong><kbd><a href=\"https://play.golang.org/p/QQMsTyzXnt\" rel=\"nofollow\"><code>playground demo 2</code></a></kbd></strong></p>\n\n<p><strong>output :</strong> (both demo yields the same output)</p>\n\n<pre><code>Another head for me!\nHead off!\nYour head will be mine!\nStand still!\nOne more head for me!\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 37630542, "answer_count": 2, "score": 0, "last_activity_date": 1465045904, "creation_date": 1465041357, "last_edit_date": 1465042851, "question_id": 37629947, "link": "https://stackoverflow.com/questions/37629947/go-unmarshall-xml", "title": "Go unmarshall XML", "body": "<p>I currently have the following XML </p>\n\n<pre><code>&lt;monster name=\"Valkyrie\" nameDescription=\"a valkyrie\" race=\"blood\" experience=\"85\" speed=\"190\" manacost=\"450\"&gt;\n    &lt;health now=\"190\" max=\"190\" /&gt;\n    &lt;look type=\"139\" head=\"113\" body=\"57\" legs=\"95\" feet=\"113\" corpse=\"20523\" /&gt;\n    &lt;voices interval=\"5000\" chance=\"10\"&gt;\n        &lt;voice sentence=\"Another head for me!\" /&gt;\n        &lt;voice sentence=\"Head off!\" /&gt;\n        &lt;voice sentence=\"Your head will be mine!\" /&gt;\n        &lt;voice sentence=\"Stand still!\" /&gt;\n        &lt;voice sentence=\"One more head for me!\" /&gt;\n    &lt;/voices&gt;\n&lt;/monster&gt;\n</code></pre>\n\n<p>And I am reading it using the following structs</p>\n\n<pre><code>type monster struct {\n    XMLName xml.Name `xml:\"monster\"`\n    Name string `xml:\"name,attr\"`\n    NameDescription string `xml:\"nameDescription,attr\"`\n    Race string `xml:\"race,attr\"`\n    Experience int `xml:\"experience,attr\"`\n    Speed int `xml:\"speed,attr\"`\n    ManaCost int `xml:\"manacost,attr\"`\n    Health monsterHealth `xml:\"health\"`\n    Look monsterLook `xml:\"look\"`\n    Voices monsterVoice `xml:\"voices\"`\n}\n\ntype monsterVoice struct {\n    Voices []monsterSentence\n}\n\ntype monsterSentence struct {\n    XMLName xml.Name `xml:\"voice\"`\n    Sentence string `xml:\"sentence,attr\"`\n}\n\ntype monsterLook struct {\n    Type int `xml:\"type,attr\"`\n    Head int `xml:\"head,attr\"`\n    Body int `xml:\"body,attr\"`\n    Legs int `xml:\"legs,attr\"`\n    Feet int `xml:\"feet,attr\"`\n    Corpse int `xml:\"corpse,attr\"`\n}\n\ntype monsterHealth struct {\n    Now int `xml:\"now,attr\"`\n    Max int `xml:\"max,attr\"`\n}\n</code></pre>\n\n<p>But I am not sure how to read the voices element</p>\n"}, {"tags": ["sql", "database", "go"], "comments": [{"owner": {"reputation": 1760, "user_id": 2569676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1551c9e98376506ba99a81c63aa6aa16?s=128&d=identicon&r=PG", "display_name": "Mateusz", "link": "https://stackoverflow.com/users/2569676/mateusz"}, "edited": false, "score": 0, "creation_date": 1610039318, "post_id": 37629357, "comment_id": 116012840, "body": "How do I loop over r.Next() twice()? The second time it&#39;s empty."}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "edited": false, "score": 0, "creation_date": 1465038552, "post_id": 37629440, "comment_id": 62740754, "body": "Okay no problem, thanks icza, you&#39;re always so helpful :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1465038405, "creation_date": 1465038405, "answer_id": 37629440, "question_id": 37629357, "link": "https://stackoverflow.com/questions/37629357/how-to-get-count-of-sql-rows-without-using-next/37629440#37629440", "title": "How to get count of sql.Rows without using Next()?", "body": "<p>You basically listed your options. There is no hidden feature that would supply you the rows count.</p>\n\n<p>Note that some db-specific driver might support this, but the general interface does not.</p>\n\n<p>Also note that if you plan to iterate over the rows and read them anyway, this means negligible overhead which you should not be concerned about. If the rows count is really big and the query returns many data and you want to avoid allocating memory for all, then execute a <code>SELECT COUNT(*)</code> query beforehand so you'll know the number of results (but know that it might change for the next query if records are inserted or updated meanwhile).</p>\n"}], "owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5474, "favorite_count": 0, "answer_count": 1, "score": 15, "last_activity_date": 1465038405, "creation_date": 1465037816, "question_id": 37629357, "link": "https://stackoverflow.com/questions/37629357/how-to-get-count-of-sql-rows-without-using-next", "title": "How to get count of sql.Rows without using Next()?", "body": "<p>I need to get the length of <code>*sql.Rows</code> <em>before</em> I begin my Next() loop to get the values out. One way is to create a slice of rows by looping over Next() twice, getting the count, and then looping over that new slice to pull the values out, but that seems really inefficient so I'm hoping there is a better way to do this. </p>\n\n<p>Looking at the docs, I see no mention of a Count function or Length function that I can use: <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"noreferrer\">https://golang.org/pkg/database/sql/#Rows</a></p>\n\n<p>Looking at the Go code, I can't see anything in the struct that would help me (although I could be missing something, so would appreciate a second pair of eyes here): <a href=\"https://github.com/golang/go/blob/master/src/database/sql/sql.go#L1714\" rel=\"noreferrer\">https://github.com/golang/go/blob/master/src/database/sql/sql.go#L1714</a> </p>\n\n<p>Surely there is some way to do this that is better than just looping over Next() twice?</p>\n\n<p>I realize I could do a separate count query as well, or even include a count(*) in my other select, but I'd rather avoid this too. This is for a Go ORM project, and I don't want to overcomplicate the select statement, and I'd rather avoid tampering with their built-up request as much as possible.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "io", "synchronization"], "answers": [{"comments": [{"owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "edited": false, "score": 2, "creation_date": 1465045462, "post_id": 37630534, "comment_id": 62742823, "body": "are you sure there is no chance of data corruption? reads may happen in parallel with appends, the only guarantee I have is that read always done for the data that&#39;s been previously appended(in another goroutine) - this enforced with providing a &quot;proper&quot; offset for the read. Is there any official documentation you may link?"}, {"owner": {"reputation": 149, "user_id": 9144511, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_VbT8TZ2f5M/AAAAAAAAAAI/AAAAAAAAAFM/ZSplr4rJEt4/photo.jpg?sz=128", "display_name": "Daniel Kurniadi", "link": "https://stackoverflow.com/users/9144511/daniel-kurniadi"}, "edited": false, "score": 0, "creation_date": 1617525771, "post_id": 37630534, "comment_id": 118324772, "body": "nice answer. I built and app that upload file to AWS (using io.Reader as input) but the data to be read comes in a stream generated by my upstream services in chunks of bytes. I thinking of this solution to write the streamed data into file and pass an io.Reader (which is a file reader of the same file) to aws file uploader."}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 5, "last_activity_date": 1465045264, "creation_date": 1465045264, "answer_id": 37630534, "question_id": 37628873, "link": "https://stackoverflow.com/questions/37628873/golang-simultaneous-read-write-to-the-file-without-explicit-file-lock/37630534#37630534", "title": "Golang simultaneous read/write to the file without explicit file lock", "body": "<p>I'll assume by \"random read\" you actually mean \"arbitrary read\".</p>\n\n<p>If I understand your use case correctly, you don't need to seek or lock or do anything manual. UNIX has this covered via <code>O_APPEND</code>. Here is what you can do:</p>\n\n<ol>\n<li>Open the file with <a href=\"https://golang.org/pkg/os/#pkg-constants\" rel=\"noreferrer\"><code>os.O_APPEND</code></a>. This way every write, <strong>regardless of any preceding operations</strong>, will go to the end of the file</li>\n<li>When reading use <a href=\"https://golang.org/pkg/os/#File.ReadAt\" rel=\"noreferrer\"><code>File.ReadAt</code></a>. This lets you specify arbitrary offsets for your reads</li>\n</ol>\n\n<p>Using this scheme you can avoid any sort of locking: the OS will do it for you. Because of the buffer cache this scheme is not even inefficient: appends and reads are pretty much independent.</p>\n"}], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3099, "favorite_count": 1, "accepted_answer_id": 37630534, "answer_count": 1, "score": 4, "last_activity_date": 1465106474, "creation_date": 1465034433, "last_edit_date": 1465037984, "question_id": 37628873, "link": "https://stackoverflow.com/questions/37628873/golang-simultaneous-read-write-to-the-file-without-explicit-file-lock", "title": "Golang simultaneous read/write to the file without explicit file lock", "body": "<p>I have a situation where I need to concurrently read/write from/to the file, but the scope of operations is <em>limited</em>:</p>\n\n<ul>\n<li>append only, no random offset writes</li>\n<li>read from random position, where I know for sure the content has been written before(via append, internal access serialization via golang channel to ensure random read happens only after content's been appended)</li>\n<li>there is only one process running</li>\n</ul>\n\n<p>This is a high loaded application and I would like to avoid locking file for each read/write I do</p>\n\n<p>I was going to open 2 files - one for read, another for append only</p>\n\n<p>would doing so create some potential issues/bugs?</p>\n\n<p>what is the recommended practice if I would like to avoid file locking for each read/write I do?</p>\n\n<p>p.s. golang, linux, ext4</p>\n"}, {"tags": ["go", "time", "floating-point", "precision", "unix-timestamp"], "answers": [{"comments": [{"owner": {"reputation": 482, "user_id": 1800635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8eec993b0d1afd64bc1dafa5adff87c?s=128&d=identicon&r=PG", "display_name": "maikonas", "link": "https://stackoverflow.com/users/1800635/maikonas"}, "edited": false, "score": 1, "creation_date": 1496491403, "post_id": 37628278, "comment_id": 75690317, "body": "10^9 is a binary XOR operation and not a power operator. Use 1000000000 or just 1e9 instead"}, {"owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "reply_to_user": {"reputation": 482, "user_id": 1800635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8eec993b0d1afd64bc1dafa5adff87c?s=128&d=identicon&r=PG", "display_name": "maikonas", "link": "https://stackoverflow.com/users/1800635/maikonas"}, "edited": false, "score": 0, "creation_date": 1496491925, "post_id": 37628278, "comment_id": 75690462, "body": "Whoops! You&#39;re right, fixed. Thanks for the comment"}], "tags": [], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "is_accepted": true, "score": 18, "last_activity_date": 1496491936, "last_edit_date": 1496491936, "creation_date": 1465030106, "answer_id": 37628278, "question_id": 37628254, "link": "https://stackoverflow.com/questions/37628254/parse-unix-timestamp-with-decimal-from-float-using-time-unix/37628278#37628278", "title": "Parse unix timestamp with decimal from float using time.Unix()?", "body": "<pre><code>sec, dec := math.Modf(timeFloat);\ntime.Unix(int64(sec), int64(dec*(1e9)));\n</code></pre>\n"}], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5208, "favorite_count": 0, "accepted_answer_id": 37628278, "answer_count": 1, "score": 10, "last_activity_date": 1496491936, "creation_date": 1465029939, "question_id": 37628254, "link": "https://stackoverflow.com/questions/37628254/parse-unix-timestamp-with-decimal-from-float-using-time-unix", "title": "Parse unix timestamp with decimal from float using time.Unix()?", "body": "<p>This is pretty straightforward, but I couldn't find a response and figured that others might have the same question.</p>\n\n<p>I have a Unix timestamp as a float, that includes a decimal value for fractions of seconds. What's the conversion factor to pass this float as two separate integers to the <code>time</code> package's <code>time.Unix(sec int64, nsec int64)</code> function, without losing the decimal precision?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 0, "creation_date": 1465023378, "post_id": 37627236, "comment_id": 62736849, "body": "what significance Scanln have then..? it claims to scan till cr or eof. <a href=\"https://golang.org/pkg/fmt/#Scan\" rel=\"nofollow noreferrer\">golang.org/pkg/fmt/#Scan</a>"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 1, "creation_date": 1465023512, "post_id": 37627236, "comment_id": 62736885, "body": "<code>Scanln is similar to Scan, but stops scanning at a newline and after the final item there must be a newline or EOF.</code> It still split by spaces, but do not continue on another line even if there is one."}, {"owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 0, "creation_date": 1465024086, "post_id": 37627236, "comment_id": 62737023, "body": "so it can be concluded that to scan an entire line with spaces in between words, fmt package has nothing to offer..?"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "edited": false, "score": 0, "creation_date": 1465026998, "post_id": 37627236, "comment_id": 62737751, "body": "Not that I know of."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 1, "last_activity_date": 1465022509, "creation_date": 1465022509, "answer_id": 37627236, "question_id": 37627191, "link": "https://stackoverflow.com/questions/37627191/go-language-equivalent-of-scanf-n/37627236#37627236", "title": "go language equivalent of scanf %[^\\n]", "body": "<p>To read an entire line, you can use the <code>bufio</code> package:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    r := bufio.NewReader(os.Stdin)\n    str, _ := r.ReadString('\\n')\n    fmt.Println(str)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 2, "last_activity_date": 1465024068, "creation_date": 1465024068, "answer_id": 37627442, "question_id": 37627191, "link": "https://stackoverflow.com/questions/37627191/go-language-equivalent-of-scanf-n/37627442#37627442", "title": "go language equivalent of scanf %[^\\n]", "body": "<p>The Scan family of functions scan space-separated tokens.</p>\n\n<p>If you read the <a href=\"https://golang.org/pkg/fmt/#Scan\" rel=\"nofollow\">fmt</a> documentation it will be obvious why you'll get only the first word of the input.</p>\n\n<blockquote>\n  <p>Scan scans text read from standard input, storing successive\n  space-separated values into successive arguments. Newlines count as\n  space. It returns the number of items successfully scanned. If that is\n  less than the number of arguments, err will report why.</p>\n</blockquote>\n\n<p><code>bufio.Scan</code> is what you need. </p>\n\n<pre><code>// read standard input as a set of lines.\nscanner := bufio.NewScanner(os.Stdin)\nfor scanner.Scan() {\n        fmt.Println(scanner.Text()) // Println will add back the final '\\n'\n}\n\nif err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading standard input:\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 603, "user_id": 3291639, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/777fc86473207d1010f34448d8aa7014?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Sourav", "link": "https://stackoverflow.com/users/3291639/himanshu-sourav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 37627442, "answer_count": 2, "score": 0, "last_activity_date": 1465024068, "creation_date": 1465022212, "question_id": 37627191, "link": "https://stackoverflow.com/questions/37627191/go-language-equivalent-of-scanf-n", "title": "go language equivalent of scanf %[^\\n]", "body": "<p>for go language </p>\n\n<hr>\n\n<p><code>fmt.Scanln(\"%s\",&amp;v)</code></p>\n\n<hr>\n\n<p>this should store entire line as string inside v variable right..? but when I am printing I get only the first word and everything after the space is not captured.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 6, "last_activity_date": 1465013882, "creation_date": 1465013882, "answer_id": 37626301, "question_id": 37626210, "link": "https://stackoverflow.com/questions/37626210/in-a-template-how-can-i-have-a-counter/37626301#37626301", "title": "In a template, how can I have a counter?", "body": "<p>How about doing it the other way around, since ranging over the actual data is something that templates do easily? You can do without <code>loop</code> and <code>inc</code> and start with</p>\n\n<pre><code>{{ range $index, $value := .MyArray }}\n&lt;td&gt;&lt;input value=\"{{ $value }}\" type=\"text\" name=\"value[]\" maxlength=\"1\" size=\"1\"&gt;\n{{ end }}\n</code></pre>\n\n<p>which will get you all of the inputs you need, but without the surrounding markup, so how do we get that? A little bit of modular arithmetic. Define a template function like so:</p>\n\n<pre><code>\"each\": func(interval, n int) bool {\n    return n % interval == 0\n}\n</code></pre>\n\n<p>then we can pad things out:</p>\n\n<pre><code>{{ range $index, $value := .MyArray }}\n{{ if each 27 $index }}&lt;tbody&gt;{{ end }}\n{{ if each 9 $index }}&lt;tr&gt;{{ end }}\n&lt;td&gt;&lt;input value=\"{{ $value }}\" type=\"text\" name=\"value[]\" maxlength=\"1\" size=\"1\"&gt;\n{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 1594195, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6455dd35ac3f86950c2ac30653905b25?s=128&d=identicon&r=PG", "display_name": "Tristan", "link": "https://stackoverflow.com/users/1594195/tristan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5933, "favorite_count": 1, "accepted_answer_id": 37626301, "answer_count": 1, "score": 3, "last_activity_date": 1465013882, "creation_date": 1465012878, "question_id": 37626210, "link": "https://stackoverflow.com/questions/37626210/in-a-template-how-can-i-have-a-counter", "title": "In a template, how can I have a counter?", "body": "<p>I require basic incrementation arithmetic and loop for my project to keep the template readable and populate a 9x9 grid with values. The values are stored in a string array and so it is necessary to be able to have control over the index.</p>\n\n<p>Here is my handler with both template functions defined:</p>\n\n<pre><code>func HomeHandler(w http.ResponseWriter, req *http.Request) {\n    t := template.New(\"home.html\").Funcs(template.FuncMap{\n        \"loop\": func(n int) []struct{} {\n            return make([]struct{}, n)\n        },\n    }).Funcs(template.FuncMap{\n        \"inc\": func(n int) int {\n            return n + 1\n        },\n    })\n\n    t, err := t.ParseFiles(\"templates/home.html\")\n\n    if err != nil {\n        log.Print(\"template/home error:\", err)\n    }\n    t.ExecuteTemplate(w, \"home.html\", nil)\n}\n</code></pre>\n\n<p>To create the grid I use the loop function like so:</p>\n\n<pre><code>{{ range loop 3}}\n&lt;tbody&gt;\n    {{ range loop 3}}\n    &lt;tr&gt;\n        {{ range loop 9}} \n        &lt;td&gt; &lt;input value=\"1\" type=\"text\" name=\"value[]\" maxlength=\"1\" size=\"1\"&gt;\n        {{end}}\n    {{end}}\n{{end}}\n</code></pre>\n\n<p>However, I'd like to set the value attribute of the input element to the correct value with my data. I believe that I can access the index with the following:</p>\n\n<pre><code>{{index .MyArray 3}}\n</code></pre>\n\n<p>I will replace \"3\" with a counter that I'll need to be able to increment correctly.</p>\n\n<p>Unfortunately, it seems like I can't correctly reassign the variable as I can only increment it from 0 to 1 at most.</p>\n\n<p>Here is my template with my counter:</p>\n\n<pre><code>{{$count := 0}}\n{{ range loop 3}}\n&lt;tbody&gt;\n    {{ range loop 3}}\n    &lt;tr&gt;\n        {{ range loop 9}} \n        {{$count := inc $count}}\n        &lt;td&gt; &lt;input value=\"1\" type=\"text\" name=\"value[]\" maxlength=\"1\" size=\"1\"&gt;\n        {{end}}\n    {{end}}\n{{end}}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1465004667, "creation_date": 1465004667, "answer_id": 37625566, "question_id": 37625480, "link": "https://stackoverflow.com/questions/37625480/how-does-go-calculate-a-hash-value-for-keys-in-a-map/37625566#37625566", "title": "How does go calculate a hash value for keys in a map?", "body": "<p>The Go map implementation uses a hash called <code>aeshash</code>. It's not AES, but it uses the aesenc assembly instruction to compute hashes. This hash isn't exported for use in the standard library. </p>\n\n<p>The hash itself is written in assembly, and can be found in the runtime package source. </p>\n"}, {"comments": [{"owner": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "edited": false, "score": 0, "creation_date": 1503024325, "post_id": 37625654, "comment_id": 78452711, "body": "How are hashes of structs made? Does it hash the struct contents as one linear chunk of memory? How about strings? Does it hash the string data itself or the internal struct representation which is a pointer and length? Would a hash of two strings which store the same byte sequence but in a different location result in equal or inequal hashes?"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "edited": false, "score": 0, "creation_date": 1503030075, "post_id": 37625654, "comment_id": 78454152, "body": "@thomasrutter if two things compare equal with <code>==</code> they must have equal hashes (or maps wouldn&#39;t work... this is also the reasoning behind all of the special cases I outlined above). That means that strings hash their bodies, not their headers. And structs compose the hashes of all of their fields. I can&#39;t find the code actually implementing that, but the tests and the <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">comparison rules</a> make it clear."}, {"owner": {"reputation": 104432, "user_id": 53212, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0fbce15f81d6308656931250db267a1?s=128&d=identicon&r=PG", "display_name": "thomasrutter", "link": "https://stackoverflow.com/users/53212/thomasrutter"}, "edited": false, "score": 0, "creation_date": 1503036201, "post_id": 37625654, "comment_id": 78456206, "body": "Thanks for the link"}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 12, "last_activity_date": 1465005916, "creation_date": 1465005916, "answer_id": 37625654, "question_id": 37625480, "link": "https://stackoverflow.com/questions/37625480/how-does-go-calculate-a-hash-value-for-keys-in-a-map/37625654#37625654", "title": "How does go calculate a hash value for keys in a map?", "body": "<ol>\n<li><p>The language spec doesn't say, which means that it's free to change at any time, or differ between implementations.</p></li>\n<li><p>The hash algorithm varies somewhat between types and platforms. As of now: On x86 (32 or 64 bit) if the CPU supports AES instructions, the runtime uses <code>aeshash</code>, a hash built on AES primitives, otherwise it uses a function \"inspired by\" xxHash and cityhash, but different from either. There are different variants for 32-bit and 64-bit systems. Most types use a simple hash of their memory contents, but floating-point types have code to ensure that 0 and -0 hash equally (since they compare equally) and NaNs hash randomly (since two NaNs are never equal). Since complex types are built from floats, their hashes are composed from the hashes of their two floating-point parts. And an interface's hash is the hash of the value stored in the interface, and not the interface header itself.</p></li>\n<li>All of this stuff is in private functions, so no, you can't access Go's internal hash for a value in your own code.</li>\n</ol>\n"}], "owner": {"reputation": 742, "user_id": 717318, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/13e99fc7225ca378040ef36ef1a3049e?s=128&d=identicon&r=PG", "display_name": "Kevin Deenanauth", "link": "https://stackoverflow.com/users/717318/kevin-deenanauth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2332, "favorite_count": 3, "accepted_answer_id": 37625654, "answer_count": 2, "score": 9, "last_activity_date": 1465005916, "creation_date": 1465003569, "question_id": 37625480, "link": "https://stackoverflow.com/questions/37625480/how-does-go-calculate-a-hash-value-for-keys-in-a-map", "title": "How does go calculate a hash value for keys in a map?", "body": "<p>How does Go calculate a hash for keys in a map? Is it truly unique and is it available for use in other structures?</p>\n\n<p>I imagine it's easy for primitive keys like <code>int</code> or immutable <code>string</code> but it seems nontrivial for composite structures.</p>\n"}, {"tags": ["go", "documentation", "godoc"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 4, "creation_date": 1465007137, "post_id": 37625351, "comment_id": 62733886, "body": "Your helper functions shouldn&#39;t need to be exported, thus wouldn&#39;t be part of the docs."}, {"owner": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465231752, "post_id": 37625351, "comment_id": 62803988, "body": "My helper functions are in the same file though. Do I need to move them to a separate file?"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465232387, "post_id": 37625351, "comment_id": 62804340, "body": "No. Exported members begin with a capital letter, unexported ones begin with a lower-case letter (ref: <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Exported_identifiers</a>). You should simply start the helpers with a lower case and they will be omitted from your docs, unless you add a flag to specifically also include unexported members."}, {"owner": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465245542, "post_id": 37625351, "comment_id": 62811248, "body": "Thank you, doing that now"}], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 0, "last_activity_date": 1465356327, "creation_date": 1465356327, "answer_id": 37692712, "question_id": 37625351, "link": "https://stackoverflow.com/questions/37625351/how-to-only-make-part-of-a-go-document-show-up-in-godocs/37692712#37692712", "title": "How to only make part of a go document show up in godocs", "body": "<p>The <em>default</em> behavior of the commands <strong>godoc</strong> and its cousin <strong>go doc</strong>, display package documentation of <em>exported declarations</em>. Oddly I did not find a simple authoritative source to link to that explicitly documents this fact, but there are inferences to that fact referenced in commands that alter the default behavior, such as from the <a href=\"https://godoc.org/golang.org/x/tools/cmd/godoc\" rel=\"nofollow\">godoc package's documentation</a>:</p>\n\n<blockquote>\n  <p>The presentation mode of web pages served by godoc can be controlled with the \"m\" URL parameter; it accepts a comma-separated list of flag names as value: </p>\n</blockquote>\n\n<p>...</p>\n\n<blockquote>\n  <p>For instance, <a href=\"http://golang.org/pkg/math/big/?m=all,text\" rel=\"nofollow\">http://golang.org/pkg/math/big/?m=all,text</a> shows the documentation for all (not just the exported) declarations of package big, in textual form (as it would appear when using godoc from the command line: \"godoc -src math/big .*\"). </p>\n</blockquote>\n\n<p>And the source code at <a href=\"https://golang.org/src/go/doc/doc.go\" rel=\"nofollow\">https://golang.org/src/go/doc/doc.go</a> which includes:</p>\n\n<pre><code>81    const (\n82        // extract documentation for all package-level declarations,\n83        // not just exported ones\n84        AllDecls Mode = 1 &lt;&lt; iota\n...\n89    )\n</code></pre>\n\n<p>And <a href=\"https://golang.org/src/go/doc/exports.go\" rel=\"nofollow\">https://golang.org/src/go/doc/exports.go</a> documents a function with:</p>\n\n<pre><code>241    // fileExports removes unexported declarations from src in place.\n</code></pre>\n\n<p>And finally running <code>go doc -h</code> in the terminal reveals a flag: </p>\n\n<p><em>-u show unexported symbols as well as exported.</em></p>\n"}], "owner": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 357, "favorite_count": 0, "accepted_answer_id": 37692712, "answer_count": 1, "score": -1, "last_activity_date": 1465356327, "creation_date": 1465002161, "question_id": 37625351, "link": "https://stackoverflow.com/questions/37625351/how-to-only-make-part-of-a-go-document-show-up-in-godocs", "title": "How to only make part of a go document show up in godocs", "body": "<p>I am using godocs to document my API written in go/golang and I am documenting it using godocs in the sense that I generate an HTML page of my entire main.go file which contains all the functions used to create my API. However, I do not want to display information about all my helper functions, I just want to display header information about some functions in the file. Is there a way to only allow some of the functions in the file to be part of the documentation or do I have to create another file for all my helper functions?\nRight now I am testing it on my local port 8000: <code>godoc -http=:8000</code></p>\n"}, {"tags": ["python", "sockets", "go", "binary", "packing"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465009810, "post_id": 37625112, "comment_id": 62734275, "body": "Oh. I had similar problems starting out. Sorry I don&#39;t have time to look in depth, maybe if this is still unanswered after I get up tomorrow I&#39;ll do so, but sometimes the problem is as simple as needing to <code>\\n</code> or something similar to indicate that the write is terminated... maybe that helps, and maybe someone who can take the time will get to it before I have a chance."}, {"owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "reply_to_user": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465010826, "post_id": 37625112, "comment_id": 62734434, "body": "Jeah, i did some work and surprisingly you&#39;re right with the &quot;\\n&quot;, i also encode large messages with fancy unicode byte sequences to base64 now... But really, only god knows why its works how it works now. It looks very ugly now:   conn.Write(pack(&quot;\\n&quot;))  conn.Write(pack(&quot;msgb64 &quot; + string(b64.StdEncoding.EncodeToString([]byte(out)))))"}, {"owner": {"reputation": 11620, "user_id": 1832301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dfe654f47e3de2384ffd4e2165c575c?s=128&d=identicon&r=PG", "display_name": "BraveNewCurrency", "link": "https://stackoverflow.com/users/1832301/bravenewcurrency"}, "edited": false, "score": 0, "creation_date": 1465061094, "post_id": 37625112, "comment_id": 62747938, "body": "There is no need for newlines. In the code you pasted, you have <code>tlsCon.Write</code> and <code>c.Write</code>. We don&#39;t know what <code>c</code> is."}, {"owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "edited": false, "score": 0, "creation_date": 1468542346, "post_id": 37625112, "comment_id": 64182093, "body": "The variable &quot;c&quot; is actually &quot;tlsConn&quot;. I overlooked that due a code-beautification for this post. Sorry my fault. Currently my script works with the newlinew workaround on go 1.5 - 1.6, i haven&#39;t tried the 1.7 alpha yet."}], "owner": {"reputation": 29, "user_id": 6421586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y6HBr.png?s=128&g=1", "display_name": "Johnny BeGood", "link": "https://stackoverflow.com/users/6421586/johnny-begood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 741, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1468542556, "creation_date": 1464999130, "last_edit_date": 1468542556, "question_id": 37625112, "link": "https://stackoverflow.com/questions/37625112/golang-sending-binary-encoded-data-via-tls-socket", "title": "Golang - Sending binary encoded data via TLS Socket", "body": "<p>I'm new to Golang and this kind of more lowlevel stuff, so maybe i'm just thinking in the wrong direction.</p>\n\n<p>My project is a small golang monitoring client which sends some ping-message (current date) over a encrypted TLS connection (this is just for learning purpose).\nThe python server and client are working flawless for now.</p>\n\n<p>The (python) server &amp; client are packing the data like this:</p>\n\n<pre><code>[...]\ndef _send_msg(self, msg):\n    msg = struct.pack('&gt;I', len(msg)) + bytes(msg, 'UTF-8')\n    self.client.send(msg)\n\ndef _recv_msg(self):\n    raw_msglen = self.client.recv(4)\n    if not raw_msglen:\n        return \"\"\n    msglen = struct.unpack('&gt;I', raw_msglen)[0]\n    return self._recvall(msglen)\n[...]\n</code></pre>\n\n<p>On the Go-Side I pack the data like this:</p>\n\n<pre><code>type packet struct {\n   a uint32\n   b []byte\n}\n\nfunc pack(d string) []byte {\n\n    buf := bytes.Buffer{}\n    u := len([]byte(d))\n    p := packet{\n        a: uint32(u),      \n        b: []byte(d),\n    }\n\n    err := binary.Write(&amp;buf, binary.BigEndian, p.a) // struct.unpack('&gt;I' [...] in python \n\n    if err != nil {\n       fmt.Println(err)\n    }\n\n    buf.Write(p.b) // Append bytes to buffer\n\n    return buf.Bytes() \n}\n\nreader := bufio.NewReader(tlsConn) // Socket reader\n\n[..]\n// Writing binary data\ntlsConn.Write(pack(\"login test:test\")) // Works so far\n\n// Reading response (from python server)\nvar p uint32  // packet size\nbinary.Read(reader, binary.BigEndian, &amp;p) // Read packet length (4 bytes uint32)\nbuf1 := make([]byte, int(p))\nreader.Read(buf1)\nfmt.Println(string(buf1)) // Print  response - this also works\n\n// Send some ping\n// This code part also get's passed, but the python server doesn't\n// recive any message\nc.Write(pack(\"ping 0000-00-00 00:00:00\")) \nbinary.Read(reader, binary.BigEndian, &amp;p)\nbuf1 = make([]byte, int(p))\nfmt.Println(string(buf1)) // Here i don't get an response\n</code></pre>\n\n<p>Here is the golang client-side test code which I'm using: <a href=\"http://pastebin.com/dr1mJZ9Y\" rel=\"nofollow\">http://pastebin.com/dr1mJZ9Y</a>\nand the corresponding terminal output: <a href=\"http://pastebin.com/mrctJPs5\" rel=\"nofollow\">http://pastebin.com/mrctJPs5</a></p>\n\n<p>The strange thing is, that the login message (including the server response) all get sent (and received) correctly but the second time when i try to send a ping like:</p>\n\n<pre><code>tlsConn.Write(pack(\"ping 0000-00-00 00:00:00\"))\n</code></pre>\n\n<p>The message seems not to reach the server and no response message gets  send back to the client.</p>\n\n<p>Is there an error with the binary encoding of the packet-data and the length prefixing? </p>\n\n<p>I know the code looks a bit messy and not very go-idiomatic, sorry for that.\nThank you again in advance for your help!</p>\n\n<p>Software dependencies / environment:</p>\n\n<ul>\n<li>Python 3.4</li>\n<li>Golang 1.5.3 (amd64 Linux)</li>\n<li>No 3rd-Party libs</li>\n</ul>\n"}, {"tags": ["c++", "opencv", "go", "computer-vision"], "comments": [{"owner": {"reputation": 1260, "user_id": 3893901, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1936c40432997826b9c180e11d010106?s=128&d=identicon&r=PG&f=1", "display_name": "jonathanGB", "link": "https://stackoverflow.com/users/3893901/jonathangb"}, "edited": false, "score": 0, "creation_date": 1465081011, "post_id": 37624560, "comment_id": 62753498, "body": "I&#39;ve specified that my #1 requirement is performance."}], "answers": [{"comments": [{"owner": {"reputation": 1260, "user_id": 3893901, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1936c40432997826b9c180e11d010106?s=128&d=identicon&r=PG&f=1", "display_name": "jonathanGB", "link": "https://stackoverflow.com/users/3893901/jonathangb"}, "edited": false, "score": 0, "creation_date": 1465055870, "post_id": 37624576, "comment_id": 62746238, "body": "But would you say it&#39;s the most performant option?"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": true, "score": 4, "last_activity_date": 1464994594, "creation_date": 1464994594, "answer_id": 37624576, "question_id": 37624560, "link": "https://stackoverflow.com/questions/37624560/opencv-or-similar-library-in-go/37624576#37624576", "title": "OpenCV (or similar library) in Go", "body": "<p><a href=\"http://zacg.github.io/blog/2013/06/06/calling-c-plus-plus-code-from-go-with-swig/\" rel=\"nofollow\">SWIG</a> is certainly a viable option.</p>\n\n<p>You can also search for a Go binding to OpenCV.  For example: <a href=\"https://github.com/lazywei/go-opencv\" rel=\"nofollow\">https://github.com/lazywei/go-opencv</a></p>\n"}], "owner": {"reputation": 1260, "user_id": 3893901, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1936c40432997826b9c180e11d010106?s=128&d=identicon&r=PG&f=1", "display_name": "jonathanGB", "link": "https://stackoverflow.com/users/3893901/jonathangb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "closed_date": 1465010060, "accepted_answer_id": 37624576, "answer_count": 1, "score": 2, "last_activity_date": 1464994763, "creation_date": 1464994487, "last_edit_date": 1464994763, "question_id": 37624560, "link": "https://stackoverflow.com/questions/37624560/opencv-or-similar-library-in-go", "closed_reason": "Needs more focus", "title": "OpenCV (or similar library) in Go", "body": "<p>I intend to use OpenCV for a project in which I've already built the server in Go. However, OpenCV doesn't have a Go API, so what's the best solution? Call a c++ program with <code>.exec</code>, use swig, find another library to do computer vision?</p>\n\n<p>Thanks.</p>\n\n<p>Edit: I want to maximize performance, and I'm ok with C++.</p>\n"}, {"tags": ["ms-access", "go"], "comments": [{"owner": {"reputation": 18231, "user_id": 475052, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dcf2e8035affcf18eef28b9e0d3f1569?s=128&d=identicon&r=PG", "display_name": "Carl Veazey", "link": "https://stackoverflow.com/users/475052/carl-veazey"}, "edited": false, "score": 0, "creation_date": 1465019111, "post_id": 37622396, "comment_id": 62735884, "body": "Three spots in <code>getTableNames</code> could return non nil error. When you debugged this by adding log statements or using a debugger, which one was executed?"}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "reply_to_user": {"reputation": 18231, "user_id": 475052, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dcf2e8035affcf18eef28b9e0d3f1569?s=128&d=identicon&r=PG", "display_name": "Carl Veazey", "link": "https://stackoverflow.com/users/475052/carl-veazey"}, "edited": false, "score": 0, "creation_date": 1465198285, "post_id": 37622396, "comment_id": 62783197, "body": "The first one with the Select-query."}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "reply_to_user": {"reputation": 18231, "user_id": 475052, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/dcf2e8035affcf18eef28b9e0d3f1569?s=128&d=identicon&r=PG", "display_name": "Carl Veazey", "link": "https://stackoverflow.com/users/475052/carl-veazey"}, "edited": false, "score": 0, "creation_date": 1465199580, "post_id": 37622396, "comment_id": 62783897, "body": "Adding &quot;AND ((MSysObjects.Flags)=0)&quot; as a constraint doesn&#39;t help. Maybe this goes back to a potential problem mentioned in the original stackoverflow topic: &quot;MsysObjects are unsupported system tables and should not be used. Permissions on these tables outside of MS Access can be very chancy&quot;?"}], "owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 589, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465198533, "creation_date": 1464983706, "last_edit_date": 1592644375, "question_id": 37622396, "link": "https://stackoverflow.com/questions/37622396/no-error-description-in-golang-when-trying-to-read-the-table-names-of-a-ms-acces", "title": "no error description in golang when trying to read the table names of a ms-access db", "body": "<p>I try to read out the table names of an Access database (aka. an mdb-file) in go.\nMy code is pretty much a mixture of <a href=\"https://github.com/mattn/go-adodb/blob/master/_example/mdb.go\" rel=\"nofollow noreferrer\">an example of how to use the go-driver</a> and the <a href=\"https://stackoverflow.com/questions/201282/how-can-i-get-table-names-from-an-ms-access-database\">stackoverflow answer on how to get the table names from an mdb file</a>.</p>\n<p>The result is the the text</p>\n<p><strong>get table names</strong></p>\n<p>on the command-line which means that the row <code>log.Fatal(&quot;get table names&quot;, err)</code> got triggered. But as a golang-beginner, i don't know why this happened because the error message seems to be empty, so i don't get any further information.</p>\n<pre><code>package main\n\nimport (\n    &quot;database/sql&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n    _ &quot;github.com/mattn/go-adodb&quot;\n)\n\nfunc main() {\n    mdbFilePath := &quot;./register.mdb&quot;\n\n    db, err := openAccessDb(mdbFilePath)\n    if err != nil {\n        log.Fatal(&quot;open file error:&quot;, err)\n    }\n\n    tableNames, err := getTableNames(db)\n    if err != nil {\n        log.Fatal(&quot;get table names&quot;, err)\n    }\n\n    if len(tableNames) &lt;= 0 {\n        fmt.Println(&quot;no tables found in &quot; + mdbFilePath)\n        return\n    }\n    // print out all the table names\n    for index, tableName := range tableNames {\n        fmt.Printf(&quot;table {%d}: {%s}\\n&quot;, index+1, tableName)\n    }\n}\n\nfunc openAccessDb(mdbFilePath string) (*sql.DB, error) {\n    db, err := sql.Open(\n        &quot;adodb&quot;,\n        &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data Source=&quot;+mdbFilePath+&quot;;&quot;)\n    return db, err\n}\n\nfunc getTableNames(db *sql.DB) ([]string, error) {\n    rows, err := db.Query(\n        `SELECT MSysObjects.Name AS table_name\n        FROM MSysObjects\n        WHERE (((Left([Name],1))&lt;&gt;&quot;~&quot;)\n        AND ((Left([Name],4))&lt;&gt;&quot;MSys&quot;)\n        AND ((MSysObjects.Type) In (1,4,6)))\n        order by MSysObjects.Name`)\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    tableNames := make([]string, 4)\n    for rows.Next() {\n        var name string\n        if err := rows.Scan(&amp;name); err != nil {\n            return nil, err\n        }\n        tableNames = append(tableNames, name)\n    }\n    if err := rows.Err(); err != nil {\n        return nil, err\n    }\n\n    return tableNames, nil\n}\n</code></pre>\n<p><strong>UPDATE</strong></p>\n<p>the error comes from the select-query. But i don't know how to fix this as this comes, as mentioned, directly <a href=\"https://stackoverflow.com/questions/201282/how-can-i-get-table-names-from-an-ms-access-database\">from another stackoverflow answer</a></p>\n"}, {"tags": ["postgresql", "datetime", "go", "go-gorm"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465047519, "post_id": 37622354, "comment_id": 62743529, "body": "Have you tried passing <code>parseTime=True</code> in the DSN? For example, <code>gorm.Open(&quot;postgres&quot;, &quot;...?charset=utf8&amp;parseTime=true&quot;)</code>"}, {"owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465202547, "post_id": 37622354, "comment_id": 62785495, "body": "No, I have this line: \t &quot;&quot;&quot; db, err := gorm.Open(&quot;postgres&quot;, &quot;user=postgres password=postgres dbname=go_dev sslmode=disable&quot;) &quot;&quot;&quot; I didn&#39;t find a way how to pass this parameter to the Open func"}], "owner": {"reputation": 646, "user_id": 1835337, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/1fbdc5186f28d5ad225812065c20723c?s=128&d=identicon&r=PG", "display_name": "user1835337", "link": "https://stackoverflow.com/users/1835337/user1835337"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1467147565, "creation_date": 1464983486, "last_edit_date": 1467147565, "question_id": 37622354, "link": "https://stackoverflow.com/questions/37622354/how-to-display-datetime-value-in-api-response-with-gorm", "title": "How to display datetime value in API response with gorm", "body": "<p>I am building simple API with Golang and I am using gorm with Postgres.\nI am storing datetime value with <code>time.Now()</code> in database and it stores it correctly.\nWhen I am trying to display this value in API response I am getting <code>\"0001-01-01T00:00:00Z\"</code> value.</p>\n\n<p>Server logs:</p>\n\n<pre><code>(sql: Scan error on column index 5: unsupported driver -&gt; Scan pair: []uint8 -&gt; *time.Time)\n[2016-06-03 22:41:22]\n</code></pre>\n\n<p>GetAll func:</p>\n\n<pre><code>func GetAll() map[string]*Project {\n    db, err := NewDB()\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n\n    Projects = make(map[string]*Project)\n    projects := []Project{}\n    db.Find(&amp;projects)\n\n    for i := range projects {\n        fmt.Println(i, &amp;projects[i])\n        v := &amp;projects[i]\n        Projects[v.PackageName] = &amp;projects[i]\n    }\n    return Projects\n}\n</code></pre>\n\n<p>Why does it happen?</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1464981349, "post_id": 37621794, "comment_id": 62726300, "body": "Could you post an example of a document that generates this error? It would probably be simpler if you defined your collection schema as a struct."}, {"owner": {"reputation": 53, "user_id": 5803537, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRsM8Rrho5g/AAAAAAAAAAI/AAAAAAAAADw/nGkxwlGVlV8/photo.jpg?sz=128", "display_name": "Syed Qasim Rizvi", "link": "https://stackoverflow.com/users/5803537/syed-qasim-rizvi"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1465145961, "post_id": 37621794, "comment_id": 62768747, "body": "Thanks @user114241 ... the problem is that collection is schemaless."}, {"owner": {"reputation": 53, "user_id": 5803537, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRsM8Rrho5g/AAAAAAAAAAI/AAAAAAAAADw/nGkxwlGVlV8/photo.jpg?sz=128", "display_name": "Syed Qasim Rizvi", "link": "https://stackoverflow.com/users/5803537/syed-qasim-rizvi"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1465186522, "post_id": 37621794, "comment_id": 62778841, "body": "Thanks @user114241-- I fixed the issue using &quot;reflect&quot;."}], "owner": {"reputation": 53, "user_id": 5803537, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LRsM8Rrho5g/AAAAAAAAAAI/AAAAAAAAADw/nGkxwlGVlV8/photo.jpg?sz=128", "display_name": "Syed Qasim Rizvi", "link": "https://stackoverflow.com/users/5803537/syed-qasim-rizvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1464983460, "creation_date": 1464980993, "last_edit_date": 1464983460, "question_id": 37621794, "link": "https://stackoverflow.com/questions/37621794/mongo-sharred-key-definition-and-used-in-go-lang", "title": "Mongo Sharred Key definition and used in GO lang", "body": "<p>I have a program where I need to access Mongo Sharred Key from DB collection in Go lang. I retrieve the collection output as </p>\n\n<pre><code>map[string]interface{} \n</code></pre>\n\n<p>and type cast Mongo Sharred Key. However sometime its definition is int64 and sometime it is only int. So my Go program is getting panic sating</p>\n\n<blockquote>\n  <p>\"invalid interface conversion - interface is defined as int but its type is int64\". </p>\n</blockquote>\n\n<p>And when I change its definition to int64 again I am getting same type error for other records. Please help.</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 17930, "user_id": 1575066, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/hGOuL.png?s=128&g=1", "display_name": "PascalVKooten", "link": "https://stackoverflow.com/users/1575066/pascalvkooten"}, "edited": false, "score": 0, "creation_date": 1464980352, "post_id": 37621582, "comment_id": 62725817, "body": "So we actually have to write the definition twice? When the value changes, it has to be changed at 2 places. Seems very weird. At least it worked."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "reply_to_user": {"reputation": 17930, "user_id": 1575066, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/hGOuL.png?s=128&g=1", "display_name": "PascalVKooten", "link": "https://stackoverflow.com/users/1575066/pascalvkooten"}, "edited": false, "score": 0, "creation_date": 1464980444, "post_id": 37621582, "comment_id": 62725859, "body": "So currently your code declares that <code>neighbours</code> will exist, but it doesn&#39;t actually ask for memory for it. We have to ask for memory for it before we can put any data in it. So it&#39;s not so much writing the definition twice, as making sure we get memory for the map."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "reply_to_user": {"reputation": 17930, "user_id": 1575066, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/hGOuL.png?s=128&g=1", "display_name": "PascalVKooten", "link": "https://stackoverflow.com/users/1575066/pascalvkooten"}, "edited": false, "score": 0, "creation_date": 1464980587, "post_id": 37621582, "comment_id": 62725929, "body": "Oh it can, that&#39;s why I wrote <code>var neighbours = make(map[COO][]COO)</code>, you can put that instead of <code>var neighbours map[COO][]COO</code>. The confusion stems probably from the fact that a nil slice is valid to use for normal slice operations, but a nil map isn&#39;t valid to use for map operations."}, {"owner": {"reputation": 17930, "user_id": 1575066, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/hGOuL.png?s=128&g=1", "display_name": "PascalVKooten", "link": "https://stackoverflow.com/users/1575066/pascalvkooten"}, "edited": false, "score": 0, "creation_date": 1464980936, "post_id": 37621582, "comment_id": 62726099, "body": "Could have sworn it gave an error message when I tried it, but copying from you did the trick! Thanks a lot."}], "tags": [], "owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "is_accepted": true, "score": 4, "last_activity_date": 1464980106, "creation_date": 1464980106, "answer_id": 37621582, "question_id": 37621441, "link": "https://stackoverflow.com/questions/37621441/panic-assignment-to-entry-in-nil-map-on-single-simple-map/37621582#37621582", "title": "panic: assignment to entry in nil map on single simple map", "body": "<p>You need to initialize neighbours: <code>var neighbours = make(map[COO][]COO)</code></p>\n\n<p>See the second section in: <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">https://blog.golang.org/go-maps-in-action</a></p>\n\n<p>You'll get a panic whenever you try to insert a value into a map that hasn't been initialized.</p>\n"}, {"comments": [{"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 2, "creation_date": 1464987114, "post_id": 37622416, "comment_id": 62729015, "body": "Perhaps I&#39;m misunderstanding what you&#39;ve written, but you don&#39;t have to initialize a slice in order to append to it (a nil slice is valid to append to)."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1464987802, "post_id": 37622416, "comment_id": 62729327, "body": "I wasn&#39;t aware of that, thanks for correcting me ! I updated my post accordingly."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1464987958, "post_id": 37622416, "comment_id": 62729379, "body": "np! I&#39;m just lazy and love using nil slices to start if I don&#39;t know what capacity I&#39;ll actually need lol."}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 3, "last_activity_date": 1464987772, "last_edit_date": 1464987772, "creation_date": 1464983790, "answer_id": 37622416, "question_id": 37621441, "link": "https://stackoverflow.com/questions/37621441/panic-assignment-to-entry-in-nil-map-on-single-simple-map/37622416#37622416", "title": "panic: assignment to entry in nil map on single simple map", "body": "<p>In Golang, everything is initialized to a <code>zero value</code>, it's the default value for uninitialized variables.</p>\n\n<p>So, as it has been conceived, a map's zero value is nil. When trying to use an non-initialized map, it panics. (Kind of a null pointer exception)</p>\n\n<p>Sometimes it can be useful, because if you know the zero value of something you don't have to initialize it explicitly:</p>\n\n<pre><code>var str string\nstr += \"42\"\nfmt.Println(str)\n// 42 ; A string zero value is \"\"\n\nvar i int\ni++\nfmt.Println(i)\n// 1 ; An int zero value is 0\n\nvar b bool\nb = !b\nfmt.Println(b)\n// true ; A bool zero value is false\n</code></pre>\n\n<p>If you have a Java background, that's the same thing: primitive types have a default value and objects are initialized to null;</p>\n\n<p>Now, for more complex types like <code>chan</code> and <code>map</code>, the zero value is <code>nil</code>, that's why you have to use <code>make</code> to instantiate them. Pointers also have a nil zero value. The case of arrays and slice is a bit more tricky:</p>\n\n<pre><code>var a [2]int\nfmt.Println(a)\n// [0 0]\n\nvar b []int\nfmt.Println(b)\n// [] ; initialized to an empty slice\n</code></pre>\n\n<p>The compiler knows the length of the array (it cannot be changed) and its type, so it can already instantiate the right amount of memory. All of the values are initialized to their zero value (unlike C where you can have anything inside your array). For the slice, it is initialized to the empty slice <code>[]</code>, so you can use <code>append</code> normally.</p>\n\n<p>Now, for structs, it is the same as for arrays. Go creates a struct with all its fields initialized to zero values. It makes a deep initialization, example here:</p>\n\n<pre><code>type Point struct {\n    x int\n    y int\n}\n\ntype Line struct {\n    a Point\n    b Point\n}\n\nfunc main() {\n    var line Line\n    // the %#v format prints Golang's deep representation of a value\n    fmt.Printf(\"%#v\\n\", line)\n}\n// main.Line{a:main.Point{x:0, y:0}, b:main.Point{x:0, y:0}}\n</code></pre>\n\n<p>Finally, the <code>interface</code> and <code>func</code> types are also initialized to nil.</p>\n\n<p>That's really all there is to it. When working with complex types, you just have to remember to initialize them. The only exception is for arrays because you can't do <code>make([2]int)</code>.</p>\n\n<p>In your case, you have map of slice, so you need at least two steps to put something inside: Initialize the nested slice, and initialize the first map:</p>\n\n<pre><code>var buds []COO\nneighbours := make(map[COO][]COO)\nneighbours[COO{}] = buds\n\n// alternative (shorter)\nneighbours := make(map[COO][]COO)\n\n// You have to use equal here because the type of neighbours[0] is known\nneighbours[COO{}] = make([]COO, 0)\n</code></pre>\n"}], "owner": {"reputation": 17930, "user_id": 1575066, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/hGOuL.png?s=128&g=1", "display_name": "PascalVKooten", "link": "https://stackoverflow.com/users/1575066/pascalvkooten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "accepted_answer_id": 37621582, "answer_count": 2, "score": 1, "last_activity_date": 1464987772, "creation_date": 1464979508, "question_id": 37621441, "link": "https://stackoverflow.com/questions/37621441/panic-assignment-to-entry-in-nil-map-on-single-simple-map", "title": "panic: assignment to entry in nil map on single simple map", "body": "<p>I was under the impression that the assignment to entry in nil map error would only happen if we would want to assign to a double map, that is, when a map on a deeper level is trying to be assigned while the higher one doesn't exist, e.g.:</p>\n\n<pre><code>var mm map[int]map[int]int\nmm[1][2] = 3\n</code></pre>\n\n<p>But it also happens for a simple map (though with struct as a key):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype COO struct {\n    x int\n    y int\n}\n\nvar neighbours map[COO][]COO\n\nfunc main() {\n    for i := 0; i &lt; 30; i++ {\n        for j := 0; j &lt; 20; j++ {\n            var buds []COO\n            if i &lt; 29 {\n                buds = append(buds, COO{x: i + 1, y: j})\n            }\n            if i &gt; 0 {\n                buds = append(buds, COO{x: i - 1, y: j})\n            }\n            if j &lt; 19 {\n                buds = append(buds, COO{x: i, y: j + 1})\n            }\n            if j &gt; 0 {\n                buds = append(buds, COO{x: i, y: j - 1})\n            }\n            neighbours[COO{x: i, y: j}] = buds // &lt;--- yields error\n        }\n    }\n\n\n    fmt.Println(neighbours)\n\n}\n</code></pre>\n\n<p>What could be wrong?</p>\n"}, {"tags": ["go", "file-writing"], "comments": [{"owner": {"reputation": 453, "user_id": 6083111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba01cf3ef98244da8d16027dc3eb8a9?s=128&d=identicon&r=PG", "display_name": "user161778", "link": "https://stackoverflow.com/users/6083111/user161778"}, "edited": false, "score": 3, "creation_date": 1464976333, "post_id": 37620381, "comment_id": 62723810, "body": "Please show us a minimal, complete, verifiable example of your code that has the described issue."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 1290873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d9590909217c367d1b5279c319a9d98d?s=128&d=identicon&r=PG", "display_name": "nekto", "link": "https://stackoverflow.com/users/1290873/nekto"}, "edited": false, "score": 0, "creation_date": 1464976300, "post_id": 37620568, "comment_id": 62723795, "body": "f, err := os.Create(&quot;/tmp/mt_report&quot;)     if err != nil {         panic(err)     } defer f.Close() w := bufio.NewWriter(f) w.WriteString(&quot;noReport = &quot;+ string(noReport) + &quot; nr3h = &quot; + string(nr3h)+ &quot; nr2h = &quot;+ string(nr2h)+ &quot; nr1h = &quot;+ string(nr1h) + &quot; ok = &quot;+ string(ok)+ &quot;\\n&quot;)"}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": true, "score": 1, "last_activity_date": 1464976860, "last_edit_date": 1495542159, "creation_date": 1464975973, "answer_id": 37620568, "question_id": 37620381, "link": "https://stackoverflow.com/questions/37620381/writing-to-file-int-converted-to-string/37620568#37620568", "title": "Writing to file int converted to string", "body": "<p><a href=\"https://play.golang.org/p/QAXJ4aJBy3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QAXJ4aJBy3</a></p>\n\n<pre><code>fmt.Printf(\"os.StdOut is %T\\n\", os.Stdout)\nos.Stdout.WriteString(\"noReport = 12320 nr3h = 105 nr2h = 162 nr1h = 38 ok = 16899 \\n\")\nos.Stdout.WriteString(\"12320\")\n\n//Output\n//os.StdOut is *os.File\n//noReport = 12320 nr3h = 105 nr2h = 162 nr1h = 38 ok = 16899 \n//12320\n</code></pre>\n\n<p>Works fine for me. </p>\n\n<p>Give us your code, please.</p>\n\n<p><strong>UDP</strong></p>\n\n<p>string(noReport), noReport is integer right? Thats expected behavior.</p>\n\n<p>Use <a href=\"https://golang.org/pkg/strconv/#Itoa\" rel=\"nofollow noreferrer\">strconv.Itoa</a>(noReport).</p>\n\n<pre><code>noReport := 12320\nnr3h := 105\nnr2h := 162\nnr1h := 38\nok := 16899\nos.Stdout.WriteString(\"noReport = \"+ strconv.Itoa(noReport) + \" nr3h = \" + strconv.Itoa(nr3h)+ \" nr2h = \"+ strconv.Itoa(nr2h)+ \" nr1h = \"+ strconv.Itoa(nr1h) + \" ok = \"+ strconv.Itoa(ok)+ \"\\n\") \n</code></pre>\n\n<p>Or evanmcdonnal's <a href=\"https://stackoverflow.com/a/37620716/6248842\">answer</a>. </p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 1290873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d9590909217c367d1b5279c319a9d98d?s=128&d=identicon&r=PG", "display_name": "nekto", "link": "https://stackoverflow.com/users/1290873/nekto"}, "edited": false, "score": 0, "creation_date": 1464977026, "post_id": 37620716, "comment_id": 62724188, "body": "Thank you. Worked."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1464976561, "creation_date": 1464976561, "answer_id": 37620716, "question_id": 37620381, "link": "https://stackoverflow.com/questions/37620381/writing-to-file-int-converted-to-string/37620716#37620716", "title": "Writing to file int converted to string", "body": "<p>To get a string with your ints I recommend using <code>fmt.Sprintf</code></p>\n\n<p>It would be something like this;</p>\n\n<pre><code>s := fmt.Sprintf(\"noReport = %d nr3h = %d nr2h = %d nr1h = %d ok = 16899\", 12320, 162, 38)\n</code></pre>\n\n<p>which will assign the value <code>\"noReport = 12320 nr3h = 105 nr2h = 162 nr1h = 38 ok = 16899\"</code> to <code>s</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 1290873, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d9590909217c367d1b5279c319a9d98d?s=128&d=identicon&r=PG", "display_name": "nekto", "link": "https://stackoverflow.com/users/1290873/nekto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37620568, "answer_count": 2, "score": -1, "last_activity_date": 1464977169, "creation_date": 1464975157, "last_edit_date": 1464975571, "question_id": 37620381, "link": "https://stackoverflow.com/questions/37620381/writing-to-file-int-converted-to-string", "title": "Writing to file int converted to string", "body": "<p>I just want simply write to file a string converted from int. But f.WriteString instead of number write a symbols from ASCII code table.</p>\n\n<p>I expected \"noReport =  12320 nr3h =  105 nr2h =  162 nr1h =  38 ok =  16899\"</p>\n\n<p>But instead got \"noReport = \u3020 nr3h = i nr2h = \u00a2 nr1h = &amp; ok = \u4203\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 671, "user_id": 1191379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad89c755cb24c17927ff4a3b3d4e9c2?s=128&d=identicon&r=PG", "display_name": "Kevin Frost", "link": "https://stackoverflow.com/users/1191379/kevin-frost"}, "edited": false, "score": 0, "creation_date": 1464975419, "post_id": 37620251, "comment_id": 62723363, "body": "The plot thickens! Could it be that this only hangs for very fast operations? If I call <code>CostlyPrep()</code> instead of <code>FunctionOfInterest()</code> then suddenly it works."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1464977212, "post_id": 37620251, "comment_id": 62724265, "body": "<code>StopTimer</code> blocks on a call to <code>runtime.ReadMemStats</code>, which requires a <code>stopTheWorld</code> call. You basically shouldn&#39;t be stopping and starting the timer in the benchmark loop."}, {"owner": {"reputation": 493, "user_id": 4563831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65ff019604e25751693cfd7cabbdd5d8?s=128&d=identicon&r=PG&f=1", "display_name": "ttacon", "link": "https://stackoverflow.com/users/4563831/ttacon"}, "edited": false, "score": 0, "creation_date": 1464980678, "post_id": 37620251, "comment_id": 62725980, "body": "Ya, there shouldn&#39;t be &#39;prep&#39; inside the loop, all prep (and consequently all time manipulation) should be done before entering the benchmark loop."}, {"owner": {"reputation": 671, "user_id": 1191379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad89c755cb24c17927ff4a3b3d4e9c2?s=128&d=identicon&r=PG", "display_name": "Kevin Frost", "link": "https://stackoverflow.com/users/1191379/kevin-frost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1464988467, "post_id": 37620251, "comment_id": 62729561, "body": "Thanks @JimB, but the docs strongly imply that I can do it if I have the need.  In fact the way I read it, that&#39;s precisely what these are for, because you should be using <code>b.ResetTimer()</code> for any prep that happens before the benchmark loop.  I get that it&#39;s not optimal but -- also to @user114241 on this -- there absolutely are cases where you have to fiddle with state in the benchmark loop in order for the benchmark to be meaningful.  You then need to factor out the time spent fiddling, one way or another."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1464991247, "post_id": 37620251, "comment_id": 62730579, "body": "oh yes, sorry, it shouldn&#39;t affect the timing. Run the benchmark with gctrace and see what&#39;s going on. I think that&#39;s probably what&#39;s interfering."}, {"owner": {"reputation": 671, "user_id": 1191379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad89c755cb24c17927ff4a3b3d4e9c2?s=128&d=identicon&r=PG", "display_name": "Kevin Frost", "link": "https://stackoverflow.com/users/1191379/kevin-frost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1464992285, "post_id": 37620251, "comment_id": 62730896, "body": "Thanks @JimB, your previous comment pointed me to the answer! :-)"}, {"owner": {"reputation": 7477, "user_id": 190280, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/134b8de0aceaba40d4b30757a3bffd48?s=128&d=identicon&r=PG", "display_name": "Josh Bleecher Snyder", "link": "https://stackoverflow.com/users/190280/josh-bleecher-snyder"}, "edited": false, "score": 0, "creation_date": 1547411407, "post_id": 37620251, "comment_id": 95174806, "body": "Possibly relevant: <a href=\"https://github.com/golang/go/issues/27217\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/27217</a>"}], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 1191379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad89c755cb24c17927ff4a3b3d4e9c2?s=128&d=identicon&r=PG", "display_name": "Kevin Frost", "link": "https://stackoverflow.com/users/1191379/kevin-frost"}, "is_accepted": false, "score": 4, "last_activity_date": 1464992250, "creation_date": 1464992250, "answer_id": 37624250, "question_id": 37620251, "link": "https://stackoverflow.com/questions/37620251/golang-benchmarking-b-stoptimer-hangs-is-it-me/37624250#37624250", "title": "Golang benchmarking b.StopTimer() hangs -- is it me?", "body": "<p><em>TL;DR: it's not a bug, it's just a little tricky.</em></p>\n\n<p>I'm pretty sure I know what's going on.  The use of <code>StopTimer</code> and <code>StartTimer</code> inside the benchmarking loop is not the problem; the problem is that the function I <em>do</em> want to test is too fast for its own good. Or for my good anyway.</p>\n\n<p>By adjusting the sleep time used by that function, we can pretty easily observe the benchmarking differences.  At least for something this simple, Go is running more iterations the faster the <em>measured</em> code returns.  This is known behavior and I should have thought of it.  One finds output like this:</p>\n\n<pre><code>PASS\nBenchmarkSomething-4     1000000          2079 ns/op\nok      bmtimer 36.587s\n</code></pre>\n\n<p>When the <code>FunctionOfInterest</code> returns very fast -- or of course \"infinitely\" fast, as in <code>func tooFast() {}</code> -- then Go keeps running more iterations of it, trying to get a reliable benchmark.  You might run out of patience.  Or, your computer might:</p>\n\n<pre><code>*** Test killed with quit: ran too long (10m0s).\nFAIL    bmtimer 600.037s\n</code></pre>\n\n<p>(That was ten minutes at 100% CPU on one core.)</p>\n\n<p>The good news of course is that it's not a bug; the bad news is it's still pretty annoying that it doesn't just stop at, say, a million iterations and tell you its best guess.</p>\n\n<p>But then again, the other good news is that encountering this problem indicates your function is fast enough and probably doesn't need benchmarking.</p>\n\n<p>The remaining mystery is: <strong>Why does this only happen when we stop and start the timer?</strong></p>\n\n<p>Without fiddling with the timer, I can call my noop function and it benchmarks it just fine, in a mere two billion iterations:</p>\n\n<pre><code>BenchmarkSomething-4    2000000000           0.33 ns/op\nok      bmtimer 0.706s\n</code></pre>\n\n<p>My best guess is based on the comment from @JimB -- <em>stopping the world</em> takes at least a little time, and when you're running two billion iterations that can easily run over ten minutes.  Like the man said: a billion here, a billion there, and pretty soon you're talking about real money.</p>\n\n<p>(That's my guess anyway.  Smarter folks than I may yet correct me.)</p>\n\n<p>Thus the moral of our story is: <strong>yes</strong> by all means do take advantage of <code>b.StopTimer()</code> and <code>b.StartTimer()</code> in order to handle state if you have no other way to deal with it.  But keep in mind that for very fast functions, it may be too much for the benchmarker.</p>\n\n<p>I do wish I knew a better way to isolate the specific function benchmark for fast functions.  My initial hack that I used before trying <code>StopTimer</code> was to have another benchmark function that benchmarks just the extra code, so you'd get two numbers: ns/op with everything, and ns/op <em>without</em> the function of interest.  That works, and it's probably even more accurate than stopping the timer, but it does require advance knowledge of how to interpret the benchmark output.</p>\n"}], "owner": {"reputation": 671, "user_id": 1191379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad89c755cb24c17927ff4a3b3d4e9c2?s=128&d=identicon&r=PG", "display_name": "Kevin Frost", "link": "https://stackoverflow.com/users/1191379/kevin-frost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1480, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1464992250, "creation_date": 1464974672, "last_edit_date": 1464990035, "question_id": 37620251, "link": "https://stackoverflow.com/questions/37620251/golang-benchmarking-b-stoptimer-hangs-is-it-me", "title": "Golang benchmarking b.StopTimer() hangs -- is it me?", "body": "<p>I've run into a problem benchmarking my Go programs, and it looks to me like a Go bug.  Please help me understand why it's not.</p>\n\n<p>In a nutshell: benchmarking hangs when I call <code>b.StopTimer()</code> even if I then call <code>b.StartTimer()</code> afterwards.  AFAICT I am using the functions as intended.</p>\n\n<p>This is on Mac OSX 10.11.5 \"El Capitan,\" with <code>go version go1.6.1 darwin/amd64</code>; everything else seems to be fine.  I will try to check this on Linux later today and update the question.</p>\n\n<p>Here's the code.  Run with <code>go test -bench=.</code> as usual.</p>\n\n<pre><code>package bmtimer\n\nimport (\n    \"testing\"\n    \"time\"\n)\n\n// These appear to not matter; they can be very short.\nvar COSTLY_PREP_DELAY = time.Nanosecond\nvar RESET_STATE_DELAY = time.Nanosecond\n\n// This however -- the measured function delay -- must not be too short.\n// The shorter it is, the more iterations will be timed.  If it's infinitely\n// short then you will hang -- or perhaps *appear* to hang?\nvar FUNCTION_OF_INTEREST_DELAY = time.Microsecond\n\nfunc CostlyPrep()         { time.Sleep(COSTLY_PREP_DELAY) }\nfunc ResetState()         { time.Sleep(RESET_STATE_DELAY) }\nfunc FunctionOfInterest() { time.Sleep(FUNCTION_OF_INTEREST_DELAY) }\n\nfunc TestPlaceHolder(t *testing.T) {}\n\nfunc BenchmarkSomething(b *testing.B) {\n\n    CostlyPrep()\n    b.ResetTimer()\n\n    for n := 0; n &lt; b.N; n++ {\n\n        FunctionOfInterest()\n        b.StopTimer()\n        ResetState()\n        b.StartTimer()\n    }\n}\n</code></pre>\n\n<p>Thanks in advance for any tips! I've come up short on Google as well as here.</p>\n\n<p><em>Edit:</em> It seems this only happens of <code>FunctionOfInterest()</code> is really fast; and yes, I specifically want to do this inside my benchmark loop. I've updated the sample code to make that more clear.  And I <em>think</em> I have it figured out now.</p>\n"}]