[{"tags": ["sockets", "go", "udp", "ip", "packet"], "comments": [{"owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "edited": false, "score": 0, "creation_date": 1524711322, "post_id": 50032630, "comment_id": 87084373, "body": "why syscall? <i>&quot;The primary use of syscall is inside other packages that provide a more portable interface to the system, such as &quot;os&quot;, &quot;time&quot; and &quot;net&quot;. Use those packages rather than this one if you can.&quot;</i>"}, {"owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "edited": false, "score": 0, "creation_date": 1524716712, "post_id": 50032630, "comment_id": 87105553, "body": "its working for me, all I did was build the binary and run with sudo permission."}, {"owner": {"reputation": 51, "user_id": 9700739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brash Man", "link": "https://stackoverflow.com/users/9700739/brash-man"}, "edited": false, "score": 0, "creation_date": 1524786770, "post_id": 50032630, "comment_id": 87123198, "body": "Interesting, what OS / Architecture are you running with?"}, {"owner": {"reputation": 51, "user_id": 9700739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brash Man", "link": "https://stackoverflow.com/users/9700739/brash-man"}, "reply_to_user": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "edited": false, "score": 0, "creation_date": 1524787220, "post_id": 50032630, "comment_id": 87123305, "body": "@vitr is there a way of getting access to the ip &amp; udp headers while using the &quot;net&quot; package? if so that is preferable but I couldn&#39;t figure out how to do that."}, {"owner": {"reputation": 278, "user_id": 4057608, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/DpUDg.jpg?s=128&g=1", "display_name": "Utku Ufuk", "link": "https://stackoverflow.com/users/4057608/utku-ufuk"}, "edited": false, "score": 0, "creation_date": 1581455351, "post_id": 50032630, "comment_id": 106437774, "body": "It worked for me when I removed the <code>Ethernet</code> layer altogether from the <code>SerializeBuffer</code>, since I also need to only modify IP &amp; UDP headers. Just a question, why do you need to use a raw socket on the receiver, shouldn&#39;t it be able to read the data through a regular socket as well?"}], "owner": {"reputation": 51, "user_id": 9700739, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Brash Man", "link": "https://stackoverflow.com/users/9700739/brash-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1449, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1524716712, "creation_date": 1524698262, "question_id": 50032630, "link": "https://stackoverflow.com/questions/50032630/golang-raw-socket-udp-not-working", "title": "Golang Raw socket UDP not working", "body": "<h1>Main Question</h1>\n\n<p>I am looking for a way of sending packets using the go language which grants me the ability to view and set the TTL and other low level fields of packets(I don't need to modify ethernet headers just ip &amp; UDP headers). I have attempted to craft and send my own packets in the code below.</p>\n\n<p>When running the below code no messages are received by the receiver.  Can anyone either a.) alert me to any errors I have made in this code or b.) suggest another means of sending udp data using golang while retaining access to the ip &amp; udp headers? </p>\n\n<p>(I have removed the mac addresses, they would need to be replaced to run this code)</p>\n\n<h1>Code</h1>\n\n<h3>(Sending)</h3>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"syscall\"\n    \"log\"\n    \"github.com/google/gopacket\"\n    \"github.com/google/gopacket/layers\"\n    \"fmt\"\n    \"encoding/hex\"\n    \"encoding/json\"\n    \"net\"\n)\n\ntype NameTag struct {\n    Name string `json:\"name\"`\n}\n\nfunc main() {\n    var err error\n    fd, e := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_UDP)\n    if e != nil {\n        fmt.Println(\"Problem @ location 1\")\n    }\n    addr := syscall.SockaddrInet4{\n        Port: 27289,\n        Addr: [4]byte{127, 0, 0, 1},\n    }\n    p := pkt()\n    err = syscall.Sendto(fd, p, 0, &amp;addr)\n    if err != nil {\n        log.Fatal(\"Sendto:\", err)\n    }\n}\n\nfunc pkt() []byte {\n    sb := gopacket.NewSerializeBuffer()\n    nt := NameTag{\"Paul\"}\n    b, _ := json.Marshal(nt)\n    pld := gopacket.Payload(b)\n    l := uint16(len(pld))\n    udp := layers.UDP{\n        SrcPort:  27289,\n        DstPort:  27288,\n        Length:   l + 8,\n        Checksum: 0,\n    }\n    l = l + 8\n    ip := layers.IPv4{\n        Version:    0x4,\n        IHL:        5,\n        Length:     20 + l,\n        TTL:        255,\n        Flags:      0x40,\n        FragOffset: 0,\n        Checksum:   0,\n        Protocol:   syscall.IPPROTO_UDP,\n        DstIP:      net.IPv4(127, 0, 0, 1),\n        SrcIP:      net.IPv4(127, 0, 0, 1),\n    }\n    l = l + 20\n\n    eth := layers.Ethernet{\n        EthernetType: layers.EthernetTypeIPv4,\n        SrcMAC: net.HardwareAddr{\n            0x--, 0x--, 0x--, 0x--, 0x--, 0x--,\n        },\n        DstMAC: net.HardwareAddr{\n            0x--, 0x--, 0x--, 0x--, 0x--, 0x--,\n        },\n    }\n    fmt.Println(pld.SerializeTo(sb, gopacket.SerializeOptions{}))\n    fmt.Println(udp.SerializeTo(sb, gopacket.SerializeOptions{}))\n    fmt.Println(ip.SerializeTo(sb, gopacket.SerializeOptions{}))\n    fmt.Println(eth.SerializeTo(sb, gopacket.SerializeOptions{}))\n\n    //Debug prints here (first line is for dump to packet validator)\n    fmt.Println(hex.EncodeToString(sb.Bytes()))\n    fmt.Println(sb.Bytes())\n\n    return sb.Bytes()\n}\n</code></pre>\n\n<h3>(Receiving)</h3>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"syscall\"\n    \"os\"\n    \"fmt\"\n)\n\nfunc main() {\n    fd, err := syscall.Socket(syscall.AF_INET, syscall.SOCK_RAW, syscall.IPPROTO_UDP)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    sa:= &amp;syscall.SockaddrInet4{\n        Addr: [4]byte{127,0,0,1},\n        Port:27288,\n    }\n    e := syscall.Bind(fd, sa)\n    if e != nil {\n        fmt.Println(\"problems @ location 1\")\n    }\n    f := os.NewFile(uintptr(fd), fmt.Sprintf(\"fd%d\", fd))\n    fmt.Println(\"Entering main loop\")\n    for {\n        fmt.Println(\"In loop\")\n        buf := make([]byte, 1024)\n        numRead, err := f.Read(buf)\n        if err != nil {\n            fmt.Println(\"problems @ location 2\")\n        }\n        fmt.Printf(\"Loop done %v\\n\", buf[:numRead])\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1524692372, "post_id": 50031113, "comment_id": 87079556, "body": "Your <code>main.go</code> isn&#39;t in a package directory. Start here: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524693176, "post_id": 50031113, "comment_id": 87079848, "body": "That&#39;s not the problem, I know how it&#39;s structured, it&#39;s just an simple example."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1524693428, "post_id": 50031113, "comment_id": 87079924, "body": "yes it is <i>a</i> problem. The error contains the path which shows it&#39;s not a valid package path. I can reproduce the exact same error locally, and moving the file into a proper package directory fixes the issue."}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524697054, "post_id": 50031113, "comment_id": 87080989, "body": "you are right;), but it seems that the code should not have errors, but it does not work, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 2359, "user_id": 3955129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxfYS.jpg?s=128&g=1", "display_name": "Abdollah", "link": "https://stackoverflow.com/users/3955129/abdollah"}, "is_accepted": false, "score": 0, "last_activity_date": 1568294401, "creation_date": 1568294401, "answer_id": 57907666, "question_id": 50031113, "link": "https://stackoverflow.com/questions/50031113/gorename-not-working-rename-failed-gorename-cant-find-package-containing/57907666#57907666", "title": "Gorename not working: &quot;Rename failed: gorename: can&#39;t find package containing&quot;", "body": "<p>VSCode uses <code>gorename</code> command-line tool to do rename. The tool supposes you are following the right package structure but it fails to find it. Create a <code>src</code> directory in <code>%GOPATH%</code>, i.e. create directory <code>/home/hume/projects/go/src</code>. Create another directory in <code>src</code> as the package directory and put <code>main.go</code> in the package directory. You need to add package declaration at <code>main.go</code>. Then the problem is resoved.</p>\n"}, {"comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 1, "creation_date": 1589508507, "post_id": 61328321, "comment_id": 109329674, "body": "Spent literally an hour on this, thank you! It seems gorename attempts to search my entire $GOPATH, failing on any packages that use gomod. This is definitely the best solution"}], "tags": [], "owner": {"reputation": 14632, "user_id": 428260, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Jr7uO.png?s=128&g=1", "display_name": "iltempo", "link": "https://stackoverflow.com/users/428260/iltempo"}, "is_accepted": false, "score": 10, "last_activity_date": 1589539852, "last_edit_date": 1589539852, "creation_date": 1587403327, "answer_id": 61328321, "question_id": 50031113, "link": "https://stackoverflow.com/questions/50031113/gorename-not-working-rename-failed-gorename-cant-find-package-containing/61328321#61328321", "title": "Gorename not working: &quot;Rename failed: gorename: can&#39;t find package containing&quot;", "body": "<p>You can switch to using <a href=\"https://github.com/golang/tools/tree/master/gopls\" rel=\"noreferrer\">gpls</a>, the official Go language server. Besides other featured renaming symbols works perfectly regardless of any package structure.</p>\n\n<p>In VSC open Preferences, Settings, and activate <code>go.useLanguageServer</code>. After installing <em>gpls</em> you are ready to go.</p>\n"}], "owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2248, "favorite_count": 1, "answer_count": 2, "score": 12, "last_activity_date": 1589539852, "creation_date": 1524689272, "last_edit_date": 1592644375, "question_id": 50031113, "link": "https://stackoverflow.com/questions/50031113/gorename-not-working-rename-failed-gorename-cant-find-package-containing", "title": "Gorename not working: &quot;Rename failed: gorename: can&#39;t find package containing&quot;", "body": "<p>When trying to change the symbols, VSCode throws the following error:</p>\n<p><strong>&quot;Rename failed: gorename: can't find package containing /home/hume/projects/go/main.go&quot;</strong></p>\n<blockquote>\n<p>vscode 1.22.2 x64</p>\n<p>go version go1.10.1 linux/amd64</p>\n<p>go env GOPATH /home/hume/projects/go</p>\n</blockquote>\n<p>My <code>settings.json</code> is as follows:</p>\n<pre><code>{\n      &quot;go.toolsGopath&quot;: &quot;/home/hume/gotools&quot;\n    , &quot;go.autocompleteUnimportedPackages&quot;: true\n    , &quot;go.inferGopath&quot;: true\n    , &quot;go.formatTool&quot;: &quot;gofmt&quot;\n    , &quot;go.vetFlags&quot;: [\n        &quot;/src&quot;\n       ]\n}\n</code></pre>\n<p>Thanks.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 4, "creation_date": 1524688621, "post_id": 50030691, "comment_id": 87077919, "body": "Your question is unclear. Can you please provide a sample of the XML output you&#39;d like to output?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524719284, "post_id": 50030691, "comment_id": 87086407, "body": "Please post your yaml along with code you have tried to unmarshal and problem you are facing"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1524736934, "last_edit_date": 1524736934, "creation_date": 1524730322, "answer_id": 50037994, "question_id": 50030691, "link": "https://stackoverflow.com/questions/50030691/golang-xml-unmarshalling/50037994#50037994", "title": "Golang XML Unmarshalling", "body": "<p>First, if you want to assign slice values of different types to a field you should use <code>interface{}</code> instead of <code>[]interface{}</code> as the type of the field or else you'll have to convert each element in the slice to interface manually.</p>\n\n<pre><code>type Resp struct {\n     Count   string      `xml:\"totalRows\"`\n     Records interface{} `xml:\"data&gt;record\"`\n}\n</code></pre>\n\n<p>Now since the type of the field is <code>interface{}</code> the xml decoder by itself doesn't know how to unmarshal the xml data and therefore the field is left untouched and unpopulated. To fix this, you can assist the decoder by <em>pre-allocating</em> the value of the type you want and assigning it to the field.</p>\n\n<pre><code>resp := new(Resp)\nresp.Records = new([]DepartmentRecord)\nxml.Unmarshal(data, resp)\n</code></pre>\n\n<p>Or if you want to avoid post-unmarshal type assertion on the <code>Records</code> field, allocate a variable, assign that to the field, and after unmarshal use the variable.</p>\n\n<pre><code>resp := new(Resp)\nrecords := new([]DepartmentRecord)\nresp.Records = records\nxml.Unmarshal(data, resp)\n// records is now populated and ready for use\n</code></pre>\n\n<p>Note that I'm intentionally using <code>new</code> on the slice type as opposed to the usual <code>make</code>, this is becaues <code>new</code> returns an allocated pointer to the zero value of the passed in type and, I belive, the xml decoder needs the underlying type of <code>interface{}</code> fields to be pointer types as opposed to value types, which is what <code>make</code> would return. So before you use the records slice you'll need to dereference it since it is actaully a pointer.</p>\n\n<pre><code>recs := *records\n</code></pre>\n\n<p>I guess a nicer version of the above would be something like this:</p>\n\n<pre><code>resp := new(Resp)\nrecords := make([]DepartmentRecord, 0)\nresp.Records = &amp;records\nxml.Unmarshal(data, resp)\n// records is now populated and ready for use\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/FHEco6C69jw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FHEco6C69jw</a></p>\n"}], "owner": {"reputation": 127, "user_id": 4652997, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-jVwj71-9A7s/AAAAAAAAAAI/AAAAAAAAC5o/c_BOtWGbRyM/photo.jpg?sz=128", "display_name": "James Jason", "link": "https://stackoverflow.com/users/4652997/james-jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 50037994, "answer_count": 1, "score": -1, "last_activity_date": 1524736934, "creation_date": 1524687556, "question_id": 50030691, "link": "https://stackoverflow.com/questions/50030691/golang-xml-unmarshalling", "title": "Golang XML Unmarshalling", "body": "<pre><code>type Resp struct {\n     Count string `xml:\"totalRows\"`\n     Records []interface{} `xml:\"data&gt;record\"`\n}\n\ntype DepartmentRecord struct {\n     DepID string `xml:\"IDFIELD\"`\n}\n\ntype PersonRecord struct {\n     UserID string `xml:\"IDFIELD\"`\n}\n</code></pre>\n\n<p>I am looking for a way to pass into xml.Unmarshal Resp struct altered with desired Record type.</p>\n"}, {"tags": ["go", "google-admin-sdk", "google-reseller-api"], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "edited": false, "score": 0, "creation_date": 1524754742, "post_id": 50044381, "comment_id": 87108609, "body": "3-legged is no option as far as I can see. The rest we already found out but there seems to be a lack of information on how to impersonate a user using the golang client libs"}, {"owner": {"reputation": 12939, "user_id": 1503886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qbzlC.png?s=128&g=1", "display_name": "Jay Lee", "link": "https://stackoverflow.com/users/1503886/jay-lee"}, "reply_to_user": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "edited": false, "score": 0, "creation_date": 1524763052, "post_id": 50044381, "comment_id": 87113502, "body": "why is 3-legged not an option?"}, {"owner": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "edited": false, "score": 0, "creation_date": 1525265017, "post_id": 50044381, "comment_id": 87287840, "body": "because the application is deployed in kubernetes and i got no way of providing the auth token to it when being asked on stdin (or did I get something wrong?)"}, {"owner": {"reputation": 12939, "user_id": 1503886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qbzlC.png?s=128&g=1", "display_name": "Jay Lee", "link": "https://stackoverflow.com/users/1503886/jay-lee"}, "reply_to_user": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "edited": false, "score": 0, "creation_date": 1525265195, "post_id": 50044381, "comment_id": 87287964, "body": "You would provide the refresh token which can be exchanged for a fresh access token at any time <a href=\"https://developers.google.com/identity/protocols/OAuth2WebServer#offline\" rel=\"nofollow noreferrer\">developers.google.com/identity/protocols/&hellip;</a>"}], "tags": [], "owner": {"reputation": 12939, "user_id": 1503886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qbzlC.png?s=128&g=1", "display_name": "Jay Lee", "link": "https://stackoverflow.com/users/1503886/jay-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1524749583, "creation_date": 1524749583, "answer_id": 50044381, "question_id": 50029586, "link": "https://stackoverflow.com/questions/50029586/accessing-google-reseller-api-using-service-accounts/50044381#50044381", "title": "Accessing Google Reseller API using Service Accounts", "body": "<p>So few points here:</p>\n\n<ul>\n<li>Reseller API only requires impersonation / domain-wide delegation when using a service account. In other words, the service account itself has no rights to call the API directly but it does have the ability to impersonate a reseller user (e.g. admin@reseller.example.com or such) who has rights to call the Reseller API.</li>\n<li>You may be able to <a href=\"https://github.com/google/google-api-go-client/blob/master/GettingStarted.md#3-legged-oauth\" rel=\"nofollow noreferrer\">use regular 3-legged OAuth</a> instead of a service account. You just need to make sure you request offline access so that you get a refresh token that is long lived.</li>\n<li>Impersonation / domain-wide delegation is not compatible with the default service accounts built-in to AppEngine and ComputeEngine. You must use a service account you created in your API project.</li>\n</ul>\n\n<p>See if <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/blob/master/authexample_test.go\" rel=\"nofollow noreferrer\">the samples Google provides</a> get you where you need to be.</p>\n"}, {"tags": [], "owner": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "is_accepted": true, "score": 1, "last_activity_date": 1525265127, "creation_date": 1525265127, "answer_id": 50134996, "question_id": 50029586, "link": "https://stackoverflow.com/questions/50029586/accessing-google-reseller-api-using-service-accounts/50134996#50134996", "title": "Accessing Google Reseller API using Service Accounts", "body": "<p>The problem was resolved by using a different config and then setting the jwt.Subject which apparently does impersonation:</p>\n\n<pre><code>const envVar = \"GOOGLE_APPLICATION_CREDENTIALS\"\nif filename := os.Getenv(envVar); filename != \"\" {\n    serviceAccount, err := ioutil.ReadFile(filename)\n    if err != nil {\n        log.Fatal(\"creating oauth client failed\", zap.Error(err))\n    }\n    config, err := google.JWTConfigFromJSON(serviceAccount,\n        reseller.AppsOrderScope,\n    )\n\n    config.Subject = *impersonationUser // like user@google.com\n    client = config.Client(ctx)\n}\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 6135889, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hVeBA.png?s=128&g=1", "display_name": "kwiesmueller", "link": "https://stackoverflow.com/users/6135889/kwiesmueller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 0, "accepted_answer_id": 50134996, "answer_count": 2, "score": 2, "last_activity_date": 1525265127, "creation_date": 1524682808, "question_id": 50029586, "link": "https://stackoverflow.com/questions/50029586/accessing-google-reseller-api-using-service-accounts", "title": "Accessing Google Reseller API using Service Accounts", "body": "<p>We are having issues accessing the reseller api using service accounts.\nThe example with client secrets work well, but we would need to deploy this in k8s (Kubernetes Engine) without the need to refresh the oauth session on a recurring basis (especially doing this once, as it is kinda hard in a docker container).</p>\n\n<p>While there is a lot of documentation on how to do this with python we could not find any way of getting access using a service account.</p>\n\n<p>We tried two accounts, the default compute engine one and one created directly for our use case.\nBoth got the reseller scope in G Suite.</p>\n\n<pre><code>    https://www.googleapis.com/auth/apps.order,\n    https://www.googleapis.com/auth/admin.directory.user,\n    https://www.googleapis.com/auth/siteverification,\n</code></pre>\n\n<p>We keep getting <code>\"googleapi: Error 403: Authenticated user is not authorized to perform this action., insufficientPermissions\"</code> errors though when using</p>\n\n<pre><code>    client, err = google.DefaultClient(ctx, reseller.AppsOrderScope)\n    if err != nil {\n        log.Fatal(\"creating oauth client failed\", zap.Error(err))\n    }\n    subs, err := client.Subscriptions.List().Do()\n    if err != nil {\n        log.Fatal(\"listing subscriptions failed\", zap.Error(err))\n    }\n</code></pre>\n\n<p>I read on a post on StackOverflow, that the Reseller API requires user impersonation but searching on this throughout Google and the oauth2 and client lib repos did not result in a way to do this.\nPython does this like described in the End-to-End Tutorial</p>\n\n<pre><code>    credentials = ServiceAccountCredentials.from_json_keyfile_name(\n        JSON_PRIVATE_KEY_FILE, \n    OAUTH2_SCOPES).create_delegated(RESELLER_ADMIN_USER)\n</code></pre>\n\n<p>but for Go i could not find any documented way of doing this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3201, "user_id": 1875092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1182c2dfe8c91c9623e09d6c8fdf87b0?s=128&d=identicon&r=PG", "display_name": "jsageryd", "link": "https://stackoverflow.com/users/1875092/jsageryd"}, "edited": false, "score": 0, "creation_date": 1524682861, "post_id": 50029425, "comment_id": 87075232, "body": "Are you able to clarify why you are not able to return after the first error? Why do you need to continue on to the next thing in <code>DecodeMessage</code> after the first error?"}, {"owner": {"reputation": 259, "user_id": 5631039, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/03a7c72afaaea1bc33f12d411265d8b0?s=128&d=identicon&r=PG&f=1", "display_name": "gel", "link": "https://stackoverflow.com/users/5631039/gel"}, "reply_to_user": {"reputation": 3201, "user_id": 1875092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1182c2dfe8c91c9623e09d6c8fdf87b0?s=128&d=identicon&r=PG", "display_name": "jsageryd", "link": "https://stackoverflow.com/users/1875092/jsageryd"}, "edited": false, "score": 0, "creation_date": 1524683020, "post_id": 50029425, "comment_id": 87075335, "body": "How would I do that? Could I just use return as normally?"}, {"owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "edited": false, "score": 0, "creation_date": 1524683226, "post_id": 50029425, "comment_id": 87075451, "body": "Yes. This sort of pattern is pretty common and otherwise looks pretty similar to your typical Go pattern of <code>if err != nil { return err }</code>"}, {"owner": {"reputation": 259, "user_id": 5631039, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/03a7c72afaaea1bc33f12d411265d8b0?s=128&d=identicon&r=PG&f=1", "display_name": "gel", "link": "https://stackoverflow.com/users/5631039/gel"}, "edited": false, "score": 0, "creation_date": 1524683315, "post_id": 50029425, "comment_id": 87075498, "body": "But I read this: <a href=\"https://stackoverflow.com/questions/20945069/catching-return-values-from-goroutines\" title=\"catching return values from goroutines\">stackoverflow.com/questions/20945069/&hellip;</a>, which says it&#39;s a bad id&#233;a."}, {"owner": {"reputation": 3201, "user_id": 1875092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1182c2dfe8c91c9623e09d6c8fdf87b0?s=128&d=identicon&r=PG", "display_name": "jsageryd", "link": "https://stackoverflow.com/users/1875092/jsageryd"}, "edited": false, "score": 0, "creation_date": 1524683986, "post_id": 50029425, "comment_id": 87075806, "body": "@gel If you had a normal function, would you continue processing even after the first error? If not, don&#39;t do it here either. Pass the error on the channel and return. Or perhaps better yet -- avoid the channel altogether in <code>DecodeMessage</code> and handle the channel sending outside of that function. Might make it easier to test it as well."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 3600716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcf75d8900076a133d2394ea3980cc69?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Poscidonio", "link": "https://stackoverflow.com/users/3600716/gustavo-poscidonio"}, "is_accepted": false, "score": 0, "last_activity_date": 1524691383, "creation_date": 1524691383, "answer_id": 50031559, "question_id": 50029425, "link": "https://stackoverflow.com/questions/50029425/handle-multiple-errors-from-a-single-channel/50031559#50031559", "title": "Handle multiple errors from a single channel", "body": "<p>I'll start by saying that having to go through all the error checks for a function before returning even if they fail is a bit of a code smell. It <em>might</em> mean that you have something weird going on and there may be a better way to accomplish what you're trying to do.</p>\n\n<p>However, assuming that you've boiled down your problem to this, then I see two options, depending on how the errors have to be handled.</p>\n\n<p>If the errors can be handled one-by-one and don't really rely on each other, then you can just create an error channel and send them back one by one as you encounter the errors. See the following working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    errCh := make(chan error)\n    go HandleErrorsSerially(\"bad error\", errCh)\n    for err := range errCh {\n        fmt.Printf(\"Found error serially: %v\\n\", err)\n    }\n}\n\nfunc HandleErrorsSerially(msg string, errCh chan&lt;- error) {\n    if strings.Contains(msg, \"error\") {\n        errCh &lt;- errors.New(\"message contained string 'error'\")\n    }\n    if strings.Contains(msg, \"bad\") {\n        errCh &lt;- errors.New(\"message contained string 'bad'\")\n    }\n    close(errCh)\n}\n</code></pre>\n\n<p>Alternatively, if you need to have a view of all the errors that occurred all at once (because two errors happening simultaneously may indicate some special circumstances) then you'd have to append them all to an array and then pass them through a channel. See the following working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    errArrCh := make(chan []error)\n    go HandleErrorsTogether(\"bad error\", errArrCh)\n    errArr := &lt;-errArrCh\n    fmt.Printf(\"Found the following errors together: %v\\n\", errArr)\n}\n\nfunc HandleErrorsTogether(msg string, errArrCh chan&lt;- []error) {\n    errArr := make([]error, 0)\n    if strings.Contains(msg, \"error\") {\n        errArr = append(errArr, errors.New(\"message contained string 'error'\"))\n    }\n    if strings.Contains(msg, \"bad\") {\n        errArr = append(errArr, errors.New(\"message contained string 'bad'\"))\n    }\n    errArrCh &lt;- errArr\n    close(errArrCh)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 0, "last_activity_date": 1524693072, "creation_date": 1524693072, "answer_id": 50031868, "question_id": 50029425, "link": "https://stackoverflow.com/questions/50029425/handle-multiple-errors-from-a-single-channel/50031868#50031868", "title": "Handle multiple errors from a single channel", "body": "<p>I can see cases where it's useful to return multiple errors, such as when you are parsing messages and there are multiple bad fields and you need to summarise these back to a client.</p>\n\n<p>I think the best approach is to use a package like <a href=\"https://github.com/hashicorp/go-multierror\" rel=\"nofollow noreferrer\">hashicorp's multierror</a> which allows multiple errors to be collected with formatting in a structure type that implements error interface and so can still be sent on a <code>chan error</code>. The receive side can then either process as just a standard error or extract the information on each individual error.</p>\n\n<p>The multierror documentation is pretty good, just read through the examples on the github page.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6789898, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lJBzCnlI8qE/AAAAAAAAAAI/AAAAAAAAB-M/gYHIps2Lm6A/photo.jpg?sz=128", "display_name": "\u6797\u5b50\u7bc6", "link": "https://stackoverflow.com/users/6789898/%e6%9e%97%e5%ad%90%e7%af%86"}, "is_accepted": false, "score": 0, "last_activity_date": 1524714322, "creation_date": 1524714322, "answer_id": 50034503, "question_id": 50029425, "link": "https://stackoverflow.com/questions/50029425/handle-multiple-errors-from-a-single-channel/50034503#50034503", "title": "Handle multiple errors from a single channel", "body": "<blockquote>\n  <p>The best thing, for me, is that the routine would exit on an error and\n  return that error like it would do \"normally\".</p>\n</blockquote>\n\n<p>Of course, you can, and get last error or all error are both pretty strange.</p>\n\n<ol>\n<li>Get last error is unhelpful for debugging, compare with getting first error.</li>\n<li>Get all error is same if the first error will cause the following failure, the following error message is unhelpful; Another situation is these errors <em>do not</em> have the association, I think this means you have to sperate they into different concurrency part for better controlling.</li>\n</ol>\n\n<p>Ok, now back to original problem. Consider the code:</p>\n\n<pre><code>func foo(errTo chan error) {\n    defer close(errTo)\n    v, err := CouldFailOne()\n    if err != nil {\n        errTo &lt;- err\n        return // Yp, just stop this routine, let it join back to Invoker\n    }\n    v2, err := CloudFailTwo()\n    if err != nil {\n        errTo &lt;- err\n        return\n    }\n    // As the previous error handle until end of the function\n}\n</code></pre>\n\n<p>If you want to return value from this kind of function. Just use a channel, and send the value into it only no error raise. I think this style will be more clear and like return style, just became using a channel to return the error.</p>\n"}], "owner": {"reputation": 259, "user_id": 5631039, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/03a7c72afaaea1bc33f12d411265d8b0?s=128&d=identicon&r=PG&f=1", "display_name": "gel", "link": "https://stackoverflow.com/users/5631039/gel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 451, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1524714322, "creation_date": 1524682211, "last_edit_date": 1524682647, "question_id": 50029425, "link": "https://stackoverflow.com/questions/50029425/handle-multiple-errors-from-a-single-channel", "title": "Handle multiple errors from a single channel", "body": "<p>I have some trouble with go routines and channels regarding error handling.</p>\n\n<p>Firstly I have a function that listen for messages (in a infinite for loop):</p>\n\n<pre><code>func main() {\n\n    messageChannel := make(chan messageHandler.MessageInfo)\n\n    for {\n        if token := client.Subscribe(\"#\", 0, func(client MQTT.Client, msg MQTT.Message) {\n            go messageHandler.DecodeMessage(msg, messageChannel)\n            select {\n            case messageInfo := &lt;-messageChannel:\n                //Handle\n            }\n\n        }); token.Wait() &amp;&amp; token.Error() != nil {\n            fmt.Println(token.Error())\n        }\n    }\n\n\n}\n</code></pre>\n\n<p>But in the DecodeMessage function, there could arise multiple errors.  </p>\n\n<pre><code>func DecodeMessage(msg mqtt.Message, c1 chan MessageInfo) {\n\n    //do something, might result in error\n\n    //do another thing, might result in error\n\n    c1 &lt;- MessageInfo{...}\n}\n</code></pre>\n\n<p>Normally I would just return from the function. But seems a bit trickier with routines. I've looked at <a href=\"https://stackoverflow.com/questions/25142016/return-error-from-the-channel\">this post</a>, but if both errors would occur, I would only see the last error message. </p>\n\n<p>Example:</p>\n\n<pre><code>func DecodeMessage(msg mqtt.Message, c1 chan MessageInfo) {\n\n    var returnError error\n\n    if err != nil {\n        returnError = err\n    }\n\n    if err != nil {\n        returnError = err\n    }\n\n    c1 &lt;- MessageInfo{\n        Error: returnError,\n        ...\n    }\n}\n</code></pre>\n\n<p>Should I have an array of some sort and append all errors? Is it bad practice to have multiple errors in one routine? </p>\n\n<p>The best thing, for me, is that the routine would exit on an error and return that error like it would do \"normally\". Is that possible?</p>\n"}, {"tags": ["arrays", "go", "slice", "sudoku"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1524682162, "post_id": 50029237, "comment_id": 87074847, "body": "Arrays like [9]int and slices like []int arer different types in Go. Take the Tour of Go."}, {"owner": {"reputation": 13, "user_id": 6832455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d772c1d4b7ec882bb664b1a8fc5602f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbadrawy", "link": "https://stackoverflow.com/users/6832455/zbadrawy"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524685908, "post_id": 50029237, "comment_id": 87076667, "body": "took the tour. What I don&#39;t understand is what alternative. I want a slice to contain the values of one column of the 2d array. How can I do this considering the above method failed."}], "answers": [{"tags": [], "owner": {"reputation": 1045, "user_id": 199249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2cc78b8cc4d17b7461776d266ea3db6?s=128&d=identicon&r=PG", "display_name": "nojo", "link": "https://stackoverflow.com/users/199249/nojo"}, "is_accepted": true, "score": 0, "last_activity_date": 1524687828, "creation_date": 1524687828, "answer_id": 50030763, "question_id": 50029237, "link": "https://stackoverflow.com/questions/50029237/cant-make-a-slice-of-a-column-of-a-2d-array-cannot-use-sudoku090-type-9/50030763#50030763", "title": "Can&#39;t make a slice of a column of a 2d array &quot;cannot use Sudoku[0:9][0] (type [9]int) as type []int in assignment&quot;", "body": "<p><code>var col1 []int = Sudoku[0:9][0]</code> gets you an array, not a slice.  You could either declare as <code>var col1 [9]int = Sudoku[0:9][0]</code> (or better: <code>col1 := Sudoku[0:9][0]</code>), or if you really want a slice: <code>var col1Slice []int = col1[:]</code> after getting col1.</p>\n\n<p>In general, things would be much easier if your sudoku structure were a 2D slice instead of 2D array, then you'd be dealing with only slices.</p>\n\n<p>Working example of all of these:\n<a href=\"https://play.golang.org/p/LE8qwFSy1m_e\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LE8qwFSy1m_e</a></p>\n"}], "owner": {"reputation": 13, "user_id": 6832455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d772c1d4b7ec882bb664b1a8fc5602f?s=128&d=identicon&r=PG&f=1", "display_name": "Zbadrawy", "link": "https://stackoverflow.com/users/6832455/zbadrawy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 50030763, "answer_count": 1, "score": -2, "last_activity_date": 1524688382, "creation_date": 1524681548, "last_edit_date": 1524688382, "question_id": 50029237, "link": "https://stackoverflow.com/questions/50029237/cant-make-a-slice-of-a-column-of-a-2d-array-cannot-use-sudoku090-type-9", "title": "Can&#39;t make a slice of a column of a 2d array &quot;cannot use Sudoku[0:9][0] (type [9]int) as type []int in assignment&quot;", "body": "<p>I'm making a simple game of sudoku using slices of a 9x9 2d array. I'm still starting out with Golang and have some C++ experience. I keep getting the error message \"cannot use Sudoku[0:9][0] (type [9]int) as type []int in assignment\".</p>\n\n<p>var row1 []int = Sudoku[0][0:9]\nThis line correctly took the values of the first row of the 2d array and placed them into the row1 slice, but using var col1 []int = Sudoku[0:9][0] results in the error message above. What can I do? Thanks in advance!</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var Sudoku [9][9]int\n    fmt.Println(Sudoku)\n    var row1 []int = Sudoku[0][0:9]\n    fmt.Println(row1)\n    var col1 []int = Sudoku[0:9][0]\n    fmt.Println(col1)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Jk6sqqXR5VE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Jk6sqqXR5VE</a></p>\n\n<pre><code>10:6: cannot use Sudoku[0:9][0] (type [9]int) as type []int in assignment\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1524679337, "post_id": 50028567, "comment_id": 87073427, "body": "Do you really need this mapping? The most idiomatic way to expose functionality in Go would be to use interfaces to only expose the public contract of your objects without leaking implementation details."}, {"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1524679531, "post_id": 50028567, "comment_id": 87073513, "body": "Yes I do, I have to change the shape of the objects."}, {"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1524681414, "post_id": 50028567, "comment_id": 87074474, "body": "@SirDarius For example, there is struct with a collection that has another collection.  I need to remove 1 layer of the collections and merge some fields."}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": false, "score": 0, "last_activity_date": 1524682386, "creation_date": 1524682386, "answer_id": 50029478, "question_id": 50028567, "link": "https://stackoverflow.com/questions/50028567/trying-to-map-a-struct-to-my-exposed-api-struct/50029478#50029478", "title": "Trying to map a struct to my exposed API struct", "body": "<p><code>range</code> will work fine for what you want to do. The code below is non-specific and can be generalized to your use case.</p>\n\n<pre><code>func mapLocationsToModifiedLocations(user User) []ModifiedLocation {\n    // initialize a new slice with the type of your API-appropriate output\n    // and a length of zero\n    var output := make([]ModifiedLocation, 0)\n\n    // iterate over your input data\n    for _, element := range user.Locations {\n        // use append to automatically re-size the output array as needed\n        output = append(output, modifyLocation(location))\n    }\n\n    return output\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1524689326, "post_id": 50029768, "comment_id": 87078245, "body": "Why do you do len() 2 times? one is for the size of the array, the other?"}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1524690213, "post_id": 50029768, "comment_id": 87078662, "body": "Capacity. Slice has length and capacity"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1524683558, "creation_date": 1524683558, "answer_id": 50029768, "question_id": 50028567, "link": "https://stackoverflow.com/questions/50028567/trying-to-map-a-struct-to-my-exposed-api-struct/50029768#50029768", "title": "Trying to map a struct to my exposed API struct", "body": "<p>Allocate first then loop for range</p>\n\n<pre><code>func mapUserToApi(user User) UserApi {\n  api := &amp;UserApi{\n     Id: user.Id,\n     Locations: make([]LocationApi, len(user.Locations), len(user.Locations)),\n  }\n\n  for index, location := range user.Locations {\n    api.Locations[index] = mapLocationToApi(location)\n  }\n\n  return api\n}\n</code></pre>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 50029768, "answer_count": 2, "score": 0, "last_activity_date": 1524683558, "creation_date": 1524679000, "question_id": 50028567, "link": "https://stackoverflow.com/questions/50028567/trying-to-map-a-struct-to-my-exposed-api-struct", "title": "Trying to map a struct to my exposed API struct", "body": "<p>I am writing mapping functions that map my internal models to those that I will expose in my API.</p>\n\n<p>How do I map the Locations property.  Do I range over them? Do I have to init the UserApi locations first? </p>\n\n<p>I little confused on how to best do this without having any nil exceptions etc.  </p>\n\n<pre><code>func mapUserToApi(user User) UserApi {\n  api := &amp;UserApi{\n     Id: user.Id,\n     ..\n     ..\n  }\n\n  for index, location := range user.Locations {\n    /// ????????????\n  }\n\n  return api\n}\n\nfunc mapLocationToApi(location Locatio) LocationApi {\n  ..\n}\n\n\ntype User struct {\n  Id int\n\n  Locations []Location\n}\n\ntype UserApi struct {\n  Id int\n\n  Locations []LocationApi\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524673452, "post_id": 50027041, "comment_id": 87070373, "body": "Are package main and package api within files that are in the same directory?"}, {"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524673668, "post_id": 50027041, "comment_id": 87070513, "body": "yes, all my files currently are in the main directory using package main.  Since I want my api models to be named the same I need to seperate them into diff packages"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524674241, "post_id": 50027041, "comment_id": 87070802, "body": "You can&#39;t have different packages in the same directory. package is pretty synonymous with directory. Your api models would need to go in <code>.&#47;api&#47;model.go</code> and the main package could live in <code>.&#47;main.go</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1524675083, "post_id": 50027041, "comment_id": 87071197, "body": "Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to write Go code</a>. This document describes how to organize code into packages and use those packages."}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": true, "score": 1, "last_activity_date": 1524685494, "creation_date": 1524685494, "answer_id": 50030204, "question_id": 50027041, "link": "https://stackoverflow.com/questions/50027041/how-to-manage-mapping-models-in-a-rest-api/50030204#50030204", "title": "How to manage mapping models in a REST API", "body": "<p>As others have noted, what you want to do is simply not possible under the same package, and is likely to cause confusion even under different packages. If you want to go ahead and do the latter anyways, you should have a folder called <code>api</code> and you can put <code>user.go</code> inside of it. A sample folder structure then looks like this:</p>\n\n<pre><code>main.go // package main\nuser.go // package main\n/api\n  user.go // package api\n</code></pre>\n\n<p>For what it's worth, when I design an API I'll typically have a struct <code>User</code> in package <code>model</code>, and a struct <code>UserResponse</code> in package <code>handler</code>. For endpoints that take data, they'll also have a <code>UserRequest</code> struct associated with them as well. This makes clear what their purpose is regardless of what package they're being referenced in.</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 50030204, "answer_count": 1, "score": -1, "last_activity_date": 1524685494, "creation_date": 1524673320, "last_edit_date": 1524673989, "question_id": 50027041, "link": "https://stackoverflow.com/questions/50027041/how-to-manage-mapping-models-in-a-rest-api", "title": "How to manage mapping models in a REST API", "body": "<p>I have a REST API, and for each response I need to map my core models to models I am going to expose in the REST service.</p>\n\n<p>I want to name the models the same, like:</p>\n\n<pre><code>package main \n\ntype User struct {\n  Name string\n  Password string\n}\n</code></pre>\n\n<p>And the User struct I want to expose in my API:</p>\n\n<pre><code>type User struct {\n  Name string\n}\n</code></pre>\n\n<p>How do I organize my code so that I don't get name collisions, because when I try this I get an error:</p>\n\n<blockquote>\n  <p>previous declaration at</p>\n</blockquote>\n\n<p>If I change the package for my API struct to:</p>\n\n<pre><code>package api\ntype User struct { ... }\n</code></pre>\n\n<p>I get another error </p>\n\n<blockquote>\n  <p>can't load package: package ... found package main and api</p>\n</blockquote>\n\n<p>If I am able to seperate the models, how will I reference the other package's model:</p>\n\n<pre><code>func mapUserToApi(user User) api.User {\n}\n</code></pre>\n\n<p><strong>So I want to take as a parameter the main.User and return the api.User.</strong></p>\n"}, {"tags": ["windows", "go", "disk-partitioning"], "comments": [{"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524673902, "post_id": 50025838, "comment_id": 87070630, "body": "I assume you want to know this for Windows only and that the usage of a package is not a problem?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1524673903, "post_id": 50025838, "comment_id": 87070631, "body": "in windows we can use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb968800(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>IOCTL_STORAGE_GET_DEVICE_NUMBER</code></a> for get device(disk) number. how/are possible use this in go separate question"}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524677728, "post_id": 50025838, "comment_id": 87072590, "body": "@Dippo yep. I tried to find some pkg of golang, but doesn&#39;t work."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524681914, "post_id": 50025838, "comment_id": 87074722, "body": "@Zander Wong I also didn&#39;t find a package but i did found out that you can enter this one in the command line, this works for win 7, 8 and 10: wmic logicaldisk get name"}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 1, "creation_date": 1524682248, "post_id": 50025838, "comment_id": 87074896, "body": "@Zander Wong I think i found a package : <a href=\"https://github.com/StackExchange/wmi\" rel=\"nofollow noreferrer\">github.com/StackExchange/wmi</a>"}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524722445, "post_id": 50025838, "comment_id": 87087539, "body": "@Dippo this command just list partitions of my hard-disk not the disk numbers."}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524724401, "post_id": 50025838, "comment_id": 87088497, "body": "@Dippo Thx Very Much!   I just tested the pkg <code>wmi</code>.       It works! Thx again."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 1, "creation_date": 1524765815, "post_id": 50025838, "comment_id": 87114857, "body": "@Zander Wong You are right that partitios are still visible as a drive, i was wrong because i don&#39;t have any partitions. But i found on this website (<a href=\"https://ardamis.com/2012/08/21/getting-a-list-of-logical-and-physical-drives-from-the-command-line/\" rel=\"nofollow noreferrer\">ardamis.com/2012/08/21/&hellip;</a>) a query that solves your problem."}, {"owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524841536, "post_id": 50025838, "comment_id": 87147122, "body": "@Dippo  I fount a command line to get hard-disk index.  <code>$ wmic diskdrive get index</code>"}], "owner": {"reputation": 441, "user_id": 7022570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc0519d31ed01850ea8f6940aee08fa?s=128&d=identicon&r=PG&f=1", "display_name": "Zander Wong", "link": "https://stackoverflow.com/users/7022570/zander-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1022, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525875446, "creation_date": 1524669349, "last_edit_date": 1525875446, "question_id": 50025838, "link": "https://stackoverflow.com/questions/50025838/how-do-you-get-the-numbers-of-hard-disk-not-partitions-on-windows-in-golang", "title": "How do you get the numbers of hard disk (not partitions!) on Windows in golang?", "body": "<p>This question is different from <a href=\"https://stackoverflow.com/questions/23128148/how-can-i-get-a-listing-of-all-drives-on-windows-using-golang\">How can I get a listing of all drives on Windows using golang?</a></p>\n\n<p>I know how get the partitions of hard disk, but what about the numbers of hard disk?\nI tried using <code>diskpark</code> but don't like it.<br>\n<a href=\"https://i.stack.imgur.com/cBxTv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cBxTv.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there some native go way to implement?</p>\n\n<p>@Dippo saids: I think i found a package : <a href=\"https://github.com/StackExchange/wmi\" rel=\"nofollow noreferrer\">https://github.com/StackExchange/wmi</a></p>\n\n<p>And it works .\nThx all.  </p>\n\n<p>Here the code is.   </p>\n\n<p>Gopkg.toml:    </p>\n\n<p><code>required = [\"github.com/stackexchange/wmi\"]</code>   </p>\n\n<p>and the go code:   </p>\n\n<pre><code>func getDiskDrivers() uint8 {\n    type Win32_DiskDrive struct {\n        Caption      string\n        Name         string\n        DeviceID     string\n        Model        string\n        Index        int\n        Partitions   int\n        Size         int\n        PNPDeviceID  string\n        Status       string\n        SerialNumber string\n        Manufacturer string\n        MediaType    string\n        Description  string\n        SystemName   string\n    }\n\n    var dst []Win32_DiskDrive\n\n    query := wmi.CreateQuery(&amp;dst, \"\")\n    if err := wmi.Query(query, &amp;dst); err != nil {\n        log.Println(err.Error())\n        return 0\n    }\n\n    //for key, value := range dst {\n    //  log.Println(fmt.Sprintf(`Disk%d: %v`, key+1, value))\n    //}\n\n    return uint8(len(dst))\n}\n</code></pre>\n"}, {"tags": ["ios", "go", "clang", "cocoapods", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 289, "user_id": 5456612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-h3gOyj8CNgY/AAAAAAAAAAI/AAAAAAAAAiQ/3Jy9aCOOyYQ/photo.jpg?sz=128", "display_name": "Matti", "link": "https://stackoverflow.com/users/5456612/matti"}, "is_accepted": false, "score": 0, "last_activity_date": 1524821817, "last_edit_date": 1524821817, "creation_date": 1524731660, "answer_id": 50038396, "question_id": 50024087, "link": "https://stackoverflow.com/questions/50024087/gomobile-bind-producing-library-with-pie-disabled-i386-arch/50038396#50038396", "title": "Gomobile bind producing library with &quot;PIE disabled&quot; / i386 arch", "body": "<p>Apparently this fixes (suppresses) the error:</p>\n\n<pre><code>spec.pod_target_xcconfig = {\n    \"OTHER_LDFLAGS[arch=i386]\" =&gt; \"-Wl,-read_only_relocs,suppress\"\n}\n</code></pre>\n\n<p>I still get the PIE warning but the error is gone and the pod is pushed to the repository ok.</p>\n\n<p>I wonder if Apple will have a beef with a binary missing PIE when pushing to App Store?</p>\n"}], "owner": {"reputation": 289, "user_id": 5456612, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-h3gOyj8CNgY/AAAAAAAAAAI/AAAAAAAAAiQ/3Jy9aCOOyYQ/photo.jpg?sz=128", "display_name": "Matti", "link": "https://stackoverflow.com/users/5456612/matti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524821817, "creation_date": 1524664264, "question_id": 50024087, "link": "https://stackoverflow.com/questions/50024087/gomobile-bind-producing-library-with-pie-disabled-i386-arch", "title": "Gomobile bind producing library with &quot;PIE disabled&quot; / i386 arch", "body": "<p>I've used the gomobile bind tool to build my Go library for use in an iOS app. I've wrapped my library into a Cocoapods .podspec. It works nicely in the simulator (via a local development pod), but when I try to do <code>pod lib lint</code> (part step, part of releasing a cocoapod) I run into errors:</p>\n\n<p>Error:</p>\n\n<pre><code> ld: illegal text-relocation to 'runtime.rodata' in /Users/matti/src/foobar-sdk-ios/Frameworks/Client.framework/Client(go.o) from 'sync/atomic.(*Value).Store' in /Users/matti/src/foobar-sdk-ios/Frameworks/Client.framework/Client(go.o) for architecture i386\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n</code></pre>\n\n<p>Warning:</p>\n\n<pre><code>- NOTE  | [iOS] [FooBarSDK/Go] xcodebuild:  ld: warning: PIE disabled. Absolute addressing (perhaps -mdynamic-no-pic) not allowed in code signed PIE, but used in sync/atomic.(*Value).Store from /Users/matti/src/foobar-sdk-ios/Frameworks/Client.framework/Client(go.o). To fix this warning, don't compile with -mdynamic-no-pic or link with -Wl,-no_pie\n</code></pre>\n\n<p>It seems to link for other architectures. I couldnt figure out how to skip i386 - even though I override VALID_ARCHS - and I guess it wouldnt be the proper solution anyway. </p>\n\n<p>So instead I'd like to know how to build a proper binary out of my Go code - I tried supplying -ldflags=\"-extldflags=-pie\" to the gomobile bind command but I am assuming its more of a compilation issue. I know there is -buildmode=pie available for go build, but only for main packages and also not for gomobile bind.</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1524659021, "post_id": 50022088, "comment_id": 87060376, "body": "Are you certain this is the code you&#39;re running?: <a href=\"https://play.golang.org/p/wHQ3M5CHH53\" rel=\"nofollow noreferrer\">play.golang.org/p/wHQ3M5CHH53</a>"}, {"owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524659704, "post_id": 50022088, "comment_id": 87060913, "body": "ahh, cool, I&#39;m running on OSX ( go version go1.9.4 darwin/amd64) and if I run on Linux it runs fine. So it seems like it is issue with Go on OSX only. Can someone try to run this snippet on OSX and verify if it is the case"}, {"owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524660882, "post_id": 50022088, "comment_id": 87061825, "body": "yes, you&#39;re right, if I change code to use location it works as expected"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524661144, "post_id": 50022088, "comment_id": 87062033, "body": "Yes, it&#39;s safer to always specify locations. <code>time.Unix</code> sets <code>time.Local</code> -- maybe it shouldn&#39;t but probably not something that can be changed at this point. I think it should be at least specified in the docs."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524662461, "post_id": 50022088, "comment_id": 87063010, "body": "@JimB: Beware of using the Go playground for package <code>time</code> code examples. The playground has special properties: &quot;In the playground the time begins at 2009-11-10 23:00:00 UTC.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1524660990, "post_id": 50022729, "comment_id": 87061907, "body": "Since unix timestamps are UTC, shouldn&#39;t <code>time.Unix</code> use <code>time.UTC</code> rather than the local location?"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524661473, "post_id": 50022729, "comment_id": 87062279, "body": "@JimB: It seems to me that the code is working as expected. See the documentation. <code>Parse</code> returns UTC and <code>Unix</code> returns Local."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1524661506, "post_id": 50022729, "comment_id": 87062306, "body": "Yup, thanks, I read that a few times and missed &quot;returns the local Time&quot; every time."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 9, "last_activity_date": 1524665297, "last_edit_date": 1524665297, "creation_date": 1524660275, "answer_id": 50022729, "question_id": 50022088, "link": "https://stackoverflow.com/questions/50022088/time-conversion-issue-in-go-language/50022729#50022729", "title": "Time conversion issue in go language", "body": "<p>It is because of the difference between your local time zone and UTC. <code>Parse</code> returned UTC time and <code>Unix</code> returned local time. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc unix2Str(ts int64) string {\n    const layout = \"20060102\"\n    t := time.Unix(ts, 0)\n    fmt.Println(t)\n    return t.Format(layout)\n}\n\nfunc unixTime(ts string) int64 {\n    const layout = \"20060102\"\n    t, err := time.Parse(layout, ts)\n    if err != nil {\n        fmt.Println(err)\n        return 0\n    }\n    fmt.Println(t)\n    return t.Unix()\n}\n\nfunc main() {\n    ts1 := \"20110320\"\n    ts2 := \"20110321\"\n\n    ut1 := unixTime(ts1)\n    ut2 := unixTime(ts2)\n\n    fmt.Println(ts1, ut1, unix2Str(ut1))\n    fmt.Println(ts2, ut2, unix2Str(ut2))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2011-03-20 00:00:00 +0000 UTC\n2011-03-21 00:00:00 +0000 UTC\n2011-03-19 20:00:00 -0400 EDT\n20110320 1300579200 20110319\n2011-03-20 20:00:00 -0400 EDT\n20110321 1300665600 20110320\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">func Parse</a></p>\n\n<pre><code>func Parse(layout, value string) (Time, error)\n</code></pre>\n  \n  <p>Parse parses a formatted string and returns the time value it\n  represents. The layout defines the format by showing how the reference\n  time, defined to be</p>\n\n<pre><code>Mon Jan 2 15:04:05 -0700 MST 2006\n</code></pre>\n  \n  <p>would be interpreted if it were the value; it serves as an example of\n  the input format. The same interpretation will then be made to the\n  input string.</p>\n  \n  <p>In the absence of a time zone indicator, Parse returns a time in UTC.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/#Time.Unix\" rel=\"nofollow noreferrer\">func Unix</a></p>\n\n<pre><code>func Unix(sec int64, nsec int64) Time\n</code></pre>\n  \n  <p>Unix returns the local Time corresponding to the given Unix time, sec\n  seconds and nsec nanoseconds since January 1, 1970 UTC.</p>\n</blockquote>\n"}], "owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 2, "accepted_answer_id": 50022729, "answer_count": 1, "score": 6, "last_activity_date": 1524665297, "creation_date": 1524658455, "question_id": 50022088, "link": "https://stackoverflow.com/questions/50022088/time-conversion-issue-in-go-language", "title": "Time conversion issue in go language", "body": "<p>I'm trying to understand the issue with time conversion in Go language. Here is code example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc unix2Str(ts int64) string {\n    const layout = \"20060102\"\n    t := time.Unix(ts, 0)\n    return t.Format(layout)\n}\n\nfunc unixTime(ts string) int64 {\n    const layout = \"20060102\"\n    t, err := time.Parse(layout, ts)\n    if err != nil {\n            fmt.Println(err)\n            return 0\n    }\n    return t.Unix()\n}\nfunc main() {\n    ts1 := \"20110320\"\n    ts2 := \"20110321\"\n\n    ut1 := unixTime(ts1)\n    ut2 := unixTime(ts2)\n\n    fmt.Println(ts1, ut1, unix2Str(ut1))\n    fmt.Println(ts2, ut2, unix2Str(ut2))\n}\n</code></pre>\n\n<p>It prints the following output:</p>\n\n<pre><code>20110320 1300579200 20110319\n20110321 1300665600 20110320\n</code></pre>\n\n<p>But since I do the conversion from string format to Unix and reverse I would expect the same results for the date in string format. But it is not the case. In fact, the printed unix time <code>1300579200</code> is converted in python to original date I started with, e.g.</p>\n\n<pre><code>&gt;&gt;&gt; time.strftime(\"%Y%m%d\", time.gmtime(1300579200))\n'20110320'\n</code></pre>\n\n<p>Is it a bug in Go code or am I missing something?</p>\n"}, {"tags": ["go", "server", "client"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1524657732, "post_id": 50021730, "comment_id": 87059347, "body": "TCP connections cannot be sustained if one end crashes. You need an application-layer reconnection capability."}, {"owner": {"reputation": 4500, "user_id": 549007, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3342c97dcb4c2c07a22f016614bb9eaf?s=128&d=identicon&r=PG", "display_name": "insumity", "link": "https://stackoverflow.com/users/549007/insumity"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1524657903, "post_id": 50021730, "comment_id": 87059476, "body": "Yes, that&#39;s what I&#39;m trying to do. The server can just accept a new client on the fly."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1524674746, "post_id": 50021730, "comment_id": 87071034, "body": "So far i know, you cant read and write that easily. You must write and close the connection for acknowledgement, then re-open the connection and read and wait for the other side to close the connection for acknowledgement."}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1524666328, "last_edit_date": 1524666328, "creation_date": 1524662725, "answer_id": 50023582, "question_id": 50021730, "link": "https://stackoverflow.com/questions/50021730/fix-faulty-connections-in-go/50023582#50023582", "title": "Fix faulty connections in Go", "body": "<p>Maybe just check for errors, something like this</p>\n\n<pre><code>func connect(addr string)(*bufio.Reader, *bufio.Writer, Error){\n    conn, err := net.Dial(\"tcp\", addr)  reader := bufio.NewReader(conn)\n    if err != nill{\n        return(nil, nil, err)\n    }\n    writer := bufio.NewWriter(conn)\n    reader := bufio.NewReader(conn)\n    return(reader, writer, nil)\n}\nfor reader, writer, err := connect(adrr);;{\n    if err !=nil {\n        reader, writer, err = connect(adrr)\n        continue\n    }\n    _, err = writer.write(data)\n    err = reader.read()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1524797939, "creation_date": 1524797939, "answer_id": 50054560, "question_id": 50021730, "link": "https://stackoverflow.com/questions/50021730/fix-faulty-connections-in-go/50054560#50054560", "title": "Fix faulty connections in Go", "body": "<p>Here's one way:</p>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"sync\"\n    \"time\"\n)\n\ntype ReconnectingWriter struct {\n    Dialer func() (net.Conn, error)\n\n    mu   sync.RWMutex\n    conn net.Conn\n}\n\nfunc NewReconnectingWriter(dialer func() (net.Conn, error)) *ReconnectingWriter {\n    return &amp;ReconnectingWriter{Dialer: dialer}\n}\n\nfunc (rw *ReconnectingWriter) getConn() (net.Conn, error) {\n    rw.mu.RLock()\n    conn := rw.conn\n    rw.mu.RUnlock()\n\n    if conn != nil {\n        return conn, nil\n    }\n\n    rw.mu.Lock()\n    defer rw.mu.Unlock()\n\n    var err error\n    if rw.conn == nil {\n        rw.conn, err = rw.Dialer()\n    }\n\n    return rw.conn, err\n}\n\nfunc (rw *ReconnectingWriter) closeConn() {\n    rw.mu.Lock()\n    defer rw.mu.Unlock()\n\n    if rw.conn != nil {\n        rw.conn.Close()\n        rw.conn = nil\n    }\n}\n\nfunc (rw *ReconnectingWriter) Write(b []byte) (int, error) {\n    for i := 0; ; i++ {\n        if i &gt; 0 {\n            time.Sleep(time.Second) // replace this with exp backoff + jitter\n        }\n\n        // try to get a connection\n        conn, err := rw.getConn()\n        if err != nil {\n            continue\n        }\n\n        // try to write the data\n        n, err := conn.Write(b)\n        if err != nil {\n            rw.closeConn()\n            continue\n        }\n\n        return n, err\n    }\n}\n\nfunc main() {\n    rw := NewReconnectingWriter(func() (net.Conn, error) {\n        return net.Dial(\"tcp\", \"localhost:9000\")\n    })\n    rw.Write([]byte(\"hello world\"))\n}\n</code></pre>\n\n<p>You shouldn't do this though because you'll end up with partial writes. If this is an http server a better solution is to use a load balancer because it can replay the whole request properly. (haproxy or envoy are options)</p>\n"}], "owner": {"reputation": 4500, "user_id": 549007, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3342c97dcb4c2c07a22f016614bb9eaf?s=128&d=identicon&r=PG", "display_name": "insumity", "link": "https://stackoverflow.com/users/549007/insumity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524797939, "creation_date": 1524657425, "last_edit_date": 1524660091, "question_id": 50021730, "link": "https://stackoverflow.com/questions/50021730/fix-faulty-connections-in-go", "title": "Fix faulty connections in Go", "body": "<p>I have a client that is sending (receiving) data to (from) a server. The code of the client is similar to:</p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", \"127.0.0.1:3456\")\nreader := bufio.NewReader(conn)\nwriter := bufio.NewWriter(conn)\n\nfor true {\n   writer.write(data)\n   reader.read()\n}\n</code></pre>\n\n<p>Now, assume that the server crashes often leading to <code>conn</code> to be faulty. This would imply that the <code>write</code> and <code>read</code> methods in the <code>for</code> loop will not do anything and just return an <code>error</code>. Even if the server comes up again in the next few seconds the client's <code>for</code> loop code will not be able to communicate with the server since <code>conn</code> is faulty.</p>\n\n<p>What I'm trying to achieve is: <strong>Have the client to continue operating when the server comes back up again.</strong> For this, I though of the following approach:</p>\n\n<pre><code>    func fixConnection(conn *net.Conn, reader **[]bufio.Reader, writer **[]bufio.Writer) net.Conn {\n\n        for true {\n\n            oneByte := make([] byte, 1, 1)\n            reader := bufio.NewReader(*conn)\n            _, err := reader.Read(oneByte)\n            if err != nil {\n                for true {\n                    var tmpConn net.Conn\n                    tmpConn, err = net.Dial(\"tcp\", \"127.0.0.1:3456\")\n                    if err == nil {\n                        *conn = tmpConn\n                        *reader = bufio.NewReader(*conn)\n                        *writer = bufio.NewWriter(*conn)\n                    }\n                    time.Sleep(time.Millisecond * 100)\n                }\n            } else {\n                reader.UnreadByte()\n                time.Sleep(time.Millisecond * 500)\n                continue\n            }\n\n        }\n}\n</code></pre>\n\n<p>and then I just add one line in the client:</p>\n\n<pre><code>conn, _ := net.Dial(\"tcp\", \"127.0.0.1:3456\")\nreader := bufio.NewReader(conn)\nwriter := bufio.NewWriter(conn)\n\n// new line\ngo fixConnection(&amp;conn, &amp;reader, &amp;writer)\n\nfor true {\n   writer.write(data)\n   reader.read()\n}\n</code></pre>\n\n<p>There is at lest one problem with my approach: <code>bufio</code> is not thread-safe so while <code>fixConnection</code> is changing the readers (writers) there might be an issue. Is there a way to solve this problem without using <code>sync.Mutex</code> before operating on readers/writers.</p>\n\n<p>Also, is there a better way to solve my aforementioned problem. Namely, connecting again to the server when the server comes back up again? Note that the server can accept connections by multiple clients at any point in time.</p>\n"}, {"tags": ["go", "udp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524676007, "post_id": 50021599, "comment_id": 87071677, "body": "The source IP is set by the OS network stack, nothing in your code here is going to effect that. You have to create a raw packet yourself: <a href=\"https://godoc.org/github.com/google/gopacket#hdr-Creating_Packet_Data\" rel=\"nofollow noreferrer\">godoc.org/github.com/google/gopacket#hdr-Creating_Packet_Dat&zwnj;&#8203;a</a>"}], "owner": {"reputation": 59, "user_id": 3679341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58a6d9f7ece37f03821a6a9d57d56370?s=128&d=identicon&r=PG&f=1", "display_name": "Konstantin", "link": "https://stackoverflow.com/users/3679341/konstantin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1181, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524682560, "creation_date": 1524657016, "last_edit_date": 1524682560, "question_id": 50021599, "link": "https://stackoverflow.com/questions/50021599/how-change-the-source-ip-address-udp-package-to-a-fake-ip-in-golang", "title": "How change the source ip address udp package to a fake ip in golang?", "body": "<p>I need recive udp package and send their to broadcast address other interface.</p>\n\n<p>I wrote udp forward server. Its work!\nHow change the source udp address new packages to src address income package?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"os\"\n)\n\nfunc CheckError(err error) {\n    if err  != nil {\n        fmt.Println(\"Error: \" , err)\n        os.Exit(0)\n    }\n}\n\nfunc main() {\n    ServerAddr,err := net.ResolveUDPAddr(\"udp4\",\":10001\")\n    CheckError(err)\n\n    LocalAddr, err := net.ResolveUDPAddr(\"udp4\", \"192.168.164.83:10001\")\n    CheckError(err)\n\n    RemoteAddr, err := net.ResolveUDPAddr(\"udp4\", \"192.168.164.255:10002\")\n    CheckError(err)\n\n    Conn, err := net.DialUDP(\"udp4\", LocalAddr, RemoteAddr)\n    CheckError(err)\n\n    defer Conn.Close()\n\n    ServerConn, err := net.ListenUDP(\"udp4\", ServerAddr)\n    CheckError(err)\n    defer ServerConn.Close()\n\n    buf := make([]byte, 2048)\n\n    for {\n        n,addr,err := ServerConn.ReadFromUDP(buf)\n        fmt.Println(\"Received \",n , \"bytes from \",addr)\n\n        if err != nil {\n            fmt.Println(\"Error-recive: \",err)\n        } else {\n            go Conn.Write(buf[0:n])\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "hyperledger-fabric"], "answers": [{"tags": [], "owner": {"reputation": 334, "user_id": 5062508, "user_type": "registered", "accept_rate": 44, "profile_image": "https://lh6.googleusercontent.com/-6yI1bTnTcSs/AAAAAAAAAAI/AAAAAAAAE24/wkwzXqtheW0/photo.jpg?sz=128", "display_name": "Julian Wise", "link": "https://stackoverflow.com/users/5062508/julian-wise"}, "is_accepted": false, "score": 0, "last_activity_date": 1539915204, "creation_date": 1539915204, "answer_id": 52884953, "question_id": 50021124, "link": "https://stackoverflow.com/questions/50021124/accessing-external-api-in-hyperledger-fabric/52884953#52884953", "title": "Accessing External Api in HyperLedger Fabric", "body": "<p>Generally you are not supposed to call external APIs from within hyperledger as doing so can lead to conflicts between the peer nodes. Assuming every peer needs to perform the request the number of requests exponential increase with the number of nodes involved in your system. </p>\n\n<p>There is how the documentation says external requests should be performed.That being said the documentation on external requests has not been updated for current hyperledger version as far as I can tell. \n<a href=\"https://hyperledger.github.io/composer/v0.19/integrating/call-out\" rel=\"nofollow noreferrer\">https://hyperledger.github.io/composer/v0.19/integrating/call-out</a></p>\n\n<p>Consensus considerations when accessing external APIs are noted over here <a href=\"https://hyperledger.github.io/composer/v0.19/integrating/call-out#consensus-considerations\" rel=\"nofollow noreferrer\">https://hyperledger.github.io/composer/v0.19/integrating/call-out#consensus-considerations</a></p>\n\n<p>The workaround I have been using is to set up a second docker container which is not running hyperledger to perform api requests on port 3001, collate the results, then send them over to Hyperledger set up with the REST service on port 3000. </p>\n"}], "owner": {"reputation": 117, "user_id": 8080898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59fa9cae710a3ec346bce56e699b6992?s=128&d=identicon&r=PG&f=1", "display_name": "Sarageorge", "link": "https://stackoverflow.com/users/8080898/sarageorge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 271, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539915204, "creation_date": 1524655641, "question_id": 50021124, "link": "https://stackoverflow.com/questions/50021124/accessing-external-api-in-hyperledger-fabric", "title": "Accessing External Api in HyperLedger Fabric", "body": "<p>I am trying to access the following Api via hyperLedger Fabric chaincode  :<a href=\"http://api.open-notify.org/astros.json.However\" rel=\"nofollow noreferrer\">http://api.open-notify.org/astros.json.However</a> I come up with following error </p>\n\n<p>panic: Get <a href=\"http://api.open-notify.org/astros.json\" rel=\"nofollow noreferrer\">http://api.open-notify.org/astros.json</a>: proxyconnect tcp: dial tcp: i/o timeout</p>\n\n<p>I have tried multiple ways to resolve proxy but it always times out.</p>\n\n<p>Can anybody suggest a fix ?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "tdd", "goconvey"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1524662934, "post_id": 50020919, "comment_id": 87063327, "body": "In this example provided by convey they have already implemented what u probably want <a href=\"https://github.com/smartystreets/goconvey/blob/ef6db91d284a0e7badaa1f0c404c30aa7dee3aed/examples/assertion_examples_test.go#L111\" rel=\"nofollow noreferrer\">github.com/smartystreets/goconvey/blob/&hellip;</a>  Do you don&#39;t want to use that?"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1524663296, "post_id": 50020919, "comment_id": 87063513, "body": "Also you recieving error because you custom function not staisfy <code>type assertion func</code> which is <a href=\"https://github.com/smartystreets/assertions/blob/7678a5452ebea5b7090a6b163f844c133f523da2/assert/assert.go#L119\" rel=\"nofollow noreferrer\">github.com/smartystreets/assertions/blob/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "is_accepted": true, "score": 1, "last_activity_date": 1532719215, "creation_date": 1532719215, "answer_id": 51564294, "question_id": 50020919, "link": "https://stackoverflow.com/questions/50020919/goconvey-custom-assertions-not-working-as-expected/51564294#51564294", "title": "GoConvey custom assertions not working as expected", "body": "<p>Here's how I would write that custom assertion:</p>\n\n<pre><code>func shouldBeInTheLast24Hours(actual interface{}, _ ...interface{}) string {\n    providedDate := actual.(time.Time)\n    theshold := time.Now().Add(time.Hour * -24)\n    if providedDate.After(theshold) {\n        return \"\"\n    } else {\n        return \"The target date is assumed to be in the last 24 hours, go *THERE* and fix stuff\"\n    }\n}\n\nfunc TestDateStuff(t *testing.T) {\n    Convey(\"Given date stuff\", t, func() {\n        Convey(\"should verify some custom assertions are working\", func() {\n            vipDate := time.Now()\n            So(vipDate, shouldBeInTheLast24Hours)\n        })\n    })\n}\n</code></pre>\n\n<p>The function signature for a custom assertion has to match the <code>assertion</code> func type:</p>\n\n<pre><code>// assertion is an alias for a function with a signature that the convey.So()\n// method can handle. Any future or custom assertions should conform to this\n// method signature. The return value should be an empty string if the assertion\n// passes and a well-formed failure message if not.\ntype assertion func(actual interface{}, expected ...interface{}) string\n</code></pre>\n\n<p>But, as was stated in the comments, there's already an assertion defined that can do what you need:</p>\n\n<pre><code>So(vipDate, ShouldHappenWithin, time.Hour*24, time.Now())\n</code></pre>\n"}], "owner": {"reputation": 3020, "user_id": 1264920, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6401cada72e3e86775c409db49e6befb?s=128&d=identicon&r=PG", "display_name": "TPPZ", "link": "https://stackoverflow.com/users/1264920/tppz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 269, "favorite_count": 0, "accepted_answer_id": 51564294, "answer_count": 1, "score": 0, "last_activity_date": 1532719215, "creation_date": 1524655004, "question_id": 50020919, "link": "https://stackoverflow.com/questions/50020919/goconvey-custom-assertions-not-working-as-expected", "title": "GoConvey custom assertions not working as expected", "body": "<p>Not sure why the following custom assertion is not working, it seems a compilation error, but the syntax I am using seems compliant with what is explained in their wiki page: <a href=\"https://github.com/smartystreets/goconvey/wiki/Custom-Assertions\" rel=\"nofollow noreferrer\">https://github.com/smartystreets/goconvey/wiki/Custom-Assertions</a></p>\n\n<p>I basically want to assert a <code>time.Time</code> filed in a struct is representing a date within the last 24 hours.</p>\n\n<pre><code>// func shouldBeInTheLast24Hours(targetDate time.Time, foo time.Time) string {\nfunc shouldBeInTheLast24Hours(targetDate time.Time) string {\n    if targetDate.Before(time.Now().Add(time.Duration(-24) * time.Hour)) {\n        return \"\"\n    } else {\n        return \"The target date is assumed to be in the last 24 hours, go *THERE* and fix stuff\"\n    }\n}\n\ntype DateStuff struct {\n    VipDate time.Time\n}\n\nfunc TestDateStuff(t *testing.T) {\n    Convey(\"Given date stuff\", t, func() {\n        Convey(\"should verify some custom assertions are working\", func() {\n            myDateStruct := &amp;DateStuff{VipDate: time.Now()}\n\n            // So(myDateStruct.VipDate, shouldBeInTheLast24Hours, nil) // this throws \"cannot use shouldBeInTheLast24Hours (type func(time.Time, time.Time) string) as type convey.assertion in argument to convey.So\"\n            So(myDateStruct.VipDate, shouldBeInTheLast24Hours) // this throws \"cannot use shouldBeInTheLast24Hours (type func(time.Time) string) as type convey.assertion in argument to convey.So\"\n        })\n    })\n}\n</code></pre>\n\n<p>When checking the version of Go Convey I am using I see this:</p>\n\n<pre><code>$ cd $GOPATH/src/github.com/smartystreets/goconvey/ &amp;&amp; git log -n 1 | grep Date\nDate:   Fri Aug 25 16:14:26 2017 -0600\n</code></pre>\n\n<p>Which is after the date on the wiki page (Nov 15, 2013) so it should not be a matter of updating the Go Convey library in my <code>$GOPATH</code>.</p>\n\n<p>I am not that much familiar with this closure syntax, but it does not seem to me I am misusing it, however I see that compilation error so I must be missing some gotchas.</p>\n"}, {"tags": ["go", "hcl"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "edited": false, "score": 0, "creation_date": 1525434826, "post_id": 50020510, "comment_id": 87365464, "body": "Thank you for your help :)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1524653792, "creation_date": 1524653792, "answer_id": 50020510, "question_id": 50020147, "link": "https://stackoverflow.com/questions/50020147/how-to-pre-check-and-set-variable-before-compiling-on-go/50020510#50020510", "title": "How to pre-check and set variable before compiling on Go?", "body": "<p>You can use <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">go generate</a> to accomplish this, if you can build a command to create the code you want.</p>\n"}], "owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 50020510, "answer_count": 1, "score": 0, "last_activity_date": 1524653792, "creation_date": 1524652723, "question_id": 50020147, "link": "https://stackoverflow.com/questions/50020147/how-to-pre-check-and-set-variable-before-compiling-on-go", "title": "How to pre-check and set variable before compiling on Go?", "body": "<p>I'm going to pre-check HCL contents and set it as a variable in <code>golang</code>.\ni.e. HCL contents should be parsed before compilation and set as a specific variable.</p>\n\n<p>Here is the example.</p>\n\n<pre><code>.\n\u251c\u2500\u2500 config.mel\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>The <code>config.mel</code> has the following HCL strings.</p>\n\n<pre><code>types {\n    directory = \"string\"\n    listen = \"ipaddr\"\n}\n</code></pre>\n\n<p>The <code>main.go</code> has the following lines:</p>\n\n<pre><code>package main\n\nimport (\n     \"github.com/hashicorp/hcl\"\n)\n\nfunc main() {\n    hcl.Parse(HCL_CONTENTS)\n}\n</code></pre>\n\n<p>Is there any method to set <code>HCL_CONTENTS</code> variable before compilation?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1524652797, "creation_date": 1524652797, "answer_id": 50020168, "question_id": 50018938, "link": "https://stackoverflow.com/questions/50018938/how-to-get-the-count-value-using-lookup-in-mongodb-using-golang/50020168#50020168", "title": "How to get the count value using $lookup in mongodb using golang?", "body": "<p>So your aggregation actually returns all <code>comment</code> documents in the <code>resultField</code> field, which implicitly contains the number of results, it's a slice of which you can check the length in Go using the builtin <code>len()</code> function.</p>\n\n<p>Since you only need the length (number of <code>comment</code> documents), that's why you want to only retrieve the size of this array. For that purpose you may use the <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/addFields/\" rel=\"nofollow noreferrer\"><code>$addFields</code></a> stage to replace the <code>resultField</code> array with a number being the length of this array.</p>\n\n<pre><code>pipe := c.Pipe([]bson.M{\n    {\n        \"$lookup\": bson.M{\n            \"from\":         \"comment\",\n            \"localField\":   \"_id\",\n            \"foreignField\": \"post_id\",\n            \"as\":           \"resultField\",\n        },\n    },\n    {\n        \"$addFields\": bson.M{\n            \"resultField\": bson.M{\"$size\": \"$resultField\"},\n        },\n    },\n})\n</code></pre>\n\n<p>Note that <code>$addFields</code> stage is equivalent to a <code>$project</code> stage that explicitly specifies all existing fields in the input documents and adds the new fields. Available only since MongoDB version 3.4.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9684058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 50020168, "answer_count": 1, "score": 2, "last_activity_date": 1526363916, "creation_date": 1524649305, "last_edit_date": 1526363916, "question_id": 50018938, "link": "https://stackoverflow.com/questions/50018938/how-to-get-the-count-value-using-lookup-in-mongodb-using-golang", "title": "How to get the count value using $lookup in mongodb using golang?", "body": "<p>Using aggregation I am joining two collections of mongodb using golang. The result is seems like below:-</p>\n\n<p>OUTPUT:-</p>\n\n<pre><code>{\n\"response\": {\n    \"code\": 1,\n    \"api_status\": 1,\n    \"message\": \"Success\",\n    \"total_record\": [\n        {\n            \"_id\": 1,\n            \"author_name\": \"mohit\",\n            \"category\": 232,\n            \"content\": \"This is the content\",\n            \"date_time\": 1524632713,\n            \"excerpt\": \"This is a  short text\",\n            \"image\": \"pic.jpg\",\n            \"resultField\": [\n                {\n                    \"_id\": 6,\n                    \"comment\": \"this is a least comment\",\n                    \"comment_on\": 1524644601,\n                    \"email\": \"puneet@bookingkoala.com\",\n                    \"name\": \"puneet\",\n                    \"post_id\": 1,\n                    \"reply_to\": 1524644601,\n                    \"status\": 1\n                },\n                {\n                    \"_id\": 7,\n                    \"comment\": \"this is a least comment\",\n                    \"comment_on\": 1524647808,\n                    \"email\": \"puneet@bookingkoala.com\",\n                    \"name\": \"puneet\",\n                    \"post_id\": 1,\n                    \"reply_to\": 1524647808,\n                    \"status\": 1\n                }\n            ],\n            \"status\": 0,\n            \"tags\": \"this\",\n            \"title\": \"how to do the code\"\n        },\n        {\n            \"_id\": 2,\n            \"author_name\": \"mohit\",\n            \"category\": 232,\n            \"content\": \"This is the content\",\n            \"date_time\": 1524632713,\n            \"excerpt\": \"This is a  short text\",\n            \"image\": \"pic.jpg\",\n            \"resultField\": [\n                {\n                    \"_id\": 8,\n                    \"comment\": \"this is a least comment\",\n                    \"comment_on\": 1524648059,\n                    \"email\": \"puneet@bookingkoala.com\",\n                    \"name\": \"puneet\",\n                    \"post_id\": 2,\n                    \"reply_to\": 1524648059,\n                    \"status\": 1\n                }\n            ],\n            \"status\": 0,\n            \"tags\": \"this\",\n            \"title\": \"how to do the code\"\n        },\n        {\n            \"_id\": 3,\n            \"author_name\": \"puneet\",\n            \"category\": 2,\n            \"content\": \"this is content\",\n            \"date_time\": 1524641086,\n            \"excerpt\": \"this is excerpt\",\n            \"image\": \"pic.jpg\",\n            \"resultField\": [],\n            \"status\": 1,\n            \"tags\": \"go\",\n            \"title\": \"how to do the code\"\n        }\n    ]\n }\n}\n</code></pre>\n\n<p>This <strong>output</strong> is taken by the below code of golang:-</p>\n\n<pre><code>mongoSession := config.ConnectDb()\ncollection := mongoSession.DB(config.Database).C(config.BlogCollection)\npipeline := []bson.M{\n    bson.M{\"$match\": bson.M{}},\n    bson.M{\"$lookup\": bson.M{\"from\" : \"comment\", \"localField\" : \"_id\", \"foreignField\": \"post_id\",\"as\": \"resultField\" }},\n}\nfmt.Println(pipeline)\npipe := collection.Pipe(pipeline)\nresp := []bson.M{}\nerr = pipe.All(&amp;resp)\nif err != nil {\n    fmt.Println(\"Errored: %#v \\n\", err)\n}\nfmt.Println(resp)\nif err != nil {\n    response = ResponseControllerList{\n        config.FailureCode,\n        config.FailureFlag,\n        config.FailureMsg,\n        nil,\n        nil,\n    }\n} else {\n    response = ResponseControllerList{\n        config.SuccessFlag,\n        config.SuccessFlag,\n        config.SuccessMsg,\n        nil,\n        resp,\n    }\n}\n</code></pre>\n\n<p>Issue is:- I need only <code>count</code> of the <code>data</code> <strong>not</strong> the <code>data</code>. Means in the output as shown above there is the <code>resultField</code> in which data is show but I only need the <code>count</code> value like:- <code>\"resultField\":[2]</code> but it is showing the data. How can I will get the count values of the data in output. Thank you in advance.</p>\n"}, {"tags": ["performance", "http", "go", "server", "latency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1524642393, "post_id": 50016617, "comment_id": 87049566, "body": "Nothing in the showed code suggests why performance should degrade at 400 or 500 requests / second. The problem is in other parts of your code which you don&#39;t show. <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">Profile your code</a>."}, {"owner": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1524642964, "post_id": 50016617, "comment_id": 87049938, "body": "The other parts of the code do json validation of the event data against a json schema and then push it to a stream."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1524643099, "post_id": 50016617, "comment_id": 87050013, "body": "It&#39;s not <i>what</i> the rest of your code does, but rather <i>how</i>. Without seeing it, we won&#39;t be able to help you. As said earlier, do profile your code."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1524643608, "post_id": 50016617, "comment_id": 87050299, "body": "On a side note, handling each request is already done in separate goroutines, so you gain nothing from launcher yet another goroutine from each. That&#39;s just overhead."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1524644084, "post_id": 50016617, "comment_id": 87050619, "body": "profile and benchmark and then publish here the actual data, otherwise you are just asking people to guess for you. Profiling will allow you to identify the slow path in your code yourself."}, {"owner": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "edited": false, "score": 0, "creation_date": 1524645652, "post_id": 50016617, "comment_id": 87051498, "body": "I have added some profiling results."}, {"owner": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1524645694, "post_id": 50016617, "comment_id": 87051524, "body": "@icza I am using another goroutine because I dont want the processing to happen in the http request-response cycle."}], "answers": [{"comments": [{"owner": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "edited": false, "score": 0, "creation_date": 1524652792, "post_id": 50018458, "comment_id": 87056096, "body": "Thanks for the detailed reply. All of this makes sense and I do realize that there would be the need for horizontal scaling since the system is getting overloaded.  What does not make sense to me still is why the sudden degradation in response time. I was wondering if there is a way to figure that out."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "edited": false, "score": 0, "creation_date": 1524653379, "post_id": 50018458, "comment_id": 87056400, "body": "I&#39;d first try to look at running your service under <code>GODEBUG=shedtrace=N</code>\u2014see <a href=\"https://golang.org/pkg/runtime/\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://software.intel.com/en-us/blogs/2014/05/10/debugging-performance-issues-in-go-programs\" rel=\"nofollow noreferrer\">this</a> for a background/how to use."}, {"owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "edited": false, "score": 0, "creation_date": 1563348236, "post_id": 50018458, "comment_id": 100664992, "body": "have you considered a progress bar?"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 10, "last_activity_date": 1524648306, "last_edit_date": 1524648306, "creation_date": 1524647939, "answer_id": 50018458, "question_id": 50016617, "link": "https://stackoverflow.com/questions/50016617/go-http-server-performance-issue/50018458#50018458", "title": "Go HTTP Server Performance Issue", "body": "<h2>The problem</h2>\n\n<blockquote>\n  <p>I am using another goroutine because I dont want the processing to happen in the http request-response cycle.</p>\n</blockquote>\n\n<p>That's a common fallacy (and hence trap). The line of reasoning appears to be sound: you're trying to process requests \"somewhere else\" in an attempt to\nhandle ingress HTTP requests as fast as possible.</p>\n\n<p>The problem is that that \"somewhere else\" is still some code which\n<em>runs concurrently</em> with the rest of your request-handling churn.\nHence if that code runs <em>slower</em> than the rate of ingress requests,\nyour processing goroutines will pile up essentially draining one or\nmore resources. Which exactly\u2014depends on the actual processing:\nif it's CPU-bound, it will create natural contention for the CPU\nbetween all those <code>GOMAXPROCS</code> hardware threads of execution;\nif it's bound to network I/O, it will create load on Go runtime scheruler which has to divide the available execution quanta it has\non its hands between all those goroutines wanted to be executed;\nif it's bound to disk I/O or other syscalls you will have\nproliferation of OS threads created, and so on and so on\u2026</p>\n\n<p>Essentially, <em>you are <strong>queueing</strong> the work units</em> converted from the\ningress HTTP requests, but <em>queues do not fix overload.</em>\nThey might be used to absorb short spikes of overload,\nbut this only works when such spikes are \"surrounded\" by the periods\nof load at least slightly below the maximum capacity provided by your\nsystem.\nThe fact you're queueing is not directly seen in your case, but it's\nthere, and it's exhibited by pressing your system past its natural\ncapacity\u2014your \"queue\" starts to grow indefinitely.</p>\n\n<p>Please read <a href=\"https://ferd.ca/queues-don-t-fix-overload.html\" rel=\"noreferrer\">this classic essay</a> carefully to understand why your approach is not going\nto work in realistic production setting.\nPay close attention to those pictures of the kitchen sinks.</p>\n\n<h2>What to do about it?</h2>\n\n<p>Unfortunately, it's almost impossible to give your simple solution\nas we're not working with your code in your settings with your workload.\nStill, here are a couple of directions to explore.</p>\n\n<p>On the most broad scale, try to see whether you have some easily\ndiscernible bottleneck in your system which you presently cannot see.\nFor instance, if all those concurrent worker goroutines eventually\ntalk to an RDBMs instance, its disk I/O may quite easily <em>serialize</em>\nall those goroutines which will merely wait for their turn to have\ntheir data accepted.\nThe bottleneck may be simpler\u2014say, in each worker goroutine\nyou carelessly execute some long-running operation while holding a lock\ncontended on by all those goroutines;\nthis obviously serializes them all.</p>\n\n<p>The next step would be to actually <em>measure</em> (I mean, by writing a benchmark)\nhow many time does it take for a single worker to complete its unit of work.\nThen you need to measure how this number changes when increasing the\nconcurrency factor.\nAfter collecting these data, you will be able to do\neducated projections about at what <em>realistic</em> rate your system\nis able to handle the requests.</p>\n\n<p>The next step is to think through your strategy at making your system\nfulfil those calculated expectations. Usually this means <em>limiting the rate\nof ingress requests.</em> There are different approaches to achieve this.\nLook at <a href=\"https://godoc.org/golang.org/x/time/rate\" rel=\"noreferrer\"><code>golang.org/x/time/rate</code></a>\nfor a time-based rate limiter but it's possible to start with lower-tech\napproaches such as using a buffered channel as a counting semaphore.\nThe requests which would overflow your capacity may be rejected\n(typically with HTTP status code 429, see <a href=\"https://tools.ietf.org/html/rfc6585#section-4\" rel=\"noreferrer\">this</a>).\nYou might also consider queueing them briefly but I'd try this only\nto serve as a cherry on a pie\u2014that is, when you have the rest\nsorted out completely.</p>\n\n<p>The question of what to do with rejected requests depends on your\nsetting. Typically you try to \"scale horizontally\" by deploying more\nthan one service to process your requests and teach your clients\nto switch over available services. (I'd stress that it means several\n<em>independent</em> services\u2014if they all share some target sink which collects\ntheir data, they might be limited by the ultimate capacity of that sink,\nand adding more systems won't gain you anything.)</p>\n\n<p>Let me repeat that the general problem has no magic solutions:\nif your complete stystem (with this HTTP service you're writing being\nmerely its front-end, gateway, part) is only able to handle <code>N</code> RPS of load,\nno amount of scattering <code>go processRequest()</code> is going to make it\nhandle requests at a higher pace. The easy concurrency Go offers is not\na <a href=\"https://en.wikipedia.org/wiki/No_Silver_Bullet\" rel=\"noreferrer\">silver bullet</a>,\nit's a machine gun.</p>\n"}], "owner": {"reputation": 289, "user_id": 3925116, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8e281219e447236b0073c97450541fd9?s=128&d=identicon&r=PG&f=1", "display_name": "vaibhav", "link": "https://stackoverflow.com/users/3925116/vaibhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1524648306, "creation_date": 1524642086, "last_edit_date": 1524645609, "question_id": 50016617, "link": "https://stackoverflow.com/questions/50016617/go-http-server-performance-issue", "title": "Go HTTP Server Performance Issue", "body": "<p>I am writing an event collector http server which would be under heavy load. Hence in the http handler I am just deserialising the event and then running the actual processing outside of the http request-response cycle in a goroutine. </p>\n\n<p>With this, I see that if I am hitting the server at 400 requests per second, then the latency is under 20ms for 99 percentile. But as soon as I bump the request rate to 500 per second, latency shoots up to over 800ms. </p>\n\n<p>Could anyone please help me with some ideas on what the reason could be so that I can explore more.</p>\n\n<pre><code>package controller\n\nimport (\n    \"net/http\"\n    \"encoding/json\"\n    \"event-server/service\"\n    \"time\"\n)\n\nfunc CollectEvent() http.Handler {\n    handleFunc := func(w http.ResponseWriter, r *http.Request) {\n        startTime := time.Now()\n        stats.Incr(\"TotalHttpRequests\", nil, 1)\n        decoder := json.NewDecoder(r.Body)\n        var event service.Event\n        err := decoder.Decode(&amp;event)\n        if err != nil {\n            http.Error(w, \"Invalid json: \" + err.Error(), http.StatusBadRequest)\n            return\n        }\n        go service.Collect(&amp;event)\n        w.Write([]byte(\"Accepted\"))\n        stats.Timing(\"HttpResponseDuration\", time.Since(startTime), nil, 1)\n    }\n\n    return http.HandlerFunc(handleFunc)\n}\n</code></pre>\n\n<p>I ran a test with 1000 requests per second and profiled it. Following are the results.</p>\n\n<pre><code>(pprof) top20\nShowing nodes accounting for 3.97s, 90.85% of 4.37s total\nDropped 89 nodes (cum &lt;= 0.02s)\nShowing top 20 nodes out of 162\n      flat  flat%   sum%        cum   cum%\n     0.72s 16.48% 16.48%      0.72s 16.48%  runtime.mach_semaphore_signal\n     0.65s 14.87% 31.35%      0.66s 15.10%  syscall.Syscall\n     0.54s 12.36% 43.71%      0.54s 12.36%  runtime.usleep\n     0.46s 10.53% 54.23%      0.46s 10.53%  runtime.cgocall\n     0.34s  7.78% 62.01%      0.34s  7.78%  runtime.mach_semaphore_wait\n     0.33s  7.55% 69.57%      0.33s  7.55%  runtime.kevent\n     0.30s  6.86% 76.43%      0.30s  6.86%  syscall.RawSyscall\n     0.10s  2.29% 78.72%      0.10s  2.29%          runtime.mach_semaphore_timedwait\n     0.07s  1.60% 80.32%      1.25s 28.60%  net.dialSingle\n     0.06s  1.37% 81.69%      0.11s  2.52%  runtime.notetsleep\n     0.06s  1.37% 83.07%      0.06s  1.37%  runtime.scanobject\n     0.06s  1.37% 84.44%      0.06s  1.37%  syscall.Syscall6\n     0.05s  1.14% 85.58%      0.05s  1.14%  internal/poll.convertErr\n     0.05s  1.14% 86.73%      0.05s  1.14%  runtime.memmove\n     0.05s  1.14% 87.87%      0.05s  1.14%  runtime.step\n     0.04s  0.92% 88.79%      0.09s  2.06%  runtime.mallocgc\n     0.03s  0.69% 89.47%      0.58s 13.27%  net.(*netFD).connect\n     0.02s  0.46% 89.93%      0.40s  9.15%  net.sysSocket\n     0.02s  0.46% 90.39%      0.03s  0.69%  net/http.(*Transport).getIdleConn\n     0.02s  0.46% 90.85%      0.13s  2.97%  runtime.gentraceback\n(pprof) top --cum\nShowing nodes accounting for 70ms, 1.60% of 4370ms total\nDropped 89 nodes (cum &lt;= 21.85ms)\nShowing top 10 nodes out of 162\n      flat  flat%   sum%        cum   cum%\n         0     0%     0%     1320ms 30.21%  net/http.(*Transport).getConn.func4\n         0     0%     0%     1310ms 29.98%  net.(*Dialer).Dial\n         0     0%     0%     1310ms 29.98%  net.(*Dialer).Dial-fm\n         0     0%     0%     1310ms 29.98%  net.(*Dialer).DialContext\n         0     0%     0%     1310ms 29.98%  net/http.(*Transport).dial\n         0     0%     0%     1310ms 29.98%  net/http.(*Transport).dialConn\n         0     0%     0%     1250ms 28.60%  net.dialSerial\n      70ms  1.60%  1.60%     1250ms 28.60%  net.dialSingle\n         0     0%  1.60%     1170ms 26.77%  net.dialTCP\n         0     0%  1.60%     1170ms 26.77%  net.doDialTCP\n(pprof) \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1524644294, "post_id": 50016108, "comment_id": 87050725, "body": "This is your first app? congrat, start with the documentation : <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a> <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a>    <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">golang.org/doc/articles/wiki</a> you obviously didn&#39;t read any of it."}, {"owner": {"reputation": 369, "user_id": 4444629, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wZfiH.png?s=128&g=1", "display_name": "musale", "link": "https://stackoverflow.com/users/4444629/musale"}, "edited": false, "score": 0, "creation_date": 1524659906, "post_id": 50016108, "comment_id": 87061081, "body": "I wrote an answer for the creation of a go webserver <a href=\"https://stackoverflow.com/a/49923337/4444629\">stackoverflow.com/a/49923337/4444629</a> I hope it sheds some light for you regarding the use of templates."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524670970, "post_id": 50016108, "comment_id": 87068917, "body": "The code you posted doesn&#39;t compile. Look at why that is."}, {"owner": {"reputation": 83, "user_id": 4046160, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jCBJZUK-3eo/AAAAAAAAAAI/AAAAAAAAAHg/nb44HhajB7c/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/4046160/sam"}, "reply_to_user": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1524723270, "post_id": 50016108, "comment_id": 87087850, "body": "@mpm Thanks for the tutorials."}, {"owner": {"reputation": 83, "user_id": 4046160, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jCBJZUK-3eo/AAAAAAAAAAI/AAAAAAAAAHg/nb44HhajB7c/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/4046160/sam"}, "reply_to_user": {"reputation": 369, "user_id": 4444629, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wZfiH.png?s=128&g=1", "display_name": "musale", "link": "https://stackoverflow.com/users/4444629/musale"}, "edited": false, "score": 0, "creation_date": 1524723353, "post_id": 50016108, "comment_id": 87087885, "body": "@musale This is something i was looking for. thanks mate."}, {"owner": {"reputation": 83, "user_id": 4046160, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jCBJZUK-3eo/AAAAAAAAAAI/AAAAAAAAAHg/nb44HhajB7c/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/4046160/sam"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524723949, "post_id": 50016108, "comment_id": 87088217, "body": "@MichaelHampton it does compile. the problem is (or can say unaware)  about go templates (which I&#39;m learning now). anyway thanks for the comment."}, {"owner": {"reputation": 369, "user_id": 4444629, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/wZfiH.png?s=128&g=1", "display_name": "musale", "link": "https://stackoverflow.com/users/4444629/musale"}, "edited": false, "score": 0, "creation_date": 1524732340, "post_id": 50016108, "comment_id": 87093305, "body": "@Sam you&#39;re welcome :)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524754027, "post_id": 50016108, "comment_id": 87108126, "body": "@Sam Er, the code in this question <b>does not compile</b> because you omitted relevant parts of it. But yes, you need to learn about html/template (which is based on text/template)."}], "answers": [{"tags": [], "owner": {"reputation": 437, "user_id": 5180614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a2916873af11e1c97a88c8b24c64aac?s=128&d=identicon&r=PG&f=1", "display_name": "yabberth", "link": "https://stackoverflow.com/users/5180614/yabberth"}, "is_accepted": true, "score": 2, "last_activity_date": 1524837234, "creation_date": 1524837234, "answer_id": 50063902, "question_id": 50016108, "link": "https://stackoverflow.com/questions/50016108/linking-my-html-to-go-lang/50063902#50063902", "title": "Linking my HTML to Go Lang", "body": "<p>Create a template file:</p>\n\n<p><strong>tpl.gohtml</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Hello World!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;The Number from Go Code is: {{.}}&lt;/h1&gt; \n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>And your <strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"text/template\"\n)\n\nvar tpl *template.Template\n\nfunc init() {\n    tpl = template.Must(template.ParseFiles(\"tpl.gohtml\"))\n}\n\nfunc main() {\n    err := tpl.ExecuteTemplate(os.Stdout, \"tpl.gohtml\", 42)\n    if err != nil {\n        log.Fatalln(err)\n    }\n}\n</code></pre>\n\n<p>In the init function you parse the template file created above. If you have many of them you can use <code>ParseGlob(pattern string) (*Template, error)</code> But for this example you can parse the template by name.\nAfter we done this we execute the template with the name <code>tpl.gohtml</code> and print it out on the <code>Stdout</code> and handle errors.</p>\n\n<p>Now you can run the code with <code>go run main.go</code> and you get the following output:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Hello World!&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1&gt;The meaning of life: 42&lt;/h1&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>You can see that the last argument of the <code>ExecuteTemplate()</code> Function is the data you passed to your template. You can also use slices, maps or self created complex data types to the template and iterate over it.</p>\n\n<p><strong>main.go with a slice</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"text/template\"\n)\n\nvar tpl *template.Template\n\nfunc init() {\n    tpl = template.Must(template.ParseFiles(\"tpl.gohtml\"))\n}\n\nfunc main() {\n\n    sages := []string{\"This\", \"is\", \"a\", \"string\", \"slice\"}\n\n    err := tpl.Execute(os.Stdout, sages)\n    if err != nil {\n        log.Fatalln(err)\n    }\n}\n</code></pre>\n\n<p>and the corresponding template could look like this</p>\n\n<p><strong>tpl.gohtml</strong></p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Slice Data&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n    {{range $index, $name := .}}\n    &lt;li&gt;{{$index}} - {{$name}}&lt;/li&gt;\n    {{end}}\n&lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>This would give you the following output:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Slice Data&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n\n    &lt;li&gt;0 - This&lt;/li&gt;\n\n    &lt;li&gt;1 - is&lt;/li&gt;\n\n    &lt;li&gt;2 - a&lt;/li&gt;\n\n    &lt;li&gt;3 - string&lt;/li&gt;\n\n    &lt;li&gt;4 - slice&lt;/li&gt;\n\n&lt;/ul&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>If you want to create the html files with this code just use <code>go run main.go &gt; outputfilename.html</code></p>\n\n<p><a href=\"https://github.com/GoesToEleven/golang-web-dev\" rel=\"nofollow noreferrer\">Golang Web Dev Github. Sources of a Udemy course</a></p>\n\n<p><a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">Go Templates</a></p>\n"}], "owner": {"reputation": 83, "user_id": 4046160, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jCBJZUK-3eo/AAAAAAAAAAI/AAAAAAAAAHg/nb44HhajB7c/photo.jpg?sz=128", "display_name": "Sam", "link": "https://stackoverflow.com/users/4046160/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 2, "accepted_answer_id": 50063902, "answer_count": 1, "score": 0, "last_activity_date": 1524837234, "creation_date": 1524640179, "question_id": 50016108, "link": "https://stackoverflow.com/questions/50016108/linking-my-html-to-go-lang", "title": "Linking my HTML to Go Lang", "body": "<p>I'm trying to show my result set and Variables from .Go Lang to an HTML Page. </p>\n\n<p><a href=\"https://i.stack.imgur.com/W0NpM.png\" rel=\"nofollow noreferrer\">Assuming this tree view as my workspace.</a>\n    <strong>Home.HTML</strong>  </p>\n\n<pre><code> &lt;div id=\"Golang\"&gt;&lt;p&gt;My Name is : &lt;i&gt;{{.myName}}&lt;/i&gt;&lt;/p&gt;&lt;/div&gt;\n    &lt;div id=\"Golang\"&gt;&lt;p&gt;Some Random Database Test: &lt;br&gt;{{.Country}} {{.City}} &lt;/p&gt;&lt;/div&gt;\n</code></pre>\n\n<p><strong>db.Go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\ntype world struct {\n    Country sql.NullString `json:\"country\"`\n    State   sql.NullString `json:\"state\"`\n    City    sql.NullString `json:\"city\"`\n    Abbr    string         `json:\"abbriviation\"`\n    id      int            `json:\"id\"`\n    CCode   int            `json:\"CountryCode\"`\n}\n\nfunc main() {\n\n    name := \"Sam\"\n\n    dsn := \"root:1234@tcp(127.0.0.1:3306)/script\"\n    // Open database\n    fmt.Println(\"We're going to connect a MySql Db\")\n    db, err := sql.Open(\"mysql\", dsn)\n    if err != nil {\n        panic(err)\n    }\n\n    defer db.Close()\n\n    fmt.Println(\"Successfully connected to Mysql Db\")\n\n    results, err := db.Query(\"SELECT * FROM CountryDb WHERE Country =?\", \"India\")\n    if err != nil {\n        panic(err.Error())\n    }\n\n    for results.Next() {\n        var tag world\n        err = results.Scan(&amp;tag.Abbr, &amp;tag.Country, &amp;tag.CCode, &amp;tag.State, &amp;tag.City)\n        if err != nil {\n            panic(err.Error()) \n        }\n        log.Printf(tag.Abbr, tag.Country, tag.CCode, tag.State, tag.City)\n    }\n\n}\n</code></pre>\n\n<p>Now how can i show values from my Go program to HTML Tags.\nThis is my first go program and I'm not much aware of this language. I go through some online tutorials but the way they are written is not very helpful.\nso any help on this would be appreciated.\nThanks</p>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 6120, "user_id": 206401, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b3d722df1b0c7ed6c352cff71006012?s=128&d=identicon&r=PG", "display_name": "AMIC MING", "link": "https://stackoverflow.com/users/206401/amic-ming"}, "edited": false, "score": 0, "creation_date": 1524681005, "post_id": 50016055, "comment_id": 87074262, "body": "Did you looked this - <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">golang.org/dl</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4826260, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-YJjF57Le4Vg/AAAAAAAAAAI/AAAAAAAACzE/Rs7x79GzZC8/photo.jpg?sz=128", "display_name": "Paul Chen", "link": "https://stackoverflow.com/users/4826260/paul-chen"}, "edited": false, "score": 0, "creation_date": 1597510031, "post_id": 50026563, "comment_id": 112158970, "body": "If you are looking for a 64-bits MAKE for windows, here is the link to download (<a href=\"https://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/\" rel=\"nofollow noreferrer\">sourceforge.net/projects/mingw-w64/files/&hellip;</a>) . MinGW-w64 is a 64-bit MAKE for windows."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1524671689, "creation_date": 1524671689, "answer_id": 50026563, "question_id": 50016055, "link": "https://stackoverflow.com/questions/50016055/windows-how-to-make-for-golang/50026563#50026563", "title": "Windows how to make for Golang", "body": "<blockquote>\n  <p><a href=\"http://gnuwin32.sourceforge.net/packages/make.htm\" rel=\"nofollow noreferrer\">Make for Windows</a></p>\n  \n  <p>Make: GNU make utility to maintain groups of programs</p>\n</blockquote>\n"}], "owner": {"reputation": 123, "user_id": 7817561, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/51b425bc125646b414d4400f96200fa6?s=128&d=identicon&r=PG&f=1", "display_name": "Yi Luo", "link": "https://stackoverflow.com/users/7817561/yi-luo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1524671689, "creation_date": 1524640003, "last_edit_date": 1524651312, "question_id": 50016055, "link": "https://stackoverflow.com/questions/50016055/windows-how-to-make-for-golang", "title": "Windows how to make for Golang", "body": "<p>I have Golang 1.8.3 installed and want to use <strong>go-libp2p</strong>. But from the <strong>libp2p</strong> GitHub page <a href=\"https://github.com/libp2p/go-libp2p\" rel=\"nofollow noreferrer\">here</a>, it need to run <code>make</code> and <code>make deps</code> command. As I am using Windows 10, it shows <code>make</code> command is not recognized. So, my question is how can I configure and run the <code>make</code> command?</p>\n"}, {"tags": ["python", "go", "grpc"], "comments": [{"owner": {"reputation": 5576, "user_id": 4986182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5oDOo.png?s=128&g=1", "display_name": "vitr", "link": "https://stackoverflow.com/users/4986182/vitr"}, "edited": false, "score": 2, "creation_date": 1524646965, "post_id": 50014425, "comment_id": 87052377, "body": "hard to tell, as we can see neither server nor client code"}, {"owner": {"reputation": 2034, "user_id": 4621164, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5gR5.jpg?s=128&g=1", "display_name": "Nathaniel Manista At Google", "link": "https://stackoverflow.com/users/4621164/nathaniel-manista-at-google"}, "edited": false, "score": 0, "creation_date": 1525368159, "post_id": 50014425, "comment_id": 87339225, "body": "Agreed; please share all code necessary to demonstrate the problem (assuming you&#39;re able to do so without sharing anything private or confidential)."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 9704047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3c74ed5af19376c7c26ba1f3eb6b6db?s=128&d=identicon&r=PG&f=1", "display_name": "Pierluigi", "link": "https://stackoverflow.com/users/9704047/pierluigi"}, "is_accepted": false, "score": 1, "last_activity_date": 1524754139, "last_edit_date": 1524754139, "creation_date": 1524746584, "answer_id": 50043304, "question_id": 50014425, "link": "https://stackoverflow.com/questions/50014425/not-able-to-connect-to-go-grpc-server-using-python-client/50043304#50043304", "title": "Not able to connect to go grpc server using python client", "body": "<p>Sometimes I get <code>StatusCode.UNIMPLEMENTED</code> when the version of the protocol buffer files used by the client and the by server are in a inconsistent status.</p>\n\n<p>For example I made a change in the proto buffer file in the server but I forgot to change the proto buffer file in the client.</p>\n\n<p>I don't know if this can help but sometime it happened to me.</p>\n"}], "owner": {"reputation": 3436, "user_id": 729294, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/de7b24414ca6c375479bdab7ba824eb0?s=128&d=identicon&r=PG", "display_name": "rajan sthapit", "link": "https://stackoverflow.com/users/729294/rajan-sthapit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1349, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524754139, "creation_date": 1524633010, "question_id": 50014425, "link": "https://stackoverflow.com/questions/50014425/not-able-to-connect-to-go-grpc-server-using-python-client", "title": "Not able to connect to go grpc server using python client", "body": "<p>I have a grpc server running in Go. I am not able to call a method into it using the python client. Not sure what is going wrong. I get the following error</p>\n\n<p><code>_Rendezvous of RPC that terminated with (StatusCode.UNIMPLEMENTED, method: /com.test/myMethod)&gt;</code></p>\n\n<p>Any idea what could have gone wrong? The Go client is able to communicate properly.</p>\n\n<p>Also I generated the stubs following the instructions <a href=\"https://grpc.io/docs/tutorials/basic/python.html\" rel=\"nofollow noreferrer\">https://grpc.io/docs/tutorials/basic/python.html</a></p>\n\n<pre><code>python -m grpc_tools.protoc -I../../protos --python_out=. --grpc_python_out=. ../../protos/route_guide.proto\n</code></pre>\n\n<p>Once I got the py files, I removed the proto files and zipped the package. This zipped package is what I am using for my python client. Is there anything wrong?</p>\n"}, {"tags": ["go", "interface", "go-map"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524631666, "post_id": 50014090, "comment_id": 87044638, "body": "for a map list use <code>[]</code> in front. e.g. <code>[]map[string]interface{}</code>."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524632226, "post_id": 50014090, "comment_id": 87044782, "body": "@mkopriva if we use <code>[]map[string]interface{}</code> it will throw an error. Since <code>ret[&quot;result&quot;]</code> is an <code>interface{}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 78, "user_id": 9662545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce897d01547a5931add7b63a535a09d8?s=128&d=identicon&r=PG&f=1", "display_name": "\u772d\u6587\u5cf0", "link": "https://stackoverflow.com/users/9662545/%e7%9c%ad%e6%96%87%e5%b3%b0"}, "edited": false, "score": 1, "creation_date": 1524631824, "post_id": 50014161, "comment_id": 87044686, "body": "<code>fmt.Println(ret[&quot;result&quot;].(interface{}).([]interface{}))</code> in your case ret[&quot;result&quot;] is actually an <code>interface{}</code> not <code>map[string]interface{}</code> and its innner value is <code>[]interface{}</code> slice of interface"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 1, "last_activity_date": 1524632299, "last_edit_date": 1524632299, "creation_date": 1524631090, "answer_id": 50014161, "question_id": 50014090, "link": "https://stackoverflow.com/questions/50014090/can-golang-function-return-interface-how-to-return-a-map-list/50014161#50014161", "title": "can golang function return interface{}{} - how to return a map list", "body": "<p>Create return type to <code>map[string]interface{}</code>. Because the response returned from <code>GET</code> request is of type <code>map[string]interface{}</code> not <code>map[string]interface{}{}</code> which is a composite literal. So you can use it like</p>\n\n<pre><code>func getLatestTxs() map[string]interface{} {\n    fmt.Println(\"hello\")\n    // function body code ....\n    return ret\n}\n</code></pre>\n\n<p>For this line</p>\n\n<blockquote>\n  <p>if i change map[string]interface{}{} to interface{}, there is no\n  compile error any more.</p>\n</blockquote>\n\n<p>We can convert anything to <code>interface{}</code> because it works as a wrapper which can wrap any type and will save the underlying type and its value. The value can be received using type assertion for an underlying type. So in your case when you are using an interface it will wrap <code>map[string]interface{}</code> value. For fetching the value it is required to type assert as below.</p>\n\n<pre><code>func getLatestTxs() interface{} {\n    fmt.Println(\"hello\")\n    // function code .....\n    //fmt.Println(ret[\"result\"])\n    return ret\n}\n\n\nret[\"result\"].(interface{}).([]interface{})\n</code></pre>\n\n<p>print the underlying <code>map[string]interface{}</code> to get the value of single object inside result</p>\n\n<pre><code>fmt.Println(ret[\"result\"].(interface{}).([]interface{})[0].(map[string]interface{})[\"from\"])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78, "user_id": 9662545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce897d01547a5931add7b63a535a09d8?s=128&d=identicon&r=PG&f=1", "display_name": "\u772d\u6587\u5cf0", "link": "https://stackoverflow.com/users/9662545/%e7%9c%ad%e6%96%87%e5%b3%b0"}, "edited": false, "score": 0, "creation_date": 1524631454, "post_id": 50014164, "comment_id": 87044578, "body": "i want return a map list, <code>ret[&quot;result&quot;]</code>, looks you are return a map, That`s right?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1524634400, "last_edit_date": 1524634400, "creation_date": 1524631097, "answer_id": 50014164, "question_id": 50014090, "link": "https://stackoverflow.com/questions/50014090/can-golang-function-return-interface-how-to-return-a-map-list/50014164#50014164", "title": "can golang function return interface{}{} - how to return a map list", "body": "<p>The code <code>map[string]interface{}{}</code> is a composite literal value for an empty map. Functions are declared with types, not values. It looks like you want to return the slice type <code>[]map[string]interface{}</code>.  Use the following function:</p>\n\n<pre><code>func getLatestTxs() []map[string]interface{} {\n    fmt.Println(\"hello\")\n    resp, err := http.Get(\"http://api.etherscan.io/api?module=account&amp;action=txlist&amp;address=0x266ac31358d773af8278f625c4d4a35648953341&amp;startblock=0&amp;endblock=99999999&amp;sort=asc&amp;apikey=5UUVIZV5581ENPXKYWAUDGQTHI956A56MU\")\n    defer resp.Body.Close()\n    body, _ := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Errorf(\"etherscan\u8bbf\u95ee\u5931\u8d25\")\n    }\n    var ret struct {\n        Status  string\n        Result  []map[string]interface{}\n    }\n    json.Unmarshal(body, &amp;ret)\n    if ret.Status == \"1\" {\n        return ret.Result\n    }\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 78, "user_id": 9662545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce897d01547a5931add7b63a535a09d8?s=128&d=identicon&r=PG&f=1", "display_name": "\u772d\u6587\u5cf0", "link": "https://stackoverflow.com/users/9662545/%e7%9c%ad%e6%96%87%e5%b3%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6555, "favorite_count": 0, "accepted_answer_id": 50014164, "answer_count": 2, "score": 5, "last_activity_date": 1531550809, "creation_date": 1524630565, "last_edit_date": 1531550809, "question_id": 50014090, "link": "https://stackoverflow.com/questions/50014090/can-golang-function-return-interface-how-to-return-a-map-list", "title": "can golang function return interface{}{} - how to return a map list", "body": "<pre><code>func getLatestTxs() map[string]interface{}{} {\n    fmt.Println(\"hello\")\n    resp, err := http.Get(\"http://api.etherscan.io/api?module=account&amp;action=txlist&amp;address=0x266ac31358d773af8278f625c4d4a35648953341&amp;startblock=0&amp;endblock=99999999&amp;sort=asc&amp;apikey=5UUVIZV5581ENPXKYWAUDGQTHI956A56MU\")\n    defer resp.Body.Close()\n    body, _ := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Errorf(\"etherscan\u8bbf\u95ee\u5931\u8d25\")\n    }\n    ret := map[string]interface{}{}\n    json.Unmarshal(body, &amp;ret)\n    if ret[\"status\"] == 1 {\n        return ret[\"result\"]\n    }\n}\n</code></pre>\n\n<p>I want return <code>map[string]interface{}{}</code> in my code.</p>\n\n<p>but i got compile error <code>syntax error: unexpected [ after top level declaration</code></p>\n\n<p>if i change <code>map[string]interface{}{}</code> to <code>interface{}</code>, there is no compile error any more.</p>\n\n<p><strong>Attention</strong> i use <code>map[string]interface{}{}</code> because i want return a map list.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1524629763, "last_edit_date": 1524629763, "creation_date": 1524629449, "answer_id": 50013925, "question_id": 50013552, "link": "https://stackoverflow.com/questions/50013552/convert-12-hour-format-to-24-hour-format-time-in-golang/50013925#50013925", "title": "convert 12 hour format to 24 hour format time in golang", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout1 := \"03:04:05PM\"\n    layout2 := \"15:04:05\"\n    t, err := time.Parse(layout1, \"07:05:45PM\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(t.Format(layout1))\n    fmt.Println(t.Format(layout2))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Ypn2-lEF_Zs\" rel=\"noreferrer\">https://play.golang.org/p/Ypn2-lEF_Zs</a></p>\n\n<p>Output:</p>\n\n<pre><code>07:05:45PM\n19:05:45\n</code></pre>\n\n<hr>\n\n<p>Reference: <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"noreferrer\">package time</a></p>\n"}, {"tags": [], "owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "is_accepted": false, "score": 6, "last_activity_date": 1610431721, "last_edit_date": 1610431721, "creation_date": 1524629653, "answer_id": 50013965, "question_id": 50013552, "link": "https://stackoverflow.com/questions/50013552/convert-12-hour-format-to-24-hour-format-time-in-golang/50013965#50013965", "title": "convert 12 hour format to 24 hour format time in golang", "body": "<p>The key is to understand how to write the <code>layout</code> argument. According to <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">godoc</a>, the reference time for <code>layout</code> is:</p>\n<pre><code>Mon Jan 2 15:04:05 -0700 MST 2006\n</code></pre>\n<p>Each string element of a date has a specific numerical value relevant to it:</p>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>String</th>\n<th>Represents</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1 or 01 or Jan</td>\n<td>month</td>\n</tr>\n<tr>\n<td>2 or 02</td>\n<td>day of month</td>\n</tr>\n<tr>\n<td>3 or 03 or 15</td>\n<td>hour</td>\n</tr>\n<tr>\n<td>4 or 04</td>\n<td>minute</td>\n</tr>\n<tr>\n<td>5 or 05</td>\n<td>second</td>\n</tr>\n<tr>\n<td>6 or 06 or 2006</td>\n<td>year</td>\n</tr>\n<tr>\n<td>-0700 or MST</td>\n<td>timezone representation</td>\n</tr>\n<tr>\n<td>PM</td>\n<td>period of day</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>You need to rewrite this date to your format as the layout for parse. You only need to include the elements to your need. So only the hour, minute, second and AM/PM is important. Reference time <code>15:04:05</code> should be written as <code>03:04:05PM</code>.</p>\n<p>Just use the rewritten time as the layout parameter:</p>\n<pre class=\"lang-golang prettyprint-override\"><code>import time\n\n...\n\n\nt, _ := time.Parse(&quot;03:04:05PM&quot;, &quot;07:05:45PM&quot;)\nfmt.Println(t.Format(&quot;15:04:05&quot;))\n</code></pre>\n<p>Output:</p>\n<pre><code>19:05:45\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 713, "user_id": 12162813, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-22W2wmyNnEQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfCiW9MIj-T5ov3H31eHm8dOqD1pg/photo.jpg?sz=128", "display_name": "Thushara Buddhika", "link": "https://stackoverflow.com/users/12162813/thushara-buddhika"}, "is_accepted": false, "score": 0, "last_activity_date": 1573120585, "creation_date": 1573120585, "answer_id": 58746133, "question_id": 50013552, "link": "https://stackoverflow.com/questions/50013552/convert-12-hour-format-to-24-hour-format-time-in-golang/58746133#58746133", "title": "convert 12 hour format to 24 hour format time in golang", "body": "<pre><code>const (\n    layoutDateTime   = \"02 Jan 2006 15:04:05\"\n)\n\ndateTimePM, _ := time.Parse(layoutDateTime + \" PM\", \"07 Nov 2019 11:31:30 PM\")\ndateTimeAM, _ := time.Parse(layoutDateTime + \" PM\", \"07 Nov 2019 11:31:30 AM\")\n</code></pre>\n\n<p>This has successfully converted both AM,PM dates correctly.</p>\n"}], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5945, "favorite_count": 2, "accepted_answer_id": 50013925, "answer_count": 3, "score": 6, "last_activity_date": 1610431721, "creation_date": 1524626346, "last_edit_date": 1524626742, "question_id": 50013552, "link": "https://stackoverflow.com/questions/50013552/convert-12-hour-format-to-24-hour-format-time-in-golang", "title": "convert 12 hour format to 24 hour format time in golang", "body": "<p>In golang I have not found any way to convert 12 hour format string time to 24 hour format as below:</p>\n\n<pre><code>07:05:45PM to 19:05:45\n</code></pre>\n\n<p>I have tried below using layout</p>\n\n<pre><code>layout := \"Mon Jan 2 15:04:05 -0700 MST 2006\"\n/*\n * Write your code here.\n */\n//layout := \"3:04PM\"\nt,_ := time.Parse(layout,s)\nfmt.Println(t)\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>07:05:45PM\n</code></pre>\n\n<p>I have looked for answers similar to this but it is not helping everyone is using whole layout. I found answers in another language but not in go.</p>\n"}, {"tags": ["json", "go", "go-map"], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 892960, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e84fb88c367cef82ae127b8c164750e?s=128&d=identicon&r=PG", "display_name": "user892960", "link": "https://stackoverflow.com/users/892960/user892960"}, "edited": false, "score": 0, "creation_date": 1524842296, "post_id": 50013584, "comment_id": 87147591, "body": "Can I use <code>interface</code> for the map value only? because everything else is fixed except the map value type."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 127, "user_id": 892960, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e84fb88c367cef82ae127b8c164750e?s=128&d=identicon&r=PG", "display_name": "user892960", "link": "https://stackoverflow.com/users/892960/user892960"}, "edited": false, "score": 0, "creation_date": 1524842378, "post_id": 50013584, "comment_id": 87147641, "body": "yes you can do that too. But this is an array you will have to use unmarshaller interface for dynamic values in json"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 2, "last_activity_date": 1524626662, "creation_date": 1524626662, "answer_id": 50013584, "question_id": 50013545, "link": "https://stackoverflow.com/questions/50013545/how-to-parse-a-json-into-a-map-with-variable-type-in-golang/50013584#50013584", "title": "How to parse a JSON into a map with variable type in Golang", "body": "<p>For unmarshalling dynamic json where output is different use interface to unmarshal the same. It will unmarshal whole json as it is structured with any type inside it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    jsonbytes := []byte(`{\n        \"return\": [{\n            \"&lt;UUID1&gt;\": true,\n            \"&lt;UUID2&gt;\": \"Minion did not return. [No response]\",\n            \"&lt;UUID3&gt;\": true,\n            \"&lt;UUID4&gt;\": false\n            }]\n    }`)\n    var v interface{}\n    if err := json.Unmarshal(jsonbytes, &amp;v); err != nil{\n        fmt.Println(err)\n    }\n    fmt.Println(v)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rMdXrYZ5Kyo\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 127, "user_id": 892960, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e84fb88c367cef82ae127b8c164750e?s=128&d=identicon&r=PG", "display_name": "user892960", "link": "https://stackoverflow.com/users/892960/user892960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1356, "favorite_count": 0, "accepted_answer_id": 50013584, "answer_count": 1, "score": 4, "last_activity_date": 1531550732, "creation_date": 1524626285, "last_edit_date": 1531550732, "question_id": 50013545, "link": "https://stackoverflow.com/questions/50013545/how-to-parse-a-json-into-a-map-with-variable-type-in-golang", "title": "How to parse a JSON into a map with variable type in Golang", "body": "<p>I have the following JSON response from the Salt-Stack API:</p>\n\n<pre><code>{\n    \"return\": [{\n        \"&lt;UUID1&gt;\": true,\n        \"&lt;UUID2&gt;\": \"Minion did not return. [No response]\",\n        \"&lt;UUID3&gt;\": true,\n        \"&lt;UUID4&gt;\": false\n    }]\n}\n</code></pre>\n\n<p>I usually use a map structure to unmarshall it in Go:</p>\n\n<pre><code>type getMinionsStatusResponse struct {\n    Returns     []map[string]bool `json:\"return\"`\n}\n</code></pre>\n\n<p>But due to the second row where an error response is returned (in string format) instead of the boolean, I got the following error: <code>json: cannot unmarshal string into Go value of type bool</code></p>\n\n<p>I wonder how I can marshall this JSON format in Golang using the <code>encoding/json</code> package?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1524643608, "post_id": 50012739, "comment_id": 87050298, "body": "Thanks for the suggestion. <code>go-pry</code> is actually one of the packages I&#39;m evaluating alongside <code>gore</code> but, funnily enough, it just panics and crashes on my system. &#175;\\_(\u30c4)_/&#175;"}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1524619255, "creation_date": 1524619255, "answer_id": 50012739, "question_id": 50012471, "link": "https://stackoverflow.com/questions/50012471/repl-console-in-context-of-application-in-go/50012739#50012739", "title": "REPL console in context of application in Go", "body": "<p>You could try <code>go-pry</code>: <a href=\"https://github.com/d4l3k/go-pry\" rel=\"nofollow noreferrer\">https://github.com/d4l3k/go-pry</a></p>\n\n<p>This works much close to the rails console. Just <code>import \"github.com/d4l3k/go-pry/pry\"</code> in your file and add <code>pry.Pry()</code> where you want to start your session. After that you just call <code>go-pry main.go</code> instead of <code>go main.go</code>.</p>\n\n<p>But there is not a standard solution, as far as I can tell.</p>\n"}], "owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524644973, "creation_date": 1524616425, "last_edit_date": 1524644973, "question_id": 50012471, "link": "https://stackoverflow.com/questions/50012471/repl-console-in-context-of-application-in-go", "title": "REPL console in context of application in Go", "body": "<p>Is there a way to access an interactive REPL console in the context of an application, in Go?</p>\n\n<p>For reference, I'm thinking about the functionality of <a href=\"https://en.wikipedia.org/wiki/Interactive_Ruby_Shell\" rel=\"nofollow noreferrer\">Ruby's irb</a> or <a href=\"https://github.com/pry/pry\" rel=\"nofollow noreferrer\">pry</a> (and, by extension, the <a href=\"http://guides.rubyonrails.org/command_line.html#rails-console\" rel=\"nofollow noreferrer\">Ruby On Rails console</a> that builds on them), the <a href=\"https://nodejs.org/api/repl.html\" rel=\"nofollow noreferrer\">Node.js REPL</a>, the <a href=\"https://docs.scala-lang.org/overviews/repl/overview.html\" rel=\"nofollow noreferrer\">Scala REPL</a> (and <a href=\"https://www.playframework.com/documentation/2.6.x/PlayConsole\" rel=\"nofollow noreferrer\">Play console</a>) or <a href=\"https://hexdocs.pm/iex/IEx.html\" rel=\"nofollow noreferrer\">Elixir's IEx</a>. All of these are development (or production!) tools to open a REPL in the context of an application. For example, they allow to access an application's classes, objects and constants, and by extension to interact with the application's resources (e.g. a database).</p>\n\n<p>There are some Go REPLs out there, like <a href=\"https://github.com/motemen/gore\" rel=\"nofollow noreferrer\">gore</a>, but it's not clear how to plug them into an application.</p>\n\n<p>I suppose it would be possible to start a <code>gore</code> session and then import all packages, but what about the initializations that happen in the <code>main</code>?</p>\n\n<p>My instinct tells me that there should be a way to provide an alternative \"REPL-only\" <code>main</code> to compile a different binary that starts the application as a REPL -- rather than, say, an HTTP server.</p>\n\n<p>Is there any established way to do so? Or a reference implementation?</p>\n"}, {"tags": ["recursion", "go"], "comments": [{"owner": {"reputation": 572, "user_id": 1369587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45b8df80bdc328da043f13f0f21f891?s=128&d=identicon&r=PG", "display_name": "Dygnus", "link": "https://stackoverflow.com/users/1369587/dygnus"}, "edited": false, "score": 0, "creation_date": 1524604997, "post_id": 50010819, "comment_id": 87038367, "body": "I think I&#39;m being stupid, the anonymous function is invoked after the creation of the chain, which will probably be the value of the last time <code>next</code> has been set (so the last middleware). Which will always cause the function to point to itself. Isn&#39;t it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524605129, "post_id": 50010819, "comment_id": 87038406, "body": "You only have one <code>next</code> variable here at all. If you don&#39;t reuse the same one each time, they won&#39;t all be the same value at the end. (I&#39;m not sure exactly what you&#39;re trying to do here, because this code isn&#39;t valid)"}], "answers": [{"comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1524607691, "post_id": 50011098, "comment_id": 87039249, "body": "I think you also have to make a copy of <code>middlew</code> for the same reason (it&#39;s the same variable every time through the loop)."}, {"owner": {"reputation": 572, "user_id": 1369587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45b8df80bdc328da043f13f0f21f891?s=128&d=identicon&r=PG", "display_name": "Dygnus", "link": "https://stackoverflow.com/users/1369587/dygnus"}, "edited": false, "score": 0, "creation_date": 1524640871, "post_id": 50011098, "comment_id": 87048695, "body": "You guys are hero&#39;s! That makes sense. I did copy the <code>next</code> variable in a previous attempt, hadn&#39;t thought about copying <code>middlew</code>. Thanks guys!"}], "tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": true, "score": 3, "last_activity_date": 1524608743, "last_edit_date": 1524608743, "creation_date": 1524606127, "answer_id": 50011098, "question_id": 50010819, "link": "https://stackoverflow.com/questions/50010819/recursion-when-overwriting-in-variable/50011098#50011098", "title": "Recursion when overwriting in variable", "body": "<p>Seems this is a closure variable in loop problem. You are creating a function which is capturing <code>next</code> in each loop, but what this will mean is that all of the functions share the same variable <code>next</code> and they will all have the value that is left on the last loop. I think you can fix it by introducing a new temporary variable inside the loop scope:</p>\n\n<pre><code>func createChain(collection []MiddlewareInterface, handler http.Handler) http.Handler\n    next := handler\n\n    for _, middlew := range collection {\n        thisNext:= next\n        mw := middlew\n        next = func(w http.ResponseWriter, res *http.Request) {\n            mw.Run(w, res, thisNext)\n        }\n    }\n\n    return next\n}\n</code></pre>\n\n<p>Possibly the placement of the new variable definition isn't quite right but the closure issue will definitely be the source of your problem. It's not normally how http middleware handlers work as they normally wrap each other rather than being chained.</p>\n"}], "owner": {"reputation": 572, "user_id": 1369587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c45b8df80bdc328da043f13f0f21f891?s=128&d=identicon&r=PG", "display_name": "Dygnus", "link": "https://stackoverflow.com/users/1369587/dygnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 50011098, "answer_count": 1, "score": 0, "last_activity_date": 1524608743, "creation_date": 1524604556, "question_id": 50010819, "link": "https://stackoverflow.com/questions/50010819/recursion-when-overwriting-in-variable", "title": "Recursion when overwriting in variable", "body": "<p>I hope you can help me out since this gave me quite a headache.</p>\n\n<p>I'm creating a chain for the middleware which is executed afterwards. But it looks like it has become recurring. The variable <code>next</code> within the anonymous function points to itself.</p>\n\n<pre><code>type MiddlewareInterface interface {\n    // Run the middleware for the given request, and receive the next handler.\n    Run(http.ResponseWriter, *http.Request, http.Handler)\n}\n\ncreateChain(collection []MiddlewareInterface, handler http.Handler) http.Handler\n    next := handler\n\n    for _, middlew := range collection {\n        next = func(w http.ResponseWriter, res *http.Request) {\n            middlew.Run(w, res, next)\n        }\n    }\n\n    return next\n}\n</code></pre>\n\n<p>I know it's kind of a noob question, but I sincerely do want to understand what causes this and how this can be resolved. Looking forward to your answers!</p>\n"}, {"tags": ["c", "go", "ffmpeg", "cgo"], "comments": [{"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1524713993, "post_id": 50010555, "comment_id": 87085018, "body": "I got this working, saving my image, by writing a save file function in C and calling that from Go. It would still be interesting to see how this would work though. I think the problem is with the .Data() function call not returning the right thing, or my understanding of what to do with that to get the right type to pass around... which i really need now for gl.DrawPixels :/"}, {"owner": {"reputation": 702, "user_id": 1782065, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0504252889cd793223f6525d0f71fc1?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1782065/andrew"}, "edited": false, "score": 0, "creation_date": 1524791508, "post_id": 50010555, "comment_id": 87124247, "body": "Can you post what code you used? I am about to tackle this and will post something if I work it out"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "reply_to_user": {"reputation": 702, "user_id": 1782065, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/f0504252889cd793223f6525d0f71fc1?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1782065/andrew"}, "edited": false, "score": 0, "creation_date": 1524820981, "post_id": 50010555, "comment_id": 87134841, "body": "@Andrew sure, I added the working C save function that I&#39;m using. This question has a better example of what I&#39;m trying to do I think: <a href=\"https://stackoverflow.com/questions/50046388/how-to-pass-a-go-array-pointer-to-gldrawpixels?noredirect=1#comment87109166_50046388\" title=\"how to pass a go array pointer to gldrawpixels\">stackoverflow.com/questions/50046388/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "is_accepted": false, "score": 0, "last_activity_date": 1595247304, "creation_date": 1595247304, "answer_id": 62995182, "question_id": 50010555, "link": "https://stackoverflow.com/questions/50010555/how-do-i-write-to-a-file-in-golang-using-a-pointer-to-the-c-data/62995182#62995182", "title": "How do I write to a file in Golang using a pointer to the C data?", "body": "<p>I had the same issue:\nA C function allocated space and gave a pointer to that space and the size to read.\nI solved it by doing:</p>\n<pre class=\"lang-c prettyprint-override\"><code>buffer := *(*[]byte)(unsafe.Pointer(&amp;content))\n</code></pre>\n<p>this transforms the pointer to a Golang byte array at the address of content.\n<code>buffer</code> gets filled with data from <code>os.Read</code> and the C function handles the data.</p>\n"}], "owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 940, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1595247304, "creation_date": 1524603067, "last_edit_date": 1524824360, "question_id": 50010555, "link": "https://stackoverflow.com/questions/50010555/how-do-i-write-to-a-file-in-golang-using-a-pointer-to-the-c-data", "title": "How do I write to a file in Golang using a pointer to the C data?", "body": "<p>I'm writing an app for the windows platform using FFmpeg and it's golang wrapper goav, but I'm having trouble understanding how to use the C pointers to gain access to an array.</p>\n\n<p>I'm trying to write the frame data, pointed to by a uint8 pointer from C, to a .ppm file in golang. </p>\n\n<p><em>Once I have this done, for proof of concept that FFmpeg is doing what I expect it to, I want to set the frames to a texture in OpenGl to make a video player with cool transitions; any pointers to do that nice and efficiently would be so very helpful! I'm guessing I need to write some shader code to draw the ppm as a texture...</em></p>\n\n<p>The <a href=\"http://netpbm.sourceforge.net/doc/ppm.html\" rel=\"nofollow noreferrer\">PPM file structure</a> looks pretty simple just the header and then a byte of data for each red, green and blue value of each pixel in the frame from top left to bottom right</p>\n\n<p>I'm starting to understanding how to cast the pointers between C and Go types, but how can I access the data and write it in Go with the same result as C? In C I just have to set the pointer offset for the data and state how much of it to write:</p>\n\n<pre><code>for (y = 0; y &lt; height; y++) {\n    fwrite(pFrame-&gt;data[0]+y*pFrame-&gt;linesize[0], 1, width*3, pFile);\n}\n</code></pre>\n\n<p>I've stripped out all the relevant parts of the C code, the wrapper and my code, shown below:</p>\n\n<p>C code - libavutil/frame.h</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n\ntypedef struct AVFrame {\n#define AV_NUM_DATA_POINTERS 8\n    uint8_t *data[AV_NUM_DATA_POINTERS];\n    int linesize[AV_NUM_DATA_POINTERS];\n}\n</code></pre>\n\n<p>Golang goav wrapper</p>\n\n<pre><code>package avutil\n\n/*\n    #cgo pkg-config: libavutil\n    #include &lt;libavutil/frame.h&gt;\n    #include &lt;stdlib.h&gt;\n*/\nimport \"C\"\nimport (\n    \"unsafe\"\n)\n\ntype Frame C.struct_AVFrame\n\nfunc Data(f *Frame) *uint8 {\n    return (*uint8)(unsafe.Pointer((*C.uint8_t)(unsafe.Pointer(&amp;f.data))))\n}\nfunc Linesize(f *Frame) int {\n    return int(*(*C.int)(unsafe.Pointer(&amp;f.linesize)))\n}\n</code></pre>\n\n<p>My Golang code</p>\n\n<pre><code>package main\n\nimport \"github.com/giorgisio/goav/avutil\"\n\nfunc saveFrame(videoFrame *avutil.Frame, width int, height int, iFrame int) {\n    var szFilename string\n    var y int\n    var file *os.File\n    var err error\n\n    szFilename = \"\"\n\n    // Open file\n    szFilename = fmt.Sprintf(\"frame%d.ppm\", iFrame)\n\n    if file, err = os.Create(szFilename); err != nil {\n        log.Println(\"Error Reading\")\n    }\n\n    // Write header\n    fh := []byte(fmt.Sprintf(\"P6\\n%d %d\\n255\\n\", width, height))\n    file.Write(fh)\n    var b byte = 0\n    // Write pixel data\n    for y = 0; y &lt; height; y++ {\n        d := avutil.Data(videoFrame) // d should be a pointer to the first byte of data\n        l := avutil.Linesize(videoFrame)\n\n        // I'm basically lost trying to figure out how to correctly write\n        // this to a file, the file is created, but when I open it in GIMP\n        // the image is mostly black with glitchy fuzz - so it's not being\n        // written properly; the header seems to be ok, it knows the height\n        // and width at least.\n\n        data := make([]byte, l*3)\n\n        ptr := unsafe.Pointer(d)\n        for i := 0; i &lt; l; i++ {\n            datum := (*uint8)(unsafe.Pointer(uintptr(ptr) + (uintptr(i)+(uintptr(y)*uintptr(l)))*unsafe.Sizeof(*d)))\n            data = append(data, *datum)\n            //fmt.Println(*datum)\n        }\n\n        n, err := file.Write(data)\n        if err != nil {\n            log.Println(\"Error Writing:\", szFilename, \"-\", n)\n        }\n    }\n\n    file.Close()\n}\n</code></pre>\n\n<p>So, how can I write to a file using a pointer to the data, like you can do in C, and get the same result?</p>\n\n<p>The first frame should be black so all 0's but I'm getting a glitchy fuzz, so it must be accessing some random data</p>\n\n<p><strong>Update:</strong> My fix using a C function to save:</p>\n\n<pre><code>package avutil\n\n/*\n    #cgo pkg-config: libavutil\n    #include &lt;libavutil/frame.h&gt;\n    #include &lt;stdlib.h&gt;\n    #include &lt;stdio.h&gt;\n\n    void SaveFrame(const char* location, AVFrame *pFrame, int width, int height) {\n        FILE *pFile;\n        int  y;\n\n        // Open file\n        pFile=fopen(location, \"wb\");\n        if(pFile==NULL)\n            return;\n\n        // Write header\n        fprintf(pFile, \"P6\\n%d %d\\n255\\n\", width, height);\n\n        // Write pixel data\n        for(y=0; y&lt;height; y++)\n            fwrite(pFrame-&gt;data[0]+y*pFrame-&gt;linesize[0], 1, width*3, pFile);\n\n        // Close file\n        fclose(pFile);\n    }\n    uint8_t* GetData(AVFrame *pFrame) {\n        return pFrame-&gt;data[0];\n    }\n*/\nimport \"C\"\n</code></pre>\n\n<p>I updated the avutil file, in the goav wrapper package, with this save function at the top, then pass it the frame context so it can get the data pointer from it. I also added this Go function to that avutil file to call the C function</p>\n\n<pre><code>func SaveFrame(location string, f *Frame, width int, height int) {\n    csLoc := C.CString(location)\n    C.SaveFrame(csLoc, (*C.struct_AVFrame)(unsafe.Pointer(f)), C.int(width), C.int(height))\n    C.free(unsafe.Pointer(csLoc))\n}\n</code></pre>\n"}, {"tags": ["go", "intellij-idea"], "comments": [{"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1524689446, "post_id": 50008856, "comment_id": 87078294, "body": "Which IDE version/go plugin version are you using? Have you tried setting the Go SDK via Settings | Go | GOROOT? Does the problem still exist?"}, {"owner": {"reputation": 619, "user_id": 2958603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5Qw.jpg?s=128&g=1", "display_name": "buddha", "link": "https://stackoverflow.com/users/2958603/buddha"}, "reply_to_user": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1524762279, "post_id": 50008856, "comment_id": 87113123, "body": "IDE version: IU-172.3317.76 Go plugin version: v172.3317-EAP-CANDIDATE-SNAPSHOT.20 There are not Go  in the Settings.  Yes, the problem still exist."}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1524774430, "post_id": 50008856, "comment_id": 87118982, "body": "You need to use IntelliJ IDEA Ultimate 2017.3 or newer to be able to install the Go plugin supported by JetBrains. In IDEA you&#39;ll find the settings under Settings | Language &amp; Frameworks | Go | GOROOT"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1524596584, "post_id": 50009051, "comment_id": 87034690, "body": "That plugin is not compatible with the current version of Intellij, btw.  They discontinued it in favor of the official one, which is unfortunately only available in the paid version of Intellij now."}, {"owner": {"reputation": 619, "user_id": 2958603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5Qw.jpg?s=128&g=1", "display_name": "buddha", "link": "https://stackoverflow.com/users/2958603/buddha"}, "edited": false, "score": 0, "creation_date": 1524771318, "post_id": 50009051, "comment_id": 87117561, "body": "After I upgrade the idea and go-lang plugin to 2018 version, it worked."}], "tags": [], "owner": {"reputation": 1327, "user_id": 1110636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709ba1cdc862cffcbab3c518209e634d?s=128&d=identicon&r=PG", "display_name": "Timir", "link": "https://stackoverflow.com/users/1110636/timir"}, "is_accepted": true, "score": 1, "last_activity_date": 1599340079, "last_edit_date": 1599340079, "creation_date": 1524596369, "answer_id": 50009051, "question_id": 50008856, "link": "https://stackoverflow.com/questions/50008856/idea-display-cannot-resolve-file-fmt/50009051#50009051", "title": "Idea display Cannot resolve file &quot;fmt&quot;", "body": "<p>Which go-lang plugin are you using?</p>\n<p>In any case, define a go SDK under platform settings. Make sure you include your local <code>GOPATH</code> under classpath.</p>\n<p>Also see: <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1368\" rel=\"nofollow noreferrer\">https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1368</a></p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5129439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b109a9cd88cc7a4e2137d47dd0ca7fcd?s=128&d=identicon&r=PG&f=1", "display_name": "Sniper Law", "link": "https://stackoverflow.com/users/5129439/sniper-law"}, "is_accepted": false, "score": 0, "last_activity_date": 1539336477, "creation_date": 1539336477, "answer_id": 52776450, "question_id": 50008856, "link": "https://stackoverflow.com/questions/50008856/idea-display-cannot-resolve-file-fmt/52776450#52776450", "title": "Idea display Cannot resolve file &quot;fmt&quot;", "body": "<p>I also encountered this problem and has solved it after downgrading golang version from 1.11 to 1.9.5.</p>\n\n<p>I am using Idea2017.1.6 for community, and the go plugin came from <a href=\"https://plugins.jetbrains.com/plugin/5047-go-language-golang-org-support-plugin\" rel=\"nofollow noreferrer\">here</a>, which is developed by google. As of now, only idea2017.1 and earlier version are compatible.</p>\n\n<p>BTW, <a href=\"http://%20https://plugins.jetbrains.com/plugin/9568-go\" rel=\"nofollow noreferrer\">go plugin developed by jetbrains</a> is only available from ultimate version.</p>\n"}], "owner": {"reputation": 619, "user_id": 2958603, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5Qw.jpg?s=128&g=1", "display_name": "buddha", "link": "https://stackoverflow.com/users/2958603/buddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3665, "favorite_count": 0, "accepted_answer_id": 50009051, "answer_count": 2, "score": 0, "last_activity_date": 1599340079, "creation_date": 1524595634, "question_id": 50008856, "link": "https://stackoverflow.com/questions/50008856/idea-display-cannot-resolve-file-fmt", "title": "Idea display Cannot resolve file &quot;fmt&quot;", "body": "<p>I am using Idea to develop the golang program, I have set the go root and go path. And I have added go plugin for the Idea. The Idea also warn that Cannot resolve file \"fmt\". But the program works normally.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nfunc main() {\n    fmt.Println(\"Hello, World!\")\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/uhvp2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uhvp2.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want the Idea give me the right message. How can I solve this issue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1524593819, "post_id": 50008381, "comment_id": 87033239, "body": "<a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">tour.golang.org/methods/16</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1524593821, "post_id": 50008381, "comment_id": 87033243, "body": "You could use a <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">type switch</a>."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1524596452, "post_id": 50008579, "comment_id": 87034622, "body": "Use <code>v := x.(type)</code> in the switch.  That way you don&#39;t have to put a separate type assertion in each case."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1524654641, "post_id": 50008579, "comment_id": 87057173, "body": "Rather than json, also could have done: <code>v, _ = strconv.ParseFloat(fmt.Sprint(x),64)</code>, but yes, don&#39;t do that"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 4, "last_activity_date": 1524596783, "last_edit_date": 1524596783, "creation_date": 1524594506, "answer_id": 50008579, "question_id": 50008381, "link": "https://stackoverflow.com/questions/50008381/golang-assert-any-number-to-float/50008579#50008579", "title": "Golang assert any number to float", "body": "<p>The right way to do it would be like so: <a href=\"https://play.golang.org/p/_evcLsjcXY-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_evcLsjcXY-</a></p>\n\n<pre><code>var x interface{}\nx = int64(12)\nvar y float64\nswitch v := x.(type) {\ncase int:\n    y = float64(v)\ncase int8:\n    y = float64(v)\ncase int16:\n    y = float64(v)\ncase int32:\n    y = float64(v)\ncase int64:\n    y = float64(v)\ncase uint:\n    y = float64(v)\ncase uint8:\n    y = float64(v)\ncase uint16:\n    y = float64(v)\ncase uint32:\n    y = float64(v)\ncase uint64:\n    y = float64(v)\ncase float32:\n    y = float64(v)\ncase float64:\n    y = v\n}\nfmt.Println(y)\n</code></pre>\n\n<p>If you don't care about performance / safety / etc., and just want something short (don't do this):</p>\n\n<pre><code>var x interface{}\nx = int64(12)\ntmp, _ := json.Marshal(x)\nvar y float64\njson.Unmarshal(tmp, &amp;y)\nfmt.Println(y)\n</code></pre>\n\n<p>Or, you could use reflection <a href=\"https://play.golang.org/p/QYQP00KicmF\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QYQP00KicmF</a>:</p>\n\n<pre><code>import \"reflect\"\n\nvar floatType = reflect.TypeOf(float64(0))\n\nfunc getFloat(unk interface{}) (float64, error) {\n    v := reflect.ValueOf(unk)\n    v = reflect.Indirect(v)\n    if !v.Type().ConvertibleTo(floatType) {\n        return 0, fmt.Errorf(\"cannot convert %v to float64\", v.Type())\n    }\n    fv := v.Convert(floatType)\n    return fv.Float(), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9692792, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "bmtl", "link": "https://stackoverflow.com/users/9692792/bmtl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524596783, "creation_date": 1524593753, "last_edit_date": 1524593857, "question_id": 50008381, "link": "https://stackoverflow.com/questions/50008381/golang-assert-any-number-to-float", "title": "Golang assert any number to float", "body": "<p>I'm using a library that accepts only <code>float64</code> as a function argument but my code can post any type of numbers in an <code>interface{}</code>, meaning <code>int, int8, int16, int32, int64, uint, uint8, uint16, uint32, uint64, float32, float64</code>. </p>\n\n<p>How can I write an elegant function that assert for all these types ?</p>\n\n<p>I was thinking of something like: </p>\n\n<pre><code>if i, ok := event.Value.(int); ok {\n value = float64(i)\n} else if f, ok := event.Value.(float64); ok {\n value = f\n} else { \n  ... error and return\n}\n</code></pre>\n\n<p>with one <code>else if</code> per type.</p>\n\n<p>I'm sure there's something more efficient/elegant somewhere!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["reactjs", "go", "gorilla", "mux"], "answers": [{"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1524596795, "post_id": 50008665, "comment_id": 87034796, "body": "My other routes work with r.HanddleFunc, why does PathPrefix want something so different?"}, {"owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "reply_to_user": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1524605957, "post_id": 50008665, "comment_id": 87038653, "body": "Well you are using the <code>Handler</code> method. Maybe you were using the <code>HandlerFunc</code> method in the other cases? <a href=\"https://github.com/gorilla/mux/blob/077b44c2cf82958550c79f5885ee64900cdcee22/route.go#L118-L123\" rel=\"nofollow noreferrer\">github.com/gorilla/mux/blob/&hellip;</a> vs <a href=\"https://github.com/gorilla/mux/blob/077b44c2cf82958550c79f5885ee64900cdcee22/route.go#L125-L128\" rel=\"nofollow noreferrer\">github.com/gorilla/mux/blob/&hellip;</a>  I&#39;m updating my answer to show how you could avoid having to wrap it in the <code>http.HandlerFunc()</code>."}], "tags": [], "owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "is_accepted": true, "score": 2, "last_activity_date": 1524606018, "last_edit_date": 1524606018, "creation_date": 1524594928, "answer_id": 50008665, "question_id": 50008257, "link": "https://stackoverflow.com/questions/50008257/how-to-set-up-a-route-to-serve-reactjs-app/50008665#50008665", "title": "How to set up a route to serve reactjs app?", "body": "<p>Your http handler needs a <code>ServeHTTP</code> method. If you pass your function to <code>http.HandlerFunc</code>, that will be introduced for you:</p>\n\n<pre><code>app.PathPrefix(\"/\").Handler(http.HandlerFunc(serveReact))\n\nfunc serveReact(w http.ResponseWriter, r *http.Request) {\n}\n</code></pre>\n\n<blockquote>\n  <p>The HandlerFunc type is an adapter to allow the use of ordinary functions as HTTP handlers. If f is a function with the appropriate signature, HandlerFunc(f) is a Handler that calls f.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/src/net/http/server.go\" rel=\"nofollow noreferrer\">source</a></p>\n\n<pre><code>type HandlerFunc func(ResponseWriter, *Request)\n\n// ServeHTTP calls f(w, r).\nfunc (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\n    f(w, r)\n}\n</code></pre>\n\n<p>Similarly, you could use the mux router <code>HandlerFunc</code> instead:</p>\n\n<pre><code>app.PathPrefix(\"/\").HandlerFunc(serveReact)\n\nfunc serveReact(w http.ResponseWriter, r *http.Request) {\n}\n</code></pre>\n\n<p>This essentially performs both steps for you in a combined single step.</p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 50008665, "answer_count": 1, "score": -1, "last_activity_date": 1554789832, "creation_date": 1524593312, "last_edit_date": 1554789832, "question_id": 50008257, "link": "https://stackoverflow.com/questions/50008257/how-to-set-up-a-route-to-serve-reactjs-app", "title": "How to set up a route to serve reactjs app?", "body": "<p>I'm trying to set up a route to serve my reactjs application.</p>\n\n<p>I have my index.html and bundle.js in the public folder</p>\n\n<pre><code>/public/index.html\n/public/bundle.js\n</code></pre>\n\n<p>I'm using go as my backend API, and also to serve my reactjs app.</p>\n\n<p>I created a subroute for my app like:</p>\n\n<pre><code>r := mux.NewRouter()\n\napp := r.Host(\"app.example.com\").Subrouter()\n</code></pre>\n\n<p>So any request with app as the subdomain will be for my Reactjs app.</p>\n\n<p>So now I have to serve every request regardless of the URL to my reactjs app.</p>\n\n<p>Is path prefix what I need here?</p>\n\n<p>I tried this:</p>\n\n<pre><code>app.PathPrefix(\"/\").Handler(serveReact)\n\nfunc serveReact(w http.ResponseWriter, r *http.Request) {\n}\n</code></pre>\n\n<p>But I get this error:</p>\n\n<blockquote>\n  <p>cannot use serveReact (type func() http.Handler) as type http.Handler\n  in argument to app.PathPrefix(\"/\").Handler:   func() http.Handler does\n  not implement http.Handler (missing ServeHTTP method)</p>\n</blockquote>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1524586113, "post_id": 50006291, "comment_id": 87029092, "body": "That&#39;s not how JSON does or should work. If you want a string you should really have a string in the JSON."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1524586154, "post_id": 50006291, "comment_id": 87029111, "body": "Set that field as a <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a>.  It&#39;ll be stored as is, without interpretation (ie. as <code>&quot;[1,2,3,4]&quot;</code>), as a slice of bytes, which can be converted to a string easily enough.  If you need a string directly, you&#39;ll have to implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">json.Unmarshaler interface</a> on your type and do the conversion yourself."}, {"owner": {"reputation": 9249, "user_id": 456809, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a8e60ef50534769dba78843acf8bb82d?s=128&d=identicon&r=PG", "display_name": "Breedly", "link": "https://stackoverflow.com/users/456809/breedly"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1524588857, "post_id": 50006291, "comment_id": 87030640, "body": "@Kaedys that works! Would you mind leaving that as the answer below so that you can claim it?"}, {"owner": {"reputation": 9249, "user_id": 456809, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a8e60ef50534769dba78843acf8bb82d?s=128&d=identicon&r=PG", "display_name": "Breedly", "link": "https://stackoverflow.com/users/456809/breedly"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1524588866, "post_id": 50006291, "comment_id": 87030644, "body": "@Adrian haha that&#39;s pretty funny."}, {"owner": {"reputation": 1509, "user_id": 4815767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc24bfa1708763d1853a48c6290fbcaa?s=128&d=identicon&r=PG", "display_name": "Popmedic", "link": "https://stackoverflow.com/users/4815767/popmedic"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1524593481, "post_id": 50006291, "comment_id": 87033056, "body": "@Breedly, I think @Adrian is being serious, it should be a string if you want a string, i.e.: <code>{&quot;a&quot;:1, &quot;b&quot;:&quot;[1,2,3,4]&quot;}</code> is what the JSON should be if you want a string, that is JSON, out of it."}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1524590226, "creation_date": 1524590226, "answer_id": 50007484, "question_id": 50006291, "link": "https://stackoverflow.com/questions/50006291/go-unmarshal-json-but-unmarshal-nested-structure-as-a-string/50007484#50007484", "title": "Go Unmarshal JSON, but unmarshal nested structure as a string", "body": "<p>Set the field as a <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a>. It'll be stored as is, without interpretation (ie. as <code>\"[1,2,3,4]\"</code>), as a slice of bytes, which can be converted to a string easily enough.</p>\n\n<p>If you need a string directly, you'll have to implement the <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\">json.Unmarshaler interface</a> on your type and do the conversion yourself.</p>\n"}], "owner": {"reputation": 9249, "user_id": 456809, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a8e60ef50534769dba78843acf8bb82d?s=128&d=identicon&r=PG", "display_name": "Breedly", "link": "https://stackoverflow.com/users/456809/breedly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 50007484, "answer_count": 1, "score": -1, "last_activity_date": 1524590226, "creation_date": 1524585995, "question_id": 50006291, "link": "https://stackoverflow.com/questions/50006291/go-unmarshal-json-but-unmarshal-nested-structure-as-a-string", "title": "Go Unmarshal JSON, but unmarshal nested structure as a string", "body": "<p>Given the following JSON object:</p>\n\n<pre><code>{\n\"a\": 1,\n\"b\": [1,2,3,4]\n}\n</code></pre>\n\n<p>And the following <code>type</code>:</p>\n\n<pre><code>type Thing struct {\n  A Int `json:\"a\"`\n  B string `json:\"b\"\n}\n</code></pre>\n\n<p>I would like the Array \"b\" to stay as a JSON string when marshalled into go.</p>\n\n<p>I currently get the following error:</p>\n\n<p><code>panic: json: cannot unmarshal array into Go struct field Thing.b of type string</code></p>\n"}, {"tags": ["go", "kubernetes", "grpc", "istio"], "comments": [{"owner": {"reputation": 2137, "user_id": 90797, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/7pblP.jpg?s=128&g=1", "display_name": "Virmundi", "link": "https://stackoverflow.com/users/90797/virmundi"}, "edited": false, "score": 1, "creation_date": 1548249783, "post_id": 50005666, "comment_id": 95474452, "body": "I think the IP you&#39;re testing with is a virtual one. Like 192.168. If it runs outside of the pod, which I inferred from your question but fails within, are you using the right IP address?"}], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 6713869, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207140073075709/picture?type=large", "display_name": "Rodrigo Loza", "link": "https://stackoverflow.com/users/6713869/rodrigo-loza"}, "is_accepted": true, "score": 0, "last_activity_date": 1569676347, "creation_date": 1569676347, "answer_id": 58146648, "question_id": 50005666, "link": "https://stackoverflow.com/questions/50005666/go-grpc-routing-without-specifying-port/58146648#58146648", "title": "go gRPC routing without specifying port", "body": "<p>If it is working internally in the pod, then you only need to expose it. You can do it by adding a yaml definition for a service. Like the following.</p>\n\n<pre><code>apiVersion: v1\nkind: Service\nmetadata:\n  namespace: $YOUR_NAMESPCAE\n  labels:\n    app: $YOUR_SERVICE_NAME\n  name: $YOUR_SERVICE_NAME\nspec:\n  ports:\n  - name: $YOUR_GRCP_PORT\n    port: $YOUR_GRCP_PORT\n    targetPort: $YOUR_GRCP_PORT\n  selector:\n    app: $YOUR_SERVICE_NAME\nstatus:\n  loadBalancer: {}\n</code></pre>\n\n<p>Note that where it says <code>$YOUR_GRCP_PORT</code>you define the grcp port you will expose. </p>\n\n<p>Now you only need to edit the ingress you mentioned. It should be something like the following.</p>\n\n<pre><code>apiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: vizix-ingress\n  namespace: preprod-vizix-io\n  annotations:\n    kubernetes.io/ingress.class: nginx\n    nginx.ingress.kubernetes.io/rewrite-target: \"/\"\nspec:\n  rules:\n  - http:\n      paths:\n      - path: /\n        backend:\n          serviceName: $YOUR_SERVICE_NAME\n          servicePort: $YOUR_GRCP_PORT\n</code></pre>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 0, "accepted_answer_id": 58146648, "answer_count": 1, "score": 6, "last_activity_date": 1569676347, "creation_date": 1524584059, "question_id": 50005666, "link": "https://stackoverflow.com/questions/50005666/go-grpc-routing-without-specifying-port", "title": "go gRPC routing without specifying port", "body": "<p>New to gRPC:</p>\n\n<p>Having a gRPC client, how do you use routing?</p>\n\n<p>My gRPC server is at this local path <code>10.0.1.6/hw</code>.</p>\n\n<p>It is running and listening in a Kubernetes pod and it is working internally, if I run it in a pod. But I am now accessing it via url and ingress.</p>\n\n<p>But how do I test that it actually is working with the routing without a port number?</p>\n\n<pre><code>const (\n    address     = \"10.0.1.6:80/hw\"\n    defaultName = \"World\"\n)\n\nvar (\n    conn *grpc.ClientConn\n    c    pb.GreeterClient\n)\n\nfunc setupRPC() {\n\n    var err error\n    conn, err = grpc.Dial(address, grpc.WithInsecure())\n    c = pb.NewGreeterClient(conn)\n    if err != nil {\n        log.Fatalf(\"did not connect: %v\", err)\n    }\n\n}\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>could not greet: rpc error: code = Unavailable desc = all SubConns are in TransientFailure, latest connection error: connection error: desc = \"transport: Error while dialing dial tcp: lookup tcp/80/hw: nodename nor servname provided, or not known\"\n</code></pre>\n\n<p>Do you know how? Or how to test gRPC endpoints?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1524583630, "post_id": 50005326, "comment_id": 87027396, "body": "You&#39;re problem is IO bound, the goroutine is only adding extra overhead. Start by using buffered IO to improve performance. (also, reading the counter value directly defeats the purpose of using atomics)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1524583867, "post_id": 50005326, "comment_id": 87027562, "body": "There aren&#39;t any hard restrictions on buffer size.  A buffered channel has functionally the same memory footprint as an array of that type.  In this case, it&#39;s a channel of strings, which are each two machine words long.  Thus the memory footprint of your channel buffer will be 16 (or 8, on 32-bit systems) bytes multiplied by the buffer size.  A million-sized buffer is still only ~16 MB."}, {"owner": {"reputation": 439, "user_id": 1290778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9c090234ad04870da1952229d6b622c?s=128&d=identicon&r=PG", "display_name": "phanteh", "link": "https://stackoverflow.com/users/1290778/phanteh"}, "edited": false, "score": 0, "creation_date": 1524584295, "post_id": 50005326, "comment_id": 87027866, "body": "Thank you both, some good info there! On the atomic - it&#39;s not being used properly here I know (still playing with the structure etc), but thanks for the pointer on reading directly, will probably save me some headaches down the line!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1524584643, "post_id": 50005326, "comment_id": 87028120, "body": "Also note that once your data generation is fast enough to outpace the writer (i.e., once IO is your bottleneck), continuing to buffer does nothing but increase memory usage. It won&#39;t get any faster than it can write to disk. Your data generation might as well just wait until more has been written to disk unless there is some particular reason not to."}, {"owner": {"reputation": 439, "user_id": 1290778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9c090234ad04870da1952229d6b622c?s=128&d=identicon&r=PG", "display_name": "phanteh", "link": "https://stackoverflow.com/users/1290778/phanteh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1524584960, "post_id": 50005326, "comment_id": 87028325, "body": "Yeah I realise the bottleneck is IO - but it was still a bit quicker to throw the data as it was generated onto the channel. @JimB the bufferedIO writer has slashed my write time down to ~6s! It doesn&#39;t seem to benefit from a buffer size of more than 50 or so..."}], "owner": {"reputation": 439, "user_id": 1290778, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9c090234ad04870da1952229d6b622c?s=128&d=identicon&r=PG", "display_name": "phanteh", "link": "https://stackoverflow.com/users/1290778/phanteh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 925, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1524583220, "creation_date": 1524583220, "question_id": 50005326, "link": "https://stackoverflow.com/questions/50005326/go-channel-buffer-length-best-practice", "title": "Go channel buffer length - best practice", "body": "<p>I'm currently learning Go and have started to re-write a test-data-generation program I originally wrote in Java. I've been intrigued by Go's channels / threading possibilities, as many of the programs I've written have been focused around load testing a system / recording various metrics.</p>\n\n<p>Here, I am creating some data to be written out to a CSV file. I started out by generating all of the data, then passing that off to be written to a file. I then thought I'd try and implement a channel, so data could be written while it's still being generated.</p>\n\n<p>It worked - it almost eliminated the overhead of generating the data first and <em>then</em> writing it. However, I found that this only worked if I had a channel with a buffer big enough to cope with all of the test data being generated: <code>c := make(chan string, count)</code>, where count is the same size as the number of test data lines I am generating.</p>\n\n<p>So, to my question: I'm regularly generating millions of records of test data (load test applications) - should I be using a channel with a buffer that large? I can't find much about restrictions on the size of the buffer?</p>\n\n<p>Running the below with a 10m count completes in ~59.5s; generating the data up front and writing it all to a file takes ~62s; using a buffer length of 1 - 100 takes ~80s.</p>\n\n<pre><code>const externalRefPrefix = \"Ref\"\nconst fileName = \"citizens.csv\"\n\nvar counter int32 = 0\n\nfunc WriteCitizensForApplication(applicationId string, count int) {\n    file, err := os.Create(fileName)\n\n    if err != nil {\n        panic(err)\n    }\n\n    defer file.Close()\n\n    c := make(chan string, count)\n\n    go generateCitizens(applicationId, count, c)\n\n    for line := range c {\n        file.WriteString(line)\n    }\n}\n\nfunc generateCitizens(applicationId string, count int, c chan string) {\n    for i := 0; i &lt; count; i++ {\n        c &lt;- fmt.Sprintf(\"%v%v\\n\", applicationId, generateExternalRef())\n    }\n    close(c)\n}\n\nfunc generateExternalRef() string {\n    atomic.AddInt32(&amp;COUNTER, 1)\n    return fmt.Sprintf(\"%v%08d\", externalRefPrefix, counter)\n}\n</code></pre>\n"}, {"tags": ["go", "cookies", "client"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1524582278, "post_id": 50004796, "comment_id": 87026391, "body": "Don&#39;t just print errors and continue -- the <code>http.Response</code> can&#39;t be used if there was an error."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1524583416, "post_id": 50004796, "comment_id": 87027217, "body": "Also stop ignoring errors.  There are 3 places in that code where you&#39;re dumping an error return value into an underscore.  Check the errors, you can&#39;t just assume everything succeeds.  If it returns an error, it&#39;s because that function might fail.  And the panic stacktrace will specify exactly where in your code the failure happened."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 4, "creation_date": 1524583619, "post_id": 50004796, "comment_id": 87027388, "body": "One thing that strikes me is that you&#39;re creating an http.Request as a literal.  The Request struct has a map, Header, that you&#39;re not initializing.  Use http.NewRequest() instead."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1524584284, "post_id": 50004796, "comment_id": 87027863, "body": "It would be helpful to point out which line of the quoted code results in the quoted error."}, {"owner": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "edited": false, "score": 0, "creation_date": 1524657794, "post_id": 50004796, "comment_id": 87059397, "body": "Panic accor in the second <b>client.Do</b> .if i do not use the cookies i was ok but i could not keep the cokies."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "edited": false, "score": 0, "creation_date": 1524657597, "post_id": 50005803, "comment_id": 87059270, "body": "i want to define the request by myself but no to use the <b>http.NewRequest</b> or <b>client.PostForm</b>"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 2, "last_activity_date": 1524584512, "creation_date": 1524584512, "answer_id": 50005803, "question_id": 50004796, "link": "https://stackoverflow.com/questions/50004796/how-to-use-two-client-do-use-golang/50005803#50005803", "title": "How to use two client.Do use golang", "body": "<p>The error is not because you're using <code>client.Do</code> twice. In fact you can call it many times. Error message indicates that there is an unallocated variable (a <code>map</code>) being accessed somewhere. In your case, the variable which causing error is <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>Request.Header</code></a>. Use appropriate method to construct request, e.g. <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"nofollow noreferrer\">http.NewRequest</a>:</p>\n\n<pre><code>nodeReq, err := http.NewRequest(\"GET\", nodeUrl, nil)\n</code></pre>\n\n<p>When doing POST request for sending form content, use <a href=\"https://golang.org/pkg/net/http/#Client.PostForm\" rel=\"nofollow noreferrer\">Client.PostForm</a>, e.g.</p>\n\n<pre><code>resp, err := client.PostForm(loginUrl, v)\n</code></pre>\n\n<p>This method will set appropriate <code>Content-Type</code> header then call <code>client.Do</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "edited": false, "score": 0, "creation_date": 1524657533, "post_id": 50006524, "comment_id": 87059213, "body": "If i use https how to keep the cookies?"}, {"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "reply_to_user": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "edited": false, "score": 0, "creation_date": 1524781096, "post_id": 50006524, "comment_id": 87121697, "body": "@YuanmengXiao, cookies in https works equals to http. An way is req.Header[&quot;cookie&quot;]=[]string{&quot;cookie data&quot;}."}, {"owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "reply_to_user": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "edited": false, "score": 0, "creation_date": 1524781827, "post_id": 50006524, "comment_id": 87121898, "body": "@YuanmengXiao, if the cookies are same as resp.Cookies then <code>nodeReq.AddCookie(resp.Cookies()[0])</code> (in your code)"}], "tags": [], "owner": {"reputation": 983, "user_id": 7059119, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209343272591927/picture?type=large", "display_name": "Aristofanio Garcia", "link": "https://stackoverflow.com/users/7059119/aristofanio-garcia"}, "is_accepted": true, "score": 2, "last_activity_date": 1524587664, "last_edit_date": 1524587664, "creation_date": 1524586828, "answer_id": 50006524, "question_id": 50004796, "link": "https://stackoverflow.com/questions/50004796/how-to-use-two-client-do-use-golang/50006524#50006524", "title": "How to use two client.Do use golang", "body": "<p>Error occured in request.go (line 389):</p>\n\n<pre><code>// AddCookie adds a cookie to the request. Per RFC 6265 section 5.4,\n// AddCookie does not attach more than one Cookie header field. That\n// means all cookies, if any, are written into the same line,\n// separated by semicolon.\nfunc (r *Request) AddCookie(c *Cookie) {\n    ...\n    if c := r.Header.Get(\"Cookie\"); c != \"\" {\n        r.Header.Set(\"Cookie\", c+\"; \"+s)\n    } else {\n        r.Header.Set(\"Cookie\", s)\n    }\n}\n</code></pre>\n\n<p>See that request try to set Header. If you to make Header, will work.</p>\n\n<pre><code>nodeReq := &amp;http.Request{\n    Method: \"GET\",\n    URL:    nodeUrl,\n    TLS:    resp.TLS,\n    Header: make(Header),\n}\n</code></pre>\n\n<p>The appropriate method is http.NewRequest.\nLink: <a href=\"https://golang.org/pkg/net/http/#NewRequest\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#NewRequest</a></p>\n\n<p>In http.NewRequest (request.go line 778), the Header is created like:</p>\n\n<pre><code>req := &amp;Request{\n    Method:     method,\n    URL:        u,\n    Proto:      \"HTTP/1.1\",\n    ProtoMajor: 1,\n    ProtoMinor: 1,\n    Header:     make(Header),\n    Body:       rc,\n    Host:       u.Host,\n}\n</code></pre>\n\n<p>See also that if you use HTTP, non-HTTPS, Header not is required and too will work!!</p>\n"}, {"tags": [], "owner": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "is_accepted": false, "score": 0, "last_activity_date": 1524661582, "creation_date": 1524661582, "answer_id": 50023197, "question_id": 50004796, "link": "https://stackoverflow.com/questions/50004796/how-to-use-two-client-do-use-golang/50023197#50023197", "title": "How to use two client.Do use golang", "body": "<p>The panic accur because the <strong>Request.Header</strong> no initialize, at the second <strong>Client.Do</strong> the cookies could not add to <strong>Request.Header</strong> (NodeReq).\n<a href=\"https://stackoverflow.com/questions/24493116/how-to-send-a-post-request-in-golang\">In this link i learn how to add header by my self</a>\nOne solution is </p>\n\n<pre><code>v := url.Values{}\nv.Add(\"email\", \"1231231231@qq.com\")\nv.Add(\"passwd\", \"1231231231\")\n\nreq, err := http.NewRequest(\"POST\", \"https://pro.v2bz.com/auth/login\", strings.NewReader(v.Encode()))\nreq.PostForm = v\nreq.Header.Set(\"Content-Type\", \"application/x-www-form-urlencoded\")\n</code></pre>\n\n<p>At the second <strong>Request</strong> as @aristofanio-garcia say use</p>\n\n<pre><code>nodeReq := &amp;http.Request{\n    Method: \"GET\",\n    URL:    nodeUrl,\n    Header: make(http.Header), //add this to initialize Request.Header so the cookies could add into header\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 6819271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_ZB3c9kXsos/AAAAAAAAAAI/AAAAAAAAKuI/l6BMFts6e_8/photo.jpg?sz=128", "display_name": "Yuanmeng Xiao", "link": "https://stackoverflow.com/users/6819271/yuanmeng-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 50006524, "answer_count": 3, "score": 0, "last_activity_date": 1524661582, "creation_date": 1524581693, "question_id": 50004796, "link": "https://stackoverflow.com/questions/50004796/how-to-use-two-client-do-use-golang", "title": "How to use two client.Do use golang", "body": "<p>I use th go package net/http and i want to post to login url and then get the node page\nI want to use twice client.Do because the cookies\nHere is my code</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/http/cookiejar\"\n    \"net/url\"\n)\n\nfunc main() {\n    cookieJar, _ := cookiejar.New(nil)\n    client := &amp;http.Client{\n        Jar: cookieJar,\n    }\n\n    loginUrl, _ := url.Parse(\"https://pro.v2bz.com/auth/login\")\n\n    v := url.Values{}\n    v.Add(\"email\", \"1231231231@qq.com\")\n    v.Add(\"passwd\", \"1231231231\")\n\n    req := &amp;http.Request{\n        Method:   \"POST\",\n        URL:      loginUrl,\n        PostForm: v,\n    }\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Println(\"login failed\", err)\n    }\n    defer resp.Body.Close()\n    log.Println(resp.Status)\n\n    nodeUrl, _ := url.Parse(\"https://pro.v2bz.com/user/node\")\n    nodeReq := &amp;http.Request{\n        Method: \"GET\",\n        URL:    nodeUrl,\n    }\n\n    nodeResp, err := client.Do(nodeReq)\n    if err != nil {\n        log.Println(\"node request failed\", err)\n    }\n    log.Println(nodeResp.Status)\n}\n</code></pre>\n\n<p>But i get this error \n<strong>panic: assignment to entry in nil map</strong>\nHow could i use twice client.Do in one code?</p>\n"}, {"tags": ["go", "installation", "windows-7-x64", "cgo"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1524580004, "post_id": 50003598, "comment_id": 87024667, "body": "From windows command prompt, you need to set `CGO_FLAGS=-IC:\\Users\\Bob\\Downloads\\SDL2-2.0.8\\x86_64-w64-mi&zwnj;&#8203;ngw32\\include`, then execute <i>go get ...</i>"}, {"owner": {"reputation": 141, "user_id": 7505473, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rIybB.jpg?s=128&g=1", "display_name": "w3Charlie", "link": "https://stackoverflow.com/users/7505473/w3charlie"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1524664272, "post_id": 50003598, "comment_id": 87064160, "body": "I&#39;ve tried it, but still the same errormessage C:\\Users\\Bob&gt;set CGO_FLAGS=-IC:\\Users\\Bob\\Downloads\\SDL2-2.0.8\\x86_64-w64-min&zwnj;&#8203;gw3 2\\include  C:\\Users\\Bob&gt;go get -v github.com/veandco/go-sdl2/sdl github.com/veandco/go-sdl2/sdl # github.com/veandco/go-sdl2/sdl In file included from go\\src\\github.com\\veandco\\go-sdl2\\sdl\\audio.go:4:0: ./sdl_wrapper.h:2:23: fatal error: SDL2/SDL.h: No such file or directory compilation terminated."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7505473, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rIybB.jpg?s=128&g=1", "display_name": "w3Charlie", "link": "https://stackoverflow.com/users/7505473/w3charlie"}, "edited": false, "score": 0, "creation_date": 1524664542, "post_id": 50004003, "comment_id": 87064344, "body": "do I have to know how C works to use Go? I&#39;ll update the gcc output in the first posting"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1524579808, "last_edit_date": 1524579808, "creation_date": 1524579466, "answer_id": 50004003, "question_id": 50003598, "link": "https://stackoverflow.com/questions/50003598/problems-installing-packages-which-use-sdl2-via-cgo-on-windows-7/50004003#50004003", "title": "Problems installing packages which use SDL2 via cgo on Windows 7", "body": "<p>Please see <a href=\"https://www.google.com/search?q=&quot;fatal+error&quot;+&quot;No+such+file+or+directory+compilation+terminated.&quot;\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p>The reason is <code>go install</code> tried to compile some\n<a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code></a>\ncode of the <code>github.com\\veandco\\go-sdl2</code> package, and that code apparently\nwants to use the <a href=\"https://en.wikipedia.org/wiki/Include_directive#C/C++\" rel=\"nofollow noreferrer\">C header files</a>\nof the <code>libsdl2</code> library\u00b9.</p>\n\n<p>You need to make <a href=\"https://www.libsdl.org/download-2.0.php\" rel=\"nofollow noreferrer\"><code>libsdl2</code></a>\navailable to the compiler.</p>\n\n<p>To figure out where the C compiler expects to find the include (header)\nfiles, see <a href=\"https://stackoverflow.com/a/6666338/720999\">this</a>.</p>\n\n<hr>\n\n<p>\u00b9 That's how C works. To use a compiled library in other C code, the compiler\nusually needs to know the definitions of the types and functions provided\nby that library. The formats of such libraries\u2014contrary to Go libraries\u2014do not typically embed type information in their metadata, so the compiler\nneeds to get that information from somewhere. In C and C++ world this information is commonly kept in the so-called include (also: header) files\nwhich are included\u2014through the use of a so-called preprocessor\u2014both into the\ncode used to build a library and the code which uses the library.</p>\n"}], "owner": {"reputation": 141, "user_id": 7505473, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/rIybB.jpg?s=128&g=1", "display_name": "w3Charlie", "link": "https://stackoverflow.com/users/7505473/w3charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 353, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1595178120, "creation_date": 1524578300, "last_edit_date": 1595178120, "question_id": 50003598, "link": "https://stackoverflow.com/questions/50003598/problems-installing-packages-which-use-sdl2-via-cgo-on-windows-7", "title": "Problems installing packages which use SDL2 via cgo on Windows 7", "body": "<p>I have problems installing SDL2 for golang, using Visual Studio Code.</p>\n<p>I try to get the package:</p>\n<pre><code>&quot;C:\\Users\\Bob\\go\\src\\flappyGopher&gt;go get -v github.com/veandco/go-sdl2/sdl\ngithub.com/veandco/go-sdl2/sdl\n# github.com/veandco/go-sdl2/sdl\nIn file included from ..\\github.com\\veandco\\go-sdl2\\sdl\\audio.go:4:0:\n./sdl_wrapper.h:2:23: fatal error: SDL2/SDL.h: No such file or directory\ncompilation terminated.&quot;\n</code></pre>\n<p>I used this manual: <a href=\"https://github.com/vinzBad/go-sdl2-tut/blob/master/00_preparation/windows.md\" rel=\"nofollow noreferrer\">https://github.com/vinzBad/go-sdl2-tut/blob/master/00_preparation/windows.md</a></p>\n<p>I have also the env variables:</p>\n<pre><code>CGO_CFLAGS C:\\MinGW64\\mingw64\\include\nGOPATH C:\\Users\\Bob\\go\nGOROOT C:\\Go\\\nPATH ... C:\\MinGW64\\mingw64\\x86_64-w64-mingw32\\bin;C:\\MinGW64\\mingw64\\bin;C:\\Users\\Bob\\Downloads\\SDL2-2.0.8\\x86_64-w64-mingw32\\include\\SDL2\n</code></pre>\n<p>edit:the gcc output looks like a mess</p>\n<pre><code>C:\\Users\\Bob&gt;gcc -xc -E -v -\nUsing built-in specs.\nCOLLECT_GCC=gcc\nTarget: x86_64-w64-mingw32\nConfigured with: ../../../src/gcc-5.1.0/configure --build=x86_64-w64-  mingw32 --e\nnable-targets=all --enable-languages=ada,c,c++,fortran,lto,objc,obj-c++ --enable\n-libgomp --enable-lto --enable-graphite --enable-cxx-flags=-DWINPTHREAD_STATIC -\n-disable-build-with-cxx --disable-build-poststage1-with-cxx --enable-libstdcxx-d\nebug --enable-threads=posix --enable-version-specific-runtime-libs --enable-full\ny-dynamic-string --enable-libstdcxx-threads --enable-libstdcxx-time --with-gnu-l\nd --disable-werror --disable-nls --disable-win32-registry --prefix=/mingw64tdm -\n-with-local-prefix=/mingw64tdm --with-pkgversion=tdm64-1 --with-bugurl=http://td\nm-gcc.tdragon.net/bugs\nThread model: posix\ngcc version 5.1.0 (tdm64-1)\nCOLLECT_GCC_OPTIONS='-E' '-v' '-mtune=generic' '-march=x86-64'\n C:/Program Files/TDM-GCC-64/bin/../libexec/gcc/x86_64-w64-mingw32/5.1.0/cc1.exe\n -E -quiet -v -iprefix C:/Program Files/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-min\ngw32/5.1.0/ -D_REENTRANT - -mtune=generic -march=x86-64\nignoring duplicate directory &quot;C:/Program Files/TDM-GCC-64/lib/gcc/../../lib/gcc/\nx86_64-w64-mingw32/5.1.0/include&quot;\nignoring duplicate directory &quot;C:/Program Files/TDM-GCC-64/lib/gcc/../../lib/gcc/\nx86_64-w64-mingw32/5.1.0/../../../../include&quot;\nignoring duplicate directory &quot;C:/Program Files/TDM-GCC-64/lib/gcc/../../lib/gcc/\nx86_64-w64-mingw32/5.1.0/include-fixed&quot;\nignoring duplicate directory &quot;C:/Program Files/TDM-GCC-64/lib/gcc/../../lib/gcc/\nx86_64-w64-mingw32/5.1.0/../../../../x86_64-w64-mingw32/include&quot;\n#include &quot;...&quot; search starts here:\n#include &lt;...&gt; search starts here:\n C:/Program Files/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/include\n C:/Program Files/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../..\n/include\n C:/Program Files/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/include-fixed\n  C:/Program Files/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../../..\n/x86_64-w64-mingw32/include\nEnd of search list.\n</code></pre>\n"}, {"tags": ["security", "go", "elliptic-curve", "ecdh"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1524574720, "post_id": 50002149, "comment_id": 87020754, "body": "For the same reason that a random number from 1 and 1000 is some times 4 digits, some times, 3, sometimes 2, or sometimes 1 digit."}], "answers": [{"comments": [{"owner": {"reputation": 796, "user_id": 9021186, "user_type": "registered", "profile_image": "https://graph.facebook.com/545213625839644/picture?type=large", "display_name": "KawaLo", "link": "https://stackoverflow.com/users/9021186/kawalo"}, "edited": false, "score": 0, "creation_date": 1607273544, "post_id": 50007190, "comment_id": 115214750, "body": "In case of applications that requires fixed length representation (such as JWK), what is the &quot;best way&quot; to adjust length if the returned key is not 66 bytes long ? Will it work as intended if I just fill the missing cells with a null sequence ? (&quot;\\x00&quot;)"}, {"owner": {"reputation": 22888, "user_id": 6535399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x5vsS.jpg?s=128&g=1", "display_name": "bartonjs", "link": "https://stackoverflow.com/users/6535399/bartonjs"}, "reply_to_user": {"reputation": 796, "user_id": 9021186, "user_type": "registered", "profile_image": "https://graph.facebook.com/545213625839644/picture?type=large", "display_name": "KawaLo", "link": "https://stackoverflow.com/users/9021186/kawalo"}, "edited": false, "score": 1, "creation_date": 1607273763, "post_id": 50007190, "comment_id": 115214808, "body": "@KawaLo So long as it&#39;s not inside any sort of length-prepended structure, sure, you could add prefix zeroes.  (e.g. you couldn&#39;t do it inside a certificate&#39;s SubjectPublicKeyInfo since it has length values, you&#39;d need to recompute everything... then re-sign the cert.)"}], "tags": [], "owner": {"reputation": 22888, "user_id": 6535399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x5vsS.jpg?s=128&g=1", "display_name": "bartonjs", "link": "https://stackoverflow.com/users/6535399/bartonjs"}, "is_accepted": true, "score": 6, "last_activity_date": 1524589095, "creation_date": 1524589095, "answer_id": 50007190, "question_id": 50002149, "link": "https://stackoverflow.com/questions/50002149/why-p-521-public-key-x-y-some-time-is-65-bytes-some-time-is-66-bytes/50007190#50007190", "title": "Why P-521 public key X,Y some time is 65 bytes some time is 66 bytes", "body": "<p><code>secp521r1</code> uses a 521-bit prime field.  So the X or Y coordinates are represented as 521-bit numbers.  Yes, 521, not 512.</p>\n\n<p>521 bits is 65 full bytes and one bit left over.  In a fixed-size encoding of the public key the most significant byte would always have the 7 most significant bits set to 0, and the 8th bit will be 1 or 0 (so the whole byte is 0x00 or 0x01).</p>\n\n<p>Since the coordinate space isn't <em>quite</em> all of the 521-bit numbers, you have a slightly less than 50% chance of the high bit being set for any particular point.</p>\n\n<p>Go's method seems to be returning the value using a minimum-byte representation.  So you should see something like</p>\n\n<ul>\n<li>66 bytes: 49% of the time</li>\n<li>65 bytes: 50% of the time</li>\n<li>64 bytes (top 9 bits are all 0): 0.2%</li>\n<li>(63 bytes and below are possible, but with vanishingly small percentages)</li>\n</ul>\n"}], "owner": {"reputation": 13, "user_id": 9235725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/305685abbb9191af4c0e59ca31388a67?s=128&d=identicon&r=PG", "display_name": "user9235725", "link": "https://stackoverflow.com/users/9235725/user9235725"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1350, "favorite_count": 0, "closed_date": 1524593436, "accepted_answer_id": 50007190, "answer_count": 1, "score": -2, "last_activity_date": 1524589095, "creation_date": 1524574234, "question_id": 50002149, "link": "https://stackoverflow.com/questions/50002149/why-p-521-public-key-x-y-some-time-is-65-bytes-some-time-is-66-bytes", "closed_reason": "Not suitable for this site", "title": "Why P-521 public key X,Y some time is 65 bytes some time is 66 bytes", "body": "<p>I use golang generate the P-521 public key.\nsource code look like that:</p>\n\n<pre><code>curve:=elliptic.P521()\npriv, x, y, err := elliptic.GenerateKey(curve, rand.Reader)\nxBytes:=x.Bytes()\nyBytes:=y.bytes()\n//len(xBytes)  some time is 65 bytes ,some time is 66 bytes \n</code></pre>\n\n<p>Why P-521 public key X,Y  not like P-256 or P-384 that have a fixed public key  length?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1524576267, "post_id": 50000895, "comment_id": 87021904, "body": "That <code>&quot;,flatten&quot;</code> option is unneeded (and is useless). Struct flattening happens as the default (and only) behavior. What happens if you make the field a non-pointer? Does it work then?"}, {"owner": {"reputation": 51, "user_id": 5922068, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AUbSx8eHSo8/AAAAAAAAAAI/AAAAAAAAAHI/FHOXCWmjskA/photo.jpg?sz=128", "display_name": "ayush gupta", "link": "https://stackoverflow.com/users/5922068/ayush-gupta"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1524669916, "post_id": 50000895, "comment_id": 87068188, "body": "Bydefault struct flattening does not occur, instead the datastore makes the SignerData a property and adds the json string for the property as its value. The problem arises when I want to make a query by SignerData.Id = value. This doesn&#39;t run in that case. @icza"}], "owner": {"reputation": 51, "user_id": 5922068, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AUbSx8eHSo8/AAAAAAAAAAI/AAAAAAAAAHI/FHOXCWmjskA/photo.jpg?sz=128", "display_name": "ayush gupta", "link": "https://stackoverflow.com/users/5922068/ayush-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 304, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524654625, "creation_date": 1524570381, "last_edit_date": 1524654625, "question_id": 50000895, "link": "https://stackoverflow.com/questions/50000895/read-flattened-entity-from-cloud-datastore-in-golang", "title": "Read flattened entity from cloud datastore in golang", "body": "<pre><code>func (db *dataStore) AddAcceptance(ctx context.Context, req *acceptance.PolicyAcceptance) (uint64, error) {\n\naccpKey := datastore.IncompleteKey(\"Acceptance\", nil)\n\nkey, err := db.Put(context.Background(), accpKey, req);\nif  err != nil {\n    log.Fatalf(\"Failed to save Acceptance: %v\", err)\n}\naccpKey = key\nval := uint64(accpKey.ID)\nreturn val, err\n}\n\n\n\ntype PolicyAcceptance struct {\nId           string                     `protobuf:\"bytes,1,opt,name=id\" json:\"id,omitempty\"`\nPolicyNumber int64                      `protobuf:\"varint,2,opt,name=policyNumber\" json:\"policyNumber,omitempty\"`\nVersion      string                     `protobuf:\"bytes,3,opt,name=version\" json:\"version,omitempty\"`\nSignerData   *SignerData                `protobuf:\"bytes,4,opt,name=signerData\" json:\"signerData,omitempty\" datastore:\",flatten\"`\nGroupID      int64                      `protobuf:\"varint,5,opt,name=groupID\" json:\"groupID,omitempty\"`\nLocationID   int64                      `protobuf:\"varint,6,opt,name=locationID\" json:\"locationID,omitempty\"`\nBusinessId   int64                      `protobuf:\"varint,7,opt,name=businessId\" json:\"businessId,omitempty\"`\nAcceptedDate *google_protobuf.Timestamp `protobuf:\"bytes,8,opt,name=acceptedDate\" json:\"acceptedDate,omitempty\" datastore:\",flatten\"`\nIssuerName   string                     `protobuf:\"bytes,9,opt,name=issuerName\" json:\"issuerName,omitempty\"`\nPlace        string                     `protobuf:\"bytes,10,opt,name=place\" json:\"place,omitempty\"`\n}\ntype SignerData struct {\nName  string `protobuf:\"bytes,1,opt,name=name\" json:\"name,omitempty\"`\nEmail string `protobuf:\"bytes,2,opt,name=email\" json:\"email,omitempty\"`\nType  string `protobuf:\"bytes,3,opt,name=type\" json:\"type,omitempty\"`\nId    int64  `protobuf:\"varint,4,opt,name=id\" json:\"id,omitempty\"`\n}\n</code></pre>\n\n<p>datastore:\",flatten\" saves data as flattened in data store. The property names becomes flattened with . like <code>SignerData.Id</code> as property name but when it's read from data store, how can I map it back to struct? It fails throwing an error like: </p>\n\n<blockquote>\n  <p>SignerData.Id could not be found as a key in struct. Error: No such\n  struct field.</p>\n</blockquote>\n\n<pre><code>func (db *dataStore) GetAcceptanceBySignerData(ctx context.Context, req *acceptance.SignerData) (*acceptance.ListOfPolicyAcceptance, error) {\nquery := datastore.NewQuery(\"Acceptance\").Filter(\"SignerData.Id =\", req.Id)\nvar accpArr acceptance.ListOfPolicyAcceptance\nvar err error\nit := db.Run(ctx, query)\nfor {\n    var accept acceptance.PolicyAcceptance\n\n    _, err := it.Next(&amp;accept)\n    if err == iterator.Done {\n        break\n    }\n    if err != nil {\n        log.Fatalf(\"Error fetching : %v\", err)\n    }\n    accpArr.AcceptanceList = append(accpArr.AcceptanceList, &amp;accept)\n}\nreturn &amp;accpArr, err\n}\n</code></pre>\n"}, {"tags": ["go", "interface", "structure", "embedding"], "comments": [{"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524575209, "post_id": 50000847, "comment_id": 87021104, "body": "Basically what you are trying to do is inheritance, which is deliberately, consciously and by design not supported in go for reasons that can be googled. It can be done, but there is a little messiness involved. However, there&#39;s a lot of go code out there and not much of it finds the need to do this so there&#39;s probably an alternative approach to solving the problem that would be better or at least more idiomatic. I find that what that solution would be depends on understanding the problem better - different constraints lead to different answers/approaches."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524575394, "post_id": 50000847, "comment_id": 87021233, "body": "Option <code>1.</code> is fine, the only &quot;insane&quot; thing about it is that you&#39;re returning <code>Common</code> from a function called <code>NewSpecific1</code>, and you&#39;re not setting <code>Common</code>&#39;s <code>Specifier</code>, why? You should return <code>Specific1</code> instead. Also this does not seem to require embedding, not that you can&#39;t use it, but it will work without it just as well."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1524575739, "post_id": 50000847, "comment_id": 87021502, "body": "E.g. <a href=\"https://play.golang.org/p/GYuKrg_Luuu\" rel=\"nofollow noreferrer\">play.golang.org/p/GYuKrg_Luuu</a>"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524576092, "post_id": 50000847, "comment_id": 87021779, "body": "@GilesW, thank you for the reply. I thought about inheritance, but it&#39;s not good in Go. I&#39;d like to make it idiomatically. I feel this task fits Go very well, but the problem is mutual dependency. I&#39;ll make more descriptive explanation little later."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524576279, "post_id": 50000847, "comment_id": 87021915, "body": "@mkopriva thank you. Thing <code>foo.Common.Specific = foo</code> is very interesting, but seems strange a little bit. What if there will be more interfaces? If they are in different packages, move type declarations to 3rd package?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524576441, "post_id": 50000847, "comment_id": 87022037, "body": "@EugeneLisitsky I don&#39;t think there&#39;s anything strange here, the types have a circular dependency, how else would you express it?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524576608, "post_id": 50000847, "comment_id": 87022163, "body": "@mkopriva I also can&#39;t find better way :) I think of some sort of embedding to one bigger so so they could find methods on the same level. But if initial structures don&#39;t have methods from each other they can&#39;t reference them at compile-time."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1524576640, "post_id": 50000847, "comment_id": 87022190, "body": "@EugeneLisitsky how you structure your code, whether you have a package specifically for type declarions only or not, is up to you, just make sure it compiles."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524577644, "post_id": 50000847, "comment_id": 87022908, "body": "@EugeneLisitsky keep in mind that generally it&#39;s a good idea to follow the single responsibility principle. Something &quot;bigger&quot; sounds like you may be trying to do more than just one thing with that..."}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524580904, "post_id": 50000847, "comment_id": 87025333, "body": "One other observation on the question - if the methods added by the specific type are not common (since the common functionality is in the type common), how can they be satisfied by the same interface Specifier? And if they are different then the specific will have to embed the common, not the other way around. But if the methods on each specific type component are different how would the methods in the common type be calling them without type switching? See where the confusion is?"}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524640159, "post_id": 50000847, "comment_id": 87048329, "body": "@GilesW It&#39;s quite possible. If you have the same logics and different adapters to very similar resources."}, {"owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524640231, "post_id": 50000847, "comment_id": 87048372, "body": "@mkopriva, yes, I want the same thing: logics in one structure and some adapters to slight modifications in specific structures."}], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524570226, "creation_date": 1524570226, "question_id": 50000847, "link": "https://stackoverflow.com/questions/50000847/embedding-of-mutually-dependent-structures-interfaces", "title": "Embedding of mutually dependent structures/interfaces", "body": "<p>I have 3 structures that are similar about 70%. So I'd like to extract some common part and create some extensions with specific methods and fields.</p>\n\n<p>Final structure will work as follows:</p>\n\n<ol>\n<li><p>method <code>.Start()</code> from <code>Common</code> is called</p></li>\n<li><p><code>Start()</code> calls method <code>.Name()</code> from specific part the latter return a string </p></li>\n<li><p>the returned result is being processed in <code>(*Common).Process()</code>, sometimes it should call specific's <code>Format()</code></p></li>\n<li><p>But! Specific part have to call Common part's method, for example <code>GetVerbosity()</code></p></li>\n</ol>\n\n<p>Like this:</p>\n\n<pre><code>package common\n\ntype Common struct {\n     Specificer \n}\n\nfunc (c *Common) Start() {\n     ...\n     name := Specific.Name()\n}\n\nfunc (c *Common) GetVerbosity() {...}\n\ntype Specificer interface {\n    Name() string\n    Format() string\n}\n</code></pre>\n\n<p>And specific part:</p>\n\n<pre><code>package specific1\n\n// should implement common.Specificer interface\ntype Specific1 struct {\n    // unexported fields\n}\n\nfunc (s *Specific1) Name() string {...}\nfunc (s *Specific1) Format() string {\n   // How to call it???\n   Common.Method() \n}\n</code></pre>\n\n<p>This is similar to some frameworks - when another code calls your code, and also you call it's code.</p>\n\n<p>How to implement this better? And how to create new structures?\nI tried:</p>\n\n<ol>\n<li><p>Embed <code>Specific</code> to <code>Common</code>, and  embed vise versa:</p>\n\n<pre><code>type Common struct {\n    Specificer\n}\n\ntype Specific1 struct {\n   common.Common\n   ...\n}\n\n// But this is little bit insane:\nfunc NewSpecific1() *common.Common {\n    var s = Specific1{}\n    return &amp;common.Common{Specificer: &amp;s}\n}\n</code></pre></li>\n<li><p>Define 2 interfaces: <code>Commoner</code> and <code>Specificer</code>. And combined interface:</p>\n\n<pre><code>package common\ntype CommonSpecificer interface {\n   Commoner\n   Specificer\n}\n\ntype Common struct {...}  // implements all the methods from Commoner\n\nfunc New() *Common {...}\n\n\n//////\npackage specific1\n\ntype Specific1 struct  { // implements all the methods from common.Specificer\n   Common\n   ...\n}  \n\nfunc NewSpecific1() *Specific1 {\n  c := common.NewCommon(...)\n  s := &amp;Specific1{Common: c}\n  return s\n}\n</code></pre></li>\n</ol>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1524594304, "creation_date": 1524594304, "answer_id": 50008522, "question_id": 50000369, "link": "https://stackoverflow.com/questions/50000369/cannot-disable-optimizations-while-compiling-runtime/50008522#50008522", "title": "Cannot disable optimizations while compiling runtime", "body": "<p>This error message seems to come from the Go compiler due to <a href=\"https://go-review.googlesource.com/c/go/+/38380\" rel=\"nofollow noreferrer\">this</a> change which fixes <a href=\"https://github.com/golang/go/issues/19571\" rel=\"nofollow noreferrer\">this bug</a>\n(the \"compile: \" prefix is apparently added by vscode).</p>\n\n<p>My take on the reason is as follows:</p>\n\n<ol>\n<li>You have Go runtime source code somehow modified since before you started to experience the present problem.</li>\n<li>An attempt to build your program detects the runtime has changed\n<em>and needs to be rebuilt as well</em>\u2014simply because parts of it are included\ninto any program built with Go.</li>\n</ol>\n\n<p>As to how to solve this, I have no clean idea.\nSupposedly running</p>\n\n<pre><code>$ cd /usr/local/go/src\n$ ./make.bash\n</code></pre>\n\n<p>should do it.</p>\n\n<hr>\n\n<p>On a side note, you must not set the <code>GOROOT</code> env. variable\nby hand\u2014please leave it to the Go suite instead; since many versions ago,\nit knows its <code>GOROOT</code> automatically based on where the <code>go</code> binary\nis located.</p>\n"}], "owner": {"reputation": 11, "user_id": 9690729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69151fab272d3546720146ab3f4381ba?s=128&d=identicon&r=PG&f=1", "display_name": "xiaoyiyi", "link": "https://stackoverflow.com/users/9690729/xiaoyiyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1524594304, "creation_date": 1524568738, "last_edit_date": 1524571603, "question_id": 50000369, "link": "https://stackoverflow.com/questions/50000369/cannot-disable-optimizations-while-compiling-runtime", "title": "Cannot disable optimizations while compiling runtime", "body": "<p>When I use VSCODE in my Ubuntu 16.10 to compile my go project, it can't succeed and prompt: </p>\n\n<pre><code>compile: cannot disable optimizations while compiling runtime\nexit status 2\nProcess exiting with code: 1\n</code></pre>\n\n<p>I checked my launch.json:</p>\n\n<pre><code>{\n    \"version\": \"0.2.0\",\n    \"configurations\": [\n        {\n            \"name\": \"Launch\",\n            \"type\": \"go\",\n            \"request\": \"launch\",\n            \"mode\": \"debug\",\n            \"remotePath\": \"\",\n            \"port\": 2345,\n            \"host\": \"127.0.0.1\",\n            \"program\": \"${fileDirname}\",\n            \"env\": {\n                \"GOPATH\":\"/home/bill/test/go\",\n                \"GOROOT\":\"/usr/local/go\"\n            },\n            \"args\": [],\n            \"showLog\": true\n        }\n    ]\n}\n</code></pre>\n\n<p>What can I do to change this?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1524566734, "post_id": 49999677, "comment_id": 87015294, "body": "On panic or explicit return. Dead simple."}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524566854, "post_id": 49999677, "comment_id": 87015381, "body": "so, I won&#39;t have any return."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9455968"}, "edited": false, "score": 1, "creation_date": 1524567211, "post_id": 49999677, "comment_id": 87015607, "body": "Threads are usually not used in Go. The preferred way is to use goroutines and channels."}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 1, "creation_date": 1524567294, "post_id": 49999677, "comment_id": 87015671, "body": "corrected. By mistake wrote threads."}], "answers": [{"comments": [{"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1524567225, "post_id": 49999786, "comment_id": 87015616, "body": "what all cases can result in panic? If machine goes down, it is fine as then process also will restart."}, {"owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 0, "creation_date": 1524567250, "post_id": 49999786, "comment_id": 87015638, "body": "only one I know is when there is lack of memory."}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "reply_to_user": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "edited": false, "score": 1, "creation_date": 1524567399, "post_id": 49999786, "comment_id": 87015723, "body": "runtime errors like out of bounds array access or direct calls to panic() by your code or packages you are using."}], "tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 2, "last_activity_date": 1524566899, "creation_date": 1524566899, "answer_id": 49999786, "question_id": 49999677, "link": "https://stackoverflow.com/questions/49999677/possible-scenarios-for-go-routine-termination/49999786#49999786", "title": "Possible scenarios for go routine termination", "body": "<p>If it is in a non-terminating for loop it will only exit on a panic, or if the OS kills the process (program) or the machine goes down.</p>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "is_accepted": false, "score": 0, "last_activity_date": 1524571225, "last_edit_date": 1524571225, "creation_date": 1524569299, "answer_id": 50000555, "question_id": 49999677, "link": "https://stackoverflow.com/questions/49999677/possible-scenarios-for-go-routine-termination/50000555#50000555", "title": "Possible scenarios for go routine termination", "body": "<p>From the <a href=\"https://golang.org/ref/spec#Run_time_panics\" rel=\"nofollow noreferrer\">documentation</a>, </p>\n\n<blockquote>\n  <p>Execution errors such as attempting to index an array out of bounds trigger a run-time panic equivalent to a call of the built-in function panic with a value of the implementation-defined interface type runtime.Error.</p>\n</blockquote>\n\n<p>Apart from that, it can <code>panic</code> when memory is not sufficient.</p>\n\n<p>If a <code>go routine</code> encounters a <code>panic</code>, <code>defer-panic-recover</code> can be used to handle it. <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">This</a> link to the official document provides more information on usage of it.</p>\n"}], "owner": {"reputation": 947, "user_id": 3218674, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/E7ZAV.jpg?s=128&g=1", "display_name": "Gauranga", "link": "https://stackoverflow.com/users/3218674/gauranga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1524597904, "answer_count": 2, "score": -7, "last_activity_date": 1524654465, "creation_date": 1524566592, "last_edit_date": 1524654465, "question_id": 49999677, "link": "https://stackoverflow.com/questions/49999677/possible-scenarios-for-go-routine-termination", "closed_reason": "Needs more focus", "title": "Possible scenarios for go routine termination", "body": "<p>What are the possible scenarios in which a <code>go routine</code>, which has to run forever, can get terminated?</p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1524565470, "post_id": 49999230, "comment_id": 87014472, "body": "Add an other git remote."}, {"owner": {"reputation": 594, "user_id": 1054114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc175ba42a40a2cd3d3ba24910f9bfa1?s=128&d=identicon&r=PG", "display_name": "orirawlings", "link": "https://stackoverflow.com/users/1054114/orirawlings"}, "edited": false, "score": 0, "creation_date": 1524575596, "post_id": 49999230, "comment_id": 87021401, "body": "Are you trying to push multiple libraries to a single bitbucket repository?"}, {"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "edited": false, "score": 0, "creation_date": 1524579626, "post_id": 49999230, "comment_id": 87024389, "body": "Yes, trying to club dependencies together"}, {"owner": {"reputation": 1327, "user_id": 1110636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709ba1cdc862cffcbab3c518209e634d?s=128&d=identicon&r=PG", "display_name": "Timir", "link": "https://stackoverflow.com/users/1110636/timir"}, "edited": false, "score": 0, "creation_date": 1524595506, "post_id": 49999230, "comment_id": 87034105, "body": "In that case, you need a git-aware package manager instead. See reference to glide in answer below."}], "answers": [{"tags": [], "owner": {"reputation": 1327, "user_id": 1110636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709ba1cdc862cffcbab3c518209e634d?s=128&d=identicon&r=PG", "display_name": "Timir", "link": "https://stackoverflow.com/users/1110636/timir"}, "is_accepted": true, "score": 3, "last_activity_date": 1524595303, "last_edit_date": 1524595303, "creation_date": 1524566174, "answer_id": 49999536, "question_id": 49999230, "link": "https://stackoverflow.com/questions/49999230/how-to-pull-from-a-git-source-and-push-to-another/49999536#49999536", "title": "How to pull from a git source and push to another", "body": "<p>You'll need to add a git remote for each repository that you've pulled. </p>\n\n<blockquote>\n  <p>$ git remote add <strong>bitbucket</strong> <a href=\"https://mybitbucketserver.example.com/bitbucket/projects/repo.git\" rel=\"nofollow noreferrer\">https://mybitbucketserver.example.com/bitbucket/projects/repo.git</a></p>\n</blockquote>\n\n<p>And when you need to push to bitbucket, you say:</p>\n\n<pre><code>$ git push bitbucket master\n</code></pre>\n\n<p>Ref: <a href=\"https://help.github.com/articles/adding-a-remote/\" rel=\"nofollow noreferrer\">https://help.github.com/articles/adding-a-remote/</a></p>\n\n<p><strong>Edit: Consolidating Dependencies</strong> </p>\n\n<p>You might also consider including a git-aware package manager like <a href=\"https://github.com/Masterminds/glide/blob/master/README.md\" rel=\"nofollow noreferrer\">glide</a> into your build workflow. </p>\n"}], "owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 49999536, "answer_count": 1, "score": 0, "last_activity_date": 1524595303, "creation_date": 1524565293, "last_edit_date": 1524568507, "question_id": 49999230, "link": "https://stackoverflow.com/questions/49999230/how-to-pull-from-a-git-source-and-push-to-another", "title": "How to pull from a git source and push to another", "body": "<p>I am using golang (go get) to fetch code from github.com (various repos) into a local repo </p>\n\n<p><code>c:\\gopath\\src\\...</code></p>\n\n<p>However, afterwards I am unable to push these to local bit bucket server.</p>\n\n<p>BUT, If I download zips from git hub and extract and then i can push to local source code repo.</p>\n\n<p>Am I doing it wrong and what should otherwise be doing ?</p>\n\n<p>thank you</p>\n"}, {"tags": ["caching", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524564936, "post_id": 49998917, "comment_id": 87014114, "body": "Pass -count=1. I agree that it&#39;s not obvious, but it&#39;s the canonical way to do it."}, {"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524572650, "post_id": 49998917, "comment_id": 87019219, "body": "Thanks, while its correct the dublicate question (which I failed to find my self) has even better answer providing also a way to clear cache."}, {"owner": {"reputation": 757, "user_id": 3795212, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/987621bf8b5d812def204c0075ed0d2d?s=128&d=identicon&r=PG&f=1", "display_name": "apostrophedottilde", "link": "https://stackoverflow.com/users/3795212/apostrophedottilde"}, "edited": false, "score": 0, "creation_date": 1557682982, "post_id": 49998917, "comment_id": 98838291, "body": "Try go clean -testcache"}], "answers": [{"comments": [{"owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "edited": false, "score": 0, "creation_date": 1524572662, "post_id": 49999321, "comment_id": 87019232, "body": "Thanks, while its correct the dublicate question (which I failed to find my self) has even better answer providing also a way to clear cache."}], "tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 8, "last_activity_date": 1567072438, "last_edit_date": 1567072438, "creation_date": 1524565537, "answer_id": 49999321, "question_id": 49998917, "link": "https://stackoverflow.com/questions/49998917/no-obvious-way-to-disable-test-caching-in-go-1-10/49999321#49999321", "title": "no obvious way to disable test caching in go 1.10", "body": "<p>The idiomatic way to bypass test caching is to use <strong>-count=1</strong>. This is the recommended way for doing that in release note as well</p>\n\n<blockquote>\n  <p>The go test command now caches test results: if the test executable\n  and command line match a previous run and the files and environment\n  variables consulted by that run have not changed either, go test will\n  print the previous test output, replacing the elapsed time with the\n  string \u201c(cached).\u201d Test caching applies only to successful test\n  results; only to go test commands with an explicit list of packages;\n  and only to command lines using a subset of the -cpu, -list,\n  -parallel, -run, -short, and -v test flags. The idiomatic way to bypass test caching is to use -count=1.</p>\n</blockquote>\n\n<p>Refer : <a href=\"https://golang.org/doc/go1.10#test\" rel=\"nofollow noreferrer\">https://golang.org/doc/go1.10#test</a></p>\n"}], "owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2779, "favorite_count": 0, "closed_date": 1524565501, "accepted_answer_id": 49999321, "answer_count": 1, "score": 6, "last_activity_date": 1567072438, "creation_date": 1524564460, "question_id": 49998917, "link": "https://stackoverflow.com/questions/49998917/no-obvious-way-to-disable-test-caching-in-go-1-10", "closed_reason": "Duplicate", "title": "no obvious way to disable test caching in go 1.10", "body": "<p>Golang 1.10 introduced caching for test, but there is no obvious way to disable test caching.\nSo the question is, how to temporal dislable it and how to force rebuild it.\nI did read the documentation: <a href=\"https://golang.org/cmd/go/#hdr-Build_and_test_caching\" rel=\"noreferrer\">https://golang.org/cmd/go/#hdr-Build_and_test_caching</a> but did not found any obvious answer to that question.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1524571506, "post_id": 49998102, "comment_id": 87018396, "body": "Include your relevant code in the question."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1524575017, "post_id": 49998102, "comment_id": 87020970, "body": "@Flimzy updated the question"}, {"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1524598904, "post_id": 49998102, "comment_id": 87035875, "body": "Move <code>models_test&#47;math_test.go</code> to <code>models&#47;math_test.go</code>."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1524619903, "post_id": 49998102, "comment_id": 87042011, "body": "@fhe I know it works inside the same package. I want to keep the test cases outside of the package to keep things clean."}, {"owner": {"reputation": 315, "user_id": 5353940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3bb5640039c457d201b38ef7b79058?s=128&d=identicon&r=PG", "display_name": "Patrick Stephen", "link": "https://stackoverflow.com/users/5353940/patrick-stephen"}, "edited": false, "score": 0, "creation_date": 1524621350, "post_id": 49998102, "comment_id": 87042309, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/37464156/get-coverage-stats-when-tests-are-in-another-package\">Get Coverage stats when tests are in another package</a>"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 315, "user_id": 5353940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3bb5640039c457d201b38ef7b79058?s=128&d=identicon&r=PG", "display_name": "Patrick Stephen", "link": "https://stackoverflow.com/users/5353940/patrick-stephen"}, "edited": false, "score": 0, "creation_date": 1524622790, "post_id": 49998102, "comment_id": 87042576, "body": "@PatrickStephen That one doesn&#39;t work for me with latest go version. It throws a warning <code>warning: no packages being tested depend on matches for pattern models</code> and give 0% test coverage."}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1524622394, "creation_date": 1524562236, "last_edit_date": 1524622394, "question_id": 49998102, "link": "https://stackoverflow.com/questions/49998102/golang-package-test-coverage-not-working-in-version-1-10-1", "title": "Golang package test coverage not working in version 1.10.1", "body": "<p>I'm trying to generate test coverage for a package using the following commands.</p>\n\n<p><code>go test -v ./models_test -coverpkg=./models -coverprofile=c.out &amp;&amp; go tool cover -func=c.out</code></p>\n\n<p><code>go test -v ./models_test -coverpkg=github.com/apremalal/go-test-cov/models -coverprofile=c.out &amp;&amp; go tool cover -func=c.out</code></p>\n\n<p>My repo structure is like below, and I'm executing commands indie  folder</p>\n\n<pre><code>&lt;go-test-cov&gt;\n |\n  -&lt;models&gt;\n |\n  -&lt;models-test&gt;\n</code></pre>\n\n<p>I have hosted the code in <a href=\"https://github.com/apremalal/go-test-cov\" rel=\"nofollow noreferrer\">github</a> for easy referencing.</p>\n\n<p>models/math.go</p>\n\n<pre><code>package models\n\nfunc Add(x,y int) int{\n  return x+y\n}\n</code></pre>\n\n<p>models_test/math_test.go</p>\n\n<pre><code>package models_test\n\nimport (\n    \"testing\"\n  \"github.com/apremalal/go-test-cov/models\"\n)\n\nfunc TestAdd(t *testing.T) {\n    total := models.Add(5, 5)\n    if total != 10 {\n       t.Errorf(\"Sum was incorrect, got: %d, want: %d.\", total, 10)\n    }\n}\n</code></pre>\n\n<p>Each time I receive 0% test coverage though the tests get executed without errors.</p>\n\n<p>I'm using go version <code>go1.10.1 darwin/amd64</code>. This method used to work in earlier go versions. Appreciate your help in finding out how to get this working with the latest go release.</p>\n"}, {"tags": ["go", "internationalization"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1524568463, "post_id": 49997766, "comment_id": 87016406, "body": "<code>display.Self.Name(tag)</code> may be helpful, see <a href=\"https://godoc.org/golang.org/x/text/language/display#example-Namer\" rel=\"nofollow noreferrer\">examples</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1481, "user_id": 3864300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d21be1be28f98e985fd732dab88abc7e?s=128&d=identicon&r=PG", "display_name": "frankie567", "link": "https://stackoverflow.com/users/3864300/frankie567"}, "is_accepted": true, "score": 5, "last_activity_date": 1524568094, "creation_date": 1524568094, "answer_id": 50000165, "question_id": 49997766, "link": "https://stackoverflow.com/questions/49997766/language-matchstrings-returns-garbage/50000165#50000165", "title": "&#39;language.MatchStrings()&#39; returns garbage", "body": "<p>According to the <a href=\"https://godoc.org/golang.org/x/text/language#NewMatcher\" rel=\"noreferrer\">documentation</a>, the language matcher may add the Unicode extension on the tag:</p>\n\n<blockquote>\n  <p>The index returned by the Match method corresponds to the index of the\n  matched tag in t, but is augmented with the Unicode extension ('u')of\n  the corresponding preferred tag. This allows user locale options to be\n  passed transparently.</p>\n</blockquote>\n\n<p>This explains the weird <code>en-u-rg-uszzzz</code> value. As the matcher provides us the index of the matched language in the array, a workaround would be to use it to retrieve the original language:</p>\n\n<pre><code>var availableLanguages = []language.Tag{\n    language.English, // Default if no match\n    language.French,\n}\nvar languageMatcher = language.NewMatcher(availableLanguages)\n\nlang, _ := r.Cookie(\"lang\")\naccept := r.Header.Get(\"Accept-Language\")\n\nvar cookieValue = \"\"\n\nif lang != nil { // Be careful: the variable name was wrong\n    cookieValue = lang.String()\n}\n\n_, i := language.MatchStrings(languageMatcher, cookieValue, accept)\n\nlog.Debugf(ctx, fmt.Sprintf(\"Localized %s to %s. cookie: %s | header: %s\", path, availableLanguages[i].String(), cookieValue, accept))\n\nhttp.Redirect(w, r, \"/\"+availableLanguages[i].String()+path, 302)\n</code></pre>\n\n<p>A bit hacky, but it works.</p>\n\n<p>Regards!</p>\n"}], "owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 1, "accepted_answer_id": 50000165, "answer_count": 1, "score": 2, "last_activity_date": 1524571432, "creation_date": 1524561284, "last_edit_date": 1524571432, "question_id": 49997766, "link": "https://stackoverflow.com/questions/49997766/language-matchstrings-returns-garbage", "title": "&#39;language.MatchStrings()&#39; returns garbage", "body": "<p>I'm having the following piece of code in go:</p>\n\n<pre><code>var languageMatcher = language.NewMatcher([]language.Tag{\n    language.English, // Default if no match\n    language.French,\n})\n\nlang, _ := r.Cookie(\"lang\")\naccept := r.Header.Get(\"Accept-Language\")\n\nvar cookieValue = \"\"\n\nif cookie != nil {\n    cookieValue = lang.String()\n}\n\ntag, _ := language.MatchStrings(languageMatcher, cookieValue, accept)\n\nlog.Debugf(ctx, fmt.Sprintf(\"Localized %s to %s. cookie: %s | header: %s\", path, tag.String(), cookieValue, accept))\n\nhttp.Redirect(w, r, \"/\"+tag.String()+path, 302)\n</code></pre>\n\n<p>Most of it comes from the  <a href=\"https://godoc.org/golang.org/x/text/language\" rel=\"nofollow noreferrer\">GoDoc</a></p>\n\n<p>It's working fine most of the time but sometimes (when browsing in private mode from a computer that never visited the website, or when removing the entire cache from the browser (no lang cookie)); the <code>language.MatchStrings</code> function returns a bunch of garbage in the tag variable like <code>en-u-rg-uszzzz</code>.</p>\n\n<p>Here's the my log.Debugf output:</p>\n\n<blockquote>\n  <p><code>Localized / to en-u-rg-uszzzz. cookie: | header: en-US,en;q=0.9</code></p>\n</blockquote>\n\n<p>Any idea of what is wrong ?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1524558544, "post_id": 49996662, "comment_id": 87010052, "body": "The json for that url starts with <code>{&quot;tracks&quot;:{&quot;track&quot;:[{&quot;name&quot;:&quot;Hello&quot;,&quot;duration&quot;:&quot;0&quot;, ...</code>. The corresponding go struct passed in to json.Unmarshal must have a similar structure."}, {"owner": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1524559087, "post_id": 49996662, "comment_id": 87010358, "body": "thanks to reply. Yes, I have the Complete Code which is a Little  bit longer so that I want to focus on the fail result (blank) because I have to print out a specific data set. So in MyStruct it holds variables (name, duration, listeners, mbid and url respectively)"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1524559193, "post_id": 49996662, "comment_id": 87010417, "body": "Other note, you&#39;re registering multiple handler for <code>&#47;</code>. This is not allowed. Your real code looks the same?"}, {"owner": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "edited": false, "score": 0, "creation_date": 1524559876, "post_id": 49996662, "comment_id": 87010817, "body": "yes, it looks the same. Infact, I am new to golang but trying to learn it. I have to print out different data sets for example I have different type structures hold different variables to present JSON data. So, I tried to write functions and call these structures into them. I am worried that it can be fail but wondering how to resolve ! (I can share the Whole code if you would like to)"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "edited": false, "score": 0, "creation_date": 1524568994, "post_id": 49997932, "comment_id": 87016787, "body": "thanks @Mark ! But I am getting stuck again when I try to create more type structure (same way as you did) but program ends suddenly without any output on terminal. Like:  type Attr_info struct {    Country    string <code>json:&quot;country&quot;</code>    Page       string <code>json:&quot;page&quot;</code>    PerPage    string <code>json:&quot;perpage&quot;</code>    TotalPages string <code>json:&quot;totalpages&quot;</code>    Total      string <code>json:&quot;total&quot;</code> }  type Data2 struct {    Content2 struct{       Attrs[] Attr_info <code>json:&quot;attr_info&quot;</code>    } }"}, {"owner": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "edited": false, "score": 0, "creation_date": 1524569794, "post_id": 49997932, "comment_id": 87017311, "body": "(New) thanks @Mark ! But I am getting stuck again when I try to create more type structure (same way as you did) but program ends suddenly without any output on terminal. I have put my work on golang link (i could not put the data because of error from the site) <a href=\"https://play.golang.org/p/guufCoG4uN7\" rel=\"nofollow noreferrer\">play.golang.org/p/guufCoG4uN7</a>"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "edited": false, "score": 0, "creation_date": 1524612543, "post_id": 49997932, "comment_id": 87040472, "body": "You&#39;re on the right track (no pun intended...)! Here&#39;s another <a href=\"https://play.golang.org/p/HL2dPKc8pDA\" rel=\"nofollow noreferrer\">play</a> showing nested structs. It&#39;s worth spending time on the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">json.Marshal</a> docs."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1524562196, "last_edit_date": 1524562196, "creation_date": 1524561717, "answer_id": 49997932, "question_id": 49996662, "link": "https://stackoverflow.com/questions/49996662/how-to-solve-json-data-print-out-in-this-program/49997932#49997932", "title": "How to solve JSON data print out in this program?", "body": "<p>To be a bit more explicit, the go data structure must match the json data structure. Not just the individual 'track', but the entire json structure.</p>\n\n<p>Here's an example based on the response from the url you gave. The response is reduced to fit here, the full response is on the <a href=\"https://play.golang.org/p/VcLaaoY6IVb\" rel=\"nofollow noreferrer\">Playground</a>.</p>\n\n<p>The names returned by the json structure are misleading, but it's workable.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Track struct {\n    Name     string `json:\"name\"`\n    Duration string `json:\"duration\"`\n    //... etc\n}\n\ntype Data struct {\n    Content struct {\n        Tracks []Track `json:\"track\"`\n    } `json:\"tracks\"`\n}\n\nfunc main() {\n    var body = []byte(`{\n        \"tracks\":{\n            \"track\":[\n                {\n                    \"name\":\"Hello\",\n                    \"duration\":\"123\",\n                    \"listeners\":\"373721\",\n                    \"mbid\":\"\"\n                }\n            ]\n        }\n    }`)\n\n    var data Data\n    err := json.Unmarshal(body, &amp;data)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, track := range data.Content.Tracks {\n        fmt.Printf(\"Track: %s\\n\", track.Name)\n    }\n}\n</code></pre>\n\n<p>Replacing <code>body</code> with the full json (eg, from the url response) and running this prints:</p>\n\n<p><code>Track: Hello\nTrack: Can't Feel My Face\nTrack: Sultans of Swing\nTrack: Sorry\nTrack: Lean On (feat. M\u00d8 &amp; DJ Snake)\nTrack: The Less I Know the Better\nTrack: Africa\n...\n</code></p>\n"}], "owner": {"reputation": 25, "user_id": 9461459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e71694999a6b7b4a30dd12bd2b501f1?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian93", "link": "https://stackoverflow.com/users/9461459/adrian93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 49997932, "answer_count": 1, "score": 0, "last_activity_date": 1524571411, "creation_date": 1524557813, "last_edit_date": 1524571411, "question_id": 49996662, "link": "https://stackoverflow.com/questions/49996662/how-to-solve-json-data-print-out-in-this-program", "title": "How to solve JSON data print out in this program?", "body": "<p>I am trying to convert data through api url into JSON data. As a whole it works, but when I want to get specific data set from JSON (here I am trying MyStruct which is a data set having name, duration, listners), so it comes with blank result. On the other side, same problem with html template which does not give any result when I call it through local host port.\nI have declared a global instance to call data set in template function (could also use in my get content function though) but having fail result.\nI am wondered why data variable in get_content having blank result?</p>\n\n<pre><code>// created structurs example\ntype MyStruct struct {\n    Name       string\n    Duration   string\n    and so on..\n}\nvar data1 MyStruct\n\n// function to retreive api data &amp; convert into json.\nfunc get_content() {\n    // json data\n    url := \"http://ws.audioscrobbler.com/2.0/?method=geo.gettoptracks&amp;api_key=c1572082105bd40d247836b5c1819623&amp;format=json&amp;country=Netherlands\"\n    url += \"\" // limit data for testing\n    res, err := http.Get(url)\n    if err != nil {\n        panic(err.Error())\n    }\n    body, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    var data MyStruct\n    err = json.Unmarshal(body, &amp;data)\n    if err != nil {\n        panic(err.Error())\n    }\n    fmt.Printf(\"Results: %v\\n\", data)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        get_content()\n    })\n\n    http.HandleFunc(\"/\", template1)\n    http.ListenAndServe(\":8080\", nil)\n\n}\n\nfunc template1(w http.ResponseWriter, r *http.Request) {\n\n    fp := path.Join(\"index.html\")\n    tmpl, err := template.ParseFiles(fp)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    if err := tmpl.Execute(w, data1); err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n\n<p>on index file I have written names to call the data:  </p>\n\n<pre><code>{{.Name}}\n{{.Duration}}\n{{.Listeners}}\n</code></pre>\n"}, {"tags": ["go", "substring"], "comments": [{"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1524576715, "post_id": 49993740, "comment_id": 87022242, "body": "where is your Handler <code>routes</code> From the end Point You can take This"}], "answers": [{"tags": [], "owner": {"reputation": 654, "user_id": 2329794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1595faba70351b69bab5fc337c486d8?s=128&d=identicon&r=PG", "display_name": "Josh McMillan", "link": "https://stackoverflow.com/users/2329794/josh-mcmillan"}, "is_accepted": false, "score": 1, "last_activity_date": 1524546858, "creation_date": 1524546858, "answer_id": 49993861, "question_id": 49993740, "link": "https://stackoverflow.com/questions/49993740/how-to-take-some-part-of-the-url-as-a-sub-string-using-golang-in-gin-package/49993861#49993861", "title": "How to take some part of the url as a sub-string using golang in gin package?", "body": "<p>If you're using Gin, then you should be able to use <a href=\"https://github.com/gin-gonic/gin#parameters-in-path\" rel=\"nofollow noreferrer\">its \"parameters in path\"</a> functionality to extract the fragment.</p>\n\n<p>That said, if you're doing this in raw Go, then this should do the trick:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strings\"\n  \"errors\"\n  \"net/url\"\n)\n\nconst segmentToPluck = 4\n\nfunc getAuthenticationKey(inputUrl string) (string, error) {\n  parsedUrl, err := url.Parse(inputUrl)\n\n  if err != nil {\n    return \"\", err\n  }\n\n  split := strings.Split(parsedUrl.Path, \"/\")\n\n  if len(split) &lt; segmentToPluck + 1 {\n    return \"\", errors.New(\"unable to find key segment\")\n  }\n\n  return split[segmentToPluck], nil\n}\n\nfunc main() {\n  key, err := getAuthenticationKey(\"https://projects.com/id/669461/authenticationKey/0A8BE8D1AFDBC11C700548F72022DA5C\")\n\n  if err != nil {\n    panic(err)\n  }\n\n  fmt.Println(key)\n}\n</code></pre>\n\n<p>The <code>getAuthenticationKey</code> function there will select the correct segment from the supplied <code>inputUrl</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9684058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1526363803, "creation_date": 1524545987, "last_edit_date": 1526363803, "question_id": 49993740, "link": "https://stackoverflow.com/questions/49993740/how-to-take-some-part-of-the-url-as-a-sub-string-using-golang-in-gin-package", "title": "How to take some part of the url as a sub-string using golang in gin package?", "body": "<p>In golang I have a url when we hit it with using browser then some code will run. for example url:-</p>\n\n<p>Header:-</p>\n\n<pre><code>https://projects.com/id/669461/authenticationKey/0A8BE8D1AFDBC11C700548F72022DA5C\n</code></pre>\n\n<p><strong><em>Issue</em></strong> :-This is the url and I want to take out some string in the function variable like<code>number := \"0A8BE8D1AFDBC11C700548F72022DA5C\"</code> . How can we do this can anyone help me. Thank you in advance.</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 382, "user_id": 9353387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3G2gD.jpg?s=128&g=1", "display_name": "Isaa\u0441 Weisberg", "link": "https://stackoverflow.com/users/9353387/isaa%d1%81-weisberg"}, "edited": false, "score": 0, "creation_date": 1524539535, "post_id": 49992870, "comment_id": 87002191, "body": "Please provide additional output of <code>echo $GOROOT</code> and <code>echo $GOPATH</code>"}, {"owner": {"reputation": 175, "user_id": 6092122, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d114fe5b0d44af15c13e641824161900?s=128&d=identicon&r=PG&f=1", "display_name": "DavidB", "link": "https://stackoverflow.com/users/6092122/davidb"}, "reply_to_user": {"reputation": 382, "user_id": 9353387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3G2gD.jpg?s=128&g=1", "display_name": "Isaa\u0441 Weisberg", "link": "https://stackoverflow.com/users/9353387/isaa%d1%81-weisberg"}, "edited": false, "score": 0, "creation_date": 1524545539, "post_id": 49992870, "comment_id": 87003571, "body": "@IsaacCarolWeisberg - I just ran the command on my local machine terminal, the result is empty. I am new to Go. Please advice"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1524547329, "post_id": 49992870, "comment_id": 87004144, "body": "Try to run the commands inside src folder from terminal of vscode"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 6092122, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d114fe5b0d44af15c13e641824161900?s=128&d=identicon&r=PG&f=1", "display_name": "DavidB", "link": "https://stackoverflow.com/users/6092122/davidb"}, "edited": false, "score": 0, "creation_date": 1524573470, "post_id": 49994428, "comment_id": 87019778, "body": "@Issac . Thank you. In-fact, I found one video on YouTube is really helpful. <a href=\"https://www.youtube.com/watch?v=PGq6CPff2EY\" rel=\"nofollow noreferrer\">youtube.com/watch?v=PGq6CPff2EY</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1524578033, "post_id": 49994428, "comment_id": 87023217, "body": "&quot;This indicates an incomplete installation of go&quot; not true. <a href=\"https://golang.org/doc/go1.9#goroot\" rel=\"nofollow noreferrer\">As of Go 1.9 GOROOT is no longer required</a> (before that it defaulted to /usr/local/go), and <a href=\"https://github.com/golang/go/wiki/SettingGOPATH\" rel=\"nofollow noreferrer\">GOPATH defaults to $HOME/go</a>."}, {"owner": {"reputation": 2945, "user_id": 5345715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f05631812e06e1599ce28b59ed000c?s=128&d=identicon&r=PG&f=1", "display_name": "User12547645", "link": "https://stackoverflow.com/users/5345715/user12547645"}, "edited": false, "score": 1, "creation_date": 1554715251, "post_id": 49994428, "comment_id": 97839068, "body": "If you receive a <code>Error: Command failed go get...</code> even though you set the paths in bashrc, you might want to check if there is a problem with git, since these packages are downloaded via git.   It also helped to manually run one command after another, instead of automatically running them all at once"}], "tags": [], "owner": {"reputation": 382, "user_id": 9353387, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3G2gD.jpg?s=128&g=1", "display_name": "Isaa\u0441 Weisberg", "link": "https://stackoverflow.com/users/9353387/isaa%d1%81-weisberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1524549694, "creation_date": 1524549694, "answer_id": 49994428, "question_id": 49992870, "link": "https://stackoverflow.com/questions/49992870/failed-to-install-go-extension-in-visual-studio-code/49994428#49994428", "title": "Failed to install Go extension in Visual Studio Code", "body": "<p>As you have pointed out in your comment, on your system\n<code>echo $GOPATH</code> and <code>echo $GOROOT</code> produce empty output. This indicates an incomplete installation of <code>go</code>. Now, assuming you have installed the <code>go</code> toolchain via the downloads on the website or better yet, <code>gvm</code>, the all there is left to do is make the environment persist the changes across terminal sessions.</p>\n\n<p>Adding</p>\n\n<pre><code>export GOPATH=*your path to GOPATH*\nexport GOROOT=*path to your go installation*\n</code></pre>\n\n<p>to your <code>~/.bashrc</code>, restarting terminal session, restarting VSCode and reattempting to install the tools should do the trick.</p>\n\n<p><strong>Further reading</strong>:</p>\n\n<p><a href=\"https://golang.org/doc/install#install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install#install</a></p>\n\n<p><a href=\"https://github.com/golang/go/wiki/GOPATH\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/GOPATH</a></p>\n\n<p><a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#GOPATH</a></p>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 7140971, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ee-F10EuDiA/AAAAAAAAAAI/AAAAAAAAAC0/MYL0WuiQEZM/photo.jpg?sz=128", "display_name": "Malar Kandasamy", "link": "https://stackoverflow.com/users/7140971/malar-kandasamy"}, "is_accepted": false, "score": 0, "last_activity_date": 1618159744, "creation_date": 1618159744, "answer_id": 67047694, "question_id": 49992870, "link": "https://stackoverflow.com/questions/49992870/failed-to-install-go-extension-in-visual-studio-code/67047694#67047694", "title": "Failed to install Go extension in Visual Studio Code", "body": "<p>I removed all old Visual Studio Code in mac. I installed latest Visual studio code and it solved the issue.\n<a href=\"https://code.visualstudio.com/docs/setup/mac\" rel=\"nofollow noreferrer\">https://code.visualstudio.com/docs/setup/mac</a></p>\n<p>This is my .bashrc and .bash_profile setting:</p>\n<pre><code>export GOPATH=/Users/user/work\nexport GOROOT=/usr/local/Cellar/go/1.15.7/libexec\nexport PATH=$PATH:$GOROOT/bin\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 6092122, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d114fe5b0d44af15c13e641824161900?s=128&d=identicon&r=PG&f=1", "display_name": "DavidB", "link": "https://stackoverflow.com/users/6092122/davidb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9522, "favorite_count": 2, "accepted_answer_id": 49994428, "answer_count": 2, "score": 1, "last_activity_date": 1618159744, "creation_date": 1524539394, "question_id": 49992870, "link": "https://stackoverflow.com/questions/49992870/failed-to-install-go-extension-in-visual-studio-code", "title": "Failed to install Go extension in Visual Studio Code", "body": "<p>When I try to install the Go Extension in my Visual Studio Code, and I got these error messages as below.\nAm I missing something here?</p>\n\n<pre><code> gocode\n  gopkgs\n  go-outline\n  go-symbols\n  guru\n  gorename\n  godef\n  goreturns\n  golint\n  dlv\n\nInstalling github.com/nsf/gocode FAILED\nInstalling github.com/uudashr/gopkgs/cmd/gopkgs FAILED\nInstalling github.com/ramya-rao-a/go-outline FAILED\nInstalling github.com/acroca/go-symbols FAILED\nInstalling golang.org/x/tools/cmd/guru FAILED\nInstalling golang.org/x/tools/cmd/gorename FAILED\nInstalling github.com/rogpeppe/godef FAILED\nInstalling github.com/sqs/goreturns FAILED\nInstalling github.com/golang/lint/golint FAILED\nInstalling github.com/derekparker/delve/cmd/dlv FAILED\n\n10 tools failed to install.\n\ngocode:\nError: Command failed: /usr/local/go/bin/go get -u -v github.com/nsf/gocode\npackage github.com/nsf/gocode: cannot download, /home/bitnumbers/go is a GOROOT, not a GOPATH. For more details see: 'go help gopath'\npackage github.com/nsf/gocode: cannot download, /home/bitnumbers/go is a GOROOT, not a GOPATH. For more details see: 'go help gopath'\n</code></pre>\n\n<p>Please advice.</p>\n"}, {"tags": ["go", "nosql", "amazon-dynamodb", "amazon-dynamodb-streams"], "answers": [{"comments": [{"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1524575746, "post_id": 49994166, "comment_id": 87021506, "body": "You&#39;re saying ID should not be the hash key? It&#39;s the only unique row in the table, thought I read that should mean it&#39;s the hash. Also trying to see how I could use the range key to get the latest of each A/B combination."}, {"owner": {"reputation": 456, "user_id": 2064972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f353f025ddc079745303cd54a8afc76?s=128&d=identicon&r=PG&f=1", "display_name": "cerberus", "link": "https://stackoverflow.com/users/2064972/cerberus"}, "reply_to_user": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1524577456, "post_id": 49994166, "comment_id": 87022773, "body": "@NathanHyland you can use ID attribute as primary index. Create a Global secondary index with A attribute as partition key and Date as Sort Key."}], "tags": [], "owner": {"reputation": 456, "user_id": 2064972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f353f025ddc079745303cd54a8afc76?s=128&d=identicon&r=PG&f=1", "display_name": "cerberus", "link": "https://stackoverflow.com/users/2064972/cerberus"}, "is_accepted": false, "score": 0, "last_activity_date": 1524548496, "creation_date": 1524548496, "answer_id": 49994166, "question_id": 49992630, "link": "https://stackoverflow.com/questions/49992630/getting-the-latest-of-multiple-values-from-dynamodb/49994166#49994166", "title": "Getting the latest of multiple values from DynamoDB", "body": "<p>You should use attribute A as HashKey(PartitionKey) and Date as RangeKey(SortKey). With partitionKey only equality condition(==) can be used. RangeKey supports &lt;,>,=,Between operations.</p>\n\n<p><a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html\" rel=\"nofollow noreferrer\">Check this link</a></p>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1524548496, "creation_date": 1524537459, "question_id": 49992630, "link": "https://stackoverflow.com/questions/49992630/getting-the-latest-of-multiple-values-from-dynamodb", "title": "Getting the latest of multiple values from DynamoDB", "body": "<p>If I have a table like below:</p>\n\n<pre><code>ID   A B C D(ate)\nASDF 1 2 1 12/12/2016\nASEF 1 2 3 12/13/2016\nAFDS 2 3 1 12/13/2016\nASFA 2 3 4 12/14/2016\n</code></pre>\n\n<p>And I want to get the latest based on a pair (A, B) and the latest date (D), how would I set up a table to work well with this request, and what kind of query would I use to retrieve that?</p>\n\n<p>The output would give me values for the IDs ASEF and ASFA.</p>\n\n<p>I'm using the aws-go-sdk to run this, but I should be able to convert any solution to that SDK.</p>\n"}, {"tags": ["go", "installation", "failed-installation", "ubuntu-17.10"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1524542881, "post_id": 49992512, "comment_id": 87002849, "body": "This question directly involves a tool used primarily for programming, the Go programming language compiler and tools. It&#39;s on-topic."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 1, "creation_date": 1524550341, "post_id": 49992512, "comment_id": 87005281, "body": "<code>sudo su - root</code> then <code>Go</code> dissappears from my system too..Maybe the PATH is not set for <code>root</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 8321160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80289c5c19f2a9cdd1bd57650e4954eb?s=128&d=identicon&r=PG", "display_name": "Pablo", "link": "https://stackoverflow.com/users/8321160/pablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1524563953, "creation_date": 1524563953, "answer_id": 49998717, "question_id": 49992512, "link": "https://stackoverflow.com/questions/49992512/go-does-not-exist-when-logged-in-as-sudo-does-when-logged-in-as-user/49998717#49998717", "title": "GO does not exist when logged in as sudo, does when logged in as user", "body": "<p>You should ask in another community, like: <a href=\"https://unix.stackexchange.com/\">unix &amp; linux</a></p>\n\n<p>But, the problem is that when you log as root, the PATH variable is set as configured for root user. you have to configure the PATH environment variable of root user, or run su/sudo as following:</p>\n\n<pre><code>su --preserve-environment -\nsudo --preserve-env bash\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 5973071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb64015516c086679cf825e5873dbc80?s=128&d=identicon&r=PG&f=1", "display_name": "kbar", "link": "https://stackoverflow.com/users/5973071/kbar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1524563953, "creation_date": 1524536533, "last_edit_date": 1524538026, "question_id": 49992512, "link": "https://stackoverflow.com/questions/49992512/go-does-not-exist-when-logged-in-as-sudo-does-when-logged-in-as-user", "title": "GO does not exist when logged in as sudo, does when logged in as user", "body": "<p>The title is the problem - here is a brief explanation as to how I got here as I imagine that may help with sleuthing.</p>\n\n<p>I installed go, and everything was fine. I ran <code>build essential golang</code> command on Ubuntu, and all of a sudden my go version was out of sync with my <code>/usr/local/go/src/VERSION</code> file.</p>\n\n<p>I deleted my go files at <code>/usr/local/go/</code>, as well as the go and the go-1.8 folders in <code>/usr/bin/</code>. I then reinstalled go at <code>/usr/local/go</code></p>\n\n<p>Now, when I run <code>go env</code> as a user, the output looks correct. However (the title), when I am <code>sudo</code>, no go commands are recognized and I get the following message: The program 'go' can be found in the following packages:\n * golang-go\n * gccgo-go</p>\n\n<p>As a user, some of my go env output is: </p>\n\n<pre><code>GOPATH=\"/home/{me}/go\"\nGOROOT=\"/usr/local/go\"\n</code></pre>\n\n<p>As a user, my <code>echo $PATH</code> is :</p>\n\n<pre><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/usr/local/go/bin:/home/{me}/go/bin\n</code></pre>\n\n<p>My <code>~/.profile</code> includes:</p>\n\n<pre><code>export GOPATH=$HOME/go\nexport PATH=$PATH:/usr/local/go/bin:$GOPATH/bin\n</code></pre>\n\n<p>Help, please? : )</p>\n"}, {"tags": ["docker", "go", "microservices"], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 7789092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C9fg_rmgTtg/AAAAAAAAAAI/AAAAAAAAAAs/c2OQsYP7XwY/photo.jpg?sz=128", "display_name": "qskane", "link": "https://stackoverflow.com/users/7789092/qskane"}, "edited": false, "score": 0, "creation_date": 1524547106, "post_id": 49993084, "comment_id": 87004068, "body": "yes, it is an integration test, and   I have written unit tests before"}], "tags": [], "owner": {"reputation": 1508, "user_id": 1304519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8850b692b1c4e1d6439f002846a2df8?s=128&d=identicon&r=PG", "display_name": "Kajal Sinha", "link": "https://stackoverflow.com/users/1304519/kajal-sinha"}, "is_accepted": false, "score": 1, "last_activity_date": 1524541488, "creation_date": 1524541488, "answer_id": 49993084, "question_id": 49992237, "link": "https://stackoverflow.com/questions/49992237/if-there-are-multiple-microservices-how-should-i-integration-test-them/49993084#49993084", "title": "If there are multiple microservices, how should I integration test them?", "body": "<p>You did not explain what kind of test you want to do. The way you are doing it it seems you are running instances with database so I treat it more like an integration test.</p>\n\n<p>I assume you have written unit tests before doing this.</p>\n\n<p>If you wish to test independently I suggest making use of <a href=\"http://onsi.github.io/ginkgo/\" rel=\"nofollow noreferrer\">http://onsi.github.io/ginkgo/</a></p>\n\n<p>This will help you test most of the apis and business scenario and test the flow of your orderService and userService individually.</p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 3, "last_activity_date": 1524547981, "creation_date": 1524547981, "answer_id": 49994074, "question_id": 49992237, "link": "https://stackoverflow.com/questions/49992237/if-there-are-multiple-microservices-how-should-i-integration-test-them/49994074#49994074", "title": "If there are multiple microservices, how should I integration test them?", "body": "<p>If you change Go code you have to recompile; that's not abnormal. Go code compiles quickly so that's usually not a big deal.</p>\n\n<p>I'm not sure why you are running govendor repeatedly. If you are working on a dependency it is often easier to unvendor it temporarily.</p>\n\n<p>To speed things up, don't use Docker during development; at least not for the Go code. Since Go doesn't have any dependencies beside itself there's no advantage to doing this. You can still run backing services (e.g. a database) in Docker, but you don't have to rebuild and restart that all the time.</p>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 7789092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C9fg_rmgTtg/AAAAAAAAAAI/AAAAAAAAAAs/c2OQsYP7XwY/photo.jpg?sz=128", "display_name": "qskane", "link": "https://stackoverflow.com/users/7789092/qskane"}, "edited": false, "score": 0, "creation_date": 1524619205, "post_id": 50008846, "comment_id": 87041839, "body": "Your advice is very good, just because I am new to <code>golang</code> and <code>docker</code>, anyway, thanks again!"}], "tags": [], "owner": {"reputation": 113, "user_id": 8359632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbc269eaf1b2696ad5fa39f4d3548cc?s=128&d=identicon&r=PG&f=1", "display_name": "yihuaf", "link": "https://stackoverflow.com/users/8359632/yihuaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1524779346, "last_edit_date": 1524779346, "creation_date": 1524595592, "answer_id": 50008846, "question_id": 49992237, "link": "https://stackoverflow.com/questions/49992237/if-there-are-multiple-microservices-how-should-i-integration-test-them/50008846#50008846", "title": "If there are multiple microservices, how should I integration test them?", "body": "<p>First, I don't think repeating of go vendor is necessary unless dependency has changed. It should not happen often.</p>\n\n<p>Second, Golang does require you to build/compile, so if you make changes you would have to re-build the service. However, most of the times, you should make changes only to one services to make your life easier. It will make the testing and debugging easier during development.</p>\n\n<p>Lastly, there are a few ways to speed things up with development using docker. I would suggest keep using docker as it will make your devops life easier, although you don't have to. For simplicity, you can move the build step to Docker container. What you have to do is to copy the dir including the dependency into container and build inside the container (or just do <code>go run</code> inside container). This is OK for development. If you would like to have one set of container definition for development and deployment, you can write a script to compile each services, copy the binary into one directory and have docker copy the binary from that directory. A few lines of python script should be enough. This has the added benefits of using docker-compose where you can stand up the whole services with a single click. Then you can also write your integration test launcher using another docker container which will run your test once and exit.  </p>\n"}], "owner": {"reputation": 461, "user_id": 7789092, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-C9fg_rmgTtg/AAAAAAAAAAI/AAAAAAAAAAs/c2OQsYP7XwY/photo.jpg?sz=128", "display_name": "qskane", "link": "https://stackoverflow.com/users/7789092/qskane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 49994074, "answer_count": 3, "score": 1, "last_activity_date": 1524779346, "creation_date": 1524534123, "last_edit_date": 1524577087, "question_id": 49992237, "link": "https://stackoverflow.com/questions/49992237/if-there-are-multiple-microservices-how-should-i-integration-test-them", "title": "If there are multiple microservices, how should I integration test them?", "body": "<p>I am learning microservice architecture, but now there is some confusion.</p>\n\n<h3>situation</h3>\n\n<ul>\n<li>there are 4 projects written in <code>golang</code>\n\n<ol>\n<li><strong>orderService</strong></li>\n<li><strong>userService</strong></li>\n<li><strong>tools</strong></li>\n<li><strong>web</strong> ( forward <code>HTTP</code> request )</li>\n</ol></li>\n<li><code>orderService</code> , <code>userService</code>, <code>web</code> communicate via <code>grpc</code></li>\n<li>all api requests through <code>web</code> forwarding to <code>orderService</code> or <code>userService</code></li>\n<li><code>orderService</code> and <code>userService</code> have their own independent database</li>\n<li>they are all in <code>docker</code> containers</li>\n</ul>\n\n<h3>confusion</h3>\n\n<p>when I want to test a request, I have to do the following steps:</p>\n\n<pre><code>cd orderService\ngovender update +vendor\ngo build\n\ncd userService\ngovender update +vendor\ngo build\n\ncd web\ngovender update +vendor\ngo build\n\ndocker-compose build\ndocker-compose up\n</code></pre>\n\n<p>when I changed some code, I have to do this steps again.<br>\nI think this is unscientific and abnormal.  I want to know whether all of these steps are necessary to integration test four microservices in docker.</p>\n"}, {"tags": ["go", "google-bigquery"], "comments": [{"owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "edited": false, "score": 0, "creation_date": 1524556125, "post_id": 49991982, "comment_id": 87008602, "body": "I also facing the same issue!"}], "answers": [{"tags": [], "owner": {"reputation": 1298, "user_id": 3521565, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n8Owa.jpg?s=128&g=1", "display_name": "foxygen", "link": "https://stackoverflow.com/users/3521565/foxygen"}, "is_accepted": false, "score": 2, "last_activity_date": 1524602544, "creation_date": 1524602544, "answer_id": 50010448, "question_id": 49991982, "link": "https://stackoverflow.com/questions/49991982/go-bigquery-package-installs-with-errors-go-version-1-10-1/50010448#50010448", "title": "Go BigQuery package installs with errors (Go version 1.10.1)", "body": "<p>Looks like someone pushed a broken change to the Go BigQuery client last night.</p>\n\n<p><a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/commit/c718c274c122d2ca258bb8f93830d820cbb2160d\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-go/commit/c718c274c122d2ca258bb8f93830d820cbb2160d</a></p>\n\n<p>Should be fixed now. However, if you're using <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a> for Go dependency management, it looks like you'll need to set the revision like so in <code>Gopkg.toml</code> (if you are trying to use <a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go/tree/v0.21.0\" rel=\"nofollow noreferrer\">v0.21.0</a> of the <code>GoogleCloudPlatform/google-cloud-go</code> client):</p>\n\n<pre><code>[[constraint]]\n  name = \"cloud.google.com/go\"\n  revision = \"c718c274c122d2ca258bb8f93830d820cbb2160d\"\n</code></pre>\n\n<p>Sad times.</p>\n"}], "owner": {"reputation": 1298, "user_id": 3521565, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n8Owa.jpg?s=128&g=1", "display_name": "foxygen", "link": "https://stackoverflow.com/users/3521565/foxygen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524602544, "creation_date": 1524531887, "question_id": 49991982, "link": "https://stackoverflow.com/questions/49991982/go-bigquery-package-installs-with-errors-go-version-1-10-1", "title": "Go BigQuery package installs with errors (Go version 1.10.1)", "body": "<p>For some reason, I get the following errors when installing the <code>cloud.google.com/go/bigquery</code> package. I'm a Go noob, so I assume I'm doing something wrong. I was wondering if anyone was able to replicate, or could point me in the direction about how to resolve these errors? For example, is using a <code>bool</code> type in place of a <code>*bool</code> legal in prior versions of Go? Perhaps this is a bug in the Google package? </p>\n\n<pre><code>$ go get -u cloud.google.com/go/bigquery\n\n# cloud.google.com/go/bigquery\ngocode/src/cloud.google.com/go/bigquery/query.go:166:22: cannot use true (type bool) as type *bool in assignment\ngocode/src/cloud.google.com/go/bigquery/query.go:168:22: cannot use false (type bool) as type *bool in assignment\ngocode/src/cloud.google.com/go/bigquery/query.go:199:15: cannot use qq.UseLegacySql (type *bool) as type bool in field value\ngocode/src/cloud.google.com/go/bigquery/query.go:200:22: invalid operation: ! *bool\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1524577518, "post_id": 49991171, "comment_id": 87022815, "body": "You can&#39;t solve it in NodeJS at all, it&#39;s single-threaded."}, {"owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1524579526, "post_id": 49991171, "comment_id": 87024319, "body": "Yes of course, I wanted to express only the idea, not the low level behavior, u suggestions are welcome."}], "answers": [{"comments": [{"owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "reply_to_user": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "edited": false, "score": 0, "creation_date": 1524529777, "post_id": 49991198, "comment_id": 87000123, "body": "It really depends on the problem you are solving, for the sample as presented here, this way is likely the most simple. If you need to scale this up to N requests, you will probably need a different way to keep track of them. One example would be to use a single channel, and pass a unique ID into the <code>go request</code> function call, then use that same ID along with the result when you push it on to the channel to return."}], "tags": [], "owner": {"reputation": 26448, "user_id": 10322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa46a3814b72439b1d2efa8f7c9162c2?s=128&d=identicon&r=PG", "display_name": "ctcherry", "link": "https://stackoverflow.com/users/10322/ctcherry"}, "is_accepted": true, "score": 0, "last_activity_date": 1524525428, "creation_date": 1524525428, "answer_id": 49991198, "question_id": 49991171, "link": "https://stackoverflow.com/questions/49991171/perform-coordinated-gorutines-in-go/49991198#49991198", "title": "Perform coordinated gorutines in Go", "body": "<p>Use 2 channels. They will still run concurrently, and you can keep track of which is which.</p>\n\n<pre><code>func request(c chan bool, ms time.Duration, val bool) {\n    time.Sleep(ms * time.Millisecond)\n    c &lt;- val\n}\n\nfunc main() {\n    c1 := make(chan bool)\n    c2 := make(chan bool)\n\n    go request(c1, 1000, true)\n    go request(c2, 0, false)\n    first := &lt;-c1\n    second := &lt;-c2\n    fmt.Println(first, second) // output false true\n\n}\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 6724258, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-a2j_P9vJbvw/AAAAAAAAAAI/AAAAAAAABcw/3LyYxuqeDP0/photo.jpg?sz=128", "display_name": "Hume", "link": "https://stackoverflow.com/users/6724258/hume"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49991198, "answer_count": 1, "score": 0, "last_activity_date": 1524525428, "creation_date": 1524525139, "question_id": 49991171, "link": "https://stackoverflow.com/questions/49991171/perform-coordinated-gorutines-in-go", "title": "Perform coordinated gorutines in Go", "body": "<p>I would like to know how to coordinate routines in Go. A real case would be to coordinate two resources obtained through a request http. For example in node Nodejs would solve this with: <code>Promise.all [service1, service2]</code></p>\n\n<pre><code>func request(c chan bool, ms time.Duration, val bool) {\n    time.Sleep(ms * time.Millisecond)\n    c &lt;- val\n}\n\nfunc main() {\n    c := make(chan bool, 2)\n    go request(c, 1000, true)\n    go request(c, 0, false)\n    first, second := &lt;-c, &lt;-c\n    fmt.Println(first, second) // output false true\n\n}\n</code></pre>\n\n<p>The first one to be resolved is placed over the others, but how can I identify each one?</p>\n\n<p>Thanks for you time.</p>\n"}, {"tags": ["sql-server", "go"], "comments": [{"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 3, "creation_date": 1524517908, "post_id": 49989917, "comment_id": 86996508, "body": "Did you try it?"}, {"owner": {"reputation": 8672, "user_id": 1768008, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/110a4869ccf97041d884164cc36c36b6?s=128&d=identicon&r=PG", "display_name": "wonderful world", "link": "https://stackoverflow.com/users/1768008/wonderful-world"}, "reply_to_user": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1524599936, "post_id": 49989917, "comment_id": 87036354, "body": "<code>trusted_connection=true</code> in the connection string did not work."}, {"owner": {"reputation": 30515, "user_id": 3813116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DeWnw.png?s=128&g=1", "display_name": "Sean Lange", "link": "https://stackoverflow.com/users/3813116/sean-lange"}, "edited": false, "score": 0, "creation_date": 1524600207, "post_id": 49989917, "comment_id": 87036491, "body": "I would assume &quot;did not work&quot; came with an error message? I don&#39;t know anything about GO so I have no idea if it works or not."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 14514836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b3805fa9ac6eccd9b568efe9cdd42f?s=128&d=identicon&r=PG", "display_name": "AK Valley", "link": "https://stackoverflow.com/users/14514836/ak-valley"}, "is_accepted": true, "score": 1, "last_activity_date": 1614893263, "creation_date": 1614893263, "answer_id": 66483298, "question_id": 49989917, "link": "https://stackoverflow.com/questions/49989917/how-to-use-trusted-connection-with-go-mssql-package-denisenkom-go-mssqldb/66483298#66483298", "title": "How to use trusted connection with GO MSSQL package denisenkom/go-mssqldb?", "body": "<p>The connection string for Windows Authentication looks like this:</p>\n<pre><code>&quot;server=localhost;user id=;&quot;\n</code></pre>\n<p>The value for &quot;user id&quot; parameter is blank and the &quot;password&quot; parameter is not used in the connection string.</p>\n<p>This closed issue <a href=\"https://github.com/denisenkom/go-mssqldb/issues/475\" rel=\"nofollow noreferrer\">Trouble connecting with Active Directory authentication</a> from the GitHub repo provides more details about how Windows authentication works than the official documentation and examples.</p>\n"}], "owner": {"reputation": 8672, "user_id": 1768008, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/110a4869ccf97041d884164cc36c36b6?s=128&d=identicon&r=PG", "display_name": "wonderful world", "link": "https://stackoverflow.com/users/1768008/wonderful-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 66483298, "answer_count": 1, "score": 0, "last_activity_date": 1614893263, "creation_date": 1524517440, "last_edit_date": 1524518413, "question_id": 49989917, "link": "https://stackoverflow.com/questions/49989917/how-to-use-trusted-connection-with-go-mssql-package-denisenkom-go-mssqldb", "title": "How to use trusted connection with GO MSSQL package denisenkom/go-mssqldb?", "body": "<p>Can I use <code>trusted connection</code> in the connection string to connect to MS-SQL? I'm using <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">denisenkom/go-mssqldb</a>?</p>\n\n<p>This is a sample connection string that I see from an article:</p>\n\n<p><code>server=localhost;user id=sa;password=SA_PASSWORD=yourStrong(!)Password;</code></p>\n\n<p>The <a href=\"https://github.com/denisenkom/go-mssqldb#connection-parameters-and-dsn\" rel=\"nofollow noreferrer\">documentation section</a> does not mention about the <code>trusted connection</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1524515662, "post_id": 49988363, "comment_id": 86995511, "body": "Tangential: if you use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a>, you can use Get() and Select() to pull, respectively, a single entry or a slice of entries without having to handle a <code>rows</code> variable.  Those functions return only an error, and thus work well with the <code>if &lt;statement&gt;; &lt;conditional&gt; {</code> style.  sqlx is also just a really amazing library in general."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1524555094, "post_id": 49988363, "comment_id": 87007971, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16126102/handling-multiple-errors-in-go\">Handling multiple errors in go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1524515547, "post_id": 49988398, "comment_id": 86995465, "body": "Though in this case, simply moving the function call outside the if statement (and using shortform declaration) is actually a more compact code style.  Declaring the vars beforehand added 2 lines when moving the statement into the if block saved 1 line.  Can work rather well if the vars are already declared for some reason or if you use named returns, though."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1524516782, "post_id": 49988398, "comment_id": 86995992, "body": "Either way, it has the same effect of moving the declaration outside the block."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 4, "last_activity_date": 1524510948, "creation_date": 1524510948, "answer_id": 49988398, "question_id": 49988363, "link": "https://stackoverflow.com/questions/49988363/less-verbose-error-handling-in-go/49988398#49988398", "title": "Less verbose error handling in Go?", "body": "<p>They're only trapped in scope if they're declared in the <code>if</code> block using <code>:=</code>. If you declare them outside the <code>if</code>, they're in the outer scope:</p>\n\n<pre><code>var err error\nvar result SomeResultType\nif result,err = SomeFunc(); err != nil {\n    // Handle error\n}\n// Do something with result (or error if you want)\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 8877952, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9385de92399494fd92bd73fb2cc3c4ef?s=128&d=identicon&r=PG&f=1", "display_name": "bblocs3141", "link": "https://stackoverflow.com/users/8877952/bblocs3141"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 369, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524510948, "creation_date": 1524510786, "question_id": 49988363, "link": "https://stackoverflow.com/questions/49988363/less-verbose-error-handling-in-go", "title": "Less verbose error handling in Go?", "body": "<p>I have some Go code that queries a Database using the \"database/sql\" package. Most of these functions return: <code>result, err</code> or <code>rows, err</code>.</p>\n\n<p>Because of this, you end up with many repetitive blocks like this:</p>\n\n<pre><code>if err != nil {\n  // Handle Error\n}\n</code></pre>\n\n<p>I've seen \"cleaner\" code for functions that only return err:</p>\n\n<pre><code>if err := SomeFunc(); err != nil {\n  // Handle Error\n}\n</code></pre>\n\n<p>I can't do this with these functions because the variable gets trapped in the scope when I need to access it in another query function later on.</p>\n\n<p>Is there a way to clean up this go code?</p>\n"}, {"tags": ["c", "go", "ffmpeg", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1524570215, "post_id": 49993115, "comment_id": 87017560, "body": "Cool, the ptr_at and stream_at functions look like the ones. How does stream_at work? In the example you&#39;re passing it an AVFormatContext (ctx) rather than AVStream (ctx.streams), does it search for streams in that class or something?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1524575641, "post_id": 49993115, "comment_id": 87021436, "body": "@nevernew Sorry, it was my mistake. You must pass in a pointer to <code>AVFormatContext</code> to function <code>stream_at</code>. I updated the explanation."}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 0, "creation_date": 1524580081, "post_id": 49993115, "comment_id": 87024709, "body": "Oh awesome, I wasn&#39;t aware of <code>C.stream_at</code>"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1524603248, "post_id": 49993115, "comment_id": 87037778, "body": "question continued: <a href=\"https://stackoverflow.com/questions/50010555/cgo-how-do-i-write-to-a-file-in-golang-using-a-pointer-to-the-c-data\" title=\"cgo how do i write to a file in golang using a pointer to the c data\">stackoverflow.com/questions/50010555/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 4, "last_activity_date": 1524575520, "last_edit_date": 1524575520, "creation_date": 1524541704, "answer_id": 49993115, "question_id": 49987098, "link": "https://stackoverflow.com/questions/49987098/how-to-access-a-c-pointer-array-from-golang/49993115#49993115", "title": "How to access a C pointer array from Golang", "body": "<p>As you noticed, the problem is in the following code:</p>\n\n<pre><code>func (ctxt *Context) StreamsGet(i uintptr) *Stream {\n    streams := (**Stream)(unsafe.Pointer(ctxt.streams));\n    // I think this is where it's going wrong, I'm brand new to this stuff \n    return (*Stream)(unsafe.Pointer(uintptr(unsafe.Pointer(streams)) + i*unsafe.Sizeof(*streams)));\n}\n</code></pre>\n\n<p>In the code, variable <code>streams</code> is <strong>double pointer</strong>, thus the result of adding offset to <code>streams</code> is also a double pointer (i.e. the type is <code>**Stream</code>). But, in your snippets, it is casted to <code>*Stream</code> which is incorrect. The correct code is:</p>\n\n<pre><code>func (ctxt *Context) StreamsGet(i uintptr) *Stream {\n    streams := (**Stream)(unsafe.Pointer(ctxt.streams))\n    // Add offset i then cast it to **Stream\n    ptrPtr := (**Stream)(unsafe.Pointer(uintptr(unsafe.Pointer(streams)) + i*unsafe.Sizeof(*streams)))\n    return *ptrPtr\n}\n</code></pre>\n\n<p><strong>Additional note:</strong><br>\nIf you would like to avoid pointer arithmetic in <code>Go</code> side, you can define a <em>helper</em> function for accessing the element of the pointer (i.e. streams) in C side as follows:</p>\n\n<pre><code>/*\nvoid * ptr_at(void **ptr, int idx) {\n    return ptr[idx];\n}\n\nstruct AVStream * stream_at(struct AVFormatContext *c, int idx) {\n    if (i &gt;= 0 &amp;&amp; i &lt; c-&gt;nb_streams)\n        return c-&gt;streams[idx];\n    return NULL;\n}\n*/\nimport \"C\"\nimport (\n    \"unsafe\"\n)\n\ntype Context C.struct_AVFormatContext\ntype Stream C.struct_AVStream\n\nfunc (ctx *Context) StreamAt(i int) *Stream {\n    p := (*unsafe.Pointer)(unsafe.Pointer(ctx.streams))\n    ret := C.ptr_at(p, C.int(i))\n\n    return (*Stream)(ret)\n}\n\nfunc (ctx *Context) StreamAt2(i int) *Stream {\n    ret := C.stream_at((*C.struct_AVFormatContext)(ctx), C.int(i))\n\n    return (*Stream)(ret)\n}\n</code></pre>\n\n<p>You may choose either <code>ptr_at</code> function which accepts generic (any) double pointer as its argument, or more specific <code>stream_at</code> function which only accepts pointer to <code>AVFormatContext</code> as its argument. The former approach can be used to access element from any double pointer such as: <code>AVProgram **</code>, <code>AVChapter **</code>, etc. The later approach is preferable if we need to implement additional processing such as boundary checking. </p>\n"}], "owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2127, "favorite_count": 0, "accepted_answer_id": 49993115, "answer_count": 1, "score": 3, "last_activity_date": 1524575520, "creation_date": 1524505698, "last_edit_date": 1524556175, "question_id": 49987098, "link": "https://stackoverflow.com/questions/49987098/how-to-access-a-c-pointer-array-from-golang", "title": "How to access a C pointer array from Golang", "body": "<p>I'm writing an app for the windows platform using FFmpeg and it's golang wrapper goav, but I'm having trouble understanding how to use the C pointers to gain access to an array.</p>\n\n<p>I'm trying to get the streams stored in the AVFormatContext class to use in go, and eventually add frames to a texture in OpenGl to make a video player with cool transitions.</p>\n\n<p>I think understanding how to cast and access the C data will make coding this a lot easier.</p>\n\n<p>I've stripped out all the relevant parts of the C code, the wrapper and my code, shown below:</p>\n\n<p>C code - libavformat/avformat.h</p>\n\n<pre><code>typedef struct AVFormatContext { \n    unsigned int nb_streams; \n    AVStream **streams; \n}\n</code></pre>\n\n<p>Golang goav wrapper</p>\n\n<pre><code>package avutil\n\n//#cgo pkg-config: libavformat\n//#include &lt;libavformat/avformat.h&gt;\nimport \"C\"\nimport (\n    \"unsafe\"\n)\n\ntype Context C.struct_AVFormatContext; \n\nfunc (ctxt *Context) StreamsGet(i uintptr) *Stream {\n    streams := (**Stream)(unsafe.Pointer(ctxt.streams));\n    // I think this is where it's going wrong, I'm brand new to this stuff \n    return (*Stream)(unsafe.Pointer(uintptr(unsafe.Pointer(streams)) + i*unsafe.Sizeof(*streams)));\n}\n</code></pre>\n\n<p>My Golang code</p>\n\n<pre><code>package main\n\nimport \"github.com/giorgisio/goav/avformat\"\n\nfunc main() {\n    ctx := &amp;avformat.Context{} // the actual function to initiate this does an mallocz for the streams\n\n    stream := ctx.StreamsGet(0)\n\n    //do stuff with stream...\n}\n</code></pre>\n\n<p>In C it looks like I just have to do just streams[i], but that wont work in go, so I added a function to the wrapper using the technique from my question <a href=\"https://stackoverflow.com/questions/49931051/cgo-how-do-you-use-pointers-in-golang-to-access-data-from-an-array-in-c\">here</a>. \nHowever I'm not getting the data; It looks like I'm getting a pointer to somewhere random in memory. So, how can I access these elements form golang? Any resources would be helpful too; I'm going to be investing a fair bit of time into this.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1524505879, "post_id": 49987028, "comment_id": 86990515, "body": "<code>increaseCounter</code> needs to have a pointer receiver: <code>(g *Golang)</code>."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1524506005, "post_id": 49987028, "comment_id": 86990582, "body": ":) hehe its working thank you."}, {"owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1524602660, "post_id": 49987028, "comment_id": 87037546, "body": "If you downvote, please put comment like a real man."}], "answers": [{"tags": [], "owner": {"reputation": 330, "user_id": 2996610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3a59b1d471be646c0e835c2c8b5f756?s=128&d=identicon&r=PG&f=1", "display_name": "cheks", "link": "https://stackoverflow.com/users/2996610/cheks"}, "is_accepted": false, "score": 0, "last_activity_date": 1524556954, "creation_date": 1524556954, "answer_id": 49996387, "question_id": 49987028, "link": "https://stackoverflow.com/questions/49987028/trying-to-implement-oops-in-golang-with-structs/49996387#49996387", "title": "Trying to implement OOPS in golang with structs", "body": "<p>When you run method without pointer you copy struct data, when use poiner you change original data.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 8359632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbc269eaf1b2696ad5fa39f4d3548cc?s=128&d=identicon&r=PG&f=1", "display_name": "yihuaf", "link": "https://stackoverflow.com/users/8359632/yihuaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1524595781, "creation_date": 1524595781, "answer_id": 50008889, "question_id": 49987028, "link": "https://stackoverflow.com/questions/49987028/trying-to-implement-oops-in-golang-with-structs/50008889#50008889", "title": "Trying to implement OOPS in golang with structs", "body": "<p>Change <code>func (g Golang) increaseCounter()</code> to <code>func (g *Golang) increaseCounter()</code>. You need pointer receiver to change the data inside the struct.</p>\n"}], "owner": {"reputation": 13087, "user_id": 2062973, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/GD1pm.png?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2062973/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 1, "answer_count": 2, "score": -2, "last_activity_date": 1524595781, "creation_date": 1524505378, "question_id": 49987028, "link": "https://stackoverflow.com/questions/49987028/trying-to-implement-oops-in-golang-with-structs", "title": "Trying to implement OOPS in golang with structs", "body": "<p>I am trying to retain the stats of a struct. What I am trying to do is create a struct using NewGolang and increase the counter, but all the output are  1. I am expecting 1,2,3. Can somebody please explain.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Golang struct {\n    SessionCounter int\n}\n\nfunc NewGolang() *Golang {\n    return &amp;Golang{\n            SessionCounter: 0,\n    }\n}\n\nfunc (g Golang) increaseCounter() {\n    g.SessionCounter++\n    fmt.Println(g.SessionCounter)\n}\n\nfunc main() {\n    obj := NewGolang()\n    obj.increaseCounter()\n    obj.increaseCounter()\n    obj.increaseCounter()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> 1\n 1 \n 1\n</code></pre>\n\n<p>Expected:\n     1\n     2\n     3</p>\n"}, {"tags": ["java", "go", "jna"], "comments": [{"owner": {"reputation": 2082, "user_id": 1932789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2ba307979825d683215da659c2455?s=128&d=identicon&r=PG", "display_name": "Zachary Craig", "link": "https://stackoverflow.com/users/1932789/zachary-craig"}, "edited": false, "score": 3, "creation_date": 1524504415, "post_id": 49986729, "comment_id": 86989757, "body": "Are you asking how to call your &quot;Add&quot; function from java? I&#39;m really confused, because that code you just posted is GO, not java, maybe if that is in fact the goal post the java code you&#39;ve tried to use to access this function?"}, {"owner": {"reputation": 10279, "user_id": 4138801, "user_type": "registered", "accept_rate": 97, "profile_image": "https://lh4.googleusercontent.com/-aVJI2hM4hYc/AAAAAAAAAAI/AAAAAAAAAEk/cXFqsfUYh0o/photo.jpg?sz=128", "display_name": "Clashsoft", "link": "https://stackoverflow.com/users/4138801/clashsoft"}, "reply_to_user": {"reputation": 2082, "user_id": 1932789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a2ba307979825d683215da659c2455?s=128&d=identicon&r=PG", "display_name": "Zachary Craig", "link": "https://stackoverflow.com/users/1932789/zachary-craig"}, "edited": false, "score": 0, "creation_date": 1524504561, "post_id": 49986729, "comment_id": 86989856, "body": "@zack6849 hes trying to use JNA, there is a tag but its not specified in the question body."}, {"owner": {"reputation": 13032, "user_id": 4216641, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dVLIh.jpg?s=128&g=1", "display_name": "Turing85", "link": "https://stackoverflow.com/users/4216641/turing85"}, "edited": false, "score": 1, "creation_date": 1524504820, "post_id": 49986729, "comment_id": 86989976, "body": "<a href=\"https://medium.com/learning-the-go-programming-language/calling-go-functions-from-other-languages-4c7d8bcc69bf\" rel=\"nofollow noreferrer\">This</a> seems to be a relatively recent article on the topic. I have not verified its content though."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1524505114, "post_id": 49986729, "comment_id": 86990107, "body": "I&#39;m voting to close this question as off-topic because it displays no attempt to do even a minimal research and does not present a clear narrow problem."}, {"owner": {"reputation": 1455, "user_id": 542271, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d240821bb9eccc63133cff302670a3a8?s=128&d=identicon&r=PG", "display_name": "dmotta", "link": "https://stackoverflow.com/users/542271/dmotta"}, "edited": false, "score": 0, "creation_date": 1524510582, "post_id": 49986729, "comment_id": 86992890, "body": "Yes, I need to move some logic from Java &#39;Spring Batch&#39;  to Golang, in order to improve the performance. My idea is use JNA as Interface to access to Golang functions."}], "answers": [{"tags": [], "owner": {"reputation": 1455, "user_id": 542271, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d240821bb9eccc63133cff302670a3a8?s=128&d=identicon&r=PG", "display_name": "dmotta", "link": "https://stackoverflow.com/users/542271/dmotta"}, "is_accepted": true, "score": 15, "last_activity_date": 1524524626, "creation_date": 1524524626, "answer_id": 49991098, "question_id": 49986729, "link": "https://stackoverflow.com/questions/49986729/how-to-call-go-function-from-java-using-java-native-interface/49991098#49991098", "title": "How to call go function from java using Java native interface?", "body": "<p>After review of the documentation about <a href=\"https://github.com/jbuberel/buildmodeshared\" rel=\"noreferrer\">Go Shared Libraries</a> </p>\n\n<p>It is possible to integrate the call Golang functions from Java Spring Batch, below a short example:</p>\n\n<p>Golang function: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nimport \"C\"\n\n//export Add\nfunc Add(x, y int) int {\n    fmt.Printf(\"Go says: adding %v and %v\\n\", x, y)\n    return x + y\n}\n</code></pre>\n\n<p>After that, execute the command to generate the binary files:</p>\n\n<pre><code>go build -buildmode=c-shared -o bin/lib-cqm-transformer.so src/cqm_transformer.go\n</code></pre>\n\n<p>This generates the binary files:</p>\n\n<pre><code>ls -la bin/\ntotal 2860\ndrwxrwxr-x 2 dmotta dmotta    4096 abr 23 01:13 .\ndrwxrwxr-x 5 dmotta dmotta    4096 abr 23 00:35 ..\n-rw-r--r-- 1 root   root      1558 abr 23 01:13 lib-cqm-transformer.h\n-rw-r--r-- 1 root   root   2915112 abr 23 01:13 lib-cqm-transformer.so\n</code></pre>\n\n<p>Finally, create the JNA class:</p>\n\n<pre><code>package com.XX.XX.batch.engine.transformer;\n\nimport com.sun.jna.Library;\nimport com.sun.jna.Native;\n\npublic class GoEngineTransformerTest {\n  static GoCqmTransformer GO_CQM_TRANSFORMER;\n  static {\n    String os = System.getProperty(\"os.name\").toLowerCase();\n    String libExtension;\n    if (os.contains(\"mac os\")) {\n      libExtension = \"dylib\";\n    } else if (os.contains(\"windows\")) {\n      libExtension = \"dll\";\n    } else {\n      libExtension = \"so\";\n    }\n\n    String pwd = System.getProperty(\"user.dir\");\n    String lib = pwd + \"/golang/bin/lib-cqm-transformer.\" + libExtension;\n    GO_CQM_TRANSFORMER = (GoCqmTransformer) Native.loadLibrary(lib, GoCqmTransformer.class);\n  }\n\n  public interface GoCqmTransformer extends Library {\n    long Add(long x, long y);\n  }\n\n  public static void main(String[] args) {\n    System.out.println(\"Java says: about to call Go ..\");\n    long total = GO_CQM_TRANSFORMER.Add(30, 12);\n    System.out.println(\"Java says: result is \" + total);\n  }\n}\n</code></pre>\n\n<p>After that, execute from Main Java class, Results:</p>\n\n<pre><code>Java HotSpot(TM) 64-Bit Server VM warning: You have loaded library /tmp/jna1412558273325390219.tmp which might have disabled stack guard. The VM will try to fix the stack guard now.\nIt's highly recommended that you fix the library with 'execstack -c &lt;libfile&gt;', or link it with '-z noexecstack'.\nJava says: about to call Go ..\nGo says: adding 30 and 12\nJava says: result is 42\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 542271, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d240821bb9eccc63133cff302670a3a8?s=128&d=identicon&r=PG", "display_name": "dmotta", "link": "https://stackoverflow.com/users/542271/dmotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7703, "favorite_count": 8, "accepted_answer_id": 49991098, "answer_count": 1, "score": 1, "last_activity_date": 1589451900, "creation_date": 1524504298, "last_edit_date": 1589451900, "question_id": 49986729, "link": "https://stackoverflow.com/questions/49986729/how-to-call-go-function-from-java-using-java-native-interface", "title": "How to call go function from java using Java native interface?", "body": "<p>It is possible to call C methods through JNA interface in Java. My question is how I can reach the same functionality with Go?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nimport \"C\"\n\n//export Add\nfunc Add(x, y int) int {\n    fmt.Printf(\"Go says: adding %v and %v\\n\", x, y)\n    return x + y\n}\n</code></pre>\n"}, {"tags": ["csv", "go"], "answers": [{"comments": [{"owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "edited": false, "score": 0, "creation_date": 1524495236, "post_id": 49983955, "comment_id": 86984428, "body": "Thanks, I had the exact same thing earlier. But then I processed the value further before writing it out, removing the newline character again -.-"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1524494918, "creation_date": 1524494918, "answer_id": 49983955, "question_id": 49983877, "link": "https://stackoverflow.com/questions/49983877/writing-multi-line-string-to-csv-file/49983955#49983955", "title": "Writing multi line string to CSV file", "body": "<p>You need to embed the <code>\\n</code> in your multiline value. You can do this, for example, by using <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings.Join</code></a>:</p>\n\n<pre><code>w.Write([]string{\n    normalValue,\n    strings.Join(multiValue, \"\\n\"),\n})\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uWJnClpQ1OT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uWJnClpQ1OT</a></p>\n"}], "owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 0, "accepted_answer_id": 49983955, "answer_count": 1, "score": -1, "last_activity_date": 1524494932, "creation_date": 1524494684, "last_edit_date": 1524494932, "question_id": 49983877, "link": "https://stackoverflow.com/questions/49983877/writing-multi-line-string-to-csv-file", "title": "Writing multi line string to CSV file", "body": "<p>How can I write a multi line value to a CSV file using the <code>encoding/csv</code> package?</p>\n\n<pre><code>fh, err := os.Create(fileName)\nif err != nil {\n    log.Fatalf(\"Could not create file: %v\", err)\n}\ndefer fh.Close()\nw := csv.NewWriter(fh)\n\nnormalValue := \"I am a single line value\"\nmultiValue := []string{\"I am a \", \"multi line value\"}\n\nw.Write([]string{normalValue, multiValue})\n</code></pre>\n\n<p>The result I would expect in the resulting CSV file:</p>\n\n<pre><code>I am a single line value,\"I am a \nmulti line value\"\n</code></pre>\n\n<p>How can I realize this, since <code>csv.Write</code> does not accept <code>[]string</code> as an argument? Simply appending <code>\\n</code> between each element of the multi line value does not achieve anything either.</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 292, "user_id": 3006344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5bd75574303cf338529d605191d6f6?s=128&d=identicon&r=PG", "display_name": "Cajus Pollmeier", "link": "https://stackoverflow.com/users/3006344/cajus-pollmeier"}, "edited": false, "score": 0, "creation_date": 1524493382, "post_id": 49983496, "comment_id": 86983347, "body": "Doh. That works. And just because of one little missing ampersand ;-) Thanks for your quick response!"}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1524493500, "last_edit_date": 1524493500, "creation_date": 1524493230, "answer_id": 49983496, "question_id": 49982976, "link": "https://stackoverflow.com/questions/49982976/setting-protobuf-properties-by-name/49983496#49983496", "title": "Setting protobuf properties by name", "body": "<p>You need to pass a pointer to <code>o</code> to <code>reflect.ValueOf</code>. By simply passing the value, the fields of the struct will not be addressable.</p>\n\n<pre><code>r := reflect.ValueOf(&amp;o)\nf := reflect.Indirect(r).FieldByName(\"Uid\")\nf.SetUint(42)\n</code></pre>\n\n<p>If at all possible, however, I would try to implement this without reflection. Either use a map in your protocol buffer definition, or a switch in your Go code:</p>\n\n<pre><code>switch name {\ncase \"Uid\":\n    o.Uid = uintValue\ncase \"Name\"\n    o.Name = stringValue\n}\n</code></pre>\n\n<p>The non-reflect code is less likely to fail at runtime.</p>\n"}], "owner": {"reputation": 292, "user_id": 3006344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5bd75574303cf338529d605191d6f6?s=128&d=identicon&r=PG", "display_name": "Cajus Pollmeier", "link": "https://stackoverflow.com/users/3006344/cajus-pollmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 49983496, "answer_count": 1, "score": 0, "last_activity_date": 1524493500, "creation_date": 1524491754, "question_id": 49982976, "link": "https://stackoverflow.com/questions/49982976/setting-protobuf-properties-by-name", "title": "Setting protobuf properties by name", "body": "<p>To avoid too much spaghetti style code, I'd like to set certain properties of a <em>golang</em> protobuf object by name. So lets say there's some kind of <code>.proto</code> definition like</p>\n\n<pre><code>syntax = \"proto3\";\npackage foo;\n\nmessage User {\n    uint64 uid = 1;\n    string name = 2;\n}\n</code></pre>\n\n<p>and code accessing it like</p>\n\n<pre><code>o := foo.User{Name: \"John Doe\"}\no.Uid = 40\n</code></pre>\n\n<p>exists. I'd like to be able to set <code>Uid</code> without the dotted notation. Reflection constructs like</p>\n\n<pre><code>r := reflect.ValueOf(o)\nf := reflect.Indirect(r).FieldByName(\"Uid\")\nf.SetUint(42)\n</code></pre>\n\n<p>seem to fail, because <code>Uid</code> is not <em>addressable</em>. I found several posts about struct fields <em>not being addressable</em>, but it's still unclear (to me as a \"golang newbie\") what has to be done in this context to make it work.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 7, "creation_date": 1524489251, "post_id": 49981996, "comment_id": 86980185, "body": "You cannot have a field with name &quot;type&quot;. You <b>must</b> rename it. No arguing, no workaround. Rename."}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524489390, "post_id": 49981996, "comment_id": 86980279, "body": "I can not rename it, as it is a key used in payment gateway&#39;s API response. Please help me with this."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1524489402, "post_id": 49981996, "comment_id": 86980286, "body": "For umarshaling an API response all you usually need is a tag."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1524489439, "post_id": 49981996, "comment_id": 86980306, "body": "E.g. <code>Type string `json:&quot;type&quot;`</code>"}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524489680, "post_id": 49981996, "comment_id": 86980494, "body": "Ok. Thanks @mkopriva. I will try"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 6, "creation_date": 1524489726, "post_id": 49981996, "comment_id": 86980546, "body": "Anyways if you&#39;re using <code>encoding&#47;json</code> or <code>encoding&#47;xml</code> or other reflect-using-packages you&#39;ll need to change your fields to start with an upper case letter, otherwise the unmarshaling won&#39;t work. (user defined symbols starting with lower case letters are <i>unexported</i>)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524491392, "post_id": 49981996, "comment_id": 86981777, "body": "&quot;I can not rename it&quot; <i>is</i> arguing."}], "answers": [{"tags": [], "owner": {"reputation": 1592, "user_id": 7251967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-al-If026iHU/AAAAAAAAAAI/AAAAAAAAABE/9lsheyH-V9Q/photo.jpg?sz=128", "display_name": "negi Yogi", "link": "https://stackoverflow.com/users/7251967/negi-yogi"}, "is_accepted": true, "score": 9, "last_activity_date": 1524508778, "last_edit_date": 1524508778, "creation_date": 1524490111, "answer_id": 49982397, "question_id": 49981996, "link": "https://stackoverflow.com/questions/49981996/declare-struct-field-name-as-type/49982397#49982397", "title": "Declare struct field name as &quot;type&quot;", "body": "<p>Update your struct to this , to unmarshal api response <em>you need to export your structure's fields</em> i.e your structs feilds should be in upper case:</p>\n\n<pre><code>type Test struct {\n    Active bool `json:\"active\"`\n    Name string  `json:\"name\"`\n    Description string `json:\"description\"`\n    Amount  int `json:\"amount\"`\n    Currency string `json:\"currency\"`\n    Type string `json:\"type\"`\n}\n</code></pre>\n\n<p>And then try to unmarshal your API response to this struct </p>\n"}], "owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1073, "favorite_count": 0, "accepted_answer_id": 49982397, "answer_count": 1, "score": 4, "last_activity_date": 1524547333, "creation_date": 1524489054, "last_edit_date": 1524547333, "question_id": 49981996, "link": "https://stackoverflow.com/questions/49981996/declare-struct-field-name-as-type", "title": "Declare struct field name as &quot;type&quot;", "body": "<p>I am integrating API and parsing its response in a structure. For this I need to declare field name as <code>type</code> as API's response contains <code>key</code> named <code>type</code>. But when I declare <code>type</code> in field name it gives me error: </p>\n\n<blockquote>\n  <p>syntax error: unexpected literal <code>type</code>, expecting field name or\n  embedded type.</p>\n</blockquote>\n\n<p>I don't know how to declare literal <code>type</code> as struct field name.</p>\n\n<p>My struct is </p>\n\n<pre><code>type Test struct {\n    active bool\n    name string\n    description string\n    amount  int\n    currency string\n    type string\n}\n</code></pre>\n"}, {"tags": ["node.js", "go", "cryptography"], "comments": [{"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1530003635, "post_id": 49981704, "comment_id": 89069084, "body": "Please fix your title spelling: when you write <i>ecryption</i>, do you mean &quot;decryption&quot; or &quot;encryption&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 15202, "user_id": 183110, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e56fee2230943ae9886f84233cc640b8?s=128&d=identicon&r=PG", "display_name": "John Giotta", "link": "https://stackoverflow.com/users/183110/john-giotta"}, "edited": false, "score": 0, "creation_date": 1524491749, "post_id": 49982723, "comment_id": 86982039, "body": "May I suggest, if you have an example of change, post it in your answer. As you said &quot;a few posts... same problem&quot;. It can go a long way."}, {"owner": {"reputation": 377, "user_id": 4660279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d1a52216d25e42decc1d62130c263fb?s=128&d=identicon&r=PG&f=1", "display_name": "Darksorrow", "link": "https://stackoverflow.com/users/4660279/darksorrow"}, "reply_to_user": {"reputation": 15202, "user_id": 183110, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e56fee2230943ae9886f84233cc640b8?s=128&d=identicon&r=PG", "display_name": "John Giotta", "link": "https://stackoverflow.com/users/183110/john-giotta"}, "edited": false, "score": 0, "creation_date": 1524495888, "post_id": 49982723, "comment_id": 86984884, "body": "I&#39;m sorry i&#39;m not sure what you mean by change, i read those posts amoung others (<a href=\"https://stackoverflow.com/questions/46475204/golang-decrypt-aes-256-cbc-base64-from-nodejs\" title=\"golang decrypt aes 256 cbc base64 from nodejs\">stackoverflow.com/questions/46475204/&hellip;</a>) and (<a href=\"https://stackoverflow.com/questions/46475204/golang-decrypt-aes-256-cbc-base64-from-nodejs\" title=\"golang decrypt aes 256 cbc base64 from nodejs\">stackoverflow.com/questions/46475204/&hellip;</a>) but they weren&#39;t fully related to my problem, tho now i&#39;m exploring how to remove padding. This was easy in node but in golang i can&#39;t do only a parseInt(numWithPadding, 10).toString() :D"}], "tags": [], "owner": {"reputation": 377, "user_id": 4660279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d1a52216d25e42decc1d62130c263fb?s=128&d=identicon&r=PG&f=1", "display_name": "Darksorrow", "link": "https://stackoverflow.com/users/4660279/darksorrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1524491042, "creation_date": 1524491042, "answer_id": 49982723, "question_id": 49981704, "link": "https://stackoverflow.com/questions/49981704/nodejs-golang-aes-256-decryption/49982723#49982723", "title": "Nodejs / Golang aes 256 decryption", "body": "<p>Ok this is working well actually, the blocksize show isn't a problem, internally it creates the correct block for the aes256, my problem was because of the parameters sent to me that added padding on the \"encr\" variable. But the code on top works perfectly</p>\n"}], "owner": {"reputation": 377, "user_id": 4660279, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5d1a52216d25e42decc1d62130c263fb?s=128&d=identicon&r=PG&f=1", "display_name": "Darksorrow", "link": "https://stackoverflow.com/users/4660279/darksorrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 49982723, "answer_count": 1, "score": 0, "last_activity_date": 1530130451, "creation_date": 1524488257, "last_edit_date": 1530130451, "question_id": 49981704, "link": "https://stackoverflow.com/questions/49981704/nodejs-golang-aes-256-decryption", "title": "Nodejs / Golang aes 256 decryption", "body": "<p>I have an encrypted string that I was able to decrypt in nodejs using the following code</p>\n\n<pre><code>let decrypt = crypto.createDecipheriv('aes-256-cbc-hmac-sha1', derived, iv);\ndecrypt.setAutoPadding(false);\nlet decrypted = decrypt.update(new_buf, 'binary', 'utf8') + decrypt.final('utf8');\n</code></pre>\n\n<p>I have to be able to decrypt the same buffer in a go program and I wrote this</p>\n\n<pre><code>fmt.Printf(\"buf size=%d\\n\", len(derivedKey))\nblock, err := aes.NewCipher(derivedKey)\nif err != nil {\n    fmt.Printf(\"%v\\n\", err)\n    return (\"0\")\n}\nfmt.Printf(\"block size=%d\\n\", block.BlockSize())\ncbc := cipher.NewCBCDecrypter(block, ivKey)\nfmt.Printf(\"cbc block size=%d\\n\", cbc.BlockSize())\ndecr := make([]byte, len(encr))\ncbc.CryptBlocks(decr, []byte(encr))\n</code></pre>\n\n<p>This isn't working (I suppose I won't be posting here otherwise :p) but I also noticed that when I print the length of the derived key I get 32 but when I read the block.BlockSize() or the cbc.BlockSize() I get 16 as an answer so I'm wondering if I don't have to setup something because it is detecting my algorithm as aes128 instead of aes256.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6388, "user_id": 847552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc674fd2cf824532531bd2b193bdc920?s=128&d=identicon&r=PG", "display_name": "skovorodkin", "link": "https://stackoverflow.com/users/847552/skovorodkin"}, "edited": false, "score": 0, "creation_date": 1524487711, "post_id": 49980194, "comment_id": 86979078, "body": "A relevant issue: <a href=\"https://github.com/spf13/cobra/issues/563\" rel=\"nofollow noreferrer\">How can I pass context.Context between pre/post-run hooks?</a>."}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 1, "creation_date": 1524489155, "post_id": 49980194, "comment_id": 86980110, "body": "If i understand correctly then this answer is the exact same problem;  <a href=\"https://stackoverflow.com/a/49981932/6376471\">stackoverflow.com/a/49981932/6376471</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524512307, "post_id": 49980194, "comment_id": 86993876, "body": "@Zak , well you answer as my question :) using env( with different approach, here is viper in you answer is   terraform.io/docs/state , isnt it similar approach ?if not why?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524554447, "post_id": 49980194, "comment_id": 87007535, "body": "<code>viper.Set(...)</code> will not persist between executions of the same program. The docs (<a href=\"https://godoc.org/github.com/spf13/viper#Set\" rel=\"nofollow noreferrer\">godoc.org/github.com/spf13/viper#Set</a>) talk say that viper will store the value set in its internal register which means that it will be lost after the program ends.  Assuming in your case the program does not exit between <code>Run</code> and <code>PersistentPostRun</code> then you will be fine using viper.  If <code>PersistentPostRun</code> is executed as another CLI tool execution then the values in <code>viper.Set(...)</code> will be lost."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524580875, "post_id": 49980194, "comment_id": 87025307, "body": "@Zak - there is some example code for your solution proposal , some oss example for my context ? if yes please provide it as answer, the link to the second question doesnt help much for my case...."}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 4628081, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yGbnkCNSojE/AAAAAAAAAAI/AAAAAAAAAcY/zmn34zFQAVI/photo.jpg?sz=128", "display_name": "Francesco Gualazzi", "link": "https://stackoverflow.com/users/4628081/francesco-gualazzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1532355675, "creation_date": 1532355675, "answer_id": 51481059, "question_id": 49980194, "link": "https://stackoverflow.com/questions/49980194/how-to-pass-parameters-from-command-objects/51481059#51481059", "title": "How to pass parameters from command objects", "body": "<p>you don't need Viper for that.\nJust create 2 singletons (variables with global scope in the command file) and you can assign them to your Build function returns.</p>\n\n<p>Example </p>\n\n<pre><code>package cmd\n\nvar (\n    root,\n    value string\n)\n\nvar cfBuild = &amp;cobra.Command{\n    Use:   \"build\",\n    Short: \"Build\",\n    Run: func(cmd *cobra.Command, args []string) {\n        root, value = Build(target)\n    },\n    PersistentPostRun: func(cmd *cobra.Command, args []string) {\n        fmt.Printf(\"%s, %s\", root, value)\n   } \n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8557463"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1923, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1532355675, "creation_date": 1524483438, "last_edit_date": 1524483882, "question_id": 49980194, "link": "https://stackoverflow.com/questions/49980194/how-to-pass-parameters-from-command-objects", "title": "How to pass parameters from command objects", "body": "<p>I use the following code which need to pass value from functions <code>root, value</code></p>\n\n<pre><code>var cfBuild = &amp;cobra.Command{\n    Use:   \"build\",\n    Short: \"Build\",\n    Run: func(cmd *cobra.Command, args []string) {\n\n\n        root, value := Build(target)\n    },\n    PersistentPostRun: func(cmd *cobra.Command, args []string) {\n   //Here I need to use root, value\n   } \n}\n</code></pre>\n\n<p>I can do it by using global variable but is there a nice way to avoid global in this case ?</p>\n\n<p>This is the repo, I didnt find any nice way to do it ...\n<a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">https://github.com/spf13/cobra</a></p>\n\n<p>Btw there is option to use <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">viper</a></p>\n\n<p>like ...</p>\n\n<pre><code>Run: func(cmd *cobra.Command, args []string) {\n    root, value := Build(target)\n    viper.Set(\"root\", root)\n    viper.Set(\"value\", value)\n</code></pre>\n\n<p>and then get it in the other method...\nIs it good direction?</p>\n"}, {"tags": ["algorithm", "go"], "comments": [{"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 2, "creation_date": 1524482595, "post_id": 49979881, "comment_id": 86975715, "body": "Why this specific choice? This doesn&#39;t look like a good idea, because  of the problem you encounter (among a lot of other issues)."}, {"owner": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 1, "creation_date": 1524482700, "post_id": 49979881, "comment_id": 86975774, "body": "Things would work a lot better if it was MM.DD - there&#39;s a reason people often store dates as YYYYMMDD"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1524482713, "post_id": 49979881, "comment_id": 86975787, "body": "To be honest, the array of float64 is not from my choice, I have to work with this. If I had the choice, I would do it another way, sure."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1524482746, "post_id": 49979881, "comment_id": 86975804, "body": "also, with fixed bits IEEE-754 floating point number, your 1.02 will actually be stored as closest-approximation, like  1.019999980926513671875 .  I know all these comments don&#39;t solve your actual problem, but still... Find a way to <i>get out</i> of this terrible data representation would be the first step I&#39;d take in order to work properly with sorting and everything else"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 38170, "user_id": 57135, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/S9roh.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/57135/joe"}, "edited": false, "score": 0, "creation_date": 1524483009, "post_id": 49979881, "comment_id": 86975980, "body": "@Joe : I could manage to get that format if needed"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 2, "creation_date": 1524483239, "post_id": 49979881, "comment_id": 86976121, "body": "@Pac0 : I did not tell everything, at the beginning, I have it in string. I first decided to parse it in float64 because I thought it could be easier to sort. May I update the post and title ?"}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 1, "creation_date": 1524483424, "post_id": 49979881, "comment_id": 86976259, "body": "Yes, keep it as string looks better IMO, at least you will be able to manipulate it without the floating point accuracy problem . See next comment from Mr Lister for simple solution."}, {"owner": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 3, "creation_date": 1524483443, "post_id": 49979881, "comment_id": 86976277, "body": "It&#39;s a string? Then just flip the parts before and after the dot, and sort as strings."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 2, "creation_date": 1524483530, "post_id": 49979881, "comment_id": 86976332, "body": "And sure, please go on with editing title/question to reflect the actual problem you are trying to solve."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1524483635, "post_id": 49979881, "comment_id": 86976388, "body": "@Pac0 : Ok thanks, I did."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 42447, "user_id": 1016716, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1c83d772b1c065603c7f20975d8d3552?s=128&d=identicon&r=PG", "display_name": "Mr Lister", "link": "https://stackoverflow.com/users/1016716/mr-lister"}, "edited": false, "score": 0, "creation_date": 1524484142, "post_id": 49979881, "comment_id": 86976714, "body": "@MrLister : I do not understand what you mean.."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 1, "creation_date": 1524484327, "post_id": 49979881, "comment_id": 86976829, "body": "@Elwyn Tranform the strings from &quot;DD.MM&quot; to &quot;MMDD&quot;, and then convert them to integer and sort them, the natural order of integers will be your date ordering. You can also simply sort them as string, with the natural lexicographic order, but make sure you don&#39;t forget the leading 0 for month before 10"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1524484586, "post_id": 49979881, "comment_id": 86977003, "body": "It may be an information that I forgot to add but I need the original format to remain the same, I mean, it is useful for me for the next steps. So if I convert to int, and change the format, I need to do the reverse operation after that."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "reply_to_user": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1524484756, "post_id": 49979881, "comment_id": 86977091, "body": "@Pac0 : did you notice that the month is after the dot and the day is before ? Or maybe I still do not understand you.."}, {"owner": {"reputation": 16371, "user_id": 479251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9870fa7c3f578b33976c7a770cbff4b2?s=128&d=identicon&r=PG", "display_name": "Pac0", "link": "https://stackoverflow.com/users/479251/pac0"}, "edited": false, "score": 0, "creation_date": 1524484880, "post_id": 49979881, "comment_id": 86977166, "body": "Well, I don&#39;t know how your program is structured, but usually for a sort, one could create a comparator function that will try to tell if some element is greater than another element. Inside this comparator function, you can do the conversion job. This conversion is only for some temporary variables in the comparator function, your <i>actual data</i> should not be modified. Mbo has given an example of such a comparator function in pseudocode."}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 0, "creation_date": 1524489962, "post_id": 49979881, "comment_id": 86980720, "body": "Thanks, understood now. Do not know why the downvotes, I find the question useful."}], "answers": [{"comments": [{"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 1, "creation_date": 1524489809, "post_id": 49980520, "comment_id": 86980610, "body": "Thanks a lot, I will accept the Golang answer but yours is the correct algorithm with the prefix case"}], "tags": [], "owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "is_accepted": false, "score": 2, "last_activity_date": 1524484560, "creation_date": 1524484560, "answer_id": 49980520, "question_id": 49979881, "link": "https://stackoverflow.com/questions/49979881/sort-d-mm-and-dd-mm-dates-in-ascending-order/49980520#49980520", "title": "Sort &quot;d.mm&quot; and &quot;dd.mm&quot; dates in ascending order", "body": "<p>You need to use comparator function (As far as I see - <code>go</code> provides <a href=\"https://gobyexample.com/sorting-by-functions\" rel=\"nofollow noreferrer\">such possibility</a>) that separates string into two parts, compares the second parts, in case of equality compares the first part.<br>\nTo provide correct comparison of days, transform string values to integers or just add '0' in the beginning if string length is 1 (to make '21' > '7')</p>\n\n<p>pseudocode:</p>\n\n<pre><code> sort list with comparator func(a, b: string):\n    a =&gt; lefta, righta\n    b =&gt; leftb, rightb\n    if righta &gt; rightb\n       return 1\n    else if righta &lt; rightb\n       return -1\n    else:       \n      if length(lefta)=1\n         lefta = '0' + lefta\n      if length(leftb)=1\n         leftb = '0' + leftb\n      if lefta &gt; leftb\n         return 1\n      else if lefta &lt; leftb\n         return -1\n      else\n         return 0       \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 4, "creation_date": 1524485859, "post_id": 49980671, "comment_id": 86977777, "body": "You made a mistake described in my answer. Check your code with additional date &#39;11.02&#39;"}, {"owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "edited": false, "score": 1, "creation_date": 1524489838, "post_id": 49980671, "comment_id": 86980631, "body": "Thanks a lot, with the appropriate fix it is working"}], "tags": [], "owner": {"reputation": 6388, "user_id": 847552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc674fd2cf824532531bd2b193bdc920?s=128&d=identicon&r=PG", "display_name": "skovorodkin", "link": "https://stackoverflow.com/users/847552/skovorodkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1524489236, "last_edit_date": 1524489236, "creation_date": 1524485114, "answer_id": 49980671, "question_id": 49979881, "link": "https://stackoverflow.com/questions/49979881/sort-d-mm-and-dd-mm-dates-in-ascending-order/49980671#49980671", "title": "Sort &quot;d.mm&quot; and &quot;dd.mm&quot; dates in ascending order", "body": "<p>I suppose you need a Go program. Check <a href=\"https://play.golang.org/p/wtrkqKPVqz9\" rel=\"nofollow noreferrer\">this one</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n    \"strings\"\n)\n\ntype ByDay struct { sort.StringSlice }\nfunc (a ByDay) Less(i, j int) bool {\n    dmi, dmj := strings.Split(a.StringSlice[i], \".\"), strings.Split(a.StringSlice[j], \".\")\n    return dmi[1] &lt; dmj[1] || dmi[1] == dmj[1] &amp;&amp; dmi[0] &lt; dmj[0]\n}\n\nfunc main() {\n    days := []string{\"3.03\", \"3.02\", \"2.02\", \"3.01\", \"1.03\", \"1.02\"}\n    sort.Sort(ByDay{days})\n    fmt.Println(days)\n}\n</code></pre>\n\n<p>It prints <code>[3.01 1.02 2.02 3.02 1.03 3.03]</code>.</p>\n\n<p>I doubt <code>ByDay</code> is the best name, you'd better give it a more descriptive one.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1524500206, "last_edit_date": 1524500206, "creation_date": 1524490448, "answer_id": 49982501, "question_id": 49979881, "link": "https://stackoverflow.com/questions/49979881/sort-d-mm-and-dd-mm-dates-in-ascending-order/49982501#49982501", "title": "Sort &quot;d.mm&quot; and &quot;dd.mm&quot; dates in ascending order", "body": "<p>For example, an efficient conversion and comparison,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc mmdd(key string) uint32 {\n    // \"d.mm\" or \"dd.mm\"\n    k := uint32(key[len(key)-1])&lt;&lt;16 +\n        uint32(key[len(key)-2])&lt;&lt;24 +\n        uint32(key[len(key)-4])&lt;&lt;0\n    if len(key) &gt;= 5 {\n        k += uint32(key[len(key)-5]) &lt;&lt; 8\n    }\n    return k\n}\n\nfunc main() {\n    // 1.02 (1st of February); 2.02 (2nd of February); 1.03 (1st of March); 3.02 (3rd of February)\n    keys := []string{\"31.12\", \"01.01\", \"1.02\", \"2.02\", \"1.03\", \"3.02\", \"30.11\"}\n    fmt.Println(keys)\n    sort.Slice(keys,\n        func(i, j int) bool {\n            return mmdd(keys[i]) &lt; mmdd(keys[j])\n        },\n    )\n    fmt.Println(keys)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[31.12 01.01 1.02 2.02 1.03 3.02 30.11]\n[01.01 1.02 2.02 3.02 1.03 30.11 31.12]\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 1699865, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7dfd127ca79430fed151aa1665ac7c84?s=128&d=identicon&r=PG", "display_name": "Elwyn", "link": "https://stackoverflow.com/users/1699865/elwyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 49980671, "answer_count": 3, "score": -1, "last_activity_date": 1524500206, "creation_date": 1524482529, "last_edit_date": 1524497384, "question_id": 49979881, "link": "https://stackoverflow.com/questions/49979881/sort-d-mm-and-dd-mm-dates-in-ascending-order", "title": "Sort &quot;d.mm&quot; and &quot;dd.mm&quot; dates in ascending order", "body": "<p>I have <code>var keys []string</code>. A key represents the day and month formatted as either <code>\"D.MM\"</code> or <code>\"DD.MM\"</code>.</p>\n\n<p>For example : </p>\n\n<p><code>1.02 (1st of February) - 2.02 (2nd of February) - 1.03 (1st of March) - 3.02 (3rd of February) - 31.12 (31st of December)</code></p>\n\n<p>I need the keys to be sorted as follows:</p>\n\n<p><code>[ '1.02', '2.02', '3.02', '1.03', '31.12' ]</code>.</p>\n\n<p>First the months, and then the days within the months.</p>\n\n<p>I first tried to parse the string into a float64 number because I thought it would be easier to work with numbers (see the comments), but it seems it is worst.</p>\n\n<p>How can I achieve this?</p>\n"}, {"tags": ["go", "hcl"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524480958, "post_id": 49977465, "comment_id": 86974660, "body": "Any particular reason to not just set the field after decoding?"}, {"owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524486125, "post_id": 49977465, "comment_id": 86977965, "body": "Yes, I have some reason about that. For example, I&#39;m going to check validation of HCL options before passing them to real structure fields."}, {"owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524555134, "post_id": 49977465, "comment_id": 87008000, "body": "I can implement it using the <a href=\"https://github.com/kvz/json2hcl/blob/master/main.go\" rel=\"nofollow noreferrer\">following link</a>"}], "owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 779, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524475279, "creation_date": 1524475279, "question_id": 49977465, "link": "https://stackoverflow.com/questions/49977465/set-hcl-fields-in-golang", "title": "Set HCL fields in golang", "body": "<p>I'm going to set HCL fields in <code>golang</code>.\nHere the example.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n\n    \"github.com/hashicorp/hcl\"\n)\n\nconst (\n    EXAMPLE_HCL = `config = \"/etc/test.conf\"`\n)\n\ntype HCLConfig struct {\n    ConfigFile          string     `hcl:\"config\"`\n}\n\nfunc main() {\n    cfg := &amp;HCLConfig{}\n\n    hclTree, err := hcl.Parse(EXAMPLE_HCL)\n    if err != nil {\n        os.Exit(1)\n    }\n\n    // how to modify tree to override config field\n\n    if err := hcl.DecodeObject(&amp;cfg, hclTree); err != nil {\n        os.Exit(1)\n    }\n\n    log.Printf(\"%+v\\n\", cfg)\n}\n</code></pre>\n\n<p>It's possible to override <code>config</code> field after called a function <code>hcl.DecodeObject</code>.</p>\n\n<p>But I'm going to override that field before calling <code>hcl.DecodeObject</code>.</p>\n\n<p>Is there some way to modify HCL tree?</p>\n"}, {"tags": ["go", "concurrency", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1524487976, "post_id": 49975926, "comment_id": 86979268, "body": "@Cerise ... true :)"}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1524495934, "post_id": 49975926, "comment_id": 86984922, "body": "Also true .. but you&#39;re just being pointlessly pedantic now. It really doesn&#39;t change the fact that the concurrency happens within the server and the questioners handler function will be called concurrently. How would you like me to edit the answer to make you happy? A full call stack?"}, {"owner": {"reputation": 75, "user_id": 8963223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b3dcf07a38a007436420609f9d708b?s=128&d=identicon&r=PG&f=1", "display_name": "Vish K", "link": "https://stackoverflow.com/users/8963223/vish-k"}, "edited": false, "score": 0, "creation_date": 1524533169, "post_id": 49975926, "comment_id": 87000897, "body": "Thanks I understand, Yes concerned with minor details :)"}], "tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 1, "last_activity_date": 1524469867, "creation_date": 1524469867, "answer_id": 49975926, "question_id": 49975616, "link": "https://stackoverflow.com/questions/49975616/golang-rest-api-concurrency/49975926#49975926", "title": "Golang rest api concurrency", "body": "<p>The concurrency happens inside the router - it will start a separate goroutine for each messaged received that uses the handler. Repository instances will be shared so don't put any code in there that isn't concurrency safe.</p>\n"}, {"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 75, "user_id": 8963223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b3dcf07a38a007436420609f9d708b?s=128&d=identicon&r=PG&f=1", "display_name": "Vish K", "link": "https://stackoverflow.com/users/8963223/vish-k"}, "edited": false, "score": 0, "creation_date": 1524608135, "post_id": 49986212, "comment_id": 87039374, "body": "@VishK I still don&#39;t know what that package is. In any case, find out if the values are thread safe or not. If they are not, protect them with a mutex in the controller."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1524502799, "last_edit_date": 1524502799, "creation_date": 1524502336, "answer_id": 49986212, "question_id": 49975616, "link": "https://stackoverflow.com/questions/49975616/golang-rest-api-concurrency/49986212#49986212", "title": "Golang rest api concurrency", "body": "<p>The net/http server automatically starts a new goroutine for each client connection and executes request handlers in those goroutines. The application does not need to do anything special to serve requests concurrently.</p>\n\n<p>The single mux, controller and db values are used for all requests, and possibly concurrently.</p>\n\n<p>Use a <a href=\"https://godoc.org/sync#Mutex\" rel=\"nofollow noreferrer\">mutex</a> to protect these values if they are not thread-safe.  The mux (assuming you are using gorilla/mux) and the controller (as currently written) are both thread-safe.  No mutex is needed for those values. I don't know what the <code>daos</code> package is, so I cannot comment on the necessity of using a mutex to protect the db value.</p>\n"}], "owner": {"reputation": 75, "user_id": 8963223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28b3dcf07a38a007436420609f9d708b?s=128&d=identicon&r=PG&f=1", "display_name": "Vish K", "link": "https://stackoverflow.com/users/8963223/vish-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3783, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1524502799, "creation_date": 1524468725, "question_id": 49975616, "link": "https://stackoverflow.com/questions/49975616/golang-rest-api-concurrency", "title": "Golang rest api concurrency", "body": "<p>I am writing the rest api in golang with the following structure</p>\n\n<p>Handler classes:</p>\n\n<pre><code>type Controller struct {\n    db daos.IUserDB\n}\n\nfunc NewController(db daos.IUserDB) *Controller{\n    return &amp;Controller{db:db}\n}\n\n\nfunc (c *Controller) Test(w http.ResponseWriter, r *http.Request)  {\n\n    fmt.Fprintf(w, \"Welcome to the HomePage!\")\n}\n\nfunc (c *Controller) RegisterRoutes(r *mux.Router){\n    r.HandleFunc(\"/test\", c.Test).Methods(\"GET\")\n}\n</code></pre>\n\n<p>DAO classes</p>\n\n<pre><code>type IUserDB interface {\n    Get\n    GetByID ... \n}\n\n\ntype userDAO struct {\n    db *sql.DB\n}\n\n\nfunc NewDB(dataSourceName string) (*userDAO, error) {\n    db, err := sql.Open(\"mysql\", dataSourceName)\n    if err != nil {\n        return nil, err\n    }\n    if err = db.Ping(); err != nil {\n        return nil, err\n    }\n    return &amp;userDAO{db}, nil\n}\n\nfunc (dao *userDAO) Get(){\n}\n\nfunc (dao *userDAO) GetByID(){\n}\n</code></pre>\n\n<p>main class</p>\n\n<pre><code>func main() {\n\n    db, err := daos.NewDB(connectionStr)\n    if err != nil {\n        log.Panic(errr)\n    }\n    handler := handlers.NewController(db)\n\n    router := mux.NewRouter()\n    handler.RegisterRoutes(router)\n\n    log.Printf(\"serving on port 8080\")\n    http.ListenAndServe(\":3000\", router)\n}\n</code></pre>\n\n<p>Question:</p>\n\n<p>We are creating only <strong>one instance of Handler and Repository</strong> objects. (will make another service interface also)</p>\n\n<p><strong>How golang achieve concurrency with this setup for simultaneous many request ?</strong></p>\n\n<p>For every request the same object of handler or db will be used ?</p>\n\n<p>Help to clarify this design ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 8, "creation_date": 1524466590, "post_id": 49975045, "comment_id": 86965988, "body": "<a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 330, "user_id": 2996610, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f3a59b1d471be646c0e835c2c8b5f756?s=128&d=identicon&r=PG&f=1", "display_name": "cheks", "link": "https://stackoverflow.com/users/2996610/cheks"}, "edited": false, "score": 0, "creation_date": 1524561836, "post_id": 49975045, "comment_id": 87012071, "body": "You can`t declare dif\u0430erent package name in one package"}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": true, "score": 2, "last_activity_date": 1524466832, "creation_date": 1524466832, "answer_id": 49975132, "question_id": 49975045, "link": "https://stackoverflow.com/questions/49975045/how-i-can-use-local-package-in-golang/49975132#49975132", "title": "How I can use local package in golang?", "body": "<p>You need to put each package in a separate sub-directory. So your directory structure so put lib.go in <code>project/lib</code> and main.go in <code>project/cmd</code>. It should then work.</p>\n"}, {"tags": [], "owner": {"reputation": 435, "user_id": 1044149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47a63452f832c056947c4eaec05415ce?s=128&d=identicon&r=PG", "display_name": "Spiros I. Economakis", "link": "https://stackoverflow.com/users/1044149/spiros-i-economakis"}, "is_accepted": false, "score": 0, "last_activity_date": 1524467232, "creation_date": 1524467232, "answer_id": 49975233, "question_id": 49975045, "link": "https://stackoverflow.com/questions/49975045/how-i-can-use-local-package-in-golang/49975233#49975233", "title": "How I can use local package in golang?", "body": "<p>First of all create a separate package <code>libtest</code> and put <code>lib.go</code> there. Then you should give the full path of <code>libtest</code> otherwise your import right now searches for <code>$GOPATH/src/libtest</code> or <code>/usr/local/Cellar/go/&lt;version&gt;</code> which doesn't exist. </p>\n\n<p>So you should give <code>import project/libtest</code></p>\n"}], "owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "closed_date": 1524594702, "accepted_answer_id": 49975132, "answer_count": 2, "score": -5, "last_activity_date": 1524467232, "creation_date": 1524466482, "question_id": 49975045, "link": "https://stackoverflow.com/questions/49975045/how-i-can-use-local-package-in-golang", "closed_reason": "Duplicate", "title": "How I can use local package in golang?", "body": "<p>Here are two <code>.go</code> files.</p>\n\n<pre><code>\u251c\u2500\u2500 lib.go\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>The <code>lib.go</code> has a package <code>libtest</code>.</p>\n\n<pre><code>$ cat lib.go \n\npackage libtest\n\nimport (\n    \"fmt\"\n)\n\nfunc TestLibFunc() {\n    fmt.Println(\"This is test library function\")\n}\n</code></pre>\n\n<p>The <code>main.go</code> has a package <code>main</code>.</p>\n\n<pre><code>$ cat main.go\npackage main\n\nimport (\n    \"libtest\"\n)\n\nfunc main() {\n    libtest.TestLibFunc()\n}\n</code></pre>\n\n<p>When I tried to build them, but it's failed.</p>\n\n<pre><code>$ go build *.go\ncan't load package: package main: found packages libtest (lib.go) and main (main.go) in /Users/dev/work/tmp/local-package\n</code></pre>\n\n<p>How can I use local packages in <code>main</code> package?</p>\n"}, {"tags": ["go", "command-line", "command-line-arguments", "viper-go", "go-cobra"], "comments": [{"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524473360, "post_id": 49974998, "comment_id": 86969762, "body": "How are the two cobra commands run? Surely you can only run one at a time from the CLI? Or does one call the other?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524473446, "post_id": 49974998, "comment_id": 86969810, "body": "@Zak - I run one at a time..."}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 1, "creation_date": 1524473622, "post_id": 49974998, "comment_id": 86969939, "body": "Are they always run one after another? Maybe you could follow the unix philosophy <a href=\"https://en.wikipedia.org/wiki/Unix_philosophy#Origin\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Unix_philosophy#Origin</a>. Specifically the points in origin. &quot;Expect the output of every program to become the input to another&quot;. You could output the things you need from command 1, to stdout and then use that as the input to command 2 using &quot;|&quot; pipe. I don&#39;t think polluting the env is a good idea, the vars should only exist for the lifetime of the program"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524473684, "post_id": 49974998, "comment_id": 86969976, "body": "@Zak - I think that <code>viper</code> could be better, what do you think?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524473802, "post_id": 49974998, "comment_id": 86970057, "body": "I think this problem is bigger than the CLI library that you choose. There&#39;s no good way of storing state between running of CLI tools / commands. Unless you are persisting to some kind of file or chaining them with pipe. The ENV can be considered a type of file."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524473913, "post_id": 49974998, "comment_id": 86970132, "body": "@Zak - ok, can you please provide your suggestion as answer please ?"}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1524693162, "post_id": 49974998, "comment_id": 87079842, "body": "What do you mean with &quot;E2E solution&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1524752535, "post_id": 49974998, "comment_id": 87107048, "body": "@IvandelaBeldad - &quot;productive solution&quot; ..."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524905148, "post_id": 49974998, "comment_id": 87165531, "body": "be wary that cloud systems might have ephimeral file systems that are subject to data loss. eg: heroku"}, {"owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "edited": false, "score": 2, "creation_date": 1525037116, "post_id": 49974998, "comment_id": 87199133, "body": "You&#39;ve gotten perfectly reasonable answers but you seem to want something that isn&#39;t really reasonable. If you want stateful operations you need to either 1) Run a daemon process and interact with it via your CLI tool or 2) Generate and store a configuration data somewhere on the system. Both have the same problem, however, that whatever state first command created, could be undone before running the next. <i>You still have to deal with the state potentially being bogus or missing when you run the second command</i>. It seems like you&#39;re fixated on a solution rather than solving the actual problem."}, {"owner": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "edited": false, "score": 0, "creation_date": 1525262776, "post_id": 49974998, "comment_id": 87286379, "body": "after reading the (good) answers already there and seeing you dont like it, why not just implement a third command, which combines the first two in just one invocation?"}], "answers": [{"comments": [{"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524489714, "post_id": 49981932, "comment_id": 86980528, "body": "One project that I know that does this well is <code>terraform</code> <a href=\"https://www.terraform.io/docs/state/\" rel=\"nofollow noreferrer\">terraform.io/docs/state</a> it basically persists everything that it needs in a file <code>terraform.tfstate</code> (using json syntax)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524489879, "post_id": 49981932, "comment_id": 86980652, "body": "I dont want in json, I want in env ...why json is better?"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524490071, "post_id": 49981932, "comment_id": 86980796, "body": "I am not saying you should use json. Only that that is one of many formats. You can write to the environment if you wish."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524508638, "post_id": 49981932, "comment_id": 86991871, "body": "You didnt provide any example code in my context...it will be great if you can add it and i&#39;ll close the question, thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524672906, "post_id": 49981932, "comment_id": 87070065, "body": "Sorry but your answer doesnt answer my real requirements"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524690876, "post_id": 49981932, "comment_id": 87078950, "body": "HI,Thanks, Sorry but I need some E2E &quot;productive&quot; solution, the second solution IMO is not suitable for it, can you provide E2E solution for the first option (productive one ...)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524691026, "post_id": 49981932, "comment_id": 87079023, "body": "btw, The reason that I put high bounty is that I need E2E productive solution for it , go playground example will help to understand your points better."}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "edited": false, "score": 0, "creation_date": 1524727922, "post_id": 49981932, "comment_id": 87090579, "body": "Your problem is that even if you opt to use environment variables, all commands that are run in shell get a child env (basically a copy of the environment) <a href=\"https://stackoverflow.com/questions/24938877/how-to-set-environment-variables-that-last-in-go\" title=\"how to set environment variables that last in go\">stackoverflow.com/questions/24938877/&hellip;</a> This means that even if you opted for the env variables version you would have to chain the commands together anyway. If you cannot do that, then you should be writing the values to a file and reading them in the second command"}, {"owner": {"reputation": 315, "user_id": 5353940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3bb5640039c457d201b38ef7b79058?s=128&d=identicon&r=PG", "display_name": "Patrick Stephen", "link": "https://stackoverflow.com/users/5353940/patrick-stephen"}, "edited": false, "score": 0, "creation_date": 1524755164, "post_id": 49981932, "comment_id": 87108882, "body": "Use a default location on the system to store a file that has the information you want to store, and let that location be configurable in the commands&#39; settings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "reply_to_user": {"reputation": 315, "user_id": 5353940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3bb5640039c457d201b38ef7b79058?s=128&d=identicon&r=PG", "display_name": "Patrick Stephen", "link": "https://stackoverflow.com/users/5353940/patrick-stephen"}, "edited": false, "score": 0, "creation_date": 1524767343, "post_id": 49981932, "comment_id": 87115666, "body": "@PatrickStephen - there is example code which I can use as a reference ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524813805, "post_id": 49981932, "comment_id": 87131058, "body": "let say that I understand that I need config file (json) , how I should do it? where should I create it (path)?"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 2, "last_activity_date": 1524674606, "last_edit_date": 1524674606, "creation_date": 1524488889, "answer_id": 49981932, "question_id": 49974998, "link": "https://stackoverflow.com/questions/49974998/share-properties-from-separate-commands-process/49981932#49981932", "title": "Share properties from separate commands/process", "body": "<p>If you are trying to persist state across execution of different commands of a command line tool, the you have 2 choices.</p>\n\n<ol>\n<li>Write the state to some kind of file (consider the env a file in this case).</li>\n<li>Output values from the first command in a way that can be used as the input to another command.</li>\n</ol>\n\n<p><strong>On 1.</strong></p>\n\n<p>I think it's good practice for any arguments etc. to only survive for the lifetime of the running of the CLI tool. The equivalent of the smallest scoped variables possible in programming. This works well when you need to persist the state indefinitely, but if your state is no longer used after the <code>initProcess</code> command has finished then this is probably not the right option.</p>\n\n<p><strong>On 2.</strong></p>\n\n<p>There is some precedence for this. The unix philosophy (<a href=\"https://en.wikipedia.org/wiki/Unix_philosophy#Origin\" rel=\"nofollow noreferrer\">wikipedia</a>) suggests to:</p>\n\n<blockquote>\n  <p>Expect the output of every program to become the input to another</p>\n</blockquote>\n\n<p>So you could pick some output (to stdout) format for the first <code>prepare</code> command that could be used as the input for the second <code>initProcess</code> command. And then use <code>|</code> pipe to run the output of one into the other.</p>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>func Run(cmd *cobra.Command, args []string) {\n    //This creating the temp folder and validate some configuration file    \n    tmpFolderPath,parsedFile := exe.PreProcess()\n    fmt.Println(tmpFolderPath)\n    fmt.Println(parsedFile)\n}\n\nfunc InitProcess(cmd *cobra.Command, args []string) {\n\n    tmpFolder, parsedFile := args[0], args[1]\n\n}\n</code></pre>\n\n<p>Then to run the program, and pipe the commands together:</p>\n\n<pre><code>./program pre | xargs ./program run\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524905189, "post_id": 50073142, "comment_id": 87165548, "body": "Instead of file I would recommend a db"}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524913876, "post_id": 50073142, "comment_id": 87167877, "body": "@NidhinDavid To use a database to share some basic information between commands? Not at all."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524923328, "post_id": 50073142, "comment_id": 87170567, "body": "This is the world of cloud computing and horizontal scaling!"}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524925574, "post_id": 50073142, "comment_id": 87171231, "body": "@NidhinDavid So you&#39;re recommending stop using file system entirely. This is store two strings, nothing more, set up a database for this is ridiculous."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524931062, "post_id": 50073142, "comment_id": 87172742, "body": "<a href=\"https://12factor.net/\" rel=\"nofollow noreferrer\">12factor.net</a> - 12 factors for a standard app. Your recommendation breaks vi and viii...If you don&#39;t want to set up db then use a something like etcd"}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524933993, "post_id": 50073142, "comment_id": 87173683, "body": "@NidhinDavid Each problem must be solved using one methodology. I&#39;m answering a concrete situation. In this case he is developing a cli. Extracted from your page: <code>&quot;Who should read this document? Any developer building applications which run as a service.&quot;</code> Is that this situation? Absolutely not."}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "reply_to_user": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1524934122, "post_id": 50073142, "comment_id": 87173729, "body": "@NidhinDavid Anyway, you&#39;re completely free to post your own answer if you&#39;re more right"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1524936293, "post_id": 50073142, "comment_id": 87174419, "body": "@IvandelaBeldad - This make sense +1, Can you please provide playground , I want to test it ..."}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1524971623, "post_id": 50073142, "comment_id": 87181899, "body": "@RaynD I suppose that is not possible to save files in it. But you can test it with your actual problem, the steps are well defined. If you have any problem let me know."}, {"owner": {"reputation": 2201, "user_id": 3359432, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5d48edbf794415b7f16c19c50d8cc524?s=128&d=identicon&r=PG&f=1", "display_name": "Nidhin David", "link": "https://stackoverflow.com/users/3359432/nidhin-david"}, "edited": false, "score": 0, "creation_date": 1525012986, "post_id": 50073142, "comment_id": 87191347, "body": "<a href=\"https://stackoverflow.com/questions/2693081/does-google-app-engine-allow-creation-of-files-and-folders-on-the-server\" title=\"does google app engine allow creation of files and folders on the server\">stackoverflow.com/questions/2693081/&hellip;</a> If you intend to run in local system (like <code>grep</code> <code>cat</code> etc..) then file is ok. But if you want to run it in cloud (as I said earlier) or if you want to horizontally scale across systems then file systems will be a (alteast) risk."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1525244082, "post_id": 50073142, "comment_id": 87275214, "body": "@IvandelaBeldad  - can you add the error handling and the &quot;productive flow&quot; like in playground please?"}, {"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1525246579, "post_id": 50073142, "comment_id": 87276541, "body": "@RaynD <a href=\"https://play.golang.org/p/phU4DG543cD\" rel=\"nofollow noreferrer\">https://play.golang.org/p/phU4DG543cD</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "edited": false, "score": 0, "creation_date": 1525271361, "post_id": 50073142, "comment_id": 87292463, "body": "Thanks , i&#39;ve closed the question :)"}], "tags": [], "owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "is_accepted": true, "score": 2, "last_activity_date": 1525245649, "last_edit_date": 1525245649, "creation_date": 1524892756, "answer_id": 50073142, "question_id": 49974998, "link": "https://stackoverflow.com/questions/49974998/share-properties-from-separate-commands-process/50073142#50073142", "title": "Share properties from separate commands/process", "body": "<h3>Share information between commands</h3>\n\n<p>Like was said in comments, if you need to share data across commands, you'll need to persist it. The structure you use is no relevant, but for simplicity and because of JSON is the current most extended language for data exchange we'll use it.</p>\n\n<p><hr></p>\n\n<h3>Where should I create it (path)?</h3>\n\n<p>My recomendation is to use the home of the user. Many applications save its configuration here. This will allow a solution multi-environment easily. Say that your configuration file will be named <em>myApp</em>.</p>\n\n<pre><code>func configPath() string {\n    cfgFile := \".myApp\"\n    usr, _ := user.Current()\n    return path.Join(usr.HomeDir, cfgFile)\n}\n</code></pre>\n\n<p><hr></p>\n\n<h3>When to clean it ?</h3>\n\n<p>That obviously will depend on your requirements. But, if you always need to run <code>pre</code> and <code>run</code> in that order, I bet that you can clean it inmediately after <code>run</code> execution, when it won't be longer needed.</p>\n\n<p><hr></p>\n\n<h3>How to store it ?</h3>\n\n<p>That's easy. If what you need to save is your <code>config</code> struct you can do this:</p>\n\n<pre><code>func saveConfig(c config) {\n    jsonC, _ := json.Marshal(c)\n    ioutil.WriteFile(configPath(), jsonC, os.ModeAppend)\n}\n</code></pre>\n\n<p><hr></p>\n\n<h3>And to read it ?</h3>\n\n<pre><code>func readConfig() config {\n    data, _ := ioutil.ReadFile(configPath())\n    var cfg config\n    json.Unmarshal(data, &amp;cfg)\n    return cfg\n}\n</code></pre>\n\n<p><hr></p>\n\n<h3>Flow</h3>\n\n<pre><code>// pre command\n// persist to file the data you need\nsaveConfig(config{ \n    id:   \"id\",\n    path: \"path\",\n    wd:   \"wd\",\n}) \n</code></pre>\n\n<p></p>\n\n<pre><code>// run command\n// retrieve the previously stored information\ncfg := readConfig()\n\n// from now you can use the data generated by `pre`\n</code></pre>\n\n<blockquote>\n  <p><strong>DISCLAIMER</strong>: I've removed all error handling for short.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6124024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 2, "accepted_answer_id": 50073142, "answer_count": 2, "score": 4, "last_activity_date": 1525245649, "creation_date": 1524466328, "last_edit_date": 1592644375, "question_id": 49974998, "link": "https://stackoverflow.com/questions/49974998/share-properties-from-separate-commands-process", "title": "Share properties from separate commands/process", "body": "<p>Im providing command line tool with several command and sub commands, Im using <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">cobra</a> command line and I\u2019ve two <strong>separate commands</strong>\nthat first is <strong>prerequisit</strong>e to other</p>\n<p>e.g. the first command is preferring the environment by creating temp folder and validate some file</p>\n<p>The second command should get some properties from the first command</p>\n<p>and user should execute it like</p>\n<blockquote>\n<p>btr prepare<br />\nbtr run</p>\n</blockquote>\n<p>when the <code>run command</code> is executed it should get some data from the <code>prepare</code> command outcome</p>\n<pre><code>// rootCmd represents the base command when called without any subcommands\nvar rootCmd = &amp;cobra.Command{\n    Use:   &quot;btr&quot;,\n    Short: &quot;piping process&quot;,\n}\n\n\n    var prepare = &amp;cobra.Command{\n        Use:   &quot;pre&quot;,\n        Short: &quot;Prepare The environment&quot; ,\n        Run: func(cmd *cobra.Command, args []string) {\n        \n        //This creating the temp folder and validate some configuration file    \n           tmpFolderPath,parsedFile := exe.PreProcess()\n        },\n    }\n    \n    \n    var initProcess = &amp;cobra.Command{\n        Use:   \u201crun\u201d,\n        Short: \u201crun process\u201d,\n        Run: func(cmd *cobra.Command, args []string) {\n            \n      //Here I need those two properties \n    \n             run(tmpFolderPath, ParsedFile)\n        },\n    }\n\nfunc init() {\n\n    rootCmd.AddCommand(prepare,initProcess)\n    \n}\n</code></pre>\n<p><strong>UPDATE</strong></p>\n<p>Well, the answer below doest really help. I need to share state between two command in <strong>local &amp; cloud</strong> env) , how I can do it that if I run the command line commands from shell script that call to 1 command and then call to the second which need to get some state from the first command, I need E2E <strong>solution with code real example in my context</strong></p>\n<p>update 2</p>\n<p>let say that I understand that I need config file (json) ,</p>\n<blockquote>\n<p>Where should I create it (path)?</p>\n<p>When to clean it ?</p>\n<p>in case I use 1file How should I validate to store data which is relevant for specific process and take other process data when needed (guid ) ?</p>\n</blockquote>\n<p>lets say I've config like following</p>\n<pre><code>type config struct{\n    \n    path string,\n    wd string,\n    id string,//guid?\n    \n}\n</code></pre>\n"}, {"tags": ["go", "exim", "gomail"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1524480711, "post_id": 49979124, "comment_id": 86974512, "body": "JFTR <a href=\"https://tools.ietf.org/html/rfc6409\" rel=\"nofollow noreferrer\">the RFC on MDAs</a> contains no mention of the <code>Bcc</code> header field so I think it&#39;s purely an MTA thing."}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524499931, "post_id": 49979124, "comment_id": 86987376, "body": "so maybe any other library ? or should I loop the contacts (will it be spam/ junk?)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 1, "creation_date": 1524500933, "post_id": 49979124, "comment_id": 86987980, "body": "If you opt to talk to a locally running Exim instance via its SMTP or main submission (587) port, the problem goes away completely as you&#39;re free to issue any (sane) number of the <code>RCPT TO</code> SMTP commands during the single message submission session. Looks like making yourself a bit more aware about how e-mail works would not hurt you."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524500953, "post_id": 49979124, "comment_id": 86987992, "body": "BTW, have you filed an issue with gomail?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524501094, "post_id": 49979124, "comment_id": 86988058, "body": "To make my previous commit more clear, I <i>think</i> that&#39;s exactly what <code>gomail</code> does with the contents of the <code>Bcc</code> header field when it&#39;s present <i>and when</i> it&#39;s talking to an MTA/MDA via the SMTP protocol (as opposed to passing the message to the stdin of <code>&#47;usr&#47;sbin&#47;sendmail -t</code> or the like): it takes all the addresses from the <code>Bcc</code> field and generates an <code>RCPT TO</code> command for each of them."}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524555220, "post_id": 49979124, "comment_id": 87008054, "body": "I&#39;ve opened a issue on gomail repo <a href=\"https://github.com/go-gomail/gomail/issues/115\" rel=\"nofollow noreferrer\">github.com/go-gomail/gomail/issues/115</a> . How do I <b>opt to talk to a locally running Exim instance via its SMTP</b> I&#39;ve tried <code>d := gomail.NewDialer(&quot;localhost&quot;, 587, &quot;&quot;, &quot;&quot;)</code> with error <b><i>panic: gomail: could not send email 1: 550 Verification failed for &lt;fromemail@myexampledomain.in&gt; Unrouteable address Sender verify failed</i></b>  while using <code>d.TLSConfig = &amp;tls.Config{InsecureSkipVerify: true}</code>"}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524555987, "post_id": 49979124, "comment_id": 87008512, "body": "Or should I custom implement <code>gomsg.WriteTo()</code> that sends data to <code>exim -t</code> ?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524565787, "post_id": 49979124, "comment_id": 87014673, "body": "That <code>550 Verification failed for \u2026 Unrouteable address Sender verify failed</code> (may) have nothing to do with TLS. It means Exim failed to verify your <code>From</code> address <i>for some reason.</i> What exactly reason depends on how Exim is configured. You might get a hunch on this by enabling debugging output for Exim, retry mail submission and studying Exim log afterwards. All in all, this is outside of the scope of this discussion. As I&#39;ve already suggested elsewhere, try asking about configuring Exim over there at <a href=\"https://superuser.com\">superuser.com</a>"}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524588450, "post_id": 49979124, "comment_id": 87030396, "body": "Thank you for your time; I&#39;ve asked it on SuperUser as you have advised : <a href=\"https://superuser.com/q/1316842/555998\">superuser.com/q/1316842/555998</a>"}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1524480586, "last_edit_date": 1524480586, "creation_date": 1524480145, "answer_id": 49979124, "question_id": 49974478, "link": "https://stackoverflow.com/questions/49974478/send-emails-in-go-through-exim-without-smtp/49979124#49979124", "title": "Send emails in go through Exim (without smtp)?", "body": "<p>I think it's <a href=\"https://github.com/go-gomail/gomail/commit/8de74d4f48c5aa343703bb1c7376d2aed0f9c258\" rel=\"nofollow noreferrer\">this</a> (and <a href=\"https://github.com/go-gomail/gomail/blob/81ebce5c23dfd25c6c67194b37d3dd3f338c98b1/CHANGELOG.md#L14\" rel=\"nofollow noreferrer\">here</a> is the changelog entry for it).</p>\n\n<p>Still, the logic fixed by the commit above should only apply to actually\n<em>sending</em> messages\u2014that is, when the package actually speaks with an SMTP\nserver (because, naturally, <code>Bcc</code> should not be forwarded past the first MTA processing the message (maybe even the first MDA\u2014I'm lazy to read the RFC)).</p>\n\n<p>The commit being discussed refers to\n<a href=\"https://tools.ietf.org/html/rfc5322#section-3.6.3\" rel=\"nofollow noreferrer\">this part of a relevant RFC</a> which actually offers three different ways to handle <code>Bcc</code> header\nfields.\nSo I have no idea whether to actually blame the package author for\nthis change or not.</p>\n\n<p>Yet still, <a href=\"https://github.com/go-gomail/gomail/blob/81ebce5c23dfd25c6c67194b37d3dd3f338c98b1/writeto.go#L244\" rel=\"nofollow noreferrer\">this</a> looks like stripping the <code>Bcc</code> header away even for the <code>Message.WriteTo</code>\nmethod, which, IMO, is a mistake.\nThe reason I think this is a mistake is as follows:</p>\n\n<ul>\n<li>When the package sends a message via SMTP it works as an MTA\nor an MDA and should obey the rules defined by the relevant RFCs for these\ntypes of mail agents.</li>\n<li>When it merely streams the message to an MDA (Exim in your case),\nit works as a pure client, and <em>processing</em> of the <code>Bcc</code> header fields\nis clearly not its business\u2014it rather should be delegated to the first\n\"real\" mail processing agent.</li>\n</ul>\n\n<p>The only relevant issue/pull-request I was able to find is\n<a href=\"https://github.com/go-gomail/gomail/pull/34\" rel=\"nofollow noreferrer\">this</a> but it looks like the\ncode was highly refactored after its inclusion so I have no idea\nwhether it introduced what I supposed is a bug or not.</p>\n\n<p>See also <a href=\"https://github.com/go-gomail/gomail/issues/19\" rel=\"nofollow noreferrer\">this</a>.</p>\n\n<p><strong>TL;DR</strong></p>\n\n<p>I would file an issue in the package's bug tracker.</p>\n\n<p>(If you will do that, please link it there; thanks.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11599259, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/a13c35ce69cf166b9259cc3863660b11?s=128&d=identicon&r=PG", "display_name": "voidhaze", "link": "https://stackoverflow.com/users/11599259/voidhaze"}, "is_accepted": false, "score": -2, "last_activity_date": 1559681873, "last_edit_date": 1559681873, "creation_date": 1559655176, "answer_id": 56445013, "question_id": 49974478, "link": "https://stackoverflow.com/questions/49974478/send-emails-in-go-through-exim-without-smtp/56445013#56445013", "title": "Send emails in go through Exim (without smtp)?", "body": "<p>The problem is caused by the <code>-t</code> option you pass to exim. From <a href=\"https://www.exim.org/exim-html-current/doc/html/spec_html/ch-message_processing.html\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<blockquote>\n  <h2>7. The Bcc: header line</h2>\n  \n  <p>If Exim is called with the <strong>-t</strong> option, to take recipient addresses from\n  a message\u2019s header, it removes any <em>Bcc:</em> header line that may exist\n  (after extracting its addresses). If <strong>-t</strong> is not present on the command\n  line, any existing <em>Bcc:</em> is not removed.</p>\n</blockquote>\n\n<p>.</p>\n"}], "owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 511, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1559681873, "creation_date": 1524463973, "last_edit_date": 1592644375, "question_id": 49974478, "link": "https://stackoverflow.com/questions/49974478/send-emails-in-go-through-exim-without-smtp", "title": "Send emails in go through Exim (without smtp)?", "body": "<p>I'm currently using &quot;gopkg.in/gomail.v2&quot; to send email with following  <a href=\"https://stackoverflow.com/a/35521846/5806017\">code found here</a></p>\n<pre><code>package main\n\nimport (\n    &quot;bytes&quot;\n    &quot;fmt&quot;\n\n    &quot;gopkg.in/gomail.v2&quot;\n)\n\nfunc main() {\n    m := gomail.NewMessage()\n\n    m.SetHeader(&quot;From&quot;, &quot;me@example.com&quot;)\n    m.SetHeader(&quot;To&quot;, &quot;you@example.com&quot;)\n\n    m.SetAddressHeader(&quot;Bcc&quot;, &quot;youbcc@example.com&quot;, &quot;Bcc Email&quot;)\n\n    m.SetHeader(&quot;Bcc&quot;, &quot;anotherbcc@example.com&quot;, &quot;yetbcc@example.com&quot;)\n\n    m.SetHeader(&quot;Reply-To&quot;, &quot;me@example.com&quot;)\n    m.SetHeader(&quot;Subject&quot;, &quot;Subject is to gomail to be discussed&quot;)\n    body := `Why is bcc not getting populated`\n    m.SetBody(&quot;text/html&quot;, body)\n\n    sendMailViaExim(m)\n\n}\nfunc sendMailViaExim(m *gomail.Message) (err error) {\n    cmd := exec.Command(&quot;/usr/sbin/exim&quot;, &quot;-t&quot;)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n\n    pw, err := cmd.StdinPipe()\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n    err = cmd.Start()\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n    var errs [3]error\n    _, errs[0] = m.WriteTo(pw)\n    errs[1] = pw.Close()\n    errs[2] = cmd.Wait()\n    for _, err = range errs {\n        if err != nil {\n            log.Println(err)\n            return\n        }\n    }\n    return\n}\n</code></pre>\n<p>The Above code <strong>doesn't send to Bcc</strong> emails;</p>\n<p>So I logged the info that was being passed to <code>exim -t</code> via following code:</p>\n<blockquote>\n<p>buf := new(bytes.Buffer)</p>\n<p>m.WriteTo(buf) //should write entire msg with bcc?</p>\n<p>fmt.Println(buf.String())</p>\n</blockquote>\n<p>and the console logged :</p>\n<pre><code>$ go run main.go\nMime-Version: 1.0\nDate: Mon, 23 Apr 2018 11:15:54 +0530\nTo: you@example.com\nReply-To: me@example.com\nSubject: Subject is to gomail to be discussed\nFrom: me@example.com\nContent-Type: text/html; charset=UTF-8\nContent-Transfer-Encoding: quoted-printable\n\nWhy is bcc not getting populated\n</code></pre>\n<p>bcc is not getting to the <code>exim -t</code> How do I achieve that without using smtp.</p>\n"}, {"tags": ["mysql", "windows", "ubuntu", "docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "edited": false, "score": 0, "creation_date": 1524533416, "post_id": 49976635, "comment_id": 87000941, "body": "at this point i&#39;ve given up on the porting effort though.  i hope one day this becomes less painful, but that day hasn&#39;t yet arrived."}], "tags": [], "owner": {"reputation": 141, "user_id": 3226688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5907fa944faa8517ce90ed15d7d35cb4?s=128&d=identicon&r=PG&f=1", "display_name": "user3226688", "link": "https://stackoverflow.com/users/3226688/user3226688"}, "is_accepted": false, "score": 5, "last_activity_date": 1524474294, "last_edit_date": 1524474294, "creation_date": 1524472405, "answer_id": 49976635, "question_id": 49974372, "link": "https://stackoverflow.com/questions/49974372/go-mysql-authentication-plugin-not-supported-while-connecting-from-go-app-conta/49976635#49976635", "title": "go-mysql: authentication plugin not supported while connecting from go app container to mysql container", "body": "<p>MySQL image on docker hub changes \"latest\" tag from 5.7 to 8 recently (2018/04/20), which has lots of breaking changes. Using \"mysql:5.7\" instead of \"mysql\" should solve your problem.</p>\n"}], "owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3878, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1524474294, "creation_date": 1524463473, "last_edit_date": 1524464937, "question_id": 49974372, "link": "https://stackoverflow.com/questions/49974372/go-mysql-authentication-plugin-not-supported-while-connecting-from-go-app-conta", "title": "go-mysql: authentication plugin not supported while connecting from go app container to mysql container", "body": "<p>I am porting my linux docker environment from my mac to my pc laptop.  I have 2 docker images, one is a <code>mysql:latest</code> database image, the other is a <code>go:alpine</code> application server image.</p>\n\n<p>On my mac, I use bash scripts to pass in environment variables to the app server to compose the database connection string to mysql.  </p>\n\n<p>The connection string is: </p>\n\n<pre><code>root:password@tcp(mysql_host:3306)/dbname\n</code></pre>\n\n<p>The database connection is successful when I run this on my mac, but not on my PC.</p>\n\n<p>On <code>Windows 10</code>, I have installed <code>Ubuntu</code> and <code>Docker for Windows</code>.  In <code>bash</code>, I've installed the docker client and I am able to use the docker cli to connect to my Windows Docker host by setting the <code>DOCKER_HOST</code> environment variable.</p>\n\n<p>I have created a custom docker network that I pass to my 2 containers via the <code>--network</code> flag so they can see each other and I have verified that they are indeed able to resolve their container names.</p>\n\n<p>The connection string that my app server is using is exactly the same, but returns the following error: </p>\n\n<pre><code>this authentication plugin is not supported\n</code></pre>\n\n<p>The line in my go code returning this error is:</p>\n\n<pre><code>db, err = sql.Open(\"mysql\", dbConnStr)\n</code></pre>\n\n<p>What am I missing?  What authentication plugin?</p>\n\n<p>Here is the output of <code>docker info</code> on my PC:</p>\n\n<pre><code>Containers: 1\n Running: 0\n Paused: 0\n Stopped: 1\nImages: 27\nServer Version: 18.04.0-ce\nStorage Driver: overlay2\n Backing Filesystem: extfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: cgroupfs\nPlugins:\n Volume: local\n Network: bridge host ipvlan macvlan null overlay\n Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslog\nSwarm: inactive\nRuntimes: runc\nDefault Runtime: runc\nInit Binary: docker-init\ncontainerd version: 773c489c9c1b21a6d78b5c538cd395416ec50f88\nrunc version: 4fc53a81fb7c994640722ac585fa9ca548971871\ninit version: 949e6fa\nSecurity Options:\n seccomp\n  Profile: default\nKernel Version: 4.9.87-linuxkit-aufs\nOperating System: Docker for Windows\nOSType: linux\nArchitecture: x86_64\nCPUs: 6\nTotal Memory: 3.837GiB\nName: linuxkit-00155d016401\nID: JXLB:YHLO:J6XO:H66P:X7LQ:RF2I:Z3AC:FPLY:OCLQ:DSYU:H4CR:W2DD\nDocker Root Dir: /var/lib/docker\nDebug Mode (client): false\nDebug Mode (server): true\n File Descriptors: 19\n Goroutines: 36\n System Time: 2018-04-23T06:06:31.2274774Z\n EventsListeners: 1\nRegistry: https://index.docker.io/v1/\nLabels:\nExperimental: true\nInsecure Registries:\n 127.0.0.0/8\nLive Restore Enabled: false\n</code></pre>\n"}, {"tags": ["go", "asn.1", "asn1"], "comments": [{"owner": {"reputation": 337, "user_id": 5772695, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pSKby.jpg?s=128&g=1", "display_name": "Aarvi", "link": "https://stackoverflow.com/users/5772695/aarvi"}, "edited": false, "score": 0, "creation_date": 1524462312, "post_id": 49974077, "comment_id": 86964078, "body": "The module definition is of the following format: Module-Name DEFINITIONS AUTOMATIC TAGS := etc..."}, {"owner": {"reputation": 337, "user_id": 5772695, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pSKby.jpg?s=128&g=1", "display_name": "Aarvi", "link": "https://stackoverflow.com/users/5772695/aarvi"}, "edited": false, "score": 0, "creation_date": 1524565923, "post_id": 49974077, "comment_id": 87014753, "body": "There is this library that implements BER encoding/decoding. It is based on &quot;encoding/asn1&quot; package: <a href=\"https://github.com/Logicalis/asn1\" rel=\"nofollow noreferrer\">github.com/Logicalis/asn1</a>. This helped me."}], "answers": [{"tags": [], "owner": {"reputation": 8230, "user_id": 2876830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/23e4baefc1b032e53e723ce13f34f9c3?s=128&d=identicon&r=PG&f=1", "display_name": "YaFred", "link": "https://stackoverflow.com/users/2876830/yafred"}, "is_accepted": false, "score": 1, "last_activity_date": 1524475858, "creation_date": 1524475858, "answer_id": 49977666, "question_id": 49974077, "link": "https://stackoverflow.com/questions/49974077/asn-1-unmarshalling-wireshark-hex-code-using-go-structs/49977666#49977666", "title": "ASN.1 unmarshalling wireshark hex code using go structs", "body": "<p>It's not a problem with tags. It's a problem with the ability of your lib to decode indefinite length.\nFor constructed types (such as sequences) you can either use:</p>\n\n<blockquote>\n  <p>Tag Length Value (also called definite length form)</p>\n</blockquote>\n\n<p>or </p>\n\n<blockquote>\n  <p>Tag '80'H Value '0000'H (also called indefinite length form)</p>\n</blockquote>\n\n<p>The message you receive uses indefinite length for all sequences.\nYour lib does not support it because it sticks to Distinguished Encoding Rules (DER) where this form is not allowed.\nIf it was supported by your lib, your message part would be decoded like this ...</p>\n\n<pre><code>T: 30 (CONSTRUCTED_UNIVERSAL_16) \nL: 80 (indefinite)   \n   T: a0 (CONSTRUCTED_CONTEXT_0)\n   L: 80 (indefinite)\n     T: 80 (PRIMITIVE_CONTEXT_0)\n     L: 1\n     V: 06\n     T: 83 (PRIMITIVE_CONTEXT_3)\n     L: 2\n     V: 00 e2\n   0000: end of content\n\n   T: a2 (CONSTRUCTED_CONTEXT_2)   \n   L: 80 (indefinite)\n      T: 80 (PRIMITIVE_CONTEXT_0)\n      L: 1\n      V: 01\n      T: 81 (PRIMITIVE_CONTEXT_1)\n      L: 1\n      V: 0d\n   0000: end of content \n\n   T: 83 (PRIMITIVE_CONTEXT_3)   \n   L: 1   \n   V: 65 \n0000: end of content\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 5772695, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/pSKby.jpg?s=128&g=1", "display_name": "Aarvi", "link": "https://stackoverflow.com/users/5772695/aarvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524475858, "creation_date": 1524462115, "question_id": 49974077, "link": "https://stackoverflow.com/questions/49974077/asn-1-unmarshalling-wireshark-hex-code-using-go-structs", "title": "ASN.1 unmarshalling wireshark hex code using go structs", "body": "<p>I am trying to decode the following hex code from a tcp dump. \n18001c3080a080800106830200e20000a28080010181010d00008301650000</p>\n\n<p>The ASN.1 definition that I am trying to decode is of the following format:</p>\n\n<pre><code>ConnectionEstablishedReply  ::= SEQUENCE {\nmessage         MessageFields,\nnackReason      NackReason OPTIONAL,\ninterfaceVersion    InterfaceVersion,\nmediatorId      INTEGER (1..65535),\nwaitForCommit       BOOLEAN OPTIONAL,\n...\n}\n\nMessageFields       ::= SEQUENCE {\nmessageSequence     INTEGER (1..65535),\nbsId    INTEGER (1..65535) OPTIONAL,\nneID        INTEGER(0..16777216) OPTIONAL, -- unsigned int\nnelementID  INTEGER(0..16777216) OPTIONAL, -- unsigned int\n...\n}\n\nInterfaceVersion        ::= SEQUENCE {\nmajor           INTEGER (1..100),\nminor           INTEGER (0..100)\n}\n</code></pre>\n\n<p>As I understand, the tag or type for ConnectionEstablishedReply from the tcp dump is 24, whereas the tag for a sequence is 16. The mismatch in these tags is what is causing the error:</p>\n\n<blockquote>\n  <p>Error while unmarshalling:  asn1: structure error: tags don't match (16 vs {class:0 tag:24 length:0 isCompound:false}) {optional:false explicit:false application:false defaultValue: tag: stringType:0 timeType:0 set:false omitEmpty:false} ConnectionEstablishedReply @2</p>\n</blockquote>\n\n<p>The go structs corresponding to these elements are:</p>\n\n<pre><code>type ConnectionEstablishedReply struct {\n    Message          MessageFields    \n    NackReason       NackReason       `asn1:\"optional\"`\n    InterfaceVersion InterfaceVersion \n    MediatorId       int              \n    WaitForCommit    bool             `asn1:\"optional\"`\n}\n</code></pre>\n\n<p>and likewise for other elements. </p>\n\n<p>Unmarshalling code:</p>\n\n<pre><code>res := structs.ConnectionEstablishedReply{}\ndata, _ := hex.DecodeString(\"18001c3080a080800106830200e20000a28080010181010d00008301650000\")\n_, err := asn1.Unmarshal(data, &amp;res)\nif err != nil {\n    fmt.Println(\"Error while unmarshalling: \", err)\n}\nfmt.Println(res)\n</code></pre>\n\n<p>In a previous question (<a href=\"https://stackoverflow.com/questions/49665475/asn-1-unmarshalling-using-go-structs-gives-tags-dont-match-error\">ASN.1 Unmarshalling using go structs gives tags don&#39;t match error</a>) with a similar problem, I was told that I should be using implicit asn.1 tags with these structs. However, these tags don't work for these application specific elements. </p>\n\n<p>FYI, when only 3080a080800106830200e20000a28080010181010d00008301650000 (message part) of the above mentioned hex stream is fed into <a href=\"http://asn1-playground.oss.com/\" rel=\"nofollow noreferrer\">http://asn1-playground.oss.com/</a>, the decoding is successful. Whereas, the same stream when used in go code gives:</p>\n\n<blockquote>\n  <p>indefinite length found (not DER)</p>\n</blockquote>\n\n<p>Which asn.1 tags should be used in these go structs so that unmarshalling is successful? </p>\n"}, {"tags": ["performance", "go", "optimization", "kubernetes", "hardware"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1524491960, "post_id": 49973800, "comment_id": 86982217, "body": "&#171;\u2026where a developer doesn&#39;t care about the hardware&#187;\u2014that is plain wrong unless they also do not care about performance."}], "answers": [{"comments": [{"owner": {"reputation": 542, "user_id": 7012458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xhCpK.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/7012458/gautam"}, "edited": false, "score": 1, "creation_date": 1526284745, "post_id": 49981747, "comment_id": 87666751, "body": "Thank You for clarifying."}], "tags": [], "owner": {"reputation": 754, "user_id": 3476897, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/57E2l.png?s=128&g=1", "display_name": "Kugel", "link": "https://stackoverflow.com/users/3476897/kugel"}, "is_accepted": false, "score": 1, "last_activity_date": 1524488388, "creation_date": 1524488388, "answer_id": 49981747, "question_id": 49973800, "link": "https://stackoverflow.com/questions/49973800/is-go-efficient-in-cloud-environment-like-kubernetes/49981747#49981747", "title": "Is Go efficient in Cloud environment like Kubernetes?", "body": "<p>Go compiles across all relevant architectures. You do not have to modify your code for different platforms.\nIn cloud environments (like Kubernetes for example) you usually use docker images or drop in your binary.</p>\n"}], "owner": {"reputation": 542, "user_id": 7012458, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xhCpK.jpg?s=128&g=1", "display_name": "Gautam", "link": "https://stackoverflow.com/users/7012458/gautam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1524488388, "creation_date": 1524460437, "question_id": 49973800, "link": "https://stackoverflow.com/questions/49973800/is-go-efficient-in-cloud-environment-like-kubernetes", "title": "Is Go efficient in Cloud environment like Kubernetes?", "body": "<p>Go has mechanical sympathy. So does that mean I need to modify my code based on the hardware I am running, for the best possible performance? How does that work in a cloud environment like K8s where a developer doesn't care about the hardware? </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "is_accepted": false, "score": -1, "last_activity_date": 1524464991, "creation_date": 1524464991, "answer_id": 49974697, "question_id": 49973767, "link": "https://stackoverflow.com/questions/49973767/express-middleware-for-specific-route-using-gin-package-in-golang/49974697#49974697", "title": "express middleware for specific route using gin package in golang?", "body": "<p><a href=\"https://github.com/gin-gonic/gin#using-middleware\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/gin#using-middleware</a>, shows how you can use a specific set of urls with an authorization middleware.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9684058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3886, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524464991, "creation_date": 1524460204, "question_id": 49973767, "link": "https://stackoverflow.com/questions/49973767/express-middleware-for-specific-route-using-gin-package-in-golang", "title": "express middleware for specific route using gin package in golang?", "body": "<p>I made a <code>middleware</code> for the routes it successfully runs but there is a small issue that is it will apply for the all the routes include <code>signup</code> and <code>login</code>. I want to social the <code>signup</code>and <code>login</code> route that all users will access these two routes. Below is the code that I am using:-</p>\n\n<p>Routes.go</p>\n\n<pre><code>/*Signup Route */\nRoute{\"SaveUser\", \"POST\", \"/signup\", controller.SaveUser},\n\n/*Login Route*/\nRoute{\"LoginUser\", \"POST\", \"/login\", controller.Login},\n\n/* All Customers Routes */\nRoute{\"SaveCustomers\", \"POST\", \"/customer\", controller.SaveCustomers},\nRoute{\"GetCustomers\", \"GET\", \"/customer\", controller.GetCustomers},\nRoute{\"GetCustomer\", \"GET\", \"/customer/:id\", controller.GetCustomer},\nRoute{\"UpdateCustomers\", \"PUT\", \"/customer/:id\", controller.UpdateCustomers},\n\nfunc NewRouter() {\n  router := gin.Default()\n  router.Use(require(\"./login\"))\n  router.Use(JWTAuthMiddleware())\n  v1 := router.Group(\"/api/v1\")\n  for _, route := range routes {\n    switch route.Method {\n    case \"GET\":\n        v1.GET(route.Pattern, route.HandlerFunc)\n    case \"POST\":\n        v1.POST(route.Pattern, route.HandlerFunc)\n    case \"PUT\":\n        v1.PUT(route.Pattern, route.HandlerFunc)\n    case \"DELETE\":\n        v1.DELETE(route.Pattern, route.HandlerFunc)\n    default:\n        v1.GET(route.Pattern, func(c *gin.Context) {\n            c.JSON(200, gin.H{\n                \"result\": \"Specify a valid http method with this route.\",\n            })\n        })\n    }\n }\n router.Run(\":8080\")\n}\n\nfunc JWTAuthMiddleware() gin.HandlerFunc {\n  return func(c *gin.Context) {\n    controller.ValidateToken(c)\n    c.Next()\n  }\n}\n</code></pre>\n\n<p>When I hit the url <code>/login</code> then the login API will run and it check whether the user is authorized or not. but the middleware code will is also apply on signup and login. How I will social the login api and the signup api. I searched it for google but the stuff I found i don't understand can anyone help me. Thank you in advance.</p>\n"}, {"tags": ["go", "interface", "network-programming", "microservices"], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 0, "creation_date": 1524464614, "post_id": 49973762, "comment_id": 86965049, "body": "The only possible issue is - adding a new request type would require changes in two places - the network package and the main package, so some duplication here."}, {"owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524467357, "post_id": 49973762, "comment_id": 86966391, "body": "Actually that code should use switch r := req.(type) - as written it isn&#39;t a type switch."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "edited": false, "score": 0, "creation_date": 1524486868, "post_id": 49973762, "comment_id": 86978499, "body": "@GilesW It is a type switch in both the original answer and the edited answer.  See <a href=\"https://play.golang.org/p/HSPAzJvk8jR\" rel=\"nofollow noreferrer\">play.golang.org/p/HSPAzJvk8jR</a>."}, {"owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 0, "creation_date": 1524487805, "post_id": 49973762, "comment_id": 86979162, "body": "I&#39;ll accept his answer. The duplication looks to be inevitable. Doesn&#39;t seem like the Go language has a way to avoid this."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 0, "creation_date": 1524488126, "post_id": 49973762, "comment_id": 86979371, "body": "@Metatrix You need to update two packages when a new request type is added, but there is no duplication of code. If you could extend non-local packages as attempted in the question, you would still need to update two packages when a new request type is added."}, {"owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "edited": false, "score": 0, "creation_date": 1524489225, "post_id": 49973762, "comment_id": 86980159, "body": "@CeriseLim&#243;n I agree with no duplication, just code needs to be written in two places. However, if we were able to extend the request class with a Handle function, then type checking wouldn&#39;t be required. req.Handle() would automatically select the Handle function for the request type. (As req is interface type)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1524496741, "last_edit_date": 1524496741, "creation_date": 1524460174, "answer_id": 49973762, "question_id": 49973699, "link": "https://stackoverflow.com/questions/49973699/extend-an-interface-method-in-a-non-local-package/49973762#49973762", "title": "Extend an interface method in a non-local package", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow noreferrer\">type switch</a> in the main package:</p>\n\n<pre><code>switch req := network.GetRequestFromBytes(conn).(type) {\ncase *network.RequestA:\n   // handle here, req has type *RequestA in this branch\ncase *network.RequestB:\n   // handle here, req has type *RequestB in this branch\ndefault:\n   // handle unknown request type\n}\n</code></pre>\n\n<p>This avoids encoding knowledge of the protocol bytes in the main package.</p>\n\n<p>Because the question specifies that parsing code is in the network package and handler code is in the main package, it's not possible to avoid updating the code in two packages when a new request type is added. Even if the language supported the feature proposed in the question, it would still be necessary to update two packages when a new request type is added.</p>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 9661066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DKIYpno_RaE/AAAAAAAAAAI/AAAAAAAAAAA/784Fv4xgNp8/photo.jpg?sz=128", "display_name": "GilesW", "link": "https://stackoverflow.com/users/9661066/gilesw"}, "is_accepted": false, "score": 1, "last_activity_date": 1524472926, "creation_date": 1524472926, "answer_id": 49976763, "question_id": 49973699, "link": "https://stackoverflow.com/questions/49973699/extend-an-interface-method-in-a-non-local-package/49976763#49976763", "title": "Extend an interface method in a non-local package", "body": "<p>If you wrap a return value in an interface you will always have to either type switch on it to process it based on its type in this kind of scenario.</p>\n\n<p>The alternative for the way you are approaching would be to insert the processing function into the Request objects dynamically by adding a method to the <code>Request</code> interface which allowed you register a handler and another method <code>Handle()</code> which you could call to process each message by calling the registered handler. Experience suggests that you would end up with a bunch of boilerplate in each Request type definition though.</p>\n\n<p>In go I would probably take a different approach and not use an OO kind of design where you make each request type it's own \"class\". I would probably define the network package more along the lines of the code below. (Caveat: this isn't tested, there might be a few typos and theres some error stuff that needs filled in)</p>\n\n<pre><code>type RequestType byte\n\nconst (\n    ARequest RequestType = iota\n    BRequest\n    CRequest\n    EndRequestRange\n)\n\ntype HandlerFunc func([]byte) error\n\ntype MessageInterface struct {\n    handlers map[RequestType]HandlerFunc\n    // other stuff\n}\n\nfunc NewMessageInterface() *MessageInterface {\n    m := &amp;MessageInterface {\n        handlers: make(map[RequestType]HandlerFunc),\n    }\n    // Do other stuff\n    return m\n}\n\nfunc (m *MessageInterface) AddHandler(rt RequestType, h HandlerFunc) error {\n    if rt &gt;= EndRequestRange {\n        // return an error\n    }\n    m.handlers[rt]=h\n\n    return nil\n}\n\nfunc (m *MessageInterface) ProcessNextMessage() error {\n    buf := make([]byte, 100)\n    _, _ := conn.Read(buf)\n\n    h, ok := m.handlers[ReqestType(buff[0])]\n    if !ok {\n        // probably return error\n    }\n\n    return h(buff[1:])  \n}\n</code></pre>\n\n<p>In your main package you would then initialize <code>MessageInterface</code>, call <code>AddHandler()</code> to add each handler during initialization you want and repeatedly call <code>ProcessNextMessage()</code> during your main processing.</p>\n\n<p>It's a different approach from the design direction you were going in, but for me a bit more of a go approach.</p>\n\n<p>(Note as well - I didn't do anything to make sure the code was safe for concurrency and this kind of approach is normally used in a way that each handler is called in its own goroutine. If you made that change you might want some mutex protection around the map as well as checking a few other aspects)</p>\n"}], "owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 49973762, "answer_count": 2, "score": -2, "last_activity_date": 1524496741, "creation_date": 1524459757, "last_edit_date": 1524466027, "question_id": 49973699, "link": "https://stackoverflow.com/questions/49973699/extend-an-interface-method-in-a-non-local-package", "title": "Extend an interface method in a non-local package", "body": "<p>Trying to create a microservice within Go, I have a package network to take care of getting the bytes and converting to a particular request:</p>\n\n<pre><code>package network\n\ntype Request interface {\n}\n\ntype RequestA struct {\na int\n}\n\ntype RequestB struct {\nb string\n}\n\nfunc GetRequestFromBytes(conn net.Conn) Request {\nbuf := make([]byte, 100)\n_, _ := conn.Read(buf)\nswitch buf[0] {\ncase 0:\n    // convert bytes into RequestA\n    requestA = RequestAFromBytes(buf[1:])\n    return requestA\ncase 1:\n    requestB = RequestBFromBytes(buf[1:])\n    return requestB\n}}\n</code></pre>\n\n<p>Now in the main, I want to handle the request.</p>\n\n<pre><code>package main\nimport (\n    \"network\"\n)\n\n(ra *RequestA) Handle() {\n// handle here\n}\n\n(rb *RequestB) Handle() {\n// handle\n}\n\nfunc main() {\n    // get conn here\n    req = GetRequestFromBytes(conn)\n    req.Handle()\n}\n</code></pre>\n\n<p>However, Golang does not allow RequestA/RequestB classes to be extended in the main package. Two solutions I found online were type aliasing/embedding, but in both it looks like we'll have to handle by finding the specific type of the request at runtime. This necessitates a switch/if statement in both network and main packages, which duplicates code in both.</p>\n\n<p>The simplest solution would be to move the switch statement into package main, where we determine the type of the request and then handle it, but then package main would have to deal with raw bytes, which I'd like to avoid. The responsibility of finding the request type and sending it 'upwards' should rest with the network package.</p>\n\n<p>Is there a simple idiomatic Go way to solve this?</p>\n"}, {"tags": ["ubuntu", "go", "vim"], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 9684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef1b3774f79c2b02b77c344c82aae71?s=128&d=identicon&r=PG&f=1", "display_name": "v v", "link": "https://stackoverflow.com/users/9684016/v-v"}, "is_accepted": false, "score": 1, "last_activity_date": 1524462787, "creation_date": 1524462787, "answer_id": 49974209, "question_id": 49973634, "link": "https://stackoverflow.com/questions/49973634/go-vim-not-work-well-after-install-go-with-official-archive-on-ubuntu/49974209#49974209", "title": "go-vim not work well after install go with official archive on ubuntu", "body": "<p>After rewrote environment variables, it works.</p>\n\n<pre><code>export GOROOT=/usr/local/go\nexport GOPATH=$HOME/go\nexport PATH=$PATH:$GOROOT/bin:$GOPATH/bin\n\n$ go version\ngo version go1.10.1 linux/amd64\n\n$ vim\n:GoInstallBinaries\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 9684016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ef1b3774f79c2b02b77c344c82aae71?s=128&d=identicon&r=PG&f=1", "display_name": "v v", "link": "https://stackoverflow.com/users/9684016/v-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 460, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524462787, "creation_date": 1524459329, "last_edit_date": 1524461160, "question_id": 49973634, "link": "https://stackoverflow.com/questions/49973634/go-vim-not-work-well-after-install-go-with-official-archive-on-ubuntu", "title": "go-vim not work well after install go with official archive on ubuntu", "body": "<p>Installed go using offciall archive:</p>\n\n<p><a href=\"https://golang.org/doc/install?download=go1.10.1.linux-amd64.tar.gz\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.10.1.linux-amd64.tar.gz</a></p>\n\n<p>Extract it:</p>\n\n<pre><code>$ tar -C /usr/local -xzf go1.10.1.linux-amd64.tar.gz\n</code></pre>\n\n<p>Check go version:</p>\n\n<pre><code>$ go version\ngo version go1.10 linux/amd64\n</code></pre>\n\n<p>Use <a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow noreferrer\">vim-go</a> as a vim plugin, when use vim open a go file, it saids:</p>\n\n<blockquote>\n  <p>vim-go: could not find 'gotags'. Run :GoInstallBinaries to fix it</p>\n</blockquote>\n\n<p>Therefore, when ran <code>:GoInstallBinaries</code>, got messages:</p>\n\n<blockquote>\n  <p>vim-go: golint not found. Installing github.com/lint/golint to folder\n  ...\n      compile: version \"go1.10.1\" does not match go tool version \"go1.10\"</p>\n</blockquote>\n\n<p>Why it caused version conflict? How to fix it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 3, "creation_date": 1524457425, "post_id": 49973357, "comment_id": 86962630, "body": "Show an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please"}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "is_accepted": false, "score": 1, "last_activity_date": 1524461601, "creation_date": 1524461601, "answer_id": 49973989, "question_id": 49973357, "link": "https://stackoverflow.com/questions/49973357/behavior-of-time-timer/49973989#49973989", "title": "Behavior of time.Timer", "body": "<p>You can use <code>time.AfterFunc</code>; for example;</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    timer := time.AfterFunc(time.Second*60, func() {\n        fmt.Printf(\"you're out!\")\n    })\n    defer timer.Stop()\n}\n</code></pre>\n\n<p>'cause whether user types something or not you can close the connection and send to leaving channel.</p>\n"}], "owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524461601, "creation_date": 1524457086, "last_edit_date": 1524461353, "question_id": 49973357, "link": "https://stackoverflow.com/questions/49973357/behavior-of-time-timer", "title": "Behavior of time.Timer", "body": "<p>I'm new to Go and the time package is a tad confusing for me. So I'm making a chat box and the idea is that when you send a message, the timer resets to 20 seconds, and if you don't respond by 20 seconds you get kicked out. The code I have works only if the person has typed something, but if they never input anything, they don't get kicked out. I tried applying  <code>Stop()</code> before the for loop, but it doesn't work. Should I do all the timer before and after the loop rather than inside the for loop?</p>\n\n<pre><code>func ... {\n\n  timer := time.NewTimer(20 * time.Second)\n\n  for input.Scan() {\n  go func(){\n    &lt;-timer.C\n    leaving &lt;- ch\n    conn.Close()\n  }()\n\n  messages &lt;- input.Text()\n  timer.Stop()\n  timer.Reset(20 * time.Second)\n}\n</code></pre>\n"}, {"tags": ["go", "middleware", "go-micro"], "answers": [{"tags": [], "owner": {"reputation": 966, "user_id": 2166750, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b7a98a414302c4331caa45d56a522202?s=128&d=identicon&r=PG", "display_name": "Bert Verhees", "link": "https://stackoverflow.com/users/2166750/bert-verhees"}, "is_accepted": false, "score": 0, "last_activity_date": 1529439789, "creation_date": 1529439789, "answer_id": 50936375, "question_id": 49973189, "link": "https://stackoverflow.com/questions/49973189/go-micro-wrapper-as-a-service/50936375#50936375", "title": "go-micro wrapper as a service", "body": "<p>You can write service wrappers by incorporating the go-micro client in the wrapper code. You find on github many examples how to write a go-micro client, I believe there is one in the greeter example in the go-micro repository.</p>\n\n<p>I use a wrapper to disclose a grpc-interface to a rest-service wrapper by using the client boilerplate.</p>\n\n<p>You can write wrappers to a micro-service for almost any purpose in this way.</p>\n\n<p>Don't worry about the ports the client code needs to address, Consul can handle this just fine for you.</p>\n"}], "owner": {"reputation": 23, "user_id": 5403518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ab45d28cf79ad76597f73d18c0b9406?s=128&d=identicon&r=PG&f=1", "display_name": "Alexandr", "link": "https://stackoverflow.com/users/5403518/alexandr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 981, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1529439789, "creation_date": 1524455825, "last_edit_date": 1524473213, "question_id": 49973189, "link": "https://stackoverflow.com/questions/49973189/go-micro-wrapper-as-a-service", "title": "go-micro wrapper as a service", "body": "<p>Question is about using go-micro wrapper as a separate service - if anyone knows how to use it properly please let me know. my example - authWrapper, so all api services should be able to use it, it should be discovered via standard service discovery, to make any changes to authWrapper only 1 service should be rebuild (I didn't find a way how to properly pass context.Context from api service to authWrapper via rpc call) </p>\n\n<p><a href=\"https://github.com/micro/go-micro\" rel=\"nofollow noreferrer\">go-micro docs</a></p>\n\n<p><a href=\"https://github.com/micro/examples/blob/a9a94c1b59a7fda92670ad1bc0d631268b07d56c/wrapper/README.md\" rel=\"nofollow noreferrer\">go-micro wrapper examples</a></p>\n\n<p>api's code where authWrapper gets called:</p>\n\n<pre><code>func main() {\n    service := micro.NewService(\n        micro.Name(\"go.micro.api.account\"),\n        micro.WrapHandler(AuthWrapper),\n    )\n    fmt.Println(\"service created\")\n    service.Init()\n    account.RegisterAccountHandler(service.Server(),\n        &amp;handler.Account{\n            ProfileServiceClient: profile.NewProfileServiceClient(\"go.micro.srv.profile\", service.Client()),\n            AuthServiceClient:    auth.NewAuthServiceClient(\"go.micro.srv.auth\", service.Client()),\n        })\n\n    if err := service.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>and authWrapper:</p>\n\n<pre><code>var methodsWithoutAuth = map[string]bool{\"Account.Auth\": true, \"Account.Create\": true}\n\nfunc AuthWrapper(fn server.HandlerFunc) server.HandlerFunc {\n    return func(ctx context.Context, req server.Request, resp interface{}) error {\n        fmt.Printf(\"AuthWrapper, req: %+v\", req)\n\n        method := req.Method()\n        fmt.Printf(\"checking if method allowed, method: %+v\", method)\n        if _, ok := methodsWithoutAuth[method]; ok {\n            return fn(ctx, req, resp)\n        }\n\n        fmt.Printf(\"validating token\")\n\n        authClient := auth.NewAuthServiceClient(\"go.micro.srv.auth\", client.DefaultClient)\n\n        meta, ok := metadata.FromContext(ctx)\n        if !ok {\n            return errors.New(\"no auth meta-data found in request\")\n        }\n\n        token := meta[\"Token\"]\n        log.Println(\"Authenticating with token: \", token)\n\n        newCtx := context.WithValue(ctx, \"Method\", req.Method())\n\n        _, err := authClient.ValidateToken(newCtx, &amp;auth.Token{Token: token})\n        if err != nil {\n            return err\n        }\n\n        prof, err := authClient.Decode(newCtx, &amp;auth.Token{Token: token})\n        if err != nil {\n            return err\n        }\n\n        newCtxWithProf := context.WithValue(newCtx, \"Profile\", prof.Profile)\n\n        return fn(newCtxWithProf, req, resp)\n    }\n}\n</code></pre>\n"}, {"tags": ["python-2.7", "go"], "answers": [{"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1524458206, "post_id": 49973017, "comment_id": 86962804, "body": "Minor change: regex (which you correctly copied from OP) should be <code>&quot;[^A-Za-z]&quot;</code>.  And YES!!! Always check returned errors."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1524470559, "post_id": 49973017, "comment_id": 86968206, "body": "@sberry: Fixed."}, {"owner": {"reputation": 17, "user_id": 4940844, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6CquowI6uI/AAAAAAAAAAI/AAAAAAAAAbY/StFQnJDRA9I/photo.jpg?sz=128", "display_name": "Keith Lashley", "link": "https://stackoverflow.com/users/4940844/keith-lashley"}, "edited": false, "score": 0, "creation_date": 1524667720, "post_id": 49973017, "comment_id": 87066574, "body": "Thank you looked this up at another source and found a solution but your explanation helped me understand."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1524470758, "last_edit_date": 1524470758, "creation_date": 1524454284, "answer_id": 49973017, "question_id": 49972363, "link": "https://stackoverflow.com/questions/49972363/how-to-rename-a-group-of-files-in-a-different-directory-in-golang/49973017#49973017", "title": "How to rename a group of files in a different directory in Golang", "body": "<p>In Go, always, always, check for errors. Many of your problems will then be obvious. For example, you have <code>os.Rename</code> errors.</p>\n\n<p>Use the <code>filepath</code> package to manipulate filename paths. Compiling a constant <code>regex</code> expression should only be done once. Fix your <code>regexp</code> bug: <code>\"[^A-za-z]\"</code> should be <code>\"[^A-Za-z]\"</code>. </p>\n\n<p>Here's a working version:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n    \"regexp\"\n)\n\nfunc readCurrentDir() {\n    dir := \"C:\\\\Users\\\\g\\\\Desktop\\\\prank\"\n    file, err := os.Open(dir)\n    if err != nil {\n        log.Fatalf(\"failed opening directory: %s\", err)\n    }\n    defer file.Close()\n\n    list, err := file.Readdirnames(0) // 0 to read all files and folders\n    if err != nil {\n        log.Fatalf(\"failed reading directory: %s\", err)\n    }\n    re := regexp.MustCompile(\"[^A-Za-z]\")\n    for _, name := range list {\n        oldName := name\n        fmt.Println(\"Old Name - \", oldName)\n        newName := re.ReplaceAllString(oldName, \" \")\n        fmt.Println(\"New Name - \", newName)\n        err := os.Rename(filepath.Join(dir, oldName), filepath.Join(dir, newName))\n        if err != nil {\n            log.Printf(\"error renaming file: %s\", err)\n            continue\n        }\n        fmt.Println(\"File names have been changed\")\n    }\n}\n\nfunc main() {\n    readCurrentDir()\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Old Name -  prankster.42.txt\nNew Name -  prankster    txt\nFile names have been changed\n</code></pre>\n\n<p>Diff:</p>\n\n<pre><code>&gt; git diff old.go new.go\ndiff --git a/old.go b/new.go\nindex 464b60e..7ae276e 100644\n--- a/old.go\n+++ b/new.go\n@@ -4,6 +4,7 @@ import (\n        \"fmt\"\n        \"log\"\n        \"os\"\n+       \"path/filepath\"\n        \"regexp\"\n )\n\n@@ -15,69 +16,31 @@ func readCurrentDir() {\n        }\n        defer file.Close()\n\n-       list, _ := file.Readdirnames(0) // 0 to read all files and folders\n+       list, err := file.Readdirnames(0) // 0 to read all files and folders\n+       if err != nil {\n+               log.Fatalf(\"failed reading directory: %s\", err)\n+       }\n+       re := regexp.MustCompile(\"[^A-Za-z]\")\n        for _, name := range list {\n                oldName := name\n                fmt.Println(\"Old Name - \", oldName)\n-               re := regexp.MustCompile(\"[^A-za-z]\")\n                newName := re.ReplaceAllString(oldName, \" \")\n                fmt.Println(\"New Name - \", newName)\n-               os.Rename(dir+oldName, dir+newName)\n+               err := os.Rename(filepath.Join(dir, oldName), filepath.Join(dir, newName))\n+               if err != nil {\n+                       log.Printf(\"error renaming file: %s\", err)\n+                       continue\n+               }\n                fmt.Println(\"File names have been changed\")\n-\n        }\n }\n\n func main() {\n        readCurrentDir()\n-\n }\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4940844, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-T6CquowI6uI/AAAAAAAAAAI/AAAAAAAAAbY/StFQnJDRA9I/photo.jpg?sz=128", "display_name": "Keith Lashley", "link": "https://stackoverflow.com/users/4940844/keith-lashley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1524470758, "creation_date": 1524447814, "question_id": 49972363, "link": "https://stackoverflow.com/questions/49972363/how-to-rename-a-group-of-files-in-a-different-directory-in-golang", "title": "How to rename a group of files in a different directory in Golang", "body": "<p>I made a program in Python 2.7 that renames the files in a directory by replacing the numbers in those file names.  I tried to do the same thing with a Golang app but it is not working.  The console still gives be new names but it is not changing the names of the photos in the file directory.  </p>\n\n<p>Here is the python program</p>\n\n<pre><code>import os\ndef rename_files():\n    #(1) get files names from a folder\n    file_list = os.listdir(r\"C:\\\\Users\\\\g\\\\Desktop\\\\Fun\\\\udacity\\\\foundationsofpython\\\\07finalrenamingapp\\\\prank\")\n    print(file_list)\n    saved_path = os.getcwd()\n    print (saved_path)\n    os.chdir(r\"C:\\\\Users\\\\g\\\\Desktop\\\\Fun\\\\udacity\\\\foundationsofpython\\\\07finalrenamingapp\\\\prank\")\n\n    #2 rename all files names in folder\n    for file_name in file_list:\n        print (\"Old Name - \" +file_name)\n        print (\"New Name - \" +file_name.strip(\"0123456789\"))\n        os.rename(file_name,file_name.strip(\"0123456789\"))\n    os.chdir(saved_path)\n\nrename_files()\n</code></pre>\n\n<p>This works just fine.  However, this Golang script does not\nThis is the Golang program</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"fmt\"\n    \"regexp\"\n)\nfunc readCurrentDir() {\n    dir := \"C:\\\\Users\\\\g\\\\Desktop\\\\prank\"\n    file, err := os.Open(dir)\n    if err != nil {\n        log.Fatalf(\"failed opening directory: %s\", err)\n    }\n    defer file.Close()\n\n    list,_ := file.Readdirnames(0) // 0 to read all files and folders\n    for _, name := range list {\n        oldName := name\n        fmt.Println(\"Old Name - \", oldName)\n        re := regexp.MustCompile( \"[^A-za-z]\" )\n        newName := re.ReplaceAllString( oldName, \" \")\n        fmt.Println(\"New Name - \", newName)        \n        os.Rename(dir+oldName, dir+newName)\n        fmt.Println(\"File names have been changed\")\n\n    }\n}\n\nfunc main() {\n    readCurrentDir()\n\n}\n</code></pre>\n\n<p>If you want to pull these to projects from the github repo here is a link that will provide you with the code and the photo folder where the images are stored.  I would benefit the most by seeing where my code needs to be changed.  Any help or advice you could give would be greatly appreciated.  Thank you very much.</p>\n\n<p>Python App  <a href=\"https://github.com/lashleykeith/GoingwithGolang/tree/master/OldCode2BeChanged\" rel=\"nofollow noreferrer\">https://github.com/lashleykeith/GoingwithGolang/tree/master/OldCode2BeChanged</a></p>\n\n<p>Golang App\n<a href=\"https://github.com/lashleykeith/GoingwithGolang/tree/master/our_tutorial/5finalrenamingapp\" rel=\"nofollow noreferrer\">https://github.com/lashleykeith/GoingwithGolang/tree/master/our_tutorial/5finalrenamingapp</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 3628322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c8dbc707a957bb6408f0efb3e88a?s=128&d=identicon&r=PG&f=1", "display_name": "Peach", "link": "https://stackoverflow.com/users/3628322/peach"}, "edited": false, "score": 0, "creation_date": 1524706901, "post_id": 49972729, "comment_id": 87083332, "body": "By doing this, All bounds checking are eliminated. <a href=\"https://go101.org/article/bounds-check-elimination.html\" rel=\"nofollow noreferrer\">See this post</a>"}], "tags": [], "owner": {"reputation": 394, "user_id": 4794989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kl1aC.jpg?s=128&g=1", "display_name": "Alireza Bashiri", "link": "https://stackoverflow.com/users/4794989/alireza-bashiri"}, "is_accepted": false, "score": 2, "last_activity_date": 1524451495, "creation_date": 1524451495, "answer_id": 49972729, "question_id": 49972319, "link": "https://stackoverflow.com/questions/49972319/disable-array-slice-bounds-checking-in-golang-to-improve-performance/49972729#49972729", "title": "Disable array/slice bounds checking in Golang to improve performance", "body": "<p>Using <code>gcflags</code> you can disable bounds checking.</p>\n\n<pre><code>go build -gcflags=-B .\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 3628322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c8dbc707a957bb6408f0efb3e88a?s=128&d=identicon&r=PG&f=1", "display_name": "Peach", "link": "https://stackoverflow.com/users/3628322/peach"}, "edited": false, "score": 1, "creation_date": 1524706535, "post_id": 49972772, "comment_id": 87083253, "body": "Sorry for the XY problem. I just wrote a FPS calculator, and It shows the FPS is always \u2248 60. So maybe you are right, bounds checking is not the matter. And, after many tests, I noticed there are many misalignment between frames. I do use SDL double buffer to render image on screen, but I don&#39;t know why."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1524452226, "last_edit_date": 1524452226, "creation_date": 1524451852, "answer_id": 49972772, "question_id": 49972319, "link": "https://stackoverflow.com/questions/49972319/disable-array-slice-bounds-checking-in-golang-to-improve-performance/49972772#49972772", "title": "Disable array/slice bounds checking in Golang to improve performance", "body": "<blockquote>\n  <p><a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">The XY Problem</a></p>\n  \n  <p>The XY problem is asking about your attempted solution rather than\n  your actual problem.</p>\n</blockquote>\n\n<hr>\n\n<p>Your real problem is overall performance. Let's see some benchmarks to show that bounds checking is a significant problem. It may not be a significant problem. For example, less than one millisecond per second,</p>\n\n<p>Bounds check:</p>\n\n<pre><code>BenchmarkPixels-4    300    4034580 ns/op\n</code></pre>\n\n<p>No bounds check:</p>\n\n<pre><code>BenchmarkPixels-4    500    3150985 ns/op\n</code></pre>\n\n<p><code>bounds_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n)\n\nconst (\n    width  = 256\n    height = 240\n    frames = 60\n)\n\nvar pixels [width * height]byte\n\nfunc writePixel(w, h int) {\n    pixels[w*height+h] = 42\n}\n\nfunc BenchmarkPixels(b *testing.B) {\n    for N := 0; N &lt; b.N; N++ {\n        for f := 0; f &lt; frames; f++ {\n            for w := 0; w &lt; width; w++ {\n                for h := 0; h &lt; height; h++ {\n                    writePixel(w, h)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "is_accepted": false, "score": 2, "last_activity_date": 1555129639, "creation_date": 1555129639, "answer_id": 55662008, "question_id": 49972319, "link": "https://stackoverflow.com/questions/49972319/disable-array-slice-bounds-checking-in-golang-to-improve-performance/55662008#55662008", "title": "Disable array/slice bounds checking in Golang to improve performance", "body": "<p>If you really need to avoid the bounds check, you can use the unsafe package and use C-style pointer arithmetic to perform your lookups:</p>\n\n<pre><code>index := 2\nsize := unsafe.Sizeof(YourStruct{})\np := unsafe.Pointer(&amp;yourStructSlice[0])\nindexp := (unsafe.Pointer)(uintptr(p) + size*uintptr(index))\nyourStructPtr := (*YourStruct)(indexp)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/GDNphKsJPOv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GDNphKsJPOv</a></p>\n\n<p>You should time it to determine how much CPU run time you are actually saving by doing this, but it is probably true it is possible to make it faster using this approach.</p>\n\n<p>Also, you may want to have a look at the actual generated instructions to make sure that what you outputting is actually more efficient.  Doing lookups without bounds checks very well may be more trouble than it's worth.  Some info on how to do that here: <a href=\"https://github.com/teh-cmc/go-internals/blob/master/chapter1_assembly_primer/README.md\" rel=\"nofollow noreferrer\">https://github.com/teh-cmc/go-internals/blob/master/chapter1_assembly_primer/README.md</a></p>\n\n<p>Another common approach is to write performance critical code in assembly (see <a href=\"https://golang.org/doc/asm\" rel=\"nofollow noreferrer\">https://golang.org/doc/asm</a>).  Ain't no automatic bounds checking in asm :) </p>\n"}], "owner": {"reputation": 81, "user_id": 3628322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28f6c8dbc707a957bb6408f0efb3e88a?s=128&d=identicon&r=PG&f=1", "display_name": "Peach", "link": "https://stackoverflow.com/users/3628322/peach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1446, "favorite_count": 2, "answer_count": 3, "score": 4, "last_activity_date": 1555129639, "creation_date": 1524447363, "question_id": 49972319, "link": "https://stackoverflow.com/questions/49972319/disable-array-slice-bounds-checking-in-golang-to-improve-performance", "title": "Disable array/slice bounds checking in Golang to improve performance", "body": "<p>I'm writing a NES/Famicom emulator. I register a callback function that will be called every time a pixel is rendered. It means that my callback function will be called about 3.5 million times (256width * 240height * 60fps). </p>\n\n<p>In my callback function, there are many array/slice operations, and I found that Go will do bounds checking every time I index an element in it. But the indexes are results of bit and operations so I can tell that it will NOT exceed both bounds.</p>\n\n<p>So, I'm here to ask if there is a way to disable bounds checking?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "ib-api"], "answers": [{"tags": [], "owner": {"reputation": 2700, "user_id": 691416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/497c258e20915c2b16947525a9bb9833?s=128&d=identicon&r=PG", "display_name": "Stephen", "link": "https://stackoverflow.com/users/691416/stephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1533756987, "creation_date": 1533756987, "answer_id": 51754388, "question_id": 49971796, "link": "https://stackoverflow.com/questions/49971796/ib-api-order-placement-error-cannot-set-vol-attribute-on-non-vol-order/51754388#51754388", "title": "IB API order placement error: cannot set VOL attribute on non-vol order", "body": "<p>Instead of <code>ib.Order{...}</code>, try <code>order := ib.NewOrder()</code></p>\n"}, {"tags": [], "owner": {"reputation": 486, "user_id": 11234834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03c34c24604be60dfc84b959bf8f61fc?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11234834/josh"}, "is_accepted": false, "score": 0, "last_activity_date": 1565283239, "last_edit_date": 1565283239, "creation_date": 1565276794, "answer_id": 57415683, "question_id": 49971796, "link": "https://stackoverflow.com/questions/49971796/ib-api-order-placement-error-cannot-set-vol-attribute-on-non-vol-order/57415683#57415683", "title": "IB API order placement error: cannot set VOL attribute on non-vol order", "body": "<p>It looks like the order object constructor is setting the <code>volatility</code> and <code>volatilityType</code> attributes to 0. In this case since the order is not a volatility order (type <code>VOL</code>), these attributes should be unset. In the IB API, 'unset' is designated by the maximum value for that primitive data type. So in the Order class, </p>\n\n<p><code>volatilityType</code> would need to be <code>=</code> <code>math.MaxInt32</code> or <code>2147483647</code> and</p>\n\n<p><code>volatility</code> set as <code>math.MaxFloat64 = 1.7976931348623157e+308</code></p>\n"}], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 305, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1565349300, "creation_date": 1524441019, "last_edit_date": 1565349300, "question_id": 49971796, "link": "https://stackoverflow.com/questions/49971796/ib-api-order-placement-error-cannot-set-vol-attribute-on-non-vol-order", "title": "IB API order placement error: cannot set VOL attribute on non-vol order", "body": "<p>I'm trying to use <a href=\"https://godoc.org/github.com/gofinance/ib\" rel=\"nofollow noreferrer\">a Go port</a> of the ib API to connect to my Interactive Brokers Trader Workstation.</p>\n\n<p>I can connect and read data from the API but when I try to place an order on a paper trading account I get the following error:</p>\n\n<pre><code>&amp;{1 321 Error validating request:-'bB' : cause - Cannot set VOL attribute on non-VOL order.}\n</code></pre>\n\n<p>But I do not believe I set a VOL attribute in the request. A minimal program that reproduces the error is:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"time\"\n\n    \"github.com/gofinance/ib\"\n)\n\nfunc main() {\n    eng, err := ib.NewEngine(ib.EngineOptions{\n        DumpConversation: true,\n        Gateway:          \"127.0.0.1:1122\",\n    })\n    if err != nil {\n        fmt.Printf(\"Connection error: %v\", err)\n    }\n    // Note: you have to make sure the connection has been fully established\n    // before attempting to do any requests to the TWS. Failure to do so will\n    // result in the TWS closing the connection. Typically this can be done by\n    // waiting for a callback from an event and the end of the initial connection\n    // handshake, such as IBApi.EWrapper.nextValidId or IBApi.EWrapper.managedAccounts\n    // https://interactivebrokers.github.io/tws-api/connection.html\n    // TODO take apart engine.go and make it wait properly.\n    time.Sleep(1 * time.Second)\n    defer eng.Stop()\n    // printInstrument(eng)\n    reqID := eng.NextRequestID()\n    o := make(chan ib.Reply)\n    eng.Subscribe(o, reqID)\n    order := ib.Order{\n        Action:     \"BUY\",\n        OrderType:  \"LMT\",\n        TotalQty:   100,\n        LimitPrice: 95.94,\n    }\n    contract := ib.Contract{\n        SecurityType:    \"STK\",\n        Symbol:          \"MSFT\",\n        Exchange:        \"SMART\",\n        PrimaryExchange: \"NASDAQ\",\n        Currency:        \"USD\",\n    }\n    req := &amp;ib.PlaceOrder{\n        Order:    order,\n        Contract: contract,\n    }\n    req.SetID(reqID)\n    if err := eng.Send(req); err != nil {\n        fmt.Printf(\"Send error: %v\", err)\n    }\n    fmt.Println(\"Waiting for reply...\")\n    reply := &lt;-o\n    fmt.Println(reply)\n}\n</code></pre>\n\n<p>And the output from the program is:</p>\n\n<pre><code>$ go run main.go\n2&gt; '71-1-2-'\n2&lt; &amp;{15 1} &amp;{[DU1029297]}\n2&lt; &amp;{9 1} &amp;{1}\n2&lt; &amp;{4 2} &amp;{-1 2104 Market data farm connection is OK:usfuture}\n2&lt; &amp;{4 2} &amp;{-1 2104 Market data farm connection is OK:cashfarm}\n2&lt; &amp;{4 2} &amp;{-1 2104 Market data farm connection is OK:usfarm.us}\n2&lt; &amp;{4 2} &amp;{-1 2104 Market data farm connection is OK:usfarm}\n2&lt; &amp;{4 2} &amp;{-1 2106 HMDS data farm connection is OK:ilhmds}\n2&lt; &amp;{4 2} &amp;{-1 2106 HMDS data farm connection is OK:euhmds}\n2&lt; &amp;{4 2} &amp;{-1 2106 HMDS data farm connection is OK:fundfarm}\n2&lt; &amp;{4 2} &amp;{-1 2106 HMDS data farm connection is OK:ushmds}\n2&gt; '3-42-1-0-MSFT-STK--0---SMART-NASDAQ-USD-----BUY-100-LMT-95.94-0-----0--0-0-0-0-0-0-0-0--0-------0--0-0---0-0-0-0-0-0-0-0-0-0-0-0-0-0-0--0-0-0-0-0-0-0-0-----0---0-0--0--'\nWaiting for reply...\n2&lt; &amp;{4 2} &amp;{1 321 Error validating request:-'bB' : cause - Cannot set VOL attribute on...\n&amp;{1 321 Error validating request:-'bB' : cause - Cannot set VOL attribute on non-VOL order.}\n</code></pre>\n\n<p>Note especially the dump from the ib engine <code>3-42-1-0-MSFT-STK--0---SMART-NASDAQ-USD-----BUY-100-LMT-95.94-0-----0--0-0-0-0-0-0-0-0--0-------0--0-0---0-0-0-0-0-0-0-0-0-0-0-0-0-0-0--0-0-0-0-0-0-0-0-----0---0-0--0--</code>. Maybe someone familiar with the IB API can tell me what I'm doing wrong here?</p>\n"}, {"tags": ["multithreading", "go", "range", "goroutine", "channels"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1524456082, "post_id": 49971237, "comment_id": 86962349, "body": "<code>range</code> ranges until the channel is closed. &quot;the buffer runs out&quot; has nothing to do with how range works (for whatever the buffer runs out means)."}, {"owner": {"reputation": 91, "user_id": 7176723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XG4Z3n-6m0k/AAAAAAAAAAI/AAAAAAAACCg/2iexh4HIdIY/photo.jpg?sz=128", "display_name": "Tamimi Ahmad", "link": "https://stackoverflow.com/users/7176723/tamimi-ahmad"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1524674843, "post_id": 49971237, "comment_id": 87071080, "body": "I found another solution as well, which is by using <code>defer</code>. Ultimately I could  <code>go func() { defer close(ch) }</code> just before printing the content"}], "answers": [{"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1524441275, "post_id": 49971647, "comment_id": 86959484, "body": "The reason the second one might not be printing all the way to 9 has to do with the fact that the main goroutine exits after the last value is put onto the channel, and the receiver goroutine may not print output by that time."}, {"owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1524467939, "post_id": 49971647, "comment_id": 86966703, "body": "Added a note updating my answer."}], "tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": false, "score": 1, "last_activity_date": 1524467898, "last_edit_date": 1524467898, "creation_date": 1524439382, "answer_id": 49971647, "question_id": 49971237, "link": "https://stackoverflow.com/questions/49971237/how-to-safely-interact-with-channels-in-goroutines-in-golang/49971647#49971647", "title": "How to safely interact with channels in goroutines in Golang", "body": "<p>The reason your first implementation only returns every other number is because you are, in effect \"taking\" from <code>c</code> twice each time the loop runs: first with <code>range</code>, then again with <code>&lt;-</code>. It just happens that you're not actually binding or using the first value taken off the channel, so all you end up printing is every other one.</p>\n\n<p>An alternative approach to your first implementation would be to not use <code>range</code> at all, e.g.:</p>\n\n<pre><code>func printchannel(c chan int) {\n    for {\n        fmt.Println(&lt;-c)\n    }\n}\n</code></pre>\n\n<p>I could not replicate the behavior of your second implementation, on my machine, but the reason for that is that both of your implementations are racy - they will terminate whenever main ends, regardless of what data may be pending in a channel or however many goroutines may be active. </p>\n\n<p>As a closing note, I'd warn you not to think about goroutines as explicitly being \"threads\", though they have a similar mental model and interface. In a simple program like this it's not at all unlikely that Go might just do it all using a single OS thread. </p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 5561795, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z0i3f53E6iY/AAAAAAAAAAI/AAAAAAAAEkg/VxUOEbN_GH4/photo.jpg?sz=128", "display_name": "Gaurav Raghuvanshy", "link": "https://stackoverflow.com/users/5561795/gaurav-raghuvanshy"}, "is_accepted": false, "score": -1, "last_activity_date": 1524440538, "creation_date": 1524440538, "answer_id": 49971740, "question_id": 49971237, "link": "https://stackoverflow.com/questions/49971237/how-to-safely-interact-with-channels-in-goroutines-in-golang/49971740#49971740", "title": "How to safely interact with channels in goroutines in Golang", "body": "<p>Your first loop does not work as you have 2 blocking channel receivers and they do not execute at the same time.</p>\n\n<p>When you call the goroutine the loop starts, and it waits for the first value to be sent to the channel. Effectively think of it as <code>&lt;-c</code> . </p>\n\n<p>When the for loop in the main function runs it sends 0 on the Chan. At this point the <code>range c</code> recieves the value and stops blocking the execution of the loop.</p>\n\n<p>Then it is blocked by the reciever at <code>fmt.println(&lt;-c)</code> . When 1 is sent on the second iteration of the loop in main the recieved at <code>fmt.println(&lt;-c)</code> reads from the channel, allowing <code>fmt.println</code> to execute thus finishing the loop and waiting for a value at the <code>for range c</code> .</p>\n\n<p>Your second implementation of the looping mechanism is the correct one.\nThe reason it exits before printing to 9 is that after the for loop in <code>main</code> finishes the program goes ahead and completes execution of main.</p>\n\n<p>In Go func main is launched as a goroutine itself while executing. Thus when the for loop in main completes it goes ahead and exits, and as the print is within a parallel goroutine that is closed, it is never executed. There is no time for it to print as there is nothing to block main from completing and exiting the program.</p>\n\n<p>One way to solve this is to use wait groups <a href=\"http://www.golangprograms.com/go-language/concurrency.html\" rel=\"nofollow noreferrer\">http://www.golangprograms.com/go-language/concurrency.html</a></p>\n\n<p>In order to get the expected result you need to have a blocking process running in main that provides enough time or waits for confirmation of the execution of the goroutine before allowing the program to continue.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 7176723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XG4Z3n-6m0k/AAAAAAAAAAI/AAAAAAAACCg/2iexh4HIdIY/photo.jpg?sz=128", "display_name": "Tamimi Ahmad", "link": "https://stackoverflow.com/users/7176723/tamimi-ahmad"}, "edited": false, "score": 0, "creation_date": 1524674796, "post_id": 49971752, "comment_id": 87071064, "body": "I like the wait group approach to it, interesting implementation. And thanks for the pointer to look into goroutines (green threads) vs regular threads!"}], "tags": [], "owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "is_accepted": true, "score": 3, "last_activity_date": 1524440666, "creation_date": 1524440666, "answer_id": 49971752, "question_id": 49971237, "link": "https://stackoverflow.com/questions/49971237/how-to-safely-interact-with-channels-in-goroutines-in-golang/49971752#49971752", "title": "How to safely interact with channels in goroutines in Golang", "body": "<p>Implementation 1. You're reading from the channel twice - <code>range c</code> and <code>&lt;-c</code> are both reading from the channel. </p>\n\n<p>Implementation 2. That's the correct approach. The reason you might not see 9 printed is that two goroutines might run in parallel threads. In that case it might go like this:</p>\n\n<ol>\n<li>main goroutine sends 9 to the channel and blocks until it's read</li>\n<li>second goroutine receives 9 from the channel</li>\n<li>main goroutine unblocks and exits. That terminates whole program which doesn't give second goroutine a chance to print 9</li>\n</ol>\n\n<p>In case like that you have to synchronize your goroutines. For example, like so</p>\n\n<pre><code>func printchannel(c chan int, wg *sync.WaitGroup) {\n    for i:=range c {\n        fmt.Println(i)\n    }\n\n    wg.Done() //notify that we're done here\n}\n\nfunc main() {\n    c := make(chan int)\n    wg := sync.WaitGroup{}\n\n    wg.Add(1) //increase by one to wait for one goroutine to finish\n              //very important to do it here and not in the goroutine\n              //otherwise you get race condition\n\n    go printchannel(c, &amp;wg) //very important to pass wg by reference\n                            //sync.WaitGroup is a structure, passing it\n                            //by value would produce incorrect results\n\n    for i:=0; i&lt;10 ; i++ {\n        c &lt;- i\n    }\n\n    close(c)  //close the channel to terminate the range loop\n    wg.Wait() //wait for the goroutine to finish\n}\n</code></pre>\n\n<p>As to goroutines vs threads. You shouldn't confuse them and probably should understand the difference between them. Goroutines are green threads. There're countless blog posts, lectures and stackoverflow answers on that topic. </p>\n"}, {"tags": [], "owner": {"reputation": 231, "user_id": 3578692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8abcd270aa5bfa384e94a2fdb89d509e?s=128&d=identicon&r=PG&f=1", "display_name": "Metatrix", "link": "https://stackoverflow.com/users/3578692/metatrix"}, "is_accepted": false, "score": 1, "last_activity_date": 1524466290, "creation_date": 1524466290, "answer_id": 49974986, "question_id": 49971237, "link": "https://stackoverflow.com/questions/49971237/how-to-safely-interact-with-channels-in-goroutines-in-golang/49974986#49974986", "title": "How to safely interact with channels in goroutines in Golang", "body": "<p>In implementation 1, range reads into channel once, then again in Println. Hence you're skipping over 2, 4, 6, 8.</p>\n\n<p>In both implementations, once the final i (9) has been sent to goroutine, the program exits. Thus goroutine does not have the time to print out 9. To solve it, use a WaitGroup as has been mentioned in the other answer, or a done channel to avoid semaphore/mutex.</p>\n\n<pre><code>func main() {\n\n    c := make(chan int)\n    done := make(chan bool)\n    go printchannel(c, done)\n    for i:=0; i&lt;10 ; i++ {\n        c &lt;- i\n    }\n    close(c)\n    &lt;- done\n}\n\nfunc printchannel(c chan int, done chan bool) {\n    for i := range c {\n        fmt.Println(i)\n    }\n    done &lt;- true\n}\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7176723, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XG4Z3n-6m0k/AAAAAAAAAAI/AAAAAAAACCg/2iexh4HIdIY/photo.jpg?sz=128", "display_name": "Tamimi Ahmad", "link": "https://stackoverflow.com/users/7176723/tamimi-ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1129, "favorite_count": 2, "accepted_answer_id": 49971752, "answer_count": 4, "score": 2, "last_activity_date": 1524467898, "creation_date": 1524435192, "question_id": 49971237, "link": "https://stackoverflow.com/questions/49971237/how-to-safely-interact-with-channels-in-goroutines-in-golang", "title": "How to safely interact with channels in goroutines in Golang", "body": "<p>I am new to go and I am trying to understand the way channels in goroutines work. To my understanding, the keyword <code>range</code> could be used to iterate over a the values of the channel up until the channel is closed or the buffer runs out; hence, a <code>for range c</code> will repeatedly loops until the buffer runs out.</p>\n\n<p>I have the following simple function that adds value to a channel:</p>\n\n<pre><code>func main() {\n\n    c := make(chan int)\n    go printchannel(c)\n    for i:=0; i&lt;10 ; i++ {\n        c &lt;- i\n    }\n\n}\n</code></pre>\n\n<p>I have two implementations of <code>printchannel</code> and I am not sure why the behaviour is different.</p>\n\n<p><strong>Implementation 1:</strong></p>\n\n<pre><code>func printchannel(c chan int) {\n    for range c {\n        fmt.Println(&lt;-c)\n    }\n}\n</code></pre>\n\n<p><em>output: 1 3 5 7</em></p>\n\n<p><strong>Implementation 2:</strong></p>\n\n<pre><code>func printchannel(c chan int) {\n    for i:=range c {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p><em>output: 0 1 2 3 4 5 6 7 8</em></p>\n\n<p>And I was expecting neither of those outputs! </p>\n\n<p><em>Wanted output: 0 1 2 3 4 5 6 7 8 9</em></p>\n\n<p>Shouldnt the <code>main</code> function and the <code>printchannel</code> function run on two threads in parallel, one adding values to the channel and the other reading the values up until the channel is closed? I might be missing some fundamental go/thread concept here and pointers to that would be helpful.</p>\n\n<p>Feedback on this (and my understanding to channels manipulation in goroutines) is greatly appreciated!</p>\n"}, {"tags": ["function", "go", "struct", "types", "binding"], "comments": [{"owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "edited": false, "score": 0, "creation_date": 1524432537, "post_id": 49970715, "comment_id": 86957680, "body": "Oh, I see that seemed to work. No, actually, it didn&#39;t:  <a href=\"https://play.golang.org/p/xIbXg8ks2lO\" rel=\"nofollow noreferrer\">play.golang.org/p/xIbXg8ks2lO</a>  I mean, it worked as in, I was able to invoke these functions,  and they assigned and all, but as soon as I removed the []FuncSet{} slice it can&#39;t find the functions, though I didn&#39;t change the name (and I can only assume it has to do with the signature including the type binding)."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1524432810, "post_id": 49970715, "comment_id": 86957732, "body": "You might get more help if you try explaining the actual problem you&#39;re trying to solve instead of asking how to implement something that looks like a feature from another langauge."}, {"owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1524433500, "post_id": 49970715, "comment_id": 86957906, "body": "Yes, it essentially implements function overrides.  I&#39;d be happy to learn a more idiomatic and less boiler-plate riddled route to the very simple goal:  I have a tree library, and I want to be able to arbitrarily substitute any given data type in the payload of each node. The structure contains a slice array, and has a coordinate system and uses simple formulae based on the index to enable left/right/parent steps instead of using vector references. I ended up stumbling on this way to do it after I learned the &#39;type Name func()&#39; thing."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1524434298, "post_id": 49970715, "comment_id": 86958068, "body": "I would love to help but you&#39;ve given me two sentences and only one of those seems to have some significance to the problem you&#39;re trying to solve. As it stands now I&#39;m unable to fully comprehend what you&#39;re trying to do and therefore unable to offer a solution. Maybe someone more knoledgable will join and help out, or, if you can, please update the original question with your actual question, include the relevant code: Tree, Node, how/where you need to do the arbitrary substitution, etc."}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1524434405, "post_id": 49970715, "comment_id": 86958092, "body": "I don&#39;t quite understand what it is you want to do. From the playground code, it looks like you want to have a function you can call on a struct type and be able to change the behavior of that function. If that&#39;s the case, you could do that by defining a method on the type that calls <code>Funct</code>, which would still be a field that you could set to whatever function you want. That function would have to take a pointer to <code>FuncSet</code> as a parameter (instead of taking a receiver) so that the binding would be determined by the object you call <code>Funct</code> on."}, {"owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "edited": false, "score": 0, "creation_date": 1524436954, "post_id": 49970715, "comment_id": 86958640, "body": "The thing that is confusing me is that because of the compile time type safety enforcement, I can&#39;t just change the function to be something other than <code>func() error</code> I have to have a set of them (you can see this in the git link I added) and I can&#39;t override the default 32 bit unsigned integer that I am putting in the base library for parameter types either, without <code>type Name func</code> declarations, and these declarations do not match the same signature but with a <code>(*Typename)</code> binding."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "edited": false, "score": 0, "creation_date": 1524591056, "post_id": 49985843, "comment_id": 87031765, "body": "That&#39;s an approach I hadn&#39;t seen before also. I am in the process of switching it all up so that my struct just stores a set of datatype agnostic function signatures with nice names, and a pointer to the same type, and then call them with b.Functionname(b, parameters...) Then I only use interfaces for the types, which pass through type agnostic functions into the type savvy (aka implementations). Saves on my previous overhead wrapping and stupid namespace.  But maybe your idea is even better because I still can b.Functionname(&lt;no pointer here&gt; parameters...)"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 2, "last_activity_date": 1524500991, "creation_date": 1524500991, "answer_id": 49985843, "question_id": 49970715, "link": "https://stackoverflow.com/questions/49970715/golang-function-types-with-a-binding-to-a-struct/49985843#49985843", "title": "Golang Function Types with a binding to a struct?", "body": "<p>You could use an anonymous field with an interface that defines the method set that you want to use (that might change).</p>\n\n<p><a href=\"https://play.golang.org/p/OFCPK8Wl-Rw\" rel=\"nofollow noreferrer\">Go playground here</a></p>\n\n<p>You'd define your interface</p>\n\n<pre><code>type validator interface {\n    IsRightOf(a, b interface{}) bool\n\n    ... // other methods\n}\n</code></pre>\n\n<p>and your type:</p>\n\n<pre><code>type Bast struct {\n    validator // anonymous interface field\n\n    ... // some fields\n}\n</code></pre>\n\n<p>Then you can access the methods of validator from the Bast type</p>\n\n<pre><code>b := bast.New()\nb.IsRightOf(c, d) // this is valid, you do not need to do b.validator.IsRightOf(...)\n</code></pre>\n\n<p>because validator is an interface you can change those methods how you like.</p>\n"}], "owner": {"reputation": 76, "user_id": 7461738, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D0yKjXEU0zI/AAAAAAAAAAI/AAAAAAAAACE/2YFhu24oiB0/photo.jpg?sz=128", "display_name": "Louki Sumirniy", "link": "https://stackoverflow.com/users/7461738/louki-sumirniy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6886, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1524500991, "creation_date": 1524430893, "last_edit_date": 1524436780, "question_id": 49970715, "link": "https://stackoverflow.com/questions/49970715/golang-function-types-with-a-binding-to-a-struct", "title": "Golang Function Types with a binding to a struct?", "body": "<p>This might seem like a silly question, but I want to make a struct with a collection of functions, but the functions bind to the struct. I can sorta see that this is a cycle, but humor me with this example:</p>\n\n<pre><code>type FuncType func() error\n\ntype FuncSet struct {\n  TokenVariable  int\n  FuncTyper      FuncType\n}\n</code></pre>\n\n<p>and I want to be able to create a function bound to the FuncSet type so it can operate on TokenVariable, thusly:</p>\n\n<pre><code>func (f *FuncSet) FuncType() error {\n  f.TokenVariable = 100\n  return nil\n}\n</code></pre>\n\n<p>However, this changes the signature of the type (I can't find any information about type bindings as part of function type specifications) such that assigning this function to the struct element tells me this function/variable is not found.</p>\n\n<p>I can see an easy work-around for this, by prefixing the parameters with a pointer to the struct type, it's just a bit ugly.</p>\n\n<p>I looked around a little further and discovered that what I'm kinda looking for is like a closure in that it can be passed a variable from the immediate outer scope but... well, I'll be glad to be corrected about this absence of type binding in function types, but for now passing the pointer to the type looks like the way to go. </p>\n\n<p>I think I found the solution:</p>\n\n<pre><code>type nullTester func(*Bast, uint32) bool\n\ntype Bast struct {\n  ...\n  isNull    nullTester\n  ...\n }\n\nfunc isNull(b *Bast, d uint32) bool {\n  return d == 0\n}\n</code></pre>\n\n<p>and then I can bind it to the type like this:</p>\n\n<pre><code>func NewBast() (b *Bast) {\n  ...\n  b.isNull = isNull\n  ...\n}\n\n// IsNull - tests if a value in the tree is null\nfunc (b *Bast) IsNull(d uint32) bool {\n  return b.isNull(b, d)\n}\n</code></pre>\n\n<p>It seems a bit hackish and I'm not sure what's going to happen in a second library that I will write that sets a different type for the uint32 parameter, but go vet is happy so maybe this is the correct way to do it.</p>\n\n<p>It does seem to me that func types should really have a field in the grammar to specify a binding type, but maybe I just found a hack that sorta lets me do polymorphism. In calling programs all they will see is the nice exported function that binds to the type as planned and I get my readability as well as being able to retarget the base library to store a different type of data.</p>\n\n<p>I think this is the proper solution. I just can't find anything that confirms or denies whether in a type Name func specification there is any way of asserting the type. It really should not match up, since the binding <em>is</em> part of the signature, but the syntax for type with functions does not appear to have this type binding.</p>\n\n<p>My actual code is here, and you can see by looking at it what I am aiming to do:\n<a href=\"https://github.com/calibrae-project/bast/blob/master/pkg/bast/bast.go\" rel=\"nofollow noreferrer\">https://github.com/calibrae-project/bast/blob/master/pkg/bast/bast.go</a></p>\n\n<p>The differences between the type of data the tree stores is entirely superficial, because it is intended to be primarily used for sorting unsigned integers of various lengths, and one important thing it needs to have is to be able to work from a, for example, 64 bit integer but sort only by the first or last half (as I have a bigger project that treats these hash values as coordinates in an adjacency list). In theory it could be used instead of a hash table lookup as well, with a low variance in time to find elements because of the binary tree structure.</p>\n\n<p>It's not a conventional, reference-vector based tree, and the store itself is an array with an unconventional power of two mapping, a 'dense' tree, and the purpose above all, for implementing this way, is that when the tree is walked, as well as rotated, much of the time it is sequential blocks of memory being accessed which should make for a lot less cache misses than a conventional binary tree (and for which reason generally this type of application just uses some kind of sort like a bucket sort).</p>\n"}, {"tags": ["go", "filter", "writer"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1524414313, "creation_date": 1524414313, "answer_id": 49968180, "question_id": 49967523, "link": "https://stackoverflow.com/questions/49967523/redact-sensitive-data-through-a-custom-io-writer-in-go/49968180#49968180", "title": "Redact sensitive data through a custom io.Writer in Go", "body": "<p>Use <a href=\"https://godoc.org/os/exec#Cmd.StdoutPipe\" rel=\"nofollow noreferrer\">Cmd.StdoutPipe</a> to get a reader on the program output. Use a scanner on that reader. </p>\n\n<pre><code>cmd := exec.Command(someBinaryFile)\nr, err := cmd.StdoutPipe()\nif err != nil {\n    log.Fatal(err)\n}\nif err := cmd.Start(); err != nil {\n    log.Fatal(err)\n}\ns := bufio.NewScanner(r)\nfor s.Scan() {\n    out := s.String() \n    out = strings.Replace(out, pf.keyWord, \"*******\", -1)\n    // write out to destination\n}\nif s.Err() != nil {\n    log.Fatal(s.Err())\n}\nif err := cmd.Wait(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 253, "user_id": 1576623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f344698d39bd1a2d78c6406c2343ff?s=128&d=identicon&r=PG", "display_name": "Athropos", "link": "https://stackoverflow.com/users/1576623/athropos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524414313, "creation_date": 1524410318, "question_id": 49967523, "link": "https://stackoverflow.com/questions/49967523/redact-sensitive-data-through-a-custom-io-writer-in-go", "title": "Redact sensitive data through a custom io.Writer in Go", "body": "<p>I am executing some <code>exec.Command</code>s that output sensitive data. I want to filter this data out. Since you can set the <code>stdout</code> writer to the <code>Command</code> struct, my idea is to write a custom <code>io.Writer</code> that basically consumes the output and filters the output by a given word.</p>\n\n<pre><code>type passwordFilter struct {\n    keyWord string\n}\n\nfunc (pf passwordFilter) Write(p []byte) (n int, err error) {\n    // this is where I have no idea what to do\n    // I think I should somehow use a scanner and then filter\n    // out = strings.Replace(out, pf.keyWord, \"*******\", -1)\n    // something like this\n    // but I have to deal with byte array here\n}\n\nfunc main() {\n    pf := passwordFilter{keyWord: \"password123\"}\n    cmd := exec.Command(someBinaryFile)\n    cmd.Stdout = pf\n    cmd.Stderr = &amp;stderr\n    if err := cmd.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>I'm not sure if I'm headed the right way here, but I'm sure I can somehow reuse the existing <code>io.Writers</code> or scanners here.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "serverless"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 3, "creation_date": 1524405340, "post_id": 49965575, "comment_id": 86948990, "body": "You probably already concluded that <code>&#39;Endpoint&#39; configuration is required for this service</code> seems to imply that <code>aws.Config { Endpoint: ...</code> is expected.  Intuition suggests that this <i>might</i> mean you are using an SDK version that predates the availability of this service in this region.  Probably unrelated, you have <code>eu-west-1</code> rather than <code>eu-west-2</code> in your role config."}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1524435782, "post_id": 49965575, "comment_id": 86958402, "body": "@Michael-sqlbot that was absolutely it, thank you!"}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1524438654, "post_id": 49965575, "comment_id": 86958992, "body": "I guess I managed to make about 3 different suggestions... which one was it?"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 1, "creation_date": 1524489951, "post_id": 49965575, "comment_id": 86980713, "body": "@Michael-sqlbot ahh yes, it was the missing Endpoint url from the config struct. I added the Endpoint generated in the IoT console for my device"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 688, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1535902531, "creation_date": 1524397754, "last_edit_date": 1535902531, "question_id": 49965575, "link": "https://stackoverflow.com/questions/49965575/missingendpoint-error-when-attempting-to-publish-to-iot-core-from-a-lambda", "title": "MissingEndpoint error when attempting to publish to IoT core from a Lambda", "body": "<p>I have a Lambda and I'm attempting to publish to an IoT core via the SDK. However I'm getting an error</p>\n\n<pre><code>{\n    \"errorMessage\": \"MissingEndpoint: 'Endpoint' configuration is required for this service\",\n    \"errorType\": \"baseError\"\n}\n</code></pre>\n\n<p>Here's my publish function:</p>\n\n<pre><code>func publish() error {\n    session := session.New(&amp;aws.Config{\n        Region: aws.String(\"eu-west-2\"),\n    })\n    iot := iotdataplane.New(session)\n    input := &amp;iotdataplane.PublishInput{\n        Payload: []byte(\"take picture\"),\n        Topic:   aws.String(\"take-picture\"),\n    }\n    resp, err := iot.Publish(input)\n\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>Here are some IAM/roles stuff I've added as part of my serverless config:</p>\n\n<pre><code>provider:\n  name: aws\n  runtime: go1.x\n  region: eu-west-1\n  iamRoleStatements:\n    - Effect: \"Allow\"\n      Action:\n        - \"iot:Publish\"\n      Resource: [\"arn:aws:iot:eu-west-2:&lt;redacted&gt;:thing/mini-camera\"]\n    - Effect: \"Allow\"\n      Action:\n        - \"iot:Connect\"\n      Resource: [\"*\"]\n</code></pre>\n"}, {"tags": ["arrays", "dictionary", "go", "hash", "slice"], "comments": [{"owner": {"reputation": 694, "user_id": 2649222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b97bf3c9ef3c1b92be966c36306b4234?s=128&d=identicon&r=PG", "display_name": "ei-grad", "link": "https://stackoverflow.com/users/2649222/ei-grad"}, "edited": false, "score": 0, "creation_date": 1524399211, "post_id": 49965387, "comment_id": 86947285, "body": "A tree approach looks good for me, but the question about <code>reflect.Type</code> bytes representation still looks reasonable. How about the <code>encoding&#47;gob</code>, would it work here?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1524404799, "post_id": 49965387, "comment_id": 86948805, "body": "Why not use the string approach in <a href=\"https://stackoverflow.com/questions/49634346/hashing-reflect-type/49634974#49634974\">hashing-relfect-type</a>?  The answer provides a unique string for a []reflect.Type."}, {"owner": {"reputation": 113, "user_id": 6219573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84475d139afd44f74ae4c1cf54b9380c?s=128&d=identicon&r=PG&f=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/6219573/brent"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1524420899, "post_id": 49965387, "comment_id": 86954254, "body": "@CeriseLim&#243;n - you&#39;re right. I can follow <a href=\"https://stackoverflow.com/questions/49634346/hashing-reflect-type/49634974#49634974\">hashing-reflect-type</a> to keep a map of unique ids for each <code>reflect.Type</code> and then combine those to make keys for my map whose keys are <code>[]reflect.Type</code>. I overlooked this when I read that answer. Feel free to make it an answer or I can!"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 6219573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84475d139afd44f74ae4c1cf54b9380c?s=128&d=identicon&r=PG&f=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/6219573/brent"}, "is_accepted": false, "score": 0, "last_activity_date": 1524522839, "creation_date": 1524522839, "answer_id": 49990857, "question_id": 49965387, "link": "https://stackoverflow.com/questions/49965387/use-slice-reflect-type-as-map-key/49990857#49990857", "title": "Use slice []reflect.Type as map key", "body": "<p>Following a suggestion in the comments I implemented a solution using the <a href=\"https://stackoverflow.com/questions/49634346/hashing-reflect-type\">hashing-reflect-type</a> solution, but for any slice of hashable types.</p>\n\n<pre><code>import (\n    \"reflect\"\n    \"strconv\"\n    \"strings\"\n    \"sync\"\n)\n\n// IdHashmap stores the next id as an int64 and a map pointing to the\n// unique id for each hashable key\ntype IdHashmap struct {\n    nextId  int64\n    hashMap map[interface{}]string\n    mutex   sync.Mutex\n}\n\n// LoadOrStore returns the existing value for the key if present. \n// Otherwise, it stores and returns the given value.\n// The loaded result is true if the value was loaded, false if stored.\n// The value is an a unique id for the object that was passed (or \n// object reference). It is a stringified int64\n// representing the number of unique objects passed to this IdHashmap \n// before this object was first passed in\nfunc (hm *IdHashmap) LoadOrStore(subKey interface{}) (hashmapId string) {\n    if hm.hashMap == nil {\n        hm.hashMap = make(map[interface{}]string)\n    }\n    // the entry for a given key is only ever written once but read many times\n    if id, ok := hm.hashMap[subKey]; ok {\n        return id\n    }\n    hm.mutex.Lock()\n    // check for the possibility that someone else wrote a value for \n    // this subKey while this thread waited for the lock\n    if id, ok := hm.hashMap[subKey]; ok {\n        return id\n    }\n    id := strconv.FormatInt(hm.nextId, 10)\n    hm.nextId++\n    hm.hashMap[subKey] = id\n    hm.mutex.Unlock()\n    return id\n}\n\n// LoadOrStoreForSlice gets a unique id for a given slice of objects \n// by concatenating hashmapids of its elements\nfunc (hm *IdHashmap) LoadOrStoreForSlice(keys interface{}) (hashmapId string) {\n    if reflect.TypeOf(keys).Kind() == reflect.Slice {\n        s := reflect.ValueOf(keys)\n\n        ids := make([]string, s.Len())\n        for i := 0; i &lt; s.Len(); i++ {\n            ids[i], _ = hm.LoadOrStore(s.Index(i))\n        }\n        return strings.Join(ids, \",\")\n    }\n    // if not a slice try hashing directly in case the type is hashable\n    id, _ := hm.LoadOrStore(keys)\n    return id\n}\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6219573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84475d139afd44f74ae4c1cf54b9380c?s=128&d=identicon&r=PG&f=1", "display_name": "Brent", "link": "https://stackoverflow.com/users/6219573/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524522839, "creation_date": 1524396447, "last_edit_date": 1524396741, "question_id": 49965387, "link": "https://stackoverflow.com/questions/49965387/use-slice-reflect-type-as-map-key", "title": "Use slice []reflect.Type as map key", "body": "<p>I have a slice of <code>reflect.Type</code> values that define the input type for a function and I want to cache the result using <code>sync.Map</code>. </p>\n\n<p>I realize slices cannot be used as map keys in general so I have searched far and wide for a way to create unique keys from multiple <code>reflect.Type</code> values. Ideas include </p>\n\n<ol>\n<li>Using a concatenation of <code>reflect.Type.String()</code> for each subkey. The godoc explicitly says not to use it for equality so the keys would not be unique.</li>\n<li>Use a concatenation of <code>fmt.Sprintf(\"%#v\", subKey)</code> - see <a href=\"https://stackoverflow.com/questions/27267042/golang-how-to-use-function-as-maps-key\">here</a>. I don't know whether these keys would be unique.</li>\n<li>Create a tree out of <code>sync.Map</code>s [a map of maps of maps... of depth len(slice)] where the lookup for a value involves traversing deeper in the tree of maps for each subkey. This seems slow and cumbersome but should work.</li>\n<li>Hardcode a limit on the number of keys and store it as an array whose size is the upper limit. This would work but the hardcoded limit is annoying when you need to exceed the limit.</li>\n</ol>\n\n<p>A reference on <a href=\"https://stackoverflow.com/questions/37900696/why-cant-go-slice-be-used-as-keys-in-go-maps-pretty-much-the-same-way-arrays-ca/37901317#37901317\">why slices can't be used as keys</a> indicates that how to define equality on slices may be unclear. In this case I want element-wise equality if and only if the slices have the same length.</p>\n\n<p>It would be awesome to find a byte representation of <code>reflect.Type</code> similar to the solution to a similar problem <a href=\"https://stackoverflow.com/questions/8071383/complex-datatypes-as-keys-in-maps-in-go\">here</a>.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/49634346/hashing-reflect-type\">hashing-reflect-type</a>.</p>\n"}, {"tags": ["go", "encryption", "cryptography", "runtime", "aes"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1524416898, "post_id": 49965280, "comment_id": 86952883, "body": "The table driven implementation likely leaks information through side channels. On x86, ARMv8, POWER8 (and friends) you should use the built-in hardware acceleration."}], "answers": [{"tags": [], "owner": {"reputation": 1706, "user_id": 1967551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d0aecb14d90a03ecc32cafacdbbfaf76?s=128&d=identicon&r=PG&f=1", "display_name": "sribin", "link": "https://stackoverflow.com/users/1967551/sribin"}, "is_accepted": true, "score": 0, "last_activity_date": 1524411405, "creation_date": 1524411405, "answer_id": 49967693, "question_id": 49965280, "link": "https://stackoverflow.com/questions/49965280/how-does-middle-rounds-of-aes-encryption-work-in-go-runtime/49967693#49967693", "title": "How does middle rounds of AES encryption work in Go runtime?", "body": "<p>I have found an answer to my question in:</p>\n\n<ol>\n<li><a href=\"https://crypto.stackexchange.com/questions/19175/efficient-aes-use-of-t-tables\">https://crypto.stackexchange.com/questions/19175/efficient-aes-use-of-t-tables</a></li>\n<li><a href=\"https://stackoverflow.com/questions/15094722/generating-aes-aes-256-lookup-tables\">Generating AES (AES-256) Lookup Tables</a></li>\n<li><a href=\"https://golang.org/src/crypto/aes/aes_test.go\" rel=\"nofollow noreferrer\">https://golang.org/src/crypto/aes/aes_test.go</a></li>\n</ol>\n"}], "owner": {"reputation": 1706, "user_id": 1967551, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d0aecb14d90a03ecc32cafacdbbfaf76?s=128&d=identicon&r=PG&f=1", "display_name": "sribin", "link": "https://stackoverflow.com/users/1967551/sribin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 49967693, "answer_count": 1, "score": 1, "last_activity_date": 1524416933, "creation_date": 1524395670, "last_edit_date": 1524416933, "question_id": 49965280, "link": "https://stackoverflow.com/questions/49965280/how-does-middle-rounds-of-aes-encryption-work-in-go-runtime", "title": "How does middle rounds of AES encryption work in Go runtime?", "body": "<p>I learn how AES`s implementation work in Go and I do not understand how middle rounds work while encrypt block in <a href=\"https://github.com/golang/go/blob/master/src/crypto/aes/block.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/crypto/aes/block.go</a>:</p>\n\n<pre><code>// Middle rounds shuffle using tables.\n// Number of rounds is set by length of expanded key.\nnr := len(xk)/4 - 2 // - 2: one above, one more below\nk := 4\nfor r := 0; r &lt; nr; r++ {\n    t0 = xk[k+0] ^ te0[uint8(s0&gt;&gt;24)] ^ te1[uint8(s1&gt;&gt;16)] ^ te2[uint8(s2&gt;&gt;8)] ^ te3[uint8(s3)]\n    t1 = xk[k+1] ^ te0[uint8(s1&gt;&gt;24)] ^ te1[uint8(s2&gt;&gt;16)] ^ te2[uint8(s3&gt;&gt;8)] ^ te3[uint8(s0)]\n    t2 = xk[k+2] ^ te0[uint8(s2&gt;&gt;24)] ^ te1[uint8(s3&gt;&gt;16)] ^ te2[uint8(s0&gt;&gt;8)] ^ te3[uint8(s1)]\n    t3 = xk[k+3] ^ te0[uint8(s3&gt;&gt;24)] ^ te1[uint8(s0&gt;&gt;16)] ^ te2[uint8(s1&gt;&gt;8)] ^ te3[uint8(s2)]\n    k += 4\n    s0, s1, s2, s3 = t0, t1, t2, t3\n}\n</code></pre>\n\n<p>I understand that this code do SybButes, ShiftRows, MixColumns and AddRoundKey of AES, but I do not understand how this code do it by using \n\"te0\", \"te1\", \"te2\", \"te3\" arrays. It's precomputed arrays which are defined in <a href=\"https://github.com/golang/go/blob/master/src/crypto/aes/const.go\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/crypto/aes/const.go</a>. </p>\n\n<p>May someone explain to me how these arrays was precomputed? Thank you so much for you help.</p>\n"}, {"tags": ["go", "hcl"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1524395428, "post_id": 49965175, "comment_id": 86946318, "body": "Export your struct fields; change the first letters of the field names to uppercase."}, {"owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1524396842, "post_id": 49965175, "comment_id": 86946685, "body": "Thanks, it works for me."}], "owner": {"reputation": 79, "user_id": 7842632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5406b1bc2a45f1647c1316b4039cd2b0?s=128&d=identicon&r=PG&f=1", "display_name": "cdevman", "link": "https://stackoverflow.com/users/7842632/cdevman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 556, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524394831, "creation_date": 1524394831, "question_id": 49965175, "link": "https://stackoverflow.com/questions/49965175/how-to-parse-each-hcl-dictionary-item-by-golang", "title": "How to parse each HCL dictionary item by golang?", "body": "<p>I have tried to parse HCL config using <code>golang</code>, but it's not working.</p>\n\n<pre><code>type cfg_dict struct {\n      name     string       `hcl:\",key\"`\n      type     string       `hcl:\"type\"`\n}\n\ntype hcl_config struct {\n      config_items    cfg_dict      `hcl:\"config\"`\n}\n\nfunc main() {\n    hcl_example = `config \"cfg1\" {\n           type = \"string\"\n    }`\n\n    hcl_opts := &amp;hcl_config{}\n\n    hcl_tree, err := hcl.Parse(hcl_example)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    if err := hcl.DecodeObject(&amp;hcl_opts, hcl_tree); err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    fmt.Println(hcl_opts)\n}\n</code></pre>\n\n<p>When I tried to run this test code after built, it shows empty value.</p>\n\n<pre><code>&amp;{[]}\n</code></pre>\n\n<p>Is there any problem what I have to fix?</p>\n"}, {"tags": ["go", "cryptography", "aes"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 5, "creation_date": 1524417219, "post_id": 49964673, "comment_id": 86952975, "body": "Neither the downvotes nor the close votes make sense. This is a very good question and well explained. And now that it&#39;s been raised, I have to wonder what on earth the Go standard library is doing to keep key material secure."}, {"owner": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 3, "creation_date": 1524567123, "post_id": 49964673, "comment_id": 87015541, "body": "@MichaelHampton Although I did not vote to close the question, there <i>are</i> issues in the question worthy of negative feedback. Notably, there is a mention of an attempt to a solution, but no code to let us understand how that attempt was concretely made. Moreover, the question should not ask for library recommendations."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 20746, "user_id": 1233251, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/cI9GF.png?s=128&g=1", "display_name": "E_net4 says don&#39;t copy that", "link": "https://stackoverflow.com/users/1233251/e-net4-says-dont-copy-that"}, "edited": false, "score": 0, "creation_date": 1524746502, "post_id": 49964673, "comment_id": 87102479, "body": "@E_net4 Removed part of asking for libraries. I guess explaining how to use memguard to protect the key would expand the question needlessly. Cast the last re-open vote and voted question up as the main question is certainly something that should be answered. Happy to upvote any other answers from Go developers! Off topic: wow, a +4 / -4 ; you don&#39;t see that happening all too often!"}], "answers": [{"tags": [], "owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "is_accepted": false, "score": 1, "last_activity_date": 1524746382, "last_edit_date": 1524746382, "creation_date": 1524492690, "answer_id": 49983308, "question_id": 49964673, "link": "https://stackoverflow.com/questions/49964673/security-concern-using-aes-encryption-in-golang/49983308#49983308", "title": "Security concern using AES encryption in golang", "body": "<p>It looks to me that it is simply garbage collected and that no attempt is made to destroy the key material otherwise.</p>\n\n<p>The <a href=\"https://golang.org/src/crypto/aes/cipher.go?s=688:736#L44\" rel=\"nofollow noreferrer\">source</a> simply shows that the subkeys are derived and then returned in a pointer to a struct. It doesn't seem that there are any methods defined to destroy the expanded key material.</p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 2367715, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/fc4cddf922be9b80e1b108e90dfaa171?s=128&d=identicon&r=PG", "display_name": "Anit Gandhi", "link": "https://stackoverflow.com/users/2367715/anit-gandhi"}, "is_accepted": false, "score": 2, "last_activity_date": 1525562342, "creation_date": 1525562342, "answer_id": 50194870, "question_id": 49964673, "link": "https://stackoverflow.com/questions/49964673/security-concern-using-aes-encryption-in-golang/50194870#50194870", "title": "Security concern using AES encryption in golang", "body": "<p>memguard is the right library for this tool, but it has to be manually dropped into the AES code by replacing the calls to <code>make([]byte)</code> with calls to <code>memguard.New...</code></p>\n\n<p>By changing the encryption/decryption expanded key schedules to memguard <code>LockedBuffer</code>s, you can control where they live in memory. Further, after the use of the AES block is completed, you can then destroy the underlying <code>LockedBuffer</code>s</p>\n\n<p>I was working on the same problem, and I believe I've solved it here: <a href=\"https://github.com/anitgandhi/aesguard\" rel=\"nofollow noreferrer\">https://github.com/anitgandhi/aesguard</a></p>\n"}], "owner": {"reputation": 79, "user_id": 5713810, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PW3zhr878pc/AAAAAAAAAAI/AAAAAAAABxg/kB9ilrzsujw/photo.jpg?sz=128", "display_name": "mmelamud", "link": "https://stackoverflow.com/users/5713810/mmelamud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1525562342, "creation_date": 1524391042, "last_edit_date": 1524746243, "question_id": 49964673, "link": "https://stackoverflow.com/questions/49964673/security-concern-using-aes-encryption-in-golang", "title": "Security concern using AES encryption in golang", "body": "<p>I want to use the AES implementation in the standard library of crypto in GO.</p>\n\n<p>But as far as I know, I don't have any control where the expanded key is stored and when it is freed, so this can cause a security problem.</p>\n\n<p>I wanted to use memguard (<a href=\"https://github.com/awnumar/memguard\" rel=\"nofollow noreferrer\">https://github.com/awnumar/memguard</a>) library to secure the key, but I don't have any access to the key after it is expanded.</p>\n\n<p>Any ideas how can I store and manage the key securely?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 0, "creation_date": 1571026710, "post_id": 49964941, "comment_id": 103089869, "body": "In <a href=\"https://youtu.be/LSzR0VEraWw?t=1100\" rel=\"nofollow noreferrer\">this video</a> (linked at relevant timestamp), he creates an http server which gets <code>r.Context()</code> from the request, and then <code>select</code>s on <code>ctx.Done()</code>.  He runs the server in one terminal, a client in another, and the <code>ctrl-C</code>&#39;s the client before the request finishes.  The server detects this even in <code>ctx.Done()</code>.  How is this happening?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 0, "creation_date": 1571049751, "post_id": 49964941, "comment_id": 103099136, "body": "@Jonah When you press <code>ctrl+c</code> on the client, that terminates the connection to the server, and when the server detects the closed connection, cancels the request&#39;s context which means its <code>done</code> channel will be closed, and so any handler that &quot;listens&quot; on the context&#39;s <code>done</code> channel will also be notified and can return early from the handler function."}, {"owner": {"reputation": 14450, "user_id": 438615, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Dseeq.jpg?s=128&g=1", "display_name": "Jonah", "link": "https://stackoverflow.com/users/438615/jonah"}, "edited": false, "score": 0, "creation_date": 1571051574, "post_id": 49964941, "comment_id": 103100088, "body": "Thanks.  I figured it was something like that but after exploring the source of the http package I was unable to find where the code was that implemented that feature"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1524393407, "last_edit_date": 1524393407, "creation_date": 1524393024, "answer_id": 49964941, "question_id": 49964220, "link": "https://stackoverflow.com/questions/49964220/carrying-deadlines-and-cancelation-signals-across-processes/49964941#49964941", "title": "Carrying deadlines and cancelation signals across processes", "body": "<p>Sorry to break your enthusiasm, but the <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\"><code>context</code></a> package cannot be used as-is for inter-process communication and signaling.</p>\n\n<p>The wording here may be a little imperfect, as in the \"context\" of the <code>context</code> package documentation most people would think of <em>\"processes\"</em> as an <a href=\"https://en.wikipedia.org/wiki/Process_(computing)\" rel=\"nofollow noreferrer\">OS process</a> entity. But the word \"process\" has multiple meanings, and the more general <em>\"a set of activities that interact to achieve a result\"</em> meaning is used here (from <a href=\"https://en.wikipedia.org/wiki/Process\" rel=\"nofollow noreferrer\">Wikipedia: Process</a>). To avoid ambiguity, <em>\"goroutines\"</em> or <em>\"a set of goroutines\"</em> would be more appropriate here, but within the <em>same</em> Go application.</p>\n\n<p>Note that when the <code>context</code> package was first published as a separate, experimental package (not as part of the standard library), this blog post explained its background and uses: <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">Go Concurrency Patterns: Context</a>. The <code>context</code> haven't change since it was integrated into the standard library, and that blog post did not mention the word \"process\", not even once.</p>\n"}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 49964941, "answer_count": 1, "score": 3, "last_activity_date": 1529352155, "creation_date": 1524387372, "last_edit_date": 1529352155, "question_id": 49964220, "link": "https://stackoverflow.com/questions/49964220/carrying-deadlines-and-cancelation-signals-across-processes", "title": "Carrying deadlines and cancelation signals across processes", "body": "<p>The golang <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">context</a> documentation says :</p>\n\n<blockquote>\n  <p>Package context defines the Context type, which carries deadlines, \n    cancelation signals, and other request-scoped values across API boundaries \n    and between processes. </p>\n</blockquote>\n\n<p>I also read concrete <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">examples</a> of context, but I don't see any information on <code>carring deadlines and cancellation signals</code> across <strong>processes</strong>.</p>\n\n<p>How does signals work across processes? </p>\n\n<p>Are they reliable like, if service1 sends a cancel signal but it dies, and signal is lost, what happens now?</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1524381462, "post_id": 49963498, "comment_id": 86943012, "body": "On which operating system, and which implementation and version of Go? Details matter a lot, so please <b>edit your question</b> to give more of them (and motivation and context)."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1524381534, "post_id": 49963498, "comment_id": 86943037, "body": "BTW, on most OSes, a Go process consumes <a href=\"https://en.wikipedia.org/wiki/Virtual_memory\" rel=\"nofollow noreferrer\">virtual memory</a> (in its virtual address space), not RAM. The RAM proper is managed by the OS kernel, not by the Go program or runtime. Also, it could be the case that releasing memory too early would decrease performance"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 7, "last_activity_date": 1572257547, "last_edit_date": 1572257547, "creation_date": 1524381879, "answer_id": 49963553, "question_id": 49963498, "link": "https://stackoverflow.com/questions/49963498/gos-garbage-collector-isnt-releasing-memory-at-the-right-time/49963553#49963553", "title": "Go&#39;s Garbage collector isn&#39;t releasing memory at the right time", "body": "<p>You might want to call <a href=\"https://golang.org/pkg/runtime/debug/#FreeOSMemory\" rel=\"nofollow noreferrer\">FreeOSMemory</a> from <code>runtime/debug</code></p>\n\n<p>But you probably should not. Try instead to tune the GC for your particular application and usage (perhaps using <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" rel=\"nofollow noreferrer\">SetGCPercent</a>). It is likely that using <code>FreeOSMemory</code> too often would <em>decrease</em> performance, so be sure to benchmark.</p>\n\n<p><sup>Notice that the garbage collection implementation has improved in recent versions of Go, and is different in various Go implementations (e.g. in <a href=\"https://gcc.gnu.org/onlinedocs/gccgo/\" rel=\"nofollow noreferrer\">GCC Go</a>).</sup></p>\n\n<p>Don't confuse RAM usage (the <a href=\"https://en.wikipedia.org/wiki/Random-access_memory\" rel=\"nofollow noreferrer\">RAM</a> is managed by your OS kernel, not by your Go process), <a href=\"https://en.wikipedia.org/wiki/Virtual_memory\" rel=\"nofollow noreferrer\">virtual memory</a>, <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow noreferrer\">virtual address space</a>. Read about <a href=\"https://en.wikipedia.org/wiki/Resident_set_size\" rel=\"nofollow noreferrer\">RSS</a>, <a href=\"https://en.wikipedia.org/wiki/Demand_paging\" rel=\"nofollow noreferrer\">demand paging</a>, <a href=\"https://en.wikipedia.org/wiki/Thrashing_(computer_science)\" rel=\"nofollow noreferrer\">thrashing</a>.</p>\n\n<p>For an overview of garbage collection techniques, read <a href=\"http://gchandbook.org/\" rel=\"nofollow noreferrer\"><em>The GC Handbook</em></a>.</p>\n\n<p>For a better understanding of OSes, read <a href=\"http://pages.cs.wisc.edu/~remzi/OSTEP/\" rel=\"nofollow noreferrer\"><em>Operating Systems: Three Easy Pieces</em></a></p>\n\n<p>See also <a href=\"https://www.linuxatemyram.com/\" rel=\"nofollow noreferrer\">Linux ate my RAM</a>.</p>\n"}], "owner": {"reputation": 9, "user_id": 8479136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d57340d7af5494008663f27c7534e2e?s=128&d=identicon&r=PG&f=1", "display_name": "hadi2f244", "link": "https://stackoverflow.com/users/8479136/hadi2f244"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3187, "favorite_count": 2, "closed_date": 1524389689, "answer_count": 1, "score": 0, "last_activity_date": 1572257547, "creation_date": 1524381321, "question_id": 49963498, "link": "https://stackoverflow.com/questions/49963498/gos-garbage-collector-isnt-releasing-memory-at-the-right-time", "closed_reason": "Duplicate", "title": "Go&#39;s Garbage collector isn&#39;t releasing memory at the right time", "body": "<p>I wrote a simple http golang webserver to test the Go garbage collection (releasing memory of inaccessible pointers), But in strees testing ,I understand it consumes excessive ram.</p>\n\n<p>According to some <a href=\"https://stackoverflow.com/questions/24376817/go-1-3-garbage-collector-not-releasing-server-memory-back-to-system\">question/answers</a>, I found out Golang does garbage collection automatically, manage the extra memory itself and doesn't get back memory to OS at once. Some results:</p>\n\n<ul>\n<li><p>The webserver release ram after about 5mins.</p></li>\n<li><p>The webserver consumes ram until it gets up to specific level and requesting more connections not gets more memory(about 4GB in my case)</p></li>\n</ul>\n\n<p>Consuming 4GB of ram isn't cool! So i added a Goroutine to my code that gets the extra memory back to OS. </p>\n\n<p>The code:</p>\n\n<pre><code>type t struct{\n    a       []string\n    b       map[string]string\n}\nvar x t = t{\n    a:  []string{\"1\",\"2\"},\n    b:  make(map[string]string),\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    x := &amp;t{}\n    fmt.Fprintf(w, \"pong\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/ping\", handler)\n    go func(){\n        for {\n            time.Sleep(10 * time.Second)\n            fmt.Println(\"Free up memory...\")\n            debug.FreeOSMemory() \n        }\n\n    }()\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>For stress testing i use <a href=\"https://httpd.apache.org/docs/2.4/programs/ab.html\" rel=\"nofollow noreferrer\">Apache Bench</a>:</p>\n\n<pre><code>ab -c 100 -n 400000 http://127.0.0.1:8080/ping\n</code></pre>\n\n<p>I ran above command about 10 times continuously to check the ram usage. \nIt works very well, But the problem is, Is there any standard way that Go releases the memory better!? </p>\n\n<p>I know in some cases, it's good that Go manages the memory itself instead of repetitive releasing and getting back memory from OS, But in my case, 5 minutes delay is very much to releasing memory.</p>\n"}, {"tags": ["ssl", "go", "https"], "answers": [{"comments": [{"owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "edited": false, "score": 0, "creation_date": 1524379541, "post_id": 49963286, "comment_id": 86942497, "body": "Then how come if I type in &quot;example.com&quot; for well known sites, Chrome displays the green &quot;Secure&quot; logo because of the HTTPS redirect? What exactly is secured if the only request I made was over an insecure HTTP connection?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "edited": false, "score": 1, "creation_date": 1524399451, "post_id": 49963286, "comment_id": 86947346, "body": "@rampatowl, see also <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\" rel=\"nofollow noreferrer\">HSTS</a>, the Preload section in particular. This can prevent the redirect from happening in the first place."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1524380025, "last_edit_date": 1524380025, "creation_date": 1524379392, "answer_id": 49963286, "question_id": 49963265, "link": "https://stackoverflow.com/questions/49963265/does-redirect-from-http-to-https-have-encryption/49963286#49963286", "title": "Does redirect from HTTP to HTTPS have encryption?", "body": "<p>A POST request to an HTTP server is not secure. This includes the case where the server responds to the POST with a redirect to an HTTPS server. </p>\n\n<p>Browsers automatically follow redirects. The request to the HTTPS server is secure. </p>\n"}], "owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 49963286, "answer_count": 1, "score": -1, "last_activity_date": 1524380025, "creation_date": 1524379207, "question_id": 49963265, "link": "https://stackoverflow.com/questions/49963265/does-redirect-from-http-to-https-have-encryption", "title": "Does redirect from HTTP to HTTPS have encryption?", "body": "<p>I have an HTTPS server in Go, so that users can enter <a href=\"https://example.com\" rel=\"nofollow noreferrer\">https://example.com</a> in their browser. I'd like them to also be able to type in \"example.com\" to reach my HTTPS server. From <a href=\"https://stackoverflow.com/questions/37536006/how-do-i-rewrite-redirect-from-http-to-https-in-go\">this answer</a> I see that the standard solution is to run an HTTP server that redirects to <a href=\"https://example.com\" rel=\"nofollow noreferrer\">https://example.com</a>.</p>\n\n<p>I'm wondering if this is as secure as if everything were in HTTPS. In particular, if a user sends a POST request to \"example.com\", will the content be encrypted while it passes through the network?</p>\n"}, {"tags": ["json", "go", "enums", "protocol-buffers", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "edited": false, "score": 0, "creation_date": 1524474596, "post_id": 49962937, "comment_id": 86970546, "body": "<code>gogo</code> was not required for my specific problem. Thanks for the refer, it might help with other issues"}, {"owner": {"reputation": 572, "user_id": 2047138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6705951d37d1fdb4f62215934fdf8a1?s=128&d=identicon&r=PG", "display_name": "rubens21", "link": "https://stackoverflow.com/users/2047138/rubens21"}, "edited": false, "score": 0, "creation_date": 1573403329, "post_id": 49962937, "comment_id": 103862960, "body": "The current golang protobuf lib (v1.3) is already replacing the enum values by string.  However, to make the default value visible, you must set the Marshaler &#39;EmitDefaults&#39; option to true:  jsonpb.Marshaler{ \t\tEmitDefaults: true, \t}"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 3, "last_activity_date": 1524376106, "creation_date": 1524376106, "answer_id": 49962937, "question_id": 49962893, "link": "https://stackoverflow.com/questions/49962893/converting-protobuf3-with-enum-to-json-in-go/49962937#49962937", "title": "Converting Protobuf3 with enum to JSON in Go", "body": "<p>Level is not a string though, it is an emum.  There are really only two choices I see.</p>\n\n<ol>\n<li>Write a custom marshaller that does this for you</li>\n<li>Generate code that does this for you.</li>\n</ol>\n\n<p>For #2, gogoprotobuf has an extension (still marked as experimental) that let's you do exactly this:</p>\n\n<p><a href=\"https://godoc.org/github.com/gogo/protobuf/plugin/enumstringer\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gogo/protobuf/plugin/enumstringer</a> and\n<a href=\"https://github.com/gogo/protobuf/blob/master/extensions.md\" rel=\"nofollow noreferrer\">https://github.com/gogo/protobuf/blob/master/extensions.md</a></p>\n"}, {"tags": [], "owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "is_accepted": false, "score": 9, "last_activity_date": 1524474252, "creation_date": 1524474252, "answer_id": 49977134, "question_id": 49962893, "link": "https://stackoverflow.com/questions/49962893/converting-protobuf3-with-enum-to-json-in-go/49977134#49977134", "title": "Converting Protobuf3 with enum to JSON in Go", "body": "<p>I found out that I should use the <code>protobuf/jsonpb</code> package and not the standard <code>json</code> package.</p>\n\n<p>so:</p>\n\n<pre><code>j, _ := json.MarshalIndent(protoMessage, \"\", \"\\t\")\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>m := jsonpb.Marshaler{}\nresult, _ := m.MarshalToString(protoMessage)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 156, "user_id": 1021322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc9db084544fe27e9785c303ee817f9?s=128&d=identicon&r=PG", "display_name": "wthrain", "link": "https://stackoverflow.com/users/1021322/wthrain"}, "is_accepted": false, "score": 0, "last_activity_date": 1604039283, "creation_date": 1604039283, "answer_id": 64603620, "question_id": 49962893, "link": "https://stackoverflow.com/questions/49962893/converting-protobuf3-with-enum-to-json-in-go/64603620#64603620", "title": "Converting Protobuf3 with enum to JSON in Go", "body": "<p>When it comes to serialize the json object, this would be helpful.</p>\n<pre><code>var msg bytes.Buffer\nm := jsonpb.Marshaler{}\nerr := m.Marshal(&amp;msg, event)\n</code></pre>\n<p><code>msg.Bytes()</code> converts <code>msg</code> to byte stream.</p>\n"}], "owner": {"reputation": 6283, "user_id": 434792, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/11d0482f7d0ebdbe1d42c81f7817db5d?s=128&d=identicon&r=PG", "display_name": "michaelbn", "link": "https://stackoverflow.com/users/434792/michaelbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8504, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1604039283, "creation_date": 1524375701, "last_edit_date": 1524376048, "question_id": 49962893, "link": "https://stackoverflow.com/questions/49962893/converting-protobuf3-with-enum-to-json-in-go", "title": "Converting Protobuf3 with enum to JSON in Go", "body": "<p>How can I convert <code>grpc</code>/<code>protobuf3</code> message to <code>JSON</code> where the <code>enum</code> is represented as <code>string</code>?</p>\n\n<p>For example, the <code>protobuf</code> message:</p>\n\n<pre><code>enum Level {\n    WARNING = 0;\n    FATAL = 1;\n    SEVERE = 2;\n    ...\n}\n\nmessage Http {\n    string message = 1;\n    Level level = 2;\n}\n</code></pre>\n\n<p>Is converted by:</p>\n\n<pre><code>j, _ := json.MarshalIndent(protoMessage, \"\", \"\\t\")\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>{\n    \"message\": \"Hello world!\",\n    \"level\": 2,\n}\n</code></pre>\n\n<p>I wish to get:</p>\n\n<pre><code>{\n    \"message\": \"Hello world!\",\n    \"level\": \"SEVERE\",\n}\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "smtp"], "comments": [{"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524376533, "post_id": 49962763, "comment_id": 86941915, "body": "You have already read the welcome message. Why are you doing this? Do you intend to send mail, or do something else?"}, {"owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524377665, "post_id": 49962763, "comment_id": 86942145, "body": "@MichaelHampton  i need to check if server is Haraka or something else"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 1, "creation_date": 1524377970, "post_id": 49962763, "comment_id": 86942213, "body": "Then why do you call <code>smtp.NewClient()</code>?"}, {"owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1524379483, "post_id": 49962763, "comment_id": 86942487, "body": "@MichaelHampton if the server is diferent to <code>Haraka</code>, in this case i send email."}], "answers": [{"comments": [{"owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "edited": false, "score": 0, "creation_date": 1524395467, "post_id": 49963867, "comment_id": 86946326, "body": "thanks for your help, i try to use your code : not print welcome message and die in timeout : <a href=\"https://play.golang.org/p/amy8NdSIsu6\" rel=\"nofollow noreferrer\">play.golang.org/p/amy8NdSIsu6</a>"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "edited": false, "score": 0, "creation_date": 1524417440, "post_id": 49963867, "comment_id": 86953048, "body": "@kingcope That code does not contain any evidence that you modified it in accordance with this answer. Please do so first."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 1, "last_activity_date": 1524384723, "creation_date": 1524384723, "answer_id": 49963867, "question_id": 49962763, "link": "https://stackoverflow.com/questions/49962763/smtp-connection-read-welcome-message/49963867#49963867", "title": "SMTP connection read welcome message", "body": "<p>An inspection of the standard library source indicates that <code>smtp.NewClient()</code> reads the SMTP banner from the remote host and throws it away.</p>\n\n<pre><code>func NewClient(conn net.Conn, host string) (*Client, error) {\n    text := textproto.NewConn(conn)\n    _, _, err := text.ReadResponse(220)\n    if err != nil {\n        text.Close()\n        return nil, err\n    }\n    c := &amp;Client{Text: text, conn: conn, serverName: host, localName: \"localhost\"}\n    _, c.tls = conn.(*tls.Conn)\n    return c, nil\n}\n</code></pre>\n\n<p>You want to read this banner and decide whether to send mail based on its contents.</p>\n\n<p>Since you have already read the banner yourself, and presumably will make a decision on that, instead of calling <code>smtp.NewClient()</code> you should then implement the rest of <code>NewClient()</code> in your own code, possibly something like this:</p>\n\n<pre><code>    client := &amp;smtp.Client{Text: text, conn: conn, serverName: host, localName: \"localhost\"}\n    _, client.tls = conn.(*tls.Conn)\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524484279, "creation_date": 1524374509, "last_edit_date": 1524484279, "question_id": 49962763, "link": "https://stackoverflow.com/questions/49962763/smtp-connection-read-welcome-message", "title": "SMTP connection read welcome message", "body": "<p>I try to connect on smtp server and read welcome message. This is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"time\"\n    \"net/smtp\"\n    \"bufio\"\n)\n\nfunc main() {\n    // attempt a connection\n    conn, _ := net.DialTimeout(\"tcp\", \"88.198.24.108:25\", 15 * time.Second)\n\n    buf := bufio.NewReader(conn)\n    bytes, _ := buf.ReadBytes('\\n')\n    fmt.Printf(\"%s\", bytes)\n\n\n    client, err := smtp.NewClient(conn, \"88.198.24.108\")\n    if err != nil {\n        fmt.Println(\"1&gt;&gt;\", err)\n        return\n    }\n\n    client.Quit()\n    conn.Close()\n}\n</code></pre>\n\n<p>Problem is after read welcome message stop running and wait to go in timeout, I want to read/print welcome message and continue.</p>\n\n<pre><code>220 example.me ESMTP Haraka/2.8.18 ready\n1&gt;&gt; 421 timeout\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1524375342, "creation_date": 1524375342, "answer_id": 49962853, "question_id": 49962698, "link": "https://stackoverflow.com/questions/49962698/how-golangs-typecast-to-interface-implemented-by-a-struct-and-embedded-struct-w/49962853#49962853", "title": "How GoLang&#39;s typecast to interface implemented by a struct and embedded struct works", "body": "<p>The additional methods missing from Vodka, but present on BarStocks are implemented for BaseAttributes and if the method is missing from Vodka, the method from the embedded strut will be called instead. </p>\n\n<p>Note, methods in an embedded struct will not have access to the parent struct members.  Also note, if you wanted to call the embedded struct's method when it has been defined in the parent (as GetVodka is for Vodka) then you would prepend the embedded type's name to the method.  For example</p>\n\n<pre><code>myDrink := someFunc()\nmyDrink.BaseAttributes.GetVodka()\n</code></pre>\n\n<p>This is obviously not helpful in this case as all of the BaseAttribute methods return nil, but may be helpful in the future.</p>\n"}, {"comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 1, "creation_date": 1524375625, "post_id": 49962866, "comment_id": 86941741, "body": "Well done.  It is always best to get it right from the spec."}], "tags": [], "owner": {"reputation": 3183, "user_id": 216345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ffc76b5c6c4607d55b0796da63d67f0?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/216345/thomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1524375495, "creation_date": 1524375495, "answer_id": 49962866, "question_id": 49962698, "link": "https://stackoverflow.com/questions/49962698/how-golangs-typecast-to-interface-implemented-by-a-struct-and-embedded-struct-w/49962866#49962866", "title": "How GoLang&#39;s typecast to interface implemented by a struct and embedded struct works", "body": "<p>I'll do my best to answer the question I think you're asking.</p>\n\n<p>The <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">documentation</a> on embedding explains the behavior you're seeing,</p>\n\n<blockquote>\n  <p>There's an important way in which embedding differs from subclassing.\n  When we embed a type, the methods of that type become methods of the\n  outer type, but when they are invoked the receiver of the method is\n  the inner type, not the outer one.</p>\n</blockquote>\n\n<p>This explains how a <code>Vodka</code> struct, which embeds struct <code>BaseAttributes</code> which implements all of the methods in <code>BarStocks</code> is able to satisfy the interface <code>Barstocks</code>. This excerpt, however, does not explain how we effectively override <code>GetVodka()</code> for our <code>Vodka</code> struct.</p>\n\n<p>To understand this we need to read another excerpt from the documentation.</p>\n\n<blockquote>\n  <p>Embedding types introduces the problem of name conflicts but the rules\n  to resolve them are simple. First, a field or method X hides any other\n  item X in a more deeply nested part of the type.</p>\n</blockquote>\n\n<p>This excerpt explains that If <code>Vodka</code> implements <code>GetVodka()</code> and embeds a struct (<code>BaseAttributes)</code> which also implements <code>GetVodka()</code>, the outer-most definition is the one that takes precedence.</p>\n\n<p>The combination of these behaviors explain how <code>Vodka</code> satisfies the <code>BarStocks</code> interface and has the behavior you see in the example code.</p>\n"}], "owner": {"reputation": 453, "user_id": 1242876, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a02eba64c5df7c418e1b1386a59873f8?s=128&d=identicon&r=PG", "display_name": "Humming", "link": "https://stackoverflow.com/users/1242876/humming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 49962866, "answer_count": 2, "score": 0, "last_activity_date": 1524375495, "creation_date": 1524373853, "question_id": 49962698, "link": "https://stackoverflow.com/questions/49962698/how-golangs-typecast-to-interface-implemented-by-a-struct-and-embedded-struct-w", "title": "How GoLang&#39;s typecast to interface implemented by a struct and embedded struct works", "body": "<p>I recently came across a code that is doing something I don't understand.</p>\n\n<p>There are multiple structs having the same embedded struct and an interface that defines methods returning pointer to each struct. This interface is implemented by the embedded struct but only 'partially' by the individual structs, as such, each struct only implements the method where the pointer to that struct is returned.</p>\n\n<p>For better understanding, here is the representative code:</p>\n\n<pre><code>type BarStocks interface {\n    GetVodka() *Vodka\n    GetMartini() *Martini\n    GetBourbon() *Bourbon\n    GetNegroni() *Negroni\n    GetManhattan() *Manhattan\n}\n\ntype BaseAttributes struct {\n    ID        uuid.UUID\n    Quantity float64\n    CreatedAt time.Time\n    UpdatedAt time.Time\n}\n\nfunc (e *BaseAttributes) GetVodka() *Vodka {\n    return nil\n}\n\nfunc (e *BaseAttributes) GetMartini() *Martini {\n    return nil\n}\n\nfunc (e *BaseAttributes) GetBourbon() *Bourbon {\n    return nil\n}\n\nfunc (e *BaseAttributes) GetNegroni() *Negroni {\n    return nil\n}\n\nfunc (e *BaseAttributes) GetManhattan() *Manhattan {\n    return nil\n}\n</code></pre>\n\n<p>And then each individual struct implements only the method where its pointer is returned, for example:</p>\n\n<pre><code>type Vodka struct {\n    BaseAttributes\n\n    Label string\n}\n\nfunc (v *Vodka) GetVodka() *Vodka {\n    return v\n}\n</code></pre>\n\n<p>Now in the code, this setup is used to typecast the individual struct to the interface as a pointer, something like this:</p>\n\n<pre><code>func someFunc() BarStocks {\n    v := Vodka{}\n    return &amp;v\n}\n</code></pre>\n\n<p>Now I am not too deep into Go yet and so unable to comprehend how the pointer to the struct becomes the same type as the interface.</p>\n\n<p>Thanks in advance for any insight into this.</p>\n"}, {"tags": ["go", "centos", "exim", "gomail"], "comments": [{"owner": {"reputation": 4567, "user_id": 1318734, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/S3JJ2.gif?s=128&g=1", "display_name": "rofls", "link": "https://stackoverflow.com/users/1318734/rofls"}, "edited": false, "score": 1, "creation_date": 1524368989, "post_id": 49962086, "comment_id": 86940751, "body": "Why do you need the <code>-t</code> flag, why not simply remove it?"}], "answers": [{"comments": [{"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524457597, "post_id": 49963903, "comment_id": 86962668, "body": "I&#39;m not receiving any mail to bcc email addresses maybe problem is in golang code"}, {"owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "edited": false, "score": 0, "creation_date": 1524462594, "post_id": 49963903, "comment_id": 86964178, "body": "Yes the problem is in go code <code>_, errs[0] = m.WriteTo(pw)</code> is not sending bcc to exim"}], "tags": [], "owner": {"reputation": 9961, "user_id": 2139766, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/b3qcA.png?s=128&g=1", "display_name": "AnFi", "link": "https://stackoverflow.com/users/2139766/anfi"}, "is_accepted": true, "score": 2, "last_activity_date": 1524385017, "creation_date": 1524385017, "answer_id": 49963903, "question_id": 49962086, "link": "https://stackoverflow.com/questions/49962086/how-to-send-bcc-email-via-exim-t-sendmail-look-alike-mode/49963903#49963903", "title": "How to send bcc email via `exim -t`? [&quot;sendmail look alike&quot; mode]", "body": "<p>\"Sendmail look alike\" mode with<code>-t</code> removes <code>Bcc:</code> headers <strong>after processing them</strong>.<br>\nIn <code>-t</code> mode <code>Bcc:</code> headers content will be appended to the (SMTP) recipients list <strong>BUT</strong> recipients will not see/receive <code>Bcc:</code> headers.</p>\n\n<p><em>Style guide suggestion:</em> <strong>IF</strong> you use another SMTP/MTA soft (e.g. Exim) in \"sendmail look alike\" (command line comparability mode) <strong>THEN</strong> use sendmail program/binary provided by them.<br>\n<code>const sendmail = \"/usr/sbin/sendmail\"</code></p>\n"}], "owner": {"reputation": 1222, "user_id": 5806017, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/TXRib.jpg?s=128&g=1", "display_name": "Garvit Jain", "link": "https://stackoverflow.com/users/5806017/garvit-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 49963903, "answer_count": 1, "score": 0, "last_activity_date": 1524417326, "creation_date": 1524366012, "last_edit_date": 1524417326, "question_id": 49962086, "link": "https://stackoverflow.com/questions/49962086/how-to-send-bcc-email-via-exim-t-sendmail-look-alike-mode", "title": "How to send bcc email via `exim -t`? [&quot;sendmail look alike&quot; mode]", "body": "<p>I'm using golang to send email with exim via following method</p>\n\n<pre><code>const sendmail = \"/usr/sbin/exim\"\n\nfunc submitMail(m *gomail.Message) (err error) {\n    cmd := exec.Command(sendmail, \"-t\")\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n\n    pw, err := cmd.StdinPipe()\n    if err != nil {\n        return\n    }\n\n    err = cmd.Start()\n    if err != nil {\n        return\n    }\n\n    var errs [3]error\n    _, errs[0] = m.WriteTo(pw)\n    errs[1] = pw.Close()\n    errs[2] = cmd.Wait()\n    for _, err = range errs {\n        if err != nil {\n            return\n        }\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/35521846/5806017\">as Answered on here</a></p>\n\n<p>The problem is that Exim removes Bcc with <i>-t</i></p>\n\n<blockquote>\n  <p>If Exim is called with the -t option, to take recipient addresses from\n  a message's headers, it removes any Bcc: header that may exist (after\n  extracting its addresses), unless the message has no To: or Cc:\n  header, in which case a Bcc: header with no addresses is left in the\n  message, in accordance with RFC 822. If -t is not present on the\n  command line, any existing Bcc: header is not removed.</p>\n  \n  <p>If Exim is called to receive a message with the recipient addresses\n  given on the command line, and there is no Bcc:, To:, or Cc: header in\n  the message, it normally adds a To: header, listing the recipients.\n  Some mailing list software is known to submit messages in this way,\n  and in this case the creation of a To: header is not what is wanted.\n  If the always_bcc option is set, Exim adds an empty Bcc: header\n  instead in this circumstance.</p>\n</blockquote>\n\n<p><a href=\"http://www.exim.org/exim-html-3.20/doc/html/spec_49.html#SEC832\" rel=\"nofollow noreferrer\">found in Spec here</a></p>\n"}, {"tags": ["go", "azure-active-directory", "microsoft-graph-api", "azure-ad-graph-api"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 6483630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/htnzN.jpg?s=128&g=1", "display_name": "Dan Mayor", "link": "https://stackoverflow.com/users/6483630/dan-mayor"}, "edited": false, "score": 0, "creation_date": 1524487781, "post_id": 49964277, "comment_id": 86979143, "body": "Thanks for the response, the resource owner grant flow is exactly what I&#39;m looking for. I am looking to use AD as my own sites user / permission store, I&#39;m not looking to allow users to authenticate outside of my tenant (and it&#39;s just a blog site, MFA isn&#39;t necessary)."}, {"owner": {"reputation": 10885, "user_id": 325697, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ea733005a1c705bedc99eade18f4457d?s=128&d=identicon&r=PG", "display_name": "Philippe Signoret", "link": "https://stackoverflow.com/users/325697/philippe-signoret"}, "edited": false, "score": 2, "creation_date": 1524490448, "post_id": 49964277, "comment_id": 86981061, "body": "Using the Resource Owner Password Credential flow is highly discouraged, and for your scenario it is simply not supported. Even if it&#39;s &quot;just a blog site&quot; you should not do this. Most blog platforms (e.g. WordPress) can be easily integrated for sign-in with Azure AD."}, {"owner": {"reputation": 40761, "user_id": 1658906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4748ed2fb97e8a8d4dd6d439625135?s=128&d=identicon&r=PG", "display_name": "juunas", "link": "https://stackoverflow.com/users/1658906/juunas"}, "edited": false, "score": 1, "creation_date": 1524490786, "post_id": 49964277, "comment_id": 86981315, "body": "I don&#39;t recommend its use either. Main possible use case is &quot;service accounts&quot; when app-only access is not a good option/impossible"}, {"owner": {"reputation": 65, "user_id": 6483630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/htnzN.jpg?s=128&g=1", "display_name": "Dan Mayor", "link": "https://stackoverflow.com/users/6483630/dan-mayor"}, "edited": false, "score": 0, "creation_date": 1524574275, "post_id": 49964277, "comment_id": 87020387, "body": "From what I read, it&#39;s discouraged because my site would be collecting username and password. Which I would understand if I was asking end users to sign in with their existing Microsoft accounts, but this is not the case. I am looking to use Azure AD programmatically as my user / permission store. Where in I will be creating these accounts from code when the user submits registration (I will know the password) then authenticating them against that same username &amp; password. The alternative which I am likely doing is creating my own user account store. Why else would it be discouraged?"}, {"owner": {"reputation": 40761, "user_id": 1658906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4748ed2fb97e8a8d4dd6d439625135?s=128&d=identicon&r=PG", "display_name": "juunas", "link": "https://stackoverflow.com/users/1658906/juunas"}, "edited": false, "score": 0, "creation_date": 1524583050, "post_id": 49964277, "comment_id": 87026927, "body": "That might be a case where it is acceptable. Though in my own blog I still use OpenID Connect Authorization Code flow :)"}, {"owner": {"reputation": 65, "user_id": 6483630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/htnzN.jpg?s=128&g=1", "display_name": "Dan Mayor", "link": "https://stackoverflow.com/users/6483630/dan-mayor"}, "edited": false, "score": 0, "creation_date": 1524611473, "post_id": 49964277, "comment_id": 87040229, "body": "Fair enough, I&#39;m deciding against it at this point anyway but all good knowledge and insight. Thanks!"}], "tags": [], "owner": {"reputation": 40761, "user_id": 1658906, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4e4748ed2fb97e8a8d4dd6d439625135?s=128&d=identicon&r=PG", "display_name": "juunas", "link": "https://stackoverflow.com/users/1658906/juunas"}, "is_accepted": true, "score": 4, "last_activity_date": 1524387867, "creation_date": 1524387867, "answer_id": 49964277, "question_id": 49961487, "link": "https://stackoverflow.com/questions/49961487/validate-user-credentials-against-azure-ad-without-oauth/49964277#49964277", "title": "Validate user credentials against Azure AD without oAuth", "body": "<p>Basically no.\nNo other OAuth/OpenIdConnect identity provider that I am aware of offers this either.\nWhat if the account requires Multi-Factor Authentication?</p>\n\n<p>There is Resource Owner Password Credentials grant flow, but I would recommend not using it, since it does not work for accounts with MFA for instance.\nThat flow allows \"non-interactive\" authentication.\nBut if interaction is needed, it fails.</p>\n\n<p>OAuth/OpenId Connect being \"convoluted\" is a matter of personal opinion.\nCertain things are the way they are to make the process secure.\nThe redirect is necessary because the user is signing in to Office 365, not your app.\nThey should not give their passwords to you.</p>\n\n<p>Seems people have been looking for a MS Graph library for Go: <a href=\"https://github.com/microsoftgraph/MSGraph-SDK-Code-Generator/issues/53\" rel=\"nofollow noreferrer\">https://github.com/microsoftgraph/MSGraph-SDK-Code-Generator/issues/53</a>.\nNo official one exists at the moment though :/</p>\n"}], "owner": {"reputation": 65, "user_id": 6483630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/htnzN.jpg?s=128&g=1", "display_name": "Dan Mayor", "link": "https://stackoverflow.com/users/6483630/dan-mayor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 49964277, "answer_count": 1, "score": 1, "last_activity_date": 1524387867, "creation_date": 1524357887, "question_id": 49961487, "link": "https://stackoverflow.com/questions/49961487/validate-user-credentials-against-azure-ad-without-oauth", "title": "Validate user credentials against Azure AD without oAuth", "body": "<p>I am looking to use Azure AD as my authentication system but do not want to bounce my users out to the Microsoft login page as it is disruptive and the fact that users may or may not have personal and or work accounts seems to make it quite confusing for most.</p>\n\n<p>I have researched this quite a bit over the past few days but only find resources that show me AAD libraries in .NET, Azure Graph and Microsoft Graph API's. All of which seem to be convoluted systems that do the oAuth bounce through the Microsoft sign in window.</p>\n\n<p>I am using Golang, but am an MSCA in .NET. If there are references to source code in .net that do not require proprietary / closed source DLL files I can use that as a starting point, or otherwise, if there is some reference point perhaps that shows how to use the MS Graph API to send username and password (entered on my site) and receive some positive or negative response indicating if the credentials provided match an account in my Azure AD would be great.</p>\n\n<p>For example, I know of using <a href=\"https://msdn.microsoft.com/en-us/library/azure/ad/graph/api/users-operations\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/azure/ad/graph/api/users-operations</a> to create, get, list, update and delete users. But it doesn't seem to have a validate or authorize procedure (unless of course I'm simply missing it).</p>\n\n<p>My question is, is there a way to validate credentials without using oAuth through the Microsoft account sign in? If so can someone provide reference and or a bit of psuedo code to get me going in the right direction? Thanks in advance! </p>\n"}, {"tags": ["linux", "go", "tap", "tun"], "comments": [{"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1583588344, "post_id": 49961464, "comment_id": 107171712, "body": "Why not use libpcap"}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 13023536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47980cf37f3f4e7940d6d1f641cd03be?s=128&d=identicon&r=PG", "display_name": "kmeaw", "link": "https://stackoverflow.com/users/13023536/kmeaw"}, "is_accepted": true, "score": 1, "last_activity_date": 1583585906, "creation_date": 1583585906, "answer_id": 60577764, "question_id": 49961464, "link": "https://stackoverflow.com/questions/49961464/how-to-read-tcp-packets-on-a-tun-tap-interface/60577764#60577764", "title": "How to read TCP packets on a tun/tap interface?", "body": "<p>Your code works for me.\nIf I run it, then I can see TCP packets after I initiate some TCP-related activity.\nFor this instance, I used \"ssh 10.2.0.11\". Here is what I got:</p>\n\n<pre><code>2020/03/07 15:52:23 isTCP: false, header: ver=6 hdrlen=0 tos=0x0 totallen=0 id=0x8 flags=0x1 fragoff=0x1aff ttl=254 proto=128 cksum=0x0 src=0.0.0.0 dst=126.87.58.227\n2020/03/07 15:52:27 isTCP: false, header: ver=6 hdrlen=0 tos=0x0 totallen=0 id=0x8 flags=0x1 fragoff=0x1aff ttl=254 proto=128 cksum=0x0 src=0.0.0.0 dst=126.87.58.227\n2020/03/07 15:52:34 isTCP: false, header: ver=6 hdrlen=0 tos=0x0 totallen=0 id=0x8 flags=0x1 fragoff=0x1aff ttl=254 proto=128 cksum=0x0 src=0.0.0.0 dst=126.87.58.227\n2020/03/07 15:52:36 isTCP: true, header: ver=4 hdrlen=20 tos=0x0 totallen=60 id=0x9cec flags=0x2 fragoff=0x0 ttl=64 proto=6 cksum=0x89b7 src=10.2.0.10 dst=10.2.0.11\n2020/03/07 15:52:37 isTCP: true, header: ver=4 hdrlen=20 tos=0x0 totallen=60 id=0x9ced flags=0x2 fragoff=0x0 ttl=64 proto=6 cksum=0x89b6 src=10.2.0.10 dst=10.2.0.11\n2020/03/07 15:52:39 isTCP: true, header: ver=4 hdrlen=20 tos=0x0 totallen=60 id=0x9cee flags=0x2 fragoff=0x0 ttl=64 proto=6 cksum=0x89b5 src=10.2.0.10 dst=10.2.0.11\n2020/03/07 15:52:43 isTCP: true, header: ver=4 hdrlen=20 tos=0x0 totallen=60 id=0x9cef flags=0x2 fragoff=0x0 ttl=64 proto=6 cksum=0x89b4 src=10.2.0.10 dst=10.2.0.11\n</code></pre>\n\n<p>As you can see, a TCP client at 10.2.0.10 is trying to establish (TCP-SYN) a connection to 10.2.0.11.</p>\n"}], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1071, "favorite_count": 2, "accepted_answer_id": 60577764, "answer_count": 1, "score": 2, "last_activity_date": 1583585906, "creation_date": 1524357679, "question_id": 49961464, "link": "https://stackoverflow.com/questions/49961464/how-to-read-tcp-packets-on-a-tun-tap-interface", "title": "How to read TCP packets on a tun/tap interface?", "body": "<p>I'm working on a simple project that listens on a tun interface and modified the packets then re-sends them to the real interface.</p>\n\n<p>I have tried <a href=\"https://github.com/songgao/water\" rel=\"nofollow noreferrer\"><code>songgao/water</code></a>, <a href=\"https://github.com/pkg/taptun\" rel=\"nofollow noreferrer\"><code>pkg/tuntap</code></a> and even writing my own based on some C code floating around but no matter what I tried, I can't receive TCP packets (ICMP/UDP works fine).</p>\n\n<p>I feel like i'm missing something extremely obvious but I can't figure it for the life of me...</p>\n\n<p>The <a href=\"https://gist.github.com/OneOfOne/5368f638f7df1035862659a7bec6ca2f\" rel=\"nofollow noreferrer\">code</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"os/exec\"\n\n    \"golang.org/x/net/ipv4\"\n\n    \"github.com/songgao/water\"\n)\n\nconst (\n    // I use TUN interface, so only plain IP packet, no ethernet header + mtu is set to 1300\n    BUFFERSIZE = 1600\n    MTU        = \"1300\"\n)\n\nfunc main() {\n    iface, err := water.New(water.Config{})\n    fatalIf(err)\n\n    log.Printf(\"tun interface: %s\", iface.Name())\n    runBin(\"/bin/ip\", \"link\", \"set\", \"dev\", iface.Name(), \"mtu\", MTU)\n    runBin(\"/bin/ip\", \"addr\", \"add\", \"10.2.0.10/24\", \"dev\", iface.Name())\n    runBin(\"/bin/ip\", \"link\", \"set\", \"dev\", iface.Name(), \"up\")\n\n    buf := make([]byte, BUFFERSIZE)\n\n    for {\n        n, err := iface.Read(buf)\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        header, _ := ipv4.ParseHeader(buf[:n])\n\n        log.Printf(\"isTCP: %v, header: %s\", header.Protocol == 6, header)\n    }\n}\n\nfunc fatalIf(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc runBin(bin string, args ...string) {\n    cmd := exec.Command(bin, args...)\n    cmd.Stderr = os.Stderr\n    cmd.Stdout = os.Stdout\n    cmd.Stdin = os.Stdin\n    fatalIf(cmd.Run())\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-sql", "google-kubernetes-engine"], "comments": [{"owner": {"reputation": 2669, "user_id": 444583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/htumO.jpg?s=128&g=1", "display_name": "rexposadas", "link": "https://stackoverflow.com/users/444583/rexposadas"}, "edited": false, "score": 1, "creation_date": 1531229402, "post_id": 49960560, "comment_id": 89511150, "body": "Did you ever resolve this issue?"}, {"owner": {"reputation": 238, "user_id": 4671631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwkxC.jpg?s=128&g=1", "display_name": "clk", "link": "https://stackoverflow.com/users/4671631/clk"}, "reply_to_user": {"reputation": 2669, "user_id": 444583, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/htumO.jpg?s=128&g=1", "display_name": "rexposadas", "link": "https://stackoverflow.com/users/444583/rexposadas"}, "edited": false, "score": 0, "creation_date": 1531243169, "post_id": 49960560, "comment_id": 89520029, "body": "@rexposadas I didn&#39;t, but I suspect specifying the port on the cloudsql-proxy container might fix it:        <code>ports:           - containerPort: 3306             protocol: TCP</code>"}], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 9209450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a810acd61595dff055049975f2f44ea8?s=128&d=identicon&r=PG&f=1", "display_name": "Pol Arroyo", "link": "https://stackoverflow.com/users/9209450/pol-arroyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1524566403, "creation_date": 1524566403, "answer_id": 49999638, "question_id": 49960560, "link": "https://stackoverflow.com/questions/49960560/connecting-to-google-cloud-sql-using-proxy-error-403-insufficient-permission/49999638#49999638", "title": "Connecting to Google Cloud SQL using proxy -- Error 403: Insufficient Permission", "body": "<p>Hi as you can read here [1]: \"If your program is written in Go you can use the Cloud SQL Proxy as a library, avoiding the need to start the Proxy as a companion process.\", So you are already using the SQL proxy as code and there is no need to use the SQL proxy as a POD.</p>\n\n<p>If you still want to use the SQL proxy as a POD, you can use the GO Companion Process as you can read here[2] under: \"Companion Process\":</p>\n\n<pre><code>import (\n        \"github.com/go-sql-driver/mysql\"\n)\n\ndsn := fmt.Sprintf(\"%s:%s@tcp(%s)/%s\",\n       dbUser,\n       dbPassword,\n       \"127.0.0.1:3306\",\n       dbName)\ndb, err := sql.Open(\"mysql\", dsn)\n</code></pre>\n\n<p>[1] <a href=\"https://github.com/GoogleCloudPlatform/cloudsql-proxy#to-use-inside-a-go-program\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/cloudsql-proxy#to-use-inside-a-go-program</a>\n[2] <a href=\"https://cloud.google.com/sql/docs/mysql/connect-external-app#languages\" rel=\"nofollow noreferrer\">https://cloud.google.com/sql/docs/mysql/connect-external-app#languages</a></p>\n"}], "owner": {"reputation": 238, "user_id": 4671631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cwkxC.jpg?s=128&g=1", "display_name": "clk", "link": "https://stackoverflow.com/users/4671631/clk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524566403, "creation_date": 1524347866, "last_edit_date": 1524492035, "question_id": 49960560, "link": "https://stackoverflow.com/questions/49960560/connecting-to-google-cloud-sql-using-proxy-error-403-insufficient-permission", "title": "Connecting to Google Cloud SQL using proxy -- Error 403: Insufficient Permission", "body": "<pre><code>EDIT:\n</code></pre>\n\n<p>I now think the issue is with my Golang pod communicating with the proxy pod via localhost, as in the second error message. </p>\n\n<p>I added the service account credentials JSON file to my Docker image's <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable. After doing that, using <code>my-project:us-central1:my-instance</code> as <code>connName</code> below works.</p>\n\n<p>However, when I try using the <code>DB_HOST</code> environment variable in the container as <code>connName</code>, I still get the 404 error below.</p>\n\n<pre><code>ORIGINAL POST\n</code></pre>\n\n<p>I'm following <a href=\"https://cloud.google.com/sql/docs/mysql/connect-kubernetes-engine\" rel=\"nofollow noreferrer\">this guide</a> to connect to Google Cloud SQL from a pod on Kubernetes Engine. The pod is running two containers: one with the Cloud SQL proxy image and another with a Golang service to do the actual database queries.</p>\n\n<p>I'm getting the following error when my Golang service tries to initiate a connection:</p>\n\n<blockquote>\n  <p>ensure that the Cloud SQL API is enabled for your project\n  (<a href=\"https://console.cloud.google.com/flows/enableapi?apiid=sqladmin\" rel=\"nofollow noreferrer\">https://console.cloud.google.com/flows/enableapi?apiid=sqladmin</a>).\n  Error during createEphemeral for\n  my-project:us-central1:my-instance: googleapi: Error 403:\n  Insufficient Permission, insufficientPermission</p>\n</blockquote>\n\n<p>I've looked at a few threads here and elsewhere and here's what I've done so far:</p>\n\n<ul>\n<li>Ensured the Cloud SQL API is in fact enabled.</li>\n<li>Added the <code>Editor</code> role to the service account I'm using.</li>\n<li>Removed and re-added the <code>Cloud SQL Client</code> role on the service account I'm using.</li>\n<li>Verified the correct secrets were created, with the same namespace as the pods.</li>\n</ul>\n\n<p>Below is a snippet of the Golang code I'm using, which was taken from <a href=\"https://cloud.google.com/sql/docs/mysql/connect-external-app#languages\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>cfg := mysql.Cfg(connName, dbUser, dbPassword)\ncfg.DBName = dbName\ndb, err := mysql.DialCfg(cfg)\n\nif err != nil {\n    log.Println(err)\n    return c.NoContent(http.StatusInternalServerError)\n}\n</code></pre>\n\n<p><code>connName</code> is the same string that shows up in the error: <code>my-project:us-central1:my-instance</code>. I've tried changing that to <code>127.0.0.1:3306</code> instead, but I then get this error below:</p>\n\n<blockquote>\n  <p>ensure that the account has access to \"127.0.0.1:3306\" (and make sure\n  there's no typo in that name). Error during createEphemeral for\n  127.0.0.1:3306: googleapi: got HTTP response code 404 with body: Not Found</p>\n</blockquote>\n\n<p>Also, here is a snippet of the yaml file I'm using to deploy the pods. </p>\n\n<pre><code>    env: \n    - name: DB_HOST\n      value: 127.0.0.1:3306\n    - name: DB_USER\n      valueFrom:\n        secretKeyRef:\n          name: cloudsql-db-credentials\n          key: username\n    - name: DB_PASSWORD\n      valueFrom:\n        secretKeyRef:\n          name: cloudsql-db-credentials\n          key: password\n  - name: cloudsql-proxy\n    image: gcr.io/cloudsql-docker/gce-proxy:1.11\n    command: [\"/cloud_sql_proxy\",\n              \"-instances=my-project:us-central1:my-instance=tcp:3306\",\n              \"-credential_file=/secrets/cloudsql/credentials.json\"]\n    volumeMounts:\n      - name: cloudsql-instance-credentials\n        mountPath: /secrets/cloudsql\n        readOnly: true\n  volumes:\n    - name: cloudsql-instance-credentials\n      secret:\n        secretName: cloudsql-instance-credentials\n</code></pre>\n\n<p>I've also verified that the Cloud SQL proxy starts without issue:</p>\n\n<pre><code>2018/04/21 20:41:19 Listening on 127.0.0.1:3306 for my-project:us-central1:my-instance\n2018/04/21 20:41:19 Ready for new connections\n</code></pre>\n\n<p>I'm not sure what else to try here. Any help is appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524345046, "post_id": 49959719, "comment_id": 86936996, "body": "You are stealing 32 bytes from the connection; the SMTP client never gets to see them and thus reads unexpected data. You will probably have to wrap the net.Conn to sniff the traffic."}, {"owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524346872, "post_id": 49959719, "comment_id": 86937379, "body": "@Peter how much bytes i need to use ? i sure this is the problem, but i dont know how identificate the right  size"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1524399947, "post_id": 49959719, "comment_id": 86947464, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/49962763/golang-smtp-connexion-read-wellcome-message\">golang smtp connexion read wellcome message</a>"}], "owner": {"reputation": 977, "user_id": 2752185, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dd5f32012130adff6fa78ed329229bc4?s=128&d=identicon&r=PG&f=1", "display_name": "kingcope", "link": "https://stackoverflow.com/users/2752185/kingcope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1524341292, "creation_date": 1524340664, "last_edit_date": 1524341292, "question_id": 49959719, "link": "https://stackoverflow.com/questions/49959719/golang-smtp-get-and-parse-wellcome-message-of-server", "title": "golang smtp get and parse wellcome message of server", "body": "<p>I want to get welcome message of smtp server and check if contains specific keyword, this is my actual code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"strings\"\n    \"time\"\n    \"net/smtp\"\n    \"errors\"\n)\n\ntype loginAuth struct {\n    username, password string\n}\n\nfunc (a *loginAuth) Start(server *smtp.ServerInfo) (string, []byte, error) {\n    return \"LOGIN\", []byte{}, nil\n}\n\nfunc (a *loginAuth) Next(fromServer []byte, more bool) ([]byte, error) {\n    if more {\n        switch string(fromServer) {\n        case \"Username:\":\n            return []byte(a.username), nil\n        case \"Password:\":\n            return []byte(a.password), nil\n        default:\n            return nil, errors.New(\"Unkown fromServer\")\n        }\n    }\n    return nil, nil\n}\n\n\nfunc main() {\n\n    // attempt a connection\n    conn, err := net.DialTimeout(\"tcp\", \"88.198.24.108:25\", 15 * time.Second)\n    defer conn.Close()\n    if err == nil {\n        buf := make([]byte, 32, 32)\n        conn.Read(buf)\n        if strings.Contains(string(buf), \"Haraka\") {\n            fmt.Println(\"this server not working with this application\")\n        }\n    }\n\n    client, err := smtp.NewClient(conn, \"88.198.24.108\")\n    if err != nil {\n        fmt.Println(\"1&gt;&gt;\", err)\n        return\n    }\n\n    err = client.Auth(&amp;loginAuth{\"info@example.com\", \"123456\"})\n    if err != nil {\n        fmt.Println(\"2&gt;&gt;\", err)\n        return\n    } else {\n        fmt.Println(\"auth successfull\")\n    }\n\n}\n</code></pre>\n\n<p>The code return this error : <code>1&gt;&gt; short response: 18 ready</code>\nwhere i wrong ?</p>\n"}, {"tags": ["string", "go", "append", "slice"], "comments": [{"owner": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1524337371, "post_id": 49959159, "comment_id": 86934855, "body": "Why don&#39;t you follow go standard syntax. Only wondering. The world is easier if all follow similar rules."}, {"owner": {"reputation": 15, "user_id": 9679609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2AgO.jpg?s=128&g=1", "display_name": "Fantone", "link": "https://stackoverflow.com/users/9679609/fantone"}, "reply_to_user": {"reputation": 1917, "user_id": 6401895, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e169f96fa9c3c6a770dd828e3319263a?s=128&d=identicon&r=PG", "display_name": "Ivan Beldad", "link": "https://stackoverflow.com/users/6401895/ivan-beldad"}, "edited": false, "score": 0, "creation_date": 1524384381, "post_id": 49959159, "comment_id": 86943753, "body": "I&#39;m new to Go, I&#39;d need some suggestions for the problem above"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1524433304, "last_edit_date": 1524433304, "creation_date": 1524405071, "answer_id": 49966665, "question_id": 49959159, "link": "https://stackoverflow.com/questions/49959159/i-cant-return-string-slice-like-i-would-like-to-passing-just-the-last-one/49966665#49966665", "title": "I can&#39;t return string slice like I would like to. Passing just the last one", "body": "<p>It's hard to be sure, since your code is difficult to read, but this looks particularly suspicious (in pseudocode),</p>\n\n<pre><code>// main\nfor each file in list_file() {\n    result = {\n        // isValueInList\n        var result\n        for each file in list_file() {\n            for each word in file {\n                if word in wordlist and not in result {\n                    result = append(result, word)\n                }\n            }\n        }\n        // all the words in wordlist in any of the files\n        return result\n    }\n    // main\n    write result\n}\n</code></pre>\n\n<p>There are other problems with your code.</p>\n\n<hr>\n\n<p>Here's a more readable example (a first draft), of what you appear to be trying to do (Python modules in Python files?):</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n    \"path/filepath\"\n)\n\nvar modules = map[string]bool{\n    \"numpy\": true, \"grabscreen\": true, \"cv2\": true, \"time\": true, \"os\": true, \"pandas\": true, \"tqdm\": true, \"collections\": true,\n    \"models\": true, \"random\": true, \"inception_v3\": true, \"googlenet\": true, \"shuffle\": true, \"getkeys\": true, \"tflearn\": true,\n    \"directkeys\": true, \"statistics\": true, \"motion\": true, \"tflearn.layers.conv\": true, \"conv_2d\": true,\n    \"max_pool_2d\": true, \"avg_pool_2d\": true, \"conv_3d\": true, \"max_pool_3d\": true, \"avg_pool_3d\": true,\n}\n\nfunc findWords(filename string, lexicon map[string]bool) error {\n    f, err := os.Open(filename)\n    if err != nil {\n        return err\n    }\n    defer f.Close()\n\n    words := make(map[string]bool)\n\n    s := bufio.NewScanner(f)\n    s.Split(bufio.ScanWords)\n    for s.Scan() {\n        word := s.Text()\n        if _, exists := lexicon[word]; exists {\n            words[word] = true\n        }\n    }\n    if s.Err(); err != nil {\n        return err\n    }\n\n    var buf bytes.Buffer\n    for word := range words {\n        buf.WriteString(word)\n        buf.WriteString(\"\\n\")\n    }\n    if buf.Len() &gt; 0 {\n        err := ioutil.WriteFile(filename+`.words`, buf.Bytes(), 0666)\n        if err != nil {\n            return err\n        }\n    }\n    return nil\n}\n\nfunc main() {\n    dir := `./`\n    files, err := ioutil.ReadDir(dir)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n    for _, file := range files {\n        filename := file.Name()\n        if filepath.Ext(filename) != \".py\" {\n            continue\n        }\n        findWords(filename, modules)\n        if err != nil {\n            fmt.Fprintln(os.Stderr, err)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "is_accepted": false, "score": -1, "last_activity_date": 1524416155, "last_edit_date": 1524416155, "creation_date": 1524412644, "answer_id": 49967896, "question_id": 49959159, "link": "https://stackoverflow.com/questions/49959159/i-cant-return-string-slice-like-i-would-like-to-passing-just-the-last-one/49967896#49967896", "title": "I can&#39;t return string slice like I would like to. Passing just the last one", "body": "<p>There are a few mistakes in your code, so i've rewritten most of the code.\nWhat i did : \n1) open a file\n2) read a line\n3) compare it\n4) check if the target file exists\n5) if not, create it\n6) if it does, append to it\n7) write to it\n8) close target file\n9) goto 2 if there are more lines\n10) goto 1 if there are more files</p>\n\n<p>I tried to make it as much as readable for everybody so that everybody can understand it.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n    \"strconv\"\n    \"strings\"\n    \"time\"\n)\n\nconst readDir string = \"./\"\n\nvar startTime time.Time\n\nfunc main() {\n    for noFile, fileName := range listFile() {\n        startTime = time.Now()\n        fileInput, err := os.Open(fileName)\n        if err != nil {\n            log.Fatal(err)\n        }\n        defer fileInput.Close()\n\n        scanner := bufio.NewScanner(fileInput)\n        for scanner.Scan() {\n            for _, targetContent := range []string{\"numpy\", \"grabscreen\", \"cv2\", \"time\", \"os\", \"pandas\", \"tqdm\", \"collections\", \"models\", \"random\", \"inception_v3\", \"googlenet\", \"shuffle\", \"getkeys\", \"tflearn\", \"directkeys\", \"statistics\", \"motion\", \"tflearn.layers.conv\", \"conv_2d\", \"max_pool_2d\", \"avg_pool_2d\", \"conv_3d\", \"max_pool_3d\", \"avg_pool_3d\"} {\n                if strings.Contains(scanner.Text(), targetContent) {\n\n                    if _, err := os.Stat(readDir + \"output_\" + strconv.Itoa(noFile)); os.IsNotExist(err) {\n                        fmt.Println(\"File : \" + readDir + \"output_\" + strconv.Itoa(noFile) + \" does not exists, creating it now!\")\n                        createFile, err := os.Create(readDir + \"output_\" + strconv.Itoa(noFile))\n                        if err != nil {\n                            panic(err)\n                        }\n                        createFile.Close()\n                    }\n\n                    fileOutput, err := os.OpenFile(readDir+\"output_\"+strconv.Itoa(noFile), os.O_APPEND|os.O_WRONLY, 0600)\n                    if err != nil {\n                        panic(err)\n                    }\n\n                    if _, err = fileOutput.WriteString(\"contains : \" + targetContent + \" in : \" + scanner.Text() + \"\\n\"); err != nil {\n                        panic(err)\n                    }\n\n                    fileOutput.Close()\n\n                    fmt.Println(\"Writing file : \", readDir+\"output_\"+strconv.Itoa(noFile))\n                    fmt.Println(\"contains : \" + targetContent + \" in : \" + scanner.Text())\n                }\n            }\n        }\n\n        if err := scanner.Err(); err != nil {\n            log.Fatal(err)\n        }\n\n        log.Printf(\"Execution took %s\", time.Since(startTime))\n    }\n\n}\n\nfunc listFile() []string {\n\n    filesNames := make([]string, 0, 100)\n\n    files, err := ioutil.ReadDir(readDir)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, f := range files {\n        if strings.HasSuffix(f.Name(), \".txt\") {\n            fileName, err := filepath.Abs(string(f.Name()))\n            if err != nil {\n                log.Fatal(err)\n            }\n            filesNames = append(filesNames, fileName)\n        }\n    }\n    return filesNames\n}\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9679609, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a2AgO.jpg?s=128&g=1", "display_name": "Fantone", "link": "https://stackoverflow.com/users/9679609/fantone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 2, "answer_count": 2, "score": -5, "last_activity_date": 1524433304, "creation_date": 1524336666, "last_edit_date": 1524403860, "question_id": 49959159, "link": "https://stackoverflow.com/questions/49959159/i-cant-return-string-slice-like-i-would-like-to-passing-just-the-last-one", "title": "I can&#39;t return string slice like I would like to. Passing just the last one", "body": "<p>I wrote this code to get the list of the file in directory, appending the names in a slice and one by one open them, after I open a file I search for some words in the file and if found write them in a new file.\nBut I always get the same words in the new files and I can't figure out why</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"os\"\n    \"strings\"\n    \"time\"\n)\n\nconst dir_to_read_path string = \"path\"\n\nfunc main() {\n\n    start := time.Now()\n    temp_string_filename := \"\"\n    temp_string_filename_counter := 0\n\n    //defer list_file()\n\n    // just pass the file name\n    for k := range list_file() {\n\n        temp_string_filename = list_file()[temp_string_filename_counter]\n        if true {\n            k = k\n        }\n        temp_string_filename_counter++\n\n        b, err := ioutil.ReadFile(temp_string_filename)\n        if err != nil {\n            fmt.Print(err)\n        }\n\n        // convert content to a 'string'\n        str := string(b)\n        control_params := []string{\"numpy\", \"grabscreen\", \"cv2\", \"time\", \"os\", \"pandas\", \"tqdm\", \"collections\", \"models\", \"random\", \"inception_v3\", \"googlenet\", \"shuffle\", \"getkeys\", \"tflearn\", \"directkeys\", \"statistics\", \"motion\", \"tflearn.layers.conv\", \"conv_2d\", \"max_pool_2d\", \"avg_pool_2d\", \"conv_3d\", \"max_pool_3d\", \"avg_pool_3d\"}\n\n        temp_string_filename = dir_to_read_path + \"output_\" + temp_string_filename\n\n        fmt.Println(\"Writing file n. \", k)\n\n        file, err := os.Create(temp_string_filename)\n        if err != nil {\n            log.Fatal(\"Cannot create file\", err)\n        }\n\n        for _, z := range isValueInList(control_params, str, list_file()) {\n\n            fmt.Fprintf(file, z)\n            fmt.Fprintf(file, \"\\n\")\n        }\n        defer file.Close()\n\n        elapsed := time.Since(start)\n        log.Printf(\"Execution took %s\", elapsed)\n    }\n\n}\n\nfunc isValueInList(list []string, file_string string, read_file []string) []string {\n\n    encountered_modules := make([]string, 0, 10)\n    temp_string_filename := \"\"\n    temp_string_filename_counter := 0\n\n    encountered := map[string]bool{}\n    result := make([]string, 0, 10)\n    final_result := [][]string{}\n\n    for z := range read_file {\n\n        fmt.Println(\"Reading file n. \", z)\n\n        temp_string_filename = read_file[temp_string_filename_counter]\n        f, _ := os.Open(temp_string_filename)\n        defer f.Close()\n\n        scanner := bufio.NewScanner(f)\n        scanner.Split(bufio.ScanWords)\n\n        for scanner.Scan() {\n            line := scanner.Text()\n            for _, v := range list {\n                if v == line {\n                    encountered_modules = append(encountered_modules, line)\n                }\n            }\n        }\n\n        for v := range encountered_modules {\n            if encountered[encountered_modules[v]] == true {\n                // Do not add duplicate.\n            } else {\n                // Record this element as an encountered element.\n                encountered[encountered_modules[v]] = true\n                result = append(result, encountered_modules[v])\n            }\n        }\n        temp_string_filename_counter++\n        final_result = append(final_result, result)\n    }\n    return result\n\n}\n\nfunc list_file() []string {\n\n    files_names := make([]string, 0, 10)\n\n    files, err := ioutil.ReadDir(\"./\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    for _, f := range files {\n        if strings.HasSuffix(f.Name(), \".txt\") {\n            files_names = append(files_names, string(f.Name()))\n\n        }\n    }\n\n    return files_names\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 6, "last_activity_date": 1524332331, "creation_date": 1524332331, "answer_id": 49958476, "question_id": 49958153, "link": "https://stackoverflow.com/questions/49958153/unbuffered-channel-in-go/49958476#49958476", "title": "Unbuffered channel in Go", "body": "<p>An unbuffered channel blocks on send until a receiver is ready to read.  In your first example a reader is set up first, so when the send occurs it can be sent immediately.</p>\n\n<p>In your second example, the send happens before a receiver is ready so the send blocks and the program deadlocks.</p>\n\n<p>You could fix the second example by making a buffered channel, but there is a chance you won't ever see the output from the goroutine as the program may exit (the main goroutine) before the output buffer is flushed.  The goroutine may not even run as main exits before it can be scheduled.</p>\n"}, {"tags": [], "owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "is_accepted": false, "score": 2, "last_activity_date": 1524332578, "creation_date": 1524332578, "answer_id": 49958529, "question_id": 49958153, "link": "https://stackoverflow.com/questions/49958153/unbuffered-channel-in-go/49958529#49958529", "title": "Unbuffered channel in Go", "body": "<p>First of all, <code>go-routines</code> run concurrently. In 1st example, the sub-goroutine has already started, but in 2nd example, the go-routine hasn't started yet when the send operation appears.</p>\n\n<p>Think about line by line.</p>\n\n<p>In 1st example, the <code>sub-goroutine</code> has started concurrently before the send operation appears on the main go-routine. As a result, when the the send operation happens, there is already an receiver (<code>sub-goroutine</code>) exists. </p>\n\n<p>If you tweak the 1st example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch01 := make(chan string)\n\n    go func() {\n        fmt.Println(\"We are in the sub goroutine\")\n        fmt.Println(&lt;-ch01)\n    }()\n\n    // wait for start of sub-routine\n    time.Sleep(time.Second * 2)\n\n    fmt.Println(\"We are in the main goroutine\")\n    ch01 &lt;- \"Hello\"\n\n    // wait for the routine to receive and print the string\n    time.Sleep(time.Second * 2)\n\n}\n</code></pre>\n\n<p>The output will be</p>\n\n<pre><code>We are in the sub goroutine\nWe are in the main goroutine\nHello\n</code></pre>\n\n<p>So, you can see that the sub-goroutine has already started.and it is waiting to receive on channel. When the main goroutine send string in channel, the sub-goroutine resumes and receives the signal.</p>\n\n<p>But in 2nd example, The program has stuck in main go routine <code>send operation</code>, and the sub go routine has not started yet and will not start, because the program has not got that line yet. so there is no other receiver to receive the signal. So the program stuck in deadlock.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1524338368, "creation_date": 1524338368, "answer_id": 49959405, "question_id": 49958153, "link": "https://stackoverflow.com/questions/49958153/unbuffered-channel-in-go/49959405#49959405", "title": "Unbuffered channel in Go", "body": "<p>For unbuffered channels the go routine is blocked until there is no one to receive it. First there should be a go routine to receive the value from the channel and then a value to the channel is send. For the example when we are sending a value to channel it is required to create a buffered channel so that the value is saved into buffered until there is no one to receive it like this will work.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch01 := make(chan string, 10)\n    ch01 &lt;- \"Hello\"\n    go func() {\n        fmt.Println(\"We are in the sub goroutine\")\n        fmt.Println(&lt;-ch01)\n    }()\n\n    fmt.Println(\"We are in the main goroutine\")\n    time.Sleep(1 * time.Second)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/NlHIaWFKxtb\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1524339326, "creation_date": 1524339326, "answer_id": 49959538, "question_id": 49958153, "link": "https://stackoverflow.com/questions/49958153/unbuffered-channel-in-go/49959538#49959538", "title": "Unbuffered channel in Go", "body": "<blockquote>\n  <p>Did that mean after ch01 &lt;- \"Hello\" the main goroutine was immediately\n  blocked so that the sub goroutine had no chance to run? If it is true,\n  how should I understand the result of the first code example?(At first\n  in main goroutine, then in sub goroutine).</p>\n</blockquote>\n\n<p>It's true. You understand things write. Order of evaluation of spawned goroutines unspecified and can only be controlled with sync tools(channels, mutexes). Sub goroutine in first example may as well Print() first in another environment. It's just <em>unspecified</em>.  </p>\n"}], "owner": {"reputation": 977, "user_id": 1419809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Plto.jpg?s=128&g=1", "display_name": "Pauli", "link": "https://stackoverflow.com/users/1419809/pauli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1167, "favorite_count": 0, "accepted_answer_id": 49958476, "answer_count": 4, "score": 4, "last_activity_date": 1524339326, "creation_date": 1524330044, "question_id": 49958153, "link": "https://stackoverflow.com/questions/49958153/unbuffered-channel-in-go", "title": "Unbuffered channel in Go", "body": "<p>Here is a simple example code about unbuffered channels:</p>\n\n<pre><code>ch01 := make(chan string)\n\ngo func() {\n    fmt.Println(\"We are in the sub goroutine\")\n    fmt.Println(&lt;-ch01)\n}()\n\nfmt.Println(\"We are in the main goroutine\")\nch01 &lt;- \"Hello\"\n</code></pre>\n\n<p>The result I got:</p>\n\n<pre><code>We are in the main goroutine \nWe are in the sub goroutine \nHello\n</code></pre>\n\n<p>Go playground:\n<a href=\"https://play.golang.org/p/rFWQbwXRzGw\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rFWQbwXRzGw</a></p>\n\n<p>From my understanding, the send operation blocked the main goroutine, until the sub goroutine executed a receive operation on channel <code>ch01</code>.  Then the program exited.</p>\n\n<p>After placing the sub goroutine after the send operation like that:</p>\n\n<pre><code>fmt.Println(\"We are in the main goroutine\")\nch01 &lt;- \"Hello\"\n\ngo func() {\n    fmt.Println(\"We are in the sub goroutine\")\n    fmt.Println(&lt;-ch01)\n}()\n</code></pre>\n\n<p>A deadlock occurred:</p>\n\n<pre><code>We are in the main goroutine\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p>go playground\n<a href=\"https://play.golang.org/p/DmRUiBG4UmZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/DmRUiBG4UmZ</a></p>\n\n<p>What happened this time? Did that mean after <code>ch01 &lt;- \"Hello\"</code> the main goroutine was immediately blocked so that the sub goroutine had no chance to run? If it is true, how should I understand the result of the first code example?(At first in main goroutine, then in sub goroutine).</p>\n"}]