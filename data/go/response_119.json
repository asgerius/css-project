[{"tags": ["testing", "go", "packages"], "answers": [{"tags": [], "owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "is_accepted": true, "score": 41, "last_activity_date": 1587214865, "last_edit_date": 1587214865, "creation_date": 1492644879, "answer_id": 43507774, "question_id": 43507740, "link": "https://stackoverflow.com/questions/43507740/how-to-run-go-test-on-all-test-files-in-my-project-except-for-vendor-packages/43507774#43507774", "title": "How to run go test on all test files in my project except for vendor packages", "body": "<p>The <code>-run</code> pattern is matched only against the test identifier (not the filename); in principle you could do:</p>\n\n<pre><code>go test -run TestFoo\n</code></pre>\n\n<p>but when you'd have to add <code>Foo</code> to all your test function names, which you probably don't want.</p>\n\n<p>The <code>...</code> wildcard excludes the <code>./vendor</code> directory since Go 1.9, so you can now just run <code>go test ./...</code> and it won't include <code>./vendor</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1492672015, "last_edit_date": 1492672015, "creation_date": 1492670864, "answer_id": 43512156, "question_id": 43507740, "link": "https://stackoverflow.com/questions/43507740/how-to-run-go-test-on-all-test-files-in-my-project-except-for-vendor-packages/43512156#43512156", "title": "How to run go test on all test files in my project except for vendor packages", "body": "<blockquote>\n  <p><a href=\"https://github.com/golang/go/issues/19090\" rel=\"nofollow noreferrer\">cmd/go: exclude vendor dir from matching <code>...</code> #19090</a></p>\n  \n  <p><a href=\"https://groups.google.com/forum/#!searchin/golang-checkins/vendor%7Csort:relevance/golang-checkins/3nC41KX8NcQ/4L2CbiuNFgAJ\" rel=\"nofollow noreferrer\">[go] cmd/go: exclude vendored packages from ... matches</a></p>\n\n<pre><code>By overwhelming popular demand, exclude vendored packages from ... matches,\nby making ... never match the \"vendor\" element above a vendored package.\n\ngo help packages now reads:\n\n    An import path is a pattern if it includes one or more \"...\" wildcards,\n    each of which can match any string, including the empty string and\n    strings containing slashes.  Such a pattern expands to all package\n    directories found in the GOPATH trees with names matching the\n    patterns.\n\n    To make common patterns more convenient, there are two special cases.\n    First, /... at the end of the pattern can match an empty string,\n    so that net/... matches both net and packages in its subdirectories, like net/http.\n    Second, any slash-separted pattern element containing a wildcard never\n    participates in a match of the \"vendor\" element in the path of a vendored\n    package, so that ./... does not match packages in subdirectories of\n    ./vendor or ./mycode/vendor, but ./vendor/... and ./mycode/vendor/... do.\n    Note, however, that a directory named vendor that itself contains code\n    is not a vendored package: cmd/vendor would be a command named vendor,\n    and the pattern cmd/... matches it.\n\nFixes #19090.\n</code></pre>\n  \n  <p><a href=\"https://go.googlesource.com/go/+/fa1d54c2edad607866445577fe4949fbe55166e1\" rel=\"nofollow noreferrer\">go / go / fa1d54c2edad607866445577fe4949fbe55166e1</a></p>\n\n<pre><code>commit    fa1d54c2edad607866445577fe4949fbe55166e1\nWed Mar 29 18:51:44 2017 +0000\n</code></pre>\n</blockquote>\n\n<p>Try running <code>go test ./...</code> at tip or wait for Go1.9.</p>\n"}], "owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13536, "favorite_count": 3, "accepted_answer_id": 43507774, "answer_count": 2, "score": 19, "last_activity_date": 1587214865, "creation_date": 1492644598, "last_edit_date": 1492667747, "question_id": 43507740, "link": "https://stackoverflow.com/questions/43507740/how-to-run-go-test-on-all-test-files-in-my-project-except-for-vendor-packages", "title": "How to run go test on all test files in my project except for vendor packages", "body": "<p>My project folder contains:</p>\n\n<pre><code>Makefile  README.md  component/  driver/  service/  vendor/  worker/\n</code></pre>\n\n<p>I'd like to run <code>go test</code> on all test files, e.g. <code>foobar_test.go</code> files except for the test files in the vendor package. The closest I've come to success was with <code>go test ./...</code> but that included vendor test files.</p>\n\n<p>I saw in the documentation you can pass a regex to <code>-run</code> option but I'm having trouble getting this working. For example I tried <code>go test ./*</code>, but I get a bunch of <code>can't load package errors</code>.</p>\n\n<p>What's the best way to do this?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1492632569, "creation_date": 1492632569, "answer_id": 43505195, "question_id": 43505133, "link": "https://stackoverflow.com/questions/43505133/goanda-on-github-for-oanda-api-rest-in-golang/43505195#43505195", "title": "GOanda on github for Oanda API Rest in GoLang", "body": "<p>There's a bug in the package. It contains invalid code.</p>\n\n<p>The solution would be to use an older version that isn't broken (if there is one), fix the bug, or get someone else (perhaps the author) to fix the bug.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492636512, "post_id": 43505284, "comment_id": 74067109, "body": "Thank you!  That worked!  Now I just haft to figure out how to make a working example calling the functions!"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492637019, "post_id": 43505284, "comment_id": 74067372, "body": "Glad I could help. As this answered the question as is, would you please click to accept the answer? As far as using the library, it looks like everything is based off using a <code>Client</code>, so simply call <code>NewFxTradeClient</code> or <code>NewFxPracticeClient</code> to get a new <code>Client</code>, then start using it."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492637478, "post_id": 43505284, "comment_id": 74067583, "body": "What I am currently trying to figure out right now is how to populate Client and pass it too NewFxTradeClient.  Kind of like Ansi C but not.  Not like perl/php so I am trying to get a working example!"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492639162, "post_id": 43505284, "comment_id": 74068260, "body": "I don&#39;t know what you mean. You pass those functions a string (whatever your <code>token</code> is), and they return a <code>Client</code> all ready to go. The statement <code>client := goanda.NewFxTradeClient(&quot;mytoken&quot;)</code> would compile and run, but that obviously isn&#39;t a real token."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492639343, "post_id": 43505284, "comment_id": 74068336, "body": "When I go to populate Client what you are calling &quot;mytoken&quot; I get undefined: Client    package main    import &quot;github.com/jasonnfls/goanda&quot;    func main() {         account := Client{Token: &quot;This is API key token&quot;, Env: 1234567890, client: &quot;unknown at this time what goes here&quot;}         oanda := goanda.NewFxTradeClient(&amp;account)   }"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492639402, "post_id": 43505284, "comment_id": 74068362, "body": "Those <code>New...</code> functions populate it for you."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492639740, "post_id": 43505284, "comment_id": 74068498, "body": "This code runs <a href=\"https://play.golang.org/p/o6SeJuFzII\" rel=\"nofollow noreferrer\">play.golang.org/p/o6SeJuFzII</a> (copy paste locally. you can&#39;t import external libs on the playground). Have you done the golang tour? <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492640056, "post_id": 43505284, "comment_id": 74068630, "body": "If you want to refer to the <code>Client</code> struct manually, you have to specify it by the package name e.g. <code>goanda.Client</code>. It doesn&#39;t get passed into the <code>New</code> functions, it is returned from them. If you create it manually yourself, you don&#39;t need to call either of the <code>New</code> functions."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492640130, "post_id": 43505284, "comment_id": 74068650, "body": "My issues is populating the type of Client on lines 7 to 10 in goanda/client.go.  Setting the 3 values of Token / Env / client so I can make the mytoken to pass to that function!"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492640483, "post_id": 43505284, "comment_id": 74068757, "body": "This is a library for the oanda REST API. The <code>token</code> is just a string. You presumably get the API token from <a href=\"https://www.oanda.com/\" rel=\"nofollow noreferrer\">oanda.com</a> . You do not need to manually create the <code>Client</code>, just pass your API token into the <code>New</code> function."}, {"owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492640685, "post_id": 43505284, "comment_id": 74068827, "body": "cannot use account (type goanda.Client) as type string in argument to goanda.NewFxTradeClient when I use this to set the values //account := goanda.Client{Token: &quot;This is API key token&quot;, Env: &quot;1234567890&quot;, client: &quot;unknown at this time what goes here&quot;}  10         account := goanda.Client{Token: &quot;This is API key token&quot;, Env: &quot;1234567890&quot;}....  The token is 2 values one API key and one Account # that is how oanda takes the arguments.  How to feed that into go type I am not sure"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "edited": false, "score": 0, "creation_date": 1492640910, "post_id": 43505284, "comment_id": 74068907, "body": "Well, then maybe this isn&#39;t the right library? Or perhaps you shouldn&#39;t use the <code>New</code> functions? The value to put in the third slot of <code>oanda.Client</code> is <code>http.DefaultClient</code> after importing <code>net&#47;http</code>."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 0, "last_activity_date": 1492635996, "last_edit_date": 1492635996, "creation_date": 1492632926, "answer_id": 43505284, "question_id": 43505133, "link": "https://stackoverflow.com/questions/43505133/goanda-on-github-for-oanda-api-rest-in-golang/43505284#43505284", "title": "GOanda on github for Oanda API Rest in GoLang", "body": "<p>The bug in the package appears to be a copy/paste error. In the file <code>trade.go</code>, change the return value on line 20 from <code>OrderResponse</code> to <code>UpdateTradeResponse</code>, then run <code>go install github.com/jasonnfls/goanda</code>.</p>\n\n<p>The file will be in your <code>$GOPATH/src/github.com/jasonnfls/goanda</code></p>\n\n<p>I submitted a pull request with the fix to the repo owner.</p>\n"}], "owner": {"reputation": 31, "user_id": 2777145, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/275a25ae585ac389a97aee758ee1fd6e?s=128&d=identicon&r=PG&f=1", "display_name": "user2777145", "link": "https://stackoverflow.com/users/2777145/user2777145"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 43505284, "answer_count": 2, "score": -1, "last_activity_date": 1492669804, "creation_date": 1492632326, "last_edit_date": 1492669804, "question_id": 43505133, "link": "https://stackoverflow.com/questions/43505133/goanda-on-github-for-oanda-api-rest-in-golang", "title": "GOanda on github for Oanda API Rest in GoLang", "body": "<p>When I try to install this package:</p>\n\n<pre><code>go get github.com/jasonnfls/goanda\n</code></pre>\n\n<p>I get this error:</p>\n\n<blockquote>\n  <p>/usr/local/go/bin/src/github.com/jasonnfls/goanda/trade.go:47: cannot use responseObj (type UpdateTradeResponse) as type OrderResponse in return argument</p>\n</blockquote>\n\n<p>What would be the best way to resolve this?</p>\n\n<p>Anyone have a good solution to this?</p>\n"}, {"tags": ["go", "setter"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1492630351, "post_id": 43504393, "comment_id": 74063552, "body": "I&#39;m glad you didn&#39;t mark this as a duplicate of the ever-so-many struct setter questions. This one indeed has some subtle differences."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1492629824, "creation_date": 1492629824, "answer_id": 43504393, "question_id": 43504240, "link": "https://stackoverflow.com/questions/43504240/setter-not-working-in-model/43504393#43504393", "title": "Setter not working in model", "body": "<p><code>IndexController.ChangeText</code> needs a pointer receiver, or <code>IndexController.Model</code> needs to be a pointer. You're calling <code>SetText</code> on a copy of the <code>SetText</code> value.</p>\n\n<p>If you expect things to be mutable, it's much easier to consistently use pointers to structs throughout, and make explicit struct values the exception when you really need them. </p>\n"}], "owner": {"reputation": 204, "user_id": 6532897, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/435502d7612ac27de3fcdf788f0813b2?s=128&d=identicon&r=PG&f=1", "display_name": "jufracaqui", "link": "https://stackoverflow.com/users/6532897/jufracaqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1492664073, "accepted_answer_id": 43504393, "answer_count": 1, "score": 0, "last_activity_date": 1492632496, "creation_date": 1492629307, "last_edit_date": 1492632496, "question_id": 43504240, "link": "https://stackoverflow.com/questions/43504240/setter-not-working-in-model", "closed_reason": "Duplicate", "title": "Setter not working in model", "body": "<p>I am making this code trying to understand the MVC architecture while learning Go, and I am stuck trying to change values in the model from the controller. </p>\n\n<p>The code right now creates a model that only holds a string, the view shows that string on the terminal, but the controller can not change it (it gets the user input without any problem).</p>\n\n<p>Right now the text I get in the terminal is like this:</p>\n\n<pre><code>Hello World!\nasdf //my input\nHello World!\n</code></pre>\n\n<p>And the output I would like to get would be like this:</p>\n\n<pre><code>Hello World!\nasdf //my input\nasdf\n</code></pre>\n\n<p>Here are my files:</p>\n\n<p>model.go</p>\n\n<pre><code>package models\n\ntype IndexModel struct {\n    Text string\n}\n\nfunc (m *IndexModel) InitModel() string {\n    return m.Text\n}\n\nfunc (m *IndexModel) SetText(newText string) {\n    m.Text = newText\n}\n</code></pre>\n\n<p>view.go</p>\n\n<pre><code>package views\n\nimport \"github.com/jufracaqui/mvc_template/app/models\"\n\ntype IndexView struct {\n    Model    models.IndexModel\n}\n\nfunc (v IndexView) Output() string {\n    return v.Model.Text\n}\n</code></pre>\n\n<p>controller.go</p>\n\n<pre><code>package controllers\n\nimport \"github.com/jufracaqui/mvc_template/app/models\"\n\ntype IndexController struct {\n    Model models.IndexModel\n}\n\nfunc (c IndexController) ChangeText(userInput string) {\n    c.Model.SetText(userInput)\n}\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"os\"\n\n    \"fmt\"\n\n    \"github.com/jufracaqui/mvc_template/app/controllers\"\n    \"github.com/jufracaqui/mvc_template/app/models\"\n    \"github.com/jufracaqui/mvc_template/app/views\"\n)\n\nfunc main() {\n    handleIndex()\n}\n\nfunc handleIndex() {\n    model := models.IndexModel{\n        \"Hello World!\",\n    }\n\n    controller := controllers.IndexController{\n        model,\n    }\n\n    viewIndex := views.IndexView{\n        model,\n    }\n\n    fmt.Println(viewIndex.Model.Text)\n\n    reader := bufio.NewReader(os.Stdin)\n    text, _ := reader.ReadString('\\n')\n    controller.ChangeText(text)\n    fmt.Println(viewIndex.Model.Text)\n}\n</code></pre>\n\n<p><strong>Edit:</strong>\nHow my code ended up after @JimB answer:</p>\n\n<p>model.go:</p>\n\n<pre><code>package models\n\ntype IndexModel struct {\n    Text string\n}\n\nfunc (m *IndexModel) InitModel() string {\n    return m.Text\n}\n</code></pre>\n\n<p>view.go:</p>\n\n<pre><code>package views\n\nimport \"github.com/jufracaqui/mvc_template/app/models\"\n\ntype IndexView struct {\n    Model    *models.IndexModel\n}\n\nfunc (v IndexView) Output() string {\n    return v.Model.Text\n}\n</code></pre>\n\n<p>controller.go:</p>\n\n<pre><code>package controllers\n\nimport \"github.com/jufracaqui/mvc_template/app/models\"\n\ntype IndexController struct {\n    Model *models.IndexModel\n}\n\nfunc (c IndexController) ChangeText(userInput string) {\n    c.Model.Text = userImput\n}\n</code></pre>\n\n<p>main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"os\"\n\n    \"fmt\"\n\n    \"github.com/jufracaqui/mvc_template/app/controllers\"\n    \"github.com/jufracaqui/mvc_template/app/models\"\n    \"github.com/jufracaqui/mvc_template/app/views\"\n)\n\nfunc main() {\n    handleIndex()\n}\n\nfunc handleIndex() {\n    model := models.IndexModel{\n        \"Hello World!\",\n    }\n\n    m := &amp;model\n\n    controller := controllers.IndexController{\n        m,\n    }\n\n    viewIndex := views.IndexView{\n        m,\n    }\n\n    fmt.Println(viewIndex.Model.Text)\n\n    reader := bufio.NewReader(os.Stdin)\n    text, _ := reader.ReadString('\\n')\n    controller.ChangeText(text)\n    fmt.Println(viewIndex.Model.Text)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492630894, "post_id": 43504124, "comment_id": 74063931, "body": "You can&#39;t use Println Scanf for this sort of thing. You can&#39;t readily erase what Println has written to the terminal, and you can&#39;t interrupt a read from stdin in Scanf."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1492630170, "creation_date": 1492630170, "answer_id": 43504502, "question_id": 43504124, "link": "https://stackoverflow.com/questions/43504124/option-to-stop-asking-for-input-after-wg-wait-is-done/43504502#43504502", "title": "Option to stop asking for input after wg.wait() is done", "body": "<p>You have to handle your user input in another Go routine, then instead of <code>wg.Wait()</code>, probably just use a select:</p>\n\n<pre><code>func ABC() {\n    done := make(chan struct{})\n    go func() {\n        defer close(done)\n        doSomething()\n    }()\n    stop := make(chan struct{})\n    go func() {\n        defer close(stop)\n        stop &lt;- optionToStop()\n    }\n    select {\n    case done:\n        // Finished, close optionToStop dialog, and move on\n    case stop:\n        // User requested stop, terminate the 3rd party thing and move on\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7239851, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0e24becccd87d2573c6e8fc63b24baf3?s=128&d=identicon&r=PG&f=1", "display_name": "Innocentguy", "link": "https://stackoverflow.com/users/7239851/innocentguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1492630170, "creation_date": 1492628902, "last_edit_date": 1492629682, "question_id": 43504124, "link": "https://stackoverflow.com/questions/43504124/option-to-stop-asking-for-input-after-wg-wait-is-done", "title": "Option to stop asking for input after wg.wait() is done", "body": "<p><strong>1</strong>. I triggered a goroutine (which runs a third party program) and I am using <code>wg.Wait()</code> to wait for it to complete</p>\n\n<p><strong>2</strong>. Before <code>wg.Wait()</code>, I want to provide user an option to cancel this third party program that is running (if he want to)</p>\n\n<p><strong>3</strong>. After the third party program execution is done, this user input option should vanish off (there is no reason why he should stop the process thats already done). Currently this input has to be provided before <code>wg.Wait()</code> is triggered</p>\n\n<p>How can I do it? I thought of keeping the <code>optiontoStop()</code> function in goroutine and then kill it after <code>wg.Wait()</code> is done but I wasn't able to get it done or else is there a way to send a random value to the blocking call of scanf before I return from XYZ? or any other workarounds?</p>\n\n<p>More details:</p>\n\n<p><strong>1</strong>.</p>\n\n<pre><code>func XYZ() {\n   wg.Add(1)\n   go doSomething(&amp;wg) // this runs a third party program\n}\n</code></pre>\n\n<p><strong>2</strong>. </p>\n\n<pre><code>func ABC() {\n   XYZ()\n   optiontoStop() // I want this input wait request to vanish off after \n                  // the third party program execution                    \n                  // (doSomething()) is completed\n   wg.Wait() \n   //some other stuff \n}\n</code></pre>\n\n<p><strong>3</strong>. </p>\n\n<pre><code>func optiontoStop() {\n   var option string\n   fmt.Println(\"Type 'quit'  if you want to quit the program\")\n   fmt.Scanf(\"%s\",&amp;string)\n   //kill the process etc.\n }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492625809, "post_id": 43502432, "comment_id": 74060887, "body": "Great... I thought so, but always best to double-check :)"}], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 0, "creation_date": 1492625383, "post_id": 43502894, "comment_id": 74060623, "body": "Thanks. This works for me. But do you think if there is another way to make the test code easier to write? Maybe make changes package main?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 0, "creation_date": 1492626189, "post_id": 43502894, "comment_id": 74061121, "body": "Depends on what you think is hard-to-write in this test... If you have many such <code>TestXxx</code> functions for testing different handlers and you feel like you&#39;re repeating yourself a lot you can extract repetetive code into a function and use it in your tests. E.g. you could have one function, let&#39;s call it <code>testrouter</code>, that creates a new router, registers every handler and then returns the router, and you can pass the <code>rr</code> and <code>req</code> straight to its result like so <code>testrouter().ServeHTTP(rr, req)</code>..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 2, "creation_date": 1492626213, "post_id": 43502894, "comment_id": 74061131, "body": "And if you want to test a single handler with many different requests have a look at <a href=\"https://github.com/golang/go/wiki/TableDrivenTests\" rel=\"nofollow noreferrer\">table driven tests</a>."}, {"owner": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "edited": false, "score": 0, "creation_date": 1492626360, "post_id": 43502894, "comment_id": 74061211, "body": "Table Driven tests is exactly what i am looking for. Thanks"}, {"owner": {"reputation": 91, "user_id": 3893899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc6d2ccd53a7a1895b8d5712218e5b9?s=128&d=identicon&r=PG", "display_name": "austinjalexander", "link": "https://stackoverflow.com/users/3893899/austinjalexander"}, "edited": false, "score": 3, "creation_date": 1495227913, "post_id": 43502894, "comment_id": 75181929, "body": "Small update: <code>rr.code</code> --&gt; <code>rr.Code</code> (see <a href=\"https://golang.org/pkg/net/http/httptest/#ResponseRecorder\" rel=\"nofollow noreferrer\">httptest.ResponseRecorder docs</a>)."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 14, "last_activity_date": 1522961130, "last_edit_date": 1522961130, "creation_date": 1492624532, "answer_id": 43502894, "question_id": 43502432, "link": "https://stackoverflow.com/questions/43502432/how-to-write-test-with-httprouter/43502894#43502894", "title": "How to write test with httprouter", "body": "<p>Just spin up a new router for each test and then register the handler under test, then pass the test request to the router, not the handler, so that the router can parse the path parameters and pass them to the handler.</p>\n\n<pre><code>func TestGetBook(t *testing.T) {\n    handler := controllers.NewBookController()\n    router := httprouter.New()\n    router.GET(\"/book/:id\", handler.GetBook)\n\n    req, _ := http.NewRequest(\"GET\", \"/book/sampleid\", nil)\n    rr := httptest.NewRecorder()\n\n    router.ServeHTTP(rr, req)\n    if status := rr.Code; status != http.StatusOK {\n        t.Errorf(\"Wrong status\")\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1492625558, "creation_date": 1492625558, "answer_id": 43503197, "question_id": 43502432, "link": "https://stackoverflow.com/questions/43502432/how-to-write-test-with-httprouter/43503197#43503197", "title": "How to write test with httprouter", "body": "<p>You need to wrap your handler so that it can be accessed as an <code>http.HandlerFunc</code>:</p>\n\n<pre><code>func TestGetBook(t *testing.T) {\n    req, _ := http.NewRequest(\"GET\", \"/book/sampleid\", nil)\n    rr := httptest.NewRecorder()\n    handler := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        controllers.NewBookController().GetBook(w, r, httprouter.Params{})\n    })\n    handler.ServeHTTP(rr,req)\n    if status := rr.code; status != http.StatusOK {\n        t.Errorf(\"Wrong status\")\n    }\n}\n</code></pre>\n\n<p>If your handler requires parameters, you'll either have to parse them manually from the request, or just supply them as the third argument.</p>\n"}, {"tags": [], "owner": {"reputation": 802, "user_id": 2018909, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/10ebdad579fc333db3830e893baf977e?s=128&d=identicon&r=PG", "display_name": "srini", "link": "https://stackoverflow.com/users/2018909/srini"}, "is_accepted": false, "score": -1, "last_activity_date": 1525218612, "last_edit_date": 1592644375, "creation_date": 1525218612, "answer_id": 50125341, "question_id": 43502432, "link": "https://stackoverflow.com/questions/43502432/how-to-write-test-with-httprouter/50125341#50125341", "title": "How to write test with httprouter", "body": "<p>here is one more good blog and corresponding working code for this:</p>\n<blockquote>\n<p><a href=\"https://medium.com/@gauravsingharoy/build-your-first-api-server-with-httprouter-in-golang-732b7b01f6ab\" rel=\"nofollow noreferrer\">https://medium.com/@gauravsingharoy/build-your-first-api-server-with-httprouter-in-golang-732b7b01f6ab</a></p>\n<p><a href=\"https://github.com/gsingharoy/httprouter-tutorial/blob/master/part4/handlers_test.go\" rel=\"nofollow noreferrer\">https://github.com/gsingharoy/httprouter-tutorial/blob/master/part4/handlers_test.go</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1904, "user_id": 2794539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dfb46d5553134acc3bb086c33ee107f?s=128&d=identicon&r=PG&f=1", "display_name": "gaozhidf", "link": "https://stackoverflow.com/users/2794539/gaozhidf"}, "is_accepted": false, "score": 1, "last_activity_date": 1543909497, "creation_date": 1543909497, "answer_id": 53608002, "question_id": 43502432, "link": "https://stackoverflow.com/questions/43502432/how-to-write-test-with-httprouter/53608002#53608002", "title": "How to write test with httprouter", "body": "<p>u can try this without <code>ServeHTTP</code></p>\n\n<pre><code>func TestGetBook(t *testing.T) {\n    req := httptest.NewRequest(\"GET\", \"http://example.com/foo\", nil)\n    w := httptest.NewRecorder()\n\n    controllers.NewBookController().GetBook(w, req, []httprouter.Param{{Key: \"id\", Value: \"101\"}})\n\n    resp := w.Result()\n    body, _ := ioutil.ReadAll(resp.Body)\n\n    t.Log(resp.StatusCode)\n    t.Log(resp.Header.Get(\"Content-Type\"))\n    t.Log(string(body))\n}\n</code></pre>\n"}], "owner": {"reputation": 1237, "user_id": 4490615, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-AahyD50_HmQ/AAAAAAAAAAI/AAAAAAAAAVA/c8BqLWE3IQk/photo.jpg?sz=128", "display_name": "JSNoob", "link": "https://stackoverflow.com/users/4490615/jsnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3379, "favorite_count": 2, "accepted_answer_id": 43502894, "answer_count": 4, "score": 9, "last_activity_date": 1543909497, "creation_date": 1492623092, "last_edit_date": 1492625797, "question_id": 43502432, "link": "https://stackoverflow.com/questions/43502432/how-to-write-test-with-httprouter", "title": "How to write test with httprouter", "body": "<p>I am writing tests for a simple REST service in GoLang. But, because I am using <a href=\"https://github.com/julienschmidt/httprouter\" rel=\"noreferrer\">julienschmidt/httprouter</a> as the routing library. I am struggling on how to write test.</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nfunc main() {\n   router := httprouter.New()\n   bookController := controllers.NewBookController()\n   router.GET(\"/book/:id\", bookController.GetBook)\n   http.ListenAndServe(\":8080\", router)\n}\n</code></pre>\n\n<p>controllers</p>\n\n<pre><code>package controllers\n\ntype BookController struct {}\n\nfunc NewBookController *BookController {\n   return &amp;BookController()\n}\n\nfunc (bc BookController) GetBook(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n   fmt.Fprintf(w,\"%s\", p)\n}\n</code></pre>\n\n<p>My question is: How can test this while GetBook is neither HttpHandler nor HttpHandle</p>\n\n<p>If I use a traditional handler, the test will be easy like this</p>\n\n<pre><code>func TestGetBook(t *testing.T) {\n  req, _ := http.NewRequest(\"GET\", \"/book/sampleid\", nil)\n  rr := httptest.NewRecorder()\n  handler := controllers.NewBookController().GetBook\n  handler.ServeHTTP(rr,req)\n  if status := rr.code; status != http.StatusOK {\n    t.Errorf(\"Wrong status\")\n  }\n}\n</code></pre>\n\n<p>The problem is, httprouter is not handler, or handlefunc. So I am stuck now</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492623283, "post_id": 43502240, "comment_id": 74059286, "body": "Did you try reading the manual?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 2, "creation_date": 1492623661, "post_id": 43502240, "comment_id": 74059542, "body": "This has so many duplicates that it&#39;s just ridiculous. Google exists for a reason people."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 1, "creation_date": 1492625572, "post_id": 43502240, "comment_id": 74060754, "body": "I don&#39;t see how the question marked as answered is the same, and I did Google for it beforehand, as well as check the time docs.. there will probably be over a thousand people who want to do exactly what I asked so why are you so negative about me wanting to get more questions/answers related to Go which will help increase its popularity.."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492625769, "post_id": 43502240, "comment_id": 74060871, "body": "@fisker: Yes, there are a thousand people who want t odo exactly the same as you. Which is why it&#39;s so incredible that you didn&#39;t find an answer. But fear not: We&#39;ve now provided you a link to one of the exact duplicates."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492625880, "post_id": 43502240, "comment_id": 74060936, "body": "Except it&#39;s not a duplicate, his input string is completely different, and it has nothing to do with obtaining the value as Unix timestamp"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492626263, "post_id": 43502529, "comment_id": 74061163, "body": "Thanks a lot, I remember trying something similar, but after converting it back and fourth between Unix timestamp then it appeared to give different results.. not sure if it was because I wrote the layout string differently (e.g. 20160319) but it seems to work now :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492626487, "post_id": 43502529, "comment_id": 74061282, "body": "No problem, the reference timestamp is important for the layout, you have to use <code>01</code> as the month, <code>02</code> as the day, <code>2006</code> as the year, and so forth... If you used <code>03</code> as month, it&#39;s just not gonna work."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492626600, "post_id": 43502529, "comment_id": 74061353, "body": "Ahh, that explains it :).. I figured it was best if I used something between 13-31 as day so that it couldn&#39;t be confused as the month.."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1492623859, "last_edit_date": 1492623859, "creation_date": 1492623364, "answer_id": 43502529, "question_id": 43502240, "link": "https://stackoverflow.com/questions/43502240/convert-yyyymmdd-to-unix-time-in-go/43502529#43502529", "title": "Convert YYYYMMDD to Unix time in Go", "body": "<p>You are correct, you can use <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">time.Parse</a>, where the first argument is the layout of the second, the second being the value you want to parse.</p>\n\n<p>That means that if you know that the value you want to parse has this <code>YYYYMMDD</code> format you can use the <strong>reference time</strong> to construct the layout argument. And since the reference time is specified in the docs as <code>Mon Jan 2 15:04:05 -0700 MST 2006</code> your layout should look like this: <code>20060102</code>.</p>\n\n<pre><code>layout := \"20060102\"\nt, err := time.Parse(layout, date)\nif err != nil {\n   panic(err)\n}\nfmt.Println(t)\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1262, "favorite_count": 0, "closed_date": 1492624735, "accepted_answer_id": 43502529, "answer_count": 1, "score": -5, "last_activity_date": 1492623859, "creation_date": 1492622483, "question_id": 43502240, "link": "https://stackoverflow.com/questions/43502240/convert-yyyymmdd-to-unix-time-in-go", "closed_reason": "Duplicate", "title": "Convert YYYYMMDD to Unix time in Go", "body": "<p>I have a form input where I figure it would be easiest for the user to simply insert date as YYYYMMDD, so I was wondering how I should go about converting that user input to Unix time?</p>\n\n<pre><code>import \"time\"\n\nfunc SomeFormPOST(w http.ResponseWriter, r *http.Request) {\n  err := r.ParseForm()\n  // err handling\n  date := r.FormValue(\"date\")\n  unixDate := date.DOWHAT.Unix()\n}\n</code></pre>\n\n<p>I think maybe I need to use <code>t, _ = time.Parse(...)</code> but not haven't been able to figure it out..</p>\n"}, {"tags": ["mongodb", "go", "mongoose"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492623437, "post_id": 43502144, "comment_id": 74059401, "body": "We can&#39;t fix your code if you don&#39;t show us your code.  Also your first sentence doesn&#39;t make any sense. Is it meant to be an error message? Formatting would help."}, {"owner": {"reputation": 169, "user_id": 3838144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e04ca54aa48f9dd43dbbf4dd7a451f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3838144/rahul"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492623916, "post_id": 43502144, "comment_id": 74059718, "body": "its random error for sharded cluster"}, {"owner": {"reputation": 169, "user_id": 3838144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e04ca54aa48f9dd43dbbf4dd7a451f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3838144/rahul"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492704255, "post_id": 43502144, "comment_id": 74102488, "body": "here is the issue <a href=\"https://groups.google.com/forum/?utm_medium=email&amp;utm_source=footer#!msg/mongodb-user/FWpS1llOAnQ/gagNr5KtGAAJ\" rel=\"nofollow noreferrer\">groups.google.com/forum/&hellip;</a>"}, {"owner": {"reputation": 169, "user_id": 3838144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e04ca54aa48f9dd43dbbf4dd7a451f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3838144/rahul"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492704329, "post_id": 43502144, "comment_id": 74102545, "body": "@Flimzy its a common problem of mongodb engine ..."}, {"owner": {"reputation": 169, "user_id": 3838144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e04ca54aa48f9dd43dbbf4dd7a451f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3838144/rahul"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492704358, "post_id": 43502144, "comment_id": 74102565, "body": "@Flimzy see the discussion here <a href=\"https://groups.google.com/forum/?utm_medium=email&amp;utm_source=footer#!msg/mongodb-user/FWpS1llOAnQ/gagNr5KtGAAJ\" rel=\"nofollow noreferrer\">groups.google.com/forum/&hellip;</a>"}], "owner": {"reputation": 169, "user_id": 3838144, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e04ca54aa48f9dd43dbbf4dd7a451f9?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/3838144/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1492623801, "creation_date": 1492622182, "last_edit_date": 1492623801, "question_id": 43502144, "link": "https://stackoverflow.com/questions/43502144/golang-mongodb-driver-random-errnotfound-error-for-update-query-even-document-is", "title": "Golang mongodb driver random errnotfound error for update query even document is present for the criteria", "body": "<p>Golang mongodb driver random errnotfound error for update query even document is present for the criteria.</p>\n\n<p>I am using golang with mongodb but facing some weird issue while updating document.For some random call it throws error \"errNotFound\" even document is present for given criteria.</p>\n\n<p>it works well when query runs again.</p>\n"}, {"tags": ["mongodb", "go", "mongodb-query"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1492621253, "post_id": 43501791, "comment_id": 74058049, "body": "I&#39;m pretty sure this question has nothing to do with Go. It&#39;s just about how to form a MongoDB query."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492621309, "post_id": 43501791, "comment_id": 74058087, "body": "I&#39;m trying to complete this task from my Golang program. I added Go just so the answer will help me... thanks for the suggestion though (and the edit...)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492621384, "post_id": 43501791, "comment_id": 74058130, "body": "Sure, you&#39;re using it in Go, but once you have a working query, you can use it in any language."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492621407, "post_id": 43501791, "comment_id": 74058145, "body": "I&#39;m happy with how my question is."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492621461, "post_id": 43501791, "comment_id": 74058179, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17044587/how-to-aggregate-sum-in-mongodb-to-get-a-total-count\">How to aggregate sum in MongoDB to get a total count?</a>"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492621464, "post_id": 43501791, "comment_id": 74058184, "body": "Have you tried <code>$count</code> instead of <code>$size</code>?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1492621926, "post_id": 43501791, "comment_id": 74058491, "body": "I&#39;ve tried these things... the only issue is that <code>PostCount int `json:&quot;postCount&quot;`</code> might not be actually the field catching the result of the post count.  What would the <code>&quot;$size&quot;: &quot;posts&quot;</code> &#39;s field name be?"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1492622412, "post_id": 43501791, "comment_id": 74058817, "body": "Flimzy, can you just  leave my post alone, I&#39;m not trying to sum numbers in an array..."}, {"owner": {"reputation": 268112, "user_id": 1259510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0840e2c5392970ef26cbfef84a0e4903?s=128&d=identicon&r=PG", "display_name": "JohnnyHK", "link": "https://stackoverflow.com/users/1259510/johnnyhk"}, "edited": false, "score": 1, "creation_date": 1492623997, "post_id": 43501791, "comment_id": 74059769, "body": "<a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/size/#exp._S_size\" rel=\"nofollow noreferrer\"><code>$size</code></a> is an <code>aggregate</code> operator; you can&#39;t use it with <code>find</code>."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1492624096, "post_id": 43501791, "comment_id": 74059828, "body": "Ok thank you. Would you recommend I select all the posts and count them in my program, or store a new key such as <code>postCount</code>?"}, {"owner": {"reputation": 268112, "user_id": 1259510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0840e2c5392970ef26cbfef84a0e4903?s=128&d=identicon&r=PG", "display_name": "JohnnyHK", "link": "https://stackoverflow.com/users/1259510/johnnyhk"}, "edited": false, "score": 1, "creation_date": 1492624336, "post_id": 43501791, "comment_id": 74059991, "body": "No, use an <a href=\"https://docs.mongodb.com/manual/aggregation/\" rel=\"nofollow noreferrer\">aggregation pipeline</a> for your query instead of <code>Find</code>. Your question appears to be a dupe of <a href=\"http://stackoverflow.com/questions/6722850/querying-internal-array-size-in-mongodb\" title=\"querying internal array size in mongodb\">stackoverflow.com/questions/6722850/&hellip;</a>"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 458, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492622377, "creation_date": 1492621015, "last_edit_date": 1492622377, "question_id": 43501791, "link": "https://stackoverflow.com/questions/43501791/count-struct-slice-length-in-mongodb-query", "title": "Count struct slice length in MongoDB query", "body": "<p>I'm using MongoDB with Golang.</p>\n\n<p>I have the following struct which my query result will write to:</p>\n\n<pre><code>var slacks []struct {\n        Name        string `json:\"name\"`\n        Description string `json:\"description\"`\n        PostCount   int    `json:\"postCount\"`\n    } `json:\"slacks\"`\n}\n</code></pre>\n\n<p>I have documents in my collection which look like:</p>\n\n<pre><code>type slack struct {\n    ID          bson.ObjectId   `bson:\"_id\"`\n    Name        string          `bson:\"name\"`\n    Description string          `bson:\"description\"`\n    Posts       []post          `bson:\"posts\"`\n}\n</code></pre>\n\n<p>My aim is to count the posts in each slack using a MongoDB query.\nI've got this so far:</p>\n\n<pre><code>db.C(\"slacks\").Find(&amp;bson.M{\"name\": &amp;bson.RegEx{\n    Pattern: \".*\" + searchStr + \".*\",\n    Options: \"i\",\n}}).Select(&amp;bson.M{\n    \"name\":        1,\n    \"description\": 1,\n    \"$size\":       \"posts\",\n}).All(&amp;slacks)\n</code></pre>\n\n<p>But <code>{\"$size\": \"posts\"}</code> doesn't do the trick.</p>\n\n<p>How can I query the length of an array/slice of struct in a MongoDB query in Golang?</p>\n"}, {"tags": ["go", "form-submit", "beego"], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1492664082, "post_id": 43507912, "comment_id": 74075090, "body": "I also think about it, but is it not ugly? I get object from database and apply form data to it. Why it override id which is not in form?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1492667447, "post_id": 43507912, "comment_id": 74076246, "body": "You&#39;d have to show us your <code>ParseForm</code> method, I have no idea why it overwrites it"}, {"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1492668841, "post_id": 43507912, "comment_id": 74076938, "body": "It&#39;s not mine, it from beego"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 3, "last_activity_date": 1492669992, "last_edit_date": 1492669992, "creation_date": 1492645866, "answer_id": 43507912, "question_id": 43501021, "link": "https://stackoverflow.com/questions/43501021/what-is-correct-way-to-handle-form-submission-in-beego/43507912#43507912", "title": "What is correct way to handle form submission in beego?", "body": "<p>Just add the ID after you parse the form:</p>\n\n<pre><code>if err := c.ParseForm(&amp;service); err != nil {\n    c.Abort(\"500\")\n}\nservice.Id = id\n</code></pre>\n\n<p>Looking through beego's source, I <em>think</em> you could do:</p>\n\n<pre><code>if c.Ctx.Input.IsPost() {\n    c.Input().Add(\"id\", id)\n    err = nil\n    if err := c.ParseForm(&amp;service); err != nil {\n        c.Abort(\"500\")\n    }\n\n    serviceModel.CreateOrUpdate(service)\n}\n</code></pre>\n\n<p>But if not, I would just restructure your code a little bit:</p>\n\n<pre><code>func (c *ServicesController) Edit() {\n    var id, _ = c.GetUint64(\":id\")\n    var service models.Service{}\n    var serviceModel = models.Service{}\n    var err error\n\n    if c.Ctx.Input.IsPost() {\n        if err = c.ParseForm(&amp;service); err != nil {\n            c.Abort(\"500\")\n        }\n        service.Id = id\n        serviceModel.CreateOrUpdate(service)\n    } else {\n        service, err = serviceModel.FindById(id)\n        if err == orm.ErrNoRows || err == orm.ErrMissPK  {\n        c.Abort(\"404\")\n    }\n\n    c.Data[\"Service\"] = service\n    c.TplName = \"services/edit.html\"\n}\n</code></pre>\n"}], "owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 43507912, "answer_count": 1, "score": 2, "last_activity_date": 1492669992, "creation_date": 1492618554, "question_id": 43501021, "link": "https://stackoverflow.com/questions/43501021/what-is-correct-way-to-handle-form-submission-in-beego", "title": "What is correct way to handle form submission in beego?", "body": "<p>I'm trying to submit form data in beego and store it to database. And have some questions:</p>\n\n<ul>\n<li>how correct handle request and transform it to object?</li>\n<li>Should I validate request or transformed object?</li>\n</ul>\n\n<p>My controller action:</p>\n\n<pre><code>func (c *ServicesController) Edit() {\n    var err error\n    var id, _ = c.GetUint64(\":id\")\n    var serviceModel = models.Service{}\n    var service models.Service\n\n    service, err = serviceModel.FindById(id)\n\n    c.Data[\"Service\"] = service\n\n    if err == orm.ErrNoRows || err == orm.ErrMissPK  {\n        c.Abort(\"404\")\n    }\n\n    if c.Ctx.Input.IsPost() {\n        err = nil\n        if err := c.ParseForm(&amp;service); err != nil {\n            c.Abort(\"500\")\n        }\n\n        serviceModel.CreateOrUpdate(service)\n    }\n\n    c.TplName = \"services/edit.html\"\n}\n</code></pre>\n\n<p>Model:</p>\n\n<pre><code>type Service struct {\n    Id       uint64 `form:\"-\"`\n    Name     string `orm:\"size(100)\" valid:\"Required; MaxSize(100)\" form:\"name\"`\n}\n\nfunc init() {\n    orm.RegisterModel(new(Service))\n}\n\nfunc (s *Service) FindById(id uint64) (Service, error) {\n    o := orm.NewOrm()\n    service := Service{Id: id}\n    err := o.Read(&amp;service)\n\n    return service, err\n}\n\nfunc (s *Service) CreateOrUpdate(service Service)  {\n    o := orm.NewOrm()\n    o.InsertOrUpdate(&amp;service)\n}\n</code></pre>\n\n<p>But when I'm trying to submit form (with <code>InsertOrUpdate</code>) it anyway creates new object because I have no id field in the form (because I retrieving object from id param from route). Should I pass id to form anyway or how to hack it?</p>\n"}, {"tags": ["go", "projects-and-solutions", "directory-structure"], "comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 3, "creation_date": 1492612210, "post_id": 43498585, "comment_id": 74051565, "body": "Try <a href=\"https://golang.org/doc/code.html#Library\" rel=\"nofollow noreferrer\">creating a library</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1492612441, "post_id": 43498585, "comment_id": 74051763, "body": "Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>, it explains all of this."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1492619029, "post_id": 43498585, "comment_id": 74056559, "body": "@MadWombat is following the tested, validated, recommended way &quot;something stupid&quot;? If the designer of a machine tells you: &quot;You must first press this button, then you can do X.&quot; would you also ask what evidence there is that it is better to press the button first? Is &quot;the creator of the tool told you to do so&quot; not evidence enough? Well, probably not where ego is as strong as in programming."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 2, "creation_date": 1492619568, "post_id": 43498585, "comment_id": 74056917, "body": "That&#39;s the thing. A programming language is not just a machine, it is a tool. And as a user of the tool I have to understand how it works, otherwise I cannot use it. So no, I am not going to just &quot;press button X&quot;, I need to know exactly why I am doing this and what is going to happen.  And yes, forcing me to structure my source code using domain names as directory names is mind bogglingly stupid to the point of being insulting. Fortunately, vendor support takes some of the pain away."}, {"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1492657245, "post_id": 43498585, "comment_id": 74073177, "body": "@Volker You are missing the point of this question. This question is not about whether I should or should not follow what the documentation says.  This question is about what scenario would cause problems for me if I do not follow the documentation. That would help me to understand better the usefulness of following the documentation."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1492615770, "creation_date": 1492615770, "answer_id": 43500069, "question_id": 43498585, "link": "https://stackoverflow.com/questions/43498585/when-is-it-really-necessary-to-place-go-source-code-in-gopath-src/43500069#43500069", "title": "When is it really necessary to place Go source code in $GOPATH/src?", "body": "<p>The standard Go tools look in the <code>$GOPATH</code> subdirectories <code>src</code>, <code>pkg</code>, and <code>bin</code>. For example,</p>\n\n<p><code>currency.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"golang.org/x/text/currency\"\n)\n\nfunc main() {\n    t1799, _ := time.Parse(\"2006-01-02\", \"1799-01-01\")\n    for it := currency.Query(currency.Date(t1799)); it.Next(); {\n        from := \"\"\n        if t, ok := it.From(); ok {\n            from = t.Format(\"2006-01-01\")\n        }\n        fmt.Printf(\"%v is used in %v since: %v\\n\", it.Unit(), it.Region(), from)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go build currency.go\ncurrency.go:7:2: cannot find package \"golang.org/x/text/currency\" in any of:\n    /home/peter/go/src/golang.org/x/text/currency (from $GOROOT)\n    /home/peter/gopath/src/golang.org/x/text/currency (from $GOPATH)\n$ \n</code></pre>\n\n<p>If we put the missing package in <code>$GOPATH/src</code>, the standard Go tools will find it.</p>\n\n<pre><code>$ go get golang.org/x/text/currency\n$ go build currency.go\n$ ./currency\nGBP is used in GB since: 1694-07-07\nGIP is used in GI since: 1713-01-01\nUSD is used in US since: 1792-01-01\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 2, "last_activity_date": 1492616945, "creation_date": 1492616945, "answer_id": 43500486, "question_id": 43498585, "link": "https://stackoverflow.com/questions/43498585/when-is-it-really-necessary-to-place-go-source-code-in-gopath-src/43500486#43500486", "title": "When is it really necessary to place Go source code in $GOPATH/src?", "body": "<p>As JimB says in his comment, the Go <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">documentation</a> makes this clear; basically, the GOPATH is <em>workspace</em> which allows you to keep all your project files and imports and artifacts in one location.</p>\n\n<p>For a simple project it's not strictly necessary, but when you begin importing dependencies and want to manage libraries it becomes more helpful.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 2, "last_activity_date": 1492629980, "last_edit_date": 1492629980, "creation_date": 1492626936, "answer_id": 43503588, "question_id": 43498585, "link": "https://stackoverflow.com/questions/43498585/when-is-it-really-necessary-to-place-go-source-code-in-gopath-src/43503588#43503588", "title": "When is it really necessary to place Go source code in $GOPATH/src?", "body": "<p>You <em>really</em> need to put your code in a <code>GOPATH</code> once you write more than a <code>package main</code>. When you <code>import \"github.com/me/myapp/mylib\"</code>, Go will look under your <code>GOPATH</code> for that. Tools like <code>go test</code> also work in terms of packages under <code>GOPATH</code>, not <code>.go</code> files.</p>\n\n<p>It also becomes the more practical thing to do as soon as your code is in more than one file. It's like the difference between compiling your C program by directly invoking <code>cc</code>/<code>gcc</code>/etc. and using a tool like <code>make</code>.</p>\n\n<p>If you're starting out and wondering why people want to break up projects into multiple packages in the first place, reasons include:</p>\n\n<ul>\n<li>Projects grow, and by 10K or 100K lines you really need to organize.</li>\n<li>Projects often turn out to contain reusable tools, and packages let other projects <code>import</code> them separately.</li>\n<li>Packages let you track and control what code has access to what other code and variables. For instance, private names in one package aren't accessible for other packages, so you know you can mess around with that private stuff without breaking code outside the package, and you know that no code outside is futzing with private fields/variables or calling private code behind your back.</li>\n<li>Packages minimize namespace collisions, i.e., you can have <code>gzip.Reader</code> and <code>io.Reader</code>. If you choose your names right, <code>packagename.ThingName</code> can make code read naturally.</li>\n<li>Packages can be recompiled, tested, etc. individually, which keeps your edit/build/test cycle faster.</li>\n<li>In Go specifically, packages enforce some other things about your code organization, like no cyclic dependencies (if A imports B, B doesn't directly or indirectly import A) and that packages under <code>/foo/internal/</code> only get used by packages under <code>/foo/</code>. Constraints like these can help keep a big project from ending up like tangled spaghetti.</li>\n</ul>\n\n<p>There are other benefits but those should help show why it's worth getting in the habit. It's fine to just charge forward writing things in a big package for a little bit and start breaking up files moving some types, functions, etc. out into other packages as needed; the 'natural' boundaries will start to make more sense over time. </p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2009, "favorite_count": 1, "accepted_answer_id": 43500069, "answer_count": 3, "score": 4, "last_activity_date": 1492629980, "creation_date": 1492612008, "question_id": 43498585, "link": "https://stackoverflow.com/questions/43498585/when-is-it-really-necessary-to-place-go-source-code-in-gopath-src", "title": "When is it really necessary to place Go source code in $GOPATH/src?", "body": "<p>Take a look at this shell session, where I build a simple hello world program in Go.</p>\n\n<pre><code>$ cd ~/lab/hello/\n$ ls\nhello.go\n$ cat hello.go \npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"hello, world\\n\")\n}\n$ go build\n$ ./hello \nhello, world\n$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n$ lsb_release -a\nNo LSB modules are available.\nDistributor ID: Debian\nDescription:    Debian GNU/Linux 8.7 (jessie)\nRelease:    8.7\nCodename:   jessie\n</code></pre>\n\n<p>Here is what I don't understand. The tutorial at <a href=\"https://golang.org/doc/install#testing\" rel=\"nofollow noreferrer\">https://golang.org/doc/install#testing</a> says that I should place my <code>hello.go</code> file at ~/go/src/hello. But I am not following this. How is my program compiling then? If my program is compiling fine in this manner, why does the documentation say that I should keep my source code at ~/go/src or $GOPATH/src when it does not seem to matter?</p>\n\n<p>Is there a scenario where it is really necessary to place the source code at $GOPATH/src?</p>\n"}, {"tags": ["go", "struct", "model", "annotations", "beego"], "answers": [{"comments": [{"owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 0, "creation_date": 1492612432, "post_id": 43498691, "comment_id": 74051755, "body": "tank you! should I set <code>orm:&quot;id&quot;</code> or it&#39;s ok to miss it ad it will be with some kind of autogenerating?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "edited": false, "score": 1, "creation_date": 1492613784, "post_id": 43498691, "comment_id": 74052848, "body": "@OleksandrSavchenko You can leave it out, it was just an example. Read more about it here: <a href=\"https://beego.me/docs/mvc/model/overview.md\" rel=\"nofollow noreferrer\">Models \u2013 Beego ORM</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1492613835, "last_edit_date": 1495540015, "creation_date": 1492612277, "answer_id": 43498691, "question_id": 43498452, "link": "https://stackoverflow.com/questions/43498452/is-it-possible-to-use-multiple-annotations-in-beego/43498691#43498691", "title": "Is it possible to use multiple annotations in beego?", "body": "<p>Quoting from <a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\"><code>reflect.StructTag</code></a>:</p>\n\n<blockquote>\n  <p>By convention, tag strings are a concatenation of optionally space-separated key:\"value\" pairs.</p>\n</blockquote>\n\n<p>So you may specify multiple key-value pairs separated by space, like:</p>\n\n<pre><code>type Service struct {\n    Id uint64 `form:\"id\" valid:\"Range(1, 999)\" orm:\"auto\"`\n}\n</code></pre>\n\n<p>See more about tags in this answer: <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a></p>\n"}], "owner": {"reputation": 549, "user_id": 611527, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d8eae5f2829023af325878239f0adc5c?s=128&d=identicon&r=PG", "display_name": "Oleksandr Savchenko", "link": "https://stackoverflow.com/users/611527/oleksandr-savchenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 43498691, "answer_count": 1, "score": 2, "last_activity_date": 1492614316, "creation_date": 1492611670, "last_edit_date": 1492614316, "question_id": 43498452, "link": "https://stackoverflow.com/questions/43498452/is-it-possible-to-use-multiple-annotations-in-beego", "title": "Is it possible to use multiple annotations in beego?", "body": "<p>I have model like:</p>\n\n<pre><code>type Service struct {\n    Id       uint64 \n    Name     string \n    Secret   string \n    Disabled bool\n}\n</code></pre>\n\n<p>And want to use annotations like <code>form</code>, <code>valid</code> and <code>orm</code>. And I can't find how I should declare these annotations. Should it be one or many? If many, what separator should I use?</p>\n"}, {"tags": ["date", "go", "time"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1492605513, "post_id": 43495745, "comment_id": 74046194, "body": "What does <i>&quot; filter this time from this timestamp&quot;</i> mean? You want to get back the number <code>651387237</code> from the <code>time.Time</code> value? And what random date? In what range?"}, {"owner": {"reputation": 59, "user_id": 7888395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozUlt.jpg?s=128&g=1", "display_name": "Rahul Prabhu", "link": "https://stackoverflow.com/users/7888395/rahul-prabhu"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1492605825, "post_id": 43495745, "comment_id": 74046454, "body": "@icza I want to get a random date say May 22, 2009. How do I get that?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1492605939, "post_id": 43495745, "comment_id": 74046538, "body": "What is the <i>range</i> you want random dates in? Min and Max dates?"}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1492613172, "post_id": 43497333, "comment_id": 74052353, "body": "This is an acceptable way to generate a random date and shouldn&#39;t be marked down."}, {"owner": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "edited": false, "score": 2, "creation_date": 1492618502, "post_id": 43497333, "comment_id": 74056193, "body": "It works, but it isn&#39;t evenly distributed. Eg. March 1 will appear much more often than it should. Even if you do the obvious fix of limiting the day of month to valid numbers, you then just change the bad distribution and dates in Feb. will be chosen more than they should."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "edited": false, "score": 1, "creation_date": 1492621618, "post_id": 43497333, "comment_id": 74058291, "body": "Good point @JamesAntill I&#39;ve updated my answer, but to my defense, it was not my intention to provide a full-fledged solution without knowing more about the problem, all I intended to do is to point out that <code>math&#47;rand</code> could be used for something like random dates, whether that&#39;s something the OP is looking for, I cannot tell."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 20, "last_activity_date": 1492621064, "last_edit_date": 1492621064, "creation_date": 1492608906, "answer_id": 43497333, "question_id": 43495745, "link": "https://stackoverflow.com/questions/43495745/how-to-generate-random-date-in-go-lang/43497333#43497333", "title": "How to generate random date in Go lang?", "body": "<p>You can use <code>math/rand</code> to generate a random date like this:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc randate() time.Time {\n    min := time.Date(1970, 1, 0, 0, 0, 0, 0, time.UTC).Unix()\n    max := time.Date(2070, 1, 0, 0, 0, 0, 0, time.UTC).Unix()\n    delta := max - min\n\n    sec := rand.Int63n(delta) + min\n    return time.Unix(sec, 0)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/x1CK6nIO-v\" rel=\"noreferrer\">https://play.golang.org/p/x1CK6nIO-v</a></p>\n"}], "owner": {"reputation": 59, "user_id": 7888395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozUlt.jpg?s=128&g=1", "display_name": "Rahul Prabhu", "link": "https://stackoverflow.com/users/7888395/rahul-prabhu"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4463, "favorite_count": 0, "closed_date": 1492610159, "answer_count": 1, "score": -7, "last_activity_date": 1537841259, "creation_date": 1492604802, "last_edit_date": 1537841259, "question_id": 43495745, "link": "https://stackoverflow.com/questions/43495745/how-to-generate-random-date-in-go-lang", "closed_reason": "Needs details or clarity", "title": "How to generate random date in Go lang?", "body": "<pre><code>time.Date(2009, 11, 17, 20, 34, 58, 651387237, time.UTC)\n</code></pre>\n\n<p>The above code gives us a timestamp but, what if I want to fetch only the date part and the time part separately? Is it possible to use split()?</p>\n"}, {"tags": ["go", "orm", "beego"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492614286, "post_id": 43495297, "comment_id": 74053219, "body": "Your possible solution is the way to do it in beego&#39;s orm: <a href=\"https://github.com/astaxie/beego/issues/1258\" rel=\"nofollow noreferrer\">github.com/astaxie/beego/issues/1258</a>"}, {"owner": {"reputation": 11, "user_id": 7882642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095064ed7fcf5b8caa38adb82239edf4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7882642/max"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492670698, "post_id": 43495297, "comment_id": 74077990, "body": "@mkopriva Thank you. I saw this post too. Since this post is 2 years old, I was hoping there is a new approach. The working approach is very bad performance wise."}, {"owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "edited": false, "score": 0, "creation_date": 1531989946, "post_id": 43495297, "comment_id": 89807228, "body": "Hi Max - Did you find a solution to this please,thank you."}], "owner": {"reputation": 11, "user_id": 7882642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095064ed7fcf5b8caa38adb82239edf4?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/7882642/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 873, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1492603625, "creation_date": 1492603625, "question_id": 43495297, "link": "https://stackoverflow.com/questions/43495297/loadrelated-of-a-list-in-beego", "title": "LoadRelated of a list in beego", "body": "<p>I am wondering how the correct approach is to load related fields in beego. \nThe <a href=\"https://beego.me/docs/mvc/model/query.md\" rel=\"nofollow noreferrer\">doc</a> explains it like this:</p>\n\n<pre><code>type User struct {\n   Id    int\n   Name  string\n   Posts []*Post `orm:\"reverse(many)\"`\n}\n\nuser := User{Id: 1}\nerr := dORM.Read(&amp;user)\nnum, err := dORM.LoadRelated(&amp;user, \"Posts\")\n</code></pre>\n\n<p>This makes sense as long as I only query one record. What is the correct way to fetch related fields when I query all users?</p>\n\n<p>A possible solution would be like this:</p>\n\n<pre><code>var users []*User\no.QueryTable(new(User)).All(&amp;users)\nfor _, user := range users {\n    o.LoadRelated(controlCategory, \"Posts\")\n}\n</code></pre>\n\n<p>However, this means I have to loop everytime over the complete list and make for every record a DB query to load all records. </p>\n\n<p>Any suggestions? Thanks!</p>\n"}, {"tags": ["go", "lambda", "lifecycle", "channel"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1492600069, "post_id": 43493918, "comment_id": 74042255, "body": "You could avoid this closing the channel. If you can&#39;t because of many functions that use  the channel in write, than you should set up a control channel."}, {"owner": {"reputation": 97, "user_id": 4833933, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/846c9916c1af5ed44798c60033c5a704?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4833933/eric"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1492600570, "post_id": 43493918, "comment_id": 74042639, "body": "I know this can be avoided, but I&#39;m not looking to do so, but rather to know what happens. Another aspect is whether this is bad or not, and I honestly have no answer to that either."}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1492601553, "post_id": 43493918, "comment_id": 74043298, "body": "Your code is broken as you write 10 values in a channel, but you just read the first. To have a proper test, you should read all the values."}, {"owner": {"reputation": 97, "user_id": 4833933, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/846c9916c1af5ed44798c60033c5a704?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4833933/eric"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1492602118, "post_id": 43493918, "comment_id": 74043693, "body": "I&#39;m sorry but you seem to misunderstand the purpose of my code. The entire point is to only read one value and leave the other nine. It&#39;s not a test of anything and has no point rather than to illustrate my question. And to be fair, I only write two values to the channel each time, The first, being the one that is both written and read, and the second, written but never read. The remaining eight are neither written nor read."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1492603509, "last_edit_date": 1492603509, "creation_date": 1492601634, "answer_id": 43494573, "question_id": 43493918, "link": "https://stackoverflow.com/questions/43493918/what-happens-when-an-anonymous-function-waits-on-channel-forever-in-golang/43494573#43494573", "title": "What happens when an anonymous function waits on channel forever in golang?", "body": "<p>You have a goroutine leak.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"runtime\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    for {\n        text := foo()\n        fmt.Println(text, \"NumGoroutine\", runtime.NumGoroutine())\n        time.Sleep(time.Second)\n    }\n}\n\nfunc foo() string {\n    ch := make(chan string)\n    for i := 0; i &lt; 10; i++ {\n        // Create some threads\n        go func(i int) {\n            time.Sleep(time.Duration(rand.Intn(1000)) * time.Millisecond)\n            ch &lt;- strconv.Itoa(i)\n        }(i)\n    }\n    return &lt;-ch\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run leak.go\n4 NumGoroutine 10\n4 NumGoroutine 20\n0 NumGoroutine 28\n8 NumGoroutine 37\n2 NumGoroutine 46\n8 NumGoroutine 55\n2 NumGoroutine 64\n3 NumGoroutine 73\n8 NumGoroutine 82\n1 NumGoroutine 91\n4 NumGoroutine 100\n&lt;&lt;--SNIP--&gt;&gt;\n4 NumGoroutine 4006\n7 NumGoroutine 4015\n6 NumGoroutine 4024\n9 NumGoroutine 4033\n9 NumGoroutine 4042\n9 NumGoroutine 4051\n1 NumGoroutine 4060\n0 NumGoroutine 4069\n4 NumGoroutine 4078\n0 NumGoroutine 4087\n6 NumGoroutine 4096\n^Csignal: interrupt\n$\n</code></pre>\n\n<p>Like a memory leak, a goroutine leak is bad.</p>\n\n<p>For some background, see <a href=\"https://github.com/golang/go/issues/19702\" rel=\"nofollow noreferrer\">Go: proposal: runtime: garbage collect goroutines blocked forever #19702: Closed.</a></p>\n"}], "owner": {"reputation": 97, "user_id": 4833933, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/846c9916c1af5ed44798c60033c5a704?s=128&d=identicon&r=PG&f=1", "display_name": "Eric", "link": "https://stackoverflow.com/users/4833933/eric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 2, "accepted_answer_id": 43494573, "answer_count": 1, "score": 2, "last_activity_date": 1492603509, "creation_date": 1492599792, "question_id": 43493918, "link": "https://stackoverflow.com/questions/43493918/what-happens-when-an-anonymous-function-waits-on-channel-forever-in-golang", "title": "What happens when an anonymous function waits on channel forever in golang?", "body": "<p>I have a function creating a channel with no buffer. This function goes on to create several other concurrent anonymous functions writing to said channel. The function then goes on to wait for input on the channel and then returns the value. </p>\n\n<p>See example below \n</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"fmt\"\n    \"strconv\"\n    \"math/rand\"\n)\n\nfunc main() {\n    for{\n        text := foo()\n        fmt.Println(text)\n        time.Sleep(time.Second)\n    }\n\n}\n\nfunc foo() string {    \n    ch := make(chan string)\n    for i := 0; i &lt; 10; i++ {\n        // Create some threads\n        go func(i int) {\n            time.Sleep(time.Duration(rand.Intn(1000))*time.Millisecond)\n            ch &lt;- strconv.Itoa(i)\n        }(i)\n    }\n    return &lt;- ch\n}\n</code></pre>\n\n<p>What happens with the anonymous functions that are still waiting on the channel, even though the entire function (foo in example) is \"dead\"?</p>\n\n<p>Will they be collected as garbage, or will they forever wander the limbo of my computers memory (or until I kill the main thread) eating away at it in a desperate attempt to send their last message before passing on?</p>\n"}, {"tags": ["string", "go", "file-io", "null"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1492607182, "post_id": 43490148, "comment_id": 74047422, "body": "I don&#39;t think &quot;enter a null value&quot; makes sense. Null is the absence of input.  The closest you can get in a stream input would be a 0-length string, but as you know <code>&quot;&quot;</code> is not the same as <code>nil</code> in Go (or almost any language)."}, {"owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 0, "creation_date": 1492607494, "post_id": 43490148, "comment_id": 74047638, "body": "<a href=\"http://stackoverflow.com/questions/18594330/what-is-the-best-way-to-test-for-an-empty-string-in-go\" title=\"what is the best way to test for an empty string in go\">stackoverflow.com/questions/18594330/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1492590414, "last_edit_date": 1492590414, "creation_date": 1492590069, "answer_id": 43490238, "question_id": 43490148, "link": "https://stackoverflow.com/questions/43490148/how-do-i-check-if-the-user-has-entered-a-null-value-in-go/43490238#43490238", "title": "How do I check if the user has entered a null value in Go?", "body": "<p><a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"noreferrer\"><code>bufio.Reader.ReadString()</code></a> returns a <code>string</code> that also <strong>contains the delimeter</strong>, in this case the newline character <code>\\n</code>.</p>\n\n<p>If the user does not enter anything just presses the <kbd>Enter</kbd> key, the return value of <code>ReadString()</code> will be <code>\"\\n\"</code>, so you have to compare the result to <code>\"\\n\"</code> to check for empty input:</p>\n\n<pre><code>reader := bufio.NewReader(os.Stdin)\nfmt.Print(\"Enter text: \")\ntext, err := reader.ReadString('\\n')\nif err != nil {\n    panic(err) // Don't forget to check and handle returned errors!\n}\n\nif text == \"\\n\" {\n    fmt.Println(\"No input!\")\n} else {\n    fmt.Println(\"Hello\", text)\n}\n</code></pre>\n\n<p>An even better alternative would be to use <a href=\"https://golang.org/pkg/strings/#TrimSpace\" rel=\"noreferrer\"><code>strings.TrimSpace()</code></a> which removes leading and trailing white space characters (newline included; it isn't a meaningful name if someone inputs 2 spaces and presses <kbd>Enter</kbd>, this solution also filters that out). You can compare to the empty string <code>\"\"</code> if you called <code>strings.TrimSpace()</code> prior:</p>\n\n<pre><code>text = strings.TrimSpace(text)\nif text == \"\" {\n    fmt.Println(\"No input!\")\n} else {\n    fmt.Println(\"Hello\", text)\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7888395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozUlt.jpg?s=128&g=1", "display_name": "Rahul Prabhu", "link": "https://stackoverflow.com/users/7888395/rahul-prabhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492590629, "creation_date": 1492589772, "last_edit_date": 1492590629, "question_id": 43490148, "link": "https://stackoverflow.com/questions/43490148/how-do-i-check-if-the-user-has-entered-a-null-value-in-go", "title": "How do I check if the user has entered a null value in Go?", "body": "<pre><code>reader := bufio.NewReader(os.Stdin)\nfmt.Print(\"Enter text: \")\ntext, _ := reader.ReadString('\\n')\nfmt.Println(\"Hello\",text)\n</code></pre>\n\n<p>How do I check if the user has entered a null value and where do I put the code? Note - I've already tried checking the length <code>= 0</code> and <code>= \" \"</code> but, they don't seem to be working.</p>\n\n<p>Please suggest an alternative way for doing this. Thanks!</p>\n"}, {"tags": ["go", "publish-subscribe"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492590683, "post_id": 43490037, "comment_id": 74035649, "body": "<code>acker</code> and <code>puller</code> should be defined in <code>cloud.google.com&#47;go&#47;pubsub</code> if you have the full package, all its files etc. Where are you running the tests from? What folder?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492590905, "post_id": 43490037, "comment_id": 74035776, "body": "The <code>cloud.google.com&#47;go&#47;pubsub</code> package should, besides the <code>iterator.go</code> file, contain an <code>acker.go</code> file and a <code>puller.go</code> file, the two types you&#39;re missing are defined in those two files. Do you have those two files in the pubsub folder?"}, {"owner": {"reputation": 135, "user_id": 5850539, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201452242264529/picture?type=large", "display_name": "Takash Futada", "link": "https://stackoverflow.com/users/5850539/takash-futada"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492592770, "post_id": 43490037, "comment_id": 74037054, "body": "When I did clean install the entire package, go get -u cloud.google.com/go, both of codes are appeared. Thanks a lot."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492593212, "post_id": 43490037, "comment_id": 74037358, "body": "No problem, I&#39;m glad you got it fixed."}], "owner": {"reputation": 135, "user_id": 5850539, "user_type": "registered", "profile_image": "https://graph.facebook.com/10201452242264529/picture?type=large", "display_name": "Takash Futada", "link": "https://stackoverflow.com/users/5850539/takash-futada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492589412, "creation_date": 1492589412, "question_id": 43490037, "link": "https://stackoverflow.com/questions/43490037/cloud-google-com-go-pubsub-iterator-go44-undefined-acker-and-puller", "title": "cloud.google.com/go/pubsub iterator.go:44: undefined: acker and puller", "body": "<p>I'm hitting the following error messages when I build codes that employ cloud.google.com/go/pubsub.\nAm I working on a wrong package? Or it's just because of alpha?</p>\n\n<pre><code>$ go test\n# cloud.google.com/go/pubsub\n./iterator.go:44: undefined: acker\n./iterator.go:46: undefined: puller\nFAIL    cloud.google.com/go/pubsub [build failed]\n</code></pre>\n"}, {"tags": ["performance", "go"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1492586319, "post_id": 43488986, "comment_id": 74032885, "body": "Try running <code>go run -race *.go</code>"}, {"owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1492586573, "post_id": 43488986, "comment_id": 74033063, "body": "@Acidic I&#39;ve already tried that.  Maybe it&#39;s not some race condition. Thanks anyway."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1492587664, "post_id": 43488986, "comment_id": 74033773, "body": "@Eagle <a href=\"https://golang.org/src/database/sql/sql.go?#L1437\" rel=\"nofollow noreferrer\">/database/sql/sql.go:1440</a> is waiting for a transaction to be committed or rolled back. You can check your code for transactions that are not resolved."}, {"owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1492587970, "post_id": 43488986, "comment_id": 74033967, "body": "@JohnSPerayil I&#39;ve checked my code. There are a lot of APIs which use SQL transaction. But I cannot find one without <code>Rollback</code> or <code>Commit</code>. That&#39;s why I want to get the full stack traces. Thanks anyway."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492628950, "post_id": 43488986, "comment_id": 74062721, "body": "To be fair, the trace isn&#39;t incomplete. It&#39;s being called as <code>go tx.awaitDone()</code>. Each goroutine has its own stack, so that is the beginning on the stack for the goroutine you&#39;re examining."}, {"owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492660915, "post_id": 43488986, "comment_id": 74074179, "body": "@Adrian Yes, you&#39;re right. I&#39;ve updated the question. Now I&#39;m trying to modify some go source code to track the bug."}], "answers": [{"comments": [{"owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "edited": false, "score": 0, "creation_date": 1493185072, "post_id": 43583407, "comment_id": 74300349, "body": "Thanks. Using &quot;defer&quot; is far better. I just added <code>Rollback</code> or <code>Commit</code> before each <code>return</code>. However, I suppose it should achieve the same effect as your code."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "edited": false, "score": 0, "creation_date": 1493208098, "post_id": 43583407, "comment_id": 74315009, "body": "@Eagle yes, defer produces cleaner code for the same functionality. I can&#39;t think of any other case for blocking goroutines in your case, will update the answer if I do."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 0, "last_activity_date": 1505214335, "last_edit_date": 1505214335, "creation_date": 1493023218, "answer_id": 43583407, "question_id": 43488986, "link": "https://stackoverflow.com/questions/43488986/goroutine-stack-traces-incomplete/43583407#43583407", "title": "goroutine stack traces incomplete", "body": "<p>I don't think there is any way to get the parent goroutine stack without you having to manually track each go routine invocation and generating an id for it.</p>\n\n<p>In this specific case, what is likely is that you have a transaction that has not been Committed or Rollbacked because an error occurs and the function prematurely exits without calling either.</p>\n\n<p>A good template to avoid the same is to use 'defer'.</p>\n\n<pre><code>func (s Service) DoSomething() (err error) {\n    tx, err := s.db.Begin()\n    if err != nil {\n        return\n    }\n    defer func() {\n        if err != nil {\n            tx.Rollback()\n            return\n        }\n        err = tx.Commit()\n    }()\n    if _, err = tx.Exec(...); err != nil {\n        return\n    }\n    if _, err = tx.Exec(...); err != nil {\n        return\n    }\n    // ...\n    return }\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/a/23502629/2285935\">Code Reference</a> </p>\n\n<p>PS: Beware of error shadowing.</p>\n"}], "owner": {"reputation": 471, "user_id": 1633004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4362c618a90c5601d79bf6c7e5502?s=128&d=identicon&r=PG", "display_name": "Eagle", "link": "https://stackoverflow.com/users/1633004/eagle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1505214335, "creation_date": 1492586162, "last_edit_date": 1492596992, "question_id": 43488986, "link": "https://stackoverflow.com/questions/43488986/goroutine-stack-traces-incomplete", "title": "goroutine stack traces incomplete", "body": "<p>I wrote a web app using golang. When it's running in production, there are some goroutines blocked. Here are the information (generated by using <code>pprof</code>):</p>\n\n<pre><code>goroutine 792247 [chan receive, 948 minutes]:\ndatabase/sql.(*Tx).awaitDone(0xc4206e2b80)\n    /usr/local/go/src/database/sql/sql.go:1440 +0x57\ncreated by database/sql.(*DB).begin\n    /usr/local/go/src/database/sql/sql.go:1383 +0x274\n</code></pre>\n\n<p>The goroutine has been waiting on the channel for 948 minites. Apparently, there's something wrong. But the stack traces seems incomplete. It's not enough for me to find the bug. (I want some stack traces start from my program.)</p>\n\n<p>How can I get the full stack traces of this goroutine?\nOr are there any other ways to debug this issue?</p>\n\n<p><strong>Update</strong>:</p>\n\n<p>I've read the source code of database/sql/sql.go. It turns out <code>database/sql/sql.go:1440</code> is in a new goroutine. The stack traces are <code>incomplete</code> because previous stack traces belong to the <code>parent</code> goroutine.</p>\n\n<p>My question should be : are there better ways to debug this issue?</p>\n"}, {"tags": ["windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 6, "last_activity_date": 1492570461, "creation_date": 1492570461, "answer_id": 43485517, "question_id": 43485414, "link": "https://stackoverflow.com/questions/43485414/getspecialfolder-equivalent-in-golang/43485517#43485517", "title": "GetSpecialFolder equivalent in golang", "body": "<p>You use <a href=\"https://golang.org/pkg/os/#TempDir\" rel=\"noreferrer\"><code>os.TempDir()</code></a> for that.</p>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 43485517, "answer_count": 1, "score": 0, "last_activity_date": 1492570461, "creation_date": 1492569764, "question_id": 43485414, "link": "https://stackoverflow.com/questions/43485414/getspecialfolder-equivalent-in-golang", "title": "GetSpecialFolder equivalent in golang", "body": "<p>I'm trying to get the temp folder of windows, other than a fixed path <code>C:\\Windows\\Temp</code>, I'd like to use some API similar to <code>GetSpecialFolder</code> in VBScript.</p>\n\n<p>Is there anything like that?</p>\n"}, {"tags": ["xml", "go", "decoding"], "answers": [{"comments": [{"owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "edited": false, "score": 0, "creation_date": 1492573666, "post_id": 43484700, "comment_id": 74027285, "body": "Perfect. Thanks. That took care of it."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1492564981, "creation_date": 1492564981, "answer_id": 43484700, "question_id": 43484446, "link": "https://stackoverflow.com/questions/43484446/golang-xml-decoding/43484700#43484700", "title": "GOLANG xml decoding", "body": "<p>The root element is automatically decoded into the value you pass to <code>Decode</code> so you don't need to mention it in the <code>Files</code> field tag.</p>\n\n<p>So just change <code>xml:\"FileRetriever&gt;FileList&gt;File\"</code> to <code>xml:\"FileList&gt;File\"</code>.  </p>\n"}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 0, "accepted_answer_id": 43484700, "answer_count": 1, "score": 1, "last_activity_date": 1492564981, "creation_date": 1492563039, "question_id": 43484446, "link": "https://stackoverflow.com/questions/43484446/golang-xml-decoding", "title": "GOLANG xml decoding", "body": "<p>In Go, I'm trying to decode this XML into the \"fileRetriever\" struct. I only care about the file names:</p>\n\n<pre><code> &lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\" ?&gt;\n &lt;FileRetriever&gt;\n   &lt;FileList&gt;\n       &lt;File name=\"Name1\" /&gt;\n       &lt;File name=\"Name2\" /&gt;\n   &lt;/FileList&gt;\n &lt;/FileRetriever&gt;\n</code></pre>\n\n<p>I think this code snippet is close, but I can't seem to see where I'm going wrong. It produces no errors, but also a zero-length list of file names:</p>\n\n<pre><code>import (\n    \"encoding/base64\"\n    \"encoding/xml\"\n    \"fmt\"\n    \"net/http\"\n\n    \"golang.org/x/net/html/charset\"\n\n)\ntype fileRetriever struct {\n    Files []file `xml:\"FileRetriever&gt;FileList&gt;File\"`\n}\n\ntype file struct {\n    Name string `xml:\"name,attr\"`\n}\n\nfunc Main(){\n    retrieve()\n}\n\nfunc retrieve()(retriever *fileRetriever){\n    req := ... //set up http.NewRequest()\n    client := &amp;http.Client{}\n    rsp, err := client.Do(req)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer rsp.Body.Close()\n\n    decoder := xml.NewDecoder(rsp.Body)\n    decoder.CharsetReader = charset.NewReaderLabel\n\n    retriever = &amp;fileRetriever{}\n\n    err = decoder.Decode(&amp;retriever)\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    return retriever, xTidx\n}\n</code></pre>\n"}, {"tags": ["go", "google-api", "google-cloud-platform", "google-compute-engine", "google-developers-console"], "answers": [{"tags": [], "owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "is_accepted": false, "score": 0, "last_activity_date": 1492591725, "creation_date": 1492591725, "answer_id": 43490803, "question_id": 43482969, "link": "https://stackoverflow.com/questions/43482969/how-to-create-a-google-cloud-project-with-service-management-api-enabled/43490803#43490803", "title": "How to create a Google Cloud project with service management API enabled?", "body": "<p>The <a href=\"https://cloud.google.com/resource-manager/reference/rest/\" rel=\"nofollow noreferrer\">Google Cloud Resource Manager API</a> is very limited in what it will allow you to do.</p>\n\n<p>while it does have a <a href=\"https://cloud.google.com/resource-manager/reference/rest/v1beta1/projects/update\" rel=\"nofollow noreferrer\">projects.update</a> method it does not support enabling APIs. Your going to have to manually edit the project.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 1775619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/657aa0077d2815c9c98d32468e91a022?s=128&d=identicon&r=PG", "display_name": "mpl", "link": "https://stackoverflow.com/users/1775619/mpl"}, "edited": false, "score": 0, "creation_date": 1492629524, "post_id": 43503392, "comment_id": 74063076, "body": "Yes thanks, I eventually noticed, that as opposed to what the doc says, I didn&#39;t need to explicitly enable the API to use is (see end of commit message at <a href=\"https://camlistore-review.googlesource.com/c/9906/4\" rel=\"nofollow noreferrer\">camlistore-review.googlesource.com/c/9906/4</a>). Hmmo, are you saying that I should not expect servicemanagement to keep on working by default, and that I should use serviceuser instead?"}, {"owner": {"reputation": 310, "user_id": 6934031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgVlq4AUxRQ/AAAAAAAAAAI/AAAAAAAAA5E/_DTbo3m8qhg/photo.jpg?sz=128", "display_name": "Rob Kochman", "link": "https://stackoverflow.com/users/6934031/rob-kochman"}, "reply_to_user": {"reputation": 33, "user_id": 1775619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/657aa0077d2815c9c98d32468e91a022?s=128&d=identicon&r=PG", "display_name": "mpl", "link": "https://stackoverflow.com/users/1775619/mpl"}, "edited": false, "score": 0, "creation_date": 1492637200, "post_id": 43503392, "comment_id": 74067444, "body": "serviceuser is intended to be the service consumer-facing API. It&#39;s useful in that you can enable/disable services without having to enable the servicemanagement API."}, {"owner": {"reputation": 814, "user_id": 3807231, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e4a956b23bfefa4c437258637d86caa1?s=128&d=identicon&r=PG&f=1", "display_name": "TvE", "link": "https://stackoverflow.com/users/3807231/tve"}, "edited": false, "score": 0, "creation_date": 1504135897, "post_id": 43503392, "comment_id": 78901407, "body": "This is not working for me. First of all, the &quot;name&quot; parameter to the Enable method is not described in the docs. In the source json one can find &quot;A valid path would be:\\n- /v1/projects/my-project/services/servicemanagement.googleapi&zwnj;&#8203;s.com:enable&quot; but one has to pass something like &quot;projects/my-project/services/servicemanagement.googleapis.c&zwnj;&#8203;om&quot;. But when I try to enable the servicemanagement API I get the response: googleapi: Error 403: Google Service User API has not been used in project xxxx before or it is disabled."}, {"owner": {"reputation": 814, "user_id": 3807231, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e4a956b23bfefa4c437258637d86caa1?s=128&d=identicon&r=PG&f=1", "display_name": "TvE", "link": "https://stackoverflow.com/users/3807231/tve"}, "edited": false, "score": 0, "creation_date": 1504136397, "post_id": 43503392, "comment_id": 78901506, "body": "I tried the gcloud cli tool and it handles the enablement fine. Looking at the HTTP it produces and instead of a URL like /v1/project/&lt;proj-id&gt;/services/&lt;service&gt;:enable it uses just /v1/services/&lt;service&gt;:enable and passes the project ID in the body as &quot;consumerId&quot; field. I tricked the ProjectsServicesService.Enable method to do that by passing the consumerId stuff to the Do() method. Looks like the library needs some fixes..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7192474"}, "reply_to_user": {"reputation": 814, "user_id": 3807231, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e4a956b23bfefa4c437258637d86caa1?s=128&d=identicon&r=PG&f=1", "display_name": "TvE", "link": "https://stackoverflow.com/users/3807231/tve"}, "edited": false, "score": 0, "creation_date": 1567540442, "post_id": 43503392, "comment_id": 101990876, "body": "@TvE Yo tve, im getting the same Error 403: Google Service User API has not been used in project. Im doing this in python though. did you ever solve this?"}, {"owner": {"reputation": 310, "user_id": 6934031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgVlq4AUxRQ/AAAAAAAAAAI/AAAAAAAAA5E/_DTbo3m8qhg/photo.jpg?sz=128", "display_name": "Rob Kochman", "link": "https://stackoverflow.com/users/6934031/rob-kochman"}, "edited": false, "score": 0, "creation_date": 1567631568, "post_id": 43503392, "comment_id": 102024535, "body": "Try using the Service Usage API: <a href=\"https://cloud.google.com/service-usage/docs/reference/rest/\" rel=\"nofollow noreferrer\">cloud.google.com/service-usage/docs/reference/rest</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7192474"}, "reply_to_user": {"reputation": 814, "user_id": 3807231, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/e4a956b23bfefa4c437258637d86caa1?s=128&d=identicon&r=PG&f=1", "display_name": "TvE", "link": "https://stackoverflow.com/users/3807231/tve"}, "edited": false, "score": 0, "creation_date": 1567729114, "post_id": 43503392, "comment_id": 102059745, "body": "@TvE I can, but that would require me to enable the api. That&#39;s why I&#39;ve been trying to use the Service User API, which is &quot;enabled by default&quot;, but I&#39;m getting the same thing as you. I&#39;m trying to automate this process and enabling manually the api on each project is not very efficient... any other tips?"}, {"owner": {"reputation": 310, "user_id": 6934031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgVlq4AUxRQ/AAAAAAAAAAI/AAAAAAAAA5E/_DTbo3m8qhg/photo.jpg?sz=128", "display_name": "Rob Kochman", "link": "https://stackoverflow.com/users/6934031/rob-kochman"}, "edited": false, "score": 0, "creation_date": 1568001891, "post_id": 43503392, "comment_id": 102122438, "body": "I updated the answer. You want &quot;Service Usage&quot; not &quot;Service User&quot;"}], "tags": [], "owner": {"reputation": 310, "user_id": 6934031, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AgVlq4AUxRQ/AAAAAAAAAAI/AAAAAAAAA5E/_DTbo3m8qhg/photo.jpg?sz=128", "display_name": "Rob Kochman", "link": "https://stackoverflow.com/users/6934031/rob-kochman"}, "is_accepted": true, "score": 0, "last_activity_date": 1568001871, "last_edit_date": 1568001871, "creation_date": 1492626253, "answer_id": 43503392, "question_id": 43482969, "link": "https://stackoverflow.com/questions/43482969/how-to-create-a-google-cloud-project-with-service-management-api-enabled/43503392#43503392", "title": "How to create a Google Cloud project with service management API enabled?", "body": "<p>Use the Service Usage API:\n<a href=\"https://cloud.google.com/service-usage/docs/reference/rest/\" rel=\"nofollow noreferrer\">https://cloud.google.com/service-usage/docs/reference/rest/</a></p>\n\n<p>(updated)</p>\n"}], "owner": {"reputation": 33, "user_id": 1775619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/657aa0077d2815c9c98d32468e91a022?s=128&d=identicon&r=PG", "display_name": "mpl", "link": "https://stackoverflow.com/users/1775619/mpl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1029, "favorite_count": 0, "accepted_answer_id": 43503392, "answer_count": 2, "score": 3, "last_activity_date": 1568001871, "creation_date": 1492553093, "last_edit_date": 1492607816, "question_id": 43482969, "link": "https://stackoverflow.com/questions/43482969/how-to-create-a-google-cloud-project-with-service-management-api-enabled", "title": "How to create a Google Cloud project with service management API enabled?", "body": "<p>We're deploying our software on behalf (OAuth2) of users on Google Cloud. We've managed to automate most of it, but there's one bit that's missing.</p>\n\n<ol>\n<li>Creating the project is done with <a href=\"https://godoc.org/google.golang.org/api/cloudresourcemanager/v1#ProjectsService.Create\" rel=\"nofollow noreferrer\">https://godoc.org/google.golang.org/api/cloudresourcemanager/v1#ProjectsService.Create</a>  </li>\n<li>Enabling the required APIs (compute, storage, etc) is done with google.golang.org/api/servicemanagement/v1#ServicesService.Enable (can't post as full link thanks to the very bright SO limitations)  </li>\n<li>Creating the instance is done with google.golang.org/api/compute/v1#InstancesService.Insert  </li>\n</ol>\n\n<p>The missing bit is between step 1 and step 2: in order to make use of the <code>Service Management API to enable the needed APIs</code>, we need the Service Management API itself to be enabled on the project (how ironic). I'm hoping there must be a way to create a project with some APIs enabled from the start, maybe with cloudresourcemanager, or maybe with <a href=\"https://godoc.org/google.golang.org/api/deploymentmanager/v2\" rel=\"nofollow noreferrer\">https://godoc.org/google.golang.org/api/deploymentmanager/v2</a>, but I haven't found it so far.</p>\n\n<p>So, to restate: does anyone know if it's possible (in Go) to create a Google Cloud project with some specific Google Cloud APIs enabled right on/after creation?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 7658423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c8f789b6958a730962ad52b6271eaf?s=128&d=identicon&r=PG", "display_name": "JohnReese", "link": "https://stackoverflow.com/users/7658423/johnreese"}, "is_accepted": true, "score": 1, "last_activity_date": 1492557150, "creation_date": 1492557150, "answer_id": 43483701, "question_id": 43482864, "link": "https://stackoverflow.com/questions/43482864/how-can-i-use-data-received-as-response-from-google-api/43483701#43483701", "title": "How can I use data received as response from google api?", "body": "<p>Fixed it by using json.Unmarshal.</p>\n"}], "owner": {"reputation": 103, "user_id": 7658423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3c8f789b6958a730962ad52b6271eaf?s=128&d=identicon&r=PG", "display_name": "JohnReese", "link": "https://stackoverflow.com/users/7658423/johnreese"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 43483701, "answer_count": 1, "score": 0, "last_activity_date": 1492557150, "creation_date": 1492552547, "question_id": 43482864, "link": "https://stackoverflow.com/questions/43482864/how-can-i-use-data-received-as-response-from-google-api", "title": "How can I use data received as response from google api?", "body": "<p>I'm trying to create login with google api authentication with oauth2.\nI'm getting response from google api (response.body) as:</p>\n\n<pre><code>{\n \"id\": \"received ID\",\n \"email\": \"EMAIL\",\n \"verified_email\": true,\n \"name\": \"Name\",\n}\n</code></pre>\n\n<p>How can I access that data inside go program so that I can store it in database?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/url\"\n    \"strings\"\n\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    \"encoding/json\"\n)\n\nvar (\n    oauthConf = &amp;oauth2.Config{\n        ClientID:     \"CLIENTID\",\n        ClientSecret: \"Secret\",\n        RedirectURL:  \"http://localhost:8011/showprofile\",\n        //Scopes:       []string{\"https://www.googleapis.com/auth/plus.login\"},\n        Scopes:[]string{\"profile\",\"email\"},\n        Endpoint:     google.Endpoint,\n    }\n    oauthStateString = \"thisshouldberandom\"\n)\n\nconst htmlIndex = `&lt;html&gt;&lt;body&gt;\nLogged in with &lt;a href=\"/login\"&gt;facebook&lt;/a&gt;\n&lt;/body&gt;&lt;/html&gt;\n`\n\nfunc handleMain(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n    w.WriteHeader(http.StatusOK)\n    w.Write([]byte(htmlIndex))\n}\n\nfunc handleGoogleLogin(w http.ResponseWriter, r *http.Request) {\n    Url, err := url.Parse(oauthConf.Endpoint.AuthURL)\n    if err != nil {\n        log.Fatal(\"Parse: \", err)\n    }\n    parameters := url.Values{}\n    parameters.Add(\"client_id\", oauthConf.ClientID)\n    parameters.Add(\"scope\", strings.Join(oauthConf.Scopes, \" \"))\n    parameters.Add(\"redirect_uri\", oauthConf.RedirectURL)\n    parameters.Add(\"response_type\", \"code\")\n    parameters.Add(\"state\", oauthStateString)\n    Url.RawQuery = parameters.Encode()\n    url := Url.String()\n    fmt.Println(\"URL\" + url)\n    http.Redirect(w, r, url, http.StatusTemporaryRedirect)\n}\n\nfunc handleGoogleCallback(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Call back working\")\n    state := r.FormValue(\"state\")\n    if state != oauthStateString {\n        fmt.Printf(\"invalid oauth state, expected '%s', got '%s'\\n\", oauthStateString, state)\n        http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        return\n    }\n\n    code := r.FormValue(\"code\")\n\n    token, err := oauthConf.Exchange(oauth2.NoContext, code)\n    if err != nil {\n        fmt.Printf(\"oauthConf.Exchange() failed with '%s'\\n\", err)\n        http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        return\n    }\n\n\n    resp,err:=  http.Get(\"https://www.googleapis.com/oauth2/v2/userinfo?access_token=\" + token.AccessToken)\n\n    if err != nil {\n        fmt.Printf(\"Get: %s\\n\", err)\n        http.Redirect(w, r, \"/\", http.StatusTemporaryRedirect)\n        return\n    }\n    fmt.Println(resp.Body)\n    defer resp.Body.Close()\n\n    response, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Printf(\"ReadAll: %s\\n\", err)\n        http.Redirect(w, r, \"/showprofile\", http.StatusTemporaryRedirect)\n        return\n    }\n\n\n\n    log.Printf(\"parseResponseBody: %s\\n\", string(response))\n\n    http.Redirect(w, r, \"/showprofile\", http.StatusTemporaryRedirect)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handleMain)\n    http.HandleFunc(\"/login\", handleGoogleLogin)\n    http.HandleFunc(\"/showprofile\", handleGoogleCallback)\n    fmt.Print(\"Started running on http://localhost:8011\\n\")\n    log.Fatal(http.ListenAndServe(\":8011\", nil))\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "channel"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1492548294, "post_id": 43481836, "comment_id": 74019648, "body": "What exactly do you need the channel length for?"}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492548659, "post_id": 43481836, "comment_id": 74019859, "body": "Because when I am doing batches, the last batch won&#39;t be the same length as the other batches.  So stuff I am doing after calculating the batch will need that.  So if I have 89 rows and I am selecting by batches of 10, the last one will only have 9"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1492548811, "post_id": 43481836, "comment_id": 74019947, "body": "You can use sync/atomic for a counter, and just increment it with each iteration of your for loop, and return that. There is no &quot;length&quot; of your unbuffered channel; its length is always zero, by definition."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492548873, "post_id": 43481836, "comment_id": 74019981, "body": "You don&#39;t have a buffered channel, but even if you did, the length of a buffered channel isn&#39;t useful when there are concurrent sends or receives, because the value is stale as soon as you read it."}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492548882, "post_id": 43481836, "comment_id": 74019990, "body": "Yeah I figured I could do that, but didn&#39;t want to rely on that if it isn&#39;t the preferred way to use it.  But if that is the case then I can try it"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492549003, "post_id": 43481836, "comment_id": 74020059, "body": "@Adrian Returning that would do no good. The for loop is still running after the <code>gen</code> func returns."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1492549097, "post_id": 43481836, "comment_id": 74020116, "body": "@Gavin fair point. Would have to be an atomic stored in a struct, and you&#39;d have to have a way of knowing when the batch was done before you read it to get an authoritative count. Regardless, to the original question, the unbuffered channel has no length."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492549180, "post_id": 43481836, "comment_id": 74020169, "body": "It still does not explain why you need length: every batch would have 10 items unless the channel is closed. You collect items for a batch until the batch size is reached 10, or the channel is closed. Why do you need length?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1492549205, "post_id": 43481836, "comment_id": 74020190, "body": "Since you spawn a goroutine and then return from <code>gen</code>, the for loop will still be running after you get your result from <code>gen</code>. Therefore, retuning some sort of count from <code>gen</code> will not work. Your best bet is probably just to count the number of items as you receive them from the channel."}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492549210, "post_id": 43481836, "comment_id": 74020192, "body": "Ok so I might just be structuring my code poorly, but this is the gist of what I am doing.  1. creating an unbuffered chan from query batch 2. spawning workers to read on that channel and encrypt data 3. put the encrypted data on another channel (which is &quot;shared&quot; amongst the workers 4. do work on the encrypted channel when workers are done  I am using a wait group for the worker goroutines, and it is currently blocking the the .Wait().  It wasn&#39;t before, but I am trying this new way and am not sure why.  I switched the encrypted chan to buffered and it worked.  That is why I wanted len"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1492549298, "post_id": 43481836, "comment_id": 74020243, "body": "Passing around rows doesn&#39;t seem like a good idea either. You will leak database connections if they aren&#39;t closed. Just do your work in the goroutine, and pass the result through a channel."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492549977, "post_id": 43481836, "comment_id": 74020566, "body": "Can you show us your actual batch-handling code, so we can help address the core of your problem, rather than this <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492550024, "post_id": 43482243, "comment_id": 74020592, "body": "Once I get my chan of items from the query, I spawn goroutines and do work on them.  I put the work on a single channel then want to range over that.  I am modifying old code so it was already using a waitgroup for the workers, but it is blocking now with the new single channel.  I was able to switch it to unbuffered and it didn&#39;t block but you need a len for that.  So the length would be of the batches, which isn&#39;t guaranteed to be same length on last query."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 1, "creation_date": 1492550112, "post_id": 43482243, "comment_id": 74020635, "body": "Can you not read from your channel until it&#39;s closed, then count how many results you got?"}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492550518, "post_id": 43482243, "comment_id": 74020823, "body": "here is the gist of it. <a href=\"https://play.golang.org/p/kBTgohg2Ia\" rel=\"nofollow noreferrer\">play.golang.org/p/kBTgohg2Ia</a>    I can&#39;t show you my work code unfortunately.  But the buffered channel doesn&#39;t block, but unbuffered would.  That is why I need the length of the chan with the query batch.  Mind you this is all wrapped in a for loop that terminates when the done chan is written to.  That happens when there is nothing else to query.  I am doing batches since I need to encrypt a column in a table that has millions of rows"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492550782, "post_id": 43482243, "comment_id": 74020940, "body": "@ZeroHour your code blocks because you don&#39;t consume from <code>enc</code>. Create another goroutine that reads from it."}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492550800, "post_id": 43482243, "comment_id": 74020952, "body": "@zerkms well if you look at the enc chan, I have it as buffered to the same length as the gen chan would be.  I picked 100 as an example batch size.  But as I said, the last batch probably won&#39;t have as many results as the LIMIT number."}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492550887, "post_id": 43482243, "comment_id": 74020986, "body": "@zerkms I don&#39;t think I can because I need finish doing the all the work before moving onto the next batch.  So I have to wait until I know it is done.  That is why not having it in a goroutine should be the way to go.  Otherwise I am managing goroutine state and I shouldn&#39;t have to."}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492551071, "post_id": 43482243, "comment_id": 74021067, "body": "I think I just helped myself.  Wrapping the wg.Wait() and close() into a goroutine before the range works. <a href=\"https://play.golang.org/p/kWB3nRC2U6\" rel=\"nofollow noreferrer\">play.golang.org/p/kWB3nRC2U6</a>  Although I am not 100% sure why that is needed.  So if someone can explain in better detail than the lack of good tutorials on this stuff"}, {"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492551268, "post_id": 43482243, "comment_id": 74021141, "body": "@zerkms Ok I see your example and it has the same effect as mine.  I like mine better since it doesn&#39;t require another WaitGroup.  But regardless of that, why does another goroutine need to be spawned to do that in such a case.  You provided the answer, but no explanation."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492551338, "post_id": 43482243, "comment_id": 74021171, "body": "Because you need 2 things being doing concurrently: a) read from the channel b) wait from producers completion (to close the channel). PS: it&#39;s a comment, not an answer ;-P"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1492549790, "creation_date": 1492549790, "answer_id": 43482243, "question_id": 43481836, "link": "https://stackoverflow.com/questions/43481836/proper-way-to-gain-access-to-a-channel-length-in-go/43482243#43482243", "title": "Proper way to gain access to a channel length in Go", "body": "<p>The <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len</code></a> built-in will return the \"length\" of a channel:</p>\n\n<blockquote>\n  <h3>func len(v Type) int</h3>\n  \n  <p>The len built-in function returns the length of v, according to its type:</p>\n\n<pre><code>Array: the number of elements in v.\nPointer to array: the number of elements in *v (even if v is nil).\nSlice, or map: the number of elements in v; if v is nil, len(v) is zero.\nString: the number of bytes in v.\nChannel: the number of elements queued (unread) in the channel buffer;\n</code></pre>\n  \n  <p>if v is nil, len(v) is zero.</p>\n</blockquote>\n\n<p>But I don't think that will help you.</p>\n\n<p>What you really need is a new approach to your problem: counting the items in queue in a channel is not an appropriate way to handle \"batches\" of tasks.</p>\n\n<p>What do you need this length for?</p>\n"}, {"comments": [{"owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "edited": false, "score": 0, "creation_date": 1492701074, "post_id": 43501622, "comment_id": 74100264, "body": "Actually, I needed a buffered channel which was the same length as the number of objects in my generated chan.  For some reason, which I don&#39;t quite understand, wg.Wait() was blocking on me when writing to another channel if it wasn&#39;t buffered.  But I was able to get around that by spawning another goroutine for the wg.Wait() and it works now with an unbuffered channel.  Here is the before and after if you are interested and have input.  before: <a href=\"https://play.golang.org/p/kBTgohg2Ia\" rel=\"nofollow noreferrer\">play.golang.org/p/kBTgohg2Ia</a>    after: <a href=\"https://play.golang.org/p/kWB3nRC2U6\" rel=\"nofollow noreferrer\">play.golang.org/p/kWB3nRC2U6</a>"}], "tags": [], "owner": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "is_accepted": false, "score": 0, "last_activity_date": 1492620516, "creation_date": 1492620516, "answer_id": 43501622, "question_id": 43481836, "link": "https://stackoverflow.com/questions/43481836/proper-way-to-gain-access-to-a-channel-length-in-go/43501622#43501622", "title": "Proper way to gain access to a channel length in Go", "body": "<p>I am assuming, from your follow on answers, you actually want to know \"good\" values for the workers pool and the buffer on the channel to keep everything working \"optimally\".</p>\n\n<p>This is extremely hard, and depends on what the workers are doing, but at a first guess I'd look at a minimal value of buffered channel and a pool of workers at runtime.GOMAXPROCS(0). If you have a lot of resources then you could go as far as \"infinite\" workers.</p>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 2662180, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1smkG.png?s=128&g=1", "display_name": "David B", "link": "https://stackoverflow.com/users/2662180/david-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1580399001, "creation_date": 1580399001, "answer_id": 59989598, "question_id": 43481836, "link": "https://stackoverflow.com/questions/43481836/proper-way-to-gain-access-to-a-channel-length-in-go/59989598#59989598", "title": "Proper way to gain access to a channel length in Go", "body": "<p>You are using a <strong>not</strong> buffered channels. Thank you for that\ud83d\udc4d\ud83d\udc4f\ud83d\udc4c\ud83d\ude4c\nUnbuffered channel uses no memory. thus never contains nothing ! \nThe only purpose of unbuffered channels are for achieving synchronicity between goroutine by passing an element from one to another. That's it ! </p>\n\n<pre><code>    go func(){\n        c:=make(chan struct{})\n        c&lt;-struct{}{} // Definitely locked\n    }()\n</code></pre>\n\n<p>another deadlock</p>\n\n<pre><code>    go func(){\n        c:=make(chan struct{})\n        &lt;-c // Definitely locked\n        c&lt;-struct{}{} // Never get there\n    }()\n</code></pre>\n\n<p>use another goroutine to read the channel</p>\n\n<pre><code>    go func(){\n        c:=make(chan struct{})\n        go func(){&lt;-c}()\n        c&lt;-struct{}{}\n    }()\n</code></pre>\n\n<p>In your case you have a generator, which means you have to read the channel until the producer goroutine will close it. It is a good design that ensures that your goroutine are not dangling.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Read the channel until the injecter goroutine finishes and closes it.\nfor r := range gen() {\n...\n}\n// goroutine inner of gen() as finished\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 1702069, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a93f16742c367cda43b4eaa04b5aa498?s=128&d=identicon&r=PG", "display_name": "ZeroHour", "link": "https://stackoverflow.com/users/1702069/zerohour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1955, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1580399001, "creation_date": 1492548124, "question_id": 43481836, "link": "https://stackoverflow.com/questions/43481836/proper-way-to-gain-access-to-a-channel-length-in-go", "title": "Proper way to gain access to a channel length in Go", "body": "<p>I have been using Go for a little and still getting better everyday, but not an expert per se.  Currently I am tackling concurrency and goroutines as I think that is the final unknown in my Go toolbelt.  I think I am getting the hang of it as such, but still definitely a beginner.</p>\n\n<p>The task I am having an issue with seems pretty basic to me, but nothing I have tried works.  I would like to figure out a way to calculate the length of a channel.</p>\n\n<p>From what I have gathered, len() only works on buffered channels so that won't help me in this case.  What I am doing is reading values from the DB in batches.  I have a generator func that goes like</p>\n\n<pre><code>func gen() chan Result {\n  out := make(chan Result)\n\n  go func() {\n    ... query db\n    for rows.Next() {\n      out &lt;- row\n    }\n     close(out)\n   }()\n\n  return out\n}\n</code></pre>\n\n<p>then I am using it as such</p>\n\n<pre><code>c := gen()\n\n...\n\n// do other stuff\n</code></pre>\n\n<p>I would either like to return the count with the out channel, or wrap all of it in a struct type and just return that.  </p>\n\n<p>like so:</p>\n\n<pre><code>c, len := gen()\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>a := gen()\n\nfmt.Println(a.c)\nfmt.Println(a.len)\n</code></pre>\n\n<p>I believe I have tried all but using atomic, which I think would actually work but I read around and it apparently isn't the right thing to use atomic for.  What other options do I have that either don't leave me with a 0 or blocks infinitely</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1492537618, "post_id": 43478834, "comment_id": 74013225, "body": "Because the language spec says so? What is the question?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492537801, "post_id": 43478834, "comment_id": 74013335, "body": "The quote you took from the spec lays it out, defer can only alter a return value for named result parameters. It works differently because that&#39;s how it was designed. It likely reduces bugs where you could accidentally alter your return values, and it may also be the simpler implementation as well."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1492537956, "post_id": 43478834, "comment_id": 74013419, "body": "@Volker is says <code>For instance</code> so to me it seems to imply there is some kind of rule that &quot;named result parameters&quot; are part of."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492538710, "post_id": 43478834, "comment_id": 74013888, "body": "@JimB to me it looks like the opposite (i.e. increases the number of bugs) as I expected defer to work just like any closure executed before return( equivalent of <code>func up3()error</code> from my example.) After reading the specs I&#39;ve found this exception though the text is confusing. <code>For instance makes</code> it sound like the behaviour follows a specific rule when in fact there is no rule and it&#39;s actually an exception specific to the <code>defer</code> statement."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492538930, "post_id": 43478834, "comment_id": 74014052, "body": "@themihai: except that should not have ever caused any latent bugs, because it could never have worked in the first place. It&#39;s part of the spec for defer, so it can&#39;t really be an exception when it&#39;s always the case. I agree it can be confusing if you didn&#39;t read the spec and/or test it out, but the rule itself seems very clear."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492539874, "post_id": 43478834, "comment_id": 74014675, "body": "@JimB <code>For instance</code> means  <code>as an example</code>. Can you point me to the specification paragraph that can be used to infer this example related to the named result parameters ?  The examples are supposed to be optional and further clarify the specification not to be part of the specification, right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492540963, "post_id": 43478834, "comment_id": 74015325, "body": "@themihai: that is a remnant of an older wording of that section, and it seems another sentence was interjected i there. It&#39;s adding more detail about when they are invoked and what their scope is. Yes, the wording could probably be improved, but the details are all there. This isn&#39;t the forum to debate whether the facts should have been placed before or after a &quot;For instance,&quot;."}, {"owner": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "edited": false, "score": 0, "creation_date": 1492620873, "post_id": 43478834, "comment_id": 74057770, "body": "One thing that might be confusing you is that the last line of up2() does nothing (setting the return value to the return value), and the defer is altering the return value directly. Eg. see <a href=\"https://tour.golang.org/basics/7\" rel=\"nofollow noreferrer\">tour.golang.org/basics/7</a>"}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 2742, "user_id": 10314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20cf40f15981c94eb92341e8cdf98e85?s=128&d=identicon&r=PG", "display_name": "James Antill", "link": "https://stackoverflow.com/users/10314/james-antill"}, "edited": false, "score": 0, "creation_date": 1492623000, "post_id": 43478834, "comment_id": 74059144, "body": "@JamesAntill in the real program it was meant to be used as a clean up task and overwrite the error if it fails . See here a use case which may make more sense <a href=\"https://play.golang.org/p/6dwHrhdCdP\" rel=\"nofollow noreferrer\">play.golang.org/p/6dwHrhdCdP</a> . The fact that the behaviour is different when you don&#39;t use named result params seems just odd to me and is poorly documented(AFAIAC)"}], "answers": [{"comments": [{"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 1, "creation_date": 1492541369, "post_id": 43479960, "comment_id": 74015575, "body": "For some reasons I thought defer is executed just like a closure injected <code>return</code> (i.e. equivalent of <code>up3</code> from my example) not &quot;after&quot; the surrounding function  returns thus the whole confusion. I believe the wording could be improved to make this more clear."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1492541585, "post_id": 43479960, "comment_id": 74015715, "body": "@themihai: it&#39;s still not &quot;after&quot; it returns, though that&#39;s just a technicality. Just below that statement: <code>deferred functions are invoked immediately before the surrounding function returns</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1492541731, "post_id": 43479960, "comment_id": 74015798, "body": "I think the language in the spec can be improved by saying &quot;A &quot;defer&quot; statement invokes a function whose execution is deferred to the moment the surrounding function <i>terminates</i>. &quot;   The order of execution with this change in terminology is: function terminates, deferred functions execute, function returns."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492541905, "post_id": 43479960, "comment_id": 74015911, "body": "@JimB I mean that after the surrounding function &quot;executes&quot;. Initially I mistakenly  thought the execution is  <code>surrounding function -&gt; defer -&gt; return</code>  but now I found out it is a kind of  <code>surrounding function -&gt; return -&gt;  defer -&gt; return</code>  so the behaviour of the named params totally makes sense."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1492543200, "post_id": 43479960, "comment_id": 74016691, "body": "@themihai It&#39;s <code>surrounding function -&gt; defer -&gt; return</code>. The return statement is part of the surrounding function. The return statement causes the surrounding function to terminate and optionally provides results. The function returns after the function terminates and deferred functions are executed.  Setting return values is one of few situations where it&#39;s important to distinguish function termination from return."}, {"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1492543667, "post_id": 43479960, "comment_id": 74016952, "body": "@CeriseLim&#243;n that makes sense. It&#39;s just that you I can&#39;t emulate &quot;terminate&quot; in Go thus the reason why I used  <code>sf  -&gt; return -&gt; defer -&gt; return</code>. Technically it should be  <code>sf  -&gt; terminate -&gt; defer -&gt; return</code>.  Would you mind to file an issue on <a href=\"https://github.com/golang/go/issues/new\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/new</a> ?  I believe your proposal to use <code>terminate</code> instead of <code>return</code> is great and has high chances to be merged."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1492544808, "post_id": 43479960, "comment_id": 74017631, "body": "Panic and reaching the end of the function body also cause the surrounding function to terminate."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1492541184, "creation_date": 1492541184, "answer_id": 43479960, "question_id": 43478834, "link": "https://stackoverflow.com/questions/43478834/why-defer-behaves-differently-with-variables-defined-in-the-surrounding-function/43479960#43479960", "title": "Why defer behaves differently with variables defined in the surrounding function than named results?", "body": "<p>The <a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"nofollow noreferrer\">spec says</a>:</p>\n\n<blockquote>\n  <p>A \"defer\" statement invokes a function whose execution is deferred to the moment the surrounding function returns, either because the surrounding function executed a return statement, reached the end of its function body, or because the corresponding goroutine is panicking.</p>\n</blockquote>\n\n<p>A key point is that the deferred function is executed after the return statement is executed.</p>\n\n<p>The <a href=\"https://golang.org/ref/spec#Return_statements\" rel=\"nofollow noreferrer\">spec also says</a>:</p>\n\n<blockquote>\n  <p>A \"return\" statement in a function F terminates the execution of F, and optionally provides one or more result values. Any functions deferred by F are executed before F returns to its caller.</p>\n</blockquote>\n\n<p>The function <code>up</code> returns nil because the deferred function sets <code>err</code> after the return statement provides the function result.</p>\n\n<p>The function <code>up2</code> overwrites the result value set by the return statement.</p>\n"}], "owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 43479960, "answer_count": 1, "score": 1, "last_activity_date": 1492541184, "creation_date": 1492537145, "last_edit_date": 1492540477, "question_id": 43478834, "link": "https://stackoverflow.com/questions/43478834/why-defer-behaves-differently-with-variables-defined-in-the-surrounding-function", "title": "Why defer behaves differently with variables defined in the surrounding function than named results?", "body": "<p>The program below returns</p>\n\n<pre><code>&lt;nil&gt;\nhello\n</code></pre>\n\n<p>I expected both to return \"hello\" but it's not the case. I've found that the behaviour is given as example in the language <a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"nofollow noreferrer\">spec</a>.</p>\n\n<blockquote>\n  <p>For instance, if the deferred function is a function literal and the surrounding function has named result parameters that are in scope within the literal, the deferred function may access and modify the result parameters before they are returned.</p>\n</blockquote>\n\n<p>My question is: why does defer works differently with variables defined in the surrounding function than with named results? Isn't it just a closure executed before the surrounding function returns?</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    fmt.Println(up())\n    fmt.Println(up2())\n\n}\n\nfunc up() error {\n    var err error\n    defer func() {\n        err = errors.New(\"hello\")\n    }()\n    return err\n}\n\nfunc up2() (err error) {\n    defer func() {\n        err = errors.New(\"hello\")\n    }()\n    return err\n}\n\nfunc up3() error {\n    var err error\n    fn := func() {\n        err = errors.New(\"hello\")\n    }\n    fn()\n    return err\n}\n</code></pre>\n"}, {"tags": ["http", "go", "struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1492535212, "post_id": 43478050, "comment_id": 74011777, "body": "If you want a method to modify the value of its receiver you need to define that method on the pointer of that receiver <a href=\"https://tour.golang.org/methods/4\" rel=\"nofollow noreferrer\">tour.golang.org/methods/4</a>"}, {"owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492536264, "post_id": 43478050, "comment_id": 74012433, "body": "o.m.g., thank you. i knew that but i always forget it somehow. XD the same thing about zero being the first index in array. i always want to write loop starting at 1 instead of 0 XD"}], "answers": [{"tags": [], "owner": {"reputation": 10078, "user_id": 2709018, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/p98Vl.png?s=128&g=1", "display_name": "myaut", "link": "https://stackoverflow.com/users/2709018/myaut"}, "is_accepted": true, "score": 5, "last_activity_date": 1492535211, "creation_date": 1492535211, "answer_id": 43478240, "question_id": 43478050, "link": "https://stackoverflow.com/questions/43478050/setting-a-value-in-structure-fails/43478240#43478240", "title": "Setting a value in structure fails", "body": "<p>This is due to prototype of methods:</p>\n\n<pre><code>func (srv tServer) init()\n    // ^^^ copies values \n</code></pre>\n\n<p>so:</p>\n\n<pre><code>server.init()   // updates its own copy of server, \n                // copy gets disposed after init() returns\n\nserver.start()  // uses its own copy of server\n</code></pre>\n\n<p>You need to pass <code>srv</code> by pointer to methods:</p>\n\n<pre><code>func (srv *tServer) init()\n</code></pre>\n\n<p>in that case both <code>init()</code> and <code>start()</code> calls will work on the same copy of <code>tServer</code> structure and will share values in its fields.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1492535251, "creation_date": 1492535251, "answer_id": 43478251, "question_id": 43478050, "link": "https://stackoverflow.com/questions/43478050/setting-a-value-in-structure-fails/43478251#43478251", "title": "Setting a value in structure fails", "body": "<p>If you look at the docs for <a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\">http.Server</a> you will see that a blank value is possible, and means \":http\":</p>\n\n<pre><code>type Server struct {\n       Addr      string      // TCP address to listen on, \":http\" if empty\n</code></pre>\n\n<p>You set <code>srv.server.Addr</code> directly in <code>init()</code>, but this is not the proper way to use the <code>http.Server</code> type.</p>\n\n<p>Perhaps you meant to do this:</p>\n\n<pre><code>func (srv tServer) startServerRoutine() {\n    log.Println(\"Server started at\", srv.ipAddress + \":\" + srv.port) //\n    err := srv.server.ListenAndServe(srv.ipAddress + \":\" + srv.port)\n    if err != nil {\n        log.Println(\"Server Error:\", err) //\n        return\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 43478240, "answer_count": 2, "score": 1, "last_activity_date": 1492535256, "creation_date": 1492534605, "last_edit_date": 1492535256, "question_id": 43478050, "link": "https://stackoverflow.com/questions/43478050/setting-a-value-in-structure-fails", "title": "Setting a value in structure fails", "body": "<p>I set the value in the structure, but it is not set. The methods are called consequently, not in parallel. How can that be? This is golang, forgot to say. </p>\n\n<p>If I change the code to set value in the \"start\" method (instead of \"init\" method), it works; but setting value in \"init\" method fails. Looks very strange to me.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\ntype tServer struct {\n    ipAddress string\n    port      string\n    server    http.Server\n}\n\nvar server tServer\n\nfunc main() {\n    server.ipAddress = \"0.0.0.0\"\n    server.port = \"12345\"\n    server.init()\n    server.start()\n    time.Sleep(time.Second * 5)\n}\n\nfunc (srv tServer) init() {\n    srv.server.Addr = srv.ipAddress + \":\" + srv.port\n    log.Println(\"srv.server.Addr=\", srv.server.Addr) ////////////////////\n}\n\nfunc (srv tServer) start() {\n    log.Println(\"srv.server.Addr=\", srv.server.Addr) ////////////////////\n    go srv.startServerRoutine()\n}\n\nfunc (srv tServer) startServerRoutine() {\n    log.Println(\"Server started at\", srv.server.Addr) //\n    err := srv.server.ListenAndServe()\n    if err != nil {\n        log.Println(\"Server Error:\", err) //\n        return\n    }\n}\n</code></pre>\n\n<p>Here is the console:</p>\n\n<pre><code>2017/04/18 19:43:07 srv.server.Addr= 0.0.0.0:12345\n2017/04/18 19:43:07 srv.server.Addr= \n2017/04/18 19:43:07 Server started at \n2017/04/18 19:43:07 Server Error: listen tcp :80: bind: permission denied\n</code></pre>\n"}, {"tags": ["go", "parallel-processing"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492535864, "post_id": 43477725, "comment_id": 74012203, "body": "Please use <b>gofmt</b>! It makes your code much easier to read, and more correct. Your code had extra semicolons, and your second example wasn&#39;t even valid Go due to an extra <code>}</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1492537076, "post_id": 43477725, "comment_id": 74012954, "body": "Put simply: No. Both &quot;run in parallel&quot; for whatever that means. Most probably your observations are flawed."}], "answers": [{"comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1492614422, "post_id": 43478131, "comment_id": 74053314, "body": "@ChrisDave -- The article that was linked is from 2013 (very old in the programming world, but still something that should be read) and while I agree that concurrency is not parallelism, modern versions of Go 1.7 (or 1.6 can&#39;t remember) and higher use all cores by default allowing parallelism to be achieved. Before this change to the language one would have to manually set the number of cores to be used with runtime.GOMAXPROCS(runtime.NumCPU()). That all being said, John Weldon is correct in his assessment about your use of channels."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 3, "last_activity_date": 1492534874, "creation_date": 1492534874, "answer_id": 43478131, "question_id": 43477725, "link": "https://stackoverflow.com/questions/43477725/how-to-call-a-function-in-parallel-in-go/43478131#43478131", "title": "How to call a function in parallel in Go", "body": "<p>Keep in mind that goroutines provide concurrency, and <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">concurrency is not parallelism</a>.</p>\n\n<p>The problem in your first example is that you're reading from the unbuffered channel inside the for loop so the write that's happening in the goroutine is serialized waiting for the read.  Move the read outside of the for loop, and/or put the read in it's own goroutine and you may see more parallelization. </p>\n"}], "owner": {"reputation": 33, "user_id": 6565674, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/034e394f4221e6b84d4f8b7bdd08fa35?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisDave", "link": "https://stackoverflow.com/users/6565674/chrisdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "accepted_answer_id": 43478131, "answer_count": 1, "score": 0, "last_activity_date": 1492535829, "creation_date": 1492533532, "last_edit_date": 1492535829, "question_id": 43477725, "link": "https://stackoverflow.com/questions/43477725/how-to-call-a-function-in-parallel-in-go", "title": "How to call a function in parallel in Go", "body": "<p>I am trying to run a function in parallel.... when I do it </p>\n\n<pre><code>func runParallel() {\n    var out [5]chan string\n    for i := range out {\n        out[i] = make(chan string)\n    }\n    for j:=0; j&lt;2; j++ {\n        fmt.Println(\"\\nStarting: \", j)\n        go func() {\n            out[0] &lt;- f3(4)\n        }()\n\n        fmt.Println(&lt;-out[0])\n    }\n}\n\nfunc main() {    \n    runParallel()\n}\n</code></pre>\n\n<p>I see that function gets called serially one after the other... but when i do..</p>\n\n<pre><code>func runParallel() {\n    var out [5]chan string\n    for i := range out {\n        out[i] = make(chan string)\n    }\n\n    fmt.Println(\"\\nStarting: \", j)\n    go func() {\n        out[0] &lt;- f3(4)\n    }()\n    go func() {\n        out[0] &lt;- f3(4)\n    }()\n\n    fmt.Println(&lt;-out[0])\n}\n\nfunc main() {    \n    runParallel()\n}\n</code></pre>\n\n<p>The function gets called parallel.  </p>\n\n<p>I need to get the function called parallel in a for loop, Please help.</p>\n"}, {"tags": ["javascript", "jquery", "go", "highcharts"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1492528498, "post_id": 43475991, "comment_id": 74007206, "body": "Please export your field names, that is change <code>name string</code> to <code>Name string</code> etc."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1492528964, "creation_date": 1492528964, "answer_id": 43476180, "question_id": 43475991, "link": "https://stackoverflow.com/questions/43475991/highcharts-data-with-x-y-values-golang-struct/43476180#43476180", "title": "Highcharts data with x,y values golang struct", "body": "<p>For <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">encoding/json</a> to work the way you want to, you need to <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">export</a> your struct fields.</p>\n\n<p>From <code>encoding/json</code> docs:</p>\n\n<blockquote>\n  <p>Struct values encode as JSON objects. Each <strong>exported</strong> struct field\n  becomes a member of the object, using the field name as the object\n  key, unless the field is omitted for one of the reasons given below.</p>\n</blockquote>\n\n<p>Same for decoding:</p>\n\n<blockquote>\n  <p>Unmarshal will only set <strong>exported</strong> fields of the struct.</p>\n</blockquote>\n"}], "owner": {"reputation": 21, "user_id": 7882490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11585a44ba9797a79911d773cac06023?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Tao", "link": "https://stackoverflow.com/users/7882490/robert-tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "closed_date": 1492532682, "answer_count": 1, "score": 0, "last_activity_date": 1492789431, "creation_date": 1492528403, "last_edit_date": 1492789431, "question_id": 43475991, "link": "https://stackoverflow.com/questions/43475991/highcharts-data-with-x-y-values-golang-struct", "closed_reason": "Duplicate", "title": "Highcharts data with x,y values golang struct", "body": "<p><strong>Question Updated</strong></p>\n\n<p>Thank you all for answering my immature question asked last time, however, I still cannot figure out how to handle the [x,y] series data.</p>\n\n<p>It works fine when <strong>Data</strong> is a single array of integers, but an array of struct doesn't work. How can I solve it?</p>\n\n<pre><code>series: [{//should work like this\n    data: [\n        [\"1\", 29.9],\n        [\"2\", 71.5],\n        [\"3\", 106.4]\n    ]\n}]\n\ntype Line struct {//my struct\nData []Point `json:\"data\"`  //this is the tricky part\n}\n\ntype Point struct {\nDate  string\nValue int\n}\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>&lt;script&gt;\r\n$(document).ready(function() {\r\n    var options = {\r\n        chart: {\r\n            renderTo: 'ERP_Chart',\r\n            type: 'spline'\r\n        },\r\n        series: []\r\n   };\r\n\r\n   $.getJSON(\"/Get_ERP_Chart\", function(data) {\r\n       options.series = data;\r\n       var chart = new Highcharts.Chart(options);\r\n    });\r\n});\r\n&lt;/script&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>My server-side Go code</p>\n\n<pre><code>type Line struct {\nData []Point `json:\"data\"`  //this is the tricky part...\n}\n\ntype Point struct {\nDate  string\nValue int\n}\n\nfunc showERPChart(writer http.ResponseWriter, request *http.Request) {\n\nvar profit, expense, contacts Line\nvar chart []Line\n\nrows, err := Db.Query(\"SELECT profit,expense,contacts,_date FROM Sells ORDER BY _date\")\n\nvar prof, exp, con int\nvar date string\n\nfor rows.Next() {\n    err = rows.Scan(&amp;prof, &amp;exp, &amp;con, &amp;date)\n    profit.Data = append(profit.Data, Point{date, prof})\n    expense.Data = append(expense.Data, Point{date, exp})\n    contacts.Data = append(contacts.Data, Point{date, con})\n}\n\nchart = append(chart, profit)\nchart = append(chart, expense)\nchart = append(chart, contacts)\n\njs, _:= json.Marshal(chart)\n\nwriter.Write(js)\n}\n</code></pre>\n"}, {"tags": ["go", "slice", "sizeof"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492525913, "post_id": 43474910, "comment_id": 74005099, "body": "Go also has <a href=\"https://golang.org/pkg/unsafe/#Sizeof\" rel=\"nofollow noreferrer\">Sizeof</a>, but I don&#39;t think that will help you here."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1492525856, "creation_date": 1492525856, "answer_id": 43475028, "question_id": 43474910, "link": "https://stackoverflow.com/questions/43474910/better-way-to-determine-required-storage-for-byte/43475028#43475028", "title": "Better way to determine required storage for []byte", "body": "<p>Can you use <code>len()</code>?</p>\n\n<pre><code>newBuf := make([]byte,len(oldBuf))\ncopy(newBuf, oldBuf)\n</code></pre>\n\n<p>If you have more complex requirements, please explain them.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1492528091, "last_edit_date": 1492528091, "creation_date": 1492525917, "answer_id": 43475058, "question_id": 43474910, "link": "https://stackoverflow.com/questions/43474910/better-way-to-determine-required-storage-for-byte/43475058#43475058", "title": "Better way to determine required storage for []byte", "body": "<p>In Go use the builtin <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\"><code>len()</code></a> function. Store the result of slicing, and use <code>len()</code> on it:</p>\n\n<pre><code>func unpackDiscoverResp(buff []byte) Device {\n    d := Device{}\n\n    mac := buff[7:7+6]\n    d.Mac = make([]byte, len(mac))\n    copy(d.Mac, mac)\n\n    reverseMac := buff[7+12:7+6+12]\n    d.ReverseMac = make([]byte, len(reverseMac))\n    copy(d.ReverseMac, reverseMac)\n\n    d.IsOn = buff[41] != 0\n    return d\n}\n</code></pre>\n\n<p>But if you just want to make a copy of it, it's easier / shorter to just append to a <code>nil</code> slice (the builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a> function allocates storage as needed):</p>\n\n<pre><code>func unpackDiscoverResp(buff []byte) Device {\n    d := Device{}\n    d.Mac = append(d.Mac, buff[7:7+6]...)\n    d.ReverseMac = append(d.ReverseMac, buff[7+12:7+6+12]...)\n    d.IsOn = buff[41] != 0\n    return d\n}\n</code></pre>\n\n<p>Or simply in the composite literal:</p>\n\n<pre><code>d := Device{\n    Mac:        append([]byte(nil), buff[7:7+6]...),\n    ReverseMac: append([]byte(nil), buff[7+12:7+6+12]...),\n}\n</code></pre>\n\n<p>One thing to note here: <code>append()</code> might allocate a bigger backing array than what is needed (it \"optimizes\" for future appends), so if you want to avoid that, the first solution with <code>copy()</code> is better.</p>\n"}, {"tags": [], "owner": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "is_accepted": false, "score": 0, "last_activity_date": 1492615939, "creation_date": 1492615939, "answer_id": 43500132, "question_id": 43474910, "link": "https://stackoverflow.com/questions/43474910/better-way-to-determine-required-storage-for-byte/43500132#43500132", "title": "Better way to determine required storage for []byte", "body": "<p>Thanks - <code>len()</code> is the key. I replaced the original code with</p>\n\n<pre><code>// copyMac allocates space for and copies MAC addr from slice\nfunc copyMac(dst *net.HardwareAddr, src []byte) {\n    *dst = make([]byte, len(src))\n    copy(*dst, src)\n}\n\n// Code to find and send commands to Orvibo S20 WiFi controlled outlets\n// The outlets need to brought into the network first (AKA paired)\n// and for that see pair.go\nfunc unpackDiscoverResp(ip *net.UDPAddr, buff []byte) Device {\n    d := Device{IpAddr: *ip}\n    copyMac(&amp;d.Mac, buff[7:7+6])\n    copyMac(&amp;d.ReverseMac, buff[7+12:7+6+12])\n    d.IsOn = buff[41] != 0\n    return d\n}\n</code></pre>\n\n<p>I'm happier with that than my original code. (I do need to fix that comment which has lost its connection to the code.)</p>\n"}], "owner": {"reputation": 232, "user_id": 79178, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/3b12de015ea506efbd7e9660fbce61f3?s=128&d=identicon&r=PG", "display_name": "HankB", "link": "https://stackoverflow.com/users/79178/hankb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1492615939, "creation_date": 1492525505, "last_edit_date": 1492526466, "question_id": 43474910, "link": "https://stackoverflow.com/questions/43474910/better-way-to-determine-required-storage-for-byte", "title": "Better way to determine required storage for []byte", "body": "<p>I've got a bit of code that unpacks a message read from a UDP socket including the devices MAC address (which the device stores in the message itself). I have found that just assigning the <code>[]byte</code> slice to the struct member copies the address of the MAC address in the buffer. I can copy the value using the <code>copy()</code> primitive and that only works if I first allocate storage in the destination. The following code works:</p>\n\n<pre><code>// You can edit this code!\n// Click here and start typing.\npackage main\n\nimport (\n    \"fmt\"\n    \"net\"\n)\n\n// information about an Orvibo S20 IoT device\ntype Device struct {\n    Mac, ReverseMac net.HardwareAddr // MAC address (and reversed)\n    IsOn            bool             // power state\n}\n\n// function to unpack the info from the Discover reply\nfunc unpackDiscoverResp(buff []byte) Device {\n    d := Device{}\n    d.Mac = make([]byte, 6)\n    copy(d.Mac, buff[7:7+6])\n    d.ReverseMac = make([]byte, 6)\n    copy(d.ReverseMac, buff[7+12:7+6+12])\n    d.IsOn = buff[41] != 0\n    return d\n}\n\nfunc main() {\n    s1 := []byte{\n        0x68, 0x64, 0x00, 0x2a, 0x71, 0x61, 0x00, 0xac, 0xcf, 0x23, 0x36, 0x02, 0x0e, 0x20, 0x20, 0x20,\n        0x20, 0x20, 0x20, 0x0e, 0x02, 0x36, 0x23, 0xcf, 0xac, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x53,\n        0x4f, 0x43, 0x30, 0x30, 0x35, 0x2e, 0xe1, 0x9d, 0xdc, 0x00}\n    s2 := []byte{\n        0x68, 0x64, 0x00, 0x2a, 0x71, 0x61, 0x00, 0xac, 0xcf, 0x23, 0x55, 0xfe, 0x22, 0x20, 0x20, 0x20,\n        0x20, 0x20, 0x20, 0x22, 0xfe, 0x55, 0x23, 0xcf, 0xac, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20, 0x53,\n        0x4f, 0x43, 0x30, 0x30, 0x35, 0x39, 0x87, 0x1b, 0xbc, 0x01}\n\n    msgs := [][]byte{s1, s2}\n\n    devices := make([]Device, 0)\n\n    for _, msg := range msgs {\n        d := unpackDiscoverResp(msg)\n        devices = append(devices, d)\n        fmt.Println(d)\n    }\n\n    //d1 := unpackDiscoverResp(s1)\n    //devices = append(devices, d1)\n    //d2 := unpackDiscoverResp(s2)\n    //devices = append(devices, d2)\n    //fmt.Println(d1)\n    fmt.Println(devices)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/vMdNlX5H2H\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vMdNlX5H2H</a>\nThe part I don't like is line 19 (and 21)</p>\n\n<pre><code>d.Mac = make([]byte, 6)\n</code></pre>\n\n<p>It seems to me that this must be common pattern and there should be a way to get the size required for the storage. Since I've hard coded the slice length I'm copying from I suppose hard coding the storage required is no worse, but in the more general sense I'd prefer to do better. (In C I'd use the <code>sizeof</code> operator but this isn't C.)</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["email", "go", "alert", "metrics", "prometheus"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7757989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95f4d2fca153e2e63ccede4371cb558?s=128&d=identicon&r=PG&f=1", "display_name": "iso123", "link": "https://stackoverflow.com/users/7757989/iso123"}, "edited": false, "score": 0, "creation_date": 1492523597, "post_id": 43473789, "comment_id": 74003228, "body": "thanks for the reply. That&#39;s fixed the issue but I&#39;m now getting ` &lt;first&gt;: error calling first: first() called on vector with no elements&quot;<code>. If I access </code>cs_job_time` from Prometheus, there is a value. I also tried changing <code>first</code> to <code>range</code> but got the error message in my original post but I&#39;m sure I&#39;m doing that wrong (sorry, I&#39;m new to Go templating)"}, {"owner": {"reputation": 24634, "user_id": 83591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuiTl.jpg?s=128&g=1", "display_name": "brian-brazil", "link": "https://stackoverflow.com/users/83591/brian-brazil"}, "reply_to_user": {"reputation": 69, "user_id": 7757989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95f4d2fca153e2e63ccede4371cb558?s=128&d=identicon&r=PG&f=1", "display_name": "iso123", "link": "https://stackoverflow.com/users/7757989/iso123"}, "edited": false, "score": 0, "creation_date": 1492524580, "post_id": 43473789, "comment_id": 74004042, "body": "I&#39;d guess your job label is incorrect. See <a href=\"https://prometheus.io/docs/visualization/template_examples/#simple-iteration\" rel=\"nofollow noreferrer\">prometheus.io/docs/visualization/template_examples/&hellip;</a> for an example."}, {"owner": {"reputation": 69, "user_id": 7757989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95f4d2fca153e2e63ccede4371cb558?s=128&d=identicon&r=PG&f=1", "display_name": "iso123", "link": "https://stackoverflow.com/users/7757989/iso123"}, "edited": false, "score": 1, "creation_date": 1492527014, "post_id": 43473789, "comment_id": 74006022, "body": "Thanks, it&#39;s working. I hardcoded the jobname and it worked. If anyone wants just the value, add the <code>value</code> parameter too. E.g. <code>{{ `cs_job_time{instance=&#39;localhost:9091&#39;,job=&#39;jobname&#39;}` | query | first | value}}</code>"}], "tags": [], "owner": {"reputation": 24634, "user_id": 83591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuiTl.jpg?s=128&g=1", "display_name": "brian-brazil", "link": "https://stackoverflow.com/users/83591/brian-brazil"}, "is_accepted": true, "score": 2, "last_activity_date": 1492522561, "creation_date": 1492522561, "answer_id": 43473789, "question_id": 43473473, "link": "https://stackoverflow.com/questions/43473473/prometheus-email-alert-to-show-metric-value/43473789#43473789", "title": "Prometheus email alert to show metric value", "body": "<p>You're missing the <code>printf</code> there from the example:</p>\n\n<pre><code>\"{{ printf `cs_job_time{instance='%s', job='/'}` $labels.instance | query | first }}\"\n</code></pre>\n\n<p>Be careful though, if there's no results then the <code>first</code> will fail. It's generally best to use a range statement as that'll be resilient to that.</p>\n"}], "owner": {"reputation": 69, "user_id": 7757989, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e95f4d2fca153e2e63ccede4371cb558?s=128&d=identicon&r=PG&f=1", "display_name": "iso123", "link": "https://stackoverflow.com/users/7757989/iso123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2184, "favorite_count": 1, "accepted_answer_id": 43473789, "answer_count": 1, "score": 1, "last_activity_date": 1492522561, "creation_date": 1492521723, "last_edit_date": 1592644375, "question_id": 43473473, "link": "https://stackoverflow.com/questions/43473473/prometheus-email-alert-to-show-metric-value", "title": "Prometheus email alert to show metric value", "body": "<p>I have a label <code>cs_job_time</code> in Prometheus/Alert Manager and would like to send an email alert when a condition is met for another job. The email sends fine but is it possible to include the value of <code>cs_job_time</code> within the email? I can use <code>{{$value}}</code> for the metric in question but I would also like to print the value of <code>cs_job_time</code>.</p>\n<p>I came across <a href=\"https://github.com/prometheus/alertmanager/issues/549\" rel=\"nofollow noreferrer\">this</a> but when I try</p>\n<pre><code>time = &quot;{{  `cs_job_time{instance='%s', job='/'}` $labels.instance | query | first }}\n</code></pre>\n<p>or similar variants, I get the error message <code>&quot;Error expanding alert template CSJobAlert with data '{map[] 2123}': runtime error: invalid memory address or nil pointer dereference&quot; source=&quot;alerting.go:199&quot;</code></p>\n<p>Is it possible to email metric values?</p>\n"}, {"tags": ["http", "go", "tcp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492522030, "post_id": 43473411, "comment_id": 74001927, "body": "<a href=\"https://golang.org/pkg/net/#Listener\" rel=\"nofollow noreferrer\"><code>net.Listener</code></a> has a <code>Close</code> method, and the <a href=\"https://golang.org/pkg/net/http/#Server\" rel=\"nofollow noreferrer\"><code>http.Server</code></a> has <code>Shutdown</code> and <code>Close</code> methods. Are you asking about the use of these methods? What &quot;cleanup&quot; are you trying to so?"}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492523873, "post_id": 43473411, "comment_id": 74003464, "body": "@JimB I am familiar with the <code>Close</code> and <code>Shutdown</code> methods, I just need a way to synchronise the two goroutines so I can call said methods when I want to stop the application. R.E cleanup: I am referring to other business logic I may be doing at the same time (writing to a DB, etc)."}], "answers": [{"comments": [{"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1492525988, "post_id": 43474751, "comment_id": 74005172, "body": "Thanks, Jim. I did initially go down this route, but I started to doubt my choice. My only question would be: what do you do with the <code>err</code> from the call to <code>net.Listen()</code>? Would you also pass it down the <code>tcpErr</code> chan?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1492526438, "post_id": 43474751, "comment_id": 74005534, "body": "@danbondd: you could, it&#39;s up to you. Since the http server is started by that point, you may want that error to exit through the same code path. Trying to make this as concise as possible, I didn&#39;t add all possible error checks into the code."}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1492526732, "post_id": 43474751, "comment_id": 74005773, "body": "thanks - I&#39;ll implement this and accept your answer."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1492526545, "last_edit_date": 1492526545, "creation_date": 1492525055, "answer_id": 43474751, "question_id": 43473411, "link": "https://stackoverflow.com/questions/43473411/gracefully-shutting-down-multiple-servers/43474751#43474751", "title": "Gracefully shutting down multiple servers", "body": "<p>Start by keeping a reference to the http server and the tcp listener so that you can later close them.</p>\n\n<p>Create separate error channels so you know which path returned the error, and buffer them so that a send can always complete.</p>\n\n<p>To make sure that whatever cleanup you want to attempt is complete before you exit, you can add a WaitGroup to the server goroutines. </p>\n\n<p>I simple extension of your example might look like:</p>\n\n<pre><code>var wg sync.WaitGroup\n\n// create  HTTP server.\nserveSvr := http.NewServeMux()\nserveSvr.HandleFunc(\"/\", handler())\nserver := &amp;http.Server{Addr: \":8080\", Handler: serveSvr}\n\n// create http server error channel\nhttpErr := make(chan error, 1)\n\n// start HTTP server.\nwg.Add(1)\ngo func() {\n    defer wg.Done()\n    httpErr &lt;- server.ListenAndServe()\n    // http cleanup\n}()\n\ntcpErr := make(chan error, 1)\nlistener, err := net.Listen(\"tcp\", \":1111\")\nif err != nil {\n    tcpErr &lt;- err\n} else {\n    // start TCP server\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        defer listener.Close()\n        for {\n            conn, err := listener.Accept()\n            if err != nil {\n                if ne, ok := err.(net.Error); ok &amp;&amp; ne.Temporary() {\n                    // temp error, wait and continue\n                    continue\n                }\n                tcpErr &lt;- err\n\n                // cleanup TCP\n                return\n            }\n\n            // code to handle each connection\n        }\n    }()\n}\nselect {\ncase err := &lt;-httpErr:\n    // handle http error and close tcp listen\n    if listener != nil {\n        listener.Close()\n    }\ncase err := &lt;-tcpErr:\n    // handle tcp error and close http server\n    server.Close()\n}\n\n// you may also want to receive the error from the server\n// you shutdown to log\n\n// wait for any final cleanup to finish\nwg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 492, "favorite_count": 0, "accepted_answer_id": 43474751, "answer_count": 1, "score": 1, "last_activity_date": 1492526545, "creation_date": 1492521568, "question_id": 43473411, "link": "https://stackoverflow.com/questions/43473411/gracefully-shutting-down-multiple-servers", "title": "Gracefully shutting down multiple servers", "body": "<p>I have an application that runs a basic HTTP server and also accepts connections over TCP.</p>\n\n<p>Basic pseudo code is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n    \"net/http\"\n)\n\nfunc main() {\n    // create serve HTTP server.\n    serveSvr := http.NewServeMux()\n    serveSvr.HandleFunc(\"/\", handler())\n\n    // create server error channel\n    svrErr := make(chan error)\n\n    // start HTTP server.\n    go func() {\n        svrErr &lt;- http.ListenAndServe(\":8080\", serveSvr)\n    }()\n\n    // start TCP server\n    go func() {\n        lnr, err := net.Listen(\"tcp\", \":1111\")\n        if err != nil {\n            svrErr &lt;- err\n            return\n        }\n        defer lnr.Close()\n\n        for {\n            conn, err := lnr.Accept()\n            if err != nil {\n                log.Printf(\"connection error: %v\", err)\n                continue\n            }\n            // code to handle each connection\n        }\n    }()\n\n    select {\n    case err := &lt;-svrErr:\n        log.Print(err)\n    }\n}\n</code></pre>\n\n<p>I run both servers in separate goroutines and I need a way to gracefully shut them both down if either of them fail. For example; if the HTTP server errors, how would I go back and shutdown the TCP server/perform any cleanup?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1492531732, "last_edit_date": 1495540027, "creation_date": 1492531732, "answer_id": 43477173, "question_id": 43473122, "link": "https://stackoverflow.com/questions/43473122/go-mgo-get-field-type/43477173#43477173", "title": "Go mgo get field type", "body": "<p>I'm not sure about a way to get the type of the field <em>before</em> doing the query, but <a href=\"https://stackoverflow.com/a/18346347/102371\">one</a> approach is to simply query into an <code>bson.M</code> and then do type detection on the retrieved values:</p>\n\n<pre><code>var res bson.M\n// ...\nerr = db.DB.C(collection).Find(fields).Limit(limint).All(&amp;res)\n// ...\nfor key, val := range res {\n  switch val.(type) {\n  case string:\n    // handle\n  case int:\n    // handle\n  // ...\n  default:\n    // handle\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 62, "user_id": 6556346, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1e73ecba799839091bf709d219a82665?s=128&d=identicon&r=PG&f=1", "display_name": "JM445", "link": "https://stackoverflow.com/users/6556346/jm445"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492531732, "creation_date": 1492520898, "question_id": 43473122, "link": "https://stackoverflow.com/questions/43473122/go-mgo-get-field-type", "title": "Go mgo get field type", "body": "<p>I'm creating an API in Go using MongoDB and mgo as storage engine.\nI wrote sort of an abstraction for GET requests letting user filter the results by fields in query string parameters, but it only works for string fields.</p>\n\n<p>I'm searching for a way to get a field's type with only field name, in order to cast parameter to correct type before searching in collection.\nHere is the code: </p>\n\n<pre><code>func (db *DataBase) GetByFields(fields *map[string]interface{}, collection string) ([]DataModel, error) {\n    var res []interface{}\n\n    Debug(\"Getting \" + collection + \" by fields: \")\n    for i, v := range *fields {\n        Debug(\"=&gt; \" + i + \" = \" + v.(string))\n        // Here would be the type checking\n    }\n\n    if limit, ok := (*fields)[\"limit\"]; ok {\n        limint, err := strconv.Atoi(limit.(string))\n        if err != nil {...} // Err Handling\n        delete(*fields, \"limit\")\n        err = db.DB.C(collection).Find(fields).Limit(limint).All(&amp;res)\n        if err != nil {...} // Err Handling\n    } else {\n        err := db.DB.C(collection).Find(fields).All(&amp;res)\n        if err != nil {...} // Err Handling\n    }\n\n    resModel := ComputeModelSlice(res, collection)\n    return resModel, nil\n}\n</code></pre>\n\n<p>With mongodb I can check type with:</p>\n\n<pre><code>db.getCollection('CollectionName').findOne().field_name instanceof typeName\n</code></pre>\n\n<p>But I can't find a way to perform that with mgo.\nAny idea?</p>\n"}, {"tags": ["html", "http", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1492521117, "post_id": 43473046, "comment_id": 74001193, "body": "How are you redirecting? outputHTML == http.Redirect() ?  If so in the redirect you two options. 1) pass the data as a URL parameter and on the backend grab the parameter, pass to the template and render.   2) Redirect to another backend endpoint, which handles all the logic, sets the data up, and renders the template. You can&#39;t pass data directly on a redirect.  Example myTemplate.ExecuteTemplate(w, &quot;base&quot;, data). Also see the html package <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492521243, "post_id": 43473046, "comment_id": 74001306, "body": "Please show the definition of <code>outputHTML</code> since that&#39;s the function that renders your login page."}, {"owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492521617, "post_id": 43473046, "comment_id": 74001612, "body": "@mkopriva, i updated my question with relevant data i guess now"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1492522868, "post_id": 43473046, "comment_id": 74002613, "body": "Check out this <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">tutorial</a> in particular about using <code>html&#47;template</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1522044625, "last_edit_date": 1522044625, "creation_date": 1492522883, "answer_id": 43473919, "question_id": 43473046, "link": "https://stackoverflow.com/questions/43473046/how-to-send-variable-and-its-value-to-html/43473919#43473919", "title": "How to send variable and its value to html", "body": "<p>To be able to display values in your html you can use Go's <code>html/template</code> package.</p>\n\n<p>First you'll need to specify where in the html page you want your values to appear, using the <code>html/template</code> package you can do that with <a href=\"https://golang.org/pkg/text/template/#pkg-overview\" rel=\"nofollow noreferrer\">template actions</a>.</p>\n\n<blockquote>\n  <p>\"Actions\"--data evaluations or control structures--are delimited by\n  \"{{\" and \"}}\"</p>\n</blockquote>\n\n<p>Next you'll need to drop the <code>http.ServeContent</code> function as that does not know how to render templates, instead you can use <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\">Execute</a> to display the login page together with your values.</p>\n\n<p>Here's an example:</p>\n\n<p><strong>login.html</strong>:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;body&gt;\n        &lt;h1&gt;{{.MyVar}}&lt;/h1&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>outputHTML</strong>:</p>\n\n<pre><code>func outputHTML(w http.ResponseWriter, filename string, data interface{}) {\n    t, err := template.ParseFiles(filename)\n    if err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n    if err := t.Execute(w, data); err != nil {\n        http.Error(w, err.Error(), 500)\n        return\n    }\n}\n</code></pre>\n\n<p>And your <strong>loginHandler</strong>:</p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n\n    // do whatever you need to do\n\n    myvar := map[string]interface{}{\"MyVar\": \"Foo Bar Baz\"}\n    outputHTML(w, \"static/login.html\", myvar)\n}\n</code></pre>\n\n<p>Read more on templates here: <a href=\"https://golang.org/pkg/html/template\" rel=\"nofollow noreferrer\">html/template</a> and for information about how to program the templates themselves, see the documentation for <a href=\"https://golang.org/pkg/text/template\" rel=\"nofollow noreferrer\">text/template</a></p>\n"}], "owner": {"reputation": 183, "user_id": 4903596, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-l1la9rNAGIU/AAAAAAAAAAI/AAAAAAAAACk/m-VUMTDlbu0/photo.jpg?sz=128", "display_name": "vijay", "link": "https://stackoverflow.com/users/4903596/vijay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2677, "favorite_count": 1, "accepted_answer_id": 43473919, "answer_count": 1, "score": 0, "last_activity_date": 1522044625, "creation_date": 1492520689, "last_edit_date": 1492524791, "question_id": 43473046, "link": "https://stackoverflow.com/questions/43473046/how-to-send-variable-and-its-value-to-html", "title": "How to send variable and its value to html", "body": "<p>I have written a small piece of code in go </p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"loginHandler\")\n    log.Println(\"request url is\", r.RequestURI)\n    log.Println(\"request method\", r.Method)\n    requestbody, _ := ioutil.ReadAll(r.Body)\n    log.Println(\"request body is\", string(requestbody))\n    if r.Method == \"POST\" {\n        us, err := globalSessions.SessionStart(w, r)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        us.Set(\"LoggedInUserID\", \"000000\")\n        w.Header().Set(\"Location\", \"/auth\")\n        w.WriteHeader(http.StatusFound)\n        return\n    }\n    outputHTML(w, r, \"static/login.html\")\n}\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>func outputHTML(w http.ResponseWriter, req *http.Request, filename string) {\r\n\tlog.Println(\"outputHTML\")\r\n\trequestbody, _ := ioutil.ReadAll(req.Body)\r\n\tlog.Println(\"request body is\", string(requestbody))\r\n\tlog.Println(\"request body is\", requestbody)\r\n\tfile, err := os.Open(filename)\r\n\tif err != nil {\r\n\t\thttp.Error(w, err.Error(), 500)\r\n\t\treturn\r\n\t}\r\n\tdefer file.Close()\r\n\tfi, _ := file.Stat()\r\n\thttp.ServeContent(w, req, file.Name(), fi.ModTime(), file)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>in this code i am redirecting to login.html . now i want to send a variable let it be some string called testvariable and its value to login.html. </p>\n"}, {"tags": ["go", "google-cloud-datastore", "datastore"], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492522282, "post_id": 43473165, "comment_id": 74002125, "body": "Could you take a look at the updated question? I think you mean it can be done like this? In this scenario then there would likely only be 1 entity with ApprovalStatus=1 as the previously approved entities would be set to discontinued (ApprovalStatus=3)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492524497, "post_id": 43473165, "comment_id": 74003971, "body": "As far as the <code>TournamentID</code> goes, that&#39;s how I would do it when using a relational database like <code>postgres</code> but I really have no idea how one should model relationships in gae&#39;s <code>datastore</code> with Go... but if the example from your update works for you then that is <i>probably</i> how it should be done. Regarding the <code>status</code>, discontinuing the last approved edit after approving a new one makes sense to me."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1492520997, "creation_date": 1492520997, "answer_id": 43473165, "question_id": 43472580, "link": "https://stackoverflow.com/questions/43472580/designing-a-datastore-schema-for-a-page-that-users-can-edit-e-g-a-wikipedia-st/43473165#43473165", "title": "Designing a Datastore schema for a page that users can edit (e.g. a wikipedia/stackoverflow page)", "body": "<p>One thing you could do is to simply create a new entity that would represent the <code>edit</code> of a tournament. By the way, I'm not a <code>datastore</code> user so I'm not sure if this is how you would model the entities but the general idea is the same for most, if not all, databases:</p>\n\n<pre><code>type Tournament struct {\n    ID          in64   `datastore:\"-\"`\n    MDContent   []byte `datastore:\",noindex\"`\n    Name        string\n    URL         string\n    DateCreated int64\n    CreatedBy   string\n    DateUpdated int64\n    UpdatedBy   string\n    Edits       []TournamentEdit\n}\n\ntype TournamentEdit struct {\n    ID             in64   `datastore:\"-\"`\n    MDContent      []byte `datastore:\",noindex\"`\n    DateCreated    int64\n    CreatedBy      string\n    ApprovalStatus int64 // 0=to be decided, 1=approved, 2=rejected, 3=discontinued\n    ApprovalBy     string\n}\n</code></pre>\n\n<p>This should allow you to have multiple edits from different users in the queue, CRUD a specific edit, and or filter edits by their status.</p>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 43473165, "answer_count": 1, "score": 0, "last_activity_date": 1492522018, "creation_date": 1492519537, "last_edit_date": 1492522018, "question_id": 43472580, "link": "https://stackoverflow.com/questions/43472580/designing-a-datastore-schema-for-a-page-that-users-can-edit-e-g-a-wikipedia-st", "title": "Designing a Datastore schema for a page that users can edit (e.g. a wikipedia/stackoverflow page)", "body": "<p>The idea is to design a table/entity that contains some basic info, as well as a Markdown-Content field that would allow users to easily create tables and such.</p>\n\n<p>I'm thinking something like this:</p>\n\n<pre><code>type Tournament struct {\n  ID in64 `datastore:\"-\"`\n  MDContent []byte `datastore:\",noindex\"`\n  Name string\n  URL string\n  DateCreated int64\n  CreatedBy string\n  DateUpdated int64\n  UpdatedBy string\n  ApprovalStatus int64 // 0=to be decided, 1=approved, 2=rejected, 3=discontinued\n  ApprovalBy string\n}\n</code></pre>\n\n<p>My problem is figuring out how to update it. The ID field will also be used as the URL path, e.g. if an entity has ID 7 then it will be displayed on example.com/tournament/7.</p>\n\n<p>I believe this eliminates the possibility of simply creating a new entity with updated data, and then set the ApprovalStatus=3 on the previous entity, because if you do as such then the example.com/tournament/7 URL will no longer request the correct ID.</p>\n\n<p>I also don't like the idea of creating my own unique ID because I think it would be great to simply take advantage of the Datastore ID generation (which also makes it easy to get the correct entity based on URL); I considered creating a new entity/table that would keep track of revisions but I'm not sure how efficient all of this is, so I was hoping some expert might be able to give some advice.</p>\n\n<hr>\n\n<p>Update related to @mkopriva solution:</p>\n\n<p>If you do it this way, then it's necessary to include a TournamentID field inside the TournamentEdit entity struct I think?</p>\n\n<pre><code>type TournamentEdit struct {\n    ID             in64   `datastore:\"-\"`\n    TournamentID   int64\n    MDContent      []byte `datastore:\",noindex\"`\n    DateCreated    int64\n    CreatedBy      string\n    ApprovalStatus int64 // 0=to be decided, 1=approved, 2=rejected, 3=discontinued\n    ApprovalBy     string\n}\n</code></pre>\n\n<p>And then the retrieve function could look like this:</p>\n\n<pre><code>func (db *datastoreDB) GetTournamentByKeyID(ctx context.Context, keyID int64) (*Tournament, error) {\n  key := datastore.IDKey(\"Tournament\", keyID, nil)\n  var tournamnet Tournament\n  err := db.client.Get(ctx, key, &amp;tournament)\n  // err checking\n  tournament.ID = key.ID\n\n  var edits TournamentEdits\n  query := datastore.NewQuery(\"TournamentEdit\")\n  query = query.Filter(\"TournamentID =\", tournament.ID)\n  query = query.Filter(\"ApprovalStatus =\", 1)\n  if _, err := db.client.GetAll(ctx, query, &amp;edits); err != nil {\n    //err checking\n  }\n  tournament.Edits = edits // I guess this is wrong way to do it?\n  return &amp;tournament, nil\n}\n</code></pre>\n\n<p>Would this work?</p>\n"}, {"tags": ["curl", "go", "multipartform-data", "beego"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492525259, "post_id": 43471581, "comment_id": 74004581, "body": "Before calling <code>Bind</code> try calling the <a href=\"https://godoc.org/github.com/astaxie/beego/context#BeegoInput.ParseFormOrMulitForm\" rel=\"nofollow noreferrer\">ParseFormOrMulitForm</a> method on input. Please note the Mu<b>li</b>t typo is not mine, that&#39;s how the method is defined."}, {"owner": {"reputation": 4355, "user_id": 1392154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/61e860048a2e2226ea2726fe3d29451a?s=128&d=identicon&r=PG", "display_name": "Elmor", "link": "https://stackoverflow.com/users/1392154/elmor"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492526670, "post_id": 43471581, "comment_id": 74005726, "body": "No luck, please see updates"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1492532539, "creation_date": 1492532539, "answer_id": 43477427, "question_id": 43471581, "link": "https://stackoverflow.com/questions/43471581/beego-how-to-access-params-submitted-with-multipart-form-data-header/43477427#43477427", "title": "Beego how to access params submitted with multipart/form-data header?", "body": "<p>You should be able to access the <code>name</code> parameter value using the <a href=\"https://godoc.org/github.com/astaxie/beego/context#BeegoInput.Query\" rel=\"nofollow noreferrer\">Query</a> method, like so:</p>\n\n<pre><code>name := c.Ctx.Input.Query(\"name\")\n</code></pre>\n\n<p>If you want to use <code>Bind</code> you can do something like this:</p>\n\n<pre><code>names := []string{}\nif err := c.Ctx.Input.Bind(&amp;names, \"name\"); err != nil {\n    panic(err)\n}\nlog.Println(name[0]) // first\n</code></pre>\n\n<p>But you'll also have to update your <code>curl</code> to specifically declare the <code>name</code> parameter as an array with index:</p>\n\n<pre><code>curl ... -F \"name[0]=first\"\n</code></pre>\n\n<p>This is because internally Go stores a form's parameter values in a slice of strings (see <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\">url.Values</a>) and beego is using this as well, so after beego parses the form it will look like this <code>url.Values{\"name\": []string{\"first\"}}</code> and so beego does not know how to bind <code>[]string{\"first\"}</code> into a plain <code>string</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10506008, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YzzHFzr2v8M/AAAAAAAAAAI/AAAAAAAAAAo/uHjIUQYc2Tw/photo.jpg?sz=128", "display_name": "yuxin zhang", "link": "https://stackoverflow.com/users/10506008/yuxin-zhang"}, "is_accepted": false, "score": 1, "last_activity_date": 1539589322, "creation_date": 1539589322, "answer_id": 52811899, "question_id": 43471581, "link": "https://stackoverflow.com/questions/43471581/beego-how-to-access-params-submitted-with-multipart-form-data-header/52811899#52811899", "title": "Beego how to access params submitted with multipart/form-data header?", "body": "<p>change the \"Content-Type: multipart/form-data to enctype:multipart/form-data</p>\n"}], "owner": {"reputation": 4355, "user_id": 1392154, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/61e860048a2e2226ea2726fe3d29451a?s=128&d=identicon&r=PG", "display_name": "Elmor", "link": "https://stackoverflow.com/users/1392154/elmor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1061, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1539589322, "creation_date": 1492516899, "last_edit_date": 1492678941, "question_id": 43471581, "link": "https://stackoverflow.com/questions/43471581/beego-how-to-access-params-submitted-with-multipart-form-data-header", "title": "Beego how to access params submitted with multipart/form-data header?", "body": "<p>I've ran into a problem as follows:<br>\nWhen I make a <code>curl</code> request to my <code>beego</code> app  </p>\n\n<blockquote>\n  <p>curl <a href=\"http://localhost:8080/controller/path\" rel=\"nofollow noreferrer\">http://localhost:8080/controller/path</a>  -X POST -H 'Content-Type: multipart/form-data; charset=UTF-8' -F \u201cfile=@file.csv;filename=file.csv\u201d -F \u201cname=first\u201d  </p>\n</blockquote>\n\n<p>I want to access <code>name</code> param from my controller, but when I try </p>\n\n<blockquote>\n  <p>func (c *Controller) Path() {<br>\n  ...<br>\n  var name string<br>\n  c.Ctx.Input.Bind(&amp;name, \"name\")<br>\n  // or I've tried 'name := c.GetString(\"name\")'<br>\n  ...<br>\n  }</p>\n</blockquote>\n\n<p>result  is always an empty string as <code>name</code> variable.  </p>\n\n<p>What am I doing wrong ? How can I access params in this case ?  Please any advice welcome !  </p>\n\n<p><strong>Update 1</strong><br>\nI've tried <code>Parse to struct</code>  approach, with no luck...</p>\n\n<pre><code>type   DataParams struct {\n  Name string `form:\"name\"`\n}\n\n    cLDP := DataParams{}\n    if err := c.ParseForm(&amp;cLDP); err != nil {\n        return ret, err\n    }  \n</code></pre>\n\n<p><strong><em>Update 2</em></strong><br>\nas of comment, I've tried  </p>\n\n<pre><code>c.Ctx.Input.ParseFormOrMulitForm(99999)\nvar name string\nc.Ctx.Input.Bind(&amp;name, \"name\")\n</code></pre>\n\n<p><strong><em>Update 3</em></strong><br>\nafter trying altogether I'm lost...</p>\n\n<pre><code>name := c.Ctx.Input.Query(\"name\")\nparams := c.Ctx.Input.Params()\nname2 := c.GetString(\"name\")\nc.Ctx.Input.ParseFormOrMulitForm(99999)\nparams2 := c.Ctx.Input.Params()\nfmt.Println(\"Debug 2-&gt;\", name)\nfmt.Println(\"Debug 5-&gt;\", name2)\nfmt.Println(\"Debug 3-&gt;\", params)\nfmt.Println(\"Debug 4-&gt;\", params2)\n</code></pre>\n\n<p>output is</p>\n\n<pre><code>Debug 2-&gt;\nDebug 3-&gt; map[...]\nDebug 4-&gt; map[...]\nDebug 5-&gt;\n</code></pre>\n\n<p>no name param detected      </p>\n\n<p><strong><em>Update 4</em></strong><br>\nif I use <code>c.Ctx.Input.RequestBody</code> it not surprisingly is empty </p>\n\n<p>And still no luck :(</p>\n"}, {"tags": ["go", "hyperledger", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492531870, "post_id": 43471031, "comment_id": 74009772, "body": "First off you&#39;re ignoring the errors... check the errors and make sure there isn&#39;t some other issue happening."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492532060, "post_id": 43471031, "comment_id": 74009903, "body": "Although depending on which implementation of <code>stub</code> you&#39;re using the errors may always be <code>nil</code> <a href=\"https://github.com/hyperledger-archives/fabric/blob/master/core/chaincode/shim/chaincode.go#L628\" rel=\"nofollow noreferrer\">github.com/hyperledger-archives/fabric/blob/master/core/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7883489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c78ab24a7a9fded7e84c96469cffb7?s=128&d=identicon&r=PG&f=1", "display_name": "Manoo", "link": "https://stackoverflow.com/users/7883489/manoo"}, "edited": false, "score": 0, "creation_date": 1492599983, "post_id": 43477339, "comment_id": 74042195, "body": "Hi John, I have posted my whole GO file. Kindly suggest some solution."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 0, "last_activity_date": 1492532260, "creation_date": 1492532260, "answer_id": 43477339, "question_id": 43471031, "link": "https://stackoverflow.com/questions/43471031/stub-getcallercertificate-stub-getcallermetadata-stub-getpayload-is-retu/43477339#43477339", "title": "stub.GetCallerCertificate(), stub.GetCallerMetadata(), stub.GetPayload() is returning blank", "body": "<p>If you're using <a href=\"https://github.com/hyperledger-archives/fabric/blob/master/core/chaincode/shim/chaincode.go#L628\" rel=\"nofollow noreferrer\">https://github.com/hyperledger-archives/fabric/blob/master/core/chaincode/shim/chaincode.go#L628</a> I suspect that the <code>shim.ChainCodeStubInterface</code> has not been initialized properly before being passed in to this method.</p>\n\n<p>Every implementation of <code>ChainCodeStub</code> is required to fulfill <a href=\"https://github.com/hyperledger-archives/fabric/blob/master/core/chaincode/shim/chaincode.go#L52\" rel=\"nofollow noreferrer\">this interface</a></p>\n\n<pre><code>type Chaincode interface {\n    // Init is called during Deploy transaction after the container has been\n    // established, allowing the chaincode to initialize its internal data\n    Init(stub *ChaincodeStub, function string, args []string) ([]byte, error)\n\n    // Invoke is called for every Invoke transactions. The chaincode may change\n    // its state variables\n    Invoke(stub *ChaincodeStub, function string, args []string) ([]byte, error)\n\n    // Query is called for Query transactions. The chaincode may only read\n    // (but not modify) its state variables and return the result\n    Query(stub *ChaincodeStub, function string, args []string) ([]byte, error)\n}\n</code></pre>\n\n<p>And the <code>Init</code> method is where I'd expect the stub to be initialized so that your values don't get returned as empty</p>\n"}], "owner": {"reputation": 1, "user_id": 7883489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4c78ab24a7a9fded7e84c96469cffb7?s=128&d=identicon&r=PG&f=1", "display_name": "Manoo", "link": "https://stackoverflow.com/users/7883489/manoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1492599932, "creation_date": 1492515265, "last_edit_date": 1492599932, "question_id": 43471031, "link": "https://stackoverflow.com/questions/43471031/stub-getcallercertificate-stub-getcallermetadata-stub-getpayload-is-retu", "title": "stub.GetCallerCertificate(), stub.GetCallerMetadata(), stub.GetPayload() is returning blank", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    pb \"github.com/hyperledger/fabric/protos/peer\"\n)\n\nvar matchLogger = shim.NewLogger(\"Helper\")\n\ntype PlaceHolder struct {\n    ValA  string `json:\"ValA\"`\n    ValB  string `json:\"ValB\"`\n    Match bool   `json:\"Match\"`\n}\n\ntype Agreement struct {\n    TradeNumber         PlaceHolder `json:\"TradeNumber\"`\n    BuyerName           PlaceHolder `json:\"BuyerName\"`\n    SellerName          PlaceHolder `json:\"SellerName\"`\n    BuyerID             PlaceHolder `json:\"BuyerID\"`\n    SellerID            PlaceHolder `json:\"SellerID\"`\n}\n\ntype ContractContaineer struct {\n    FirmID       string   `json:\"FirmID\"`\n    ContractList []string `json:\"contractList\"`\n}\n\n\nfunc (t *Agreement) Init(stub shim.ChaincodeStubInterface) pb.Response {\n\n    xx, err1 := stub.GetCallerCertificate()\n    if err1 != nil {\n        matchLogger.Info(err1)  \n    }\n    matchLogger.Info(\"Cert ----\")\n    matchLogger.Info(string(xx))\n    matchLogger.Info(\"----\")\n\n    xy, err3 := stub.GetCallerMetadata()\n    if err3 != nil {\n        matchLogger.Info(err3)  \n    }\n    matchLogger.Info(\"Meta ----\")\n    matchLogger.Info(string(xy))\n    matchLogger.Info(\"----\")\n\n    yy, err4 := stub.GetPayload()\n    if err4 != nil {\n        matchLogger.Info(err4)  \n    }\n    matchLogger.Info(\"PLD ----\")\n    matchLogger.Info(string(yy))\n    matchLogger.Info(\"----\")\n\n\n    return shim.Success(nil)\n}\n\n\nfunc (t *Agreement) Query(stub shim.ChaincodeStubInterface) pb.Response {\n        return shim.Success(nil)\n}\n\n\n// Transaction makes payment of X units from A to B\nfunc (t *Agreement) Invoke(stub shim.ChaincodeStubInterface) pb.Response {\n\n    xx, err1 := stub.GetCallerCertificate()\n    if err1 != nil {\n        matchLogger.Info(err1)  \n    }\n    matchLogger.Info(\"Cert ----\")\n    matchLogger.Info(string(xx))\n    matchLogger.Info(\"----\")\n\n    xy, err3 := stub.GetCallerMetadata()\n    if err3 != nil {\n        matchLogger.Info(err3)  \n    }\n    matchLogger.Info(\"Meta ----\")\n    matchLogger.Info(string(xy))\n    matchLogger.Info(\"----\")\n\n    yy, err4 := stub.GetPayload()\n    if err4 != nil {\n        matchLogger.Info(err4)  \n    }\n    matchLogger.Info(\"PLD ----\")\n    matchLogger.Info(string(yy))\n    matchLogger.Info(\"----\")\n\n    return shim.Success(nil)\n}\n\n\nfunc main() {\n\n    lld, _ := shim.LogLevel(\"INFO\")\n    matchLogger.Info(lld)\n    matchLogger.SetLevel(lld)\n    matchLogger.Info(matchLogger.IsEnabledFor(lld))\n    err := shim.Start(new(Agreement))\n    if err != nil {\n        fmt.Printf(\"Error starting Simple chaincode: %s\", err)\n    }\n}\n</code></pre>\n\n<p>This is my complete GO file. Kindly suggest what i did wrong. The logger output is coming as blank for xx, xy, yy. errors are nil too. I have implemented all 3 methods i.e. init, invoke and query. Code is getting compiled just fine</p>\n"}, {"tags": ["string", "go", "type-conversion", "slice"], "comments": [{"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 0, "creation_date": 1492513925, "post_id": 43470284, "comment_id": 73995863, "body": "<a href=\"http://stackoverflow.com/questions/14373634/how-expensive-is-bytestring\" title=\"how expensive is bytestring\">stackoverflow.com/questions/14373634/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 0, "creation_date": 1492513366, "post_id": 43470344, "comment_id": 73995524, "body": "Thanks for the quick reply.  I forgot the fact that a byte slice is mutable, so a copy is needed.  Thanks"}, {"owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "edited": false, "score": 1, "creation_date": 1492513957, "post_id": 43470344, "comment_id": 73995889, "body": "FYI, there is a feature request for immutable byte array <a href=\"https://github.com/golang/go/issues/2205\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/2205</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 18, "last_activity_date": 1492514312, "last_edit_date": 1492514312, "creation_date": 1492513227, "answer_id": 43470344, "question_id": 43470284, "link": "https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470344#43470344", "title": "golang: []byte(string) vs []byte(*string)", "body": "<p><code>[]byte(\"something\")</code> is not a function (or method) call, it's a type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"noreferrer\">conversion</a>.</p>\n\n<p>The type conversion \"itself\" does not copy the value. Converting a <code>string</code> to a <code>[]byte</code> however does, and it needs to, because the result byte slice is <em>mutable</em>, and if a copy would not be made, you could modify / alter the <code>string</code> value (the content of the <code>string</code>) which is <em>immutable</em>, it must be as the <a href=\"https://golang.org/ref/spec#String_types\" rel=\"noreferrer\">Spec: String types</a> section dictates:</p>\n\n<blockquote>\n  <p>Strings are immutable: once created, it is impossible to change the contents of a string.</p>\n</blockquote>\n\n<p>Note that there are few cases when <code>string</code> &lt;=> <code>[]byte</code> conversion does not make a copy as it is optimized \"away\" by the compiler. These are rare and \"hard coded\" cases when there is proof an immutable <code>string</code> cannot / will not end up modified.</p>\n\n<p>Such an example is looking up a value from a map where the key type is <code>string</code>, and you index the map with a <code>[]byte</code>, converted to <code>string</code> of course (<a href=\"https://github.com/golang/go/issues/3512\" rel=\"noreferrer\">source</a>):</p>\n\n<pre><code>key := []byte(\"some key\")\n\nvar m map[string]T\n// ...\nv, ok := m[string(key)]  // Copying key here is optimized away\n</code></pre>\n\n<p>Another optimization is when ranging over the bytes of a <code>string</code> that is explicitly converted to a byte slice:</p>\n\n<pre><code>s := \"something\"\nfor i, v := range []byte(s) { // Copying s is optimized away\n    // ...\n}\n</code></pre>\n\n<p>(Note that without the conversion the <code>for range</code> would iterate over the <code>rune</code>s of the string and not over its UTF8-encoded bytes.)</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1492513437, "creation_date": 1492513437, "answer_id": 43470417, "question_id": 43470284, "link": "https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470417#43470417", "title": "golang: []byte(string) vs []byte(*string)", "body": "<blockquote>\n  <p>I'm curious as why Golang doesn't provide a []byte(*string) method.</p>\n</blockquote>\n\n<p>Because it doesn't make sense.</p>\n\n<p>A pointer (to any type) cannot be represented (in any obviously meaningful way) as a <code>[]byte</code>.</p>\n\n<blockquote>\n  <p>From a performance perspective, wouldn't []byte(string) make a copy of the input argument and add more cost (though this seems odd since strings are immutable, why copy them)?</p>\n</blockquote>\n\n<p>Converting from <code>[]byte</code> to <code>string</code> (and vice versa) does involve a copy, because strings are immutable, but byte arrays are not.</p>\n\n<p>However, using a pointer wouldn't solve that problem.</p>\n"}], "owner": {"reputation": 3127, "user_id": 842860, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/oOCwG.png?s=128&g=1", "display_name": "stackoverflower", "link": "https://stackoverflow.com/users/842860/stackoverflower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2567, "favorite_count": 2, "accepted_answer_id": 43470344, "answer_count": 2, "score": 3, "last_activity_date": 1492514527, "creation_date": 1492513069, "last_edit_date": 1492514527, "question_id": 43470284, "link": "https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring", "title": "golang: []byte(string) vs []byte(*string)", "body": "<p>I'm curious as why Golang doesn't provide a <code>[]byte(*string)</code> method. From a performance perspective, wouldn't <code>[]byte(string)</code> make a copy of the input argument and add more cost (though this seems odd since strings are immutable, why copy them)?</p>\n\n<p>I'm new to Go and would appreciate any clarification.</p>\n"}, {"tags": ["go", "rabbitmq", "message-queue"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492549392, "post_id": 43472447, "comment_id": 74020287, "body": "Because if Rabbit waited to ack a pub until the message was consumed and acked, it would defeat the entire purpose of a message queue altogether."}], "tags": [], "owner": {"reputation": 1169, "user_id": 5551200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I9tHK.jpg?s=128&g=1", "display_name": "Vanlightly", "link": "https://stackoverflow.com/users/5551200/vanlightly"}, "is_accepted": true, "score": 2, "last_activity_date": 1492519219, "creation_date": 1492519219, "answer_id": 43472447, "question_id": 43470113, "link": "https://stackoverflow.com/questions/43470113/no-consumers-yet-when-i-publish-something-an-ack-is-immediately-returned-why/43472447#43472447", "title": "No consumers, yet when I publish something an ack is immediately returned why? (golang/rabbitmq)", "body": "<p>You are confusing publisher confirm acks and nacks with consumer side acks and nacks.</p>\n\n<p>The documentation states:</p>\n\n<blockquote>\n  <p>For unroutable messages, the broker will issue a confirm once the\n  exchange verifies a message won't route to any queue (returns an empty\n  list of queues). If the message is also published as mandatory, the\n  basic.return is sent to the client before basic.ack. The same is true\n  for negative acknowledgements (basic.nack). </p>\n  \n  <p>For routable messages, the basic.ack is sent when a message has been\n  accepted by all the queues. For persistent messages routed to durable\n  queues, this means persisting to disk. For mirrored queues, this means\n  that all mirrors have accepted the message.</p>\n</blockquote>\n\n<p>So you are seeing the correct behaviour. RabbitMQ is confirming that the messages arrived at the queue.</p>\n"}], "owner": {"reputation": 424, "user_id": 6737107, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5e3cd4f938bd4d184a70771ca352172f?s=128&d=identicon&r=PG&f=1", "display_name": "DiderDrogba344", "link": "https://stackoverflow.com/users/6737107/diderdrogba344"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 43472447, "answer_count": 1, "score": 1, "last_activity_date": 1492519219, "creation_date": 1492512567, "question_id": 43470113, "link": "https://stackoverflow.com/questions/43470113/no-consumers-yet-when-i-publish-something-an-ack-is-immediately-returned-why", "title": "No consumers, yet when I publish something an ack is immediately returned why? (golang/rabbitmq)", "body": "<p>Below is the publisher code that I use. It requires acks before the message is taken off the queue. It's suppose to print out that it receives an Ack or nack (at the bottom of the code) from a consumer. If you just run the publisher code below by itself (without running a consumer code at same time), it suppose to just hang, waiting for ack or nack but it doesn't, it prints out an ack as if a consumer had sent it. So I'm confused if I have any part of the code wrong.</p>\n\n<p>For the base code I used code from rabbitmq's official tutorial: <a href=\"https://www.rabbitmq.com/tutorials/tutorial-one-go.html\" rel=\"nofollow noreferrer\">https://www.rabbitmq.com/tutorials/tutorial-one-go.html</a></p>\n\n<p>For ack/nack part of the code I followed this: <a href=\"https://agocs.org/blog/2014/08/19/rabbitmq-best-practices-in-go/\" rel=\"nofollow noreferrer\">https://agocs.org/blog/2014/08/19/rabbitmq-best-practices-in-go/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/streadway/amqp\"\n)\n\nfunc failOnError(err error, msg string) {\n    if err != nil {\n        log.Fatalf(\"%s: %s\", msg, err)\n    }\n}\n\nfunc main() {\n\n    conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\")\n    failOnError(err, \"Failed to connect to RabbitMQ\")\n    defer conn.Close()\n\n    ch, err := conn.Channel()\n    failOnError(err, \"Failed to open a channel\")\n    defer ch.Close()\n\n     ch.Confirm(false)\n\n    ack, nack := ch.NotifyConfirm(make(chan uint64, 1), make(chan uint64, 1))\n\n    q, err := ch.QueueDeclare(\n        \"hello\", // name\n        false,   // durable\n        false,   // delete when unused\n        false,   // exclusive\n        false,   // no-wait\n        nil,     // arguments\n    )\n    failOnError(err, \"Failed to declare a queue\")\n\n    body := \"hello\"\n    err = ch.Publish(\n        \"\",     // exchange\n        q.Name, // routing key\n        true,  // mandatory\n        false,  // immediate\n        amqp.Publishing{\n            ContentType: \"text/plain\",\n            Body:        []byte(body),\n        })\n    log.Printf(\" [x] Sent %s\", body)\n    failOnError(err, \"Failed to publish a message\")\n\n    select {\n      case tag := &lt;-ack:\n          log.Println(\"Acked \", tag)\n      case tag := &lt;-nack:\n          log.Println(\"Nack alert! \", tag)\n    }\n}\n</code></pre>\n"}, {"tags": ["multithreading", "unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1492649818, "post_id": 43468590, "comment_id": 74071340, "body": "Your goroutine is never called, that&#39;s a compiler error for go 1.7."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1498395605, "last_edit_date": 1498395605, "creation_date": 1492508203, "answer_id": 43468590, "question_id": 43468476, "link": "https://stackoverflow.com/questions/43468476/how-to-test-a-function-that-watches-a-file-in-a-goroutine/43468590#43468590", "title": "How to test a function that watches a file in a goroutine", "body": "<blockquote>\n  <p>Is there any way how I can test a function like this, like \u2026 starting a different thread (?) that updates/modifies the file?</p>\n</blockquote>\n\n<p>Of course... start a goroutine that does the updates you want.</p>\n\n<pre><code>func TestStuff(t *testing.T) {\n    tmpfile, err := ioutil.TempFile(\"\", \"test\")\n\n    if err != nil {\n        t.Fatal(\"Failed to create tmp file\")\n    }\n\n    defer os.Remove(tmpfile.Name())\n\n    watcherFunc := func (err error) bool {\n        return false\n    }\n    go func() {\n        // Do updates here\n    }()\n\n    WatchFileChanges(tmpfile.Name(), watcherFunc)\n}\n</code></pre>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 43468590, "answer_count": 1, "score": 0, "last_activity_date": 1498395605, "creation_date": 1492507879, "question_id": 43468476, "link": "https://stackoverflow.com/questions/43468476/how-to-test-a-function-that-watches-a-file-in-a-goroutine", "title": "How to test a function that watches a file in a goroutine", "body": "<p>I have a function that watches certian file via fsnotify and calls a callback when the file changes. If the callback returns false, the watching is ended:</p>\n\n<pre><code>import (\n    \"github.com/golang/glog\"\n    \"github.com/fsnotify/fsnotify\"\n)\n\ntype WatcherFunc func(err error) bool\n\nfunc WatchFileChanges(filename string, watcherFunc WatcherFunc) {\n    watcher, err := fsnotify.NewWatcher()\n\n    if err != nil {\n        glog.Errorf(\"Got error creating watcher %s\", err)\n    }\n\n    defer watcher.Close()\n\n    done := make(chan bool)\n\n    go func() {\n        for {\n            select {\n            case event := &lt;-watcher.Events:\n                glog.Infof(\"inotify event %s\", event)\n\n                if event.Op&amp;fsnotify.Write == fsnotify.Write {\n                    glog.Infof(\"modified file %s, calling watcher func\", event.Name)\n\n                    if !watcherFunc(nil) {\n                        close(done)\n                    }\n                }\n\n            case err := &lt;-watcher.Errors:\n                glog.Errorf(\"Got error watching %s, calling watcher func\", err)\n\n                if !watcherFunc(err) {\n                    close(done)\n                }\n            }\n        }\n    }()\n\n    glog.Infof(\"Start watching file %s\", filename)\n\n    err = watcher.Add(filename)\n\n    if err != nil {\n        glog.Errorf(\"Got error adding watcher %s\", err)\n    }\n    &lt;-done\n}\n</code></pre>\n\n<p>Then I thought it would be nice to have a test for that, so I started out with a simple test case:</p>\n\n<pre><code>import (\n    \"io/ioutil\"\n    \"os\"\n    \"testing\"\n)\n\nfunc TestStuff(t *testing.T) {\n    tmpfile, err := ioutil.TempFile(\"\", \"test\")\n\n    if err != nil {\n        t.Fatal(\"Failed to create tmp file\")\n    }\n\n    defer os.Remove(tmpfile.Name())\n\n    watcherFunc := func (err error) bool {\n        return false\n    }\n\n    WatchFileChanges(tmpfile.Name(), watcherFunc)\n}\n</code></pre>\n\n<p>What I wanted do to here is to do a few modifications to the file, collect the events in an array, return then <code>false</code> from the <code>watcherFunc</code> and then assert on the array. The thing is, of course the test just hangs and waits for events, as the goroutine was started. </p>\n\n<p>Is there any way how I can test a function like this, like \u2026 starting a different thread (?) that updates/modifies the file? </p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-pubsub"], "answers": [{"tags": [], "owner": {"reputation": 2448, "user_id": 384117, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/201dd82065037d9637b0217e26ded14b?s=128&d=identicon&r=PG", "display_name": "Hippocrates", "link": "https://stackoverflow.com/users/384117/hippocrates"}, "is_accepted": false, "score": 0, "last_activity_date": 1575924480, "creation_date": 1575924480, "answer_id": 59256358, "question_id": 43468249, "link": "https://stackoverflow.com/questions/43468249/cloud-pub-sub-pull-subscriber-with-gae-go-standard/59256358#59256358", "title": "Cloud Pub/Sub: Pull subscriber with GAE/Go Standard", "body": "<p>No, You can't do that. The proper way to use PubSub with GAE Standard is to create a push subscription which delivers each message to an App Engine endpoint you have defined.</p>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1575924480, "creation_date": 1492507165, "question_id": 43468249, "link": "https://stackoverflow.com/questions/43468249/cloud-pub-sub-pull-subscriber-with-gae-go-standard", "title": "Cloud Pub/Sub: Pull subscriber with GAE/Go Standard", "body": "<p>Can I create Cloud Pub/Sub pull subscriber with GAE/Go Standard Environment?</p>\n\n<p>I read <a href=\"https://cloud.google.com/go/getting-started/using-pub-sub\" rel=\"nofollow noreferrer\">this page</a>, but this is GAE Flexible environment.\nI would like to create pull subscriber with GAE/Go Standard.</p>\n\n<p>Can I do it?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 4, "last_activity_date": 1492503926, "last_edit_date": 1592644375, "creation_date": 1492503315, "answer_id": 43467022, "question_id": 43466757, "link": "https://stackoverflow.com/questions/43466757/use-of-gos-struct-pointer-as-interface/43467022#43467022", "title": "Use of go&#39;s struct pointer as interface", "body": "<p>That's because it does not fit the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability</a> criterias</p>\n<blockquote>\n<p>A value <code>x</code> is assignable to a variable of type <code>T</code> (&quot;<code>x</code> is assignable to <code>T</code>&quot;) in any of these cases:</p>\n<ul>\n<li><code>x</code>'s type is identical to <code>T</code>.</li>\n<li><code>x</code>'s type <code>V</code> and <code>T</code> have identical underlying types and at least one of <code>V</code> or <code>T</code> is not a named type.</li>\n<li><code>T</code> is an interface type and <code>x</code> implements <code>T</code>.</li>\n<li><code>x</code> is a bidirectional channel value, <code>T</code> is a channel type, <code>x</code>'s type <code>V</code> and <code>T</code> have identical element types, and at least one of <code>V</code> or <code>T</code> is not a named type.</li>\n<li><code>x</code> is the predeclared identifier <code>nil</code> and <code>T</code> is a pointer, function, slice, map, channel, or interface type.</li>\n<li><code>x</code> is an untyped constant representable by a value of type <code>T</code>.</li>\n</ul>\n</blockquote>\n<p>So, this explains why <code>testInterface(instance.fails)</code> fails: because the <code>instance.fails</code> is not assignable to the <code>f func() interface{}</code>.</p>\n<p>Now the second question:</p>\n<blockquote>\n<p>It perfectly works if I try to return *struct from function that is declared to return interface{} (wrapper func).</p>\n</blockquote>\n<p>It works fine, because the value of the <code>*struct</code> type is assignable to the <code>interface{}</code> type because of:</p>\n<ol>\n<li>this rule of the assignability: &quot;<code>T</code> is an interface type and <code>x</code> implements <code>T</code>.&quot;</li>\n<li>&quot;A type implements any interface comprising any subset of its methods and may therefore implement several distinct interfaces. For instance, <strong>all types implement the empty interface</strong>:&quot; (bold is mine)</li>\n</ol>\n<p>References:</p>\n<ul>\n<li><a href=\"https://golang.org/ref/spec#Type_identity\" rel=\"nofollow noreferrer\">Type identity</a></li>\n<li><a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Assignability</a></li>\n<li><a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">Interface types</a></li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 7882759, "user_type": "registered", "profile_image": "https://graph.facebook.com/10202941027004643/picture?type=large", "display_name": "\u0410\u0440\u0442\u0443\u0440 \u0413\u0430\u0432\u043a\u0430\u043b\u044e\u043a", "link": "https://stackoverflow.com/users/7882759/%d0%90%d1%80%d1%82%d1%83%d1%80-%d0%93%d0%b0%d0%b2%d0%ba%d0%b0%d0%bb%d1%8e%d0%ba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 43467022, "answer_count": 1, "score": 1, "last_activity_date": 1492503926, "creation_date": 1492502426, "last_edit_date": 1492502728, "question_id": 43466757, "link": "https://stackoverflow.com/questions/43466757/use-of-gos-struct-pointer-as-interface", "title": "Use of go&#39;s struct pointer as interface", "body": "<p>I want to pass struct method as function value. Why does compilation fail if function is required to return interface{} and it returns *struct? It perfectly works if I try to return *struct from function that is declared to return interface{} (wrapper func).</p>\n\n<pre><code>package main\n\nfunc main() {\n        println(\"hello\")\n        testInterface(wrapper)          // works\n        instance := MyStruct{}\n        testInterface(instance.works)   // works\n        testInterface(instance.fails)   // fails: ./main.go:8: cannot use instance.fails (type func(int) *MyStruct) as type func(int) interface {} in argument to testInterface\n}\n\nfunc testInterface(f func() interface{}) {\n        f()\n        return\n}\n\ntype MyStruct struct {\n}\n\nfunc (s *MyStruct) works() interface{} {\n        return s\n}\n\nfunc (s *MyStruct) fails() *MyStruct {\n        return s\n}\n\nfunc wrapper() interface{} {\n        s := MyStruct{}\n        return s.fails()\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go", "console", "webbrowser-control"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7545303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/283f28349591c1e1804f25551658c2bb?s=128&d=identicon&r=PG&f=1", "display_name": "gophervk", "link": "https://stackoverflow.com/users/7545303/gophervk"}, "edited": false, "score": 0, "creation_date": 1492496732, "post_id": 43465027, "comment_id": 73985419, "body": "ohhhhhhhhh..thank you"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1492496661, "creation_date": 1492496661, "answer_id": 43465027, "question_id": 43464994, "link": "https://stackoverflow.com/questions/43464994/how-to-print-into-browser-console-using-golang/43465027#43465027", "title": "How to print into browser console using golang", "body": "<p>No.</p>\n\n<p>Go doesn't run in your browser (unless you're using <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">GopherJS</a> or similar), so there's no way for <em>Go</em> to write to your browser's console.  You must do that from JavaScript.</p>\n"}], "owner": {"reputation": 67, "user_id": 7545303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/283f28349591c1e1804f25551658c2bb?s=128&d=identicon&r=PG&f=1", "display_name": "gophervk", "link": "https://stackoverflow.com/users/7545303/gophervk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 906, "favorite_count": 0, "closed_date": 1492654433, "answer_count": 1, "score": -4, "last_activity_date": 1492496786, "creation_date": 1492496526, "last_edit_date": 1492496786, "question_id": 43464994, "link": "https://stackoverflow.com/questions/43464994/how-to-print-into-browser-console-using-golang", "closed_reason": "Duplicate", "title": "How to print into browser console using golang", "body": "<p>i am using golang to develop my small web app and i just wanted to know are there are any ways in golang from which i can print anything into browser console.</p>\n\n<p>I am using Go version go1.7.4 linux/amd64.</p>\n\n<p>Here i just want to print some values for example redirect url's into web browser's console\n<a href=\"https://i.stack.imgur.com/0BMvO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0BMvO.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["encryption", "go", "cryptography", "aes", "rsa"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492488457, "post_id": 43463221, "comment_id": 73982412, "body": "Which line generates that error?"}, {"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 2, "creation_date": 1492488500, "post_id": 43463221, "comment_id": 73982424, "body": "What is definition of <code>encrypt()</code> function? Show us <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 9427, "user_id": 706119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445ccf3d91c8f3b19b0ba4d8ba1e702?s=128&d=identicon&r=PG", "display_name": "DarkSquirrel42", "link": "https://stackoverflow.com/users/706119/darksquirrel42"}, "edited": false, "score": 0, "creation_date": 1492506072, "post_id": 43463221, "comment_id": 73990760, "body": "you expect an aes cipher to work with a rsa key?"}, {"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "reply_to_user": {"reputation": 9427, "user_id": 706119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445ccf3d91c8f3b19b0ba4d8ba1e702?s=128&d=identicon&r=PG", "display_name": "DarkSquirrel42", "link": "https://stackoverflow.com/users/706119/darksquirrel42"}, "edited": false, "score": 0, "creation_date": 1492516206, "post_id": 43463221, "comment_id": 73997446, "body": "@DarkSquirrel42  yes exactly i want to use rsa key in aes ciper. what mistake i am doing ??"}, {"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 0, "creation_date": 1492516405, "post_id": 43463221, "comment_id": 73997591, "body": "@Fimzy encrypt(text, []byte(privateKeyPem)) this generates an error."}, {"owner": {"reputation": 9427, "user_id": 706119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445ccf3d91c8f3b19b0ba4d8ba1e702?s=128&d=identicon&r=PG", "display_name": "DarkSquirrel42", "link": "https://stackoverflow.com/users/706119/darksquirrel42"}, "edited": false, "score": 0, "creation_date": 1492516500, "post_id": 43463221, "comment_id": 73997660, "body": "your cipher expects you to provide a specific size byte array holding the key ... for AES-128 that is 128 bit ... for AES-256 that is 256 bit ... etc ... but you don&#39;t have such a byte array holding a key ... you have a string holding a pem encoded x509 structure...what you want to google is &quot;hybrid cryptography&quot;"}, {"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "reply_to_user": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 0, "creation_date": 1492517447, "post_id": 43463221, "comment_id": 73998362, "body": "@ymonad Definition of encrypt() funtion has added."}, {"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "reply_to_user": {"reputation": 9427, "user_id": 706119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f445ccf3d91c8f3b19b0ba4d8ba1e702?s=128&d=identicon&r=PG", "display_name": "DarkSquirrel42", "link": "https://stackoverflow.com/users/706119/darksquirrel42"}, "edited": false, "score": 0, "creation_date": 1492518453, "post_id": 43463221, "comment_id": 73999085, "body": "@DarkSquirrel42 Thanks, I have searched &quot;hybrid cryptography&quot; , Hope this would solve my problem."}], "answers": [{"tags": [], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "is_accepted": true, "score": 0, "last_activity_date": 1492518857, "creation_date": 1492518857, "answer_id": 43472300, "question_id": 43463221, "link": "https://stackoverflow.com/questions/43463221/how-to-use-rsa-key-pair-for-aes-encryption-and-decryprion-in-golang/43472300#43472300", "title": "How to use rsa key pair for AES encryption and decryprion in golang", "body": "<p>As suggested in comments, i searched \"hybrid cryptography\" . And this <a href=\"https://play.golang.org/p/77fRvrDa4A\" rel=\"nofollow noreferrer\">example</a> has solved my problem.</p>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2278, "favorite_count": 0, "accepted_answer_id": 43472300, "answer_count": 1, "score": -2, "last_activity_date": 1492518857, "creation_date": 1492487111, "last_edit_date": 1492516643, "question_id": 43463221, "link": "https://stackoverflow.com/questions/43463221/how-to-use-rsa-key-pair-for-aes-encryption-and-decryprion-in-golang", "title": "How to use rsa key pair for AES encryption and decryprion in golang", "body": "<p>I want to generate rsa key pair(public and private), and then use them for AES encryption and  decryption.e.g. Public key for Encryption and private key for Decryption.I wrote a simple code for this, but the problem is that when i run this code i get this error:</p>\n\n<pre><code>crypto/aes: invalid key size 1639\n</code></pre>\n\n<p>How can i resove this problem ?? My Encryption code is given bellow:</p>\n\n<pre><code>//genrarting private key\nprivateKey, err := rsa.GenerateKey(rand.Reader, 2014)\nif err != nil {\n    return\n}\nprivateKeyDer := x509.MarshalPKCS1PrivateKey(privateKey)\nprivateKeyBlock := pem.Block{\n    Type:    \"RSA PRIVATE KEY\",\n    Headers: nil,\n    Bytes:   privateKeyDer,\n}\nprivateKeyPem := string(pem.EncodeToMemory(&amp;privateKeyBlock))\n\n\n//using privateKeyPem for encryption\ntext := []byte(\"My name is Astaxie\")\nciphertext, err := encrypt(text, []byte(privateKeyPem))\nif err != nil {\n    // TODO: Properly handle error\n    log.Fatal(err)\n}\nfmt.Printf(\"%s =&gt; %x\\n\", text, ciphertext)\n\n//Definition of encrypt()\nfunc encrypt(plaintext []byte, key []byte) ([]byte, error) {\nc, err := aes.NewCipher(key)\nif err != nil {\n    return nil, err\n}\n\ngcm, err := cipher.NewGCM(c)\nif err != nil {\n    return nil, err\n}\n\nnonce := make([]byte, gcm.NonceSize())\nif _, err = io.ReadFull(rand.Reader, nonce); err != nil {\n    return nil, err\n}\n\nreturn gcm.Seal(nonce, nonce, plaintext, nil), nil\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"comments": [{"owner": {"reputation": 3793, "user_id": 873601, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/16dd69c7d8b13156595bc01387e55224?s=128&d=identicon&r=PG", "display_name": "Vishal Biyani", "link": "https://stackoverflow.com/users/873601/vishal-biyani"}, "edited": false, "score": 0, "creation_date": 1516273007, "post_id": 43474444, "comment_id": 83624539, "body": "I am using client-go to fetch a resource and need to use the &quot;Kind&quot; for some switch decision, but Kind is empty in the retrieved object. What is the best way to solve this?"}], "tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1492524221, "creation_date": 1492524221, "answer_id": 43474444, "question_id": 43462908, "link": "https://stackoverflow.com/questions/43462908/unable-to-declare-kind-type-for-kubernetes-api-type-declarations/43474444#43474444", "title": "Unable to declare Kind type for Kubernetes API Type Declarations", "body": "<p>When using an embedded struct, the key is usually the type name without the package. You can declare your <code>TypeMeta</code> like this:</p>\n\n<pre><code>test := v1beta1.Deployment{\n  TypeMeta: metav1.TypeMeta{\n    APIVersion: \"apps/v1beta1\",\n    Kind: \"Deployment\",\n  },\n}\n</code></pre>\n\n<p>However, manually setting the <code>TypeMeta</code> on any Kubernetes API object is usually only necessary if you plan to persist these objects yourself (for example, to generate YAML files).</p>\n\n<p>When using the Kubernetes client API (for example, using the k8s.io/client-go package) to talk to an API server, you will not need the <code>TypeMeta</code> property, since all API operations are strongly typed anyway and all metadata can safely be inferred. After all, the API version and kind of a <code>v1beta1.Deployment</code> struct should be (and are, to the client library) obvious.</p>\n"}], "owner": {"reputation": 3440, "user_id": 188357, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/8028415da438e16747ab38eb45029ccd?s=128&d=identicon&r=PG", "display_name": "David C", "link": "https://stackoverflow.com/users/188357/david-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492524221, "creation_date": 1492484753, "question_id": 43462908, "link": "https://stackoverflow.com/questions/43462908/unable-to-declare-kind-type-for-kubernetes-api-type-declarations", "title": "Unable to declare Kind type for Kubernetes API Type Declarations", "body": "<p>I'm relatively new to golang and need some help pointing to the right direction.</p>\n\n<p>I'm trying to declare a new <code>Deployment</code> type.</p>\n\n<p>My imports look like:</p>\n\n<pre><code>import (\n  \"encoding/json\"\n  \"fmt\"\n  yaml \"gopkg.in/yaml.v2\"\n  \"io/ioutil\"\n  metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n  \"k8s.io/kubernetes/pkg/api/v1\"\n  \"k8s.io/kubernetes/pkg/apis/extensions/v1beta1\"\n)\n</code></pre>\n\n<p>When I try to create a Deployment Object like:</p>\n\n<pre><code>  test := v1beta1.Deployment{\n    Spec: v1beta1.DeploymentSpec{\n      Template: v1.PodTemplateSpec{\n        Spec: v1.PodSpec{\n          Containers: []v1.Container{{\n            Name:  \"test\",\n            Image: \"image_url\",\n          },\n          },\n        },\n      },\n    },\n  }\n</code></pre>\n\n<p>It works, but the Deployment Object that returns doesn't have a <code>Kind</code> which is necessary to identify the object.</p>\n\n<p>According to <a href=\"https://github.com/kubernetes/kubernetes/blob/master/pkg/apis/extensions/types.go#L162\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/blob/master/pkg/apis/extensions/types.go#L162</a></p>\n\n<p>There's an embedded <code>metav1.TypeMeta</code> which has the <code>Kind</code> object that I need. (For reference: <a href=\"https://github.com/kubernetes/apimachinery/blob/master/pkg/apis/meta/v1/types.go#L38\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/apimachinery/blob/master/pkg/apis/meta/v1/types.go#L38</a>)</p>\n\n<p>I tried declaring <code>metav1.TypeMeta</code> in the struct literal like:</p>\n\n<pre><code>  test := v1beta1.Deployment{\n    metav1.TypeMeta: metav1.TypeMeta{Kind: \"Deployment\"}\n    Spec: v1beta1.DeploymentSpec{\n      Template: v1.PodTemplateSpec{\n        Spec: v1.PodSpec{\n          Containers: []v1.Container{{\n            Name:  \"test\",\n            Image: \"image_url\",\n          },\n          },\n        },\n      },\n    },\n  } \n</code></pre>\n\n<p>But I get a </p>\n\n<p><code>unknown field '\"k8s.io/apimachinery/pkg/apis/meta/v1\".TypeMeta' in struct literal of type v1beta1.Deployment</code></p>\n\n<p>I suspect it is due to <code>metav1.TypeMeta</code> declaration in the <code>Deployment</code> struct is an unexported field.</p>\n\n<p>How should I declare Kind?</p>\n"}, {"tags": ["gcc", "go", "gccgo"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1492482613, "post_id": 43462056, "comment_id": 73980952, "body": "<code>go env</code> and tells us what your setup is.  Also may want to run <code>which go</code> and <code>which gccgo</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492520217, "post_id": 43462056, "comment_id": 74000465, "body": "<code>gccgo</code> is just the compiler, it&#39;s not a replacement for the <code>go</code> tool. If you want to see how the compiler is invoked, use the <code>-x</code> flag: <code>go build -x -compiler gccgo logging.go</code>"}, {"owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492621554, "post_id": 43462056, "comment_id": 74058248, "body": "@JimB You are right. My original attempt was to build a program, to which a Makefile (and inside, a &#39;go build&#39; command) was already given. The build fails and I used the &#39;-x&#39; flag to narrow down to a &#39;gccgo&#39; command where it could not import. The example above was just manually running that command standalone."}, {"owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "edited": false, "score": 0, "creation_date": 1492623657, "post_id": 43462056, "comment_id": 74059539, "body": "Updated the question with some clarifications and recent development."}], "owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492623538, "creation_date": 1492478553, "last_edit_date": 1492623538, "question_id": 43462056, "link": "https://stackoverflow.com/questions/43462056/go-import-package-pkg-found-with-go-compiler-gccgo-not-found-with-gccgo", "title": "Go import package: pkg found with go (-compiler gccgo), not found with gccgo", "body": "<p>Go/gccgo version: 6.3.0</p>\n\n<p>I am building a program with <code>go build -compiler gccgo -x &lt;args&gt; &lt;args&gt; program.go</code>. Build process fails with </p>\n\n<pre><code>% /usr/bin/gccgo -c -g -fgo-pkgpath=&lt;file_path&gt;/common/flogging -fgo-relative-import-path=&lt;file_path&gt;/common/flogging -o &lt;dest_path&gt;/common/flogging/)obj/_go_.o ./logging.go (some program specific args omitted)\n% &lt;file_path&gt;/common/flogging\ncommon/flogging/logging.go:26:26: error: import file 'github.com/op/go-\nlogging' not found\n  \"github.com/op/go-logging\"\n                          ^\n</code></pre>\n\n<p><code>logging.go</code> imports</p>\n\n<pre><code>import (\n    \"io\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n    \"sync\"\n\n    \"github.com/op/go-logging\"\n)\n</code></pre>\n\n<p>If I compile <code>logging.go</code> standalone with <code>go build</code>, it compiles fine:</p>\n\n<pre><code>[root@eef079aa0103 flogging]# go build logging.go \n[root@eef079aa0103 flogging]# go build -compiler gccgo logging.go \n</code></pre>\n\n<p>If I run the <code>/usr/bin/gccgo</code> command standalone, the error persists. </p>\n\n<pre><code>[root@eef079aa0103 flogging]# /usr/bin/gccgo &lt;args&gt; logging.go (args same with above) \nlogging.go:26:26: error: import file 'github.com/op/go-logging' not found\n  \"github.com/op/go-logging\"  \n                          ^\n</code></pre>\n\n<p>I used <code>strace</code> to track</p>\n\n<p><code>% strace -f -o aa /usr/bin/gccgo &lt;args&gt; logging.go (args same with above)</code></p>\n\n<p>and found out that\n<code>\nopen(\"/opt/gopath/src/github.com/op/go-logging\", O_RDONLY) = 10\nopen(\"/opt/gopath/src/github.com/op/go-logging.gox\", O_RDONLY) = -1 ENOENT (No such file or directory)\nopen(\"/opt/gopath/src/github.com/op/libgo-logging.so\", O_RDONLY) = -1 ENOENT (No such file or directory)\nopen(\"/opt/gopath/src/github.com/op/libgo-logging.a\", O_RDONLY) = -1 ENOENT (No such file or directory)\nopen(\"/opt/gopath/src/github.com/op/go-logging.o\", O_RDONLY) = -1 ENOENT (No such file or directory)\n</code></p>\n\n<p>the compiler is able to find <code>go-logging</code> package in my $GOPATH, but it fails for not seeing anything with <code>.gox</code> <code>.so</code> <code>.a</code> or <code>.o</code> file.</p>\n\n<p>Which agrees with whats on the Go website:</p>\n\n<pre><code>When you import the package FILE with gccgo, it will look for the import data in the following files, and use the first one that it finds.\n\nFILE.gox FILE.o libFILE.so libFILE.a\n\nThe gccgo compiler will look in the current directory for import files\n</code></pre>\n\n<p>Any idea how could I resolve the issue?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["string", "go", "escaping", "hex"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492475786, "post_id": 43461679, "comment_id": 73979379, "body": "<code>\\xDA</code> <i>is</i> a valid hex escape. The utf8 encoding of <code>rune(218)</code> is <code>\\xc3\\x9a</code>. I&#39;m not sure what you&#39;re expecting to happen here."}, {"owner": {"reputation": 87, "user_id": 6201291, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5uEyb7euGZ4/AAAAAAAAAAI/AAAAAAAAAHk/o9o1b_adaQI/photo.jpg?sz=128", "display_name": "John Duncan", "link": "https://stackoverflow.com/users/6201291/john-duncan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492476456, "post_id": 43461679, "comment_id": 73979530, "body": "I could be mistaken, but I was expecting <code>fmt.Println(&quot;\\xDA&quot;)</code> to output &#39;&#218;&#39; instead of &#39;\ufffd&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1492480636, "last_edit_date": 1492480636, "creation_date": 1492476197, "answer_id": 43461796, "question_id": 43461679, "link": "https://stackoverflow.com/questions/43461679/escaping-of-hex-values-in-string-literals/43461796#43461796", "title": "Escaping of hex values in string literals", "body": "<p>Your input looks like ISO-8859-1 (Latin-1). Convert it to UTF-8. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unicode/utf8\"\n)\n\n// ISO88591ToString maps ISO-8859-1 (Latin-1) to string (UTF-8).\nfunc ISO88591ToString(iso string) string {\n    var utf []rune\n    for i := 0; i &lt; len(iso); i++ {\n        r := iso[i]\n        if utf == nil {\n            if r &lt; utf8.RuneSelf {\n                continue\n            }\n            utf = make([]rune, len(iso))\n            for j, r := range iso[:i] {\n                utf[j] = rune(r)\n            }\n        }\n        utf[i] = rune(r)\n    }\n    if utf == nil {\n        return string(iso)\n    }\n    return string(utf)\n}\n\nfunc main() {\n    l1 := \"\\x00\\x00\\t;IDATx\\xDA\\x010\\t\\xCF\\xF6\"\n    fmt.Printf(\"%q\\n\", l1)\n    s := ISO88591ToString(l1)\n    fmt.Printf(\"%q\\n\", s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"\\x00\\x00\\t;IDATx\\xda\\x010\\t\\xcf\\xf6\"\n\"\\x00\\x00\\t;IDATx\u00da\\x010\\t\u00cf\u00f6\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 6201291, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5uEyb7euGZ4/AAAAAAAAAAI/AAAAAAAAAHk/o9o1b_adaQI/photo.jpg?sz=128", "display_name": "John Duncan", "link": "https://stackoverflow.com/users/6201291/john-duncan"}, "edited": false, "score": 0, "creation_date": 1492478757, "post_id": 43462059, "comment_id": 73980007, "body": "Thanks! I just ended up changing the hex value to unicode (a couple minutes after the post) and everything went smoothly from there ;)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1492483236, "last_edit_date": 1492483236, "creation_date": 1492478568, "answer_id": 43462059, "question_id": 43461679, "link": "https://stackoverflow.com/questions/43461679/escaping-of-hex-values-in-string-literals/43462059#43462059", "title": "Escaping of hex values in string literals", "body": "<p>Go strings are just a series of bytes, but when an encoding is needed, it's assumed to be utf8. The value <code>\\xda</code> isn't a valid utf8 character, so when printing it's converted to the <code>unicode.ReplacementCharacter</code> \"\ufffd\"</p>\n\n<pre><code>    ReplacementChar = '\\uFFFD'     // Represents invalid code points.\n</code></pre>\n\n<p>If you want the rune value of <code>\\xda</code> in a string literal, use a unicode escape: <code>\\u00DA</code>, or use the utf8 encoded: <code>\\xc3\\x9a</code>, or use the character itself: <code>\u00da</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/EJZIqCI_Gr\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EJZIqCI_Gr</a></p>\n\n<p>If you actually want a single byte value of <code>\\xda</code> in your string, that is what you have and the printed character is inconsequential. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": false, "score": 1, "last_activity_date": 1492480309, "creation_date": 1492480309, "answer_id": 43462289, "question_id": 43461679, "link": "https://stackoverflow.com/questions/43461679/escaping-of-hex-values-in-string-literals/43462289#43462289", "title": "Escaping of hex values in string literals", "body": "<p>Strings in Go are UTF-8, and <code>\\xDA</code> isn't a valid UTF-8 sequence by itself, meaning printing it as a part of a string will yield the Unicode replacement character U+FFFD instead of what you wanted (\u00da, or U+00DA).</p>\n\n<p>You seem to be working with raw bytes, however, so you should consider whether you want the rune represented by <code>\\u00DA</code>, which is encoded in UTF-8 as the 2-byte sequence <code>\\xC3\\x8F</code>, or whether you require the single byte <code>\\xDA</code>. The former will print \u00da as you want with the caveat that it requires 2 bytes. The latter will not print as you expect, yet it will correctly be interpret <code>\\xDA</code> as 1 byte rather than 2 bytes.</p>\n\n<p>Here's an illustrative example you can <a href=\"https://play.golang.org/p/fHRm6Urqns\" rel=\"nofollow noreferrer\">run on the Playground</a>:</p>\n\n<pre><code>func main() {\n    // A string made up of UTF-8 lead bytes.\n    dataString := \"\\xCF\\xDA\\xF6\"\n\n    // Doesn't print what you think it should.\n    for _, c := range dataString {\n        fmt.Printf(\"%X \", c)\n    }\n    fmt.Println()\n\n    // Convert the string's bytes to a byte slice.\n    data := []byte(dataString)\n\n    // Now it should print CF, DA, F6.\n    for _, b := range data {\n        fmt.Printf(\"%X \", b)\n    }\n    fmt.Println()\n}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 6201291, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5uEyb7euGZ4/AAAAAAAAAAI/AAAAAAAAAHk/o9o1b_adaQI/photo.jpg?sz=128", "display_name": "John Duncan", "link": "https://stackoverflow.com/users/6201291/john-duncan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4073, "favorite_count": 2, "accepted_answer_id": 43462059, "answer_count": 3, "score": 0, "last_activity_date": 1611240606, "creation_date": 1492475221, "last_edit_date": 1611240606, "question_id": 43461679, "link": "https://stackoverflow.com/questions/43461679/escaping-of-hex-values-in-string-literals", "title": "Escaping of hex values in string literals", "body": "<p>I am attempting to escape a specific hex value in a golang string. The function call looks something like this:</p>\n<pre><code>Insert(0, &quot;\\x00\\x00\\x00\\rIHDR\\x00\\x00\\x000\\x00\\x00\\x000\\b\\x03&quot;)\nInsert(25, &quot;\\x00\\x00\\x00\\x06PLTE&quot;)\nInsert(43, &quot;\\x00\\x00\\x00\\x02tRNS&quot;)\nInsert(57, &quot;\\x00\\x00\\t;IDATx\\xDA\\x010\\t\\xCF\\xF6&quot;) // problem line\nInsert(2432, &quot;\\x00\\x00\\x00\\x00IEND&quot;)\n</code></pre>\n<p>The problem arises when the language interprets the &quot;\\xDA&quot; hex escape. Instead of correctly escaping to a \u00da value, it is escaped to \ufffd (the Replacement Character).</p>\n<p>I ensured this is what was occuring in the following playground example:</p>\n<pre><code>fmt.Println(&quot;\\xDA&quot;)\ni := 218\nh := fmt.Sprintf(&quot;%x&quot;, i)\nfmt.Printf(&quot;Hex conf of '%d' is '%s'\\n&quot;, i, h)  \nfmt.Println(string(i))\n</code></pre>\n<p>This snippet, when run, prints</p>\n<pre><code>\ufffd\nHex conf of '218' is 'da'\n\u00da\n</code></pre>\n<p>Am I missing something here? The fact that &quot;\\xDA&quot; is being escaped to a value of 65533 is throwing off my entire program, which relies on the CRC32 and some other checksums. This does not occur in the <a href=\"https://github.com/JohnDDuncanIII/messagefaces/blob/master/chrome/content/lib/xface.js\" rel=\"nofollow noreferrer\">javascript version</a> of this program (which itself is a translation from James compface program, written in C).</p>\n<p>Here is the playground link: <a href=\"https://play.golang.org/p/c-XMK68maX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/c-XMK68maX</a></p>\n"}, {"tags": ["string", "performance", "go", "concatenation"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1492468029, "post_id": 43460604, "comment_id": 73977185, "body": "Mind linking to the question? I imagine it was about repeated concatenation."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1492468665, "post_id": 43460604, "comment_id": 73977379, "body": "What&#39;s your Go version? Is it the same as the one used in the mentioned question? And as @Ryan already said, please link to the question."}, {"owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "edited": false, "score": 0, "creation_date": 1492471238, "post_id": 43460604, "comment_id": 73978109, "body": "go version 1.8.1."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "edited": false, "score": 0, "creation_date": 1492471038, "post_id": 43460911, "comment_id": 73978059, "body": "thanks! i have added two alternative methods to the test -- M3A  and M2A. M2A is very cheaty (in real life we cannot guess the size), but M3A with one Buffer works fine. But on large data it is not so fast (Step #24, 26, 28, 30)."}, {"owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "edited": false, "score": 0, "creation_date": 1492471582, "post_id": 43460911, "comment_id": 73978183, "body": "Why for string size 16 MiB and larger built-in operator &quot;+&quot; is faster?"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1492471042, "last_edit_date": 1492471042, "creation_date": 1492469719, "answer_id": 43460911, "question_id": 43460604, "link": "https://stackoverflow.com/questions/43460604/speed-of-concatenation-of-string-variables-in-go/43460911#43460911", "title": "Speed of Concatenation of string variables in Go", "body": "<p>One thing you're doing wrong is how you're benchmarking the buffer version. You're allocating a new buffer on every iteration, instead you should create a buffer once and keep writing to it until you're done, then you can retrieve your result. Else why use a buffer at all?</p>\n\n<pre><code>buf := bytes.NewBuffer([]byte(catcher))\nfor j = 1; j &lt;= operations; j++ {\n    //----------------------------\n    buf.WriteString(delta)\n    //----------------------------\n}\ncatcher = buf.String()\n</code></pre>\n\n<p>Your <code>stringsJoinViaCopy</code> also unnecessarily allocates a new byte slice every single time. And <code>copy</code> anyway makes sense over <code>bytes.Buffer</code> only when you know the size of the string beforehand since <code>Buffer</code> already uses <code>copy</code> underneath, together with some growing heuristic for the underlying byte slice.</p>\n"}, {"comments": [{"owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "edited": false, "score": 0, "creation_date": 1492535067, "post_id": 43463230, "comment_id": 74011692, "body": "thanks, but it does not check the speed for big sizes of data. for big sizes the picture is opposite."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1492489899, "last_edit_date": 1492489899, "creation_date": 1492487174, "answer_id": 43463230, "question_id": 43460604, "link": "https://stackoverflow.com/questions/43460604/speed-of-concatenation-of-string-variables-in-go/43463230#43463230", "title": "Speed of Concatenation of string variables in Go", "body": "<p>Here's a Go benchmark starter kit.</p>\n\n<p><code>concat_test.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"strconv\"\n    \"strings\"\n    \"testing\"\n)\n\nfunc BenchmarkConcat(b *testing.B) {\n    var s string\n    for n := 1; n &lt;= 1&lt;&lt;12; n &lt;&lt;= 3 {\n        s1 := strings.Repeat(\"a\", n)\n        s2 := strings.Repeat(\"b\", n)\n\n        b.Run(\"PlusL\"+strconv.Itoa(n), func(b *testing.B) {\n            b.ReportAllocs()\n            b.ResetTimer()\n            for i := 0; i &lt; b.N; i++ {\n                s = s1 + s2\n            }\n            b.StopTimer()\n        },\n        )\n\n        b.Run(\"CopyL\"+strconv.Itoa(n), func(b *testing.B) {\n            b.ReportAllocs()\n            b.ResetTimer()\n            for i := 0; i &lt; b.N; i++ {\n                buf := make([]byte, len(s1)+len(s2))\n                copy(buf[copy(buf, s1):], s2)\n                s = string(buf)\n            }\n            b.StopTimer()\n        },\n        )\n\n        b.Run(\"BufferL\"+strconv.Itoa(n), func(b *testing.B) {\n            b.ReportAllocs()\n            b.ResetTimer()\n            for i := 0; i &lt; b.N; i++ {\n                var buf bytes.Buffer\n                buf.WriteString(s1)\n                buf.WriteString(s2)\n                s = buf.String()\n            }\n            b.StopTimer()\n        },\n        )\n\n    }\n    _ = s\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go test -bench=.\ngoos: linux\ngoarch: amd64\npkg: so/concat\nBenchmarkConcat/PlusL1-4       30000000     55.9 ns/op     2 B/op      1 allocs/op\nBenchmarkConcat/CopyL1-4       30000000     63.0 ns/op     4 B/op      2 allocs/op\nBenchmarkConcat/BufferL1-4     10000000    115 ns/op     114 B/op      2 allocs/op\nBenchmarkConcat/PlusL8-4       20000000     78.1 ns/op    16 B/op      1 allocs/op\nBenchmarkConcat/CopyL8-4       20000000     99.2 ns/op    32 B/op      2 allocs/op\nBenchmarkConcat/BufferL8-4     10000000    131 ns/op     128 B/op      2 allocs/op\nBenchmarkConcat/PlusL64-4      20000000     85.3 ns/op   128 B/op      1 allocs/op\nBenchmarkConcat/CopyL64-4      10000000    125 ns/op     256 B/op      2 allocs/op\nBenchmarkConcat/BufferL64-4     5000000    328 ns/op     432 B/op      3 allocs/op\nBenchmarkConcat/PlusL512-4      5000000    249 ns/op    1024 B/op      1 allocs/op\nBenchmarkConcat/CopyL512-4      3000000    457 ns/op    2048 B/op      2 allocs/op\nBenchmarkConcat/BufferL512-4    1000000   1012 ns/op    3184 B/op      4 allocs/op\nBenchmarkConcat/PlusL4096-4     1000000   1527 ns/op    8192 B/op      1 allocs/op\nBenchmarkConcat/CopyL4096-4      500000   3132 ns/op   16384 B/op      2 allocs/op\nBenchmarkConcat/BufferL4096-4    300000   4863 ns/op   24688 B/op      4 allocs/op\nPASS\nok      so/concat   24.308s\n$ \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "is_accepted": true, "score": -1, "last_activity_date": 1500372110, "creation_date": 1500372110, "answer_id": 45163493, "question_id": 43460604, "link": "https://stackoverflow.com/questions/43460604/speed-of-concatenation-of-string-variables-in-go/45163493#45163493", "title": "Speed of Concatenation of string variables in Go", "body": "<p>On very large Sizes the Plus Operator (\"+\") is faster than other Methods.</p>\n"}], "owner": {"reputation": 241, "user_id": 5672542, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29ab50545414b03b9c669d03bb631019?s=128&d=identicon&r=PG&f=1", "display_name": "Chelovek", "link": "https://stackoverflow.com/users/5672542/chelovek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 1, "accepted_answer_id": 45163493, "answer_count": 3, "score": -1, "last_activity_date": 1500372110, "creation_date": 1492467873, "last_edit_date": 1495535460, "question_id": 43460604, "link": "https://stackoverflow.com/questions/43460604/speed-of-concatenation-of-string-variables-in-go", "title": "Speed of Concatenation of string variables in Go", "body": "<p>I have seen on this website a question about the speed of string concatenation. In that topic people wrote about some ephemeral benchmarks with strange numbers. <a href=\"https://stackoverflow.com/questions/1760757/how-to-efficiently-concatenate-strings-in-go\">How to efficiently concatenate strings in Go?</a></p>\n\n<p>I have decided to check those speeds and wrote a test. My test shows other results. On big sizes \"+\" operator is faster than other methods. Is that right?</p>\n\n<p>Here is my code.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"runtime/debug\"\n    \"time\"\n)\n\nconst variations = 30\n\nvar time1, time2 time.Time\nvar delta, catcher string\nvar x, deltaSize, k, dataSize, operations uint64\nvar i, j, x_min uint64\nvar l int\nvar delta_byte []byte\nvar method1Speed, method2Speed, method3Speed, method3ASpeed, method2ASpeed [variations]uint64\nvar dataTotal [variations]uint64\nvar tmp []byte\n\nfunc main() {\n\n    x_min = 2\n    operations = 1\n\n    for x = variations; x &gt;= x_min; x = x - 2 {\n        deltaSize = 1 &lt;&lt; x // 2^x\n        dataSize = operations * deltaSize\n        dataTotal[x-1] = dataSize\n\n        fmt.Println(\"Step #\", x, \"delta=\", deltaSize, \"op.=\", operations, \"data=\", dataSize)\n        fmt.Println(\"Preparing Data...\")\n        delta_byte = make([]byte, deltaSize)\n        for i = 0; i &lt; deltaSize; i++ {\n            delta_byte[i] = 255\n        }\n        delta = string(delta_byte)\n\n        delta_byte = nil\n        catcher = \"\"\n        debug.FreeOSMemory()\n\n        fmt.Println(\"Testing Method #1...\")\n        time1 = time.Now()\n        for j = 1; j &lt;= operations; j++ {\n            //----------------------------\n            catcher += delta\n            //----------------------------\n        }\n        time2 = time.Now()\n        method1Speed[x-1] = uint64((1000000 * float64(dataSize)) / float64(time2.Sub(time1).Nanoseconds())) // KiB/sec.\n\n        catcher = \"\"\n        debug.FreeOSMemory()\n\n        fmt.Println(\"Testing Method #2...\")\n        time1 = time.Now()\n        for j = 1; j &lt;= operations; j++ {\n            //----------------------------\n            stringsJoinViaCopy(&amp;catcher, &amp;catcher, &amp;delta)\n            //----------------------------\n        }\n        time2 = time.Now()\n        method2Speed[x-1] = uint64((1000000 * float64(dataSize)) / float64(time2.Sub(time1).Nanoseconds())) // KiB/sec.\n\n        catcher = \"\"\n        debug.FreeOSMemory()\n\n        fmt.Println(\"Testing Method #3...\")\n        time1 = time.Now()\n        for j = 1; j &lt;= operations; j++ {\n            //----------------------------\n            stringsJoinViaBuffer(&amp;catcher, &amp;catcher, &amp;delta)\n            //----------------------------\n        }\n        time2 = time.Now()\n        method3Speed[x-1] = uint64((1000000 * float64(dataSize)) / float64(time2.Sub(time1).Nanoseconds())) // KiB/sec.\n\n        catcher = \"\"\n        debug.FreeOSMemory()\n\n        fmt.Println(\"Testing Method #3A...\")\n        time1 = time.Now()\n        buffer := bytes.NewBuffer(nil)\n        for j = 1; j &lt;= operations; j++ {\n            //----------------------------\n            buffer.WriteString(delta)\n            //----------------------------\n        }\n        catcher = buffer.String()\n        time2 = time.Now()\n        method3ASpeed[x-1] = uint64((1000000 * float64(dataSize)) / float64(time2.Sub(time1).Nanoseconds())) // KiB/sec.\n\n        catcher = \"\"\n        debug.FreeOSMemory()\n\n        fmt.Println(\"Testing Method #2A...\")\n        time1 = time.Now()\n        tmp = make([]byte, int(operations)*len(delta)) // Cheating (guessing) with size\n        l = 0\n        for j = 1; j &lt;= operations; j++ {\n            //----------------------------\n            l += copy(tmp[l:], delta)\n            //----------------------------\n        }\n        catcher = string(tmp)\n        time2 = time.Now()\n        method2ASpeed[x-1] = uint64((1000000 * float64(dataSize)) / float64(time2.Sub(time1).Nanoseconds())) // KiB/sec.\n\n        catcher = \"\"\n        delta = \"\"\n        debug.FreeOSMemory()\n\n        ///\n        operations *= 2\n    }\n\n    // Show Results\n    fmt.Println(\"#. ops. Total Data, B. Speed (KiB/sec) M1 M2 M3 M3A M2A\")\n    for x = x_min; x &lt;= variations; x = x + 2 {\n        dataSize = 1 &lt;&lt; x // 2^x\n        operations = 1 &lt;&lt; (variations - x)\n        fmt.Println(x, operations, dataTotal[x-1], method1Speed[x-1], method2Speed[x-1], method3Speed[x-1],\n            method3ASpeed[x-1], method2ASpeed[x-1])\n    }\n}\n\n//------------------------------------------------------------------------------\n\nfunc stringsJoinViaBuffer(dest, a, b *string) {\n\n    // Joins two strings (a &amp; b) using Buffer and puts them into dest.\n\n    buffer := bytes.NewBuffer(nil)\n    buffer.WriteString(*a)\n    buffer.WriteString(*b)\n\n    *dest = buffer.String()\n}\n\n//------------------------------------------------------------------------------\n\nfunc stringsJoinViaCopy(dest, a, b *string) {\n    x := make([]byte, len(*a)+len(*b))\n    i := 0\n    i += copy(x[i:], *a)\n    i += copy(x[i:], *b)\n\n    *dest = string(x)\n}\n</code></pre>\n\n<p>Here are results</p>\n\n<pre><code>#. ops. Total Data, B. Speed (KiB/sec) M1 M2 M3 M3A M2A\n2 268435456 65536 236 109 57 108413 301653\n4 67108864 131072 464 227 113 251519 576660\n6 16777216 262144 895 410 202 225300 626165\n8 4194304 524288 1514 672 351 205068 552088\n10 1048576 1048576 3187 1412 756 207588 532239\n12 262144 2097152 7980 3238 1727 209447 592230\n14 65536 4194304 16361 6553 3641 230521 536320\n16 16384 8388608 29568 12170 6835 241752 604050\n18 4096 16777216 55158 23950 13549 238039 563997\n20 1024 33554432 98348 43400 25958 216947 521189\n22 256 67108864 168906 80442 48725 231806 534722\n24 64 134217728 299127 129035 89686 254403 519534\n26 16 268435456 529730 207405 153894 284578 506730\n28 4 536870912 1167316 353510 268546 359990 523471\n30 1 1073741824 909950698305 503703 581848 572763 579852\n</code></pre>\n\n<p>Seems like it works when you either have a lot of data going constantly or can cheat with size guessing... Is it correct? If there are ocassional strings, simple \"+\" is better? Somehow, in the mentioned question people measured byte transfers without real-world tasks. </p>\n\n<p>Somehow in the step #26 \"+\" operator is faster even than cheating with size guessing!</p>\n"}, {"tags": ["git", "github", "go"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492462305, "post_id": 43459325, "comment_id": 73974816, "body": "<code>go get</code> doesn&#39;t fetch anything if it exists locally. Running <code>go get -u</code> will call <code>git pull --ff-only</code>, but it will never change your remote tracking branch."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492462484, "post_id": 43459325, "comment_id": 73974887, "body": "Hmm, I&#39;m not sure if ff-only would work with committed local changes then. Only one way to find out for sure!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492462903, "post_id": 43459325, "comment_id": 73975059, "body": "If course it won&#39;t work, because you can&#39;t fast-forward if there&#39;s changes. It will also fail if you don&#39;t have tracking info for your local branch (which is default when making a branch and pushing it to a remote), though even if you did it would still do nothing, because you&#39;re remote branch is the same thing you just pushed!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492463219, "post_id": 43459325, "comment_id": 73975211, "body": "He didn&#39;t say anything about making a branch, so he&#39;ll still be on the same branch that was originally checked out (master), with one additional commit, which will have been pushed to a secondary remote, but not the remote tracked by the branch. So a fast forward (and therefore <code>go get -u</code>, according to @JimB earlier comment), wouldn&#39;t work without a clean checkout from origin. Could change it to track the fork, and then keep the fork up to date from its upstream, but the import path would be misleading at that point."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1492641483, "last_edit_date": 1492641483, "creation_date": 1492462052, "answer_id": 43459325, "question_id": 43459290, "link": "https://stackoverflow.com/questions/43459290/submit-pull-request-for-changes-to-packages-installed-via-go-get/43459325#43459325", "title": "Submit pull request for changes to packages installed via &quot;go get&quot;", "body": "<p>Fork the repo in GitHub, then add your fork as a remote in your working copy under a name other than origin, e.g. <code>git remote add myfork git@github.org...</code>. You can push your changes to your fork (<code>git push myfork</code>), then open a PR from your fork to the original.</p>\n\n<p>Explicitly, the commands would something like this after you fork the original to your own account:</p>\n\n<pre><code>git remote add myfork https://github.com/&lt;your_username&gt;/&lt;repository&gt;.git\ngit push myfork\n</code></pre>\n\n<p>After which, you can submit the PR to the original. If your PR is accepted, you can then run these commands:</p>\n\n<pre><code>git remote remove myfork\ngit rebase master\ngit pull origin master\n</code></pre>\n\n<p>You can then delete your fork from your GitHub account. After which, <code>go get -u</code> will function as normal.</p>\n\n<p>Any time you need to make new changes to the package, you can repeat this process.</p>\n"}], "owner": {"reputation": 14367, "user_id": 130427, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/6gMyw.jpg?s=128&g=1", "display_name": "Chris Redford", "link": "https://stackoverflow.com/users/130427/chris-redford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 43459325, "answer_count": 1, "score": 0, "last_activity_date": 1492641483, "creation_date": 1492461903, "last_edit_date": 1492462146, "question_id": 43459290, "link": "https://stackoverflow.com/questions/43459290/submit-pull-request-for-changes-to-packages-installed-via-go-get", "title": "Submit pull request for changes to packages installed via &quot;go get&quot;", "body": "<p>I have a package I installed via <code>go get github.com/&lt;other_user&gt;/&lt;repository&gt;</code>. It was missing some features, so I have been working with the original author to add them to the package.</p>\n\n<p>I made the changes to my local copy and committed them. Then I realized: derp, I don't have authorization to <code>git push</code> these changes.</p>\n\n<p>Is there a way for me to salvage my changes and somehow submit a pull request to him? Or do I have to lose all my changes, fork his repository, re-implement my changes, and then submit a pull request?</p>\n\n<p>And no matter what I do, is there a way for me to retain the ability to do this command?</p>\n\n<pre><code>go get -u &lt;original_repository&gt;\n</code></pre>\n\n<p>Or do I have to just become a full-time contributor and continually update my fork with his repository?</p>\n"}, {"tags": ["http", "go", "gzip", "tar"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1492461653, "post_id": 43459174, "comment_id": 73974499, "body": "If tar with <code>-j</code> works, it&#39;s a bzip file, not a gzip."}], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 6292128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86d69b38297441ffb0669edb14c1777?s=128&d=identicon&r=PG&f=1", "display_name": "Julien S&#233;veno-Piltant", "link": "https://stackoverflow.com/users/6292128/julien-s%c3%a9veno-piltant"}, "edited": false, "score": 0, "creation_date": 1492555894, "post_id": 43466177, "comment_id": 74022774, "body": "Thanks mate, I will try it tomorrow :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 7882603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3ad047cecdf9d7a01ec7f46d85a08e?s=128&d=identicon&r=PG&f=1", "display_name": "user7882603", "link": "https://stackoverflow.com/users/7882603/user7882603"}, "is_accepted": false, "score": 1, "last_activity_date": 1492500547, "creation_date": 1492500547, "answer_id": 43466177, "question_id": 43459174, "link": "https://stackoverflow.com/questions/43459174/invalid-gzip-header/43466177#43466177", "title": "Invalid GZIP header", "body": "<p><strong>you need zlib rather than gzip:</strong></p>\n\n<pre><code>func readGzip(content []byte) error {\n    var buf *bytes.Buffer = bytes.NewBuffer(content)\n\n    gRead, err := zlib.NewReader(buf)\n    if err != nil {\n        return err\n    }\n\n    if t, err := io.Copy(os.Stdout, gRead); err != nil {\n        fmt.Println(t)\n        return err\n    }\n\n    if err := gRead.Close(); err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8341647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b9342d448e4bc876cb6ec8bf31c41e9?s=128&d=identicon&r=PG&f=1", "display_name": "danny wang", "link": "https://stackoverflow.com/users/8341647/danny-wang"}, "is_accepted": false, "score": 0, "last_activity_date": 1500616587, "last_edit_date": 1500616587, "creation_date": 1500604139, "answer_id": 45228038, "question_id": 43459174, "link": "https://stackoverflow.com/questions/43459174/invalid-gzip-header/45228038#45228038", "title": "Invalid GZIP header", "body": "<p>In the Server: if use below code sends response, the response body will include header information. It will lead to invalid header error.</p>\n\n<p>Should use <code>ServeContent()</code> function to send file.</p>\n\n<pre><code>streamPDFbytes, _ := os.Create(\"./data/Matt Aimonettirepo.go\")\nb := bytes.NewBuffer(streamPDFbytes)\n\n// stream straight to client(browser)\nw.Header().Set(\"Content-type\", \"application/octet-stream\")\nw.Header().Set(\"Content-Encoding\", \"gzip\")\n\nif _, err := b.WriteTo(w); err != nil { // &lt;----- here!\n    fmt.Fprintf(w, \"%s\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 6292128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f86d69b38297441ffb0669edb14c1777?s=128&d=identicon&r=PG&f=1", "display_name": "Julien S&#233;veno-Piltant", "link": "https://stackoverflow.com/users/6292128/julien-s%c3%a9veno-piltant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6976, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1500616587, "creation_date": 1492461357, "last_edit_date": 1492462116, "question_id": 43459174, "link": "https://stackoverflow.com/questions/43459174/invalid-gzip-header", "title": "Invalid GZIP header", "body": "<p>I am new to Golang, so maybe this is something quite evident but I did not find anything that is working on Stackoverflow or on the Gzip documentation.</p>\n\n<p>I download a .gz through Http and write the content of the response body in a file. However, when I try to read it from the file and uncompress it, I got the \"invalid header\" error.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>reader, err := os.Open(completeName)\nif err != nil {\n    panic(err)\n}\ndefer reader.Close()\n\narchive, err := gzip.NewReader(reader)\nif err != nil {\n    panic(err)\n}\ndefer archive.Close()\n\ntarget := destDirectory()\nwriter, err := os.Create(target + completeName)\nif err != nil {\n    panic(err)\n}\ndefer writer.Close()\n\n_, err = io.Copy(writer, archive)\nreturn err\n</code></pre>\n\n<p>I though it would be that the content I receive is invalid but I tried to uncompress it via \"tar -xjf file.gz\" and it worked perfecly.</p>\n\n<p>Any ideas ?</p>\n"}, {"tags": ["go", "go-html-template"], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492461526, "post_id": 43459037, "comment_id": 73974445, "body": "No problem, I&#39;m glad I could help. Just FYI, from looking at the <code>unrolled&#47;render</code>&#39;s source, it seems to me that the <code>UnEscapeHTML</code> option is only for unescaping JSON values, and although they don&#39;t mention it in their documentation of the option, they do mention it in their <code>README</code> under <a href=\"https://github.com/unrolled/render#available-options\" rel=\"nofollow noreferrer\">Available Options</a>."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492461982, "post_id": 43459037, "comment_id": 73974661, "body": "After reading your solution I also tried to remove the <code>UnEscapeHTML: true,</code> option and it still worked :).. before posting my question I had also tried to make it work using <code>template.Must(template.New(&quot;&quot;).Parse(markdownContent)</code>.. not sure if it would&#39;ve worked or not but I also noticed I foolishly used <code>text&#47;template</code> instead of <code>html&#47;template</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492463042, "post_id": 43459037, "comment_id": 73975115, "body": "<code>Parse</code> takes a string, so you can pass the <code>markdownContent</code> value directly to it although you need to cast it to a <code>string</code> since <code>MarkdownCommon</code> returns a slice of bytes, and you would also lose the <code>&lt;body&gt;...&lt;&#47;body&gt;</code> part. Here&#39;s a quick example of how template escaping works: <a href=\"https://play.golang.org/p/tkYXcmNXLm\" rel=\"nofollow noreferrer\">play.golang.org/p/tkYXcmNXLm</a>"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1492473882, "post_id": 43459037, "comment_id": 73978851, "body": "That&#39;s great :), I do think <code>template.HTML(md)</code> inside the map[string]interface{}{...} feels much cleaner and easier to work with than <code>template.Must(template.New(&quot;&quot;).Parse(string(md)))</code> so I&#39;m very happy to know it&#39;s possible to do it that way ^_^"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 5, "last_activity_date": 1563290440, "last_edit_date": 1563290440, "creation_date": 1492460696, "answer_id": 43459037, "question_id": 43458824, "link": "https://stackoverflow.com/questions/43458824/parsing-unescaped-html-to-html-template-in-go/43459037#43459037", "title": "Parsing unescaped HTML to HTML template in Go", "body": "<p>In Go you can convert known safe html strings to the <a href=\"https://golang.org/pkg/html/template/#HTML\" rel=\"nofollow noreferrer\">template.HTML</a> type, and since <a href=\"https://github.com/unrolled/render\" rel=\"nofollow noreferrer\">unrolled/render</a> uses Go's <code>html/template</code> to render html you should be able to use just that.</p>\n\n<pre><code>Renderer.HTML(w, http.StatusOK, \"index\", map[string]interface{}{\n        \"content\": template.HTML(markdownContent),\n})\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3183, "favorite_count": 0, "accepted_answer_id": 43459037, "answer_count": 1, "score": 3, "last_activity_date": 1563290440, "creation_date": 1492459703, "question_id": 43458824, "link": "https://stackoverflow.com/questions/43458824/parsing-unescaped-html-to-html-template-in-go", "title": "Parsing unescaped HTML to HTML template in Go", "body": "<p>I have created this really simple program for testing.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/microcosm-cc/bluemonday\"\n    \"github.com/pressly/chi\"\n    \"github.com/russross/blackfriday\"\n    \"github.com/unrolled/render\"\n    \"net/http\"\n)\n\nfunc main() {\n    r := chi.NewRouter()\n    r.Get(\"/\", homepageGET)\n    http.ListenAndServe(\":8080\", r)\n}\n\nfunc homepageGET(w http.ResponseWriter, r *http.Request) {\n    Renderer := render.New(render.Options{\n        Directory:    \"frontend\",\n        Extensions:   []string{\".tmpl\", \".html\"},\n        UnEscapeHTML: true,\n    })\n    unsafe := blackfriday.MarkdownCommon([]byte(\"**bolded text**\"))\n    markdownContent := bluemonday.UGCPolicy().SanitizeBytes(unsafe)\n    fmt.Print(string(markdownContent))\n    Renderer.HTML(w, http.StatusOK, \"index\", map[string]interface{}{\n        \"content\": fmt.Sprintf(string(markdownContent))})\n}\n</code></pre>\n\n<p>And then I have a HTML file containing nothing besides:</p>\n\n<pre><code>&lt;body&gt;\n  {{ .content }}\n&lt;/body&gt;\n</code></pre>\n\n<p>The fmt.Print command prints \"<code>&lt;p&gt;&lt;strong&gt;bolded text&lt;/strong&gt;&lt;/p&gt;</code>\", whereas it's inserted into the HTML page as: \"<code>&amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;bolded text&amp;lt;/strong&amp;gt;&amp;lt;/p&amp;gt;</code>\".</p>\n\n<p>I believe it is related to escaped HTML, but for the unrolled/render package I configure it as unescaped.. I'd greatly appreciate any help getting the test program working (preferably together with unrolled/render).</p>\n"}, {"tags": ["http", "go", "concurrency", "race-condition"], "comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1492459734, "post_id": 43458792, "comment_id": 73973463, "body": "Have you built and run your code with <code>-race</code> option?"}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1492459770, "post_id": 43458792, "comment_id": 73973487, "body": "@Grzegorz\u017bur yes on both build an test and it runs fine."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492459778, "post_id": 43458792, "comment_id": 73973490, "body": "You have no synchronization around your map, and it could be modified and read concurrently."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492460560, "post_id": 43458792, "comment_id": 73973913, "body": "@JimB makes sense after your edit. You had me confused."}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492460564, "post_id": 43458792, "comment_id": 73973915, "body": "@JimB so I will need a mutex around the map if I want to concurrently read and write?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1492460607, "post_id": 43458792, "comment_id": 73973943, "body": "<a href=\"https://golang.org/doc/go1.6#runtime\" rel=\"nofollow noreferrer\">golang.org/doc/go1.6#runtime</a> &quot;As always, if one goroutine is writing to a map, no other goroutine should be reading or writing the map concurrently. If the runtime detects this condition, it prints a diagnosis and crashes the program.&quot;"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1492460654, "post_id": 43458792, "comment_id": 73973971, "body": "@danbondd you can use any synchronisation mechanism that lets you achieve the expected behaviour (no writes concurrent to any other operation). For example: mutexes, yes."}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492460818, "post_id": 43458792, "comment_id": 73974074, "body": "@zerkms Ok, thanks. I&#39;m still a little unsure as to why it was never flagged when I ran the application with the <code>-race</code> flag."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492460820, "post_id": 43458792, "comment_id": 73974075, "body": "@danbondd: no data structures in go are safe for concurrent reads and writes. You always need synchronization."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1492460863, "post_id": 43458792, "comment_id": 73974109, "body": "@danbondd: the race detector and runtime map checks can only detect races when they happen, if you don&#39;t test your code with concurrent requests, then there&#39;s no concurrent access."}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492460949, "post_id": 43458792, "comment_id": 73974159, "body": "@JimB Makes sense, thanks! I only tested the application in isolation without and concurrent end-to-end test."}, {"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 1, "creation_date": 1492461987, "post_id": 43458792, "comment_id": 73974665, "body": "Use a read-write lock instead of a mutex.  It allows for concurrents reads and only locks when a goroutine is writing to the map."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492464501, "post_id": 43459894, "comment_id": 73975826, "body": "Right. Which is what I was trying to get across. How was it unclear?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492464559, "post_id": 43459894, "comment_id": 73975862, "body": "&quot;You&#39;re only synchronizing your writes, not your reads. That means you still might read from the map while you&#39;re writing to it.&quot; is an accurate description of the code in the question, and description of the problem with it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1492464603, "post_id": 43459894, "comment_id": 73975883, "body": "No, the suggestion follows &quot;To make it thread-safe...&quot; I&#39;ll edit for clarity."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1492464684, "last_edit_date": 1492464684, "creation_date": 1492464324, "answer_id": 43459894, "question_id": 43458792, "link": "https://stackoverflow.com/questions/43458792/concurrently-writing-and-reading-from-map-causes-potential-race-condition/43459894#43459894", "title": "Concurrently writing and reading from map causes potential race condition", "body": "<p>In the code given, you're only synchronizing your writes, not your reads; that means you still might read from the map while you're writing to it, which would be a race condition.</p>\n\n<p>To make it thread-safe, you need to wrap both reads and writes in a concurrency structure - either using channels or a mutex - in order to ensure that only one thread is accessing it at any given time if it is a write operation. Multiple threads can safely read at the same time, as long as no thread is writing to it. <code>RWMutex</code> provides this functionality explicitly.</p>\n"}], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 0, "accepted_answer_id": 43459894, "answer_count": 1, "score": 3, "last_activity_date": 1494927874, "creation_date": 1492459591, "last_edit_date": 1494927874, "question_id": 43458792, "link": "https://stackoverflow.com/questions/43458792/concurrently-writing-and-reading-from-map-causes-potential-race-condition", "title": "Concurrently writing and reading from map causes potential race condition", "body": "<p>I have a very basic Golang application that creates and runs a HTTP server. The server has 2 endpoints, one to send data and one to receive.</p>\n\n<p>Upon each POST request to the server, parse the incoming data from the body and push it onto a channel. I then have a function that reads from the channel and saves the data to a map.</p>\n\n<p>Upon each GET request to the server, JSON marshal the map and send it to the client.</p>\n\n<p>Each request to the HTTP server runs asynchronously and the worker function writes to the map synchronously in its own goroutine.</p>\n\n<p>Basic pseudo code is as follows:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\ntype dataStore map[string]string\n\nfunc listenHandler(stream chan string) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        // JSON unmarshal request body\n\n        // push data onto stream\n        stream &lt;- data\n    }\n}\n\nfunc serveHandler(store *dataStore) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        // JSON marshal data store\n        // serve to client\n    }\n}\n\nfunc worker(stream &lt;-chan string) *dataStore {\n    store := make(dataStore)\n    go func() {\n        for data := range stream {\n            // process and write data to map\n        }\n    }()\n    return &amp;store\n}\n\nfunc main() {\n    stream := make(chan string)\n    store := worker(stream)\n\n    http.HandleFunc(\"/listen\", listenHandler(stream))\n    http.HandleFunc(\"/serve\", serveHandler(store))\n\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I have tested and ran the application with no problems, however I have been told it has a potential race condition and I am not sure why. Is this true? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1492456768, "post_id": 43457876, "comment_id": 73971853, "body": "No you can&#39;t, because type <code>geometry</code> is an interface and therefore exposes no fields, only methods."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492456858, "post_id": 43457876, "comment_id": 73971910, "body": "You need to define the method for each type to satisfy the interface. You can&#39;t make the method any simpler than <code>return c.name</code>, so there&#39;s no functionality there to deduplicate."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492456878, "post_id": 43457876, "comment_id": 73971927, "body": "@Adrian whoops, my mistake!"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1492456982, "creation_date": 1492456982, "answer_id": 43458119, "question_id": 43457876, "link": "https://stackoverflow.com/questions/43457876/how-to-dry-in-the-following/43458119#43458119", "title": "How to DRY in the following?", "body": "<p>You could - and potentially should - embed your geometry type in another struct type that includes the name. Unless the name is \"circle\" or \"square\" or what have you, the name isn't actually related in any way to the geometry itself. So you could have:</p>\n\n<pre><code>type namedGeometry struct {\n    geometry\n    name string\n}\n\nfunc (ng *namedGeometry) getName() string {\n    return ng.name\n}\n</code></pre>\n\n<p>Which would serve the same purpose, remain DRY, and maintain separation of concerns. With <code>geometry</code> embedded, you can still call the <code>geometry</code> methods on a <code>namedGeometry</code> instance.</p>\n"}, {"comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1492521513, "post_id": 43467225, "comment_id": 74001523, "body": "Normally we embed the type itself, not a pointer to type. That just adds one unnecessary indirection level, hence <code>baseShape</code> should embedded in <code>rect</code> and <code>circle</code> (not <code>*baseShape</code>)."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 1, "creation_date": 1492537742, "post_id": 43467225, "comment_id": 74013306, "body": "@KavehShahbazian You&#39;re right. When returning a type that would satisfy an interface, if the type has pointer receivers for all the methods, you must return a pointer to the type (<a href=\"https://play.golang.org/p/GngXC1Rze2\" rel=\"nofollow noreferrer\">an example of what I mean</a>). I thought the same applied here, but apparently it does not."}], "tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": false, "score": 0, "last_activity_date": 1492537752, "last_edit_date": 1492537752, "creation_date": 1492503968, "answer_id": 43467225, "question_id": 43457876, "link": "https://stackoverflow.com/questions/43457876/how-to-dry-in-the-following/43467225#43467225", "title": "How to DRY in the following?", "body": "<p>I would take a similar approach to Adrian's, but I would instead embed a base type, which holds common functionality, in your other types e.g.</p>\n\n<pre><code>type baseShape struct {\n    name string\n}\n\nfunc (s *baseShape) getName() string {\n    return s.name\n}\n\ntype rect struct {\n    width, height float64\n    baseShape\n}\n\ntype circle struct {\n    radius float64\n    baseShape\n}\n</code></pre>\n\n<p>After doing this, you only need to implement the functions that differ between the shapes on a per type basis.</p>\n"}], "owner": {"reputation": 894, "user_id": 6078917, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/HRZj4.jpg?s=128&g=1", "display_name": "ryan", "link": "https://stackoverflow.com/users/6078917/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492537752, "creation_date": 1492455952, "question_id": 43457876, "link": "https://stackoverflow.com/questions/43457876/how-to-dry-in-the-following", "title": "How to DRY in the following?", "body": "<p>Typical example with added <code>getName()</code> function.  </p>\n\n<p>I wonder how can I do not write <code>getName()</code> for <code>circle</code> and <code>rect</code> twice?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\n// Here's a basic interface for geometric shapes.\ntype geometry interface {\n    area() float64\n    perim() float64\n    getName() string\n}\n\n// For our example we'll implement this interface on\n// `rect` and `circle` types.\ntype rect struct {\n    width, height float64\n    name string\n}\ntype circle struct {\n    radius float64\n    name string\n}\n\n// To implement an interface in Go, we just need to\n// implement all the methods in the interface. Here we\n// implement `geometry` on `rect`s.\nfunc (r rect) area() float64 {\n    return r.width * r.height\n}\nfunc (r rect) perim() float64 {\n    return 2*r.width + 2*r.height\n}\nfunc (r rect) getName() string {\n    return r.name\n}\n\n// The implementation for `circle`s.\nfunc (c circle) area() float64 {\n    return math.Pi * c.radius * c.radius\n}\nfunc (c circle) perim() float64 {\n    return 2 * math.Pi * c.radius\n}\nfunc (c circle) getName() string {\n    return c.name\n}\n\n// If a variable has an interface type, then we can call\n// methods that are in the named interface. Here's a\n// generic `measure` function taking advantage of this\n// to work on any `geometry`.\nfunc measure(g geometry) {\n    fmt.Println(g)\n    fmt.Println(g.area())\n    fmt.Println(g.perim())\n    fmt.Println(g.getName())\n}\n\nfunc main() {\n    r := rect{width: 3, height: 4, name: \"rect5\"}\n    c := circle{radius: 5, name: \"circle2\"}\n\n    // The `circle` and `rect` struct types both\n    // implement the `geometry` interface so we can use\n    // instances of\n    // these structs as arguments to `measure`.\n    measure(r)\n    measure(c)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2061, "user_id": 5584413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dca5aedf246def1926b828737715585?s=128&d=identicon&r=PG&f=1", "display_name": "Rams", "link": "https://stackoverflow.com/users/5584413/rams"}, "edited": false, "score": 1, "creation_date": 1492452439, "post_id": 43456851, "comment_id": 73969459, "body": "In which database n also u can simply get the result by google"}, {"owner": {"reputation": 121, "user_id": 2152652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb76613173dd31ce6ee7748f5f43230a?s=128&d=identicon&r=PG", "display_name": "serps", "link": "https://stackoverflow.com/users/2152652/serps"}, "reply_to_user": {"reputation": 2061, "user_id": 5584413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9dca5aedf246def1926b828737715585?s=128&d=identicon&r=PG&f=1", "display_name": "Rams", "link": "https://stackoverflow.com/users/5584413/rams"}, "edited": false, "score": 0, "creation_date": 1492454849, "post_id": 43456851, "comment_id": 73970743, "body": "i did not mention anything to do with databases @Rams? i will check that answer @NaveenKumarNamachivayam"}, {"owner": {"reputation": 121, "user_id": 2152652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb76613173dd31ce6ee7748f5f43230a?s=128&d=identicon&r=PG", "display_name": "serps", "link": "https://stackoverflow.com/users/2152652/serps"}, "edited": false, "score": 0, "creation_date": 1492455697, "post_id": 43456851, "comment_id": 73971294, "body": "best answer here <a href=\"http://stackoverflow.com/a/39287194/2152652\">stackoverflow.com/a/39287194/2152652</a>"}, {"owner": {"reputation": 2081, "user_id": 2378213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3639dc9bce37b77502008ab6ca6feb?s=128&d=identicon&r=PG", "display_name": "edufinn", "link": "https://stackoverflow.com/users/2378213/edufinn"}, "edited": false, "score": 0, "creation_date": 1546791214, "post_id": 43456851, "comment_id": 94959837, "body": "I disagree that this is duplicated question. Provided answers show American date formats, which have nothing to do with the formats used in most European countries."}], "answers": [{"tags": [], "owner": {"reputation": 2339, "user_id": 3081558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9ritS.jpg?s=128&g=1", "display_name": "Patrick", "link": "https://stackoverflow.com/users/3081558/patrick"}, "is_accepted": true, "score": 14, "last_activity_date": 1492461807, "creation_date": 1492461807, "answer_id": 43459271, "question_id": 43456851, "link": "https://stackoverflow.com/questions/43456851/how-to-format-todays-date-in-go-as-dd-mm-yyyy/43459271#43459271", "title": "How to format todays date in go as dd-mm-yyyy?", "body": "<p>It works this way in Go Playground: <a href=\"https://play.golang.org/p/kBjTxZS9Y7\" rel=\"noreferrer\">https://play.golang.org/p/kBjTxZS9Y7</a></p>\n\n<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(time.Now().Format(\"02-01-2006\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 2152652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb76613173dd31ce6ee7748f5f43230a?s=128&d=identicon&r=PG", "display_name": "serps", "link": "https://stackoverflow.com/users/2152652/serps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10158, "favorite_count": 0, "closed_date": 1492496134, "accepted_answer_id": 43459271, "answer_count": 1, "score": 2, "last_activity_date": 1492461807, "creation_date": 1492452214, "question_id": 43456851, "link": "https://stackoverflow.com/questions/43456851/how-to-format-todays-date-in-go-as-dd-mm-yyyy", "closed_reason": "Duplicate", "title": "How to format todays date in go as dd-mm-yyyy?", "body": "<p>I am trying to format todays date in golang and seem to be struggling with something i deem to be quite simple.</p>\n\n<p>I am trying to get todays date in the format of dd-mm-yyy</p>\n\n<p>any ideas?</p>\n\n<p>thanks</p>\n"}, {"tags": ["go", "code-duplication"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492451567, "post_id": 43456418, "comment_id": 73968976, "body": "Before I post my answer, I have a question. Is the second argument to<code>db.client.GetAll</code> an <code>inteface{}</code>?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1492453315, "post_id": 43456418, "comment_id": 73969948, "body": "I&#39;m voting to close this question as off-topic because this question belongs on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1492457086, "post_id": 43456418, "comment_id": 73972042, "body": "@PaulHankin he&#39;s not asking for a general code review, he&#39;s asking a specific question about how to use the Go language. Seems legit to me for SO."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492468236, "post_id": 43456418, "comment_id": 73977257, "body": "Could you please share what package you&#39;re using that implements the <code>db.client.GetAll</code> method/func? From the looks of it, you might not need to loop over the keys at all since you&#39;re already passing a pointer to the &quot;destination&quot; value... therefore I&#39;m assuming <code>GetAll</code> fills out its second argument for you and the returned keys are just for consideration and do not have to be used necessarily... For example <code>google.golang.org&#47;appengine&#47;datastore</code>&#39;s very similar <code>*Query.GetAll</code> method works that way."}, {"owner": {"reputation": 31, "user_id": 7863592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f629975a82ea593068c9421e208cdd9?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/7863592/harry"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492517414, "post_id": 43456418, "comment_id": 73998339, "body": "@mkopriva I&#39;m using the datastore package"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1492612821, "post_id": 43456418, "comment_id": 74052068, "body": "While the accepted answers definitely answer your question, I would suggest that you organize your code into packages and not worry so much about the code duplication. My reasoning being that it&#39;s much easier to work with the data if loaded into a struct.  You don&#39;t have to write conversions (using reflect, which would lead to a performance drop), accessing and modifying the data will be easier, and lastly because you&#39;ve created a well defined struct you will know exactly what&#39;s in the object you&#39;re querying for, which means no guessing later."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1492457481, "creation_date": 1492457481, "answer_id": 43458266, "question_id": 43456418, "link": "https://stackoverflow.com/questions/43456418/golang-avoiding-code-duplication/43458266#43458266", "title": "Golang avoiding code duplication", "body": "<p>Assuming that <code>db.client.GetAll</code> takes an <code>interface{}</code> as its second argument, which it appears to, you can in fact DRY it out:</p>\n\n<pre><code>func (db *DB) dryGet(owner, table string, result interface{}) error {\n    q := db.NewQuery(table).Filter(\"Owner =\", owner).Order(\"Name\")\n    keys,err := db.client.GetAll(q, &amp;result)\n    return err\n}\n</code></pre>\n\n<p>Converting the result to a map is a little more difficult because Go lacks generics, and your structs have no methods that could be used to interface them. It's possible but would require, at the least, creating a <code>getID</code> method on each type, creating a <code>hasID</code> interface, and then returning a <code>map[int]hasID</code>, which the caller would then have to cast the values of back to the struct type to access any other fields. Not optimal, but doable. However, the above solution would at least let you eliminate a good portion of duplicate code.</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1492519510, "creation_date": 1492519510, "answer_id": 43472564, "question_id": 43456418, "link": "https://stackoverflow.com/questions/43456418/golang-avoiding-code-duplication/43472564#43472564", "title": "Golang avoiding code duplication", "body": "<p>Just to add to the accepted answer, if you're using <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference\" rel=\"nofollow noreferrer\">google.golang.org/appengine/datastore</a> you don't need to loop over the keys, unless you want to.</p>\n\n<p>From the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#Query.GetAll\" rel=\"nofollow noreferrer\">GetAll docs</a>: (emphasis mine)</p>\n\n<blockquote>\n  <p>GetAll runs the query in the given context and returns all keys that\n  match that query, <strong>as well as appending the values to dst</strong>.</p>\n</blockquote>\n\n<p>So you could simplify your two methods to something like this:</p>\n\n<pre><code>func (db *DB) ListOnes(owner string) ([]*One, error) {\n    ones = make([]*One, 0)\n    q := db.NewQuery(\"One\").\n        Filter(\"Owner =\", owner).\n        Order(\"Name\")\n\n    if _, err := db.client.GetAll(q, &amp;ones); err != nil {\n        return nil, err\n    }\n    return ones, nil\n}\n\nfunc (db *DB) ListTwos(owner string) ([]*Two, error) {\n    twos = make([]*Two, 0)\n    q := db.NewQuery(\"Two\").\n        Filter(\"Owner =\", owner).\n        Order(\"Name\")\n\n    if _, err := db.client.GetAll(q, &amp;twos); err != nil {\n        return nil, err\n    }\n    return twos, nil\n}\n</code></pre>\n\n<p>This is still quite a lot of duplication, so you could now generalize your code with an approach like in the accepted answer, e.g.:</p>\n\n<pre><code>type dbInterface interface {\n    ListByType(owner, typ string, dst interface{}) ([]*datastore.Key, error)\n}\n\nfunc (db *DB) ListByType(owner, typ string, dst interface{}) ([]*datastore.Key, error) {\n    q := db.NewQuery(typ).\n        Filter(\"Owner =\", owner).\n        Order(\"Name\")\n\n    return db.client.GetAll(q, dst)\n}\n</code></pre>\n\n<p>And you can use that implementation like this:</p>\n\n<pre><code>func main() {\n    // ignore keys if you don't need them\n    ones := []*One{}\n    if _, err := DB.ListByType(user.ID, \"One\", &amp;ones); err != nil {\n        panic(err)\n    }\n\n    // use keys if you need them\n    twos := []*Two{}\n    keys, err := DB.ListByType(user.ID, \"Two\", &amp;twos)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>And by the way, if you want to control how your types, <code>One</code> and <code>Two</code> etc., are loaded from the datastore, you could have them implement the <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference#PropertyLoadSaver\" rel=\"nofollow noreferrer\">PropertyLoadSaver</a> interface.</p>\n"}], "owner": {"reputation": 31, "user_id": 7863592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f629975a82ea593068c9421e208cdd9?s=128&d=identicon&r=PG", "display_name": "Harry", "link": "https://stackoverflow.com/users/7863592/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1087, "favorite_count": 0, "accepted_answer_id": 43458266, "answer_count": 2, "score": 2, "last_activity_date": 1492519510, "creation_date": 1492450469, "question_id": 43456418, "link": "https://stackoverflow.com/questions/43456418/golang-avoiding-code-duplication", "title": "Golang avoiding code duplication", "body": "<p>I have two structs at the moment. </p>\n\n<pre><code>type One struct {\n    Name  string\n    Age   int\n    ID    int\n    Owner string\n}\n\ntype Two struct {\n    ID    int\n    Make  string\n    Bags  string\n    Age   int\n    Owner string\n}\n</code></pre>\n\n<p>These structs map to a table in a DB, I use an interface to provide access to the DB and contents. In this case just a listing of the data in One and Two based on the owner. </p>\n\n<pre><code>type dbInterface interface {\n    ListOnesByOwner(owner string) ([]*One, error)\n    LitsTwosByOwner(owner string) ([]*Two, error)\n}\n</code></pre>\n\n<p>The listing functions are the same except for the structs. </p>\n\n<pre><code>func (db *DB) ListOnes(owner string) ([]*One, error) {\n    ones = make([]*One, 0)\n    q := db.NewQuery(\"One\").\n        Filter(\"Owner =\", owner).\n        Order(\"Name\")\n\n    keys, err := db.client.GetAll(q, &amp;ones)\n    for i, k := range keys {\n        ones[i].ID = k.ID\n    }\n    return ones, nil\n}\n\nfunc (db *DB) ListTwos(owner string) ([]*Two, error) {\n    twos = make([]*Two, 0)\n    q := db.NewQuery(\"Two\").\n        Filter(\"Owner =\", owner).\n        Order(\"Name\")\n\n    keys, err := db.client.GetAll(q, &amp;twos)\n    for i, k := range keys {\n        twos[i].ID = k.ID\n    }\n    return twos, nil\n}\n\nfunc main() {\n    ones, err := DB.ListOnesByOwner(user.ID)\n    twos, err := DB.ListTwosByOwner(user.ID)\n}\n</code></pre>\n\n<p>I'm fairly new to GO, so I'm wondering what is the idiomatic way to reduce the code duplication seen here? If I was to add a couple more structs then it would be unwieldy because the amount of code duplication needed. </p>\n\n<p>Thanks for any help! </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1492449674, "post_id": 43456135, "comment_id": 73967888, "body": "You likely have <code>GOROOT</code> files in <code>C:\\Users\\MYUSER\\go</code> caused by setting <code>GOROOT</code> at some point. Also, don&#39;t set <code>GOROOT</code> or <code>GOTOOLDIR</code> unless you intend to change them from the defaults."}, {"owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492456867, "post_id": 43456135, "comment_id": 73971920, "body": "It was the former. Get should inform with a little more detail about this case, but anyway, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "is_accepted": true, "score": 6, "last_activity_date": 1495454227, "creation_date": 1495454227, "answer_id": 44112264, "question_id": 43456135, "link": "https://stackoverflow.com/questions/43456135/go-get-path-is-a-goroot-not-a-gopath-error-even-with-env-set-up-in-windows/44112264#44112264", "title": "Go get path is a GOROOT, not a GOPATH error, even with env set up in Windows", "body": "<p>As it turns out, go get checks for the file \"src/cmd/go/alldocs.go\" to verify that the path is goroot. I opened an <a href=\"https://github.com/golang/go/issues/20057\" rel=\"noreferrer\">issue</a> about the aggressive check but it was closed in a \"won't fix\" fashion. At least it could use a different error message, but that's how it works as of today</p>\n"}], "owner": {"reputation": 81, "user_id": 4887442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24e3885d69b79d92439d53ac49b811bb?s=128&d=identicon&r=PG&f=1", "display_name": "Luis GG", "link": "https://stackoverflow.com/users/4887442/luis-gg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2334, "favorite_count": 0, "accepted_answer_id": 44112264, "answer_count": 1, "score": 2, "last_activity_date": 1495454227, "creation_date": 1492449453, "question_id": 43456135, "link": "https://stackoverflow.com/questions/43456135/go-get-path-is-a-goroot-not-a-gopath-error-even-with-env-set-up-in-windows", "title": "Go get path is a GOROOT, not a GOPATH error, even with env set up in Windows", "body": "<p>In Windows 8, whenever I try to download a package with <code>go get</code> and <code>go install</code> I get the following error:</p>\n\n<pre><code>cannot download, C:\\Users\\MYUSER\\go is a GOROOT, not a GOPATH. For more details see: 'go help gopath'\n</code></pre>\n\n<p>I had manually set up the environment variables GOPATH, GOROOT and GOTOOLDIR for both the computer and the current user to no avail</p>\n\n<p>User go env</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=C:\\Users\\MYUSER\\go\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=1\nset PKG_CONFIG=pkg-config\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\n</code></pre>\n\n<p>Administrator prompt go env</p>\n\n<pre><code>set GOARCH=amd64\nset GOBIN=\nset GOEXE=.exe\nset GOHOSTARCH=amd64\nset GOHOSTOS=windows\nset GOOS=windows\nset GOPATH=C:\\Users\\MYUSER\\go\nset GORACE=\nset GOROOT=C:\\Go\nset GOTOOLDIR=C:\\Go\\pkg\\tool\\windows_amd64\nset GCCGO=gccgo\nset CC=gcc\nset GOGCCFLAGS=-m64 -mthreads -fmessage-length=0\nset CXX=g++\nset CGO_ENABLED=1\nset PKG_CONFIG=pkg-config\nset CGO_CFLAGS=-g -O2\nset CGO_CPPFLAGS=\nset CGO_CXXFLAGS=-g -O2\nset CGO_FFLAGS=-g -O2\nset CGO_LDFLAGS=-g -O2\n</code></pre>\n\n<p>Is this a known issue with go get or I'm still doing something wrong with my setup? Thanks in advance</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492441642, "post_id": 43454043, "comment_id": 73963534, "body": "<code>map_copy</code> would just be a function containing your for loop. I&#39;m not sure what you&#39;re asking."}, {"owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492441798, "post_id": 43454043, "comment_id": 73963619, "body": "I could just write it myself. It was more directed at the performance aspect. Maybe there is some fancy go internal i don&#39;t know which handles this better than a for loop. Sorry if unclear."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492448408, "post_id": 43454043, "comment_id": 73967223, "body": "Not entirely related to this specific question, but there are a bunch of slice tricks on the wiki that expose some simple optimizations, such as append using ellipsis. Read here <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1492442344, "creation_date": 1492442344, "answer_id": 43454300, "question_id": 43454043, "link": "https://stackoverflow.com/questions/43454043/golang-copy-elements-of-object-to-slice/43454300#43454300", "title": "Golang copy elements of object to slice", "body": "<p>The only performance increase you could add is allocating the correct slice capacity ahead of time. </p>\n\n<p>You can still add values with append by starting with a 0 length slice:</p>\n\n<pre><code>tmp := make([]string, 0, len(some_object.some_field))\nfor _, value := range some_object.some_field {\n    tmp = append(tmp, do_something(value))\n}\n</code></pre>\n\n<p>Or by indexing the slices directly:</p>\n\n<pre><code>tmp := make([]string, len(some_object.some_field))\nfor i := range some_object.some_field {\n    tmp[i] = do_something(some_object.some_field[i])\n}\n</code></pre>\n"}], "owner": {"reputation": 561, "user_id": 3564720, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/KiSNg.jpg?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/3564720/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1006, "favorite_count": 1, "accepted_answer_id": 43454300, "answer_count": 1, "score": 1, "last_activity_date": 1518964449, "creation_date": 1492441488, "last_edit_date": 1518964449, "question_id": 43454043, "link": "https://stackoverflow.com/questions/43454043/golang-copy-elements-of-object-to-slice", "title": "Golang copy elements of object to slice", "body": "<p>Is there any better way to apply a function to fields of an object and then copy the result to a new slice? By better I mean having a better performance than a for loop.</p>\n\n<pre><code>var tmp []string\nfor _, value := range some_object.some_field {\n    tmp = append(tmp, do_something(value))\n}\n</code></pre>\n\n<p>Something like:</p>\n\n<pre><code>tmp := map_copy(do_something(some_object.some_field))\n</code></pre>\n\n<p>With the resulting slice being:</p>\n\n<pre><code>tmp[0] = do_something(some_object.some_value[0])\ntmp[1] = do_something(some_object.some_value[1])\ntmp[2] = do_something(some_object.some_value[2])\n....\n</code></pre>\n"}, {"tags": ["go", "terminal", "command-line-interface"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492448342, "post_id": 43453721, "comment_id": 73967190, "body": "There are different libraries to do this depending on your operating system. Which OS are you using?"}, {"owner": {"reputation": 23, "user_id": 4021739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737cfb0fc4d43289d192f999a1a19ec3?s=128&d=identicon&r=PG&f=1", "display_name": "j\u0153.", "link": "https://stackoverflow.com/users/4021739/j%c5%93"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492450462, "post_id": 43453721, "comment_id": 73968314, "body": "I&#39;d aim for Linux and Mac, no interest in Windows currently ;)"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4021739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737cfb0fc4d43289d192f999a1a19ec3?s=128&d=identicon&r=PG&f=1", "display_name": "j\u0153.", "link": "https://stackoverflow.com/users/4021739/j%c5%93"}, "edited": false, "score": 0, "creation_date": 1492454115, "post_id": 43457071, "comment_id": 73970342, "body": "Thank you for your suggestion. The libraries I listed are somewhat more go-ish replacements of ncurses. As far as I have seen ncurses UIs they also seem to be window based, meaning they occupy all the terminal screen which is not what I strive for\u2026"}, {"owner": {"reputation": 42737, "user_id": 4518274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UPurS.png?s=128&g=1", "display_name": "Thomas Dickey", "link": "https://stackoverflow.com/users/4518274/thomas-dickey"}, "edited": false, "score": 0, "creation_date": 1492469040, "post_id": 43457071, "comment_id": 73977502, "body": "ncurses does what&#39;s suggested using <code>filter</code>, but goncurses does not appear to use that, and it does not appear to be in active development. You could clone <code>goncurses</code> and add interfaces to <code>filter</code>, etc."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1492452977, "creation_date": 1492452977, "answer_id": 43457071, "question_id": 43453721, "link": "https://stackoverflow.com/questions/43453721/control-arrow-keys-in-cli-app/43457071#43457071", "title": "Control arrow keys in CLI app", "body": "<p>ncurses is one popular library for terminal control in Linux, and it has <a href=\"https://github.com/rthornton128/goncurses\" rel=\"nofollow noreferrer\">Go bindings</a> (also supports OSX and Windows). I have never used them, so I cannot vouch for them, but this is one way to accomplish what you want.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4021739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737cfb0fc4d43289d192f999a1a19ec3?s=128&d=identicon&r=PG&f=1", "display_name": "j\u0153.", "link": "https://stackoverflow.com/users/4021739/j%c5%93"}, "is_accepted": true, "score": 0, "last_activity_date": 1493141018, "creation_date": 1493141018, "answer_id": 43617208, "question_id": 43453721, "link": "https://stackoverflow.com/questions/43453721/control-arrow-keys-in-cli-app/43617208#43617208", "title": "Control arrow keys in CLI app", "body": "<p>Answering my own question: <a href=\"https://github.com/paulrademacher/climenu\" rel=\"nofollow noreferrer\">This neat library called <strong>climenu</strong></a> practically does what I asked for. All the technical trickery needed is part of this code. Kudos to \n <a href=\"https://github.com/paulrademacher\" rel=\"nofollow noreferrer\">Paul Rademacher</a>! I surely can adapt this to suit my needs.</p>\n"}], "owner": {"reputation": 23, "user_id": 4021739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/737cfb0fc4d43289d192f999a1a19ec3?s=128&d=identicon&r=PG&f=1", "display_name": "j\u0153.", "link": "https://stackoverflow.com/users/4021739/j%c5%93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "accepted_answer_id": 43617208, "answer_count": 2, "score": -1, "last_activity_date": 1493141018, "creation_date": 1492440431, "question_id": 43453721, "link": "https://stackoverflow.com/questions/43453721/control-arrow-keys-in-cli-app", "title": "Control arrow keys in CLI app", "body": "<p>I would like to build a (golang) library that offers a number of options for user choice. My idea is to print the names of the options and highlight one as \"active\". Upon arrow keys (left and right or up and down) being pressed I would like to update the \"selected\" answer internally and visibly.</p>\n\n<p>I know about <code>termbox</code> and <a href=\"https://github.com/gdamore/tcell\" rel=\"nofollow noreferrer\"><code>tcell</code></a> and I also have checked projects like <code>peco</code>  and <a href=\"https://github.com/ericfreese/rat\" rel=\"nofollow noreferrer\"><code>rat</code></a>. All of them seem to build on the basic concept of a screen of some kind. Ideally I would like to keep the control in just the line the user is editing in his terminal without creating a fullscreen interaction. Is there any way to achieve this?</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 0, "creation_date": 1492441201, "post_id": 43453326, "comment_id": 73963264, "body": "Please read <a href=\"https://meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 2466, "user_id": 3751420, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MeAcM.jpg?s=128&g=1", "display_name": "Steve Lovell", "link": "https://stackoverflow.com/users/3751420/steve-lovell"}, "edited": false, "score": 0, "creation_date": 1492442382, "post_id": 43453326, "comment_id": 73963983, "body": "If this is a direct copy &amp; paste of your code, you have a typo. You are referring to a table as both <code>salory</code> and <code>sallory</code>. There may be other issues too, but that one jumped out at me."}, {"owner": {"reputation": 1, "user_id": 7858085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P9Htp1XOO2Y/AAAAAAAAAAI/AAAAAAAAABA/hRVaj-vXxis/photo.jpg?sz=128", "display_name": "Avinash Wellborn Soft", "link": "https://stackoverflow.com/users/7858085/avinash-wellborn-soft"}, "edited": false, "score": 0, "creation_date": 1492442972, "post_id": 43453326, "comment_id": 73964326, "body": "no this is not the problem  U know Golang beego framework ?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492448443, "post_id": 43453326, "comment_id": 73967244, "body": "Use gofmt. You have some very poorly formatted Go code.  (extra commas, semicolons, bad indentation, etc)."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492448644, "post_id": 43453326, "comment_id": 73967350, "body": "To address your question: The concept of a left join is foreign to Beego. Left joins (and any other SQL) are only relevant to the SQL server you&#39;re using. Beego just consumes the data that&#39;s passed to it. Get your query working, and Beego will follow suit."}], "owner": {"reputation": 1, "user_id": 7858085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-P9Htp1XOO2Y/AAAAAAAAAAI/AAAAAAAAABA/hRVaj-vXxis/photo.jpg?sz=128", "display_name": "Avinash Wellborn Soft", "link": "https://stackoverflow.com/users/7858085/avinash-wellborn-soft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492442913, "creation_date": 1492438886, "last_edit_date": 1492442913, "question_id": 43453326, "link": "https://stackoverflow.com/questions/43453326/how-to-fetch-data-using-left-join-when-using-beedo-raw-sql-to-query", "title": "How to fetch data using Left Join when using Beedo Raw SQL to query?", "body": "<p>I am getting an error with the below code, it is not fetching any row:</p>\n\n<pre><code>type User struct {\n\n    Id       int\n    Username string\n    Name     string\n    Age      int\n}\n\ntype Salory struct {\n\n    Id        int\n    Username  string \n    Salory    string\n    Reamrk    string\n}\n\nvar detail []*models.Salory \n\nif num, err := orm.NewOrm().Raw(\"SELECT salory.id, salory.salory, salory.reamrk, salory.username, user.username, user.name FROM salory LEFT JOIN user ON salory.username = user.username ORDER BY id ASC\",).QueryRows(&amp;detail); \nerr == nil {\n      fmt.Printf(\"%d Total rows read\\n\", num)\n\n        for _, post := range detail {\n\n            fmt.Printf(\"Id: %d, UserName: %d, Name: %s\\n\", post.Id, post.Salory.Username, post.Remark)\n            }\n\n\n    }\n</code></pre>\n\n<p>I want to know the concept of Left Join in Beego Using Raw SQL to query</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10017, "user_id": 301107, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c87e8db57897b08332340b2c4b508ff?s=128&d=identicon&r=PG", "display_name": "masnun", "link": "https://stackoverflow.com/users/301107/masnun"}, "edited": false, "score": 0, "creation_date": 1492430116, "post_id": 43450813, "comment_id": 73957437, "body": "Doesn&#39;t <code>Sprintf</code> return a string and thus is not affected by the issue?"}, {"owner": {"reputation": 7587, "user_id": 79389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d3c88e6303e7947f1b73e069038eb6?s=128&d=identicon&r=PG", "display_name": "Shaun Bouckaert", "link": "https://stackoverflow.com/users/79389/shaun-bouckaert"}, "reply_to_user": {"reputation": 10017, "user_id": 301107, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c87e8db57897b08332340b2c4b508ff?s=128&d=identicon&r=PG", "display_name": "masnun", "link": "https://stackoverflow.com/users/301107/masnun"}, "edited": false, "score": 0, "creation_date": 1492430181, "post_id": 43450813, "comment_id": 73957466, "body": "Sprint also returns a string"}, {"owner": {"reputation": 10017, "user_id": 301107, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c87e8db57897b08332340b2c4b508ff?s=128&d=identicon&r=PG", "display_name": "masnun", "link": "https://stackoverflow.com/users/301107/masnun"}, "edited": false, "score": 0, "creation_date": 1492430251, "post_id": 43450813, "comment_id": 73957503, "body": "Yes, right. My bad."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1492441786, "post_id": 43450813, "comment_id": 73963613, "body": "Check out these questions+answers for examples when the same issue arises, and type conversion solves it (explanation is in the answers): <a href=\"http://stackoverflow.com/questions/43176625/call-json-unmarshal-inside-unmarshaljson-function-without-causing-stack-overflow/43178272#43178272\">Call json.Unmarshal inside UnmarshalJSON function without causing stack overflow</a>; and <a href=\"http://stackoverflow.com/questions/43065856/the-difference-between-t-and-t/43065979#43065979\">The difference between t and *t</a>."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 3, "last_activity_date": 1586235756, "last_edit_date": 1586235756, "creation_date": 1492430535, "answer_id": 43451092, "question_id": 43450813, "link": "https://stackoverflow.com/questions/43450813/go-tour-exercise-errors-using-sprintf-with-f-to-avoid-infinite-recursion/43451092#43451092", "title": "Go Tour Exercise: Errors: using Sprintf with %f to avoid infinite recursion", "body": "<p>That infinite loop case applies only to <code>v</code>, <code>s</code>, <code>x</code>, <code>X</code>, and <code>q</code>.</p>\n\n<p>See here: <a href=\"https://github.com/golang/go/blob/6f51082da77a1d4cafd5b7af0db69293943f4066/src/fmt/print.go#L615\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/6f51082da77a1d4cafd5b7af0db69293943f4066/src/fmt/print.go#L615</a></p>\n"}], "owner": {"reputation": 7587, "user_id": 79389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32d3c88e6303e7947f1b73e069038eb6?s=128&d=identicon&r=PG", "display_name": "Shaun Bouckaert", "link": "https://stackoverflow.com/users/79389/shaun-bouckaert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1007, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586235756, "creation_date": 1492429403, "last_edit_date": 1495540007, "question_id": 43450813, "link": "https://stackoverflow.com/questions/43450813/go-tour-exercise-errors-using-sprintf-with-f-to-avoid-infinite-recursion", "title": "Go Tour Exercise: Errors: using Sprintf with %f to avoid infinite recursion", "body": "<p>I'm working through the Go tour and in the Errors exercise it mentions that calling Sprint(f) in your Error function will result in an issue, which is an infinite loop. Why this occurs is explained here: <a href=\"https://stackoverflow.com/questions/27474907/error-infinite-loop\">Error, infinite loop</a></p>\n\n<p>In my first implementation though I used Sprintf with the %f verb:</p>\n\n<pre><code>func (e ErrNegativeSqrt) Error() string {\n    return fmt.Sprintf(\"cannot Sqrt negative number: %f\", e)\n}\n</code></pre>\n\n<p>This seems to avoid the issue and I was wondering if this is because the %f verb is expecting a float so it forces it to treat e as a float? The tour mentioned that <a href=\"https://tour.golang.org/basics/13\" rel=\"nofollow noreferrer\">assignment requires explicit conversion</a>, however I assume that doesn't effect this case?</p>\n\n<p>Or am I completely off the mark and something else is going on here?</p>\n"}, {"tags": ["sockets", "go", "udp", "buffer"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1492429256, "post_id": 43450463, "comment_id": 73956992, "body": "Have you considered consulting the documentation? Surely there is a <code>GetWriteBuffer()</code> method?"}, {"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1492429518, "post_id": 43450463, "comment_id": 73957131, "body": "I have look through golang package about net package ,  but I have  not see   GetWriteBuffer() method ."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "edited": false, "score": 0, "creation_date": 1492433126, "post_id": 43451712, "comment_id": 73958865, "body": "yes,  I use it and  no error output,  and have any method to get the  value of send buffer  after setting the udp buffer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1492433152, "last_edit_date": 1492433152, "creation_date": 1492432876, "answer_id": 43451712, "question_id": 43450463, "link": "https://stackoverflow.com/questions/43450463/golang-get-udp-socket-buffer-size/43451712#43451712", "title": "golang get udp socket buffer size", "body": "<p>Check the error value returned by <code>SetWriteBuffer</code>. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    addr, err := net.ResolveUDPAddr(\"udp\", \":8089\")\n    conn, err := net.DialUDP(\"udp\", nil, addr)\n\n    err = conn.SetWriteBuffer(64 * 1024 * 1024)\n    if err != nil {\n        log.Print(err)\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "edited": false, "score": 0, "creation_date": 1492565717, "post_id": 43472818, "comment_id": 74025277, "body": "it works well ,  very thanks,  and  the get value is double   of set buffer value"}], "tags": [], "owner": {"reputation": 46, "user_id": 7782902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TcEBOnHoNvo/AAAAAAAAAAI/AAAAAAAAANc/2U9TW-kQSsM/photo.jpg?sz=128", "display_name": "Joshua Wales", "link": "https://stackoverflow.com/users/7782902/joshua-wales"}, "is_accepted": true, "score": 3, "last_activity_date": 1492520149, "creation_date": 1492520149, "answer_id": 43472818, "question_id": 43450463, "link": "https://stackoverflow.com/questions/43450463/golang-get-udp-socket-buffer-size/43472818#43472818", "title": "golang get udp socket buffer size", "body": "<p>After looking at the net package code, it looks like SetWriteBuffer makes a syscall to setsockopt (for posix). There is no similar function for GetWriteBuffer. The only way i can think to do this is by making another syscall to getsockopt like so.</p>\n\n<pre><code>addr, _ := net.ResolveUDPAddr(\"udp\", \":8089\")\nconn, _ := net.DialUDP(\"udp\", nil, addr)\nconn.SetWriteBuffer(10 * 1024)\nfd, _ := conn.File()\nvalue, _ := syscall.GetsockoptInt(int(fd.Fd()), syscall.SOL_SOCKET, syscall.SO_SNDBUF)\nlog.Println(value)\nfd.Close()\nconn.Close()\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2946, "favorite_count": 2, "accepted_answer_id": 43472818, "answer_count": 2, "score": 1, "last_activity_date": 1492520149, "creation_date": 1492428131, "question_id": 43450463, "link": "https://stackoverflow.com/questions/43450463/golang-get-udp-socket-buffer-size", "title": "golang get udp socket buffer size", "body": "<p>I'm writing a udp client and set udp socket send buffer by SetWriteBuffer. </p>\n\n<pre><code>   addr, _ := net.ResolveUDPAddr(\"udp\", \":8089\")\n   conn, err :=net.DialUDP(\"udp\", nil, addr)  \n   err =conn.SetWriteBuffer(64*1024*1024)\n</code></pre>\n\n<p>as above, how can I test set the value is effective or get the send buffer value after  call SetWriteBuffer function.<br>\nThank you all.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 3, "creation_date": 1492426991, "post_id": 43450113, "comment_id": 73955886, "body": "The <code>Scan*</code> functions of <code>bufio</code> are not meant to be invoked directly. They are instead designed for use as arguments to <a href=\"https://godoc.org/bufio#Scanner.Split\" rel=\"nofollow noreferrer\"><code>bufio.Scanner.Split</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 16, "last_activity_date": 1522485351, "last_edit_date": 1522485351, "creation_date": 1492429231, "answer_id": 43450779, "question_id": 43450113, "link": "https://stackoverflow.com/questions/43450113/how-to-use-bufio-scanwords/43450779#43450779", "title": "How to use bufio.ScanWords", "body": "<p>To count words:</p>\n\n<pre><code>input := \"Spicy jalapeno pastrami ut ham turducken.\\n Lorem sed ullamco, leberkas sint short loin strip steak ut shoulder shankle porchetta venison prosciutto turducken swine.\\n Deserunt kevin frankfurter tongue aliqua incididunt tri-tip shank nostrud.\\n\"\nscanner := bufio.NewScanner(strings.NewReader(input))\n// Set the split function for the scanning operation.\nscanner.Split(bufio.ScanWords)\n// Count the words.\ncount := 0\nfor scanner.Scan() {\n    count++\n}\nif err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, \"reading input:\", err)\n}\nfmt.Printf(\"%d\\n\", count)\n</code></pre>\n\n<p>To count lines:</p>\n\n<pre><code>input := \"Spicy jalapeno pastrami ut ham turducken.\\n Lorem sed ullamco, leberkas sint short loin strip steak ut shoulder shankle porchetta venison prosciutto turducken swine.\\n Deserunt kevin frankfurter tongue aliqua incididunt tri-tip shank nostrud.\\n\"\n\nscanner := bufio.NewScanner(strings.NewReader(input))\n// Set the split function for the scanning operation.\nscanner.Split(bufio.ScanLines)\n// Count the words.\ncount := 0\nfor scanner.Scan() {\n    count++\n}\nif err := scanner.Err(); err != nil {\n    fmt.Fprintln(os.Stderr, \"reading input:\", err)\n}\nfmt.Printf(\"%d\\n\", count)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 7202914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n1KJb.jpg?s=128&g=1", "display_name": "replper", "link": "https://stackoverflow.com/users/7202914/replper"}, "is_accepted": false, "score": 1, "last_activity_date": 1586484894, "creation_date": 1586484894, "answer_id": 61133051, "question_id": 43450113, "link": "https://stackoverflow.com/questions/43450113/how-to-use-bufio-scanwords/61133051#61133051", "title": "How to use bufio.ScanWords", "body": "<p>This is an exercise in book <em>The Go Programming Language</em> Exercise 7.1</p>\n\n<p>This is my solution:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n)\n\n// WordCounter count words\ntype WordCounter int\n\n// LineCounter count Lines\ntype LineCounter int\n\ntype scanFunc func(p []byte, EOF bool) (advance int, token []byte, err error)\n\nfunc scanBytes(p []byte, fn scanFunc) (cnt int) {\n    for true {\n        advance, token, _ := fn(p, true)\n        if len(token) == 0 {\n            break\n        }\n        p = p[advance:]\n        cnt++\n    }\n    return cnt\n}\n\nfunc (c *WordCounter) Write(p []byte) (int, error) {\n    cnt := scanBytes(p, bufio.ScanWords)\n    *c += WordCounter(cnt)\n    return cnt, nil\n}\n\nfunc (c WordCounter) String() string {\n    return fmt.Sprintf(\"contains %d words\", c)\n}\n\nfunc (c *LineCounter) Write(p []byte) (int, error) {\n    cnt := scanBytes(p, bufio.ScanLines)\n    *c += LineCounter(cnt)\n    return cnt, nil\n}\n\nfunc (c LineCounter) String() string {\n    return fmt.Sprintf(\"contains %d lines\", c)\n}\n\nfunc main() {\n    var c WordCounter\n    fmt.Println(c)\n\n    fmt.Fprintf(&amp;c, \"This is an sentence.\")\n    fmt.Println(c)\n\n    c = 0\n    fmt.Fprintf(&amp;c, \"This\")\n    fmt.Println(c)\n\n    var l LineCounter\n    fmt.Println(l)\n\n    fmt.Fprintf(&amp;l, `This is another\nline`)\n    fmt.Println(l)\n\n    l = 0\n    fmt.Fprintf(&amp;l, \"This is another\\nline\")\n    fmt.Println(l)\n\n    fmt.Fprintf(&amp;l, \"This is one line\")\n    fmt.Println(l)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2569, "user_id": 1463746, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a9b21e1124471dbf419e00499cebc82d?s=128&d=identicon&r=PG&f=1", "display_name": "Nagri", "link": "https://stackoverflow.com/users/1463746/nagri"}, "is_accepted": false, "score": 2, "last_activity_date": 1586509850, "creation_date": 1586509850, "answer_id": 61137191, "question_id": 43450113, "link": "https://stackoverflow.com/questions/43450113/how-to-use-bufio-scanwords/61137191#61137191", "title": "How to use bufio.ScanWords", "body": "<p>This is an exercise in book The Go Programming Language Exercise 7.1</p>\n\n<p>This is an extension of <a href=\"https://stackoverflow.com/users/7202914/replper\">@repler</a> solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\ntype byteCounter int\ntype wordCounter int\ntype lineCounter int\n\nfunc main() {\n    var c byteCounter\n    c.Write([]byte(\"Hello This is a line\"))\n    fmt.Println(\"Byte Counter \", c)\n\n    var w wordCounter\n    w.Write([]byte(\"Hello This is a line\"))\n    fmt.Println(\"Word Counter \", w)\n\n    var l lineCounter\n    l.Write([]byte(\"Hello \\nThis \\n is \\na line\\n.\\n.\\n\"))\n    fmt.Println(\"Length \", l)\n\n}\n\nfunc (c *byteCounter) Write(p []byte) (int, error) {\n    *c += byteCounter(len(p))\n    return len(p), nil\n}\n\nfunc (w *wordCounter) Write(p []byte) (int, error) {\n    count := retCount(p, bufio.ScanWords)\n    *w += wordCounter(count)\n    return count, nil\n}\n\nfunc (l *lineCounter) Write(p []byte) (int, error) {\n    count := retCount(p, bufio.ScanLines)\n    *l += lineCounter(count)\n    return count, nil\n}\n\nfunc retCount(p []byte, fn bufio.SplitFunc) (count int) {\n    s := string(p)\n    scanner := bufio.NewScanner(strings.NewReader(s))\n    scanner.Split(fn)\n    count = 0\n    for scanner.Scan() {\n        count++\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading input:\", err)\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 2782, "user_id": 3235127, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9GaKP.jpg?s=128&g=1", "display_name": "zianwar", "link": "https://stackoverflow.com/users/3235127/zianwar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2639, "favorite_count": 3, "accepted_answer_id": 43450779, "answer_count": 3, "score": 9, "last_activity_date": 1586509850, "creation_date": 1492426673, "last_edit_date": 1524585498, "question_id": 43450113, "link": "https://stackoverflow.com/questions/43450113/how-to-use-bufio-scanwords", "title": "How to use bufio.ScanWords", "body": "<p>How do I use <code>bufio.ScanWords</code> and <code>bufio.ScanLines</code> functions to count words and lines?</p>\n\n<p>I tried:</p>\n\n<pre><code>fmt.Println(bufio.ScanWords([]byte(\"Good day everyone\"), false))\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>5 [103 111 111 100] &lt;nil&gt;\n</code></pre>\n\n<p>Not sure what that means?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1492424741, "post_id": 43449577, "comment_id": 73954806, "body": "Change your method receiver types from <code>Node</code> to <code>*Node</code>."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1492453400, "post_id": 43449577, "comment_id": 73969989, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/6476343/in-go-using-a-setter-for-a-struct-type-does-not-work-as-anticipated\">In Go, using a setter for a struct type does not work as anticipated</a>"}], "owner": {"reputation": 11, "user_id": 6307379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--6rocoCrhgg/AAAAAAAAAAI/AAAAAAAAAIw/4VwjeCLE7Pw/photo.jpg?sz=128", "display_name": "Amie Nel", "link": "https://stackoverflow.com/users/6307379/amie-nel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492424443, "creation_date": 1492424443, "question_id": 43449577, "link": "https://stackoverflow.com/questions/43449577/golang-program-does-not-execute-as-expected", "title": "golang program does not execute as expected", "body": "<p>I am working trough a course \"Mastering Go Programming\" by \"Mina Andrawos\". The following adapted code does not execute as expected:</p>\n\n<p><strong>a) main.go -</strong>\n    package main</p>\n\n<pre><code>import (\n \"fmt\"\n \"interfaces/linklist\"\n)\n\nfunc main() {\n    node := linklist.NewNode()\n    node.SetValue(1)\n    fmt.Println(\"Get Value: \", node.GetValue())\n}\n</code></pre>\n\n<p><strong>b) linklist.go -</strong>\n    package linklist</p>\n\n<pre><code>// Node struct\ntype Node struct {\n    next  *Node\n    value int\n}\n\n// SetValue function\nfunc (sNode Node) SetValue(v int) {\n\n    sNode.value = v\n}\n\n// GetValue function\nfunc (sNode Node) GetValue() int {\n\n    return sNode.value\n}\n\n// NewNode constructor\nfunc NewNode() Node {\n\n    return Node{}\n}\n</code></pre>\n\n<p><strong>Problem:</strong>\nThe code \"sNode.value = v\" in \"linklist.go\" is never executed. The program outputs \"0\" instead of \"1\". In debug mode the \"sNode.value = v\" code is skipped when \"node.SetValue(1)\" is executed in the main function.</p>\n\n<p>What must be done so that the program prints \"Get Value: 1\"?</p>\n\n<p><strong>Environment</strong>:</p>\n\n<ul>\n<li>OS: Ubuntu 16.04/64bit</li>\n<li>GO Version: 1.8.1</li>\n<li>Command to execute the program: go run main.go</li>\n</ul>\n"}, {"tags": ["optimization", "go", "code-generation"], "comments": [{"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1492417984, "post_id": 43447681, "comment_id": 73951595, "body": "Assembly / IR is lossy - several different AST representations might finally compile down into the same ASM. For transpiling you&#39;d normally want to carry the intention of the code. This in itself is difficult, Go might transpile clumsily to JavaScript, it&#39;s unlikely to output generic code too if you the target was &quot;idiomatic&quot; Rust/C++. This might give you some inspiration: <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">github.com/gopherjs/gopherjs</a>"}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1492418243, "post_id": 43447681, "comment_id": 73951707, "body": "@MartinGallagher, I believe there are some fundamental optimizations like constant folding, expression strength reduction, etc. API that would be perfect expects a list of selected optimizations and applies them. Then I could select &quot;inlining&quot; and sign that &quot;I know that it will change the result call stack shape&quot;."}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1492419894, "post_id": 43447681, "comment_id": 73952389, "body": "@MartinGallagher btw, thanks for the link and feedback. Do you think that implementing simple optimizations for each Go transcompiler is wasteful or is it unavoidable in some sense? I&#39;m afraid my competence here is pretty limited, advices are welcome."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1492421648, "post_id": 43447681, "comment_id": 73953282, "body": "I think you&#39;re correct, straight forward, language agnostic / generic optimisations could be possible (this might be relevant: <a href=\"https://github.com/dominikh/go-tools/blob/master/simple/lint.go\" rel=\"nofollow noreferrer\">github.com/dominikh/go-tools/blob/master/simple/lint.go</a>). Still it&#39;s a challenge; (<a href=\"http://stackoverflow.com/questions/5180914/llvm-ir-back-to-human-readable-source-language\" title=\"llvm ir back to human readable source language\">stackoverflow.com/questions/5180914/&hellip;</a>) - it&#39;s not even trivial for LLVM IR to reverse to different targets."}], "owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 2, "answer_count": 0, "score": 0, "last_activity_date": 1492437815, "creation_date": 1492416629, "last_edit_date": 1492437815, "question_id": 43447681, "link": "https://stackoverflow.com/questions/43447681/how-to-run-optimizations-on-type-checked-ast", "title": "How to run optimizations on type checked ast?", "body": "<p>There are packages to scan/parse/typecheck Go code,\nbut what about optimizations? </p>\n\n<p>Suppose we have a program that translates Go to the other target language.\nIf we do it only based on the AST, we will miss all optimizations (unless we apply them by hand). Target environment can have really bad or no optimizer at all, and of course even if it has one, it could not be able to optimize transcompiled code well. </p>\n\n<p>Simply put: <em>what are our options?</em></p>\n\n<p>Maybe there is some way to compile Go to its assembler with optimizations and then (either of 2):\n<strong>a)</strong> translate assembler back to Go and traverse AST as usual? <br>\n<strong>b)</strong> read assembler into some kind of IR structure and use that to emit code?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 9, "last_activity_date": 1574069840, "last_edit_date": 1574069840, "creation_date": 1492421193, "answer_id": 43448702, "question_id": 43447405, "link": "https://stackoverflow.com/questions/43447405/change-http-client-transport/43448702#43448702", "title": "Change *http.Client transport", "body": "<p>The <code>http.Client</code> has a <code>Transport</code> field that you could use to \"change the authentication header on a client basis\" if that's what you want. The <code>Transport</code> field has type <code>http.RoundTripper</code> which is a one method interface, so all you need to do is to define your transport with an implementation of the <code>RoundTrip</code> method.</p>\n\n<pre><code>type MyTransport struct {\n    apiKey string\n    // keep a reference to the client's original transport\n    rt http.RoundTripper\n}\n\nfunc (t *MyTransport) RoundTrip(r *http.Request) (*http.Response, error) {\n    // set your auth headers here\n    r.Header.Set(\"Auth\", t.apiKey)\n    return t.rt.RoundTrip(r)\n}\n</code></pre>\n\n<p>Now you can use an instance of this type to set the <code>Transport</code> field on an <code>http.Client</code>.</p>\n\n<pre><code>var client *http.Client = // get client from somewhere...\n// set the transport to your type\nclient.Transport = &amp;MyTransport{apiKey: \"secret\", tr: client.Transport}\n</code></pre>\n\n<p>Depending on how and where from you got the client, it's possible that its <code>Transport</code> field is not yet set, so it might be a good idea to ensure that your type uses the default transport in such a case.</p>\n\n<pre><code>func (t *MyTransport) transport() http.RoundTripper {\n    if t.rt != nil {\n        return t.rt\n    }\n    return http.DefaultTransport\n}\n\n// update your method accordingly\nfunc (t *MyTransport) RoundTrip(r *http.Request) (*http.Response, error) {\n    // set your auth headers here\n    r.Header.Set(\"Auth\", t.apiKey)\n    return t.transport().RoundTrip(r)\n}\n</code></pre>\n\n<p>It might be worth noting that the <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"noreferrer\">Go documentation</a> recommends not to modify the <code>*http.Request</code> inside the <code>RoundTrip</code> method, so what you can do, and what the <a href=\"https://github.com/google/go-github\" rel=\"noreferrer\">go-github</a> package you linked to is doing, is to create a copy of the request, set the auth headers on it, and pass that to the underlying <code>Transport</code>. See here: <a href=\"https://github.com/google/go-github/blob/d23570d44313ca73dbcaadec71fc43eca4d29f8b/github/github.go#L841-L875\" rel=\"noreferrer\">https://github.com/google/go-github/blob/d23570d44313ca73dbcaadec71fc43eca4d29f8b/github/github.go#L841-L875</a></p>\n"}], "owner": {"reputation": 347, "user_id": 2643546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2674188147a5491ce22ad0a25ca7f402?s=128&d=identicon&r=PG", "display_name": "Deniz Saner", "link": "https://stackoverflow.com/users/2643546/deniz-saner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4023, "favorite_count": 1, "accepted_answer_id": 43448702, "answer_count": 1, "score": 4, "last_activity_date": 1574069840, "creation_date": 1492415323, "last_edit_date": 1492451060, "question_id": 43447405, "link": "https://stackoverflow.com/questions/43447405/change-http-client-transport", "title": "Change *http.Client transport", "body": "<h1>The Status Quo</h1>\n\n<p>Having picked a side project (building a wrapper around a third party API), I'm stuck. I am using <a href=\"https://github.com/dghubble/sling\" rel=\"nofollow noreferrer\">sling</a> to compose my HTTP requests.</p>\n\n<p>So parts of the Client are composed as follows:</p>\n\n<pre><code>type Client struct {\n    // some services etc..\n    sling *sling.Sling &lt;-- this is initialized with *http.Client\n}\n\nfunc NewClient(httpClient *http.Client) *Client {\n    sling := sling.New().Client(httpClient).Base(BaseURL)\n}\n\n//....\n</code></pre>\n\n<h1>Things I can't wrap my head around</h1>\n\n<p>I am following the same principle as <a href=\"https://github.com/google/go-github\" rel=\"nofollow noreferrer\">go-github</a> and <a href=\"https://github.com/dghubble/go-twitter\" rel=\"nofollow noreferrer\">go-twitter</a> that authentication should not be handled by my library, but rather by golangs oauth1/2 package. </p>\n\n<p>As the the API provides application and user level authentication and some of the workflows require initial application level authentication and then user level authentication, my question is, if there is any way to change the <code>*http.Transport</code> in order to change the authentication header on a client basis.</p>\n\n<p>So far, I haven't found a way to do so.</p>\n"}, {"tags": ["go", "println", "gofmt"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1492403655, "post_id": 43445176, "comment_id": 73946726, "body": "What do you mean by &#39;export&#39;? Please show us a full example of what you are trying to achieve and where it fails."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2176127"}, "edited": false, "score": 0, "creation_date": 1492403715, "post_id": 43445176, "comment_id": 73946743, "body": "1) There&#39;s a missing semicolon"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2176127"}, "edited": false, "score": 0, "creation_date": 1492403727, "post_id": 43445176, "comment_id": 73946747, "body": "2) Println doesn&#39;t format, that&#39;s what Printf and family are for."}, {"owner": {"reputation": 681, "user_id": 7242227, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1589333751327228/picture?type=large", "display_name": "Junya Kono", "link": "https://stackoverflow.com/users/7242227/junya-kono"}, "edited": false, "score": 0, "creation_date": 1492427834, "post_id": 43445176, "comment_id": 73956304, "body": "Sorry, &#39;export&#39; is typo."}], "answers": [{"tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 1, "last_activity_date": 1492404736, "creation_date": 1492404736, "answer_id": 43445328, "question_id": 43445176, "link": "https://stackoverflow.com/questions/43445176/how-to-expand-variables-with-fmt-println/43445328#43445328", "title": "How to expand variables with fmt.Println()", "body": "<p>As the <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\">documentation for <code>fmt.Println</code></a> states, this function does not support format specifiers. Use <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf</code></a> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1492404739, "creation_date": 1492404739, "answer_id": 43445329, "question_id": 43445176, "link": "https://stackoverflow.com/questions/43445176/how-to-expand-variables-with-fmt-println/43445329#43445329", "title": "How to expand variables with fmt.Println()", "body": "<p>Use <code>Printf</code> not <code>Println</code>. Use <code>%d</code> for <code>old</code> which is type <code>int</code>. Add a newline.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    old := 20\n    fmt.Printf(\"I'm %d years old.\\n\", old)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>I'm 20 years old.\n</code></pre>\n"}], "owner": {"reputation": 681, "user_id": 7242227, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1589333751327228/picture?type=large", "display_name": "Junya Kono", "link": "https://stackoverflow.com/users/7242227/junya-kono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 1, "accepted_answer_id": 43445329, "answer_count": 2, "score": 1, "last_activity_date": 1492427740, "creation_date": 1492403500, "last_edit_date": 1492427740, "question_id": 43445176, "link": "https://stackoverflow.com/questions/43445176/how-to-expand-variables-with-fmt-println", "title": "How to expand variables with fmt.Println()", "body": "<p>I can't expand variables with fmt.Println().</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main(){\n  old := 20\n  fmt.Println(\"I'm %g years old.\",old)\n}\n</code></pre>\n\n<p>result =></p>\n\n<pre><code>I'm %g years old.\n20\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1492395591, "post_id": 43444285, "comment_id": 73945140, "body": "So my questions goes to why almost all the applications want to use the lowercase? is it a rule or something?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 1, "creation_date": 1492397282, "post_id": 43444285, "comment_id": 73945470, "body": "@fluter There&#39;s no rule that JSON use lowercase field names, but it seems to be common practice."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1492398276, "post_id": 43444285, "comment_id": 73945663, "body": "@fluter because the rest of the world does, and interoperability is nice :)"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1492397651, "last_edit_date": 1492397651, "creation_date": 1492395464, "answer_id": 43444285, "question_id": 43444248, "link": "https://stackoverflow.com/questions/43444248/why-is-the-format-string-of-struct-field-always-lower-case/43444285#43444285", "title": "Why is the format string of struct field always lower case", "body": "<p>The <a href=\"https://godoc.org/encoding/json#Marshal\" rel=\"nofollow noreferrer\">encoding/json documentation</a> says: </p>\n\n<blockquote>\n  <p>The encoding of each struct field can be customized by the format string stored under the \"json\" key in the struct field's tag. The format string gives the name of the field, possibly followed by a comma-separated list of options. The name may be empty in order to specify options without overriding the default field name.</p>\n</blockquote>\n\n<p>Applications specify a lowercase name in the tag to produce a lowercase name in the JSON. </p>\n\n<p>This struct </p>\n\n<pre><code>type Example struct {\n  Name1 string\n  Name2 string `json:\"name1\"`\n}\n</code></pre>\n\n<p>encodes as:</p>\n\n<pre><code>{\n  \"Name1\": \"1\",\n  \"name1\": \"2\"\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/j58hZVduUr\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>JSON only requires that field names be valid strings. Lowercase names are not required in JSON. That said, it is very common practice to start field names with a lowercase letter in JSON.</p>\n"}, {"comments": [{"owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1492396657, "post_id": 43444381, "comment_id": 73945354, "body": "as my understanding, json does not have private, all fields are public, nomatter in lower or upper case."}, {"owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "reply_to_user": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "edited": false, "score": 0, "creation_date": 1492396994, "post_id": 43444381, "comment_id": 73945413, "body": "yes, I just add explanation if lower case using on variable. but for json output using lowercase maybe for manage consistency and usually json using lower case key.  take a look <a href=\"http://json.org/example.html\" rel=\"nofollow noreferrer\">json.org/example.html</a>, all key using lowecase but value can be mix case."}], "tags": [], "owner": {"reputation": 522, "user_id": 1391008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03f3a6314e7ed2bd34b7200d48742d2?s=128&d=identicon&r=PG", "display_name": "Moch Lutfi", "link": "https://stackoverflow.com/users/1391008/moch-lutfi"}, "is_accepted": false, "score": 1, "last_activity_date": 1492396532, "creation_date": 1492396532, "answer_id": 43444381, "question_id": 43444248, "link": "https://stackoverflow.com/questions/43444248/why-is-the-format-string-of-struct-field-always-lower-case/43444381#43444381", "title": "Why is the format string of struct field always lower case", "body": "<pre><code>Name string `json:\"name\" db:\"SomeName\"`\n</code></pre>\n\n<p>Keep in mind, string <code>json:\"name\" db:\"Name\"</code> used to adjust de/serialization, can be in json or database.</p>\n\n<p>for naming it depends on output. if database field is <code>SomeName</code> so you must define db <code>SomeName</code>.</p>\n\n<blockquote>\n  <p>So my questions goes to why almost all the applications want to use the lowercase?</p>\n</blockquote>\n\n<p>if you encounter source code which using ouput json using only lowercase, this obviously to keep consistency output.</p>\n\n<p>if lower case on variable give different effect too, for lower case act as <code>private</code> variable and upper case act as <code>public</code> variable so can be accessed through package.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1492425113, "creation_date": 1492425113, "answer_id": 43449751, "question_id": 43444248, "link": "https://stackoverflow.com/questions/43444248/why-is-the-format-string-of-struct-field-always-lower-case/43449751#43449751", "title": "Why is the format string of struct field always lower case", "body": "<blockquote>\n  <p>When encoding/decoding structs with json, almost all of the code out there use the same field name, but with the initial letter in lower case, why is this?</p>\n</blockquote>\n\n<p>Because JavaScript traditionally/preferentially uses <a href=\"https://en.wikipedia.org/wiki/Camel_case\" rel=\"nofollow noreferrer\">camelCase</a> for variable and function names, so naturally JSON (originating in the JavaScript world) followed suit.</p>\n\n<p>Of course this is not an enforce standard, and there are many competing standards.  But since the question is why is this common, this seems the most likely answer.</p>\n\n<p>You are, of course, free to use any casing system you want for JSON key names, and you most certainly will find examples of any casing system (including lack of system) in use in real software.</p>\n"}], "owner": {"reputation": 11221, "user_id": 436559, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8d6b535e4fadefca3e9cab9b6b1ee49b?s=128&d=identicon&r=PG", "display_name": "fluter", "link": "https://stackoverflow.com/users/436559/fluter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "accepted_answer_id": 43444285, "answer_count": 3, "score": 2, "last_activity_date": 1492425113, "creation_date": 1492395162, "question_id": 43444248, "link": "https://stackoverflow.com/questions/43444248/why-is-the-format-string-of-struct-field-always-lower-case", "title": "Why is the format string of struct field always lower case", "body": "<p>When encoding/decoding structs with json, almost all of the code out there use the same field name, but with the initial letter in lower case, why is this?</p>\n\n<p>Since the names are the same, and json certainly can work with any case, why add this duplicate thing:</p>\n\n<pre><code>Name string `json:\"name\"`\n</code></pre>\n\n<p>Why not just use <code>Name string</code>? It other case, adding the format string makes sense if the name is different than the go field name:</p>\n\n<pre><code>Name string `json:\"MyName\"`\n</code></pre>\n"}, {"tags": ["go", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 3415, "user_id": 5287638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AzeH8.png?s=128&g=1", "display_name": "Jack Taylor", "link": "https://stackoverflow.com/users/5287638/jack-taylor"}, "is_accepted": true, "score": 4, "last_activity_date": 1492408427, "creation_date": 1492408427, "answer_id": 43445895, "question_id": 43440708, "link": "https://stackoverflow.com/questions/43440708/how-to-iterate-through-hugo-pages-by-markdown-names/43445895#43445895", "title": "How to iterate through hugo pages by markdown names", "body": "<p>This actually requires some pretty advanced use of Hugo templates. But you can do it!</p>\n\n<p>First, to make it easy for yourself, add the \".md\" extension to the pages you are trying to access. It's probably also a good idea to add the full path so that Hugo doesn't get the wrong file if you add files with the same name in a different directory in the future.</p>\n\n<pre><code>+++\n[publications]\nlinks = [\"publications/2017/article1.md\",\n        \"publications/2017/article2.md\"]\n+++\n</code></pre>\n\n<p>Then you can use something like the following in your template.</p>\n\n<pre><code>{{ range .Params.publications.links }}\n  {{ range where $.Site.Pages \"URL\" ($.RelRef .) }}\n    The \"{{ .Title }}\" page has {{ .WordCount }} words.\n  {{ end }}\n{{ end }}\n</code></pre>\n\n<p>This uses the <a href=\"https://gohugo.io/templates/functions/#general\" rel=\"nofollow noreferrer\"><code>where</code> function</a> to filter the array of all the site's pages by the URL field. To find the URL it uses the <a href=\"https://gohugo.io/templates/variables/#page-variables\" rel=\"nofollow noreferrer\"><code>.RelRef</code> page variable</a> with the link text.</p>\n\n<p>I think there should also be a way to use the <code>apply</code> function to do this without the inner <code>range</code> statement, but I couldn't get it to work.</p>\n"}], "owner": {"reputation": 230, "user_id": 6058105, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jxgUL0uro8o/AAAAAAAAAAI/AAAAAAAAINg/fVwZMZ2Tt64/photo.jpg?sz=128", "display_name": "Luk&#225;\u0161 Hejtm&#225;nek", "link": "https://stackoverflow.com/users/6058105/luk%c3%a1%c5%a1-hejtm%c3%a1nek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1184, "favorite_count": 1, "accepted_answer_id": 43445895, "answer_count": 1, "score": 1, "last_activity_date": 1492408427, "creation_date": 1492367879, "question_id": 43440708, "link": "https://stackoverflow.com/questions/43440708/how-to-iterate-through-hugo-pages-by-markdown-names", "title": "How to iterate through hugo pages by markdown names", "body": "<p>I am building a simple Hugo blog and I have this following toml config for a page</p>\n\n<pre><code>+++\n[publications]\nlinks = [\"2017/article1\",\n        \"2017/article2\"]\n+++\n</code></pre>\n\n<p>And I have these files in their appropriate content section (content/publications/2017/article1.md). What I need is to iterate through them, load each page and use some of their <code>.Params</code> in building a partial. Something like </p>\n\n<pre><code> {{ range .Params.publications.links }}\n {{ do something with page parameters }}\n {{ end }}\n</code></pre>\n\n<p>I guess it is a basic Hugo question, I just cant figure it out.</p>\n"}, {"tags": ["sql", "sql-server", "go"], "comments": [{"owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "edited": false, "score": 0, "creation_date": 1492363451, "post_id": 43439929, "comment_id": 73936808, "body": "I get this error :     mssql: Incorrect syntax near &#39; &#39;"}, {"owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 1, "creation_date": 1492366319, "post_id": 43439929, "comment_id": 73937778, "body": "At the very least, strings in Go should be double-quoted."}, {"owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "reply_to_user": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 0, "creation_date": 1492406568, "post_id": 43439929, "comment_id": 73947383, "body": "Hi Dmitry.  I am not sure which string you referring to but the sql file I am loading has strings with single quotes as required by mssql server."}, {"owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "reply_to_user": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 0, "creation_date": 1492418021, "post_id": 43439929, "comment_id": 73951619, "body": "I have just realized that the file I am loading might contain some special characters illegal to mssql ? but when I copy the contents and paste on sql server the scripts executes as expected. How would you go about eliminating these characters in this case"}, {"owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 0, "creation_date": 1492420770, "post_id": 43439929, "comment_id": 73952806, "body": "I&#39;m referring to these string: <code>sql.Open(&#39;mssql&#39;, &#39;mydatabase&#39;)</code>. This snippet should look like <code>sql.Open(&quot;mssql&quot;, &quot;mydatabase&quot;)</code>."}, {"owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "reply_to_user": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 0, "creation_date": 1492423025, "post_id": 43439929, "comment_id": 73953946, "body": "Thanks @Dmitry. I have fixed that but the issue still stands. How do I eliminate illegal characters in a file."}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "is_accepted": true, "score": 0, "last_activity_date": 1492445486, "creation_date": 1492445486, "answer_id": 43455121, "question_id": 43439929, "link": "https://stackoverflow.com/questions/43439929/how-to-execute-mssql-script-directly-from-file-with-golang/43455121#43455121", "title": "How to execute mssql script directly from file with Golang", "body": "<p>I have realized the illegal character causing issues was probably an extended ASCII character so I used the below method to strip off unnecessary characters from the file contents :</p>\n\n<pre><code>func stripCtlAndExtFromBytes(str string) string {\n  b := make([]byte, len(str))\n  var bl int\n  for i := 0; i &lt; len(str); i++ {\n    c := str[i]\n    if c &gt;= 32 &amp;&amp; c &lt; 127 {\n      b[bl] = c\n      bl++\n     }\n }\n return string(b[:bl])\n}\n</code></pre>\n\n<p>as stated here <a href=\"https://rosettacode.org/wiki/Strip_control_codes_and_extended_characters_from_a_string#Go\" rel=\"nofollow noreferrer\">https://rosettacode.org/wiki/Strip_control_codes_and_extended_characters_from_a_string#Go</a></p>\n"}], "owner": {"reputation": 627, "user_id": 4869748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d8c1c0c9cb723cd9175854835384b4e?s=128&d=identicon&r=PG&f=1", "display_name": "Godfrey", "link": "https://stackoverflow.com/users/4869748/godfrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 1, "accepted_answer_id": 43455121, "answer_count": 1, "score": 0, "last_activity_date": 1492445486, "creation_date": 1492363281, "last_edit_date": 1492422948, "question_id": 43439929, "link": "https://stackoverflow.com/questions/43439929/how-to-execute-mssql-script-directly-from-file-with-golang", "title": "How to execute mssql script directly from file with Golang", "body": "<p>I have been looking around for the answer to the question above with no luck. Excuse me if it is a duplicate. So basically I am trying to execute a sql script directly from file but I keep on getting the  \" Incorrect syntax near ''. \" error</p>\n\n<pre><code>func AnotherDatabase() (sql.Result, error) {\n     rc, err := os.Open(\"./myscript.sql\")\n     if err != nil {\n        return nil,err\n     }\n     buf := new(bytes.Buffer)\n     buf.ReadFrom(rc)\n     contents := buf.String()\n\n     db, err := sql.Open(\"mssql\", \"mydatabase\")\n     if err != nil {\n       return nil,err\n     }\n     defer db.Close()\n\n     res, err := db.Exec(contents)\n     if err != nil {\n       return nil,err\n     }\n    return res,nil\n}\n</code></pre>\n"}, {"tags": ["go", "packages"], "comments": [{"owner": {"reputation": 1, "user_id": 7341079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c39de0eade4d91d860403f4920ce61?s=128&d=identicon&r=PG&f=1", "display_name": "jenny \u5f90\u6625\u6770", "link": "https://stackoverflow.com/users/7341079/jenny-%e5%be%90%e6%98%a5%e6%9d%b0"}, "edited": false, "score": 0, "creation_date": 1492359434, "post_id": 43439241, "comment_id": 73935461, "body": "Here&#39;s the interface I&#39;m trying to use in ibe._// Master is the interface used to extract private keys for arbitrary identities._     &#39;type Master interface { \t    Extract(id string) (PrivateKey, error) \t    Params() Params     }&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7341079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c39de0eade4d91d860403f4920ce61?s=128&d=identicon&r=PG&f=1", "display_name": "jenny \u5f90\u6625\u6770", "link": "https://stackoverflow.com/users/7341079/jenny-%e5%be%90%e6%98%a5%e6%9d%b0"}, "edited": false, "score": 0, "creation_date": 1492833854, "post_id": 43473468, "comment_id": 74162075, "body": "Yes, thank you for your answer, I figured that out. But I found that, the private keys I extracted each time are not the same. That is frustrating...I looked into that and found several random() in the Setup()s and Extract()s. I&#39;m now reading the paper( <a href=\"http://crypto.stanford.edu/~dabo/papers/bfibe.pdf\" rel=\"nofollow noreferrer\">crypto.stanford.edu/~dabo/papers/bfibe.pdf</a> ) trying to find out that how the keys like that can even working..."}, {"owner": {"reputation": 1, "user_id": 7341079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c39de0eade4d91d860403f4920ce61?s=128&d=identicon&r=PG&f=1", "display_name": "jenny \u5f90\u6625\u6770", "link": "https://stackoverflow.com/users/7341079/jenny-%e5%be%90%e6%98%a5%e6%9d%b0"}, "edited": false, "score": 0, "creation_date": 1492918715, "post_id": 43473468, "comment_id": 74184588, "body": "Hi Joshua, I try to follow your code to print the ciphertext and decrypted text using the functions, but I always can&#39;t get them. I checked the original ibe library and I think it just can&#39;t print those two texts, right?"}], "tags": [], "owner": {"reputation": 46, "user_id": 7782902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TcEBOnHoNvo/AAAAAAAAAAI/AAAAAAAAANc/2U9TW-kQSsM/photo.jpg?sz=128", "display_name": "Joshua Wales", "link": "https://stackoverflow.com/users/7782902/joshua-wales"}, "is_accepted": false, "score": 0, "last_activity_date": 1492522123, "last_edit_date": 1492522123, "creation_date": 1492521711, "answer_id": 43473468, "question_id": 43439241, "link": "https://stackoverflow.com/questions/43439241/how-to-use-master-interface-in-ibe-package-in-golang/43473468#43473468", "title": "How to use Master interface in ibe package in golang", "body": "<p>There are 2 implementations of Master provided in the ibe package (bb1 and bb2).\nThese can be accessed using either ibe.SetupBB1() or ibe.SetupBB2()</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"log\"\n\n    \"v.io/x/lib/ibe\"\n)\n\nvar Macid = \"00055DNEFF\"\n\nfunc stringToBin(Macid string) (id string) {\n    for _, c := range Macid {\n        id = fmt.Sprintf(\"%s%b\", id, c)\n    }\n    return\n}\n\nfunc main() {\n    bb2Master, err := ibe.SetupBB2()\n    // or\n    // bb1Master, err := ibe.SetupBB1()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    id := stringToBin(Macid)\n    privateKey, err := bb2Master.Extract(id)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"MacID is %v, private key is %v\", Macid, privateKey)\n\n    // etc...\n    // privateKey.Decrypt(C, m)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7341079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c39de0eade4d91d860403f4920ce61?s=128&d=identicon&r=PG&f=1", "display_name": "jenny \u5f90\u6625\u6770", "link": "https://stackoverflow.com/users/7341079/jenny-%e5%be%90%e6%98%a5%e6%9d%b0"}, "is_accepted": false, "score": 0, "last_activity_date": 1492919164, "creation_date": 1492919164, "answer_id": 43567147, "question_id": 43439241, "link": "https://stackoverflow.com/questions/43439241/how-to-use-master-interface-in-ibe-package-in-golang/43567147#43567147", "title": "How to use Master interface in ibe package in golang", "body": "<p>@Joshua Wales</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\n\"log\"\n\n\"v.io/x/lib/ibe\"\n)\n\nvar Macid = \"00055DNEFF\"\n\nfunc stringToBin(Macid string) (id string) {\nfor _, c := range Macid {\n    id = fmt.Sprintf(\"%s%b\", id, c)\n}\nreturn\n}\n\nfunc main() {\nbb1Master, err := ibe.SetupBB1()\n\nif err != nil {\n    log.Fatal(err)\n}\n\nid := stringToBin(Macid)\nprivateKey, err := bb1Master.Extract(id)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"MacID is %v, private key is %v\", Macid, privateKey)\n\nm := []byte(\"HelloAuthentication\")\noverhead := bb1Master.Params().CiphertextOverhead()\nC := make([]byte, len(m)+overhead)\n\nif err := bb1Master.Params().Encrypt(Macid, m, C); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"Ciphertext is : \", bb1Master.Params().Encrypt(Macid, m, C))\n\nif err := privateKey.Decrypt(C, m); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"Decrypted text is : \", privateKey.Decrypt(C, m))\n\n\n}\n</code></pre>\n\n<p>@</p>\n"}], "owner": {"reputation": 1, "user_id": 7341079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c39de0eade4d91d860403f4920ce61?s=128&d=identicon&r=PG&f=1", "display_name": "jenny \u5f90\u6625\u6770", "link": "https://stackoverflow.com/users/7341079/jenny-%e5%be%90%e6%98%a5%e6%9d%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492985593, "creation_date": 1492359294, "question_id": 43439241, "link": "https://stackoverflow.com/questions/43439241/how-to-use-master-interface-in-ibe-package-in-golang", "title": "How to use Master interface in ibe package in golang", "body": "<p>I'm trying to generate private key using the Extract() in the Master interface of the ibe package, here's the link of the package,\"<a href=\"https://godoc.org/v.io/x/lib/ibe#Master\" rel=\"nofollow noreferrer\">https://godoc.org/v.io/x/lib/ibe#Master</a>\". In the package, the input of Extract is id, and consist of {0,1}*, so I convert Mac id to binary string first, and then use the binary string to generate correspond private key. \nMy code is like this.</p>\n\n<pre><code>package main\nimport (\n\"fmt\"\n\"v.io/x/lib/ibe\"\n)\n\nvar Macid = \"00055DNEFF\"\nvar id string\nvar PrivateKey string\n\nfunc stringToBin(Macid string) (id string) {\n    for _, c := range Macid {\n        id = fmt.Sprintf(\"%s%b\", id, c)\n    }\n    return\n}\ntype Master string\nfunc (master Master) Extract(id string) (PrivateKey, error) {\n    return PrivateKey\n}\n\nfunc main() {\n    fmt.Println(\"MacID is \" + Macid + \", public key is\" + stringToBin(Macid) + \", private key is\" + ibe.Extract(id))\n\n}\n</code></pre>\n\n<p>But I always got errors </p>\n\n<blockquote>\n  <p>$ go build pkg.go</p>\n  \n  <p>command-line-arguments</p>\n  \n  <p>./pkg.go:27: PrivateKey is not a type</p>\n  \n  <p>./pkg.go:33: undefined: ibe in ibe.Extract</p>\n</blockquote>\n\n<p>I'm all new to go, and I have read the tour of go, but I couldn't get it.\nCan anyone help me with this? Thank you.</p>\n"}, {"tags": ["go", "llvm"], "comments": [{"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1492432616, "post_id": 43438219, "comment_id": 73958604, "body": "<code>llgo</code> has installation instructions available at <a href=\"https://llvm.org/svn/llvm-project/llgo/trunk/README.TXT\" rel=\"nofollow noreferrer\">llvm.org/svn/llvm-project/llgo/trunk/README.TXT</a>; did you go through those, and if so, which issues did you encounter?"}, {"owner": {"reputation": 1, "user_id": 7874787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a5b531ca6d98ab255c47be7a8d0a7?s=128&d=identicon&r=PG&f=1", "display_name": "GoWorkCode", "link": "https://stackoverflow.com/users/7874787/goworkcode"}, "reply_to_user": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "edited": false, "score": 0, "creation_date": 1492433862, "post_id": 43438219, "comment_id": 73959231, "body": "Please again check new update of question."}], "owner": {"reputation": 1, "user_id": 7874787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a5b531ca6d98ab255c47be7a8d0a7?s=128&d=identicon&r=PG&f=1", "display_name": "GoWorkCode", "link": "https://stackoverflow.com/users/7874787/goworkcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 866, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1492518483, "creation_date": 1492352601, "last_edit_date": 1492518483, "question_id": 43438219, "link": "https://stackoverflow.com/questions/43438219/how-get-llvm-library-in-go", "title": "How Get llvm Library in Go?", "body": "<p>My OS is GNU/Ubuntu 16.10- 64bit.</p>\n\n<p>i also report this to GoLang.</p>\n\n<p><a href=\"https://github.com/golang/go/issues/19444\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/19444</a></p>\n\n<h2>$ go get llvm.org/llvm/bindings/go/llvm</h2>\n\n<pre><code>package llvm.org/llvm/bindings/go/llvm: unrecognized import path \"llvm.org/llvm/bindings/go/llvm\" (parse https://llvm.org/llvm/bindings/go/llvm?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<h2>$ go get llvm.org/llvm/bindings</h2>\n\n<pre><code>package llvm.org/llvm/bindings: unrecognized import path \"llvm.org/llvm/bindings\" (parse https://llvm.org/llvm/bindings?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<p>so <code>go get</code> say not parse <a href=\"https://llvm.org/llvm/bindings?go-get=1\" rel=\"nofollow noreferrer\">https://llvm.org/llvm/bindings?go-get=1</a></p>\n\n<p>in browser also <code>https://llvm.org/</code> not open.(HTTPS)</p>\n\n<pre><code>Not Found\nThe requested URL / was not found on this server.\nApache/2.2.22 (Ubuntu) Server at llvm.org Port 443\n</code></pre>\n\n<p>but <code>http://llvm.org</code> is good.(HTTP)</p>\n\n<p>how can get this libs for GoLang?</p>\n\n<p>==================</p>\n\n<p>Try <code>github.com/go-llvm/llgo</code> : </p>\n\n<pre><code>guest@system:~/go/src/github.com/go-llvm/llgo$ ./llgo-go.sh build\ncan't load package: package github.com/go-llvm/llgo: no buildable Go source files in /home/guest/go/src/github.com/go-llvm/llgo\nguest@system:~/go/src/github.com/go-llvm/llgo$ ./llgo-go.sh install\ncan't load package: package github.com/go-llvm/llgo: no buildable Go source files in /home/guest/go/src/github.com/go-llvm/llgo\nguest@system:~/go/src/github.com/go-llvm/llgo$ ./llgo-go.sh install\ncan't load package: package github.com/go-llvm/llgo: no buildable Go source files in /home/guest/go/src/github.com/go-llvm/llgo\nguest@system:~/go/src/github.com/go-llvm/llgo$ make\n./update_clang.sh\ncan't load package: package llvm.org/llvm/bindings/go/llvm: cannot find package \"llvm.org/llvm/bindings/go/llvm\" in any of:\n    /usr/lib/go-1.8/src/llvm.org/llvm/bindings/go/llvm (from $GOROOT)\n    /home/guest/go/src/llvm.org/llvm/bindings/go/llvm (from $GOPATH)\nMakefile:25: recipe for target 'workdir/.update-clang-stamp' failed\nmake: *** [workdir/.update-clang-stamp] Error 1\nguest@system:~/go/src/github.com/go-llvm/llgo$ export PATH=/path/to/gcc-inst/bin:$PATH\nguest@system:~/go/src/github.com/go-llvm/llgo$ export LD_LIBRARY_PATH=/path/to/gcc-inst/lib64:$LD_LIBRARY_PATH\nguest@system:~/go/src/github.com/go-llvm/llgo$ export CC=`which gcc`\nguest@system:~/go/src/github.com/go-llvm/llgo$ export CXX=`which g++`\nguest@system:~/go/src/github.com/go-llvm/llgo$ export LIBGO_CFLAGS=--gcc-toolchain=/path/to/gcc-inst\nguest@system:~/go/src/github.com/go-llvm/llgo$ go get -d github.com/go-llvm/llgo/cmd/gllgo\npackage llvm.org/llvm/bindings/go/llvm: unrecognized import path \"llvm.org/llvm/bindings/go/llvm\" (parse https://llvm.org/llvm/bindings/go/llvm?go-get=1: no go-import meta tags ())\npackage golang.org/x/tools/go/exact: cannot find package \"golang.org/x/tools/go/exact\" in any of:\n    /usr/lib/go-1.8/src/golang.org/x/tools/go/exact (from $GOROOT)\n    /home/guest/go/src/golang.org/x/tools/go/exact (from $GOPATH)\npackage golang.org/x/tools/go/gccgoimporter: cannot find package \"golang.org/x/tools/go/gccgoimporter\" in any of:\n    /usr/lib/go-1.8/src/golang.org/x/tools/go/gccgoimporter (from $GOROOT)\n    /home/guest/go/src/golang.org/x/tools/go/gccgoimporter (from $GOPATH)\npackage golang.org/x/tools/go/importer: cannot find package \"golang.org/x/tools/go/importer\" in any of:\n    /usr/lib/go-1.8/src/golang.org/x/tools/go/importer (from $GOROOT)\n    /home/guest/go/src/golang.org/x/tools/go/importer (from $GOPATH)\nguest@system:~/go/src/github.com/go-llvm/llgo$ $GOPATH/src/llvm.org/llvm/bindings/go/build.sh -DCMAKE_BUILD_TYPE=Release -DLLVM_TARGETS_TO_BUILD=host\nbash: /home/guest/go/src/llvm.org/llvm/bindings/go/build.sh: No such file or directory\nguest@system:~/go/src/github.com/go-llvm/llgo$ \n</code></pre>\n\n<hr>\n\n<pre><code>$ go version\ngo version go1.8 linux/amd64\n$ cmake -version\ncmake version 3.8.20170216-gb9229\n\nCMake suite maintained and supported by Kitware (kitware.com/cmake).\n</code></pre>\n\n<hr>\n\n<p>guest@system:~/go/src/github.com/go-llvm/llvm$ ./update_llvm.sh</p>\n\n<pre><code>+ llvm_components=all-targets analysis asmparser asmprinter bitreader bitwriter codegen core debuginfo executionengine instrumentation interpreter ipo irreader linker mc mcjit objcarcopts option profiledata scalaropts support target \n+ dirname ./update_llvm.sh\n+ gollvmdir=.\n+ grep run_update_llvm_sh_to_get_revision_ ./llvm_dep.go\n+ sed -E -e s/.*run_update_llvm_sh_to_get_revision_([0-9]+.*)/\\1/g\n+ llvmrev=218171\n+ workdir=./workdir\n+ llvmdir=./workdir/llvm\n+ llvm_builddir=./workdir/llvm_build\n+ mkdir -p ./workdir\n+ svn co -r 218171 https://llvm.org/svn/llvm-project/llvm/trunk ./workdir/llvm\nChecked out revision 218171.\n+ mkdir -p ./workdir/llvm_build\n+ cmake_flags=../llvm \n+ llvm_config=./workdir/llvm_build/bin/llvm-config\n+ which ninja\n+ test -n /usr/bin/ninja\n+ cd ./workdir/llvm_build\n+ cmake -G Ninja ../llvm\n-- Target triple: x86_64-unknown-linux-gnu\n-- Native target architecture is X86\n-- Threads enabled.\n-- Doxygen disabled.\n-- Sphinx disabled.\nCMake Warning (dev) at cmake/modules/HandleLLVMOptions.cmake:131 (if):\n  Policy CMP0054 is not set: Only interpret if() arguments as variables or\n  keywords when unquoted.  Run \"cmake --help-policy CMP0054\" for policy\n  details.  Use the cmake_policy command to set the policy and suppress this\n  warning.\n\n  Quoted variables like \"C_SUPPORTS_FPIC\" will no longer be dereferenced when\n  the policy is set to NEW.  Since the policy is not set the OLD behavior\n  will be used.\nCall Stack (most recent call first):\n  cmake/modules/HandleLLVMOptions.cmake:148 (add_flag_or_print_warning)\n  CMakeLists.txt:315 (include)\nThis warning is for project developers.  Use -Wno-dev to suppress it.\n\n-- Building with -fPIC\n-- Constructing LLVMBuild project information\n-- Targeting AArch64\n-- Targeting ARM\n-- Targeting CppBackend\n-- Targeting Hexagon\n-- Targeting Mips\n-- Targeting MSP430\n-- Targeting NVPTX\n-- Targeting PowerPC\n-- Targeting R600\n-- Targeting Sparc\n-- Targeting SystemZ\n-- Targeting X86\n-- Targeting XCore\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build\n+ ninja -C ./workdir/llvm_build llvm-config\nninja: Entering directory `./workdir/llvm_build'\n[2/2] Linking CXX executable bin/llvm-config\n+ ./workdir/llvm_build/bin/llvm-config --libs all-targets analysis asmparser asmprinter bitreader bitwriter codegen core debuginfo executionengine instrumentation interpreter ipo irreader linker mc mcjit objcarcopts option profiledata scalaropts support target\n+ sed -e s/-l//g\n+ llvm_buildtargets=LLVMOption LLVMObjCARCOpts LLVMMCJIT LLVMRuntimeDyld LLVMLinker LLVMIRReader LLVMipo LLVMVectorize LLVMInterpreter LLVMInstrumentation LLVMExecutionEngine LLVMDebugInfo LLVMBitWriter LLVMAsmParser LLVMXCoreDisassembler LLVMXCoreCodeGen LLVMXCoreDesc LLVMXCoreInfo LLVMXCoreAsmPrinter LLVMX86Disassembler LLVMX86AsmParser LLVMX86CodeGen LLVMX86Desc LLVMX86Info LLVMX86AsmPrinter LLVMX86Utils LLVMSystemZDisassembler LLVMSystemZCodeGen LLVMSystemZAsmParser LLVMSystemZDesc LLVMSystemZInfo LLVMSystemZAsmPrinter LLVMSparcDisassembler LLVMSparcCodeGen LLVMSparcAsmParser LLVMSparcDesc LLVMSparcInfo LLVMSparcAsmPrinter LLVMR600CodeGen LLVMR600Desc LLVMR600Info LLVMR600AsmPrinter LLVMPowerPCDisassembler LLVMPowerPCCodeGen LLVMPowerPCAsmParser LLVMPowerPCDesc LLVMPowerPCInfo LLVMPowerPCAsmPrinter LLVMNVPTXCodeGen LLVMNVPTXDesc LLVMNVPTXInfo LLVMNVPTXAsmPrinter LLVMMSP430CodeGen LLVMMSP430Desc LLVMMSP430Info LLVMMSP430AsmPrinter LLVMMipsDisassembler LLVMMipsCodeGen LLVMMipsAsmParser LLVMMipsDesc LLVMMipsInfo LLVMMipsAsmPrinter LLVMHexagonCodeGen LLVMHexagonAsmPrinter LLVMHexagonDesc LLVMHexagonInfo LLVMCppBackendCodeGen LLVMCppBackendInfo LLVMARMDisassembler LLVMARMCodeGen LLVMARMAsmParser LLVMARMDesc LLVMARMInfo LLVMARMAsmPrinter LLVMAArch64Disassembler LLVMMCDisassembler LLVMAArch64CodeGen LLVMSelectionDAG LLVMAsmPrinter LLVMCodeGen LLVMScalarOpts LLVMProfileData LLVMObject LLVMBitReader LLVMInstCombine LLVMTransformUtils LLVMipa LLVMAnalysis LLVMTarget LLVMCore LLVMAArch64AsmParser LLVMMCParser LLVMAArch64Desc LLVMAArch64Info LLVMAArch64AsmPrinter LLVMMC LLVMAArch64Utils LLVMSupport\n+ ninja -C ./workdir/llvm_build LLVMOption LLVMObjCARCOpts LLVMMCJIT LLVMRuntimeDyld LLVMLinker LLVMIRReader LLVMipo LLVMVectorize LLVMInterpreter LLVMInstrumentation LLVMExecutionEngine LLVMDebugInfo LLVMBitWriter LLVMAsmParser LLVMXCoreDisassembler LLVMXCoreCodeGen LLVMXCoreDesc LLVMXCoreInfo LLVMXCoreAsmPrinter LLVMX86Disassembler LLVMX86AsmParser LLVMX86CodeGen LLVMX86Desc LLVMX86Info LLVMX86AsmPrinter LLVMX86Utils LLVMSystemZDisassembler LLVMSystemZCodeGen LLVMSystemZAsmParser LLVMSystemZDesc LLVMSystemZInfo LLVMSystemZAsmPrinter LLVMSparcDisassembler LLVMSparcCodeGen LLVMSparcAsmParser LLVMSparcDesc LLVMSparcInfo LLVMSparcAsmPrinter LLVMR600CodeGen LLVMR600Desc LLVMR600Info LLVMR600AsmPrinter LLVMPowerPCDisassembler LLVMPowerPCCodeGen LLVMPowerPCAsmParser LLVMPowerPCDesc LLVMPowerPCInfo LLVMPowerPCAsmPrinter LLVMNVPTXCodeGen LLVMNVPTXDesc LLVMNVPTXInfo LLVMNVPTXAsmPrinter LLVMMSP430CodeGen LLVMMSP430Desc LLVMMSP430Info LLVMMSP430AsmPrinter LLVMMipsDisassembler LLVMMipsCodeGen LLVMMipsAsmParser LLVMMipsDesc LLVMMipsInfo LLVMMipsAsmPrinter LLVMHexagonCodeGen LLVMHexagonAsmPrinter LLVMHexagonDesc LLVMHexagonInfo LLVMCppBackendCodeGen LLVMCppBackendInfo LLVMARMDisassembler LLVMARMCodeGen LLVMARMAsmParser LLVMARMDesc LLVMARMInfo LLVMARMAsmPrinter LLVMAArch64Disassembler LLVMMCDisassembler LLVMAArch64CodeGen LLVMSelectionDAG LLVMAsmPrinter LLVMCodeGen LLVMScalarOpts LLVMProfileData LLVMObject LLVMBitReader LLVMInstCombine LLVMTransformUtils LLVMipa LLVMAnalysis LLVMTarget LLVMCore LLVMAArch64AsmParser LLVMMCParser LLVMAArch64Desc LLVMAArch64Info LLVMAArch64AsmPrinter LLVMMC LLVMAArch64Utils LLVMSupport FileCheck\nninja: Entering directory `./workdir/llvm_build'\nninja: no work to do.\n+ ./workdir/llvm_build/bin/llvm-config --version\n+ llvm_version=3.6.0svn\n+ ./workdir/llvm_build/bin/llvm-config --cppflags\n+ llvm_cflags=-I/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm/include -I/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build/include    -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS\n+ uname\n+ [ Linux == Darwin ]\n./update_llvm.sh: 59: [: Linux: unexpected operator\n+ ./workdir/llvm_build/bin/llvm-config --ldflags\n+ ./workdir/llvm_build/bin/llvm-config --libdir\n+ ./workdir/llvm_build/bin/llvm-config --libs all-targets analysis asmparser asmprinter bitreader bitwriter codegen core debuginfo executionengine instrumentation interpreter ipo irreader linker mc mcjit objcarcopts option profiledata scalaropts support target\n+ ./workdir/llvm_build/bin/llvm-config --system-libs\n+ llvm_ldflags=-L/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build//lib  -Wl,-rpath,/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build//lib -lLLVMOption -lLLVMObjCARCOpts -lLLVMMCJIT -lLLVMRuntimeDyld -lLLVMLinker -lLLVMIRReader -lLLVMipo -lLLVMVectorize -lLLVMInterpreter -lLLVMInstrumentation -lLLVMExecutionEngine -lLLVMDebugInfo -lLLVMBitWriter -lLLVMAsmParser -lLLVMXCoreDisassembler -lLLVMXCoreCodeGen -lLLVMXCoreDesc -lLLVMXCoreInfo -lLLVMXCoreAsmPrinter -lLLVMX86Disassembler -lLLVMX86AsmParser -lLLVMX86CodeGen -lLLVMX86Desc -lLLVMX86Info -lLLVMX86AsmPrinter -lLLVMX86Utils -lLLVMSystemZDisassembler -lLLVMSystemZCodeGen -lLLVMSystemZAsmParser -lLLVMSystemZDesc -lLLVMSystemZInfo -lLLVMSystemZAsmPrinter -lLLVMSparcDisassembler -lLLVMSparcCodeGen -lLLVMSparcAsmParser -lLLVMSparcDesc -lLLVMSparcInfo -lLLVMSparcAsmPrinter -lLLVMR600CodeGen -lLLVMR600Desc -lLLVMR600Info -lLLVMR600AsmPrinter -lLLVMPowerPCDisassembler -lLLVMPowerPCCodeGen -lLLVMPowerPCAsmParser -lLLVMPowerPCDesc -lLLVMPowerPCInfo -lLLVMPowerPCAsmPrinter -lLLVMNVPTXCodeGen -lLLVMNVPTXDesc -lLLVMNVPTXInfo -lLLVMNVPTXAsmPrinter -lLLVMMSP430CodeGen -lLLVMMSP430Desc -lLLVMMSP430Info -lLLVMMSP430AsmPrinter -lLLVMMipsDisassembler -lLLVMMipsCodeGen -lLLVMMipsAsmParser -lLLVMMipsDesc -lLLVMMipsInfo -lLLVMMipsAsmPrinter -lLLVMHexagonCodeGen -lLLVMHexagonAsmPrinter -lLLVMHexagonDesc -lLLVMHexagonInfo -lLLVMCppBackendCodeGen -lLLVMCppBackendInfo -lLLVMARMDisassembler -lLLVMARMCodeGen -lLLVMARMAsmParser -lLLVMARMDesc -lLLVMARMInfo -lLLVMARMAsmPrinter -lLLVMAArch64Disassembler -lLLVMMCDisassembler -lLLVMAArch64CodeGen -lLLVMSelectionDAG -lLLVMAsmPrinter -lLLVMCodeGen -lLLVMScalarOpts -lLLVMProfileData -lLLVMObject -lLLVMBitReader -lLLVMInstCombine -lLLVMTransformUtils -lLLVMipa -lLLVMAnalysis -lLLVMTarget -lLLVMCore -lLLVMAArch64AsmParser -lLLVMMCParser -lLLVMAArch64Desc -lLLVMAArch64Info -lLLVMAArch64AsmPrinter -lLLVMMC -lLLVMAArch64Utils -lLLVMSupport -lrt -ldl -ltinfo -latomic -lpthread -lz\n+ sed -e s#@LLVM_REVISION@#218171#g; s#@LLVM_CFLAGS@#-I/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm/include -I/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build/include    -D_GNU_SOURCE -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT_MACROS -D__STDC_LIMIT_MACROS#g;         s#@LLVM_LDFLAGS@#-L/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build//lib  -Wl,-rpath,/home/guest/go/src/github.com/go-llvm/llvm/workdir/llvm_build//lib -lLLVMOption -lLLVMObjCARCOpts -lLLVMMCJIT -lLLVMRuntimeDyld -lLLVMLinker -lLLVMIRReader -lLLVMipo -lLLVMVectorize -lLLVMInterpreter -lLLVMInstrumentation -lLLVMExecutionEngine -lLLVMDebugInfo -lLLVMBitWriter -lLLVMAsmParser -lLLVMXCoreDisassembler -lLLVMXCoreCodeGen -lLLVMXCoreDesc -lLLVMXCoreInfo -lLLVMXCoreAsmPrinter -lLLVMX86Disassembler -lLLVMX86AsmParser -lLLVMX86CodeGen -lLLVMX86Desc -lLLVMX86Info -lLLVMX86AsmPrinter -lLLVMX86Utils -lLLVMSystemZDisassembler -lLLVMSystemZCodeGen -lLLVMSystemZAsmParser -lLLVMSystemZDesc -lLLVMSystemZInfo -lLLVMSystemZAsmPrinter -lLLVMSparcDisassembler -lLLVMSparcCodeGen -lLLVMSparcAsmParser -lLLVMSparcDesc -lLLVMSparcInfo -lLLVMSparcAsmPrinter -lLLVMR600CodeGen -lLLVMR600Desc -lLLVMR600Info -lLLVMR600AsmPrinter -lLLVMPowerPCDisassembler -lLLVMPowerPCCodeGen -lLLVMPowerPCAsmParser -lLLVMPowerPCDesc -lLLVMPowerPCInfo -lLLVMPowerPCAsmPrinter -lLLVMNVPTXCodeGen -lLLVMNVPTXDesc -lLLVMNVPTXInfo -lLLVMNVPTXAsmPrinter -lLLVMMSP430CodeGen -lLLVMMSP430Desc -lLLVMMSP430Info -lLLVMMSP430AsmPrinter -lLLVMMipsDisassembler -lLLVMMipsCodeGen -lLLVMMipsAsmParser -lLLVMMipsDesc -lLLVMMipsInfo -lLLVMMipsAsmPrinter -lLLVMHexagonCodeGen -lLLVMHexagonAsmPrinter -lLLVMHexagonDesc -lLLVMHexagonInfo -lLLVMCppBackendCodeGen -lLLVMCppBackendInfo -lLLVMARMDisassembler -lLLVMARMCodeGen -lLLVMARMAsmParser -lLLVMARMDesc -lLLVMARMInfo -lLLVMARMAsmPrinter -lLLVMAArch64Disassembler -lLLVMMCDisassembler -lLLVMAArch64CodeGen -lLLVMSelectionDAG -lLLVMAsmPrinter -lLLVMCodeGen -lLLVMScalarOpts -lLLVMProfileData -lLLVMObject -lLLVMBitReader -lLLVMInstCombine -lLLVMTransformUtils -lLLVMipa -lLLVMAnalysis -lLLVMTarget -lLLVMCore -lLLVMAArch64AsmParser -lLLVMMCParser -lLLVMAArch64Desc -lLLVMAArch64Info -lLLVMAArch64AsmPrinter -lLLVMMC -lLLVMAArch64Utils -lLLVMSupport -lrt -ldl -ltinfo -latomic -lpthread -lz#g ./llvm_config.go.in\n+ printf package llvm\\n\\nconst Version = \"%s\"\\n 3.6.0svn\n</code></pre>\n\n<p>guest@system:~/go/src/github.com/go-llvm/llvm/examples$ cd factorial</p>\n\n<p>guest@system:~/go/src/github.com/go-llvm/llvm/examples/factorial$ ls\n    factorial  factorial.go</p>\n\n<p>guest@system:~/go/src/github.com/go-llvm/llvm/examples/factorial$ go build factorial.go</p>\n\n<p>guest@system:~/go/src/github.com/go-llvm/llvm/examples/factorial$ ./factorial</p>\n\n<pre><code>; ModuleID = 'fac_module'\n\ndefine i32 @fac(i32) {\nentry:\n  %cmptmp = icmp eq i32 %0, 0\n  br i1 %cmptmp, label %end, label %iffalse\n\niffalse:                                          ; preds = %entry\n  %subtmp = add i32 %0, -1\n  %calltmp = call i32 @fac(i32 %subtmp)\n  %multmp = mul i32 %calltmp, %0\n  br label %end\n\nend:                                              ; preds = %entry, %iffalse\n  %result = phi i32 [ %multmp, %iffalse ], [ 1, %entry ]\n  ret i32 %result\n}\n-----------------------------------------\nRunning fac(10) with JIT...\nResult: 3628800\nDONE\n</code></pre>\n\n<hr>\n\n<pre><code>guest@system:~$ go get llvm.org/llvm.v36/bindings/go/llvm\npackage llvm.org/llvm.v36/bindings/go/llvm: unrecognized import path \"llvm.org/llvm.v36/bindings/go/llvm\" (parse https://llvm.org/llvm.v36/bindings/go/llvm?go-get=1: no go-import meta tags ())\nguest@system:~$ go get -d llvm.org/llvm.v36/bindings/go/llvm\npackage llvm.org/llvm.v36/bindings/go/llvm: unrecognized import path \"llvm.org/llvm.v36/bindings/go/llvm\" (parse https://llvm.org/llvm.v36/bindings/go/llvm?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<hr>\n\n<pre><code>$ which llvm-config\n/usr/bin/llvm-config\n\nguest@system:~/go/src/github.com/go-llvm/llvm/workdir/llvm_build/bin$ ls\nFileCheck  llvm-config  llvm-lit  llvm-tblgen\n</code></pre>\n\n<hr>\n\n<p>guest@system:~/go/src/github.com/axw/llgo$ ./update_third_party.sh</p>\n\n<p>github.com/axw/llgo$ ./update_third_party.sh </p>\n\n<pre><code>Cloning into '/tmp/update_third_party.auPNC9/gofrontend'...\nremote: Sending approximately 92.68 MiB ...\nremote: Counting objects: 3087, done\nremote: Finding sources: 100% (69/69)\nremote: Total 33940 (delta 26755), reused 33933 (delta 26755)\nReceiving objects: 100% (33940/33940), 92.79 MiB | 60.00 KiB/s, done.\nResolving deltas: 100% (26755/26755), done.\nChecking connectivity... done.\nNote: checking out '81eb6a3f425b2158c67ee32c0cc973a72ce9d6be'.\n\nYou are in 'detached HEAD' state. You can look around, make experimental\nchanges and commit them, and you can discard any commits you make in this\nstate without impacting any branches by performing another checkout.\n\nIf you want to create a new branch to retain commits you create, you may\ndo so (now or later) by using -b with the checkout command again. Example:\n\n  git checkout -b &lt;new-branch-name&gt;\n\nHEAD is now at 81eb6a3... runtime: don't overallocate in select code\npatching file libgo/runtime/chan.goc\npatching file libgo/runtime/chan.h\npatching file libgo/runtime/heapdump.c\npatching file libgo/runtime/malloc.goc\npatching file libgo/runtime/malloc.h\nHunk #1 succeeded at 392 (offset 2 lines).\nHunk #2 succeeded at 403 (offset 2 lines).\nHunk #3 succeeded at 460 (offset 2 lines).\nHunk #4 succeeded at 478 (offset 2 lines).\nHunk #5 succeeded at 507 (offset 2 lines).\npatching file libgo/runtime/mcache.c\npatching file libgo/runtime/mcentral.c\npatching file libgo/runtime/mgc0.c\nHunk #3 succeeded at 1380 (offset 2 lines).\nHunk #4 succeeded at 1390 (offset 2 lines).\nHunk #5 succeeded at 1804 (offset 2 lines).\nHunk #6 succeeded at 2151 (offset 4 lines).\nHunk #7 succeeded at 2428 (offset 5 lines).\nHunk #8 succeeded at 2443 (offset 5 lines).\nHunk #9 succeeded at 2451 (offset 5 lines).\npatching file libgo/runtime/mheap.c\npatching file libgo/runtime/netpoll.goc\npatching file libgo/runtime/proc.c\nHunk #1 succeeded at 326 (offset 24 lines).\nHunk #2 succeeded at 809 (offset 100 lines).\nHunk #3 succeeded at 820 (offset 100 lines).\nHunk #4 succeeded at 847 (offset 100 lines).\nHunk #5 succeeded at 855 (offset 100 lines).\nHunk #6 succeeded at 864 (offset 100 lines).\nHunk #7 succeeded at 881 (offset 100 lines).\nHunk #8 succeeded at 894 (offset 100 lines).\nHunk #9 succeeded at 933 (offset 100 lines).\nHunk #10 succeeded at 953 (offset 100 lines).\nHunk #11 succeeded at 987 (offset 100 lines).\nHunk #12 succeeded at 1011 (offset 100 lines).\nHunk #13 succeeded at 1452 (offset 106 lines).\nHunk #14 succeeded at 1481 (offset 106 lines).\nHunk #15 succeeded at 1525 (offset 106 lines).\nHunk #16 succeeded at 1618 (offset 106 lines).\nHunk #17 succeeded at 1673 (offset 106 lines).\nHunk #18 succeeded at 1709 (offset 106 lines).\nHunk #19 succeeded at 1730 (offset 106 lines).\nHunk #20 succeeded at 1749 (offset 106 lines).\nHunk #21 succeeded at 1794 (offset 106 lines).\nHunk #22 succeeded at 1832 (offset 106 lines).\nHunk #23 succeeded at 1928 (offset 106 lines).\nHunk #24 succeeded at 2031 (offset 106 lines).\nHunk #25 succeeded at 2159 (offset 106 lines).\nHunk #26 succeeded at 2184 (offset 106 lines).\nHunk #27 succeeded at 2192 (offset 106 lines).\nHunk #28 succeeded at 2484 (offset 119 lines).\nHunk #29 succeeded at 2595 (offset 119 lines).\nHunk #30 succeeded at 2627 (offset 119 lines).\nHunk #31 succeeded at 2657 (offset 119 lines).\nHunk #32 succeeded at 2682 (offset 119 lines).\nHunk #33 succeeded at 2826 (offset 119 lines).\nHunk #34 succeeded at 2906 (offset 126 lines).\nHunk #35 succeeded at 3044 (offset 126 lines).\nHunk #36 succeeded at 3080 (offset 126 lines).\nHunk #37 succeeded at 3112 (offset 126 lines).\nHunk #38 succeeded at 3268 (offset 126 lines).\nHunk #39 succeeded at 3422 (offset 126 lines).\npatching file libgo/runtime/runtime.h\npatching file libgo/runtime/sema.goc\npatching file libgo/runtime/sigqueue.goc\npatching file libgo/runtime/time.goc\npatching file libgo/Makefile.am\nHunk #1 succeeded at 4139 (offset 401 lines).\nHunk #2 succeeded at 4246 (offset 409 lines).\npatching file libgo/Makefile.in\nHunk #1 succeeded at 2433 (offset 221 lines).\nHunk #2 succeeded at 2540 (offset 229 lines).\npatching file libgo/go/runtime/mfinal_test.go\nHunk #1 succeeded at 65 (offset 3 lines).\ncp: cannot stat '../../cmake/config.guess': No such file or directory\n</code></pre>\n\n<p>how can fix?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492350054, "post_id": 43437729, "comment_id": 73932620, "body": "<code>reflect.Value.Bytes</code> does not return what you think it returns. See here <a href=\"https://golang.org/pkg/reflect/#Value.Bytes\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#Value.Bytes</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1492350478, "post_id": 43437729, "comment_id": 73932749, "body": "What format do you want the resulting file to be? JSON, XML, or plain text? If plain text how do you want the data to be formatted? Everything on one line? Or one line per field? And how would the slice be formatted?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492350907, "post_id": 43437729, "comment_id": 73932877, "body": "Just to expand on my first comment, if your field is of type <code>int</code> calling <code>Bytes</code> on its <code>reflect.Value</code> will panic because the <code>Bytes</code> method works only on values that are of type <code>[]byte</code>. Here&#39;s an example <a href=\"https://play.golang.org/p/g4UWNhbbzM\" rel=\"nofollow noreferrer\">play.golang.org/p/g4UWNhbbzM</a>"}, {"owner": {"reputation": 2597, "user_id": 2948793, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/YkdhN.png?s=128&g=1", "display_name": "ConorB", "link": "https://stackoverflow.com/users/2948793/conorb"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492351095, "post_id": 43437729, "comment_id": 73932924, "body": "@mkopriva The format will be plain text - I&#39;ve edited the question to include more details on this."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 2, "last_activity_date": 1492428843, "last_edit_date": 1492428843, "creation_date": 1492350620, "answer_id": 43437945, "question_id": 43437729, "link": "https://stackoverflow.com/questions/43437729/writing-a-structs-fields-and-values-of-different-types-to-a-file-in-go/43437945#43437945", "title": "Writing a struct&#39;s fields and values of different types to a file in Go", "body": "<p>Why not use the <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"nofollow noreferrer\">built-in <code>gob</code> package</a> to store your struct values?  </p>\n\n<p>I use it to store different structures, one per line, in files.  During decoding, you can test the type conversion or provide a hint in a wrapper - whichever is faster for your given use case.</p>\n\n<p>You'd treat each line as a buffer when Encoding and Decoding when reading back the line. You can even gzip/zlib/compress, encrypt/decrypt, etc the stream in real-time. </p>\n\n<p>No point in re-inventing the wheel when you have a polished and armorall'd wheel already at your disposal.</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1492352899, "creation_date": 1492352899, "answer_id": 43438265, "question_id": 43437729, "link": "https://stackoverflow.com/questions/43437729/writing-a-structs-fields-and-values-of-different-types-to-a-file-in-go/43438265#43438265", "title": "Writing a struct&#39;s fields and values of different types to a file in Go", "body": "<p>Instead of using the <code>Bytes</code> method on <code>reflect.Value</code> which does not work as you initially intended, you can use either the <code>strconv</code> package or the <code>fmt</code> to format you fields.</p>\n\n<p>Here's an example using <code>fmt</code>:</p>\n\n<pre><code>var s string\nswitch fi.Kind() {\ncase reflect.String:\n    s = fmt.Sprintf(\"%q\", fi.String())\ncase reflect.Int:\n    s = fmt.Sprintf(\"%d\", fi.Int())\ncase reflect.Slice:\n    if fi.Type().Elem().Kind() != reflect.String {\n        continue\n    }\n\n    s = \"[\"\n    for j := 0; j &lt; fi.Len(); j++ {\n        s = fmt.Sprintf(\"%s%q, \", s, fi.Index(i).String()) \n    }\n    s = strings.TrimRight(s, \", \") + \"]\"\ndefault:\n    continue\n}\n\nsf := rv.Type().Field(i)\nif _, err := fmt.Fprintf(file, \"%s=%s\\n\", sf.Name, s); err!= nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/KQF3CicVzA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KQF3CicVzA</a></p>\n"}], "owner": {"reputation": 2597, "user_id": 2948793, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/YkdhN.png?s=128&g=1", "display_name": "ConorB", "link": "https://stackoverflow.com/users/2948793/conorb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 43438265, "answer_count": 2, "score": 0, "last_activity_date": 1492428843, "creation_date": 1492348914, "last_edit_date": 1492350912, "question_id": 43437729, "link": "https://stackoverflow.com/questions/43437729/writing-a-structs-fields-and-values-of-different-types-to-a-file-in-go", "title": "Writing a struct&#39;s fields and values of different types to a file in Go", "body": "<p>I'm writing a simple program that takes in input from a form, populates an instance of a struct with the received data and the writes this received data to a file. </p>\n\n<p>I'm a bit stuck at the moment with figuring out the best way to iterate over the populated struct and write its contents to the file.</p>\n\n<p>The struct in question contains 3 different types of fields (ints, strings, []strings).</p>\n\n<p>I can iterate over them but I am unable to get their actual type. </p>\n\n<p>Inspecting my posted code below with print statements reveals that each of their types is coming back as structs rather than the aforementioned string, int etc.</p>\n\n<p>The desired output format is be plain text.</p>\n\n<p>For example:</p>\n\n<pre><code>field_1=\"value_1\"\nfield_2=10\nfield_3=[\"a\", \"b\", \"c\"]\n</code></pre>\n\n<p>Anyone have any ideas? Perhaps I'm going about this the wrong way entirely?</p>\n\n<pre><code>func (c *Config) writeConfigToFile(file *os.File) {\n\n    listVal := reflect.ValueOf(c)\n    element := listVal.Elem()\n\n    for i := 0; i &lt; element.NumField(); i++ {\n        field := element.Field(i)\n        myType := reflect.TypeOf(field)\n\n        if myType.Kind() == reflect.Int {\n            file.Write(field.Bytes())\n            } else {\n                file.WriteString(field.String())\n            }\n        }\n}\n</code></pre>\n"}, {"tags": ["go", "pipe", "exec", "goroutine"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492458942, "post_id": 43436751, "comment_id": 73973069, "body": "You have two separate routines running, you should use two separate shutdown channels. Having just one like you do, you have no idea which one will collect the shutdown signal from the channel first, leaving the other to block."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492459421, "post_id": 43436751, "comment_id": 73973325, "body": "Also note that a command cannot be reused after it is run <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#Cmd</a>"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1492460516, "post_id": 43436751, "comment_id": 73973879, "body": "@RayfenWindspear it&#39;s fine to use a single shutdown channel. A read from a closed channel will always return the zero value immediately, so both goroutines will collect the shutdown signal."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492460675, "post_id": 43436751, "comment_id": 73973980, "body": "Ah yes, he is using <code>close</code>. I was confusing <code>pr.ProcessExit</code> with <code>pr.shutdown</code>.  Still, the point has validity if not using close, just isn&#39;t the case here."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492461655, "post_id": 43436751, "comment_id": 73974500, "body": "Here is an example of the solution you kind of suggested, but yes, you still get the case where the go routine reading from io still has no idea when to stop. <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/lRA8S3bv9BM\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/lRA8S3bv9BM</a>"}, {"owner": {"reputation": 573, "user_id": 3060453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423d15544ba61adc93c9d26bbf1639d2?s=128&d=identicon&r=PG", "display_name": "redpix_", "link": "https://stackoverflow.com/users/3060453/redpix"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1492492054, "post_id": 43436751, "comment_id": 73983476, "body": "@RayfenWindspear I&#39;m calling it&#39;s start method, not Run, Output or CombinedOutput, I read about closing channel here: <a href=\"http://www.godesignpatterns.com/2014/04/exiting-multiple-goroutines-simultaneously.html\" rel=\"nofollow noreferrer\">Closing Multiple Goroutines Simultaneously</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1492461897, "post_id": 43459260, "comment_id": 73974615, "body": "I was thinking he didn&#39;t want to close the pipes. He mentioned pausing the <code>cmd</code> by shutting off the goroutines, so I assumed closing them wasn&#39;t an option. My two cents. I like the put in channel case, great idea."}, {"owner": {"reputation": 573, "user_id": 3060453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423d15544ba61adc93c9d26bbf1639d2?s=128&d=identicon&r=PG", "display_name": "redpix_", "link": "https://stackoverflow.com/users/3060453/redpix"}, "edited": false, "score": 0, "creation_date": 1492493329, "post_id": 43459260, "comment_id": 73983958, "body": "@user1431317 Thanks for the answer. At first I had buffer outside of for loop but then the data (bytes) were mixed from I think contiguous reads. I&#39;m not sure how <b>buf[:]</b> behaves just yet. I&#39;m going to try this and I&#39;ll let you know how it goes."}, {"owner": {"reputation": 573, "user_id": 3060453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423d15544ba61adc93c9d26bbf1639d2?s=128&d=identicon&r=PG", "display_name": "redpix_", "link": "https://stackoverflow.com/users/3060453/redpix"}, "edited": false, "score": 0, "creation_date": 1492539698, "post_id": 43459260, "comment_id": 74014571, "body": "@user1431317 Buffer outside the loop cause mix of data from contiguous reads. Is there anything I can do about this? I don&#39;t want to be allocating in for loop. Thanks."}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1492598004, "post_id": 43459260, "comment_id": 74040724, "body": "The problem is that you&#39;re passing the original buffer through the channel, so the goroutine reading from the channel will be using the same buffer, which can be overridden by the next Read in cmdInRoutine.  So you can&#39;t avoid allocation unfortunately."}, {"owner": {"reputation": 573, "user_id": 3060453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423d15544ba61adc93c9d26bbf1639d2?s=128&d=identicon&r=PG", "display_name": "redpix_", "link": "https://stackoverflow.com/users/3060453/redpix"}, "edited": false, "score": 0, "creation_date": 1492620818, "post_id": 43459260, "comment_id": 74057732, "body": "@user1431317 Would the other way be to copy data byte by byte?"}, {"owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "edited": false, "score": 0, "creation_date": 1492677568, "post_id": 43459260, "comment_id": 74082155, "body": "Yes, but you&#39;d have to do it before the channel send, so there&#39;s basically no difference (you could only copy size bytes, but that wouldn&#39;t make much of a difference)."}], "tags": [], "owner": {"reputation": 1795, "user_id": 1431317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565cf25d753bc7b715eac4a21edb4d6?s=128&d=identicon&r=PG", "display_name": "user1431317", "link": "https://stackoverflow.com/users/1431317/user1431317"}, "is_accepted": true, "score": 2, "last_activity_date": 1492598399, "last_edit_date": 1492598399, "creation_date": 1492461773, "answer_id": 43459260, "question_id": 43436751, "link": "https://stackoverflow.com/questions/43436751/how-to-stop-goroutine-blocked-by-external-i-o-started-for-process/43459260#43459260", "title": "How to stop goroutine blocked by external I/O started for process?", "body": "<p>It's probably blocked at <code>pr.stdOutPipe.Read(buf)</code>. You could try closing <code>pr.stdOutPipe</code>, that should interrupt the Read.</p>\n\n<p>You can also close <code>pr.stdInPipe</code>, to make sure the Write doesn't block.</p>\n\n<p><strong>Edit</strong>: This won't allow you to reattach, but there's no other way to interrupt that read. It's probably better to just keep these two goroutines running for the entire process, and pause somewhere else in the stack (e.g. if you don't want to receive the command's output in the paused state, don't write <code>buf</code> to <code>pr.CmdIn</code> - but be careful to avoid race conditions).</p>\n\n<p>Close might be buggy in current versions of go: <a href=\"https://github.com/golang/go/issues/6817\" rel=\"nofollow noreferrer\">issue 6817</a>.</p>\n\n<p><strong>End of edit</strong></p>\n\n<p>Also, be careful with <code>pr.CmdIn</code>. If closing <code>stdOutPipe</code> doesn't cause Read to return an error, <code>cmdInRoutine</code> will try to write to the channel. If nothing reads from it, <code>cmdInRoutine</code> will block forever. I would move <code>pr.stdOutPipe.Read(buf)</code> out of the select, then add <code>pr.CmdIn &lt;- buf[:size]</code> as another case to the select:</p>\n\n<pre><code>func (pr *ExternalProcess) cmdInRoutine() {\n    app.At(te, \"cmdInRoutine\")\n\n    // this check should probably only happen once.\n    // if stdOutPipe can change during the loop,\n    // then that's a race condition.\n    if pr.stdOutPipe == nil {\n        println(\"!!! Standard output pipe is nil. Sending Exit Request !!!\")\n        pr.ProcessExit &lt;- true\n        close(pr.shutdown)\n        return\n    }\n\n    for {\n        println(\"CMDINROUTINE\")\n        // we need to allocate a new buffer in each iteration,\n        // because when we pass it through the channel,\n        // we can no longer safely overwrite the data in it,\n        // since the other goroutine might still be using it.\n        buf := make([]byte, 2048)\n        size, err := pr.stdOutPipe.Read(buf)\n        if err != nil {\n            println(\"!!! Sending exit request from cmdInRoutine !!!\")\n            // Be careful with this, if you also closed pr.shutdown when you closed stdOutPipe, then this is going to panic (closing a closed channel).\n            pr.ProcessExit &lt;- true\n            close(pr.shutdown)\n            return\n        }\n\n        // now that we have some data, try to send it,\n        // unless we're done.\n        select {\n        case &lt;-pr.shutdown:\n            println(\"!!! Shutting cmdInRoutine down !!!\")\n            return\n        case pr.CmdIn &lt;- buf[:size]:\n            println(\"--- Received data for sending to CmdIn:\", string(buf[:size]))\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 573, "user_id": 3060453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/423d15544ba61adc93c9d26bbf1639d2?s=128&d=identicon&r=PG", "display_name": "redpix_", "link": "https://stackoverflow.com/users/3060453/redpix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 2, "accepted_answer_id": 43459260, "answer_count": 1, "score": 2, "last_activity_date": 1492598399, "creation_date": 1492342183, "last_edit_date": 1492494068, "question_id": 43436751, "link": "https://stackoverflow.com/questions/43436751/how-to-stop-goroutine-blocked-by-external-i-o-started-for-process", "title": "How to stop goroutine blocked by external I/O started for process?", "body": "<p>I'm having a problem here that I can't exit goroutine safely.</p>\n\n<p>I'm having an external process created using exec.Command (storing cmd, stdin pipe and stdout pipe of the process):</p>\n\n<pre><code>exec.Command(args[0], args[1]...) // args[0] is a base command\n</code></pre>\n\n<p>Whenever there is a need to start that process I'm calling:</p>\n\n<pre><code>cmd.Start()\n</code></pre>\n\n<p>Then upon start and attaching I'm running 2 goroutines:</p>\n\n<pre><code>shutdown := make(chan struct{})\n// Run the routine which will read from process and send the data to CmdIn channel\ngo pr.cmdInRoutine()\n// Run the routine which will read from CmdOut and write to process\ngo pr.cmdOutRoutine()\n</code></pre>\n\n<p>cmdInRoutine:</p>\n\n<pre><code>func (pr *ExternalProcess) cmdInRoutine() {\n    app.At(te, \"cmdInRoutine\")\n\n    for {\n        println(\"CMDINROUTINE\")\n        select {\n        case &lt;-pr.shutdown:\n            println(\"!!! Shutting cmdInRoutine down !!!\")\n            return\n        default:\n            println(\"Inside the for loop of the CmdInRoutine\")\n            if pr.stdOutPipe == nil {\n                println(\"!!! Standard output pipe is nil. Sending Exit Request !!!\")\n                pr.ProcessExit &lt;- true\n                close(pr.shutdown)\n                return\n            }\n\n            buf := make([]byte, 2048)\n\n            size, err := pr.stdOutPipe.Read(buf)\n            if err != nil {\n                println(\"!!! Sending exit request from cmdInRoutine !!!\")\n                pr.ProcessExit &lt;- true\n                close(pr.shutdown)\n                return\n            }\n\n            println(\"--- Received data for sending to CmdIn:\", string(buf[:size]))\n            pr.CmdIn &lt;- buf[:size]\n        }\n\n    }\n}\n</code></pre>\n\n<p>cmdOutRoutine:</p>\n\n<pre><code>func (pr *ExternalProcess) cmdOutRoutine() {\n    app.At(te, \"cmdOutRoutine\")\n\n    for {\n        select {\n        case &lt;-pr.shutdown:\n            println(\"!!! Shutting cmdOutRoutine down !!!\")\n            return\n        case data := &lt;-pr.CmdOut:\n            println(\"Received data for sending to Process: \", data)\n            if pr.stdInPipe == nil {\n                println(\"!!! Standard input pipe is nil. Sending Exit Request !!!\")\n                pr.ProcessExit &lt;- true\n                return\n            }\n\n            println(\"--- Received input to write to external process:\", string(data))\n            _, err := pr.stdInPipe.Write(append(data, '\\n'))\n            if err != nil {\n                println(\"!!! Couldn't Write To the std in pipe of the process !!!\")\n                pr.ProcessExit &lt;- true\n                return\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Interesting cases here:</p>\n\n<p>1) When process sends EOF (don't mind the <strong>pr.ProcessExit &lt;- true</strong> I was notifying to the parent handler using a channel to stop and exit the process) in <strong>cmdInRoutine</strong> I'm closing the shutdown channel too and this lets <strong>cmdOutRoutine</strong> to exit because inside the select statement there's no default case so it blocks and waits for either exit or data in which then gets written to the running process using stored <strong>stdInPipe</strong>.</p>\n\n<p>2) When I want to just stop goroutines but leave process running i.e kind of pausing the read and write I'm closing the shutdown channel with the hope that those 2 goroutines will end.\n   <br>- <strong>cmdOutRoutine</strong> prints <strong>!!! Shutting cmdOutRoutine down !!!</strong> because select doesn't have default case and closing the shutdown channel causes returning almost immediately\n   <br>- <strong>cmdOutRoutine</strong> doesn't print anything and I'm having a weird feeling that it's not even returning, I think because <strong>It's blocked in the default case at reading from stdInPipe</strong>.</p>\n\n<p>I was thinking of running another goroutine inside the <strong>cmdOutRoutine</strong> before the for loop and have <strong>stdIn</strong> data of the process converted into a channel then I would be able to eliminate default case in <strong>cmdInRoutine</strong> but this creates another problem, that new goroutine also has to be stopped it will still be blocked by the reading from the <strong>stdIn</strong> of the running process.</p>\n\n<p>Any ideas how can I resolve this (modify the logic) to meet the needs of shutting down anytime and starting goroutines (process I/O) but not the running process itself? Or Is there a way to avoid blocking calls of read and write at all, that I'm not aware of yet?</p>\n\n<p>Thanks a lot.</p>\n"}, {"tags": ["csv", "go", "uuid"], "comments": [{"owner": {"reputation": 675, "user_id": 618441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864be5586cec683bf3fe03454b304a5f?s=128&d=identicon&r=PG", "display_name": "AndreasHassing", "link": "https://stackoverflow.com/users/618441/andreashassing"}, "edited": false, "score": 0, "creation_date": 1492340100, "post_id": 43436121, "comment_id": 73929935, "body": "What does the data look like in the CSV file, and what does <code>s</code> look like. By just looking at the lengths it&#39;s hard to see what happens."}, {"owner": {"reputation": 889, "user_id": 1204665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96bc8cdbaf78a0ff513534e4cba22e9d?s=128&d=identicon&r=PG", "display_name": "Slach", "link": "https://stackoverflow.com/users/1204665/slach"}, "reply_to_user": {"reputation": 675, "user_id": 618441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/864be5586cec683bf3fe03454b304a5f?s=128&d=identicon&r=PG", "display_name": "AndreasHassing", "link": "https://stackoverflow.com/users/618441/andreashassing"}, "edited": false, "score": 0, "creation_date": 1492343130, "post_id": 43436121, "comment_id": 73930702, "body": "i need insert FixedString(16) optimized UUID storage into <a href=\"https://github.com/yandex/clickhouse\" rel=\"nofollow noreferrer\">github.com/yandex/clickhouse</a> database"}], "answers": [{"tags": [], "owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "is_accepted": true, "score": 3, "last_activity_date": 1492341257, "last_edit_date": 1492341257, "creation_date": 1492340869, "answer_id": 43436564, "question_id": 43436121, "link": "https://stackoverflow.com/questions/43436121/howto-write-uuid-raw-16-bytes-to-csv-in-golang/43436564#43436564", "title": "Howto write UUID raw 16 bytes to CSV in golang?", "body": "<p>This is because CSV format is not suitable for storing raw binary data, which is unlikely to be a valid utf-8 sequence.</p>\n\n<p>What happens is that when <code>csv_writer.Write</code> <a href=\"https://golang.org/src/encoding/csv/writer.go#L60\" rel=\"nofollow noreferrer\">iterates a string with <code>range</code> loop</a>, every time it encounters an invalid utf-8 sequence, the rune <code>r1</code> gets equal to 65533, which is encoded as 3 bytes: <code>0xef, 0xbf, 0xbd</code>.</p>\n\n<p>Illustrative example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n)\n\nfunc main() {\n    invalidString := string([]byte{0xff, 0xfe, 0xfd})\n    var b bytes.Buffer\n    for _, r := range invalidString {\n        fmt.Printf(\"current rune: %v\\n\", r)\n        b.WriteRune(r)\n    }\n\n    fmt.Printf(\"total data: %v\\n\", b.Bytes())\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>current rune: 65533\ncurrent rune: 65533\ncurrent rune: 65533\ntotal data: [239 191 189 239 191 189 239 191 189]\n</code></pre>\n\n<p>So you should either abandon CSV in favour of some other format (suitable for storing binary data), or store UUIDs in their string form.</p>\n"}], "owner": {"reputation": 889, "user_id": 1204665, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96bc8cdbaf78a0ff513534e4cba22e9d?s=128&d=identicon&r=PG", "display_name": "Slach", "link": "https://stackoverflow.com/users/1204665/slach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 901, "favorite_count": 0, "accepted_answer_id": 43436564, "answer_count": 1, "score": 0, "last_activity_date": 1492341257, "creation_date": 1492337783, "question_id": 43436121, "link": "https://stackoverflow.com/questions/43436121/howto-write-uuid-raw-16-bytes-to-csv-in-golang", "title": "Howto write UUID raw 16 bytes to CSV in golang?", "body": "<p>I have following code, which try save UUID raw 16 bytes (with 0x0A inside) to CSV format</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"github.com/satori/go.uuid\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    u, err := uuid.FromString(\"e1393c62-877a-4adc-8ffb-f1bf0a337c5f\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    csv_file, err := os.OpenFile(\"csv_wtf.csv\", os.O_WRONLY|os.O_CREATE, 0644)\n    if err != nil {\n        log.Fatal(err)\n    }\n    s := string(u.Bytes())\n    log.Printf(\"len(s)=%d\",len(s))\n    csv_writer := csv.NewWriter(csv_file)\n    csv_writer.UseCRLF = false\n    csv_writer.Write([]string{s})\n    csv_writer.Flush()\n    finfo, err := csv_file.Stat()\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"size csv_wtf.csv = %d\", finfo.Size())\n    csv_file.Close()\n}\n</code></pre>\n\n<p>this code output data to csv with add extra bytes</p>\n\n<pre><code>2017/04/16 12:37:14 len(s)=16\n2017/04/16 12:37:14 size csv_wtf.csv = 29\n</code></pre>\n\n<p>why encoding/csv add extra bytes when follow my string over range (see <a href=\"https://golang.org/src/encoding/csv/writer.go#L38\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/csv/writer.go#L38</a>, <a href=\"https://golang.org/src/encoding/csv/writer.go#L50\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/csv/writer.go#L50</a> and <a href=\"https://golang.org/src/encoding/csv/writer.go#L76\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/csv/writer.go#L76</a>)?</p>\n\n<p>could somebody help me find CSV package who don't do it strange conversion ??</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 1536, "user_id": 3207406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3870ef2ee8e67369b0ece69ce315b187?s=128&d=identicon&r=PG", "display_name": "oliverpool", "link": "https://stackoverflow.com/users/3207406/oliverpool"}, "edited": false, "score": 1, "creation_date": 1492330146, "post_id": 43434939, "comment_id": 73927582, "body": "If your actual code is working fine, this could be a better fitted for <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "reply_to_user": {"reputation": 1536, "user_id": 3207406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3870ef2ee8e67369b0ece69ce315b187?s=128&d=identicon&r=PG", "display_name": "oliverpool", "link": "https://stackoverflow.com/users/3207406/oliverpool"}, "edited": false, "score": 0, "creation_date": 1492333599, "post_id": 43434939, "comment_id": 73928358, "body": "@oliverpool I did and it was promptly closed and they suggested I ask here."}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1492336005, "post_id": 43434939, "comment_id": 73928944, "body": "I think you need <code>defer cancel()</code> in the <code>doSomething</code>, otherwise you&#39;ll leak the gorutine when the <code>longRunningFunction</code> completes without being cancelled by the <code>stop</code> channel. You probably should also use <code>context.TODO()</code> instead of <code>context.Background()</code> as in the long run want to replace the stop cannel with context."}], "answers": [{"tags": [], "owner": {"reputation": 1536, "user_id": 3207406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3870ef2ee8e67369b0ece69ce315b187?s=128&d=identicon&r=PG", "display_name": "oliverpool", "link": "https://stackoverflow.com/users/3207406/oliverpool"}, "is_accepted": true, "score": 1, "last_activity_date": 1492366384, "last_edit_date": 1492366384, "creation_date": 1492350602, "answer_id": 43437943, "question_id": 43434939, "link": "https://stackoverflow.com/questions/43434939/is-there-a-more-concise-way-of-creating-a-context-that-is-cancelled-after-receiv/43437943#43437943", "title": "Is there a more concise way of creating a context that is cancelled after receiving on a channel?", "body": "<p>As @ain mentionned, your code currently leaks the goroutine if the <code>longRunningFunction</code> runs to the end and nothing is sent on <code>stop</code> (or it is not closed): the <code>select</code> statement will never be fulfilled (the only way for the <code>context</code> to be done is when something comes out of <code>stop</code> to call <code>cancel</code>).</p>\n\n<p>Here is a way to fix it (mainly an implementation of <a href=\"https://stackoverflow.com/questions/43434939/is-there-a-more-concise-way-of-creating-a-context-that-is-cancelled-after-receiv#comment73928944_43434939\">@ain's comment</a>):</p>\n\n<pre><code>func doSomething(stop &lt;-chan bool) {\n    ctx := context.TODO() // because in the future, you might pass a ctx arg to this function, from which you could then \"inherit\"\n    ctx, cancel := context.WithCancel(ctx)\n    defer cancel() // to be sure to release the associated resources whatever happens (and prevent the following goroutine from leaking)\n    go func() {\n        select {\n        case &lt;-ctx.Done():\n        case &lt;-stop:\n            cancel()\n        }\n    }()\n    longRunningFunction(ctx)\n}\n</code></pre>\n"}], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 43437943, "answer_count": 1, "score": 1, "last_activity_date": 1492366384, "creation_date": 1492328518, "last_edit_date": 1492333692, "question_id": 43434939, "link": "https://stackoverflow.com/questions/43434939/is-there-a-more-concise-way-of-creating-a-context-that-is-cancelled-after-receiv", "title": "Is there a more concise way of creating a context that is cancelled after receiving on a channel?", "body": "<p>I need to invoke a function that takes a <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\"><code>Context</code></a> as a parameter. This block of code has access to a channel that is used for signalling that the operation should be cancelled.</p>\n\n<p>Here is what I am currently using to cancel the <code>Context</code> when a value is received:</p>\n\n<pre><code>func doSomething(stop &lt;-chan bool) {\n    ctx, cancel := context.WithCancel(context.Background())\n    go func() {\n        select {\n        case &lt;-ctx.Done():\n        case &lt;-stop:\n            cancel()\n        }\n    }()\n    longRunningFunction(ctx)\n}\n</code></pre>\n\n<p>The intended control flow is as follows:</p>\n\n<ul>\n<li><p>If the task runs to completion, it will cancel the context, the <code>&lt;-ctx.Done()</code> will fire, and the goroutine will terminate.</p></li>\n<li><p>If a value is received on <code>stop</code>, the context is cancelled, notifying the task that it should quit. Once again, the goroutine will terminate when this happens.</p></li>\n</ul>\n\n<p>This seems overly complex. Is there a simpler way to accomplish the intended behavior?</p>\n"}, {"tags": ["windows", "go", "dll", "arp"], "answers": [{"comments": [{"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "edited": false, "score": 0, "creation_date": 1492508291, "post_id": 43445375, "comment_id": 73992181, "body": "Thanks,I&#39;ve already found the problem: first, <code>net.IPv4</code> returns the IP address (in 16-byte form), not 4-byte form as I thought, second, <code>SendARP</code> expects <code>IPAddr</code> which should be big-endian order for 1st&amp;2nd parameters."}], "tags": [], "owner": {"reputation": 1967, "user_id": 1390507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53335e2b507fd457757eee3a39323159?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1390507/alex"}, "is_accepted": true, "score": 1, "last_activity_date": 1492405029, "creation_date": 1492405029, "answer_id": 43445375, "question_id": 43434765, "link": "https://stackoverflow.com/questions/43434765/sending-arp-request-by-calling-windows-dlls-inside-go-doesnt-work/43445375#43445375", "title": "sending ARP request by calling Windows DLLs inside Go doesn&#39;t work", "body": "<p>Please, try this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"syscall\"\n    \"unsafe\"\n)\n\nvar SendARP = syscall.MustLoadDLL(\"iphlpapi.dll\").MustFindProc(\"SendARP\")\n\nfunc ip4ToUint32(ip net.IP) (uint32, error) {\n    ip = ip.To4()\n    if ip == nil {\n        return 0, fmt.Errorf(\"ip address %v is not ip4\", ip)\n    }\n    var ret uint32\n    for i := 4; i &gt; 0; i-- {\n        ret &lt;&lt;= 8\n        ret += uint32(ip[i-1])\n    }\n    return ret, nil\n}\n\nfunc sendARP(ip net.IP) (net.HardwareAddr, error) {\n    dst, err := ip4ToUint32(ip)\n    if err != nil {\n        return nil, err\n    }\n    mac := []byte{0xff, 0xff, 0xff, 0xff, 0xff, 0xff}\n    n := uint32(len(mac))\n    ret, _, _ := SendARP.Call(\n        uintptr(dst),\n        0,\n        uintptr(unsafe.Pointer(&amp;mac[0])),\n        uintptr(unsafe.Pointer(&amp;n)))\n    if ret != 0 {\n        return nil, syscall.Errno(ret)\n    }\n    return mac, nil\n}\nfunc main() {\n    ip := net.IPv4(192, 168, 1, 1)\n    mac, err := sendARP(ip)\n    if err != nil {\n        log.Fatalf(\"could not find MAC for %q: %v\", ip, err)\n    }\n    fmt.Printf(\"MAC address for %v is %v\\n\", ip, mac)\n}\n</code></pre>\n\n<p>it works for me.</p>\n\n<p>Alex</p>\n"}], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 43445375, "answer_count": 1, "score": -1, "last_activity_date": 1492405029, "creation_date": 1492327031, "question_id": 43434765, "link": "https://stackoverflow.com/questions/43434765/sending-arp-request-by-calling-windows-dlls-inside-go-doesnt-work", "title": "sending ARP request by calling Windows DLLs inside Go doesn&#39;t work", "body": "<p>I'm trying to call a Windows API <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366358(v=vs.85).aspx\" rel=\"nofollow noreferrer\">SendARP</a> from Go to send arp request on Windows, but it always returns <code>1168</code>, AKA <code>ERROR_NOT_FOUND</code>, description by MSDN on this error code:</p>\n\n<blockquote>\n  <p>Element not found. This error is returned on Windows Vista if the the SrcIp parameter does not specify a source IPv4 address on an interface on the local computer or the INADDR_ANY IP address (an IPv4 address of 0.0.0.0).</p>\n</blockquote>\n\n<p>but I'm on Windows 7, moreover I do specify a right source IPv4 address. And I see no ARP packet sent in Wireshark. So where is the problem?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"syscall\"\n    \"net\"\n    \"unsafe\"\n)\n\nvar (\n    iphlp, _   = syscall.LoadLibrary(\"iphlpapi.dll\")\n    SendARP, _ = syscall.GetProcAddress(iphlp, \"SendARP\")\n)\n\nfunc sendARP(src, dst net.IP) {\n    //var nargs uintptr = 4\n    var len uint = 6\n    mac := []byte{0xff, 0xff, 0xff, 0xff, 0xff, 0xff}\n    ret, _, callErr := syscall.Syscall6(\n    uintptr(SendARP), 4,\n    uintptr(unsafe.Pointer(&amp;dst[0])),\n    uintptr(unsafe.Pointer(&amp;src[0])),\n    uintptr(unsafe.Pointer(&amp;mac[0])),\n    uintptr(unsafe.Pointer(&amp;len)),\n    0,\n    0)\n\n    if callErr == 0 {\n        fmt.Printf(\"result %v\\n\", int(ret))\n    }\n}\n\nfunc main() {\n    defer syscall.FreeLibrary(iphlp)\n\n    fmt.Printf(\"addr: %v\\n\", sendARP)\n\n    dst := net.IPv4(192,168,1,1)\n    src := net.IPv4(192,168,1,103)\n    sendARP(src, dst)   \n}\n</code></pre>\n"}, {"tags": ["unix", "go", "epoch"], "comments": [{"owner": {"reputation": 671, "user_id": 7551820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-qFYkSwbZduE/AAAAAAAAAAI/AAAAAAAAAdQ/MmHqIWG-_xQ/photo.jpg?sz=128", "display_name": "Laurence", "link": "https://stackoverflow.com/users/7551820/laurence"}, "edited": false, "score": 3, "creation_date": 1492290717, "post_id": 43431046, "comment_id": 73920433, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24987131/how-to-parse-unix-timestamp-in-golang\">How to parse unix timestamp in golang</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 10, "last_activity_date": 1492288878, "creation_date": 1492288878, "answer_id": 43431083, "question_id": 43431046, "link": "https://stackoverflow.com/questions/43431046/convert-unix-epoch-as-a-string-to-time-time-on-go/43431083#43431083", "title": "Convert Unix epoch as a string to time.Time on Go", "body": "<p>There is no such function in <code>time</code> package, but it's easy to write:</p>\n\n<pre><code>func stringToTime(s string) (time.Time, error) {\n    sec, err := strconv.ParseInt(s, 10, 64)\n    if err != nil {\n        return time.Time{}, err\n    }\n    return time.Unix(sec, 0), nil\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/2h0Vd7plgk\" rel=\"noreferrer\">https://play.golang.org/p/2h0Vd7plgk</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 5, "last_activity_date": 1551517086, "last_edit_date": 1551517086, "creation_date": 1492290323, "answer_id": 43431284, "question_id": 43431046, "link": "https://stackoverflow.com/questions/43431046/convert-unix-epoch-as-a-string-to-time-time-on-go/43431284#43431284", "title": "Convert Unix epoch as a string to time.Time on Go", "body": "<p>There's nothing wrong, or incorrect about the answer provided by @Ainar-G, but likely a better way to do this is with a custom JSON unmarshaler:</p>\n\n<pre><code>type EpochTime time.Time\n\nfunc (et *EpochTime) UnmarshalJSON(data []byte) error {\n    t := strings.Trim(string(data), `\"`) // Remove quote marks from around the JSON string\n    sec, err := strconv.ParseInt(t, 10, 64)\n    if err != nil {\n        return err\n    }\n    epochTime := time.Unix(sec,0)\n    *et = EpochTime(epochTime)\n    return nil\n}\n</code></pre>\n\n<p>Then in your struct, replace <code>time.Time</code> with <code>EpochTime</code>:</p>\n\n<pre><code>type SomeDocument struct {\n    Timestamp EpochTime `json:\"time\"`\n    // other fields\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 2592525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf9fd9479f530292dcba81531aafadf0?s=128&d=identicon&r=PG", "display_name": "Tigger", "link": "https://stackoverflow.com/users/2592525/tigger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5143, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1551517086, "creation_date": 1492288637, "question_id": 43431046, "link": "https://stackoverflow.com/questions/43431046/convert-unix-epoch-as-a-string-to-time-time-on-go", "title": "Convert Unix epoch as a string to time.Time on Go", "body": "<p>I'm reading a JSON file that contains Unix Epoch dates, but they are strings in the JSON.  In Go, can I convert a string in the form \"1490846400\" into a Go time.Time?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492286482, "post_id": 43430410, "comment_id": 73919172, "body": "One question per post, please."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1492286551, "post_id": 43430410, "comment_id": 73919193, "body": "1. Read <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">this</a>. 2. Because it&#39;s valid UTF-8. 3. It accepts a byte array. Why is this a question?"}, {"owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "edited": false, "score": 0, "creation_date": 1492436482, "post_id": 43430410, "comment_id": 73960596, "body": "Hm, question is put on hold <i>as too broad</i>. I agree that the question is not very good, but it&#39;s definitely not broad :)"}], "answers": [{"tags": [], "owner": {"reputation": 9443, "user_id": 1099240, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd46278adf767d035fe304addad99151?s=128&d=identicon&r=PG", "display_name": "Dmitry Frank", "link": "https://stackoverflow.com/users/1099240/dmitry-frank"}, "is_accepted": true, "score": 5, "last_activity_date": 1492286703, "creation_date": 1492286703, "answer_id": 43430711, "question_id": 43430410, "link": "https://stackoverflow.com/questions/43430410/rune-in-golang-and-utf-8/43430711#43430711", "title": "Rune in Golang and UTF-8", "body": "<ol>\n<li><code>rune</code> is an alias for the type <code>int32</code>. It is intended to make programs clear about the cases when an integer value represents a code point.</li>\n<li>Because the sequence of bytes <code>0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0xe4, 0xb8, 0x96, 0xe7, 0x95, 0x8c</code> (which is a representation of the utf-8 string <code>Hello, \u4e16\u754c</code>) is a valid UTF-8 sequence.</li>\n<li>While <code>utf8.Valid</code> accepts only array of bytes (there is no overloading in Go, so the \"only\" part is actually irrelevant), there are a few similar functions to check for validness: <a href=\"https://golang.org/pkg/unicode/utf8/#ValidRune\" rel=\"noreferrer\">utf8.ValidRune</a> and <a href=\"https://golang.org/pkg/unicode/utf8/#ValidString\" rel=\"noreferrer\">utf8.ValidString</a></li>\n</ol>\n\n<p>I recommend reading an awesome article on the Go blog: <a href=\"https://blog.golang.org/strings\" rel=\"noreferrer\">Strings, bytes, runes and characters in Go</a>, I believe after reading it and experimenting a bit you'll get answers to most of your utf8-related questions about Go.</p>\n"}], "owner": {"reputation": 111, "user_id": 7872417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c7138ddb7f4842f89adf86751214641?s=128&d=identicon&r=PG&f=1", "display_name": "RoboNoob", "link": "https://stackoverflow.com/users/7872417/robonoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1127, "favorite_count": 0, "closed_date": 1492302474, "accepted_answer_id": 43430711, "answer_count": 1, "score": -5, "last_activity_date": 1492286703, "creation_date": 1492284805, "question_id": 43430410, "link": "https://stackoverflow.com/questions/43430410/rune-in-golang-and-utf-8", "closed_reason": "Needs more focus", "title": "Rune in Golang and UTF-8", "body": "<ol>\n<li><p>What does \"rune\" mean?</p></li>\n<li><p><a href=\"https://golang.org/pkg/unicode/utf8/#example_Valid\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unicode/utf8/#example_Valid</a> Why is the answer is true in the first line?</p></li>\n<li><p>The function Valid accepts only an array?</p></li>\n</ol>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "is_accepted": true, "score": 4, "last_activity_date": 1492315641, "last_edit_date": 1492315641, "creation_date": 1492285955, "answer_id": 43430612, "question_id": 43430004, "link": "https://stackoverflow.com/questions/43430004/how-to-parse-iso6709-coordinates-in-golang/43430612#43430612", "title": "How to parse ISO6709 coordinates in golang?", "body": "<p>I'm not sure which pieces you would want to extract but the following regex works within your examples to select them all. </p>\n\n<pre><code>(\\+|-)\\d+\\.?\\d+(\\+|-)\\d+\\.?[\\d]+(\\+|-)?[^/]*\n</code></pre>\n\n<p>It does work it out in pieces, and depends on the last / as being a terminator, though if it isn't there would be other ways around it. </p>\n\n<pre><code>(\\+|-)\\d+\\.?\\d+(\\+|-)\\d+\\.?\\d+(\\+|-)?[A-Z_\\d]*\n</code></pre>\n\n<p>Does not rely on the / terminator.</p>\n\n<p>To provide a perfect answer, the context of the coordinates would be required. </p>\n\n<p>here is the code to implement, given a string as input:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    toSearch := \"Atlantic Ocean +00-025/\\nFrance +46+002/\\nParis +48.52+002.20/\\nEiffel Tower +48.8577+002.295/\\nMount Everest +27.5916+086.5640+8850CRSWGS_84/\\nNorth Pole +90+000/\\nPacific Ocean +00-160/\\nSouth Pole -90+000+2800CRSWGS_84/\\nUnited States +38-097/\\nNew York City +40.75-074.00/\\nStatue of Liberty +40.6894-074.0447/\"\n    ISOCoord := regexp.MustCompile(`(\\+|-)\\d+\\.?\\d+(\\+|-)\\d+\\.?\\d+(\\+|-)?[A-Z_\\d]*`)\n    result := ISOCoord.FindAll([]byte(toSearch), 11)\n    for _, v := range result {\n        fmt.Printf(\"%s\\n\", v)\n    }\n}\n</code></pre>\n\n<p>returns: </p>\n\n<pre><code>+00-025\n+46+002\n+48.52+002.20\n+48.8577+002.295\n+27.5916+086.5640+8850CRSWGS_84\n+90+000\n+00-160\n-90+000+2800CRSWGS_84\n+38-097\n+40.75-074.00\n+40.6894-074.0447\n</code></pre>\n\n<p>Given the new idea that you want the 2 sepearate coords, this approch works: </p>\n\n<pre><code>import (\n    \"fmt\"\n    \"regexp\"\n    \"strconv\"\n)\n\ntype coord struct {\n    lat, long float64\n}\n\nfunc main() {\n    toSearch := \"Atlantic Ocean +00-025/\\nFrance +46+002/\\nParis +48.52+002.20/\\nEiffel Tower +48.8577+002.295/\\nMount Everest +27.5916+086.5640+8850CRSWGS_84/\\nNorth Pole +90+000/\\nPacific Ocean +00-160/\\nSouth Pole -90+000+2800CRSWGS_84/\\nUnited States +38-097/\\nNew York City +40.75-074.00/\\nStatue of Liberty +40.6894-074.0447/\"\n    ISOCoord := regexp.MustCompile(`((\\+|-)\\d+\\.?\\d*){2}`)\n    result := ISOCoord.FindAllString(toSearch, -1)\n    INDCoord := regexp.MustCompile(`(\\+|-)\\d+\\.?\\d*`)\n    answer := make([]coord, 11)\n\n    for i, v := range result {\n        temp := INDCoord.FindAllString(v, 2)\n        lat, _ := strconv.ParseFloat(temp[0], 64)\n        lon, _ := strconv.ParseFloat(temp[1], 64)\n        answer[i] = coord{lat, lon}\n    }\n    fmt.Println(answer)\n}\n</code></pre>\n\n<p>The regex is doubled so that it is a little more robust, but it would be faster to only do it once, if it were possible given the input.</p>\n\n<p>The code also should have error checking on the conversions, but you can add that. </p>\n\n<p>Also worth noting that it trims 0's. If you want to maintain those as stated, ie. if 012.1 is not the same as 12.1, you could just leave out the conversion to float and work with the strings. </p>\n\n<p>Code produces as float:</p>\n\n<pre><code>[{0 -25} {46 2} {48.52 2.2} {48.8577 2.295} {27.5916 86.564} {90 0} {0 -160} {-90 0} {38 -97} {40.75 -74} {40.6894 -74.0447}]\n</code></pre>\n\n<p>or </p>\n\n<pre><code>[{+00 -025} {+46 +002} {+48.52 +002.20} {+48.8577 +002.295} {+27.5916 +086.5640} {+90 +000} {+00 -160} {-90 +000} {+38 -097} {+40.75 -074.00} {+40.6894 -074.0447}]\n</code></pre>\n\n<p>as string</p>\n"}], "owner": {"reputation": 297, "user_id": 7467314, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8c4715513d18c3b7c8c20346296c85da?s=128&d=identicon&r=PG&f=1", "display_name": "user7467314", "link": "https://stackoverflow.com/users/7467314/user7467314"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 503, "favorite_count": 0, "accepted_answer_id": 43430612, "answer_count": 1, "score": 0, "last_activity_date": 1492315641, "creation_date": 1492282423, "last_edit_date": 1492299526, "question_id": 43430004, "link": "https://stackoverflow.com/questions/43430004/how-to-parse-iso6709-coordinates-in-golang", "title": "How to parse ISO6709 coordinates in golang?", "body": "<p>Some examples from Wikipedia on <a href=\"https://en.wikipedia.org/wiki/ISO_6709\" rel=\"nofollow noreferrer\">ISO 6709</a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Atlantic Ocean +00-025/\nFrance +46+002/\nParis +48.52+002.20/\nEiffel Tower +48.8577+002.295/\nMount Everest +27.5916+086.5640+8850CRSWGS_84/\nNorth Pole +90+000/\nPacific Ocean +00-160/\nSouth Pole -90+000+2800CRSWGS_84/\nUnited States +38-097/\nNew York City +40.75-074.00/\nStatue of Liberty +40.6894-074.0447/\n</code></pre>\n\n<p>What's the way to parse this since there's no consistent delimiting character? Regex? Read and parse it byte by byte?</p>\n\n<p>To clarify: the desired output is a pair of float32 latitude and longitudes. So for e.g:</p>\n\n<p>input: +40.6894-074.0447/<br>\noutput: 40.6894 and -074.0447</p>\n"}, {"tags": ["go", "tcpserver"], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 0, "creation_date": 1492427058, "post_id": 43427067, "comment_id": 73955922, "body": "Thanks, I used json to convert into []byte using Marshal() function,and then write into net.Conn.Write(). But on the receiving end I am unable to convert it into original form."}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "reply_to_user": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "edited": false, "score": 0, "creation_date": 1492437265, "post_id": 43427067, "comment_id": 73961014, "body": "@Raja Hammad Farooq make sure your objects&#39; fields are exported. Only your package can access internal fields."}, {"owner": {"reputation": 929, "user_id": 1093289, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/yIIK1.jpg?s=128&g=1", "display_name": "beyondfloatingpoint", "link": "https://stackoverflow.com/users/1093289/beyondfloatingpoint"}, "edited": false, "score": 0, "creation_date": 1554971516, "post_id": 43427067, "comment_id": 97947746, "body": "Since these question turns up in Google Search, here is the link to <a href=\"https://stackoverflow.com/questions/20165768/reading-and-writing-on-net-conn\">solution</a>."}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 1, "last_activity_date": 1492265469, "creation_date": 1492265469, "answer_id": 43427067, "question_id": 43426100, "link": "https://stackoverflow.com/questions/43426100/how-to-write-a-user-defined-struct-object-in-net-conn-write/43427067#43427067", "title": "How to write a user defined struct object in net.Conn.Write()", "body": "<p>You have to serialize the object into a <code>[]byte</code> or <code>io.Reader</code></p>\n\n<p>Some solutions in the standard library include <a href=\"https://godoc.org/encoding/gob\" rel=\"nofollow noreferrer\">gob</a> and <a href=\"https://godoc.org/encoding/json\" rel=\"nofollow noreferrer\">json</a>.</p>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "closed_date": 1492308577, "answer_count": 1, "score": 0, "last_activity_date": 1492265469, "creation_date": 1492259536, "last_edit_date": 1492259992, "question_id": 43426100, "link": "https://stackoverflow.com/questions/43426100/how-to-write-a-user-defined-struct-object-in-net-conn-write", "closed_reason": "Needs details or clarity", "title": "How to write a user defined struct object in net.Conn.Write()", "body": "<p>I have a simple TCP server listening on a port. How to write an object of type user defined in <code>net.Conn.Write()</code>?</p>\n\n<p>My code is given below:</p>\n\n<pre><code>func main() {\n    ln, err := net.Listen(\"tcp\", \":2000\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    msgchan := make(chan string)\n    for {\n        conn, err := ln.Accept()\n        if err != nil {\n            log.Println(err)\n            continue\n        }   \n    }\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "edited": false, "score": 0, "creation_date": 1492268281, "post_id": 43426032, "comment_id": 73912841, "body": "Please, clarify: your question is about <code>text&#47;template</code> ? Because <code>text&#47;tempate</code> allows nested template definitions."}], "answers": [{"comments": [{"owner": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492342953, "post_id": 43428047, "comment_id": 73930660, "body": "Is that somehow possible to use with <code>ParseFiles</code>?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492343155, "post_id": 43428047, "comment_id": 73930711, "body": "<code>ParseFiles</code>, <code>ParseGlob</code>... doesn&#39;t matter how you parse the template as longs as you&#39;ve got the func registered with the <code>Funcs</code> method, the resulting template will have access to that func."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492343559, "post_id": 43428047, "comment_id": 73930826, "body": "If you mean the function <code>template.ParseFiles</code> as opposed to the method <code>*Template.ParseFiles</code> then <b>no</b>, because you cannot reference a func that hasn&#39;t been yet registered. So you need to first create a <code>template.Template</code> with <code>template.New</code> then register the functions you want to use, and then call the <code>ParseFiles</code> method on that template."}, {"owner": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492344001, "post_id": 43428047, "comment_id": 73930942, "body": "at first, thanks for your help and sorry for making this more complicated then it should.  For my case it does not working I made a non working example here <a href=\"https://play.golang.org/p/lJrfBs--d5\" rel=\"nofollow noreferrer\">play.golang.org/p/lJrfBs--d5</a>  but never the less I think that is the right direction and I will find the solution sooner or later I guess :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492344656, "post_id": 43428047, "comment_id": 73931100, "body": "The snippet in the answer is just an approx example. <code>ParseFiles</code> returns two values not one, a <code>*Template</code> and an <code>error</code> value, so instead of <code>t := ...</code> do <code>t, err := ...</code> or wrap the whole <code>ParseFiles</code> call into the <code>template.Must</code> func as is in the playground example of my answer. I&#39;ll update the snippet to reflect this."}, {"owner": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492344914, "post_id": 43428047, "comment_id": 73931162, "body": "I got it working, here is also a good example <a href=\"http://goinbigdata.com/example-of-using-templates-in-golang/\" rel=\"nofollow noreferrer\">goinbigdata.com/example-of-using-templates-in-golang</a>   Thank you"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "edited": false, "score": 0, "creation_date": 1492344996, "post_id": 43428047, "comment_id": 73931181, "body": "No problem, I&#39;m glad you got it working."}, {"owner": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 0, "creation_date": 1529844979, "post_id": 43428047, "comment_id": 89012910, "body": "Is this thread-safe?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 7096, "user_id": 3990767, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a5741a212e3b0e6bd46a8a1e6d76a4a?s=128&d=identicon&r=PG", "display_name": "SOFe", "link": "https://stackoverflow.com/users/3990767/sofe"}, "edited": false, "score": 1, "creation_date": 1529845500, "post_id": 43428047, "comment_id": 89013042, "body": "@SOFe Depends on what you mean exaclty, do you have a specific concern regarding specific value types? If you&#39;re passing non-pointer values around then it ought to be safe for concurrent use, if on the other hand you&#39;re passing around pointer values then you might run into issues, but Go&#39;s <code>sync</code> package provides you with enough tools to implement a concurrency-safe solution."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 6, "last_activity_date": 1492344673, "last_edit_date": 1492344673, "creation_date": 1492271222, "answer_id": 43428047, "question_id": 43426032, "link": "https://stackoverflow.com/questions/43426032/pass-data-between-templates/43428047#43428047", "title": "Pass data between templates", "body": "<p>I'm not sure whether there exists a builtin solution for passing multiple arguments to a template invocation but, in case there isn't one, you could define a function that merges its arguments and returns them as a single slice value, then you can register that function and use it in the template invocation.</p>\n\n<p>Something like:</p>\n\n<pre><code>func args(vs ...interface{}) []interface{} { return vs }\nt, err := template.New(\"t\").Funcs(template.FuncMap{\"args\":args}).Parse...\n</code></pre>\n\n<p>Then, in your <code>index.html</code>, you would do this:</p>\n\n<pre><code>{{ template \"image_row\" args . 5 }}\n</code></pre>\n\n<p>And then inside your <code>image_row</code> template you can access the arguments with the builtin <code>index</code> function like this:</p>\n\n<pre><code>{{ define \"image_row\" }}\n\n   To stuff here {{index . 0}} {{index . 1}}\n\n{{ end }}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gkdtvvJ1bb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gkdtvvJ1bb</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1492347403, "last_edit_date": 1492347403, "creation_date": 1492274660, "answer_id": 43428608, "question_id": 43426032, "link": "https://stackoverflow.com/questions/43426032/pass-data-between-templates/43428608#43428608", "title": "Pass data between templates", "body": "<p>There is no builtin for this. You can add a function that creates a map and use that in the child template:</p>\n\n<pre><code>func argsfn(kvs ...interface{}) (map[string]interface{}, error) {\n  if len(kvs)%2 != 0 {\n    return nil, errors.New(\"args requires even number of arguments.\")\n  }\n  m := make(map[string]interface{})\n  for i := 0; i &lt; len(kvs); i += 2 {\n    s, ok := kvs[i].(string)\n    if !ok {\n        return nil, errors.New(\"even args to args must be strings.\")\n    }\n    m[s] = kvs[i+1]\n  }\n  return m, nil\n}\n</code></pre>\n\n<p>Add it the function to the template like this:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Funcs(template.FuncMap{\"args\": argsfn}).Parse(......\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>{{template \"image_row\" args \"row\" . \"a\" 5}}{{end}}\n\n{{define \"image_row\"}}\n     {{$.row}} {{$.a}}\n{{end}}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gMEmKTHqk9\" rel=\"nofollow noreferrer\">Run it in the playground</a></p>\n\n<p>The advantage of using a map is that the arguments are \"named\". The advantage of using a slice as described in another answer is that the code is much simpler.</p>\n"}], "owner": {"reputation": 2489, "user_id": 1923869, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zLRld.jpg?s=128&g=1", "display_name": "xhallix", "link": "https://stackoverflow.com/users/1923869/xhallix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1888, "favorite_count": 1, "closed_date": 1492348175, "accepted_answer_id": 43428047, "answer_count": 2, "score": 4, "last_activity_date": 1492347403, "creation_date": 1492259117, "last_edit_date": 1492281989, "question_id": 43426032, "link": "https://stackoverflow.com/questions/43426032/pass-data-between-templates", "closed_reason": "Duplicate", "title": "Pass data between templates", "body": "<p>I have simple case, where a templates <code>(text/templates)</code> includes another like this</p>\n\n<pre><code>`index.html`\n\n{{ template \"image_row\" . }}\n\n\n`image_row.html`\n\n{{ define \"image_row\" }}\n\n   To stuff here\n\n{{ end }}\n</code></pre>\n\n<p>Now I want to reuse the image row template. Let's say I would like to pass a simple number, so that the image_row template builds up rows according to this number</p>\n\n<p>I'd like to have something like that (where 5 is the additional argument)</p>\n\n<p><code>index.html</code></p>\n\n<pre><code>{{ template \"image_row\" . | 5 }}\n</code></pre>\n\n<p>How could I achieve that in this case?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1492268007, "post_id": 43425951, "comment_id": 73912751, "body": "In my experience, &quot;may be a bug of compiler or runtime&quot;, is way less likely than &quot;may be bug in my own code.&quot; Sure it happens sometimes that the compiler or runtime is broken, but it&#39;s pretty rare. The pragmatic programmer book describes this idea with the motto &#39;&quot;select&quot; isn&#39;t broken&#39;"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1492274844, "post_id": 43425951, "comment_id": 73915132, "body": "<a href=\"https://en.oxforddictionaries.com/definition/a_bad_workman_always_blames_his_tools\" rel=\"nofollow noreferrer\">a bad workman always blames his tools</a>: proverb: A person who has done something badly will seek to lay the blame on their equipment rather than admit their own lack of skill."}, {"owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1492321306, "post_id": 43425951, "comment_id": 73925807, "body": "@peterSO Got it. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "edited": false, "score": 0, "creation_date": 1492270135, "post_id": 43427416, "comment_id": 73913551, "body": "It&#39;s really a trap that to be beyond comprehension. I see you are right, but it&#39;s not natural for my understanding. I think <code>append(lst, i)</code> should allocate an array which size should be <code>len(lst)+1</code>, and copy the content of <code>lst</code> and <code>i</code> to the new array. Could you explain more details for this case? And when will happen?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "edited": false, "score": 2, "creation_date": 1492272757, "post_id": 43427416, "comment_id": 73914454, "body": "A new underlying array is allocated only if the appended element doesn&#39;t fit in the current array. See: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>"}, {"owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "edited": false, "score": 0, "creation_date": 1492321283, "post_id": 43427416, "comment_id": 73925801, "body": "Got it. Thanks a lot!"}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1492267667, "creation_date": 1492267667, "answer_id": 43427416, "question_id": 43425951, "link": "https://stackoverflow.com/questions/43425951/unexpectedly-the-result-for-my-code-based-on-mapintint/43427416#43427416", "title": "Unexpectedly the result for my code based on `map[int][][]int`", "body": "<p>In this code, your slices may alias each other:</p>\n\n<pre><code>newlist := make([][]int, 0)\nfor _, lst := range m[level-1] {\n    for i := 0; i &lt; n; i++ {\n        if i &gt; lst[len(lst)-1] {\n            newlst := append(lst, i)\n            newlist = append(newlist, newlst)\n</code></pre>\n\n<p>You're appending <code>i</code> to a previously computed slice, which may or may not reallocate the underlying array. When it doesn't, each <code>newlst</code> reuses the same underlying array, so in earlier versions of <code>newlst</code>, values are overwritten by later versions of <code>newlst</code>.</p>\n\n<p>You need to force the new slices to use new underlying arrays by copying the data:</p>\n\n<pre><code>newlst := append([]int{}, lst...)\nnewlst = append(newlst, i)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lNPa3KS_Ql\" rel=\"nofollow noreferrer\">Here's a playground version of the fixed code.</a></p>\n"}], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 43427416, "answer_count": 1, "score": 1, "last_activity_date": 1492267667, "creation_date": 1492258515, "question_id": 43425951, "link": "https://stackoverflow.com/questions/43425951/unexpectedly-the-result-for-my-code-based-on-mapintint", "title": "Unexpectedly the result for my code based on `map[int][][]int`", "body": "<p>I ran my code in Go versions 1.7.4, 1.8, 1.8.1 on Linux(Ubuntu 1604)/amd64</p>\n\n<p>I'm trying to use a structure <code>m := map[int][][]int</code> to write a code to do something below.</p>\n\n<p>For an array <code>numbers := []int{0,1,2,3,4}</code>, let <code>m[0] = [][]int{[]int{0}, []int{1}, []int{2}, []int{3}, []int{4}}</code>,\nand append a number <code>n</code> within <code>numbers</code> to all list of <code>m[i]</code>, then <code>m[1]</code> as below.</p>\n\n<p><code>m[1] -&gt; [[0,1], [0,2],..,[0,4],[1,2],[1,3],..,[1,4],...,,[2,3],[2,4],[3,4]]</code></p>\n\n<p>and so on for <code>m[2] -&gt; [[0,1,2],[0,1,3],.....]</code>, <code>m[3]</code>, <code>m[4]</code></p>\n\n<p>Here is my code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    n := 5\n    m := make(map[int][][]int)\n    list := make([][]int, 0)\n    for i := 0; i &lt; n; i++ {\n        list = append(list, []int{i})\n    }\n    m[0] = list\n    fmt.Println(m)\n    for level := 1; level &lt; n; level++ {\n        newlist := make([][]int, 0)\n        for _, lst := range m[level-1] {\n            for i := 0; i &lt; n; i++ {\n                if i &gt; lst[len(lst)-1] {\n                    newlst := append(lst, i)\n                    newlist = append(newlist, newlst)\n                    fmt.Println(level, \":\", lst, i, \"-&gt;\", newlst, \"=&gt;\", newlist)\n                }\n            }\n        }\n        m[level] = newlist\n    }\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>And the output as below.</p>\n\n<pre><code>map[0:[[0] [1] [2] [3] [4]]]\n1 : [0] 1 -&gt; [0 1] =&gt; [[0 1]]\n1 : [0] 2 -&gt; [0 2] =&gt; [[0 1] [0 2]]\n1 : [0] 3 -&gt; [0 3] =&gt; [[0 1] [0 2] [0 3]]\n1 : [0] 4 -&gt; [0 4] =&gt; [[0 1] [0 2] [0 3] [0 4]]\n1 : [1] 2 -&gt; [1 2] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2]]\n1 : [1] 3 -&gt; [1 3] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2] [1 3]]\n1 : [1] 4 -&gt; [1 4] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2] [1 3] [1 4]]\n1 : [2] 3 -&gt; [2 3] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2] [1 3] [1 4] [2 3]]\n1 : [2] 4 -&gt; [2 4] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2] [1 3] [1 4] [2 3] [2 4]]\n1 : [3] 4 -&gt; [3 4] =&gt; [[0 1] [0 2] [0 3] [0 4] [1 2] [1 3] [1 4] [2 3] [2 4] [3 4]]\n2 : [0 1] 2 -&gt; [0 1 2] =&gt; [[0 1 2]]\n2 : [0 1] 3 -&gt; [0 1 3] =&gt; [[0 1 2] [0 1 3]]\n2 : [0 1] 4 -&gt; [0 1 4] =&gt; [[0 1 2] [0 1 3] [0 1 4]]\n2 : [0 2] 3 -&gt; [0 2 3] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3]]\n2 : [0 2] 4 -&gt; [0 2 4] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4]]\n2 : [0 3] 4 -&gt; [0 3 4] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4]]\n2 : [1 2] 3 -&gt; [1 2 3] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4] [1 2 3]]\n2 : [1 2] 4 -&gt; [1 2 4] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4] [1 2 3] [1 2 4]]\n2 : [1 3] 4 -&gt; [1 3 4] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4] [1 2 3] [1 2 4] [1 3 4]]\n2 : [2 3] 4 -&gt; [2 3 4] =&gt; [[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4] [1 2 3] [1 2 4] [1 3 4] [2 3 4]]\n3 : [0 1 2] 3 -&gt; [0 1 2 3] =&gt; [[0 1 2 3]]\n3 : [0 1 2] 4 -&gt; [0 1 2 4] =&gt; [[0 1 2 4] [0 1 2 4]]\n3 : [0 1 3] 4 -&gt; [0 1 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4]]\n3 : [0 2 3] 4 -&gt; [0 2 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4] [0 2 3 4]]\n3 : [1 2 3] 4 -&gt; [1 2 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4] [0 2 3 4] [1 2 3 4]]\nmap[4:[] 0:[[0] [1] [2] [3] [4]] 1:[[0 1] [0 2] [0 3] [0 4] [1 2] [1 3] [1 4] [2 3] [2 4] [3 4]] 2:[[0 1 2] [0 1 3] [0 1 4] [0 2 3] [0 2 4] [0 3 4] [1 2 3] [1 2 4] [1 3 4] [2 3 4]] 3:[[0 1 2 4] [0 1 2 4] [0 1 3 4] [0 2 3 4] [1 2 3 4]]]\n</code></pre>\n\n<p>The issue at here.</p>\n\n<pre><code>3 : [0 1 2] 3 -&gt; [0 1 2 3] =&gt; [[0 1 2 3]]\n3 : [0 1 2] 4 -&gt; [0 1 2 4] =&gt; [[0 1 2 4] [0 1 2 4]]           \n3 : [0 1 3] 4 -&gt; [0 1 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4]]\n3 : [0 2 3] 4 -&gt; [0 2 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4] [0 2 3 4]]\n3 : [1 2 3] 4 -&gt; [1 2 3 4] =&gt; [[0 1 2 4] [0 1 2 4] [0 1 3 4] [0 2 3 4] [1 2 3 4]]\n</code></pre>\n\n<p>The correct output should be:</p>\n\n<pre><code>3 : [0 1 2] 3 -&gt; [0 1 2 3] =&gt; [[0 1 2 3]]\n3 : [0 1 2] 4 -&gt; [0 1 2 4] =&gt; [[0 1 2 **3**] [0 1 2 4]]           \n3 : [0 1 3] 4 -&gt; [0 1 3 4] =&gt; [[0 1 2 **3**] [0 1 2 4] [0 1 3 4]]\n3 : [0 2 3] 4 -&gt; [0 2 3 4] =&gt; [[0 1 2 **3**] [0 1 2 4] [0 1 3 4] [0 2 3 4]]\n3 : [1 2 3] 4 -&gt; [1 2 3 4] =&gt; [[0 1 2 **3**] [0 1 2 4] [0 1 3 4] [0 2 3 4] [1 2 3 4]]\n</code></pre>\n\n<p>I don't know why, but I think it may be a bug of Go compiler or runtime.</p>\n\n<p>What reason of the issue? Maybe a Go bug or just my code mistake. How to solve it if a bug for Go or my code? Cheers!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7786269, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/455216d85d82028c9ad8c9f062165cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Higeath", "link": "https://stackoverflow.com/users/7786269/higeath"}, "edited": false, "score": 0, "creation_date": 1492263288, "post_id": 43425767, "comment_id": 73911207, "body": "I have copied the exact structure you are using but I&#39;m still getting 404 not found and image might help: <a href=\"http://imgur.com/a/J2ep0\" rel=\"nofollow noreferrer\">imgur.com/a/J2ep0</a>"}], "tags": [], "owner": {"reputation": 3377, "user_id": 3438405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bacfe7cf1712f9858bebaf738438718?s=128&d=identicon&r=PG&f=1", "display_name": "The F", "link": "https://stackoverflow.com/users/3438405/the-f"}, "is_accepted": true, "score": 8, "last_activity_date": 1492606855, "last_edit_date": 1492606855, "creation_date": 1492257375, "answer_id": 43425767, "question_id": 43425594, "link": "https://stackoverflow.com/questions/43425594/serve-static-files-via-http-with-go/43425767#43425767", "title": "Serve static files via http with go", "body": "<p>To serve files via http, define a FileServer for a directory and route it to, for example, <code>\"/assets/\"</code> using <code>http.Handle</code>. <br/>Following setup should work for you:</p>\n\n<p>directory structure:</p>\n\n<pre><code>\u251c\u2500\u2500 assets/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 js\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 css\n\u251c\u2500\u2500 templates/\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<p>main.go</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", rootHandler)\n    http.Handle(\"/assets/\", http.StripPrefix(\"/assets/\", http.FileServer(http.Dir(\"assets\"))))\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"templates/index.html\")\n}\n</code></pre>\n\n<p>in your template file:</p>\n\n<pre><code>&lt;script src=\"/assets/js/app.js\"&gt;&lt;/script&gt;\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 7786269, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/455216d85d82028c9ad8c9f062165cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Higeath", "link": "https://stackoverflow.com/users/7786269/higeath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2799, "favorite_count": 1, "accepted_answer_id": 43425767, "answer_count": 1, "score": 4, "last_activity_date": 1492642675, "creation_date": 1492256396, "last_edit_date": 1492642675, "question_id": 43425594, "link": "https://stackoverflow.com/questions/43425594/serve-static-files-via-http-with-go", "title": "Serve static files via http with go", "body": "<p>In my html I'm trying to include JS using</p>\n\n<pre><code>&lt;script src=\"/js/app.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>I have also tried relative path (from server location)</p>\n\n<pre><code>&lt;script src=\"js/app.js\"&gt;&lt;/script&gt;\n</code></pre>\n\n<p>and relative from the html file \n    </p>\n\n<p>My file structure</p>\n\n<pre><code>-js\n    app.js\n-templates\n    index.html\nhub.go\nmain.go\n</code></pre>\n\n<p>main.go is the server</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", rootHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"Templates/index.html\")\n}\n</code></pre>\n\n<p>Am I missing something do I have to server css/js through server? or should the simple html work</p>\n"}, {"tags": ["http", "go", "webserver", "port"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 83, "last_activity_date": 1492268560, "last_edit_date": 1492268560, "creation_date": 1492255499, "answer_id": 43425461, "question_id": 43424787, "link": "https://stackoverflow.com/questions/43424787/how-to-use-next-available-port-in-http-listenandserve/43425461#43425461", "title": "How to use next available port in http.ListenAndServe", "body": "<p>You may use port <code>0</code> to indicate you're not specifying an exact port but you want a free, available port selected by the system:</p>\n\n<pre><code>http.ListenAndServe(\":0\", nil)\n</code></pre>\n\n<p>The problem with this is that you won't be able to find out what port was assigned. So you need to create the <a href=\"https://golang.org/pkg/net/#Listener\" rel=\"noreferrer\"><code>net.Listener</code></a> yourself (using the <a href=\"https://golang.org/pkg/net/#Listen\" rel=\"noreferrer\"><code>net.Listen()</code></a> function), and manually pass it to <a href=\"https://golang.org/pkg/net/http/#Serve\" rel=\"noreferrer\"><code>http.Serve()</code></a>:</p>\n\n<pre><code>listener, err := net.Listen(\"tcp\", \":0\")\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(\"Using port:\", listener.Addr().(*net.TCPAddr).Port)\n\npanic(http.Serve(listener, nil))\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>Using port: 42039\n</code></pre>\n\n<p>As you can see, you can access the assigned port from the <code>net.Listener</code>, from its <a href=\"https://golang.org/pkg/net/#Addr\" rel=\"noreferrer\"><code>net.Addr</code></a> address (acquired by its <code>Addr()</code> method). <code>net.Addr</code> does not directly give access to the port, but since we created the <code>net.Listener</code> using <code>tcp</code> network stream, the <code>net.Addr</code> will be of dynamic type <a href=\"https://golang.org/pkg/net/#TCPAddr\" rel=\"noreferrer\"><code>*net.TCPAddr</code></a> (which we can acquire with a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"noreferrer\">type assertion</a>), which is a struct and has a field <code>Port int</code>.</p>\n\n<p>Note that if you don't need the port in your application (e.g. you just want to display it for yourself), you don't need the type assertion, you can just print <code>listener.Addr()</code> (which will contain the port at the end):</p>\n\n<pre><code>fmt.Println(\"Address:\", listener.Addr())\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>Address: [::]:42039\n</code></pre>\n\n<p>Also don't forget to handle returned errors (<code>http.ListenAndServe()</code> in this case). In my example I simply passed it to <code>panic()</code> because <code>http.LitenAndServe()</code> and <code>http.Serve()</code> block if everything goes well (so they only return if there's an error, which I pass to <code>panic()</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 432, "user_id": 2017049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f93ef0a577c1fceee8d66d5f60e3d21?s=128&d=identicon&r=PG&f=1", "display_name": "lionello", "link": "https://stackoverflow.com/users/2017049/lionello"}, "is_accepted": false, "score": 2, "last_activity_date": 1613520762, "creation_date": 1613520762, "answer_id": 66234025, "question_id": 43424787, "link": "https://stackoverflow.com/questions/43424787/how-to-use-next-available-port-in-http-listenandserve/66234025#66234025", "title": "How to use next available port in http.ListenAndServe", "body": "<p>I landed on this page because I wanted to start a new server on a random port for testing purposes. I later learned about the <code>httptest</code> package, <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/httptest/</a> , which does a much better job of managing temporary HTTP server for testing.</p>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16245, "favorite_count": 9, "accepted_answer_id": 43425461, "answer_count": 2, "score": 39, "last_activity_date": 1613520762, "creation_date": 1492251146, "last_edit_date": 1492280552, "question_id": 43424787, "link": "https://stackoverflow.com/questions/43424787/how-to-use-next-available-port-in-http-listenandserve", "title": "How to use next available port in http.ListenAndServe", "body": "<p>I wrote a simple web server to listen on port 8080. But I don't want to use a hard coded port number. What I want is that my server listen on any available port. And I want to know that on what port number my web server is listening.</p>\n\n<p>My code is given bellow:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {       \n    http.HandleFunc(\"/\", handler)\n    http.ListenAndServe(\":8080\", nil)\n\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "cassandra", "gocql"], "comments": [{"owner": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492235932, "post_id": 43422152, "comment_id": 73904159, "body": "can you provide notedool status and cassandra.yaml file from one of the nodes? I wouldn&#39;t really change the protocol version at all."}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "reply_to_user": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492236306, "post_id": 43422152, "comment_id": 73904241, "body": "I&#39;m not entirely sure what to look for. But when i type &quot;nodetool status&quot; on the command promt, this is what i get.    <b>Datacenter: datacenter1 ======================== Status=Up/Down |/ State=Normal/Leaving/Joining/Moving --  Address    Load       Tokens       Owns (effective)  Host ID                               Rack UN  127.0.0.1  182.43 KB  256          100.0%            ###some host ID  rack1</b>"}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "reply_to_user": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492236716, "post_id": 43422152, "comment_id": 73904331, "body": "the cassandra.yaml file is large. Is there any information in particular that you want from the cassandra.yaml file?  If it helps, i haven&#39;t changed anything in it. It is just as it was when i downloaded cassandra"}, {"owner": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492298462, "post_id": 43422152, "comment_id": 73922176, "body": "Any luck with 127.0.0.1?"}, {"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "reply_to_user": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492364376, "post_id": 43422152, "comment_id": 73937138, "body": "Yeah.... 127.0.0.1 works. Thanks!   Sorry for the late reply"}, {"owner": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "edited": false, "score": 0, "creation_date": 1492365396, "post_id": 43422152, "comment_id": 73937470, "body": "No problem man :) always glad to help"}], "answers": [{"comments": [{"owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "edited": false, "score": 0, "creation_date": 1492234294, "post_id": 43422426, "comment_id": 73903818, "body": "I initially set the protocol to 4. And it still produced the same error message."}], "tags": [], "owner": {"reputation": 1963, "user_id": 7413631, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EA5YX.jpg?s=128&g=1", "display_name": "Marko \u0160valjek", "link": "https://stackoverflow.com/users/7413631/marko-%c5%a0valjek"}, "is_accepted": false, "score": 2, "last_activity_date": 1492239027, "last_edit_date": 1492239027, "creation_date": 1492232998, "answer_id": 43422426, "question_id": 43422152, "link": "https://stackoverflow.com/questions/43422152/unable-to-create-session-connecting-to-cassandra/43422426#43422426", "title": "Unable to create session connecting to Cassandra", "body": "<p>Looks like the ip addresses are not according to the cluster situation on your computer. After giving me the nodetool status I think you should update the <code>cluster := gocql.NewCluster</code> to have just the <code>127.0.0.1</code> address and not the addresses from example.</p>\n\n<p>I think in reality you are just running single node cassandra local instance. Which is fine for development.</p>\n\n<p>Basically:</p>\n\n<pre><code>cluster := gocql.NewCluster(\"127.0.0.1\")\n</code></pre>\n\n<p>and just drop this line all together</p>\n\n<pre><code>cluster.ProtoVersion = 3\n</code></pre>\n"}], "owner": {"reputation": 926, "user_id": 3083825, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/a0acf64bb8976dcf3dc0a2a1e3994ca8?s=128&d=identicon&r=PG", "display_name": "SomeGuyFortune", "link": "https://stackoverflow.com/users/3083825/someguyfortune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2434, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1492239027, "creation_date": 1492229963, "last_edit_date": 1492230554, "question_id": 43422152, "link": "https://stackoverflow.com/questions/43422152/unable-to-create-session-connecting-to-cassandra", "title": "Unable to create session connecting to Cassandra", "body": "<p>I am using this <a href=\"https://github.com/gocql/gocql\" rel=\"nofollow noreferrer\">gocql</a> package.</p>\n\n<p>I am trying to get this example working. </p>\n\n<pre><code>func main() {\n    // connect to the cluster\n    cluster := gocql.NewCluster(\"192.168.1.1\", \"192.168.1.2\", \"192.168.1.3\")\n    cluster.ProtoVersion = 3\n    cluster.Keyspace = \"example\"\n    cluster.Consistency = gocql.Quorum\n    session, err := cluster.CreateSession()\n    defer session.Close()\n    if err != nil {\n       fmt.Printf(\"%v\\n\", err)\n       return\n    }\n\n    uuid := gocql.TimeUUID()\n    fmt.Printf(\"UUID : %v\", uuid)\n\n    query := session.Query(`INSERT INTO tweet (timeline, id, text) VALUES         \n    (?, ?, ?)`, \"me\", uuid, \"hello world\")\n\n    fmt.Println(\"About to exec\")\n    err = query.Exec()\n\n    // insert a tweet\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var id gocql.UUID\n    var text string\n\n    /* Search for a specific set of records whose 'timeline' column matches\n     * the value 'me'. The secondary index that we created earlier will be\n     * used for optimizing the search */\n    if err := session.Query(`SELECT id, text FROM tweet WHERE timeline = ?     \n    LIMIT 1`,\"me\").Consistency(gocql.One).Scan(&amp;id, &amp;text); err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"Tweet:\", id, text)\n\n    // list all tweets\n    iter := session.Query(`SELECT id, text FROM tweet WHERE timeline = ?`, \n    \"me\").Iter()\n    for iter.Scan(&amp;id, &amp;text) {\n        fmt.Println(\"Tweet:\", id, text)\n    }\n    if err := iter.Close(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>Using the Cassandra shell I have created the keyspace \"example\" and the table \"tweet\" and they all work fine.</p>\n\n<p>However, when I run the program, it gives me this error:</p>\n\n<pre><code>2017/04/14 20:52:55 gocql: unable to dial control conn 192.168.1.3: dial tcp     \n192.168.1.3:9042: i/o timeout\ngocql: unable to create session: control: unable to connect to initial \nhosts: dial tcp 192.168.1.3:9042: i/o timeoutpanic: runtime error: invalid \nmemory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x0 pc=0x60236d]\n\ngoroutine 1 [running]:\ngithub.com/gocql/gocql.(*Session).Close(0x0)\n    /home/mda/.local/go/src/github.com/gocql/gocql/session.go:344 +0x2d\n</code></pre>\n\n<p>For some reason, gocql is unable to dial the localhost connection, and it times out. I am not sure how to fix this and a stackoverflow and google search hasn't helped so far. </p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492217797, "post_id": 43421062, "comment_id": 73901093, "body": "<code>strings.Split</code> is returning a slice of just one element if you&#39;re getting an index out of range error."}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492218003, "post_id": 43421062, "comment_id": 73901124, "body": "But with the input of 2[space]3 why would strings.Split() only return a slice of 1?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492218034, "post_id": 43421062, "comment_id": 73901127, "body": "Are you sure that&#39;s what the input is?"}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492218117, "post_id": 43421062, "comment_id": 73901143, "body": "Er I typed it myself so yes.  Is it possible that Scanln includes some \\n char or something. This still shouldn&#39;t cause any issues?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 2, "creation_date": 1492218156, "post_id": 43421062, "comment_id": 73901150, "body": ":D - I&#39;ll try it locally myself, but you could inspect the string before you split it to validate your assumptions"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1492218242, "post_id": 43421062, "comment_id": 73901162, "body": "I just tried it locally and it seems to work fine for me... What operating system are you on?"}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1492218357, "post_id": 43421062, "comment_id": 73901182, "body": "Windows :(   I narrowed it down though. The string is in fact 2 when 2 3 is inputted."}], "answers": [{"comments": [{"owner": {"reputation": 18829, "user_id": 24998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c14a4f2931fa9336fdccdfe11318fef?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/24998/jack"}, "edited": false, "score": 0, "creation_date": 1492218867, "post_id": 43421151, "comment_id": 73901266, "body": "<a href=\"http://stackoverflow.com/questions/34647039/how-to-use-fmt-scanln-read-from-a-string-separated-by-spaces\" title=\"how to use fmt scanln read from a string separated by spaces\">stackoverflow.com/questions/34647039/&hellip;</a>"}, {"owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "edited": false, "score": 1, "creation_date": 1498879020, "post_id": 43421151, "comment_id": 76694504, "body": "@Dean But this won&#39;t solve the problem if you have unknown number of inputs. Added to that, declaring more variables is a bad practice .  Better to use bufio scanner"}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "edited": false, "score": 0, "creation_date": 1499030913, "post_id": 43421151, "comment_id": 76729111, "body": "The two inputs are the width and height of a 2d object so number of inputs will always be two. However your suggestion is better in the cases you outlined so I set it as the best answer. :)"}], "tags": [], "owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "is_accepted": false, "score": 0, "last_activity_date": 1492218843, "creation_date": 1492218843, "answer_id": 43421151, "question_id": 43421062, "link": "https://stackoverflow.com/questions/43421062/strings-split-stdin-not-returning-slice-array/43421151#43421151", "title": "strings.Split, stdin not returning slice/array", "body": "<p>Scanln seemed to only read until a space so I solved this problem by using an extra string</p>\n\n<pre><code>fmt.Scanln(&amp;in, &amp;in1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 2068742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531732e06128a2c69f720d9abefbc464?s=128&d=identicon&r=PG", "display_name": "AvnishSingh", "link": "https://stackoverflow.com/users/2068742/avnishsingh"}, "is_accepted": false, "score": 1, "last_activity_date": 1492300383, "last_edit_date": 1492300383, "creation_date": 1492227286, "answer_id": 43421911, "question_id": 43421062, "link": "https://stackoverflow.com/questions/43421062/strings-split-stdin-not-returning-slice-array/43421911#43421911", "title": "strings.Split, stdin not returning slice/array", "body": "<p>It is because <code>fmt.Scanln</code> doesn't take inputs after first space so if you entered 2 3 4 at <code>fmt.Scanln(&amp;in)</code> then only 2 will be assigned to in.</p>\n\n<p>Try using package <code>bufio</code>: </p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\nscanner.Scan()\nin := scanner.Text()\nwh = strings.Split(in, \" \")\nfmt.Println(wh[0])\nfmt.Println(wh[1])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 383, "user_id": 4634669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh5.googleusercontent.com/-RCOr91QgPvQ/AAAAAAAAAAI/AAAAAAAAAIk/X1Aka8XIDgw/photo.jpg?sz=128", "display_name": "athavan kanapuli", "link": "https://stackoverflow.com/users/4634669/athavan-kanapuli"}, "is_accepted": true, "score": 0, "last_activity_date": 1498878866, "creation_date": 1498878866, "answer_id": 44857027, "question_id": 43421062, "link": "https://stackoverflow.com/questions/43421062/strings-split-stdin-not-returning-slice-array/44857027#44857027", "title": "strings.Split, stdin not returning slice/array", "body": "<p><strong>fmt.Scanln stops reading after the spaces.</strong></p>\n\n<p>Two Approaches to solve this Problem </p>\n\n<p><strong>1st Approach: USE Scanf</strong></p>\n\n<pre><code>var in string\nfmt.Scanf(\"%q\", &amp;in)\n</code></pre>\n\n<p>But then your input should be enclosed within the double quotes like <code>\"2 3\"</code></p>\n\n<p><strong>2nd Approach: USE bufio</strong></p>\n\n<p>The best way I consider</p>\n\n<pre><code>scanner := bufio.NewScanner(os.Stdin)\nfor scanner.Scan(){\n   in = scanner.Text()\n   break  //optional line if your input has a single line\n}\nfmt.Println(in)\n</code></pre>\n\n<p>This shall solve the problem in the best way</p>\n"}], "owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 44857027, "answer_count": 3, "score": 1, "last_activity_date": 1498878866, "creation_date": 1492217711, "last_edit_date": 1492220046, "question_id": 43421062, "link": "https://stackoverflow.com/questions/43421062/strings-split-stdin-not-returning-slice-array", "title": "strings.Split, stdin not returning slice/array", "body": "<p>It seems that strings.split(\" \") is not returning an array. I have no idea why this is. I'm sure I am using it in a similar context elsewhere.  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    var seedCost float64\n    var lawnNo int\n    var in string\n    var area float64\n    var wh []string\n\n    fmt.Scanln(&amp;seedCost) //2 is inputted\n    fmt.Scanln(&amp;lawnNo)   //3\n    lawnCost := 0.00\n\n    for i := 0; i &lt; lawnNo; i++ {\n        fmt.Scanln(&amp;in) //2 3 is inputted\n        wh = strings.Split(in, \" \")\n        fmt.Println(wh[0])\n        fmt.Println(wh[1]) //Test throwing exception, index out of range\n        w, _ := strconv.ParseFloat(wh[0], 64)\n        h, _ := strconv.ParseFloat(wh[1], 64) //EXCEPTIONAL LINE, index out of range\n\n        area = w * h\n        lawnCost += area * seedCost\n    }\n\n    ans := strconv.FormatFloat(lawnCost, 'E', 8, 64)\n    fmt.Println(ans)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1492216762, "post_id": 43420958, "comment_id": 73900920, "body": "Why do you think there is one?"}], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "edited": false, "score": 0, "creation_date": 1492217132, "post_id": 43420973, "comment_id": 73900977, "body": "I am not sure if we are thinking the same thing.  Right after inc unlock and right before read acquire the lock, there can be goroutine modify the sum?"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "edited": false, "score": 2, "creation_date": 1492217187, "post_id": 43420973, "comment_id": 73900987, "body": "The fact that the actual <code>c.sum++</code> is happening in a goroutine means that the mutex is not protecting anything to do with the increment."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1492217817, "post_id": 43420973, "comment_id": 73901097, "body": "A better solution would be to use <a href=\"https://golang.org/pkg/sync/atomic/#AddInt32\" rel=\"nofollow noreferrer\"><code>atomic.AddInt32</code></a> so no locking is necessary."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 6, "last_activity_date": 1492218006, "last_edit_date": 1492218006, "creation_date": 1492216865, "answer_id": 43420973, "question_id": 43420958, "link": "https://stackoverflow.com/questions/43420958/potential-race-condition-in-go-language/43420973#43420973", "title": "potential race condition in go language", "body": "<p>The <code>c.sum++</code> is in a goroutine that is scheduled independently of the execution of the <code>inc()</code> method. When the <code>inc()</code> method exits the <code>defer</code>ed unlock of the mutex will happen and will very likely happen at the wrong time, leading to a race condition.</p>\n\n<p>As @Flimzy suggests using <code>atomic.AddInt32</code> would remove the need for a mutex at all.</p>\n\n<p>two mutex based solutions are either to not increment in a goroutine:</p>\n\n<pre><code>func (c *PossiblySafeCounter) inc() {\n   c.mu.Lock();\n   defer c.mu.Unlock();\n   c.sum++\n}\n</code></pre>\n\n<p>or do the locking and unlocking <em>in</em> the goroutine:</p>\n\n<pre><code>func (c *PossiblySafeCounter) inc() {\n   go func() {\n       c.mu.Lock();\n       defer c.mu.Unlock();\n       c.sum++\n   }() \n}\n</code></pre>\n\n<p>but honestly, doing any kind of goroutine doesn't make sense in this example.  Why do you need the increment to be in a goroutine?</p>\n"}], "owner": {"reputation": 679, "user_id": 7176437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/549cb8faa34003416eccec2fd3c7dd71?s=128&d=identicon&r=PG&f=1", "display_name": "vkosyj", "link": "https://stackoverflow.com/users/7176437/vkosyj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 43420973, "answer_count": 1, "score": 0, "last_activity_date": 1492218006, "creation_date": 1492216718, "question_id": 43420958, "link": "https://stackoverflow.com/questions/43420958/potential-race-condition-in-go-language", "title": "potential race condition in go language", "body": "<p>I am not sure why the following code has the race condition, can someone give me a hint?  I think there is no potential race condition.  Thank you in advance. </p>\n\n<pre><code>type PossiblySafeCounter struct {\n    mu sync.Mutex\n    sum int\n}\n\nfunc (c *PossiblySafeCounter) inc() {\n   c.mu.Lock();\n   defer c.mu.Unlock();\n   go func() {\n       c.sum++\n   }() \n}\nfunc (c *PossiblySafeCounter) read() int {\n    c.mu.Lock();\n    defer c.mu.Unlock();\n    return c.sum\n }\n</code></pre>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 3572, "user_id": 23200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqqLy.jpg?s=128&g=1", "display_name": "Cyril Graze", "link": "https://stackoverflow.com/users/23200/cyril-graze"}, "edited": false, "score": 0, "creation_date": 1492195490, "post_id": 43417375, "comment_id": 73893790, "body": "as per the docs, StrictSlash() has no effect when used with PathPrefix()"}], "tags": [], "owner": {"reputation": 3572, "user_id": 23200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IqqLy.jpg?s=128&g=1", "display_name": "Cyril Graze", "link": "https://stackoverflow.com/users/23200/cyril-graze"}, "is_accepted": true, "score": 8, "last_activity_date": 1492195438, "creation_date": 1492195438, "answer_id": 43417375, "question_id": 43417204, "link": "https://stackoverflow.com/questions/43417204/go-gorilla-mux-match-anything-path-template/43417375#43417375", "title": "Go Gorilla Mux &quot;match anything&quot; path template", "body": "<p>This should work:</p>\n\n<pre><code>router := mux.NewRouter().PathPrefix(\"/\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 656, "user_id": 9947010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43ecdf86bdd8e6632ac394a5a25654a?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Mottl", "link": "https://stackoverflow.com/users/9947010/dmitry-mottl"}, "is_accepted": false, "score": 9, "last_activity_date": 1543612931, "creation_date": 1543612931, "answer_id": 53565093, "question_id": 43417204, "link": "https://stackoverflow.com/questions/43417204/go-gorilla-mux-match-anything-path-template/53565093#53565093", "title": "Go Gorilla Mux &quot;match anything&quot; path template", "body": "<p>You can use <code>mux.Route.HandlerFunc</code> together with <code>mux.Router.PathPrefix</code>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r := mux.NewRouter()\n\n// route catalog to catalogHandler:\nr.HandleFunc(\"/catalog/{id}\", catalogHandler) \n\n// route everything else to defaultHandler:\nr.PathPrefix(\"/\").HandlerFunc(defaultHandler)\n</code></pre>\n\n<p>Note the difference in names (<code>HandlerFunc</code> vs <code>HandleFunc</code>).</p>\n"}], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5318, "favorite_count": 2, "accepted_answer_id": 43417375, "answer_count": 2, "score": 7, "last_activity_date": 1543612931, "creation_date": 1492194710, "question_id": 43417204, "link": "https://stackoverflow.com/questions/43417204/go-gorilla-mux-match-anything-path-template", "title": "Go Gorilla Mux &quot;match anything&quot; path template", "body": "<p>What is the proper syntax to create a simple \"match anything\" handler?</p>\n\n<p><code>mux.NewRouter().StrictSlash(true).Path(\"/\")....</code></p>\n\n<p>The above code seems to strictly match <code>/</code> and <code>/foo</code> won't get matched</p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 804, "user_id": 880963, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/edacc2ea1717765faf2ab392116b7182?s=128&d=identicon&r=PG", "display_name": "krish7919", "link": "https://stackoverflow.com/users/880963/krish7919"}, "edited": false, "score": 1, "creation_date": 1492255703, "post_id": 43416630, "comment_id": 73909002, "body": "In proto3, there is no difference between an unset variable and a null/empty variable, and hence, I use a default value with every field (in a constructor/builder) and check for that instead."}], "owner": {"reputation": 903, "user_id": 3027614, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5c2d0d0b4cd3457db67aefcf03fd0d01?s=128&d=identicon&r=PG", "display_name": "mark.sagikazar", "link": "https://stackoverflow.com/users/3027614/mark-sagikazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1492192240, "creation_date": 1492192240, "question_id": 43416630, "link": "https://stackoverflow.com/questions/43416630/protocol-buffers-3-partial-update", "title": "Protocol Buffers 3 partial update", "body": "<p>I am trying to implement partial update with Protocol Buffers 3 (using Go). The problem is that in some cases it's not possible to distinguish default (empty) values and the same values set on purpose (like a description set to an empty string to clear it).</p>\n\n<p>After some digging I found reference to <a href=\"https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#fieldmask\" rel=\"nofollow noreferrer\">FieldMasks</a> in <a href=\"https://github.com/golang/protobuf/issues/225\" rel=\"nofollow noreferrer\">this</a> issue which explains that such values cannot be distinguished, but an incremental update is possible using FieldMasks.</p>\n\n<p>I tried to find some documentation or guide explaining how to use FieldMasks, but I couldn't.</p>\n\n<p>So the question is: how can I achieve partial update with proto3 (using FieldMasks)?</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["windows", "go", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 2397, "user_id": 1012139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c60b55608ea93fd84b8a2c40ac9f64e?s=128&d=identicon&r=PG", "display_name": "Patrick D&#39;appollonio", "link": "https://stackoverflow.com/users/1012139/patrick-dappollonio"}, "is_accepted": false, "score": 0, "last_activity_date": 1492202669, "creation_date": 1492202669, "answer_id": 43418985, "question_id": 43415100, "link": "https://stackoverflow.com/questions/43415100/how-to-force-windows-godoc-to-update-private-package-documentation-on-local-webs/43418985#43418985", "title": "How to force Windows godoc to update private package documentation on local webserver in golang?", "body": "<p>Technically this is not a Go related problem, but more related to the <em>execution of a command</em> when the contents of a folder change. </p>\n\n<p>There are some solutions for standard HTTP Go programs -- those who have a router and listen on an specific port -- but nothing too much for GoDoc. This is because of the os-dependant model, where the OS needs to have a way to detect and listen for changes in the directory.</p>\n\n<p>Maybe <a href=\"https://unix.stackexchange.com/questions/24026/how-to-run-a-command-when-a-directorys-contents-are-updated\">something from here</a> may help you out, but it will require some bash scripting -- which may not be an option if you're on Windows and/or don't have Bash.</p>\n\n<p>For Go HTTP projects, there's <a href=\"https://github.com/codegangsta/gin\" rel=\"nofollow noreferrer\">CodeGangsta's Gin package</a> and <a href=\"https://github.com/pilu/fresh\" rel=\"nofollow noreferrer\">Pilu's Fresh</a>. Both work great!</p>\n"}, {"tags": [], "owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "is_accepted": true, "score": 0, "last_activity_date": 1492531765, "creation_date": 1492531765, "answer_id": 43477185, "question_id": 43415100, "link": "https://stackoverflow.com/questions/43415100/how-to-force-windows-godoc-to-update-private-package-documentation-on-local-webs/43477185#43477185", "title": "How to force Windows godoc to update private package documentation on local webserver in golang?", "body": "<p>Patrick's answer pointed me in the right direction. The solution was to move the entire package folder into another folder and then run the \"godoc -http :6060\" command again which forced the update. </p>\n\n<p>For just creating a godoc, this works fine. You just can't actually build anything without changing imports or moving the folder back. </p>\n\n<p>Strangely, after doing this and moving it back, godoc is now recognizing my updates without moving the package folder.</p>\n"}], "owner": {"reputation": 491, "user_id": 7655137, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5203fc333c6443affb37aa2209267d71?s=128&d=identicon&r=PG&f=1", "display_name": "darkwing", "link": "https://stackoverflow.com/users/7655137/darkwing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 43477185, "answer_count": 2, "score": 0, "last_activity_date": 1492531765, "creation_date": 1492185620, "question_id": 43415100, "link": "https://stackoverflow.com/questions/43415100/how-to-force-windows-godoc-to-update-private-package-documentation-on-local-webs", "title": "How to force Windows godoc to update private package documentation on local webserver in golang?", "body": "<p>How can I force godoc to update my private package documentation when running a local godoc webserver on Windows? </p>\n\n<p>Running the command: \"godoc -http :6060\" on Windows doesn't update new godoc comments in private packages. When I first ran the command it got the comments that were already present but hasn't updated since when killing and restarting the command. Is there a cache or something I can clear? </p>\n\n<p>I can't find anything about this anywhere. There's this really old github issue (that was apparently fixed) that is frozen due to age and deals with the -sync option that doesn't exist in godoc in the current (and my own) go1.8 windows/amd64 install: <a href=\"https://github.com/golang/go/issues/3273\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/3273</a></p>\n\n<p>I tried this on Linux and it updates immediately when I kill and restart the \"godoc -http :6060\" command.</p>\n"}, {"tags": ["java", "go", "cryptography", "base64", "aes"], "comments": [{"owner": {"reputation": 541, "user_id": 5662881, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh6.googleusercontent.com/-kevAuavWPyk/AAAAAAAAAAI/AAAAAAAAACA/a5VJ5ypbJZg/photo.jpg?sz=128", "display_name": "Hitesh Ghuge", "link": "https://stackoverflow.com/users/5662881/hitesh-ghuge"}, "edited": false, "score": 0, "creation_date": 1492186392, "post_id": 43415059, "comment_id": 73889234, "body": "Not clear what u supposed to do? As I understand you are encrypted string using java <code>AES</code>. Not clear <code>golang</code>. Is you are trying to decrypt the same using golang ?"}, {"owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "reply_to_user": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1492188969, "post_id": 43415059, "comment_id": 73890416, "body": "@ArtjomB. thanks for your reminder. Hope my modification can help people understand my problem better."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 1, "creation_date": 1492189196, "post_id": 43415059, "comment_id": 73890522, "body": "Your key looks like it&#39;s Base64-encoded. Did you decode it first or did you use it as-is (your code is incomplete in that regard)?"}, {"owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "reply_to_user": {"reputation": 541, "user_id": 5662881, "user_type": "registered", "accept_rate": 46, "profile_image": "https://lh6.googleusercontent.com/-kevAuavWPyk/AAAAAAAAAAI/AAAAAAAAACA/a5VJ5ypbJZg/photo.jpg?sz=128", "display_name": "Hitesh Ghuge", "link": "https://stackoverflow.com/users/5662881/hitesh-ghuge"}, "edited": false, "score": 0, "creation_date": 1492189295, "post_id": 43415059, "comment_id": 73890582, "body": "@hiteshghuge Yes, I am trying to encrypt in Java and decrypt in Go w/ the same data w/ the same key.  Fortunately, I cannot make it happen. In my question, I am trying to show the difference of encryption function and outputs in Java and Go."}, {"owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "reply_to_user": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1492190004, "post_id": 43415059, "comment_id": 73890926, "body": "@ArtjomB. Good Call. I did not write the Java code. The key seems like encoded based on base64. Will that be a problem if I use that key in Go for encryption or decryption?"}, {"owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "reply_to_user": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1492191051, "post_id": 43415059, "comment_id": 73891521, "body": "@ArtjomB. Thanks. I tried PKCS7padding before. In Go, the encrypted results are exactly the same. BTW, I referred to a document about Java AES before, PKCS5padding is implemented by PKCS7padding"}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1492191238, "post_id": 43415059, "comment_id": 73891610, "body": "Right, I didn&#39;t missed that you&#39;re already using <code>PKCS5Padding</code>. Then we need to see your full code including how those inputs and outputs are handled."}, {"owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "edited": false, "score": 0, "creation_date": 1492195137, "post_id": 43415059, "comment_id": 73893630, "body": "Sorry, I have problem in posting my code because of formatting issues. Here are the libs I used in Go.                                                                    _ &quot;golang.org/x/crypto/blowfish&quot; \t_ &quot;github.com/andreburgaud/crypt2go/ecb&quot; \t_ &quot;github.com/andreburgaud/crypt2go/padding&quot; \t&quot;encoding/base64&quot;"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1492342707, "post_id": 43415059, "comment_id": 73930596, "body": "Note that <code>T3-Arghbegrgg455dfer4g==</code> seems to be <b>base64 url</b> format: normal base 64 doesn&#39;t contain a dash (<code>-</code>) only slashes and plus signs. Also note that using any class in <code>sun.misc</code> is explicitly forbidden by Java: these are internal implementation classes that may change any minute."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1492342977, "post_id": 43415059, "comment_id": 73930664, "body": "You need to show us how you generate the keys from the code, your code is currently incomplete. No doubt the libraries are OK, it&#39;s the rest of the code that is missing."}], "owner": {"reputation": 11, "user_id": 6771578, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d09ea293ece6273eb523c294677d5652?s=128&d=identicon&r=PG&f=1", "display_name": "ping hu", "link": "https://stackoverflow.com/users/6771578/ping-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 641, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1492190593, "creation_date": 1492185474, "last_edit_date": 1492190593, "question_id": 43415059, "link": "https://stackoverflow.com/questions/43415059/encryption-of-aes128-ecb-pkcs5base64rfc-1521-in-java-and-decryption-in-gola", "title": "Encryption of AES(128/ECB/PKCS5)+Base64(RFC 1521) in Java and decryption in Golang", "body": "<p>the Encryption in Java is by importing javax.crypto.Cipher, sun.misc.BASE64Decoder, sun.misc.BASE64Encoder and javax/crypto/SecretKey.</p>\n\n<p>I did a lot research on those algorithms to understand the specific standards to make sure every step is the same in Java and Golang.</p>\n\n<p>Since I cannot decrypt the encrypted data from java, I am trying to see the difference from encrypting in golang and that in Java to see the difference. The encrypted outputs from golang and Java are different even w/ the same format(24 digits with <code>\"==\"</code>at the end). </p>\n\n<pre>\ninputs: key: T3-Arghbegrgg455dfer4g==  \n        text: 123456789012345  \noutput: golang: 07vl02WwI8dApjYI161TrQ==  \n        java:   B9E8aoCd+fYQBkKbqCS3lA==  \n</pre>\n\n<p>Please help to find out the reason behind the difference! Thanks!</p>\n\n<p>The java code using </p>\n\n<pre class=\"lang-java prettyprint-override\"><code>Cipher cipher = Cipher.getInstance(\"AES\");\ncipher.init(Cipher.ENCRYPT_MODE, secretKey);\n\nbyte[] stringBytes = message.getBytes(\"UTF8\");\nbyte[] raw = cipher.doFinal(stringBytes);\n\nBASE64Encoder encoder = new BASE64Encoder();\nString base64 = encoder.encode(raw);\nreturn base64;\n</code></pre>\n\n<p>In Golang</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>block, err := aes.NewCipher(key)\nif err != nil {\n    return \"\",err\n}\ncontent := []byte(src)\necb := NewECBEncrypter(block)\ncontent = PKCS5Padding(content, block.BlockSize())\ncrypted := make([]byte, len(content))\necb.CryptBlocks(crypted, content)\nfinalMsg := base64.StdEncoding.EncodeToString(crypted)\nreturn finalMsg,nil\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 495848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba7999d17e83069719be8a8056fbb5e5?s=128&d=identicon&r=PG", "display_name": "Srisa", "link": "https://stackoverflow.com/users/495848/srisa"}, "edited": false, "score": 0, "creation_date": 1492182830, "post_id": 43414216, "comment_id": 73887311, "body": "Any other way to make it print the regular string instead of the error message?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 949, "user_id": 495848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba7999d17e83069719be8a8056fbb5e5?s=128&d=identicon&r=PG", "display_name": "Srisa", "link": "https://stackoverflow.com/users/495848/srisa"}, "edited": false, "score": 0, "creation_date": 1492183185, "post_id": 43414216, "comment_id": 73887540, "body": "@Srisa: <code>fmt.Println(Sqrt(2).String())</code> ?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1492183267, "post_id": 43414216, "comment_id": 73887583, "body": "It&#39;s a two-argument return value, so that won&#39;t work.  But frankly, that reflects a problematic design in general.  Functions can return multiple values, so there&#39;s no real reason for your result item to also implement the error interface when you can just pass back an error itself (which you&#39;re doing, by literally passing the same item back twice).  Bad code smell is the problem here."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1492187831, "last_edit_date": 1592644375, "creation_date": 1492182363, "answer_id": 43414216, "question_id": 43414130, "link": "https://stackoverflow.com/questions/43414130/fmt-println-calling-error-instead-of-string/43414216#43414216", "title": "fmt.Println calling Error instead of String()", "body": "<p>The <a href=\"https://godoc.org/fmt\" rel=\"noreferrer\">documentation states how the value is converted to a string</a>:</p>\n<blockquote>\n<ol start=\"4\">\n<li><p>If an operand implements the error interface, the Error method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n<li><p>If an operand implements method String() string, that method will be invoked to convert the object to a string, which will then be formatted as required by the verb (if any).</p>\n</li>\n</ol>\n</blockquote>\n<p>The <code>error</code> interface comes before <code>Stringer</code>.</p>\n<p>A more idiomatic way to write the function is:</p>\n<pre><code>func Sqrt(x float64) (float64, error) {\n  if x &lt; 0 {\n    return 0, ErrNegativeSqrt(x)\n  }\n  return math.Sqrt(x), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 949, "user_id": 495848, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba7999d17e83069719be8a8056fbb5e5?s=128&d=identicon&r=PG", "display_name": "Srisa", "link": "https://stackoverflow.com/users/495848/srisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 43414216, "answer_count": 1, "score": 3, "last_activity_date": 1492187831, "creation_date": 1492182091, "question_id": 43414130, "link": "https://stackoverflow.com/questions/43414130/fmt-println-calling-error-instead-of-string", "title": "fmt.Println calling Error instead of String()", "body": "<p>I have this code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype ErrNegativeSqrt float64\n\nfunc (s ErrNegativeSqrt) String() string {\n    return fmt.Sprintf(\"%f\", float64(s))\n}\n\nfunc (e ErrNegativeSqrt) Error() string {\n    return fmt.Sprintf(\"Cannot Sqrt negative number: %v\", float64(e))\n}\n\nfunc Sqrt(x float64) (ErrNegativeSqrt, error) {\n    if x &lt; 0 {\n        e := ErrNegativeSqrt(x)\n        return e, e\n    } else {\n        return ErrNegativeSqrt(math.Sqrt(x)), nil\n    }\n}\n\nfunc main() {\n    fmt.Println(Sqrt(2))\n    fmt.Println(Sqrt(-2))\n}\n</code></pre>\n\n<p>And the output of this code is</p>\n\n<blockquote>\n  <p>Cannot Sqrt negative number: 1.4142135623730951 &lt;nil&gt;\n  Cannot Sqrt negative number: -2 Cannot Sqrt negative number: -2</p>\n</blockquote>\n\n<p>When I have implemented the Stringer interface for the ErrNegativeSqrt, why is the fmt.Println invoking the Error() method instead of the String() method?</p>\n\n<p>I am new to go, so I might be missing something very obvious.</p>\n"}, {"tags": ["regex", "go", "regex-group"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1492177579, "post_id": 43412667, "comment_id": 73884319, "body": "No, repeated captures are constantly overwritten, and only the last value is kept.  You only have as many groups in the result as you have defined in the pattern."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1492178516, "post_id": 43412667, "comment_id": 73884898, "body": "You need to use <code>([0-9]+):([0-9]+-[0-9]+(?:[,&#47;][0-9]+-[0-9]+)*)</code> and when a match is obtained split the contents of the second capturing group and add these items to the result."}], "owner": {"user_type": "does_not_exist", "display_name": "user5423851"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492176916, "creation_date": 1492176916, "question_id": 43412667, "link": "https://stackoverflow.com/questions/43412667/repeat-group-to-match-multiple-occurrences", "title": "Repeat group to match multiple occurrences", "body": "<p>// The example is here: <a href=\"https://regex101.com/r/7kjJCr/3\" rel=\"nofollow noreferrer\">https://regex101.com/r/7kjJCr/3</a></p>\n\n<p>I try to match strings of type <code>([0-9]):(([0-9]+)-([0-9]+))+</code><br>\nWhereas the second group should be repeatable, so that a string like <code>25:12-54,213-512,1231-2344</code> gets matched and group in (25, 12, 54, 213, 512, 1231, 2344) and a string like <code>25:12-34</code> should be processed the same way.    </p>\n\n<p>I appreciate any ideas!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492175180, "post_id": 43412117, "comment_id": 73882927, "body": "Validate is called everytime, it&#39;s return value will be evaluated only if the ParseOrFail returns true. Unless ParseOfFail mutates value in a separate go routine Validate will be called with the updated value."}, {"owner": {"reputation": 4498, "user_id": 58768, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9bbffd2d873441279b4661070e8add4b?s=128&d=identicon&r=PG", "display_name": "bohdan_trotsenko", "link": "https://stackoverflow.com/users/58768/bohdan-trotsenko"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1492175436, "post_id": 43412117, "comment_id": 73883097, "body": "@mkopriva if the first function return false, the second is not called. Just checked in playground."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492175476, "post_id": 43412117, "comment_id": 73883116, "body": "Yup, I take that back :f, sorry"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1492179060, "creation_date": 1492179060, "answer_id": 43413261, "question_id": 43412117, "link": "https://stackoverflow.com/questions/43412117/early-or-late-argument-evaluation-in-golang/43413261#43413261", "title": "Early or late argument evaluation in golang?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language\n  Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Expressions\" rel=\"nofollow noreferrer\">Expressions</a></p>\n  \n  <p>An expression specifies the computation of a value by applying\n  operators and functions to operands.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Operands\" rel=\"nofollow noreferrer\">Operands</a></p>\n  \n  <p>Operands denote the elementary values in an expression. An operand may\n  be a literal, a (possibly qualified) non-blank identifier denoting a\n  constant, variable, or function, a method expression yielding a\n  function, or a parenthesized expression.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">Order of evaluation</a></p>\n  \n  <p>At package level, initialization dependencies determine the evaluation\n  order of individual initialization expressions in variable\n  declarations. Otherwise, when evaluating the operands of an\n  expression, assignment, or return statement, all function calls,\n  method calls, and communication operations are evaluated in lexical\n  left-to-right order.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls</a></p>\n  \n  <p>Given an expression f of function type F,</p>\n\n<pre><code>f(a1, a2, \u2026 an)\n</code></pre>\n  \n  <p>calls f with arguments a1, a2, \u2026 an. Except for one special case,\n  arguments must be single-valued expressions assignable to the\n  parameter types of F and are evaluated before the function is called.\n  The type of the expression is the result type of F. A method\n  invocation is similar but the method itself is specified as a selector\n  upon a value of the receiver type for the method.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Logical_operators\" rel=\"nofollow noreferrer\">Logical operators</a></p>\n  \n  <p>Logical operators apply to boolean values and yield a result of the\n  same type as the operands. The right operand is evaluated\n  conditionally.</p>\n\n<pre><code>&amp;&amp;    conditional AND    p &amp;&amp; q  is  \"if p then q else false\"\n||    conditional OR     p || q  is  \"if p then true else q\"\n!     NOT                !p      is  \"not p\"\n</code></pre>\n</blockquote>\n\n<p>The behavior of your code is defined in The Go Programming Language Specification. </p>\n\n<pre><code>var value int\n\nif !(ParseOrFail(inputStrVal, &amp;value) &amp;&amp; Validate(value)) {\n    return SomeErr \n}\n</code></pre>\n\n<p>Or, in pseudocode,</p>\n\n<pre><code>ParseOrFail arguments are evaluated\nParseOrFail is called\nif ParseOrFail == true\n    Validate arguments are evaluated\n    Validate is called\n</code></pre>\n\n<p>That is, in your example (<a href=\"https://play.golang.org/p/l6XHbgQjFs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/l6XHbgQjFs</a>), late evaluation.</p>\n"}], "owner": {"reputation": 4498, "user_id": 58768, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9bbffd2d873441279b4661070e8add4b?s=128&d=identicon&r=PG", "display_name": "bohdan_trotsenko", "link": "https://stackoverflow.com/users/58768/bohdan-trotsenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1871, "favorite_count": 1, "accepted_answer_id": 43413261, "answer_count": 1, "score": 1, "last_activity_date": 1492179060, "creation_date": 1492175069, "question_id": 43412117, "link": "https://stackoverflow.com/questions/43412117/early-or-late-argument-evaluation-in-golang", "title": "Early or late argument evaluation in golang?", "body": "<p>In my program I do a series of sequential checks in this manner:</p>\n\n<pre><code>var value int\n\nif !(ParseOrFail(inputStrVal, &amp;value) &amp;&amp;\n     Validate(value)) {\n    return SomeErr\n}\n</code></pre>\n\n<p>I know that <code>Validate</code> is called only if <code>ParseOrFail</code> returns true, but I'm not sure whether in all such scenarios it will get the updated value.</p>\n\n<p>Is it correct to do so? Or must I pass a pointer to <code>Validate</code> ?</p>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/l6XHbgQjFs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/l6XHbgQjFs</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "edited": false, "score": 0, "creation_date": 1492172931, "post_id": 43411458, "comment_id": 73881844, "body": "If you understand C++ at all, take a look at the answer to my question <a href=\"http://stackoverflow.com/questions/37701382/checking-ahead-for-future-groups-when-parsing-tokens\">here</a>. I don&#39;t know Go, but as languages have always been generated, your best bet is defining a lexer, parser and code-generator which outputs Go, and <i>then</i> use reflection on the generated code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492173063, "post_id": 43411458, "comment_id": 73881914, "body": "@JimB Parse the file into a Go string and do reflection on it?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492173272, "post_id": 43411458, "comment_id": 73882012, "body": "As @JimB already mentioned you cannot generate types at <b>runtime</b>, but you can generate code with the help of the go generate tool. See more here: <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">blog.golang.org/generate</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492173765, "post_id": 43411458, "comment_id": 73882236, "body": "@finnrayment: reflecting on strings containing code isn&#39;t going to accomplish anything, they&#39;re still just strings. If you didn&#39;t have the types at compile time, they don&#39;t exist."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5549921"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492173856, "post_id": 43411458, "comment_id": 73882286, "body": "@JimB Ah ok. Was just wondering since I don&#39;t program in Go. In Java, if I create a class in reflection, I can reference it after compile time. Same with Python. Nice to know the boundaries. :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1492179775, "post_id": 43411458, "comment_id": 73885580, "body": "Sorry, I should have mentioned that you <i>can</i> build a struct, but you can&#39;t define a <i>type</i>, therefor its usefulness will be limited when trying to compose it within your code."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1492176474, "creation_date": 1492176474, "answer_id": 43412540, "question_id": 43411458, "link": "https://stackoverflow.com/questions/43411458/runtime-structure-using-reflection/43412540#43412540", "title": "Runtime structure using reflection", "body": "<p>Yes, you can with <a href=\"https://golang.org/pkg/reflect/#StructOf\" rel=\"nofollow noreferrer\"><code>reflect.StructOf</code></a>:</p>\n\n<pre><code>sType := reflect.StructOf([]reflect.StructField{\n    {Name: \"Name\", Type: stringType, Tag: reflect.StructTag(`db:\"name\" json:\"name\"`)},\n    {Name: \"Surname\", Type: stringType, Tag: reflect.StructTag(`db:\"surname\" json:\"surname\"`)},\n})\nsv := reflect.New(sType)\nsvi := sv.Interface()\nb, err := json.Marshal(svi)\nfmt.Printf(\"%s %v\", b, err)\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>{\"name\":\"\",\"surname\":\"\"} &lt;nil&gt;\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/U4N3bbJ5n8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/U4N3bbJ5n8</a>.</p>\n\n<p>But as others have said, sometimes it's better to just generate code. Reflection is kinda wonky at times, and requires a lot of precision when using it.</p>\n"}], "owner": {"reputation": 267, "user_id": 1831123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/144d9a829875d372bba54b0229deceb8?s=128&d=identicon&r=PG", "display_name": "Xter", "link": "https://stackoverflow.com/users/1831123/xter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 43412540, "answer_count": 1, "score": 2, "last_activity_date": 1492176474, "creation_date": 1492172626, "question_id": 43411458, "link": "https://stackoverflow.com/questions/43411458/runtime-structure-using-reflection", "title": "Runtime structure using reflection", "body": "<p>Assume I have data model written in some sort of yaml file.</p>\n\n<pre><code>schema: human\ntype: object\nproperties:\n    name:\n        type: string\n    surname:\n        type: string\n</code></pre>\n\n<p>I would like to parse it, and generate structure:</p>\n\n<pre><code>type Human struct {\n    Name string `db:\"name\"`\n    Surname string `db:\"surname\"`\n}\n</code></pre>\n\n<p>Is it possible to generate runtime Go struct using reflection?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 7786269, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/455216d85d82028c9ad8c9f062165cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Higeath", "link": "https://stackoverflow.com/users/7786269/higeath"}, "edited": false, "score": 0, "creation_date": 1492169618, "post_id": 43410646, "comment_id": 73880127, "body": "So this is a channel of ints, but what if I want the size to be dynamic?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1492195085, "post_id": 43410646, "comment_id": 73893601, "body": "Go does not support dynamically-sized channels."}], "tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": false, "score": 1, "last_activity_date": 1492169349, "creation_date": 1492169349, "answer_id": 43410646, "question_id": 43410524, "link": "https://stackoverflow.com/questions/43410524/channel-slice-of-integers/43410646#43410646", "title": "Channel slice of integers", "body": "<p>This is called </p>\n\n<blockquote>\n  <p>buffered channel</p>\n</blockquote>\n\n<p>the right syntaxis is</p>\n\n<pre><code>test := make(chan int, 5)    \ntest &lt;- 1\ntest &lt;- 2\n</code></pre>\n\n<p>Golang tour has an example:</p>\n\n<p><a href=\"https://tour.golang.org/concurrency/3\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/3</a></p>\n"}, {"tags": [], "owner": {"reputation": 9626, "user_id": 1888559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d94b2fccdfe0a1b012875e69430c9546?s=128&d=identicon&r=PG", "display_name": "Ngenator", "link": "https://stackoverflow.com/users/1888559/ngenator"}, "is_accepted": true, "score": 1, "last_activity_date": 1492174995, "creation_date": 1492174995, "answer_id": 43412103, "question_id": 43410524, "link": "https://stackoverflow.com/questions/43410524/channel-slice-of-integers/43412103#43412103", "title": "Channel slice of integers", "body": "<p>You defined a channel of <code>[]int</code> but are trying to send it an <code>int</code>. You have to send it a slice of ints and then have the receiver use that slice. </p>\n\n<p>A working example is here: <a href=\"https://play.golang.org/p/TmcUKU8G-1\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TmcUKU8G-1</a></p>\n\n<p>Notice that I'm appending the 4 to the <code>things</code> slice and not the channel itself</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    c := make(chan []int)\n\n    things := []int{1, 2, 3}\n\n    go func() {\n        c &lt;- things\n    }()\n\n    for _, i := range &lt;-c {\n        fmt.Println(i)\n    }\n\n    go func() {\n        c &lt;- append(things, 4)\n    }()\n\n    for _, i := range &lt;-c {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1\n2\n3\n1\n2\n3\n4\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 7786269, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/455216d85d82028c9ad8c9f062165cf7?s=128&d=identicon&r=PG&f=1", "display_name": "Higeath", "link": "https://stackoverflow.com/users/7786269/higeath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1080, "favorite_count": 0, "accepted_answer_id": 43412103, "answer_count": 2, "score": 2, "last_activity_date": 1492183074, "creation_date": 1492168864, "last_edit_date": 1492183074, "question_id": 43410524, "link": "https://stackoverflow.com/questions/43410524/channel-slice-of-integers", "title": "Channel slice of integers", "body": "<p>I want to create a slice that is a channel and contains integers.</p>\n\n<pre><code>test := make(chan []int)\ntest &lt;- 5\n</code></pre>\n\n<p>This is the way I initialized it but I have no idea how to now pass a value since for slices we would use append but for channels we send data using &lt;-</p>\n\n<p>I have tried with both just &lt;- and append and both combined like below and can't get it to work</p>\n\n<pre><code>test &lt;- append(test, 5)\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1492195271, "post_id": 43409919, "comment_id": 73893689, "body": "I would strongly advise against loading your configuration in an init() function at all, for the reason stated (issues with testing) among others (structure, reusability, control, etc.). Just call loadConfig() from your entry point."}], "answers": [{"comments": [{"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "edited": false, "score": 2, "creation_date": 1492169332, "post_id": 43410591, "comment_id": 73879999, "body": "Thanks for your answer. I&#39;ve decided to not use the <code>init()</code>. Calling <code>loadConfig</code> in the <code>New</code> function and return also an error in that function seems more appropriated."}, {"owner": {"reputation": 2544, "user_id": 1007151, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61eced2e6b06628580af0dace82283b?s=128&d=identicon&r=PG", "display_name": "darnmason", "link": "https://stackoverflow.com/users/1007151/darnmason"}, "edited": false, "score": 0, "creation_date": 1595293499, "post_id": 43410591, "comment_id": 111418324, "body": "For some context I used this for testing GCP cloud functions. As my function&#39;s global dependencies are initialised in <code>func init()</code>, with this approach I can mock them first in the test file and the only change to the real code is to check if deps are already initialised, and if so, skip the real initialisation. If anyone has a better or more &quot;proper&quot; way I&#39;m all ears"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 9, "last_activity_date": 1492169131, "creation_date": 1492169131, "answer_id": 43410591, "question_id": 43409919, "link": "https://stackoverflow.com/questions/43409919/init-function-breaking-unit-tests/43410591#43410591", "title": "Init function breaking unit tests", "body": "<p>I'm not sure whether there's a nicer way of doing this, but if you consider the fact that package-level variables are initialized before the <code>init</code> func is run you can use a flag to tell you whether you're running tests or not.</p>\n\n<pre><code>var _testing = false\n\nfunc init() {\n    if _testing {\n        return\n    }\n\n    var err error // Necessary to prevent config variable shadowing\n    config, err = loadConfig(\"./client/config.yml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\n// ...\n</code></pre>\n\n<p>And in your test file you could do something like this:</p>\n\n<pre><code>// not nice but works\nvar _ = (func() interface{} {\n    _testing = true\n    return nil\n}())\n\nfunc TestNew(t *testing.T) {\n    expected := &amp;Config{}\n    observed := New()\n    if !reflect.DeepEqual(observed, expected) {\n        t.Errorf(\"observed %+v. expecting %+v\\n\", observed, expected)\n    }\n}\n</code></pre>\n\n<p>You can read more on the initialization order here: <a href=\"https://golang.org/ref/spec#Program_initialization_and_execution\" rel=\"noreferrer\">https://golang.org/ref/spec#Program_initialization_and_execution</a></p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3992, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1492169131, "creation_date": 1492166486, "question_id": 43409919, "link": "https://stackoverflow.com/questions/43409919/init-function-breaking-unit-tests", "title": "Init function breaking unit tests", "body": "<p>In the package I want to test, I have an init function that loads the configuration file containing some stuff I want to use to run my application. However, I don't want to trigger this init function while running my unit tests. </p>\n\n<p>Is there any way for skipping or preventing this init function to be called during the unit tests?</p>\n\n<p>Some snippets to illustrate the question:</p>\n\n<pre><code>func init() {\n    var err error // Necessary to prevent config variable shadowing\n    config, err = loadConfig(\"./client/config.yml\")\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc loadConfig(filepath string) (*Config, error) {\n    viper.SetConfigFile(filepath)\n    if err := viper.ReadInConfig(); err != nil {\n        return nil, fmt.Errorf(\"Error loading config file: %s\", err)\n    }\n  (...)\n}\n\n// New returns a Config value(!)\nfunc New() Config {\n    return *config\n}\n</code></pre>\n\n<p>A test case:</p>\n\n<pre><code>func TestNew(t *testing.T) {\n    expected := &amp;Config{}\n    observed := New()\n    if !reflect.DeepEqual(observed, expected) {\n        t.Errorf(\"observed %+v. expecting %+v\\n\", observed, expected)\n    }\n}\n</code></pre>\n"}, {"tags": ["oop", "go", "interface", "mocking", "dependencies"], "comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1492161709, "post_id": 43408646, "comment_id": 73876593, "body": "Is this question meant to be complete?"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1492164735, "post_id": 43408646, "comment_id": 73877988, "body": "Please post your code as simplified as possible but conveying the general idea. To post your code is required for most of practical questions. Keep it clear and clean."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492182973, "post_id": 43408646, "comment_id": 73887412, "body": "There are a million ways to do what you&#39;re asking, depending on your functions in use. Please paste your code."}], "answers": [{"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "edited": false, "score": 0, "creation_date": 1499067022, "post_id": 43408894, "comment_id": 76737989, "body": "@Vicky, could you please add a code snippet and a play.go link to your question. Stackoverflow questions could and should be useful for others and people will be grateful to you. Keep your karma on bright side."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 1, "last_activity_date": 1492164496, "last_edit_date": 1492164496, "creation_date": 1492162337, "answer_id": 43408894, "question_id": 43408646, "link": "https://stackoverflow.com/questions/43408646/function-mocking-through-interface-in-golang/43408894#43408894", "title": "function Mocking through Interface in golang", "body": "<h3><a href=\"https://play.golang.org/p/6FVSfYh2_C\" rel=\"nofollow noreferrer\">Abstract function type</a></h3>\n\n<p>You can do it with dependency injection not using interfaces:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math\"\n)\n\ntype a func(float64) float64\n\nfunc A(arg float64) float64 {\n    return math.Pow(arg, 2)\n}\n\nfunc mock(arg float64) float64 {\n    return math.Sqrt(arg)\n}\n\nfunc b(function a, arg float64) float64 {\n    return function(arg)\n}\n\nfunc main() {\n    fmt.Println(b(A, 2))\n    fmt.Println(b(mock, 2))\n}\n</code></pre>\n\n<h3>Function is first class citizen in Go</h3>\n\n<blockquote>\n  <p>In programming language design, a first-class citizen (also type, object, entity, or value) in a given programming language is an entity which supports all the operations generally available to other entities. </p>\n</blockquote>\n\n<p>It means you can pass function as argument among other possibilities. And of course you can declare an abstract type based on function with concrete interface <strong>(Don't confuse with <code>interface</code> type)</strong></p>\n\n<h3><a href=\"https://play.golang.org/p/i3tGlqsSOl\" rel=\"nofollow noreferrer\">Interface approach</a></h3>\n\n<p>You can make compositions using your functions</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math\"\n)\n\n// Declare an interface type with dependencies\ntype HGer interface {\n    H(float64) float64\n    G(float64) float64\n}\n\n// Declare a dependent type with embedded interface\ntype Dependent struct {\n    HGer\n}\n\nfunc (d *Dependent) B(arg float64) float64 {\n    return d.H(arg) * d.G(arg)\n}\n\n// Implement the interface for an actual program\ntype ImplHGer struct{}\n\nfunc (i *ImplHGer) H(arg float64) float64 {\n    return math.Pow(arg, 2)\n}\n\nfunc (i *ImplHGer) G(arg float64) float64 {\n    return math.Sqrt(arg)\n}\n\n// Implement the interface for mock of dependencies\ntype MockHGer struct{}\n\nfunc (i *MockHGer) H(arg float64) float64 {\n    return float64(0)\n}\n\nfunc (i *MockHGer) G(arg float64) float64 {\n    return float64(0)\n}\n\nfunc main() {\n    // Use real implementation\n    a := Dependent{new(ImplHGer)}\n    // Use the mock\n    b := Dependent{new(MockHGer)}\n    fmt.Println(a.B(8)) // 181.01933598375618\n    fmt.Println(b.B(8)) // 0\n}\n</code></pre>\n\n<h3>Embedding</h3>\n\n<blockquote>\n  <p>Including an anonymous field in a struct is known as embedding. In this case the Discount type is embedded in the PremiumDiscount type. All the methods of Discount are instantly available on the PremiumDiscount type. Furthermore those same methods can be hidden</p>\n</blockquote>\n\n<p>It is possible to embed interface to struct to extend it's behavior or to be more specific - declare abstract dependency.</p>\n"}], "owner": {"reputation": 95, "user_id": 5449397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7CJrP.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/5449397/vicky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 897, "favorite_count": 0, "accepted_answer_id": 43408894, "answer_count": 1, "score": -1, "last_activity_date": 1492182950, "creation_date": 1492161297, "last_edit_date": 1492182950, "question_id": 43408646, "link": "https://stackoverflow.com/questions/43408646/function-mocking-through-interface-in-golang", "title": "function Mocking through Interface in golang", "body": "<p>I am trying to write a unit test code form following code which has 3 level of function calling as below:</p>\n\n<p>The main function calls function A() and then function A calls function B() and C() depending upon some condition and function B calls function E() and F(), whereas function C calls function G() and H() on some condition.<br>\nThe above like the code I have developed, Here I want to mock function E() and F() for function B, and G() and H() for function C. Please suggest me how to do it using interface.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 304, "user_id": 1845836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QmDna.jpg?s=128&g=1", "display_name": "Eddynand Fuchs", "link": "https://stackoverflow.com/users/1845836/eddynand-fuchs"}, "edited": false, "score": 0, "creation_date": 1492159918, "post_id": 43408212, "comment_id": 73875768, "body": "what about <code>cmd.Process.Kill()</code>"}, {"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1492160406, "post_id": 43408212, "comment_id": 73875990, "body": "How do parent &amp; child processes connect to your app / another_app_binary? Which one is which? Are you talking about killing another_app_binary&#39;s child processes? Please provide more information in the question."}, {"owner": {"reputation": 1900, "user_id": 5039916, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4dab9fd1c05639df76171030a5eb176f?s=128&d=identicon&r=PG&f=1", "display_name": "Nema Ga", "link": "https://stackoverflow.com/users/5039916/nema-ga"}, "edited": false, "score": 0, "creation_date": 1492160674, "post_id": 43408212, "comment_id": 73876104, "body": "Thanks, updated the question."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1492163148, "last_edit_date": 1492163148, "creation_date": 1492162038, "answer_id": 43408828, "question_id": 43408212, "link": "https://stackoverflow.com/questions/43408212/child-processes-cleanup-after-termination/43408828#43408828", "title": "Child processes cleanup after termination", "body": "<p>You can use the <a href=\"https://golang.org/pkg/os/signal/\" rel=\"nofollow noreferrer\">os/signal</a> package to listen for the kill signal in your current process.</p>\n\n<pre><code>import (\n    \"os/exec\"\n    \"os\"\n    \"os/signal\"\n)\n\n// ...\n\ncmd := exec.Command(\"another_app_binary\", \"-config\", \"config.conf\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\ncmd.Run()\n\nc := make(chan os.Signal, 2)\nsignal.Notify(c, os.Interrupt, os.Kill)\ngo func() {\n    &lt;-c\n    // cleanup\n    cmd.Process.Kill()\n    os.Exit(1)\n}()\n\n// ...\n</code></pre>\n"}], "owner": {"reputation": 1900, "user_id": 5039916, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4dab9fd1c05639df76171030a5eb176f?s=128&d=identicon&r=PG&f=1", "display_name": "Nema Ga", "link": "https://stackoverflow.com/users/5039916/nema-ga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1492182904, "creation_date": 1492159634, "last_edit_date": 1492182904, "question_id": 43408212, "link": "https://stackoverflow.com/questions/43408212/child-processes-cleanup-after-termination", "title": "Child processes cleanup after termination", "body": "<p>I want to run another binary from go app with something like:</p>\n\n<pre><code>cmd := exec.Command(\"another_app_binary\", \"-config\", \"config.conf\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\ncmd.Run()\n</code></pre>\n\n<p>When I kill the parent process(code above), child process(another_app_binary) becomes orphan. What options do I have to cleanup child processes after parent exits/TERMINATES? It has to be somewhat platform nutural because I plan to run it on win/linux.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1492160432, "creation_date": 1492160432, "answer_id": 43408416, "question_id": 43407537, "link": "https://stackoverflow.com/questions/43407537/in-pq-array-fails-to-pass-values/43408416#43408416", "title": "IN pq.Array fails to pass values", "body": "<p>Postgres's <a href=\"https://www.postgresql.org/docs/current/static/functions-comparisons.html#FUNCTIONS-COMPARISONS-IN-SCALAR\" rel=\"nofollow noreferrer\">IN</a> does not take an array like for example <a href=\"https://www.postgresql.org/docs/current/static/functions-comparisons.html#AEN21103\" rel=\"nofollow noreferrer\">ANY</a> or <a href=\"https://www.postgresql.org/docs/current/static/functions-comparisons.html#AEN21126\" rel=\"nofollow noreferrer\">ALL</a> which is where you can use <code>pq.Array</code>.</p>\n\n<p>Instead of using <code>x NOT IN($1)</code> you can use <code>x &lt;&gt; ALL($1)</code>.</p>\n\n<p>From <a href=\"https://www.postgresql.org/docs/current/static/functions-comparisons.html#AEN21126\" rel=\"nofollow noreferrer\">ALL</a>'s docs.</p>\n\n<blockquote>\n  <p>The left-hand expression is evaluated and compared to each element of\n  the array using the given operator, which must yield a Boolean result.\n  The result of ALL is \"true\" if all comparisons yield true (including\n  the case where the array has zero elements). The result is \"false\" if\n  any false result is found.</p>\n</blockquote>\n"}], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 43408416, "answer_count": 1, "score": 0, "last_activity_date": 1492182884, "creation_date": 1492156646, "last_edit_date": 1492182884, "question_id": 43407537, "link": "https://stackoverflow.com/questions/43407537/in-pq-array-fails-to-pass-values", "title": "IN pq.Array fails to pass values", "body": "<p>I have the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"github.com/lib/pq\"\n)\n\nconst (\n    DB_USER     = \"&lt;username&gt;\"\n    DB_PASSWORD = \"&lt;password&gt;\"\n    DB_NAME     = \"&lt;db&gt;\"\n)\n\nfunc main() {\n    dbinfo := fmt.Sprintf(\"user=%s password=%s dbname=%s sslmode=disable\",\n    DB_USER, DB_PASSWORD, DB_NAME)\n\n    db, err := sql.Open(\"postgres\", dbinfo)\n    checkErr(err)\n    defer db.Close()\n\n    fmt.Println(\"# Querying with blacklist in SQL\")\n    rows, err := db.Query(`\n    SELECT * FROM(\n        SELECT x from (values ('A'), ('B'), ('C') ) s(x)\n    ) As Res1 WHERE x NOT IN ('A');\n`)\n    checkErr(err)\n\n    for rows.Next() {\n        var str string\n        err = rows.Scan(&amp;str)\n        fmt.Println(str) // Prints B,C\n    }\n\n    fmt.Println(\"Querying with blacklist in Golang\")\n    blacklist := []string{\"A\"}\n\n    q := `\n    SELECT * FROM(\n        SELECT x from (values ('A'), ('B'), ('C') ) s(x)\n    ) As Res1 WHERE x NOT IN ($1);\n\n`\n    rows, err = db.Query(q, pq.Array(blacklist))\n    checkErr(err)\n\n    for rows.Next() {\n        var str string\n        err = rows.Scan(&amp;str)\n        fmt.Println(str) // Prints A, B, C\n    }\n}\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>where I pass a pq.Array as a parameter to a Golang Postgres format string $1. However the parameter fails to get passed. When I expect an output of <code>B,C</code>, the program is printing <code>A,B,C</code>.</p>\n\n<pre><code># Querying with blacklist in SQL\nB\nC\nQuerying with blacklist in Golang\nA\nB\nC\n</code></pre>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7865967, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FzQKVQy2mjY/AAAAAAAAAAI/AAAAAAAAAAk/rUURtPunV2U/photo.jpg?sz=128", "display_name": "Sengkathir", "link": "https://stackoverflow.com/users/7865967/sengkathir"}, "edited": false, "score": 0, "creation_date": 1492159160, "post_id": 43407410, "comment_id": 73875452, "body": "Thanks for the answer."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1492157399, "last_edit_date": 1492157399, "creation_date": 1492156040, "answer_id": 43407410, "question_id": 43406888, "link": "https://stackoverflow.com/questions/43406888/access-pointer-value-of-a-struct-inside-a-function/43407410#43407410", "title": "Access pointer value of a struct inside a function", "body": "<p>On this line: <code>structVal := reflect.ValueOf(&amp;u).Elem()</code> you're taking the address of an interface (the argument of your func) and not an address to the interface's underlying value, and then you're passing the pointer to <code>ValueOf</code>, so the <code>.Elem()</code> call returns the \"elem value\" to which the pointer points to, which is the <code>interface</code>, not struct.</p>\n\n<p>If you know for a fact that the passed in value is a struct and not a pointer, all you need is this: <code>structVal := reflect.ValueOf(u)</code>.</p>\n\n<p>If a pointer was passed to your func, eg <code>GetStructFieldPointers(&amp;u, ...</code> then this is what you want: <code>structVal := reflect.ValueOf(u).Elem()</code>.</p>\n\n<p>But also you can handle both cases by checking the value's kind.</p>\n\n<pre><code>rv := reflect.ValueOf(u)\nif rv.Kind() == reflect.Ptr {\n    rv = rv.Elem()\n}\nif rv.Kind() == reflect.Struct {\n    fmt.Println(rv.NumField())\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/9F9LNnwEaH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9F9LNnwEaH</a></p>\n\n<p><strong>Update</strong>:\nTook a better look at your code... If you want to be able to get the addresses of your struct's fields, you need to pass a pointer to the struct as the argument, or else those fields are going to be unaddressable.</p>\n\n<p><a href=\"https://play.golang.org/p/RaA2rau3s-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RaA2rau3s-</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7865967, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FzQKVQy2mjY/AAAAAAAAAAI/AAAAAAAAAAk/rUURtPunV2U/photo.jpg?sz=128", "display_name": "Sengkathir", "link": "https://stackoverflow.com/users/7865967/sengkathir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 43407410, "answer_count": 1, "score": 1, "last_activity_date": 1492182778, "creation_date": 1492153791, "last_edit_date": 1492182778, "question_id": 43406888, "link": "https://stackoverflow.com/questions/43406888/access-pointer-value-of-a-struct-inside-a-function", "title": "Access pointer value of a struct inside a function", "body": "<p>I want to pass a struct object to a function &amp; be able to access its pointer value from that function. I am not able to understand why the following is resulting in error.</p>\n\n<pre><code>func GetStructFieldPointers(u interface{}, jsonFields []string) []interface{} {\n    structVal := reflect.ValueOf(&amp;u).Elem()\n    structType := reflect.TypeOf(u)\n    numberOfFields := structVal.NumField() // getting error here reflect:\n                                           // call of reflect.Value.NumField\n                                           // on interface Value\n    numberOfJSONFields := len(jsonFields)\n    res := make([]interface{}, numberOfJSONFields)\n    fmt.Println(jsonFields)\n    for fieldIndex, field := range jsonFields {\n        for i := 0; i &lt; numberOfFields; i++ {\n            if structType.Field(i).Tag.Get(\"json\") == field {\n                valueField := structVal.Field(i)\n                res[fieldIndex] = valueField.Addr().Interface()\n            }\n        }\n    }\n\n    return res\n}\n\ntype User struct {\n    Id             int      `json:\"id\"`\n    Name           string   `json:\"name\"`\n    Address        string   `json:\"address\"`\n}\nuser := User{}\nres := GetStructFieldPointers(user, []string{\"id\", \"name\"}) \n</code></pre>\n\n<p>To make this work, I had to make <code>structType</code> as a parameter like following:</p>\n\n<pre><code>func GetStructFieldPointers(u interface{}, structType reflect.Type, jsonFields []string) []interface{} {\n    structVal := reflect.ValueOf(u).Elem()\n    // structType := reflect.TypeOf(u)\n    numberOfFields := structVal.NumField() \n    numberOfJSONFields := len(jsonFields)\n    res := make([]interface{}, numberOfJSONFields)\n    fmt.Println(jsonFields)\n    for fieldIndex, field := range jsonFields {\n        for i := 0; i &lt; numberOfFields; i++ {\n            if structType.Field(i).Tag.Get(\"json\") == field {\n                valueField := structVal.Field(i)\n                res[fieldIndex] = valueField.Addr().Interface()\n            }\n        }\n    }\n\n    return res\n}\n\nuser := User{}\nres := GetStructFieldPointers(&amp;user, reflect.TypeOf(user), []string{\"id\", \"name\"}) \n</code></pre>\n\n<p>I like to know how to pass <code>User{}</code> as a parameter &amp; use in both reflect.ValueOf &amp; reflect.TypeOf calls.</p>\n"}, {"tags": ["csv", "go"], "answers": [{"tags": [], "owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "is_accepted": false, "score": 1, "last_activity_date": 1492153636, "creation_date": 1492153636, "answer_id": 43406855, "question_id": 43406667, "link": "https://stackoverflow.com/questions/43406667/gocsv-concatenate-2-csv-columns-into-a-single-struct-member/43406855#43406855", "title": "GoCSV: concatenate 2 csv columns into a single struct member", "body": "<p>(a) I don't think there is a supported way to do this. However you <em>could</em> implement a custom reader that merges fields into each other. Rather proprietary, I wouldn't recommend it.</p>\n\n<p>(b) Why not simply add a method to MyStruct that returns the merged values?</p>\n\n<pre><code>type MyStruct struct { \n    ColA       string `csv:\"colA\"`\n    ColB       string `csv:\"colB\"`\n    ColC       string `csv:\"colC\"`\n}\n\nfunc (m MyStruct) dateTime() string {\n  return ColB+ColC\n}\n</code></pre>\n\n<p>(c) Maybe use a little bit of shell-fu to pre-process the CSV before parsing it?</p>\n"}], "owner": {"reputation": 1713, "user_id": 4052858, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/710d5f65b404307fea9b5a1564c60549?s=128&d=identicon&r=PG&f=1", "display_name": "N.F.", "link": "https://stackoverflow.com/users/4052858/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492153636, "creation_date": 1492152839, "question_id": 43406667, "link": "https://stackoverflow.com/questions/43406667/gocsv-concatenate-2-csv-columns-into-a-single-struct-member", "title": "GoCSV: concatenate 2 csv columns into a single struct member", "body": "<p>Can I concatenate 2 csv columns into a single struct member with <a href=\"https://github.com/gocarina/gocsv\" rel=\"nofollow noreferrer\">Go CSV</a>?</p>\n\n<p>CSV format is like this.</p>\n\n<pre><code>colA, date, time, colB\nA1, 2017-04-14, 09:50:10, B1\nA2, 2017-04-14, 09:50:20, B2\n</code></pre>\n\n<p>I would like to map this CSV into the struct</p>\n\n<pre><code>type MyStruct struct { \n    ColA       string `csv:\"colA\"`\n    DateTime   string  // &lt;- like \"2017-04-14 09:50:10\"\n    ColB       string `csv:\"colB\"`\n}\n</code></pre>\n\n<p>How can I do this with Go CSV or another way in Go?</p>\n"}, {"tags": ["go", "sublimetext3", "sublime-text-plugin", "gosublime"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492182637, "post_id": 43406148, "comment_id": 73887201, "body": "Where do you see this infinite loop?"}, {"owner": {"reputation": 3197, "user_id": 5853530, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3b9567983f2e1d6c2315fa26202accb6?s=128&d=identicon&r=PG&f=1", "display_name": "Rajeev Singh", "link": "https://stackoverflow.com/users/5853530/rajeev-singh"}, "edited": false, "score": 0, "creation_date": 1492197993, "post_id": 43406148, "comment_id": 73894952, "body": "try to run your program from a terminal"}], "answers": [{"tags": [], "owner": {"reputation": 300, "user_id": 2068742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/531732e06128a2c69f720d9abefbc464?s=128&d=identicon&r=PG", "display_name": "AvnishSingh", "link": "https://stackoverflow.com/users/2068742/avnishsingh"}, "is_accepted": false, "score": 0, "last_activity_date": 1492228091, "creation_date": 1492228091, "answer_id": 43421987, "question_id": 43406148, "link": "https://stackoverflow.com/questions/43406148/go-run-is-going-in-infinite-loop-using-sublime-text-3/43421987#43421987", "title": "&quot;go run&quot; is going in infinite loop using sublime text 3", "body": "<p>Open sublime\nGoto Tools->Build System-> New build System. Paste below lines in the file and save by some_name.sublime-build</p>\n\n<pre><code>{\n\"shell_cmd\": \"go run $file\",\n\"shell\":true\n}\n</code></pre>\n\n<p>Goto Tools->Build system-><code>&lt;select-your-build or automatic&gt;</code></p>\n\n<p>Goto Tools->Build</p>\n\n<p>Done cheers :)</p>\n"}], "owner": {"reputation": 351, "user_id": 5534731, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e0347faf2a8ecc002919f9374015dd51?s=128&d=identicon&r=PG", "display_name": "me24hour", "link": "https://stackoverflow.com/users/5534731/me24hour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492228091, "creation_date": 1492150157, "last_edit_date": 1492182611, "question_id": 43406148, "link": "https://stackoverflow.com/questions/43406148/go-run-is-going-in-infinite-loop-using-sublime-text-3", "title": "&quot;go run&quot; is going in infinite loop using sublime text 3", "body": "<p>I am trying to run go code in sublime text 3.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>However, when I go under <code>Tools -&gt; Build</code> I see that the program goes in infinite loop. </p>\n\n<pre><code>GoSublime r17.03.05-1 9o: type `help` for help and command documentation\n\n[ `go run main.go` \u231b ]\n[ ~/Documents/SublimeWorkspace/ ] # \n</code></pre>\n\n<p>Please let me know what I might be missing here.</p>\n"}]