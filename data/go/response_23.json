[{"tags": ["struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1434583242, "creation_date": 1434583242, "answer_id": 30904096, "question_id": 30903721, "link": "https://stackoverflow.com/questions/30903721/referencing-yourself-inside-of-a-struct/30904096#30904096", "title": "Referencing yourself inside of a struct", "body": "<p>You can't refer to a value inside its own declaration. You need to initialize the value first, then you can assign the method you want to use to Handler.</p>\n\n<pre><code>testAuth := &amp;Authorization{\n    Username: \"someusername\",\n    Password: \"somepassword\",\n}\ntestAuth.Handler = testAuth.HandleFunc\n\nauths := Authorizations{\n    \"test\": testAuth,\n}\n</code></pre>\n"}], "owner": {"reputation": 9166, "user_id": 571783, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e99163d63d146cc552e149820643d4ed?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/571783/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 30904096, "answer_count": 1, "score": 0, "last_activity_date": 1434583242, "creation_date": 1434580969, "question_id": 30903721, "link": "https://stackoverflow.com/questions/30903721/referencing-yourself-inside-of-a-struct", "title": "Referencing yourself inside of a struct", "body": "<p>Let's say I have a type that's a struct like so:</p>\n\n<pre><code>type Authorization struct {\n    Username string\n    Password string\n    Handler  func(http.HandlerFunc) http.HandlerFunc\n}\n</code></pre>\n\n<p>And I have an array of these:</p>\n\n<pre><code>type Authorizations map[string]*Authorization\n</code></pre>\n\n<p>I want to be able to do something like this:</p>\n\n<pre><code>var auth = Authorizations{\n    \"test\": *Authorization{\n        \"someusername\",\n        \"somepassword\",\n        self.BasicAuth,\n    },\n}\n</code></pre>\n\n<p>Assume that self.BasicAuth (which obviously doesn't work) is a method on the Authorization type. What is the syntactically correct way to do this?</p>\n"}, {"tags": ["javascript", "go"], "comments": [{"owner": {"reputation": 99450, "user_id": 1686485, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/g3GW9.png?s=128&g=1", "display_name": "tymeJV", "link": "https://stackoverflow.com/users/1686485/tymejv"}, "edited": false, "score": 0, "creation_date": 1434573305, "post_id": 30901856, "comment_id": 49842662, "body": "Try prefixing the <code>src</code> with a <code>&#47;</code>, <code>src=&quot;&#47;sankey.js&quot;</code>"}, {"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 0, "creation_date": 1434575616, "post_id": 30901856, "comment_id": 49843913, "body": "Can you load the script directly? <code>http:&#47;&#47;localhost:8888&#47;sankey.js</code> ??"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434575710, "post_id": 30901856, "comment_id": 49843966, "body": "Yes. I can except at localhost:8100. I added a random string, in the hopes that I would get an error  debugger console.log(&quot;HELLO WORLD&quot;); dfdfd  but nothing, it&#39;s like the browser doesn&#39;t know that this is a javascript file, and it&#39;s treating it like text"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434575977, "post_id": 30901856, "comment_id": 49844083, "body": "Nope - changes I make locally are being updated. Could it be how I&#39;m serving the index.html?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434576226, "post_id": 30901856, "comment_id": 49844193, "body": "Is there a way for javascript to be served such that it is being treated like a text file?"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1434576712, "post_id": 30901856, "comment_id": 49844404, "body": "Have you tried placing the &lt;script&gt; tag just before the closing &lt;/body&gt; tag?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434576831, "post_id": 30901856, "comment_id": 49844457, "body": "Just tried that, no dice."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434576887, "post_id": 30901856, "comment_id": 49844486, "body": "This has happened to me before. Make sure that the javascript file is being served with the correct content type (e.g. <code>application&#47;javascript</code>)."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434576925, "post_id": 30901856, "comment_id": 49844509, "body": "(the web inspector should show this - status, accept-encoding, type, etc.)"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434577025, "post_id": 30901856, "comment_id": 49844548, "body": "@TimCooper, what do you mean? So right now I&#39;m serving html that has script tags, what should the content type be?"}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434577110, "post_id": 30901856, "comment_id": 49844579, "body": "Ok. So looking at the Headers for sankey.js, I see that the Content-Type is application.javascript and there&#39;s a 200 status code"}], "answers": [{"comments": [{"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434574210, "post_id": 30902035, "comment_id": 49843189, "body": "it is being served - I see that sankey.js exists under sources, and the request for it has a 200 response"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434574359, "post_id": 30902035, "comment_id": 49843276, "body": "Great, then I agree with @toshiomagic and suggest that you add a break point in your javascript."}, {"owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "edited": false, "score": 0, "creation_date": 1434574808, "post_id": 30902035, "comment_id": 49843496, "body": "So I added a debugger, and it doesn&#39;t trigger"}, {"owner": {"reputation": 15256, "user_id": 43786, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/40d8767cf48359c6e880fb66a6916de6?s=128&d=identicon&r=PG", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/43786/nicholas"}, "edited": false, "score": 0, "creation_date": 1434584240, "post_id": 30902035, "comment_id": 49847009, "body": "Is the js served with a content type header ?"}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": false, "score": 0, "last_activity_date": 1434573838, "creation_date": 1434573838, "answer_id": 30902035, "question_id": 30901856, "link": "https://stackoverflow.com/questions/30901856/locally-served-javascript-not-running/30902035#30902035", "title": "Locally served javascript not running", "body": "<p>My guess based on having a similar problem when I wrote my own basic web server using Go (golang) was that I got the paths to the file mixed so it was getting <code>404 Not Found</code>.</p>\n\n<p>I recomend using the Network tab in Chrome debug (F12) to check that the <code>sankey.js</code> is actually being served to the browser.  </p>\n"}], "owner": {"reputation": 5712, "user_id": 915672, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/e098cd6eb0f9064f197a2a6e016f3d63?s=128&d=identicon&r=PG&f=1", "display_name": "praks5432", "link": "https://stackoverflow.com/users/915672/praks5432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1434574854, "creation_date": 1434573163, "last_edit_date": 1495540712, "question_id": 30901856, "link": "https://stackoverflow.com/questions/30901856/locally-served-javascript-not-running", "title": "Locally served javascript not running", "body": "<p>So I have a js file called sankey.js that has this content -</p>\n\n<pre><code>console.log(\"HELLO WORLD\");\n</code></pre>\n\n<p>I load it in an index.html file that looks like this</p>\n\n<pre><code>&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javacript\" src=\"sankey.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javacript\" src=\"//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.2.1/backbone-min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\" src=\"//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js\"&gt;&lt;/script&gt;\n\n&lt;body&gt;\n    &lt;h1&gt; TEST &lt;/h1&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>This is served by a golang webserver - the rest of the code is in this question. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/30900727/cannot-find-local-script-resource-with-golang-server/30901320#30901320\">https://stackoverflow.com/questions/30900727/cannot-find-local-script-resource-with-golang-server/30901320#30901320</a></p>\n\n<p>I successful find the file, but the console.log does not show. </p>\n\n<p>Why? </p>\n\n<p>I even added a debugger, like this</p>\n\n<pre><code>debugger;\nconsole.log(\"HELLO WORLD\");\n</code></pre>\n\n<p>And that is not run. </p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1434564538, "post_id": 30897623, "comment_id": 49837331, "body": "Sure you could use a slice, but what do you do when you add an attribute, or another element type, or inner text? There&#39;s also no canonical way to marshal a data structure to an element. What comprises an attribute vs a sub-element, or a namespace? A map isn&#39;t ordered, and can produce different XML each time it&#39;s marshaled. There are a lot of reasons there&#39;s no 1 to 1 mapping."}, {"owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434645300, "post_id": 30897623, "comment_id": 49878901, "body": "I don&#39;t understand why that would preclude translation between the two. Why not just add another struct member for an attribute, create a new type for an element, or have a struct member for inner text? A map isn&#39;t ordered, but you don&#39;t need to use a map, you can just use an array."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434647032, "post_id": 30897623, "comment_id": 49879909, "body": "Of course you can represent an XML document with a combination of purpose designed data structures. What you can&#39;t do is use it as a generalized serialization format for a struct and map that directly to an XML element."}, {"owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434659409, "post_id": 30897623, "comment_id": 49887239, "body": "Ah okay, I understand the original comment now thanks to your explanation. You should put your texts as an answer!"}], "owner": {"reputation": 27292, "user_id": 100208, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e2fda105627061de42901c671680638b?s=128&d=identicon&r=PG&f=1", "display_name": "atp", "link": "https://stackoverflow.com/users/100208/atp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434559547, "creation_date": 1434559547, "question_id": 30897623, "link": "https://stackoverflow.com/questions/30897623/go-why-is-mapping-between-xml-and-data-structures-flawed", "title": "Go: Why is &quot;mapping between XML and data structures flawed&quot;?", "body": "<p>In the Go XML package, <a href=\"https://golang.org/pkg/encoding/xml/#pkg-note-BUG\" rel=\"nofollow\">there is a comment</a>: </p>\n\n<blockquote>\n  <p>Mapping between XML elements and data structures is inherently flawed: an XML element is an order-dependent collection of anonymous values, while a data structure is an order-independent collection of named values. See package json for a textual representation more suitable to data structures.</p>\n</blockquote>\n\n<p>Why would someone assert this? A data structure can also be, for example, an array, which is an order-dependent collection of values. </p>\n\n<p>XML may typically be verbose and complex but I can't see the argument that mapping it to a data structure is flawed. Can someone explain this?</p>\n"}, {"tags": ["go", "floating-point", "type-conversion", "floating-point-conversion"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1471849004, "last_edit_date": 1471849004, "creation_date": 1434559372, "answer_id": 30897573, "question_id": 30897208, "link": "https://stackoverflow.com/questions/30897208/how-to-change-a-float64-number-to-uint64-in-a-right-way/30897573#30897573", "title": "How to change a float64 number to uint64 in a right way?", "body": "<p>The problem here is the representation of constants and floating point numbers.</p>\n\n<p>Constants are represented in arbitrary precision. Floating point numbers are represented using the <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"noreferrer\">IEEE 754</a> standard.</p>\n\n<p><a href=\"http://golang.org/ref/spec#Constants\" rel=\"noreferrer\">Spec: Constants:</a></p>\n\n<blockquote>\n  <p>Numeric constants represent values of arbitrary precision and do not overflow.</p>\n</blockquote>\n\n<p><a href=\"http://golang.org/ref/spec#Numeric_types\" rel=\"noreferrer\">Spec: Numeric types:</a></p>\n\n<blockquote>\n<pre><code>float64     the set of all IEEE-754 64-bit floating-point numbers\n</code></pre>\n</blockquote>\n\n<p>In IEEE 754 the double precision which is using 64 bits (<code>float64</code> in Go) <strong>53 bits</strong> are used to store the digits. This means the max digits (max number) that can be represented is the number of digits of <code>2&lt;&lt;52</code> which is (1 bit is for sign):</p>\n\n<pre><code>2&lt;&lt;52        : 9007199254740992\nYour constant: 6161047830682206209\n</code></pre>\n\n<p>15.95 digits to be precise (16 digits, but not all values that you can describe with 16 digits, only up to <code>9007199254740992</code>).</p>\n\n<p>The integer constant you try to put into a variable of type <code>float64</code> simply <strong>does not fit</strong>  into 52 bits so it has to be rounded and digits (or bits) will be cut off (lost).</p>\n\n<p>You can verify this by printing the original <code>n float64</code> number:</p>\n\n<pre><code>var n float64 = 6161047830682206209\nfmt.Printf(\"%f\\n\", n)\nfmt.Printf(\"%d\\n\", uint64(n))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>6161047830682206208.000000\n6161047830682206208\n</code></pre>\n\n<p>The problem is not with conversion, the problem is that the <code>float64</code> value you try to convert is already not equal to the constant you tried to assign to it.</p>\n\n<p><strong>Just for curiosity:</strong></p>\n\n<p>Try the same with a much bigger number: +500 compared to the first const:</p>\n\n<pre><code>n = 6161047830682206709 // +500 compared to first!\nfmt.Printf(\"%f\\n\", n2)\nfmt.Printf(\"%d\\n\", uint64(n2))\n</code></pre>\n\n<p>Output <strong>still</strong> the same (the last digits / bits are cut off, +500 included!):</p>\n\n<pre><code>6161047830682206208.000000\n6161047830682206208\n</code></pre>\n\n<p>Try a smaller number whose digits can be represented precisely using 52 bits (less than ~16 digits):</p>\n\n<pre><code>n = 7830682206209\nfmt.Printf(\"%f\\n\", n)\nfmt.Printf(\"%d\\n\", uint64(n))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>7830682206209.000000\n7830682206209\n</code></pre>\n\n<p>Try it on the <a href=\"http://play.golang.org/p/JERFLKyN-B\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1128, "user_id": 11246894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f8e8c47996c0510c64dbacab90104?s=128&d=identicon&r=PG&f=1", "display_name": "AJR", "link": "https://stackoverflow.com/users/11246894/ajr"}, "is_accepted": false, "score": 4, "last_activity_date": 1598245245, "last_edit_date": 1598245245, "creation_date": 1591682505, "answer_id": 62276005, "question_id": 30897208, "link": "https://stackoverflow.com/questions/30897208/how-to-change-a-float64-number-to-uint64-in-a-right-way/62276005#62276005", "title": "How to change a float64 number to uint64 in a right way?", "body": "<p>The problem is not with the conversion but that the number is too large an integer to be stored <em>exactly</em> as a <code>float64</code>. The assignment to <code>n</code> results in some loss of significance.</p>\n<p>If you think about it, your number (about 6e18) is very close to the largest <code>uint64</code> (2^64-1 or about 18e18).  A <code>uint64</code> uses all of it's 64 bits to store an integer but a <code>float64</code> must use some of its 64 bits to store an exponent so it's going to have less bits to remember the mantissa.</p>\n<p>In summary, if you assign a <code>uint64</code> (or integer constant) larger than about 10^15 to a <code>float64</code> and back to a <code>uint64</code> you will get a close, but probably not exactly the same, value.</p>\n<p>[BTW Icza's answer is good and correct. I hope this answer is simple summary.]</p>\n"}], "owner": {"reputation": 307, "user_id": 1306312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4623558095bc289745e22692ac49d7d8?s=128&d=identicon&r=PG", "display_name": "vzex", "link": "https://stackoverflow.com/users/1306312/vzex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4457, "favorite_count": 0, "accepted_answer_id": 30897573, "answer_count": 2, "score": 2, "last_activity_date": 1598245245, "creation_date": 1434558321, "last_edit_date": 1434560001, "question_id": 30897208, "link": "https://stackoverflow.com/questions/30897208/how-to-change-a-float64-number-to-uint64-in-a-right-way", "title": "How to change a float64 number to uint64 in a right way?", "body": "<pre><code>package main\n\nfunc main() {\n    var n float64 = 6161047830682206209\n    println(uint64(n))\n}\n</code></pre>\n\n<p>The output will be:</p>\n\n<pre><code>6161047830682206208\n</code></pre>\n\n<p>It looks like that when <code>float64</code> change to <code>uint64</code>, the fraction is discarded.</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434563080, "post_id": 30897945, "comment_id": 49836475, "body": "My version of gorm was really out of date. I must have previously ran a go get on it and its been sitting there stale without me knowing. Could you give me a code example of how I should create the podcast variable? Thanks!"}, {"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434568904, "post_id": 30897945, "comment_id": 49839966, "body": "The above still searches podcast_id = 0 though?"}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "reply_to_user": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434569057, "post_id": 30897945, "comment_id": 49840073, "body": "No because the podcast id is populated by gorm after inserting ;)"}, {"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434569445, "post_id": 30897945, "comment_id": 49840330, "body": "(/home/gregf/code/go/src/github.com/gregf/gormtest/main.go:4&zwnj;&#8203;8) [2015-06-17 15:28:58]  [0.55ms]  SELECT  * FROM &quot;episodes&quot;  WHERE (&quot;podcast_id&quot; = &#39;0"}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "reply_to_user": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434570436, "post_id": 30897945, "comment_id": 49840935, "body": "on my machine everything is working, did you check if any error occurred? the Create method has a .Error property for example"}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "reply_to_user": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1434616371, "post_id": 30897945, "comment_id": 49858169, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/80854/discussion-between-alessio-and-gregf\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "is_accepted": true, "score": 1, "last_activity_date": 1434563315, "last_edit_date": 1434563315, "creation_date": 1434560625, "answer_id": 30897945, "question_id": 30897123, "link": "https://stackoverflow.com/questions/30897123/trouble-retrieving-has-many-using-gorm/30897945#30897945", "title": "Trouble retrieving Has Many using Gorm", "body": "<p>Which version of GO and GORM are you using? I've tried on my machine and this is the log:</p>\n\n<pre><code>[2015-06-17 19:02:11]  [12.00ms]  CREATE TABLE \"podcasts\" (\"id\" integer,\"title\" varchar(255),\"rss_url\" varchar(255),\"url\" varchar(255) , PRIMARY KEY (\"id\"))\n[2015-06-17 19:02:11]  [1.26ms]  CREATE TABLE \"episodes\" (\"id\" integer,\"podcast_id\" integer,\"title\" varchar(255),\"url\" varchar(255),\"downloaded\" bool , PRIMARY KEY (\"id\")) \n[2015-06-17 19:02:11]  [1.25ms]  SELECT  * FROM \"episodes\"  WHERE (\"podcast_id\" = '0')\n</code></pre>\n\n<p>Please note that because you didn't create the podcast variable, the podcast_id is 0 so the query does not make so much sense.</p>\n\n<p>In order to create the podcast, simply add this code</p>\n\n<pre><code>db.NewRecord(podcast)\ndb.Create(&amp;podcast)\n\nvar episodes []Episode\ndb.Model(&amp;podcast).Related(&amp;episodes)\n\nlog.Print(episodes)\n</code></pre>\n"}], "owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 30897945, "answer_count": 1, "score": 0, "last_activity_date": 1434563315, "creation_date": 1434558040, "question_id": 30897123, "link": "https://stackoverflow.com/questions/30897123/trouble-retrieving-has-many-using-gorm", "title": "Trouble retrieving Has Many using Gorm", "body": "<p>When I try to get episodes back from a podcast I get <code>invalid association []</code>. Not sure what I'm doing wrong.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Podcast struct {\n    Id       int\n    Title    string\n    RssUrl   string `sql:\"unique_index\"`\n    Url      string\n    Episodes []Episode\n}\n\ntype Episode struct {\n    Id         int\n    PodcastID  int `sql:\"index\"`\n    Title      string\n    Url        string `sql:\"unique_index\"`\n    Downloaded bool\n}\n\nfunc main() {\n    db, err := gorm.Open(\"sqlite3\", \"gorm.db\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    db.LogMode(true)\n\n    db.CreateTable(&amp;Podcast{})\n    db.CreateTable(&amp;Episode{})\n\n    podcast := Podcast{\n      Title:    \"My Podcast\",\n      RssUrl:   \"http://example.com/feed/\",\n      Url:      \"http://www.example.com\",\n      Episodes: []Episode{{Title: \"Episode One Point Oh!\", Url: \"http://www.example.com/one-point-oh\", Downloaded: false}},\n    }\n\n    var episodes []Episode\n    db.Model(&amp;podcast).Related(&amp;episodes)\n}\n</code></pre>\n"}, {"tags": ["c", "go", "linker", "ld", "gccgo"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1434557757, "post_id": 30896892, "comment_id": 49833057, "body": "Works for me on version <code>a2aaede</code> and Ubuntu 14.04. Have you tried to update to a newer dev version?"}, {"owner": {"reputation": 13985, "user_id": 187878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c355dd26a5f80e1605d2ff1ecb6e719e?s=128&d=identicon&r=PG", "display_name": "shazow", "link": "https://stackoverflow.com/users/187878/shazow"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1434558208, "post_id": 30896892, "comment_id": 49833375, "body": "Pulled <code>a2aaede</code>, same issue for me though. Might be related to OSX somehow, though gcc-5 fails in a similar way."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1434558875, "post_id": 30896892, "comment_id": 49833823, "body": "Might be worth it to <a href=\"https://github.com/golang/go/issues/new\" rel=\"nofollow noreferrer\">open an issue</a> about this then."}, {"owner": {"reputation": 13985, "user_id": 187878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c355dd26a5f80e1605d2ff1ecb6e719e?s=128&d=identicon&r=PG", "display_name": "shazow", "link": "https://stackoverflow.com/users/187878/shazow"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1434560564, "post_id": 30896892, "comment_id": 49834948, "body": "@Ainar-G Good point. I&#39;ll ask in a couple more places and open an issue if I can&#39;t figure it out. Thanks. :)"}, {"owner": {"reputation": 13985, "user_id": 187878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c355dd26a5f80e1605d2ff1ecb6e719e?s=128&d=identicon&r=PG", "display_name": "shazow", "link": "https://stackoverflow.com/users/187878/shazow"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1434562144, "post_id": 30896892, "comment_id": 49835875, "body": "Opened <a href=\"https://github.com/golang/go/issues/11258\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/11258</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13985, "user_id": 187878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c355dd26a5f80e1605d2ff1ecb6e719e?s=128&d=identicon&r=PG", "display_name": "shazow", "link": "https://stackoverflow.com/users/187878/shazow"}, "is_accepted": true, "score": 8, "last_activity_date": 1434643874, "last_edit_date": 1434643874, "creation_date": 1434566562, "answer_id": 30899819, "question_id": 30896892, "link": "https://stackoverflow.com/questions/30896892/using-go-1-5-buildmode-c-archive-with-net-http-server-linked-from-c/30899819#30899819", "title": "Using Go 1.5 buildmode=c-archive with net/http.Server linked from C", "body": "<p>Turns out this problem exists on OSX/darwin. To work around it, we need to add <code>-framework CoreFoundation -framework Security</code> options to the gcc linking command. The final command looks like this:</p>\n\n<pre><code>$ gcc -o gohttp-c examples/c/main.c gohttplib.a \\\n      -framework CoreFoundation -framework Security -lpthread\n</code></pre>\n\n<p>This requirement might be removed in a future version of Go. More discussion on this issue here: <a href=\"https://github.com/golang/go/issues/11258\">https://github.com/golang/go/issues/11258</a></p>\n"}], "owner": {"reputation": 13985, "user_id": 187878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c355dd26a5f80e1605d2ff1ecb6e719e?s=128&d=identicon&r=PG", "display_name": "shazow", "link": "https://stackoverflow.com/users/187878/shazow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1221, "favorite_count": 3, "accepted_answer_id": 30899819, "answer_count": 1, "score": 7, "last_activity_date": 1434643874, "creation_date": 1434557351, "last_edit_date": 1434560298, "question_id": 30896892, "link": "https://stackoverflow.com/questions/30896892/using-go-1-5-buildmode-c-archive-with-net-http-server-linked-from-c", "title": "Using Go 1.5 buildmode=c-archive with net/http.Server linked from C", "body": "<p>The upcoming release of Go 1.5 comes with <a href=\"https://docs.google.com/document/d/1nr-TQHw_er6GOQRsF6T43GGhFDelrAP0NqSS_00RgZQ/view?pli=1\">new buildmodes</a> which allow for exporting Go symbols to be linked and called from C code. I've been playing around with it and got basic \"Hello world\" examples working, but now I'm trying to link a Go library which starts a <code>net/http.Server</code> and it's failing. The code looks like this (<a href=\"https://github.com/shazow/gohttplib/tree/stackoverflow\">it's also available here</a>):</p>\n\n<p><strong>gohttplib.go:</strong></p>\n\n<pre><code>package main\n\nimport \"C\"\nimport \"net/http\"\n\n//export ListenAndServe\nfunc ListenAndServe(caddr *C.char) {\n    addr := C.GoString(caddr)\n    http.ListenAndServe(addr, nil)\n}\n\nfunc main() {}\n</code></pre>\n\n<p><strong>examples/c/main.c:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"../../gohttplib.h\"\n\nint main()\n{\n    ListenAndServe(\":8000\");\n    return 0;\n}\n</code></pre>\n\n<p>Producing the statically-linked object and headers works fine:</p>\n\n<pre><code>$ go build -buildmode=c-archive\n</code></pre>\n\n<p>But compiling against it is failing:</p>\n\n<pre><code>$ gcc -o gohttp-c examples/c/main.c gohttplib.a -lpthread\nUndefined symbols for architecture x86_64:\n  \"_CFArrayGetCount\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_CFArrayGetValueAtIndex\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_CFDataAppendBytes\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_CFDataCreateMutable\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_CFDataGetBytePtr\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n      __cgo_6dbb806e9976_Cfunc_CFDataGetBytePtr in gohttplib.a(000003.o)\n     (maybe you meant: __cgo_6dbb806e9976_Cfunc_CFDataGetBytePtr)\n  \"_CFDataGetLength\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n      __cgo_6dbb806e9976_Cfunc_CFDataGetLength in gohttplib.a(000003.o)\n     (maybe you meant: __cgo_6dbb806e9976_Cfunc_CFDataGetLength)\n  \"_CFRelease\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n      __cgo_6dbb806e9976_Cfunc_CFRelease in gohttplib.a(000003.o)\n     (maybe you meant: __cgo_6dbb806e9976_Cfunc_CFRelease)\n  \"_SecKeychainItemExport\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_SecTrustCopyAnchorCertificates\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\n  \"_kCFAllocatorDefault\", referenced from:\n      _FetchPEMRoots in gohttplib.a(000003.o)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nmake: *** [example-c] Error 1\n</code></pre>\n\n<p>This is using a recent version from the Go github repository (38e3427) on OS X 10.9.5. I understand that Go 1.5 is not released yet and that there are no guarantees about it working, but I'm doing this for educational purposes and I suspect I'm missing something.</p>\n\n<p>Related versions:</p>\n\n<pre><code>$ ld -v\n@(#)PROGRAM:ld  PROJECT:ld64-241.9\nconfigured to support archs: armv6 armv7 armv7s arm64 i386 x86_64 x86_64h armv6m armv7m armv7em\nLTO support using: LLVM version 3.5svn\n$ gcc --version\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)\nTarget: x86_64-apple-darwin13.4.0\nThread model: posix\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo", "compose"], "comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "reply_to_user": {"reputation": 21321, "user_id": 3088349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5cbe13d76e559198ea6857799b044b?s=128&d=identicon&r=PG", "display_name": "maytham-\u026f\u0250\u0265\u0287\u028e\u0250\u026f", "link": "https://stackoverflow.com/users/3088349/maytham-%c9%af%c9%90%c9%a5%ca%87%ca%8e%c9%90%c9%af"}, "edited": false, "score": 0, "creation_date": 1434555856, "post_id": 30896287, "comment_id": 49831678, "body": "Yeah I thought that - how do I overcome this issue?"}, {"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "reply_to_user": {"reputation": 21321, "user_id": 3088349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5cbe13d76e559198ea6857799b044b?s=128&d=identicon&r=PG", "display_name": "maytham-\u026f\u0250\u0265\u0287\u028e\u0250\u026f", "link": "https://stackoverflow.com/users/3088349/maytham-%c9%af%c9%90%c9%a5%ca%87%ca%8e%c9%90%c9%af"}, "edited": false, "score": 0, "creation_date": 1434556477, "post_id": 30896287, "comment_id": 49832111, "body": "The database does have a new name - a different name."}, {"owner": {"reputation": 21321, "user_id": 3088349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5cbe13d76e559198ea6857799b044b?s=128&d=identicon&r=PG", "display_name": "maytham-\u026f\u0250\u0265\u0287\u028e\u0250\u026f", "link": "https://stackoverflow.com/users/3088349/maytham-%c9%af%c9%90%c9%a5%ca%87%ca%8e%c9%90%c9%af"}, "edited": false, "score": 0, "creation_date": 1434609882, "post_id": 30896287, "comment_id": 49854316, "body": "Glad you found a solution, I have learn new thing today too."}], "answers": [{"comments": [{"owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "edited": false, "score": 0, "creation_date": 1434561694, "post_id": 30897223, "comment_id": 49835606, "body": "Oh you&#39;re right - I forgot about the extra reference to the DB name. That&#39;s the issue."}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 4, "last_activity_date": 1434558361, "creation_date": 1434558361, "answer_id": 30897223, "question_id": 30896287, "link": "https://stackoverflow.com/questions/30896287/does-mgo-cache-connection-strings/30897223#30897223", "title": "Does Mgo cache connection strings?", "body": "<p>No, mgo does not cache the connection strings you give to the <a href=\"http://gopkg.in/mgo.v2#Dial\" rel=\"nofollow\">mgo.Dial</a> function. It's not even clear to me what that would mean? Using an incorrect database name after you explicitly asked it to connect to a different database would be a serious bug, rather than caching.</p>\n\n<p>As for your problem, are you sure you are not referring to the old database name inside your own code? The Dial function is not the only way to specify database names (hint: <a href=\"http://gopkg.in/mgo.v2#Session.DB\" rel=\"nofollow\">session.DB</a>)</p>\n"}], "owner": {"reputation": 9071, "user_id": 1003632, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/80a7f76fb4682911dc2f56d7cf491454?s=128&d=identicon&r=PG", "display_name": "tommyd456", "link": "https://stackoverflow.com/users/1003632/tommyd456"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 30897223, "answer_count": 1, "score": 0, "last_activity_date": 1434558361, "creation_date": 1434555727, "last_edit_date": 1434556697, "question_id": 30896287, "link": "https://stackoverflow.com/questions/30896287/does-mgo-cache-connection-strings", "title": "Does Mgo cache connection strings?", "body": "<p>My Go application has been connecting to a MongoDB (hosted on Compose.io) using MGO with no issues.</p>\n\n<p>Today I decided to delete this database and add a different one (again using Compose). I updated the connection string.</p>\n\n<p>So I connect using:</p>\n\n<pre><code>db, err := mgo.Dial(\"mongodb://&lt;username&gt;:&lt;password&gt;@dogen.mongohq.com:10048/db-name\")\n</code></pre>\n\n<p>with the username and password in place.</p>\n\n<p>Strangely, the application still appears to connect to the old database. I know this because I printed the <code>err</code> message out which told me: <strong>not authorized for query on my-old-db-name</strong> after I tried to perform a query.</p>\n\n<p>I have run <code>go install</code> to compile again but still no luck.</p>\n"}, {"tags": ["image", "go", "martini"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1434556401, "post_id": 30896117, "comment_id": 49832067, "body": "You could debug this by making sure the multipart.File really is a jpeg: Check the first handful of bytes."}, {"owner": {"reputation": 497, "user_id": 134441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72f54820f9d924e7a1593ff71676b333?s=128&d=identicon&r=PG", "display_name": "markmarkoh", "link": "https://stackoverflow.com/users/134441/markmarkoh"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434562227, "post_id": 30896117, "comment_id": 49835924, "body": "@Volker It&#39;s not, the first 2 bytes are not &#39;FF D8&#39;. I can send that variable to s3 and it get&#39;s saved as an image, how can I do the same locally without <code>image.Decode(imageFile)</code>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434573911, "post_id": 30896117, "comment_id": 49843002, "body": "No idea. If you could post the let&#39;s say first 100 bytes someone might recognise it."}], "answers": [{"comments": [{"owner": {"reputation": 497, "user_id": 134441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72f54820f9d924e7a1593ff71676b333?s=128&d=identicon&r=PG", "display_name": "markmarkoh", "link": "https://stackoverflow.com/users/134441/markmarkoh"}, "edited": false, "score": 0, "creation_date": 1434721174, "post_id": 30907292, "comment_id": 49914011, "body": "This work as long as I changed the parameter type to <code>multipart.File</code> (since that implements <code>io.Reader</code> and <code>io.Seeker</code>). Thanks @ThunderCat"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 6, "last_activity_date": 1434726387, "last_edit_date": 1434726387, "creation_date": 1434606058, "answer_id": 30907292, "question_id": 30896117, "link": "https://stackoverflow.com/questions/30896117/image-decode-results-in-unknown-format-when-source-is-multipart-file/30907292#30907292", "title": "image.Decode results in &quot;unknown format&quot; when source is multipart.File", "body": "<p>The call <code>uploader.Upload</code> reads to the end of the file. Seek back to the beginning of the file before calling <code>CreateThumbnail</code>:</p>\n\n<pre><code>func UploadToS3(file multipart.File, /*snip*/) {\n  _, uploadErr := uploader.Upload(&amp;s3manager.UploadInput{\n    Bucket: aws.String(bucket),\n    Key:    aws.String(key),\n    Body:   file,\n    ContentType: aws.String(mimeType),\n    ACL: aws.String(\"public-read\"),\n  })\n  // Seek back to beginning of file for CreateThumbnail\n  if _, err := file.Seek(0, 0); err != nil {\n    // handle error\n  }\n  reader, err := CreateThumbnail(file)\n}    \n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 134441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72f54820f9d924e7a1593ff71676b333?s=128&d=identicon&r=PG", "display_name": "markmarkoh", "link": "https://stackoverflow.com/users/134441/markmarkoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3517, "favorite_count": 0, "accepted_answer_id": 30907292, "answer_count": 1, "score": 4, "last_activity_date": 1434726387, "creation_date": 1434555294, "question_id": 30896117, "link": "https://stackoverflow.com/questions/30896117/image-decode-results-in-unknown-format-when-source-is-multipart-file", "title": "image.Decode results in &quot;unknown format&quot; when source is multipart.File", "body": "<p>I have a <code>multipart.File</code> that a user uploads to my server, and then I take that file and upload it to s3 using <code>aws-sdk-go</code>, but I also want to create a thumbnail of that image. </p>\n\n<p>The code below works fine in my tests when I <code>file</code> is the return value of an <code>os.Open(...</code> of a local file, but it hit's the <code>err</code> block when I send <code>CreateThumbnail</code> the same variable I sent to <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/s3/s3manager/upload.go#L184\" rel=\"nofollow\"><code>s3</code></a>, which asks for an <code>io.Reader</code></p>\n\n<pre><code>import (\n  \"image\"\n  \"image/jpeg\"\n)\nfunc UploadToS3(file multipart.File, /*snip*/) {\n  _, uploadErr := uploader.Upload(&amp;s3manager.UploadInput{\n    Bucket: aws.String(bucket),\n    Key:    aws.String(key),\n    Body:   file,\n    ContentType: aws.String(mimeType),\n    ACL: aws.String(\"public-read\"),\n  })\n  reader, err := CreateThumbnail(file)\n}    \n\nfunc CreateThumbnail(imageFile io.Reader) (io.Reader, error) {\n  decodedImage, _, err := image.Decode(imageFile)\n  if err != nil {\n   fmt.Println(\"Error decoding\", err, decodedImage) // \"unknown format\"\n   return nil, err\n }\n /*snip*/\n</code></pre>\n\n<p>Most of the answers I see for the problem involve adding <code>import _ \"image/jpeg\"</code>, but that's already imported (as well as <code>png</code> and <code>gif</code>).\nI'm fairly new to Golang, so I'm a bit lost as to what I'm doing wrong. I tried <code>image.Decode(bufio.NewReader(imageFile))</code> as well, but that results in the same <code>err</code>.</p>\n"}, {"tags": ["json", "parsing", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1434555557, "post_id": 30896040, "comment_id": 49831455, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/14441149/unmarshal-json-error-even-a-matching-data-structure-is-provided\">Unmarshal json error even a matching data structure is provided</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 0, "creation_date": 1434556898, "post_id": 30896163, "comment_id": 49832429, "body": "I am not quite sure why JSON parsing is so much more complicated in Go when compared with PHP and Node but I imagine there is a reason somewhere."}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "reply_to_user": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 2, "creation_date": 1434557064, "post_id": 30896163, "comment_id": 49832544, "body": "For starters, Go is a compiled language with static typing, as opposed to PHP and Javascript. On the other hand, try to do the same in C, and then you&#39;ll find that Go isn&#39;t that hard after all :)"}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": true, "score": 2, "last_activity_date": 1434555409, "creation_date": 1434555409, "answer_id": 30896163, "question_id": 30896040, "link": "https://stackoverflow.com/questions/30896040/golang-using-iterating-through-json-parsed-map/30896163#30896163", "title": "Golang - using/iterating through JSON parsed map", "body": "<p>In Go, unmarshaling works only if a struct has <strong>exported</strong> fields, ie. fields that begin with a capital letter.</p>\n\n<p>Change your first structure to:</p>\n\n<pre><code>type fileData struct{\n    Tn string\n    Size int\n}\n</code></pre>\n\n<p>See <a href=\"http://play.golang.org/p/qO3U7ZNrNs\" rel=\"nofollow\">http://play.golang.org/p/qO3U7ZNrNs</a> for a fixed example.</p>\n\n<p>Moreover, if you intend to marshal this struct back to JSON, you'll notice that the resulting JSON use capitalized fields, which is not what you want.</p>\n\n<p>You need to add field tags:</p>\n\n<pre><code>type fileData struct{\n    Tn   string `json:\"tn\"`\n    Size int    `json:\"size\"`\n}\n</code></pre>\n\n<p>so the Marshal function will use the correct names.</p>\n"}], "owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 30896163, "answer_count": 1, "score": 0, "last_activity_date": 1434555409, "creation_date": 1434555106, "question_id": 30896040, "link": "https://stackoverflow.com/questions/30896040/golang-using-iterating-through-json-parsed-map", "title": "Golang - using/iterating through JSON parsed map", "body": "<p>With PHP and Javascript (and Node) parsing JSON is a very trivial operation.  From the looks of it Go is rather more complicated.  Consider the example below</p>\n\n<pre><code>package main\n\nimport (\"encoding/json\";\"fmt\")\n\ntype fileData struct{\n tn string\n size int\n}\n\ntype jMapA map[string] string\ntype jMapB map[string] fileData\n\nfunc parseMapA(){\n var dat jMapA\n s := `{\"lang\":\"Node\",\"compiled\":\"N\",\"fast\":\"maybe\"}`\n if err := json.Unmarshal([]byte(s), &amp;dat); err != nil {\n  panic(err)\n }\n\n fmt.Println(dat);\n for k,v := range dat{\n  fmt.Println(k,v)\n }\n}\n\nfunc parseMapB(){\n var dat jMapB\n s := `{\"f1\":{\"tn\":\"F1\",\"size\":1024},\"f2\":{\"tn\":\"F2\",\"size\":2048}}`\n if err := json.Unmarshal([]byte(s), &amp;dat); err != nil {\n  panic(err)\n }\n\n fmt.Println(dat);\n for k,v := range dat{\n  fmt.Println(k,v)\n }\n}\n\nfunc main() {\n parseMapA()\n parseMapB()    \n}\n</code></pre>\n\n<p>The <code>parseMapA()</code> call obligingly returns</p>\n\n<pre><code>map[lang:Node Compiled:N fast:maybe]\nlang Node\ncompiled N\nfast maybe\n</code></pre>\n\n<p>However, <code>parseMapB()</code> returns</p>\n\n<pre><code>map[f1:{ 0}, f2:{ 0}]\nf2 { 0}\nf1 { 0}\n</code></pre>\n\n<p>I am into my first few hours with Go so I imagine I am doing something wrong here.  However, I have no idea what that might be.  I'd much appreciate any help.  More generally, what would the Go equivalent of the Node code</p>\n\n<pre><code>for(p in obj){\n doSomethingWith(obj[p]);\n</code></pre>\n\n<p>}</p>\n\n<p>be in Go?</p>\n"}, {"tags": ["mongodb", "go", "bson", "mgo"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1434588717, "post_id": 30895854, "comment_id": 49848050, "body": "your getter and setter not  symmetrical. is GetBSON returns a []byte, SetBSON need unmarshal a []byte type, and do a unmarshal again to convert []byte to struct."}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "edited": false, "score": 0, "creation_date": 1434615810, "post_id": 30897080, "comment_id": 49857818, "body": "Muchas gracias :) I got rid of the bson.Marshal around the return struct and it instantly worked."}, {"owner": {"reputation": 1640, "user_id": 5531595, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/455940914617164/picture?type=large", "display_name": "Rohman HM", "link": "https://stackoverflow.com/users/5531595/rohman-hm"}, "edited": false, "score": 0, "creation_date": 1589880496, "post_id": 30897080, "comment_id": 109461479, "body": "Hi, How can I achieve the same thing using this driver? go.mongodb.org/mongo-driver/mongo"}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 4, "last_activity_date": 1434557887, "creation_date": 1434557887, "answer_id": 30897080, "question_id": 30895854, "link": "https://stackoverflow.com/questions/30895854/why-wont-mgo-unmarshall-my-struct-properly/30897080#30897080", "title": "Why won&#39;t mgo unmarshall my struct properly?", "body": "<p>The <a href=\"http://gopkg.in/mgo.v2/bson#Getter\" rel=\"nofollow\">GetBSON</a> method should return the value to be marshaled, not the binary data resulting from marshaling it. That's why its first result type is <code>interface{}</code> and not <code>[]byte</code>.</p>\n"}], "owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "accepted_answer_id": 30897080, "answer_count": 1, "score": 1, "last_activity_date": 1434557887, "creation_date": 1434554615, "last_edit_date": 1495539822, "question_id": 30895854, "link": "https://stackoverflow.com/questions/30895854/why-wont-mgo-unmarshall-my-struct-properly", "title": "Why won&#39;t mgo unmarshall my struct properly?", "body": "<p>Earlier I posted <a href=\"https://stackoverflow.com/questions/30891301/handling-custom-bson-marshaling-golang-mgo/30892447\">this question</a> asking about writing custom BSON marshalling/unmarshalling in Go using mgo. Now I've come to test it I think I've hit on a bigger problem. All my structs unmarshal to nil values.</p>\n\n<p>This is my currency struct with the implementations of bson.Getter and bson.Setter:</p>\n\n<pre><code>type Currency struct {\n    value        decimal.Decimal //The actual value of the currency.\n    currencyCode string          //The ISO currency code.\n}\n\n/*\nGetBSON implements bson.Getter.\n*/\nfunc (c Currency) GetBSON() (interface{}, error) {\n    f, _ := c.Value().Float64()\n    return bson.Marshal(struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    }{\n        Value:        f,\n        CurrencyCode: c.currencyCode,\n    })\n}\n\n/*\nSetBSON implements bson.Setter.\n*/\nfunc (c *Currency) SetBSON(raw bson.Raw) error {\n    decoded := new(struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    })\n\n    fmt.Println(string(raw.Data))\n    bsonErr := raw.Unmarshal(decoded)\n\n    if bsonErr == nil {\n        fmt.Println(\"Debug: no error returned.\")\n        fmt.Println(decoded)\n        c.value = decimal.NewFromFloat(decoded.Value)\n        c.currencyCode = decoded.CurrencyCode\n        return nil\n    } else {\n        return bsonErr\n    }\n}\n</code></pre>\n\n<p>By looking at the raw data, it marshals correctly, but when unmarshaling the resulting struct is just empty. Any ideas where I'm going wrong here? I used the <code>go get gopkg.in/mgo.v2</code>command literally yesterday so I would hope it was up to date and a bug like this wouldn't be present in \"the hottest MongoDB driver around\".</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434549600, "post_id": 30893740, "comment_id": 49826861, "body": "got it :)  <code>type OrgResult struct { \tXMLName  xml.Name    `xml:&quot;result&quot;` \tEntities OrgEntities `xml:&quot;entities&quot;` } type OrgEntities struct { \tOrg []OrgEntity `xml:&quot;entity&quot;` } type OrgEntity struct { \tID   int    `xml:&quot;id,attr&quot;` \tName string `xml:&quot;name,attr&quot;` \tType string `xml:&quot;type,attr&quot;` }</code>"}, {"owner": {"reputation": 3966, "user_id": 469072, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/13ce453eb105a974aea64b2461cfc200?s=128&d=identicon&r=PG", "display_name": "joel goldstick", "link": "https://stackoverflow.com/users/469072/joel-goldstick"}, "edited": false, "score": 2, "creation_date": 1434549670, "post_id": 30893740, "comment_id": 49826914, "body": "You should put your comment in an answer since its code and it solved your problem"}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "reply_to_user": {"reputation": 3966, "user_id": 469072, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/13ce453eb105a974aea64b2461cfc200?s=128&d=identicon&r=PG", "display_name": "joel goldstick", "link": "https://stackoverflow.com/users/469072/joel-goldstick"}, "edited": false, "score": 0, "creation_date": 1434637619, "post_id": 30893740, "comment_id": 49873587, "body": "@joelgoldstick thx for the heads up"}], "answers": [{"tags": [], "owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "is_accepted": false, "score": 0, "last_activity_date": 1434637588, "creation_date": 1434637588, "answer_id": 30918151, "question_id": 30893740, "link": "https://stackoverflow.com/questions/30893740/trouble-creating-struct-for-xml/30918151#30918151", "title": "Trouble creating struct for xml", "body": "<p>got it :) </p>\n\n<pre><code>type OrgResult struct { \n    XMLName xml.Name `xml:\"result\"` \n    Entities OrgEntities `xml:\"entities\"` \n} \ntype OrgEntities struct { \n    Org []OrgEntity `xml:\"entity\"` \n} \ntype OrgEntity struct { \n    ID int `xml:\"id,attr\"` \n    Name string `xml:\"name,attr\"` \n    Type string `xml:\"type,attr\"` \n}\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434637588, "creation_date": 1434549338, "question_id": 30893740, "link": "https://stackoverflow.com/questions/30893740/trouble-creating-struct-for-xml", "title": "Trouble creating struct for xml", "body": "<p>Go Newb here... I know there is an issue with my struct but cant seem to get it working.... any advice much appreciated!</p>\n\n<pre><code>&lt;?xml version='1.0' ?&gt;\n&lt;result called_on=\"2015-06-17 12:49:41.014435+00\"&gt;\n  &lt;entities count=\"0\" start=\"0\"&gt;\n    &lt;entity name=\"Aaron Test\" id=\"12345\" type=\"organization\" /&gt;\n    &lt;entity name=\"MagicOne\" id=\"102301\" type=\"organization\" /&gt;\n  &lt;/entities&gt;\n  &lt;status code=\"ok\" /&gt;\n&lt;/result&gt;\n\n\ntype OrgResult struct {\n    XMLName  xml.Name    `xml:\"result\"`\n    Entities OrgEntities `xml:\"entity\"`\n}\ntype OrgEntities struct {\n    Org OrgEntity `xml:\"entity\"`\n}\ntype OrgEntity struct {\n    ID   int    `xml:\"id,attr\"`\n    Name string `xml:\"name,attr\"`\n    Type string `xml:\"type,attr\"`\n}\n\nOrgResult := OrgResult{}\nxml.Unmarshal(body, &amp;OrgResult)\nfmt.Println(body)\nfmt.Println(OrgResult)\n</code></pre>\n"}, {"tags": ["html", "go"], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1485800314, "last_edit_date": 1485800314, "creation_date": 1434549751, "answer_id": 30893881, "question_id": 30893604, "link": "https://stackoverflow.com/questions/30893604/how-do-i-get-the-submit-value-from-the-request-object/30893881#30893881", "title": "How do I get the submit value from the request object", "body": "<p>Give your buttons a <code>name</code> attribute and then you can differentiate between them.</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;form action=\"/save\" method=\"POST\"&gt;\n&lt;div&gt;&lt;span&gt;Title: &lt;/span&gt;&lt;textarea name=\"title\" placeholder=\"Link\"&gt;{{printf \"%s\" .Title}}&lt;/textarea&gt;&lt;/div&gt;\n&lt;div&gt;\n    &lt;button type=\"submit\" value=\"submit1\" name=\"submit\"&gt;1&lt;/button&gt;\n    &lt;button type=\"submit\" value=\"submit2\" name=\"submit\"&gt;2&lt;/button&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Go:</p>\n\n<pre><code>submit := r.FormValue(\"submit\")  // will be \"submit1\" or \"submit2\"\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5019949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e27734e3fab6bca8176ca39aadfcdd35?s=128&d=identicon&r=PG&f=1", "display_name": "klrk", "link": "https://stackoverflow.com/users/5019949/klrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1408, "favorite_count": 2, "accepted_answer_id": 30893881, "answer_count": 1, "score": 3, "last_activity_date": 1485800314, "creation_date": 1434548991, "last_edit_date": 1434549984, "question_id": 30893604, "link": "https://stackoverflow.com/questions/30893604/how-do-i-get-the-submit-value-from-the-request-object", "title": "How do I get the submit value from the request object", "body": "<p>I am trying to make a form POST request with two different submit buttons. I would like to try and get the submit button value in go. How do I go about getting this from the http.Request object.</p>\n\n<p>HTML Code:</p>\n\n<pre><code>&lt;form action=\"/save\" method=\"POST\"&gt;\n&lt;div&gt;&lt;span&gt;Title: &lt;/span&gt;&lt;textarea name=\"title\" placeholder=\"Link\"&gt;{{printf \"%s\" .Title}}&lt;/textarea&gt;&lt;/div&gt;\n&lt;div&gt;\n    &lt;button type=\"submit\" value=\"submit1\"&gt;1&lt;/button&gt;\n    &lt;button type=\"submit\" value=\"submit2\"&gt;2&lt;/button&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>GO Code:</p>\n\n<pre><code>func saveHandler(w http.ResponseWriter, r *http.Request) {\n... How do I get the submit value\ntitle := r.FormValue(\"title\")\nfmt.Println(title)\n}\nfunc main() {\n    http.HandleFunc(\"/\", viewHandler)\n    http.HandleFunc(\"/save\", saveHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Or do I need to do some Ajax trick where i have a hidden field and set it in ajax before the submit?</p>\n"}, {"tags": ["json", "mongodb", "go", "bson"], "comments": [{"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1434555915, "post_id": 30891301, "comment_id": 49831733, "body": "I suppose the fact that the Currency struct is declared using unexported fields is a typo ?"}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "reply_to_user": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 1, "creation_date": 1434556496, "post_id": 30891301, "comment_id": 49832117, "body": "Nope, it&#39;s deliberate. There is more code than what&#39;s above and I&#39;m a big proponent of using getters/setters to stop the programmer being able to just change what they want without regard for immutable business logic, plus the layer of abstraction means any change later down the line to the internal workings of my struct means I have to change a minimal amount of code."}, {"owner": {"reputation": 544, "user_id": 2469559, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7DCjy.jpg?s=128&g=1", "display_name": "Benjamin R", "link": "https://stackoverflow.com/users/2469559/benjamin-r"}, "edited": false, "score": 0, "creation_date": 1470955164, "post_id": 30891301, "comment_id": 65172817, "body": "And also, if you are a user of the <code>shopspring&#47;decimal</code> package, the fields aren&#39;t exported \u2013 so in either case, you would still have to define a custom Getter/Setter to enable serialisation/deserialisation as shown in the answer."}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "edited": false, "score": 2, "creation_date": 1434547486, "post_id": 30892447, "comment_id": 49825114, "body": "That&#39;s exactly what I was looking for! It&#39;s kind of annoying that they&#39;ve not named it in a similar fashion to the JSON one, but what can you do."}, {"owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "edited": false, "score": 2, "creation_date": 1434615918, "post_id": 30892447, "comment_id": 49857882, "body": "The only change needed to make this a perfect solution is to remove the bson.Marshal statement around the return struct in the get method as described by <a href=\"http://stackoverflow.com/questions/30895854/why-wont-mgo-unmarshall-my-struct-properly/30897080#30897080\">this answer</a>"}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "edited": false, "score": 0, "creation_date": 1434628765, "post_id": 30892447, "comment_id": 49866604, "body": "@Adam : Indeed, thanks. Edited my answer to reflect it"}, {"owner": {"reputation": 1640, "user_id": 5531595, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/455940914617164/picture?type=large", "display_name": "Rohman HM", "link": "https://stackoverflow.com/users/5531595/rohman-hm"}, "edited": false, "score": 1, "creation_date": 1589880426, "post_id": 30892447, "comment_id": 109461456, "body": "Hi currently I&#39;m using this driver go.mongodb.org/mongo-driver/mongo How can I achieve the same thing as you had."}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 21, "last_activity_date": 1534855581, "last_edit_date": 1534855581, "creation_date": 1434546193, "answer_id": 30892447, "question_id": 30891301, "link": "https://stackoverflow.com/questions/30891301/handling-custom-bson-marshaling/30892447#30892447", "title": "Handling Custom BSON Marshaling", "body": "<p>Custom bson Marshalling/Unmarshalling works nearly the same way, you have to implement the <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Getter\" rel=\"nofollow noreferrer\">Getter</a> and <a href=\"https://godoc.org/labix.org/v2/mgo/bson#Setter\" rel=\"nofollow noreferrer\">Setter</a> interfaces respectively</p>\n\n<p>Something like this should work :</p>\n\n<pre><code>type Currency struct {\n    value        decimal.Decimal //The actual value of the currency.\n    currencyCode string          //The ISO currency code.\n}\n\n// GetBSON implements bson.Getter.\nfunc (c Currency) GetBSON() (interface{}, error) {\n    f := c.Value().Float64()\n    return struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    }{\n        Value:        f,\n        CurrencyCode: c.currencyCode,\n    }, nil\n}\n\n// SetBSON implements bson.Setter.\nfunc (c *Currency) SetBSON(raw bson.Raw) error {\n\n    decoded := new(struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    })\n\n    bsonErr := raw.Unmarshal(decoded)\n\n    if bsonErr == nil {\n        c.value = decimal.NewFromFloat(decoded.Value)\n        c.currencyCode = decoded.CurrencyCode\n        return nil\n    } else {\n        return bsonErr\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 448, "user_id": 4742941, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/03597e35f96065ea034b3baaeb27f908?s=128&d=identicon&r=PG&f=1", "display_name": "leylandski", "link": "https://stackoverflow.com/users/4742941/leylandski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12745, "favorite_count": 4, "accepted_answer_id": 30892447, "answer_count": 1, "score": 13, "last_activity_date": 1546026278, "creation_date": 1434543251, "last_edit_date": 1546026278, "question_id": 30891301, "link": "https://stackoverflow.com/questions/30891301/handling-custom-bson-marshaling", "title": "Handling Custom BSON Marshaling", "body": "<p>I have a number of structs that require custom marshalling. When I was testing I was using JSON and the standard JSON marshaller. As it doesn't marshal unexported fields, I needed to write a custom MarshalJSON function, which worked perfectly. When I called json.Marshal on the parent struct containing the ones that needed custom marshalling as fields, it worked fine.</p>\n\n<p>Now I need to marshal everything to BSON for some MongoDB work, and I can't find any documentation about how to write custom BSON marshalling. Can anyone tell me how to do the equivalent for BSON/mgo for what I've demonstrated below?</p>\n\n<p><strong>currency.go</strong> (the important parts)</p>\n\n<pre><code>type Currency struct {\n    value        decimal.Decimal //The actual value of the currency.\n    currencyCode string          //The ISO currency code.\n}\n\n/*\nMarshalJSON implements json.Marshaller.\n*/\nfunc (c Currency) MarshalJSON() ([]byte, error) {\n    f, _ := c.Value().Float64()\n    return json.Marshal(struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    }{\n        Value:        f,\n        CurrencyCode: c.CurrencyCode(),\n    })\n}\n\n/*\nUnmarshalJSON implements json.Unmarshaller.\n*/\nfunc (c *Currency) UnmarshalJSON(b []byte) error {\n\n    decoded := new(struct {\n        Value        float64 `json:\"value\" bson:\"value\"`\n        CurrencyCode string  `json:\"currencyCode\" bson:\"currencyCode\"`\n    })\n\n    jsonErr := json.Unmarshal(b, decoded)\n\n    if jsonErr == nil {\n        c.value = decimal.NewFromFloat(decoded.Value)\n        c.currencyCode = decoded.CurrencyCode\n        return nil\n    } else {\n        return jsonErr\n    }\n}\n</code></pre>\n\n<p><strong>product.go</strong> (again, just the relevant parts)</p>\n\n<pre><code>type Product struct {\n    Name  string\n    Code  string\n    Price currency.Currency\n}\n</code></pre>\n\n<p>When I call json.Marshal(p) where p is a Product, it produces the output I want without the need for the pattern (not sure of the name) where you create a struct which is just a clone with all exported fields.</p>\n\n<p>In my opinion using the inline method I've used greatly simplifies the API and stops you having extra structs that clutter things up.</p>\n"}, {"tags": ["go", "exception-handling", "maps", "associative-array"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434545152, "post_id": 30890591, "comment_id": 49823178, "body": "The lumberjack package might help simplify file-based logging (i.e. file rotation, max size, etc) if you need something more serious: <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">github.com/natefinch/lumberjack</a>"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 1, "creation_date": 1434543568, "post_id": 30891188, "comment_id": 49821949, "body": "@DroidOS In Go functions can have multiple return values, so in Go you propagate error by returning an <code>error</code> value, even if the function normally has other return value(s). Editing the anwser to show it."}, {"owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "edited": false, "score": 4, "creation_date": 1434545609, "post_id": 30891188, "comment_id": 49823547, "body": "Wow!  Now that is what I call a 5* answer.  It&#39;s like I attended a Go master class run by an expert.  Thank you again!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1434546471, "last_edit_date": 1434546471, "creation_date": 1434542929, "answer_id": 30891188, "question_id": 30890591, "link": "https://stackoverflow.com/questions/30890591/writing-good-golang-code/30891188#30891188", "title": "Writing good Golang code", "body": "<h3>Logging to file</h3>\n\n<p>I wouldn't open and close the file each time I want to log something. At startup I would just open it once and set it as output, and before the program exists, close it. And I wouldn't use a <code>logIt()</code> function: just log using the functions of the <a href=\"https://golang.org/pkg/log/\" rel=\"noreferrer\"><code>log</code></a> package, so you can do formatted logging e.g. with <a href=\"https://golang.org/pkg/log/#Printf\" rel=\"noreferrer\"><code>log.Printf()</code></a> etc.</p>\n\n<h3>Dynamic function choosing</h3>\n\n<p>A function map is completely OK, and does well performance-wise. If you need something faster, you can do a <code>switch</code> based on the function name, and call directly the target function in the <code>case</code> branches.</p>\n\n<h3>Checking the existence of the key</h3>\n\n<p>The values in the <code>map</code> are function values. The zero value of a function type is <code>nil</code> and you can't call a <code>nil</code> function, so you have to check the value before proceeding to call it. Note that if you index a map with a non-existing key, the zero-value of the value type is returned which is <code>nil</code> in case of function type. So we can simply check if the value is <code>nil</code>. There is also another comma-ok idiom, e.g. <code>fv, ok := funcs[name]</code> where <code>ok</code> will be a boolean value telling if the key was found in the map.</p>\n\n<p>You can do it in one place though, you don't have to duplicate it in each call:</p>\n\n<pre><code>func call(name, iam string) {\n    if fv := funcs[name]; fv != nil {\n        fv(iam)\n    }\n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>If you would choose to use a <code>switch</code>, the <code>default</code> branch would handle the invalid function name (and here you would not need the function map of course):</p>\n\n<pre><code>func call(name, iam string) error {\n    switch name {\n    case \"A\":\n        a(iam)\n    case \"B\":\n        b(iam)\n    case \"C\":\n        c(iam)\n    default:\n        return errors.New(\"Unknown function: \" + name)\n    }\n    return nil\n}\n</code></pre>\n\n<h3>Error handling / reporting</h3>\n\n<p>In Go functions can have multiple return values, so in Go you propagate error by returning an <a href=\"https://golang.org/pkg/builtin/#error\" rel=\"noreferrer\"><code>error</code></a> value, even if the function normally has other return value(s).</p>\n\n<p>So the <code>call()</code> function should have an <code>error</code> return type to signal if the specified function cannot be found.</p>\n\n<p>You may choose to return a new <code>error</code> value created by e.g. the <a href=\"https://golang.org/pkg/errors/#New\" rel=\"noreferrer\"><code>errors.New()</code></a> function (so it can be dynamic) or you may choose to create a global variable and have a fixed error value like:</p>\n\n<pre><code>var ErrInvalidFunc = errors.New(\"Invalid function!\")\n</code></pre>\n\n<p>The pros of this solution is that callers of the <code>call()</code> function can compare the returned <code>error</code> value to the value of the <code>ErrInvalidFunc</code> global variable to know that this is the case and act accordingly, e.g.:</p>\n\n<pre><code>if err := call(\"foo\", \"bar\"); err != nil {\n    if err == ErrInvalidFunc {\n        // \"foo\" is an invalid function name\n    } else {\n        // Some other error\n    }\n}\n</code></pre>\n\n<h3>So the complete revised program:</h3>\n\n<p><sup>(Slightly compacted to avoid vertical scroll bars.)</sup></p>\n\n<pre><code>package main\n\nimport (\"errors\"; \"log\"; \"os\")\n\ntype iAm func(string)\n\nfunc a(iam string) { log.Println(iam + \" A\") }\nfunc b(iam string) { log.Println(iam + \" B\") }\nfunc c(iam string) { log.Println(iam + \" C\") }\n\nvar funcs = map[string]iAm{\"A\": a, \"B\": b, \"C\": c}\n\nfunc main() {\n    f, err := os.OpenFile(\"errors.log\", os.O_RDWR|os.O_CREATE|os.O_APPEND, 0666)\n    if err != nil {\n        panic(err)\n    }\n    defer f.Close()\n    log.SetOutput(f)\n\n    call(\"A\", \"Je suis\")\n    call(\"B\", \"Ich bin\")\n    call(\"C\", \"Yo soy\")\n    call(\"D\", \"Soy Yo\")\n}\n\nfunc call(name, iam string) error {\n    if fv := funcs[name]; fv == nil {\n        return errors.New(\"Unknown funcion: \" + name)\n    } else {\n        fv(iam)\n        return nil\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 7178, "user_id": 1077485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a408c0c11875e9e3f3432c5ddc9fcddd?s=128&d=identicon&r=PG", "display_name": "DroidOS", "link": "https://stackoverflow.com/users/1077485/droidos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "accepted_answer_id": 30891188, "answer_count": 1, "score": 2, "last_activity_date": 1434546471, "creation_date": 1434541353, "last_edit_date": 1434541454, "question_id": 30890591, "link": "https://stackoverflow.com/questions/30890591/writing-good-golang-code", "title": "Writing good Golang code", "body": "<p>I am in the process of getting to grips with the Golang way of doing things.  I'd be much obliged to anyone who might be able to help with the following. First some sample code</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nfunc logIt(s string) {\n    f, _ := os.OpenFile(\"errors.log\", os.O_RDWR|os.O_CREATE|os.O_APPEND,\n        0666)\n    defer f.Close()\n\n    log.SetOutput(f)\n    log.Println(s)\n}\n\ntype iAm func(string)\n\nfunc a(iam string) { logIt(iam + \" A\") }\n\nfunc b(iam string) { logIt(iam + \" B\") }\n\nfunc c(iam string) { logIt(iam + \" C\") }\n\nvar funcs = map[string]iAm{\"A\": a, \"B\": b, \"C\": c}\n\nfunc main() {\n    funcs[\"A\"](\"Je suis\")\n    funcs[\"B\"](\"Ich bin\")\n    funcs[\"A\"](\"Yo soy\")\n    funcs[\"D\"](\"Soy Yo\")\n}\n</code></pre>\n\n<p><strong>Explanations</strong></p>\n\n<ul>\n<li>I am channeling all my log out put to a file so I can monitor it later.  Is this the right way to channel?</li>\n<li>I want to identify the right function to call at run time based on user inputs. To that end I have packed the functions as a Golang map - In PHP I would have used an associative array.  This works.  However, is this an efficient way to do things.</li>\n<li>Finally, you will note that I don't actually have a <strong>D</strong> key in my map. That last funcs call causes Go to throw a wobbly.  In another language I would have wrapped those calls in a try... block and avoided the problem. From what I have understood the Go philosophy is to check the validity of the key <em>first</em> and panic rather than trying to blindly use that key.  Is that correct?</li>\n</ul>\n\n<p>I am a Go newbie so I probably have baggage from the other languages I use.  To my mind dealing with exceptional conditions in a pre-emptive way (check the key prior to using it) is neither smart nor efficient.  Right?</p>\n"}, {"tags": ["go", "gorp"], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 1, "creation_date": 1434554561, "post_id": 30894739, "comment_id": 49830724, "body": "Thanks, but I&#39;d already got that info. There is more too - the gorp_test.go file has an example usage. It still hasn&#39;t given me sufficient info to produce my own working case yet though."}, {"owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "reply_to_user": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1434564163, "post_id": 30894739, "comment_id": 49837081, "body": "Sorry, I read your question too fast. I updated my answer with some working code"}], "tags": [], "owner": {"reputation": 4457, "user_id": 1685538, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/ebbb7b5247615b8e0984e149bd86fc16?s=128&d=identicon&r=PG", "display_name": "HectorJ", "link": "https://stackoverflow.com/users/1685538/hectorj"}, "is_accepted": true, "score": 2, "last_activity_date": 1434595273, "last_edit_date": 1434595273, "creation_date": 1434551772, "answer_id": 30894739, "question_id": 30890315, "link": "https://stackoverflow.com/questions/30890315/how-do-i-use-a-typeconverter-in-gorp/30894739#30894739", "title": "How do I use a TypeConverter in Gorp?", "body": "<p><a href=\"https://golang.org/pkg/database/sql/driver/#Valuer\" rel=\"nofollow\">Valuer</a> and <a href=\"https://golang.org/pkg/database/sql/#Scanner\" rel=\"nofollow\">Scanner</a> interfaces will do what you want. Here is a working example :</p>\n\n<pre><code>package roleGorp\n\nimport (\n    \"gopkg.in/gorp.v1\"\n    \"github.com/DATA-DOG/go-sqlmock\"\n    \"fmt\"\n    \"testing\"\n    \"database/sql/driver\"\n)\n\ntype Role string\n\nfunc (r *Role) Scan(value interface{}) error { *r = Role(value.(string)); return nil }\nfunc (r Role) Value() (driver.Value, error)  { return string(r), nil }\n\ntype Account struct {\n    User string `db:\"user\"`\n    Role Role `db:\"role\"`\n}\n\nfunc TestRoleGorp(t *testing.T) {\n    db, err := sqlmock.New()\n    if err != nil {\n        panic(err)\n    }\n    dbMap := gorp.DbMap{\n        Db: db,\n        Dialect: gorp.MySQLDialect{\n            Engine: \"InnoDB\",\n        },\n    }\n\n    rows := sqlmock.NewRows([]string{\"user\", \"role\"}).AddRow(\"user1\", \"admin\")\n\n    sqlmock.ExpectQuery(`SELECT \\* FROM account LIMIT 1`).WillReturnRows(rows)\n\n    dbMap.AddTableWithName(Account{}, \"account\")\n\n    result := &amp;Account{}\n    err = dbMap.SelectOne(result, \"SELECT * FROM account LIMIT 1\")\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Printf(\"%+v\\n\", *result)\n\n    result2 := &amp;Account{\n        User: \"user2\",\n        Role: Role(\"moderator\"),\n    }\n\n    sqlmock.ExpectExec(\"insert into `account` \\\\(`user`,`role`\\\\) values \\\\(\\\\?,\\\\?\\\\);\").WithArgs(\"user2\", \"moderator\").WillReturnResult(sqlmock.NewResult(1, 1))\n\n    err = dbMap.Insert(result2)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "accepted_answer_id": 30894739, "answer_count": 1, "score": 1, "last_activity_date": 1434595273, "creation_date": 1434540687, "question_id": 30890315, "link": "https://stackoverflow.com/questions/30890315/how-do-i-use-a-typeconverter-in-gorp", "title": "How do I use a TypeConverter in Gorp?", "body": "<p>I would like to use Gorp to load and save structs from the DB that contain specialised types. Amongst other things, this is useful for enumerated strings such as roles:</p>\n\n<pre><code>type Role string\n\ntype Account struct {\n    User string\n    Role Role\n}\n</code></pre>\n\n<p>This doesn't work \"out of the box\". An error message is raised such as</p>\n\n<pre><code>panic: sql: converting Exec argument #0's type: unsupported type user.Role, a string\n</code></pre>\n\n<p>I suspect I need to use a <code>gorp.TypeConverter</code> to solve this, but there is no documentation on how to do this.</p>\n\n<p>Can you help?</p>\n"}, {"tags": ["go", "compiler-errors", "cross-compiling"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 1, "creation_date": 1434535852, "post_id": 30888062, "comment_id": 49816665, "body": "Soon (August 2015, Go 1.5), this will be <i>so much</i> easier: <a href=\"http://talks.golang.org/2015/gogo.slide#18\" rel=\"nofollow noreferrer\">talks.golang.org/2015/gogo.slide#18</a>"}, {"owner": {"reputation": 2211, "user_id": 2866570, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7328ed4169cb39f8d33bb430c4d12391?s=128&d=identicon&r=PG", "display_name": "zaynetro", "link": "https://stackoverflow.com/users/2866570/zaynetro"}, "edited": false, "score": 0, "creation_date": 1434536479, "post_id": 30888062, "comment_id": 49817034, "body": "you can use <a href=\"https://github.com/mitchellh/gox\" rel=\"nofollow noreferrer\">gox</a> while Go 1.5 is not released, it fairly simple"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 1090021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3350f02e1695ba9ccf2b481fbb1ceaa?s=128&d=identicon&r=PG", "display_name": "Saji", "link": "https://stackoverflow.com/users/1090021/saji"}, "edited": false, "score": 0, "creation_date": 1434604676, "post_id": 30888971, "comment_id": 49851933, "body": "even the updated version ended up in the same compilation error. will try out gox as an alternative.,"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1434537123, "creation_date": 1434537123, "answer_id": 30888971, "question_id": 30888062, "link": "https://stackoverflow.com/questions/30888062/go-cross-compiler-fails/30888971#30888971", "title": "Go Cross compiler fails", "body": "<p>You say:</p>\n\n<blockquote>\n  <p>When followed this link to do cross compilation!</p>\n  \n  <p><a href=\"http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go\" rel=\"nofollow\">http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go</a></p>\n</blockquote>\n\n<p>The article clearly states that it is obsolete.</p>\n\n<blockquote>\n  <p>An introduction to cross compilation with Go</p>\n  \n  <p>Hello. Thanks for reading this article. Now that Go 1.1 has been\n  released an <a href=\"http://dave.cheney.net/2013/07/09/an-introduction-to-cross-compilation-with-go-1-1\" rel=\"nofollow\">updated\n  version</a>\n  of this article is available.</p>\n</blockquote>\n\n<p>Follow the instructions in the updated article.</p>\n"}], "owner": {"reputation": 103, "user_id": 1090021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3350f02e1695ba9ccf2b481fbb1ceaa?s=128&d=identicon&r=PG", "display_name": "Saji", "link": "https://stackoverflow.com/users/1090021/saji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1434537123, "creation_date": 1434534614, "question_id": 30888062, "link": "https://stackoverflow.com/questions/30888062/go-cross-compiler-fails", "title": "Go Cross compiler fails", "body": "<p>When followed this link to do cross compilation!</p>\n\n<p><a href=\"http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go\" rel=\"nofollow\">http://dave.cheney.net/2012/09/08/an-introduction-to-cross-compilation-with-go</a></p>\n\n<p><strong>Failing at : % go-crosscompile-build-all</strong></p>\n\n<p><strong>Getting Below error :</strong></p>\n\n<p><em># Building C bootstrap tool.\ncmd/dist\ngo tool dist: FAILED: git rev-parse --abbrev-ref HEAD\n./make.bash: eval: line 135: syntax error near unexpected token `('</em></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1434534310, "post_id": 30887528, "comment_id": 49815542, "body": "I admit I did not understand what you tried. Please show whole filesystem layout and (sample) content of the files and what you type on the command line in which folder. E.g. <code>go test</code> (no package name) works inside any package folder while running <code>go test full&#47;name&#47;of&#47;package</code> requires the full import name of the package not just the name of the package declaration."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434551525, "post_id": 30887528, "comment_id": 49828380, "body": "A package&#39;s tests are <i>for that package</i>; they do not magically run with anything that includes them. If you want to test package &quot;sender&quot; then you do <code>go test</code> in that package directory (or <code>go test whatever&#47;import&#47;path&#47;sender</code>) to test that package in isolation. When you test &quot;my_project&quot; presumably that should only be testing package main and the integration logic, not that dependant packages are functional. (As with all the go tools, there is the <code>some&#47;path&#47;...</code> short-cut to select all packages at and bellow <code>some&#47;path</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 5608, "user_id": 660828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2ab261718814b4842efac71a1b6cd1a5?s=128&d=identicon&r=PG", "display_name": "Tom Jowitt", "link": "https://stackoverflow.com/users/660828/tom-jowitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1434536220, "creation_date": 1434536220, "answer_id": 30888667, "question_id": 30887528, "link": "https://stackoverflow.com/questions/30887528/cannot-call-tests-inside-packages-other-than-main/30888667#30888667", "title": "Cannot call tests inside packages other than main", "body": "<p>Try this:</p>\n\n<pre><code>go test my_project/...\n</code></pre>\n\n<p>Or if you are within your project:</p>\n\n<pre><code>go test ./...\n</code></pre>\n"}], "owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 30888667, "answer_count": 1, "score": 0, "last_activity_date": 1434599170, "creation_date": 1434533274, "last_edit_date": 1434599170, "question_id": 30887528, "link": "https://stackoverflow.com/questions/30887528/cannot-call-tests-inside-packages-other-than-main", "title": "Cannot call tests inside packages other than main", "body": "<p>I am writing tests for my go code and inside sender folder, sender package I have added <code>exposed_api_test.go</code> ( also tried <code>exposed_api_test.go</code> because I have code in <code>exposed_api.go</code>)</p>\n\n<pre><code>package sender\n\nimport (\n    \"log\"\n    \"testing\"\n\n    \"github.com/stretchr/testify/assert\"\n)\n\nfunc TestTimeConsuming(t *testing.T) {\n\n   assert.Equal(t, \"test\", \"test1\")\n\n}\n</code></pre>\n\n<p>and when I run build and run command <code>go test my_project</code> I get <code>? my_project [no test files]</code>\nWhen I put test out of this package ( in <code>main</code> package same test but <code>package main</code> ) and execute same command I get that test from main executed.\nWhat is a problem and how to call tests inside other packages other than main ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1228, "user_id": 937681, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/olrCF.jpg?s=128&g=1", "display_name": "Jason G", "link": "https://stackoverflow.com/users/937681/jason-g"}, "edited": false, "score": 1, "creation_date": 1561473776, "post_id": 30885339, "comment_id": 100070874, "body": "this gives a cannot find package error for me.  go-contacts is main folder, apps in sub folder, in main.go &quot;go-contacts/app&quot;"}, {"owner": {"reputation": 7443, "user_id": 310662, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3ce57d6e4ca826a201cb5cf1e8595cdb?s=128&d=identicon&r=PG", "display_name": "holms", "link": "https://stackoverflow.com/users/310662/holms"}, "edited": false, "score": 0, "creation_date": 1582905491, "post_id": 30885339, "comment_id": 106949486, "body": "@icza I&#39;m not sure what yours URL path even means. I&#39;ve got package in mypkg/mypkg.go how can I import it in main.go?"}, {"owner": {"reputation": 700, "user_id": 869656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DbR3z.jpg?s=128&g=1", "display_name": "oopexpert", "link": "https://stackoverflow.com/users/869656/oopexpert"}, "edited": false, "score": 0, "creation_date": 1599911642, "post_id": 30885339, "comment_id": 112925523, "body": "Doesn&#39;t work for me. If I do so I get undefined: greetings."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 700, "user_id": 869656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DbR3z.jpg?s=128&g=1", "display_name": "oopexpert", "link": "https://stackoverflow.com/users/869656/oopexpert"}, "edited": false, "score": 0, "creation_date": 1599912261, "post_id": 30885339, "comment_id": 112925665, "body": "@oopexpert The package name is <code>greeting</code> not <code>greetings</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 700, "user_id": 869656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DbR3z.jpg?s=128&g=1", "display_name": "oopexpert", "link": "https://stackoverflow.com/users/869656/oopexpert"}, "edited": false, "score": 0, "creation_date": 1599916380, "post_id": 30885339, "comment_id": 112926700, "body": "@oopexpert Then post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> in a new question. I don&#39;t know what you have. You have to use go modules nowdays."}, {"owner": {"reputation": 700, "user_id": 869656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DbR3z.jpg?s=128&g=1", "display_name": "oopexpert", "link": "https://stackoverflow.com/users/869656/oopexpert"}, "edited": false, "score": 0, "creation_date": 1599918667, "post_id": 30885339, "comment_id": 112927285, "body": "I won&#39;t, as it would be a duplicate of this question. Nevertheless: I figured out what was going wrong... I will post an answer here soon..."}, {"owner": {"reputation": 4657, "user_id": 102699, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81df87e0d3e269d6fa6a17c6914fd656?s=128&d=identicon&r=PG", "display_name": "MikeSchinkel", "link": "https://stackoverflow.com/users/102699/mikeschinkel"}, "edited": false, "score": 0, "creation_date": 1615404715, "post_id": 30885339, "comment_id": 117683177, "body": "There is a time and a place to use local imports and that is prior to publishing to a Git repo when in early development.  Also when working for clients who have yet to create the Git repo you need, so you need to work from a local directory while waiting for them to create the repo."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 43, "last_activity_date": 1434527169, "creation_date": 1434527169, "answer_id": 30885339, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/30885339#30885339", "title": "Go: local import in non-local package", "body": "<p>You can't use local import when specifying a non-local package to <code>go install</code>. If you want the local import to work, first change working directory to <code>src/jacob.uk.com</code> then execute <code>go install</code> (without specifying the package).</p>\n\n<p>Of course having the <code>helloworld.go</code> you provided you will get an compile error: <code>imported and not used</code>. But once you use something from the imported <code>greeting</code> package, it should compile.</p>\n\n<p>But you shouldn't use local imports at all. Instead write:</p>\n\n<pre><code>import \"jacob.uk.com/greeting\"\n</code></pre>\n\n<p>And doing so you will be able to compile/run/install it from anywhere.</p>\n"}, {"tags": [], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "is_accepted": false, "score": 28, "last_activity_date": 1549528696, "last_edit_date": 1549528696, "creation_date": 1453118506, "answer_id": 34854318, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/34854318#34854318", "title": "Go: local import in non-local package", "body": "<p>Typing <code>go build</code> does not work with relative import paths; you must type <code>go build main.go</code>.</p>\n\n<p><code>go install</code> does not work at all with relative import paths.</p>\n\n<p>It is documented at <a href=\"https://golang.org/cmd/go/#hdr-Relative_import_paths\" rel=\"noreferrer\">https://golang.org/cmd/go/#hdr-Relative_import_paths</a></p>\n\n<p>See</p>\n\n<ul>\n<li><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/1XqcS8DuaNc/discussion\" rel=\"noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/1XqcS8DuaNc/discussion</a></li>\n<li><a href=\"https://github.com/golang/go/issues/12502\" rel=\"noreferrer\">https://github.com/golang/go/issues/12502</a></li>\n<li><a href=\"https://github.com/golang/go/issues/3515#issuecomment-66066361\" rel=\"noreferrer\">https://github.com/golang/go/issues/3515#issuecomment-66066361</a></li>\n</ul>\n\n<p>for explanation.</p>\n"}, {"comments": [{"owner": {"reputation": 37454, "user_id": 775184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NdE7X.jpg?s=128&g=1", "display_name": "bryanmac", "link": "https://stackoverflow.com/users/775184/bryanmac"}, "edited": false, "score": 0, "creation_date": 1525479203, "post_id": 48197351, "comment_id": 87386285, "body": "Nice.  Thanks - encouraged me to read about the vendor directory.  Even though I&#39;ll probably switch to a dep tool, doing this manually help me understand."}], "tags": [], "owner": {"reputation": 85, "user_id": 8871558, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FDGj3UJaFu4/AAAAAAAAAAI/AAAAAAAAAFo/dy3foyKUxvQ/photo.jpg?sz=128", "display_name": "nnnn20430", "link": "https://stackoverflow.com/users/8871558/nnnn20430"}, "is_accepted": false, "score": -1, "last_activity_date": 1515624526, "creation_date": 1515624526, "answer_id": 48197351, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/48197351#48197351", "title": "Go: local import in non-local package", "body": "<p>you can bypass this using the vendor feature<br>\nchange <code>import \"./greeting\"</code> to <code>import \"greeting\"</code><br>\ncreate the vendor directory <code>mkdir vendor</code> and create a symlink <code>ln -s ../greeting vendor/greeting</code></p>\n"}, {"tags": [], "owner": {"reputation": 2877, "user_id": 2624876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/192e08eb145965a0915f5ae9c21d5b38?s=128&d=identicon&r=PG", "display_name": "1j01", "link": "https://stackoverflow.com/users/2624876/1j01"}, "is_accepted": false, "score": -1, "last_activity_date": 1565376716, "creation_date": 1565376716, "answer_id": 57435708, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/57435708#57435708", "title": "Go: local import in non-local package", "body": "<p>If you just want to share code between separate files and not separate packages, here's how to do it:</p>\n\n<p>You don't need to <code>import</code>, you just have to put the source files in the same directory and specify the same <code>package</code> name at the top of each file, and then you can access all the public (Uppercase) functions and types, by referencing them directly, that is, <code>SomeFunction()</code> and not <code>somepackage.SomeFunction()</code></p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 981871, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c608f7ab1694dff34bb70a530cb9eb65?s=128&d=identicon&r=PG", "display_name": "PhilHalf", "link": "https://stackoverflow.com/users/981871/philhalf"}, "edited": false, "score": 0, "creation_date": 1604589622, "post_id": 63682229, "comment_id": 114398024, "body": "I&#39;m not sure why this answer was voted down as this exact solution has resolved the issue I was having (my packages aren&#39;t merged into the root branch in source control until I&#39;ve finished development on them). Can anybody advise if this is a &quot;bad&quot; way of dealing with this scenario?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1614333708, "post_id": 63682229, "comment_id": 117359407, "body": "the path argument of the replace directive does not require quoting. Tested on go1.16."}], "tags": [], "owner": {"reputation": 103, "user_id": 8284021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9af431e3adce2386f74032608b659969?s=128&d=identicon&r=PG&f=1", "display_name": "Linux", "link": "https://stackoverflow.com/users/8284021/linux"}, "is_accepted": false, "score": 5, "last_activity_date": 1598943998, "last_edit_date": 1598943998, "creation_date": 1598940326, "answer_id": 63682229, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/63682229#63682229", "title": "Go: local import in non-local package", "body": "<p>You can add the local packages using replace in go 1.11&lt;=\ngo to your go.mod and use &quot;replace&quot; keyword, as below, (you do not need to create a github repo, just add the lines like this)</p>\n<pre><code>module github.com/yourAccount/yourModule\n\ngo 1.15\n\nrequire (\n    github.com/cosmtrek/air v1.21.2 // indirect\n    github.com/creack/pty v1.1.11 // indirect\n    github.com/fatih/color v1.9.0 // indirect\n    github.com/imdario/mergo v0.3.11 // indirect\n    github.com/julienschmidt/httprouter v1.3.0\n    github.com/mattn/go-colorable v0.1.7 // indirect\n    github.com/pelletier/go-toml v1.8.0 // indirect\n    go.uber.org/zap v1.15.0\n    golang.org/x/sys v0.0.0-20200831180312-196b9ba8737a // indirect\n)\n\nreplace (\n    github.com/yourAccount/yourModule/localFolder =&gt;&quot;./yourModule/localFolder&quot;\n    github.com/yourAccount/yourModule/localFolder =&gt;&quot;./yourModule/localFolder&quot;\n)\n</code></pre>\n<p>Then in your main.go =&gt;</p>\n<pre><code>import (\n    alog &quot;github.com/yourAccount/yourModule/localFolder&quot;\n    slog &quot;github.com/yourAccount/yourModule/localFolder&quot;\n)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 869656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DbR3z.jpg?s=128&g=1", "display_name": "oopexpert", "link": "https://stackoverflow.com/users/869656/oopexpert"}, "is_accepted": false, "score": 0, "last_activity_date": 1599920760, "creation_date": 1599920760, "answer_id": 63861324, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package/63861324#63861324", "title": "Go: local import in non-local package", "body": "<p>There may several thing going wrong. I will provide following setup.</p>\n<h1>Check your GOPATH environment variable</h1>\n<p>The GOPATH variable defines your workspace. You can easily identify the current value if you type &quot;<code>go env</code>&quot;.</p>\n<p>If you install Go under Windows the GOPATH environment variable is set up automatically during installation process. Nevertheless: It could be that this default path is not your preferred choice. You may safely set this variable to a target directory to your wish.</p>\n<p>To change environment variables in Windows look here: <a href=\"https://www.architectryan.com/2018/08/31/how-to-change-environment-variables-on-windows-10/\" rel=\"nofollow noreferrer\">https://www.architectryan.com/2018/08/31/how-to-change-environment-variables-on-windows-10/</a></p>\n<h1>Check Workspace Layout</h1>\n<p>If you have decided where your workspace should reside and set up the GOPATH environemnt variable you should create three folders within the workspace:</p>\n<p>src, pkg, bin</p>\n<p>The folder &quot;src&quot; is the on where your source code reside. &quot;pkg&quot; includes external imports. &quot;bin&quot; contains the compiled sources.</p>\n<h1>Example Project</h1>\n<p>Layout within your workspace:</p>\n<pre><code>&lt;workspace directory&gt;\n--&gt; src\n    --&gt; oopexpertutil\n        --&gt; x.go\n    --&gt; y.go\n--&gt; pkg\n    --&gt; ...\n--&gt; bin\n    --&gt; ...\n</code></pre>\n<p>File &quot;x.go&quot;</p>\n<pre><code>package oopexpertutil\n\nfunc checkMe(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n</code></pre>\n<p>File &quot;y.go&quot;</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;oopexpertutil&quot;\n)\n\nfunc main() {\n\n    var data string = &quot;Hello World!&quot;\n    var dataAsBytes = []byte(data)\n\n    fmt.Println(data)\n\n    err := ioutil.WriteFile(&quot;hello_world.txt&quot;, dataAsBytes, 0644)\n\n    fmt.Println(err)\n\n    oopexpertutil.checkMe(err)\n\n}\n</code></pre>\n<h1>Disappointment...</h1>\n<p>This setup is still not working. You may have tried out all other answers that stick to workspace or package layout or &quot;go modules&quot; subject. The final point to consider to make this work is:</p>\n<p><strong>Change the name of the &quot;checkMe&quot; function of the referenced package to &quot;CheckMe&quot; and update the usage as well...</strong></p>\n<p>Go has some convention identifying <em><strong>exported functions</strong></em> from <em><strong>not exported functions</strong></em> of a package <em><strong>by a starting capital letter</strong></em>.</p>\n"}], "owner": {"reputation": 2647, "user_id": 2057867, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/a02ac3125fd67db27a3870119a93fa92?s=128&d=identicon&r=PG", "display_name": "Jacob Clark", "link": "https://stackoverflow.com/users/2057867/jacob-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60239, "favorite_count": 10, "answer_count": 6, "score": 60, "last_activity_date": 1599920760, "creation_date": 1434526467, "question_id": 30885098, "link": "https://stackoverflow.com/questions/30885098/go-local-import-in-non-local-package", "title": "Go: local import in non-local package", "body": "<p>I have the following file structure:</p>\n\n<pre><code>.\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 hello\n\u251c\u2500\u2500 pkg\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 jacob.uk.com\n        \u251c\u2500\u2500 greeting\n        \u2502\u00a0\u00a0 \u2514\u2500\u2500 greeting.go\n        \u2514\u2500\u2500 helloworld.go\n\n5 directories, 3 files\n</code></pre>\n\n<p>With the following GOPATH</p>\n\n<pre><code>/Users/clarkj84/Desktop/LearningGo\n</code></pre>\n\n<p>Upon executing <code>/usr/local/go/bin/go install jacob.uk.com</code> within the <code>src</code> folder, I get the error <code>local import \"./greeting\" in non-local package</code></p>\n\n<p><code>helloworld.go</code>:</p>\n\n<pre><code>package main;\nimport \"./greeting\"\n\nfunc main() {\n\n}\n</code></pre>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1434532910, "post_id": 30881035, "comment_id": 49814422, "body": "I suggest to use protobuf and send with raw socket. but why you think http post is more complex to mq client?"}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1434552625, "post_id": 30881035, "comment_id": 49829250, "body": "HTTP is fine, the problem that I&#39;m trying to solve is queuing the messages locally and retrying them when the cloud server is down or the network has issues, etc. I don&#39;t want to implement all that myself, there must be something out there that already does it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434562153, "post_id": 30881035, "comment_id": 49835881, "body": "An AMQP server isn&#39;t necessarily going to be more reliable than your http server (in fact, it probably won&#39;t be). What happens when you can&#39;t connect to RabbitMQ, or your delivery attempt returns a nack? You&#39;re right back to the same problem with retrying delivery and message persistence."}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1434567303, "post_id": 30881035, "comment_id": 49838995, "body": "Right. What is the solution then? Is there some library that can help/abstract it all from me? Someone must have solved this problem before. Or do I really have to implement it myself, e.g. using a local Redis queue with persistence for example?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1434586926, "post_id": 30881035, "comment_id": 49847614, "body": "that is more simple than you think it to implement a local queue and send them. just have a local storage(file/sqlite/sharedpreference), and start a service to check the storage periodically and do send."}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1434603306, "post_id": 30881035, "comment_id": 49851474, "body": "What about setting up a MQ replicated master-master, one instance in the cloud, one on the LAN? Local devices post to the local MQ instance and that will eventually get replicated to the other instance in the cloud where the cloud server reads from. This would also work for 2-way communication with multiple queues. Is this a viable solution?"}], "owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1542, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1434506949, "creation_date": 1434505757, "last_edit_date": 1434506949, "question_id": 30881035, "link": "https://stackoverflow.com/questions/30881035/amqp-guaranteed-delivery-in-go-golang", "title": "AMQP guaranteed delivery in Go (golang)", "body": "<p>Problem:</p>\n\n<ul>\n<li>a few small devices running an agent written in Go (golang); OS is Linux x86_64</li>\n<li>the devices are behind a firewall but they can establish <em>outgoing</em> connections to a cloud server</li>\n<li>the devices must be able to reliably post some messages to a server in the cloud</li>\n<li>the devices have local storage and they can persist messages (up to a limit) if the network is down or the cloud server is not available for whatever reason</li>\n<li>the implementation on the devices must be very light weight, preferably without using another local helper server, though a light local process would be acceptable, but a library that can run in process might be preferred</li>\n<li>a simple REST HTTP POST to the cloud server is not acceptable because the devices must then solve the reliable delivery problem</li>\n</ul>\n\n<p>Where should I start looking to do this with AMQP in Go, assuming an AMQP implementation is the right choice? Which implementation can help? RabbitMQ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 29582, "user_id": 1427098, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Bvdm0.jpg?s=128&g=1", "display_name": "Darshan Rivka Whittle", "link": "https://stackoverflow.com/users/1427098/darshan-rivka-whittle"}, "is_accepted": true, "score": 2, "last_activity_date": 1434505553, "creation_date": 1434505553, "answer_id": 30881007, "question_id": 30880942, "link": "https://stackoverflow.com/questions/30880942/declare-variable-with-format-specifier-in-go/30881007#30881007", "title": "Declare variable with format specifier in Go", "body": "<p>Yes, <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow\"><code>fmt.Sprintf</code></a> does that:</p>\n\n<pre><code>d := \"/some/dir/%s\"\nfmt.Sprintf(d, \"hello\") // Returns \"/some/dir/hello\"\n</code></pre>\n"}], "owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 30881007, "answer_count": 1, "score": -1, "last_activity_date": 1434505787, "creation_date": 1434505055, "last_edit_date": 1434505787, "question_id": 30880942, "link": "https://stackoverflow.com/questions/30880942/declare-variable-with-format-specifier-in-go", "title": "Declare variable with format specifier in Go", "body": "<p>In Python, I can declare a variable as <code>d ='/some/dir/%s'</code> and later replace <code>%s</code> with any value as </p>\n\n<pre><code>&gt;&gt;&gt; d =  '/some/dir/%s'\n&gt;&gt;&gt; d % \"hello\"\n'/some/dir/hello'\n</code></pre>\n\n<p>Is it possible to do the same in Go? If so, how?</p>\n"}, {"tags": ["concurrency", "go"], "answers": [{"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 5, "last_activity_date": 1434502693, "last_edit_date": 1434502693, "creation_date": 1434502382, "answer_id": 30880621, "question_id": 30880419, "link": "https://stackoverflow.com/questions/30880419/why-does-my-concurrent-function-exit-prematurely-in-go/30880621#30880621", "title": "Why does my concurrent function exit prematurely in Go?", "body": "<p>A Go program exits when main returns. In this case, your program is not waiting for the final \"world\" to be printed in another goroutine before exiting.</p>\n\n<p>The following code (<a href=\"http://play.golang.org/p/FuioS3MyEQ\" rel=\"noreferrer\">playground</a>) will ensure main never exits allowing the other goroutine to finish.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n    select{}\n}\n</code></pre>\n\n<p>As you may have noticed, this results in a deadlock because the program has no way to go forward. You may wish to add a channel or a sync.Waitgroup to ensure the program exits cleanly immediately after the other goroutine completes.</p>\n\n<p>For example (<a href=\"http://play.golang.org/p/RBP06YHIEP\" rel=\"noreferrer\">playground</a>):</p>\n\n<pre><code>func say(s string, ch chan&lt;- bool) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n\n    if ch != nil {\n        close(ch)\n    }\n}\n\nfunc main() {\n    ch := make(chan bool)\n    go say(\"world\", ch)\n    say(\"hello\", nil)\n    // wait for a signal that the other goroutine is done\n    &lt;-ch\n}\n</code></pre>\n"}], "owner": {"reputation": 1448, "user_id": 3990714, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9d3ffcc10f19da50e8c320016137dd7?s=128&d=identicon&r=PG&f=1", "display_name": "nonamorando", "link": "https://stackoverflow.com/users/3990714/nonamorando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "closed_date": 1475722269, "accepted_answer_id": 30880621, "answer_count": 1, "score": 1, "last_activity_date": 1434526165, "creation_date": 1434500910, "last_edit_date": 1434526165, "question_id": 30880419, "link": "https://stackoverflow.com/questions/30880419/why-does-my-concurrent-function-exit-prematurely-in-go", "closed_reason": "Duplicate", "title": "Why does my concurrent function exit prematurely in Go?", "body": "<p>I am looking through Go Bootcamp and am reading the Go Concurrency chapter right now. I have never used concurrency before in programming and don't understand the output of this program:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 2; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>hello\nworld\nhello\n\nProgram exited.\n</code></pre>\n\n<p>Can someone explain why \"world\" is not printed twice like \"hello\"? And maybe elucidate the idea of using concurrency? </p>\n\n<p>Note, Go Playground link <a href=\"http://play.golang.org/p/9JvbtSuv5o\" rel=\"nofollow\">here</a>. </p>\n"}, {"tags": ["go", "metrics", "pack"], "comments": [{"owner": {"reputation": 4311, "user_id": 741992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a2d7257021bf728eab69025ea0a5fd?s=128&d=identicon&r=PG", "display_name": "petrkotek", "link": "https://stackoverflow.com/users/741992/petrkotek"}, "edited": false, "score": 0, "creation_date": 1477110106, "post_id": 30877603, "comment_id": 67643687, "body": "late to the party, but healthd&#39;s endpoints are e.g. <a href=\"http://localhost:5002/healthd/jobs\" rel=\"nofollow noreferrer\">localhost:5002/healthd/jobs</a> or /healthd/aggregations (based on <code>HEALTHD_SERVER_HOSTPORT=:5002</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434549691, "post_id": 30878343, "comment_id": 49826930, "body": "BTW, doing <code>VAR=val VAR2=val2 command</code> is a sh/bash-ism that will not work in other environments/shells. The generic way to do this on is via <code>env</code>, that is: <code>env VAR=val VAR2=val2 command</code>. That will (should) work on all POSIX systems."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1434581578, "post_id": 30878343, "comment_id": 49846341, "body": "you said &quot;I can just invoke it with healthd if you&#39;re in the correct directory&quot;, which directory."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434582827, "post_id": 30878343, "comment_id": 49846671, "body": "@DaveC  that&#39;s what I did <code>export HEALTHD_MONITORED_HOSTPORTS=:5001 HEALTHD_SERVER_HOSTPORT=:5002 healthd </code>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434637466, "post_id": 30878343, "comment_id": 49873456, "body": "@Azis <code>export</code> does not equal <code>env</code>. Export (again shell specific, but I&#39;ll assume sh or bash) only marks some variables as exported (visible to later commands), possibly setting them. It&#39;s used like <code>export VAR=val VAR2=val2 VAR3 VAR4</code>, note there is no command, you cannot tack <code>healthd</code> on the end!! On the other hand, <code>env</code> is a shell-independent tool which sets/changes some values, and then runs a command (whatever is on the command line after the last <code>X=y</code> is a command and it&#39;s arguments)."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1434659457, "post_id": 30878343, "comment_id": 49887266, "body": "@Aziz when I said correct directory I meant the one which contains <code>healthd</code>. Alternatively your path could include the directly <code>healthd</code> is in which would make it accessible anyway. Anyway, it looks like you got healthd running now. I would try the other service. It&#39;s supposed to give you a better view of the data."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1434704484, "post_id": 30878343, "comment_id": 49903190, "body": "I got running but no answer from <b>localhost:5002/jobs</b> or the other endPoint"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434491646, "last_edit_date": 1434491646, "creation_date": 1434489311, "answer_id": 30878343, "question_id": 30877603, "link": "https://stackoverflow.com/questions/30877603/golang-healthd-and-healthtop-of-the-library-gocraft-health/30878343#30878343", "title": "Golang: healthd and healthtop of the library &quot;gocraft/health&quot;", "body": "<p>What you downloaded is a binary so you can just invoke it with <code>healthd</code> if you're in the correct directory, they actually provide this example;</p>\n\n<pre><code>HEALTHD_MONITORED_HOSTPORTS=:5020 HEALTHD_SERVER_HOSTPORT=:5032 healthd\n</code></pre>\n\n<p>Which isn't setting env var as much as invoking healthd with those two values (export or something would be required to persist the change beyond the one command). healthtop more clearly states what it is but as you can see by their paths, they're both commands <code>gocraft/health/cmd/healthtop</code>. They have several examples of using healthtop from bash, not so explicit about healthd but it's the same.</p>\n\n<p>If you ran that command (as you show in your question) then you may want to try <code>healthtop jobs</code> or something to that effect. I don't know a ton about this project and don't care to research it but from what I can tell <code>healthd</code> is just a service that collects results from various <code>/health</code> endpoints and makes them available in on API. It seems like they intend for you to use <code>healthtop</code> to on top of it to view reports.</p>\n\n<p>Also note this;</p>\n\n<blockquote>\n  <p>Great! To get a sense of the type of data healthd serves, you can manually navigate to:\n  /jobs: Lists top jobs\n  /aggregations: Provides a time series of aggregations\n  /aggregations/overall: Squishes all time series aggregations into one aggregation.\n  /hosts: Lists all monitored hosts and their statuses.\n  However, viewing raw JSON is just to give you a sense of the data. See the next section...</p>\n</blockquote>\n\n<p>I'm not sure what the domain is (localhost:5032 if you're running locally?) but you should probably just be able to go to localhost:5032/jobs and see the <code>healthd</code> is running and doing something. Also check your apps to confirm it's up and running. Don't expect any output from it directly, that's what <code>healthtop</code> is for.</p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1434584277, "creation_date": 1434486702, "last_edit_date": 1434584277, "question_id": 30877603, "link": "https://stackoverflow.com/questions/30877603/golang-healthd-and-healthtop-of-the-library-gocraft-health", "title": "Golang: healthd and healthtop of the library &quot;gocraft/health&quot;", "body": "<p>Im using <strong>gocraft/health</strong> to check the health of my service and have the metrics of each endPoint. \nIm usin The JSON polling sink to get the metrics.</p>\n\n<pre><code>sink := health.NewJsonPollingSink(time.Minute*5, time.Minute*5)\nstream.AddSink(sink)\n</code></pre>\n\n<p>I want to use  <strong>healthtop and healthd</strong>  here <a href=\"https://github.com/gocraft/health#healthd-and-healthtop\" rel=\"nofollow\">Link</a>  they explain how. </p>\n\n<p>I fixed the environment variables: <code>export HEALTHD_MONITORED_HOSTPORTS=:5001 HEALTHD_SERVER_HOSTPORT=:5002 healthd\n</code> as they said </p>\n\n<p>after they said \"Now you can run it\". how, they didn't give any command to do it.I didn't realy understand what they mean.</p>\n\n<p>I navigated to <strong>src/github.com/gocraft/health/cmd/healthd</strong>. I found <strong>main.go</strong> when I run it I got that in the console </p>\n\n<pre><code>    [openrtb@sd-69536 healthd]$ go run main.go\n    [2015-06-17T23:04:20.871743758Z]: job:general event:starting kvs:[health_host_port::5002 monitored_host_ports::5001,:5002 server_host_port::5002]\n    [2015-06-17T23:04:20.87810814Z]: job:poll status:success time:4 ms kvs:[host_port::5002]\n    [2015-06-17T23:04:20.881896459Z]: job:poll status:success time:8 ms kvs:[host_port::5001]\n    [2015-06-17T23:04:20.882338024Z]: job:recalculate status:success time:231 \u03bcs\n    [2015-06-17T23:04:23.275370787Z]: job:recalculate status:success time:6 \u03bcs\n    [2015-06-17T23:04:30.875230839Z]: job:poll status:success time:1573 \u03bcs kvs:[host_port::5002]\n    [2015-06-17T23:04:30.881415193Z]: job:poll status:success time:7 ms kvs:[host_port::5001]\n.\n.\n</code></pre>\n\n<p>but no reslute on the those endpoints </p>\n\n<p><strong>localhost:5002/jobs: Lists top jobs</strong></p>\n\n<p><strong>localhost:5002/hosts: Lists all monitored hosts and their statuses</strong></p>\n\n<p>it gave me <strong>{\"error\": \"not_found\"}</strong></p>\n\n<p>excepte this <strong>localhost:5002/health</strong> I got this JSON responce</p>\n\n<pre><code>{\n    \"instance_id\": \"sd-69536.1291\",\n    \"interval_duration\": 3600000000000,\n    \"aggregations\": [\n        {\n            \"interval_start\": \"2015-06-18T01:00:00+02:00\",\n            \"serial_number\": 48,\n            \"jobs\": {\n                \"general\": {\n                    \"timers\": {},\n                    \"events\": {\n                        \"starting\": 1\n                    },\n                    \"event_errs\": {},\n                    \"count\": 0,\n                    \"nanos_sum\": 0,\n                    \"nanos_sum_squares\": 0,\n                    \"nanos_min\": 0,\n                    \"nanos_max\": 0,\n                    \"count_success\": 0,\n                    \"count_validation_error\": 0,\n                    \"count_panic\": 0,\n                    \"count_error\": 0,\n                    \"count_junk\": 0\n                },\n                \"poll\": {\n                    \"timers\": {},\n                    \"events\": {},\n                    \"event_errs\": {},\n                    \"count\": 24,\n                    \"nanos_sum\": 107049159,\n                    \"nanos_sum_squares\": 6.06770682813009e+14,\n                    \"nanos_min\": 1581783,\n                    \"nanos_max\": 8259442,\n                    \"count_success\": 24,\n                    \"count_validation_error\": 0,\n                    \"count_panic\": 0,\n                    \"count_error\": 0,\n                    \"count_junk\": 0\n                },\n                \"recalculate\": {\n                    \"timers\": {},\n                    \"events\": {},\n                    \"event_errs\": {},\n                    \"count\": 23,\n                    \"nanos_sum\": 3501601,\n                    \"nanos_sum_squares\": 6.75958305123e+11,\n                    \"nanos_min\": 70639,\n                    \"nanos_max\": 290877,\n                    \"count_success\": 23,\n                    \"count_validation_error\": 0,\n                    \"count_panic\": 0,\n                    \"count_error\": 0,\n                    \"count_junk\": 0\n                }\n            },\n            \"timers\": {},\n            \"events\": {\n                \"starting\": 1\n            },\n            \"event_errs\": {}\n        }\n    ]\n}\n</code></pre>\n\n<p>but no idea what this result mean, because it doesn't have any relation with my<br>\n<strong>localhost:5001/health</strong> EndPoint that should normaly aggregate as they said. </p>\n"}, {"tags": ["arrays", "pointers", "go", "slice"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1434548738, "post_id": 30876241, "comment_id": 49826166, "body": "&quot;because once setting the slice to nil the garbage collector marks the memory area as dirty&quot; this is incorrect. If any code has a pointer to something then the garbage collector leaves it alone. You can set pointers to <code>nil</code> all day long and nothing happens with the garbage collector (<b>unless</b> what <i>was</i> pointed to is now no longer pointed to by anything else)."}], "answers": [{"comments": [{"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434483041, "post_id": 30876412, "comment_id": 49794133, "body": "So is the builtin <code>copy</code> function (or <code>:=</code> operator, whatever) using a COW approach? I mean, is the memory only allocated once for the slice holding the integer of value 3?"}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434483173, "post_id": 30876412, "comment_id": 49794199, "body": "Or, better yet: is this example using the same amount of memory as yours?   <a href=\"http://play.golang.org/p/e_ELjfseCO\" rel=\"nofollow noreferrer\">play.golang.org/p/e_ELjfseCO</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 2, "creation_date": 1434483231, "post_id": 30876412, "comment_id": 49794242, "body": "@alediaferia An array can hold elements. A slice is just a descriptor, it refers to an underlying array. In the example(s) only one backing array is allocated (by this: <code>make([]int, 5)</code>). You can have as many slices refering to the same array as you want, only the slice descriptor will be &quot;duplicated&quot; in memory."}, {"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "reply_to_user": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 1, "creation_date": 1434483263, "post_id": 30876412, "comment_id": 49794255, "body": "@alediaferia a slice is a reference type."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434483327, "post_id": 30876412, "comment_id": 49794291, "body": "Alright. Thanks everybody. You all helped me getting this straight."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 1, "creation_date": 1434483403, "post_id": 30876412, "comment_id": 49794341, "body": "@alediaferia In your second example (linked in your comment), also only one backing array of type <code>[]int</code> is created, and when you do this: <code>slicesArray[0] = slice</code> (where <code>slicesArray</code> is of type <code>[][]int</code>), the slice value, the descriptor is copied to the 0th element of <code>slicesArray</code>. The backing array of <code>slice</code> is not copied or duplicated, just the slice value is copied."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1471849737, "last_edit_date": 1471849737, "creation_date": 1434482681, "answer_id": 30876412, "question_id": 30876241, "link": "https://stackoverflow.com/questions/30876241/how-to-keep-a-strong-reference-in-go/30876412#30876412", "title": "How to keep a strong reference in Go?", "body": "<p><strong>TL;DR:</strong> (summary)</p>\n\n<p>You just need to make a copy of the slice value. A value of slice type is a descriptor to an <em>underlying</em> array:</p>\n\n<pre><code>slice2 := slice\n</code></pre>\n\n<p>Now <code>slice2</code> will refer to the same, shared underlying array and so it will be reachable after <code>slice</code> is zerored.</p>\n\n<p><strong>In long:</strong></p>\n\n<pre><code>slice := make([]int, 5)\n</code></pre>\n\n<p>This creates a local variable named <code>slice</code> of type <code>[]int</code> (and will be initialized with a descriptor referring to an array of size <code>5</code> created in the background by <code>make</code>). It's a slice which is a descriptor to a contiguous part of an underlying array which is created automatically in the background.</p>\n\n<pre><code>slicesArray[0] = &amp;slice\n</code></pre>\n\n<p>This stores the address of the local variable (named <code>slice</code>) into the 0th element of <code>slicesArray</code>. Note that <code>slicesArray</code> is just a slice of pointers (which pointers may point to values of type <code>[]int</code> but that doesn't matter now).</p>\n\n<p>So still no copy of the original <code>slice</code> is created.</p>\n\n<p>And so when you zero the only value of type <code>[]int</code> (which is the local variable named <code>slice</code>), you zero the only slice value (and you'll lose the only reference to its backing array).</p>\n\n<p>You want to keep the slice value after <code>slice</code> has been zeroed? Just make a copy of it (of the slice value). Copying a value of slice type only makes a copy of the descriptor, the backing array is not copied; and the copy will refer to the same backing array (it's shared):</p>\n\n<pre><code>slice2 := slice // makes a copy of the slice value\nslice = nil\n</code></pre>\n\n<p>After this <code>*(slicesArray[0])</code> will still point to a slice value being <code>nil</code>, but we have a copy of the original slice (and the shared backing array).</p>\n\n<p>So doing:</p>\n\n<pre><code>slicesArray[0] = &amp;slice2\nfmt.Println((*(slicesArray[0]))[3])\n</code></pre>\n\n<p>Will print again <code>25</code>. <a href=\"http://play.golang.org/p/jHGpg0Kxwn\" rel=\"nofollow\">Go Playground</a></p>\n\n<p><strong>Should you keep slice values or pointers to slices?</strong></p>\n\n<p>Since slices are just descriptors which are relatively small, you should keep and work with slice values. A slice value already contains a \"reference\" to a backing array. Adding another indirection by using a pointer to a slice just complicates and slightly slows things down. A slice is already designed to be small, efficient and flexible (compared to \"real\" arrays in Go).</p>\n\n<p>Of course a pointer to a slice value may also be useful in some cases, for example if you would ever want to create a function similar to the builtin <a href=\"http://golang.org/pkg/builtin/#append\" rel=\"nofollow\"><code>append()</code></a> function without returning the new slice. Or when you create a custom type whose underlying type is a slice type, and you define methods for this type which modify the slice value (in this case a pointer receiver is necessary).</p>\n\n<p><strong>Further readings:</strong> (the docs explaining everything in detail)</p>\n\n<p><a href=\"http://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">Go Slices: usage and internals</a></p>\n\n<p><a href=\"http://blog.golang.org/slices\" rel=\"nofollow\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}], "owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 30876412, "answer_count": 1, "score": 4, "last_activity_date": 1560511221, "creation_date": 1434482033, "last_edit_date": 1560511221, "question_id": 30876241, "link": "https://stackoverflow.com/questions/30876241/how-to-keep-a-strong-reference-in-go", "title": "How to keep a strong reference in Go?", "body": "<p>Is there any way I can keep a strong reference in Go?</p>\n\n<p>Given the following convoluted piece of code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nfunc main() {   \n  slice := make([]int, 5)\n  slice[3] = 25 // whatever index between 0 and 4 included I don't care\n\n  slicesArray := make([]*[]int, 2)  \n  slicesArray[0] = &amp;slice\n\n  fmt.Println((*(slicesArray[0]))[3])\n  slice = nil\n  fmt.Println((*(slicesArray[0]))[3])\n}\n</code></pre>\n\n<p>This program of course crashes because once setting the <strong>slice</strong> to <code>nil</code> the garbage collector marks the memory area as dirty.</p>\n\n<p>But is there a way to tell Go that my slice of pointers to slices should keep a strong reference to those slices? \nAlso, is there any memory usage gain in keeping references to slices rather than declaring slicesArray as <code>[][]int</code>? Is there any doc clearly stating how this is supposed to work?</p>\n"}, {"tags": ["php", "go"], "answers": [{"comments": [{"owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 0, "creation_date": 1434483049, "post_id": 30876435, "comment_id": 49794140, "body": "Interesting, that&#39;s really not mentioned in the documentation that it adds quotes like that."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 2, "creation_date": 1434483523, "post_id": 30876435, "comment_id": 49794417, "body": "@Langston: <code>exec.Command</code> operates like exec*(3), not system(3)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 0, "creation_date": 1434483919, "post_id": 30876435, "comment_id": 49794619, "body": "@Langston: nothing added any quotes, you put the quotes yourself in the string literal."}, {"owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434490682, "post_id": 30876435, "comment_id": 49798326, "body": "@JimB Perhaps I&#39;m confused but from Tim&#39;s answer, it appears that an extra set of double quotes gets addded around the value of the third parameter of <code>exec.Command</code>, which has no escaped quotes surrounding it initially."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 1, "creation_date": 1434548238, "post_id": 30876435, "comment_id": 49825762, "body": "@Langston no extra quotes are being added. If you do <code>exec.Command(&quot;cmd&quot;, &quot;arg one here&quot;, &quot;second thing&quot;, &quot;single&quot;)</code> the command will be executed with three arguments (four if you count &quot;cmd&quot; itself) and in this example there won&#39;t be a quote to be seen. Manually doing this via a shell would be <code>cmd &quot;arg one here&quot; &quot;second thing&quot; single</code>, <b>or</b> <code>cmd arg\\ one\\ here second\\ thing single</code>, <b>or</b> <code>cmd &#39;arg one here&#39; &#39;second thing&#39; &quot;single&quot;</code>, etc, etc. In other words the quotes in Tim&#39;s first example were added by him just to show that everything is being grouped together as a single argument."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "reply_to_user": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "edited": false, "score": 3, "creation_date": 1434548480, "post_id": 30876435, "comment_id": 49825952, "body": "@Langston in other words, you appear to have added extraneous single quotes in your question in order to group words into a single argument that is not needed and that get passed all the way into the command being run (where-as a shell needs those quotes to escape word breaks and strips them out)."}, {"owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434644064, "post_id": 30876435, "comment_id": 49878246, "body": "@DaveC Thanks for clarifying! That makes a lot more sense."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 5, "last_activity_date": 1434482726, "creation_date": 1434482726, "answer_id": 30876435, "question_id": 30875893, "link": "https://stackoverflow.com/questions/30875893/getting-a-php-configuration-variable-in-go/30876435#30876435", "title": "Getting a PHP configuration variable in Go", "body": "<p>The problem is your argument. If you change what you have written into a shell command, it would look like the following:</p>\n\n<pre><code>$ php -r \"'echo get_cfg_var(\\\"default_mimetype\\\");'\"\n</code></pre>\n\n<p>You will notice that there is an extra set of quotes around the 2nd argument that is causing the syntax error. You can fix this by changing your <code>exec.Command</code> to the following:</p>\n\n<pre><code>cmd := exec.Command(\"php\", \"-r\", \"echo get_cfg_var(\\\"\" + variableName + \"\\\");\")\n</code></pre>\n"}], "owner": {"reputation": 1063, "user_id": 2443833, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/lL91m.jpg?s=128&g=1", "display_name": "Langston", "link": "https://stackoverflow.com/users/2443833/langston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 30876435, "answer_count": 1, "score": 2, "last_activity_date": 1434482726, "creation_date": 1434480835, "question_id": 30875893, "link": "https://stackoverflow.com/questions/30875893/getting-a-php-configuration-variable-in-go", "title": "Getting a PHP configuration variable in Go", "body": "<p>I want to get the output of the command <code>php -r 'echo get_cfg_var(\"some_var\");'</code> to check it against a predefined value. Currently, I have the following code:</p>\n\n<pre><code>variableName := \"default_mimetype\"\ncmd := exec.Command(\"php\", \"-r\", \"'echo get_cfg_var(\\\"\" + variableName + \"\\\");'\")\nout, err := cmd.CombinedOutput()\n</code></pre>\n\n<p>after running, </p>\n\n<p><code>err.Error()</code> returns <code>\"exit status 254\"</code></p>\n\n<p><code>out</code> is <code>\"PHP Parse error:  syntax error, unexpected end of file in Command line code on line 1\"</code></p>\n\n<p>What is causing this error? Am I not escaping something properly?</p>\n"}, {"tags": ["json", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "edited": false, "score": 0, "creation_date": 1434476524, "post_id": 30874353, "comment_id": 49790361, "body": "Thanks for the quick reply.  That completely makes sense...  Unfortunately I oversimplified my example.  The data is more of the form: <code>{     &quot;set1&quot;: {         &quot;a&quot;: {         \t&quot;x&quot;: &quot;11&quot;,         \t&quot;y&quot;: &quot;22&quot;,         \t&quot;z&quot;: &quot;33&quot;     \t},         &quot;b&quot;: {         \t&quot;x&quot;: &quot;211&quot;,         \t&quot;y&quot;: &quot;222&quot;,         \t&quot;z&quot;: &quot;233&quot;     \t},         &quot;c&quot;: {         \t&quot;x&quot;: &quot;311&quot;,         \t&quot;y&quot;: &quot;322&quot;,         \t&quot;z&quot;: &quot;333&quot;     \t},     } }</code>, and I want to create a map of structures - i.e. map[string]StuctXType."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "edited": false, "score": 0, "creation_date": 1434477294, "post_id": 30874353, "comment_id": 49790839, "body": "@JamesHaskell that&#39;s cool, I got an edit for you with more about models :D"}, {"owner": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "edited": false, "score": 0, "creation_date": 1434478099, "post_id": 30874353, "comment_id": 49791332, "body": "Thanks again - I really appreciate the help.  The path you outlined above is what I&#39;ve been trying since yesterday, and it&#39;s just not working for me... not sure why, if I have a typo I&#39;m missing or what.  I posted my revised code as an edit to my original... I&#39;m getting the result: <code>JSON: {FirstSet:map[]}</code>.  Any additional thoughts?  Or could you post a full working example for me?  Thanks again so much.  I&#39;m having fun learning Go..."}, {"owner": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "edited": false, "score": 0, "creation_date": 1434478353, "post_id": 30874353, "comment_id": 49791493, "body": "Got it.  Typo - my fault...  Also looks like the &quot;Point&quot; variables need to be upper case.  Thanks again!!"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "edited": false, "score": 0, "creation_date": 1434478652, "post_id": 30874353, "comment_id": 49791675, "body": "@JamesHaskell that&#39;s because &#39;lower case fields are not exported&#39; in Go which basically means they&#39;re private. You can&#39;t unmarshal into an unexported field. Much like you can&#39;t deserialize into a private field in a class using C#&#39;s json.NET. The casing stuff is a subtle gotcha."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 4, "last_activity_date": 1434478439, "last_edit_date": 1434478439, "creation_date": 1434475921, "answer_id": 30874353, "question_id": 30874299, "link": "https://stackoverflow.com/questions/30874299/unmarshal-json-into-a-map-in-go/30874353#30874353", "title": "Unmarshal JSON into a map in Go", "body": "<p>I believe that is because you have extra layer of indirection in your models.</p>\n\n<pre><code>type JSONType struct {\n    FirstSet map[string]string `json:\"set1\"`\n}\n</code></pre>\n\n<p>Should suffice. if you specify <code>map[string]string</code> the object in json is recognized as that map. You created a struct to wrap it but a blob of json like this;</p>\n\n<pre><code>{\n    \"a\":\"11\",\n    \"b\":\"22\",\n    \"c\":\"33\"\n}\n</code></pre>\n\n<p>Actually can unmarshal directly into <code>map[string]string</code></p>\n\n<p>EDIT: Some other models based on the comment</p>\n\n<pre><code>type JSONType struct {\n    FirstSet map[string]Point `json:\"set1\"`\n}\n\ntype Point struct {\n     X string `json:\"x\"`\n     Y string `json:\"y\"`\n     Z string `json:\"z\"`\n}\n</code></pre>\n\n<p>This makes your 3-d point a statically typed struct which is fine. If you wanted to do the quick and dirty you could also just use <code>map[string]map[string]string</code>\nwhich would give a map of maps so you could access the point values like <code>FirstSet[\"a\"][\"x\"]</code> and it would return <code>\"11\"</code>.</p>\n\n<p>Second edit; clearly I didn't read you code that closely since the above example is the same. Based on that I would guess you want the</p>\n\n<pre><code> FirstSet map[string]map[string]string `json:\"set1\"`\n</code></pre>\n\n<p>option. Though it's not entirely clear to me after your edit.</p>\n"}], "owner": {"reputation": 775, "user_id": 1778335, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8798166727db11f5ac3f00cb269ee21f?s=128&d=identicon&r=PG", "display_name": "James Haskell", "link": "https://stackoverflow.com/users/1778335/james-haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4746, "favorite_count": 2, "accepted_answer_id": 30874353, "answer_count": 1, "score": 0, "last_activity_date": 1434478439, "creation_date": 1434475745, "last_edit_date": 1434477186, "question_id": 30874299, "link": "https://stackoverflow.com/questions/30874299/unmarshal-json-into-a-map-in-go", "title": "Unmarshal JSON into a map in Go", "body": "<p>I'm having trouble figuring out how to load a \"subsection\" of JSON file into a map element.  Background: I'm trying to unmarshal a somewhat complicated configuration file which has a strict structure, so I assume it's preferable to unmarshal into a \"static\" structure rather than into an interface{}.</p>\n\n<p>Here's a simple JSON file for example:</p>\n\n<pre><code>{\n    \"set1\": {\n        \"a\":\"11\",\n        \"b\":\"22\",\n        \"c\":\"33\"\n    }\n}\n</code></pre>\n\n<p>This code works:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype JSONType struct {\n    FirstSet ValsType `json:\"set1\"`\n}\n\ntype ValsType struct {\n    A string `json:\"a\"`\n    B string `json:\"b\"`\n    C string `json:\"c\"`\n}\n\nfunc main() {\n    file, e := ioutil.ReadFile(\"./test1.json\")\n    if e != nil {\n        fmt.Println(\"file error\")\n        os.Exit(1)\n    }\n    var s JSONType\n    json.Unmarshal([]byte(file), &amp;s)\n    fmt.Printf(\"\\nJSON: %+v\\n\", s)\n}\n</code></pre>\n\n<p>But this doesn't:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype JSONType struct {\n    FirstSet ValsType `json:\"set1\"`\n}\n\ntype ValsType struct {\n    Vals map[string]string\n}\n\nfunc main() {\n    file, e := ioutil.ReadFile(\"./test1.json\")\n    if e != nil {\n        fmt.Println(\"file error\")\n        os.Exit(1)\n    }\n\n    var s JSONType\n    s.FirstSet.Vals = map[string]string{}\n    json.Unmarshal([]byte(file), &amp;s)\n    fmt.Printf(\"\\nJSON: %+v\\n\", s)\n}\n</code></pre>\n\n<p>The Vals map isn't loaded.  What am I doing wrong?  Thanks for any help!</p>\n\n<p>Here's a better example:</p>\n\n<pre><code>{\n    \"set1\": {\n        \"a\": {\n            \"x\": \"11\",\n            \"y\": \"22\",\n            \"z\": \"33\"\n        },\n        \"b\": {\n            \"x\": \"211\",\n            \"y\": \"222\",\n            \"z\": \"233\"\n        },\n        \"c\": {\n            \"x\": \"311\",\n            \"y\": \"322\",\n            \"z\": \"333\"\n        },\n    }\n}\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype JSONType struct {\n    FirstSet map[string]ValsType `json:\"set1\"`\n}\n\ntype ValsType struct {\n    X string `json:\"x\"`\n    Y string `json:\"y\"`\n    Z string `json:\"z\"`\n}\n\nfunc main() {\n    file, e := ioutil.ReadFile(\"./test1.json\")\n    if e != nil {\n        fmt.Println(\"file error\")\n        os.Exit(1)\n    }\n    var s JSONType\n    json.Unmarshal([]byte(file), &amp;s)\n    fmt.Printf(\"\\nJSON: %+v\\n\", s)\n}\n</code></pre>\n"}, {"tags": ["go", "profiling", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1434469902, "post_id": 30871691, "comment_id": 49786403, "body": "First, what OS are you using? Second, <code>pprof</code>is a &quot;sampling profiler&quot;, and you&#39;re not doing anything that can be sampled. Your app needs to be continually executing instructions for some appreciable amount of time to accumulate enough samples (when using net/http/pprof, the default sample time is 30s)"}, {"owner": {"reputation": 886, "user_id": 583120, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33010d8ed92a11f6524279ecdf411f11?s=128&d=identicon&r=PG", "display_name": "Fersca", "link": "https://stackoverflow.com/users/583120/fersca"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434470593, "post_id": 30871691, "comment_id": 49786842, "body": "I am working with OSX 10.10.2  (Yosemite). I am trying now to take the profile working during long periods of time and now I see that the file have more information :) thanks!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434470836, "post_id": 30871691, "comment_id": 49786988, "body": "you also need to read this then: <a href=\"http://godoc.org/rsc.io/pprof_mac_fix\" rel=\"nofollow noreferrer\">godoc.org/rsc.io/pprof_mac_fix</a>"}], "answers": [{"comments": [{"owner": {"reputation": 886, "user_id": 583120, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33010d8ed92a11f6524279ecdf411f11?s=128&d=identicon&r=PG", "display_name": "Fersca", "link": "https://stackoverflow.com/users/583120/fersca"}, "edited": false, "score": 0, "creation_date": 1434470023, "post_id": 30872472, "comment_id": 49786487, "body": "Thanks, I will try it and I will tell you the results!! :)"}, {"owner": {"reputation": 886, "user_id": 583120, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33010d8ed92a11f6524279ecdf411f11?s=128&d=identicon&r=PG", "display_name": "Fersca", "link": "https://stackoverflow.com/users/583120/fersca"}, "edited": false, "score": 0, "creation_date": 1434470655, "post_id": 30872472, "comment_id": 49786883, "body": "I see now, after adding a for{;;} and a sleep, that the file have more information. Thanks :)"}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": false, "score": 4, "last_activity_date": 1434470081, "last_edit_date": 1434470081, "creation_date": 1434469976, "answer_id": 30872472, "question_id": 30871691, "link": "https://stackoverflow.com/questions/30871691/cant-get-golang-pprof-working/30872472#30872472", "title": "Can&#39;t get golang pprof working", "body": "<p>The problem is that your function is running too fast and pprof can't sample it. Try adding a loop around the <code>fact</code> call and sum the result to artificially prolong the program.</p>\n"}, {"tags": [], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "is_accepted": false, "score": 9, "last_activity_date": 1436697940, "last_edit_date": 1436697940, "creation_date": 1436697495, "answer_id": 31366860, "question_id": 30871691, "link": "https://stackoverflow.com/questions/30871691/cant-get-golang-pprof-working/31366860#31366860", "title": "Can&#39;t get golang pprof working", "body": "<p>As inf mentioned already, your code executes too fast. The reason is that pprof works by repeatedly halting your program during its execution, looking at which function is running at that moment in time and writing that down (together with the whole function call stack). Pprof samples with a rate of 100 samples per second. This is hardcoded in runtime/pprof/pprof.go as you can easily check (see <a href=\"https://golang.org/src/runtime/pprof/pprof.go\" rel=\"noreferrer\">https://golang.org/src/runtime/pprof/pprof.go</a> line 575 and the comment above it):</p>\n\n<pre><code>func StartCPUProfile(w io.Writer) error {\n// The runtime routines allow a variable profiling rate,\n// but in practice operating systems cannot trigger signals\n// at more than about 500 Hz, and our processing of the\n// signal is not cheap (mostly getting the stack trace).\n// 100 Hz is a reasonable choice: it is frequent enough to\n// produce useful data, rare enough not to bog down the\n// system, and a nice round number to make it easy to\n// convert sample counts to seconds.  Instead of requiring\n// each client to specify the frequency, we hard code it.\nconst hz = 100\n\n// Avoid queueing behind StopCPUProfile.\n// Could use TryLock instead if we had it.\nif cpu.profiling {\n    return fmt.Errorf(\"cpu profiling already in use\")\n}\n\ncpu.Lock()\ndefer cpu.Unlock()\nif cpu.done == nil {\n    cpu.done = make(chan bool)\n}\n// Double-check.\nif cpu.profiling {\n    return fmt.Errorf(\"cpu profiling already in use\")\n}\ncpu.profiling = true\nruntime.SetCPUProfileRate(hz)\ngo profileWriter(w)\nreturn nil\n</code></pre>\n\n<p>}</p>\n\n<p>The longer your program runs the more samples can be made and the more probable it will become that also short running functions will be sampled. If your program finishes before even the first sample is made, than the generated cpu.pprof will be empty.</p>\n\n<p>As you can see from the code above, the sampling rate is set with </p>\n\n<pre><code>runtime.SetCPUProfileRate(..)\n</code></pre>\n\n<p>If you call runtime.SetCPUProfileRate() with another value <strong>before</strong> you call StartCPUProfile(), you can override the sampling rate. You will receive a warning message during execution of your program telling you \"runtime: cannot set cpu profile rate until previous profile has finished.\" which you can ignore. It results since pprof.go calls SetCPUProfileRate() again. Since you have already set the value, the one from pprof will be ignored.</p>\n\n<p>Also, Dave Cheney has released a new version of his profiling tool, you can find it here: <a href=\"https://github.com/pkg/profile\" rel=\"noreferrer\">https://github.com/pkg/profile</a> . There, you can, among other changes, specify the path where the cpu.pprof is written to:</p>\n\n<pre><code>defer profile.Start(profile.CPUProfile, profile.ProfilePath(\".\")).Stop()\n</code></pre>\n\n<p>You can read about it here: <a href=\"http://dave.cheney.net/2014/10/22/simple-profiling-package-moved-updated\" rel=\"noreferrer\">http://dave.cheney.net/2014/10/22/simple-profiling-package-moved-updated</a></p>\n\n<p>By the way, your fact() function will quickly overflow, even if you take int64 as parameter and return value. 30! is roughly 2*10^32 and an int64 stores values only up to 2^63-1 which is roughly 9*10^18.</p>\n"}], "owner": {"reputation": 886, "user_id": 583120, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/33010d8ed92a11f6524279ecdf411f11?s=128&d=identicon&r=PG", "display_name": "Fersca", "link": "https://stackoverflow.com/users/583120/fersca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14438, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1436697940, "creation_date": 1434467897, "question_id": 30871691, "link": "https://stackoverflow.com/questions/30871691/cant-get-golang-pprof-working", "title": "Can&#39;t get golang pprof working", "body": "<p>I have tried to profile some golang applications but I couldn't have that working, I have followed these two tutorials: </p>\n\n<ul>\n<li><a href=\"http://blog.golang.org/profiling-go-programs\" rel=\"noreferrer\">http://blog.golang.org/profiling-go-programs</a></li>\n<li><a href=\"http://saml.rilspace.org/profiling-and-creating-call-graphs-for-go-programs-with-go-tool-pprof\" rel=\"noreferrer\">http://saml.rilspace.org/profiling-and-creating-call-graphs-for-go-programs-with-go-tool-pprof</a></li>\n</ul>\n\n<p>Both says that after adding some code lines to the application, you have to execute your app, I did that and I receiveed the following message in the screen:</p>\n\n<blockquote>\n  <p>2015/06/16 12:04:00 profile: cpu profiling enabled,\n  /var/folders/kg/4fxym1sn0bx02zl_2sdbmrhr9wjvqt/T/profile680799962/cpu.pprof</p>\n</blockquote>\n\n<p>So, I understand that the profiling is being executed, sending info to the file.</p>\n\n<p>But, when I see the file size, in any program that I test, it is always 64bytes.</p>\n\n<p>When I try to open the cpu.pprof file with pprof, and I execute the \"top10\" command, I see that nothing is in the file:</p>\n\n<p>(\"./fact\" is my app)</p>\n\n<blockquote>\n  <p>go tool pprof ./fact\n  /var/folders/kg/4fxym1sn0bx02zl_2sdbmrhr9wjvqt/T/profile680799962/cpu.pprof</p>\n  \n  <p>top10 --></p>\n  \n  <p>(pprof) top10 0 of 0 total (    0%)\n        flat  flat%   sum%        cum   cum%</p>\n</blockquote>\n\n<p>So, it is like nothing is happening when I am profiling.</p>\n\n<p>I have tested it in mac (this example) and in ubuntu, with three different programs.</p>\n\n<p>Do you know that I am doing wrong?</p>\n\n<p>Then example program is very simple, this is the code (is a very simple factorial program that I take from internet):</p>\n\n<pre><code>import \"fmt\"\nimport \"github.com/davecheney/profile\"\n\nfunc fact(n int) int {\n      if n == 0 {\n        return 1\n      }\n      return n * fact(n-1)\n}\n\nfunc main() {\n      defer profile.Start(profile.CPUProfile).Stop()\n      fmt.Println(fact(30))\n}\n</code></pre>\n\n<p>Thanks,\nFer</p>\n"}, {"tags": ["go", "etcd", "kite"], "answers": [{"comments": [{"owner": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "edited": false, "score": 0, "creation_date": 1507488786, "post_id": 30876406, "comment_id": 80218934, "body": "Hi, I&#39;m also trying to get kontrol work... but I&#39;ve a few problems. I&#39;ve created the keys, set the environment variables, and started etcd... but when I start kontrol I always get the following error message: <code>[kontrol] CRITICAL Could not create KitesPrefix &quot;&#47;kites&quot;: client: etcd cluster is unavailable or misconfigured; error #0: unsupported protocol scheme &quot;&quot;</code>. May I ask you what step did you exactly to make it run? The documentation is quite poor. Thank you very much :-)"}, {"owner": {"reputation": 189, "user_id": 2112039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01085cb980ada7fea471cca08f732a15?s=128&d=identicon&r=PG", "display_name": "Shishir", "link": "https://stackoverflow.com/users/2112039/shishir"}, "reply_to_user": {"reputation": 8678, "user_id": 278659, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a10f8a52a8c247d8e20ee9ab59ee22f2?s=128&d=identicon&r=PG", "display_name": "j3d", "link": "https://stackoverflow.com/users/278659/j3d"}, "edited": false, "score": 0, "creation_date": 1546284133, "post_id": 30876406, "comment_id": 94819221, "body": "Most likely kontrol environment variables are not set."}], "tags": [], "owner": {"reputation": 189, "user_id": 2112039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01085cb980ada7fea471cca08f732a15?s=128&d=identicon&r=PG", "display_name": "Shishir", "link": "https://stackoverflow.com/users/2112039/shishir"}, "is_accepted": true, "score": 1, "last_activity_date": 1434482655, "creation_date": 1434482655, "answer_id": 30876406, "question_id": 30870404, "link": "https://stackoverflow.com/questions/30870404/distributed-microservices-using-kite-and-kontrol/30876406#30876406", "title": "Distributed microservices using Kite and Kontrol", "body": "<p>I have figured it out. I need to export these environment variable,</p>\n\n<pre><code>export KONTROL_PORT=4099\nexport KONTROL_USERNAME=\"kontrol\"\nexport KONTROL_STORAGE=\"etcd\"\nexport KONTROL_KONTROLURL=\"http://127.0.0.1:4099/kite\"\nexport KONTROL_PUBLICKEYFILE=~/certs/key_pub.pem\nexport KONTROL_PRIVATEKEYFILE=~/certs/key.pem\n</code></pre>\n\n<p>Then generate rsa token,</p>\n\n<pre><code>cd ~/certs/\nopenssl genrsa -out key.pem 2048\nopenssl rsa -in key.pem -pubout &gt; key_pub.pem\nopenssl rsa -in key.pem -pubout &gt; key_pub.pem\n</code></pre>\n\n<p>Run Kontrol CLI with -install flag.</p>\n"}], "owner": {"reputation": 189, "user_id": 2112039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01085cb980ada7fea471cca08f732a15?s=128&d=identicon&r=PG", "display_name": "Shishir", "link": "https://stackoverflow.com/users/2112039/shishir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 30876406, "answer_count": 1, "score": 1, "last_activity_date": 1449019233, "creation_date": 1434464527, "last_edit_date": 1449019233, "question_id": 30870404, "link": "https://stackoverflow.com/questions/30870404/distributed-microservices-using-kite-and-kontrol", "title": "Distributed microservices using Kite and Kontrol", "body": "<p>I am able to register my kite microservice to kontrol but unable to discover it,</p>\n\n<pre><code>kites, err := k.GetKites(&amp;protocol.KontrolQuery{\n        Username:    k.Config.Username,\n        Environment:k.Config.Environment,\n        Name:\"myservice\",\n    })enter code here\n    if err != nil {\n        fmt.Println(\"has error\")\n        log.Fatalln(err)\n    }\n</code></pre>\n\n<p>I am getting authenticationError.</p>\n\n<pre><code>has error\n2015/06/16 09:59:16 authenticationError: token contains an invalid number of segments\nexit status 1\n</code></pre>\n\n<p>Also I am not able to find <code>$USER_HOME/.kite/kite.key</code> file. </p>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 2679, "user_id": 3081480, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UVerL.jpg?s=128&g=1", "display_name": "Kyle Chadha", "link": "https://stackoverflow.com/users/3081480/kyle-chadha"}, "edited": false, "score": 0, "creation_date": 1455480350, "post_id": 30867337, "comment_id": 58497208, "body": "I don&#39;t think this is a bad question, it just implies an elementary understanding of mysql. Nothing wrong with that."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434460155, "post_id": 30867686, "comment_id": 49778436, "body": "Note that writing your own escaping function is a non trivial undertaking."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434461496, "post_id": 30867686, "comment_id": 49779491, "body": "@elithrar True, but just to provide a simple check is just as easy as matching against the regexp <code>&quot;^[A-Za-z0-9_]+$&quot;</code> (see edited answer)."}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434484738, "post_id": 30867686, "comment_id": 49795062, "body": "@icza many thanks, while not the answer I was hoping for at least now I know where I stand."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 14, "last_activity_date": 1472550421, "last_edit_date": 1472550421, "creation_date": 1434457903, "answer_id": 30867686, "question_id": 30867337, "link": "https://stackoverflow.com/questions/30867337/golang-order-by-issue-with-mysql/30867686#30867686", "title": "Golang ORDER BY issue with MySql", "body": "<p>Placeholders (<code>'?'</code>) can only be used to insert dynamic, escaped values for filter parameters (e.g. in the <code>WHERE</code> part), where data values should appear, not for SQL keywords, identifiers etc. You cannot use it to dynamically specify the <code>ORDER BY</code> OR <code>GROUP BY</code> values.</p>\n\n<p>You can still do it though, for example you can use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"noreferrer\"><code>fmt.Sprintf()</code></a> to assemble the dynamic query text like this:</p>\n\n<pre><code>ordCol := \"title\"\n\nqtext := fmt.Sprintf(\"SELECT * FROM Apps ORDER BY %s DESC\", ordCol)\nrows, err := db.Query(qtext)\n</code></pre>\n\n<p><strong>Things to keep in mind:</strong></p>\n\n<p>Doing so you will have to manually defend vs SQL injection, e.g. if the value of the column name comes from the user, you cannot accept any value and just insert it directly into the query else the user will be able to do all kinds of bad things. Trivially you should only accept letters of the English alphabet + digits + underscore (<code>'_'</code>).</p>\n\n<p>Without attempting to provide a complete, all-extensive checker or escaping function, you can use this simple regexp which only accepts English letters, digits and <code>'_'</code>:</p>\n\n<pre><code>valid := regexp.MustCompile(\"^[A-Za-z0-9_]+$\")\nif !valid.MatchString(ordCol) {\n    // invalid column name, do not proceed in order to prevent SQL injection\n}\n</code></pre>\n\n<p>Examples (try it on the <a href=\"http://play.golang.org/p/q0qjSmrey_\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>fmt.Println(valid.MatchString(\"title\"))         // true\nfmt.Println(valid.MatchString(\"another_col_2\")) // true\nfmt.Println(valid.MatchString(\"it's a trap!\"))  // false\nfmt.Println(valid.MatchString(\"(trap)\"))        // false\nfmt.Println(valid.MatchString(\"also*trap\"))     // false\n</code></pre>\n"}], "owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4212, "favorite_count": 1, "accepted_answer_id": 30867686, "answer_count": 1, "score": 10, "last_activity_date": 1472550421, "creation_date": 1434456980, "question_id": 30867337, "link": "https://stackoverflow.com/questions/30867337/golang-order-by-issue-with-mysql", "title": "Golang ORDER BY issue with MySql", "body": "<p>I can't seem to dynamically ORDER BY with db.Select(). I've Googled without any luck...</p>\n\n<p><strong>WORKS</strong></p>\n\n<p><code>rows, err := db.Query(\"SELECT * FROM Apps ORDER BY title DESC\")</code></p>\n\n<p><strong>DOES NOT WORK</strong></p>\n\n<p><code>rows, err := db.Query(\"SELECT * FROM Apps ORDER BY ? DESC\", \"title\")</code></p>\n\n<p>I'm not getting any errors, the query simply fails to order.</p>\n"}, {"tags": ["go", "blockchain"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1434449711, "post_id": 30864206, "comment_id": 49771198, "body": "And what is your question?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434461218, "post_id": 30864206, "comment_id": 49779246, "body": "Is <code>blockchainr</code> your code? If you look at the stack trace, <code>db</code> is nil. You need to make sure that doesn&#39;t happen."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "edited": false, "score": 0, "creation_date": 1434462736, "post_id": 30869090, "comment_id": 49780511, "body": "Thanks! Any idea what the DB should be set to?"}, {"owner": {"reputation": 3704, "user_id": 859355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YHgGT.jpg?s=128&g=1", "display_name": "Vincenzo Maggio", "link": "https://stackoverflow.com/users/859355/vincenzo-maggio"}, "reply_to_user": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "edited": false, "score": 0, "creation_date": 1434463510, "post_id": 30869090, "comment_id": 49781238, "body": "Unfortunately it&#39;s quite application dependent, you can check here <a href=\"https://github.com/FiloSottile/blockchainr/blob/master/src/github.com/conformal/btcdb/db.go\" rel=\"nofollow noreferrer\">github.com/FiloSottile/blockchainr/blob/master/src/github.co&zwnj;&#8203;m/&hellip;</a> to understand how to add a db driver"}, {"owner": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "edited": false, "score": 0, "creation_date": 1434464207, "post_id": 30869090, "comment_id": 49781849, "body": "Fix: The new btcd ignores the specified --data-dir argument and stored data in the Library (in OSX, not sure about other OS&#39;s)"}, {"owner": {"reputation": 3704, "user_id": 859355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YHgGT.jpg?s=128&g=1", "display_name": "Vincenzo Maggio", "link": "https://stackoverflow.com/users/859355/vincenzo-maggio"}, "reply_to_user": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "edited": false, "score": 0, "creation_date": 1434464673, "post_id": 30869090, "comment_id": 49782270, "body": "I&#39;ve noticed that the &quot;vendor&quot; src of blockchainr was not updated (even the folder structure changed, doc link was broken as well). Well, better this way! :)"}, {"owner": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "edited": false, "score": 0, "creation_date": 1434465153, "post_id": 30869090, "comment_id": 49782702, "body": "I&#39;m very unfamiliar with Go, I&#39;m just using blockchainr as a way to learn Go and ECDSA at the same time"}], "tags": [], "owner": {"reputation": 3704, "user_id": 859355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YHgGT.jpg?s=128&g=1", "display_name": "Vincenzo Maggio", "link": "https://stackoverflow.com/users/859355/vincenzo-maggio"}, "is_accepted": true, "score": 0, "last_activity_date": 1434461500, "creation_date": 1434461500, "answer_id": 30869090, "question_id": 30864206, "link": "https://stackoverflow.com/questions/30864206/panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference-when-run/30869090#30869090", "title": "panic: runtime error: invalid memory address or nil pointer dereference when running Blockchainr", "body": "<p>Your problem lies with <a href=\"https://github.com/FiloSottile/blockchainr/blob/master/src/blockchainr/main.go\" rel=\"nofollow\">Blockchainr main.go</a> following lines:</p>\n\n<pre><code>var (\n    dataDir = flag.String(\"datadir\", filepath.Join(btcutil.AppDataDir(\"btcd\", false), \"data\"), \"BTCD: Data directory\")\n    dbType  = flag.String(\"dbtype\", \"leveldb\", \"BTCD: Database backend\")\n)\n</code></pre>\n\n<p>As you can see, if you don't specify a <code>dbtype</code> flag it defaults to <code>\"leveldb\"</code> so it expects the <code>datadir</code> param to contains the path to a LevelDB database.</p>\n"}], "owner": {"reputation": 21, "user_id": 5014783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/935a68f105897ff93e22e10f8fe20f46?s=128&d=identicon&r=PG", "display_name": "Kieran Mesquita", "link": "https://stackoverflow.com/users/5014783/kieran-mesquita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 996, "favorite_count": 0, "accepted_answer_id": 30869090, "answer_count": 1, "score": 0, "last_activity_date": 1434461500, "creation_date": 1434448297, "question_id": 30864206, "link": "https://stackoverflow.com/questions/30864206/panic-runtime-error-invalid-memory-address-or-nil-pointer-dereference-when-run", "title": "panic: runtime error: invalid memory address or nil pointer dereference when running Blockchainr", "body": "<p>I run blockchainr and get the following terminal output:</p>\n\n<pre><code>17:39:57 2015-06-16 [INF] loading db leveldb\npanic: runtime error: invalid memory address or nil pointer dereference\n    panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x402cb63]\n\ngoroutine 1 [running]:\nmain.search(0x4911ef8, 0xc20806e2d0, 0x0, 0x0, 0x4911ef8)\n    /Users/mesquka/Downloads/blockchainr-master/src/blockchainr/main.go:185 +0x3fa\nmain.main()\n    /Users/mesquka/Downloads/blockchainr-master/src/blockchainr/main.go:284 +0x3ce\n\ngoroutine 5 [semacquire]:\nsync.(*Cond).Wait(0xc208045100)\n    /usr/local/go/src/sync/cond.go:62 +0x9e\ngithub.com/conformal/seelog.(*asyncLoopLogger).processItem(0xc20802c4e0, 0x0)\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:50 +0xc2\ngithub.com/conformal/seelog.(*asyncLoopLogger).processQueue(0xc20802c4e0)\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:63 +0x31\ncreated by github.com/conformal/seelog.newAsyncLoopLogger\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:40 +0x8e\n\ngoroutine 6 [semacquire]:\nsync.(*Cond).Wait(0xc2080452c0)\n    /usr/local/go/src/sync/cond.go:62 +0x9e\ngithub.com/conformal/seelog.(*asyncLoopLogger).processItem(0xc20802c5a0, 0x0)\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:50 +0xc2\ngithub.com/conformal/seelog.(*asyncLoopLogger).processQueue(0xc20802c5a0)\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:63 +0x31\ncreated by github.com/conformal/seelog.newAsyncLoopLogger\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_asynclooplogger.go:40 +0x8e\n\ngoroutine 7 [syscall]:\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:21 +0x1f\ncreated by os/signal.init\u00b71\n    /usr/local/go/src/os/signal/signal_unix.go:27 +0x35\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1\n\ngoroutine 8 [chan receive]:\ngithub.com/conformal/seelog.(*asyncAdaptiveLogger).processQueue(0xc208010150)\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_adaptivelogger.go:127 +0x89\ncreated by github.com/conformal/seelog.newAsyncAdaptiveLogger\n    /Users/mesquka/Downloads/blockchainr-master/src/github.com/conformal/seelog/behavior_adaptivelogger.go:84 +0x6ba\n</code></pre>\n\n<p>I am running on OSX Yosemite 10.10.3 with go version go1.4.2 darwin/amd64</p>\n\n<p>The code is at <a href=\"https://github.com/FiloSottile/blockchainr\" rel=\"nofollow\">https://github.com/FiloSottile/blockchainr</a></p>\n\n<p>The specific commands I've run (in order) are:</p>\n\n<ul>\n<li>make all</li>\n<li>./bin/btcd --datadir=~/Btcd/</li>\n<li>./bin/blockchainr -datadir ~/Btcd/</li>\n</ul>\n\n<p>The last command is where I get this terminal output.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1434441656, "post_id": 30861801, "comment_id": 49766172, "body": "Also related: <a href=\"http://stackoverflow.com/questions/26523664/how-to-compile-golang-program-with-a-file-without-source\" title=\"how to compile golang program with a file without source\">stackoverflow.com/questions/26523664/&hellip;</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1434441770, "post_id": 30861801, "comment_id": 49766238, "body": "Theoretically you only need 1 workspace, even for multiple go projects. This one workspace can hold the source of multiple projects and required external libraries. Do this and you won&#39;t have to duplicate your external source files. Distributing and using compiled packages is discouraged in Go."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3168954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff8e05bdb619054ae99df5f0a712b8f?s=128&d=identicon&r=PG&f=1", "display_name": "Klaid Liadon", "link": "https://stackoverflow.com/users/3168954/klaid-liadon"}, "is_accepted": false, "score": 0, "last_activity_date": 1434450192, "creation_date": 1434450192, "answer_id": 30864907, "question_id": 30861801, "link": "https://stackoverflow.com/questions/30861801/is-possible-in-go-to-create-something-like-static-or-dynamic-library-and-remove/30864907#30864907", "title": "Is possible in Go to create something like static or dynamic library and remove source from both projects and put on one neutral place?", "body": "<p>You can create a package for each function (like mailer) and place them in a different GOPATH of common libraries.</p>\n\n<p>In each project add this path to the <code>GOPATH</code> (<code>PROJECT_PATH:COMMON_PATH</code>).</p>\n\n<p>Alternatively, if you can share the code, save the package in Github (package src only, without folder struct) and use <code>go get</code> to fetch the package and keep it updated.</p>\n"}], "owner": {"reputation": 93, "user_id": 5011492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206978012152158/picture?type=large", "display_name": "Black Obama", "link": "https://stackoverflow.com/users/5011492/black-obama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "closed_date": 1435112096, "answer_count": 1, "score": 0, "last_activity_date": 1434450192, "creation_date": 1434441280, "question_id": 30861801, "link": "https://stackoverflow.com/questions/30861801/is-possible-in-go-to-create-something-like-static-or-dynamic-library-and-remove", "closed_reason": "Duplicate", "title": "Is possible in Go to create something like static or dynamic library and remove source from both projects and put on one neutral place?", "body": "<p>I have couple files with same code, one package for example <code>mailer</code>, <code>shared between two projects</code> in Go. In both projects I have copied exactly the same code and it works.\nIs possible in Go to create something like static or dynamic library, like in c or c++, and remove source from both projects and put on one neutral place ?\nHow to achieve this in Go ?</p>\n"}, {"tags": ["go", "type-conversion", "channel"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1434438449, "post_id": 30860644, "comment_id": 49764207, "body": "Go is statically typed and you cannot do strange magic. A <code>chan int</code> is not an <code>int</code> just like a <code>func(map[float64]bool) complex128</code> is not an <code>int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1475843026, "last_edit_date": 1475843026, "creation_date": 1434438922, "answer_id": 30861080, "question_id": 30860644, "link": "https://stackoverflow.com/questions/30860644/convert-chan-to-non-chan-in-golang/30861080#30861080", "title": "Convert chan to non chan in golang", "body": "<p>A <code>chan int</code> is a channel of <code>int</code> values, it is not a single <code>int</code> value but a source of <code>int</code> values (or also a target, but in your case you use it as source).</p>\n\n<p>So therefore you can't convert <code>chan int</code> to <code>int</code>. What you can do and probably what you mean is use a value (of type <code>int</code>) received from a <code>chan int</code> as an <code>int</code> value.</p>\n\n<p>This is not a problem:</p>\n\n<pre><code>var result int\nch := funcWithChanResult()\nresult = &lt;- ch\n</code></pre>\n\n<p>Or more compact:</p>\n\n<pre><code>result := &lt;- funcWithChanResult()\n</code></pre>\n\n<p>Combine this with the <code>return</code> statement:</p>\n\n<pre><code>func funcWithNonChanResult() int {\n    return &lt;-funcWithChanResult()\n}\n</code></pre>\n\n<p>Output (as expected):</p>\n\n<pre><code>Received first int: 123\nReceived second int: 123\n</code></pre>\n\n<p>Try your modified, working example on the <a href=\"http://play.golang.org/p/J48w5j0zdw\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10380, "favorite_count": 2, "accepted_answer_id": 30861080, "answer_count": 1, "score": 5, "last_activity_date": 1475843073, "creation_date": 1434437486, "last_edit_date": 1475843073, "question_id": 30860644, "link": "https://stackoverflow.com/questions/30860644/convert-chan-to-non-chan-in-golang", "title": "Convert chan to non chan in golang", "body": "<p>Is it possible to let function <code>funcWithNonChanResult</code> have the following interface:</p>\n\n<pre><code>func funcWithNonChanResult() int {\n</code></pre>\n\n<p>And if I want it to use function <code>funcWithChanResult</code> with the interface:</p>\n\n<pre><code>func funcWithChanResult() chan int {\n</code></pre>\n\n<p>In other words, can I somehow convert <code>chan int</code> to <code>int</code>? Or I must have <code>chan int</code> result type in all the functions which use <code>funcWithChanResult</code>?</p>\n\n<p>Currently, I tried these methods:</p>\n\n<pre><code>result = funcWithChanResult() \n//  cannot use funcWithChanResult() (type chan int) as type int in assignment\n\n\nresult &lt;- funcWithChanResult() \n// invalid operation: result &lt;- funcWithChanResult() (send to non-chan type int)\n</code></pre>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc getIntSlowly() int {\n    time.Sleep(time.Millisecond * 500)\n    return 123\n}\n\nfunc funcWithChanResult() chan int {\n    chanint := make(chan int)\n    go func() {\n        chanint &lt;- getIntSlowly()\n    }()\n    return chanint\n}\n\nfunc funcWithNonChanResult() int {\n    var result int\n    result = funcWithChanResult() \n    // result &lt;- funcWithChanResult() \n    return result\n}\n\nfunc main() {\n    fmt.Println(\"Received first int:\", &lt;-funcWithChanResult())\n    fmt.Println(\"Received second int:\", funcWithNonChanResult())\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/zFFZV0pR07\" rel=\"noreferrer\">Playground</a></p>\n"}, {"tags": ["go", "return", "func"], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 4308307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d366c2e05b13f7656ac01985c23ed7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/4308307/andrey"}, "edited": false, "score": 0, "creation_date": 1434430277, "post_id": 30858913, "comment_id": 49760837, "body": "Is it possible to simplify code and return FROM a func? I&#39;ll have plenty of apiResponse() calls and it can be easy to forget return"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 335, "user_id": 4308307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d366c2e05b13f7656ac01985c23ed7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/4308307/andrey"}, "edited": false, "score": 1, "creation_date": 1434439956, "post_id": 30858913, "comment_id": 49765152, "body": "@Andrey no, luckily not. That would be a readability disaster."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 335, "user_id": 4308307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d366c2e05b13f7656ac01985c23ed7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/4308307/andrey"}, "edited": false, "score": 0, "creation_date": 1434440222, "post_id": 30858913, "comment_id": 49765320, "body": "@Andrey If <code>apiResponse()</code> returns an <code>error</code> and <code>apiEndpoint()</code> returns an error, the compiler will enforce an explicit return. You could then do <code>return apiResponse()</code> - which will call the function and return the error value (if any), else nil."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1434429497, "creation_date": 1434429497, "answer_id": 30858913, "question_id": 30858823, "link": "https://stackoverflow.com/questions/30858823/golang-how-to-return-in-func-from-another-func/30858913#30858913", "title": "Golang, how to return in func FROM another func?", "body": "<p>Use the <code>return</code> statement:</p>\n\n<pre><code>func apiEndpoint() {\n    if false {\n        apiResponse(\"error\")\n        return\n    }\n\n    apiResponse(\"all good\")\n}\n\nfunc apiResponse(message string) {\n    // returns message to user via JSON\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1434440256, "post_id": 30861350, "comment_id": 49765343, "body": "You&#39;re looking for the terms &quot;callee&quot; and &quot;caller&quot;, not &quot;child&quot; and &quot;parent&quot;."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1434440341, "post_id": 30861350, "comment_id": 49765390, "body": "@rightfold I&#39;m not looking for those (I know them), I was just using the asker&#39;s terms hence I put them in quotes."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1434440621, "post_id": 30861350, "comment_id": 49765575, "body": "@rightfold But you&#39;re right, it would be better to put aside asker&#39;s terms and use the right ones. So I edited, thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1434440895, "last_edit_date": 1434440895, "creation_date": 1434439776, "answer_id": 30861350, "question_id": 30858823, "link": "https://stackoverflow.com/questions/30858823/golang-how-to-return-in-func-from-another-func/30861350#30861350", "title": "Golang, how to return in func FROM another func?", "body": "<p>A function or method cannot control the execution (control flow) from where it was called from. You don't even have guarantee it was called from your function, it may be called to initialize a global variable for example.</p>\n\n<p>That being said it is the responsibility of the caller to end the execution and return, explicitly with the <code>return</code> statement.</p>\n\n<p>If the example is as simple as yours, you can avoid the <code>return</code> statement though by using <code>if-else</code>:</p>\n\n<pre><code>func apiEndpoint() {\n    if someCondition {\n        apiResponse(\"error\")\n    } else {\n        apiResponse(\"all good\")\n    }\n}\n</code></pre>\n\n<p>Also if the functions have return values and the <code>apiResponse()</code> would return a value that would be the return value of the caller, you can do the <code>return</code> in one line, e.g.</p>\n\n<pre><code>func apiEndpoint() int {\n    if someCondition {\n        return apiResponse(\"error\")\n    }\n\n    return apiResponse(\"all good\")\n}\n\nfunc apiResponse(message string) int {\n    return 1 // Return an int\n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Just for completeness but not as a solution in your case: if the callee function would <code>panic()</code>, the execution in the caller function would stop and the panicing sequence would go up in the call hierarchy (after running <code>defer</code> functions, and if they don't call <code>recover()</code>). Panic-recover is designed for something else and not as a mean for callee functions to stop executions in caller functions.</p>\n"}], "owner": {"reputation": 335, "user_id": 4308307, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d366c2e05b13f7656ac01985c23ed7a7?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/4308307/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3269, "favorite_count": 0, "accepted_answer_id": 30861350, "answer_count": 2, "score": 0, "last_activity_date": 1434440895, "creation_date": 1434429000, "question_id": 30858823, "link": "https://stackoverflow.com/questions/30858823/golang-how-to-return-in-func-from-another-func", "title": "Golang, how to return in func FROM another func?", "body": "<p>I want to end execution in parent func <code>apiEndpoint()</code> upon calling/exiting in a child func <code>apiResponse()</code></p>\n\n<pre><code>func apiEndpoint() {\n    if false {\n        apiResponse(\"error\")\n        // I want apiResponse() call to return (end execution) in parent func\n        // so next apiResponse(\"all good\") wont be executed\n    }\n\n    apiResponse(\"all good\")\n}\n\nfunc apiResponse(message string) {\n    // returns message to user via JSON\n}\n</code></pre>\n"}, {"tags": ["struct", "go", "interface", "switch-statement"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1434420435, "post_id": 30857687, "comment_id": 49758614, "body": "You&#39;re not passing a <code>*Location</code> to <code>Merge</code>; that&#39;s why you&#39;re getting &quot;Not Applicable&quot;.  Also, you may want to consider just implementing <a href=\"https://godoc.org/fmt#Stringer\" rel=\"nofollow noreferrer\"><code>fmt.Stringer</code></a> for your types."}, {"owner": {"reputation": 143, "user_id": 443002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29304fafe3bab0f4510a8242bf9a5b6?s=128&d=identicon&r=PG", "display_name": "Scott S. ", "link": "https://stackoverflow.com/users/443002/scott-s"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434420560, "post_id": 30857687, "comment_id": 49758641, "body": "Thanks for the suggestion, Tim. Can you expand on how I would use fmt.Stringer? The println(merge())) line was a simplification of what I have. The actual line I have is fmt.Println(Merge(servicesA.Users[0].Location))"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1434421381, "post_id": 30857687, "comment_id": 49758829, "body": "What is the type of <code>servicesA.Users[0].Location</code>: <code>Location</code> or <code>*Location</code>? Also you might find useful <code>%v</code> or <code>%+v</code> with <code>Sprintf</code>"}, {"owner": {"reputation": 143, "user_id": 443002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29304fafe3bab0f4510a8242bf9a5b6?s=128&d=identicon&r=PG", "display_name": "Scott S. ", "link": "https://stackoverflow.com/users/443002/scott-s"}, "edited": false, "score": 0, "creation_date": 1434421847, "post_id": 30857687, "comment_id": 49758913, "body": "Thanks for the comment, kostya. It&#39;s supposed to be just Location. When I tried removing the pointer in the function (*Location to Location) and ran it, I got this: panic: interface conversion: interface is main.Location not *main.Location"}], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 443002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29304fafe3bab0f4510a8242bf9a5b6?s=128&d=identicon&r=PG", "display_name": "Scott S. ", "link": "https://stackoverflow.com/users/443002/scott-s"}, "edited": false, "score": 0, "creation_date": 1434463925, "post_id": 30858275, "comment_id": 49781616, "body": "Thank you, Tom! That&#39;s a great explanation! When I typed out my Println function, I also forgot to include an &amp; reference to the *Location in my Merge function. My final Println method came to this: fmt.Println(Merge(&amp;servicesA.Users[0].Location)) After that change and reviewing your code, it worked the way I intended. Thanks again, Tom."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434467200, "post_id": 30858275, "comment_id": 49784448, "body": "If you&#39;re going to use a type switch you shouldn&#39;t use type assertions in the case bodies. E.g. <a href=\"https://play.golang.org/p/Wh9mAr4xzi\" rel=\"nofollow noreferrer\">play.golang.org/p/Wh9mAr4xzi</a>."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434467518, "post_id": 30858275, "comment_id": 49784712, "body": "The OP mentioned the example was a simplification, if you have multiple types that all want to have a common behaviour it&#39;s common to use an interface (<code>fmt.Stringer</code> would only be appropriate if that&#39;s a string representation of the whole type). E.g. perhaps something like <a href=\"https://play.golang.org/p/xq3a0RcbFa\" rel=\"nofollow noreferrer\">play.golang.org/p/xq3a0RcbFa</a>"}], "tags": [], "owner": {"reputation": 5608, "user_id": 660828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2ab261718814b4842efac71a1b6cd1a5?s=128&d=identicon&r=PG", "display_name": "Tom Jowitt", "link": "https://stackoverflow.com/users/660828/tom-jowitt"}, "is_accepted": true, "score": 7, "last_activity_date": 1434426208, "last_edit_date": 1434426208, "creation_date": 1434425182, "answer_id": 30858275, "question_id": 30857687, "link": "https://stackoverflow.com/questions/30857687/golang-switch-between-structs/30858275#30858275", "title": "Golang switch between structs", "body": "<p>In your example you are trying to pass the struct itself to the function rather than an instance of the struct. When I ran your code it wouldn't compile. I agree with the comments above though, this would be much better handled by making sure each struct satisfies the fmt.Stringer interface.</p>\n\n<p><a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"noreferrer\">fmt.Stringer interface</a></p>\n\n<p>A fixed version of your code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Name struct {\n    Title string\n    First string\n    Last  string\n}\n\ntype Location struct {\n    Street string\n    City   string\n    State  string\n    Zip    string\n}\n\nfunc Merge(m interface{}) string {\n    switch m.(type) {\n    case Location:\n        return fmt.Sprintf(\"%s \\n %s, %s %s\", m.(Location).Street, m.(Location).City, m.(Location).State, m.(Location).Zip)\n    case Name:\n        return fmt.Sprintf(\"%s. %s %s\", m.(Name).Title, m.(Name).First, m.(Name).Last)\n    }\n    return \"Not Applicable\"\n}\n\nfunc main() {\n    l := Location{\n        Street: \"122 Broadway\",\n        City: \"New York\",\n        State: \"NY\",\n        Zip: \"1000\",\n    }\n    fmt.Println(Merge(l))\n}\n</code></pre>\n\n<p>A version using fmt.String:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Name struct {\n    Title string\n    First string\n    Last  string\n}\n\nfunc (n *Name) String() string {\n    return fmt.Sprintf(\"%s. %s %s\", n.Title, n.First, n.Last)\n}\n\ntype Location struct {\n    Street string\n    City   string\n    State  string\n    Zip    string\n}\n\nfunc (l *Location) String() string {\n    return fmt.Sprintf(\"%s \\n %s, %s %s\", l.Street, l.City, l.State, l.Zip)\n}\n\nfunc main() {\n    l := &amp;Location{\n        Street: \"120 Broadway\",\n        City:   \"New York\",\n        State:  \"NY\",\n        Zip:    \"1000\",\n    }\n    fmt.Println(l)\n\n    n := &amp;Name{\n        Title: \"Mr\",\n        First: \"Billy\",\n        Last:  \"Bob\",\n    }\n    fmt.Println(n)\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 443002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29304fafe3bab0f4510a8242bf9a5b6?s=128&d=identicon&r=PG", "display_name": "Scott S. ", "link": "https://stackoverflow.com/users/443002/scott-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6788, "favorite_count": 1, "accepted_answer_id": 30858275, "answer_count": 1, "score": 4, "last_activity_date": 1434426208, "creation_date": 1434419992, "last_edit_date": 1434425883, "question_id": 30857687, "link": "https://stackoverflow.com/questions/30857687/golang-switch-between-structs", "title": "Golang switch between structs", "body": "<p>I'm new to golang and I'm trying to create a function that, based on the struct it's used on, will return a formatted string using Sprintf</p>\n\n<pre><code>type Name struct {\n    Title string\n    First string\n    Last  string\n}\n\ntype Location struct {\n    Street string\n    City   string\n    State  string\n    Zip    string\n}\n\nfunc Merge(m interface{}) string {\n    switch m.(type) {\n    case *Location:\n        return fmt.Sprintf(\"%s \\n %s, %s %s\", m.(*Location).Street, m.(*Location).City, m.(*Location).State, m.(*Location).Zip)\n    case *Name:\n        return fmt.Sprintf(\"%s. %s %s\", m.(*Name).Title, m.(*Name).First, m.(*Name).Last)\n    }\n    return \"Not Applicable\"\n}\n\nfmt.Println(Merge(Location))\n</code></pre>\n\n<p>I'm getting the \"<code>Not Applicable</code>\" message from my <code>PrintLn</code>. In one version of the code, I believe the message was \"<code>out of index</code>\". </p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 3, "creation_date": 1434412390, "post_id": 30856454, "comment_id": 49756769, "body": "I doesn&#39;t matter that the service/software itself is liberal about 0/false and 1/true, if it outputs JSON with &quot;1&quot;s for values it knows are boolean, then it is producing malformed JSON. Boolean and Number are different types in JOSN, and it a marshaller doesn&#39;t correctly deal with that, it has no right to expect the de-marshaller to."}, {"owner": {"reputation": 879, "user_id": 73309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580fe1b74d0daebd7c5508263d5008?s=128&d=identicon&r=PG", "display_name": "Will Charczuk", "link": "https://stackoverflow.com/users/73309/will-charczuk"}, "reply_to_user": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1434412844, "post_id": 30856454, "comment_id": 49756877, "body": "i mean, i agree that the output is bad, this isn&#39;t a vacuum though and i really have to process this output and have no control over fixing it"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1434412853, "post_id": 30856454, "comment_id": 49756879, "body": "You can implement the UnMarshalJson method for your type, not sure what you want the end result to be. In your example, the boolean and int have different field names, like they are different things. I don&#39;t think viewing it as the &quot;API interchanging the types&quot; is correct. If it was always the same field name, then that might be the case. Either way, you could always use the clean simple, fail proof method of having different types and on your end and trying to unmarshal into them one by one until you get a success. The paradigm is often used for responses that could have data or error."}, {"owner": {"reputation": 879, "user_id": 73309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580fe1b74d0daebd7c5508263d5008?s=128&d=identicon&r=PG", "display_name": "Will Charczuk", "link": "https://stackoverflow.com/users/73309/will-charczuk"}, "edited": false, "score": 0, "creation_date": 1434412903, "post_id": 30856454, "comment_id": 49756891, "body": "I guess the example is misleading, there are times when the same field is 0 or false"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1434412985, "post_id": 30856454, "comment_id": 49756903, "body": "Ah, figured as much. I just threw in an edit. I would do the custom UnmarshalJSON method and read the json for int, bool and string and then just set the bool on my type. For anything else I&#39;d error or default to false. I could provide an answer but there are probably quite a few examples you can find and I&#39;m about to leave work."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 3, "creation_date": 1434413393, "post_id": 30856454, "comment_id": 49757034, "body": "fyi this seems like a decent blog on the topic; <a href=\"http://attilaolah.eu/2013/11/29/json-decoding-in-go/\" rel=\"nofollow noreferrer\">attilaolah.eu/2013/11/29/json-decoding-in-go</a>  only complaint is that he chooses different paradigms on either end... Like one case he implements Decode for his type, the on the other end he does MarshalJSON. Personally I say be consistent there but whatever."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1434416173, "post_id": 30857066, "comment_id": 49757676, "body": "Small tip: Go style convention is to use <code>mixedCaps</code> (<a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#mixed-caps</a>) variable names, so <code>as_string</code> should be <code>asString</code> (or just <code>s</code> if it&#39;s a small function)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1434447028, "post_id": 30857066, "comment_id": 49769492, "body": "Also another small tip: there is a method <a href=\"https://golang.org/pkg/fmt/#Errorf\" rel=\"nofollow noreferrer\"><code>fmt.Errorf()</code></a> so you don&#39;t need <code>errors.New()</code> and <code>fmt.Sprintf()</code>. (Btw <code>fmt.Error()</code> does exactly the same under the hood.)"}, {"owner": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "edited": false, "score": 1, "creation_date": 1463155018, "post_id": 30857066, "comment_id": 61960236, "body": "This did not work, I think we need a pointer to ConvertibleBoolean. See answer below"}, {"owner": {"reputation": 259, "user_id": 332884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e3ed95df080a431a41316795a3dc978?s=128&d=identicon&r=PG", "display_name": "13k", "link": "https://stackoverflow.com/users/332884/13k"}, "edited": false, "score": 1, "creation_date": 1496776527, "post_id": 30857066, "comment_id": 75795965, "body": "you might want to take a look at <a href=\"https://golang.org/pkg/strconv/#ParseBool\" rel=\"nofollow noreferrer\"><code>strconv.ParseBool</code></a>"}], "tags": [], "owner": {"reputation": 879, "user_id": 73309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580fe1b74d0daebd7c5508263d5008?s=128&d=identicon&r=PG", "display_name": "Will Charczuk", "link": "https://stackoverflow.com/users/73309/will-charczuk"}, "is_accepted": false, "score": 10, "last_activity_date": 1434467291, "last_edit_date": 1434467291, "creation_date": 1434414656, "answer_id": 30857066, "question_id": 30856454, "link": "https://stackoverflow.com/questions/30856454/how-to-unmarshall-both-0-and-false-as-bool-from-json/30857066#30857066", "title": "How to unmarshall both 0 and false as bool from JSON", "body": "<p>Ended up using a special \"boolean\" type, and where I was using a normal bool, swapped for this:</p>\n\n<pre><code>type ConvertibleBoolean bool\n\nfunc (bit ConvertibleBoolean) UnmarshalJSON(data []byte) error {\n    asString := string(data)\n    if asString == \"1\" || asString == \"true\" {\n        bit = true\n    } else if asString == \"0\" || asString == \"false\" {\n        bit = false\n    } else {\n        return errors.New(fmt.Sprintf(\"Boolean unmarshal error: invalid input %s\", asString))\n    }\n    return nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1893, "user_id": 127958, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0846808c184064b26729044cdeb75a5d?s=128&d=identicon&r=PG", "display_name": "kadalamittai", "link": "https://stackoverflow.com/users/127958/kadalamittai"}, "edited": false, "score": 0, "creation_date": 1498446447, "post_id": 37214476, "comment_id": 76486300, "body": "worked fine. just changed asString to replace &quot;\\&quot;&quot;   asString := strings.Replace(strings.ToLower(strings.TrimSpace(string(dat&zwnj;&#8203;a))), &quot;\\&quot;&quot;, &quot;&quot;, -1)"}, {"owner": {"reputation": 693, "user_id": 3297761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGv4e.jpg?s=128&g=1", "display_name": "EduLopez", "link": "https://stackoverflow.com/users/3297761/edulopez"}, "edited": false, "score": 0, "creation_date": 1574104710, "post_id": 37214476, "comment_id": 104104155, "body": "This is the fixed version of the answer below. It looks simple and useful."}], "tags": [], "owner": {"reputation": 16513, "user_id": 95642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/36cf75fa7751ef674df65ab65cecd255?s=128&d=identicon&r=PG", "display_name": "Drew LeSueur", "link": "https://stackoverflow.com/users/95642/drew-lesueur"}, "is_accepted": false, "score": 11, "last_activity_date": 1463155075, "creation_date": 1463155075, "answer_id": 37214476, "question_id": 30856454, "link": "https://stackoverflow.com/questions/30856454/how-to-unmarshall-both-0-and-false-as-bool-from-json/37214476#37214476", "title": "How to unmarshall both 0 and false as bool from JSON", "body": "<p>Thank you Will Charzuck for the answer, however, it did not work for me unless I used a pointer method receiver, and set the value of the pointer in the function body.</p>\n\n<pre><code>type ConvertibleBoolean bool\n\nfunc (bit *ConvertibleBoolean) UnmarshalJSON(data []byte) error {\n    asString := string(data)\n    if asString == \"1\" || asString == \"true\" {\n        *bit = true\n    } else if asString == \"0\" || asString == \"false\" {\n        *bit = false\n    } else {\n        return errors.New(fmt.Sprintf(\"Boolean unmarshal error: invalid input %s\", asString))\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5879880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c88d2177b1e19808cb4d959ad5cf69c?s=128&d=identicon&r=PG", "display_name": "Twitch Captain", "link": "https://stackoverflow.com/users/5879880/twitch-captain"}, "is_accepted": false, "score": 3, "last_activity_date": 1561970493, "last_edit_date": 1561970493, "creation_date": 1561969814, "answer_id": 56832346, "question_id": 30856454, "link": "https://stackoverflow.com/questions/30856454/how-to-unmarshall-both-0-and-false-as-bool-from-json/56832346#56832346", "title": "How to unmarshall both 0 and false as bool from JSON", "body": "<p>This is my take on it. In case you need something to deal with a few extra cases. Add more as needed.</p>\n\n<pre><code>// so you know what's needed.\nimport (\n    \"encoding/json\"\n    \"strconv\"\n    \"strings\"\n)\n\n// NumBool provides a container and unmarshalling for fields that may be\n// boolean or numbrs in the WebUI API.\ntype NumBool struct {\n    Val bool\n    Num float64\n}\n\n// UnmarshalJSON parses fields that may be numbers or booleans.\nfunc (f *NumBool) UnmarshalJSON(b []byte) (err error) {\n    switch str := strings.ToLower(strings.Trim(string(b), `\"`)); str {\n    case \"true\":\n        f.Val = true\n    case \"false\":\n        f.Val = false\n    default:\n        f.Num, err = strconv.ParseFloat(str, 64)\n        if f.Num &gt; 0 {\n            f.Val = true\n        }\n    }\n    return err\n}\n</code></pre>\n\n<p>See it in <a href=\"https://play.golang.org/p/sXMvQY5dJ9f\" rel=\"nofollow noreferrer\">playground</a>.</p>\n\n<p>I've also been known to something like this:</p>\n\n<pre><code>// FlexBool provides a container and unmarshalling for fields that may be\n// boolean or strings in the Unifi API.\ntype FlexBool struct {\n    Val bool\n    Txt string\n}\n\n// UnmarshalJSON method converts armed/disarmed, yes/no, active/inactive or 0/1 to true/false.\n// Really it converts ready, ok, up, t, armed, yes, active, enabled, 1, true to true. Anything else is false.\nfunc (f *FlexBool) UnmarshalJSON(b []byte) error {\n    if f.Txt = strings.Trim(string(b), `\"`); f.Txt == \"\" {\n        f.Txt = \"false\"\n    }\n    f.Val = f.Txt == \"1\" || strings.EqualFold(f.Txt, \"true\") || strings.EqualFold(f.Txt, \"yes\") ||\n        strings.EqualFold(f.Txt, \"t\") || strings.EqualFold(f.Txt, \"armed\") || strings.EqualFold(f.Txt, \"active\") ||\n        strings.EqualFold(f.Txt, \"enabled\") || strings.EqualFold(f.Txt, \"ready\") || strings.EqualFold(f.Txt, \"up\") ||\n        strings.EqualFold(f.Txt, \"ok\")\n    return nil\n}\n</code></pre>\n\n<p>And if you want to go real small:</p>\n\n<pre><code>// Bool allows 0/1 to also become boolean.\ntype Bool bool\n\nfunc (bit *Bool) UnmarshalJSON(b []byte) error {\n    txt := string(b)\n    *bit = Bool(txt == \"1\" || txt == \"true\")\n    return nil\n}\n</code></pre>\n\n<p>See this one in <a href=\"https://play.golang.org/p/57s4xwGo3pw\" rel=\"nofollow noreferrer\">playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 957, "user_id": 547371, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e273522ee37f129133ba65fd5b99bf5a?s=128&d=identicon&r=PG", "display_name": "Arbiter of buffoonery", "link": "https://stackoverflow.com/users/547371/arbiter-of-buffoonery"}, "is_accepted": false, "score": 0, "last_activity_date": 1592255401, "creation_date": 1592255401, "answer_id": 62397099, "question_id": 30856454, "link": "https://stackoverflow.com/questions/30856454/how-to-unmarshall-both-0-and-false-as-bool-from-json/62397099#62397099", "title": "How to unmarshall both 0 and false as bool from JSON", "body": "<p>For <a href=\"https://stackoverflow.com/users/5879880/twitch-captain\">@Twitch Captian's</a> 3rd example, I found the result of <code>string(b)</code> caused <code>txt</code> to equal <code>\"\"1\"\"</code> instead of <code>\"1\"</code> as I expected. To remedy this I unmarshaled the byte array into <code>txt</code>, then evaluated the contents for <code>\"1\" || \"true\"</code></p>\n\n<pre><code>// Bool allows 0/1 to also become boolean.\ntype Bool bool\n\nfunc (bit *Bool) UnmarshalJSON(b []byte) error {\n    var txt string\n    err := json.Unmarshal(b, &amp;txt)\n    if err != nil {\n        return err\n    }\n\n    *bit = Bool(txt == \"1\" || txt == \"true\")\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 879, "user_id": 73309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3580fe1b74d0daebd7c5508263d5008?s=128&d=identicon&r=PG", "display_name": "Will Charczuk", "link": "https://stackoverflow.com/users/73309/will-charczuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12855, "favorite_count": 0, "answer_count": 4, "score": 12, "last_activity_date": 1592255401, "creation_date": 1434409925, "last_edit_date": 1504191440, "question_id": 30856454, "link": "https://stackoverflow.com/questions/30856454/how-to-unmarshall-both-0-and-false-as-bool-from-json", "title": "How to unmarshall both 0 and false as bool from JSON", "body": "<p>Currently am mapping the output of a service that, lets say, liberally interchanges 0 and false (and 1 and true) for its boolean types. Is there a way to use a more permissive parser for the built in encoding/json unmarshal function? I've tried adding ,string to the json tags to no avail. </p>\n\n<p>An example of what I'd want:</p>\n\n<pre><code>type MyType struct {\n    AsBoolean bool `json:\"field1\"`\n    AlsoBoolean bool `json:\"field2\"`\n}\n</code></pre>\n\n<p>then, given input json:</p>\n\n<pre><code>{\n    \"field1\" : true,\n    \"field2\" : 1\n}\n</code></pre>\n\n<p>the resulting struct would be:</p>\n\n<pre><code>obj := MyType{}\njson_err := json.Unmarshal([]byte(input_json), &amp;obj)\nfmt.Printf(\"%v\\n\", obj.AsBoolean) //\"true\"\nfmt.Printf(\"%v\\n\", obj.AlsoBoolean) //\"true\"\n</code></pre>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434407539, "post_id": 30855499, "comment_id": 49755431, "body": "Your struct tags should have backticks, not single quotes. A package like <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a> can also assist in marshaling rows into structs."}], "answers": [{"tags": [], "owner": {"reputation": 1550, "user_id": 464623, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ba8c707b3cddf068a978d436a66f218e?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/464623/dmitry"}, "is_accepted": true, "score": 1, "last_activity_date": 1434470172, "creation_date": 1434470172, "answer_id": 30872564, "question_id": 30855499, "link": "https://stackoverflow.com/questions/30855499/using-sqlx-rows-structscan-for-interface-args/30872564#30872564", "title": "Using sqlx.Rows.StructScan for interface args", "body": "<p>Solved </p>\n\n<pre><code>// package 2\nfunc GetData(sql string, dest interface{}) {\n    arr := reflect.ValueOf(dest).Elem()\n    v := reflect.New(reflect.TypeOf(dest).Elem().Elem())\n    rows, err := DBI.Queryx(sql)\n    if err == nil {\n        if err = rows.StructScan(v.Interface()); err == nil {\n            arr.Set(reflect.Append(arr, v.Elem()))\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1550, "user_id": 464623, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ba8c707b3cddf068a978d436a66f218e?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/464623/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 30872564, "answer_count": 1, "score": 0, "last_activity_date": 1434470172, "creation_date": 1434404745, "last_edit_date": 1434431406, "question_id": 30855499, "link": "https://stackoverflow.com/questions/30855499/using-sqlx-rows-structscan-for-interface-args", "title": "Using sqlx.Rows.StructScan for interface args", "body": "<p>I need to use StructScan function for interface (pointer to struct).\nBut if I try to reflect value, I've got error, because <em>reflect.New()</em> returning <em>reflect.Value</em> type. How I can scan structure and store data into <em>dest</em> var?</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>// package 1\ntype Data struct {\n    id int `db:\"id\"`\n    caption string `db:\"caption\"`\n}\n\nfunc Func1 {\n    data := []Data{}\n    GetData(&amp;data)\n    log.Println(data)\n}\n\n// package 2\nfunc GetData(sql string, dest interface{}) {\n    rows, err := DBI.Queryx(sql)\n    if err == nil {\n        // reflect.Value\n        myData := reflect.New(reflect.TypeOf(dest).Elem().Elem())\n        for rows.Next() {\n            rows.StructScan(&amp;myData) // Fail here\n\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "stack", "benchmarking", "slice"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1434403925, "post_id": 30855207, "comment_id": 49754050, "body": "And the question is ...?"}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1434404290, "post_id": 30855207, "comment_id": 49754235, "body": "@inf LOL, sorry! :) It must have stayed in the keyboard. Just updated the question."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1434404336, "post_id": 30855207, "comment_id": 49754265, "body": "What&#39;s the initial capacity of the slice in the slower example?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 4, "creation_date": 1434404364, "post_id": 30855207, "comment_id": 49754281, "body": "I still wouldn&#39;t call that a question. Your performance bench mark is very small minded. Your allocation works better because you&#39;re dealing with small data sets. Slices have base 2 growth by default, I would hardly call it optimized and it&#39;s really easy to test. The slice is just over allocating a lot here because you&#39;re starting with 0 capacity and reallocated in the 0,1,2,4,8,16,32 elements ect and the algorithm doesn&#39;t pick up until your set gets big."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1434404686, "post_id": 30855207, "comment_id": 49754421, "body": "@evanmcdonnal I&#39;d call yours an answer though :) Thank you"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1434412887, "post_id": 30855207, "comment_id": 49756882, "body": "Are you sure your <code>Push</code> is correct? I think you are missing to copy the existing values during slice cap growths. If your copy is a noop it will be faster, bit wrong."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434441685, "post_id": 30855207, "comment_id": 49766189, "body": "@Volker I&#39;m copying the existing values with <code>copy(slice, s.slice)</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1434445689, "post_id": 30855207, "comment_id": 49768579, "body": "@alediaferia: Yes, but your <code>slice</code> has length 0, so you don&#39;t copy."}], "answers": [{"comments": [{"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434441353, "post_id": 30855526, "comment_id": 49766020, "body": "Just a small correction. I&#39;m allocating with initial capacity of 20 as you can see here: <a href=\"https://github.com/alediaferia/stackgo/blob/master/stackgo.go#L21\" rel=\"nofollow noreferrer\">github.com/alediaferia/stackgo/blob/master/stackgo.go#L21</a> Other than that your point makes total sense to me."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1434444868, "post_id": 30855526, "comment_id": 49768076, "body": "NOTE: The problem is bugs in the program giving invalid results. This answer is wrong."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1434470200, "post_id": 30855526, "comment_id": 49786601, "body": "@peterSO alright dude... lol. Sorry I didn&#39;t reference the spec while explaining that giving the array capacity of 20 circumvents at least 5 reallocs. It&#39;s conceptually correct, I don&#39;t touch any technical terms so you should probably try being less of a douche bag."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1434404866, "creation_date": 1434404866, "answer_id": 30855526, "question_id": 30855207, "link": "https://stackoverflow.com/questions/30855207/different-performances-in-go-slices-resize/30855526#30855526", "title": "Different performances in Go slices resize", "body": "<p>I believe your example is faster because you have a fairly small data set and are allocating with an initial capacity of 0. In your version of append you preempt a large amount of allocations by growing the block size more dramatically early (by 20) circumventing the (in this case) expensive reallocs that take you through all those trivially small capacities 0,1,2,4,8,16,32,64 ect</p>\n\n<p>If your data sets were a lot larger this would likely be marginalized by the cost of large copies. I've seen a lot of misuse of slice in Go. The clear performance win is had by making your slice with a reasonable default capacity.</p>\n"}, {"comments": [{"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434449248, "post_id": 30862883, "comment_id": 49770911, "body": "Thank you @peterSO. I&#39;ll review my code asap following your hints and will study your links as well. I&#39;m always happy to learn from more experienced engineers."}, {"owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "edited": false, "score": 0, "creation_date": 1434459560, "post_id": 30862883, "comment_id": 49777961, "body": "I actually changed my implementation here: <a href=\"https://github.com/alediaferia/stackgo/tree/page_based\" rel=\"nofollow noreferrer\">github.com/alediaferia/stackgo/tree/page_based</a>  Your points were all right and it&#39;s probably better to set yours as the right answer. Anyway, would you like to review my new code? I&#39;d really appreciate that. Shall we move to <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a> for this?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1434452023, "last_edit_date": 1495541668, "creation_date": 1434444715, "answer_id": 30862883, "question_id": 30855207, "link": "https://stackoverflow.com/questions/30855207/different-performances-in-go-slices-resize/30862883#30862883", "title": "Different performances in Go slices resize", "body": "<p>Reading your code, tests, benchmarks, and results it's easy to see that they are flawed. A full code review is beyond the scope of StackOverflow.</p>\n\n<p>One specific bug.</p>\n\n<pre><code>// Push pushes a new element to the stack\nfunc (s *Stack) Push(elem interface{}) {\n    if len(s.slice)+1 == cap(s.slice) {\n        slice := make([]interface{}, 0, len(s.slice)+s.blockSize)\n        copy(slice, s.slice)\n        s.slice = slice\n    }\n\n    s.slice = append(s.slice, elem)\n}\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>// Push pushes a new element to the stack\nfunc (s *Stack) Push(elem interface{}) {\n    if len(s.slice)+1 == cap(s.slice) {\n        slice := make([]interface{}, len(s.slice), len(s.slice)+s.blockSize)\n        copy(slice, s.slice)\n        s.slice = slice\n    }\n\n    s.slice = append(s.slice, elem)\n}\n</code></pre>\n\n<blockquote>\n  <p><a href=\"http://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">copying\n  slices</a></p>\n  \n  <p>The function <code>copy</code> copies slice elements from a source <code>src</code> to a\n  destination <code>dst</code> and returns the number of elements copied. The\n  number of elements copied is the minimum of <code>len(src)</code> and <code>len(dst)</code>.</p>\n</blockquote>\n\n<p>You copied <code>0</code>, you should have copied <code>len(s.slice)</code>.</p>\n\n<p>As expected, your Push algorithm is inordinately slow:</p>\n\n<pre><code>append:\n\nBenchmark_PushDefaultStack-4     2000000           941 ns/op          49 B/op          1 allocs/op\n\nalediaferia:\n\nBenchmark_PushDefaultStack-4      100000       1246315 ns/op       42355 B/op          1 allocs/op\n</code></pre>\n\n<p>This how <code>append</code> works: <a href=\"https://stackoverflow.com/questions/15702419/append-complexity\">append complexity</a>.</p>\n\n<p>There are other things wrong too. Your benchmark results are often not valid.</p>\n"}], "owner": {"reputation": 2345, "user_id": 956531, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5bc58919dfd1e89d9d5be71a9c68dd9d?s=128&d=identicon&r=PG", "display_name": "alediaferia", "link": "https://stackoverflow.com/users/956531/alediaferia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 2, "accepted_answer_id": 30862883, "answer_count": 2, "score": 1, "last_activity_date": 1434452023, "creation_date": 1434403495, "last_edit_date": 1495541668, "question_id": 30855207, "link": "https://stackoverflow.com/questions/30855207/different-performances-in-go-slices-resize", "title": "Different performances in Go slices resize", "body": "<p>I'm spending some time experimenting with Go's internals and I ended up writing my own implementation of a <a href=\"https://github.com/alediaferia/stackgo\" rel=\"nofollow noreferrer\">stack</a> using slices.\nAs correctly pointed out by a reddit user in <a href=\"http://www.reddit.com/r/golang/comments/39w6e2/stackgo_a_slicebased_implementation_of_a_simple/\" rel=\"nofollow noreferrer\">this</a> post and as outlined by another user in <a href=\"https://stackoverflow.com/questions/17332227/big-o-of-append-in-golang\">this SO answer</a> Go already tries to optimise slices resize.</p>\n\n<p>Turns out, though, that I rather have performance gains using my own implementation of slice growing rather than sticking with the default one.</p>\n\n<p>This is the structure I use for holding the stack:</p>\n\n<pre><code>type Stack struct {\n    slice []interface{}\n    blockSize int\n}\n\nconst s_DefaultAllocBlockSize = 20;\n</code></pre>\n\n<p>This is <strong>my own</strong> implementation of the <code>Push</code> method</p>\n\n<pre><code>func (s *Stack) Push(elem interface{}) {\n    if len(s.slice) + 1 == cap(s.slice) {\n        slice := make([]interface{}, 0, len(s.slice) + s.blockSize)\n        copy(slice, s.slice)\n        s.slice = slice\n    }\n\n    s.slice = append(s.slice, elem)\n}\n</code></pre>\n\n<p>This is a plain implementation</p>\n\n<pre><code>func (s *Stack) Push(elem interface{}) {\n    s.slice = append(s.slice, elem)\n}\n</code></pre>\n\n<p>Running the benchmarks I've implemented using Go's <a href=\"http://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">testing</a> package my own implementation performs this way:</p>\n\n<pre><code>Benchmark_PushDefaultStack  20000000            87.7 ns/op        24 B/op          1 allocs/op\n</code></pre>\n\n<p>While relying on the plain <code>append</code> the results are the following</p>\n\n<pre><code>Benchmark_PushDefaultStack  10000000           209 ns/op          90 B/op          1 allocs/op\n</code></pre>\n\n<p>The machine I run tests on is an early 2011 Mac Book Pro, 2.3 GHz Intel Core i5 with 8GB of RAM 1333MHz DDR3</p>\n\n<p><strong>EDIT</strong>\nThe actual question is: is my implementation really faster than the default append behavior? Or am I not taking something into account?</p>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1434404094, "post_id": 30855071, "comment_id": 49754145, "body": "Exactly how are you installing Go? If you install from source, don&#39;t set <code>GOROOT</code>."}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434404200, "post_id": 30855071, "comment_id": 49754197, "body": "I&#39;ve tried this with and without GOROOT.    What are some tricks i can use to really inspect the problem?   Why would GOROOT hurt the situation?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434404499, "post_id": 30855071, "comment_id": 49754335, "body": "I don&#39;t know what to troubleshoot, since I don&#39;t know how you got here. If you used the official binary installation, all you do is unpack the tarball, and set the appropriate variables. <i>What steps did you use to install Go?</i>"}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434404864, "post_id": 30855071, "comment_id": 49754508, "body": "yum install golang (fedora packages).  however, shouldn&#39;t there generally be a way you can see where go is looking for packages, to confirm/deny their existence ?  Typically in the java world, we might do something like use System.getProperties to print all the jars on the classpath, and then look through them one by one for packages.  I assume in golang there might be a similar low level way to manually find what packages that are supplied to a program at runtime?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1434405300, "post_id": 30855071, "comment_id": 49754689, "body": "You almost never use <code>GOROOT</code>, because it&#39;s baked in to the compiled <code>go</code> tools, and setting it is <a href=\"http://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"nofollow noreferrer\">almost always a mistake</a>. There&#39;s no &quot;low level&quot; way to look up packages -- there&#39;s only two places to look <code>GOROOT</code> and <code>GOPATH</code>. The Go stdlib sources should be in <code>$GOROOT&#47;src</code>."}, {"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434412330, "post_id": 30855071, "comment_id": 49756752, "body": "Hmmm. okay.  So, then your saying if GOROOT=/usr/lib/golang, and there is nothing under src/ then something is seriously broken with my go installation?  I guess that resolves the issue ... ."}], "answers": [{"comments": [{"owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "edited": false, "score": 0, "creation_date": 1434413263, "post_id": 30856838, "comment_id": 49756998, "body": "Thanks for helping me answer this !  I guess I&#39;ll have to go check out the  packaging of this distro and see why its excluding the  go standard library src/ directory."}], "tags": [], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "is_accepted": false, "score": -1, "last_activity_date": 1434484235, "last_edit_date": 1434484235, "creation_date": 1434412675, "answer_id": 30856838, "question_id": 30855071, "link": "https://stackoverflow.com/questions/30855071/go-unrecognized-imports/30856838#30856838", "title": "Go &quot;unrecognized imports&quot;", "body": "<p><strong>TLDR</strong> </p>\n\n<p>The final solution to my problem was as follows  (this maybe overkill). </p>\n\n<p><code>yum erase golang-src</code> </p>\n\n<p><code>rm -rf /usr/lib/golang/</code></p>\n\n<p><code>yum install golang-src golang</code></p>\n\n<p>After installing golang-src, you should confirm that indeed under GOROOT/src/ there are several packages for all the standard go libs, i.e. the ones listed below.</p>\n\n<p><strong>THE DETAILS OF HOW TO INVESTIGATE GOLANG INSTALLATIONS</strong></p>\n\n<p>Obviously : <code>go get</code> gets and installs the source code you specify.  Most go libraries use the standard libraries, like <code>io</code> or <code>bytes</code> and so on.  Hence, a good test that your go distribution is installed correctly, and that your GOPATH is also set - is to run <code>go get</code>. For example  <code>go get github.com/golang/example/hello</code>  is sufficient to expose a flaw with GOROOT standard libraries.</p>\n\n<p>The first thing to do is to check what GOROOT is out of the box in your isntallation.  It is available by running <code>go env</code>, which will give you all go environment variables.  </p>\n\n<p>In general <strong>GOROOT</strong> should have a <code>src/</code> directory underneath it.  However, if you have a broken go package, then some of these libraries might not be (for some reason) under GOROOT/src. That is, you <strong>SHOULD</strong> see the source directories there for the core go stuff, for example, from a healthy working go installation.</p>\n\n<p><code>\nls /usr/lib/golang/src/\nall.bash          builtin/          compress/         errors/           html/             libbio/           Make.dist         os/               run.bash          strings/          time/\nall.bat           bytes/          ......    net/              regexp/           strconv/          text/\n</code></p>\n\n<p>Now, looking back at <strong>my broken go installation</strong>, it looked very different from what is above ... It looks like I don't have <strong>ANYTHING under /usr/lib/golang/src</strong> .  This basically means that my go package was missing some very important components, and almost any <code>go get ...</code> operation will thus fail, since none of the go standard libraries are in the GOROOT path.</p>\n\n<p>As mentioned above -- <strong>the end solution</strong> here was simply to <code>yum erase golang-src</code>, <code>rm -rf /usr/lib/golang/</code> and then and <code>yum install golang-src golang</code>. </p>\n"}], "owner": {"reputation": 16400, "user_id": 350542, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/024d1da9fad214ca44af8fcc649ebb86?s=128&d=identicon&r=PG", "display_name": "jayunit100", "link": "https://stackoverflow.com/users/350542/jayunit100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1498, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1459895488, "creation_date": 1434402856, "last_edit_date": 1459895488, "question_id": 30855071, "link": "https://stackoverflow.com/questions/30855071/go-unrecognized-imports", "title": "Go &quot;unrecognized imports&quot;", "body": "<p>On fedora 22, I found that all the standard go libraries aren't visible on the path for go.   </p>\n\n<p><strong>NOTE</strong> I have indeed cleaned my system of golang - so I'm pretty sure it's not a mixed package versioning problem  which often can happen when upgrading go.  </p>\n\n<p><strong>NOTE</strong> The version of go I've installed is 1.4.2</p>\n\n<p>I have been setting GOROOT=/usr/lib/golang, and GOPATH=(anything).</p>\n\n<p>What internal directories in /usr/lib/golang should I look into to troubleshoot the missing libraries?  </p>\n\n<p>A simple example of the failures I'm getting are below...</p>\n\n<p><code>[jay@rhbd gopath]$ go get github.com/golang/example/hello\npackage github.com/golang/example/hello\n        imports fmt: unrecognized import path \"fmt\"\npackage github.com/golang/example/hello\n        imports runtime: unrecognized import path \"runtime\"</code></p>\n\n<p>and the corresponding go env:</p>\n\n<p><code>\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/jay/gopath/\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/golang\"\nGOTOOLDIR=\"/usr/lib/golang/pkg/tool/linux_amd64\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></p>\n\n<p>UPDATE</p>\n\n<p>As per the comments in this thread... It looks like I don't have ANYTHING under /usr/lib/golang/src.  Does this basically imply that my Go distribution is broken?  If so maybe the Go binary should fail fast when this is the case... ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1434383658, "post_id": 30849375, "comment_id": 49742839, "body": "It&#39;s possible to stop <i>waiting</i> as you describe, but you can&#39;t kill a goroutine. You&#39;d have to make your func check for a quit signal (or, if it&#39;s doing network calls, set a read/write timeout) if you actually want the func to stop."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1434395763, "post_id": 30849375, "comment_id": 49749809, "body": "Unrelated to your question: don&#39;t re-seed the PRNG. Seeding is normally only done <b>once</b> (unless you explicitly want/need to restart a sequence of random numbers from some other seed). In particular, since you&#39;ve chosen to use <code>time.Now().Unix()</code> your &quot;random&quot; function will <b>always</b> return <b>the exact same value</b> until your clock ticks over to a new second! (I&#39;d just use <code>func init() { rand.Seed(time.Now().UnixNano()) }</code> in the main package or put that line in <code>main</code> itself)."}], "answers": [{"comments": [{"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1434383927, "post_id": 30849713, "comment_id": 49743048, "body": "Does that <b>really</b> guarantee the timer will immediately stop ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 3, "creation_date": 1434384280, "post_id": 30849713, "comment_id": 49743282, "body": "@DenysS&#233;guret: it guarantees that <code>measureTime</code> will immediately stop. You can&#39;t stop <code>funcWithUnpredictiveExecutionTime</code>. It&#39;s blocking without a cancellation api of any sort, so it has to run to completion."}, {"owner": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1434384336, "post_id": 30849713, "comment_id": 49743314, "body": "Are you sure there&#39;s this guarantee when <code>funcWithUnpredictiveExecutionTime</code> doesn&#39;t realease the CPU ? Can you demonstrate it in the playground ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 1, "creation_date": 1434384589, "post_id": 30849713, "comment_id": 49743480, "body": "@DenysS&#233;guret: Go does have a mostly preemptive scheduler with <code>GOMAXPROCS &gt; 1</code>. However, if you run more function-with-busy-loops than you have threads, then it will cause problems. That&#39;s more of an implementation detail however, depending on the scheduler."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1434385205, "post_id": 30849713, "comment_id": 49743900, "body": "@DenysS&#233;guret -- this should do what JimB claims (<a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">the spec for <code>select</code> might help show why</a>). If you&#39;re convinced it won&#39;t, you can build a program to show it. Otherwise, the asker will probably try it and sort it out that way."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 332764, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1434385351, "post_id": 30849713, "comment_id": 49743998, "body": "@DenysS&#233;guret: Worst case scenario: <a href=\"http://play.golang.org/p/va5l5_tDqN\" rel=\"nofollow noreferrer\">play.golang.org/p/va5l5_tDqN</a>. You will want to run it locally with <code>GOMAXPROCS &gt;= 3</code>. You may also need to adjust the <code>for</code> loop to get a reasonable completion time."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1434383883, "creation_date": 1434383883, "answer_id": 30849713, "question_id": 30849375, "link": "https://stackoverflow.com/questions/30849375/measure-execution-time-and-stop-waiting-if-too-long-in-golang/30849713#30849713", "title": "measure execution time and stop waiting if too long in golang", "body": "<p>You can't cancel a goroutine, unless you design it to be canceled. You can short circuit your timing function, by using a channel to signal the completion of the function being timed:</p>\n\n<pre><code>func measureTime(expectedMs float64) (ok bool) {\n    done := make(chan struct{})\n    t1 := time.Now()\n\n    go func() {\n        funcWithUnpredictiveExecutionTime()\n        close(done)\n    }()\n\n    select {\n    case &lt;-done:\n        ok = true\n    case &lt;-time.After(time.Duration(expectedMs) * time.Millisecond):\n    }\n\n    fmt.Println(time.Since(t1))\n    return ok\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1434397549, "last_edit_date": 1434397549, "creation_date": 1434385157, "answer_id": 30850109, "question_id": 30849375, "link": "https://stackoverflow.com/questions/30849375/measure-execution-time-and-stop-waiting-if-too-long-in-golang/30850109#30850109", "title": "measure execution time and stop waiting if too long in golang", "body": "<p>Extending JimB's example a little with the design I've personally followed for async background workers. I would say in most cases it's unacceptable to launch a go routine without passing an abort channel... All of your async methods should accept one as an argument or have one defined on their receiving type so you can actually control execution. fyi there are libraries for this, here's a simple one an old colleague of mine made; <a href=\"https://github.com/lytics/squaredance\" rel=\"nofollow\">https://github.com/lytics/squaredance</a></p>\n\n<p>If your program does not have an abort path for every goroutine you're probably going to face significant quality issues sooner or later. Also, for applications that are doing any heavy lifting in a goroutine, you will likely not be able to gracefully stop and start your application.</p>\n\n<pre><code>func measureTime(expectedMs float64) (ok bool) {\n    done := make(chan struct{})\n    abort := make(chan struct{})\n    t1 := time.Now()\n\n    go func() {\n        funcWithUnpredictiveExecutionTime(abort)\n        close(done)\n    }()\n\n    select {\n    case &lt;-done:\n        ok = true\n    case &lt;-time.After(time.Duration(expectedMs) * time.Millisecond):\n        // after signals here when the duration is reached so I close abort\n        close(abort)\n    }\n\n    fmt.Println(time.Since(t1))\n    return ok\n\n}\n\n\nfuncWithUnpredictiveExecutionTime(abort) {\n     for {\n        select {\n           // doing work in here\n           case abort:\n              // except here, we clean up and return\n        }\n     }\n}\n</code></pre>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5594, "favorite_count": 1, "accepted_answer_id": 30849713, "answer_count": 2, "score": 2, "last_activity_date": 1434397549, "creation_date": 1434382928, "question_id": 30849375, "link": "https://stackoverflow.com/questions/30849375/measure-execution-time-and-stop-waiting-if-too-long-in-golang", "title": "measure execution time and stop waiting if too long in golang", "body": "<p>I am trying to measure execution time of <code>funcWithUnpredictiveExecutionTime</code> function. </p>\n\n<pre><code>func measureTime(expectedMs float64) (ok bool) {\n    t1 := time.Now()\n    funcWithUnpredictiveExecutionTime()\n    t2 := time.Now()\n    diff := t2.Sub(t1)\n</code></pre>\n\n<p>The measuring is fine when  <code>funcWithUnpredictiveExecutionTime</code> works faster than I expected. But if it works slower than <code>expectedMs</code>  the measuring will not stop right after expected amount of milliseconds passed. </p>\n\n<p>Is it possible to stop time measuring when <code>funcWithUnpredictiveExecutionTime</code> works longer than <code>expectedMs</code> without waiting <code>funcWithUnpredictiveExecutionTime</code> to finish?</p>\n\n<p>In other words, <code>measureTime(200)</code> should return in <code>200 ms</code> anyway with a good or bad result.</p>\n\n<p>I guess I should use channels and then somehow cancel waiting for a channel. But how to do it exactly?</p>\n\n<p>Full code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n// random number between min and max\nfunc random(min, max int) int {\n    rand.Seed(time.Now().Unix())\n    return rand.Intn(max-min) + min\n}\n\n// sleeps for a random milliseconds amount between 200 and 1000\nfunc funcWithUnpredictiveExecutionTime() {\n    millisToSleep := random(200, 1000)\n    fmt.Println(fmt.Sprintf(\"Sleeping for %d milliseconds\", millisToSleep))\n    time.Sleep(time.Millisecond * time.Duration(millisToSleep))\n}\n\n// measures execution time of a function funcWithUnpredictiveExecutionTime\n// if expectedMs &lt; actual execution time, it's ok.\n// if expectedMs milliseconds passed and funcWithUnpredictiveExecutionTime\n// still did not finish execution it should return\n// without waiting for funcWithUnpredictiveExecutionTime\nfunc measureTime(expectedMs float64) (ok bool) {\n    t1 := time.Now()\n    funcWithUnpredictiveExecutionTime()\n    t2 := time.Now()\n    diff := t2.Sub(t1)\n    actualMs := diff.Seconds() * 1000\n    ok = actualMs &lt; expectedMs\n    fmt.Println(actualMs)\n    return\n}\n\n// prints results: Ok or too late\nfunc printTimeResults(ok bool) {\n    if ok {\n        fmt.Println(\"Ok\")\n    } else {\n        fmt.Println(\"Too late\")\n    }\n}\n\nfunc main() {\n    printTimeResults(measureTime(200))  // expect it to finish in 200 ms anyway\n    printTimeResults(measureTime(1000)) // expect it to finish in 1000 ms anyway\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Sleeping for 422 milliseconds\n424.11895200000004\nToo late\nSleeping for 422 milliseconds\n425.27274900000003\nOk\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/YP6GxoiSbg\" rel=\"nofollow\">Playground</a></p>\n"}, {"tags": ["performance", "go", "hashmap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434382387, "post_id": 30849122, "comment_id": 49741968, "body": "I would factor out the deeply nested statements, if only for readability. If you&#39;re worried about performance, <i>benchmark</i>. (What do interfaces have to do with this?)"}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434382464, "post_id": 30849122, "comment_id": 49742024, "body": "oh, I messed up two thoughts, the interface idea was about other things that I am doing with this code, apologies."}], "answers": [{"tags": [], "owner": {"reputation": 24278, "user_id": 6013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/2c21bed614c58c9e1c48fe272e79efd2?s=128&d=identicon&r=PG", "display_name": "Joshua", "link": "https://stackoverflow.com/users/6013/joshua"}, "is_accepted": true, "score": 1, "last_activity_date": 1434383241, "creation_date": 1434383241, "answer_id": 30849486, "question_id": 30849122, "link": "https://stackoverflow.com/questions/30849122/how-to-make-this-code-more-performant/30849486#30849486", "title": "How to make this code more performant?", "body": "<p>You don't need the outer loop as one improvement:</p>\n\n<pre><code>func getFields(filter map[string]map[string]bool, msg *Message) (fs []Field) {\n  if fieldFilter, ok := filter[relationString(msg)]; ok {\n    for _, f := range msg.Fields {\n        if _, ok := fieldFilter[f.Name]; ok {\n            fs = append(fs, f)\n        }\n      }\n    }\n  }\n\n  return\n}\n</code></pre>\n"}], "owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 30849486, "answer_count": 1, "score": -2, "last_activity_date": 1434383241, "creation_date": 1434382224, "question_id": 30849122, "link": "https://stackoverflow.com/questions/30849122/how-to-make-this-code-more-performant", "title": "How to make this code more performant?", "body": "<p>I have this snippet of code that iterate over a map and filter some fields based on relation type, I have to run two loops and have a feeling that it is going to be slow for big maps. Is there any way I can technique/refactoring to make this code more performant.</p>\n\n<pre><code>func getFields(filter map[string]map[string]bool, msg *Message) (fs []Field) {\n\n    for k, _ := range filter {\n        if relationString(msg) == k {\n            if fieldFilter, ok := filter[k]; ok {\n                for _, f := range msg.Fields {\n                    if _, ok := fieldFilter[f.Name]; ok {\n                        fs = append(fs, f)\n                    }\n                }\n            }\n        }\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1434376095, "post_id": 30846599, "comment_id": 49737285, "body": "Doesn&#39;t answer the question, but since the whole point of that wrapper is to negate this issue, why not just use the wrapper for both platforms?"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 9, "last_activity_date": 1434376362, "last_edit_date": 1434376362, "creation_date": 1434375867, "answer_id": 30846793, "question_id": 30846599, "link": "https://stackoverflow.com/questions/30846599/does-exist-on-go-something-like-macros-in-c-like-ifdef-so-i-can-choose-what-t/30846793#30846793", "title": "Does exist on Go something like macros in C++ like #ifdef so I can choose what to build based on flag?", "body": "<p>This is what <a href=\"http://golang.org/pkg/go/build/#hdr-Build_Constraints\">build tags</a> are for:</p>\n\n<blockquote>\n  <p>A build constraint, also known as a build tag, is a line comment that begins</p>\n\n<pre><code>// +build\n</code></pre>\n  \n  <p>that lists the conditions under which a file should be included in the package. Constraints may appear in any kind of source file (not just Go), but they must appear near the top of the file, preceded only by blank lines and other line comments. These rules mean that in Go files a build constraint must appear before the package clause.</p>\n</blockquote>\n\n<p>Another way to distinguish OS/arch at runtime is to use runtime's <a href=\"http://golang.org/pkg/runtime/#pkg-constants\">GOOS and GOARCH constants</a>:</p>\n\n<blockquote>\n  <p>GOARCH is the running program's architecture target: 386, amd64, or arm.</p>\n  \n  <p>GOOS is the running program's operating system target: one of darwin, freebsd, linux, and so on. </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1286, "user_id": 1071090, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vdLa6.jpg?s=128&g=1", "display_name": "Peter Hommel", "link": "https://stackoverflow.com/users/1071090/peter-hommel"}, "is_accepted": false, "score": 6, "last_activity_date": 1434377860, "last_edit_date": 1434377860, "creation_date": 1434375929, "answer_id": 30846819, "question_id": 30846599, "link": "https://stackoverflow.com/questions/30846599/does-exist-on-go-something-like-macros-in-c-like-ifdef-so-i-can-choose-what-t/30846819#30846819", "title": "Does exist on Go something like macros in C++ like #ifdef so I can choose what to build based on flag?", "body": "<p>You can work with <strong>build tags</strong> as described <a href=\"http://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"noreferrer\">here</a>.</p>\n\n<p>In a nutshell, insert a comment like</p>\n\n<pre><code>// +build linux\n</code></pre>\n\n<p>at the top of your file and this file will only build on linux.\nAccordingly</p>\n\n<pre><code>// +build windows\n</code></pre>\n\n<p>will only build the file on windows.</p>\n\n<p><strong>Be sure to put a blank line</strong> after the afforementioned comment. Read <a href=\"http://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"noreferrer\">this</a> for reference.</p>\n"}], "owner": {"reputation": 93, "user_id": 5011492, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206978012152158/picture?type=large", "display_name": "Black Obama", "link": "https://stackoverflow.com/users/5011492/black-obama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2532, "favorite_count": 2, "accepted_answer_id": 30846793, "answer_count": 2, "score": 7, "last_activity_date": 1434377860, "creation_date": 1434375347, "question_id": 30846599, "link": "https://stackoverflow.com/questions/30846599/does-exist-on-go-something-like-macros-in-c-like-ifdef-so-i-can-choose-what-t", "title": "Does exist on Go something like macros in C++ like #ifdef so I can choose what to build based on flag?", "body": "<p>I need to build in go for linux and windows with different packages same file\non windows I need to <code>import github.com/hashicorp/go-syslog</code> and on linux <code>import log/syslog</code></p>\n\n<p>and inside code in file I have to use <code>syslog.ALERT</code> or <code>gsyslog.ALERT</code> depending on os. Does exist on <code>Go</code> something like macros in <code>C++</code> like <code>#ifdef</code> so I can choose what to build based on flag ? How to achieve this without, same file to have different content for build based on OS ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 5, "creation_date": 1434374964, "post_id": 30846347, "comment_id": 49736421, "body": "You cannot build a single binary that runs on both Mac and Linux, if that is what you mean. They use different binary formats, Mach-O and ELF."}], "answers": [{"tags": [], "owner": {"reputation": 1101, "user_id": 757102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb12c55b318f541cb55c7eeb6bec8f?s=128&d=identicon&r=PG", "display_name": "Colin Nicholson", "link": "https://stackoverflow.com/users/757102/colin-nicholson"}, "is_accepted": true, "score": 7, "last_activity_date": 1438176442, "last_edit_date": 1438176442, "creation_date": 1434380677, "answer_id": 30848582, "question_id": 30846347, "link": "https://stackoverflow.com/questions/30846347/build-a-go-binary-for-both-linux-and-mac/30848582#30848582", "title": "Build a go binary for both Linux and Mac", "body": "<p>To build binaries for different platforms, I use <a href=\"https://github.com/mitchellh/gox\" rel=\"noreferrer\">GOX</a></p>\n\n<blockquote>\n  <p>Gox is a simple, no-frills tool for Go cross compilation that behaves\n  a lot like standard go build. Gox will parallelize builds for multiple\n  platforms. Gox will also build the cross-compilation toolchain for\n  you.</p>\n</blockquote>\n\n<p>You tell it which platforms you want to target, and one command will build a separate binary for each of them. One binary cannot target multiple systems though.</p>\n\n<p>To build for OSX (64 bit) and Linux (32 and 64 bit), you could use:</p>\n\n<pre><code>gox -osarch=\"darwin/amd64 linux/386 linux/amd64\"\n</code></pre>\n"}], "owner": {"reputation": 18043, "user_id": 405013, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ef3cd04888c6d17f34d43e29ec3d46f?s=128&d=identicon&r=PG", "display_name": "caarlos0", "link": "https://stackoverflow.com/users/405013/caarlos0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3742, "favorite_count": 3, "closed_date": 1434555914, "accepted_answer_id": 30848582, "answer_count": 1, "score": 1, "last_activity_date": 1438176442, "creation_date": 1434374607, "question_id": 30846347, "link": "https://stackoverflow.com/questions/30846347/build-a-go-binary-for-both-linux-and-mac", "closed_reason": "Duplicate", "title": "Build a go binary for both Linux and Mac", "body": "<p>How can I <code>go build</code> a project in a way that it works for both Mac and Linux (x86 and x64)? Is that even possible?</p>\n\n<p>I searched and found some stuff, but cannot make them work (or maybe I just didn't understood them).</p>\n"}, {"tags": ["mysql", "go", "gorp"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 2, "creation_date": 1434365827, "post_id": 30843058, "comment_id": 49730132, "body": "One question per question. -1"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434369650, "post_id": 30843058, "comment_id": 49732593, "body": "What is the error with your <code>ORDER</code> query?"}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434454112, "post_id": 30843058, "comment_id": 49774007, "body": "@elithrar please see below query samples in comments of second answer."}], "answers": [{"comments": [{"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434366322, "post_id": 30843434, "comment_id": 49730441, "body": "Hello OndraTom,  there doesnt seem to be a escape string function for Go... not that I can find. Its actually a ORDER issue (not limit)"}, {"owner": {"reputation": 72, "user_id": 4791495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fff24f70d1fc0906ae154d59d00ced?s=128&d=identicon&r=PG&f=1", "display_name": "OndraTom", "link": "https://stackoverflow.com/users/4791495/ondratom"}, "reply_to_user": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434366565, "post_id": 30843434, "comment_id": 49730603, "body": "Check the article. There are tips how to prevent SQL injection in GO language :)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1434369295, "post_id": 30843434, "comment_id": 49732346, "body": "Note that escaping strings in PHP is also not the safe way to handle SQL queries. You should be using PHP&#39;s <code>mysqli</code> package where possible and writing parameterised queries."}, {"owner": {"reputation": 72, "user_id": 4791495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fff24f70d1fc0906ae154d59d00ced?s=128&d=identicon&r=PG&f=1", "display_name": "OndraTom", "link": "https://stackoverflow.com/users/4791495/ondratom"}, "edited": false, "score": 0, "creation_date": 1434370693, "post_id": 30843434, "comment_id": 49733369, "body": "You can write parameterised queries without mysqli package or PDO."}, {"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1434375451, "post_id": 30843434, "comment_id": 49736774, "body": "@OndraTom The <code>mysql</code> extension does not support bound parameters, so you cannot write them without <code>mysqli</code> or <code>PDO</code>."}, {"owner": {"reputation": 72, "user_id": 4791495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fff24f70d1fc0906ae154d59d00ced?s=128&d=identicon&r=PG&f=1", "display_name": "OndraTom", "link": "https://stackoverflow.com/users/4791495/ondratom"}, "reply_to_user": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 0, "creation_date": 1434376852, "post_id": 30843434, "comment_id": 49737864, "body": "@Jeremiah Winsley ok, I admit it. mysql library is depracated and you should use mysqli or PDO. But for example, you can combinate mysql_real_escape_string with sprintf and bound it in this way. I just wanted to help and hit the basic points :)."}, {"owner": {"reputation": 2484, "user_id": 3794472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZTwGs.jpg?s=128&g=1", "display_name": "Jeremiah Winsley", "link": "https://stackoverflow.com/users/3794472/jeremiah-winsley"}, "edited": false, "score": 1, "creation_date": 1434379671, "post_id": 30843434, "comment_id": 49739954, "body": "That&#39;s not what bound parameters are. That&#39;s just fancy string concatenation. Bound parameters are actually sent separately from the statement."}], "tags": [], "owner": {"reputation": 72, "user_id": 4791495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89fff24f70d1fc0906ae154d59d00ced?s=128&d=identicon&r=PG&f=1", "display_name": "OndraTom", "link": "https://stackoverflow.com/users/4791495/ondratom"}, "is_accepted": false, "score": -2, "last_activity_date": 1434367113, "last_edit_date": 1434367113, "creation_date": 1434365864, "answer_id": 30843434, "question_id": 30843058, "link": "https://stackoverflow.com/questions/30843058/prevent-sql-injection/30843434#30843434", "title": "Prevent SQL injection", "body": "<p>I don't know Go language. But most of languages have function for escaping strings (PHP example: <a href=\"http://php.net/manual/en/function.mysql-real-escape-string.php\" rel=\"nofollow\">http://php.net/manual/en/function.mysql-real-escape-string.php</a>). If you're inserting only integers to your query, you only need to convert values from string to int.</p>\n\n<p>Check this out: <a href=\"http://astaxie.gitbooks.io/build-web-application-with-golang/content/en/09.4.html\" rel=\"nofollow\">http://astaxie.gitbooks.io/build-web-application-with-golang/content/en/09.4.html</a> maybe you'll find some answers.</p>\n\n<p>And about your ORDER - can you put here complete sql query that you're calling?</p>\n"}, {"comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434394844, "post_id": 30844522, "comment_id": 49749285, "body": "I&#39;d like to highlight that the parameter placehoder syntax is specific to the driver being used. For MySQL (as this question is tagged) it&#39;d be <code>\u2026 id=? AND active=?</code> rather than <code>\u2026 id=$1 AND active=$2</code>. The <a href=\"http://go-database-sql.org/prepared.html#parameter-placeholder-syntax\" rel=\"nofollow noreferrer\">tutorial linked to in this answer has a small section about this</a>."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434403218, "post_id": 30844522, "comment_id": 49753736, "body": "Good catch\u2014corrected. Too used to Postgres placeholders!"}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434449015, "post_id": 30844522, "comment_id": 49770768, "body": "Folks many thanks for your help... I rewritten query to use parameterised queries however unfortunately the error remains...  I am unable to ORDER BY using dynamic fields"}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434449088, "post_id": 30844522, "comment_id": 49770813, "body": "<b>DOES NOT WORK::</b>      <code>rows, err := db.Query(&quot;SELECT Apps.*, GROUP_CONCAT(DISTINCT IFNULL(AppCategoryMatches.category_id,&#39;-1&#39;) SEPARATOR &#39;,&#39;) as temp, GROUP_CONCAT(DISTINCT IFNULL(AppCategories.category_name,&#39;-1&#39;) SEPARATOR &#39;,&#39;) as tmp_name FROM Apps LEFT JOIN AppCategoryMatches ON AppCategoryMatches.app_id=Apps.id LEFT JOIN AppCategories ON (AppCategoryMatches.category_id = AppCategories.id) GROUP BY Apps.id ORDER BY ? DESC LIMIT 1&quot;, &quot;Apps.title&quot;)</code>"}, {"owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "edited": false, "score": 0, "creation_date": 1434449273, "post_id": 30844522, "comment_id": 49770923, "body": "<b>BELOW WORKS:</b>     <code>rows, err := db.Query(&quot;SELECT Apps.*, GROUP_CONCAT(DISTINCT IFNULL(AppCategoryMatches.category_id,&#39;-1&#39;) SEPARATOR &#39;,&#39;) as temp, GROUP_CONCAT(DISTINCT IFNULL(AppCategories.category_name,&#39;-1&#39;) SEPARATOR &#39;,&#39;) as tmp_name FROM Apps LEFT JOIN AppCategoryMatches ON AppCategoryMatches.app_id=Apps.id LEFT JOIN AppCategories ON (AppCategoryMatches.category_id = AppCategories.id) GROUP BY Apps.id ORDER BY Apps.title DESC LIMIT 1&quot;)</code>"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 6, "last_activity_date": 1434403199, "last_edit_date": 1434403199, "creation_date": 1434369172, "answer_id": 30844522, "question_id": 30843058, "link": "https://stackoverflow.com/questions/30843058/prevent-sql-injection/30844522#30844522", "title": "Prevent SQL injection", "body": "<p>You absolutely don't want to be \"escaping\" any strings on your own, nor concatenating strings to make queries.</p>\n\n<ol>\n<li><p>Go's <code>database/sql</code> (<a href=\"http://golang.org/pkg/database/sql/\" rel=\"nofollow\">http://golang.org/pkg/database/sql/</a>) package supports <a href=\"http://blog.codinghorror.com/give-me-parameterized-sql-or-give-me-death/\" rel=\"nofollow\">parameterised queries</a> by default - e.g. <code>db.Query(\"SELECT * FROM users WHERE id=? AND active=?\", id, userStatus)</code> - where <code>?</code> acts as a placeholder for mySQL to handle your variables.</p></li>\n<li><p>You can (in combination with parameterised queries) use a query builder like <a href=\"https://github.com/mgutz/dat#use-builders-or-sql\" rel=\"nofollow\">mgutz/dat</a> that can help if you're not great at writing raw SQL. A package like that or <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">sqlx</a> also helps pack/unpack queries to/from structs or maps in your application.</p></li>\n</ol>\n\n<p>There's also a great guide <a href=\"http://go-database-sql.org/index.html\" rel=\"nofollow\">in this tutorial</a> for using Go's database package. I highly suggest reading it.</p>\n"}], "owner": {"reputation": 261, "user_id": 2636324, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/639550655/picture?type=large", "display_name": "Aaron Kenny", "link": "https://stackoverflow.com/users/2636324/aaron-kenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1434403199, "creation_date": 1434364679, "last_edit_date": 1434370302, "question_id": 30843058, "link": "https://stackoverflow.com/questions/30843058/prevent-sql-injection", "title": "Prevent SQL injection", "body": "<p>Question 1:</p>\n\n<p>I have the below MySQL query which works fine but I've just discovered this is not a safe approach as its open to SQL injection. As you can see the where clause is an issue if I wanted to pass as an argument.</p>\n\n<pre><code>_, err := dbmap.Select(&amp;response.AppsData, \"SELECT...\", ?)\n</code></pre>\n\n<p>Any advice much appriciated.</p>\n\n<pre><code>where := \"\"\n\nfor i := 0; i &lt; (len(acl_user_apps)); i++ {\n    fmt.Println(acl_user_apps[i].AppId)\n    fmt.Println(acl_user_apps[i].Permissions)\n\n    if where == \"\" {\n        where = \"WHERE Apps.id=\" + strconv.Itoa(acl_user_apps[i].AppId)\n    } else {\n        where = where + \" OR Apps.id=\" + strconv.Itoa(acl_user_apps[i].AppId)\n    }\n}\n\nquery := \"SELECT Apps.*, GROUP_CONCAT(DISTINCT IFNULL(AppCategoryMatches.category_id,'-1') SEPARATOR ',') as temp,   GROUP_CONCAT(DISTINCT IFNULL(AppCategories.category_name,'-1') SEPARATOR ',') as tmp_name FROM Apps LEFT JOIN AppCategoryMatches ON AppCategoryMatches.app_id=Apps.id LEFT JOIN AppCategories ON (AppCategoryMatches.`category_id` = AppCategories.id) \" + where + \" GROUP BY Apps.id ORDER BY \" + sort_by + \" \" + order_by + \" LIMIT \" + limit + \" OFFSET \" + offset)\n_, err := dbmap.Select(&amp;response.AppsData,query)\n</code></pre>\n\n<p>Question 2: Also just wondering if anyone has ever had issues passing ORDER argument...</p>\n\n<pre><code>_, err := dbmap.Select(&amp;response.AppsData,\n        \"SELECT Apps.*, GROUP_CONCAT(DISTINCT IFNULL(AppCategoryMatches.category_id,'-1') SEPARATOR ',') as temp, GROUP_CONCAT(DISTINCT IFNULL(AppCategories.category_name,'-1') SEPARATOR ',') as tmp_name FROM Apps LEFT JOIN AppCategoryMatches ON AppCategoryMatches.app_id=Apps.id LEFT JOIN AppCategories ON (AppCategoryMatches.category_id = AppCategories.id) GROUP BY Apps.id ORDER BY ?\", \"title\")\n</code></pre>\n\n<p>This ORDER is the simplest thing ever... why isnt it working?</p>\n"}, {"tags": ["algorithm", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 0, "creation_date": 1434359081, "post_id": 30841148, "comment_id": 49726178, "body": "Isn&#39;t this better asked on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>?"}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434359235, "post_id": 30841148, "comment_id": 49726276, "body": "@Tichodroma I am not sure the problem is with a code (I am not asking people to review my code), may be I am just using the wrong algorithm. Also the problem with code review is that there is not a lot of people there and it is hard to find people knowledgable in go there."}, {"owner": {"reputation": 1502, "user_id": 1014587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/990x8.jpg?s=128&g=1", "display_name": "Mast", "link": "https://stackoverflow.com/users/1014587/mast"}, "edited": false, "score": 0, "creation_date": 1434359391, "post_id": 30841148, "comment_id": 49726359, "body": "The code looks too examplish to be re-viewable, which would make it off-topic for CodeReview. Questions about which algorithm to use should not be posted there."}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1434359705, "post_id": 30841148, "comment_id": 49726532, "body": "As each value in the matrix can go up to 10^9, your solution can encounter a number overflow problem, which can effect the running time."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1434360126, "post_id": 30841148, "comment_id": 49726812, "body": "@PhamTrung on my 64 bit machine int can hold the values int64 can hold and I can not see an overflow because 1000^2 * 10^9 can still hold in int64. I also tried the solution with int64 just in case (with no success)."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1434360152, "post_id": 30841148, "comment_id": 49726828, "body": "A* would be faster than Dijkstra&#39;s if you have an admissible heuristic - can you think of one in this case?"}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "edited": false, "score": 0, "creation_date": 1434360820, "post_id": 30841148, "comment_id": 49727230, "body": "Look like your implementation has problem, I just made a submission using Java, and it got accepted on Hackerrank."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "edited": false, "score": 0, "creation_date": 1434361121, "post_id": 30841148, "comment_id": 49727431, "body": "Try the Go profiler. It draws you a nice picture with boxes sized according to time usage."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 1, "creation_date": 1434361190, "post_id": 30841148, "comment_id": 49727490, "body": "@MichaelFoukarakis ah, I forgot that A* is optimal with admissible and consistent heuristics. And the heuristics here is closeness to the final square (which can be calculated as taxicab distance. Thanks"}, {"owner": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 0, "creation_date": 1434362249, "post_id": 30841148, "comment_id": 49728124, "body": "@SalvadorDali Taxicab distance doesn&#39;t look like an admissible heuristic here. I can&#39;t see anything preventing a 0 or negative element in the matrix."}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434361393, "post_id": 30841715, "comment_id": 49727619, "body": "thanks for telling me this. Now the question is with what I am doing wrong. I highly doubt it has something to do with overflow (my test on 700x700 matrix with values from 1 to 100 takes approximately 10 seconds). Ps, I can not see your solution (HR is hiding it) but it is not important as long as I know that it passes all tests within 1 second."}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434363426, "post_id": 30841715, "comment_id": 49728782, "body": "@SalvadorDali I think there is a fault in your implementation, look at my update :)"}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434364477, "post_id": 30841715, "comment_id": 49729373, "body": "you are totally correct. Thank you and it was so sad to see that I made such a mistake. Would you mind telling me how much time it took you to pass tests 5 and 6?"}, {"owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434364612, "post_id": 30841715, "comment_id": 49729454, "body": "@SalvadorDali it was 0.86s for test 5 and 0.85s for test 6"}], "tags": [], "owner": {"reputation": 10774, "user_id": 2741705, "user_type": "registered", "profile_image": "https://graph.facebook.com/1478197909/picture?type=large", "display_name": "Pham Trung", "link": "https://stackoverflow.com/users/2741705/pham-trung"}, "is_accepted": true, "score": 4, "last_activity_date": 1434364667, "last_edit_date": 1434364667, "creation_date": 1434360551, "answer_id": 30841715, "question_id": 30841148, "link": "https://stackoverflow.com/questions/30841148/find-the-shortest-path-sum-in-a-matrix-is-dijkstra-not-optimal-for-this-case/30841715#30841715", "title": "Find the shortest path sum in a matrix. Is Dijkstra not optimal for this case?", "body": "<p>Dijkstra should pass, I just make a submission using JAVA, and it took less than a second to complete each task.</p>\n\n<p>As I have mentioned, each value in the matrix can go up to 10^9, your solution can encounter a number overflow problem, which can effect the running time.</p>\n\n<p>My code:</p>\n\n<pre><code>&lt;!-- language:java --&gt;\n\nstatic int[]X = {0,1,0,-1};\nstatic int[]Y = {1,0,-1,0};\npublic static void main(String[] args) throws FileNotFoundException {\n    // PrintWriter out = new PrintWriter(new FileOutputStream(new File(\n    // \"output.txt\")));\n    PrintWriter out = new PrintWriter(System.out);\n    Scanner in = new Scanner();        \n    int n = in.nextInt();\n    long[][]map = new long[n][n];\n    for(int i = 0; i &lt; n; i++){\n        for(int j = 0; j &lt; n; j++){\n            map[i][j] = in.nextLong();\n        }\n    }\n    PriorityQueue&lt;Pos&gt; q= new PriorityQueue();\n    long[][]dist = new long[n][n];\n    for(long[]a : dist){\n        Arrays.fill(a,Long.MAX_VALUE);\n    }\n    q.add(new Pos(0,0,map[0][0]));\n    dist[0][0] = map[0][0];\n    while(!q.isEmpty()){\n        Pos p = q.poll();\n        if(dist[p.x][p.y] == p.cost){\n            for(int i = 0; i &lt; 4; i++){\n                int x = p.x + X[i];\n                int y = p.y + Y[i];\n                if(x &gt;= 0 &amp;&amp; y &gt;= 0 &amp;&amp; x &lt; n &amp;&amp; y &lt; n &amp;&amp; dist[x][y] &gt; dist[p.x][p.y] + map[x][y] ){\n                    dist[x][y] = dist[p.x][p.y] + map[x][y];\n                    q.add(new Pos(x,y,dist[x][y]));\n                }\n            }\n        }\n    }\n    out.println(dist[n - 1][n - 1]);\n    out.close();\n}\n\nstatic class Pos implements Comparable&lt;Pos&gt;{\n    int x, y;\n    long cost;\n    public Pos(int x, int y, long cost) {\n        super();\n        this.x = x;\n        this.y = y;\n        this.cost = cost;\n    }\n    @Override\n    public int compareTo(Pos o) {\n        // TODO Auto-generated method stub\n        return Long.compare(cost, o.cost );\n    }\n}\n</code></pre>\n\n<p><strong>Update</strong>:</p>\n\n<p>I think your Dijkstra implementation is not correct:</p>\n\n<pre><code>for frontier.Len() &gt; 0 {\n    element := heap.Pop(&amp;frontier).(*Item)\n    vertex, cost := element.value, element.priority\n    //You didn't check for visited vertex here!\n    visited[vertex] = true\n    neighbors := graph[vertex]\n    for vertex_new, cost_new := range(neighbors){\n        if !visited[vertex_new]{//You can add same vertex multiple times here!\n            if vertex_new == end{\n                return cost + cost_new\n            }\n            heap.Push(&amp;frontier, &amp;Item{\n                value: vertex_new,\n                priority: cost + cost_new,\n            })\n        }\n    }\n}\n</code></pre>\n\n<p>In your implementation, you only update <code>visited</code> when the vertex pop out of the heap, thus, one vertex can be added and processed multiple time, so, it will significantly increase your time complexity.</p>\n\n<p>To fix</p>\n\n<pre><code>for frontier.Len() &gt; 0 {\n    element := heap.Pop(&amp;frontier).(*Item)\n    vertex, cost := element.value, element.priority\n    if !visited[vertex]{\n        visited[vertex] = true\n        neighbors := graph[vertex]\n        for vertex_new, cost_new := range(neighbors){\n            if !visited[vertex_new]{\n                if vertex_new == end{\n                   return cost + cost_new\n                }\n                heap.Push(&amp;frontier, &amp;Item{\n                   value: vertex_new,\n                   priority: cost + cost_new,\n                })\n            }\n        }   \n    }\n</code></pre>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1879, "favorite_count": 0, "accepted_answer_id": 30841715, "answer_count": 1, "score": 3, "last_activity_date": 1434364667, "creation_date": 1434358826, "question_id": 30841148, "link": "https://stackoverflow.com/questions/30841148/find-the-shortest-path-sum-in-a-matrix-is-dijkstra-not-optimal-for-this-case", "title": "Find the shortest path sum in a matrix. Is Dijkstra not optimal for this case?", "body": "<p>I am trying to solve <a href=\"https://projecteuler.net/problem=83\" rel=\"nofollow\">the following problem from project euler</a> (please take a look at description and the example in the link, but here is the short explanation).</p>\n\n<blockquote>\n  <p>in the matrix, find the  minimal path sum from the top left to the bottom right, by moving left, right, up, and down</p>\n</blockquote>\n\n<p>Right after I looked at the problem, the obvious solution which came to mind is to create a graph from the matrix and then use <a href=\"https://en.wikipedia.org/?title=Dijkstra%27s_algorithm\" rel=\"nofollow\">Dijkstra</a> to find the shortest path.</p>\n\n<p>To construct a graph from a <code>N*M</code> matrix, for every <code>(i, j)</code> element I create a vertex <code>i * N + j</code> and connect it to any other vertex (to which it is possible to connect with UP, RIGHT, DOWN, LEFT) and the edge will be the value of the element I am connecting to in the matrix. After that I create 2 other vertices <code>-1</code> connected to vertex <code>0</code> and <code>-2</code> connected to <code>N*M - 1</code> which will be my start and end vertices (both connection have 0 cost).</p>\n\n<p>After this I am doing Dijkstra to find shortest path cost from <code>-1</code> to <code>-2</code>. My Dijkstra implementation uses priority queue and looks this way:</p>\n\n<pre><code>func dijkstraCost(graph map[int]map[int]int, start, end int) int{\n    if start == end{\n        return 0\n    }\n    frontier := make(PriorityQueue, 1)\n    frontier[0] = &amp;Item{value: start, priority: 0, index: 0}\n    visited := map[int]bool{}\n    heap.Init(&amp;frontier)\n\n    for frontier.Len() &gt; 0 {\n        element := heap.Pop(&amp;frontier).(*Item)\n        vertex, cost := element.value, element.priority\n        visited[vertex] = true\n        neighbors := graph[vertex]\n        for vertex_new, cost_new := range(neighbors){\n            if !visited[vertex_new]{\n                if vertex_new == end{\n                    return cost + cost_new\n                }\n                heap.Push(&amp;frontier, &amp;Item{\n                    value: vertex_new,\n                    priority: cost + cost_new,\n                })\n            }\n        }\n    }\n    return -1\n}\n</code></pre>\n\n<p>where Priority Queue implementation is taken from heap container (example PriorityQueue) with one minor modification:</p>\n\n<pre><code>func (pq PriorityQueue) Less(i, j int) bool {\n    return pq[i].priority &gt; pq[j].priority // changed to &lt;\n}\n</code></pre>\n\n<p>The graph that I am providing to the function looks like:</p>\n\n<pre><code>map[13:map[8:965 18:121 12:746 14:111] 16:map[11:803 21:732 15:537 17:497] 3:map[8:965 2:234 4:18] 4:map[9:150 3:103] 22:map[17:497 21:732 23:37] -1:map[0:131] 17:map[16:699 18:121 12:746 22:524] 1:map[6:96 0:131 2:234] 9:map[4:18 14:111 8:965] 11:map[6:96 16:699 10:630 12:746] 19:map[14:111 24:331 18:121] 24:map[23:37 -2:0 19:956] 2:map[3:103 7:342 1:673] 15:map[10:630 20:805 16:699] 18:map[13:422 23:37 17:497 19:956] 10:map[5:201 15:537 11:803] 14:map[19:956 13:422 9:150] 0:map[5:201 1:673] 6:map[5:201 7:342 1:673 11:803] 8:map[9:150 3:103 13:422 7:342] -2:map[] 12:map[7:342 17:497 11:803 13:422] 20:map[15:537 21:732] 21:map[16:699 20:805 22:524] 5:map[0:131 10:630 6:96] 23:map[18:121 22:524 24:331] 7:map[2:234 12:746 6:96 8:965]]\n</code></pre>\n\n<hr>\n\n<p>This works correctly but the problem is that it is considered inefficient (judging by <a href=\"https://www.hackerrank.com/contests/projecteuler/challenges/euler083\" rel=\"nofollow\">Hackerrank version of the problem</a>). It should run find the value of the best solution for <code>700x700</code> matrix in less than 4 seconds, whereas my solution takes 10 seconds.</p>\n\n<p>I thought that I am doing something wrong in go, so I reimplemented the same solution in python (where it took approximately 70 seconds for 700x700 matrix)</p>\n\n<hr>\n\n<p><strong>My question is:</strong> Am I using the right approach to find the best solution in a matrix. If so what am I doing wrong with my implementation?</p>\n\n<p>P.S. I have full go and python solution, just thought that even without them the question is too long.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2038, "user_id": 648913, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae5ffe0f6fb08ddb16ef0af9f39f1eaf?s=128&d=identicon&r=PG", "display_name": "DonSeba", "link": "https://stackoverflow.com/users/648913/donseba"}, "is_accepted": false, "score": 3, "last_activity_date": 1434358429, "creation_date": 1434358429, "answer_id": 30841004, "question_id": 30839928, "link": "https://stackoverflow.com/questions/30839928/golang-unmarshal-a-json-object-into-mapstringinterface-by-default-how-can-i/30841004#30841004", "title": "golang unmarshal a json object into map[string]interface{} by default, how can I unmarshal it to []byte?", "body": "<p>Why don't you unmarshal the <code>json</code> into the struct directly? </p>\n\n<p>Or in case you have more objects into slice of struct? </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype TestJson struct {\n    Foo string\n    Baz string\n}\n\nvar (\n    jsonValue = `{\"FOO\" : \"BAR\", \"BAZ\" : \"QUX\"}`\n    jsonValueSlice = `[{\"FOO\" : \"BAR\", \"BAZ\" : \"QUX\"},{\"FOO\" : \"Second BAR\", \"BAZ\" : \"Second QUX\"}]`\n)\n\nfunc main() {\n    t := TestJson{}\n    err := json.Unmarshal([]byte(jsonValue), &amp;t)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Printf(\"%+v\\n\", t)\n\n\n    t2 := []TestJson{}\n    err2 := json.Unmarshal([]byte(jsonValueSlice), &amp;t2)\n    if err2 != nil {\n        fmt.Println(err2)\n    }\n\n    fmt.Printf(\"%+v\\n\", t2)\n}\n</code></pre>\n\n<p>EDIT : \nGo doesn't unmarshal into an map[string]interface{} by default, read the docs! </p>\n\n<pre><code>func Unmarshal(data []byte, v interface{}) error\n</code></pre>\n\n<p>Golang json.Unmarshal can populate basically anyting, as long your data is consistant. </p>\n"}], "owner": {"reputation": 19, "user_id": 5010263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd2d5785c153cf1b42db0d68a5149b68?s=128&d=identicon&r=PG&f=1", "display_name": "Rex Lv", "link": "https://stackoverflow.com/users/5010263/rex-lv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 840, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1434358429, "creation_date": 1434354704, "question_id": 30839928, "link": "https://stackoverflow.com/questions/30839928/golang-unmarshal-a-json-object-into-mapstringinterface-by-default-how-can-i", "title": "golang unmarshal a json object into map[string]interface{} by default, how can I unmarshal it to []byte?", "body": "<p>golang unmarshal json object into map[string]interface{} by default, how can I unmarshal it into []byte? Because I need secondary unmarshal it into a struct instance after I got its Type. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1434360613, "post_id": 30841601, "comment_id": 49727105, "body": "Thanks for your suggestion. It does solve the error, but still the inserted value will be that empty map &quot;{}&quot; in my jsonb column, where I instead need the map to marshal to NULL like when I input - nil - directly in the Exec function as parameter. I have read the link, but as I see it, there&#39;s no real solution in that thread :/"}, {"owner": {"reputation": 2038, "user_id": 648913, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae5ffe0f6fb08ddb16ef0af9f39f1eaf?s=128&d=identicon&r=PG", "display_name": "DonSeba", "link": "https://stackoverflow.com/users/648913/donseba"}, "reply_to_user": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1434360883, "post_id": 30841601, "comment_id": 49727273, "body": "Since json.Marshal() cannot &quot;see|access&quot; c.AccessMembers it returns &quot;NULL&quot; just the way it works..."}], "tags": [], "owner": {"reputation": 2038, "user_id": 648913, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ae5ffe0f6fb08ddb16ef0af9f39f1eaf?s=128&d=identicon&r=PG", "display_name": "DonSeba", "link": "https://stackoverflow.com/users/648913/donseba"}, "is_accepted": false, "score": 1, "last_activity_date": 1434360497, "last_edit_date": 1434360497, "creation_date": 1434360190, "answer_id": 30841601, "question_id": 30839476, "link": "https://stackoverflow.com/questions/30839476/marshalling-empty-mapstringinterface-results-in-null-instead-of-nil/30841601#30841601", "title": "Marshalling empty map[string]interface{} results in &quot;null&quot; instead of nil", "body": "<p>You have not initialized your <code>AccessMembers</code>. </p>\n\n<p>Before you decide to marshal the value you should check if it exists. </p>\n\n<pre><code>if c.AccessMembers == nil {\n    c.AccessMembers = make(map[string]interface{})\n}\n</code></pre>\n\n<p>If you do the above, the result of : </p>\n\n<pre><code>accessMembers, err := json.Marshal(c.AccessMembers)\n</code></pre>\n\n<p>will be an valid empty json value <code>{}</code>, and valid for storing into the db and retrieving the value later. </p>\n\n<p>UPDATE : </p>\n\n<p>there has been some discussion about the \"NULL\" value here : \n<a href=\"https://code.google.com/p/go/issues/detail?id=2278\" rel=\"nofollow\">https://code.google.com/p/go/issues/detail?id=2278</a> </p>\n"}, {"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 3, "last_activity_date": 1434360511, "creation_date": 1434360511, "answer_id": 30841703, "question_id": 30839476, "link": "https://stackoverflow.com/questions/30839476/marshalling-empty-mapstringinterface-results-in-null-instead-of-nil/30841703#30841703", "title": "Marshalling empty map[string]interface{} results in &quot;null&quot; instead of nil", "body": "<blockquote>\n  <p>I can't understand why this is not the same, as explicitly writing nil in the Exec functions parameter, since the []byte clearly must be nil, right?</p>\n</blockquote>\n\n<p><code>nil</code> has a type. The database driver marshals <code>nil</code> differently for type <code>map[string]interface{}</code> or <code>[]byte</code> than for <code>interface{}</code>  (which is the type of the second argument of <code>db.Exec</code>). You should be able to do:</p>\n\n<pre><code>var i interface{} = nil\n\nj, _ := json.Marshal(c.AccessMembers)\n\nif string(j) != \"null\" {\n     i = j\n}\n\nsqlStr := `UPDATE content SET access_members=$1 WHERE id=$2;`\n\n_, err := db.Exec(sqlStr, i, c.Id)\n</code></pre>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3387, "favorite_count": 0, "accepted_answer_id": 30841703, "answer_count": 2, "score": 3, "last_activity_date": 1434362343, "creation_date": 1434353113, "last_edit_date": 1434362343, "question_id": 30839476, "link": "https://stackoverflow.com/questions/30839476/marshalling-empty-mapstringinterface-results-in-null-instead-of-nil", "title": "Marshalling empty map[string]interface{} results in &quot;null&quot; instead of nil", "body": "<p>I have a problem where Go is inserting \"null\" into my PostgreSQL database's jsonb columns if I try to do the following, and the structs property (in this case of type map[string]interface{}) is empty:</p>\n\n<pre><code>accessMembers, _ := json.Marshal(c.AccessMembers)\n</code></pre>\n\n<p>Doing a test print it outputs the same as the value which get stored into the database:</p>\n\n<pre><code>fmt.Println(string(accessMembers)) // equals the string \"null\"\n</code></pre>\n\n<p>The problem is that I need it to be - nil (not a string, but the Golang nil), so when I use it in the Exec function below:</p>\n\n<pre><code>sqlStr := `UPDATE my_table SET access_members=$1 WHERE id=$2;`\n\n_, err := db.Exec(sqlStr, accessMembers, c.Id)\n</code></pre>\n\n<p><strong>It should be the equivalent (which works!!) of doing:</strong></p>\n\n<pre><code>_, err := db.Exec(sqlStr, nil, c.Id)\n</code></pre>\n\n<p>I tried a lot of different workarounds, which I thought had to work, but they didn't.</p>\n\n<p>eg.</p>\n\n<pre><code>var accessMembers []byte\n\nam, _ := json.Marshal(c.AccessMembers)\n\nif string(am) != \"null\"{\n    accessMembers = am\n}\n\nsqlStr := `UPDATE my_table SET access_members=$1 WHERE id=$2;`\n\n_, err := db.Exec(sqlStr, accessMembers, c.Id)\n</code></pre>\n\n<p>Which results in the following error: <em>\"pq: invalid input syntax for type json\"</em></p>\n\n<p>I can't understand why this is not the same, as explicitly writing nil in the Exec functions parameter, since the []byte clearly must be nil, right?</p>\n\n<p>What am I doing wrong here? Here's how I had hoped it would work: <a href=\"http://play.golang.org/p/UoLAGfhhRl\" rel=\"nofollow\">http://play.golang.org/p/UoLAGfhhRl</a></p>\n\n<p><strong>Answer:</strong></p>\n\n<pre><code>var accessMembers interface{} = nil\n\nif c.AccessMembers != nil {\n    j, _ := json.Marshal(c.AccessMembers)\n    accessMembers = j\n}\n</code></pre>\n\n<p>Thanks to thwd for providing the solution basically, and for pointing out how the database driver marshals nil differently, suggesting interface{} instead of []byte.</p>\n\n<p>Thanks to DonSeba for reminding me to check if the struct field exists before using resources to marshal, do string conversion and comparison, which ought to be more expensive.</p>\n"}, {"tags": ["go", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1434370813, "post_id": 30843401, "comment_id": 49733458, "body": "Yes, that works, but I&#39;m still wondering why. I thought that <code>var config []Config</code> would be the same as my <code>var config Configs</code> which is of type <code>[]Config</code>, isn&#39;t it? What&#39;s the difference? Thanks."}, {"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1434372424, "post_id": 30843401, "comment_id": 49734608, "body": "No, it&#39;s not the same. <code>var config Configs</code> means <a href=\"http://www.yaml.org/spec/1.2/spec.html#id2759963\" rel=\"nofollow noreferrer\">mapping scalars to sequences</a>."}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1434407533, "post_id": 30843401, "comment_id": 49755427, "body": "Hmm... I still don&#39;t quite get it. Let me put it this way, what if I need to incorporate this array in a more complicated data structure? I&#39;ve updated my data def to reflect the simplest way to nest it, I thought my code would work, but I was wrong again. Please help."}, {"owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "reply_to_user": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1434427525, "post_id": 30843401, "comment_id": 49760116, "body": "@xpt See my edit and upvote the answer if it helps you out :-)"}, {"owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "edited": false, "score": 0, "creation_date": 1434463487, "post_id": 30843401, "comment_id": 49781218, "body": "Sure, was waiting for the closure. Definitely +1. Thanks"}], "tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": true, "score": 1, "last_activity_date": 1434427404, "last_edit_date": 1434427404, "creation_date": 1434365746, "answer_id": 30843401, "question_id": 30837357, "link": "https://stackoverflow.com/questions/30837357/go-yaml-interpretation-example/30843401#30843401", "title": "Go Yaml Interpretation Example", "body": "<p>The contents of the example yaml file are sequence of objects, so do it like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Config struct {\n    Foo string\n    Bar []string\n}\n\nvar data = `\n- foo: 1\n  bar:\n    - one\n    - two\n    - three\n- foo: 2\n  bar:\n    - one1\n    - two2\n    - three3\n`\n\nfunc main() {\n\n    var config []Config\n\n    /*\n       filename := os.Args[1]\n       source, err := ioutil.ReadFile(filename)\n       if err != nil {\n           panic(err)\n       }\n    */\n\n    source := []byte(data)\n\n    err := yaml.Unmarshal(source, &amp;config)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n\n    //fmt.Printf(\"Value: %#v\\n\", config.Bar[0])\n\n    fmt.Printf(\"--- config:\\n%v\\n\\n\", config)\n}\n</code></pre>\n\n<p>As to your updated question, your code almost works, just give a hint to the yaml parser like this:</p>\n\n<pre><code>type Configs struct {\n    Cfgs []Config `foobars`\n}\n</code></pre>\n"}], "owner": {"reputation": 13026, "user_id": 2125837, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/760b6ec2b6e1cba2b0218178425f4cde?s=128&d=identicon&r=PG", "display_name": "xpt", "link": "https://stackoverflow.com/users/2125837/xpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1096, "favorite_count": 0, "accepted_answer_id": 30843401, "answer_count": 1, "score": 1, "last_activity_date": 1434427404, "creation_date": 1434342473, "last_edit_date": 1434407374, "question_id": 30837357, "link": "https://stackoverflow.com/questions/30837357/go-yaml-interpretation-example", "title": "Go Yaml Interpretation Example", "body": "<p>This Go Yaml Interpretation Example, \n<a href=\"https://gist.github.com/suntong001/74c85d15b19ef4b14b0e\" rel=\"nofollow\">https://gist.github.com/suntong001/74c85d15b19ef4b14b0e</a>, can unmarshal a simple YAML like this:</p>\n\n<pre><code>foo: 1\nbar:\n  - one\n  - two\n</code></pre>\n\n<p>Now I want to interpretation an array of the exact same data structure, what's the correct way to do?</p>\n\n<p>Below is my code so far, and it is not working as expected. Please help.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype Config struct {\n    Foo string\n    Bar []string\n}\n\ntype Configs struct {\n    Cfgs []Config\n}\n\nvar data = `\n- foo: 1\n  bar:\n    - one\n    - two\n    - three\n- foo: 2\n  bar:\n    - one1\n    - two2\n    - three3\n`\n\nfunc main() {\n\n  var config Configs\n\n    /*\n       filename := os.Args[1]\n       source, err := ioutil.ReadFile(filename)\n       if err != nil {\n           panic(err)\n       }\n    */\n\n    source := []byte(data)\n\n    err := yaml.Unmarshal(source, &amp;config)\n    if err != nil {\n        log.Fatalf(\"error: %v\", err)\n    }\n\n    //fmt.Printf(\"Value: %#v\\n\", config.Bar[0])\n\n    fmt.Printf(\"--- config:\\n%v\\n\\n\", config)\n}\n</code></pre>\n\n<p>UPDATE: </p>\n\n<p>To make it work, Jfly pointed out, simply replace my <code>var config Configs</code> with <code>var config []Config</code>, and it does the trick. Now I think if change my data definition to the following, my above code would work. </p>\n\n<pre><code>foobars:\n - foo: 1\n   bar:\n    - one\n    - two\n    - three\n\n - foo: 2\n   bar:\n    - one1\n    - two2\n    - three3\n</code></pre>\n\n<p>Nops, it doesn't. Please help.</p>\n"}, {"tags": ["windows", "git", "powershell", "github", "go"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 3, "creation_date": 1434341820, "post_id": 30836901, "comment_id": 49718839, "body": "I tried on my Mac OSX shell and worked just fine. It looked like there&#39;s something wrong with the https implementation on the other side. Perhaps you can try again?"}, {"owner": {"reputation": 18017, "user_id": 1627055, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/yDnmH.jpg?s=128&g=1", "display_name": "Vesper", "link": "https://stackoverflow.com/users/1627055/vesper"}, "edited": false, "score": 1, "creation_date": 1434382089, "post_id": 30836901, "comment_id": 49741747, "body": "Check if your <code>go get</code> initiates a proper HTTPS handshake (via Wireshark or a similar network sniffing action), if there&#39;s a HTTPS request failure, you might need to update your Go installation to stop using SSLv3 and/or obsolete ciphersuites."}], "answers": [{"tags": [], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "is_accepted": true, "score": 0, "last_activity_date": 1434521550, "creation_date": 1434521550, "answer_id": 30883516, "question_id": 30836901, "link": "https://stackoverflow.com/questions/30836901/why-doesnt-go-get-gopkg-in-work-while-go-get-github-com-ok/30883516#30883516", "title": "Why doesn&#39;t &quot;go get gopkg.in/...&quot; work while &quot;go get github.com/...&quot; OK?", "body": "<p>The root cause has been found: Because my computer use a web proxy, so I need to set proxy in environment variable:  </p>\n\n<pre><code>C:\\Users\\xiaona&gt;set https_proxy=https://web-proxy.corp.hp.com:8080/\n\nC:\\Users\\xiaona&gt;set http_proxy=https://web-proxy.corp.hp.com:8080/\n\nC:\\Users\\xiaona&gt;go get -v gopkg.in/fatih/pool.v2\nFetching https://gopkg.in/fatih/pool.v2?go-get=1\nParsing meta tags from https://gopkg.in/fatih/pool.v2?go-get=1 (status code 200)\n\nget \"gopkg.in/fatih/pool.v2\": found meta tag main.metaImport{Prefix:\"gopkg.in/fa\ntih/pool.v2\", VCS:\"git\", RepoRoot:\"https://gopkg.in/fatih/pool.v2\"} at https://g\nopkg.in/fatih/pool.v2?go-get=1\ngopkg.in/fatih/pool.v2 (download)\ngopkg.in/fatih/pool.v2\n</code></pre>\n\n<p>Then, all is OK!</p>\n"}], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 0, "accepted_answer_id": 30883516, "answer_count": 1, "score": 1, "last_activity_date": 1434521550, "creation_date": 1434338463, "question_id": 30836901, "link": "https://stackoverflow.com/questions/30836901/why-doesnt-go-get-gopkg-in-work-while-go-get-github-com-ok", "title": "Why doesn&#39;t &quot;go get gopkg.in/...&quot; work while &quot;go get github.com/...&quot; OK?", "body": "<p>I try to use <code>go get gopkg.in/fatih/pool.v2</code> to install <a href=\"https://github.com/fatih/pool\" rel=\"nofollow\">pool</a> according to <code>Readme.md</code>, but can't success:  </p>\n\n<pre><code>C:\\Users\\xiaona\\Documents\\GitHub&gt; go get -v gopkg.in/fatih/pool.v2\nFetching https://gopkg.in/fatih/pool.v2?go-get=1\nhttps fetch failed.\nFetching http://gopkg.in/fatih/pool.v2?go-get=1\nimport \"gopkg.in/fatih/pool.v2\": http/https fetch: Get http://gopkg.in/fatih/poo\nl.v2?go-get=1: dial tcp 107.178.216.236:80: ConnectEx tcp: A connection attempt\nfailed because the connected party did not properly respond after a period of ti\nme, or established connection failed because connected host has failed to respon\nd.\npackage gopkg.in/fatih/pool.v2: unrecognized import path \"gopkg.in/fatih/pool.v2\n\"\n</code></pre>\n\n<p>While access <code>107.178.216.236:80</code> is OK in web browser.</p>\n\n<p>I try to use <code>go get github.com/fatih/pool</code>, and it also works OK.</p>\n\n<p>Could anyone give some clues on this issue?</p>\n\n<p>BTW: I use <code>windows powershell</code> and <code>git</code> version is <code>1.9.5</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1434339106, "post_id": 30836350, "comment_id": 49718320, "body": "In addition to the answers, you can avoid all of the &quot;fragility&quot; around quoting if you marshal your data into JSON from a struct. See here for a minimal example: <a href=\"http://play.golang.org/p/8lGwkQPYxb\" rel=\"nofollow noreferrer\">play.golang.org/p/8lGwkQPYxb</a> - you can modify your <code>makeHttpPostReq</code> function to accept a <code>User</code> instead of two strings."}], "answers": [{"tags": [], "owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "is_accepted": true, "score": 7, "last_activity_date": 1434336857, "creation_date": 1434336857, "answer_id": 30836734, "question_id": 30836350, "link": "https://stackoverflow.com/questions/30836350/unable-to-send-json-as-body-for-http-post-request-in-go/30836734#30836734", "title": "Unable to send JSON as body for HTTP POST request in GO", "body": "<p>You've got your quoting wrong:</p>\n\n<p><a href=\"http://play.golang.org/p/PueWyQ1atq\">http://play.golang.org/p/PueWyQ1atq</a></p>\n\n<pre><code>var jsonprep string = \"`{username:\"+username+\",password:\"+password+\"}`\"\n\n===&gt; `{username:Bob,password:pass}`\n</code></pre>\n\n<p>You meant:</p>\n\n<p><a href=\"http://play.golang.org/p/LMuwxArf8G\">http://play.golang.org/p/LMuwxArf8G</a></p>\n\n<pre><code>var jsonprep string = `{\"username\":\"`+username+`\",\"password\":\"`+password+`\"}`\n===&gt; {\"username\":\"Bob\",\"password\":\"pass\"}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 249309, "user_id": 97337, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed9a0d8cd44b62539b141f6c10405db1?s=128&d=identicon&r=PG", "display_name": "Rob Napier", "link": "https://stackoverflow.com/users/97337/rob-napier"}, "edited": false, "score": 1, "creation_date": 1434375237, "post_id": 30836742, "comment_id": 49736631, "body": "In Go you can avoid all the confusing backslash quoting (\\&quot;) by using ` (backtick) instead of &quot; (double-quote) for the string."}], "tags": [], "owner": {"reputation": 6849, "user_id": 1046738, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fad002f88c1fc7c38c3154d3970f1ad2?s=128&d=identicon&r=PG", "display_name": "jfly", "link": "https://stackoverflow.com/users/1046738/jfly"}, "is_accepted": false, "score": 2, "last_activity_date": 1434338685, "last_edit_date": 1434338685, "creation_date": 1434336946, "answer_id": 30836742, "question_id": 30836350, "link": "https://stackoverflow.com/questions/30836350/unable-to-send-json-as-body-for-http-post-request-in-go/30836742#30836742", "title": "Unable to send JSON as body for HTTP POST request in GO", "body": "<p>If you use </p>\n\n<pre><code>var jsonprep string = \"`{username:\"+username+\",password:\"+password+\"}`\" \n</code></pre>\n\n<p>the server will get the data like this:            </p>\n\n<pre><code>`{username:your_username,password:yourpassword}`\n</code></pre>\n\n<p>because the string in back quotes `` which is in the double quotes is not raw string literals, of course it's invalid json. you can compose the json string manually:</p>\n\n<pre><code>var jsonprep string = \"{\\\"username\\\":\\\"\" + username + \"\\\",\\\"password\\\":\\\"\" + password + \"\\\"}\"\n</code></pre>\n"}], "owner": {"reputation": 1275, "user_id": 3846091, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/05a22704d6f3656abe5c948acafcd201?s=128&d=identicon&r=PG&f=1", "display_name": "user3846091", "link": "https://stackoverflow.com/users/3846091/user3846091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10819, "favorite_count": 1, "accepted_answer_id": 30836734, "answer_count": 2, "score": 2, "last_activity_date": 1434338685, "creation_date": 1434332644, "question_id": 30836350, "link": "https://stackoverflow.com/questions/30836350/unable-to-send-json-as-body-for-http-post-request-in-go", "title": "Unable to send JSON as body for HTTP POST request in GO", "body": "<p>When i make the POST request using the below GO Function. I get a <code>invalid json</code> on the server side. </p>\n\n<p>If i send static json for example </p>\n\n<pre><code>var jsonprep = []byte(`{\"username\":\"xyz@gmail.com\",\"password\":\"xyz123\"}`) \n</code></pre>\n\n<p>it does work instead of </p>\n\n<pre><code>var jsonprep string = \"`{username:\"+username+\",password:\"+password+\"}`\"\n</code></pre>\n\n<p>.</p>\n\n<pre><code>func makeHttpPostReq(url string, username string, password string){\n\n    client := http.Client{}\n\n\n    var jsonprep string = \"`{username:\"+username+\",password:\"+password+\"}`\"\n\n    var jsonStr = []byte(jsonprep)\n\n    req, err := http.NewRequest(\"POST\", url, bytes.NewBuffer(jsonStr))\n    req.Header.Set(\"Content-Type\", \"application/json\")\n\n    resp, err := client.Do(req)\n    if err != nil {\n         fmt.Println(\"Unable to reach the server.\")\n    } else {\n         body, _ := ioutil.ReadAll(resp.Body)\n         fmt.Println(\"body=\", string(body))\n    }\n\n}\n</code></pre>\n"}, {"tags": ["http", "go", "http2"], "answers": [{"comments": [{"owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 0, "creation_date": 1434343675, "post_id": 30837401, "comment_id": 49719293, "body": "thank you this is helpful, i thought about polling but is it really the way to go for realtime apps over http2?, because why make a request if the state did not change? i cant find anything about sending a request to the client, without a request."}, {"owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "reply_to_user": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "edited": false, "score": 2, "creation_date": 1434343977, "post_id": 30837401, "comment_id": 49719372, "body": "Generally HTTP servers aren&#39;t expected to be able to make requests back to clients. Much of the time you&#39;d find the client is firewalled, behind NAT, or otherwise unreachable. HTTP2 is cool but unless you&#39;re using some of its new features (which seems unlikely given Go&#39;s implementation is pretty raw for the moment), you could just stick with HTTP 1.1 and use good old websockets. The upgrade to HTTP2 when it&#39;s ready in Go will almost certainly be pretty simple."}], "tags": [], "owner": {"reputation": 19167, "user_id": 432193, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/87f2efac0ff72169aa6e92fc3c613189?s=128&d=identicon&r=PG", "display_name": "Endophage", "link": "https://stackoverflow.com/users/432193/endophage"}, "is_accepted": true, "score": 9, "last_activity_date": 1434343230, "last_edit_date": 1434343230, "creation_date": 1434342793, "answer_id": 30837401, "question_id": 30835999, "link": "https://stackoverflow.com/questions/30835999/server-initiated-requests/30837401#30837401", "title": "Server-initiated requests", "body": "<p>Before websockets we had polling. This literally means having the client periodically (every few seconds, or whatever time period makes sense for your application), make a request to the server to find out the status of the job.</p>\n\n<p>An optimization many people use is \"long\" polling. This involves having the server accept the request, and internally to the server, check for changes, and sleep while there are none, until either a specific timeout is reached or the desired event occurs, which is then messaged back to the client.</p>\n\n<p>If a timeout is reached, the connection is closed and the client needs to make another request. The server code would look something like the following, assume the functions do sensible things based on their names and signatures:</p>\n\n<pre><code>import (\n    \"net/http\"\n    \"time\"\n)\n\nfunc PollingHandler(w http.ResponseWriter, r *http.Request) {\n    jobID := getJobID(r)\n    for finish := 60; finish &gt; 0; finish-- { // iterate for ~1 minute\n        status, err := checkStatus(jobID)\n        if err != nil {\n            writeError(w, err)\n            return\n        }\n        if status != nil {\n            writeStatus(w, status)\n            return\n        }\n        time.Sleep(time.Second) // sleep 1 second\n    }\n    writeNil(w) // specific response telling client to request again.\n}\n</code></pre>\n\n<p>A better way to handle the timeout would be to use the <a href=\"https://godoc.org/golang.org/x/net/context\">context package</a> and create a context with a timeout. That would look something like:</p>\n\n<pre><code>import (\n    \"net/http\"\n    \"time\"\n    \"golang.org/x/net/context\"\n)\n\nfunc PollingHandler(w http.ResponseWriter, r *http.Request) {\n    jobID := getJobID(r)\n    ctx := context.WithTimeout(context.Background(), time.Second * 60)\n    for {\n        select{\n        case &lt;-ctx.Done():\n            writeNil(w)\n        default: \n            status, err := checkStatus(jobID)\n            if err != nil {\n                writeError(w, err)\n                return\n            }\n            if status != nil {\n                writeStatus(w, status)\n                return\n            }\n            time.Sleep(time.Second) // sleep 1 second\n        }\n    }\n\n}\n</code></pre>\n\n<p>This second version is just going to return in a more reliable amount of time, especially in the case where <code>checkStatus</code> may be a slower call.</p>\n"}, {"comments": [{"owner": {"reputation": 2131, "user_id": 2240375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6f282bf8b419ff1482cab14c0a48741?s=128&d=identicon&r=PG&f=1", "display_name": "AsgarAli", "link": "https://stackoverflow.com/users/2240375/asgarali"}, "edited": false, "score": 0, "creation_date": 1508909664, "post_id": 32215694, "comment_id": 80796121, "body": "Kindly take a note that server will always get HTTP request in SSE. If you will check access log in your HTTP server or browser&#39;s network log then you will know."}], "tags": [], "owner": {"reputation": 4319, "user_id": 2027237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6457db0676be7f14f63e0f45aec333d?s=128&d=identicon&r=PG", "display_name": "anneb", "link": "https://stackoverflow.com/users/2027237/anneb"}, "is_accepted": false, "score": 5, "last_activity_date": 1440548216, "last_edit_date": 1440548216, "creation_date": 1440545024, "answer_id": 32215694, "question_id": 30835999, "link": "https://stackoverflow.com/questions/30835999/server-initiated-requests/32215694#32215694", "title": "Server-initiated requests", "body": "<p>You could consider using the HTML5 text/event-stream a.k.a. server side events (SSE). SSE is mentioned in the question, wouldn't that work well with http2?</p>\n\n<p>General articles about SSE</p>\n\n<ul>\n<li><a href=\"http://www.w3schools.com/html/html5_serversentevents.asp\" rel=\"noreferrer\">http://www.w3schools.com/html/html5_serversentevents.asp</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Server-sent_events\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Server-sent_events</a></li>\n</ul>\n\n<p>(IE is currently the only browser that doesn't support SSE)</p>\n\n<p>In the following article, http2 push is combined with SSE. Documents are pushed into the client cache and SSE is used to notify the client what documents can be retrieved from its cache (= server initiated requests over a single http2 connection):</p>\n\n<ul>\n<li><a href=\"https://www.igvita.com/2013/06/12/innovating-with-http-2.0-server-push/\" rel=\"noreferrer\">https://www.igvita.com/2013/06/12/innovating-with-http-2.0-server-push/</a></li>\n</ul>\n\n<p>Basics of SSE: on the server side, you start with: </p>\n\n<pre><code>Content-Type: text/event-stream\\n\\n\n</code></pre>\n\n<p>Then for each time you want to send an update to the client you send</p>\n\n<pre><code>data: { \"name\": \"value\", \"othername\": \"othervalue\" }\\n\\n\n</code></pre>\n\n<p>When finished, before closing the connection, you can optionally send:</p>\n\n<pre><code>retry: 60000\\n\\n\n</code></pre>\n\n<p>to instruct the browser to retry a new connection after 60000 msec</p>\n\n<p>In the browser the connection is made like this:</p>\n\n<pre><code>var URL = \"http://myserver/myeventstreamer\"\nif (!!window.EventSource) {\n    source = new EventSource(URL);\n} else {\n    // Resort to xhr polling :(\n    alert (\"This browser does not support Server Sent Events\\nPlease use another browser\") \n}\n\nsource.addEventListener('message', function(e) {\n  console.log(e.data);\n}, false);\n\nsource.addEventListener('open', function(e) {\n  // Connection was opened.\n}, false);\n\nsource.addEventListener('error', function(e) {\n  if (e.readyState == EventSource.CLOSED) {\n    // Connection was closed.\n  }\n}, false);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11133, "user_id": 4275347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CdbsN.jpg?s=128&g=1", "display_name": "Michael Laszlo", "link": "https://stackoverflow.com/users/4275347/michael-laszlo"}, "is_accepted": false, "score": 1, "last_activity_date": 1440837798, "creation_date": 1440837798, "answer_id": 32284226, "question_id": 30835999, "link": "https://stackoverflow.com/questions/30835999/server-initiated-requests/32284226#32284226", "title": "Server-initiated requests", "body": "<p>If you want to send the JSON message as text, a <a href=\"http://chimera.labs.oreilly.com/books/1230000000545/ch16.html\" rel=\"nofollow\">server-sent event (SSE)</a> is a good way to do it. SSE is designed to send text. All event data is encoded in UTF-8 characters. The downside is that this makes it inefficient to send binary data through SSE.</p>\n\n<p>If you want to send binary data, you may be interested in the <a href=\"https://http2.github.io/http2-spec/#rfc.section.8.2\" rel=\"nofollow\">Server Push</a> mechanism introduced by HTTP/2. Server Push allows an HTTP/2 server to send any kind of file to the client on its own initiative. It's called a Server Push \"response\" even though it's sent before the client asks for it. The client automatically stores a file sent via Server Push response in its cache. A subsequent request for the file is immediately fulfilled from the cache without a round trip to the server.</p>\n\n<p>This is an efficient way to push binary data to a web browser. The hitch is that the browser's document object model (DOM) is not notified when a Server Push response arrives. The browser only discovers that the data is in its cache when it makes a request for it. We can work around this problem in the following manner. Immediately after sending binary data with Server Push, the server sends an SSE to the client to notify it that data has been pushed to its cache. Now the client can retrieve the data from its cache by requesting it.</p>\n\n<p>But as long as you're using SSE, why not send the file through SSE in the first place? Because if you're dealing with binary data, you can benefit from the smaller file size that Server Push allows you to achieve. For a short JSON message, it may not make sense to use Server Push. In situations where you're pushing binary data and you have to conserve bandwidth, consider sending the data through Server Push followed by SSE notification.</p>\n\n<p>Unlike polling, this approach does not require periodic requests from the client. The server can send a Server Push response whenever it wants to.</p>\n"}], "owner": {"reputation": 2325, "user_id": 1492051, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/07ecac667abb2bfa8d6698dc629bbb54?s=128&d=identicon&r=PG", "display_name": "FPGA", "link": "https://stackoverflow.com/users/1492051/fpga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2295, "favorite_count": 0, "accepted_answer_id": 30837401, "answer_count": 3, "score": 11, "last_activity_date": 1440838005, "creation_date": 1434328850, "last_edit_date": 1440838005, "question_id": 30835999, "link": "https://stackoverflow.com/questions/30835999/server-initiated-requests", "title": "Server-initiated requests", "body": "<p>I know that HTTP is a request-response protocol. My problem, in short, is that a client makes a request to the server to start a long running-process, and I want to inform the client of the progress with a simple JSON message containing progress info.</p>\n\n<p>In HTTP/1.1 I know that I could use a WebSocket or server-sent events (SSE) or long polling.</p>\n\n<p>Now I know that HTTP/2 does not support WebSocket yet.</p>\n\n<p>My question is, what is the optimal way to handle such things over HTTP/2?</p>\n\n<p>Are there any new things that I am not aware of to handle server-initiated requests in HTTP/2?</p>\n\n<p>I am using the Go language, if that matters.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1770, "user_id": 2777092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6725c0383a417d03b6d3d48c730d683d?s=128&d=identicon&r=PG", "display_name": "KingRider", "link": "https://stackoverflow.com/users/2777092/kingrider"}, "edited": false, "score": 0, "creation_date": 1465400208, "post_id": 30835847, "comment_id": 62887900, "body": "Change <code>url.Values</code> to <code>bytes.NewBufferString</code> is try!"}], "answers": [{"tags": [], "owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "is_accepted": false, "score": 3, "last_activity_date": 1434327259, "creation_date": 1434327259, "answer_id": 30835862, "question_id": 30835847, "link": "https://stackoverflow.com/questions/30835847/http-post-in-go-lang-throws-error/30835862#30835862", "title": "HTTP POST in GO Lang throws error", "body": "<p>The argument to <code>makeHttpPostReq</code> states url is a string but you are treating it as a struct <code>url.Values</code>, thus the error </p>\n\n<blockquote>\n  <p>has no field or method</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1425084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69059f5d69d5b6ea9f3d0f3534914adb?s=128&d=identicon&r=PG", "display_name": "azzzz", "link": "https://stackoverflow.com/users/1425084/azzzz"}, "is_accepted": false, "score": 1, "last_activity_date": 1521173856, "last_edit_date": 1521173856, "creation_date": 1521160192, "answer_id": 49311445, "question_id": 30835847, "link": "https://stackoverflow.com/questions/30835847/http-post-in-go-lang-throws-error/49311445#49311445", "title": "HTTP POST in GO Lang throws error", "body": "<p>You are reusing the <code>url</code> word. </p>\n\n<p>url is in your case resolving to url as a string not a <code>net/url</code></p>\n"}], "owner": {"reputation": 1275, "user_id": 3846091, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/05a22704d6f3656abe5c948acafcd201?s=128&d=identicon&r=PG&f=1", "display_name": "user3846091", "link": "https://stackoverflow.com/users/3846091/user3846091"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2508, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1521173856, "creation_date": 1434327021, "question_id": 30835847, "link": "https://stackoverflow.com/questions/30835847/http-post-in-go-lang-throws-error", "title": "HTTP POST in GO Lang throws error", "body": "<p>I am trying to make a Post request using in GO Lang. The API URL is expecting a username and password field to be passed to it in body. However I keep getting the below error ?</p>\n\n<p>I am not sure what am i doing wrong here ?  </p>\n\n<p>Error</p>\n\n<pre><code> url.Values undefined (type string has no field or method Values)\n</code></pre>\n\n<p>Go Function</p>\n\n<pre><code>func makeHttpPostReq(url string, username string, password string){\n\n    client := http.Client{}\n    req, err := http.NewRequest(\"POST\", url, url.Values{\"username\": {username}, \"password\": {password}})\n    req.Header.Add(\"Content-Type\", \"application/x-www-form-urlencoded\")\n\n    resp, err := client.Do(req)\n    if err != nil {\n         fmt.Println(\"Unable to reach the server.\")\n    } else {\n         body, _ := ioutil.ReadAll(resp.Body)\n         fmt.Println(\"body=\", string(body))\n    }\n\n}\n</code></pre>\n"}, {"tags": ["mysql", "go", "insert", "duplicates"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434324565, "post_id": 30835388, "comment_id": 49715673, "body": "what is the error you get?"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434327492, "post_id": 30835388, "comment_id": 49716191, "body": "@DavidBudworth - I added the error message"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434335194, "post_id": 30835388, "comment_id": 49717597, "body": "try $1, $2 and $3 instead of ?, some drivers work that way"}, {"owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434688340, "post_id": 30835388, "comment_id": 49895728, "body": "@DavidBudworth -  It doesn&#39;t help :("}], "answers": [{"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 0, "last_activity_date": 1436494521, "creation_date": 1436494521, "answer_id": 31331388, "question_id": 30835388, "link": "https://stackoverflow.com/questions/30835388/how-to-insert-a-tuple-only-if-it-is-not-available-in-the-table-in-golang/31331388#31331388", "title": "How to insert a tuple only if it is not available in the table in Golang?", "body": "<p>\"Column count doesn't match value count\" means that you didn't provide a value for a column in the table which doesn't have a default value. </p>\n\n<p>Check your table schema (<code>DESCRIBE tag;</code>) and ensure that you are providing values for the other columns, or that they have a default value.</p>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436494521, "creation_date": 1434322269, "last_edit_date": 1434390839, "question_id": 30835388, "link": "https://stackoverflow.com/questions/30835388/how-to-insert-a-tuple-only-if-it-is-not-available-in-the-table-in-golang", "title": "How to insert a tuple only if it is not available in the table in Golang?", "body": "<p>In my use case, I want to write a function to insert a row in a table in Golang if the row is not available already. I am using MySql and <a href=\"http://github.com/go-sql-driver/mysql\" rel=\"nofollow\">github.com/go-sql-driver/mysql</a>. I am getting an error while I try to insert through this function. But I am able to insert by running through the MySql console. Here is the function definition,</p>\n\n<pre><code>    func AddTag(t *objects.Tag) {\n\n    //Get connection object\n    db, err := GetDBConnection()\n    defer db.Close()\n\n    // Prepare statement for inserting data\n    stmtIns, err := db.Prepare(\"INSERT INTO tag (tag_id, tag_name, metatag_id) SELECT * FROM (SELECT NULL, ?, ?) AS tmp WHERE NOT EXISTS ( SELECT tag_name FROM tag WHERE tag_name = ? ) LIMIT 1\")\n    if err != nil {\n        fmt.Println(\"FATAL  \", time.Now(), \"Error in prepare statement for Tag insert \")\n        panic(err.Error()) \n    }\n\n    defer stmtIns.Close()                         // Close the statement when we leave main() / the program terminates\n    _, err = stmtIns.Exec(t.TagName, t.MetaTagId, t.TagName) // Insert tuples\n\n    if err != nil {\n        fmt.Println(\"FATAL  \", time.Now(), \"Error in insert to Tag \")\n        panic(err.Error()) \n    }\n\n  }\n</code></pre>\n\n<p><strong>Edit 1 :</strong>\nI am getting the following error,</p>\n\n<pre><code>FATAL    2015-06-14 17:13:15.631487042 -0700 PDT Error in insert to Tag\npanic: Error 1136: Column count doesn't match value count at row 1\n\ngoroutine 1 [running]:\nmain.AddTag(0x1112e1a0, 0x0, 0x0)\n</code></pre>\n\n<p>Could anyone help me on this? Thank you</p>\n"}, {"tags": ["c", "go", "xlib", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 1, "last_activity_date": 1434396497, "last_edit_date": 1495541668, "creation_date": 1434392996, "answer_id": 30852444, "question_id": 30835225, "link": "https://stackoverflow.com/questions/30835225/cgo-converting-xlib-xevent-struct-to-byte-array/30852444#30852444", "title": "CGO converting Xlib XEvent struct to byte array?", "body": "<p>As mentioned <a href=\"https://golang.org/cmd/cgo/#hdr-Go_references_to_C\" rel=\"nofollow noreferrer\">in the cgo documentation</a>:</p>\n\n<blockquote>\n  <p>As Go doesn't have support for C's union type in the general case, C's union types are represented as a Go byte array with the same length.</p>\n</blockquote>\n\n<p>Another SO question: <a href=\"https://stackoverflow.com/questions/14581063/golang-cgo-converting-union-field-to-go-type\">Golang CGo: converting union field to Go type</a><br>\nor <a href=\"https://groups.google.com/d/msg/golang-nuts/G02z30Jncbk/RdPtTmllSTwJ\" rel=\"nofollow noreferrer\">a go-nuts mailing list post</a> may be of further help.</p>\n\n<p>In short, you won't be able to just simply use or simply interface with C code that uses a union. At a minimum you'll need set something like an <code>unsafe.Pointer</code> to manipulate the field/type manually and your example looks like a particularly annoying case (i.e.\u00a0it's not just a union over a few different kinds of integers as above linked cases are).</p>\n\n<p>Given the names I get the impression you may want to create an \"event\" interface in Go and implement each of the required event types as Go types that implement that interface. Then write code (in Go or C) that converts to/from the C union based on the first <code>C.sizeof(int)</code> bytes of the Go \"union\"/[]byte (I think the first <code>int type</code> field is likely included in each if the X\u2026 event types).</p>\n"}], "owner": {"reputation": 1220, "user_id": 2124732, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/cf9d2998c0d9cb26334028f72185fe38?s=128&d=identicon&r=PG", "display_name": "Christopher Dumas", "link": "https://stackoverflow.com/users/2124732/christopher-dumas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 30852444, "answer_count": 1, "score": 2, "last_activity_date": 1434396497, "creation_date": 1434320927, "question_id": 30835225, "link": "https://stackoverflow.com/questions/30835225/cgo-converting-xlib-xevent-struct-to-byte-array", "title": "CGO converting Xlib XEvent struct to byte array?", "body": "<p>I am creating a simple window manager (code based of the c code in tinywm) in Golang. To use Xlib, I am using cgo, so my header is:</p>\n\n<pre><code>// #cgo LDFLAGS: -lX11\n// #include &lt;X11/Xlib.h&gt;\n</code></pre>\n\n<p>And I have a variable declaration, like:</p>\n\n<pre><code>event := C.XEvent{}\n</code></pre>\n\n<p>And then, I use this to assign to it, later, in the event loop:</p>\n\n<pre><code>C.XNextEvent(display, &amp;event) // Yes, display is defined\n</code></pre>\n\n<p>But when I try to access properties on the event, such as xbutton or xkey, I get an error:</p>\n\n<pre><code>event.xbutton undefined (type C.XEvent has no field or method xbutton)\n</code></pre>\n\n<p>And when I look at the cgo output for XEvent, it looks like this, in the <code>_cgo_gotypes.go</code> file:</p>\n\n<pre><code>type _Ctype_XEvent [192] byte\n</code></pre>\n\n<p>And I cant figure out what is going on, although I have a hunch that the type <code>[192] byte</code> is very wrong for a C struct type. In case this helps, the XEvent struct looks like this in the C library:</p>\n\n<pre><code>typedef union _XEvent {\n\n    int type;   /* must not be changed */\n    XAnyEvent xany;\n    XKeyEvent xkey;\n    XButtonEvent xbutton;\n    XMotionEvent xmotion;\n    XCrossingEvent xcrossing;\n    XFocusChangeEvent xfocus;\n    XExposeEvent xexpose;\n    XGraphicsExposeEvent xgraphicsexpose;\n    XNoExposeEvent xnoexpose;\n    XVisibilityEvent xvisibility;\n    XCreateWindowEvent xcreatewindow;\n    XDestroyWindowEvent xdestroywindow;\n    XUnmapEvent xunmap;\n    XMapEvent xmap;\n    XMapRequestEvent xmaprequest;\n    XReparentEvent xreparent;\n    XConfigureEvent xconfigure;\n    XGravityEvent xgravity;\n    XResizeRequestEvent xresizerequest;\n    XConfigureRequestEvent xconfigurerequest;\n    XCirculateEvent xcirculate;\n    XCirculateRequestEvent xcirculaterequest;\n    XPropertyEvent xproperty;\n    XSelectionClearEvent xselectionclear;\n    XSelectionRequestEvent xselectionrequest;\n    XSelectionEvent xselection;\n    XColormapEvent xcolormap;\n    XClientMessageEvent xclient;\n    XMappingEvent xmapping;\n    XErrorEvent xerror;\n    XKeymapEvent xkeymap;\n    long pad[24];\n} XEvent;\n</code></pre>\n"}, {"tags": ["javascript", "time", "go", "utc"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1434319318, "creation_date": 1434319318, "answer_id": 30835006, "question_id": 30834791, "link": "https://stackoverflow.com/questions/30834791/javascript-gettimezoneoffset-method-in-golang/30835006#30835006", "title": "JavaScript getTimezoneOffset() method in Golang", "body": "<p>The <code>time.Time</code> type has what you're looking for:</p>\n\n<pre><code>zone, offset := time.Now().Zone()\n</code></pre>\n\n<p><code>zone</code> the the timezone name, and offset is its UTC offset. Pretty simple</p>\n\n<p>Example on the playground: <a href=\"http://play.golang.org/p/Ij-TuuRX_K\" rel=\"nofollow\">http://play.golang.org/p/Ij-TuuRX_K</a></p>\n"}], "owner": {"reputation": 1099, "user_id": 1549952, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/8076fdf9afc3effa4ddc37ad9d51b15a?s=128&d=identicon&r=PG", "display_name": "TSW1985", "link": "https://stackoverflow.com/users/1549952/tsw1985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434319318, "creation_date": 1434317627, "question_id": 30834791, "link": "https://stackoverflow.com/questions/30834791/javascript-gettimezoneoffset-method-in-golang", "title": "JavaScript getTimezoneOffset() method in Golang", "body": "<p>In JavaScript we can use this method to get the offset zone.</p>\n\n<pre><code>function myFunction() {\n    var d = new Date();\n    var n = d.getTimezoneOffset();\n    document.getElementById(\"demo\").innerHTML = n;\n\n}\n</code></pre>\n\n<p>For example , if we are in Berlin , Germany we return -120 minutes. If we are in London we have -60 minutes.</p>\n\n<p>I need exactly that method in golang. Exists??? Thanks to every one.</p>\n"}, {"tags": ["go", "biginteger", "int64"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": true, "score": 7, "last_activity_date": 1434309027, "creation_date": 1434309027, "answer_id": 30833422, "question_id": 30833314, "link": "https://stackoverflow.com/questions/30833314/golang-overflows-int64/30833422#30833422", "title": "Golang overflows int64", "body": "<p>for example so:</p>\n\n<pre><code>count,one := new(big.Int), big.NewInt(1)\ncount.SetString(\"100000000000000000000000\",10)\n</code></pre>\n\n<p>link:\n<a href=\"http://play.golang.org/p/eEXooVOs9Z\" rel=\"noreferrer\">http://play.golang.org/p/eEXooVOs9Z</a></p>\n"}, {"tags": [], "owner": {"reputation": 295, "user_id": 1497534, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0a8a02cbae2661ad44b2a035e531e961?s=128&d=identicon&r=PG", "display_name": "Katamaritaco", "link": "https://stackoverflow.com/users/1497534/katamaritaco"}, "is_accepted": false, "score": 2, "last_activity_date": 1445765349, "creation_date": 1445765349, "answer_id": 33328154, "question_id": 30833314, "link": "https://stackoverflow.com/questions/30833314/golang-overflows-int64/33328154#33328154", "title": "Golang overflows int64", "body": "<p>It won't work because under the hood, big.NewInt is actually allocating an int64. The number that you want to allocate into a big.NewInt would need more than 64bits to exist, so it failed.</p>\n\n<p>However, with how big works, if you wanted to add two large numbers below MaxInt64, you can do that! Even if the sum is greater than MaxInt64. Here is an example I just wrote up (<a href=\"http://play.golang.org/p/Jv52bMLP_B\" rel=\"nofollow\">http://play.golang.org/p/Jv52bMLP_B</a>): </p>\n\n<pre><code>func main() {\n    count := big.NewInt(0);\n\n    count.Add( count, big.NewInt( 5000000000000000000 ) );\n    count.Add( count, big.NewInt( 5000000000000000000 ) );\n\n    //9223372036854775807 is the max value represented by int64: 2^63 - 1\n    fmt.Printf( \"count:     %v\\nmax int64:  9223372036854775807\\n\", count );\n}\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code>count:     10000000000000000000\nmax int64:  9223372036854775807\n</code></pre>\n\n<p>Now, if you're still curious about how NewInt works under the hood, here is the function you're using, taken from Go's documentation,:</p>\n\n<pre><code>// NewInt allocates and returns a new Int set to x.\nfunc NewInt(x int64) *Int {\n    return new(Int).SetInt64(x)\n}\n</code></pre>\n\n<p>Sources: </p>\n\n<p><a href=\"https://golang.org/pkg/math/big/#NewInt\" rel=\"nofollow\">https://golang.org/pkg/math/big/#NewInt</a></p>\n\n<p><a href=\"https://golang.org/src/math/big/int.go?s=1058:1083#L51\" rel=\"nofollow\">https://golang.org/src/math/big/int.go?s=1058:1083#L51</a></p>\n"}], "owner": {"reputation": 85, "user_id": 5009007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dafb59e4b59a4b2cf29b66517f1dbdbf?s=128&d=identicon&r=PG&f=1", "display_name": "Mad", "link": "https://stackoverflow.com/users/5009007/mad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4616, "favorite_count": 0, "accepted_answer_id": 30833422, "answer_count": 2, "score": 7, "last_activity_date": 1445765349, "creation_date": 1434308406, "question_id": 30833314, "link": "https://stackoverflow.com/questions/30833314/golang-overflows-int64", "title": "Golang overflows int64", "body": "<p>I try to use this code, but gives me an error: constant 100000000000000000000000 overflows int64</p>\n\n<p>How can I fix that ?</p>\n\n<pre><code>// Initialise big numbers with small numbers\ncount, one := big.NewInt(100000000000000000000000), big.NewInt(1)\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 3457, "user_id": 3108853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db3d997e8c35cb14623d4dc4de494801?s=128&d=identicon&r=PG&f=1", "display_name": "lsowen", "link": "https://stackoverflow.com/users/3108853/lsowen"}, "edited": false, "score": 0, "creation_date": 1434304111, "post_id": 30832540, "comment_id": 49709943, "body": "What is the output of running <code>go build</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1434307778, "post_id": 30832540, "comment_id": 49711002, "body": "What version of Go are you using?"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434327236, "post_id": 30832540, "comment_id": 49716155, "body": "@JimB version is 4.9.0"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": -1, "last_activity_date": 1434327599, "creation_date": 1434327599, "answer_id": 30835898, "question_id": 30832540, "link": "https://stackoverflow.com/questions/30832540/go-test-for-package-fails-but-individually-test-run-fine-and-package-compiles/30835898#30835898", "title": "`go test` for package fails but individually test run fine, and package compiles fine", "body": "<p>I installed the ubuntu <code>golang</code> package</p>\n\n<pre><code>$ go version\ngo version go1.2.1 linux/amd64\n</code></pre>\n\n<p>And now am getting meaningful error messages when running package tests:</p>\n\n<p><code>$ go test github.com/dm03514/go-edu-db/..</code></p>\n"}, {"comments": [{"owner": {"reputation": 12075, "user_id": 8757883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQGYY.png?s=128&g=1", "display_name": "Akber Iqbal", "link": "https://stackoverflow.com/users/8757883/akber-iqbal"}, "edited": false, "score": 0, "creation_date": 1575509482, "post_id": 59186690, "comment_id": 104593991, "body": "can you share the order of tests which worked for you? that would be a better answer which offer something to the reader"}, {"owner": {"reputation": 362, "user_id": 8202594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGi20.jpg?s=128&g=1", "display_name": "iwasidiotic", "link": "https://stackoverflow.com/users/8202594/iwasidiotic"}, "reply_to_user": {"reputation": 12075, "user_id": 8757883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gQGYY.png?s=128&g=1", "display_name": "Akber Iqbal", "link": "https://stackoverflow.com/users/8757883/akber-iqbal"}, "edited": false, "score": 0, "creation_date": 1575543267, "post_id": 59186690, "comment_id": 104605564, "body": "I am not sure, I just tried randomly moving the order of the tests and running <code>go test</code> after every change and it suddenly started working."}], "tags": [], "owner": {"reputation": 362, "user_id": 8202594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FGi20.jpg?s=128&g=1", "display_name": "iwasidiotic", "link": "https://stackoverflow.com/users/8202594/iwasidiotic"}, "is_accepted": false, "score": -1, "last_activity_date": 1608620847, "last_edit_date": 1608620847, "creation_date": 1575507425, "answer_id": 59186690, "question_id": 30832540, "link": "https://stackoverflow.com/questions/30832540/go-test-for-package-fails-but-individually-test-run-fine-and-package-compiles/59186690#59186690", "title": "`go test` for package fails but individually test run fine, and package compiles fine", "body": "<p>There is probably a routine leak. You maybe be modifying/updating a global variable  in the test and not reverting for the second test.\nSecond reason for this error could be your test in not running in a closed env. and effecting other test after.\nyou can re-structure your test so that the test giving error runs at first so that it succeeds</p>\n"}], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1797, "favorite_count": 0, "accepted_answer_id": 30835898, "answer_count": 2, "score": 2, "last_activity_date": 1608620847, "creation_date": 1434303643, "last_edit_date": 1434327209, "question_id": 30832540, "link": "https://stackoverflow.com/questions/30832540/go-test-for-package-fails-but-individually-test-run-fine-and-package-compiles", "title": "`go test` for package fails but individually test run fine, and package compiles fine", "body": "<p>When I execute <code>go test</code> for a whole package the tests fail with:</p>\n\n<pre><code>$ go test github.com/dm03514/go-edu-db/...\n# github.com/dm03514/go-edu-db/backends\ngo1: internal compiler error: in read_type, at go/gofrontend/import.cc:669\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;file:///usr/share/doc/gccgo-4.9/README.Bugs&gt; for instructions.\nFAIL    github.com/dm03514/go-edu-db/backends [build failed]\n?       github.com/dm03514/go-edu-db/cmd        [no test files]\n# github.com/dm03514/go-edu-db/httpd\ngo1: internal compiler error: in read_type, at go/gofrontend/import.cc:669\nPlease submit a full bug report,\nwith preprocessed source if appropriate.\nSee &lt;file:///usr/share/doc/gccgo-4.9/README.Bugs&gt; for instructions.\nFAIL    github.com/dm03514/go-edu-db/httpd [build failed]\n?       github.com/dm03514/go-edu-db/logging    [no test files]\n</code></pre>\n\n<p>While the above tests fail <code>go install</code> builds correctly and I can run each of my individual tests correctly:</p>\n\n<pre><code>$ go test github.com/dm03514/go-edu-db/backends/backends_test.go\nok      command-line-arguments  0.025s\n\n\ngo test github.com/dm03514/go-edu-db/httpd/handlers_test.go\nok      command-line-arguments  0.021s\n</code></pre>\n\n<p>Has anyone ran into this before?  I am brand new to Go, and to get around this I have just been executing each one of my test files individually.</p>\n\n<p>The output of go build is nothing</p>\n\n<pre><code>$ go build github.com/dm03514/go-edu-db/...\n$\n</code></pre>\n\n<p>go version is</p>\n\n<pre><code>$ go version\ngo version xgcc (Ubuntu 4.9-20140406-0ubuntu1) 4.9.0 20140405 (experimental) [trunk revision 209157] linux/amd64\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 6, "creation_date": 1434528641, "post_id": 30832195, "comment_id": 49811573, "body": "OP asked &quot;I just want to know if this server can be used in production or is it just a dummy server&quot;. This is not so much opinion based IMO, it&#39;s a focused question with a definite answer (yes), but not a straightforward programming question as well, I&#39;ll admit."}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 1598006, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4953ab121bc82272e81884d9c6e7392e?s=128&d=identicon&r=PG", "display_name": "Akash Kumar Sharma", "link": "https://stackoverflow.com/users/1598006/akash-kumar-sharma"}, "edited": false, "score": 0, "creation_date": 1434481202, "post_id": 30832453, "comment_id": 49793161, "body": "is it the google URL shortener that they use Go server in ?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 523, "user_id": 1598006, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4953ab121bc82272e81884d9c6e7392e?s=128&d=identicon&r=PG", "display_name": "Akash Kumar Sharma", "link": "https://stackoverflow.com/users/1598006/akash-kumar-sharma"}, "edited": false, "score": 2, "creation_date": 1434488048, "post_id": 30832453, "comment_id": 49796973, "body": "@AkashKumarSharma No idea. One thing I do know that runs on it is their download servers. See here, this is a great talk <a href=\"https://talks.golang.org/2013/oscon-dl.slide#1\" rel=\"nofollow noreferrer\">talks.golang.org/2013/oscon-dl.slide#1</a>"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 9, "last_activity_date": 1434309484, "last_edit_date": 1434309484, "creation_date": 1434303126, "answer_id": 30832453, "question_id": 30832195, "link": "https://stackoverflow.com/questions/30832195/using-gos-http-server-for-production/30832453#30832453", "title": "Using Go&#39;s HTTP server for production", "body": "<p>Short answer: YES.</p>\n\n<p>Longer answer: you can certainly use the built in Web server for production traffic. There's a good chance you've used it today, since Google serves some traffic using it. I know a lot of companies, including the one I work for that use it for production traffic. BTW I don't know of a Web server widely used in Go that does <em>not</em> use the standard web server.</p>\n\n<p>Keep in mind though that you need to tweak things like client timeouts to make it really robust, and perhaps limit incoming connections, etc.</p>\n"}, {"comments": [{"owner": {"reputation": 523, "user_id": 1598006, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4953ab121bc82272e81884d9c6e7392e?s=128&d=identicon&r=PG", "display_name": "Akash Kumar Sharma", "link": "https://stackoverflow.com/users/1598006/akash-kumar-sharma"}, "edited": false, "score": 0, "creation_date": 1434481109, "post_id": 30834807, "comment_id": 49793103, "body": "I plan to use nginx mainly for proxy caching now that it feels that Go server is a hefty performer itself."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 5, "last_activity_date": 1434317729, "creation_date": 1434317729, "answer_id": 30834807, "question_id": 30832195, "link": "https://stackoverflow.com/questions/30832195/using-gos-http-server-for-production/30834807#30834807", "title": "Using Go&#39;s HTTP server for production", "body": "<p>To add to @Not_a_Golfer's answer: Go's web-server is extremely solid and pretty well tested thus far.</p>\n\n<p>There are, however, reasons why you might put it behind a reverse proxy like nginx, Apache or HAProxy, including:</p>\n\n<ul>\n<li>SSL termination (nginx has a lot of additional TLS features that you'll have to partially implement yourself, like easy OCSP stapling support)</li>\n<li>Proxy caching (serving static responses from cache, or 500 if your Go app crashes)</li>\n<li>Performant logging</li>\n<li>SPDY support (although both Go &amp; nginx will probably get HTTP/2 at the same time)</li>\n<li>Built-in gzip support and options</li>\n<li>File descriptor caching for static files</li>\n</ul>\n\n<p>I <em>generally</em> prefer to put nginx in front if I have the option, because although you can implement all of those features in Go, there's a bit of wheel re-invention going on. You can get most of the way there with middleware like <a href=\"https://godoc.org/github.com/gorilla/handlers\" rel=\"noreferrer\">gorilla/handlers</a> and Go's own crypto/tls lib, and if you're not an ops person and/or want to keep things really thin, then running everything directly from Go is still fine for production.</p>\n"}], "owner": {"reputation": 523, "user_id": 1598006, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/4953ab121bc82272e81884d9c6e7392e?s=128&d=identicon&r=PG", "display_name": "Akash Kumar Sharma", "link": "https://stackoverflow.com/users/1598006/akash-kumar-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2092, "favorite_count": 1, "closed_date": 1434323109, "accepted_answer_id": 30832453, "answer_count": 2, "score": 11, "last_activity_date": 1434317729, "creation_date": 1434301650, "last_edit_date": 1434302990, "question_id": 30832195, "link": "https://stackoverflow.com/questions/30832195/using-gos-http-server-for-production", "closed_reason": "Opinion-based", "title": "Using Go&#39;s HTTP server for production", "body": "<p>I'm a PHP developer new to Golang. PHP comes with an inbuilt server which is not recommended for production. I read the <a href=\"http://astaxie.gitbooks.io/build-web-application-with-golang/\" rel=\"noreferrer\">beautiful book by astaxie</a> on web development in Go and also the <a href=\"http://golang.org/doc/articles/wiki/\" rel=\"noreferrer\">golang.org example on writing a web app</a>. They both use the <code>http.ListenAndServe()</code> to create a web server. I just want to know if this server can be used in production or is it just a dummy server like PHP inbuilt server? By production I mean, can it handle huge traffic like an Apache or ngnix server?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 3231, "user_id": 848761, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/041837a6aea172ce78918c7e3b53a277?s=128&d=identicon&r=PG", "display_name": "Johan S", "link": "https://stackoverflow.com/users/848761/johan-s"}, "edited": false, "score": 0, "creation_date": 1444244875, "post_id": 32999934, "comment_id": 53825626, "body": "I&#39;m just accepting this without further ado, since I&#39;ve dumped the project and Gorm."}, {"owner": {"reputation": 350, "user_id": 6901545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46758a78c383f768d5dfb9b262158842?s=128&d=identicon&r=PG&f=1", "display_name": "K1ngjulien", "link": "https://stackoverflow.com/users/6901545/k1ngjulien"}, "edited": false, "score": 4, "creation_date": 1594146140, "post_id": 32999934, "comment_id": 111022590, "body": "this does not answer the question. multiple primary keys means that each value individually also has to be unique, not just the combination of the two."}], "tags": [], "owner": {"reputation": 66, "user_id": 2217453, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4290b15aebda995d4e9308442732feaa?s=128&d=identicon&r=PG", "display_name": "n915", "link": "https://stackoverflow.com/users/2217453/n915"}, "is_accepted": true, "score": -7, "last_activity_date": 1464373828, "last_edit_date": 1464373828, "creation_date": 1444242945, "answer_id": 32999934, "question_id": 30831316, "link": "https://stackoverflow.com/questions/30831316/how-to-specify-a-struct-with-a-multi-column-unique-index-for-gorm/32999934#32999934", "title": "How to specify a struct with a multi-column unique index for Gorm?", "body": "<p>Are you trying to create a table so that the combination of First and Second is unique?</p>\n\n<p>This should work :</p>\n\n<pre><code>type Something struct {\n    ID uint\n    gorm.Model\n    First  string `gorm:\"primary_key\"`\n    Second string `gorm:\"primary_key\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4438, "user_id": 1287899, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9626e5ccaaecaa83f3600427f271bfc8?s=128&d=identicon&r=PG", "display_name": "Ahmed Hashem", "link": "https://stackoverflow.com/users/1287899/ahmed-hashem"}, "is_accepted": false, "score": 5, "last_activity_date": 1597885718, "last_edit_date": 1597885718, "creation_date": 1597883390, "answer_id": 63496734, "question_id": 30831316, "link": "https://stackoverflow.com/questions/30831316/how-to-specify-a-struct-with-a-multi-column-unique-index-for-gorm/63496734#63496734", "title": "How to specify a struct with a multi-column unique index for Gorm?", "body": "<p>You can define same unique index for each column.</p>\n<pre><code>type Something struct {\n    gorm.Model\n    First  string `sql:&quot;unique_index:idx_first_second&quot;`\n    Second string `sql:&quot;unique_index:idx_first_second&quot;`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 929, "user_id": 6146337, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/10207160730031528/picture?type=large", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/6146337/sebastian"}, "is_accepted": false, "score": 4, "last_activity_date": 1603047516, "creation_date": 1603047516, "answer_id": 64417193, "question_id": 30831316, "link": "https://stackoverflow.com/questions/30831316/how-to-specify-a-struct-with-a-multi-column-unique-index-for-gorm/64417193#64417193", "title": "How to specify a struct with a multi-column unique index for Gorm?", "body": "<p>this is how you do it: You need to use the gorm struct tag and specify that the index is unique</p>\n<pre><code>type Something struct {\n    gorm.Model\n    First  string `gorm:&quot;index:idx_name,unique&quot;`\n    Second string `gorm:&quot;index:idx_name,unique&quot;`\n}\n</code></pre>\n"}], "owner": {"reputation": 3231, "user_id": 848761, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/041837a6aea172ce78918c7e3b53a277?s=128&d=identicon&r=PG", "display_name": "Johan S", "link": "https://stackoverflow.com/users/848761/johan-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3631, "favorite_count": 2, "accepted_answer_id": 32999934, "answer_count": 3, "score": 4, "last_activity_date": 1603047516, "creation_date": 1434296634, "last_edit_date": 1434298653, "question_id": 30831316, "link": "https://stackoverflow.com/questions/30831316/how-to-specify-a-struct-with-a-multi-column-unique-index-for-gorm", "title": "How to specify a struct with a multi-column unique index for Gorm?", "body": "<p>How do I define my <code>struct</code>s to specify a multi-column unique index to Gorm in Go?</p>\n\n<p>Such as:</p>\n\n<pre><code>type Something struct {\n    gorm.Model\n    First  string `sql:\"unique_index:unique_index_with_second\"`\n    Second string `sql:\"unique_index:unique_index_with_first\"`\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434298888, "post_id": 30831162, "comment_id": 49708285, "body": "In your <code>log.Println(data)</code> if you want a byte slice to be formatted as something other a byte slice you need to either covert (e.g. <code>string(data)</code>) or use formatting (e.g. <code>log.Printf(&quot;HTTP Resp: % 02X&quot;, data)</code>, or <code>&quot;%s&quot;</code> maybe)."}, {"owner": {"reputation": 3164, "user_id": 189122, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/990a15efeada96538c75fbb986ecd599?s=128&d=identicon&r=PG", "display_name": "Julius F", "link": "https://stackoverflow.com/users/189122/julius-f"}, "reply_to_user": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434379716, "post_id": 30831162, "comment_id": 49739987, "body": "@DaveC the problem is not the log it&#39;s  Sending []byte Data over HTTP, receiving this []byte Data and encoding it back into the correct []byte Data"}], "answers": [{"tags": [], "owner": {"reputation": 3164, "user_id": 189122, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/990a15efeada96538c75fbb986ecd599?s=128&d=identicon&r=PG", "display_name": "Julius F", "link": "https://stackoverflow.com/users/189122/julius-f"}, "is_accepted": true, "score": 5, "last_activity_date": 1435403731, "creation_date": 1435403731, "answer_id": 31088135, "question_id": 30831162, "link": "https://stackoverflow.com/questions/30831162/using-protobuf-with-golang-and-handling-byte-http-response-body/31088135#31088135", "title": "Using protobuf with golang and handling []byte HTTP response body", "body": "<p>The problem was: I tried to write binary data to the output stream with <code>fmt.Fprint</code> missing the important fact, that the <code>fmt</code> package converts (everything?) input to a \"read-able\" format (ie strings).\nThe correct way of writting data into the output of your HTTP Response is using the responsewriter directly like this:</p>\n\n<pre><code>k, err := w.Write(data)\n</code></pre>\n"}], "owner": {"reputation": 3164, "user_id": 189122, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/990a15efeada96538c75fbb986ecd599?s=128&d=identicon&r=PG", "display_name": "Julius F", "link": "https://stackoverflow.com/users/189122/julius-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4484, "favorite_count": 1, "accepted_answer_id": 31088135, "answer_count": 1, "score": 0, "last_activity_date": 1435403731, "creation_date": 1434295707, "last_edit_date": 1434297372, "question_id": 30831162, "link": "https://stackoverflow.com/questions/30831162/using-protobuf-with-golang-and-handling-byte-http-response-body", "title": "Using protobuf with golang and handling []byte HTTP response body", "body": "<p>I am using the Golang protobuf package and try to write some tests to ensure my API works properly.</p>\n\n<p>I construct an Object on the server-side with a generated <code>.pb.go</code> file.</p>\n\n<p>And return it with</p>\n\n<pre><code>data, err := proto.Marshal(p)\nfmt.Fprint(w, data)\n</code></pre>\n\n<p>And in my test I do</p>\n\n<pre><code>func TestGetProduct(t *testing.T) {\n    log.Println(\"Starting server\")\n    go startAPITestServer()\n    time.Sleep(0 * time.Second)\n    log.Println(\"Server started\")\n    //rq, err := http.NewRequest(\"GET\", \"localhost:8181/product/1\", nil)\n    client := &amp;http.Client{}\n    log.Println(\"Starting Request\")\n    resp, err := client.Get(\"http://localhost:8181/product/1\")\n    log.Println(\"Finished Request\")\n    if err != nil {\n        t.Log(err)\n    }\n    defer resp.Body.Close()\n    log.Println(\"Reading Request\")\n    data, err := ioutil.ReadAll(resp.Body)\n    log.Println(\"Reading finished\")\n    if err != nil {\n        t.Log(err)\n    }\n    log.Println(\"HTTP Resp\", data)\n    p := &amp;Product{}\n    proto.UnmarshalText(string(data), p)\n    proto.Unmarshal(data, p2)\n}\n</code></pre>\n\n<p>The Problem is that the HTTP Request is correct and displays the <code>[]byte</code> correctly, but if I do <code>ioutil.ReadAll</code> it interprets the HTTP Response as a string and converts it to a <code>[]byte</code>.</p>\n\n<p>For example the response is </p>\n\n<pre><code>[12 3 2 14 41]\n</code></pre>\n\n<p>Then <code>ioutil.ReadAll</code> interprets this as a string and not as a <code>[]byte</code>.</p>\n"}, {"tags": ["json", "reflection", "go"], "answers": [{"comments": [{"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1434281027, "post_id": 30828321, "comment_id": 49702801, "body": "tanx , tested it but I got the same result"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1434283612, "post_id": 30828321, "comment_id": 49703439, "body": "@Mohsen I&#39;m doing the exact same thing in my code and it works perfectly. Are you sure there&#39;s data coming in?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "edited": false, "score": 0, "creation_date": 1434283935, "post_id": 30828321, "comment_id": 49703527, "body": "@Mohsen I&#39;ve created a simplified working example in the playground. See the answer&#39;s edited text."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 4, "last_activity_date": 1434283919, "last_edit_date": 1434283919, "creation_date": 1434277913, "answer_id": 30828321, "question_id": 30828258, "link": "https://stackoverflow.com/questions/30828258/convert-json-to-struct-using-reflection-in-golang/30828321#30828321", "title": "Convert json to struct using reflection in golang", "body": "<p>The problem is that you are passing a non pointer instance of the type:</p>\n\n<pre><code>payload:=reflect.New(v).Elem().Interface()\n</code></pre>\n\n<p>Means \"allocate a new pointer to the type, then take the value of it, and extract it as <code>interface{}</code>.</p>\n\n<p>You should just keep it at:</p>\n\n<pre><code>payload:=reflect.New(v).Interface()\n</code></pre>\n\n<p>BTW It's also redundant that you are passing the type of a pointer, extracting its <code>Elem()</code>, then allocating a pointer. Do something like this:</p>\n\n<pre><code>if type.Kind() == reflect.Ptr {\n   typ = typ.Elem()\n}\n\npayload := reflect.New(typ).Interface()\n</code></pre>\n\n<p>then you can pass both pointers and non pointers to the function.</p>\n\n<p><strong>Edit: Working playground example: <a href=\"http://play.golang.org/p/TPafxcpIU5\" rel=\"nofollow\">http://play.golang.org/p/TPafxcpIU5</a></strong> </p>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1642, "favorite_count": 0, "accepted_answer_id": 30828321, "answer_count": 1, "score": 1, "last_activity_date": 1434283919, "creation_date": 1434277520, "question_id": 30828258, "link": "https://stackoverflow.com/questions/30828258/convert-json-to-struct-using-reflection-in-golang", "title": "Convert json to struct using reflection in golang", "body": "<pre><code>func deserialize(request *http.Request,typ reflect.Type) (interface{}, *httpNet.HandlerError){\n\n    data,e:=ioutil.ReadAll(request.Body)\n    fmt.Println(string(data))\n    if e !=nil{\n        return nil,&amp;httpNet.HandlerError{e,\"could not read request\",http.StatusBadRequest}\n    }\n\n    v:=typ.Elem()\n    payload:=reflect.New(v).Elem().Interface()\n\n    eaa:= json.NewDecoder(request.Body).Decode(payload)\n\n    if e!=nil{\n        fmt.Println(eaa.Error())\n    }\n    fmt.Println(payload)\n    fmt.Println(reflect.ValueOf(payload)\n        )\n    return payload,nil\n\n}\n</code></pre>\n\n<p>to call it:</p>\n\n<pre><code>r,_:= deserialize(request,reflect.TypeOf(&amp;testData{}))\n</code></pre>\n\n<p>It does not throw errors and looks completely valid operation to me , but the result is an empty structure of expecting type.</p>\n\n<p>Whats the problem with that?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434273783, "post_id": 30827729, "comment_id": 49700988, "body": "is it really that bad?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1434273980, "post_id": 30827729, "comment_id": 49701047, "body": "Python&#39;s <code>Queue.PriorityQueue</code> isn&#39;t the recommended way to get a priority queue unless you specifically want to use it to exchange information across threads; it has a whole bunch of synchronization-related overhead associated with it, and several of the basic container operations have weird names because those operations don&#39;t make much sense in a multithreaded context."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1434274353, "post_id": 30827729, "comment_id": 49701127, "body": "@user2357112 thank you for a comment, but I have never told that <code>Queue.PriorityQueue</code> is recommended in python. I just gave it as an example of simple to import module (I didn&#39;t want to mention <code>heapq</code>, because I was afraid that people misinterpret it as I am looking for a heap module). What I am looking for is recommended way to use priority queue in go."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1434278172, "post_id": 30827729, "comment_id": 49702039, "body": "I don&#39;t know of a better way than the one mentioned in your question."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1434311493, "post_id": 30827729, "comment_id": 49712180, "body": "@Not_a_Golfer this is sad. But thank you for clarifying this."}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1434312247, "post_id": 30828744, "comment_id": 49712421, "body": "Thank you. Just find it strange that C++ gives such abstraction, and go decide to &quot;give me control&quot;. Why not to give me control with implementing my heap, my sort (both implementations would not be big). Stoping my rant here."}], "tags": [], "owner": {"reputation": 2911, "user_id": 702065, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/ae529fa78546d54e42c26bd3713946a2?s=128&d=identicon&r=PG", "display_name": "Johan Wikstr&#246;m", "link": "https://stackoverflow.com/users/702065/johan-wikstr%c3%b6m"}, "is_accepted": false, "score": 0, "last_activity_date": 1434280787, "creation_date": 1434280787, "answer_id": 30828744, "question_id": 30827729, "link": "https://stackoverflow.com/questions/30827729/does-go-has-out-of-the-box-priority-queue/30828744#30828744", "title": "Does Go has out of the box priority queue?", "body": "<p>Quoting Wikipedia:</p>\n\n<blockquote>\n  <p>a priority queue is an abstract data type which is like a regular queue or stack data structure, but where additionally each element has a \"priority\" associated with it. [...] While priority queues are often implemented with heaps, they are conceptually distinct from heaps. A priority queue is an abstract concept like \"a list\" or \"a map\";</p>\n</blockquote>\n\n<p>Go provides some basic data structures that are used in most applications but leave the implementation of more specialized data structures to the programmer. For example, the go map can be used to trivially implement a set.</p>\n\n<p><a href=\"http://golang.org/pkg/container/heap/\" rel=\"nofollow\">The example</a> you link to uses a slice <code>[]*Item</code> to represent the more abstract type <code>heap.Interface</code> and also the (even more abstract) type <code>PriorityQueue</code>. Go is about composition and I would say that implementing <code>PriorityQueue</code> in terms of heap operations is good practice.</p>\n\n<p>This gives you control as a programmer. If you want thread safety, use the composition of <code>PriorityQueue</code> and <code>sync.Mutex</code> to make it thread safe. If you want a different implementation than a heap, make <code>PriorityQueue</code> an interface and you can implement it however you want.</p>\n\n<p>Of course there's a trade-off. In this case, the implementation was ~25 lines of code. If the implementation was  hundreds of lines you'd probably want to find a package that has done this already.</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1543, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434280787, "creation_date": 1434273475, "last_edit_date": 1434275917, "question_id": 30827729, "link": "https://stackoverflow.com/questions/30827729/does-go-has-out-of-the-box-priority-queue", "title": "Does Go has out of the box priority queue?", "body": "<p>Does Go has out of the box priority queue (the one that I can just import from some module and start using like python's <a href=\"https://docs.python.org/2/library/queue.html#Queue.PriorityQueue\" rel=\"nofollow\">priority queue</a>)?</p>\n\n<p>I know that priority queues are often implemented using heap data structure and go has a <a href=\"http://golang.org/pkg/container/heap/\" rel=\"nofollow\">heap package</a>, which also suggests how to use it to implement a queue (in <strong>Example (PriorityQueue)</strong> ), which I can easily grab and use.</p>\n\n<p>My question is this a recommended way to do this, or there is an out of the box Priority Queue package that I failed to find?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 387, "user_id": 4570301, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FOmaAHcDY4U/AAAAAAAAAAI/AAAAAAAAA_k/lJ8TnGdIYI4/photo.jpg?sz=128", "display_name": "Walter Delevich", "link": "https://stackoverflow.com/users/4570301/walter-delevich"}, "is_accepted": false, "score": 1, "last_activity_date": 1434262615, "last_edit_date": 1434262615, "creation_date": 1434260742, "answer_id": 30826321, "question_id": 30825996, "link": "https://stackoverflow.com/questions/30825996/multiline-input-in-a-terminal-go-application/30826321#30826321", "title": "multiline input in a terminal Go application", "body": "<p>Look at the documentation for <a href=\"http://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow\">bufio.ReadString</a>, it states that the character you pass to it will cause the function to stop reading and return. If you want to accept multi-line input, you'll need to come up with some scheme to differentiate newlines ('\\n') that continue a statement, and whatever <em>terminates</em> a statement.</p>\n\n<p><strong>edit:</strong> Here is a bad quick hacky example that extends your code to recognize multi-line input. It does this by defining the \"termination\" of a statement to be the empty string containing only \"\\n\". You can see it's just buffering multiple reads into one \"block\". You can get more clever and read the keyboard directly, but regardless you'll have to define some scheme that you can programmatically recognize as being multi-line vs. single line.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    cnt := false\n    var txt []byte\n    for {\n        result := make([]byte, 1024)\n        if cnt == false {\n            fmt.Println(\"How to read all lines here?\")\n        }\n        in := bufio.NewReader(os.Stdin)\n        _, err := in.Read(result)\n\n        if err != nil {\n            fmt.Println(err)\n        }\n        if result[0] == '\\n' {\n            cnt = false\n            fmt.Printf(\"&lt;----\\n%s----&gt;\\n\", string(txt))\n            txt = txt[:0]\n        } else {\n            txt = append(txt, result...)\n            cnt = true\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4396548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb6d1e91651b97b3bcea367fe48ffbc0?s=128&d=identicon&r=PG&f=1", "display_name": "vladwd", "link": "https://stackoverflow.com/users/4396548/vladwd"}, "is_accepted": false, "score": 0, "last_activity_date": 1434269762, "creation_date": 1434269762, "answer_id": 30827268, "question_id": 30825996, "link": "https://stackoverflow.com/questions/30825996/multiline-input-in-a-terminal-go-application/30827268#30827268", "title": "multiline input in a terminal Go application", "body": "<p><code>EOF</code> can not help you, because <code>io.EOF</code> has type of '<code>error</code>', but <code>in.ReadString</code> expects a byte (the sequence <code>'\\n'</code> - is a byte). But anyway, if I understand your goals, you need some way to stop reading from stdin. For example, a specific string. Like mysql client expects \"<strong>exit;</strong>\" string to end your session. </p>\n\n<p>Take a look at scanning lines example \n<a href=\"http://golang.org/pkg/bufio/#example_Scanner_lines\" rel=\"nofollow\">http://golang.org/pkg/bufio/#example_Scanner_lines</a>\nand improve it replacing</p>\n\n<pre><code>fmt.Println(scanner.Text()) // Println will add back the final '\\n'\n</code></pre>\n\n<p>with something like:</p>\n\n<pre><code>allInput += scanner.Text() + \"\\n\"\nif scanner.Text() == \"exit;\" {\n    //your actions on exit...\n    //...    \n    fmt.Println(\"Exiting. By\")\n    return\n}\n</code></pre>\n\n<p>Or if you want you program to work in pipes and take multiline input from other program output, you can use <code>io.ReadFull</code> or <code>PipeReader</code> functions</p>\n"}, {"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1434280116, "post_id": 30827547, "comment_id": 49702547, "body": "It does not work when I am trying to paste multiline text with an empty line between words from the clipboard."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1434291333, "post_id": 30827547, "comment_id": 49705787, "body": "@MaximYefremov: It does now. See my revised answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 8, "last_activity_date": 1434292550, "last_edit_date": 1434292550, "creation_date": 1434272014, "answer_id": 30827547, "question_id": 30825996, "link": "https://stackoverflow.com/questions/30825996/multiline-input-in-a-terminal-go-application/30827547#30827547", "title": "multiline input in a terminal Go application", "body": "<p>Buffer a set of lines and detect the end of a set of lines. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    scn := bufio.NewScanner(os.Stdin)\n    for {\n        fmt.Println(\"Enter Lines:\")\n        var lines []string\n        for scn.Scan() {\n            line := scn.Text()\n            if len(line) == 1 {\n                // Group Separator (GS ^]): ctrl-]\n                if line[0] == '\\x1D' {\n                    break\n                }\n            }\n            lines = append(lines, line)\n        }\n\n        if len(lines) &gt; 0 {\n            fmt.Println()\n            fmt.Println(\"Result:\")\n            for _, line := range lines {\n                fmt.Println(line)\n            }\n            fmt.Println()\n        }\n\n        if err := scn.Err(); err != nil {\n            fmt.Fprintln(os.Stderr, err)\n            break\n        }\n        if len(lines) == 0 {\n            break\n        }\n    }\n}\n</code></pre>\n\n<p>Console:</p>\n\n<pre>\nEnter Lines:\nHello\nWorld\n^]\n\nResult:\nHello\nWorld\n\nEnter Lines:\nFarewell\n\nWorld\n\n^]\n\nResult:\nFarewell\n\nWorld\n\n\nEnter Lines:\n^]\n</pre>\n\n<p>To terminate a set of lines, on an empty line, enter: &lt;<code>ctrl+</code>]>&lt;<code>Enter</code>>. To terminate input, enter a single line: &lt;<code>ctrl+</code>]>&lt;<code>Enter</code>>.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3643, "favorite_count": 1, "accepted_answer_id": 30827547, "answer_count": 3, "score": 2, "last_activity_date": 1434292550, "creation_date": 1434256854, "last_edit_date": 1434291840, "question_id": 30825996, "link": "https://stackoverflow.com/questions/30825996/multiline-input-in-a-terminal-go-application", "title": "multiline input in a terminal Go application", "body": "<p>I need to let a user input multiline text to the console.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    for {\n        fmt.Println(\"How to read all lines here?\")\n        in := bufio.NewReader(os.Stdin)\n        result, err := in.ReadString('\\n')\n        if err != nil {\n            fmt.Println(err)\n        }\n        fmt.Println(\"\\nresult\")\n        fmt.Println(result)     \n\n    }\n}\n</code></pre>\n\n<p>I pasted in the console:</p>\n\n<pre><code>    Hello\n    World\n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>How to read all lines here?\n\n        Hello\n        World\n\n\nresult\n\n\nHow to read all lines here?\n\nresult\n        Hello\n\nHow to read all lines here?\n\nresult\n        World\n\nHow to read all lines here?\n\nresult\n\n\nHow to read all lines here?\n</code></pre>\n\n<p>But I expect it to be:</p>\n\n<pre><code>         How to read all lines here?\n\n                Hello\n                World\n\n\n        result\n\n\n        How to read all lines here?\n\n        result\n                Hello\n                World\n\n        How to read all lines here?\n</code></pre>\n\n<p>I guess I need to use something like <code>EOF</code> instead of <code>'\\n'</code>\n But how to do it exactly?</p>\n\n<h1>Update</h1>\n\n<p>peterSo's answer works except in case when I am trying to paste from clipboard a text with one or more empty lines in-between, like:</p>\n\n<pre><code>Hello\n\nWorld\n</code></pre>\n\n<p>It prints</p>\n\n<pre><code>Enter Lines:\nHello\n\nWorldResult:\nHello\n\nEnter Lines:\n</code></pre>\n\n<h1>Update 2</h1>\n\n<p>The great updated peterSO's answer now works even for text with empty lines.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1971, "user_id": 605027, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e8f11f30d46f5346e4183aaa74064222?s=128&d=identicon&r=PG", "display_name": "Madhur", "link": "https://stackoverflow.com/users/605027/madhur"}, "is_accepted": false, "score": 1, "last_activity_date": 1434225246, "creation_date": 1434225246, "answer_id": 30822918, "question_id": 30822799, "link": "https://stackoverflow.com/questions/30822799/go-error-undefined-html-template-parsefile/30822918#30822918", "title": "go error: undefined: &quot;html/template&quot;.ParseFile", "body": "<p>It should be <code>template.ParseFiles(\"edit.html\")</code></p>\n\n<p>plural not singular</p>\n\n<p><a href=\"http://golang.org/pkg/html/template/#ParseFiles\" rel=\"nofollow\">http://golang.org/pkg/html/template/#ParseFiles</a></p>\n"}], "owner": {"reputation": 25, "user_id": 5006956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6406ce7174078692458cfa3cac256961?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Aleynikov", "link": "https://stackoverflow.com/users/5006956/oleg-aleynikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1572, "favorite_count": 0, "closed_date": 1434308768, "answer_count": 1, "score": -1, "last_activity_date": 1434225246, "creation_date": 1434224483, "last_edit_date": 1434224773, "question_id": 30822799, "link": "https://stackoverflow.com/questions/30822799/go-error-undefined-html-template-parsefile", "closed_reason": "Not suitable for this site", "title": "go error: undefined: &quot;html/template&quot;.ParseFile", "body": "<p>I have the following error while compiling the code\n\"html/template undefined: \"html/template\".ParseFile\"</p>\n\n<p>at the string of the source code \"t, _ := template.ParseFile(\"edit.html\", nil)\"</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"      \n    \"io/ioutil\"\n    \"html/template\"\n)\n\n    type Page struct {\n        Title string\n        Body  []byte\n        }\n\n    func (p *Page) save() error {\n            filename := p.Title + \".txt\"\n            return ioutil.WriteFile(filename, p.Body, 0600)\n    }\n\n    func loadPage(title string) (*Page, error) {\n        filename := title + \".txt\"\n        body, err := ioutil.ReadFile(filename)\n        if err != nil {\n            return nil, err\n        }\n        return &amp;Page{Title: title, Body: body}, nil\n    }\n\n    const lenPath = len(\"/view/\")\n\n\n    func editHandler(w http.ResponseWriter, r *http.Request) {\n        title := r.URL.Path[lenPath:]\n        p, err := loadPage(title)\n        if err != nil {\n            p = &amp;page{title: title}\n        }\n        t, _ := template.ParseFile(\"edit.html\", nil)\n        t.Execute(p, w)\n    }\n\n    func main() {\n        http.HandleFunc(\"/edit/\", editHandler)\n        http.ListenAndServe(\":8080\", nil)\n    }\n</code></pre>\n\n<p>Help tp remove this error.</p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 5, "creation_date": 1434240178, "post_id": 30822458, "comment_id": 49695359, "body": "I <b><a href=\"http://elithrar.github.io/article/approximating-html-template-inheritance/\" rel=\"nofollow noreferrer\">wrote about this</a></b> a while back\u2014a buffer pool either via <code>sync.Pool</code> or another construct\u2014is a slightly more performant way to solve this. Allocate a pool, Get a buffer, write to it and then to the response (on nil error) and then Put the buffer back into the pool. Otherwise you&#39;re on point!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 9, "last_activity_date": 1434223184, "last_edit_date": 1434223184, "creation_date": 1434222278, "answer_id": 30822458, "question_id": 30821745, "link": "https://stackoverflow.com/questions/30821745/idiomatic-way-to-handle-template-errors-in-golang/30822458#30822458", "title": "Idiomatic way to handle template errors in golang", "body": "<p>Since the template engine generates the output on-the-fly, parts of the template preceding the <code>SomeFunc</code> call are already sent to the output. And if the output is not buffered, they (along with the HTTP 200 status) may already be sent.</p>\n\n<p>You can't do anything about that.</p>\n\n<p>What you can do is perform the check before you call <a href=\"http://golang.org/pkg/html/template/#Template.Execute\" rel=\"noreferrer\"><code>template.Execute()</code></a>. In trivial case it should be enough to call <code>SomeFunc()</code> and check its return value. If you choose this path and the return value of <code>SomeFunc()</code> is complex, you do not have to call it again from the template, you can simply pass its return value to the params you pass to the template and refer to this value in the template (so <code>SomeFunc()</code> won't have to be executed twice).</p>\n\n<p>If this is not enough or you can't control it, you can create a <a href=\"http://golang.org/pkg/bytes/#Buffer\" rel=\"noreferrer\"><code>bytes.Buffer</code></a>, execute your template directed into this buffer, and after the <code>Execute()</code> returns, check if there were errors. If there were errors, send back a proper error message / page. If everything went ok, you can just send the content of the buffer to the <a href=\"http://golang.org/pkg/net/http/#ResponseWriter\" rel=\"noreferrer\"><code>ResponseWriter</code></a>.</p>\n\n<p>This could look something like this:</p>\n\n<pre><code>buf := &amp;bytes.Buffer{}\nerr := tmpl.Execute(buf, data)\nif err != nil {\n    // Send back error message, for example:\n    http.Error(w, \"Hey, Request was bad!\", http.StatusBadRequest) // HTTP 400 status\n} else {\n    // No error, send the content, HTTP 200 response status implied\n    buf.WriteTo(w)\n}\n</code></pre>\n"}], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2913, "favorite_count": 1, "answer_count": 1, "score": 9, "last_activity_date": 1434223184, "creation_date": 1434217786, "question_id": 30821745, "link": "https://stackoverflow.com/questions/30821745/idiomatic-way-to-handle-template-errors-in-golang", "title": "Idiomatic way to handle template errors in golang", "body": "<p>Say I have a <code>html/template</code> like the following:</p>\n\n<pre><code>&lt;html&gt;\n&lt;body&gt;\n    &lt;p&gt;{{SomeFunc .SomeData}}&lt;/p&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>and sometimes <code>SomeFunc</code> returns an error. Is there an idiomatic way to deal with this?</p>\n\n<p>If I write directly to the <code>ResponseWriter</code>, then a status code 200 has already been written before I encounter the error.</p>\n\n<pre><code>var tmpl *template.Template\n\nfunc Handler(w http.ResponseWriter, r *http.Request) {\n    err := tmpl.Execute(w, data)\n    // \"&lt;html&gt;&lt;body&gt;&lt;p&gt;\" has already been written...\n    // what to do with err?\n}\n</code></pre>\n\n<p>Preferably I would return a status code 400 or some such, but I can't see a way to do this if I use <code>template.Execute</code> directly on the <code>ResponseWriter</code>. Is there something I'm missing?</p>\n"}, {"tags": ["inheritance", "go"], "comments": [{"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 1, "creation_date": 1434189791, "post_id": 30816630, "comment_id": 49681515, "body": "Having an anonymous interface member in your struct like this is probably not what you want.  It will cause your struct to implement the interface, but probably not in the way you&#39;d  think.  Any method of interface you don&#39;t implement on your struct will end up being delegated to this member.  And if you&#39;ve left it set to <code>nil</code>, you&#39;ve turned what could have been a simple compile error into a runtime error."}, {"owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1434400336, "post_id": 30816630, "comment_id": 49752341, "body": "Thanks for the note @JamesHenstridge. I thought that was the recommended way as per many online resources. Having a name makes it look ugly."}, {"owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1434400363, "post_id": 30816630, "comment_id": 49752359, "body": "So why the -1 ? Please add a note."}, {"owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "reply_to_user": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1434404377, "post_id": 30816630, "comment_id": 49754292, "body": "@JamesHenstridge: the issue you mentioned should pass if the base has a default implementation of all methods, correct ?"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1434441862, "post_id": 30816630, "comment_id": 49766282, "body": "An interface has no implementation.  Think of it more like a Java interface (without the need to explicitly state you implement it), rather than a C++ class with a few abstract virtual methods."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1434189540, "creation_date": 1434189540, "answer_id": 30817364, "question_id": 30816630, "link": "https://stackoverflow.com/questions/30816630/golang-equivalent-for-inheritence-using-interface-with-data-and-member-functions/30817364#30817364", "title": "GoLang equivalent for inheritence using interface with data and member functions", "body": "<p>There is no inheritance in Go. Use composition:</p>\n\n<pre><code>type common struct {\n    data DatumType\n}\n\nfunc (c *common) commonFunc() {\n    // Do something with data.\n}\n\ntype derived1 struct {\n    common\n    otherField1 int\n}\n\n// Implement other methods on derived1.\n\ntype derived2 struct {\n    common\n    otherField2 string\n}\n\n// Implement other methods on derived2.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434199720, "post_id": 30817371, "comment_id": 49684105, "body": "You don&#39;t have to name the embedded struct as you can access it by name of type (d.base.data in this case).  Example: <a href=\"http://play.golang.org/p/x5BISwEWI8\" rel=\"nofollow noreferrer\">play.golang.org/p/x5BISwEWI8</a>"}, {"owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1434200815, "post_id": 30817371, "comment_id": 49684437, "body": "Tks, didn&#39;t know that! It&#39;s actually mentioned in the Effective Go section I linked but I didn&#39;t get from that that this works for any field. Good to know. Edited my answer accordingly."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 3, "last_activity_date": 1434200715, "last_edit_date": 1434200715, "creation_date": 1434189582, "answer_id": 30817371, "question_id": 30816630, "link": "https://stackoverflow.com/questions/30816630/golang-equivalent-for-inheritence-using-interface-with-data-and-member-functions/30817371#30817371", "title": "GoLang equivalent for inheritence using interface with data and member functions", "body": "<p>Go does not have inheritance. Instead it offers the concept of <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a>.</p>\n\n<p>In this case you don't need/want to define <code>base</code> as an <code>interface</code>. Make it a struct and define the functions as methods. Then embedding <code>base</code> in your derived structs will give them those methods.</p>\n\n<pre><code>type base struct{\n    data DatumType     \n}\nfunc (b base) func1(){\n\n}\n\nfunc (b base) func2(){\n\n}\n\nfunc (b base) common_func(){\n\n}\n\ntype derived1 struct {\n    base // anonymous meaning embedding\n}\n\ntype derived2 struct {\n    base // anonymous meaning embedding\n}\n</code></pre>\n\n<p>Now you can do:</p>\n\n<pre><code>d := derived1{}\nd.func1()\nd.func2()\nd.common_func()\n</code></pre>\n\n<p>And (as pointed out by  David Budworth in the comment) you can access the fields of <code>base</code> by referring to it's type name like so:</p>\n\n<pre><code>d.base.data = something\n</code></pre>\n"}], "owner": {"reputation": 6058, "user_id": 1952500, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/cd15d38fd1e508e6c2bcad9e153e789d?s=128&d=identicon&r=PG", "display_name": "user1952500", "link": "https://stackoverflow.com/users/1952500/user1952500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 0, "accepted_answer_id": 30817371, "answer_count": 2, "score": -1, "last_activity_date": 1484635631, "creation_date": 1434183888, "last_edit_date": 1484635631, "question_id": 30816630, "link": "https://stackoverflow.com/questions/30816630/golang-equivalent-for-inheritence-using-interface-with-data-and-member-functions", "title": "GoLang equivalent for inheritence using interface with data and member functions", "body": "<p>I am a golang newbie so pardon me if there is something obvious I am missing. I have the following structures:</p>\n\n<pre><code>type base interface {\n    func1()\n    func2()\n    common_func()\n}\n\ntype derived1 struct {\n    base // anonymous meaning inheritence\n    data DatumType\n}\n\ntype derived2 struct {\n    base // anonymous meaning inheritence\n    data DatumType\n}\n</code></pre>\n\n<p>Now I want to do the following:</p>\n\n<ol>\n<li>Keep '<code>data DatumType</code>' with <code>base</code> in some way so that looking at the definition of <code>base</code> one can know what data is common to all structs.\n<ol start=\"2\">\n<li>Implement <code>common_func()</code> in one place so that the derived structs don't need to do it.</li>\n</ol></li>\n</ol>\n\n<p>I tried implementing the function with the interface but it fails compilation. I tried to create a struct and inherit from that but am not finding good ways to do that. Is there some clean way out ?</p>\n"}, {"tags": ["go", "https"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434181513, "post_id": 30815244, "comment_id": 49679718, "body": "Is it really that inconvenient to convert a byte slice into a string?"}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434187575, "post_id": 30815244, "comment_id": 49680968, "body": "@Volker maybe I didn&#39;t make my question clear enough for you. What I wanted was to pass in the content of the key file in terms of byte array/slice instead of passing in the path of the key file in terms of string. I don&#39;t see how what you said is relevant to my question."}, {"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434189739, "post_id": 30815244, "comment_id": 49681500, "body": "@Volker did you really understand the question before you made the comment?"}], "answers": [{"comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "edited": false, "score": 0, "creation_date": 1434201794, "post_id": 30818656, "comment_id": 49684713, "body": "Thank you Dave for the playground code. That would be a nasty option, but seems nothing is better than it now. Yeah, I would like to submit a feature request, but I need to learn a bit more about how to communicate with the Golang devs. I was also thinking about another nasty option, to download the key files, and store it in a temporary place, start the server and delete it. What an awkward option."}, {"owner": {"reputation": 169, "user_id": 1974533, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7Jb0P.jpg?s=128&g=1", "display_name": "Maxux", "link": "https://stackoverflow.com/users/1974533/maxux"}, "edited": false, "score": 8, "creation_date": 1458731219, "post_id": 30818656, "comment_id": 59988216, "body": "<a href=\"https://github.com/golang/go/commit/f81f6d6ee8a7f578ab19ccb8b7dbc3b6fff81aa0\" rel=\"nofollow noreferrer\">github.com/golang/go/commit/&hellip;</a> Since this commit, you can pass empty string to do that"}, {"owner": {"reputation": 4687, "user_id": 2176740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09c0ea83bcb343688502045304a0474?s=128&d=identicon&r=PG", "display_name": "joonas.fi", "link": "https://stackoverflow.com/users/2176740/joonas-fi"}, "edited": false, "score": 2, "creation_date": 1490348133, "post_id": 30818656, "comment_id": 73081850, "body": "Maxux: awesome, worked like a charm! So just define srv.TLSConfig = &amp;tls.Config{Certificates: ... } before calling srv.ListenAndServeTLS(&quot;&quot;, &quot;&quot;)"}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": true, "score": 5, "last_activity_date": 1434198331, "creation_date": 1434198331, "answer_id": 30818656, "question_id": 30815244, "link": "https://stackoverflow.com/questions/30815244/golang-https-server-passing-certfile-and-kyefile-in-terms-of-byte-array/30818656#30818656", "title": "Golang https server passing certFile and kyeFile in terms of byte array", "body": "<p>Looking <a href=\"https://github.com/golang/go/blob/883bc6ed0ea815293fe6309d66f967ea60630e87/src/net/http/server.go#L1853-L1880\" rel=\"noreferrer\">at the source of <code>ListenAndServeTLS</code></a> it seems that there is no option, it always calls <a href=\"https://golang.org/pkg/crypto/tls/#LoadX509KeyPair\" rel=\"noreferrer\"><code>tls.LoadX509KeyPair</code></a>.\nThat's unfortunate; possibly worth submitting a feature request.</p>\n\n<p>In the meantime, the <code>ListenAndServeTLS</code> method is not large, and (other than <code>tcpKeepAliveListener</code>) it does not use anything non-exported so it'd simple to copy the body of that method to your own function and replace <code>Load509KeyPair</code> with <a href=\"https://golang.org/pkg/crypto/tls/#X509KeyPair\" rel=\"noreferrer\"><code>tls.X509KeyPair</code></a>, which does take <code>[]byte</code> of PEM encoded data rather than filenames. (Or perhaps take a <code>tls.Certificate</code> argument instead.)</p>\n\n<p>E.g.\u00a0something like <a href=\"https://play.golang.org/p/ui_8dS8ouU\" rel=\"noreferrer\">https://play.golang.org/p/ui_8dS8ouU</a></p>\n"}], "owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 1, "accepted_answer_id": 30818656, "answer_count": 1, "score": 1, "last_activity_date": 1434203574, "creation_date": 1434171322, "last_edit_date": 1434203574, "question_id": 30815244, "link": "https://stackoverflow.com/questions/30815244/golang-https-server-passing-certfile-and-kyefile-in-terms-of-byte-array", "title": "Golang https server passing certFile and kyeFile in terms of byte array", "body": "<pre><code>func ListenAndServeTLS(addr string, certFile string, keyFile string, handler Handler) error\n</code></pre>\n\n<p>Above is the function that I call to start an https server in Golang. It works without any problem. However, as I have more deployments, I don't want to put my key files everywhere. So I am thinking to let the program download the key file and cert file from a centralized place. If there would be a similar function receiving <code>[]byte</code> as opposed to <code>string</code>, it would be easy for me to do that. But it seems I don't see such function in the documentations. </p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "edited": false, "score": 0, "creation_date": 1434178891, "post_id": 30815746, "comment_id": 49679216, "body": "Is it comes from <code>unsafe</code> package? Because I&#39;m using Echo framework, where should I place in my codes?"}, {"owner": {"reputation": 353, "user_id": 650897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2ecdfa7f4d1813ae6411c5861622571?s=128&d=identicon&r=PG", "display_name": "enkdr", "link": "https://stackoverflow.com/users/650897/enkdr"}, "reply_to_user": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "edited": false, "score": 0, "creation_date": 1434180956, "post_id": 30815746, "comment_id": 49679618, "body": "It comes from html/template package - I&#39;m not familiar with Echo framework. I just named the function I wrote in the answer &#39;unsafe&#39;. You should be able to put anywhere really and pass your Content string into it."}, {"owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "edited": false, "score": 0, "creation_date": 1434183078, "post_id": 30815746, "comment_id": 49680017, "body": "Thanks a lot. I still working to find the solution. I&#39;m using <code>text&#47;template</code> as temporary workaround."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "edited": false, "score": 0, "creation_date": 1434193718, "post_id": 30815746, "comment_id": 49682481, "body": "@W.Mar The function you&#39;re looking for is this one: <a href=\"http://golang.org/pkg/html/template/#HTML\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template/#HTML</a> - you need to apply a <code>template.FuncMap</code> to your template to mark the template as &quot;safe&quot;. See here: <a href=\"http://technosophos.com/2013/11/23/using-custom-template-functions-in-go.html\" rel=\"nofollow noreferrer\">technosophos.com/2013/11/23/&hellip;</a>"}], "tags": [], "owner": {"reputation": 353, "user_id": 650897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b2ecdfa7f4d1813ae6411c5861622571?s=128&d=identicon&r=PG", "display_name": "enkdr", "link": "https://stackoverflow.com/users/650897/enkdr"}, "is_accepted": true, "score": 1, "last_activity_date": 1434176558, "creation_date": 1434176558, "answer_id": 30815746, "question_id": 30814949, "link": "https://stackoverflow.com/questions/30814949/golangpostgresql-how-to-print-exact-query-without-escape-html-tags/30815746#30815746", "title": "Golang+PostgreSQL - How to print exact query without escape HTML tags?", "body": "<p>This is caused by html template - you could use a function such as:</p>\n\n<pre><code>func unsafe(x string) template.HTML {\n    return template.HTML(x)\n}\n</code></pre>\n\n<p>to get the 'unescaped' html.</p>\n"}], "owner": {"reputation": 35, "user_id": 4983070, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nm0Ps.png?s=128&g=1", "display_name": "W. Mar", "link": "https://stackoverflow.com/users/4983070/w-mar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1466, "favorite_count": 1, "accepted_answer_id": 30815746, "answer_count": 1, "score": 0, "last_activity_date": 1434176558, "creation_date": 1434168316, "last_edit_date": 1434169252, "question_id": 30814949, "link": "https://stackoverflow.com/questions/30814949/golangpostgresql-how-to-print-exact-query-without-escape-html-tags", "title": "Golang+PostgreSQL - How to print exact query without escape HTML tags?", "body": "<p>data stored in PostgreSQL: <code>The &lt;b&gt;Argentine Army&lt;/b&gt; is</code>. Data type: <code>\"content\" text COLLATE \"default\"</code>.</p>\n\n<p>When print through Golang, it become <code>The &amp;lt;b&amp;gt;Argentine Army&amp;lt;/b&amp;gt; is</code></p>\n\n<p>I need to print exact data from PostgreSQL without escaping HTML tags. I'm not sure if this is Go or PostgreSQL issue.</p>\n\n<p>below is my Golang codes:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"github.com/labstack/echo\"\n    _ \"github.com/lib/pq\"\n    \"html/template\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n)\n\n// type Gallery struct here\n// type Template struct &amp; function here\n\nfunc main() {\n    e := echo.New()\n\n    // DB connection here\n    // Parse template &amp; render here\n\n    e.Get(\"/\", func(c *echo.Context) error {\n\n        rows, err := db.Query(\"SELECT uri, title, content FROM gallery WHERE id=123\")\n        // Handle error here\n\n        gallery := []Gallery{}\n\n        for rows.Next() {\n            b := Gallery{}\n            err := rows.Scan(&amp;b.Uri, &amp;b.Title, &amp;b.Content)\n            // Handle error here\n\n            gallery = append(gallery, b)\n        }\n\n        return c.Render(http.StatusOK, \"onlytestingtpl\", gallery[0])\n    })\n\n    e.Run(\":4444\")\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "edited": false, "score": 0, "creation_date": 1434123968, "post_id": 30807113, "comment_id": 49662296, "body": "Then the documentation on the tour is not entirely correct."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 5, "last_activity_date": 1434123743, "creation_date": 1434123743, "answer_id": 30807113, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil/30807113#30807113", "title": "The zero value of a slice is not nil", "body": "<p>Your <code>y</code> variable <em>isn't</em> the zero value for a slice. It's allocated via an empty slice literal. </p>\n\n<pre><code>// both of these allocate a slice\ny := []int{}\nz := []int{1, 2, 3}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "edited": false, "score": 0, "creation_date": 1526629010, "post_id": 30807194, "comment_id": 87827467, "body": "i do not think this is a right answer, a nil slice is not a pointer, i like @tgogos answer, which nil means the array under the slice is not init"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "reply_to_user": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "edited": false, "score": 0, "creation_date": 1526888634, "post_id": 30807194, "comment_id": 87902030, "body": "@petelin you&#39;re right, a slice is not a pointer. I&#39;ve removed the statement suggesting it is."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 17, "last_activity_date": 1526888392, "last_edit_date": 1526888392, "creation_date": 1434124006, "answer_id": 30807194, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil/30807194#30807194", "title": "The zero value of a slice is not nil", "body": "<p>The doc you referenced states that <em>a nil slice has a length and capacity of 0,</em> but not that <em>every</em> slice of length and capacity of zero is a nil slice. <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">The specification</a> only says that the value of an <em>uninitialized</em> slice is nil.</p>\n\n<p>This is a convenience to support <code>len</code> and <code>cap</code> on slices which are uninitialised (nil). Otherwise we would need to check for non-nil first in order to avoid panic. (This also holds for other in-built types like maps or channels.)</p>\n\n<p>In terms of the <code>fmt.Print</code> output, the difference in behaviour is similar to printing an uninitialised (nil) pointer vs pointer to an empty structure:</p>\n\n<pre><code>var s *struct{} // uninitialised pointer\nfmt.Println(s)  // &lt;nil&gt;\n\ns = &amp;struct{}{} // pointer to an empty structure\nfmt.Println(s)  // &amp;{}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 8, "last_activity_date": 1434382730, "last_edit_date": 1434382730, "creation_date": 1434141757, "answer_id": 30811876, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil/30811876#30811876", "title": "The zero value of a slice is not nil", "body": "<p>In this case:</p>\n\n<pre><code>var z []int \n</code></pre>\n\n<p>You have declared a variable <code>z</code> but you did not initialize it.</p>\n\n<p>In this case:</p>\n\n<pre><code>y := []int {}\n</code></pre>\n\n<p>You declared it and initialized it, you set it to an empty slice. Writing the second expression the long way makes the difference between the two expressions more clear:</p>\n\n<pre><code>var y []int = []int {}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3123, "user_id": 8910547, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEm51.png?s=128&g=1", "display_name": "Inigo", "link": "https://stackoverflow.com/users/8910547/inigo"}, "edited": false, "score": 0, "creation_date": 1558459975, "post_id": 45918994, "comment_id": 99105877, "body": "I like your answer as one way to <i>see</i> it, but I think it would be useful to confirm (or deny) that this is the the actual memory layout of a nil slice. <a href=\"https://stackoverflow.com/a/39993797\">stackoverflow.com/a/39993797</a> seems to say that it is."}], "tags": [], "owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "is_accepted": false, "score": 17, "last_activity_date": 1544012634, "last_edit_date": 1544012634, "creation_date": 1503923250, "answer_id": 45918994, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil/45918994#45918994", "title": "The zero value of a slice is not nil", "body": "<h2><code>nil</code> Vs <code>empty</code> slice</h2>\n\n<p>If we think of a slice like this:</p>\n\n<pre><code>[pointer] [length] [capacity]\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>nil slice:   [nil][0][0]\nempty slice: [addr][0][0] // it points to an address\n</code></pre>\n\n<blockquote>\n  <p>From: \"Go in action\" book:</p>\n  \n  <h3>nil slice</h3>\n  \n  <p>They\u2019re useful when you want to represent a slice that doesn\u2019t exist, such as when an exception occurs in a function that returns a slice.</p>\n\n<pre><code>// Create a nil slice of integers.\nvar slice []int\n</code></pre>\n  \n  <h3>empty slice</h3>\n  \n  <p>Empty slices are useful when you want to represent an empty collection, such as when a database query returns zero results.</p>\n\n<pre><code>// Use make to create an empty slice of integers.\nslice := make([]int, 0)\n\n// Use a slice literal to create an empty slice of integers.\nslice := []int{}\n</code></pre>\n  \n  <p>\ud83d\udc49 Regardless of whether you\u2019re using a nil slice or an empty slice, the built-in functions <code>append</code>, <code>len</code>, and <code>cap</code> work the same.</p>\n</blockquote>\n\n<hr>\n\n<p><a href=\"https://play.golang.org/p/5bjyfO5OmB\" rel=\"noreferrer\">Go playground example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    var nil_slice []int\n    var empty_slice = []int{}\n\n    fmt.Println(nil_slice == nil, len(nil_slice), cap(nil_slice))\n    fmt.Println(empty_slice == nil, len(empty_slice), cap(empty_slice))\n\n}\n</code></pre>\n\n<p>prints:</p>\n\n<pre><code>true 0 0\nfalse 0 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "is_accepted": false, "score": 0, "last_activity_date": 1526629135, "creation_date": 1526629135, "answer_id": 50406197, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil/50406197#50406197", "title": "The zero value of a slice is not nil", "body": "<blockquote>\n  <p>A nil slice has a length and capacity of 0 and has no underlying array.</p>\n</blockquote>\n\n<p>var s []string => no underlying array \nvar s = []string => create a underlying array but his length is 0.</p>\n"}], "owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19817, "favorite_count": 3, "accepted_answer_id": 30807194, "answer_count": 5, "score": 16, "last_activity_date": 1544012634, "creation_date": 1434123228, "last_edit_date": 1472494424, "question_id": 30806931, "link": "https://stackoverflow.com/questions/30806931/the-zero-value-of-a-slice-is-not-nil", "title": "The zero value of a slice is not nil", "body": "<p>I was following the example <a href=\"https://tour.golang.org/moretypes/10\" rel=\"noreferrer\">https://tour.golang.org/moretypes/10</a>\nI modified the code expecting to get the same result. I did not. Is this a bug, or a documentation error? The tour states </p>\n\n<blockquote>\n  <p>A nil slice has a length and capacity of 0.</p>\n</blockquote>\n\n<p>My y variable has a length and capacity of 0.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc myPrint(z []int) {\n    fmt.Println(z, len(z), cap(z))\n    if z == nil {\n        fmt.Println(\"nil!\")\n    }\n}\n\nfunc main() {\n    var z  []int \n    y := []int {}\n    myPrint(z)\n    myPrint(y)\n}\n</code></pre>\n\n<p>Here is my output.</p>\n\n<pre><code>[] 0 0\nnil!\n[] 0 0\n</code></pre>\n\n<p>I was expecting a second \"nil\"~ Why didn't I get it?</p>\n"}, {"tags": ["go", "readline"], "comments": [{"owner": {"reputation": 2924, "user_id": 2066459, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d8408d7e5ef47a2e2af09f3c6da6e1a6?s=128&d=identicon&r=PG", "display_name": "Robert Jacobs", "link": "https://stackoverflow.com/users/2066459/robert-jacobs"}, "edited": false, "score": 0, "creation_date": 1434122104, "post_id": 30806288, "comment_id": 49661097, "body": "See <a href=\"http://stackoverflow.com/questions/8757389/reading-file-line-by-line-in-go\" title=\"reading file line by line in go\">stackoverflow.com/questions/8757389/&hellip;</a>"}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 2, "creation_date": 1434123479, "post_id": 30806288, "comment_id": 49661981, "body": "If you know what to use (<code>bufio.Scanner</code>), then check examples on golang.org, there is one for reading lines! <a href=\"http://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Scanner</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": false, "score": 7, "last_activity_date": 1434121988, "creation_date": 1434121988, "answer_id": 30806519, "question_id": 30806288, "link": "https://stackoverflow.com/questions/30806288/golang-read-line-by-line/30806519#30806519", "title": "golang read line by line", "body": "<p>use this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    file, _ := os.Open(\"path/to_file\")\n    fscanner := bufio.NewScanner(file)\n    for fscanner.Scan() {\n        fmt.Println(fscanner.Text())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4654137, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d79956107c47f818cb8a3af6ba478e3e?s=128&d=identicon&r=PG&f=1", "display_name": "user4654137", "link": "https://stackoverflow.com/users/4654137/user4654137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5378, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1434121988, "creation_date": 1434121344, "question_id": 30806288, "link": "https://stackoverflow.com/questions/30806288/golang-read-line-by-line", "title": "golang read line by line", "body": "<p>I've started studying golang a bit and I'm absolutely unable to understand how I'm supposed to read line by line in the old-fashioned way:</p>\n\n<pre><code>while filehandler != EOF {\nline_buffer = readline(filehandler)\n}\n</code></pre>\n\n<p>I'm aware that I have to use bufio scanlines. This isn't what I am using as code, I'm merely trying to explain the idea. </p>\n"}, {"tags": ["struct", "go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 8, "last_activity_date": 1434118654, "creation_date": 1434118654, "answer_id": 30805285, "question_id": 30805006, "link": "https://stackoverflow.com/questions/30805006/golang-add-function-to-struct-defined-elsewhere/30805285#30805285", "title": "Golang add function to struct defined elsewhere", "body": "<p>You cannot define methods of non-local types. As per <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"noreferrer\">Spec</a>:</p>\n\n<blockquote>\n  <p>The type denoted by T is called the receiver base type; it must not be a pointer or interface type and <strong>it must be declared in the same package as the method.</strong></p>\n</blockquote>\n\n<p>(Emphasis added.)</p>\n\n<p>What you can do is create your own type and <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"noreferrer\">embed</a> the imported type into it:</p>\n\n<pre><code>// Has all methods of *sql.Row.\ntype myRow struct {\n    *sql.Row\n}\n\nfunc (row myRow) ScanErrorModel(mod *model.ErrorModel, err error) {\n    err = row.Scan(&amp;mod.MessageId, &amp;mod.ServiceName, &amp;mod.EventName,\n      &amp;mod.Hostname, &amp;mod.Message, &amp;mod.CriticalRate, &amp;mod.Extra, &amp;mod.Timestamp)\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 10777, "user_id": 1507139, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/efa15e463560953d4ee5943bd427846d?s=128&d=identicon&r=PG", "display_name": "eatonphil", "link": "https://stackoverflow.com/users/1507139/eatonphil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "accepted_answer_id": 30805285, "answer_count": 1, "score": 0, "last_activity_date": 1434118654, "creation_date": 1434117806, "question_id": 30805006, "link": "https://stackoverflow.com/questions/30805006/golang-add-function-to-struct-defined-elsewhere", "title": "Golang add function to struct defined elsewhere", "body": "<p>I want to create a function on the <code>sql.Row</code> struct that scans a row into my struct <code>ErrorModel</code>. This is what I am doing:</p>\n\n<pre><code>func (row *sql.Row) ScanErrorModel(mod *model.ErrorModel, err error) {\n    err = row.Scan(&amp;mod.MessageId, &amp;mod.ServiceName, &amp;mod.EventName,\n      &amp;mod.Hostname, &amp;mod.Message, &amp;mod.CriticalRate, &amp;mod.Extra, &amp;mod.Timestamp)\n    return\n}\n\nfunc (dao *ErrorsDAO) Fetch(id string) (mod *model.ErrorModel, err error) {\n    row := dao.DB.QueryRow(\"select * from errors where message_id=$1\", id) \n    return row.ScanErrorModel()\n}\n</code></pre>\n\n<p>But I am getting a compiler error here:</p>\n\n<pre><code>row.ScanErrorModel undefined (type *sql.Row has no field or method ScanErrorModel)\n</code></pre>\n\n<p>Is it impossible to add a function onto a struct that is defined somewhere else like this? Or am I just making a syntax error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 2, "creation_date": 1434117226, "post_id": 30804797, "comment_id": 49657998, "body": "I don&#39;t think there is."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1434120143, "last_edit_date": 1434120143, "creation_date": 1434119755, "answer_id": 30805723, "question_id": 30804797, "link": "https://stackoverflow.com/questions/30804797/is-it-possible-to-do-a-conversion-after-assignment/30805723#30805723", "title": "Is it possible to do a conversion after assignment?", "body": "<p>For example, only <code>x</code> escapes to heap,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\ntype T1 int\n\nfunc atoi(a string) int {\n    i, err := strconv.Atoi(a)\n    if err != nil {\n        panic(err)\n    }\n    return i\n}\n\nfunc main() {\n    x := T1(atoi(\"1\"))\n    fmt.Println(x)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "edited": false, "score": 0, "creation_date": 1434216566, "post_id": 30806660, "comment_id": 49689209, "body": "I guess the downside of the func call  is that you end-up with the value copy plus a func call."}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1434122854, "last_edit_date": 1434122854, "creation_date": 1434122364, "answer_id": 30806660, "question_id": 30804797, "link": "https://stackoverflow.com/questions/30804797/is-it-possible-to-do-a-conversion-after-assignment/30806660#30806660", "title": "Is it possible to do a conversion after assignment?", "body": "<p>No, I believe there is no such trick.</p>\n\n<p>When I want to avoid declarations of unnecessary variables in the scope, and for one-off operations, I sometimes use this kind of anonymous function calls:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strconv\"\n\ntype T1 int\n\nfunc main() {\n    x, err := func() (T1, error) {\n        x, err := strconv.Atoi(\"1\")\n        return T1(x), err\n    }()\n    fmt.Println(err, x)\n}\n</code></pre>\n\n<p>On the other hand, if you need to perform a similar cast on many occasions, and not necessarily always as a result of the same call (like <code>Atoi</code>), you could create a simple function, which would do the conversion and pass through the error:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strconv\"\n\ntype T1 int\n\nfunc resToT1(n int, err error) (T1, error) {\n    return T1(n), err\n}\n\nfunc main() {\n    x, err := resToT1(strconv.Atoi(\"1\"))\n    fmt.Println(err, x)\n}\n</code></pre>\n"}], "owner": {"reputation": 7410, "user_id": 3257971, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/726800b78cc5fe1f7dd61906ffd0eb1e?s=128&d=identicon&r=PG&f=1", "display_name": "The user with no hat", "link": "https://stackoverflow.com/users/3257971/the-user-with-no-hat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1434122854, "creation_date": 1434117133, "question_id": 30804797, "link": "https://stackoverflow.com/questions/30804797/is-it-possible-to-do-a-conversion-after-assignment", "title": "Is it possible to do a conversion after assignment?", "body": "<p>I'm wondering if there is any trick to avoid the xv identifier/allocation. Basically something like <code>x, err := T1(strconv.Atoi(\"1\"))</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"strconv\"\n\n   type T1 int\n\n    func main() {\n        xv, err := strconv.Atoi(\"1\")\n        if err != nil {\n            panic(err)\n        }\n        x := T1(xv)\n        fmt.Println(x)\n    }\n</code></pre>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1434116125, "post_id": 30803877, "comment_id": 49657264, "body": "You should probably execute the external command yourself, so you can track the PID and send the appropriate signal."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1434116226, "post_id": 30804493, "comment_id": 49657326, "body": "Use <code>os&#47;exec</code>: (&quot;StartProcess is a low-level interface. The os/exec package provides higher-level interfaces.&quot;)"}], "tags": [], "owner": {"reputation": 2237, "user_id": 24638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vlRen.png?s=128&g=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/24638/jake"}, "is_accepted": false, "score": 2, "last_activity_date": 1434116297, "last_edit_date": 1434116297, "creation_date": 1434116137, "answer_id": 30804493, "question_id": 30803877, "link": "https://stackoverflow.com/questions/30803877/go-close-an-external-application/30804493#30804493", "title": "Go - close an external application", "body": "<p>It looks like that library is hiding details that you'd use to close the program, specifically the process ID (PID). </p>\n\n<p>If you launch instead with the os/exec package or get a handle on that PID then you can use the Process object to kill or send signals to the app to try and close it gracefully.</p>\n\n<p><a href=\"https://golang.org/pkg/os/#Process\" rel=\"nofollow\">https://golang.org/pkg/os/#Process</a></p>\n"}, {"tags": [], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "is_accepted": true, "score": 1, "last_activity_date": 1434121411, "creation_date": 1434121411, "answer_id": 30806310, "question_id": 30803877, "link": "https://stackoverflow.com/questions/30803877/go-close-an-external-application/30806310#30806310", "title": "Go - close an external application", "body": "<p>Thank you guys for the help. I would able to do what I was trying with the following code.</p>\n\n<pre><code>cmd := exec.Command(path string)\n    err := cmd.Start()\n  if err != nil {\n    log.Printf(\"Command finished with error: %v\", err)\n  }\n  done := make(chan error, 1)\n  go func() {\n    done &lt;- cmd.Wait()\n  }()\n  select {\n  case &lt;-time.After(30 * time.Second):      // Kills the process after 30 seconds\n    if err := cmd.Process.Kill(); err != nil {\n      log.Fatal(\"failed to kill: \", err)\n    }\n    &lt;-done // allow goroutine to exit\n    log.Println(\"process killed\")\n    indexInit()\n    case err := &lt;-done:\n      if err!=nil{\n        log.Printf(\"process done with error = %v\", err)\n      }\n  }\n    if err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"Waiting for command to finish...\")\n  //timer() // The time goes by...\n    err = cmd.Wait()\n}\n</code></pre>\n\n<p>I placed that right after start the app with the <strong>os/exec</strong> package as @JimB recommended.</p>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 30806310, "answer_count": 2, "score": 2, "last_activity_date": 1434121557, "creation_date": 1434114396, "last_edit_date": 1434121557, "question_id": 30803877, "link": "https://stackoverflow.com/questions/30803877/go-close-an-external-application", "title": "Go - close an external application", "body": "<p>I'm using Go on an OSX machine and trying to make a program to open an external application and then after few seconds, close it - the application, not exit the Go script.</p>\n\n<p>I'm using the library available on <a href=\"https://github.com/skratchdot/open-golang\" rel=\"nofollow\">https://github.com/skratchdot/open-golang</a> to start the app and it works fine. I also already have the timeout running. But the problem comes when I have to close the application.</p>\n\n<p>Would someone give a hint of how I would be able to exit the app?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["google-app-engine", "go", "oauth-2.0", "google-oauth"], "comments": [{"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 0, "creation_date": 1434322685, "post_id": 30801822, "comment_id": 49715319, "body": "I cannot test the code, but, try to change <code>hc := &amp;http.Client{}</code> by <code>hc := urlfetch.Client(c)</code> and include <code>import &quot;appengine&#47;urlfetch&quot;</code>."}, {"owner": {"reputation": 2140, "user_id": 201618, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/RgWeB.png?s=128&g=1", "display_name": "Alistair Collins", "link": "https://stackoverflow.com/users/201618/alistair-collins"}, "reply_to_user": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 0, "creation_date": 1434355247, "post_id": 30801822, "comment_id": 49724092, "body": "@alvivi Afraid this gives the following error:  &quot;cannot use c (type context.Context) as type &quot;appengine&quot;.Context in argument to &quot;appengine/urlfetch&quot;.Client: \tcontext.Context does not implement &quot;appengine&quot;.Context (missing Call method)&quot;"}, {"owner": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 0, "creation_date": 1434365145, "post_id": 30801822, "comment_id": 49729758, "body": "Seems that you are mixing <code>google.golang.org&#47;appengine&#47;*</code> packages with packages provided by AppEngine SDK <code>appengine&#47;*</code>. Use only the packages provided by your AppEngine SDK installation, like <code>import &quot;appengine&quot;</code> instead of <code>import &quot;google.golang.org&#47;appengine&quot;</code>, and so on."}, {"owner": {"reputation": 3493, "user_id": 4270992, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JZTDS.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/4270992/nick"}, "reply_to_user": {"reputation": 3027, "user_id": 560382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1741fdf36945df8f3e26c4f1abd24cad?s=128&d=identicon&r=PG", "display_name": "Alvivi", "link": "https://stackoverflow.com/users/560382/alvivi"}, "edited": false, "score": 2, "creation_date": 1435087280, "post_id": 30801822, "comment_id": 50050121, "body": "@alvivi this is incorrect. The google.golang.org/appengine imports should be used instead."}], "answers": [{"tags": [], "owner": {"reputation": 2140, "user_id": 201618, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/RgWeB.png?s=128&g=1", "display_name": "Alistair Collins", "link": "https://stackoverflow.com/users/201618/alistair-collins"}, "is_accepted": false, "score": 1, "last_activity_date": 1434635988, "creation_date": 1434635988, "answer_id": 30917500, "question_id": 30801822, "link": "https://stackoverflow.com/questions/30801822/on-app-engine-using-go-correct-method-for-using-oauth2/30917500#30917500", "title": "On App Engine using Go, correct method for using OAuth2", "body": "<p>My current solution, including logging the logged in users display name and all the files in their Google Drive - please comment if you see any errors or improvements:</p>\n\n<pre><code>import (\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    \"google.golang.org/api/drive/v2\"\n    \"google.golang.org/api/plus/v1\"\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/log\"\n    \"html/template\"\n\n    \"net/http\"\n)\n\nvar cached_templates = template.Must(template.ParseGlob(\"templates/*.html\"))\n\nvar conf = &amp;oauth2.Config{\n    ClientID:     \"my client id\",       // Replace with correct ClientID\n    ClientSecret: \"my client secret\",   // Replace with correct ClientSecret\n    RedirectURL:  \"http://localhost:10080/oauth2callback\",\n    Scopes: []string{\n        \"https://www.googleapis.com/auth/drive\",\n        \"profile\",\n    },\n    Endpoint: google.Endpoint,\n}\n\nfunc init() {\n    http.HandleFunc(\"/\", handleRoot)\n    http.HandleFunc(\"/authorize\", handleAuthorize)\n    http.HandleFunc(\"/oauth2callback\", handleOAuth2Callback)\n}\n\nfunc handleRoot(w http.ResponseWriter, r *http.Request) {\n    err := cached_templates.ExecuteTemplate(w, \"notAuthenticated.html\", nil)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusNotFound)\n    }\n}\n\nfunc handleAuthorize(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    url := conf.AuthCodeURL(\"\")\n    http.Redirect(w, r, url, http.StatusFound)\n}\n\nfunc handleOAuth2Callback(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    code := r.FormValue(\"code\")\n    tok, err := conf.Exchange(c, code)\n    if err != nil {\n        log.Errorf(c, \"%v\", err)\n    }\n    client := conf.Client(c, tok)\n\n    // PLUS SERVICE CLIENT\n    pc, err := plus.New(client)\n    if err != nil {\n        log.Errorf(c, \"An error occurred creating Plus client: %v\", err)\n    }\n    person, err := pc.People.Get(\"me\").Do()\n    if err != nil {\n        log.Errorf(c, \"Person Error: %v\", err)\n    }\n    log.Infof(c, \"Name: %v\", person.DisplayName)\n\n    // DRIVE CLIENT\n    dc, err := drive.New(client)\n    if err != nil {\n        log.Errorf(c, \"An error occurred creating Drive client: %v\", err)\n    }\n    files, err := dc.Files.List().Do()\n    for _, value := range files.Items {\n        log.Infof(c, \"Files: %v\", value.Title)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2140, "user_id": 201618, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/RgWeB.png?s=128&g=1", "display_name": "Alistair Collins", "link": "https://stackoverflow.com/users/201618/alistair-collins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1434635988, "creation_date": 1434108112, "question_id": 30801822, "link": "https://stackoverflow.com/questions/30801822/on-app-engine-using-go-correct-method-for-using-oauth2", "title": "On App Engine using Go, correct method for using OAuth2", "body": "<p>I have been trying for the last few days to solve this, and having followed many of the examples and documentation out there without joy, I would like some assistance.</p>\n\n<p>The following gives the Google authorization page, but then fails on returning to the handleOAuth2Callback page with the following error:</p>\n\n<blockquote>\n  <p>ERROR: Post <a href=\"https://accounts.google.com/o/oauth2/token\" rel=\"nofollow\">https://accounts.google.com/o/oauth2/token</a>: not an App\n  Engine context</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>import (\n    \"google.golang.org/appengine\"\n    \"google.golang.org/appengine/log\"\n    \"google.golang.org/cloud\"\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/google\"\n    // \"google.golang.org/api/drive/v2\"\n    \"html/template\"\n    \"net/http\"\n)\n\nvar cached_templates = template.Must(template.ParseGlob(\"templates/*.html\"))\n\nvar conf = &amp;oauth2.Config{\n    ClientID:     \"my client id\",\n    ClientSecret: \"my client secret\",\n    RedirectURL:  \"http://localhost:10080/oauth2callback\",\n    Scopes: []string{\n        \"https://www.googleapis.com/auth/drive\",\n        \"https://www.googleapis.com/auth/userinfo.profile\",\n    },\n    Endpoint: google.Endpoint,\n}\n\nfunc init() {\n    http.HandleFunc(\"/\", handleRoot)\n    http.HandleFunc(\"/authorize\", handleAuthorize)\n    http.HandleFunc(\"/oauth2callback\", handleOAuth2Callback)\n}\n\nfunc handleRoot(w http.ResponseWriter, r *http.Request) {\n    err := cached_templates.ExecuteTemplate(w, \"notAuthenticated.html\", nil)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusNotFound)\n    }\n}\n\nfunc handleAuthorize(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    url := conf.AuthCodeURL(\"\")\n    http.Redirect(w, r, url, http.StatusFound)\n}\n\nfunc handleOAuth2Callback(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    hc := &amp;http.Client{}\n    ctx := cloud.NewContext(appengine.AppID(c), hc)\n    log.Infof(c, \"Ctx: %v\", ctx)\n\n    code := r.FormValue(\"code\")\n    log.Infof(c, \"Code: %v\", code)\n\n    // Exchange the received code for a token\n    tok, err := conf.Exchange(ctx, code)\n    // tok, err := conf.Exchange(oauth2.NoContext, code)\n\n    if err != nil {\n        log.Errorf(c, \"%v\", err)\n    }\n    log.Infof(c, \"Token: %v\", tok)\n\n    client := conf.Client(oauth2.NoContext, tok)\n    log.Infof(c, \"Client: %v\", client)\n}\n</code></pre>\n"}, {"tags": ["multithreading", "go", "channel"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434125306, "post_id": 30794018, "comment_id": 49663163, "body": "Why are you against a central coordinating goroutine? If you have multiple readers they will need to explicitly lock each other out (as you say) so either way you have a bottleneck at the queue. Can the criteria be easily specified by the &quot;user&quot;? (E.g. by passing in a <code>func(*bid) bool</code> for example). Otherwise you could just have a shared (either via mutex or via central goroutine) list/slice/etc that you can push to either the front or back as appropriate; or perhaps a priority queue would be a better fit."}], "answers": [{"tags": [], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "is_accepted": false, "score": 1, "last_activity_date": 1434257699, "creation_date": 1434257699, "answer_id": 30826064, "question_id": 30794018, "link": "https://stackoverflow.com/questions/30794018/peekable-queue-in-golang/30826064#30826064", "title": "Peekable Queue in Golang", "body": "<p>As @DaveC states in his comment, the simplest and fastest way to do this is to use a mutex.</p>\n\n<p>You could use the <a href=\"https://golang.org/pkg/container/list/\" rel=\"nofollow\">\"container/list\"</a> package, which implements a double-linked list for you. This can be pushed/popped from both ends.</p>\n\n<p>Here is a quick implementation that does what I think you are asking:</p>\n\n<pre><code>import (\n    \"container/list\"\n    \"sync\"\n)\n\ntype Queue struct {\n    q list.List\n    l sync.Mutex\n}\n\nfunc (q *Queue) Push(data interface{}) {\n    q.l.Lock()\n    q.q.PushBack(data)\n    q.l.Unlock()\n}\n\nfunc (q *Queue) Pop() interface{} {\n    q.l.Lock()\n    data := q.q.Remove(q.q.Front())\n    q.l.Unlock()\n    return data\n}\n\nfunc (q *Queue) TakeAnother(data interface{}) interface{} {\n    q.l.Lock()\n    e := q.q.Front()\n    // swap the data with whatever is in the front of the list\n    e.Value, data = data, e.Value\n    q.l.Unlock()\n    return data\n}\n</code></pre>\n\n<p>Nowhere do I use channels or goroutines, since I don't think they are the correct tool for this job.</p>\n"}], "owner": {"reputation": 55, "user_id": 5001385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f8d6e00eeb6b551c4a200068823a160?s=128&d=identicon&r=PG&f=1", "display_name": "AlbertoPier", "link": "https://stackoverflow.com/users/5001385/albertopier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1179, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1434257699, "creation_date": 1434072712, "question_id": 30794018, "link": "https://stackoverflow.com/questions/30794018/peekable-queue-in-golang", "title": "Peekable Queue in Golang", "body": "<p>I am trying to design a mechanism to allow cooperation of many processes \u2013 goroutines. There are two classes of processes \u2013 providers and users. Providers put \u201cbids\u201d for their services into a queue and users take waiting bids and start working with providers. However, a user may not like a bid and then two things should happen:</p>\n\n<ul>\n<li>This bid should return to the queue. It should be placed at the beginning of the queue </li>\n<li>The user should be given the next bid in the queue </li>\n</ul>\n\n<p>Ideally, I would like to avoid a central process that coordinates the communication between providers and users. \nAnother way of thinking about this problem is to imagine a \u201cpeekable\u201d queue or channel. A concept similar to the way AWS Kinesis works. A reader can get an access to \u201cpeek\u201d into the head of the queue. As this reader is peeking, no other readers can see the item. It the reader likes the item, then it removes it from the queue. If not the reader releases the lock on the item and another reader can peek. </p>\n\n<p>Any ideas how to best implement this behavior in Go using channels and goroutines? </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434070388, "post_id": 30793713, "comment_id": 49636804, "body": "But looking at the code doesn&#39;t <code>data</code> just stay empty? Why not pass in <code>nil</code>?"}, {"owner": {"reputation": 2925, "user_id": 9700, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/508ab296041eb80b05fe541b70710cac?s=128&d=identicon&r=PG", "display_name": "Christopher Currie", "link": "https://stackoverflow.com/users/9700/christopher-currie"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 1, "creation_date": 1434070418, "post_id": 30793713, "comment_id": 49636812, "body": "What makes you think it&#39;s empty when it&#39;s being provided by the caller?"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434070440, "post_id": 30793713, "comment_id": 49636820, "body": ":O I have no idea how I missed that. Thank you haha"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434070632, "post_id": 30793713, "comment_id": 49636851, "body": "Can I also assume that whoever wrote the code made a small mistake? They are passing in data, which is a map, as the third parameter to ExecuteTemplate, but in the docs it&#39;s not a map it is just <code>data interface{}</code>."}, {"owner": {"reputation": 2925, "user_id": 9700, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/508ab296041eb80b05fe541b70710cac?s=128&d=identicon&r=PG", "display_name": "Christopher Currie", "link": "https://stackoverflow.com/users/9700/christopher-currie"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434071311, "post_id": 30793713, "comment_id": 49636986, "body": "No. <code>interface{}</code> is again being used as a pointer-to-anything. The template API lets you pass arbitrary objects and it will use reflection to figure out what its fields are. Using a map instead lets the set of fields be dynamic, which is needed because the template being used is also dynamic."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1434071460, "post_id": 30793713, "comment_id": 49637010, "body": "As the author of that article: @ChristopherCurrie is correct. Further, the reason we pass in a <code>map[string]interface{}</code> is so we can <i>name</i> our data as we pass it to the template and then refer to it by name in the template itself - sometimes that might be <code>.user</code>, other times it might be <code>.post</code>, etc."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434071557, "post_id": 30793713, "comment_id": 49637035, "body": "@elithrar thank you for responding. I&#39;m very new to go, and your article saved me from getting <code>mustache</code> or even <code>gorazor</code>"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1434112584, "post_id": 30793713, "comment_id": 49654752, "body": "There is a difference between <code>void*</code> in C and <code>interface{}</code> in Go though: you can use pass by reference semantics with <code>interface{}</code>: <a href=\"http://play.golang.org/p/vZdaQrYPU9\" rel=\"nofollow noreferrer\">play.golang.org/p/vZdaQrYPU9</a>"}], "tags": [], "owner": {"reputation": 2925, "user_id": 9700, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/508ab296041eb80b05fe541b70710cac?s=128&d=identicon&r=PG", "display_name": "Christopher Currie", "link": "https://stackoverflow.com/users/9700/christopher-currie"}, "is_accepted": true, "score": 3, "last_activity_date": 1434070292, "creation_date": 1434070292, "answer_id": 30793713, "question_id": 30793673, "link": "https://stackoverflow.com/questions/30793673/what-does-an-empty-map-of-interfaces-do-in-a-golang-function/30793713#30793713", "title": "What does an empty map of interfaces do in a golang function?", "body": "<p><code>interface{}</code> is like <code>(void*)</code> in C or <code>Object</code> in Java, it means that a value of any type can be stored in the map.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 30793713, "answer_count": 1, "score": 0, "last_activity_date": 1434070292, "creation_date": 1434069909, "question_id": 30793673, "link": "https://stackoverflow.com/questions/30793673/what-does-an-empty-map-of-interfaces-do-in-a-golang-function", "title": "What does an empty map of interfaces do in a golang function?", "body": "<p>I was reading through <a href=\"https://elithrar.github.io/article/approximating-html-template-inheritance/\" rel=\"nofollow\">an article on golang templates</a> and this came up in the example code.</p>\n\n<pre><code>func renderTemplate(w http.ResponseWriter, name string, data map[string]interface{}) error {\n    // Ensure the template exists in the map.\n    tmpl, ok := templates[name]\n    if !ok {\n        return fmt.Errorf(\"The template %s does not exist.\", name)\n    }\n\n    w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n    tmpl.ExecuteTemplate(w, \"base\", data)\n\n    return nil\n}\n</code></pre>\n\n<p>The part that I don't understand is the parameter <code>data</code> in the function declaration:</p>\n\n<pre><code>data map[string]interface{}\n</code></pre>\n\n<p>I only have a very basic understanding of interfaces in go, but I have no idea why it would be used in this way.</p>\n"}, {"tags": ["pointers", "go", "interface"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1434060172, "post_id": 30792131, "comment_id": 49633802, "body": "Your methods on <code>Car</code> and <code>Bike</code> need pointer receivers, not value receivers."}, {"owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434061133, "post_id": 30792131, "comment_id": 49634134, "body": "That is not the point. I am asking how to have a &quot;handler&quot; thanks to which I will be able to modify vehicles in Fleet. Func: AddVehicles will copy it and I can not change its argument type to pointer because the type is interface."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434061296, "post_id": 30792131, "comment_id": 49634190, "body": "Simply pass a pointer to <code>AddVehicles</code>: <code>myFleet.AddVehicles(&amp;myCar); myFleet.AddVehicles(&amp;myBike)</code>; you do not have to (and should not) change <code>vehicles []Movable</code> to <code>vehicles []*Movable</code>."}, {"owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434061757, "post_id": 30792131, "comment_id": 49634340, "body": "It works... Thank you. But my mind just blow up. How it can work if the types are not correct?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434062056, "post_id": 30792131, "comment_id": 49634440, "body": "See: <a href=\"http://stackoverflow.com/questions/13511203/why-cant-i-assign-a-struct-to-an-interface\" title=\"why cant i assign a struct to an interface\">stackoverflow.com/questions/13511203/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "edited": false, "score": 0, "creation_date": 1434061158, "post_id": 30792258, "comment_id": 49634144, "body": "please see the comment above. Regarding the getters and setter I agree. They do not make sense I just wanted to have interface. Maybe I should figure out sth more convenient."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "edited": false, "score": 0, "creation_date": 1434065285, "post_id": 30792258, "comment_id": 49635444, "body": "@mmburr I see. I think I&#39;m going to leave this as is though case the solution you&#39;re going with is more of a refactor/redesign than the answer to why you weren&#39;t able to modify those fields. If you&#39;re not actually using what Tim proposed in the comments please speak up and I&#39;ll help you get a working solution."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434061072, "last_edit_date": 1434061072, "creation_date": 1434060312, "answer_id": 30792258, "question_id": 30792131, "link": "https://stackoverflow.com/questions/30792131/how-to-design-structure-with-modifiable-fields/30792258#30792258", "title": "How to design structure with modifiable fields?", "body": "<p>The problem is that you've defined the method with value receivers. When you call a method on a receiver the receiving type is actually being passed as an argument, in this case by value and you're modifying that copy.</p>\n\n<pre><code>func (bike Bike) SetLocation(loc Location) {\n    bike.Loc = loc // modifies local copy of Bike\n}\n\n\nfunc (bike *Bike) SetLocation(loc Location) {\n        bike.Loc = loc // modifies the referenced bike\n    }\n</code></pre>\n\n<p>You gotta declare your types differently though, or use the <code>&amp;</code> operator in order to call these methods because you have value types in your main. My preference is to use this syntax <code>bike := &amp;Bike{}</code> in almost all cases. I will only go away from it if I have a convenience method for initilization or a very specific reason for using a value type (which is extremely rare).</p>\n\n<p>But basically, you can't make a setter use a value type receiver. If you want to use these structs as value types I would recommend exporting the fields so they can be accessed without getter or setter. Also, just regarding style, I would be displeased to see the use of getters and setters at all unless you actually are abstracting some logic. There's no point in not exporting a field if you're going to provide a setter that directly assigns the value passed in to said field. Also, wasn't looking to closely but you are exporting all fields on your structs so your setters are useless and most programmers would just do <code>bike.Loc = anythingIWantBecauseThisFieldsExportedWhichYouMayThinkOfAsPublic</code></p>\n"}], "owner": {"reputation": 7, "user_id": 4881800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad032b18cadaca60762f3de4cea1f2ef?s=128&d=identicon&r=PG&f=1", "display_name": "mmburr", "link": "https://stackoverflow.com/users/4881800/mmburr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1434061072, "creation_date": 1434059761, "question_id": 30792131, "link": "https://stackoverflow.com/questions/30792131/how-to-design-structure-with-modifiable-fields", "title": "How to design structure with modifiable fields?", "body": "<p>I am writing a simple game in Go and have some problems with it. My, cut off, code looks like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Location struct {\n    X int\n    Y int\n}\n\ntype Car struct {\n    MaxSpeed int\n    Loc Location\n}\n\nfunc (car Car) SetLocation(loc Location) {\n    car.Loc = loc\n}\n\nfunc (car Car) GetLocation() Location {\n    return car.Loc\n}\n\ntype Bike struct {\n    GearsNum int\n    Loc Location\n}\n\nfunc (bike Bike) SetLocation(loc Location) {\n    bike.Loc = loc\n}\n\nfunc (bike Bike) GetLocation() Location {\n    return bike.Loc\n}\ntype Movable interface {\n    GetLocation() Location\n    SetLocation(Location)\n}\n\ntype Fleet struct {\n    vehicles []Movable\n}\n\nfunc (fleet *Fleet) AddVehicles(v ...Movable) {\n    for _, x := range(v) {\n        fleet.vehicles = append(fleet.vehicles, x) \n    }\n}\n\nfunc (fleet *Fleet) WherTheyAre() {\n    for _, v := range(fleet.vehicles) {\n        fmt.Println(v.GetLocation())\n    }\n}\n\nfunc main() {\n    myCar := Car{MaxSpeed: 200, Loc: Location{12, 34}}\n    myBike := Bike{GearsNum: 11, Loc: Location{1, 1}}\n\n    myFleet := Fleet{}\n    myFleet.AddVehicles(myCar)\n    myFleet.AddVehicles(myBike)\n    myFleet.WherTheyAre()\n\n    myCar.SetLocation(Location{0,0})\n    myFleet.WherTheyAre()\n}\n</code></pre>\n\n<p>The assumption is that Car and Bike are very big structures which I do not want to copy. How should I design the code to be able to modify the location of the car which is the part of the Fleet? Other words how to design the Fleet struct to be able to modify its movable objects?\nI have tried to experiment with pointers to interfaces but I was not good idea...</p>\n\n<p>Thanks for help!</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 857, "user_id": 1527967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af6603d5b10fa883500305bdfd8b4c?s=128&d=identicon&r=PG", "display_name": "dsymonds", "link": "https://stackoverflow.com/users/1527967/dsymonds"}, "edited": false, "score": 5, "creation_date": 1434940715, "post_id": 30792120, "comment_id": 49974205, "body": "That is incorrect. It takes a <code>PropertyLoadSaver</code>, <i>not</i> a <code>*PropertyLoadSaver</code>. That is an interface type implemented by <code>*PropertyList</code>, which is why you need to pass <code>&amp;datastore.PropertyList{}</code> instead of <code>datastore.PropertyList{}</code>."}, {"owner": {"reputation": 11979, "user_id": 101923, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FVQn0.jpg?s=128&g=1", "display_name": "Tim Swast", "link": "https://stackoverflow.com/users/101923/tim-swast"}, "reply_to_user": {"reputation": 857, "user_id": 1527967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19af6603d5b10fa883500305bdfd8b4c?s=128&d=identicon&r=PG", "display_name": "dsymonds", "link": "https://stackoverflow.com/users/1527967/dsymonds"}, "edited": false, "score": 0, "creation_date": 1435001025, "post_id": 30792120, "comment_id": 50006213, "body": "Thanks for the correction, I&#39;ll edit my answer. I see now in <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/datastore/reference</a> that &quot;the *PropertyList type implements PropertyLoadSave&quot; I didn&#39;t know a pointer to a type could implement an interface."}], "tags": [], "owner": {"reputation": 11979, "user_id": 101923, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FVQn0.jpg?s=128&g=1", "display_name": "Tim Swast", "link": "https://stackoverflow.com/users/101923/tim-swast"}, "is_accepted": true, "score": 1, "last_activity_date": 1435001138, "last_edit_date": 1435001138, "creation_date": 1434059686, "answer_id": 30792120, "question_id": 30792119, "link": "https://stackoverflow.com/questions/30792119/why-do-i-get-invalid-entity-type-with-datastore-put-using-a-datastore-property/30792120#30792120", "title": "Why do I get &quot;invalid entity type&quot; with datastore.Put using a datastore.PropertyList in a Go AppEngine aetest?", "body": "<p>The <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#Put\" rel=\"nofollow\">docs for the datastore.Put function</a> say:</p>\n\n<blockquote>\n  <p>Put saves the entity src into the datastore with key k. src must be a\n  struct pointer or implement PropertyLoadSaver; if a struct pointer\n  then any unexported fields of that struct will be skipped. If k is an\n  incomplete key, the returned key will be a unique key generated by the\n  datastore.</p>\n</blockquote>\n\n<p>This was somewhat confusing when trying to use this with a PropertyList as the <code>src</code>. A PropertyList does not implement PropertyLoadSaver, but a *PropertyList does. Adding an &amp; before PropertyList to get a pointer to it fixes this test.</p>\n\n<pre><code>package bigdipper\n\nimport (\n    \"testing\"\n\n    \"appengine/aetest\"\n    \"appengine/datastore\"\n)\n\nfunc TestCreateMigrationProposal(t *testing.T) {\n    c, err := aetest.NewContext(nil)\n    if err != nil {\n            t.Fatal(err)\n    }\n    defer c.Close()\n    if _, err := datastore.Put(\n            c,\n            datastore.NewKey(c, \"ORDER\", \"order-id-1\", 0, nil),\n            &amp;datastore.PropertyList{}); err != nil {\n            t.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11979, "user_id": 101923, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FVQn0.jpg?s=128&g=1", "display_name": "Tim Swast", "link": "https://stackoverflow.com/users/101923/tim-swast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1889, "favorite_count": 0, "accepted_answer_id": 30792120, "answer_count": 1, "score": 2, "last_activity_date": 1435001138, "creation_date": 1434059686, "question_id": 30792119, "link": "https://stackoverflow.com/questions/30792119/why-do-i-get-invalid-entity-type-with-datastore-put-using-a-datastore-property", "title": "Why do I get &quot;invalid entity type&quot; with datastore.Put using a datastore.PropertyList in a Go AppEngine aetest?", "body": "<p>This test fails with <code>partnermerge_test.go:22: datastore: invalid entity type</code></p>\n\n<pre><code>package bigdipper\n\nimport (\n    \"testing\"\n\n    \"appengine/aetest\"\n    \"appengine/datastore\"\n)\n\nfunc TestCreateMigrationProposal(t *testing.T) {\n    c, err := aetest.NewContext(nil)\n    if err != nil {\n            t.Fatal(err)\n    }\n    defer c.Close()\n    if _, err := datastore.Put(\n            c,\n            datastore.NewKey(c, \"ORDER\", \"order-id-1\", 0, nil),\n            datastore.PropertyList{}); err != nil {\n            t.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 1, "creation_date": 1434101716, "post_id": 30791278, "comment_id": 49648184, "body": "<a href=\"http://google-opensource.blogspot.de/2015/03/farewell-to-google-code.html\" rel=\"nofollow noreferrer\">code.google.com has been closed</a>. You can now find <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">protobuf on Github</a>"}, {"owner": {"reputation": 1504, "user_id": 1535287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b811dd8cdd87523de8e08cb64f50724?s=128&d=identicon&r=PG", "display_name": "Kyle Kloepper", "link": "https://stackoverflow.com/users/1535287/kyle-kloepper"}, "reply_to_user": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 0, "creation_date": 1434124392, "post_id": 30791278, "comment_id": 49662584, "body": "Which is what the answer indicates. I hit this issue after installing <code>golang-goprotobuf-dev</code> on Ubuntu 14.04.1 in response to an error compiling a protobuf to go."}, {"owner": {"reputation": 26843, "user_id": 208997, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/250e219125d8bff1f03e6faea950f218?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/208997/simon"}, "edited": false, "score": 0, "creation_date": 1434124479, "post_id": 30791278, "comment_id": 49662633, "body": "I wrote this during a review, that&#39;s why I didn&#39;t see the answer\u2026"}], "answers": [{"tags": [], "owner": {"reputation": 1504, "user_id": 1535287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b811dd8cdd87523de8e08cb64f50724?s=128&d=identicon&r=PG", "display_name": "Kyle Kloepper", "link": "https://stackoverflow.com/users/1535287/kyle-kloepper"}, "is_accepted": false, "score": 1, "last_activity_date": 1434056097, "creation_date": 1434056097, "answer_id": 30791279, "question_id": 30791278, "link": "https://stackoverflow.com/questions/30791278/unable-to-detect-version-control-system-for-go-protobuf/30791279#30791279", "title": "Unable to detect version control system for go protobuf", "body": "<p>The golang protobuf project has moved from <a href=\"https://code.google.com/p/gogoprotobuf/\" rel=\"nofollow\">google code</a> to <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">github</a>.</p>\n\n<p>The <code>protoc</code> version being used to generate the go code from the protocol buffer definition is out of date and uses the old import.</p>\n\n<p>Install <code>protoc-gen-go</code> from github project instructions: <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow\">https://github.com/golang/protobuf</a></p>\n"}], "owner": {"reputation": 1504, "user_id": 1535287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b811dd8cdd87523de8e08cb64f50724?s=128&d=identicon&r=PG", "display_name": "Kyle Kloepper", "link": "https://stackoverflow.com/users/1535287/kyle-kloepper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1647, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434056097, "creation_date": 1434056097, "question_id": 30791278, "link": "https://stackoverflow.com/questions/30791278/unable-to-detect-version-control-system-for-go-protobuf", "title": "Unable to detect version control system for go protobuf", "body": "<p>Running <code>go get</code> on my go project I receive the following error message:</p>\n\n<p><code>package code.google.com/p/goprotobuf/proto: unable to detect version control system for code.google.com/ path\n</code></p>\n\n<p>I have not changed anything, what is going on?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 3230, "user_id": 1243064, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cfd730a0226e5295824a0a1d9224af24?s=128&d=identicon&r=PG", "display_name": "Wessie", "link": "https://stackoverflow.com/users/1243064/wessie"}, "edited": false, "score": 2, "creation_date": 1434071143, "post_id": 30791082, "comment_id": 49636959, "body": "The code given here is incapable of producing the output you say it does."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434123883, "post_id": 30791082, "comment_id": 49662246, "body": "Please read about creating an <a href=\"http://stackoverflow.com/help/mcve\">mcve</a> (minimal, complete, and verifiable example). Your code snippets are not valid. When edited to make them compile (mostly missing parenthesis) both <code>Println</code> statements give me &quot;*pkg1.User&quot; with Go1.4.2. (Note, <code>fmt.Printf(&quot;%T %#v\\n&quot;, u, u)</code> does give <code>*reflect.rtype &amp;reflect.rtype{\u2026</code>; but that&#39;s not what you claim to have used)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434124327, "post_id": 30791082, "comment_id": 49662542, "body": "And, either expect and deal with a <code>reflect.Type</code> or don&#39;t pass that it (i.e. just do <code>pkg2.Register((*User)(nil))</code> if you don&#39;t want/expect an <code>reflect.Type</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 457, "user_id": 957936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2656eba8a324b297f94ed97c9806e15a?s=128&d=identicon&r=PG", "display_name": "Caleb Spare", "link": "https://stackoverflow.com/users/957936/caleb-spare"}, "edited": false, "score": 1, "creation_date": 1434071303, "post_id": 30791320, "comment_id": 49636982, "body": "reflect.Type is an interface type already. There is no &quot;wrapping inside an <code>interface{}</code>&quot; that happens during the call <code>RegisterStruct</code> or <code>fmt.Println</code>, and certainly no double wrapping."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434082450, "post_id": 30791320, "comment_id": 49639594, "body": "Sorry, that was too quick. The second is just a copy of an interface value, it is not repacked. Will delete."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": -2, "last_activity_date": 1434082582, "last_edit_date": 1592644375, "creation_date": 1434056275, "answer_id": 30791320, "question_id": 30791082, "link": "https://stackoverflow.com/questions/30791082/wrong-type-of-reflected-struct/30791320#30791320", "title": "Wrong type of reflected struct", "body": "<p>The <code>reflect.TypeOf()</code> returns a <code>reflect.Type</code> now you are doing two completely different things with: In the first call to Println (the &quot;correct&quot; one) this <code>reflect.Type</code> is wrapped inside an <code>interface{}</code> (during the call to Println) while in the second (the &quot;wrong&quot; one) you wrap the <code>reflect.Type</code> inside an <code>interface{}</code> while calling RegisterSturct and you then rewrap it once more inside an additional <code>interface{}</code> while calling Println. Println just removes one layer of interface{}-wrapping.</p>\n<h1>Sorry, this is nonsense. I'll have to think a bit more. Would delete if possible.</h1>\n"}], "owner": {"reputation": 2119, "user_id": 1411047, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/673ade5df575380a2e2cd5a0c1503784?s=128&d=identicon&r=PG", "display_name": "Avdept", "link": "https://stackoverflow.com/users/1411047/avdept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1434082582, "creation_date": 1434055395, "last_edit_date": 1434056315, "question_id": 30791082, "link": "https://stackoverflow.com/questions/30791082/wrong-type-of-reflected-struct", "title": "Wrong type of reflected struct", "body": "<p>I have 2 different packages(pkg1, pkg2), in first i have code that calls function from another package</p>\n\n<p>file#1</p>\n\n<pre><code>package pkg1\nimport \"pkg2\"\nimport \"reflect\"\n\ntype User struct {\n  name string\n  ...\n}\n\nfunc main() {\n  fmt.Println(reflect.TypeOf((*User)(nil)) //=&gt; *User\n  pkg2.RegisterStruct(reflect.TypeOf((*User)(nil))\n  //pkg2.RegisterStruct(reflect.TypeOf(&amp;User{}) // also tried this way\n}\n</code></pre>\n\n<p>file#2</p>\n\n<pre><code>package pkg2\n\nimport \"reflect\"\n\nfunc RegisterStruct(u interface{}) { // also tried to have argument type as reflect.Type\n fmt.Println(u) //=&gt; *reflect.rtype\n}\n</code></pre>\n\n<p>Why type was <code>reflect.rtype</code> instead of <code>*User</code> ?\nAnd how do i correctly pass type to another pkg?</p>\n"}, {"tags": ["go", "go-html-template"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1434050271, "post_id": 30789515, "comment_id": 49628646, "body": "In case you missed it, read the <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text&#47;template</code></a> documentation."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434050299, "post_id": 30789515, "comment_id": 49628660, "body": "@TimCooper I did miss that :O"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434050567, "post_id": 30789515, "comment_id": 49628819, "body": "So would it be done using named templates?   &#39;{{template &quot;name&quot;}} \tThe template with the specified name is executed with nil data.&#39;"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1434050732, "post_id": 30789515, "comment_id": 49628932, "body": "That will work if you do not want to pass any data to the template. Otherwise, you&#39;d probably do something like <code>{{ template &quot;header&quot; . }}</code>."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434051862, "post_id": 30789515, "comment_id": 49629597, "body": "@TimCooper Could the name of the template be dynamic? For example, could the page URL be passed in? Something like this? {{template .Page .}}"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1434052087, "post_id": 30789515, "comment_id": 49629744, "body": "That doesn&#39;t appear to be possible <a href=\"https://play.golang.org/p/C83SBwaZ_O\" rel=\"nofollow noreferrer\">play.golang.org/p/C83SBwaZ_O</a>"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1434052433, "post_id": 30789515, "comment_id": 49629929, "body": "@TimCooper so is there no way to have a constant header footer and dynamically changing content in the middle?"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1434053068, "post_id": 30789515, "comment_id": 49630277, "body": "You could always write out your header, content, and footer separately. For example: <code>headerTPL.Execute(out, data); contentTPL.Execute(out, data); footerTPL.Execute(out, data)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "edited": false, "score": 2, "creation_date": 1434051405, "post_id": 30789770, "comment_id": 49629332, "body": "Note that you can put multiple templates in the same source file with multiple <code>define ... end</code> blocks."}, {"owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "edited": false, "score": 0, "creation_date": 1434054778, "post_id": 30789770, "comment_id": 49631282, "body": "I&#39;m not 100%, but I think you&#39;d have to use <code>if ... else</code> which kind of muddies the waters. My gut feeling is that this kind of logic should be in the code to render the templates, and not the templates themselves. So you&#39;d maybe have <code>{{ .RenderedPageContent }}</code> instead of <code>{{ template .Page . }}</code>?"}], "tags": [], "owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "is_accepted": true, "score": 1, "last_activity_date": 1434050879, "creation_date": 1434050879, "answer_id": 30789770, "question_id": 30789515, "link": "https://stackoverflow.com/questions/30789515/in-html-templates-is-there-any-way-to-have-a-constant-header-footer-across-all-p/30789770#30789770", "title": "In html/templates is there any way to have a constant header/footer across all pages?", "body": "<p>Using <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow\">text/template</a>:</p>\n\n<ol>\n<li><p>Code to render it to Stdout</p>\n\n<pre><code>t := template.Must(template.ParseFiles(\"main.tmpl\", \"head.tmpl\", \"foot.tmpl\"))\nt.Execute(os.Stdout, nil)\n</code></pre></li>\n<li><p>main.tmpl:</p>\n\n<pre><code>{{template \"header\" .}}\n&lt;p&gt;main content&lt;/p&gt;\n{{template \"footer\" .}}\n</code></pre></li>\n<li><p>foot.tmpl:</p>\n\n<pre><code>{{define \"footer\"}}\n&lt;footer&gt;This is the foot&lt;/footer&gt;\n{{end}}\n</code></pre></li>\n<li><p>head.tmpl:</p>\n\n<pre><code>{{define \"header\"}}\n&lt;header&gt;This is the head&lt;/header&gt;\n{{end}}\n</code></pre></li>\n</ol>\n\n<p>This will result in:</p>\n\n<pre><code>&lt;header&gt;This is the head&lt;/header&gt;\n&lt;p&gt;main content&lt;/p&gt;\n&lt;footer&gt;This is the foot&lt;/footer&gt;\n</code></pre>\n\n<p>Using <a href=\"http://golang.org/pkg/html/template/\" rel=\"nofollow\">html/template</a> will be extremely similar.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "accepted_answer_id": 30789770, "answer_count": 1, "score": 3, "last_activity_date": 1434050879, "creation_date": 1434050070, "question_id": 30789515, "link": "https://stackoverflow.com/questions/30789515/in-html-templates-is-there-any-way-to-have-a-constant-header-footer-across-all-p", "title": "In html/templates is there any way to have a constant header/footer across all pages?", "body": "<p>Reading the <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow\">docs</a> wasn't particularly helpful and I want to know if the structure</p>\n\n<pre><code>{{header}}\n\n   {{content that always changes}}\n\n{{footer}}\n</code></pre>\n\n<p>is achievable with golang.</p>\n"}, {"tags": ["struct", "types", "go", "func"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1434044952, "post_id": 30787453, "comment_id": 49625386, "body": "May I ask your reason for not using a <code>map[string]string</code>? I would personally avoid using reflection to add trivial functionality to an application, the work around is probably better."}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1434050886, "post_id": 30787453, "comment_id": 49629028, "body": "The example above is a very simplistic compared to what I am trying to do, but it was enough to get the point across."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1434053476, "post_id": 30787453, "comment_id": 49630514, "body": "Seemed likely but worth asking. You still may want to consider a different model at this level."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1434043983, "creation_date": 1434043983, "answer_id": 30787605, "question_id": 30787453, "link": "https://stackoverflow.com/questions/30787453/can-you-pass-a-struct-fieldname-in-to-a-function-in-golang/30787605#30787605", "title": "Can you pass a struct fieldname in to a function in golang?", "body": "<p>The only way that I am aware of is to use reflection:</p>\n\n<pre><code>func (this *Home) AddRoomName(fieldname, value string) {\n    h := reflect.ValueOf(this).Elem()\n    h.FieldByName(fieldname).Set(reflect.ValueOf(value))\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/ZvtF_05CE_\" rel=\"nofollow\">http://play.golang.org/p/ZvtF_05CE_</a></p>\n"}, {"tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": false, "score": 0, "last_activity_date": 1434051356, "creation_date": 1434051356, "answer_id": 30789885, "question_id": 30787453, "link": "https://stackoverflow.com/questions/30787453/can-you-pass-a-struct-fieldname-in-to-a-function-in-golang/30789885#30789885", "title": "Can you pass a struct fieldname in to a function in golang?", "body": "<p>One more idea that comes to my mind is like this, not sure if it makes sense in your case though:</p>\n\n<pre><code>func Set(field *string, value string) {\n    *field = value\n}\n\nhome := &amp;Home{\"asd\", \"zxc\"}\nfmt.Println(home)\nSet(&amp;home.Bedroom, \"bedroom\")\nSet(&amp;home.Bathroom, \"bathroom\")\nfmt.Println(home)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/VGb69OLX-X\" rel=\"nofollow\">http://play.golang.org/p/VGb69OLX-X</a></p>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 5652356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfe9cd530a74a966989a53ccf742b63f?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5652356/john"}, "is_accepted": false, "score": 0, "last_activity_date": 1449539667, "creation_date": 1449539667, "answer_id": 34146666, "question_id": 30787453, "link": "https://stackoverflow.com/questions/30787453/can-you-pass-a-struct-fieldname-in-to-a-function-in-golang/34146666#34146666", "title": "Can you pass a struct fieldname in to a function in golang?", "body": "<p>Use type assertions on an interface value:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Test struct {\n    S string\n    I int\n}\n\nfunc (t *Test) setField(name string, value interface{}) {\n    switch name {\n        case \"S\":\n            t.S = value.(string)\n        case \"I\":\n            t.I = value.(int)\n    }\n}\n\nfunc main() {\n    t := &amp;Test{\"Hello\", 0}\n    fmt.Println(t.S, t.I)\n    t.setField(\"S\", \"Goodbye\")\n    t.setField(\"I\", 1)\n    fmt.Println(t.S, t.I)\n}\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1449539667, "creation_date": 1434043479, "question_id": 30787453, "link": "https://stackoverflow.com/questions/30787453/can-you-pass-a-struct-fieldname-in-to-a-function-in-golang", "title": "Can you pass a struct fieldname in to a function in golang?", "body": "<p>Say for example you have something like this, trying to make the example as simple as possible.  </p>\n\n<pre><code>type Home struct {\n    Bedroom string\n    Bathroom string\n}\n</code></pre>\n\n<p>How do you pass the field name, or can you, to a function?</p>\n\n<pre><code>func (this *Home) AddRoomName(fieldname, value string) {\n    this.fieldname = value\n}\n</code></pre>\n\n<p>Obviously that does not work... The only way I can see to do this is to use two functions which adds a lot of extra code when the struct gets really big and has a lot of similar code.</p>\n\n<pre><code>func (this *Home) AddBedroomName(value string) {\n    this.Bedroom = value\n}\nfunc (this *Home) AddBathroomName(value string) {\n    this.Bathroom = value\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1434042047, "post_id": 30786884, "comment_id": 49623686, "body": "That is definitely a special case for <code>byte</code>. I&#39;m not sure how it is implemented but if you try something like that with other types it won&#39;t compile. Once I track down the actual implementation or spec I will provide an answer."}], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434042357, "post_id": 30787088, "comment_id": 49623853, "body": "I thought it would be something like that. That&#39;s very interesting. Thank you!"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1434042539, "post_id": 30787088, "comment_id": 49623966, "body": "@AR7 great questions, my pleasure to answer them. I&#39;m going to update because I had a minor epiphany about what the code actually is."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1434042682, "last_edit_date": 1434042682, "creation_date": 1434042290, "answer_id": 30787088, "question_id": 30786884, "link": "https://stackoverflow.com/questions/30786884/parenthesis-after-a-slice-in-go/30787088#30787088", "title": "Parenthesis after a slice in go?", "body": "<p>From the spec;</p>\n\n<blockquote>\n  <p>Converting a value of a string type to a slice of bytes type yields a slice whose successive elements are the bytes of the string.</p>\n\n<pre><code>[]byte(\"hell\u00f8\")   // []byte{'h', 'e', 'l', 'l', '\\xc3', '\\xb8'}\n[]byte(\"\")        // []byte{}\n\nMyBytes(\"hell\u00f8\")  // []byte{'h', 'e', 'l', 'l', '\\xc3', '\\xb8'}\n</code></pre>\n</blockquote>\n\n<p>Check out the full conversion rules here; <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">https://golang.org/ref/spec#Conversions</a></p>\n\n<p>Based upon that, while the two lines of code result in the same behavior they are actually exercising completely unrelated language features. In the <code>[]byte{'l', 'o', 'l'}</code> case you're simply using composite literal syntax for initilization and this will always work with any types. In the other case a conversion is occurring, and beyond that it's a special case for strings. It happens to look much more like a constuctor is being called (thus making it a substitute for the composite literal syntax) but that is just coincidence.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 2, "accepted_answer_id": 30787088, "answer_count": 1, "score": 5, "last_activity_date": 1434042682, "creation_date": 1434041649, "last_edit_date": 1434042103, "question_id": 30786884, "link": "https://stackoverflow.com/questions/30786884/parenthesis-after-a-slice-in-go", "title": "Parenthesis after a slice in go?", "body": "<p>I've recently started learning go, and following through a <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow\">tutorial</a>. In the tutorial there is the line:</p>\n\n<pre><code>p1 := &amp;Page{Title: \"TestPage\", Body: []byte(\"This is a sample Page.\")}\n</code></pre>\n\n<p>They have a slice with parenthesis defined:</p>\n\n<pre><code>[]byte(\"This is a sample Page.\")\n</code></pre>\n\n<p>However from all the docs I've read I've never seen parenthesis after a slice. I've only seen the format:</p>\n\n<pre><code>b := []byte{'g', 'o', 'l', 'a', 'n', 'g'}\n</code></pre>\n\n<p>Using the curly braces. What is the role of the parenthesis?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 4591, "user_id": 3887945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7Nb72.jpg?s=128&g=1", "display_name": "Theyouthis", "link": "https://stackoverflow.com/users/3887945/theyouthis"}, "edited": false, "score": 0, "creation_date": 1475166849, "post_id": 32242522, "comment_id": 66845422, "body": "What do you do with the &#39;main&#39; function? Leave it empty? I cant deploy to app engine unless I have one."}, {"owner": {"reputation": 4591, "user_id": 3887945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7Nb72.jpg?s=128&g=1", "display_name": "Theyouthis", "link": "https://stackoverflow.com/users/3887945/theyouthis"}, "edited": false, "score": 0, "creation_date": 1475172016, "post_id": 32242522, "comment_id": 66848348, "body": "If you are using a flexible env then you must have a main(){}"}], "tags": [], "owner": {"reputation": 919, "user_id": 1954661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/163a5b4c9b453b3467768119ce7eabd6?s=128&d=identicon&r=PG", "display_name": "Alex Dvoretsky", "link": "https://stackoverflow.com/users/1954661/alex-dvoretsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1440658331, "creation_date": 1440658331, "answer_id": 32242522, "question_id": 30786420, "link": "https://stackoverflow.com/questions/30786420/always-get-502-bad-gateway-when-use-app-engine-vm/32242522#32242522", "title": "always get &quot;502 Bad gateway&quot; when use app engine VM", "body": "<p>I think you get 502 because of panic on attempt to get Context. You can see it with command <code>sudo docker logs -f gaeapp</code> after connecting to VM instance via ssh.</p>\n\n<p>It seems that all examples for appengine vm are broken and you should use <code>init()</code>, not <code>main()</code> for initialization:</p>\n\n<pre><code>package notmainpackage\n\nimport (\n  \"net/http\"\n\n  \"google.golang.org/appengine\"\n  \"google.golang.org/appengine/log\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handle)\n    appengine.Main()\n}\n\nfunc handle(w http.ResponseWriter, r *http.Request) {\n   ctx := appengine.NewContext(r)\n   log.Infof(ctx, \"got appengine context\")\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5000077, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1Q7Vb_ZkSRA/AAAAAAAAAAI/AAAAAAAAADA/jczbRX12lDo/photo.jpg?sz=128", "display_name": "Xin", "link": "https://stackoverflow.com/users/5000077/xin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1176, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1440658331, "creation_date": 1434040227, "last_edit_date": 1434040633, "question_id": 30786420, "link": "https://stackoverflow.com/questions/30786420/always-get-502-bad-gateway-when-use-app-engine-vm", "title": "always get &quot;502 Bad gateway&quot; when use app engine VM", "body": "<p>I'm trying to use the app engine VM for my project (env: Go). But am having problems I still haven't been able to resolve after days of searching:</p>\n\n<ol>\n<li><p>I can't use the package \"google.golang.org/appengine\" and \"google.golang.org/cloud/*\"\nWhen I deploy my code which contains the above packages I can deploy successfully, but when I access the URL, return always \"502 Bad Gateway\".\nIf I deploy the code without the above package, all works very well</p></li>\n<li><p>The problem above happens after an update some of my package. Because I get this problem after I did \"go get -u ...\", before that all works well</p></li>\n<li><p>When I see the last commit here (package \"google.golang.org/appengine\"): <a href=\"https://github.com/golang/appengine/commit/25b8450bec636c6b6e3b9b33d3a3f55230b10812\" rel=\"nofollow\">https://github.com/golang/appengine/commit/25b8450bec636c6b6e3b9b33d3a3f55230b10812</a>\nI don't understand when replace \"package helloworld\" -> \"package main\". If I depoy with \"package main\", I don't know how to access the handler. For example:</p></li>\n</ol>\n\n<p><code>func main() {\n    http.HandleFunc(\"/hello\", helloHandler)\n    appengine.Main()\n}</code></p>\n\n<p>After deploy, how to test?? Because \"my_app.appspot.com/hello\" return 404, page not found</p>\n\n<p>I don't know if there is someone else having the same problem. Please help, thanks!!!</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 698, "user_id": 210827, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/da0d68721d1a1c02dcebebd6a5c35887?s=128&d=identicon&r=PG", "display_name": "getWeberForStackExchange", "link": "https://stackoverflow.com/users/210827/getweberforstackexchange"}, "edited": false, "score": 0, "creation_date": 1439186162, "post_id": 30786206, "comment_id": 51738178, "body": "I&#39;m not sure why you were downvoted, accept my upvote."}], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 27, "last_activity_date": 1434040130, "last_edit_date": 1434040130, "creation_date": 1434039947, "answer_id": 30786320, "question_id": 30786206, "link": "https://stackoverflow.com/questions/30786206/are-pointers-dereferenced-by-default-inside-of-methods/30786320#30786320", "title": "Are pointers dereferenced by default inside of methods?", "body": "<p>Yes, the pointer to the struct is automatically dereferenced. From the <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"noreferrer\">spec on selectors</a>:</p>\n\n<blockquote>\n  <p>The following rules apply to selectors:</p>\n  \n  <ol>\n  <li>For a value <code>x</code> of type <code>T</code> or <code>*T</code> where <code>T</code> is not a pointer or interface type, <code>x.f</code> denotes the field or method at the shallowest depth in <code>T</code>\n  where there is such an <code>f</code>. If there is not exactly one <code>f</code> with\n  shallowest depth, the selector expression is illegal.</li>\n  </ol>\n  \n  <p>...</p>\n  \n  <ol start=\"3\">\n  <li>As an exception, if the type of <code>x</code> is a named pointer type and <code>(*x).f</code> is a valid selector expression denoting a field (but not a\n  method), <code>x.f</code> is shorthand for <code>(*x).f</code>.</li>\n  </ol>\n</blockquote>\n\n<p>Therefore, the following two statements are the same (with the first being preferred):</p>\n\n<pre><code>filename := p.Title + \".txt\"\nfilename := (*p).Title + \".txt\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1434040636, "creation_date": 1434040636, "answer_id": 30786548, "question_id": 30786206, "link": "https://stackoverflow.com/questions/30786206/are-pointers-dereferenced-by-default-inside-of-methods/30786548#30786548", "title": "Are pointers dereferenced by default inside of methods?", "body": "<p>You do not have to deference pointers or use a special access operator to access the fields of a struct in Go.</p>\n\n<pre><code>myRef := &amp;ILikeCompositeLiteralInitilization{}\nfmt.Println(myRef.Dereferenced);\n</code></pre>\n\n<p>is functionally equivalent to;</p>\n\n<pre><code>fmt.Printn((*myRef).Dereferenced);\n</code></pre>\n\n<p>Possibly worth noting that the behavior for functions is not like this. Meaning, I would have to dereference to invoke a method who's recieving type is the value and not a pointer. IE;</p>\n\n<pre><code>func (*ILikeCompositeLiteralInitilization) PointerVersion()\nfunc (ILikeCompositeLiteralInitilization) ValueVersion()\n\nmyRef.PointerVersion() // compiler likes this\n\nmyRef.ValueVersion() // won't compile\n\n(*myRef).ValueVersion() // compiler is OK with this\n</code></pre>\n\n<p>Basically, with functions no implicit dereference or address of type operation will occur, your code won't compile.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4601, "favorite_count": 6, "accepted_answer_id": 30786320, "answer_count": 2, "score": 18, "last_activity_date": 1546267171, "creation_date": 1434039590, "last_edit_date": 1546267171, "question_id": 30786206, "link": "https://stackoverflow.com/questions/30786206/are-pointers-dereferenced-by-default-inside-of-methods", "title": "Are pointers dereferenced by default inside of methods?", "body": "<p>I'm confused by methods on structs in Go. I've following along in a tutorial in which they have:</p>\n\n<pre><code>func (p *Page) save() error {\n    filename := p.Title + \".txt\"\n    return ioutil.WriteFile(filename, p.Body, 0600)\n}\n</code></pre>\n\n<p>From my understanding, <code>p</code> is pointer and you would need to dereference the pointer before retrieving a property for example:</p>\n\n<pre><code>filename := (*p).Title + \".txt\"\n</code></pre>\n\n<p>The only way this makes sense to me is if the dot is acting like <code>-&gt;</code> in C++. What am I missing?</p>\n"}, {"tags": ["go", "numbers", "precision"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434036998, "post_id": 30784608, "comment_id": 49620355, "body": "You should probably use <code>math&#47;big</code> if you want higher precision than float64."}, {"owner": {"reputation": 517, "user_id": 2395283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d1e7d33f933c74a10e72a5f37b6a0?s=128&d=identicon&r=PG", "display_name": "Thomas Modeneis", "link": "https://stackoverflow.com/users/2395283/thomas-modeneis"}, "edited": false, "score": 0, "creation_date": 1434037282, "post_id": 30784608, "comment_id": 49620591, "body": "I&#39;ve edited with the full code. Thanks"}, {"owner": {"reputation": 517, "user_id": 2395283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d1e7d33f933c74a10e72a5f37b6a0?s=128&d=identicon&r=PG", "display_name": "Thomas Modeneis", "link": "https://stackoverflow.com/users/2395283/thomas-modeneis"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1434037660, "post_id": 30784608, "comment_id": 49620896, "body": "@JimB, not sure how to do this, can you maybe modify the playground example with your suggestion ?"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1434038018, "post_id": 30784608, "comment_id": 49621177, "body": "As mentioned, you can (should?) just use float64 and live with rounding. If you have a reason to wish to keep the exact string perhaps <a href=\"https://golang.org/pkg/encoding/json/#Number\" rel=\"nofollow noreferrer\"><code>json.Number</code></a> may be of some use."}, {"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 1, "creation_date": 1434039683, "post_id": 30784608, "comment_id": 49622311, "body": "Also the question you have to ask yourself is how is the input generated anyway? If double-precision number has been used at source, the very last digits cannot be trusted anyway. You can reliably represent up to 15 decimal digits by using <code>float64</code>, but your input has 17."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1434040188, "post_id": 30784608, "comment_id": 49622620, "body": "BTW, an example using <code>json.Numer</code> (useful if a desired use case is re-marshalling the exact representation unchanged when not doing calculations) might be something like this (also shows using big.Rat; very much overkill for lat+long IMO): <a href=\"https://play.golang.org/p/TqhvyS8aRs\" rel=\"nofollow noreferrer\">play.golang.org/p/TqhvyS8aRs</a>"}], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 2395283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d1e7d33f933c74a10e72a5f37b6a0?s=128&d=identicon&r=PG", "display_name": "Thomas Modeneis", "link": "https://stackoverflow.com/users/2395283/thomas-modeneis"}, "edited": false, "score": 0, "creation_date": 1434123149, "post_id": 30785606, "comment_id": 49661748, "body": "Thank you for your very complete answer, I really appreciate it!"}, {"owner": {"reputation": 5182, "user_id": 550967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1NTf.jpg?s=128&g=1", "display_name": "DallaRosa", "link": "https://stackoverflow.com/users/550967/dallarosa"}, "reply_to_user": {"reputation": 517, "user_id": 2395283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d1e7d33f933c74a10e72a5f37b6a0?s=128&d=identicon&r=PG", "display_name": "Thomas Modeneis", "link": "https://stackoverflow.com/users/2395283/thomas-modeneis"}, "edited": false, "score": 0, "creation_date": 1481248445, "post_id": 30785606, "comment_id": 69311258, "body": "@ThomasModeneis Maybe you wanna accept the guy&#39;s answer? :)"}], "tags": [], "owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "is_accepted": true, "score": 19, "last_activity_date": 1434039399, "last_edit_date": 1434039399, "creation_date": 1434037811, "answer_id": 30785606, "question_id": 30784608, "link": "https://stackoverflow.com/questions/30784608/go-float64-does-not-work-for-latitude-and-longitude/30785606#30785606", "title": "Go float64 does not work for latitude and longitude", "body": "<h2>A practical solution:</h2>\n\n<p>Do nothing.</p>\n\n<p>The difference in the numbers is about a tenth of the width of a single small atom, and your measurements can't possibly be that precise.</p>\n\n<p>The eighth decimal place (you have 15 in your numbers) represents a distance of about 1.1mm. I doubt if your measurements are accurate to this degree, and anything more is getting really silly. The 5th decimal place is about 1.1m, which is in the realm of sanity, and not affected by floating point errors.</p>\n\n<p>The <a href=\"http://en.wikipedia.org/wiki/Decimal_degrees\" rel=\"noreferrer\">wikipedia page on Decimal Degrees</a> may be helpful in determining which values are reasonable for your project.</p>\n\n<h2>Some considerations:</h2>\n\n<p>There are two potential issues at play:</p>\n\n<ol>\n<li><p><strong>Floating point</strong>:</p>\n\n<p>Some reading that might shed light on floating point issues:  </p>\n\n<ul>\n<li><a href=\"http://floating-point-gui.de/\" rel=\"noreferrer\">What Every Programmer Should Know About Floating-Point Arithmetic or Why don\u2019t my numbers add up?</a></li>\n<li><a href=\"http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html\" rel=\"noreferrer\">What Every Computer Scientist Should Know About Floating-Point Arithmetic</a></li>\n</ul>\n\n<p>If you read these, and understand how floating point works in\npractice, you <em>may</em> be enlightened, and understand what's happening\nand how to work around it.</p></li>\n<li><p><strong>Precision of measurement</strong>:</p>\n\n<p>This, in my opinion, is the bigger issue. One number you posted was <code>13.519004709972312</code>, which was displayed as <code>13.519004709972313</code>. Whether the value has \"changed\" or not (see: 1), every software calculator I tried to calculate the difference between these values returned <code>0</code>, which is indicative.</p>\n\n<p>Doing the calculation by hand revealed a difference of <code>0.000000000000001</code> in the values. That is, a 14 zeroes before the trailing one, or <code>1^-15</code>. </p>\n\n<p>The <a href=\"http://en.wikipedia.org/wiki/Latitude\" rel=\"noreferrer\">wikipedia page on Latitude</a> says:</p>\n\n<blockquote>\n  <p>the meridian length of 1 degree of latitude on the sphere is <strong>111.2 km</strong>.</p>\n</blockquote>\n\n<p>Working backward from this, <em>the difference in locations represented by the 15th decimal place in a latitude corresponds to a distance of approximately 0.00000011mm</em>, or 0.11nanometers. </p>\n\n<p>From the The Physics Factbook's <a href=\"http://hypertextbook.com/facts/MichaelPhillip.shtml\" rel=\"noreferrer\">Diameter of an Atom</a> page: </p>\n\n<blockquote>\n  <p>An atom is a million times smaller than the thickest human hair. The diameter of an atom ranges from about 0.1 to 0.5 nanometers </p>\n</blockquote>\n\n<p>Therefore, your measurement would be \"off\" by at most 1/10 of the diameter of a single atom.</p>\n\n<p>Even if all my calculations were off by a million or billion times, the distances would still be so small that they would not matter in practice!</p></li>\n</ol>\n"}], "owner": {"reputation": 517, "user_id": 2395283, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5d1e7d33f933c74a10e72a5f37b6a0?s=128&d=identicon&r=PG", "display_name": "Thomas Modeneis", "link": "https://stackoverflow.com/users/2395283/thomas-modeneis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2633, "favorite_count": 0, "accepted_answer_id": 30785606, "answer_count": 1, "score": 0, "last_activity_date": 1434061650, "creation_date": 1434035213, "last_edit_date": 1434061650, "question_id": 30784608, "link": "https://stackoverflow.com/questions/30784608/go-float64-does-not-work-for-latitude-and-longitude", "title": "Go float64 does not work for latitude and longitude", "body": "<p>I'm trying to parse latitude and longitude from a json object with precision, and I picked float64 for the job. However float64 is somehow rounding the number and I'm not sure what to do in order to avoid rounding.</p>\n\n<p>I've created a quick snippet so you can execute the problem:\n<a href=\"http://play.golang.org/p/9g6Imn-7GK\" rel=\"nofollow\">http://play.golang.org/p/9g6Imn-7GK</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Position struct {\n    Lat float64 `json:\"lat\"`\n    Lon float64 `json:\"lon\"`\n}\n\nfunc main() {\n    s := `{\"lat\":13.519004709972312,\"lon\": -13.519004709972312}`\n    pos := Position{}\n    json.Unmarshal([]byte(s), &amp;pos)\n\n    if !reflect.DeepEqual(s, &amp;pos) {\n        fmt.Printf(\"\\nExpected %#v\\nbut got  %#v\", s, pos)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 1, "creation_date": 1434026217, "post_id": 30780924, "comment_id": 49611926, "body": "How does the POST body look like? Please provide a sample."}, {"owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "edited": false, "score": 0, "creation_date": 1434026382, "post_id": 30780924, "comment_id": 49612063, "body": "Standard body key, value parameters but I don&#39;t know keys. ( In python is easy because I can convert to dict whatever I want but in go I don;t know how when don&#39;t know names and number of keys)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 2, "creation_date": 1434026534, "post_id": 30780924, "comment_id": 49612171, "body": "Please <a href=\"https://stackoverflow.com/posts/30780924/edit\">edit</a> your question and include a sample of this body. Please also include the code you have tried to parse it."}, {"owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "edited": false, "score": 0, "creation_date": 1434027120, "post_id": 30780924, "comment_id": 49612630, "body": "@LutzHorn I&#39;ve edited"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 1, "creation_date": 1434027350, "post_id": 30780924, "comment_id": 49612798, "body": "You write &quot;Standard body key, value parameters&quot; but you try to use a JSON decoder. Is the body of the request JSON?"}, {"owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "edited": false, "score": 0, "creation_date": 1434027500, "post_id": 30780924, "comment_id": 49612907, "body": "@LutzHorn Yes, key value in json"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "edited": false, "score": 1, "creation_date": 1434027535, "post_id": 30780924, "comment_id": 49612934, "body": "Third and last time: Please <a href=\"https://stackoverflow.com/posts/30780924/edit\">edit</a> your question and provide a sample of the JSON body."}, {"owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "edited": false, "score": 0, "creation_date": 1434027647, "post_id": 30780924, "comment_id": 49613013, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/80282/discussion-between-paolaj-and-lutz-horn\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1907906"}, "is_accepted": true, "score": 1, "last_activity_date": 1434029259, "last_edit_date": 1434029259, "creation_date": 1434028320, "answer_id": 30781817, "question_id": 30780924, "link": "https://stackoverflow.com/questions/30780924/how-to-parse-parameters-from-post-body-to-mapstring-string/30781817#30781817", "title": "How to parse parameters from POST body to map[string] string?", "body": "<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\n\nfunc main() {\n    j := `{\"foo\": \"aa\", \"baz\": \"bb\", \"qux\": \"cc\"}`\n    byt := []byte(j)\n\n    var dat map[string]string   \n\n    if err := json.Unmarshal(byt, &amp;dat); err != nil {\n            panic(err)\n    }\n    fmt.Println(dat)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[qux:cc foo:aa baz:bb]\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/hQt7-caFCb\" rel=\"nofollow\">Go Playground</a></kbd></p>\n"}], "owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1125, "favorite_count": 0, "accepted_answer_id": 30781817, "answer_count": 1, "score": 0, "last_activity_date": 1434029259, "creation_date": 1434026047, "last_edit_date": 1434027761, "question_id": 30780924, "link": "https://stackoverflow.com/questions/30780924/how-to-parse-parameters-from-post-body-to-mapstring-string", "title": "How to parse parameters from POST body to map[string] string?", "body": "<p>How to parse parameters from <code>POST</code> body to <code>map[string] string</code>?</p>\n\n<p>I am using gin and I can parse to predefined structure but in this case I don't know key names.\n( I can when I know key names but when I don't know is a problem )</p>\n\n<pre><code>type Body struct {\n    Name    string\n    Email   string\n}\n\nbody := Body{}\nerr := json.NewDecoder( c.Request.Body ).Decode( &amp;body )\nif err != nil {\n    c.String( http.StatusServiceUnavailable, err.Error() )\n    return\n}\n</code></pre>\n\n<p>The body looks like this:</p>\n\n<pre><code>{ \n\"param1\": \"1\", \n\"param2\": \"1\", \n\"param3\": \"1\", \n\"param4\": \"1\" \n}\n</code></pre>\n"}, {"tags": ["go", "singleton"], "answers": [{"tags": [], "owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "is_accepted": true, "score": 5, "last_activity_date": 1434020513, "creation_date": 1434020513, "answer_id": 30778967, "question_id": 30778425, "link": "https://stackoverflow.com/questions/30778425/passing-variables-to-a-golang-package/30778967#30778967", "title": "Passing Variables to a Golang Package", "body": "<p>In Go, if your package <em>depends</em> on something external you <em>import</em> said thing. So, unless it's impossible for some reason, you should import the package that instantiates <code>bucket</code> and take it from there, either directly assigning it or in your package's <code>init</code> function.</p>\n\n<pre><code>import \"my/other/pkg\"\n\nvar bucket = pkg.InitBucket()\n</code></pre>\n\n<p>However, if it's impossible to determine what package will provision <code>bucket</code>, then your way is the way to Go. As an example, consider <code>database/sql</code> where SQL drivers have to be registered before they can be used.</p>\n\n<p>In general, <a href=\"http://en.wikipedia.org/wiki/Inversion_of_control\" rel=\"noreferrer\">IoC</a> does not apply to Go packages if that's what you had in mind.</p>\n"}], "owner": {"reputation": 1479, "user_id": 476648, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5330a9884cc276cb8db323c890289107?s=128&d=identicon&r=PG", "display_name": "Paul Mooney", "link": "https://stackoverflow.com/users/476648/paul-mooney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2692, "favorite_count": 1, "accepted_answer_id": 30778967, "answer_count": 1, "score": 2, "last_activity_date": 1434020513, "creation_date": 1434018865, "question_id": 30778425, "link": "https://stackoverflow.com/questions/30778425/passing-variables-to-a-golang-package", "title": "Passing Variables to a Golang Package", "body": "<p>Given a package containing the following local variable and functions:</p>\n\n<pre><code>var bucket *gocb.Bucket\n\nfunc Init(b *gocb.Bucket) {\n    bucket = b\n}\n\nfunc DoSomething() {\n    // do something with 'bucket'\n}\n</code></pre>\n\n<p>Is it acceptable to call the <code>Init</code> function, passing in an instance of <code>bucket</code>, before calling <code>DoSomething</code>, which is dependent on the <code>bucket</code> variable?</p>\n\n<p>Or, should <code>DoSomething</code> instead explicitly accept a <code>bucket</code> parameter, as follows:</p>\n\n<pre><code>func DoSomething(bucket *gocb.Bucket) {\n    // do something with 'bucket'\n}\n</code></pre>\n\n<p>I would prefer to instantiate a single instance of <code>bucket</code> at a package-level, and use it throughout the application life-cycle, as opposed to managing at a function-level. Is this acceptable from design, performance, etc., perspectives, or is there a preferred means of achieving this? Bearing in mind that <code>bucket</code> need only be instantiated once.</p>\n\n<p><code>DoSomething</code> will be called from a HTTP context; I would prefer that the HTTP handlers not have visibility on the <code>bucket</code> parameter, and instead instantiate <code>bucket</code> on application start-up.</p>\n"}, {"tags": ["mysql", "database", "go"], "comments": [{"owner": {"reputation": 19, "user_id": 4998095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i2nSfU7E6Gw/AAAAAAAAAAI/AAAAAAAAACQ/pmxSbAoVkFg/photo.jpg?sz=128", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/4998095/abdul-rehman"}, "edited": false, "score": 0, "creation_date": 1434195289, "post_id": 30774681, "comment_id": 49682871, "body": "Here is my new code, but again i&#39;m not able to get a record from Database :"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1434197434, "post_id": 30774681, "comment_id": 49683465, "body": "Two tips: consider using <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a> to marshal query results into structs. You should also look at using a single connection across your application\u2014a new connection pool via <code>sql.Open</code> on every request is extremely inefficient."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4998095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i2nSfU7E6Gw/AAAAAAAAAAI/AAAAAAAAACQ/pmxSbAoVkFg/photo.jpg?sz=128", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/4998095/abdul-rehman"}, "edited": false, "score": 0, "creation_date": 1434016076, "post_id": 30774903, "comment_id": 49604789, "body": "when i remove the <code>:</code>  from <code>err:=</code> the error is gone but doesn&#39;t retrieve the data !"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 2, "creation_date": 1434016350, "post_id": 30774903, "comment_id": 49604974, "body": "Because you&#39;re not checking the error to be <code>nil</code> before you assign to it again."}], "tags": [], "owner": {"reputation": 1281, "user_id": 4984282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1f908652b699b40d26e6829376cce8d?s=128&d=identicon&r=PG", "display_name": "TheOnlyError", "link": "https://stackoverflow.com/users/4984282/theonlyerror"}, "is_accepted": false, "score": 2, "last_activity_date": 1434009446, "creation_date": 1434009446, "answer_id": 30774903, "question_id": 30774681, "link": "https://stackoverflow.com/questions/30774681/retrieve-a-record-from-mysql-in-golang-using-database-sql/30774903#30774903", "title": "Retrieve a record from mysql in golang using database/sql", "body": "<p>Remove the colon <code>:</code> from <code>err :=</code> as you are assigning a new value to existing variable.</p>\n"}], "owner": {"reputation": 19, "user_id": 4998095, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-i2nSfU7E6Gw/AAAAAAAAAAI/AAAAAAAAACQ/pmxSbAoVkFg/photo.jpg?sz=128", "display_name": "Abdul Rehman", "link": "https://stackoverflow.com/users/4998095/abdul-rehman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3469, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1434195500, "creation_date": 1434008737, "last_edit_date": 1434195500, "question_id": 30774681, "link": "https://stackoverflow.com/questions/30774681/retrieve-a-record-from-mysql-in-golang-using-database-sql", "title": "Retrieve a record from mysql in golang using database/sql", "body": "<p>I'm trying to retrieve a record from mysql table and marshal it to json.\nBut i gotted the error that says : \".\\main.go:67: no new variables on left sife of :=\"\nI'm new in Golang Plz! help me to solve out this error!\nMy Code is :</p>\n\n<pre><code>func GetUser(w http.ResponseWriter, r *http.Request) {\n\n  urlParams   := mux.Vars(r)\n  id       := urlParams[\"id\"]\n  ReadUser := User{}\n  con, err := sql.Open(\"mysql\", \"root:YES@/social_network?charset=utf8\")\n\n  err := con.QueryRow(\"select * from users where user_id=?\",id).Scan(&amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email )\n  switch {\n      case err == sql.ErrNoRows:\n              fmt.Fprintf(w,\"No such user\")\n      case err != nil:\n              log.Fatal(err)\n      default:\n        output, _ := json.Marshal(ReadUser)\n        fmt.Fprintf(w,string(output))\n  }\n}\n</code></pre>\n\n<p>and Routes in main:</p>\n\n<pre><code>func main() {\n\n  gorillaRoute := mux.NewRouter()\n  gorillaRoute.HandleFunc(\"/api/user/create\", CreateUser)\n  gorillaRoute.HandleFunc(\"/api/user/read/:id\", GetUser)\n  http.Handle(\"/\", gorillaRoute)\n  http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Here is my new Code , but again not able to get record from database table, plz help me to figure out the error OR what things i do wrong?\npackage main</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n\n    _ \"github.com/go-sql-driver/mysql\"\n    \"github.com/gorilla/mux\"\n)\n\ntype API struct {\n    Message string \"json:message\"\n}\ntype User struct {\n    ID    int    \"json:id\"\n    Name  string \"json:username\"\n    Email string \"json:email\"\n    First string \"json:first\"\n    Last  string \"json:last\"\n}\n\nfunc Hello(w http.ResponseWriter, r *http.Request) {\n\n    // urlParams := mux.Vars(r)\n    // name := urlParams[\"user\"]\n    HelloMessage := \"User Creation page\"\n\n    message := API{HelloMessage}\n    output, err := json.Marshal(message)\n\n    if err != nil {\n        fmt.Println(\"Something went wrong!\")\n    }\n\n    fmt.Fprintf(w, string(output))\n\n}\n\n//POST A USER INTO DB\nfunc CreateUser(w http.ResponseWriter, r *http.Request) {\n    NewUser := User{}\n    NewUser.Name = r.FormValue(\"user\")\n    NewUser.Email = r.FormValue(\"email\")\n    NewUser.First = r.FormValue(\"first\")\n    NewUser.Last = r.FormValue(\"last\")\n    output, err := json.Marshal(NewUser)\n    fmt.Println(string(output))\n    if err != nil {\n        fmt.Println(\"Something went wrong!\")\n    }\n    con, err := sql.Open(\"mysql\", \"root:YES@/social_network?charset=utf8\")\n    sqlQuery := \"INSERT INTO users set user_nickname='\" + NewUser.Name + \"', user_first='\" + NewUser.First + \"', user_last='\" + NewUser.Last + \"', user_email='\" + NewUser.Email + \"'\"\n    q, err := con.Exec(sqlQuery)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(q)\n}\n\n//GET USERS FROM DB\nfunc GetUsers(w http.ResponseWriter, r *http.Request) {\n\n    db, err := sql.Open(\"mysql\", \"root:YES@/social_network?charset=utf8\")\n    if err != nil {\n        panic(err)\n    }\n    err = db.Ping()\n    if err != nil {\n        panic(err)\n    }\n    defer db.Close()\n    rows, err := db.Query(\"select * from users \")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n    var rowBuf, _ = rows.Columns()\n    var cols = make([]string, len(rowBuf))\n    copy(cols, rowBuf)\n    fmt.Println(rowBuf)\n    var vals = make([]interface{}, len(rowBuf))\n    for i, _ := range rowBuf {\n        vals[i] = &amp;rowBuf[i]\n    }\n    for rows.Next() {\n        err := rows.Scan(vals...)\n        if err != nil {\n            log.Fatal(err)\n        }\n        var m = map[string]interface{}{}\n        for i, col := range cols {\n            m[col] = vals[i]\n        }\n        obj, _ := json.Marshal(m)\n        //\n        fmt.Fprintf(w, string(obj))\n    }\n    err = rows.Err()\n    if err != nil {\n        log.Fatal(err)\n    }\n}\nfunc GetUser(w http.ResponseWriter, r *http.Request) {\n    urlParams := mux.Vars(r)\n    id := urlParams[\"id\"]\n    ReadUser := User{}\n    db, err := sql.Open(\"mysql\", \"root:YES@/social_network?charset=utf8\")\n    stmt := db.QueryRow(\"select * from users where id = ?\", id)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = stmt.Scan(&amp;ReadUser.ID, &amp;ReadUser.Name, &amp;ReadUser.First, &amp;ReadUser.Last, &amp;ReadUser.Email)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    result, err := json.Marshal(ReadUser)\n    fmt.Fprintf(w, string(result))\n}\nfunc main() {\n\n    gorillaRoute := mux.NewRouter()\n    gorillaRoute.HandleFunc(\"/api/user/create\", CreateUser)\n    gorillaRoute.HandleFunc(\"/api/user/read\", GetUsers)\n    gorillaRoute.HandleFunc(\"/api/user/:id\", GetUser)\n    http.Handle(\"/\", gorillaRoute)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n"}, {"tags": ["go", "base64"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1434008560, "post_id": 30774503, "comment_id": 49599777, "body": "See <a href=\"http://golang.org/pkg/encoding/base64/\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/base64</a>"}, {"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434008691, "post_id": 30774503, "comment_id": 49599869, "body": "I don&#39;t really understand the go documentations, can you give a working example sir?"}, {"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1434009425, "post_id": 30774503, "comment_id": 49600321, "body": "when I try to use this that came to go documentation <code>encoder := base64.NewEncoder(base64.StdEncoding, os.Stdout)     encoder.Write(a)     encoder.Close()</code> I encounter an error <code>cannot use a (type genreAPI) as type []byte in argument to encoder.Write</code>"}], "answers": [{"comments": [{"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1434011994, "post_id": 30775554, "comment_id": 49601963, "body": "the example data is byte <code>data := []byte(&quot;Pop&quot;)</code> while my data is in this format <code>a := genreAPI{Genre{&quot;Pop&quot;}, Genre{&quot;Rock&quot;}}</code> and when I execute the program, it gives me the error <code>cannot use a (type genreAPI) as type []byte in argument to encoder.Write</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 2, "creation_date": 1434013209, "post_id": 30775554, "comment_id": 49602774, "body": "@LeViNcE: You might try to add something called &quot;programming&quot; here: Of course you cannot stuff any nonsense into EncodeToString, especially as you do not want everything to be base64-encoded but only the content of the Genres. So just apply EncodeToString to the stuff you want to be encoded and as this seems to be strings you can trivially convert them to []byte suitable for encoding."}], "tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 5, "last_activity_date": 1434011448, "creation_date": 1434011448, "answer_id": 30775554, "question_id": 30774503, "link": "https://stackoverflow.com/questions/30774503/convert-data-to-base64-encode-in-go/30775554#30775554", "title": "Convert data to base64 encode in go", "body": "<p>I am not sure what exactly is not clear from the documentation. Not only it has a clear <a href=\"http://golang.org/pkg/encoding/base64/#Encoding.Encode\" rel=\"noreferrer\">name</a> which explains states what the method is doing, it also has an example.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    data := []byte(\"Pop\")\n    str := base64.StdEncoding.EncodeToString(data)\n    fmt.Println(str) // UG9w\n}\n</code></pre>\n\n<p><kbd><a href=\"http://play.golang.org/p/cBa9vS2LXV\" rel=\"noreferrer\">Go Playground</a></kbd></p>\n"}, {"comments": [{"owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "edited": false, "score": 0, "creation_date": 1434155752, "post_id": 30807903, "comment_id": 49675709, "body": "thanks for the response @tomasz , just one more question sir, at your given example, <code>Name Base64String</code> is the struct for <code>Genre</code> while in my case, I use <code>Name String</code> because the datas are came from a database, when I use <code>Base64String</code> no data fetch from the database while when I use <code>String</code> the output is not a base64encode. How can I achieved base64encode output with the <code>Name String</code> field on <code>Genre</code> struct. Thank you"}], "tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1434126602, "last_edit_date": 1434126602, "creation_date": 1434126293, "answer_id": 30807903, "question_id": 30774503, "link": "https://stackoverflow.com/questions/30774503/convert-data-to-base64-encode-in-go/30807903#30807903", "title": "Convert data to base64 encode in go", "body": "<p>You can customise the output of print functions by providing a <code>String()</code> method for your type. Either for the whole <code>Genre</code> or just for the name variable.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n)\n\ntype Base64String string\n\nfunc (b Base64String) String() string {\n    return base64.StdEncoding.EncodeToString([]byte(b))\n}\n\ntype Genre struct {\n    Name Base64String\n}\n\nfunc main() {\n    a := []Genre{Genre{\"Pop\"}, Genre{\"Rock\"}}\n    fmt.Println(a)                 // prints [{UG9w} {Um9jaw==}]\n    fmt.Println(string(a[0].Name)) // prints Pop\n}\n</code></pre>\n"}], "owner": {"reputation": 186, "user_id": 4993123, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/040dd3b10ebdd33f5f60fc9fb2d844e8?s=128&d=identicon&r=PG", "display_name": "LeViNcE", "link": "https://stackoverflow.com/users/4993123/levince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1972, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1434126602, "creation_date": 1434008212, "question_id": 30774503, "link": "https://stackoverflow.com/questions/30774503/convert-data-to-base64-encode-in-go", "title": "Convert data to base64 encode in go", "body": "<p>I am new to go programming language and I'm stock on this scenario on my code.\nHere's my example code:</p>\n\n<pre><code>a := genreAPI{Genre{\"Pop\"}, Genre{\"Rock\"}}\nfmt.Println(\"Value of a :\", a)\n</code></pre>\n\n<p>The current output is: <code>Value of a : [{Pop} {Rock}]</code></p>\n\n<p>How can I achieved an output like this:\n<code>Value of a : [{UG9w} {Um9jaw==}]</code>\nwhich is a base64 encode?</p>\n"}, {"tags": ["go", "key-value-store", "aerospike"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 1, "creation_date": 1434008179, "post_id": 30773207, "comment_id": 49599491, "body": "&quot;ASAP&quot; isn&#39;t a thing on Stack Overflow. It&#39;s your own problem."}, {"owner": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "edited": false, "score": 0, "creation_date": 1434158261, "post_id": 30773207, "comment_id": 49676082, "body": "Feel free to open a discussion on <a href=\"https://discuss.aerospike.com/c/client-libraries/go-client\" rel=\"nofollow noreferrer\">Aerospike&#39;s user forum</a>."}], "owner": {"reputation": 247, "user_id": 4964407, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/957426357643177/picture?type=large", "display_name": "Raunak Dugar", "link": "https://stackoverflow.com/users/4964407/raunak-dugar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "closed_date": 1434014436, "answer_count": 0, "score": 3, "last_activity_date": 1434015464, "creation_date": 1434004014, "last_edit_date": 1434015464, "question_id": 30773207, "link": "https://stackoverflow.com/questions/30773207/aerospike-key-value-store-using-go-client", "closed_reason": "Needs more focus", "title": "Aerospike Key-value Store using Go-client", "body": "<p>What is the data model to store millions of record efficiently in the aerospike database?</p>\n\n<p>Use case : storing millions of bid(value) for a particular id(key) and \nalso need to iterate over the values and operate on them as fast as possible and store them separately.</p>\n\n<p>Currently :using <strong>set</strong> as the key and <strong>bin</strong> as the value.</p>\n"}]