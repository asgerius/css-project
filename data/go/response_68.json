[{"tags": ["go", "etcd"], "answers": [{"tags": [], "owner": {"reputation": 5205, "user_id": 118201, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3332136bbcc2736f3d2118dfd7d98a15?s=128&d=identicon&r=PG", "display_name": "eSniff", "link": "https://stackoverflow.com/users/118201/esniff"}, "is_accepted": false, "score": 0, "last_activity_date": 1461859903, "creation_date": 1461859903, "answer_id": 36920089, "question_id": 36902925, "link": "https://stackoverflow.com/questions/36902925/how-to-set-consistency-option-in-golang-etcd-client/36920089#36920089", "title": "How to set consistency option in golang etcd client", "body": "<p><strong>With the new Client:</strong></p>\n\n<p>You use the GetOptions.Quorum : <a href=\"https://github.com/coreos/etcd/blob/master/client/keys.go#L211\" rel=\"nofollow\">https://github.com/coreos/etcd/blob/master/client/keys.go#L211</a></p>\n\n<p>Which you pass to the KeysAPI.Getcall: <a href=\"https://github.com/coreos/etcd/blob/master/client/keys.go#L103\" rel=\"nofollow\">https://github.com/coreos/etcd/blob/master/client/keys.go#L103</a></p>\n\n<p><strong>With the old client:</strong></p>\n\n<p>You use the SetConsistency func on the client.\n<code>\n    c := etcd.NewClient(hosts)\n    if err := c.SetConsistency(etcd.STRONG_CONSISTENCY); err != nil {\n        return nil, err\n    }\n</code>\nexample: <a href=\"https://github.com/lytics/metafora/blob/8ec2f856db6abe826989b255a02908fc3f0c5eef/m_etcd/transport.go#L73\" rel=\"nofollow\">https://github.com/lytics/metafora/blob/8ec2f856db6abe826989b255a02908fc3f0c5eef/m_etcd/transport.go#L73</a></p>\n"}], "owner": {"reputation": 173, "user_id": 2392336, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/XN6Gm.jpg?s=128&g=1", "display_name": "Smithsonian", "link": "https://stackoverflow.com/users/2392336/smithsonian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461859903, "creation_date": 1461801390, "question_id": 36902925, "link": "https://stackoverflow.com/questions/36902925/how-to-set-consistency-option-in-golang-etcd-client", "title": "How to set consistency option in golang etcd client", "body": "<p>Can anyone tell me how to set consistency=true from golang etcd client? Pr: <a href=\"https://github.com/coreos/etcd/pull/866/files\" rel=\"nofollow\">https://github.com/coreos/etcd/pull/866/files</a> fixing issue: <a href=\"https://github.com/coreos/etcd/issues/741\" rel=\"nofollow\">https://github.com/coreos/etcd/issues/741</a> only changes server side behavior. Has anyone used this option?</p>\n"}, {"tags": ["xml", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "edited": false, "score": 0, "creation_date": 1461799239, "post_id": 36902570, "comment_id": 61369165, "body": "Thanks @icza - easy fix :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1473775584, "last_edit_date": 1473775584, "creation_date": 1461799102, "answer_id": 36902570, "question_id": 36902518, "link": "https://stackoverflow.com/questions/36902518/correct-layout-of-structs-to-parse-xml-in-go/36902570#36902570", "title": "Correct layout of structs to parse xml in go", "body": "<p>The layer that the <code>Ports</code> wrapper struct creates is unnecessary, drop it. You only need to model the contents of the root xml element which is <code>&lt;ports&gt;</code> and its content is described / modeled by <code>PortInfo</code>. There is no need for a type that wraps the root element.</p>\n\n<p>Simply change</p>\n\n<pre><code>var x Ports\n</code></pre>\n\n<p>to</p>\n\n<pre><code>var x PortInfo \n</code></pre>\n\n<p>And it will work. Try it on the <a href=\"https://play.golang.org/p/_0xLXGD54_\" rel=\"nofollow\">Go Playground</a>. Output (wrapped):</p>\n\n<pre><code>{Extra:{State:closed Count:64 Reason:{Reason:conn-refused Count:64}}\n    PortProp:{Protocol:tcp Port:22 StateStuff:{State:open Reason:syn-ack}}}\n</code></pre>\n"}], "owner": {"reputation": 1010, "user_id": 3326103, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06afeeee747f8c3245b1dc74f634db88?s=128&d=identicon&r=PG&f=1", "display_name": "linuxfan", "link": "https://stackoverflow.com/users/3326103/linuxfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 36902570, "answer_count": 1, "score": 1, "last_activity_date": 1475605391, "creation_date": 1461798733, "last_edit_date": 1475605391, "question_id": 36902518, "link": "https://stackoverflow.com/questions/36902518/correct-layout-of-structs-to-parse-xml-in-go", "title": "Correct layout of structs to parse xml in go", "body": "<p>Trying to parse some nmap data with golang, but the layout of my structs isn't quite working. Link to code on playground: <a href=\"https://play.golang.org/p/kODRGiH71W\" rel=\"nofollow\">https://play.golang.org/p/kODRGiH71W</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n)\n\ntype Extrareasons struct {\n    Reason string `xml:\"reason,attr\"`\n    Count  uint32 `xml:\"count,attr\"`\n}\n\ntype Extraports struct {\n    State  string       `xml:\"state,attr\"`\n    Count  uint32       `xml:\"count,attr\"`\n    Reason Extrareasons `xml:\"extrareasons\"`\n}\n\ntype StateProps struct {\n    State  string `xml:\"state,attr\"`\n    Reason string `xml:\"reason,attr\"`\n}\n\ntype PortProps struct {\n    Protocol string `xml:\"protocol,attr\"`\n    Port     uint32 `xml:\"portid,attr\"`\n    StateStuff StateProps `xml:\"state\"`\n}\n\ntype PortInfo struct {\n    Extra    Extraports `xml:\"extraports\"`\n    PortProp PortProps  `xml:\"port\"`\n}\n\ntype Ports struct {\n    Port PortInfo `xml:\"ports\"`\n}\n\nfunc main() {\n    xmlString := `&lt;ports&gt;\n         &lt;extraports state=\"closed\" count=\"64\"&gt;\n            &lt;extrareasons reason=\"conn-refused\" count=\"64\" /&gt;\n         &lt;/extraports&gt;\n         &lt;port protocol=\"tcp\" portid=\"22\"&gt;\n            &lt;state state=\"open\" reason=\"syn-ack\" reason_ttl=\"0\" /&gt;\n            &lt;service name=\"ssh\" method=\"table\" conf=\"3\" /&gt;\n         &lt;/port&gt;\n      &lt;/ports&gt;`\n\n    var x Ports\n    if err := xml.Unmarshal([]byte(xmlString), &amp;x); err == nil {\n        fmt.Printf(\"%+v\\n\", x)\n    } else {\n        fmt.Println(\"err:\", err)\n    }\n\n}\n\n$ go run test.go \n{Port:{Extra:{State: Count:0 Reason:{Reason: Count:0}} PortProp:{Protocol: Port:0 StateStuff:{State: Reason:}}}}\n</code></pre>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1461794450, "post_id": 36901658, "comment_id": 61367476, "body": "I&#39;ve never seen this error so this is a bit of a guess, but I think you&#39;re mixing your own package (<code>boxcar</code>) with the Go standard library in <code>go&#47;src&#47;</code>, when you need to keep them separate. If so, <a href=\"http://stackoverflow.com/questions/20628918/cannot-download-gopath-not-set/20629533#20629533\">here&#39;s a quick intro to setting up a GOPATH</a> with links to more."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461795090, "post_id": 36901658, "comment_id": 61367745, "body": "I think that error is from trying to import packages in GOROOT. How have you configured your environment?"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 7260439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91160fb9619a9a2cccf8bfde65c2eb74?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Miao", "link": "https://stackoverflow.com/users/7260439/andrew-miao"}, "is_accepted": true, "score": 14, "last_activity_date": 1481087620, "creation_date": 1481087620, "answer_id": 41009882, "question_id": 36901658, "link": "https://stackoverflow.com/questions/36901658/error-non-standard-import-gopkg-in-yaml-v2-in-standard-package/41009882#41009882", "title": "Error: Non-standard import &quot;gopkg.in/yaml.v2&quot; in standard package", "body": "<p>Go has 2 paths that must be defined in os environment, GoRoot and GoPath, GoRoot is installation path of Go, there are only \"standard packages\" in it. GoPath is working folder, there are 3rd party (non-standard) packages in it, your source code folder should be in GoPath and be recognized as non-standard package. like C:\\gopath\\src\\yourproject</p>\n"}], "owner": {"reputation": 93, "user_id": 2089785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vLn8m.jpg?s=128&g=1", "display_name": "JB Reefer", "link": "https://stackoverflow.com/users/2089785/jb-reefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10882, "favorite_count": 0, "accepted_answer_id": 41009882, "answer_count": 1, "score": 8, "last_activity_date": 1481087620, "creation_date": 1461794285, "question_id": 36901658, "link": "https://stackoverflow.com/questions/36901658/error-non-standard-import-gopkg-in-yaml-v2-in-standard-package", "title": "Error: Non-standard import &quot;gopkg.in/yaml.v2&quot; in standard package", "body": "<p>I'm trying to import go-yaml, from <a href=\"https://github.com/go-yaml/yaml\" rel=\"noreferrer\">https://github.com/go-yaml/yaml</a>, and I'm seeing an error that Google isn't helping with.</p>\n\n<p>I ran <code>go get gopkg.in/yaml.v2</code>, but I am getting the error: <code>start.go:6:5: non-standard import \"gopkg.in/yaml.v2\" in standard package \"boxcar\"</code> when I try to run my program. I'm not doing anything exotic in my import, either:</p>\n\n<pre><code>package main;\n\nimport (\n    \"os\"\n    \"net\"\n    \"gopkg.in/yaml.v2\"  \n)\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["http", "go", "server"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1461798946, "last_edit_date": 1461798946, "creation_date": 1461791296, "answer_id": 36900921, "question_id": 36900894, "link": "https://stackoverflow.com/questions/36900894/how-do-i-http-listenandserve-and-not-have-it-respond-to-every-path/36900921#36900921", "title": "How do I http.ListenAndServe &quot;/&quot; and not have it respond to every path?", "body": "<p>Add the following code to the beginning of your handler:</p>\n\n<pre><code>if r.URL.Path != \"/\" {\n     http.NotFound(w, r)\n     return\n}\n</code></pre>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1461798556, "accepted_answer_id": 36900921, "answer_count": 1, "score": 0, "last_activity_date": 1461798946, "creation_date": 1461791197, "question_id": 36900894, "link": "https://stackoverflow.com/questions/36900894/how-do-i-http-listenandserve-and-not-have-it-respond-to-every-path", "closed_reason": "Duplicate", "title": "How do I http.ListenAndServe &quot;/&quot; and not have it respond to every path?", "body": "<p>I have the following code in a small golang server:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {})\n</code></pre>\n\n<p>Basically allowing you to hit the root of the server without anything scary happening.</p>\n\n<p>The issue is that you can also hit <code>/foo/bar/blah...</code> and it still works. Which I don't want.</p>\n\n<p>How can I explicitly restrict it to what I say?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1461789744, "post_id": 36900280, "comment_id": 61365132, "body": "I am doubtful you&#39;ll be able to get more details out of the <code>err</code> in Go. However, if I were experiencing this problem I would use a tool like perfmon to figure out what was locking the file and then try to address it outside of my application code - or possibly with a code change - but if two separate applications are sharing file resources you have to coordinate them using something external to both programs like writing a lock file. My cursory glance over Go&#39;s <code>os</code> package tells me there is nothing to give you this info directly."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1461790381, "post_id": 36900280, "comment_id": 61365495, "body": "@evanmcdonnal Thanks for your Input. I know how to use sysinternals to find out which process causes the problem. My goal is to detect the cause and give the user a hint what could cause the problem"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1461791925, "post_id": 36900280, "comment_id": 61366293, "body": "If you have something you can run from the command line then you can us Go&#39;s exec library ( <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec</a> ) to invoke it from your app, read the output from std.out, parse out the list of other apps locking the file and then display it to the user."}], "answers": [{"comments": [{"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1461837383, "post_id": 36901646, "comment_id": 61384767, "body": "Thanks, these are the internals I was searching for. Unfortunately I don&#39;t understand the part where <code>testing.T</code> comes from. How can I call this ?"}, {"owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "reply_to_user": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1461838774, "post_id": 36901646, "comment_id": 61385729, "body": "The testing.T variable is part of the go test framework. It&#39;s very helpful for writing quick unit tests for testcases like this. You can just remove the method signature and replace t.Logf with fmt.Printf for similar functionality without the test framework."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1461843584, "post_id": 36901646, "comment_id": 61389096, "body": "Thanks, but I only manage to retrieve the text (which is OS locale specific) from <code>Err</code> but fail to get the underlying value. In my scenario (I already tested with your example) I retrieve <code>&amp;os.LinkError{Op:&quot;rename&quot;, Old:&quot;C:&#47;temp&#47;inUse&quot;, New:&quot;c:&#47;temp&#47;Renamed&quot;, Err:0x20}</code> but when I access <code>Err</code> I get <code>Der Prozess kann nicht auf die Datei zugreifen,...</code> which is the translation of  <code>0x20</code>. But I need the <i>raw</i> value. Do you have an idea how to retrieve <code>0x20</code> without running a regex on the whole string ?"}, {"owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "reply_to_user": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1461844901, "post_id": 36901646, "comment_id": 61390125, "body": "I&#39;ve updated the answer with details on how to inspect the error further. Hopefully this will get you on the right track."}, {"owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "edited": false, "score": 0, "creation_date": 1461845530, "post_id": 36901646, "comment_id": 61390590, "body": "You certainly did ;-) I was missing the part where the error is converted to syscall. Now everything is working fine. Thanks."}], "tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1461844845, "last_edit_date": 1461844845, "creation_date": 1461794235, "answer_id": 36901646, "question_id": 36900280, "link": "https://stackoverflow.com/questions/36900280/detect-cause-of-failing-rename/36901646#36901646", "title": "Detect cause of failing rename", "body": "<p>The error returned by <code>os.Rename</code> is of type <a href=\"https://golang.org/pkg/os/#LinkError\" rel=\"nofollow\"><code>*os.LinkError</code></a> which gives you access to the underlying error from the operating system. You should be able to use that to distinguish the particular error you are encountering.</p>\n\n<p>You'll need to convert the error to *os.LinkError first.</p>\n\n<p>For instance, trying to rename a folder (<code>/Users/t/pprof</code>) to another name that is write-protected (<code>/Users/t/pprof2</code>):</p>\n\n<pre><code>func TestRename(t *testing.T) {\n    err := os.Rename(\"/Users/t/pprof\", \"/Users/t/pprof2\")\n    if err != nil {\n        e := err.(*os.LinkError)\n        t.Logf(\"Op: \", e.Op)\n        t.Logf(\"Old: \", e.Old)\n        t.Logf(\"New: \", e.New)\n        t.Logf(\"Err: \", e.Err)\n    }\n}\n</code></pre>\n\n<p>Provides the following output:</p>\n\n<pre><code>Op: %!(EXTRA string=rename)\nOld: %!(EXTRA string=/Users/t/pprof)\nNew: %!(EXTRA string=/Users/t/pprof2)\nErr: %!(EXTRA syscall.Errno=operation not permitted)\n</code></pre>\n\n<p>The OS error code is accessible as the <code>Err</code> member, but will be different depending on the OS you are running.</p>\n\n<p>The <code>Err</code> member is of type <a href=\"https://golang.org/pkg/syscall/#Errno\" rel=\"nofollow\"><code>syscall.Errno</code></a>. To further inspect the actual error, you need to convert it to that type first:</p>\n\n<pre><code>oserr := e.Err.(syscall.Errno)\n</code></pre>\n\n<p>Now <code>oserr</code> can be compared with the values for <code>Errno</code> declared in the <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow\"><code>syscall</code></a> package. You'll find them if you search for <code>ENOENT</code> on that page.</p>\n\n<p>For instance, you can check for your particular error by doing:</p>\n\n<pre><code>switch oserr {\n    case syscall.ENOENT:\n        // Handle this error\n    default:\n        // Handle other errors\n    }\n}\n</code></pre>\n\n<p>In general, it's very convenient to use fmt.Printf when debugging these sort of issues. In the example above:</p>\n\n<pre><code>fmt.Println(err)\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>rename /Users/t/pprof /Users/t/pprof2: operation not permitted\n</code></pre>\n\n<p>where-as</p>\n\n<pre><code>fmt.Printf(\"%#v\\n\", err)\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>&amp;os.LinkError{Op:\"rename\", Old:\"/Users/t/pprof\", New:\"/Users/t/pprof2\", Err:0x1}\n</code></pre>\n\n<p>giving details on the actual error, and not just its string representation.</p>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 285125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4656356e662ac05469e5bbf37d44b032?s=128&d=identicon&r=PG", "display_name": "rocku", "link": "https://stackoverflow.com/users/285125/rocku"}, "is_accepted": false, "score": 1, "last_activity_date": 1599339094, "creation_date": 1599339094, "answer_id": 63758403, "question_id": 36900280, "link": "https://stackoverflow.com/questions/36900280/detect-cause-of-failing-rename/63758403#63758403", "title": "Detect cause of failing rename", "body": "<p>Starting with Go 1.13, if you just want to check if the underlying error is of a specific type you can do:</p>\n<pre class=\"lang-go prettyprint-override\"><code>err := os.Rename(&quot;C:/temp/inUse&quot;, &quot;c:/temp/Renamed&quot;)\n\nif err != nil &amp;&amp; errors.Is(err, syscall.EEXIST) {\n    fmt.Println(&quot;File already exists&quot;)\n    ...\n}\n</code></pre>\n<p>You can read more about error handling in Go 1.13 on <a href=\"https://blog.golang.org/go1.13-errors\" rel=\"nofollow noreferrer\">the official Golang blog</a>.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["MathJax", "Prettify"], "launch_date": 1436881020, "open_beta_date": 1296068400, "closed_beta_date": 1295463600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon@2.png", "twitter_account": "StackCodeReview", "favicon_url": "https://cdn.sstatic.net/Sites/codereview/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/codereview/Img/apple-touch-icon.png", "audience": "peer programmer code reviews", "site_url": "https://codereview.stackexchange.com", "api_site_parameter": "codereview", "logo_url": "https://cdn.sstatic.net/Sites/codereview/Img/logo.png", "name": "Code Review", "site_type": "main_site"}, "on_date": 1461789064, "question_id": 126885}, "owner": {"reputation": 8993, "user_id": 1354537, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/24aaaba3c6140eaef24f9ed711644033?s=128&d=identicon&r=PG", "display_name": "Marged", "link": "https://stackoverflow.com/users/1354537/marged"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 36901646, "answer_count": 2, "score": 4, "last_activity_date": 1599339094, "creation_date": 1461788627, "last_edit_date": 1461844349, "question_id": 36900280, "link": "https://stackoverflow.com/questions/36900280/detect-cause-of-failing-rename", "title": "Detect cause of failing rename", "body": "<p>I use some code similar to the lines below. The rename can fail if the directory is blocked because some application has a file open in it.</p>\n\n<pre><code>err := os.Rename(\"C:/temp/inUse\", \"c:/temp/Renamed\")\n\nif err != nil {\n    fmt.Println(err)\n    ...\n}\n</code></pre>\n\n<p>I am able to detect this fact when I check <code>err</code> for this content: </p>\n\n<blockquote>\n  <p>rename C:/temp/inUse c:/temp/Renamed: Der Prozess kann nicht auf die\n  Datei zugreifen, da sie von einem anderen Prozess verwendet wird.</p>\n</blockquote>\n\n<p>(which translates to \"The process is unable to access the file because it is used by a different process\")\nBut this message varies depending on the OS language.</p>\n\n<p>Is it possible to detect the problem by a unique \"error code\" ? I wouldn't mind if the solution is specific to Windows and doesn't work on other operating systems supported by Go.</p>\n\n<p>Ideally I could do something like <code>if err.Err == 32 { fmt.Println( \"Your directory is in use please ...</code> </p>\n"}, {"tags": ["rest", "go", "arguments", "command-line-arguments"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461788197, "post_id": 36899476, "comment_id": 61364246, "body": "Also: <code>http.ListenAndServe</code> is blocking, so you have to fire off each listener in its own goroutine (e.g. as part of a <code>sync.WaitGroup</code>) if you want to have three concurrent listeners on different ports."}, {"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461793112, "post_id": 36899476, "comment_id": 61366853, "body": "Could you tell me how to use sync.Waitgroup in this context?"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1461787457, "post_id": 36899515, "comment_id": 61363789, "body": "Thank you. The error i had was there was an extra &#39;:&#39; after the 1 in ipfile := os.Args[1]"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1461786373, "creation_date": 1461786373, "answer_id": 36899515, "question_id": 36899476, "link": "https://stackoverflow.com/questions/36899476/argument-processing-in-golang/36899515#36899515", "title": "Argument Processing in golang", "body": "<p>Like the error says, <code>ipfile</code> is a <code>[]string</code>. The <code>[1:]</code> slice operation is going to return a slice, even if there's only 1 element.    </p>\n\n<p>After checking that <code>os.Args</code> has the enough elements, use:</p>\n\n<pre><code>ipfile := os.Args[1]\ns := strings.Split(ipfile, \"-\")\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 36899515, "answer_count": 1, "score": 0, "last_activity_date": 1461786373, "creation_date": 1461786238, "question_id": 36899476, "link": "https://stackoverflow.com/questions/36899476/argument-processing-in-golang", "title": "Argument Processing in golang", "body": "<p>I will be giving the following as the command to run my go program. </p>\n\n<blockquote>\n  <p>go run app.go 3001-3005</p>\n</blockquote>\n\n<p>What this is supposed to do is, run my go Rest api on server ports 3001 to 3005.</p>\n\n<p>This part of my main function which handles this argument.</p>\n\n<pre><code>func main() { \nipfile := os.Args[1:]\ns := strings.Split(ipfile, \"-\")\nmux := routes.New() \nmux.Put(\"/:key1/:value1\", PutData)\nmux.Get(\"/profile/:key1\", GetSingleData) \nmux.Get(\"/profile\", GetData)\nhttp.Handle(\"/\", mix)\n</code></pre>\n\n<p>Here I will run a for loop and replace the first argument with s[i].</p>\n\n<pre><code>http.ListenAndServe(\":3000\", nil)\n}\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>cannot use ipfile (type []string) as type string in argument to strings.Split\n</code></pre>\n\n<p>What datatype does os.args return?\nI tried converting it to string and then splitting. Does not work.\nPlease let me know what is wrong?</p>\n"}, {"tags": ["go", "continuous-integration", "azure-pipelines-build-task"], "answers": [{"comments": [{"owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "edited": false, "score": 2, "creation_date": 1488194768, "post_id": 36898699, "comment_id": 72108606, "body": "How would you go about installing the Go compiler on the VSTS build agent? As far as I can tell the VSTS build agent come with <a href=\"https://www.visualstudio.com/en-us/docs/build/concepts/agents/hosted#software\" rel=\"nofollow noreferrer\">a lot of software</a> installed and there is no way to install a Go compiler."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1461783713, "creation_date": 1461783713, "answer_id": 36898699, "question_id": 36897557, "link": "https://stackoverflow.com/questions/36897557/can-i-add-a-golang-compiler-to-visual-studio-team-services/36898699#36898699", "title": "Can I add a Golang Compiler to Visual Studio Team Services", "body": "<p>Yes but I would look at it a bit differently. There is no need to add anything to VSTS, you just need golang/the go compiler installed on your build agent and then you can set up a job using MSBuild like any other MSFT supported language which invokes the Go compiler with your sources. Basically, write an msbuild script who's sole job is to invoke the go compiler with the target sources.</p>\n\n<p>Here are MSBuild docs on the Exec task which is what you'd use to kick off your build; <a href=\"https://msdn.microsoft.com/en-us/library/x8zx72cd.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/x8zx72cd.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 380233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30dac1754209d4d5c0a187b027b70be5?s=128&d=identicon&r=PG", "display_name": "camilohe", "link": "https://stackoverflow.com/users/380233/camilohe"}, "is_accepted": false, "score": 0, "last_activity_date": 1510617270, "creation_date": 1510617270, "answer_id": 47275468, "question_id": 36897557, "link": "https://stackoverflow.com/questions/36897557/can-i-add-a-golang-compiler-to-visual-studio-team-services/47275468#47275468", "title": "Can I add a Golang Compiler to Visual Studio Team Services", "body": "<p>As far as I know in order to add the Go compiler you need to setup a <a href=\"https://docs.microsoft.com/en-us/vsts/build-release/concepts/agents/agents#install\" rel=\"nofollow noreferrer\">private agent</a> or install it on the fly using a build task like the <a href=\"https://docs.microsoft.com/en-us/vsts/build-release/concepts/process/tasks#tool-installers\" rel=\"nofollow noreferrer\">tool installer</a> </p>\n"}], "owner": {"reputation": 193, "user_id": 1666054, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/345ddbd186fe874b2a0a15826ca3f8b2?s=128&d=identicon&r=PG", "display_name": "learningtofly", "link": "https://stackoverflow.com/users/1666054/learningtofly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1510617270, "creation_date": 1461780225, "question_id": 36897557, "link": "https://stackoverflow.com/questions/36897557/can-i-add-a-golang-compiler-to-visual-studio-team-services", "title": "Can I add a Golang Compiler to Visual Studio Team Services", "body": "<p>We are going to use Visual Studio Team Services for a project.  We are using VSTS Git as our repository.  A portion of this project is written in Golang.  We want to enable CI and build/test all code at check in.  I have been learning more about extensions, the build agents and build process within VSTS.  I see in the marketplace there are options for Android, iOS and other platforms (but not GoLang).  Can anyone start me on the path to creating a custom extension or build definition for Golang? How can I create a custom extension to enable automated builds at check-in of GoLang code?  Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 1, "creation_date": 1461776368, "post_id": 36895714, "comment_id": 61356652, "body": "what is the size of the file you are testing this with? you don&#39;t seem to check how many bytes were read into the buffer, or if any error is returned when you do <code>file.Read(buf)</code>"}, {"owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "reply_to_user": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "edited": false, "score": 0, "creation_date": 1461777589, "post_id": 36895714, "comment_id": 61357474, "body": "I am testing with a 200 mb file. I have removed all the error checking for shortening the question. There are no errors on that step."}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "edited": false, "score": 0, "creation_date": 1461781345, "post_id": 36895714, "comment_id": 61359918, "body": "I would second Dean&#39;s comment. Just because there are no errors doesn&#39;t mean that your buffer is filled with data from the reader. You can never assume that one read on a stream will fill a buffer this large. Secondly, while ioutil functions are nice, you could just as easily just write using the file&#39;s io.Writer interface and use Seek() as necessary on the file to adjust the write position."}, {"owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "edited": false, "score": 0, "creation_date": 1461781602, "post_id": 36895714, "comment_id": 61360075, "body": "It&#39;s just a 1mb buffer. I can see the file being written and I can even run mediainfo on the file. But after I try to append the rest of the file. It gets corrupted."}, {"owner": {"reputation": 1762, "user_id": 5120331, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YhTAB.png?s=128&g=1", "display_name": "Corvus Crypto", "link": "https://stackoverflow.com/users/5120331/corvus-crypto"}, "edited": false, "score": 0, "creation_date": 1461783184, "post_id": 36895714, "comment_id": 61361114, "body": "We are telling you one reason it can be showing corrupted. It is extremely likely you have a bunch of 0&#39;s between data, which will corrupt a file.  For you to see what we mean, run these two programs one after the other (golang&#39;s share server is down): <a href=\"http://pastebin.com/LsvmyWJf\" rel=\"nofollow noreferrer\">pastebin.com/LsvmyWJf</a> <a href=\"http://pastebin.com/P9c22x78\" rel=\"nofollow noreferrer\">pastebin.com/P9c22x78</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "edited": false, "score": 0, "creation_date": 1461777721, "post_id": 36896250, "comment_id": 61357578, "body": "As suggested I did this : <code>ioutil.WriteFile(tempFile, buf, 0644)</code> then <code>dst, err := os.OpenFile(tempFile, os.O_RDWR|os.O_APPEND, 0666) \tdefer dst.Close() \t_, err = io.Copy(dst, file)</code> Still the file size increases by 1 mb and corrupted."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 1, "last_activity_date": 1461776363, "creation_date": 1461776363, "answer_id": 36896250, "question_id": 36895714, "link": "https://stackoverflow.com/questions/36895714/how-to-append-files-io-reader/36896250#36896250", "title": "How to append files (io.Reader)?", "body": "<p>You've basically opened the file twice by doing os.Create and ioutil.WriteFile</p>\n\n<p>the issue being is that os.Create's return value (dst) is like a pointer to the beginning of that file.  WriteFile doesn't move where dst points to.</p>\n\n<p>You are basically doing WriteFile, then io.Copy on top of the first set of bytes WriteFile wrote.</p>\n\n<p>Try doing WriteFile first (with Create flag), and then os.OpenFile (instead of os.Create) that same file with Append flag to append the remaining bytes to the end.</p>\n\n<p>Also, it's extremely risky to allow a client to give you the filename as it could be ../../.bashrc (for example), to which you'd overwrite your shell init with whatever the user decided to upload.</p>\n\n<p>It would be much safer if you computed a filename yourself, and if you need to remember the user's selected filename, store that in your database or even a metadata.json type file that you load later.</p>\n"}], "owner": {"reputation": 1364, "user_id": 711400, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6d759a9e10591c530ff2f1b400637eff?s=128&d=identicon&r=PG", "display_name": "Monodeep", "link": "https://stackoverflow.com/users/711400/monodeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1549, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461776363, "creation_date": 1461774663, "question_id": 36895714, "link": "https://stackoverflow.com/questions/36895714/how-to-append-files-io-reader", "title": "How to append files (io.Reader)?", "body": "<pre><code>func SimpleUploader(r *http.Request, w http.ResponseWriter) {\n    // temp folder path\n    chunkDirPath := \"./creatives/.uploads/\" + userUUID\n    // create folder\n    err = os.MkdirAll(chunkDirPath, 02750)\n\n    // Get file handle from multipart request\n    var file io.Reader\n    mr, err := r.MultipartReader()\n\n    var fileName string\n    // Read multipart body until the \"file\" part\n    for {\n        part, err := mr.NextPart()\n        if err == io.EOF {\n            break\n        }\n        if part.FormName() == \"file\" {\n            file = part\n            fileName = part.FileName()\n            fmt.Println(fileName)\n            break\n        }\n    }\n\n    // Create files\n    tempFile := chunkDirPath + \"/\" + fileName\n    dst, err := os.Create(tempFile)\n\n    defer dst.Close()\n\n    buf := make([]byte, 1024*1024)\n    file.Read(buf)\n    // write/save buffer to disk\n    ioutil.WriteFile(tempFile, buf, os.ModeAppend)\n    if http.DetectContentType(buf) != \"video/mp4\" {\n        response, _ := json.Marshal(&amp;Response{\"File upload cancelled\"})\n        settings.WriteResponse(w, http.StatusInternalServerError, response)\n        return\n    }\n\n    // joinedFile := io.MultiReader(bytes.NewReader(buf), file)\n    _, err = io.Copy(dst, file)\n    if err != nil {\n        settings.LogError(err, methodName, \"Error copying file\")\n    }\n\n    response, _ := json.Marshal(&amp;Response{\"File uploaded successfully\"})\n    settings.WriteResponse(w, http.StatusInternalServerError, response)\n}\n</code></pre>\n\n<p>I am uploading a Video file. \nBefore uploading the entire file I want to do some checks so I save the first 1mb to a file :</p>\n\n<pre><code>buf := make([]byte, 1024*1024)\nfile.Read(buf)\n// write/save buffer to disk\nioutil.WriteFile(tempFile, buf, os.ModeAppend)\n</code></pre>\n\n<p>Then if the checks pass I want to upload the rest of the file <code>dst is the same file used to save the 1st 1 mb</code> so basically i am trying to append to the file :</p>\n\n<pre><code>_, err = io.Copy(dst, file)\n</code></pre>\n\n<p>The uploaded file size is correct but the file is corrupted(can't play the video).</p>\n\n<p><strong>What else have I tried? :</strong> Joining both the readers and saving to a new file. But with this approach the file size increases by 1 mb and is corrupted.</p>\n\n<pre><code>joinedFile := io.MultiReader(bytes.NewReader(buf), file)\n_, err = io.Copy(newDst, joinedFile)\n</code></pre>\n\n<p>Kindly help.</p>\n"}, {"tags": ["go", "ubuntu-14.04", "xls"], "comments": [{"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1461778801, "post_id": 36893678, "comment_id": 61358304, "body": "could you give some more detail about the values and what you expect them to be?"}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1461820416, "post_id": 36893678, "comment_id": 61375002, "body": "Hi matt.s please check my updated question"}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461932577, "post_id": 36915693, "comment_id": 61435557, "body": "Can u suggest me a better way to handle xls files?  and by the way row1.Cols[1].(*NumberCol) says : undefined: NumberCol"}, {"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461937930, "post_id": 36915693, "comment_id": 61439289, "body": "@Hardy, sorry, you need <code>row1.Cols[1].(*xls.NumberCol)</code> ; edited above"}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1461937945, "last_edit_date": 1461937945, "creation_date": 1461848976, "answer_id": 36915693, "question_id": 36893678, "link": "https://stackoverflow.com/questions/36893678/reading-number-type-cell-from-xls-file-in-golang/36915693#36915693", "title": "Reading number type cell from xls file in golang", "body": "<p>I believe excel handles cell values differently if they are numeric.</p>\n\n<p>The documentation is sparse, but maybe try converting the value to a <code>*NumberCol</code> like so:</p>\n\n<p><code>row1.Cols[1].(*xls.NumberCol)</code></p>\n"}], "owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1029, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1600684103, "creation_date": 1461769401, "last_edit_date": 1461819268, "question_id": 36893678, "link": "https://stackoverflow.com/questions/36893678/reading-number-type-cell-from-xls-file-in-golang", "title": "Reading number type cell from xls file in golang", "body": "<p>Stuck in getting number type(format) cell value from a xls file in Go program. The file has name(text),Due_amount(number) columns in it. \nI am using the github.com/extrame/xls package.</p>\n\n<p>My code is  :</p>\n\n<pre><code>if sheet1 := xlFile.GetSheet(0); sheet1 != nil {\n    col1 := sheet1.Rows[0].Cols[0]\n    col2 := sheet1.Rows[0].Cols[0]\n    for i := 0; i &lt;= (int(sheet1.MaxRow)); i++ {\n        row1 := sheet1.Rows[uint16(i)]\n        col1 = row1.Cols[0]\n        col2 = row1.Cols[1]\n        fmt.Print(\"\\n\", col1.String(xlFile), \",\", col2.String(xlFile))\n        }\n    }\n}\n</code></pre>\n\n<p>The col2.String(xlFile) gives wrong values because column 2 has number type entries.</p>\n\n<p>My xls file contents are :</p>\n\n<pre><code>COL1  |  COL2\nADAM  |  69057\nJHON  |  4926\nBILL  |  22792\n</code></pre>\n\n<p>Running my program on this gives values like :</p>\n\n<pre><code>[ADAM],[2089.01]\n[JHON],[1913.06]\n[BILL],[1962.05]\n</code></pre>\n\n<p>how can i get a number value ?\n  Can some one tell me how to overcome this?</p>\n"}, {"tags": ["go", "syntax"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1461770013, "post_id": 36893674, "comment_id": 61351997, "body": "The spec for composite literals: <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Composite_literals</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1461818021, "post_id": 36893674, "comment_id": 61374239, "body": "Take the Tour of Go at least once, doing all exercises."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4137585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bccb3cda5f0bf097c3fbf1e14625f10f?s=128&d=identicon&r=PG", "display_name": "SilverEnsign99", "link": "https://stackoverflow.com/users/4137585/silverensign99"}, "edited": false, "score": 0, "creation_date": 1461773522, "post_id": 36893710, "comment_id": 61354735, "body": "TIL. Thanks for pointing me to that. Just want to make sure I understood the documentation right but basically this is just a way to simplify setting initial values for variables within the structure instance? You can create and return an instance <i>and</i> set variables all at the same time?"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 25, "user_id": 4137585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bccb3cda5f0bf097c3fbf1e14625f10f?s=128&d=identicon&r=PG", "display_name": "SilverEnsign99", "link": "https://stackoverflow.com/users/4137585/silverensign99"}, "edited": false, "score": 0, "creation_date": 1461773539, "post_id": 36893710, "comment_id": 61354749, "body": "@SilverEnsign99 Exactly"}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 25, "user_id": 4137585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bccb3cda5f0bf097c3fbf1e14625f10f?s=128&d=identicon&r=PG", "display_name": "SilverEnsign99", "link": "https://stackoverflow.com/users/4137585/silverensign99"}, "edited": false, "score": 0, "creation_date": 1461773635, "post_id": 36893710, "comment_id": 61354821, "body": "@SilverEnsign99, yes that&#39;s correct. (properties or members rather then variables, but yes)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461774779, "post_id": 36893710, "comment_id": 61355653, "body": "A nitpick: I&#39;d suggest to rephrase: &quot;...then taking an address of it&quot;. A pointer is not taken by this operation but produced as its result ;-)"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461774915, "post_id": 36893710, "comment_id": 61355741, "body": "@kostix Please feel free to improve the phrasing, my English is terrible"}], "tags": [], "owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": true, "score": 6, "last_activity_date": 1461769467, "last_edit_date": 1592644375, "creation_date": 1461769467, "answer_id": 36893710, "question_id": 36893674, "link": "https://stackoverflow.com/questions/36893674/go-language-syntax-confusion/36893710#36893710", "title": "Go language Syntax Confusion", "body": "<p>This is called a <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"noreferrer\">composite literal</a>.</p>\n<p>You're just creating an instance of the <code>http.Client</code> type and setting the\n<code>CheckRedirect</code> property, then taking a pointer of it.</p>\n"}], "owner": {"reputation": 25, "user_id": 4137585, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bccb3cda5f0bf097c3fbf1e14625f10f?s=128&d=identicon&r=PG", "display_name": "SilverEnsign99", "link": "https://stackoverflow.com/users/4137585/silverensign99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 36893710, "answer_count": 1, "score": -1, "last_activity_date": 1461775454, "creation_date": 1461769380, "last_edit_date": 1461775454, "question_id": 36893674, "link": "https://stackoverflow.com/questions/36893674/go-language-syntax-confusion", "title": "Go language Syntax Confusion", "body": "<p>So I'm brand new to Go, I am moving over from python b/c of concurrecny. \nAnyways I was looking at the <a href=\"https://golang.org/pkg/net/http/#pkg-overview\" rel=\"nofollow\">net/http package documentation</a> and stumbled upon this:</p>\n\n<pre><code>client := &amp;http.Client{\n    CheckRedirect: redirectPolicyFunc\n}\n</code></pre>\n\n<p>So I see we are creating a client variable by referencing the original Client structure (I think that is how you would word that) but I am totally lost at the </p>\n\n<pre><code>CheckRedirect: redirectPolicyFunc\n</code></pre>\n\n<p>What the heck does the \":\" mean and what are we doing with it? Also what are the things before and after it? I read the struct documentation and did the introduction to go tutorial but I didn't see anything, I may not of been looking hard enough. No doubt its simple I just have no idea where to start looking for answers.</p>\n\n<hr>\n\n<p>Thanks for the answers everyone! This makes much more sense now!</p>\n"}, {"tags": ["linux", "go", "ubuntu-14.04", "xls"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461767541, "post_id": 36892661, "comment_id": 61350007, "body": "will this work if there are empty cell in the middle too? say cell 2 cell 4  can be empty too. so i want to know if that particular cell is empty"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1461770593, "last_edit_date": 1461770593, "creation_date": 1461766945, "answer_id": 36892661, "question_id": 36892269, "link": "https://stackoverflow.com/questions/36892269/reading-values-from-xls-file-in-golang-on-linux-system/36892661#36892661", "title": "Reading values from xls file in golang on linux system", "body": "<p>I'm assuming that if you have empty trailing columns, the Cols slice is only as big as the number of filled out columns.</p>\n\n<p>In this case, just do:</p>\n\n<pre><code>if len(row1.Cols) &lt; 12 {\n // Whatever you want to do with &lt; 12 columns \n} else {\n // Use Cols[11] (12th column) here\n}\n</code></pre>\n\n<p>If you want just first and last columns, you can do:\n<code>rows1.Cols[0]</code> and <code>rows1.Cols[len(row1.Cols)-1]</code> which will work with arbitrarily wide rows.  </p>\n\n<p>You if there might be blank rows, first check for <code>len(rows1.Cols) == 0</code> to make sure you don't attempt to access non-existant data.</p>\n"}, {"comments": [{"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461767426, "post_id": 36892678, "comment_id": 61349921, "body": "will this work if there are empty cell in the middle too?"}, {"owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461767640, "post_id": 36892678, "comment_id": 61350087, "body": "Yes it will. It can access to <code>Cols[11]</code> if only <code>Cols</code> have 12 elements or more."}], "tags": [], "owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "is_accepted": false, "score": -1, "last_activity_date": 1461766997, "creation_date": 1461766997, "answer_id": 36892678, "question_id": 36892269, "link": "https://stackoverflow.com/questions/36892269/reading-values-from-xls-file-in-golang-on-linux-system/36892678#36892678", "title": "Reading values from xls file in golang on linux system", "body": "<p>Did you try to check Cols length before you got Cols[11]?</p>\n\n<pre><code>if len(row1.Cols) &gt; 10 {\n  col2 = row1.Cols[11]\n}else{\n  col2 = Col{}\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "reply_to_user": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "edited": false, "score": 0, "creation_date": 1461774628, "post_id": 36892736, "comment_id": 61355557, "body": "Great that it helped."}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1575460945, "post_id": 36892736, "comment_id": 104572645, "body": "clean answer, helped with mine issue 2"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 2, "last_activity_date": 1575608619, "last_edit_date": 1575608619, "creation_date": 1461767109, "answer_id": 36892736, "question_id": 36892269, "link": "https://stackoverflow.com/questions/36892269/reading-values-from-xls-file-in-golang-on-linux-system/36892736#36892736", "title": "Reading values from xls file in golang on linux system", "body": "<p>Checking the repo you are mentioning there is a <code>row.go</code> file where is defined the <code>Row</code> struct as the following:</p>\n\n<pre><code>type Row struct {\n    info *RowInfo\n    Cols map[uint16]contentHandler\n}\n</code></pre>\n\n<p>This contains the <code>Cols</code> map which keys are <code>uint16</code> values. Because in go you can verify if a map key exists in the following way:</p>\n\n<pre><code>if col2, ok := row1.Cols[11]; ok { }\n</code></pre>\n\n<p>this means you can test if the cells are not empty by checking if they contains a key.</p>\n\n<pre><code>if col2, ok := row1.Cols[11]; ok { \n    fmt.Print(\"\\n\", col2.String(xlFile))\n}\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2279, "favorite_count": 1, "accepted_answer_id": 36892736, "answer_count": 3, "score": 1, "last_activity_date": 1575608619, "creation_date": 1461766053, "last_edit_date": 1461766186, "question_id": 36892269, "link": "https://stackoverflow.com/questions/36892269/reading-values-from-xls-file-in-golang-on-linux-system", "title": "Reading values from xls file in golang on linux system", "body": "<p>I am writing a program to read xls file in Go. I am using the <code>github.com/extrame/xls</code> package.\nI want to read each cell if it is not empty. (Note some rows will have values in all 11 columns but some will not.)</p>\n\n<p>My code is:</p>\n\n<pre><code>if xlFile, err := Open(\"Table.xls\", \"utf-8\"); err == nil {\n    if sheet1 := xlFile.GetSheet(0); sheet1 != nil {\n        fmt.Print(\"Total Lines \", sheet1.MaxRow, sheet1.Name)\n        col1 := sheet1.Rows[0].Cols[0]\n        col2 := sheet1.Rows[0].Cols[0]\n        for i := 0; i &lt;= (int(sheet1.MaxRow)); i++ {\n            row1 := sheet1.Rows[uint16(i)]\n            col1 = row1.Cols[0]\n            col2 = row1.Cols[11]\n            fmt.Print(\"\\n\", col1.String(xlFile), \",\", col2.String(xlFile))\n        }\n    }\n}\n</code></pre>\n\n<p>It gives the following error: </p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<p>Because the cell 11 is empty for some rows.</p>\n\n<p>Please advise a better method or a solution.</p>\n"}, {"tags": ["pointers", "reflection", "go", "go-interface"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461762929, "post_id": 36890896, "comment_id": 61346185, "body": "<code>*str</code> will dereference the pointer and it will be of nonpointer <code>string</code> type. Did you mean to put <code>str</code> into the slice literal?"}, {"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461763336, "post_id": 36890896, "comment_id": 61346519, "body": "yep, didn&#39;t noticed, edited."}], "answers": [{"comments": [{"owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "edited": false, "score": 1, "creation_date": 1461769453, "post_id": 36891042, "comment_id": 61351586, "body": "Exactly what I was looking for, Thanks!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1461763140, "creation_date": 1461763140, "answer_id": 36891042, "question_id": 36890896, "link": "https://stackoverflow.com/questions/36890896/in-go-how-do-i-check-a-value-is-of-any-pointer-type/36891042#36891042", "title": "In Go, how do I check a value is of (any) pointer type?", "body": "<p>You can use reflection (<a href=\"https://golang.org/pkg/reflect/\"><code>reflect</code></a> package) to test if a value is of pointer type.</p>\n\n<pre><code>func firstPointerIdx(s []interface{}) int {\n    for i, v := range s {\n        if reflect.ValueOf(v).Kind() == reflect.Ptr {\n            return i\n        }\n    }\n    return -1\n}\n</code></pre>\n\n<p>Note that the above code tests the type of the value that is \"wrapped\" in an <code>interface{}</code> (this is the element type of the <code>s</code> slice parameter). This means if you pass a slice like this:</p>\n\n<pre><code>s := []interface{}{\"2\", nil, (*string)(nil)}\n</code></pre>\n\n<p>It will return <code>2</code> because even though 3rd element is a <code>nil</code> pointer, it is still a pointer (wrapped in a non-<code>nil</code> interface value).</p>\n"}], "owner": {"reputation": 534, "user_id": 4513263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c02283d203020618ad7d90e061632d4?s=128&d=identicon&r=PG&f=1", "display_name": "Elad", "link": "https://stackoverflow.com/users/4513263/elad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9243, "favorite_count": 3, "accepted_answer_id": 36891042, "answer_count": 1, "score": 9, "last_activity_date": 1461775171, "creation_date": 1461762804, "last_edit_date": 1461775171, "question_id": 36890896, "link": "https://stackoverflow.com/questions/36890896/in-go-how-do-i-check-a-value-is-of-any-pointer-type", "title": "In Go, how do I check a value is of (any) pointer type?", "body": "<p>I have a slice of <code>interface{}</code> and I need to check whether this slice contains pointer field values.</p>\n\n<p>Clarification example:</p>\n\n<pre><code>var str *string\ns := \"foo\"\nstr = &amp;s\nvar parms = []interface{}{\"a\",1233,\"b\",str}\nindex := getPointerIndex(parms)\nfmt.Println(index) // should print 3\n</code></pre>\n"}, {"tags": ["go", "reference-type"], "answers": [{"comments": [{"owner": {"reputation": 1458, "user_id": 4258041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Uqg94.jpg?s=128&g=1", "display_name": "Yan Yang", "link": "https://stackoverflow.com/users/4258041/yan-yang"}, "edited": false, "score": 0, "creation_date": 1461763323, "post_id": 36891032, "comment_id": 61346514, "body": "I tried something else to shrink the length, the process is updated in the post. Is that because after shrinking, <code>anotherSlice</code> has also shrinked capacity to 5?"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1461764807, "last_edit_date": 1461764807, "creation_date": 1461763121, "answer_id": 36891032, "question_id": 36890875, "link": "https://stackoverflow.com/questions/36890875/assigning-a-variable-of-reference-type-slice-to-another-variable-why-dont-th/36891032#36891032", "title": "Assigning a variable of reference type &quot;slice&quot; to another variable, why don&#39;t they change simultaneously?", "body": "<p>Whenever appended slice <code>anotherSlice</code> has no capacity for the new element, <code>append</code> function creates new slice and returns it. Since then the slices <code>anotherSlice</code> and <code>theSlice</code> are different - they are backed by separate arrays.</p>\n\n<p>Reslicing slice with a shorter length <code>anotherSlice[:3]</code> has no impact on the original capacity of the slice.</p>\n\n<p>The following line:</p>\n\n<pre><code>anotherSlice = append(anotherSlice[:3], anotherSlice[4:]...)\n</code></pre>\n\n<p>cuts out fourth (index 3) element. Because <code>anotherSlice[:3]</code> has capacity to hold all elements of <code>anotherSlice[4:]</code> no new allocation happens and therefore both slices are modified.</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n)   \n\nfunc main() {\n        x := []int{1, 2, 3, 4, 5, 6}\n        fmt.Println(cap(x[:3]) &gt;= len(x[:3])+len(x[4:]))\n        y := append(x[:3], x[4:]...)\n        fmt.Println(x, y)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jiX4tyEcXz\" rel=\"nofollow\"><kbd>Playground</kbd></a></p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow\">Go Slices</a></li>\n<li><a href=\"https://golang.org/pkg/builtin/#cap\" rel=\"nofollow\">Capacity function</a></li>\n<li><a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow\">Slice tricks</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1461778370, "creation_date": 1461778370, "answer_id": 36896940, "question_id": 36890875, "link": "https://stackoverflow.com/questions/36890875/assigning-a-variable-of-reference-type-slice-to-another-variable-why-dont-th/36896940#36896940", "title": "Assigning a variable of reference type &quot;slice&quot; to another variable, why don&#39;t they change simultaneously?", "body": "<p>The answer to why the length of one slice doesn't follow the change to another slice's length change is not related to the underlying storage potentially being copied and/or modified.</p>\n\n<p>In Go, it is important to remember what a slice is.  It is a struct with a length field, a capacity field, and a pointer to an array.  Some operations\nchange the length field.  Some change the capacity field.  Some change the data stored in the underlying array.  </p>\n\n<p>If one doesn't grasp how a slice is implemented in the language, there will be all sorts of confusion and bugs and wasted opportunities.  Once one becomes comfortable with how a slice is implemented, they are very easy to use and the fact that the compiler understands the structure of the slice, some very elegant and easily read code can be written.</p>\n"}], "owner": {"reputation": 1458, "user_id": 4258041, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Uqg94.jpg?s=128&g=1", "display_name": "Yan Yang", "link": "https://stackoverflow.com/users/4258041/yan-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 36891032, "answer_count": 2, "score": 1, "last_activity_date": 1461778370, "creation_date": 1461762742, "last_edit_date": 1461763156, "question_id": 36890875, "link": "https://stackoverflow.com/questions/36890875/assigning-a-variable-of-reference-type-slice-to-another-variable-why-dont-th", "title": "Assigning a variable of reference type &quot;slice&quot; to another variable, why don&#39;t they change simultaneously?", "body": "<pre><code>anotherSlice := theSlice\nanotherSlice = append(anotherSlice, newEle)\nfmt.Println(len(anotherSlice) == len(theSlice))\n</code></pre>\n\n<p>This snippet will output <code>false</code>. Why?</p>\n\n<p>And here are some other experiments:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    theSlice := []int{3,3,2,5,12,43}\n    anotherSlice := theSlice\n    fmt.Println(anotherSlice[3], theSlice[3])\n    anotherSlice[3] = anotherSlice[3]+2\n    fmt.Println(anotherSlice[3], theSlice[3])\n    anotherSlice = append(anotherSlice[:3], anotherSlice[4:]...)\n    fmt.Println(len(anotherSlice),len(theSlice))\n}\n</code></pre>\n\n<p>The output is like below:</p>\n\n<pre><code>5 5\n7 7\n5 6\n\nProgram exited.\n</code></pre>\n"}, {"tags": ["go", "naming-conventions", "code-generation"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1461762720, "last_edit_date": 1495541770, "creation_date": 1461762038, "answer_id": 36890617, "question_id": 36890166, "link": "https://stackoverflow.com/questions/36890166/name-for-a-generated-go-file/36890617#36890617", "title": "Name for a generated go file", "body": "<p>Having a suffix like <code>_GENERATED</code> added to the file name does not hold any information until the file is generated, as the compiler will just give you \"unrelated\" errors like <code>\"undefined: xxx\"</code> (the compiler won't guess that if the identifier would exists, it would be in <code>version_GENERATED.go</code>).</p>\n\n<p>For example the <a href=\"https://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"nofollow noreferrer\"><code>stringer</code></a> generator generates files with name <code>type_string.go</code> where type is replaced with the name of the type it is generated for.</p>\n\n<p>So I think simply following the <a href=\"https://stackoverflow.com/questions/25161774/what-are-conventions-for-filenames-in-go\">general guidelines</a> for file names is enough, except maybe use <code>_gen</code> or <code>_generated</code> suffix. Or if your tool is public and used by others too, then use the name of the tool as the suffix (like <code>stringer</code> does).</p>\n\n<p>If you do want the user to get a talkative error message in case your generator is yet to be run, your generator may generate an exported constant whose name is talkative if included in an error message, like:</p>\n\n<pre><code>const MustRunStringerGenerator = 0\n</code></pre>\n\n<p>And in your program refer to it like:</p>\n\n<pre><code>var _ = MustRunStringerGenerator // Test if stringer has been run\n</code></pre>\n\n<p>If <code>stringer</code> has not yet been run, you'll see an error message:</p>\n\n<pre><code>undefined: MustRunStringerGenerator\n</code></pre>\n"}], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 36890617, "answer_count": 1, "score": 2, "last_activity_date": 1461762720, "creation_date": 1461760940, "question_id": 36890166, "link": "https://stackoverflow.com/questions/36890166/name-for-a-generated-go-file", "title": "Name for a generated go file", "body": "<p>I'm generating a Go file (to include constants such as build version etc) so that the constants can be used in other packages.  I have a created a small tool that will create the file with <code>go generate</code> but am trying to think of an appropriate name so that</p>\n\n<ul>\n<li><p>It is obvious that it is generated, so if it is missing (on build) the user then knows to run <code>go generate</code></p></li>\n<li><p>And I can then add the file to the .gitignore </p></li>\n</ul>\n\n<p>My first guess is something like <code>version_GENERATED.go</code></p>\n\n<p>Any conventions I should be aware of or better suggestions?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 1121, "user_id": 316240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6c08551eff0f8316d41c104a25be60a?s=128&d=identicon&r=PG", "display_name": "Parth Desai", "link": "https://stackoverflow.com/users/316240/parth-desai"}, "is_accepted": false, "score": 2, "last_activity_date": 1461756675, "creation_date": 1461756675, "answer_id": 36888523, "question_id": 36888178, "link": "https://stackoverflow.com/questions/36888178/slice-copy-is-not-working-as-expected/36888523#36888523", "title": "Slice copy is not working as expected", "body": "<p>You are reinitializing mySlice2 variable at this point:<br>\n<code>mySlice2 = mySlice1[0:2]</code>.  </p>\n\n<p>So, the previous reference to the slice with 3 elements is gone.</p>\n\n<p>To remedy this, simply remove this sentence and re-run the program.</p>\n"}, {"tags": [], "owner": {"reputation": 2666, "user_id": 1421957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b8e742c4a05e312502c828847c455ad?s=128&d=identicon&r=PG", "display_name": "Tico", "link": "https://stackoverflow.com/users/1421957/tico"}, "is_accepted": false, "score": 4, "last_activity_date": 1461761487, "last_edit_date": 1461761487, "creation_date": 1461756727, "answer_id": 36888542, "question_id": 36888178, "link": "https://stackoverflow.com/questions/36888178/slice-copy-is-not-working-as-expected/36888542#36888542", "title": "Slice copy is not working as expected", "body": "<p>If you want <code>mySlice2</code> to have 3 elements, you should use:</p>\n\n<pre><code>myslice2 = mySlice1[0,3]\n</code></pre>\n\n<p>Or just:</p>\n\n<pre><code>copy(mySlice2,mySlice1)\n</code></pre>\n\n<p>You did create a slice with length 3, but the you then reassign it to a length of 2. You can see it using <code>len(mySlice2)</code> before and after the assignments </p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1461756830, "creation_date": 1461756830, "answer_id": 36888577, "question_id": 36888178, "link": "https://stackoverflow.com/questions/36888178/slice-copy-is-not-working-as-expected/36888577#36888577", "title": "Slice copy is not working as expected", "body": "<p>Your code is working as expected. </p>\n\n<p>You are copying the first three values from the <code>mySlice1</code> into <code>mySlice2</code>, hence you are actually copy the memory addresses pointing to the first three items from <code>mySlice1</code> slice.</p>\n\n<p>When you are declaring the <code>mySlice2</code> actually you are initializing the slice index values with zero's (this is how Go slices are working). Then you copy the first three values from slice1 into slice2. This does not means that <code>mySlice2</code> values are changed. If you change <code>mySlice2</code> 0<sup>th</sup> index to let's say 1 the <code>mySlice1</code> first value is changed accordingly, because as i mentioned the indexes are referenced by their memory addresses.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    mySlice1 := []int{0, 3, 5, 7, 9, 11}\n    mySlice2 := make([]int,3)\n    mySlice2 = mySlice1[0:2]\n    mySlice2[0] = 1\n\n    copy(mySlice2,mySlice1)\n    fmt.Printf(\"%T\\t%T\\n\", mySlice1,mySlice2)\n    fmt.Println(mySlice1,mySlice2)\n\n    // Output\n    // [1 3 5 7 9 11] [1 3]\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 3, "score": -2, "last_activity_date": 1461761487, "creation_date": 1461755741, "last_edit_date": 1461757018, "question_id": 36888178, "link": "https://stackoverflow.com/questions/36888178/slice-copy-is-not-working-as-expected", "title": "Slice copy is not working as expected", "body": "<p>In the following Go program, I am creating <code>mySlice1</code> with 6 elements in it.\n<code>mySlice2</code> is initialized with 3 elements.</p>\n\n<p>From <code>mySlice1</code> I am taking 1st two elements into <code>mySlice2</code>. Also using <code>copy</code> function of slice, 3 elements of <code>mySlice1</code> are overwritten to <code>mySlice2</code>.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    mySlice1 := []int{1, 3, 5, 7, 9, 11}\n    mySlice2 := make([]int,3)\n    mySlice2 = mySlice1[0:2]\n    copy(mySlice2,mySlice1)\n    fmt.Printf(\"%T\\t%T\\n\", mySlice1,mySlice2)\n    fmt.Println(mySlice1,mySlice2)\n}\n</code></pre>\n\n<p>But while printing <code>mySlice2</code> I am getting two elements only.</p>\n\n<pre><code>$ go run main.go\n[]int   []int\n[1 3 5 7 9 11] [1 3]\n</code></pre>\n\n<p>Why is <code>mySlice2</code> not getting overwritten while using <code>copy</code> function?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "edited": false, "score": 0, "creation_date": 1461811072, "post_id": 36887584, "comment_id": 61372266, "body": "it&#39;s a mistake, code has updated, i know that using time.Ticker is a better way, but i just want to know why my code run like that."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1461754918, "last_edit_date": 1461754918, "creation_date": 1461753947, "answer_id": 36887584, "question_id": 36886548, "link": "https://stackoverflow.com/questions/36886548/do-repetitive-tasks-at-intervals-in-golang-using-time-afterfunc-just-a-sample/36887584#36887584", "title": "do repetitive tasks at intervals in golang using time.AfterFunc, just a sample", "body": "<p><a href=\"https://golang.org/pkg/time/#AfterFunc\" rel=\"nofollow\"><code>time.AfterFunc()</code></a> returns a <a href=\"https://golang.org/pkg/time/#Timer\" rel=\"nofollow\"><code>*time.Timer</code></a>, quoting form its doc:</p>\n\n<blockquote>\n  <p>The Timer type represents a <strong>single event</strong>. When the Timer expires, the current time will be sent on C, unless the Timer was created by AfterFunc.</p>\n</blockquote>\n\n<p>The <code>time.Timer</code> returned by <code>time.AfterFunc()</code> does not repeat, so what you see is perfectly normal: in your <code>PipeService.IntervalCall()</code> you execute the callback immediately, and it gets executed after the timeout.</p>\n\n<p>Also note that you pass <code>2</code> as interval for the <code>PipeService.IntervalCall()</code> method. This <code>interval</code> parameter is of type <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow\"><code>time.Duraion</code></a>. So when you pass <code>2</code>, that won't be 2 seconds (but actually 2 nanoseconds). You should pass a value constructed from constants from the <code>time</code> package like:</p>\n\n<pre><code>InsPipeService.IntervalCall(2 * time.Second, func(){\n    fmt.Println(\"interval call\")\n})\n</code></pre>\n\n<p>If you want repetition, use <a href=\"https://golang.org/pkg/time/#Ticker\" rel=\"nofollow\"><code>time.Ticker</code></a>. For example the following code prints a message in every 2 seconds:</p>\n\n<pre><code>t := time.NewTicker(2 * time.Second)\nfor now := range t.C {\n    fmt.Println(\"tick\", now)\n}\n</code></pre>\n\n<p>Or simply if you don't need the <code>Ticker</code> and you don't want to shut it down:</p>\n\n<pre><code>c := time.Tick(2 * time.Second)\nfor now := range c {\n        fmt.Println(\"tick\", now)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1461768804, "creation_date": 1461768804, "answer_id": 36893462, "question_id": 36886548, "link": "https://stackoverflow.com/questions/36886548/do-repetitive-tasks-at-intervals-in-golang-using-time-afterfunc-just-a-sample/36893462#36893462", "title": "do repetitive tasks at intervals in golang using time.AfterFunc, just a sample", "body": "<p>set time interval then call Start it will run user Job on each time intervals. set Enabled to false to stop it.<br>\nMy Sample:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\ntype IntervalTimer struct {\n    Interval time.Duration\n    Enabled  bool\n    Job      func()\n    Wg       sync.WaitGroup\n}\n\nfunc (it *IntervalTimer) isr() {\n    if it.Enabled {\n        it.Job()\n        time.AfterFunc(it.Interval, it.isr)\n    } else {\n        it.Wg.Done()\n    }\n}\n\n//trigger\nfunc (it *IntervalTimer) Start() {\n    if it.Enabled {\n        it.Wg.Add(1)\n        time.AfterFunc(it.Interval, it.isr)\n    }\n}\n\n// user code:\nvar n int = 5\nvar it *IntervalTimer\n\nfunc uerTask() {\n    fmt.Println(n, time.Now()) // do user job ...\n    n--\n    if n == 0 {\n        it.Enabled = false\n    }\n}\nfunc main() {\n    it = &amp;IntervalTimer{Interval: 500 * time.Millisecond, Enabled: true, Job: uerTask}\n    it.Start()\n\n    //do some job ...\n    it.Wg.Wait()\n    fmt.Println(\"Bye\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1018, "user_id": 1249216, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/07Pzy.jpg?s=128&g=1", "display_name": "timestee", "link": "https://stackoverflow.com/users/1249216/timestee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4867, "favorite_count": 1, "accepted_answer_id": 36887584, "answer_count": 2, "score": 0, "last_activity_date": 1461810997, "creation_date": 1461751320, "last_edit_date": 1461810997, "question_id": 36886548, "link": "https://stackoverflow.com/questions/36886548/do-repetitive-tasks-at-intervals-in-golang-using-time-afterfunc-just-a-sample", "title": "do repetitive tasks at intervals in golang using time.AfterFunc, just a sample", "body": "<p>I just want to do repetitive background tasks in Go, using time.AfterFunc,But seems something wrong with the logic. \nThe out put just:\ninterval call\ninterval call</p>\n\n<p>But at least 5 times to call the function if all things went normal.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"os\"\n    \"os/signal\"\n)\n\ntype Timer struct {\n    Queue chan *TimeCall\n}\n\nfunc NewTimer(l int) *Timer {\n    timer := new(Timer)\n    timer.Queue = make(chan *TimeCall,l)\n    return timer\n}\n\ntype TimeCall struct {\n    timer    *time.Timer\n    callback func()\n}\n\nfunc (this *TimeCall) CallBack() {\n    defer func() { recover() }()\n    if this.callback != nil {\n        this.callback()\n    }\n}\n\nfunc (this *Timer) AfterFunc(d time.Duration, callback func()) *TimeCall {\n    call := new(TimeCall)\n    call.callback = callback\n    call.timer = time.AfterFunc(d, func() {\n        this.Queue &lt;- call\n    })\n    return call\n}\n\n\n\ntype PipeService struct {\n    TimeCall *Timer\n}\n\nfunc (this *PipeService) AfterFunc(delay time.Duration, callback func()) *TimeCall {\n    return this.TimeCall.AfterFunc(delay, callback)\n}\n\nfunc (this *PipeService) IntervalCall(interval time.Duration, callback func()) {\n    this.TimeCall.AfterFunc(interval,func(){\n        if callback != nil {\n            callback()\n        }\n        this.AfterFunc(interval,callback)\n    })\n}\n\nfunc (this *PipeService) Run(closeSig chan bool) {\n    for {\n        select {\n        case &lt;-closeSig:\n            return\n        case call := &lt;-this.TimeCall.Queue:\n            call.CallBack()\n        }\n    }\n}\n\nfunc main() {\n    var closeChan chan bool\n    InsPipeService := &amp;PipeService{TimeCall: NewTimer(10)}\n    InsPipeService.IntervalCall(2*time.Second,func(){\n        fmt.Println(\"interval call\")\n    })\n\n    c := make(chan os.Signal, 1)\n    signal.Notify(c, os.Interrupt, os.Kill)\n\n    go func(){\n        InsPipeService.Run(closeChan)\n    }()\n\n    time.Sleep(10*time.Second)\n}\n</code></pre>\n\n<p><a href=\"http://ideone.com/vk3t4q\" rel=\"nofollow\">Run Code</a></p>\n"}, {"tags": ["javascript", "ajax", "go", "binary-data"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461762533, "post_id": 36885711, "comment_id": 61345864, "body": "the request body is an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>, you read from it. (actually it&#39;s an <code>io.ReadCloser</code>, but you don&#39;t need to close it on the server)"}], "answers": [{"comments": [{"owner": {"reputation": 1969, "user_id": 3486978, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7242185982c1cf9f744eb151e933b250?s=128&d=identicon&r=PG&f=1", "display_name": "khernik", "link": "https://stackoverflow.com/users/3486978/khernik"}, "edited": false, "score": 1, "creation_date": 1461749770, "post_id": 36885767, "comment_id": 61336297, "body": "Why not binary data?"}, {"owner": {"reputation": 22669, "user_id": 1803853, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/af9689064b2f7b82d2147bbf7f10d4d7?s=128&d=identicon&r=PG", "display_name": "Davide Lorenzo MARINO", "link": "https://stackoverflow.com/users/1803853/davide-lorenzo-marino"}, "reply_to_user": {"reputation": 1969, "user_id": 3486978, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7242185982c1cf9f744eb151e933b250?s=128&d=identicon&r=PG&f=1", "display_name": "khernik", "link": "https://stackoverflow.com/users/3486978/khernik"}, "edited": false, "score": 0, "creation_date": 1461750033, "post_id": 36885767, "comment_id": 61336511, "body": "You defined the content type as text/plain. A proxy could broke your request looking at the content and recognizing it as a corrupted data."}], "tags": [], "owner": {"reputation": 22669, "user_id": 1803853, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/af9689064b2f7b82d2147bbf7f10d4d7?s=128&d=identicon&r=PG", "display_name": "Davide Lorenzo MARINO", "link": "https://stackoverflow.com/users/1803853/davide-lorenzo-marino"}, "is_accepted": false, "score": 0, "last_activity_date": 1461749500, "creation_date": 1461749500, "answer_id": 36885767, "question_id": 36885711, "link": "https://stackoverflow.com/questions/36885711/sending-binary-data-to-server/36885767#36885767", "title": "Sending binary data to server", "body": "<p>Don't send binary data over HTTP protocol. Convert them in Base64. Send them as a normal string. Decode them from Base64 to binary on the server side.</p>\n\n<p>To convert a binary data to base64 you can use the function <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/btoa\" rel=\"nofollow\">btoa</a> </p>\n"}], "owner": {"reputation": 1969, "user_id": 3486978, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/7242185982c1cf9f744eb151e933b250?s=128&d=identicon&r=PG&f=1", "display_name": "khernik", "link": "https://stackoverflow.com/users/3486978/khernik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461749716, "creation_date": 1461749329, "question_id": 36885711, "link": "https://stackoverflow.com/questions/36885711/sending-binary-data-to-server", "title": "Sending binary data to server", "body": "<p>I create an array buffer containing some data:</p>\n\n<pre><code>var myArray = new ArrayBuffer(512);\nvar longInt8View = new Uint8Array(myArray);\nfor (var i = 0; i &lt; longInt8View.length; i++) {\n    longInt8View[i] = i % 255;\n}\n</code></pre>\n\n<p>And I send it so a server via POST:</p>\n\n<pre><code>if (window.XMLHttpRequest) {\n    var xmlhttp = new XMLHttpRequest();\n} else {\n    var xmlhttp = new ActiveXObject(\"Microsoft.XMLHTTP\");\n}\nxmlhttp.onreadystatechange = function () {\n    if (xmlhttp.readyState === 4 &amp;&amp; xmlhttp.status === 200) {\n        action(xmlhttp.responseText);\n    }\n};\nxmlhttp.open(\"POST\", 'http://somedomain.com:8080', true);\nxmlhttp.send(myArray);\nvar action = function (response) {\n    console.log(response);\n};\n</code></pre>\n\n<p>I now want to receive these binary data in go code, and do something with it. How can I do this?</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"net/http\"\n)\n\nfunc handleRequest(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        w.Header().Set(\"Access-Control-Allow-Headers\", \"*\")\n        w.Header().Set(\"Content-Type\", \"text/plain\")\n        fmt.Fprintf(w, \"%s\", r.Body)\n}\n\nfunc main() {\n        http.HandleFunc(\"/\", handleRequest)\n        http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I can see a reference to a memory block inside the body, but how do I get this specificaly?</p>\n"}, {"tags": ["go", "get", "libgit2"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1461766133, "post_id": 36885592, "comment_id": 61348822, "body": "You need to install the version of git2go that matches your installed version of libgit2."}, {"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1462427465, "post_id": 36885592, "comment_id": 61635388, "body": "That was it, actually ... Do want to put that as an answer?"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461749028, "creation_date": 1461749028, "question_id": 36885592, "link": "https://stackoverflow.com/questions/36885592/git2go-go-get-command-returns-not-defined-link-to-git-blob-create-fromchunks", "title": "Git2go - go get command returns &quot;Not defined link to &#39;git_blob_create_fromchunks&#39;&quot;", "body": "<p>When I install git2go with</p>\n\n<blockquote>\n  <p>go get github.com/libgit2/git2go</p>\n</blockquote>\n\n<p>Then I get following error:</p>\n\n<blockquote>\n  <p>/tmp/go-build323687976/github.com/libgit2/git2go/_obj/wrapper.o: In\n  Funktion _go_git_blob_create_fromchunks':\n  ../../../libgit2/git2go/wrapper.c:121: Nicht definierter Verweis\n  aufgit_blob_create_fromchunks'\n      collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>\"Nicht definierter Verweis auf\" means \"Not defined link to\"</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["go", "virtual"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1461746965, "post_id": 36884609, "comment_id": 61334362, "body": "Some questions+answers which show how to circumvent the lack of inheritance: 1. <a href=\"http://stackoverflow.com/questions/36710259/go-ensuring-embedded-structs-implement-interface-without-introducing-ambiguity\">Go: Ensuring embedded structs implement interface without introducing ambiguity</a>, 2. <a href=\"http://stackoverflow.com/questions/34261933/how-to-arbitrarily-extend-an-object-in-go\">How to arbitrarily extend an \u201cobject\u201d in Go</a>, 3. <a href=\"http://stackoverflow.com/questions/29390736/go-embedded-struct-call-child-method-instead-parent-method\">Go embedded struct call child method instead parent method</a>"}, {"owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461752692, "post_id": 36884609, "comment_id": 61338458, "body": "All such answers explains why it is not possible on go - why is it I know. I don&#39;t know how the other implement such type of pattern - or what pattern is similar to it but has a reasonable implementation on go . @Jiang YD - has suggested to use reflection for such pattern - it is actually the answer to my question - but in real life i would not use such type of solution (it hides the problem from a reader) and make some refactoring to just avoid such pattern."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1461752871, "post_id": 36884609, "comment_id": 61338592, "body": "You have to store the &quot;parent&quot; if you want to call a method that is potentially overridden by parent. The linked answers show example of this. But try not to solve your problem with inheritance and virtual functions. Try to think in composition."}], "answers": [{"tags": [], "owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "is_accepted": true, "score": 3, "last_activity_date": 1461748584, "creation_date": 1461748584, "answer_id": 36885412, "question_id": 36884609, "link": "https://stackoverflow.com/questions/36884609/go-virtual-function-simulation/36885412#36885412", "title": "go virtual function simulation", "body": "<p>By the time the compiler has selected <code>func (this *A) Do() {</code> the enclosing B is gone, no longer accessible.  Go does not support the is-a construct, only the has-a (composition).  If one implements a <code>func (this *B) Do() {</code> it will supersede the Do() on *A. Of course, that's not really what you are wanting.</p>\n\n<p>I think the best explanation of the implementation and motivation is here <a href=\"http://commandcenter.blogspot.co.nz/2012/06/less-is-exponentially-more.html\" rel=\"nofollow\">Less is exponentially more</a> from Rob Pike.</p>\n"}, {"tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 2, "last_activity_date": 1461748661, "creation_date": 1461748661, "answer_id": 36885441, "question_id": 36884609, "link": "https://stackoverflow.com/questions/36884609/go-virtual-function-simulation/36885441#36885441", "title": "go virtual function simulation", "body": "<p>my simple simulation, you can improve it with some <code>reflect</code>, code generation or even RPC. the main idea is add a virtual method table, and do dispatch yourself, just like c++ does.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {\nvirFunDispatcher func(funAndParams ... interface{})\n}\n\nfunc newA() *A{\n    return &amp;A{func(funAndParams ... interface{}){\n        fun := funAndParams[0].(string)\n        switch(fun){\n            case \"DoVirtual\":\n                fmt.Println(\"IM DoVirtual Default implementation\")\n        }\n    }}\n}\n\ntype B struct {\n*A\n}\n\n\nfunc newB() *B{\n    a := A{func(funAndParams ... interface{}){\n        fun := funAndParams[0].(string)\n        switch(fun){\n            case \"DoVirtual\":\n                fmt.Println(\"IM DoVirtual B implementation\")\n        }\n    }}\n    return &amp;B{&amp;a}\n}\n\nfunc (this *A) Do() {\n    fmt.Println(\"IM DO\")\n    this.virFunDispatcher(\"DoVirtual\")\n}\n\nfunc (this *A) DoVirtual() {\n    fmt.Println(\"IM DoVirtual Default implementation\")\n}\n\nfunc (this *B) DoVirtual() {\n    fmt.Println(\"IM DoVirtual B implementation\")\n}\n\nfunc main() {\n    a := newA()\n    a.Do()\n    fmt.Println(\"----\")\n    b := newB()\n    b.DoVirtual()\n    b.Do() // How to make here B.DoVirtual call\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Iw30lVOhuC\" rel=\"nofollow\">https://play.golang.org/p/Iw30lVOhuC</a></p>\n"}], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "accepted_answer_id": 36885412, "answer_count": 2, "score": 1, "last_activity_date": 1461748661, "creation_date": 1461746530, "question_id": 36884609, "link": "https://stackoverflow.com/questions/36884609/go-virtual-function-simulation", "title": "go virtual function simulation", "body": "<p>Is there exists some trick to implement virtual functions behaviour in go ? I have the following example.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {\n}\n\ntype B struct {\n*A\n}\n\nfunc (this *A) Do() {\n    fmt.Println(\"IM DO\")\n    this.DoVirtual()\n}\n\nfunc (this *A) DoVirtual() {\n    fmt.Println(\"IM DoVirtual Default implementation\")\n}\n\nfunc (this *B) DoVirtual() {\n    fmt.Println(\"IM DoVirtual B implementation\")\n}\n\nfunc main() {\n    a := &amp;A{}\n    a.Do()\n    fmt.Println(\"----\")\n    b := &amp;B{}\n    b.DoVirtual()\n    b.Do() // How to make here B.DoVirtual call\n}\n</code></pre>\n\n<p>And the last Do() call uses also default DoVirtual implementation what is actually not was I want. The reason why is it so is go lang iheritance model : this *B and this *A are different pointers in this case, but I wonder is it possible to make some simulation of such behaviour that DoVirtual in last call will be used from B class. </p>\n"}, {"tags": ["templates", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1461744517, "creation_date": 1461744517, "answer_id": 36883950, "question_id": 36883780, "link": "https://stackoverflow.com/questions/36883780/golang-text-templates-and-the-use-of-with-end/36883950#36883950", "title": "Golang text/Templates and the use of {{with }} {{end}}", "body": "<p>Because the <code>Gift</code> is optional, and if no <code>Gift</code> is provided, we don't want to thank for anything in the letter; but if <code>Gift</code> is provided, we want to say thanks for the gift.</p>\n\n<p>The <code>{{with}}</code> action executes its body conditionally, only if the passed pipeline is not empty:</p>\n\n<pre><code>{{with pipeline}} T1 {{end}}\n    If the value of the pipeline is empty, no output is generated;\n    otherwise, dot is set to the value of the pipeline and T1 is\n    executed.\n</code></pre>\n\n<p>So the example contains this:</p>\n\n<pre><code>{{with .Gift -}}\nThank you for the lovely {{.}}.\n{{end}}\n</code></pre>\n\n<p>This means that if <code>.Gift</code> is not empty, then include the \"thank you\" sentence in the output (letter). If <code>.Gift</code> is empty, the \"thank you\" will be omitted.</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1552231699, "creation_date": 1461744014, "last_edit_date": 1552231699, "question_id": 36883780, "link": "https://stackoverflow.com/questions/36883780/golang-text-templates-and-the-use-of-with-end", "title": "Golang text/Templates and the use of {{with }} {{end}}", "body": "<p>The question is this that the first example program listed in <code>text/template</code>\nbuilds a form letter.</p>\n\n<p>While the letter is parsed with a Range, why does <code>.Gift</code> need to be used via the</p>\n\n<pre><code>{{with .Gift}} ..... {{.}}  {{end}}\n</code></pre>\n\n<p><code>.Name</code> and <code>.Attended</code> were directly addressed. Why?</p>\n"}, {"tags": ["go", "gradle", "build.gradle"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1461748952, "post_id": 36883767, "comment_id": 61335679, "body": "go is designed for &quot;all in one&quot; I suppose. all sources and libraries in <code>GOPATH</code> in compile time. all libraries compiled in to the executable in run time. That means go not need a build system"}], "answers": [{"tags": [], "owner": {"reputation": 693, "user_id": 1802697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eH3MJ.jpg?s=128&g=1", "display_name": "Igor Maznitsa", "link": "https://stackoverflow.com/users/1802697/igor-maznitsa"}, "is_accepted": false, "score": 0, "last_activity_date": 1486907316, "creation_date": 1486907316, "answer_id": 42188335, "question_id": 36883767, "link": "https://stackoverflow.com/questions/36883767/how-to-use-golang-build-commands-in-gradle/42188335#42188335", "title": "How to use golang build commands in gradle", "body": "<p>gradle supports maven plugins and you can just call <a href=\"https://github.com/raydac/mvn-golang\" rel=\"nofollow noreferrer\">the mvn-golang maven plugin</a> as usual maven plugin published in the maven central</p>\n"}, {"comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 0, "creation_date": 1486938576, "post_id": 42194045, "comment_id": 71550156, "body": "Please don&#39;t just post a link to some tool or library as an answer. At least demonstrate how it solves the problem in the answer itself."}, {"owner": {"reputation": 104, "user_id": 4959909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d5c293ab8a063d52b5c776da4f5698d?s=128&d=identicon&r=PG&f=1", "display_name": "blindpirate", "link": "https://stackoverflow.com/users/4959909/blindpirate"}, "reply_to_user": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 2, "creation_date": 1486938901, "post_id": 42194045, "comment_id": 71550279, "body": "It is demostrated in the link. I think I shouldn&#39;t put code here because they may be out-of-date and mislead people."}], "tags": [], "owner": {"reputation": 104, "user_id": 4959909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d5c293ab8a063d52b5c776da4f5698d?s=128&d=identicon&r=PG&f=1", "display_name": "blindpirate", "link": "https://stackoverflow.com/users/4959909/blindpirate"}, "is_accepted": false, "score": 1, "last_activity_date": 1486939163, "last_edit_date": 1486939163, "creation_date": 1486938491, "answer_id": 42194045, "question_id": 36883767, "link": "https://stackoverflow.com/questions/36883767/how-to-use-golang-build-commands-in-gradle/42194045#42194045", "title": "How to use golang build commands in gradle", "body": "<p>Try Gogradle <a href=\"https://github.com/blindpirate/gogradle\" rel=\"nofollow noreferrer\">https://github.com/blindpirate/gogradle</a>, a full-featured Golang build plugin.</p>\n\n<p>What you need to do is creating a <code>build.gradle</code> as documented, and run <code>./gradlew build</code> or <code>./gradlew test</code>.</p>\n"}], "owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1486939163, "creation_date": 1461743977, "last_edit_date": 1461747794, "question_id": 36883767, "link": "https://stackoverflow.com/questions/36883767/how-to-use-golang-build-commands-in-gradle", "title": "How to use golang build commands in gradle", "body": "<p>I am trying to write buildscript in gradle for a simple golang web application. </p>\n\n<p>Can someone please tell me how to use golang commands for build and install in gradle build? </p>\n\n<p>I do not see any clear documentation for the usage of gradle for a go lang application.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1461733335, "post_id": 36880335, "comment_id": 61326938, "body": "golang wont implicitly cast a <code>[]Statement</code> to a <code>[]interface{}</code> as this is costly and hiding costly processes with syntax is bad, you would have to cast each <code>Statement</code> to an <code>interface{}</code> in a for loop before passing it to performAction(...)"}], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1461733383, "last_edit_date": 1461733383, "creation_date": 1461733039, "answer_id": 36880658, "question_id": 36880335, "link": "https://stackoverflow.com/questions/36880335/perform-an-action-on-a-collection-of-items/36880658#36880658", "title": "Perform an action on a collection of items", "body": "<p>You have to declare the parameters of <code>performAction</code> exactly same like the arguments type.</p>\n\n<pre><code>func performAction(action func(Statement), v []Statement) {\n    for i := range v {\n        action(v[i])\n    }\n}\n</code></pre>\n\n<p>Or you could use <code>interface{}</code> on all parameters instead. Then cast it according to the needs.</p>\n\n<pre><code>func performAction(action interface{}, v interface{}) {\n    for _, each := range v.([]Statement) {\n        action.(func(Statement))(each)\n    }\n}\n</code></pre>\n\n<ul>\n<li>data with type <code>[]Statement</code> cannot be assigned to <code>[]interface{}</code></li>\n<li>also for type <code>func(Statement)</code> cannot be assigned to <code>func(interface{})</code></li>\n</ul>\n\n<p>Use <code>interface{}</code>, then cast it to the original type.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1461743307, "post_id": 36880819, "comment_id": 61332007, "body": "Great suggestion, but I was hoping for something that didn&#39;t require casting."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1461733950, "creation_date": 1461733950, "answer_id": 36880819, "question_id": 36880335, "link": "https://stackoverflow.com/questions/36880335/perform-an-action-on-a-collection-of-items/36880819#36880819", "title": "Perform an action on a collection of items", "body": "<p>this works for me:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\n// Actually a structure in my code, but this suffices for demonstration.\ntype Opcode int\n\n// A Statement has a Name and multiple Opcodes may use this Name.\ntype Statement struct {\n    Name    string\n    Opcodes []Opcode\n}\n\n// Print the statement name.\nfunc print_name(stmt interface{}) {\n    if s, ok := stmt.(Statement); !ok {\n        panic(\"typ err\")\n    } else {\n        fmt.Println(s.Name)\n    }\n}\n\n// Perform an action on each item of a collection.\nfunc performAction(action func(interface{}), v []interface{}) {\n    for i := range v {\n        action(v[i])\n    }\n}\n\nfunc main() {\n    slist := make([]interface{}, 3)\n    slist[0] = Statement{\"Statement 1\", nil}\n    slist[1] = Statement{\"Statement 2\", nil}\n    slist[2] = Statement{\"Statement 3\", nil}\n\n    performAction(print_name, slist)\n    /*output:\n    Statement 1\n    Statement 2\n    Statement 3\n    */\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1461743348, "post_id": 36881794, "comment_id": 61332036, "body": "Comprehensive answer! Thank you!"}], "tags": [], "owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "is_accepted": true, "score": 1, "last_activity_date": 1461745285, "last_edit_date": 1461745285, "creation_date": 1461737976, "answer_id": 36881794, "question_id": 36880335, "link": "https://stackoverflow.com/questions/36880335/perform-an-action-on-a-collection-of-items/36881794#36881794", "title": "Perform an action on a collection of items", "body": "<p>An empty <code>interface{}</code> can contain any value and passed around as the type <code>interface{}</code>. when you need the value from it, you can perform a type assertion like this:</p>\n\n<pre><code>var anyValue interface{}\nanyValue = \"hello\"\n\nstrValue := anyValue.(string) \n</code></pre>\n\n<p>If anyValue is not of the type being asserted then it will cause a panic</p>\n\n<p>the type assertion can also be used to return a bool if the interface is of that type with a multiple return</p>\n\n<pre><code>strValue, ok := anyValue.(string)\nif ok {\n    //anyValue contains a string!\n}\n</code></pre>\n\n<p>If you dont know the type of the interface, you can use a switch to determine it's type like this:</p>\n\n<pre><code>switch val := anyValue.(type) {\ncase string:\n    // anyValue contains a string\n    // and val is a string\n    break\ncase int:\n    // anyValue contains an int\n    // and val is and int\n    break\ndefault:\n    //unhandled interface type\n}\n</code></pre>\n\n<p>Hopefully this makes the empty interface{} type clearer.</p>\n\n<p>interfaces{...} which have methods declared in them are different, they can not have members (like structs can), only methods, and their underlying type must implement all the methods declared in the interface. You could have an interface actionPerformer (interface names should have the suffix \"er\" as they are doing something)</p>\n\n<pre><code>type actionPerformer interface {\n    action(interface{})\n}\n</code></pre>\n\n<p>A type that implements all the methods in an interface can be cast to that interface type, then if you call one of those methods on the interface, it will run the method on the underlying type.\nFor example, if the Statement struct implements the <code>action(interface{})</code> method, the Statement struct can be cast to an <code>actionPerformer</code> type and if the <code>action(interface{})</code> function is called on the <code>actionPerformer</code>, the action function on the Statement struct is run. So you could have multiple types that all have the <code>action(interface{})</code> method and they can all be cast to an <code>actionPerformer</code> which you can call the action function on.</p>\n\n<pre><code>func (code Opcode) action(arg interface{}) {\n    fmt.Println(arg.(int) + int(code))\n}\n\nfunc (stmt Statement) action(arg interface{}) {\n    fmt.Println(arg.(string), stmt.Name)\n}\n\nstmt := Statement{\"Statement 1\", nil}\nstmtActionPerformer := actionPerformer(stmt)\n\nopcode := Opcode(5)\nopcodeActionPerformer := actionPerformer(opcode)\n\nstmtActionPerformer.action(\"hello\") // will print \"hello \"+whatever the statements name is\nopcodeActionPerformer.action(2) //will print be 7\n</code></pre>\n\n<p>Type assertions can still be used on these types of interface e.g.</p>\n\n<pre><code>stmt := stmtActionPerformer.(Statement)\nfmt.Println(stmt.Name)\n</code></pre>\n\n<p>This is a contrived example, but with this in mind, you might want to write your code using interfaces like this.\nRemember casting between interfaces is costly, so should be done sparingly, however they are a powerful tool when used correctly.</p>\n\n<p>For your example, a simple printNames function would be much more efficient than all that interface casting (note that in golang, names should be in the CamelCase format, not using underscores)</p>\n\n<pre><code>func printNames(stmts []Statement) {\n    for _, stmt := range stmts {\n        fmt.Println(stmt.Name)\n    }\n}\n</code></pre>\n\n<p>It might also be useful to have a type StatementList and add methods to it:</p>\n\n<pre><code>type StatementList []Statement\n\nfunc (list StatementList) printNames() {\n    for _, stmt := range list {\n        fmt.Println(stmt.Name)\n    }\n}\n</code></pre>\n\n<p>Getting the hang of this stuff make golang a lot more fun, hope this helps :)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 36881794, "answer_count": 3, "score": 0, "last_activity_date": 1470742432, "creation_date": 1461731390, "last_edit_date": 1470742432, "question_id": 36880335, "link": "https://stackoverflow.com/questions/36880335/perform-an-action-on-a-collection-of-items", "title": "Perform an action on a collection of items", "body": "<p>In my actual code, I'm parsing an XML document using <code>encoding/xml</code>, and I basically have a bunch of nested structures of the following form &mdash; all of which may occur multiple times, except the top-level <code>statements</code> element:</p>\n\n<pre><code>statements\n  statement\n    opcode\n      args\n        pre\n        post\n</code></pre>\n\n<p>I'm fairly new to Go, and I'm clearly misunderstanding how <code>interface{}</code> (the empty interface) works:</p>\n\n<pre><code>.\\stmtgen.go:58: cannot use print_name (type func(Statement)) as type func(interface {}) in argument to performAction\n.\\stmtgen.go:58: cannot use slist (type []Statement) as type []interface {} in argument to performAction\n</code></pre>\n\n<p>Relevant example code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport \"fmt\"\n\n// Actually a structure in my code, but this suffices for demonstration.\ntype Opcode int\n\n// A Statement has a Name and multiple Opcodes may use this Name.\ntype Statement struct {\n    Name    string\n    Opcodes []Opcode\n}\n\n// Print the statement name.\nfunc print_name(stmt Statement) {\n    fmt.Println(stmt.Name)\n}\n\n// Perform an action on each item of a collection.\nfunc performAction(action func(interface{}), v []interface{}) {\n    for i := range v {\n        action(v[i])\n    }\n}\n\nfunc main() {\n    slist := make([]Statement, 3)\n    slist[0] = Statement{\"Statement 1\"}\n    slist[1] = Statement{\"Statement 2\"}\n    slist[2] = Statement{\"Statement 3\"}\n\n    //ERROR HERE\n    performAction(print_name, slist)\n}\n</code></pre>\n\n<p>Must I create functions to print the values for every single type?</p>\n"}, {"tags": ["ruby", "regex", "go"], "comments": [{"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "edited": false, "score": 0, "creation_date": 1461732242, "post_id": 36880125, "comment_id": 61326559, "body": "Person who voted to close, it is not at all unclear what I am asking. I put a lot of effort into this question and it&#39;s clear that I want to split the string into <code>[s ge ne]</code> but neither language is providing that ability."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 1, "creation_date": 1461735769, "post_id": 36880125, "comment_id": 61327887, "body": "I don&#39;t fully understand the rules that you want to apply to your split operation. Can you give some more samples?  What is the purpose?"}, {"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1461737966, "post_id": 36880125, "comment_id": 61328890, "body": "@pascalbetz The string consists of <code>s</code>, followed by <code>ge</code>, followed by <code>ne</code>, all of which are parts of the regex. The boolean matches know this, yet the array matches do not decompose the string into those parts. I want to split the string by its regex-matching parts. Say, if I had a string &quot;sgen&quot;, I would expect <code>[s, ge, n]</code>, because these are all parts of the regex. Or from <code>genes</code> I would expect <code>[ge, ne, s]</code>, because <code>ge</code>, <code>ne</code>, and <code>s</code> are parts of the regex. The purpose is to determine whether a given string can be created by joining together any of several possible substrings."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1461741202, "post_id": 36880125, "comment_id": 61330714, "body": "@EMBLEM Your initial assumption is wrong. Your regexp <code>&quot;sg|ge|ne|n|s&quot;</code> means any of the strings, but not the repetition of those strings to cover the whole string. So in Go <code>Regexp.Match()</code> will return <code>true</code> if the word contains any of those, even if the whole word is NOT a combination of those, e.g. testing the word <code>&quot;sgenex&quot;</code> will be <code>true</code> by <code>Match()</code> but you would expect <code>false</code>. To check if the whole word is a combination of such substrings, use a regexp like <code>&quot;^(sg|ge|ne|n|s)+$&quot;</code>."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1461743821, "post_id": 36880125, "comment_id": 61332302, "body": "The issue with the regex is that <code>sg|ge|ne|n|s</code> will match <code>sg</code> in <code>sgene</code> before it even tests <code>s</code>. After  <code>sg</code> is matched, the index goes after <code>sg</code> and the engine CANNOT start looking one letter before the previous match end position - this is not possible with <code>scan</code> or <code>findallstring</code>. That is why <code>ne</code> is not matched, as the engine sees <code>en</code> (after matching <code>sg</code>) and it is no match, so the engine advances its index and tests the position after <code>e</code> and as <code>ne</code> is before <code>n</code> in the regex, the engine matches <code>ne</code> (what comes first in alternation)(see <a href=\"https://regex101.com/r/cI6hY2/1\" rel=\"nofollow noreferrer\">demo</a>)."}, {"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461770363, "post_id": 36880125, "comment_id": 61352293, "body": "@icza You should have tested your brilliant &quot;OP is an idiot&quot; answer. If I do that, then the string will not be split into the parts  by the methods from either language. The regex will match the entire string, yes, but I will not be able to decompose the string into its substrings."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1461770961, "post_id": 36880125, "comment_id": 61352757, "body": "@EMBLEM You should remain polite as I wasn&#39;t offensive. Don&#39;t exaggerate. I only posted a comment and not an answer. The regexp I suggested is only to check if the whole word is a composite of the substrings. I never said it can be used to break the word into substrings (else it would&#39;ve been posted as an answer). You were claiming that your original regexp can be used to test this using <code>Regexp.Match()</code> which is incorrect, and I did test this."}, {"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1462031644, "post_id": 36880125, "comment_id": 61471599, "body": "@CarySwoveland Please do not treat me like an idiot who doesn&#39;t know the rules of this site. I will accept an answer when I am satisfied with one."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1462037444, "post_id": 36880125, "comment_id": 61473644, "body": "Neither I nor @icza think you&#39;re an idiot. The fact is, for vast numbers of questions posted on SO, no answer is ever selected, even when excellent answers are offered. True, the OP may not be ready to make a selection or is dissatisfied with all the answers, but more often it is because he or she does not realize an answer can be selected or simply forgets to select one. I therefoe see nothing wrong with a gentle comment to consider making a selection if none has been made after a day or three. I am not talking about a request for the OP to select one&#39;s own answer, which I detest."}, {"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "reply_to_user": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1476042245, "post_id": 36880125, "comment_id": 67175792, "body": "@LightnessRacesinOrbit That the suggestion of being fair perturbed you, a renowned C++ expert who had already declared that he would stop responding, enough to look into my comment history to find this example of me fighting against the very unfairness I loathe is victory enough for me."}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1476042352, "post_id": 36880125, "comment_id": 67175827, "body": "I&#39;m glad you feel that you can claim &quot;victory&quot;. Myself, I&#39;m a grown-up and therefore see no contest here. But each to their own. Although, to continue the theme of pointing out your logical absurdities, I said I would stop responding <i>on that thread</i>. I never committed to never talking to you ever again. Though you&#39;ll be glad to hear that I am now considering it...!"}], "answers": [{"comments": [{"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "edited": false, "score": 0, "creation_date": 1461769967, "post_id": 36882436, "comment_id": 61351970, "body": "This is an okay answer, but doesn&#39;t work in Go. And it&#39;s less efficient than regexes."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "edited": false, "score": 0, "creation_date": 1461778304, "post_id": 36882436, "comment_id": 61357969, "body": "You said Ruby <i>or</i> Go. If this can&#39;t be coded in Go (which I find surprising), that cannot be considered a weakness of the solution. It&#39;s only less efficient than a regex if it&#39;s possible to do this with a regex, something that has not been established."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1461812719, "last_edit_date": 1461812719, "creation_date": 1461739957, "answer_id": 36882436, "question_id": 36880125, "link": "https://stackoverflow.com/questions/36880125/how-do-i-override-the-match-behaviour-in-string-scan-and-findallstring/36882436#36882436", "title": "How do I override the match behaviour in String.scan and FindAllString?", "body": "<p>This answer concerns Ruby only.</p>\n\n<p>We are given the regex</p>\n\n<pre><code>r = /sg|ge|ne|n|s/\n</code></pre>\n\n<p>For this regex,</p>\n\n<pre><code>\"sgene\".scan r\n  #=&gt; [\"sg\", \"ne\"]\n</code></pre>\n\n<p>As I understand, you want to find a rearrangement of the order of the elements of the regex, <code>r_new</code>, such that</p>\n\n<pre><code>\"sgene\".scan(r_new).join == \"sgene\"\n</code></pre>\n\n<p>Viewed differently, but equivalently, you are given an array and a string</p>\n\n<pre><code>arr = [\"sg\", \"ge\", \"ne\", \"n\", \"s\"]\ntarget = \"sgene\"\n</code></pre>\n\n<p>and want to determine if there is a permutation of some or all of the elements of <code>arr</code>, <code>perm</code>, such that</p>\n\n<pre><code>target == perm.join\n</code></pre>\n\n<p>and are asking if this can be done using a regex. I don't believe it can, but I cannot prove that. Moreover, several of the comments cast doubt on that.</p>\n\n<p>It can be done, however, as follows.</p>\n\n<pre><code>(1..arr.size).each_with_object([]) { |n, perms|\n  arr.permutation(n).each  { |p| perms &lt;&lt; p if p.join==target } }\n  #=&gt; [[\"s\", \"ge\", \"ne\"]]\n</code></pre>\n\n<p>I used <code>select</code>, rather than <code>any?</code>, so that all permutations that work are identified. For example:</p>\n\n<pre><code>arr = [\"sg\", \"ge\", \"ne\", \"n\", \"s\", \"e\"]\n(1..arr.size).each_with_object([]) { |n, perms|\n  arr.permutation(n).each  { |p| perms &lt;&lt; p if p.join==target } }\n  #=&gt; [[\"sg\", \"e\", \"ne\"], [\"s\", \"ge\", \"ne\"], [\"s\", \"ge\", \"n\", \"e\"]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "edited": false, "score": 0, "creation_date": 1461770168, "post_id": 36891836, "comment_id": 61352132, "body": "Your answer does not work in the general case; it has the problem I discovered in the comments <a href=\"http://stackoverflow.com/questions/25819437/is-there-a-version-of-rubys-regexp-match-that-responds-to-the-order-of-the-matc\">here</a> Your regex can&#39;t even match &quot;sg&quot; correctly, it splits it into just <code>s</code>. That is what I have been TRYING to tell everyone! Whether I put the substrings before or after the superstrings, it doesn&#39;t match the whole thing!"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "edited": false, "score": 0, "creation_date": 1461770415, "post_id": 36891836, "comment_id": 61352338, "body": "a regex will match in the order of the pattern, so, if you want sg before s, change to <code>sg|s|ge|ne|n</code>."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1461772862, "post_id": 36891836, "comment_id": 61354221, "body": "My understanding is that the rearrangement of the regex is to be done for an arbitrary string, not just for the literal <code>&quot;sgene&quot;</code>. EMBLEM, is that correct?"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1461765048, "creation_date": 1461765048, "answer_id": 36891836, "question_id": 36880125, "link": "https://stackoverflow.com/questions/36880125/how-do-i-override-the-match-behaviour-in-string-scan-and-findallstring/36891836#36891836", "title": "How do I override the match behaviour in String.scan and FindAllString?", "body": "<p>Maybe I'm not understanding what you are actually trying to do, but simply changing the order of the symbols in the regex works.\nThis isn't a greedy vs non-greedy thing as you are using no wildcards.</p>\n\n<p>It's simply a match in order of regex problem.</p>\n\n<p>Here's a modified version <a href=\"https://play.golang.org/p/raYWzNiFcq\" rel=\"nofollow\">on Play</a>.  The only different thing being to change the regex itself to give you the desired output.</p>\n\n<p>All I did was move \"n\" to the end of the pattern, as in <code>s|sg|ge|ne|n</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := \"sgene\"\n    superBeforeSub := regexp.MustCompile(\"sg|ge|ne|n|s\")\n    subBeforeSuper := regexp.MustCompile(\"n|s|sg|ge|ne\")\n    orderIActuallyWant := regexp.MustCompile(\"s|sg|ge|ne|n\")\n    regexes := []*regexp.Regexp{superBeforeSub, subBeforeSuper, orderIActuallyWant}\n    for _, rgx := range regexes {\n        fmt.Println(rgx.MatchString(str), rgx.FindAllString(str, -1))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1907, "user_id": 3161525, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6c4bdb240d87fd9fa82717d3cfbea305?s=128&d=identicon&r=PG&f=1", "display_name": "EMBLEM", "link": "https://stackoverflow.com/users/3161525/emblem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461812719, "creation_date": 1461730109, "last_edit_date": 1495541962, "question_id": 36880125, "link": "https://stackoverflow.com/questions/36880125/how-do-i-override-the-match-behaviour-in-string-scan-and-findallstring", "title": "How do I override the match behaviour in String.scan and FindAllString?", "body": "<p>I want to determine whether a given string can be created by joining any of a set of substrings. As a specific example, I want to split a string <code>\"sgene\"</code> according to what part of the regex <code>sg|ge|ne|n|s</code> it matches. The answer is <code>\"s\"</code>, <code>\"ge\"</code>, <code>\"ne\"</code>, because those three parts are how the string can be decomposed into parts from the regex, the desired set of substrings.</p>\n\n<p>Go has <code>regexp.(*Regexp).FindAllString</code>, and Ruby has <code>Regexp.scan</code> to do this. In my code, one match is lost regardless of whether I order the substrings before or after the superstrings since my regexes overlap.</p>\n\n<hr>\n\n<p>Here is a program to reproduce the problem in Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    str := \"sgene\"\n    superBeforeSub := regexp.MustCompile(\"sg|ge|ne|n|s\")\n    subBeforeSuper := regexp.MustCompile(\"n|s|sg|ge|ne\")\n    regexes := []*regexp.Regexp{superBeforeSub, subBeforeSuper}\n    for _, rgx := range regexes {\n        fmt.Println(rgx.MatchString(str), rgx.FindAllString(str, -1))\n    }\n}\n</code></pre>\n\n<p>This program outputs:</p>\n\n<pre><code>true [sg ne]\ntrue [s ge n]\n</code></pre>\n\n<hr>\n\n<p>And here is the same program in Ruby (problem for Ruby is also seen <a href=\"https://stackoverflow.com/questions/25819437\">here</a>):</p>\n\n<pre><code>str = \"sgene\"\nregexes = [/sg|ge|ne|n|s/, /n|s|sg|ge|ne/] \nregexes.each do |regex|\n  puts \"%s %s\" % [(regex === str).to_s, str.scan(regex).inspect]\nend\n</code></pre>\n\n<p>It outputs:</p>\n\n<pre><code>true [\"sg\", \"ne\"]\ntrue [\"s\", \"ge\", \"n\"]\n</code></pre>\n\n<hr>\n\n<p>The regex engines are aware that the string can be matched by the regex, but <code>FindAllString</code> and <code>scan</code> do not match it the way the boolean match does. They seem to use a greedy longest match search that ignores at least one e. How can I use regex to split the string into <code>[s ge ne]</code> in either language?</p>\n"}, {"tags": ["ssl", "go", "https", "server", "lets-encrypt"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 3, "creation_date": 1461734961, "post_id": 36880031, "comment_id": 61327566, "body": "how about add reading permission for all user in <code>&#47;etc&#47;letsencrypt&#47;live&#47;mysite</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461771124, "post_id": 36890681, "comment_id": 61352878, "body": "With the first option, I&#39;m still unable to read the cert files themselves"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461771419, "post_id": 36890681, "comment_id": 61353076, "body": "@DougSmith you should have, did you forget passing -R to chown?"}, {"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461771499, "post_id": 36890681, "comment_id": 61353120, "body": "I &quot;own&quot; all the cert files themselves, but the group is still set as &quot;root&quot;. Is that normal? If I try to cat any of the files as the desired user I get permission denied."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461771648, "post_id": 36890681, "comment_id": 61353257, "body": "@DougSmith that&#39;s rather odd, you should be able to cat them as the user, are you running SELinux?"}, {"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 1, "creation_date": 1461772249, "post_id": 36890681, "comment_id": 61353727, "body": "Ah, <code>live</code> is just simlinked to archive, I had to <code>chown</code> the archive one as well."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 2, "last_activity_date": 1461762541, "last_edit_date": 1461762541, "creation_date": 1461762204, "answer_id": 36890681, "question_id": 36880031, "link": "https://stackoverflow.com/questions/36880031/how-do-i-access-my-tls-https-keys-in-order-to-start-listenandservetls/36890681#36890681", "title": "How do I access my TLS/HTTPS keys in order to start ListenAndServeTLS?", "body": "<p>You have few options:</p>\n\n<ul>\n<li><code>sudo chown -R your-user /etc/letsencrypt/live/mysite</code></li>\n</ul>\n\n<p>Or</p>\n\n<ul>\n<li><code>sudo cp -a /etc/letsencrypt/live/mysite ./ssl/ &amp;&amp; sudo chown -R your-user ./ssl/</code></li>\n</ul>\n\n<p>Or</p>\n\n<ul>\n<li>Use a container for your app and copy your app and the certs to it, and since it will be running as root inside the container, it won't matter.</li>\n</ul>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 36890681, "answer_count": 1, "score": 2, "last_activity_date": 1461762541, "creation_date": 1461729582, "question_id": 36880031, "link": "https://stackoverflow.com/questions/36880031/how-do-i-access-my-tls-https-keys-in-order-to-start-listenandservetls", "title": "How do I access my TLS/HTTPS keys in order to start ListenAndServeTLS?", "body": "<p>My server uses Let's Encrypt to get its TLS certificate to serve over HTTPS. </p>\n\n<p>I'm electing to use the standard <code>net/http</code> package over Apache or nginx, so I used the webroot installation method, and it placed the cert files in <code>/etc/letsencrypt/live/mysite</code>. </p>\n\n<p>The issue is that the <code>live</code> directory is only accessible by the root user. My golang program requires the certs in this directory to function and serve over HTTPS. </p>\n\n<p>However for obvious reasons I'm not running my program as the root user.</p>\n\n<p>So that leads me to wonder: how do I access these files without having to insecurely run my web server as root permanently?</p>\n"}, {"tags": ["node.js", "go", "sign", "verify", "pkcs#1"], "owner": {"reputation": 11, "user_id": 6259189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a4bb4143deb0a83db6175c41e79c577?s=128&d=identicon&r=PG&f=1", "display_name": "\u590f\u987a\u65b0", "link": "https://stackoverflow.com/users/6259189/%e5%a4%8f%e9%a1%ba%e6%96%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461723583, "creation_date": 1461723583, "question_id": 36879151, "link": "https://stackoverflow.com/questions/36879151/how-to-signpkcs1v1-5-via-nodejs", "title": "how to sign(pkcs#1v1_5) via nodejs", "body": "<p>I tried to communicate with a company A. A use golang as server. me use nodejs. </p>\n\n<p>Encrypted communication process\uff0cuse hash256 digest, and rsa-key is 1024 bit.</p>\n\n<p>here is a golang code for verify.</p>\n\n<pre><code>func NewRsaVerifier(publicKeyPem string) (verifier *RsaVerifier, err error) {\n    block, _ := pem.Decode([]byte(publicKeyPem))\n\n    if block == nil {\n        err = errors.New(PUBLIC_KEY_ERR)\n        return\n    }\n    publicKeyInterface, err1 := x509.ParsePKIXPublicKey(block.Bytes)\n    if err1 != nil {\n        err = errors.New(PUBLIC_KEY_ERR)\n        return\n    }\n    publicKey, ok := publicKeyInterface.(*rsa.PublicKey)\n    if !ok {\n        err = errors.New(PUBLIC_KEY_ERR)\n        return\n    }\n    return &amp;RsaVerifier{\n        publicKey: publicKey,\n    }, nil\n}\n\nfunc (v *RsaVerifier) Verify(msg string, signature string) (err error) {\n    signatureBytes, err := base64.StdEncoding.DecodeString(signature)\n    if err != nil {\n        return\n    }\n\n    //VerifyPKCS1v15\n    hash := sha256.New()\n    io.WriteString(hash, msg)\n    hashed := hash.Sum(nil)\n    err = rsa.VerifyPKCS1v15(v.publicKey, crypto.SHA256, hashed, signatureBytes)\n    return err\n}\n\nfunc (a *BrokerAuth) VerifySignature(pubKey, payload string, signature string) error {\n    verifier, err := security.NewRsaVerifier(pubKey)\n    if verifier == nil {\n        return errors.New(\"\u672a\u627e\u5230\u6307\u5b9a\u4ee3\u7406\u5546\u7684\u9274\u6743\u6a21\u5757\")\n    }\n    err := verifier.Verify(payload, signature)\n    if err != nil {\n        logger.Error(\"\u9a8c\u8bc1\u7b7e\u540d\u9519\u8bef: %v\", err)\n        return errors.New(\"\u4ee3\u7406\u5546\u9274\u6743\u5931\u8d25\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>how to sign a string via nodejs , and return true use this golang code.</p>\n\n<p>i try to use sign('RSA-SHA256'), it is false.</p>\n\n<p>this my code:</p>\n\n<pre><code>const SIGN_TYPE = 'RSA-SHA256';\n_hashDigest(data_buff) {\n  let hash = crypto.createHash(HASH_TYPE);\n  hash.update(data_buff);\n  return hash.digest();\n}\n\n_sign(data_buff) {\n  const sign = crypto.createSign(SIGN_TYPE);\n  sign.update(this._hashDigest(data_buff));\n  var signPramas = {\n    key: this._privateKey,\n    passphrase: this._passphrase\n  };\n  return sign.sign(signPramas);\n}\n</code></pre>\n"}, {"tags": ["http", "ubuntu", "nginx", "go", "proxy"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1461721022, "post_id": 36878684, "comment_id": 61323568, "body": "nginx as a proxy, golang as a programming language to make the real business server, that all right. what is your problem?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1461725931, "post_id": 36878684, "comment_id": 61324870, "body": "See <a href=\"http://nf.id.au/posts/2010/10/deploying-go-web-services-behind-nginx-under.html\" rel=\"nofollow noreferrer\">nf.id.au/posts/2010/10/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461724492, "post_id": 36878931, "comment_id": 61324492, "body": "Even with things like load balancing? Go will handle that?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 1, "creation_date": 1461724583, "post_id": 36878931, "comment_id": 61324510, "body": "@mickdoe no, but there are packages for that, however that is a legitimate reason to use nginx, I won&#39;t judge you for it. ;) You will be judged for running a single nginx instance just to serve a single go app, a lot of people do that."}, {"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461724634, "post_id": 36878931, "comment_id": 61324524, "body": "Hmm, you&#39;re quickly changing my mind. :) So I could theoretically use <code>net&#47;http</code> for quite awhile then?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1461724786, "post_id": 36878931, "comment_id": 61324565, "body": "yes, I generally use it for most things.  Some times it&#39;s fronted by something else, but only if you need load balancing or are hosting at Heroku or some place where they always front your webserver with their infrastructure."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461726963, "post_id": 36878931, "comment_id": 61325095, "body": "And TLS is quite optimized on amd64 systems now, specially if the CPU has aes-ni instructions, so you don&#39;t have to worry about https being slow on pure go (which was a legit concern on older versions of go)."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1461722069, "last_edit_date": 1495540386, "creation_date": 1461722069, "answer_id": 36878931, "question_id": 36878684, "link": "https://stackoverflow.com/questions/36878684/how-do-i-use-nginx-as-a-reverse-proxy-alongside-golang/36878931#36878931", "title": "How do I use nginx as a reverse proxy alongside Golang?", "body": "<p>That's not needed at all anymore unless you're using nginx for caching, Golang 1.6+ is more than good enough to server http and https directly.</p>\n\n<p>However if you're insisting, and I will secretly judge you and laugh at you, here's the work flow:</p>\n\n<ol>\n<li>Your go app listens on a local port, say \"127.0.0.1:8080\"</li>\n<li>nginx listens on 0.0.0.0:80 and 0.0.0.0:443 and proxies all requests to 127.0.0.1:8080.</li>\n<li>Be judged.</li>\n</ol>\n\n<p>The nginx setup in <a href=\"https://stackoverflow.com/questions/5009324/node-js-nginx-what-now\">Node.js + Nginx - What now?</a> is exactly the same setup you would use for Go, or any other standalone server for that matter that isn't cgi/fastcgi.</p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1463162480, "creation_date": 1463162480, "answer_id": 37216555, "question_id": 36878684, "link": "https://stackoverflow.com/questions/36878684/how-do-i-use-nginx-as-a-reverse-proxy-alongside-golang/37216555#37216555", "title": "How do I use nginx as a reverse proxy alongside Golang?", "body": "<p>I use Nginx in production very effectively, using Unix sockets instead of TCP for the FastCGI connection. This code snippet comes from <a href=\"https://github.com/rickb777/manners\" rel=\"nofollow\">Manners</a>, but you can adapt it for the normal Go api quite easily.</p>\n\n<pre><code>func isUnixNetwork(addr string) bool {\n    return strings.HasPrefix(addr, \"/\") || strings.HasPrefix(addr, \".\")\n}\n\nfunc listenToUnix(bind string) (listener net.Listener, err error) {\n    _, err = os.Stat(bind)\n    if err == nil {\n        // socket exists and is \"already in use\";\n        // presume this is from earlier run and therefore delete it\n        err = os.Remove(bind)\n        if err != nil {\n            return\n        }\n    } else if !os.IsNotExist(err) {\n        return\n    }\n    listener, err = net.Listen(\"unix\", bind)\n    return\n}\n\nfunc listen(bind string) (listener net.Listener, err error) {\n    if isUnixNetwork(bind) {\n        logger.Printf(\"Listening on unix socket %s\\n\", bind)\n        return listenToUnix(bind)\n    } else if strings.Contains(bind, \":\") {\n        logger.Printf(\"Listening on tcp socket %s\\n\", bind)\n        return net.Listen(\"tcp\", bind)\n    } else {\n        return nil, fmt.Errorf(\"error while parsing bind arg %v\", bind)\n    }\n}\n</code></pre>\n\n<p>Take a look around about <a href=\"https://github.com/rickb777/manners/blob/master/server.go#L252\" rel=\"nofollow\">line 252</a>, which is where the switching happens between HTTP over a TCP connection and FastCGI over Unix-domain sockets.</p>\n\n<p>With Unix sockets, you have to adjust your startup scripts to ensure that the sockets are created in an orderly way with the correct ownership and permissions. If you get that right, the rest is easy.</p>\n\n<hr>\n\n<p>To answer other remarks about <em>why</em> you would want to use Nginx, it always depends on your use-case. I have Nginx-hosted static/PHP websites; it is convenient to use it as a reverse-proxy on the same server in such cases.</p>\n"}], "owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1363, "favorite_count": 3, "answer_count": 2, "score": 2, "last_activity_date": 1463162480, "creation_date": 1461720202, "last_edit_date": 1495542816, "question_id": 36878684, "link": "https://stackoverflow.com/questions/36878684/how-do-i-use-nginx-as-a-reverse-proxy-alongside-golang", "title": "How do I use nginx as a reverse proxy alongside Golang?", "body": "<p>I want to use Golang as my server side language, but everything I've read points to nginx as the web server rather than relying on <code>net/http</code> (not that it's bad, but it just seems preferable overall, not the point of this post though). </p>\n\n<p>I've found a few articles on using fastcgi with Golang, but I have no luck in finding anything on reverse proxies and HTTP and whatnot, other than <a href=\"https://gist.github.com/hgfischer/7965620\" rel=\"nofollow noreferrer\">this benchmark</a> which doesn't go into enough detail unfortunately.</p>\n\n<p>Are there any tutorials/guides available on how this operates?</p>\n\n<p>For example there is a <a href=\"https://stackoverflow.com/questions/5009324/node-js-nginx-what-now\">big post on Stackoverflow</a> detailing it with Node, but I cannot find a similar one for go.</p>\n"}, {"tags": ["http", "ubuntu", "ssl", "go", "https"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461714623, "post_id": 36875673, "comment_id": 61321928, "body": "Can not the application binary and the certificates be in the same group?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1461721112, "post_id": 36875673, "comment_id": 61323594, "body": "that is a Linux problem, no matter with golang."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461712108, "post_id": 36875771, "comment_id": 61321180, "body": "Are there any tutorials available on this then? I can&#39;t seem to find how to use setcap and whatnot."}], "tags": [], "owner": {"reputation": 5437, "user_id": 1257094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Ob6MH.jpg?s=128&g=1", "display_name": "milgner", "link": "https://stackoverflow.com/users/1257094/milgner"}, "is_accepted": false, "score": 7, "last_activity_date": 1461704828, "creation_date": 1461704828, "answer_id": 36875771, "question_id": 36875673, "link": "https://stackoverflow.com/questions/36875673/does-my-golang-webserver-need-to-be-run-as-the-root-user-in-order-to-support-htt/36875771#36875771", "title": "Does my golang webserver need to be run as the root user in order to support HTTPS/TLS?", "body": "<p>To blatantly quote the well-written <a href=\"https://caddyserver.com/docs/faq\">Caddy FAQ</a>:</p>\n\n<blockquote>\n  <p>No. On Linux, you can use setcap to give Caddy permission to bind to\n  low ports. Something like <code>setcap cap_net_bind_service=+ep ./caddy</code>\n  should work. Consult the man pages of your OS to be certain. You could\n  also use iptables to forward to higher ports.</p>\n  \n  <p>Privilege de-escalation is another option, but it <a href=\"https://github.com/golang/go/issues/1435\">is not yet a\n  reliable solution</a>. It will be implemented as soon as this becomes a\n  robust possibility. Concerned readers are encouraged to get involved\n  to help this become a reality.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461711252, "post_id": 36876005, "comment_id": 61320928, "body": "Why not just always run it as root then?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461711559, "post_id": 36876005, "comment_id": 61321022, "body": "@mickdoe people don&#39;t like to do that mainly in case there&#39;s a vulnerability in the code that&#39;d give the attacker root access, but in the age of containers and docker, it&#39;s not that bad to run your app as root."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 3, "last_activity_date": 1461705693, "creation_date": 1461705693, "answer_id": 36876005, "question_id": 36875673, "link": "https://stackoverflow.com/questions/36875673/does-my-golang-webserver-need-to-be-run-as-the-root-user-in-order-to-support-htt/36876005#36876005", "title": "Does my golang webserver need to be run as the root user in order to support HTTPS/TLS?", "body": "<p>To add to @ma_il's answer, you can use setcap but you still would have to change the permissions of the cert.</p>\n\n<p>Or build your app then run it as root, example: <code>go build &amp;&amp; sudo ./app</code></p>\n"}], "owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1008, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1509984712, "creation_date": 1461704490, "last_edit_date": 1509984712, "question_id": 36875673, "link": "https://stackoverflow.com/questions/36875673/does-my-golang-webserver-need-to-be-run-as-the-root-user-in-order-to-support-htt", "title": "Does my golang webserver need to be run as the root user in order to support HTTPS/TLS?", "body": "<p>I want to use golang's built in <code>ListenAndServeTLS()</code> function to serve up my webserver (it's a very simple one), and I need to show it where my keys are stored. The keys are stored in a location only the root user can access (Let's Encrypt did this by default) and I can't listen to port 80 or 443 unless I'm the root user.</p>\n\n<p>Does this mean I have to be running the script as root all the time? Is that not insecure?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "edited": false, "score": 0, "creation_date": 1461704793, "post_id": 36875048, "comment_id": 61318239, "body": "With a problem like the issue can very well lie in your surrounding code. In the snippet you&#39;ve given us, <code>game</code> is undefined -- are we to assume it&#39;s <code>&quot;dota&quot;</code> -- and the type <code>hints</code> is also undefined. More of your actual code will probably help. Are you certain there isn&#39;t more than one document with the name you&#39;re looking for? Can you please share the results of <code>games := make([]Game); err := db.C(&quot;games&quot;).Find(bson.M{&quot;title&quot;: &quot;dota&quot;}).All(games); fmt.Printf(&quot;%#v; %s&quot;, games, err);</code> with us? (Snippet untested -- please correct as appropriate.)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1461709014, "post_id": 36875048, "comment_id": 61320164, "body": "I recommend decomposing your query for the sake of debugging. At a glance it looks good to me but most likely one of the earlier operations is not returning what you expect. Unfortunately there is a lot of overhead required to prepare an answer for this so I don&#39;t really have the time to help you further. But, if you build your query up one piece at a time checking the results along the way I bet you&#39;ll figure it out."}], "answers": [{"comments": [{"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1461743916, "post_id": 36878320, "comment_id": 61332368, "body": "tnx, it worked. what should i do to get first 10 hint from the slice ?"}, {"owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "edited": false, "score": 0, "creation_date": 1461756646, "post_id": 36878320, "comment_id": 61341228, "body": "tnx again but i cant use bson.M{&quot;$slice&quot;: [from, limit]} instead of 10, is there a syntax error or what ?"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 0, "last_activity_date": 1461766238, "last_edit_date": 1461766238, "creation_date": 1461717858, "answer_id": 36878320, "question_id": 36875048, "link": "https://stackoverflow.com/questions/36875048/select-function-doest-work-to-only-get-the-array-i-want/36878320#36878320", "title": "select function does&#39;t work to only get the array i want", "body": "<p>You have too keep using <code>Game</code> struct to receive the result, even for only <code>hints</code> column. Also your select query should be <code>.Select(bson.M{\"hints\": 1})</code>.</p>\n\n<p>I fixed your code, and tried in my local, this one is working.</p>\n\n<pre><code>game := Game{}\nerr = db.C(\"games\").Find(bson.M{\"title\": \"dota\"})\n        .Select(bson.M{\"hints\": 1}).One(&amp;game)\nif err != nil {\n    panic(err)\n}\n\nfor _, hint := range game.Hints {\n    fmt.Printf(\"%#v\\n\", *hint)\n}\n</code></pre>\n\n<p>All properties of <code>game</code> is empty, except <code>Hints</code>.</p>\n\n<h2>EDITED 1</h2>\n\n<p>To get the first 10 rows on <code>hints</code>, the easiest way would be by playing the slice, but this is bad because it need to fetch all the rows first.</p>\n\n<pre><code>for _, hint := range game.Hints[:10] { // 10 rows\n    fmt.Printf(\"%#v\\n\", *hint)\n}\n</code></pre>\n\n<p>The other solution (which is better), is by using <code>$slice</code> on the <code>.Select()</code> query.</p>\n\n<pre><code>selector := bson.M{\"hints\": bson.M{\"$slice\": 10}} // 10 rows\n\nerr = db.C(\"so\").Find(bson.M{\"title\": \"dota\"})\n        .Select(selector).One(&amp;game)\n</code></pre>\n\n<h2>EDITED 2</h2>\n\n<p>Use <code>[]int{skip, limit}</code> on the <code>$slice</code>, to support skip and limit.</p>\n\n<pre><code>selector := bson.M{\"hints\": bson.M{\"$slice\": []int{0, 10}}}\n</code></pre>\n"}], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 36878320, "answer_count": 1, "score": 0, "last_activity_date": 1461766238, "creation_date": 1461702328, "question_id": 36875048, "link": "https://stackoverflow.com/questions/36875048/select-function-doest-work-to-only-get-the-array-i-want", "title": "select function does&#39;t work to only get the array i want", "body": "<p>i have a document like this</p>\n\n<pre><code>{\n\"_id\": {\n    \"$oid\": \"570bc73da8ebd9005dd54de3\"\n},\n\"title\": \"dota\",\n\"imgurl\": \"asd.com\",\n\"description\": \"\",\n\"hints\": [\n    {\n        \"date\": \"2016-04-26 22:50:12.6069011 +0430 IRDT\",\n        \"description\": \"narinin\"\n    },\n    {\n        \"date\": \"2016-04-26 22:50:12.6069011 +0430 IRDT\",\n        \"description\": \"doros shod\"\n    }\n]\n}\n</code></pre>\n\n<p>the script i execute is </p>\n\n<pre><code>hints := hints{}\nerr := db.C(\"games\").Find(bson.M{\"title\": game}).Select(bson.M{\"hints\": 0}).One(&amp;hints)\n</code></pre>\n\n<p>my 2 structs are </p>\n\n<pre><code>type Game struct {\nId          bson.ObjectId `bson:\"_id,omitempty\"`\nTitle       string        `json:\"title\"`\nImgurl      string        `json:\"imgurl\"`\nDescription string        `json:\"desc\"`\nHints       []*hint       `bson:\"hints\", json:\"hints\"`\n}\n\ntype hint struct {\n    Description string    `json:\"desc\"`\n    Date        time.Time `json:\"date\"`\n}\n</code></pre>\n\n<p>when i use the script all i get is a none sense date string witch is not even in document\nhow can i get just the slice of hints from a game</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 6, "creation_date": 1461701349, "post_id": 36874689, "comment_id": 61316204, "body": "My advice is figure out the schema. There is no such thing as &#39;arbitrary&#39; json and I&#39;m real sick of people taking inferior approaches because they think their json is so unpredictable. I have news for you, it&#39;s not! I&#39;ve parsed far more variant and complicated json with schemas and it wasn&#39;t that hard. json is a formal language, there is an exact schema to describe any blob and they can be quite flexible."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461701522, "post_id": 36874689, "comment_id": 61316300, "body": "When you have a nested json struct and you unmarshal it, you end up with a map[string]interface{}. The interface{} portion (if it&#39;s the nested portion) is again, a map[string]interface{}. So you can keep traversing down until you find that your interface{} isn&#39;t a map. If you provide a sample of the json you&#39;d like to use, we can come up with a solution."}, {"owner": {"reputation": 13614, "user_id": 2073001, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DbYlx.jpg?s=128&g=1", "display_name": "Steve P.", "link": "https://stackoverflow.com/users/2073001/steve-p"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1461703713, "post_id": 36874689, "comment_id": 61317625, "body": "@evanmcdonnal this was more of a &#39;in theory, how would I do this?&#39;  For practical purposes, I came to the same conclusion as you."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1461707165, "post_id": 36874689, "comment_id": 61319364, "body": "That&#39;s cool. I&#39;ve also dealt with similar confusion trying unpackage data from an interface that is actually representing a slice or map of interfaces. I just felt compelled to give my 2 cents because as I said, I&#39;ve seen a lot of question like this on SO lately and most times the authors are actually dealing with pretty simple json and they&#39;re just shooting themselves in the foot with this assumption that there isn&#39;t a simple concise schema to describe it."}], "answers": [{"comments": [{"owner": {"reputation": 13614, "user_id": 2073001, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DbYlx.jpg?s=128&g=1", "display_name": "Steve P.", "link": "https://stackoverflow.com/users/2073001/steve-p"}, "edited": false, "score": 0, "creation_date": 1461704697, "post_id": 36875453, "comment_id": 61318185, "body": "Thanks for the explanation/answer :)"}, {"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "reply_to_user": {"reputation": 13614, "user_id": 2073001, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DbYlx.jpg?s=128&g=1", "display_name": "Steve P.", "link": "https://stackoverflow.com/users/2073001/steve-p"}, "edited": false, "score": 0, "creation_date": 1461705008, "post_id": 36875453, "comment_id": 61318345, "body": "Glad I could help. As was previously commented elsewhere, you might want to try creating a type to represent the parent container, e.g. <code>struct OuterConfig { Config *GeneralConfig `json:&quot;parent_key&quot;` }</code>."}], "tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": true, "score": 2, "last_activity_date": 1461703803, "creation_date": 1461703803, "answer_id": 36875453, "question_id": 36874689, "link": "https://stackoverflow.com/questions/36874689/golang-type-conversion-assertion-issue-with-unmarshalling-json/36875453#36875453", "title": "Golang type conversion/assertion issue with unmarshalling json", "body": "<p>I agree the comments about trying to utilise the expected structure of the incoming JSON in order to write well-defined Structs, but I'll attempt to answer the question anyway.</p>\n\n<p>The thing to take away from what you're seeing printed versus the error messages that you're seeing is that the compiler knows less about the type than the runtime because the runtime can look at the actual value. To bring the compiler up-to-speed we must (i) assert <code>(*jsonData)[\"important_key\"]</code> is a <code>map[string]interface{}</code> -- the compiler only knows it to be an <code>interface{}</code> -- and then (ii) type-cast that to a <code>GeneralConfig</code> type. See:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype GeneralConfig map[string]interface{}\n\nfunc main() {\n    jsonStruct := new(GeneralConfig)\n    json.Unmarshal([]byte(`{\"parent_key\": {\"foo\": \"bar\"}}`), jsonStruct)\n    fmt.Printf(\"%#v\\n\", jsonStruct)\n    // =&gt; &amp;main.GeneralConfig{\"parent_key\":map[string]interface {}{\"foo\":\"bar\"}}\n\n    nestedStruct := (*jsonStruct)[\"parent_key\"]\n    fmt.Printf(\"%#v\\n\", nestedStruct)\n    // =&gt; map[string]interface {}{\"foo\":\"bar\"}\n    // Whilst this shows the runtime knows its actual type is\n    // map[string]interface, the compiler only knows it to be an interface{}.\n\n    // First we assert for the compiler that it is indeed a\n    // map[string]interface{} we are working with. You can imagine the issues\n    // that might arrise if we has passed in `{\"parent_key\": 123}`.\n    mapConfig, ok := nestedStruct.(map[string]interface{})\n    if !ok {\n        // TODO: Error-handling.\n    }\n\n    // Now that the compiler can be sure mapConfig is a map[string]interface{}\n    // we can type-cast it to GeneralConfig:\n    config := GeneralConfig(mapConfig)\n    fmt.Printf(\"%#v\\n\", config)\n    // =&gt; main.GeneralConfig{\"foo\":\"bar\"}\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1461704768, "creation_date": 1461704768, "answer_id": 36875749, "question_id": 36874689, "link": "https://stackoverflow.com/questions/36874689/golang-type-conversion-assertion-issue-with-unmarshalling-json/36875749#36875749", "title": "Golang type conversion/assertion issue with unmarshalling json", "body": "<p>You are looking for json.RawMessage.<br>\nYou can delay unmarshalling based upon some other value and then force it to unmarshal to a specific type.</p>\n\n<p>This is not a good idea, but might be closer to what you are looking for.</p>\n\n<p><a href=\"http://play.golang.org/p/PWwAUDySE0\" rel=\"nofollow\">http://play.golang.org/p/PWwAUDySE0</a></p>\n"}, {"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": false, "score": 0, "last_activity_date": 1461705582, "last_edit_date": 1461705582, "creation_date": 1461705062, "answer_id": 36875841, "question_id": 36874689, "link": "https://stackoverflow.com/questions/36874689/golang-type-conversion-assertion-issue-with-unmarshalling-json/36875841#36875841", "title": "Golang type conversion/assertion issue with unmarshalling json", "body": "<p>This is a standard \"workaround\" if get what you're after. When handling unknown data you can implement this pattern (modified from your example) of switching on the type recursively to get to the concrete values in an unknown body of json data.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\nvar data = `\n{\n    \"key\":\"value\",\n    \"important_key\":\n        {\"foo\":\"bar\"}\n}`\n\nfunc main() {\n    var jsonData interface{}\n    json.Unmarshal([]byte(data), &amp;jsonData)\n\n    fmt.Println(reflect.TypeOf(jsonData))\n\n    parseArbitraryJSON(jsonData.(map[string]interface{}))\n}\n\nfunc parseArbitraryJSON(data map[string]interface{}) {\n    for k, v := range data {\n        switch a := v.(type) {\n        case string:\n            fmt.Printf(\"%v:%v\\n\", k, a)\n        case map[string]interface{}:\n            fmt.Printf(\"%v:%v\\n\", k, a)\n            parseArbitraryJSON(a)\n        }\n    }\n}\n</code></pre>\n\n<p>The resulting output is:</p>\n\n<pre><code>map[string]interface {}\nkey:value\nimportant_key:map[foo:bar]\nfoo:bar\n</code></pre>\n\n<p>This example only accounts for the base data being a string type but you can switch on any type that you expect to receive, and like any switch you can group your cases, so you can treat all numbers similarly for example.</p>\n"}], "owner": {"reputation": 13614, "user_id": 2073001, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DbYlx.jpg?s=128&g=1", "display_name": "Steve P.", "link": "https://stackoverflow.com/users/2073001/steve-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1275, "favorite_count": 0, "accepted_answer_id": 36875453, "answer_count": 3, "score": 0, "last_activity_date": 1461705582, "creation_date": 1461700977, "question_id": 36874689, "link": "https://stackoverflow.com/questions/36874689/golang-type-conversion-assertion-issue-with-unmarshalling-json", "title": "Golang type conversion/assertion issue with unmarshalling json", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"reflect\"\n)\n\ntype GeneralConfig map[string]interface{}\n\nvar data string = `\n{\n    \"key\":\"value\",\n    \"important_key\":\n        {\"foo\":\"bar\"}\n}`\n\nfunc main() {\n    jsonData := &amp;GeneralConfig{}\n    json.Unmarshal([]byte(data), jsonData)\n\n    fmt.Println(reflect.TypeOf(jsonData)) //main.GeneralConfig\n\n    jsonTemp := (*jsonData)[\"important_key\"]\n    fmt.Println(reflect.TypeOf(jsonTemp)) //map[string]interface {}\n\n    //newGeneralConfig := GeneralConfig(jsonTemp)\n    //cannot convert jsonTemp (type interface {}) to type GeneralConfig:\n    //need type assertion\n\n    newGeneralConfig := jsonTemp.(GeneralConfig)\n    //fmt.Println(reflect.TypeOf(newGeneralConfig))\n    //panic: interface conversion: interface {} is map[string]interface {},\n    //not main.GeneralConfig\n\n}\n</code></pre>\n\n<p>Available at <a href=\"https://play.golang.org/p/GBRf8gkL0t\" rel=\"nofollow\">the playground</a></p>\n\n<p>I understand that I can use a nested struct in lieu of <code>GeneralConfig</code>, but that would require me knowing the exact structure of the payload, ie it wouldn't work for different keys (I would be locked into \"important_key\").</p>\n\n<p>Is there a golang workaround for when I don't know what the value of \"important_key\" is?  I say golang, because if possible, one could require all \"important_keys\" to have a constant parent key, which could resolve this issue.</p>\n\n<p>To summarize, given an arbitrary json object, there must be a way that I can traverse its keys, and if a value is a custom type, convert the value to that type.  Right now it seems that if I use type conversion, it tells me that the type is <code>interface{}</code> and I need to use type assertion; however, if I use type assertion, it tells me that <code>interface{}</code> is <code>map[string]interface{}</code> not <code>main.GeneralConfig</code>.</p>\n"}, {"tags": ["apache", "encryption", "nginx", "go", "lets-encrypt"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1461721380, "post_id": 36873304, "comment_id": 61323667, "body": "I suggest to use nginx or apache, leave the tls/https/cert work to deploy team, and let developers focus on business."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461697696, "post_id": 36873405, "comment_id": 61313982, "body": "Awesome! Do you know of a tutorial that would show me how to set up Let&#39;s Encrypt without appache/nginx then? Their github and most sites seem to only explain in the context of those two"}, {"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461704817, "post_id": 36873405, "comment_id": 61318253, "body": "how do I go about listening on port 80 or 443 so that it&#39;s available at /?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461705074, "post_id": 36873405, "comment_id": 61318379, "body": "<code>go build &amp;&amp; sudo .&#47;your-service</code>, I&#39;ll add it to the post."}, {"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461712053, "post_id": 36873405, "comment_id": 61321160, "body": "Wouldn&#39;t it always be running as root then? Is that bad?"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461712227, "post_id": 36873405, "comment_id": 61321216, "body": "not &quot;bad&quot;, depends on your setup, you can always copy the certificate and chown it to your user then setcap, I&#39;ll add an example."}, {"owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461770659, "post_id": 36873405, "comment_id": 61352522, "body": "Last question! In the above example you seemingly cat the cert files to the directory of your go program. Is this secure? Is this just your home directory? Is it okay to have certs there? I thought they had to be in a secure location."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "edited": false, "score": 0, "creation_date": 1461771222, "post_id": 36873405, "comment_id": 61352947, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/110406/discussion-between-oneofone-and-mickdoe\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 4, "last_activity_date": 1461712648, "last_edit_date": 1461712648, "creation_date": 1461696662, "answer_id": 36873405, "question_id": 36873304, "link": "https://stackoverflow.com/questions/36873304/do-i-need-to-use-nginx-or-apache-to-use-lets-encrypt/36873405#36873405", "title": "Do I need to use nginx or Apache to use Lets Encrypt?", "body": "<p>No, you do not need to use Apache/Nginx, Go handles TLS just fine.</p>\n\n<p>Check <a href=\"https://golang.org/pkg/net/http/#ListenAndServeTLS\" rel=\"nofollow\">http.ListenAndServeTLS</a></p>\n\n<p>Example:</p>\n\n<pre><code>\u279c sudo letsencrypt certonly --standalone --agree-tos --email you@email.com -d domain1.com [-d domain2.com, etc..]\n\u279c sudo cat /etc/letsencrypt/archive/domain1.com/fullchain1.pem &gt; cert.pem\n\u279c sudo cat /etc/letsencrypt/archive/domain1.com/privkey1.pem &gt; key.pem \n\n\u279c cat main.go\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc handler(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(\"This is an example server.\\n\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", handler)\n    log.Printf(\"About to listen on 10443. Go to https://domain1.com:10443/\")\n    log.Fatal(http.ListenAndServeTLS(\":10443\", \"cert.pem\", \"key.pem\", nil))\n}\n</code></pre>\n\n<p>Note that if you want your go server to listen on port 443 (default https port), you will either have to run it as root or use systemd to pass it the port.</p>\n\n<p>Example of running on port 443:</p>\n\n<ol>\n<li><p>Change the code to <code>log.Fatal(http.ListenAndServeTLS(\":443\", \"cert.pem\", \"key.pem\", nil))</code></p></li>\n<li><p><code>go build</code></p></li>\n<li><code>sudo ./your-package-name</code></li>\n<li>or if you don't want to run as root, you will have to chown cert.pem/key.pem as your user then run <code>setcap cap_net_bind_service=+ep your-package-name</code> then you will be able to listen on port 443/80 as a user.</li>\n</ol>\n\n<p>More details about using setcap: <a href=\"https://wiki.apache.org/httpd/NonRootPortBinding\" rel=\"nofollow\">https://wiki.apache.org/httpd/NonRootPortBinding</a></p>\n"}], "owner": {"reputation": 91, "user_id": 6257861, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd2ac0dcad2d5ec7f6a0465dc30da507?s=128&d=identicon&r=PG&f=1", "display_name": "mickdoe", "link": "https://stackoverflow.com/users/6257861/mickdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1461712648, "creation_date": 1461696364, "question_id": 36873304, "link": "https://stackoverflow.com/questions/36873304/do-i-need-to-use-nginx-or-apache-to-use-lets-encrypt", "title": "Do I need to use nginx or Apache to use Lets Encrypt?", "body": "<p>I have a <em>really</em> simple API based on golang that just listens at a path and responds accordingly with a database insert.</p>\n\n<p>I want to serve it over TLS/https using Lets Encrypt, but all the tutorials seem to indicate use of Apache or nginx as a requirement.</p>\n\n<p>I like keeping my server really light and haven't seen any need to introduce the overhead of these web servers (it's definitely not a full fledged website) and over http my go implementation works well.</p>\n\n<p>Is it possible to install it without Apache or nginx?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461697782, "post_id": 36873292, "comment_id": 61314044, "body": "You simply can&#39;t load balance at the transport layer, and have it distribute requests based on the session layer or higher. The load balancer must understand the protocol you expect it to load-balance."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461698130, "post_id": 36873292, "comment_id": 61314266, "body": "But if I loadbalance through http, won&#39;t that make some things much more complicated? Such as working with websockets?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461703121, "post_id": 36873292, "comment_id": 61317268, "body": "No, but if the client assumes the same server will respond within a single http/1.1 or http2 session it can cause problems (note, I&#39;m not sure offhand if either nginx or haproxy will distribute individual requests within a single session). In practice this is an artificial problem you&#39;ve created for yourself. If you have a system under enough load to matter, you usually have enough clients to have the load distributed evenly anyway."}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461696310, "creation_date": 1461696310, "question_id": 36873292, "link": "https://stackoverflow.com/questions/36873292/load-balancing-through-tcp-and-disabling-re-use-of-http-connection-on-go-servers", "title": "Load balancing through TCP and disabling re-use of HTTP connection on Go servers", "body": "<p>I am trying to find a way to load balance incoming requests on my Go servers. I have tried nginx, haproxy and some Go repositories on GitHub like:</p>\n\n<p><a href=\"https://github.com/darkhelmet/balance\" rel=\"nofollow\">https://github.com/darkhelmet/balance</a></p>\n\n<p>that allows you to do layer 4 load balancing through TCP.</p>\n\n<p>I have tried TCP load balancing through haproxy and through the darkhelmet/balance library. It seems like when I do load balancing through TCP, my connections are re used so every request from my PC gets sent to the same server. So it becomes hard for me to do benchmarks with for example the \"wrk\" benchmarking tool. And also other tests when I need to see if websocket connections on different go apps can communicate through a redis server via pub sub methods and so on.</p>\n\n<p>When I refresh the web browser I can see that all requests are sent to the same server, even tho I have 3 Go servers in the backend.</p>\n\n<p>Someone said this to me: \"Disable HTTP connection re-use on your web servers.\" But I do not know how to do this.</p>\n\n<p>The code I use for my go servers to benchmark is this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"strconv\"\n\n    \"github.com/julienschmidt/httprouter\"\n)\n\nfunc fib(n int) int {\n    if n == 0 {\n        return 0\n    } else if n == 1 {\n        return 1\n    } else {\n        return fib(n-1) + fib(n-2)\n    }\n}\n\nfunc main() {\n    router := httprouter.New()\n    router.GET(\"/\", toHandle(root))\n    router.GET(\"/fibonacci/:n\", toHandle(fibonacci))\n    log.Fatal(http.ListenAndServe(\":80\", router))\n}\n\ntype errHandle func(http.ResponseWriter, *http.Request, httprouter.Params) error\n\nfunc toHandle(eh errHandle) httprouter.Handle {\n    return func(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n        if err := eh(w, r, ps); err != nil {\n            log.Println(err)\n        }\n    }\n}\n\nfunc root(w http.ResponseWriter, r *http.Request, ps httprouter.Params) error {\n    w.Write([]byte(\"To the moon! goapp1\"))\n    return nil\n}\n\nfunc fibonacci(w http.ResponseWriter, r *http.Request, ps httprouter.Params) error {\n    n, err := strconv.Atoi(ps.ByName(\"n\"))\n    if err != nil {\n        return err\n    }\n    result := fib(n)\n    w.Write([]byte(fmt.Sprintf(\"result: %d\", result)))\n    return nil\n}\n</code></pre>\n\n<p>How can I achieve this? To be able to do roundrobin from the same client/ip/machine through tcp load balancing?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461688995, "post_id": 36870289, "comment_id": 61308798, "body": "It looks like you might be over-using channels. If the requests are already concurrent and each return a single type of result, why do you need even more goroutines and channels to receive the result?"}, {"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461690183, "post_id": 36870289, "comment_id": 61309509, "body": "That&#39;s the trick though, each returns a different type of result"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461690945, "post_id": 36870289, "comment_id": 61309954, "body": "You could assign the values in a closures: <a href=\"http://play.golang.org/p/Sak5QGCPZi\" rel=\"nofollow noreferrer\">play.golang.org/p/Sak5QGCPZi</a>, or you can do as suggested below and use  a generic interface{} to receive any type."}, {"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461691243, "post_id": 36870289, "comment_id": 61310122, "body": "Question about that: I thought you had to use channels instead of doing direct assignments inside of the goroutine. Is that not true?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461691608, "post_id": 36870289, "comment_id": 61310327, "body": "No, dispatching closures as goroutines is very idiomatic. You always have to ensure that you never have concurrent reads and writes, but here the WaitGroup provides synchronization."}], "answers": [{"comments": [{"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461690330, "post_id": 36870538, "comment_id": 61309589, "body": "I had considered a similar approach, but the problem I see is that this only waits for one of the responses to come back, not all of them. I was under the assumption that switch need to be in some kind of for loop with a way to know when that loop should break."}, {"owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "reply_to_user": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461691819, "post_id": 36870538, "comment_id": 61310454, "body": "@RossPeoples you can put the receive/switch code in a <code>for{}</code> loop if you need to receive more than one value."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461691910, "post_id": 36870538, "comment_id": 61310500, "body": "@RossPeoples, no need to wrap a switch around a for (unless you want to). <a href=\"https://golang.org/ref/spec#Break_statements\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Break_statements</a>: A &quot;break&quot; statement terminates execution of the innermost &quot;for&quot;, &quot;switch&quot;, or &quot;select&quot; statement within the same function."}, {"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461699523, "post_id": 36870538, "comment_id": 61315113, "body": "It&#39;s the for{} loop I&#39;m having trouble with. There&#39;s no way that I can see to tell it to break out of the loop. And using range on the channel doesn&#39;t work unless you close the channel, and I don&#39;t think there&#39;s an appropriate place to do that in this example."}], "tags": [], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "is_accepted": false, "score": 5, "last_activity_date": 1461688123, "last_edit_date": 1461688123, "creation_date": 1461687732, "answer_id": 36870538, "question_id": 36870289, "link": "https://stackoverflow.com/questions/36870289/goroutines-and-channels-with-multiple-types/36870538#36870538", "title": "Goroutines and Channels with Multiple Types", "body": "<p>You might find it easier to create a single channel of type <code>interface{}</code> which will allow you to send any value. Then, on the receiving end, you can perform a type assertion for a specific type:</p>\n\n<pre><code>c := make(chan interface{})\n\n/* Sending: */\nc &lt;- 42\nc &lt;- \"test\"\nc &lt;- &amp;ServicePlan{}\n\n/* Receiving */\nsomething := &lt;-c\nswitch v := something.(type) {\ncase int:          // do something with v as an int\ncase string:       // do something with v as a string\ncase *ServicePlan: // do something with v as an instance pointer\ndefault:\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461777530, "post_id": 36872874, "comment_id": 61357445, "body": "You are correct. Using multiple channels introduces several possible issues. I modified my answer to include a single channel version which worked well, but I think I&#39;m going to use the WaitGroup version now. Thanks for pointing out synchronous issue!"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1461695000, "creation_date": 1461695000, "answer_id": 36872874, "question_id": 36870289, "link": "https://stackoverflow.com/questions/36870289/goroutines-and-channels-with-multiple-types/36872874#36872874", "title": "Goroutines and Channels with Multiple Types", "body": "<p>You approach is quite meaningful with little disclaimer. In the end part your receive from channels sequentially</p>\n\n<pre><code>services := &lt;- c1\nservicePlans := &lt;- c2\nserviceInstances := &lt;- c3\nserviceBindings := &lt;- c4\n</code></pre>\n\n<p>but this make your code synchronous, because</p>\n\n<pre><code>go func() {\n    c2 &lt;- GetServicePlans(s)\n}()\n</code></pre>\n\n<p>can't write to c2 as long as opposite side would read, and it would not before <code>services := &lt;- c1</code> execute. So despite been in goroutines code will execute sequentially. Easiest way to make code more async is at least to provide buffered channels</p>\n\n<pre><code>c1 := make(chan map[string]Service, 1) //buffered channel with capacity one\n</code></pre>\n\n<p>which allow c1 &lt;- GetServices(s) do it's work and buffer result in channel.</p>\n"}, {"tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": false, "score": 0, "last_activity_date": 1461745496, "creation_date": 1461745496, "answer_id": 36884269, "question_id": 36870289, "link": "https://stackoverflow.com/questions/36870289/goroutines-and-channels-with-multiple-types/36884269#36884269", "title": "Goroutines and Channels with Multiple Types", "body": "<p>As an alternative to the <code>chan interface{]</code> approach, you might consider creating an envelope object (<code>APIObject</code> in the example below) to point to the true value that you wish to send. It comes with memory overheads, but also increased type-safety. (Comments and opinions weighing the two approach would be much appreciated.)</p>\n\n<p><a href=\"https://play.golang.org/p/1KIZ7Qfg43\" rel=\"nofollow\">https://play.golang.org/p/1KIZ7Qfg43</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Service struct{ Name string }\ntype ServicePlan struct{ Name string }\ntype Organization struct{ Name string }\n\ntype APIObject struct {\n    Service      *Service\n    ServicePlan  *ServicePlan\n    Organization *Organization\n}\n\nfunc main() {\n    objs := make(chan APIObject)\n\n    go func() {\n        objs &lt;- APIObject{Service: &amp;Service{\"Service-1\"}}\n        objs &lt;- APIObject{ServicePlan: &amp;ServicePlan{\"ServicePlan-1\"}}\n        objs &lt;- APIObject{Organization: &amp;Organization{\"Organization-1\"}}\n        close(objs)\n    }()\n\n    for obj := range objs {\n        if obj.Service != nil {\n            fmt.Printf(\"Service: %v\\n\", obj.Service)\n        }\n        if obj.ServicePlan != nil {\n            fmt.Printf(\"ServicePlan: %v\\n\", obj.ServicePlan)\n        }\n        if obj.Organization != nil {\n            fmt.Printf(\"Organization: %v\\n\", obj.Organization)\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "edited": false, "score": 0, "creation_date": 1461777423, "post_id": 36887437, "comment_id": 61357374, "body": "I think this is the most complete example I&#39;ve seen so far. I ended up using the WaitGroup example and it works perfectly."}, {"owner": {"reputation": 9249, "user_id": 456809, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a8e60ef50534769dba78843acf8bb82d?s=128&d=identicon&r=PG", "display_name": "Breedly", "link": "https://stackoverflow.com/users/456809/breedly"}, "edited": false, "score": 0, "creation_date": 1479870314, "post_id": 36887437, "comment_id": 68736413, "body": "I like the use of wait group here. Is there a way to repeat yourself less though? Like creating a slice of functions and then looping over them?"}], "tags": [], "owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "is_accepted": true, "score": 7, "last_activity_date": 1461753551, "creation_date": 1461753551, "answer_id": 36887437, "question_id": 36870289, "link": "https://stackoverflow.com/questions/36870289/goroutines-and-channels-with-multiple-types/36887437#36887437", "title": "Goroutines and Channels with Multiple Types", "body": "<p>When I see this, I think we may be conflating assignment with completion, thus creating one channel per type.</p>\n\n<p>It may be simpler to create one closure per type for assignment and a single channel to manage completion.</p>\n\n<p>example:</p>\n\n<pre><code>s := NewClient()\nc := make(chan bool)\n// I don't really know the types here\nvar services services\nvar servicePlans servicePlans\nvar serviceInstances serviceInstances\nvar serviceBindings serviceInstances\nvar orgs orgs\nvar spaces spaces\n\ngo func() {\n    service = GetServices(s)\n    c &lt;- true\n}()\n\ngo func() {\n    servicePlans = GetServicePlans(s)\n    c &lt;- true\n}()\n\ngo func() {\n    serviceInstances = GetServiceInstances(s)\n    c &lt;- true\n}()\n\ngo func() {\n    serviceBindings = GetServiceBindings(s)\n    c &lt;- true\n}()\n\ngo func() {\n    orgs = GetOrganizations(s)\n    c &lt;- true\n}()\n\ngo func() {\n    spaces = GetSpaces(s)\n    c &lt;- true\n}()\n\nfor i = 0; i &lt; 6; i++ {\n    &lt;-c\n}\n// stitch all the data together later\n</code></pre>\n\n<p>The Go authors anticipated this use-case, and provide the sync.WaitGroup which makes this a little clearer <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\">sync.WaitGroup Docs</a> Underneath it is fancy atomic operations which replace the channel synchronization.</p>\n\n<p>example:</p>\n\n<pre><code>s := NewClient()\n// again, not sure of the types here\nvar services services\nvar servicePlans servicePlans\nvar serviceInstances serviceInstances\nvar serviceBindings serviceInstances\nvar orgs orgs\nvar spaces spaces\n\nvar wg sync.WaitGroup\nwg.Add(6)\n\ngo func() {\n    service = GetServices(s)\n    wg.Done()\n}()\n\ngo func() {\n    servicePlans = GetServicePlans(s)\n    wg.Done()\n}()\n\ngo func() {\n    serviceInstances = GetServiceInstances(s)\n    wg.Done()\n}()\n\ngo func() {\n    serviceBindings = GetServiceBindings(s)\n    wg.Done()\n}()\n\ngo func() {\n    orgs = GetOrganizations(s)\n    wg.Done()\n}()\n\ngo func() {\n    spaces = GetSpaces(s)\n    wg.Done()\n}()\n\n// blocks until all six complete\nwg.Wait()\n// stitch all the data together later\n</code></pre>\n\n<p>I hope this is helps.</p>\n"}], "owner": {"reputation": 833, "user_id": 156588, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d4524e43c305a26aeddfb5ed6fef2baa?s=128&d=identicon&r=PG", "display_name": "Ross Peoples", "link": "https://stackoverflow.com/users/156588/ross-peoples"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4011, "favorite_count": 1, "accepted_answer_id": 36887437, "answer_count": 4, "score": 5, "last_activity_date": 1461759122, "creation_date": 1461686953, "last_edit_date": 1461759122, "question_id": 36870289, "link": "https://stackoverflow.com/questions/36870289/goroutines-and-channels-with-multiple-types", "title": "Goroutines and Channels with Multiple Types", "body": "<p>I'm relatively new to Go and trying to figure out the best way to concurrently pull information from a <code>REST API</code>. The intent is to make multiple concurrent calls to an <code>API</code>, with each call returning a different type of data.</p>\n\n<p>I currently have:</p>\n\n<pre><code>s := NewClient()\nc1 := make(chan map[string]Service)\nc2 := make(chan map[string]ServicePlan)\nc3 := make(chan map[string]ServiceInstance)\nc4 := make(chan map[string]ServiceBinding)\nc5 := make(chan map[string]Organization)\nc6 := make(chan map[string]Space)\n\ngo func() {\n    c1 &lt;- GetServices(s)\n}()\n\ngo func() {\n    c2 &lt;- GetServicePlans(s)\n}()\n\ngo func() {\n    c3 &lt;- GetServiceInstances(s)\n}()\n\ngo func() {\n    c4 &lt;- GetServiceBindings(s)\n}()\n\ngo func() {\n    c5 &lt;- GetOrganizations(s)\n}()\n\ngo func() {\n    c6 &lt;- GetSpaces(s)\n}()\n\nservices := &lt;- c1\nservicePlans := &lt;- c2\nserviceInstances := &lt;- c3\nserviceBindings := &lt;- c4\norgs := &lt;- c5\nspaces := &lt;- c6\n// stitch all the data together later\n</code></pre>\n\n<p>but I was wondering if there was a better way to write this.</p>\n\n<p>EDIT: It's still ugly, but reduced the number of channels to one:</p>\n\n<pre><code>c := make(chan interface{})\n\nvar (\n    services     map[string]Service\n    servicePlans     map[string]ServicePlan\n    serviceInstances map[string]ServiceInstance\n    serviceBindings  map[string]ServiceBinding\n    orgs         map[string]Organization\n    spaces       map[string]Space\n)\n\ngo func() {\n    c &lt;- GetServices(s)\n}()\n\ngo func() {\n    c &lt;- GetServicePlans(s)\n}()\n\ngo func() {\n    c &lt;- GetServiceInstances(s)\n}()\n\ngo func() {\n    c &lt;- GetServiceBindings(s)\n}()\n\ngo func() {\n    c &lt;- GetOrganizations(s)\n}()\n\ngo func() {\n    c &lt;- GetSpaces(s)\n}()\n\nfor i := 0; i &lt; 6; i++ {\n    v := &lt;-c\n    switch v := v.(type) {\n    case map[string]Service:\n        services = v\n    case map[string]ServicePlan:\n        servicePlans = v\n    case map[string]ServiceInstance:\n        serviceInstances = v\n    case map[string]ServiceBinding:\n        serviceBindings = v\n    case map[string]Organization:\n        orgs = v\n    case map[string]Space:\n        spaces = v\n    }\n}\n</code></pre>\n\n<p>I would still really like a way to do this so I don't have to hard-code that the loop needs to run 6 times. I actually tried make a list of functions to run and doing it that way to remove the repetitive <code>go func</code> calls, but since all the functions have different return types, I got all type mismatch errors, and you can't fake it by using <code>func(api) interface{}</code> either as that just creates a runtime panic.</p>\n"}, {"tags": ["go", "llvm", "jit"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1461686955, "post_id": 36870139, "comment_id": 61307536, "body": "Haskell provides a way to export code as C functions, and because of that it is possible to call Haskell back from anything, including LLVM. Does Go have such feature?"}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1461687045, "post_id": 36870139, "comment_id": 61307586, "body": "@arrowd My understanding is that CGo provides this (while the native Go implementation doesn&#39;t, as it uses its own calling convention). That&#39;s a step in the right direction, but I&#39;m still not certain how to actually call that function from LLVM."}], "answers": [{"comments": [{"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "edited": false, "score": 0, "creation_date": 1461688204, "post_id": 36870462, "comment_id": 61308333, "body": "Thanks! I&#39;m still hoping someone will come up with a simple end-to-end LLVM example (in part because I&#39;m sure I won&#39;t be the last person to ask this), though."}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "edited": false, "score": 0, "creation_date": 1461700631, "post_id": 36870462, "comment_id": 61315791, "body": "Incidentally, the LLVM bindings for go don&#39;t have <code>CallInst</code>; is there something equivalent to that I should be looking for?"}, {"owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "edited": false, "score": 0, "creation_date": 1461701833, "post_id": 36870462, "comment_id": 61316491, "body": "So, unfortunately this doesn&#39;t seem to work - see my update to the post."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 3, "last_activity_date": 1461687809, "last_edit_date": 1495539922, "creation_date": 1461687495, "answer_id": 36870462, "question_id": 36870139, "link": "https://stackoverflow.com/questions/36870139/how-can-jited-llvm-code-call-back-into-a-go-function/36870462#36870462", "title": "How can JITed LLVM code call back into a Go function?", "body": "<p>According to <a href=\"https://stackoverflow.com/questions/6125683/call-go-functions-from-c\">this answer</a> you can export Go functions as C ones by adding \"export\" comment. If you do this for your function, the LLVM JIT should be able to resolve this symbol during runtime linking. The answer didn't provide the C code which calls that exported function, but assuming it would be just <code>goProgressCB(args);</code> then you can create a <code>CallInst</code> to this function and JIT it.</p>\n\n<p><strong>Updated.</strong></p>\n\n<p>Take a look at <a href=\"https://stackoverflow.com/questions/32215509/using-go-code-in-an-existing-c-project\">this answer</a>. It seems that recent Go can generate C headers for you to call Go back. With this you can compile them with <code>clang -S -emit-llvm</code> or <code>clang -march=cpp</code> and obtain textual IR or C++ calls to the LLVM API that would make up call instructions.</p>\n"}, {"tags": [], "owner": {"reputation": 6576, "user_id": 547452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e47ab60c72fc978e7bcfaf7b22f479b?s=128&d=identicon&r=PG", "display_name": "axw", "link": "https://stackoverflow.com/users/547452/axw"}, "is_accepted": true, "score": 2, "last_activity_date": 1461718914, "creation_date": 1461718914, "answer_id": 36878491, "question_id": 36870139, "link": "https://stackoverflow.com/questions/36870139/how-can-jited-llvm-code-call-back-into-a-go-function/36878491#36878491", "title": "How can JITed LLVM code call back into a Go function?", "body": "<p>The main problem is that you're not actually using the JIT here, you're using the interpreter. <code>llvm.NewExecutionEngine</code> will construct a JIT compiler if it is available, and fall back to the interpreter otherwise.</p>\n\n<p>You should use <code>llvm.NewMCJITCompiler</code>. This will fail without additional changes, for the same reason why NewExecutionEngine did not yield a JIT in the first place. You need to add the following to your \"func main()\":</p>\n\n<pre><code>llvm.LinkInMCJIT()               \nllvm.InitializeNativeTarget()    \nllvm.InitializeNativeAsmPrinter()\n</code></pre>\n\n<p>Another, smaller, issue with your code is that (lack of) whitespace is important in the \"//export\" magic.</p>\n"}], "owner": {"reputation": 98901, "user_id": 12030, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dc69af7dd7151a00843602888638fabb?s=128&d=identicon&r=PG", "display_name": "Nick Johnson", "link": "https://stackoverflow.com/users/12030/nick-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 1, "accepted_answer_id": 36878491, "answer_count": 2, "score": 4, "last_activity_date": 1461718914, "creation_date": 1461686547, "last_edit_date": 1461701805, "question_id": 36870139, "link": "https://stackoverflow.com/questions/36870139/how-can-jited-llvm-code-call-back-into-a-go-function", "title": "How can JITed LLVM code call back into a Go function?", "body": "<p>I'm writing code to generate LLVM bytecode from a custom VM bytecode using the <a href=\"https://godoc.org/llvm.org/llvm/bindings/go/llvm\" rel=\"nofollow\">LLVM Go bindings</a>; the code is then JITed and executed in-process.</p>\n\n<p>The custom VM bytecode has several operations that can't be implemented directly in LLVM, because they require changing external state; the functionality for these opcodes is implemented as Go functions.</p>\n\n<p>There are <a href=\"https://blog.felixangell.com/an-introduction-to-llvm-in-go/\" rel=\"nofollow\">excellent guides</a> on getting started with generating LLVM bytecode from Go, but none address the issue of callbacks or exported functions. Is it possible to generate LLVM instructions to call back into the Go functions? If so, how?</p>\n\n<p>I've tried the way described below by @arrowd, and it doesn't appear to work. Source code, adapted from Felix Angell's blog post:</p>\n\n<pre><code>package main\n\nimport (\n    \"C\"\n    \"fmt\"\n    \"llvm.org/llvm/final/bindings/go/llvm\"\n)\n\n// export AddInts\nfunc AddInts(arg1, arg2 int) int {\n    return arg1 + arg2;\n}\n\nfunc main() {\n    // setup our builder and module\n    builder := llvm.NewBuilder()\n    mod := llvm.NewModule(\"my_module\")\n\n    // create our function prologue\n    main := llvm.FunctionType(llvm.Int32Type(), []llvm.Type{}, false)\n    llvm.AddFunction(mod, \"main\", main)\n    block := llvm.AddBasicBlock(mod.NamedFunction(\"main\"), \"entry\")\n    builder.SetInsertPoint(block, block.FirstInstruction())\n\n    // int a = 32\n    a := builder.CreateAlloca(llvm.Int32Type(), \"a\")\n    builder.CreateStore(llvm.ConstInt(llvm.Int32Type(), 32, false), a)\n\n    // int b = 16\n    b := builder.CreateAlloca(llvm.Int32Type(), \"b\")\n    builder.CreateStore(llvm.ConstInt(llvm.Int32Type(), 16, false), b)\n\n    // return a + b\n    bVal := builder.CreateLoad(b, \"b_val\")\n    aVal := builder.CreateLoad(a, \"a_val\")\n    addIntsType := llvm.FunctionType(llvm.Int32Type(), []llvm.Type{llvm.Int32Type(), llvm.Int32Type()}, false)\n    addInts := llvm.AddFunction(mod, \"AddInts\", addIntsType)\n    call := builder.CreateCall(addInts, []llvm.Value{aVal, bVal}, \"AddInts\")\n    builder.CreateRet(call)\n\n    // verify it's all good\n    if ok := llvm.VerifyModule(mod, llvm.ReturnStatusAction); ok != nil {\n        fmt.Println(ok.Error())\n    }\n    mod.Dump()\n\n    // create our exe engine\n    engine, err := llvm.NewExecutionEngine(mod)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n\n    // run the function!\n    funcResult := engine.RunFunction(mod.NamedFunction(\"main\"), []llvm.GenericValue{})\n    fmt.Printf(\"%d\\n\", funcResult.Int(false))\n}\n</code></pre>\n\n<p>Returns:</p>\n\n<pre><code>; ModuleID = 'my_module'\n\ndefine i32 @main() {\nentry:\n  %a = alloca i32\n  store i32 32, i32* %a\n  %b = alloca i32\n  store i32 16, i32* %b\n  %b_val = load i32* %b\n  %a_val = load i32* %a\n  %AddInts = call i32 @AddInts(i32 %a_val, i32 %b_val)\n  ret i32 %AddInts\n}\n\ndeclare i32 @AddInts(i32, i32)\nLLVM ERROR: Tried to execute an unknown external function: AddInts\nexit status 1\n</code></pre>\n"}, {"tags": ["go", "gradle", "makefile"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1461682422, "post_id": 36866958, "comment_id": 61304298, "body": "erm, what&#39;s wrong with a simple <code>run.sh</code> that does that?"}, {"owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461739095, "post_id": 36866958, "comment_id": 61329486, "body": "Have java and go projects in my repository and needed a common build mechanism.Chose gradle because of its advantages."}], "answers": [{"tags": [], "owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "is_accepted": false, "score": 1, "last_activity_date": 1461757110, "creation_date": 1461757110, "answer_id": 36888688, "question_id": 36866958, "link": "https://stackoverflow.com/questions/36866958/makefile-to-gradle-conversion-for-golang-application/36888688#36888688", "title": "Makefile to gradle conversion for golang application", "body": "<p>As far as I have checked, there is no direct plugin that could do this task. As a workaround, the build execution could be written as seperate tasks in gradle and ordered accordingly. Tasks here would contain setting Go path, installing dependencies and building the application and would be run as command line process in Gradle. Gradle provides support to run command line processes as described in <a href=\"https://docs.gradle.org/current/dsl/org.gradle.api.tasks.Exec.html\" rel=\"nofollow\">gradle documentation</a>. Hope it helps.</p>\n"}], "owner": {"reputation": 2432, "user_id": 1089226, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/06a2bf4d1a7d9eed5a2ed61c7440c2bf?s=128&d=identicon&r=PG", "display_name": "Poppy", "link": "https://stackoverflow.com/users/1089226/poppy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461757110, "creation_date": 1461678653, "question_id": 36866958, "link": "https://stackoverflow.com/questions/36866958/makefile-to-gradle-conversion-for-golang-application", "title": "Makefile to gradle conversion for golang application", "body": "<p>I have a go lang application which exposes a rest API and logs the information to DB. I am trying to convert the make file to gradle build. Is there any default way similar to maven2gradle plugin or the gradle build file should be written manually? I checked the syntactical differences between gradle and make file but still not clear about passing run time arguments to gradle that is similar to </p>\n\n<pre><code>run:build\n./hello -conf=/apps/content/properties/prop.json -v=0 -logDest=\"FILE\" -log_dir=\"/var/log/logdir\"\n</code></pre>\n\n<p>hello is my executable and others are the runtime arguments. This is my first attempt in migrating make to gradle and I couldnt find any clear documentation. Please help. </p>\n"}, {"tags": ["android", "go", "chat", "twilio"], "comments": [{"owner": {"reputation": 1952, "user_id": 1642002, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/9786105ef0bd24cf2f599a6a139f8784?s=128&d=identicon&r=PG", "display_name": "regretoverflow", "link": "https://stackoverflow.com/users/1642002/regretoverflow"}, "edited": false, "score": 1, "creation_date": 1461676244, "post_id": 36865713, "comment_id": 61298997, "body": "You can generate the token on the client or the server, If your server is the only thing connecting to Twilio, then YOU have to auth with Twilio. If your users are required to have their own Twilio account, then you will need to generate the token using their Twilio API key and credentials. The link you posted shows you exactly how to do it."}], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 3547678, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a75ebcf585241176e068071ba89c61?s=128&d=identicon&r=PG&f=1", "display_name": "Kaustubh", "link": "https://stackoverflow.com/users/3547678/kaustubh"}, "edited": false, "score": 1, "creation_date": 1461735189, "post_id": 36870973, "comment_id": 61327658, "body": "not able to find the REST API end point for granting the access. As my server is in Golang, I need to grant the access to my token explicitly using REST API call. Twilio does not have official go sdk hence I am not able to grant the access to my token."}], "tags": [], "owner": {"reputation": 3663, "user_id": 5216973, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9lXDE.jpg?s=128&g=1", "display_name": "Megan Speir", "link": "https://stackoverflow.com/users/5216973/megan-speir"}, "is_accepted": false, "score": 0, "last_activity_date": 1461689117, "creation_date": 1461689117, "answer_id": 36870973, "question_id": 36865713, "link": "https://stackoverflow.com/questions/36865713/twilio-grant-access-token-and-capability-token/36870973#36870973", "title": "Twilio Grant access token and capability token", "body": "<p><a href=\"https://www.twilio.com/docs/api/client/capability-tokens\" rel=\"nofollow\">Capability tokens</a> sign communications from devices to Twilio and they are typically used with Twilio Client. </p>\n\n<p>Access Tokens should be used to authenticate SDKS for Video and IP Messaging and you can see <a href=\"https://www.twilio.com/docs/api/rest/access-tokens\" rel=\"nofollow\">this page</a> for the REST API reference.</p>\n"}, {"tags": [], "owner": {"reputation": 282, "user_id": 7521151, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-w9CcBjt_72k/AAAAAAAAAAI/AAAAAAAAABo/XAJV4LNwUp4/photo.jpg?sz=128", "display_name": "Adeeb karim", "link": "https://stackoverflow.com/users/7521151/adeeb-karim"}, "is_accepted": false, "score": 0, "last_activity_date": 1523433661, "creation_date": 1523433661, "answer_id": 49769633, "question_id": 36865713, "link": "https://stackoverflow.com/questions/36865713/twilio-grant-access-token-and-capability-token/49769633#49769633", "title": "Twilio Grant access token and capability token", "body": "<p>Access Tokens are different from the Capability Tokens used in the previous versions of Twilio Client. Using a Capability Token in the Programmable Voice SDK will not work. Access Tokens, just like Capability Tokens before, are JWT tokens, but are using a new, more flexible format that is used across all the new Twilio SDKs.</p>\n\n<p><a href=\"https://www.twilio.com/docs/voice/voip-sdk\" rel=\"nofollow noreferrer\">https://www.twilio.com/docs/voice/voip-sdk</a></p>\n"}], "owner": {"reputation": 633, "user_id": 3547678, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/17a75ebcf585241176e068071ba89c61?s=128&d=identicon&r=PG&f=1", "display_name": "Kaustubh", "link": "https://stackoverflow.com/users/3547678/kaustubh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1330, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1523433661, "creation_date": 1461675638, "question_id": 36865713, "link": "https://stackoverflow.com/questions/36865713/twilio-grant-access-token-and-capability-token", "title": "Twilio Grant access token and capability token", "body": "<p>I am developing a chat app in Android using Twilio. I went through <a href=\"https://www.twilio.com/docs/api/ip-messaging/guides/identity\" rel=\"nofollow\">this</a> link. If I am not mistaken then; to do chatting, a server must send a token to a client. Once client get's that token then he is ready to initialize Twilio SDK and do chat after that.</p>\n\n<p>My server is written in go-lang, so thought of using my existing login system. Just wondered, how can I grant the access to the token generated by my server? I did not see any REST API for granting the access for that token.</p>\n\n<p>Also when I went through the example given by Twilio, they have used capability token. How a capability token is different from access token?</p>\n"}, {"tags": ["go", "ginkgo", "gomega"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1461676868, "post_id": 36865409, "comment_id": 61299474, "body": "&quot;exec.Command(your cmd).Stdin = ReaderWhichYouWantToReadInput&quot; will not suite?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461677137, "post_id": 36865409, "comment_id": 61299689, "body": "If it&#39;s looking for a tty, have you tried connecting it you your stdin?"}], "owner": {"reputation": 11590, "user_id": 774395, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/468lE.jpg?s=128&g=1", "display_name": "EngineerBetter_DJ", "link": "https://stackoverflow.com/users/774395/engineerbetter-dj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1461674807, "creation_date": 1461674807, "question_id": 36865409, "link": "https://stackoverflow.com/questions/36865409/provide-terminal-input-to-gexec-session", "title": "Provide Terminal Input to `gexec.Session`", "body": "<p>I need to provide input to an <code>exec.Command</code> that is started by Gomega's <code>gexec.Session</code>.</p>\n\n<p>The command I'm executing is currently complaining that \"stty: stdin isn't a terminal\". How can I provide input to the spawned process that looks like it comes from a terminal?</p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1461696588, "post_id": 36868843, "comment_id": 61313383, "body": "@RogerAlsing I&#39;d like to point out that while this works it&#39;d be extremely slow and over-engineered and shouldn&#39;t be used in any real project."}, {"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 1, "creation_date": 1461698719, "post_id": 36868843, "comment_id": 61314634, "body": "Yes, I get that, the best solution would be to have protoc generate immutable structs.. but it was still interesting to see that it was possible."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1461683247, "creation_date": 1461683247, "answer_id": 36868843, "question_id": 36864450, "link": "https://stackoverflow.com/questions/36864450/cast-boxed-struct-to-boxed-pointer-golang/36868843#36868843", "title": "Cast boxed struct to boxed pointer - golang", "body": "<p>Normally, you can't take the address of a value which means you can't simply convert the interface{} to a pointer to satisfy Protobuf's requirement.</p>\n\n<p>That said, you can dynamically create a new pointer then copy the value in to that then pass the newly allocated pointer to protobuf.</p>\n\n<p>Here's an <a href=\"http://play.golang.org/p/Zi24m1tYxv\" rel=\"nofollow\">example on Play</a></p>\n\n<p>The value -> pointer conversion is:</p>\n\n<pre><code>func mkPointer(i interface{}) interface{} {\n    val := reflect.ValueOf(i)\n    if val.Kind() == reflect.Ptr {\n        return i\n    }\n    if val.CanAddr() {\n        return val.Addr().Interface()\n    }\n    nv := reflect.New(reflect.TypeOf(i))\n    nv.Elem().Set(val)\n    return nv.Interface()\n}\n</code></pre>\n\n<ul>\n<li>We first see if it's a pointer, if so, just return the value. </li>\n<li>Then we check to see if it's addressable and return that.</li>\n<li>Lastly, we make a new instance of the type and copy the contents to that and return it.</li>\n</ul>\n\n<p>Since this this copies the data, it may not be practical for your purposes.  It will all depend on size of message and expected rate of calling with a value (as that will generate more garbage).</p>\n"}], "owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 36868843, "answer_count": 1, "score": 0, "last_activity_date": 1461683247, "creation_date": 1461672281, "last_edit_date": 1461678933, "question_id": 36864450, "link": "https://stackoverflow.com/questions/36864450/cast-boxed-struct-to-boxed-pointer-golang", "title": "Cast boxed struct to boxed pointer - golang", "body": "<p>I'm using Protobuf for Golang.\nProtobuf generates message types where type pointer implements <code>proto.Message()</code>.\ne.g.</p>\n\n<pre><code>func (*SomeMessage) Message() {}\n</code></pre>\n\n<p>The protobuf lib have methods like <code>Marshal(proto.Message)</code></p>\n\n<p>Now to my actual issue.</p>\n\n<pre><code>message := SomeMessage {}\nSendMessage(&amp;message)\n\nfunc SendMessage(message interface{}) {\n   switch msg := message.(type) {\n      case proto.Message:\n          //send across the wire or whatever\n      default:\n          //non proto message, panic or whatever\n   }\n}\n</code></pre>\n\n<p>The above works fine.\nHowever, If I don't pass the message as a pointer, then the code in SendMessage will not match, as the interface is only implemented on the SomeMessage pointer, not on the value.</p>\n\n<p>What I would like to do is:</p>\n\n<pre><code>message := SomeMessage {}\nSendMessage(message) //pass by value\n//there are more stuff going on in my real code, but just trying to show the relevant parts\n\nfunc SendMessage(message interface{}) {\n   //match both pointer and value as proto.Message\n   //and then turn the value into a pointer so that\n   //other funcs or protobuf can consume it   \n\n   message = MagicallyTurnBoxedValueIntoBoxedStruct(message)       \n\n   switch msg := message.(type) {\n      case proto.Message:\n          //send across the wire or whatever\n      default:\n          //non proto message, panic or whatever\n   }\n}\n</code></pre>\n\n<p>preferably I'd like to be able to pass both as pointer and as value.\nThe reason why I want to pass by value, is that this can act as a poor mans isolation when passing messages across goroutines/threads etc.\n(in lack of immutability)</p>\n\n<p>All of this could probably be avoided if the protobuf generator generated allowed values to be treated as <code>proto.Message()</code> too.\nOr if there was some nicer way to do immutable messages.</p>\n\n<p>It's not super important,if its possible, cool, if its not, meh :-)</p>\n\n<p>[EDIT]</p>\n\n<p>If I have the reflect.Type of the message and the reflect.Type of the pointer type of the message. \nIs it somehow possible to create an instance of the pointer type pointing to the value using \"reflect\" ?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1461671477, "creation_date": 1461671477, "answer_id": 36864145, "question_id": 36863719, "link": "https://stackoverflow.com/questions/36863719/why-isnt-caller-seeing-new-data-in-slice/36864145#36864145", "title": "Why isn&#39;t caller seeing new data in slice?", "body": "<p>A slice contains a pointer to the backing array, length and capacity. The append built-in returns a new slice with a new length and possibly a new pointer to a reallocated backing array.</p>\n\n<p>Slices are passed by value. Changes to the slice in <code>getList</code> are not visible in the caller. Changes to the backing array are visible to the caller.</p>\n\n<p>A slice is called a reference type because a slice contains a pointer to the backing array.</p>\n"}], "owner": {"reputation": 2631, "user_id": 315445, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/oOGta.png?s=128&g=1", "display_name": "Null Head", "link": "https://stackoverflow.com/users/315445/null-head"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1461674751, "answer_count": 1, "score": -1, "last_activity_date": 1461671477, "creation_date": 1461670357, "last_edit_date": 1495535361, "question_id": 36863719, "link": "https://stackoverflow.com/questions/36863719/why-isnt-caller-seeing-new-data-in-slice", "closed_reason": "Duplicate", "title": "Why isn&#39;t caller seeing new data in slice?", "body": "<p>In the below code, why are both <code>fmt.Println(len(people))</code> printing <code>0</code>?\nAs pointed out here, <a href=\"https://stackoverflow.com/a/2441112/315445\">https://stackoverflow.com/a/2441112/315445</a>, and elsewhere, slice is reference type. Why isn't caller (main) seeing the updated data?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age string\n}\n\nfunc main() {\n    var people = make([]Person, 0)\n    fmt.Println(len(people))\n    getList(people)\n    fmt.Println(len(people))\n}\n\nfunc getList(people []Person) {\n    people = append(people, Person {\"Foo\", \"1\"})\n    people = append(people, Person {\"Bar\", \"2\"})\n}\n</code></pre>\n\n<p>But this works. So its not actually a <code>pass-by-reference</code>?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    name string\n    age string\n}\n\nfunc main() {\n    var people = make([]Person, 0)\n    fmt.Println(len(people))\n    people = getList(people)\n    fmt.Println(len(people))\n}\n\nfunc getList(people []Person) []Person {\n    people = append(people, Person {\"Foo\", \"1\"})\n    people = append(people, Person {\"Bar\", \"2\"})\n    return people\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1461667442, "post_id": 36862544, "comment_id": 61292419, "body": "Do you also have one or more mysterious files called one or more of A,B,C,D,E sitting in your current directory? On most systems a &quot;&gt;&quot; on the command line has a special meaning: &quot;send output to this file rather than to the console&quot;..."}, {"owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "reply_to_user": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "edited": false, "score": 0, "creation_date": 1461667648, "post_id": 36862544, "comment_id": 61292561, "body": "Yes, Whenever I run this File a file with name E is being created"}], "answers": [{"tags": [], "owner": {"reputation": 19025, "user_id": 599792, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7ce404c8d35df762a599cb5173f18456?s=128&d=identicon&r=PG", "display_name": "Gareth McCaughan", "link": "https://stackoverflow.com/users/599792/gareth-mccaughan"}, "is_accepted": true, "score": 4, "last_activity_date": 1461668152, "creation_date": 1461668152, "answer_id": 36862878, "question_id": 36862544, "link": "https://stackoverflow.com/questions/36862544/os-args-reads-only-some-data-thats-been-given-while-running-the-file-in-golang/36862878#36862878", "title": "os.Args reads only some data that&#39;s been given while running the file in golang", "body": "<p>The \">\" characters on your command line are being interpreted as <em>redirections</em> meaning \"send output to a file rather than to the console\".</p>\n\n<p>You should be able to stop this happening by quoting the command-line arguments in question. Exactly how you should do this depends on what OS you're on, what shell you're using if you're on a Unix-like OS, etc, but I would try putting double-quotes around that second argument, like this:</p>\n\n<pre><code>go run filename.go 3001-3005 \"1-&gt;A,2-&gt;B,3-&gt;C,4-&gt;D,5-&gt;E\"\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 5616775, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207829879888917/picture?type=large", "display_name": "Revanth Penugonda", "link": "https://stackoverflow.com/users/5616775/revanth-penugonda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1461674779, "accepted_answer_id": 36862878, "answer_count": 1, "score": 0, "last_activity_date": 1461668152, "creation_date": 1461667239, "last_edit_date": 1461667341, "question_id": 36862544, "link": "https://stackoverflow.com/questions/36862544/os-args-reads-only-some-data-thats-been-given-while-running-the-file-in-golang", "closed_reason": "Duplicate", "title": "os.Args reads only some data that&#39;s been given while running the file in golang", "body": "<p>My Program:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    inputs := os.Args[1:]\n    log.Print(inputs)\n}\n</code></pre>\n\n<p>When run with the command</p>\n\n<pre><code>go run filename.go 3001-3005 1-&gt;A,2-&gt;B,3-&gt;C,4-&gt;D,5-&gt;E\n</code></pre>\n\n<p>gives the output as <code>[3001-3005 1-,2-,3-,4-,5-]</code> instead of <code>[3001-3005 1-&gt;A,2-&gt;B,3-&gt;C,4-&gt;D,5-&gt;E]</code></p>\n"}, {"tags": ["c++", "c", "go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "is_accepted": true, "score": 0, "last_activity_date": 1462511091, "creation_date": 1462511091, "answer_id": 37064603, "question_id": 36861569, "link": "https://stackoverflow.com/questions/36861569/is-it-possible-to-export-wrap-a-complex-go-struct-to-c/37064603#37064603", "title": "Is it possible to export/wrap a complex Go struct to C?", "body": "<p>The way I ended up solving this, for lack of a better solution, was to use private global maps on the Go side (<a href=\"https://github.com/justinfx/gofileseq/blob/v2.1.0/cpp/export/storage.go#L34\" rel=\"nofollow\">ref</a>). These maps would associate instances of the Go objects with a random uint64 id, and the id would be returned to C++ as an \"opaque handle\". </p>\n\n<pre><code>type frameSetMap struct {\n    lock *sync.RWMutex\n    m    map[FrameSetId]*frameSetRef\n    rand idMaker\n}\n//...\nfunc (m *frameSetMap) Add(fset fileseq.FrameSet) FrameSetId {\n    // fmt.Printf(\"frameset Add %v as %v\\n\", fset.String(), id)\n    m.lock.Lock()\n    id := FrameSetId(m.rand.Uint64())\n    m.m[id] = &amp;frameSetRef{fset, 1}\n    m.lock.Unlock()\n    return id\n}\n</code></pre>\n\n<p>Then I use reference counting to determine when C++ no longer needs the object, and remove it from the map:</p>\n\n<pre><code>// Go\nfunc (m *frameSetMap) Incref(id FrameSetId) {\n    m.lock.RLock()\n    ref, ok := m.m[id]\n    m.lock.RUnlock()\n\n    if !ok {\n        return\n    }\n\n    atomic.AddUint32(&amp;ref.refs, 1)\n    // fmt.Printf(\"Incref %v to %d\\n\", ref, refs)\n}\n\nfunc (m *frameSetMap) Decref(id FrameSetId) {\n    m.lock.RLock()\n    ref, ok := m.m[id]\n    m.lock.RUnlock()\n\n    if !ok {\n        return\n    }\n\n    refs := atomic.AddUint32(&amp;ref.refs, ^uint32(0))\n    // fmt.Printf(\"Decref %v to %d\\n\", ref, refs)\n    if refs != 0 {\n        return\n    }\n\n    m.lock.Lock()\n    if atomic.LoadUint32(&amp;ref.refs) == 0 {\n        // fmt.Printf(\"Deleting %v\\n\", ref)\n        delete(m.m, id)\n    }\n    m.lock.Unlock()\n}\n\n//C++\nFileSequence::~FileSequence() {\n    if (m_valid) {\n//        std::cout &lt;&lt; \"FileSequence destroy \" &lt;&lt; m_id &lt;&lt; std::endl;\n        m_valid = false;\n        internal::FileSequence_Decref(m_id);\n        m_id = 0;\n        m_fsetId = 0;\n    }\n}\n</code></pre>\n\n<p>And all C++ interactions with the exported Go library communicate via the opaque handle:</p>\n\n<pre><code>// C++\nsize_t FileSequence::length() const {\n    return internal::FileSequence_Len(m_id);\n}\n</code></pre>\n\n<p>Unfortunately it does mean that in a multhreaded C++ environment, all threads would go through a mutex to the map. But it is only a write lock when objects are created and destroyed, and for all method calls on an object it is a read lock.</p>\n"}], "owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 0, "accepted_answer_id": 37064603, "answer_count": 1, "score": 0, "last_activity_date": 1463259304, "creation_date": 1461664786, "last_edit_date": 1463259304, "question_id": 36861569, "link": "https://stackoverflow.com/questions/36861569/is-it-possible-to-export-wrap-a-complex-go-struct-to-c", "title": "Is it possible to export/wrap a complex Go struct to C?", "body": "<p>I own a Go library, <a href=\"https://godoc.org/github.com/justinfx/gofileseq\" rel=\"nofollow\">gofileseq</a>, for which I would like to try and made a C/C++ binding. </p>\n\n<p>It is pretty straightforward to be able to export functions that use simple types (ints, strings, ...). It is even easy enough to export data from custom Go types to C by defining a C struct and translating the Go type to it, to be used in the exported functions, since you are allocating C memory to do it. But with the <a href=\"https://github.com/golang/go/issues/12416\" rel=\"nofollow\">go 1.5 cgo rules</a> I am finding it difficult to figure out how to export functionality from a more complex struct that stores state.</p>\n\n<p>Example of a struct from gofileseq that I would like to export somehow to a C++ binding:</p>\n\n<pre><code>// package fileseq\n//\n\ntype FrameSet struct {\n    frange   string\n    rangePtr *ranges.InclusiveRanges\n}\n\nfunc NewFrameSet(frange string) (*FrameSet, error) {\n    // bunch of processing to set up internal state\n}\n\nfunc (s *FrameSet) Len() int {\n    return s.rangePtr.Len()\n}\n\n// package ranges\n//\n\ntype InclusiveRanges struct {\n    blocks []*InclusiveRange\n}\n\ntype InclusiveRange struct {\n    start int\n    end   int\n    step  int\n\n    cachedEnd   int\n    isEndCached bool\n\n    cachedLen   int\n    isLenCached bool\n}\n</code></pre>\n\n<p>As you can see, the <a href=\"https://godoc.org/github.com/justinfx/gofileseq#FrameSet\" rel=\"nofollow\"><code>FrameSet</code></a> type that I want to expose contains a slice of pointers to an underlying type, each of which stores state. </p>\n\n<p>Ideally, I would love to be able to store a <code>void*</code> on a C++ class, and make it just a simple proxy for calling back into exported Go functions with the <code>void*</code>. But the cgo rules disallow C storing a Go pointer longer than the function call. And I am failing to see how I could use an approach of defining C++ classes that could be allocated and used to operate with my Go library. </p>\n\n<p>Is it possible to wrap complex types for exposure to C/C++? \nIs there a pattern that would allow a C++ client to create a Go <code>FrameSet</code>? </p>\n\n<p><em>Edit</em></p>\n\n<p>One idea I can think of would be to let C++ create objects in Go that get stored on the Go side in a static <code>map[int]*FrameSet</code> and then return the int id to C++. Then all the C++ operations make requests into Go with the id. Does that sound like a valid solution? </p>\n\n<p><em>Update</em></p>\n\n<p>For now, I am proceeding with testing a solution that uses global maps and unique ids to store objects. C++ would request a new object to be created and only get back an opaque id. Then they can call all of the methods exported as functions, using that id, including requesting for it to be destroyed when done. </p>\n\n<p>If there is a better approach than this, I would love to see an answer. Once I get a fully working prototype, I will add my own answer.</p>\n\n<p><em>Update #2</em></p>\n\n<p>I've written a blog post about the final solution that I ended up using: <a href=\"http://justinfx.com/2016/05/14/cpp-bindings-for-go/\" rel=\"nofollow\">http://justinfx.com/2016/05/14/cpp-bindings-for-go/</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "edited": false, "score": 0, "creation_date": 1461663900, "post_id": 36860898, "comment_id": 61289783, "body": "What problem do you what to solve with your program? Memory reducing techniques may be very different and depend on problem class."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 0, "creation_date": 1461664670, "post_id": 36860898, "comment_id": 61290374, "body": "Read file line by line. Recipe is here: <a href=\"http://stackoverflow.com/a/8758113/1975086\">stackoverflow.com/a/8758113/1975086</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "edited": false, "score": 1, "creation_date": 1461667112, "post_id": 36860898, "comment_id": 61292193, "body": "Do you need everything in memory at once? Can&#39;t you just process the file line-by-line as @AlexanderTrakhimenok suggested?"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 5437894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781ed71466772d288cee54c742cd6604?s=128&d=identicon&r=PG&f=1", "display_name": "rWick", "link": "https://stackoverflow.com/users/5437894/rwick"}, "edited": false, "score": 0, "creation_date": 1461666020, "post_id": 36861277, "comment_id": 61291427, "body": "Indeed, it&#39;s pretty useless, i had some validity check in that loop but i can postpone them.   I just tried, it get down to 1g9, not perfect but already better ! Thanks !"}], "tags": [], "owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "is_accepted": false, "score": 2, "last_activity_date": 1461664132, "creation_date": 1461664132, "answer_id": 36861277, "question_id": 36860898, "link": "https://stackoverflow.com/questions/36860898/how-to-reduce-memory-usage-of-string/36861277#36861277", "title": "How to reduce memory usage of []string?", "body": "<p>This seems pretty inefficient to me:</p>\n\n<pre><code>for _, value := range strings.Split(line[23:], \";\") {\n    row.Values = append(row.Values, value)\n}\n</code></pre>\n\n<p>You basically obtain a <code>[]string</code> by calling the <code>string.Split</code> function, and then loop over that slice to append every string to another initially nil string slice.</p>\n\n<p>Why not just do:</p>\n\n<pre><code>row.Values = strings.Split(line[23:], \";\")\n</code></pre>\n\n<p>instead ?</p>\n\n<p>Though I can't guarantee it, it might be possible that the loop causes each string to be copied, and therefore make your program use twice as memory as needed.</p>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5437894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781ed71466772d288cee54c742cd6604?s=128&d=identicon&r=PG&f=1", "display_name": "rWick", "link": "https://stackoverflow.com/users/5437894/rwick"}, "edited": false, "score": 1, "creation_date": 1461666447, "post_id": 36861332, "comment_id": 61291736, "body": "5 millions row, 10 column each"}], "tags": [], "owner": {"reputation": 47884, "user_id": 164234, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6b34a2a81515583dc95e5c0809db06bb?s=128&d=identicon&r=PG", "display_name": "Nick Craig-Wood", "link": "https://stackoverflow.com/users/164234/nick-craig-wood"}, "is_accepted": true, "score": 6, "last_activity_date": 1461669075, "last_edit_date": 1461669075, "creation_date": 1461664251, "answer_id": 36861332, "question_id": 36860898, "link": "https://stackoverflow.com/questions/36860898/how-to-reduce-memory-usage-of-string/36861332#36861332", "title": "How to reduce memory usage of []string?", "body": "<p>How many lines and fields are there in the file?</p>\n\n<p>It is plausible that what you are describing is using the minimum amount of memory.</p>\n\n<p>Looking at the code I think it will use 450MB of memory for the underlying string data.</p>\n\n<p>It will then slice that up into strings. These consist of a pointer and a length which take 16 bytes on a 64 bit platform.</p>\n\n<p>So 1.5GB/16 = 93Million.</p>\n\n<p>So if there are >50 Million fields in your file then the memory use seems reasonable.</p>\n\n<p>There are other overheads like number of rows etc so this isn't an exact calculation.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Given<br>\n5 millions row, 10 column each</p>\n\n<p>That is 50 million string headers of 16 bytes which will take 800MB. Plus the data itself 450MB, plus 5 * 8 * 5 million Rows = 200MB makes 1.45GB</p>\n\n<p>So I don't think even with perfect memory allocation, you'll be able to reduce the usage below 1.5GB.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1461664937, "creation_date": 1461664937, "answer_id": 36861622, "question_id": 36860898, "link": "https://stackoverflow.com/questions/36860898/how-to-reduce-memory-usage-of-string/36861622#36861622", "title": "How to reduce memory usage of []string?", "body": "<p>You are appending into a <code>Row</code> struct the values obtained by each iteration, which considering the huge file size is not a reasonable good approach. Why your are not processing the file in batches?</p>\n\n<p>Looking at the <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">Split</a> function it returns a slice of substrings, so it's not necessary to range over the resulted slices and append them into the <code>row.Values</code>. You can assign the resulted values directly to <code>row.Values</code>, then append it to the <code>rows</code> slice.</p>\n\n<pre><code>func Split(s, sep string) []string\n</code></pre>\n\n<blockquote>\n  <p>Split slices s into all substrings separated by sep and returns a\n  slice of the substrings between those separators. If sep is empty,\n  Split splits after each UTF-8 sequence. It is equivalent to SplitN\n  with a count of -1.</p>\n</blockquote>\n\n<pre><code>row.Values = strings.Split(line[23:], \";\")\nrows = append(rows, row)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 37, "user_id": 5437894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781ed71466772d288cee54c742cd6604?s=128&d=identicon&r=PG&f=1", "display_name": "rWick", "link": "https://stackoverflow.com/users/5437894/rwick"}, "edited": false, "score": 0, "creation_date": 1461681119, "post_id": 36865858, "comment_id": 61303158, "body": "I know the size of the file I use for my test,so I tried to set manually the capacity of each array, but with no big result ... So I guess it won&#39;t change much since i wasn&#39;t using the append but i&#39;ll try !"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1461675965, "creation_date": 1461675965, "answer_id": 36865858, "question_id": 36860898, "link": "https://stackoverflow.com/questions/36860898/how-to-reduce-memory-usage-of-string/36865858#36865858", "title": "How to reduce memory usage of []string?", "body": "<p>Seems to me it's about append() function. From language spec</p>\n\n<blockquote>\n  <p>If the capacity of s is not large enough to fit the additional values,\n  append allocates a new, sufficiently large underlying array</p>\n</blockquote>\n\n<p>Size of this newly allocated array can be sufficient enough to consume even more further appends. So to allocate precisely you should <code>slice := make([]Row, 0, WithExpectedCapacity)</code> and than assign <code>slice[n]=</code> instead of <code>append()</code>. If you can't do this, you at least can try reflection to compact</p>\n\n<pre><code>reflect.ValueOf(&amp;slice).Elem().SetCap(len(slice))\n</code></pre>\n\n<p>Some tricky, but you can see <a href=\"https://play.golang.org/p/LslkOBCvII\" rel=\"nofollow\">https://play.golang.org/p/LslkOBCvII</a> it works.</p>\n"}], "owner": {"reputation": 37, "user_id": 5437894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781ed71466772d288cee54c742cd6604?s=128&d=identicon&r=PG&f=1", "display_name": "rWick", "link": "https://stackoverflow.com/users/5437894/rwick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "accepted_answer_id": 36861332, "answer_count": 4, "score": 1, "last_activity_date": 1461675965, "creation_date": 1461663195, "last_edit_date": 1461666538, "question_id": 36860898, "link": "https://stackoverflow.com/questions/36860898/how-to-reduce-memory-usage-of-string", "title": "How to reduce memory usage of []string?", "body": "<p>Go is pretty new to me and i have some troubles understanding the memory usage :</p>\n\n<p>I want to load a file similar to csv into an array of rows, each row being a struct composed of a key on 22 char and an array of values (string).<br>\nMy code look like this : <a href=\"https://play.golang.org/p/hJ4SHjVXaG\" rel=\"nofollow\">https://play.golang.org/p/hJ4SHjVXaG</a></p>\n\n<p>Problem is that for a file of 450M it uses around 2G1 of memory.<br>\nDoes anyone have a solution to reduce that memory use ?</p>\n\n<p>Update using SirDarius solution : <a href=\"https://play.golang.org/p/DBmOFOkZdx\" rel=\"nofollow\">https://play.golang.org/p/DBmOFOkZdx</a> still use around 1G9</p>\n"}, {"tags": ["logging", "go", "fluentd"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1461659011, "last_edit_date": 1495542233, "creation_date": 1461658556, "answer_id": 36859118, "question_id": 36859042, "link": "https://stackoverflow.com/questions/36859042/fluentd-golang-logging-application-is-giving-error/36859118#36859118", "title": "Fluentd + golang Logging application is giving error", "body": "<p>The error is caused by this line:</p>\n\n<pre><code>error := logger.Post(tag,data)\n</code></pre>\n\n<p><code>data</code> is of type <code>Student</code>, it is your own struct type. It contains unexported fields (fields whose names start with lowercase letters). Unexported fields can only be accessed from the package in which the type is defined.</p>\n\n<p>So when the <code>fluent</code> package tries to access them (via reflection), you get a runtime panic as this is not allowed (<code>fluent</code> package is not your <code>main</code> package).</p>\n\n<p>Solution is simple: export the fields of the <code>Student</code> type:</p>\n\n<pre><code>type Student struct {\n    Name string\n    IdNo int\n    Age int\n}\n</code></pre>\n\n<p>Another alternative is to use a <code>map</code>, e.g.:</p>\n\n<pre><code>data := map[string]interface{}{\n    \"name\": \"John\",\n    \"id_no\": 1234,\n    \"age\": 25,\n}\n</code></pre>\n\n<p>The <code>struct</code> solution is more flexible though as you can \"remap\" or change how the fields will appear in the log with struct tags, e.g.:</p>\n\n<pre><code>type Student struct {\n    Name string `msg:\"name\"`\n    IdNo int    `msg:\"id_no\"`\n    Age int     `msg:\"age\"`\n}\n</code></pre>\n\n<p>Read this question+answers for more on struct tags:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go\">What are the use(s) for tags in Go?</a></p>\n\n<p>It is also covered in the <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">Spec: Struct types</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "edited": false, "score": 0, "creation_date": 1461663317, "post_id": 36859129, "comment_id": 61289356, "body": "Thanks Noval for your comment"}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 0, "last_activity_date": 1461658594, "creation_date": 1461658594, "answer_id": 36859129, "question_id": 36859042, "link": "https://stackoverflow.com/questions/36859042/fluentd-golang-logging-application-is-giving-error/36859129#36859129", "title": "Fluentd + golang Logging application is giving error", "body": "<p>All properties of struct <code>Student</code> need to be exported. Just change the first char to be uppercase, it'l work</p>\n\n<pre><code>type Student struct {\n    Name  string\n    Id_no int\n    Age   int\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 2514007, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/1dbdb537b79e8f0c15f535741539c500?s=128&d=identicon&r=PG", "display_name": "Mahesh Jadhav", "link": "https://stackoverflow.com/users/2514007/mahesh-jadhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 0, "accepted_answer_id": 36859118, "answer_count": 2, "score": 3, "last_activity_date": 1461659011, "creation_date": 1461658350, "question_id": 36859042, "link": "https://stackoverflow.com/questions/36859042/fluentd-golang-logging-application-is-giving-error", "title": "Fluentd + golang Logging application is giving error", "body": "<p>I am newbie to golang and fluentd. I am trying to build logging application using fluentd's logger library from github.com/fluent/fluent-logger-golang/fluent .</p>\n\n<p>On 192.168.0.106 fluentd service is running and listening on 24224</p>\n\n<p>Below is the program for logging in golang.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/fluent/fluent-logger-golang/fluent\"\n    \"fmt\"\n)\n\ntype Student struct {\n    name string\n    id_no int\n    age int\n}\n\nfunc main() {\n    logger,err :=fluent.New(fluent.Config{FluentHost:\"192.168.0.106\", FluentPort:24224})\n    fmt.Println(logger.BufferLimit)\n    if err != nil{\n        fmt.Println(\"error creating fluentd instance\")\n        return\n    }\n\n    defer logger.Close()\n    tag := \"fluentd-log-demo\"\n    data := Student{\"John\",1234,25}\n    error := logger.Post(tag,data)\n    if error != nil{\n        panic(error)\n    }\n}\n</code></pre>\n\n<p>I am getting lots of error after executing the binary file. </p>\n\n<pre><code>mahesh@ubuntu14:~/golang$ fluentd-log-demo\n8388608\npanic: reflect.Value.Interface: cannot return value obtained from unexported field or method\n\ngoroutine 1 [running]:\npanic(0x5674e0, 0xc82000a6f0)\n    /home/mahesh/gotools/src/runtime/panic.go:464 +0x3e6\nreflect.valueInterface(0x5674e0, 0xc820010300, 0xb8, 0x1, 0x0, 0x0)\n    /home/mahesh/gotools/src/reflect/value.go:919 +0xe7\nreflect.Value.Interface(0x5674e0, 0xc820010300, 0xb8, 0x0, 0x0)\n    /home/mahesh/gotools/src/reflect/value.go:908 +0x48\ngithub.com/fluent/fluent-logger-golang/fluent.(*Fluent).PostWithTime(0xc82007a000, 0x603120, 0x10, 0xeceb11576, 0x28abb08c, 0x6d7bc0, 0x5b2060, 0xc820010300, 0x0, 0x0)\n    /home/mahesh/golib/src/github.com/fluent/fluent-logger-golang/fluent/fluent.go:139 +0x315\ngithub.com/fluent/fluent-logger-golang/fluent.(*Fluent).Post(0xc82007a000, 0x603120, 0x10, 0x5b2060, 0xc820010300, 0x0, 0x0)\n    /home/mahesh/golib/src/github.com/fluent/fluent-logger-golang/fluent/fluent.go:116 +0x96\nmain.main()\n    /home/mahesh/golang/src/GoBasics/fluentd-log-demo/main.go:25 +0x39e\nmahesh@ubuntu14:~/golang$\n</code></pre>\n\n<p>Please help me in troubleshooting the issue.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "synchronization", "race-condition"], "answers": [{"comments": [{"owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "edited": false, "score": 0, "creation_date": 1461659680, "post_id": 36859096, "comment_id": 61286759, "body": "What if it isn&#39;t possible to lock the mutex before launching the goroutine? For example, there may be other goroutines calling Wait()."}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "reply_to_user": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "edited": false, "score": 0, "creation_date": 1461663870, "post_id": 36859096, "comment_id": 61289748, "body": "Than is possible, that when Broadcast is called, no other goroutine will be notified. It also fine - but what we both don&#39;t mentioned - usually condition is connected with some state. And Wait means - I cannot continue while system is in this state, wait. And Broadcast means - state is changed, everyone who has been waiting should check whether he can continue. Please describe more precisely what is computed in both goroutines, and why they have to communicate to each other."}, {"owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "edited": false, "score": 0, "creation_date": 1461687232, "post_id": 36859096, "comment_id": 61307711, "body": "Sorry, I should have gone into more detail in the original question. I&#39;ve added an edit that describes precisely what I&#39;m trying to do."}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 0, "creation_date": 1489324091, "post_id": 36859096, "comment_id": 72612226, "body": "I&#39;m trying to understand this and to me it looks like this introduces potential race condition. c.Wait() releases mutex, then it starts to wait for notification. The thing is, in theory, when c.Wait() releases mutex, but before it adds itself to notification list, goroutine can lock the mutex, and run Broadcast(), after that c.Wait() can add itself to notification list and wait forever for broadcast. Of course in above example it&#39;s almost never gonna happen because of time.Sleep before broadcast which gives plenty of time for c.Wait to add itself to notification list before Broadcast."}, {"owner": {"reputation": 3934, "user_id": 916440, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3f3495133a7d9411b0b4c04189ecf91?s=128&d=identicon&r=PG", "display_name": "Kamil Dziedzic", "link": "https://stackoverflow.com/users/916440/kamil-dziedzic"}, "edited": false, "score": 0, "creation_date": 1489324869, "post_id": 36859096, "comment_id": 72612464, "body": "wow, nvm, this got fixed in go 1.7 I was looking at old code: <a href=\"https://github.com/golang/go/issues/14064\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14064</a>"}], "tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 3, "last_activity_date": 1461658485, "creation_date": 1461658485, "answer_id": 36859096, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/36859096#36859096", "title": "How to correctly use sync.Cond?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    m := sync.Mutex{}\n    m.Lock() // main gouroutine is owner of lock\n    c := sync.NewCond(&amp;m)\n    go func() {\n        m.Lock() // obtain a lock\n        defer m.Unlock()\n        fmt.Println(\"3. goroutine is owner of lock\")\n        time.Sleep(2 * time.Second) // long computing - because you are the owner, you can change state variable(s)\n        c.Broadcast()               // State has been changed, publish it to waiting goroutines\n        fmt.Println(\"4. goroutine will release lock soon (deffered Unlock\")\n    }()\n    fmt.Println(\"1. main goroutine is owner of lock\")\n    time.Sleep(1 * time.Second) // initialization\n    fmt.Println(\"2. main goroutine is still lockek\")\n    c.Wait() // Wait temporarily release a mutex during wating and give opportunity to other goroutines to change the state.\n    // Because you don't know, whether this is state, that you are waiting for, is usually called in loop.\n    m.Unlock()\n    fmt.Println(\"Done\")\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/fBBwoL7_pm\" rel=\"nofollow\">http://play.golang.org/p/fBBwoL7_pm</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1461667190, "last_edit_date": 1461667190, "creation_date": 1461666457, "answer_id": 36862245, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/36862245#36862245", "title": "How to correctly use sync.Cond?", "body": "<p>Looks like you c.Wait for Broadcast which would never happens with your time intervals.\nWith</p>\n\n<pre><code>time.Sleep(3 * time.Second) //Broadcast after any Wait for it\nc.Broadcast()\n</code></pre>\n\n<p>your snippet seems to work <a href=\"http://play.golang.org/p/OE8aP4i6gY\" rel=\"nofollow\">http://play.golang.org/p/OE8aP4i6gY</a> .Or am I missing something that you try to achive?</p>\n"}, {"comments": [{"owner": {"reputation": 464, "user_id": 1030157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PXY86.png?s=128&g=1", "display_name": "Hermes", "link": "https://stackoverflow.com/users/1030157/hermes"}, "edited": false, "score": 0, "creation_date": 1555599085, "post_id": 37064343, "comment_id": 98174006, "body": "For such purpose consider using <code>sync.RWMutex</code> instead."}], "tags": [], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "is_accepted": true, "score": 1, "last_activity_date": 1462509474, "creation_date": 1462509474, "answer_id": 37064343, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/37064343#37064343", "title": "How to correctly use sync.Cond?", "body": "<p>I finally discovered a way to do this and it doesn't involve <code>sync.Cond</code> at all - just the mutex.</p>\n\n<pre><code>type Task struct {\n    m       sync.Mutex\n    headers http.Header\n}\n\nfunc NewTask() *Task {\n    t := &amp;Task{}\n    t.m.Lock()\n    go func() {\n        defer t.m.Unlock()\n        // ...do stuff...\n    }()\n    return t\n}\n\nfunc (t *Task) WaitFor() http.Header {\n    t.m.Lock()\n    defer t.m.Unlock()\n    return t.headers\n}\n</code></pre>\n\n<p>How does this work?</p>\n\n<p>The mutex is locked at the beginning of the task, ensuring that anything calling <code>WaitFor()</code> will block. Once the headers are available and the mutex unlocked by the goroutine, each call to <code>WaitFor()</code> will execute one at a time. All future calls (even after the goroutine ends) will have no problem locking the mutex, since it will always be left unlocked.</p>\n"}, {"comments": [{"owner": {"reputation": 1195, "user_id": 2317369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ea03f26f205911ccad17bd4fcf7fcb?s=128&d=identicon&r=PG", "display_name": "cpr4t3s", "link": "https://stackoverflow.com/users/2317369/cpr4t3s"}, "edited": false, "score": 2, "creation_date": 1550008644, "post_id": 42772799, "comment_id": 96110086, "body": "not sure if those for loops are really needed. I know the documentation suggests something like that but, it seems unnecessary. An if should suffice since it change sharedRsc in the possession of the lock and as stated by the documentation, the Wait only resumes after a call to Broadcast or Signal"}, {"owner": {"reputation": 401, "user_id": 3958082, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/653748984/picture?type=large", "display_name": "Drew O&#39;Meara", "link": "https://stackoverflow.com/users/3958082/drew-omeara"}, "reply_to_user": {"reputation": 1195, "user_id": 2317369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ea03f26f205911ccad17bd4fcf7fcb?s=128&d=identicon&r=PG", "display_name": "cpr4t3s", "link": "https://stackoverflow.com/users/2317369/cpr4t3s"}, "edited": false, "score": 1, "creation_date": 1554933094, "post_id": 42772799, "comment_id": 97936579, "body": "@cpr4t3s In this example, sure.  In general, it&#39;s good habit/practice since, in a Broadcast() scenario, the first goroutine wakes, changes state, and then the others resume (with the shared state now altered).  I agree with you and are absolutely correct in cases where it is not possible for any one of the waiting goroutines to affect the dependent condition(s)."}], "tags": [], "owner": {"reputation": 3172, "user_id": 1290581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/22cb75bc69d807d5597d7b9922a3775c?s=128&d=identicon&r=PG", "display_name": "garbagecollector", "link": "https://stackoverflow.com/users/1290581/garbagecollector"}, "is_accepted": false, "score": 31, "last_activity_date": 1489437120, "last_edit_date": 1489437120, "creation_date": 1489436758, "answer_id": 42772799, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/42772799#42772799", "title": "How to correctly use sync.Cond?", "body": "<p>OP answered his own, but did not directly answer the original question, I am going to post how to correctly use <code>sync.Cond</code>.</p>\n\n<p>You do not really need <code>sync.Cond</code> if you have one goroutine for each write and read - a single <code>sync.Mutex</code> would suffice to communicate between them.  <code>sync.Cond</code> could useful in situations where multiple readers wait for the shared resources to be available.</p>\n\n<pre><code>var sharedRsc = make(map[string]interface{})\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(2)\n    m := sync.Mutex{}\n    c := sync.NewCond(&amp;m)\n    go func() {\n        // this go routine wait for changes to the sharedRsc\n        c.L.Lock()\n        for len(sharedRsc) == 0 {\n            c.Wait()\n        }\n        fmt.Println(sharedRsc[\"rsc1\"])\n        c.L.Unlock()\n        wg.Done()\n    }()\n\n    go func() {\n        // this go routine wait for changes to the sharedRsc\n        c.L.Lock()\n        for len(sharedRsc) == 0 {\n            c.Wait()\n        }\n        fmt.Println(sharedRsc[\"rsc2\"])\n        c.L.Unlock()\n        wg.Done()\n    }()\n\n    // this one writes changes to sharedRsc\n    c.L.Lock()\n    sharedRsc[\"rsc1\"] = \"foo\"\n    sharedRsc[\"rsc2\"] = \"bar\"\n    c.Broadcast()\n    c.L.Unlock()\n    wg.Wait()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dZwYbUB3Oi\" rel=\"noreferrer\">Playground</a></p>\n\n<p>Having said that, using channels is still the recommended way to pass data around if the situation permitting.</p>\n\n<p>Note: <code>sync.WaitGroup</code> here is only used to wait for the goroutines to complete their executions.</p>\n"}, {"comments": [{"owner": {"reputation": 18225, "user_id": 152580, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/34b114b30616ba935061582133cceeb8?s=128&d=identicon&r=PG", "display_name": "Eloff", "link": "https://stackoverflow.com/users/152580/eloff"}, "edited": false, "score": 0, "creation_date": 1574082796, "post_id": 44015271, "comment_id": 104092357, "body": "C.Wait() locks m again before it returns, so I edited your example to add the m.Unlock() at the end for correctness, otherwise you&#39;ll be surprised to find only one waiter ever wakes up."}], "tags": [], "owner": {"reputation": 2021, "user_id": 2325264, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a5b28c1bf706b9138017bf0fd23ac45?s=128&d=identicon&r=PG", "display_name": "eric chiang", "link": "https://stackoverflow.com/users/2325264/eric-chiang"}, "is_accepted": false, "score": 14, "last_activity_date": 1574082691, "last_edit_date": 1574082691, "creation_date": 1494993365, "answer_id": 44015271, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/44015271#44015271", "title": "How to correctly use sync.Cond?", "body": "<p>You need to make sure that c.Broadcast is called <strong>after</strong> your call to c.Wait. The correct version of your program would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    m := &amp;sync.Mutex{}\n    c := sync.NewCond(m)\n    m.Lock()\n    go func() {\n        m.Lock() // Wait for c.Wait()\n        c.Broadcast()\n        m.Unlock()\n    }()\n    c.Wait() // Unlocks m, waits, then locks m again\n    m.Unlock()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O1r8v8yW6h\" rel=\"noreferrer\">https://play.golang.org/p/O1r8v8yW6h</a></p>\n"}, {"tags": [], "owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "is_accepted": false, "score": 3, "last_activity_date": 1534242858, "last_edit_date": 1534242858, "creation_date": 1533305765, "answer_id": 51674609, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/51674609#51674609", "title": "How to correctly use sync.Cond?", "body": "<p>Here's a practical example with two go routines. They start one after another but the second one waits on a condition which is broadcast by the first one before proceeding:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"sync\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    lock := sync.Mutex{}\n    lock.Lock()\n\n    cond := sync.NewCond(&amp;lock)\n\n    waitGroup := sync.WaitGroup{}\n    waitGroup.Add(2)\n\n    go func() {\n        defer waitGroup.Done()\n\n        fmt.Println(\"First go routine has started and waits for 1 second before broadcasting condition\")\n\n        time.Sleep(1 * time.Second)\n\n        fmt.Println(\"First go routine broadcasts condition\")\n\n        cond.Broadcast()\n    }()\n\n    go func() {\n        defer waitGroup.Done()\n\n        fmt.Println(\"Second go routine has started and is waiting on condition\")\n\n        cond.Wait()\n\n        fmt.Println(\"Second go routine unlocked by condition broadcast\")\n    }()\n\n    fmt.Println(\"Main go routine starts waiting\")\n\n    waitGroup.Wait()\n\n    fmt.Println(\"Main go routine ends\")\n}\n</code></pre>\n\n<p>Output may vary slightly as the second go routine could start before the first one and viceversa:</p>\n\n<pre><code>Main go routine starts waiting\nSecond go routine has started and is waiting on condition\nFirst go routine has started and waits for 1 second before broadcasting condition\nFirst go routine broadcasts condition\nSecond go routine unlocked by condition broadcast\nMain go routine ends\n</code></pre>\n\n<p><a href=\"https://gist.github.com/fracasula/21565ea1cf0c15726ca38736031edc70\" rel=\"nofollow noreferrer\">https://gist.github.com/fracasula/21565ea1cf0c15726ca38736031edc70</a></p>\n"}, {"tags": [], "owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "is_accepted": false, "score": 0, "last_activity_date": 1548758016, "creation_date": 1548758016, "answer_id": 54419042, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/54419042#54419042", "title": "How to correctly use sync.Cond?", "body": "<p>Yes you can use one channel to pass Header to multiple Go routines.</p>\n\n<pre><code>headerChan := make(chan http.Header)\n\ngo func() { // This routine can be started many times\n    header := &lt;-headerChan  // Wait for header\n    // Do things with the header\n}()\n\n// Feed the header to all waiting go routines\nfor more := true; more; {\n    select {\n    case headerChan &lt;- r.Header:\n    default: more = false\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1618428689, "post_id": 59515938, "comment_id": 118601622, "body": "I guess this is a neat example.  It doesn&#39;t answer the question.  I still don&#39;t know how to use a condition after looking at this."}, {"owner": {"reputation": 5719, "user_id": 927477, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0371d87e695b51de2f76e828e6a5915f?s=128&d=identicon&r=PG", "display_name": "Avner Levy", "link": "https://stackoverflow.com/users/927477/avner-levy"}, "reply_to_user": {"reputation": 981, "user_id": 1119810, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a3e2d5be1e20ee3dd3732bf1abb622d?s=128&d=identicon&r=PG", "display_name": "Dale", "link": "https://stackoverflow.com/users/1119810/dale"}, "edited": false, "score": 0, "creation_date": 1618520409, "post_id": 59515938, "comment_id": 118633513, "body": "If you read the full question, the question is about how to communicate some event between few goroutines which this example solves. @Dale"}], "tags": [], "owner": {"reputation": 5719, "user_id": 927477, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0371d87e695b51de2f76e828e6a5915f?s=128&d=identicon&r=PG", "display_name": "Avner Levy", "link": "https://stackoverflow.com/users/927477/avner-levy"}, "is_accepted": false, "score": 0, "last_activity_date": 1577578187, "creation_date": 1577578187, "answer_id": 59515938, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond/59515938#59515938", "title": "How to correctly use sync.Cond?", "body": "<p>In the excellent book \"Concurrency in Go\" they provide the following easy solution while leveraging the fact that a channel that is closed will release all waiting clients.  </p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"time\"\n)\nfunc main() {\n    httpHeaders := []string{}\n    headerChan := make(chan interface{})\n    var consumerFunc= func(id int, stream &lt;-chan interface{}, funcHeaders *[]string)         \n    {\n        &lt;-stream\n        fmt.Println(\"Consumer \",id,\" got headers:\", funcHeaders )   \n    }\n    for i:=0;i&lt;3;i++ {\n        go consumerFunc(i, headerChan, &amp;httpHeaders)\n    }\n    fmt.Println(\"Getting headers...\")\n    time.Sleep(2*time.Second)\n    httpHeaders=append(httpHeaders, \"test1\");\n    fmt.Println(\"Publishing headers...\")\n    close(headerChan )\n    time.Sleep(5*time.Second)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cE3SiKWNRIt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/cE3SiKWNRIt</a></p>\n"}], "owner": {"reputation": 63413, "user_id": 193619, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/11e74c6cb64be4d24fdee076ddb374b0?s=128&d=identicon&r=PG", "display_name": "Nathan Osman", "link": "https://stackoverflow.com/users/193619/nathan-osman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26086, "favorite_count": 8, "accepted_answer_id": 37064343, "answer_count": 8, "score": 29, "last_activity_date": 1577578187, "creation_date": 1461653017, "last_edit_date": 1461687181, "question_id": 36857167, "link": "https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond", "title": "How to correctly use sync.Cond?", "body": "<p>I'm having trouble figuring out how to correctly use <a href=\"https://golang.org/pkg/sync/#Cond\" rel=\"noreferrer\"><code>sync.Cond</code></a>. From what I can tell, a race condition exists between locking the Locker and invoking the condition's Wait method. This example adds an artificial delay between the two lines in the main goroutine to simulate the race condition:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    m := sync.Mutex{}\n    c := sync.NewCond(&amp;m)\n    go func() {\n        time.Sleep(1 * time.Second)\n        c.Broadcast()\n    }()\n    m.Lock()\n    time.Sleep(2 * time.Second)\n    c.Wait()\n}\n</code></pre>\n\n<p><sup>[<a href=\"http://play.golang.org/p/aV9ZefLt3V\" rel=\"noreferrer\">Run on the Go Playground</a>]</sup></p>\n\n<p>This causes an immediate panic:</p>\n\n<pre>fatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [semacquire]:\nsync.runtime_Syncsemacquire(0x10330208, 0x1)\n    /usr/local/go/src/runtime/sema.go:241 +0x2e0\nsync.(*Cond).Wait(0x10330200, 0x0)\n    /usr/local/go/src/sync/cond.go:63 +0xe0\nmain.main()\n    /tmp/sandbox301865429/main.go:17 +0x1a0</pre>\n\n<p>What am I doing wrong? How do I avoid this apparent race condition? Is there a better synchronization construct I should be using?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> I realize I should have better explained the problem I'm trying to solve here. I have a long-running goroutine that downloads a large file and a number of other goroutines that need access to the HTTP headers when they are available. This problem is harder than it sounds.</p>\n\n<p>I can't use channels since only one goroutine would then receive the value. And some of the other goroutines would be trying to retrieve the headers long after they are already available.</p>\n\n<p>The downloader goroutine could simply store the HTTP headers in a variable and use a mutex to safeguard access to them. However, this doesn't provide a way for the other goroutines to \"wait\" for them to become available.</p>\n\n<p>I had thought that both a <code>sync.Mutex</code> and <code>sync.Cond</code> together could accomplish this goal but it appears that this is not possible.</p>\n"}, {"tags": ["go", "error-handling", "panic"], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 4, "last_activity_date": 1461648018, "creation_date": 1461648018, "answer_id": 36855833, "question_id": 36855714, "link": "https://stackoverflow.com/questions/36855714/why-gos-bufio-uses-panic-under-the-hood/36855833#36855833", "title": "Why Go&#39;s bufio uses panic under the hood?", "body": "<p>It may be questionable, but consider: <code>fill</code> is a private method, and <code>b.w</code> and <code>b.buf</code> are private fields. If the condition that causes the panic is ever true, it's due to a logic error in the implementation of bufio. Since it should never really be possible to get into that state in the first place (a \"can't happen\" condition), we don't really know <em>how</em> we got there, and it's unclear how much other state got corrupted before the problem was detected and what, if anything, the user can do about it. In that kind of situation, a panic seems reasonable.</p>\n"}], "owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 36855833, "answer_count": 1, "score": 3, "last_activity_date": 1461648018, "creation_date": 1461647415, "question_id": 36855714, "link": "https://stackoverflow.com/questions/36855714/why-gos-bufio-uses-panic-under-the-hood", "title": "Why Go&#39;s bufio uses panic under the hood?", "body": "<p>Reading the code from the <code>bufio</code> package I've <a href=\"https://github.com/golang/go/blob/master/src/bufio/bufio.go#L92\" rel=\"nofollow\">found</a> such things:</p>\n\n<pre><code>// fill reads a new chunk into the buffer.\nfunc (b *Reader) fill() {\n    ...\n    if b.w &gt;= len(b.buf) {\n        panic(\"bufio: tried to fill full buffer\")\n    }\n    ...\n}\n</code></pre>\n\n<p>At the same time the <strong>Effective Go</strong> <a href=\"https://golang.org/doc/effective_go.html#panic\" rel=\"nofollow\">section</a> about <code>panic</code> contains the next paragraph:</p>\n\n<blockquote>\n  <p>This is only an example but real library functions should avoid panic.\n  If the problem can be masked or worked around, it's always better to\n  let things continue to run rather than taking down the whole program.</p>\n</blockquote>\n\n<p>So, I wonder, is the problem with a particular buffered reader so important to cause the <code>panic</code> call in the standard library code?</p>\n"}, {"tags": ["arrays", "regex", "go"], "comments": [{"owner": {"reputation": 2777, "user_id": 1002371, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/612ee2165cc4115ea14888dbf6ae24cf?s=128&d=identicon&r=PG", "display_name": "a p", "link": "https://stackoverflow.com/users/1002371/a-p"}, "edited": false, "score": 3, "creation_date": 1461645411, "post_id": 36855264, "comment_id": 61279089, "body": "See <a href=\"http://stackoverflow.com/questions/19832189/unpack-golang-slices-on-assignment\" title=\"unpack golang slices on assignment\">stackoverflow.com/questions/19832189/&hellip;</a> for use of unpacking, no list constructor required."}], "answers": [{"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461684637, "post_id": 36855354, "comment_id": 61305983, "body": "this isn&#39;t even valid go.."}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461712459, "post_id": 36855354, "comment_id": 61321292, "body": "@OneOfOne: I&#39;m very sorry but someone keeps editing the answer to be invalid. He obviously doesn&#39;t understand how go&#39;s multiple return values work."}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "reply_to_user": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1461712558, "post_id": 36855354, "comment_id": 61321326, "body": "@Noval Agung Prayogo: Please don&#39;t change working code into invalid code. Please learn about how go&#39;s return work"}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1461712829, "post_id": 36855354, "comment_id": 61321400, "body": "@OneOfOne: Thank you"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "edited": false, "score": 0, "creation_date": 1461714257, "post_id": 36855354, "comment_id": 61321817, "body": "This is your previous code <a href=\"http://play.golang.org/p/pPYHpUBq6B\" rel=\"nofollow noreferrer\">play.golang.org/p/pPYHpUBq6B</a> and it&#39;s definitely invalid. Or am I the only one who doesn&#39;t understand go multiple return?"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1461714364, "post_id": 36855354, "comment_id": 61321848, "body": "you keep deleting the return type <code>(string, string)</code>, and in the end you approve @OneOfOne answer which is exaclty did the same thing like what I did, cmon bruh, really"}, {"owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1536903508, "post_id": 36855354, "comment_id": 91597944, "body": "check out this! still one of the funniest thing I ever saw on SO :D <a href=\"https://stackoverflow.com/posts/36855354/revisions\">stackoverflow.com/posts/36855354/revisions</a>  slebetman rejects my edit two times, but approving @OneOfOne answer which does the very same thing like what I did lmao"}], "tags": [], "owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "is_accepted": false, "score": 1, "last_activity_date": 1461712754, "last_edit_date": 1461712754, "creation_date": 1461645445, "answer_id": 36855354, "question_id": 36855264, "link": "https://stackoverflow.com/questions/36855264/whats-the-go-equivalent-to-phps-list/36855354#36855354", "title": "What&#39;s the go equivalent to PHP&#39;s list()?", "body": "<p>There's nothing built-in but you can write your own function to do something similar:</p>\n\n<pre><code>func unlist(x []string) (string, string) {\n    return x[0], x[1]\n}\n\na, b := unlist(values);\n</code></pre>\n\n<p>However, this does mean that there is no way to generalize this which means that you have to write a function for destructuring* every different number and type of argument you need it for.</p>\n\n<p>*note: the general name for this operation is a \"destructuring assignment\".</p>\n"}, {"comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1461684705, "post_id": 36856108, "comment_id": 61306028, "body": "This is just bad practice, why would anyone use that rather than: <code>a, b, c := s[0], s[1], s[2]</code>? also that&#39;s a slice not an array."}], "tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 3, "last_activity_date": 1461686177, "last_edit_date": 1461686177, "creation_date": 1461649162, "answer_id": 36856108, "question_id": 36855264, "link": "https://stackoverflow.com/questions/36855264/whats-the-go-equivalent-to-phps-list/36856108#36856108", "title": "What&#39;s the go equivalent to PHP&#39;s list()?", "body": "<p>You cannot do that in go, but there is a way to achieve that by taking advantage the pointer value of it's variable.</p>\n\n<p>Create a function, pass pointer of all receiver variables as slices, then re-assign the value.</p>\n\n<pre><code>func main() {\n    var arr = []string{\"value 1\", \"value 2\", \"value 3\"}\n    var a, b, c string\n\n    vcopy(arr, &amp;a, &amp;b, &amp;c)\n\n    fmt.Println(a) // value 1\n    fmt.Println(b) // value 2\n    fmt.Println(c) // value 3\n}\n\nfunc vcopy(arr []string, dest ...*string) {\n    for i := range dest {\n        if len(arr) &gt; i {\n            *dest[i] = arr[i]\n        }\n    }\n}\n</code></pre>\n\n<p>Example <a href=\"http://play.golang.org/p/gJzWp1WglJ\" rel=\"nofollow\">http://play.golang.org/p/gJzWp1WglJ</a></p>\n\n<p>By using this technique, passing any variables are not a problem.</p>\n"}], "owner": {"reputation": 304, "user_id": 369867, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7581c54a4d5211290eedfc40d6d319fb?s=128&d=identicon&r=PG", "display_name": "Danniel Magno", "link": "https://stackoverflow.com/users/369867/danniel-magno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "closed_date": 1461684714, "accepted_answer_id": 36856108, "answer_count": 2, "score": -2, "last_activity_date": 1461712754, "creation_date": 1461644854, "last_edit_date": 1461652375, "question_id": 36855264, "link": "https://stackoverflow.com/questions/36855264/whats-the-go-equivalent-to-phps-list", "closed_reason": "Duplicate", "title": "What&#39;s the go equivalent to PHP&#39;s list()?", "body": "<p>In PHP we have the <code>list()</code> which enable us to assign values to a list of variables in one operation. Eg:</p>\n\n<pre class=\"lang-php prettyprint-override\"><code>list($a, $b) = ['valueA', 'valueB'];\necho $a; # valueA\necho $b; # valueB\n</code></pre>\n\n<p>Is it possible do the same thing in Go? Functions like <a href=\"https://golang.org/pkg/regexp/#Regexp.FindStringSubmatch\" rel=\"nofollow\"><code>Regexp.FindStringSubmatch()</code></a> returns an array, so would be nice map this values directly into other variables.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": false, "score": 1, "last_activity_date": 1461651863, "creation_date": 1461651863, "answer_id": 36856804, "question_id": 36855225, "link": "https://stackoverflow.com/questions/36855225/how-to-type-convert-a-slice-of-type-aliases/36856804#36856804", "title": "How to type convert a slice of type aliases", "body": "<p>Try this, you could do that by doing right casting.</p>\n\n<pre><code>type alias int\ntype aliases []*alias\n\nfunc main() {\n    a1 := alias(1)\n    t := aliases{&amp;a1}\n\n    orig := int(*([]*alias(t)[0]))\n    fmt.Println(orig)\n}\n</code></pre>\n\n<p>Example on  <a href=\"http://play.golang.org/p/1WosCIUZSa\" rel=\"nofollow\">http://play.golang.org/p/1WosCIUZSa</a></p>\n\n<p>If you want to get all values (not just the first index) you have to loop and cast each element.</p>\n\n<pre><code>func main() {\n    a1 := alias(1)\n    t := aliases{&amp;a1}\n\n    orig := []*int{}\n\n    for _, each := range t {\n        temp := int(*each)\n        orig = append(orig, &amp;temp)\n    }\n\n    fmt.Printf(\"%#v\\n\", orig) // []*int{(*int)(0x10434114)}\n}\n</code></pre>\n\n<p>Example: <a href=\"http://play.golang.org/p/Sx4JK3kA45\" rel=\"nofollow\">http://play.golang.org/p/Sx4JK3kA45</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1461669801, "creation_date": 1461669801, "answer_id": 36863514, "question_id": 36855225, "link": "https://stackoverflow.com/questions/36855225/how-to-type-convert-a-slice-of-type-aliases/36863514#36863514", "title": "How to type convert a slice of type aliases", "body": "<p>You can with unsafe.Pointer, a little bit unsafe so not recommended</p>\n\n<pre><code>PointerToSliceOfPointersToInt := (*([]*int))(unsafe.Pointer(&amp;t))\n</code></pre>\n\n<p>try it works <a href=\"https://play.golang.org/p/6AWd1W_it3\" rel=\"nofollow\">https://play.golang.org/p/6AWd1W_it3</a></p>\n"}], "owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2059, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461669801, "creation_date": 1461644654, "question_id": 36855225, "link": "https://stackoverflow.com/questions/36855225/how-to-type-convert-a-slice-of-type-aliases", "title": "How to type convert a slice of type aliases", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype alias int\ntype aliases []*alias\n\nfunc main() {\n    a1 := alias(1)\n    t := aliases{&amp;a1}\n\n    fmt.Println([]*int([]*alias(t)))\n}\n</code></pre>\n\n<p>The type <code>type aliases []*alias</code> is essentially <code>[]*int</code></p>\n\n<p>I want to be able to type convert <code>aliases</code> back to <code>[]*int</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7845, "user_id": 1261942, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5604800360c8ea563ba329aacc3f757?s=128&d=identicon&r=PG", "display_name": "DanRedux", "link": "https://stackoverflow.com/users/1261942/danredux"}, "edited": false, "score": 21, "creation_date": 1461642937, "post_id": 36854446, "comment_id": 61278453, "body": "Just wanted to add on <i>why</i> this is needed. The slice itself contains 3 values: a pointer to the underlying array, a &quot;length&quot;, and a &quot;capacity&quot;. When you pass in a slice, you&#39;re passing in a copy of those 3 values. The function can still read and change the items in the slice because it has the right pointer, however, it can not change the length because it&#39;s working with a copy of those fields. Using a pointer allows the function to change the &quot;length&quot; of the original."}], "tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": true, "score": 36, "last_activity_date": 1461639040, "creation_date": 1461639040, "answer_id": 36854446, "question_id": 36854408, "link": "https://stackoverflow.com/questions/36854408/how-to-append-to-a-slice-pointer-receiver/36854446#36854446", "title": "How to append to a slice pointer receiver", "body": "<p>You need to actually pass a pointer, try:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype itself []string\n\nfunc (h *itself) appendToItself(test string) {\n    *h = append(*h, test)\n}\n\nfunc main() {\n    h := itself{\"1\", \"2\"}\n    h.appendToItself(\"3\")\n    fmt.Println(h, \"&lt;- how do I make it [1,2,3]\")\n}\n</code></pre>\n"}], "owner": {"reputation": 13300, "user_id": 2521225, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/39c72c6dc4d20a8e736f8ed0d08fa646?s=128&d=identicon&r=PG&f=1", "display_name": "samol", "link": "https://stackoverflow.com/users/2521225/samol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10188, "favorite_count": 0, "accepted_answer_id": 36854446, "answer_count": 1, "score": 19, "last_activity_date": 1461639495, "creation_date": 1461638690, "question_id": 36854408, "link": "https://stackoverflow.com/questions/36854408/how-to-append-to-a-slice-pointer-receiver", "title": "How to append to a slice pointer receiver", "body": "<p>I have a type alias for a slice. And I want to be able to append to the slice (or filter from the slice) when the slice is a pointer receiver:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype itself []string\n\nfunc (h itself) appendToItself(test string) {\n    h = append(h, test)\n}\n\nfunc main() {\n    h := itself{\"1\", \"2\"}\n    h.appendToItself(\"3\")\n    fmt.Println(h, \"&lt;- how do I make it [1,2,3]\")\n}\n</code></pre>\n\n<p>Log:</p>\n\n<pre><code>[1 2] &lt;- how do I make it [1,2,3]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 4, "creation_date": 1461636275, "post_id": 36854094, "comment_id": 61276846, "body": "false isn&#39;t nil, and by reflexivity of identity, nil isn&#39;t false."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1461646705, "post_id": 36854094, "comment_id": 61279448, "body": "Unfortunately, opinion <i>is</i> the only argument here. As you have guessed from that thread, neither option is any better than the other. Indeed, all matters of programming style are <i>inherently subjective</i>, and ultimately it is up to the language designers to decide what they should or should not include in a language. It isn&#39;t necessarily about personal taste, though; in general the Go authors design the language based around what they feel leads to better code in the general case, even if it means abandoning their personal favorite idioms."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1461647393, "post_id": 36854094, "comment_id": 61279687, "body": "There&#39;s nothing stopping you form doing <code>type Err bool</code> and then <code>func (e Err) Error() { &quot;Im an error&quot; }</code>.   In that case, false is actually an error.   Obviously, it&#39;s unlikely anyone writes that code.  But languages with a truthiness concept implicitly impose some standard meanings behind non-boolean data (0/1 being false/true for example).  The Go authors chose to be explicit rather than implicit here probably due to it simplifying the language as well as not wanting surprises in general"}, {"owner": {"reputation": 23249, "user_id": 93540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0c65ea6e0452cb127010585a52b66d34?s=128&d=identicon&r=PG", "display_name": "sanmai", "link": "https://stackoverflow.com/users/93540/sanmai"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1461653330, "post_id": 36854094, "comment_id": 61282661, "body": "@DavidBudworth do you have a canonical source in regard of their decision?"}, {"owner": {"reputation": 4018, "user_id": 135673, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42ee5885ec2ae8f7834b716a3a2b57c2?s=128&d=identicon&r=PG", "display_name": "froderik", "link": "https://stackoverflow.com/users/135673/froderik"}, "edited": false, "score": 0, "creation_date": 1461653454, "post_id": 36854094, "comment_id": 61282766, "body": "<a href=\"https://stackoverflow.com/questions/29138591/hiding-nil-values-understanding-why-golang-fails-here\" title=\"hiding nil values understanding why golang fails here\">stackoverflow.com/questions/29138591/&hellip;</a>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1461680607, "post_id": 36854094, "comment_id": 61302613, "body": "@sanmai I do not, I was more drawing conclusions based on other design decisions made by the language creators."}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 6253101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ygYWm.png?s=128&g=1", "display_name": "vogtb", "link": "https://stackoverflow.com/users/6253101/vogtb"}, "is_accepted": false, "score": 1, "last_activity_date": 1461803661, "last_edit_date": 1461803661, "creation_date": 1461715118, "answer_id": 36877896, "question_id": 36854094, "link": "https://stackoverflow.com/questions/36854094/historical-reference-on-why-go-creators-choose-to-not-treat-nil-as-false/36877896#36877896", "title": "Historical reference on why Go creators choose to not treat `nil` as `false`", "body": "<p>While I can't find an exact reason in any of the golang documentation or developer discussions, the closest reason is simply that that absence of a value (nil) <em>should not</em> be interpreted as false. This is also in line with the fact that golang is a very opinionated language, and that its authors felt that not casting types when evaluating for true/false would lead to better quality of code.</p>\n"}, {"comments": [{"owner": {"reputation": 23249, "user_id": 93540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0c65ea6e0452cb127010585a52b66d34?s=128&d=identicon&r=PG", "display_name": "sanmai", "link": "https://stackoverflow.com/users/93540/sanmai"}, "edited": false, "score": 0, "creation_date": 1461717570, "post_id": 36877951, "comment_id": 61322693, "body": "If only they can do that only <code>nil</code> would evaluate to <code>false</code> with everything else being the same"}, {"owner": {"reputation": 42860, "user_id": 54937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d968f2f1240bf3e2c4080e773cc95129?s=128&d=identicon&r=PG", "display_name": "Sedat Kapanoglu", "link": "https://stackoverflow.com/users/54937/sedat-kapanoglu"}, "reply_to_user": {"reputation": 23249, "user_id": 93540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0c65ea6e0452cb127010585a52b66d34?s=128&d=identicon&r=PG", "display_name": "sanmai", "link": "https://stackoverflow.com/users/93540/sanmai"}, "edited": false, "score": 0, "creation_date": 1461729086, "post_id": 36877951, "comment_id": 61325612, "body": "@sanmai that wouldn&#39;t help much. it would only eliminate the first case given in the item. still there are tons of scenarios only that would lead to."}, {"owner": {"reputation": 23249, "user_id": 93540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0c65ea6e0452cb127010585a52b66d34?s=128&d=identicon&r=PG", "display_name": "sanmai", "link": "https://stackoverflow.com/users/93540/sanmai"}, "edited": false, "score": 0, "creation_date": 1461729421, "post_id": 36877951, "comment_id": 61325726, "body": "You&#39;re right. Thanks for the wisdom."}], "tags": [], "owner": {"reputation": 42860, "user_id": 54937, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d968f2f1240bf3e2c4080e773cc95129?s=128&d=identicon&r=PG", "display_name": "Sedat Kapanoglu", "link": "https://stackoverflow.com/users/54937/sedat-kapanoglu"}, "is_accepted": true, "score": 9, "last_activity_date": 1544557821, "last_edit_date": 1544557821, "creation_date": 1461715452, "answer_id": 36877951, "question_id": 36854094, "link": "https://stackoverflow.com/questions/36854094/historical-reference-on-why-go-creators-choose-to-not-treat-nil-as-false/36877951#36877951", "title": "Historical reference on why Go creators choose to not treat `nil` as `false`", "body": "<p>Some languages did that and it caused too many problems. It's primarily a violation of principle of least surprise. Some of the problems are:</p>\n\n<ul>\n<li>All non-nil values would evaluate to <code>true</code>. A pointer to <code>false</code> boolean value would evaluate to <code>true</code>. All of that would create new and larger set of complications, aka more bugs.</li>\n<li>Assigning a boolean to <code>nil</code> would be valid. Comparing a boolean to <code>nil</code> would be valid. That creates a semantic confusion. More bugs.</li>\n<li>Code would be harder to read because it hides the intent. It's impossible to tell from an expression if you want to check a boolean's value or assert \"non-nilness\" of some other type of variable. More bugs.</li>\n<li>Omitted operands in comparison operations in expressions would compile fine, making identifying bugs harder. Think about <code>if a == '3' &amp;&amp; b { .. }</code> kind of cases where you forget to add the comparison so <code>b</code> always evaluates to <code>true</code> even if it's not what you intend. More and more bugs.</li>\n</ul>\n\n<p>Go people probably thought about it and preferred code with less bugs is better.</p>\n\n<p>There could be a shortcut though just to propagate the error to the caller such as:</p>\n\n<pre><code>require f := os.Open(name)\n// if the call returns error, return error \n</code></pre>\n\n<p>EDIT: I'm happy to report that Go team adopted <a href=\"https://go.googlesource.com/proposal/+/master/design/go2draft-error-handling-overview.md\" rel=\"nofollow noreferrer\">a very similar approach to what I suggested</a>, in Go 2. Only they used the keyword <code>check</code> instead:</p>\n\n<pre><code>check f := os.Open(name)\n// if the call returns error run the declared error handler \n// which in turn, can return the error or do something else about it.\n</code></pre>\n"}], "owner": {"reputation": 23249, "user_id": 93540, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0c65ea6e0452cb127010585a52b66d34?s=128&d=identicon&r=PG", "display_name": "sanmai", "link": "https://stackoverflow.com/users/93540/sanmai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1951, "favorite_count": 0, "closed_date": 1461716488, "accepted_answer_id": 36877951, "answer_count": 2, "score": -1, "last_activity_date": 1559900910, "creation_date": 1461636114, "last_edit_date": 1559900910, "question_id": 36854094, "link": "https://stackoverflow.com/questions/36854094/historical-reference-on-why-go-creators-choose-to-not-treat-nil-as-false", "closed_reason": "Opinion-based", "title": "Historical reference on why Go creators choose to not treat `nil` as `false`", "body": "<p>Why did Go creators choose to not treat <code>nil</code> as <code>false</code>? What why did they think it is better to explicitly compare values to <code>nil</code>? Is there a reliable source that would explain why is that is Go? What was their opinion? What was the logic behind this decision?</p>\n\n<p>I'm looking for a historical reference.</p>\n\n<hr>\n\n<p>E.g.:</p>\n\n<pre><code>f, err := os.Open(name)\nif err != nil {\n    return err\n}\n</code></pre>\n\n<p>Than to implicitly cast <code>nil</code>s to <code>false</code> like in many other languages:</p>\n\n<pre><code>f, err := os.Open(name)\nif err {\n    return err\n}\n</code></pre>\n\n<p>As of now, the latter would give:</p>\n\n<pre><code>non-bool err (type error) used as if condition\n</code></pre>\n"}, {"tags": ["go", "websocket", "gopherjs"], "answers": [{"tags": [], "owner": {"reputation": 7845, "user_id": 1261942, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a5604800360c8ea563ba329aacc3f757?s=128&d=identicon&r=PG", "display_name": "DanRedux", "link": "https://stackoverflow.com/users/1261942/danredux"}, "is_accepted": true, "score": 1, "last_activity_date": 1461636403, "creation_date": 1461636403, "answer_id": 36854143, "question_id": 36852000, "link": "https://stackoverflow.com/questions/36852000/go-websockets-data-gopherjs/36854143#36854143", "title": "Go websockets data gopherjs", "body": "<p>Small error. You're writing uint64 but using \"ReadUvarint\" to read it (a varint is a different type of data).</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"fmt\"\n)\n\nfunc main() {\n    b := bytes.NewBuffer([]byte{})\n    e1 := binary.Write(b, binary.LittleEndian, uint64(10))\n    e2 := binary.Write(b, binary.LittleEndian, uint64(20))\n\n    fmt.Println(\"writing 10 and 20\", e1, e2)\n\n    {\n        r := bytes.NewBuffer(b.Bytes())\n        res, e := binary.ReadUvarint(r)\n        res2, e2 := binary.ReadUvarint(r)\n        fmt.Println(\"using readuvarint here        :\", res, res2, e, e2, b.Bytes())\n    }\n    {\n        r := bytes.NewBuffer(b.Bytes())\n        var res, res2 uint64\n        e := binary.Read(r, binary.LittleEndian, &amp;res)\n        e2 := binary.Read(r, binary.LittleEndian, &amp;res2)\n        fmt.Println(\"using read into uint64's here :\", res, res2, e, e2, b.Bytes())\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 36854143, "answer_count": 1, "score": 0, "last_activity_date": 1497556877, "creation_date": 1461622207, "last_edit_date": 1497556877, "question_id": 36852000, "link": "https://stackoverflow.com/questions/36852000/go-websockets-data-gopherjs", "title": "Go websockets data gopherjs", "body": "<p>I'm currently trying to communicate using websockets and my code is the following (im using gorilla)</p>\n\n<pre><code>buff := bytes.NewBuffer([]byte{})\nbinary.Write(buff, binary.LittleEndian, uint64(1))\nbinary.Write(buff, binary.LittleEndian, len(message))\nbinary.Write(buff, binary.LittleEndian, message)\nclient.Write &lt;- buff.Bytes()\n</code></pre>\n\n<p>The c.Write channel its inside a for select loop</p>\n\n<pre><code>case msg := &lt;-client.Write:\n    buffer := &amp;bytes.Buffer{}\n    err := binary.Write(buffer, binary.LittleEndian, msg)\n    if err != nil {\n        return\n    }\n    err = client.Ws.WriteMessage(websocket.BinaryMessage, buffer.Bytes())\n    if err != nil {\n        return\n    }\n    buffer.Reset()\n</code></pre>\n\n<p>And client is just a struct</p>\n\n<pre><code>type Client struct {\n    Ws      *websocket.Conn\n    Read    chan []byte\n    Write   chan []byte\n    Account *models.Account\n}\n</code></pre>\n\n<p>The message is sent successfully and I read it like this</p>\n\n<pre><code>b, err := conn.Read(buff)\nif err != nil {\n    utils.Log(\"Error while reading from socket \" + err.Error())\n    return\n}\nbuffer := bytes.NewBuffer(buff[:b])\nt, err := binary.ReadUvarint(buffer)\nutils.Log(t)\nif err != nil {\n    utils.Log(\"Error while reading from socket \" + err.Error())\n    return\n}\nswitch t {\ncase 1:\n    roomsLen, err := binary.ReadUvarint(buffer)\n    if err != nil {\n        utils.Log(\"Error while reading rooms len \" + err.Error())\n        return\n    }\n    utils.Log(roomsLen)\n    roomsBytes := make([]byte, roomsLen)\n    binary.Read(buffer, binary.LittleEndian, roomsBytes)\n    rooms := []*Room{}\n    err = json.Unmarshal(roomsBytes, rooms)\n    if err != nil {\n        utils.Log(\"Error while unmarshaling room list \" + err.Error())\n        return\n    }\n    utils.Log(rooms)\n</code></pre>\n\n<p>The utils.Log function is just this</p>\n\n<pre><code>func Log(msg interface{}) {\n    n := time.Now()\n    console.Call(\"log\", fmt.Sprintf(\"[%v:%v:%v] %v\", n.Hour(), n.Minute(),    n.Second(), msg))\n}\n</code></pre>\n\n<p>Thing is the first uint64 is the one im waiting (1) but the second uint64 im reading is always 0 while loggin it (len(message)) gives me 52</p>\n\n<p>And since its always 0 I cant unmarshal it properly</p>\n\n<p>So I'm not sure what I am doing wrong or if this is not a correct way to use websockets.</p>\n"}, {"tags": ["go", "sftp", "atom-editor"], "answers": [{"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461679755, "post_id": 36854605, "comment_id": 61301832, "body": "Interesting! Could you elaborate on how I would do this?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1470741904, "last_edit_date": 1495540386, "creation_date": 1461640359, "answer_id": 36854605, "question_id": 36851595, "link": "https://stackoverflow.com/questions/36851595/how-do-i-make-go-plus-with-atom-io-aware-that-im-developing-on-a-server/36854605#36854605", "title": "How do I make go-plus with Atom.io aware that I&#39;m developing on a server?", "body": "<p>If you use go install outside <code>GOPATH</code> you will see:  </p>\n\n<pre><code>go install: no install location for directory outside GOPATH  \n</code></pre>\n\n<p>so the workaround I found for this is to<br>\nset <code>GOPATH</code> to network location.<br>\nand clone other packages under your <code>GOPATH</code> folder and set imports normally.  </p>\n\n<p>Mounting SMB share by using mount command:</p>\n\n<pre><code>mount \u2013t smbfs 192.168.0.1:/share1 /mnt \u2013o username=UserName,workgroup=test \n</code></pre>\n\n<p>See this for how to mount it to a local drive:    <a href=\"https://stackoverflow.com/questions/38679294/how-do-i-use-a-samba-server-location-for-gopath/38680558#38680558\">How do I use a Samba server location for GOPATH?</a></p>\n\n<p>ref:\n<a href=\"http://www.linuxnix.com/8-ways-to-mount-smbfs-samba-file-system-in-linux/\" rel=\"nofollow noreferrer\">http://www.linuxnix.com/8-ways-to-mount-smbfs-samba-file-system-in-linux/</a></p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1470741904, "creation_date": 1461620512, "last_edit_date": 1470741599, "question_id": 36851595, "link": "https://stackoverflow.com/questions/36851595/how-do-i-make-go-plus-with-atom-io-aware-that-im-developing-on-a-server", "title": "How do I make go-plus with Atom.io aware that I&#39;m developing on a server?", "body": "<p>I'm using <code>Atom.io</code> as my primary editor for Go development with the <a href=\"https://github.com/joefitzgerald/go-plus\" rel=\"nofollow\">go-plus plugin</a>.<br>\nIt works great locally and the linter finds any issues in the code.</p>\n\n<p>But if I use something like Transmit to SFTP into my server and edit a file with Atom, if I try to <code>import</code> a package I have on my server, it will think it's not present (because it's looking locally?) and the linter will put up an error.</p>\n\n<p>How do I make it aware that I'm on a server and to look on the server for packages and such, not locally?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 1823, "user_id": 7644371, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-K8-GVAQWClY/AAAAAAAAAAI/AAAAAAAAAKY/44LvrIzzJVw/photo.jpg?sz=128", "display_name": "Jim Morrison", "link": "https://stackoverflow.com/users/7644371/jim-morrison"}, "is_accepted": false, "score": 0, "last_activity_date": 1553613858, "creation_date": 1553613858, "answer_id": 55360752, "question_id": 36850471, "link": "https://stackoverflow.com/questions/36850471/gae-restore-ah-builtin-python-bundle-and-ah-builtin-datastoreservice/55360752#55360752", "title": "GAE: Restore ah-builtin-python-bundle and ah-builtin-datastoreservice", "body": "<p>Old question, but to handle getting your data into BigQuery and having a copy outside of Cloud Datastore, you are best to use the <a href=\"https://cloud.google.com/datastore/docs/export-import-entities\" rel=\"nofollow noreferrer\">Managed Import/Export</a> service.</p>\n"}], "owner": {"reputation": 11, "user_id": 4763102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b153d8da835116ce7f2d1d7e69f577a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Steurer", "link": "https://stackoverflow.com/users/4763102/michael-steurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1553613858, "creation_date": 1461616190, "last_edit_date": 1495542715, "question_id": 36850471, "link": "https://stackoverflow.com/questions/36850471/gae-restore-ah-builtin-python-bundle-and-ah-builtin-datastoreservice", "title": "GAE: Restore ah-builtin-python-bundle and ah-builtin-datastoreservice", "body": "<p>I have accidentally deleted the two versions <code>ah-builtin-datastoreservice</code> and <code>ah-builtin-python-bundle</code> in one of my GAE projects (written in Go). The implication is that my auto-backups (implemented as described in <a href=\"https://cloud.google.com/appengine/articles/scheduled_backups\" rel=\"nofollow noreferrer\">Scheduled Backups</a>\u00a0and <code>Google BigQuery Analytics by Jordan Tigani, Siddartha Naidu</code>) are not working anymore and the datastore admin is not available (response code 404).</p>\n\n<p>It seems that the <code>ah-builtin-python-bundle</code> is created when \"Enabling the datastore admin\" in the <a href=\"https://console.cloud.google.com/projectselector/datastore/\" rel=\"nofollow noreferrer\">Datastore Admin interface</a>: <a href=\"https://stackoverflow.com/a/31038901/4763102\">https://stackoverflow.com/a/31038901/4763102</a>. </p>\n\n<p>Unfortunately, this button is not available anymore - only \"Open Datastore Admin\" and \"Disable writes\" buttons are available.</p>\n\n<p>My question is pretty simple: How do I <em>re-enable</em> the deleted versions <code>ah-builtin-datastoreservice</code> and <code>ah-builtin-python-bundle</code> again?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1461617044, "post_id": 36849637, "comment_id": 61270403, "body": "Just out of curiosity, what&#39;s wrong with including the unencoded key? The encoded key can be decoded anyway, it doesn&#39;t add extra security."}, {"owner": {"reputation": 31, "user_id": 5709612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_WVePE4GrGs/AAAAAAAAAAI/AAAAAAAAAJI/haKuIBx-p0Y/photo.jpg?sz=128", "display_name": "matthewdavie", "link": "https://stackoverflow.com/users/5709612/matthewdavie"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461620162, "post_id": 36849637, "comment_id": 61271969, "body": "Encoding allows us to not introduce errors or extra code when we&#39;re switching namespaces, kinds, etc. Having to be verbose about those means the code gets longer and much less flexible."}, {"owner": {"reputation": 4722, "user_id": 6061978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b9d44fdcdfcd8b61552ec455129ce0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/6061978/chris"}, "edited": false, "score": 0, "creation_date": 1461922763, "post_id": 36849637, "comment_id": 61428930, "body": "I&#39;m trying to solve a very similar problem. I don&#39;t even mind if I do have to decode things, I just can&#39;t work out how to construct the edit URL key. It seems to be in the format <code>0&#47;|12&#47;EntityKind|13&#47;id:0000000000</code> but I can&#39;t seem to figure out where the extra numbers (12 and 13) come from."}, {"owner": {"reputation": 4722, "user_id": 6061978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b9d44fdcdfcd8b61552ec455129ce0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/6061978/chris"}, "edited": false, "score": 1, "creation_date": 1461924102, "post_id": 36849637, "comment_id": 61429880, "body": "Oh, I just figured it out. The numbers are the length of the string following them (obviously that makes my previous example wrong, but oh well). That means I can actually generate the URL at least, but what a weird encoding."}, {"owner": {"reputation": 31, "user_id": 5709612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_WVePE4GrGs/AAAAAAAAAAI/AAAAAAAAAJI/haKuIBx-p0Y/photo.jpg?sz=128", "display_name": "matthewdavie", "link": "https://stackoverflow.com/users/5709612/matthewdavie"}, "edited": false, "score": 0, "creation_date": 1462223455, "post_id": 36849637, "comment_id": 61537673, "body": "wow, that&#39;s a bit convoluted, but at least it works to generate the URL. I&#39;ll pass this onto Google support as well."}, {"owner": {"reputation": 31, "user_id": 5709612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_WVePE4GrGs/AAAAAAAAAAI/AAAAAAAAAJI/haKuIBx-p0Y/photo.jpg?sz=128", "display_name": "matthewdavie", "link": "https://stackoverflow.com/users/5709612/matthewdavie"}, "reply_to_user": {"reputation": 4722, "user_id": 6061978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b9d44fdcdfcd8b61552ec455129ce0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/6061978/chris"}, "edited": false, "score": 1, "creation_date": 1464727027, "post_id": 36849637, "comment_id": 62599156, "body": "@chris FYI google has updated things so you can use the URL safe keys with the new cloud console URLs."}, {"owner": {"reputation": 4722, "user_id": 6061978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b9d44fdcdfcd8b61552ec455129ce0?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/6061978/chris"}, "edited": false, "score": 0, "creation_date": 1464729183, "post_id": 36849637, "comment_id": 62600229, "body": "@matthewdavie Well that&#39;s great. Makes things much easier for me. Thanks for the info."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 5709612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_WVePE4GrGs/AAAAAAAAAAI/AAAAAAAAAJI/haKuIBx-p0Y/photo.jpg?sz=128", "display_name": "matthewdavie", "link": "https://stackoverflow.com/users/5709612/matthewdavie"}, "is_accepted": true, "score": 0, "last_activity_date": 1464726999, "creation_date": 1464726999, "answer_id": 37555179, "question_id": 36849637, "link": "https://stackoverflow.com/questions/36849637/using-url-safe-keys-in-google-cloud-datastore/37555179#37555179", "title": "Using URL-safe keys in Google Cloud Datastore", "body": "<p>Google has updated the console to correctly process URL-safe keys, so this issue is now solved.</p>\n"}], "owner": {"reputation": 31, "user_id": 5709612, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_WVePE4GrGs/AAAAAAAAAAI/AAAAAAAAAJI/haKuIBx-p0Y/photo.jpg?sz=128", "display_name": "matthewdavie", "link": "https://stackoverflow.com/users/5709612/matthewdavie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 1, "accepted_answer_id": 37555179, "answer_count": 1, "score": 3, "last_activity_date": 1464726999, "creation_date": 1461613294, "question_id": 36849637, "link": "https://stackoverflow.com/questions/36849637/using-url-safe-keys-in-google-cloud-datastore", "title": "Using URL-safe keys in Google Cloud Datastore", "body": "<p>We're migrating from the old AppEngine Datastore console to the new  console. Internally, we have times when we're trying to generate links to specific datastore entities.</p>\n\n<p>For the old GAE console, you can use the encoded URL safe key to link to an entity, such as:</p>\n\n<p><code>return fmt.Sprintf(\"https://appengine.google.com/datastore/edit?key=%s\", key)</code></p>\n\n<p>where <code>key</code> is the encoded URL-safe key from the entity.</p>\n\n<p>However, in the new cloud console, Google returns \"failed to load\" when I try to load the URL:</p>\n\n<p><code>return fmt.Sprintf(\"https://console.cloud.google.com/datastore/entities/edit?key=%s\", key)</code></p>\n\n<p>where <code>key</code> is the encoded URL-safe key from the entity.</p>\n\n<p>It will load if I decode the key first and give the URL the namespace and kind, but only if it's the entity <strong>query</strong> page (not the edit page):</p>\n\n<p><code>return fmt.Sprintf(\"https://console.cloud.google.com/datastore/entities/query?ns=%s&amp;kind=%s&amp;key=%s\", namespace, kind, key)</code></p>\n\n<p>But the purpose of an encoded key is to not have to decode that.</p>\n\n<p>So my question:</p>\n\n<p>Is there a way to get the new cloud console to accept the encoded key and load the entity edit page?</p>\n"}, {"tags": ["parsing", "datetime", "go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1461610969, "creation_date": 1461610969, "answer_id": 36848991, "question_id": 36848858, "link": "https://stackoverflow.com/questions/36848858/how-do-i-parse-non-traditional-dates-in-golang/36848991#36848991", "title": "How do I parse non-traditional dates in golang?", "body": "<p>To parse a date in go you provide a format string that represents the date <code>Mon Jan 2 15:04:05 MST 2006</code> so in this case it would look like;</p>\n\n<pre><code>t, _ := time.Parse(\"02.01.2006\", \"25.04.2016\")\n</code></pre>\n\n<p>(play ground example; <a href=\"https://play.golang.org/p/6E9zshNeFG\" rel=\"nofollow\">https://play.golang.org/p/6E9zshNeFG</a> )</p>\n\n<p>Check the packages docs here; <a href=\"https://golang.org/pkg/time/#example_Parse\" rel=\"nofollow\">https://golang.org/pkg/time/#example_Parse</a></p>\n\n<p>I believe the arbitrary date you use as the example format is the first day of the Go programming language.</p>\n"}], "owner": {"reputation": 195, "user_id": 4496976, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5bf93c10eb38fe82f36076031146ff21?s=128&d=identicon&r=PG&f=1", "display_name": "ruby_noobie", "link": "https://stackoverflow.com/users/4496976/ruby-noobie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "closed_date": 1461611206, "accepted_answer_id": 36848991, "answer_count": 1, "score": 0, "last_activity_date": 1461610969, "creation_date": 1461610644, "question_id": 36848858, "link": "https://stackoverflow.com/questions/36848858/how-do-i-parse-non-traditional-dates-in-golang", "closed_reason": "Duplicate", "title": "How do I parse non-traditional dates in golang?", "body": "<p>I have this date, in this format:</p>\n\n<p>25.04.2016 </p>\n\n<p>I need to parse this into a Golang time object so that I can store it in my DB.</p>\n\n<p>What is the best way to do so? I can't find a standard parsing format that will do so.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1461610892, "post_id": 36848759, "comment_id": 61266751, "body": "Note that this issue isn&#39;t seen often, since most user types tend to be structs. When you access struct fields through a selector, the value is automatically dereferenced for you."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 475104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c9ac8acfee7cb7041d1a0196b41ea7?s=128&d=identicon&r=PG", "display_name": "Walt", "link": "https://stackoverflow.com/users/475104/walt"}, "edited": false, "score": 0, "creation_date": 1461612015, "post_id": 36848818, "comment_id": 61267433, "body": "Ah. I see. So I use * for both declaring a pointer and dereferencing? I assumed that because I had * in the receiver that I shouldn&#39;t have to worry about it any more."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 83, "user_id": 475104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c9ac8acfee7cb7041d1a0196b41ea7?s=128&d=identicon&r=PG", "display_name": "Walt", "link": "https://stackoverflow.com/users/475104/walt"}, "edited": false, "score": 0, "creation_date": 1461613669, "post_id": 36848818, "comment_id": 61268401, "body": "@Walt JimB explained in a comment on your question. With structs it&#39;s handled automatically so you don&#39;t often run into it but for the built in types it is necessary."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1461610480, "creation_date": 1461610480, "answer_id": 36848818, "question_id": 36848759, "link": "https://stackoverflow.com/questions/36848759/whats-happening-with-these-pointers/36848818#36848818", "title": "What&#39;s happening with these pointers?", "body": "<p>You have to use a pointer for the receiver - <code>(summaries *InvoiceSummaries)</code> - because otherwise the argument is passed by value, having a pointer means you pass a reference to the value instead. If not for that, then you couldn't modify the collection at all.</p>\n\n<p>Inside of the methods body you have use <code>*</code> because it is the dereferncing operator and returns the value at the address. Ampersand (<code>&amp;</code>) is the opposite, it gives the address of a value.</p>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1461617329, "creation_date": 1461617329, "answer_id": 36850782, "question_id": 36848759, "link": "https://stackoverflow.com/questions/36848759/whats-happening-with-these-pointers/36850782#36850782", "title": "What&#39;s happening with these pointers?", "body": "<p>Nothing wrong with your code but normally addresses to slices aren't used.  A slice is a small struct that gophers are normally happy to pass by value.  If a method or function is creating a new slice, the gopher is happy to return the new slice, by value again, as the return value.</p>\n\n<p>Of course passing a slice by value doesn't guarantee anything about the backing store remaining unchanged when the method/function returns.  So it can't be used as a way of guaranteeing the data elements of the slice haven't mutated.</p>\n"}, {"tags": [], "owner": {"reputation": 7910, "user_id": 1467988, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6b79aae3b24baa468857e9414873d9b1?s=128&d=identicon&r=PG", "display_name": "novalagung", "link": "https://stackoverflow.com/users/1467988/novalagung"}, "is_accepted": true, "score": 1, "last_activity_date": 1492673405, "last_edit_date": 1492673405, "creation_date": 1461654078, "answer_id": 36857520, "question_id": 36848759, "link": "https://stackoverflow.com/questions/36848759/whats-happening-with-these-pointers/36857520#36857520", "title": "What&#39;s happening with these pointers?", "body": "<blockquote>\n  <p>What is the purpose for each of these * ?</p>\n</blockquote>\n\n<p>By making the method receiver as pointer, you could easily change the property of the object. I think that's one of the benefit. This example below will prove it.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype someStruct struct {\n    someVar int\n}\n\nfunc (s someStruct) changeVal1(newVal int) {\n    s.someVar = newVal\n}\n\nfunc (s *someStruct) changeVal2(newVal int) {\n    s.someVar = newVal\n}\n\nfunc main() {\n    s := someStruct{0}\n    fmt.Println(s) // {0}\n\n    s.changeVal1(3)\n    fmt.Println(s) // {0}\n\n    s.changeVal2(4)\n    fmt.Println(s) // {4}\n\n    (&amp;s).changeVal2(5)\n    fmt.Println(s) // {5}\n}\n</code></pre>\n\n<blockquote>\n  <p>and why am I not using any &amp;?</p>\n</blockquote>\n\n<p>Pointer method receiver is quite special, it can also be called from non-pointer struct object. Both of <code>s.changeVal2(4)</code> and <code>(&amp;s).changeVal2(5)</code> are valid &amp; will affect the value of <code>someVar</code>.</p>\n\n<p>Example <a href=\"http://play.golang.org/p/sxCnCD2D6d\" rel=\"nofollow noreferrer\">http://play.golang.org/p/sxCnCD2D6d</a></p>\n"}], "owner": {"reputation": 83, "user_id": 475104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15c9ac8acfee7cb7041d1a0196b41ea7?s=128&d=identicon&r=PG", "display_name": "Walt", "link": "https://stackoverflow.com/users/475104/walt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 36857520, "answer_count": 3, "score": 0, "last_activity_date": 1492673405, "creation_date": 1461610289, "question_id": 36848759, "link": "https://stackoverflow.com/questions/36848759/whats-happening-with-these-pointers", "title": "What&#39;s happening with these pointers?", "body": "<p>I wrote some odd code, but I'm not sure why it works and what I can learn from it. I have a slice type build from another struct. I made a function on the slice type to modify itself. To do this, I seem to have to throw around *'s a little much.</p>\n\n<p>I'm trying to learn about pointers in Go and would like a little help. Here's an example (<a href=\"http://play.golang.org/p/roU3MEeT3q\" rel=\"nofollow\">http://play.golang.org/p/roU3MEeT3q</a>):</p>\n\n<pre><code>var ClientNames = []string {\"Client A\", \"Client B\", \"ClientC\"}\n\n\ntype InvoiceSummaries []InvoiceSummary\ntype InvoiceSummary struct {\n    Client string\n    Amt    int\n}\n\nfunc (summaries *InvoiceSummaries) BuildFromAbove() {\n    for _, name := range ClientNames {\n         *summaries = append(*summaries, InvoiceSummary{name, 100})\n    }\n}\n</code></pre>\n\n<p>My question is: What is the purpose for each of these * and why am I not using any &amp;?</p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461609932, "post_id": 36848414, "comment_id": 61266224, "body": "What have you tried? Have you looked at <a href=\"https://golang.org/pkg/os/#Getenv\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#Getenv</a> ?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1461609998, "post_id": 36848414, "comment_id": 61266251, "body": "Take a look at the <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">flag</a> buildin."}, {"owner": {"reputation": 3699, "user_id": 4816175, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/697df6176ef55a7ea25f159e0fcdec38?s=128&d=identicon&r=PG", "display_name": "cool breeze", "link": "https://stackoverflow.com/users/4816175/cool-breeze"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461612856, "post_id": 36848414, "comment_id": 61267922, "body": "@elithrar I&#39;m referring to how to give args to heroku when it starts up the app."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1461612887, "post_id": 36848414, "comment_id": 61267945, "body": "&quot;heroku env vars&quot; =&gt; <a href=\"https://devcenter.heroku.com/articles/config-vars\" rel=\"nofollow noreferrer\">devcenter.heroku.com/articles/config-vars</a>"}], "answers": [{"tags": [], "owner": {"reputation": 182, "user_id": 5622186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69af54f6a46bce1f6c539f86841ed8ef?s=128&d=identicon&r=PG", "display_name": "Kiramishima", "link": "https://stackoverflow.com/users/5622186/kiramishima"}, "is_accepted": false, "score": 1, "last_activity_date": 1461613743, "creation_date": 1461613743, "answer_id": 36849781, "question_id": 36848414, "link": "https://stackoverflow.com/questions/36848414/how-to-pass-startup-args-for-my-app/36849781#36849781", "title": "How to pass startup args for my app?", "body": "<p>First declare ENV variables in Heroku, ie:\n<code>heroku config:set APPMODE=PROD</code>\nthen in you app, import the os package and call Getenv.\nExample:</p>\n\n<pre><code>package main\n\nimport 'os'\n\nvar appmode string\nfunc init () {\n   appmode = os.Getenv(\"APPMODE\") // PROD\n}\n</code></pre>\n\n<p>Other option, using the flag package.\nExample:</p>\n\n<pre><code>// flagsoverflow\npackage main\n\nimport \"flag\"\n\nvar AppMode string \n\nfunc init () {\n   AppMode = flag.String(\"appmode\", \"DEV\", \"help message for flagname\") // Defaul Value DEV\n}\n\nThen when u build u application u can run with flag options:\n\n./flagsoverflow -appmode=PROD // Set the Value to PROD\n</code></pre>\n\n<p>Refs: <a href=\"https://devcenter.heroku.com/articles/config-vars\" rel=\"nofollow\">https://devcenter.heroku.com/articles/config-vars</a></p>\n\n<p>os: <a href=\"https://golang.org/pkg/os/#Getenv\" rel=\"nofollow\">https://golang.org/pkg/os/#Getenv</a></p>\n\n<p>Flags: <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow\">https://golang.org/pkg/flag/</a></p>\n"}], "owner": {"reputation": 3699, "user_id": 4816175, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/697df6176ef55a7ea25f159e0fcdec38?s=128&d=identicon&r=PG", "display_name": "cool breeze", "link": "https://stackoverflow.com/users/4816175/cool-breeze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461613743, "creation_date": 1461609096, "question_id": 36848414, "link": "https://stackoverflow.com/questions/36848414/how-to-pass-startup-args-for-my-app", "title": "How to pass startup args for my app?", "body": "<p>I want to pass startup arguments in my app so I can tell the application to load in either DEV or PROD settings.</p>\n\n<p>How can I do this on heroku?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461602165, "post_id": 36846166, "comment_id": 61261685, "body": "In your example, you have a directional channel (note the arrow in the param), so two way communication isn&#39;t possible with this sample code."}, {"owner": {"reputation": 543, "user_id": 3418791, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/eeb7d9f08fec68db1f5b0c823bf70e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Warrior", "link": "https://stackoverflow.com/users/3418791/warrior"}, "edited": false, "score": 1, "creation_date": 1461602218, "post_id": 36846166, "comment_id": 61261722, "body": "To make it a two ways channel just remove the arrow (a chan string) instead of (a &lt;-chan string)"}, {"owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461602297, "post_id": 36846166, "comment_id": 61261775, "body": "@william.taylor.09 In this case, we need to know the size of growth in that channel. In my case, I don&#39;t know how much can it expand"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1461602525, "post_id": 36846166, "comment_id": 61261887, "body": "The channel does not change it&#39;s size dynamically. You can allocate a buffered channel, meaning it can hold a given amount of items before senders block but by default the channel only allows for one item at a time."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1461602546, "post_id": 36846166, "comment_id": 61261899, "body": "I&#39;m not understanding what you mean by size of growth. What is your use case?"}, {"owner": {"reputation": 543, "user_id": 3418791, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/eeb7d9f08fec68db1f5b0c823bf70e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Warrior", "link": "https://stackoverflow.com/users/3418791/warrior"}, "edited": false, "score": 0, "creation_date": 1461602742, "post_id": 36846166, "comment_id": 61262019, "body": "A channel blocks by default, if you specify a size it will buffer up to x elements before blocking. If you don&#39;t specify a size you&#39;ll have to have atleast one producer and one consumer otherwise the program will enter deadlock mode"}, {"owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "edited": false, "score": 0, "creation_date": 1461602844, "post_id": 36846166, "comment_id": 61262077, "body": "I am trying to be able to write as well as read into the same channel because I have a recursive architecture. It might not be obvious at this abstract description. But what I wanted is (a chan string) instead of (a &lt;-chan string). This does for me!"}, {"owner": {"reputation": 543, "user_id": 3418791, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/eeb7d9f08fec68db1f5b0c823bf70e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Warrior", "link": "https://stackoverflow.com/users/3418791/warrior"}, "edited": false, "score": 0, "creation_date": 1461602849, "post_id": 36846166, "comment_id": 61262080, "body": "By the way, for it to be a two ways channels it has to be created as such. If it is created as read only channel you won&#39;t be able to change it to read/write channel."}], "answers": [{"tags": [], "owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "is_accepted": false, "score": 0, "last_activity_date": 1586223784, "last_edit_date": 1586223784, "creation_date": 1461602686, "answer_id": 36846429, "question_id": 36846166, "link": "https://stackoverflow.com/questions/36846166/send-and-recieve-using-channel-in-same-function/36846429#36846429", "title": "Send and recieve using channel in same function", "body": "<p>As commented by @Warrior:</p>\n\n<p>In the code referred above, the directional pointer with channel restricts the function to do any other activity on that channel instead of the one that is allowed. So, making it:</p>\n\n<pre><code>func server (a chan string) {\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>func server (a &lt;-chan string) {\n</code></pre>\n\n<p>will allow the function to send as well as receive data through the same channel.</p>\n"}], "owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586223784, "creation_date": 1461601924, "last_edit_date": 1461603696, "question_id": 36846166, "link": "https://stackoverflow.com/questions/36846166/send-and-recieve-using-channel-in-same-function", "title": "Send and recieve using channel in same function", "body": "<p>How can I make a channel 2-way (I don't know if this is right term) in the same function. If I have the following code, then:</p>\n\n<pre><code>func server (a &lt;-chan string) {\n    data:= &lt;-a\n    // now is there a way I can send data through the same channel\n    // data &lt;- \"yet another string\"\n}  \n</code></pre>\n\n<p>Is there anyother way of implementing this ? Appreciate any help.</p>\n"}, {"tags": ["android", "http", "google-app-engine", "post", "go"], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1461616863, "creation_date": 1461616863, "answer_id": 36850671, "question_id": 36846002, "link": "https://stackoverflow.com/questions/36846002/parameter-sent-from-android-app-by-posting-always-be-empty-on-backend-server-wri/36850671#36850671", "title": "Parameter sent from android app by posting always be empty on backend server written in Go language", "body": "<p>It looks like the handler in go should work, and also that the java code should send a proper request. Usually in these cases, it is useful to test the parts separately.</p>\n\n<p>One way to test the server is to use <code>curl</code> to send a request to the server, as in</p>\n\n<pre><code>curl -v --data \"idToken=theToken\" http://itforhr.com/webservice/android-sign-in\n</code></pre>\n\n<p>and check if that works. If it works, then you know the problem is on the client side, if not, it is probably on the server side.</p>\n\n<p>You could further check what the server is actually receiving by reading the body without parsing it:</p>\n\n<pre><code>b, _ := ioutil.ReadAll(r.Body)\nfmt.Print(string(b))\n</code></pre>\n\n<p>Or dump it after parsing:</p>\n\n<pre><code>r.ParseForm()\nfmt.Printf(\"%#v\", r.Form)\n</code></pre>\n\n<p>I hope this should help you understand where the problem is.</p>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461616863, "creation_date": 1461601409, "question_id": 36846002, "link": "https://stackoverflow.com/questions/36846002/parameter-sent-from-android-app-by-posting-always-be-empty-on-backend-server-wri", "title": "Parameter sent from android app by posting always be empty on backend server written in Go language", "body": "<p>I am trying to post a token by using SendUserIdTokenToBackend() method in an android app.   </p>\n\n<pre><code>private class SendUserIdTokenToBackend extends AsyncTask&lt;String, Void, String&gt; {\n\n    private Exception exception;\n\n    @Override\n    protected String doInBackground(String... idToken) {\n        Log.d(TAG, \"idToken\" + idToken);\n        try {\n            List&lt;Pair&gt; params = new ArrayList&lt;Pair&gt;();\n            Pair&lt;String, String&gt; pair = Pair.create(\"idToken\", idToken[0]);\n            params.add(pair);\n            String paramString = getQuery(params);\n\n            URL url = new URL(\"http://itforhr.com/webservice/android-sign-in\");\n            HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n            conn.setRequestMethod(\"POST\");\n\n            conn.setDoOutput(true);\n            OutputStream os = conn.getOutputStream();\n\n            BufferedWriter writer = new BufferedWriter(\n                    new OutputStreamWriter(os, \"UTF-8\"));\n\n            writer.write(paramString);\n\n            writer.flush();\n            writer.close();\n            os.close();\n\n            Log.d(TAG, \"getQuery:\" + paramString);\n\n\n            conn.connect();\n\n            BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));\n            StringBuilder stringBuilder = new StringBuilder();\n\n            String line = null;\n            while ((line = reader.readLine()) != null)\n            {\n                stringBuilder.append(line + \"\\n\");\n            }\n\n            return stringBuilder.toString();\n\n\n        } catch (Exception e) {\n\n            return  \"Error sending ID token to backend. \" + e.toString();\n        }\n    }\n\n    @Override\n    protected void onPostExecute(String result) {\n\n\n        mIdTokenTextView.setText(getString(R.string.id_token_fmt, result));\n    }\n}\n\n\nprivate String getQuery(List&lt;Pair&gt; params) throws UnsupportedEncodingException\n{\n    StringBuilder result = new StringBuilder();\n    boolean first = true;\n\n    for (Pair pair : params)\n    {\n        if (first)\n            first = false;\n        else\n            result.append(\"&amp;\");\n\n        result.append(URLEncoder.encode(pair.first.toString(), \"UTF-8\"));\n        result.append(\"=\");\n        result.append(URLEncoder.encode(pair.second.toString(), \"UTF-8\"));\n    }\n\n    return result.toString();\n}\n</code></pre>\n\n<p>Log.d results are ok. I see token id printed correctly in the log.</p>\n\n<p>However on the server side, I can't get idToken parameter </p>\n\n<pre><code>    func init() {\n        http.HandleFunc(\"/webservice/android-sign-in/\", androidSignInHandler)\n    }\n\n    func androidSignInHandler(w http.ResponseWriter, r *http.Request) {\n\n        log.Println(\"(-------- Entering androidSignInHandler --------)\")\n\n        ctx := appengine.NewContext(r)\n\n        idToken := r.FormValue(\"idToken\")\n\n        client := urlfetch.Client(ctx)\n        _, err := client.Get(\"https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=\" + idToken)\n\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        } else {\n\n            w.Header().Set(\"Content-Type\", \"text/html\")\n\n            fmt.Fprintf(w, \"%v and %v\", r.PostForm, idToken)\n\n        }\n\n        log.Println(\"(-------- Exiting androidSignInHandler --------)\")\n\n    }\n</code></pre>\n\n<p>fmt printed out \"<em>map[] and</em>\",idToken is empty. I tried calling parseForm() before getting idToken parameter but it didn't work. I have been stuck here for two nights. Please help.</p>\n"}, {"tags": ["go", "path", "relative-path"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1461594585, "post_id": 36843144, "comment_id": 61256573, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests\">how to reference a relative file from code and tests</a>"}, {"owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461594976, "post_id": 36843144, "comment_id": 61256900, "body": "No it does not look to be duplicate. There topicstarter uses some revel framework, when for me it fails for base golang functionality..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461595055, "post_id": 36843144, "comment_id": 61256968, "body": "Please read the <a href=\"http://stackoverflow.com/a/31059125/1705598\">answer I gave there</a> and don&#39;t get blocked by the word &quot;revel&quot;."}, {"owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461595240, "post_id": 36843144, "comment_id": 61257114, "body": "Hmm im not sure what exactly do u suggest.. A base path for the cert files is exactly same. The difference in the caller path. Having known my basepath how would i use it in golang to restore fullpath?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461595644, "post_id": 36843144, "comment_id": 61257406, "body": "You may use <a href=\"https://golang.org/pkg/path/#Join\" rel=\"nofollow noreferrer\"><code>path.Join()</code></a> or <a href=\"https://golang.org/pkg/path/filepath/#Join\" rel=\"nofollow noreferrer\"><code>filepath.Join()</code></a> to get the full path. I edited <a href=\"http://stackoverflow.com/a/31059125/1705598\">my answer</a> to show an example of it."}, {"owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461596136, "post_id": 36843144, "comment_id": 61257777, "body": "Well, not exactly what i meant. path.Join simply combines two paths, it has no idea whether the path is correct. I need somethin like MapPath from .NET framework - <a href=\"https://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath(v=vs.100).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a> to build absolute path for given relative. In golang Join i need to know a callers  path in order to build absolute for given(known)  base path."}, {"owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461599394, "post_id": 36843144, "comment_id": 61260069, "body": "Ok, i stopped looking for an answer assuming GOPATH is the root directory for every file in my project i build absolute path from there..."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461603084, "post_id": 36843144, "comment_id": 61262204, "body": "Now what happens when you delpoy your program to the target system where there&#39;s no <code>GOPATH</code>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461603378, "post_id": 36843144, "comment_id": 61262372, "body": "Ah, now that you&#39;ve mentioned <code>MapPath()</code>, I see where you&#39;re leading to. The problem is that that function is supposed to work in the context of IIS, which makes the .NET handler running your code know where is the base path of the deployed application.  Go does not (yet) provide an ISAPI handler and so your Go application is &quot;free standing&quot; in the sense it&#39;s not coupled with a web server (or is quite loosly so -- if it&#39;s a CGI or FastCGI handler). Hence I&#39;m with @icza on this: make your &quot;base path&quot; configurable."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461603522, "post_id": 36843144, "comment_id": 61262449, "body": "In the simplest case you might default your base path to be just &quot;.&quot;, but then make sure your program actually calls <code>os.Chdir(&quot;.&quot;)</code> somewhere early at startup -- to make the value of the current directory predictable. All-in-all, the most sensible approach does really depend on how you intend to start your program on the target system."}, {"owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461656376, "post_id": 36843144, "comment_id": 61284621, "body": "@kostix, well in case my GOPATH is not set app not gonna work.. This might be any different global variable setting root path for the app. Having it configurable would mean to have it saved in some configuration file placed somewhere in the project, but in this case ill need to load it in the app once again which in turn pushes me back to the same problem. Having global variables looks to be sufficient in Golang work to be used for setting up an apps."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1461599997, "creation_date": 1461599997, "answer_id": 36845557, "question_id": 36843144, "link": "https://stackoverflow.com/questions/36843144/relative-path-in-go/36845557#36845557", "title": "Relative path in Go", "body": "<p>Use the <a href=\"http://godoc.org/go/build\" rel=\"nofollow\">go/build</a> package to find the absolute path of a package in a Go workspace:</p>\n\n<pre><code>importPath := \"github.com/user/root/main\" // modify to match import path of main\np, err := build.Default.Import(importPath, \"\", build.FindOnly)\nif err != nil {\n    // handle error\n}\ncertsDir := filepath.Join(p.Dir, \"certs\")\n</code></pre>\n\n<p>This only works when run in the context of a Go workspace (the source code is available and GOPATH is set).</p>\n"}], "owner": {"reputation": 1084, "user_id": 2915603, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ea6fc9bc47d33adfb6e88ce2909f1a80?s=128&d=identicon&r=PG", "display_name": "ArkadyB", "link": "https://stackoverflow.com/users/2915603/arkadyb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3967, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1567861757, "creation_date": 1461593682, "last_edit_date": 1567861757, "question_id": 36843144, "link": "https://stackoverflow.com/questions/36843144/relative-path-in-go", "title": "Relative path in Go", "body": "<p>I'm trying to understand a relative path building in Go. Here is my problem: I have a folders tree:</p>\n\n<pre><code>-root\n--main\n---utils\n---certs\n--tests\n</code></pre>\n\n<p>Having my certificates uploaded into certs folder and connectivity <code>util.go</code> file uploaded into <code>utils</code>, I have relative paths hard coded in the file. </p>\n\n<p>Problem: Having paths specified in <code>utils/util.go</code>, they work fine once called from <code>main/main.go</code> and throw exception (file not found) when called from <code>tests/test.go</code>.</p>\n\n<p>What's the way out?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "edited": false, "score": 0, "creation_date": 1461591507, "post_id": 36842217, "comment_id": 61254218, "body": "can you please explain, what it does. It actually fixed!"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 5, "last_activity_date": 1461591816, "last_edit_date": 1461591816, "creation_date": 1461591421, "answer_id": 36842217, "question_id": 36842161, "link": "https://stackoverflow.com/questions/36842161/slicing-using-pointer-to-a-slice/36842217#36842217", "title": "Slicing using pointer to a slice", "body": "<p>You should use operator <code>...</code> to convert slice into list of variadic arguments.</p>\n\n<pre><code> b = append(b, tmp[:1]...)\n b = append(b, tmp[2:]...)\n</code></pre>\n"}], "owner": {"reputation": 406, "user_id": 5670261, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/9e94e9182dd035b7a6f8e83d65ed1a8a?s=128&d=identicon&r=PG&f=1", "display_name": "dvlper", "link": "https://stackoverflow.com/users/5670261/dvlper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 36842217, "answer_count": 1, "score": 1, "last_activity_date": 1461591816, "creation_date": 1461591256, "question_id": 36842161, "link": "https://stackoverflow.com/questions/36842161/slicing-using-pointer-to-a-slice", "title": "Slicing using pointer to a slice", "body": "<p>I am trying to modify slice a slice in another function, using the following code:</p>\n\n<pre><code>type DT struct {\n    name string\n    number int\n}\n\nfunc slicer(a *[]DT) {\n    tmp := *a\n    var b []DT\n    b = append(b, tmp[:1], tmp[2:])\n    *a = b\n}\n\nfunc main() {\n    o1 := DT {\n        name: \"name-1\",\n        number: 1,\n    }\n    o2 := DT {\n        name: \"name-2\",\n        number: 2,\n    }\n    o3 := DT {\n        name: \"name-3\",\n        number: 3,\n    }\n\n    b := make([]DT, 0)\n    b = append(b, o1)\n    b = append(b, o2)\n    b = append(b, o3)\n\n    slicer(&amp;b)\n    fmt.Println(b)\n}\n</code></pre>\n\n<p>What I want is, 1st and last element of the slice. But, in doing so, I am getting following error:</p>\n\n<pre><code>cannot use tmp[:1] (type []DT) as type DT in append\n</code></pre>\n\n<p>I am relatively new to Go Language, so kindly guide me through this one!</p>\n"}, {"tags": ["android", "http", "post", "go"], "comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 0, "creation_date": 1461585430, "post_id": 36839830, "comment_id": 61249617, "body": "Please share your Android request code"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 1, "creation_date": 1461585701, "post_id": 36839830, "comment_id": 61249764, "body": "<code>request.ParseForm()</code> isn&#39;t working?"}], "answers": [{"tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": true, "score": 6, "last_activity_date": 1461590439, "last_edit_date": 1461590439, "creation_date": 1461585649, "answer_id": 36839973, "question_id": 36839830, "link": "https://stackoverflow.com/questions/36839830/make-go-http-response-verbose-all-parameters/36839973#36839973", "title": "Make Go http.Response verbose all parameters", "body": "<p>The <a href=\"https://golang.org/src/net/http/request.go?s=2057:8999#L64\" rel=\"nofollow\">Request</a> structure in go has a <code>Form</code> field which is populated with request parameters after <code>ParseForm()</code> is called.</p>\n\n<blockquote>\n  <p>Form contains the parsed form data, including both the URL field's\n  query parameters and the POST or PUT form data.This field is only\n  available after ParseForm is called. The HTTP client ignores Form and\n  uses Body instead.</p>\n</blockquote>\n\n<p>You could try adding the following code after receiving a request:</p>\n\n<pre><code>func(w http.ResponseWriter, request *http.Request) {\n    request.ParseForm()\n    log.Printf(\"%v\",request.Form)\n\n    //....\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1461589491, "creation_date": 1461589491, "answer_id": 36841464, "question_id": 36839830, "link": "https://stackoverflow.com/questions/36839830/make-go-http-response-verbose-all-parameters/36841464#36841464", "title": "Make Go http.Response verbose all parameters", "body": "<p>If this is for debugging, you can use <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequest\" rel=\"nofollow\">DumpRequest</a>:</p>\n\n<pre><code>func(w http.ResponseWriter, r *http.Request) {\n    dump, err := httputil.DumpRequest(r, true)\n    if err != nil {\n        http.Error(w, fmt.Sprint(err), http.StatusInternalServerError)\n        return\n    }\n    log.Printf(\"%s\", dump)\n}\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 36839973, "answer_count": 2, "score": 0, "last_activity_date": 1461590439, "creation_date": 1461585294, "question_id": 36839830, "link": "https://stackoverflow.com/questions/36839830/make-go-http-response-verbose-all-parameters", "title": "Make Go http.Response verbose all parameters", "body": "<p>I am having a problem getting a parameter sent from android app into go application. I called r.FormValue(key) but it returned null. I want to find the way to check what are parameters available on Go side after the android app sent the post data to it. Is there any way to do this, getting all parameters without using keys?</p>\n"}, {"tags": ["git", "docker", "go", "proxy", "glide-golang"], "comments": [{"owner": {"reputation": 3119, "user_id": 1829772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7972e3d4c6efd39840dacb7d8b91267?s=128&d=identicon&r=PG", "display_name": "CFrei", "link": "https://stackoverflow.com/users/1829772/cfrei"}, "edited": false, "score": 0, "creation_date": 1461574007, "post_id": 36835685, "comment_id": 61242078, "body": "Can you access that git link on the docker host with <code>curl</code> or <code>wget</code>? Does not sound like a docker issue and the error message is quite clear: unable to access &#39;<a href=\"https://github.com/Masterminds/glide.git/\" rel=\"nofollow noreferrer\">github.com/Masterminds/glide.git</a>&#39;: Failed to connect to github.com."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5845158"}, "reply_to_user": {"reputation": 3119, "user_id": 1829772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7972e3d4c6efd39840dacb7d8b91267?s=128&d=identicon&r=PG", "display_name": "CFrei", "link": "https://stackoverflow.com/users/1829772/cfrei"}, "edited": false, "score": 0, "creation_date": 1461574323, "post_id": 36835685, "comment_id": 61242285, "body": "curl: (5) Couldn&#39;t resolve proxy &#39;xxxxx@proxy.xxxxxx.ch&#39;. my password is: xxxxxxxxxxxxxx@xxxxx. i think it has something to do with that &quot;@&quot;. i changed it to %40"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5845158"}, "reply_to_user": {"reputation": 3119, "user_id": 1829772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7972e3d4c6efd39840dacb7d8b91267?s=128&d=identicon&r=PG", "display_name": "CFrei", "link": "https://stackoverflow.com/users/1829772/cfrei"}, "edited": false, "score": 0, "creation_date": 1461575471, "post_id": 36835685, "comment_id": 61242996, "body": "no it did not... @CFrei"}, {"owner": {"reputation": 3119, "user_id": 1829772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7972e3d4c6efd39840dacb7d8b91267?s=128&d=identicon&r=PG", "display_name": "CFrei", "link": "https://stackoverflow.com/users/1829772/cfrei"}, "edited": false, "score": 0, "creation_date": 1461579725, "post_id": 36835685, "comment_id": 61245802, "body": "find out why you can&#39;t reach github from the docker host. Can you ping github? Do you have a proxy issue? (I don&#39;t understand that &quot;couldn&#39;t resolve proxy&#39;-thing...)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5845158"}, "reply_to_user": {"reputation": 3119, "user_id": 1829772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7972e3d4c6efd39840dacb7d8b91267?s=128&d=identicon&r=PG", "display_name": "CFrei", "link": "https://stackoverflow.com/users/1829772/cfrei"}, "edited": false, "score": 0, "creation_date": 1461835137, "post_id": 36835685, "comment_id": 61383165, "body": "The password had a &quot;-&quot; in it and github doesn&#39;t like &quot;-&quot; so I had to change the password. Percent-writing wasn&#39;t accepted. Now it works"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5845158"}, "is_accepted": true, "score": 1, "last_activity_date": 1461835171, "creation_date": 1461835171, "answer_id": 36910333, "question_id": 36835685, "link": "https://stackoverflow.com/questions/36835685/docker-build-failed-because-of-port-443-connection-timed-out/36910333#36910333", "title": "Docker build failed because of &quot;port 443: Connection timed out&quot;", "body": "<p>The password had a \"-\" in it and github doesn't like \"-\" so I had to change the password. Percent-writing wasn't accepted. Now it works.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5845158"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 1, "accepted_answer_id": 36910333, "answer_count": 1, "score": 1, "last_activity_date": 1553439130, "creation_date": 1461573705, "last_edit_date": 1553439130, "question_id": 36835685, "link": "https://stackoverflow.com/questions/36835685/docker-build-failed-because-of-port-443-connection-timed-out", "title": "Docker build failed because of &quot;port 443: Connection timed out&quot;", "body": "<pre><code>$ docker build buehler/twitterbeat\nSending build context to Docker daemon 96.26 kB\nStep 1 : FROM golang:1.5.2\n ---&gt; 9c67771abd78\nStep 2 : MAINTAINER Christoph Buehler &lt;christoph.buehler@bluewin.ch&gt;\n ---&gt; Using cache\n ---&gt; 57cbdd07c195\nStep 3 : ENV GO15VENDOREXPERIMENT 1\n ---&gt; Using cache\n ---&gt; fd69aeb2425d\nStep 4 : RUN git clone https://github.com/Masterminds/glide.git $GOPATH/src/github.com/Masterminds/glide &amp;&amp;     cd $GOPATH/src/github.com/Masterminds/glide &amp;&amp;     make bootstrap &amp;&amp;     make build &amp;&amp;     cp ./glide /usr/bin\n ---&gt; Running in 025c97c1cba1\nCloning into '/go/src/github.com/Masterminds/glide'...\nfatal: unable to access 'https://github.com/Masterminds/glide.git/': Failed to connect to github.com port 443: Connection timed out\nThe command '/bin/sh -c git clone https://github.com/Masterminds/glide.git $GOPATH/src/github.com/Masterminds/glide &amp;&amp;     cd $GOPATH/src/github.com/Masterminds/glide &amp;&amp;     make bootstrap &amp;&amp;     make build &amp;&amp;     cp ./glide /usr/bin' returned a non-zero code: 128\n</code></pre>\n\n<p>I want to build an elastic beat (twitterbeat by buehler) with docker.\nI get this error even if I set the proxies. I restarted the machine as well.\nI tried everything that is in the other disucussions. (Encoding password, set proxy for git, etc.)</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["debugging", "go", "visual-studio-code", "delve"], "comments": [{"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "edited": false, "score": 0, "creation_date": 1461573229, "post_id": 36834557, "comment_id": 61241564, "body": "What directory are you in? I imagine there should be a Makefile in there."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 5519235, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OLhZkYFj3p8/AAAAAAAAAAI/AAAAAAAAJS0/8KExqJlXPhQ/photo.jpg?sz=128", "display_name": "Jan \u010cejka", "link": "https://stackoverflow.com/users/5519235/jan-%c4%8cejka"}, "is_accepted": false, "score": 1, "last_activity_date": 1461592945, "creation_date": 1461592945, "answer_id": 36842850, "question_id": 36834557, "link": "https://stackoverflow.com/questions/36834557/debugging-go-on-vscode-using-delve/36842850#36842850", "title": "Debugging GO on VSCode using Delve", "body": "<p>Run <strong>mingw32-make install</strong> command from directory created by <strong>git clone <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow\">https://github.com/derekparker/delve</a></strong> command.</p>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 1525989, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9aca9154b8867a228b8a395a36cd3150?s=128&d=identicon&r=PG", "display_name": "Shehan Tis", "link": "https://stackoverflow.com/users/1525989/shehan-tis"}, "is_accepted": true, "score": 5, "last_activity_date": 1463563078, "creation_date": 1463563078, "answer_id": 37295237, "question_id": 36834557, "link": "https://stackoverflow.com/questions/36834557/debugging-go-on-vscode-using-delve/37295237#37295237", "title": "Debugging GO on VSCode using Delve", "body": "<p>I managed to get this resolved. You don't want to install mingw for this. Instead run this code and make sure the dlv.exe which is created in any directory which is in your PATH variable in your computer.</p>\n\n<pre><code>$go get -u github.com/derekparker/delve/cmd/dlv\n</code></pre>\n\n<p>I also did an writeup about debugging Golang using VSCode and Delve. If you are interested you can read it <a href=\"http://www.tistuslabs.com/how-to-setup-visual-studio-code-to-debug-golang-with-delve/\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 127, "user_id": 1525989, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9aca9154b8867a228b8a395a36cd3150?s=128&d=identicon&r=PG", "display_name": "Shehan Tis", "link": "https://stackoverflow.com/users/1525989/shehan-tis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4337, "favorite_count": 0, "accepted_answer_id": 37295237, "answer_count": 2, "score": 5, "last_activity_date": 1463563078, "creation_date": 1461569912, "question_id": 36834557, "link": "https://stackoverflow.com/questions/36834557/debugging-go-on-vscode-using-delve", "title": "Debugging GO on VSCode using Delve", "body": "<p>I want to debug GoLang on VSCode editor. In their documentation they say it is possible. I am following the following Link to install the debugging features on the IDE.\n<a href=\"https://marketplace.visualstudio.com/items?itemName=lukehoban.Go\" rel=\"noreferrer\">https://marketplace.visualstudio.com/items?itemName=lukehoban.Go</a></p>\n\n<p>And to install Delve they ask to follow these instructions\n<a href=\"https://github.com/derekparker/delve/blob/master/Documentation/installation/windows/install.md\" rel=\"noreferrer\">https://github.com/derekparker/delve/blob/master/Documentation/installation/windows/install.md</a></p>\n\n<p>Once installation is completed they ask to run the following code</p>\n\n<blockquote>\n  <p>$ mingw32-make install</p>\n</blockquote>\n\n<p>But there is an error</p>\n\n<blockquote>\n  <p>mingw32-make: *** No rule to make target 'install'.  Stop.</p>\n</blockquote>\n\n<p>Does anybody know whats wrong with this? Has anything changed other than these instructions?</p>\n"}, {"tags": ["mongodb", "go", "mgo", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1461599407, "post_id": 36832335, "comment_id": 61260082, "body": "Thanks for the tip. I added <code>form:&quot;username&quot;</code> etc to the struct but still the fields in new objects are saved as empty in the databases."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1461650816, "post_id": 36832335, "comment_id": 61281176, "body": "have no idea, may be track gin form parser codes, seems not a hard work."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 2, "last_activity_date": 1461560546, "creation_date": 1461560546, "answer_id": 36832335, "question_id": 36832072, "link": "https://stackoverflow.com/questions/36832072/cannot-insert-form-data-into-database-using-mgo-in-gin/36832335#36832335", "title": "Cannot insert form data into database using mgo in gin", "body": "<p>according to the gin document, you need <code>form</code> tag to struct fields. like:</p>\n\n<pre><code>User     string `form:\"user\" binding:\"required\"`\nPassword string `form:\"password\" binding:\"required\"`\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1489486020, "creation_date": 1461558865, "last_edit_date": 1489486020, "question_id": 36832072, "link": "https://stackoverflow.com/questions/36832072/cannot-insert-form-data-into-database-using-mgo-in-gin", "title": "Cannot insert form data into database using mgo in gin", "body": "<p>I'm new to Go and using gin framework trying to create a user object:</p>\n\n<pre><code>const (\n    // CollectionArticle holds the name of the users collection\n    CollectionUser = \"users\"\n)\n\n\n// User table contains the information for each user\ntype User struct {\n    ID  bson.ObjectId `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    Username string        `json:\"username\" bson:\"username\"`\n    Email     string        `json:\"email\" bson:\"email\"`\n    Password  string        `json:\"password\" bson:\"password\"`\n    StatusID  uint8         `json:\"status_id\" bson:\"status_id\"`\n    CreatedAt time.Time     `json:\"created_at\" bson:\"created_at\"`\n    UpdatedAt time.Time     `json:\"updated_at\" bson:\"updated_at\"`\n    Deleted   uint8         `json:\"deleted\" bson:\"deleted\"`\n}\n</code></pre>\n\n<p>This is the controller to create user</p>\n\n<pre><code>// Create a user\nfunc Create(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n\n    //to help debugging\n    x, _ := ioutil.ReadAll(c.Request.Body)\n    log.Printf(\"request body is: %s \\n\", string(x)) \n\n    user := models.User{}\n    err := c.Bind(&amp;user)\n    if err != nil {\n        c.Error(err)\n        return\n    }\n\n    //to help debugging\n    log.Printf(\"user is: %v\", user )\n    log.Printf(\"username is: %s and emails is %s\", user.Username, user.Email )  \n\n    err = db.C(models.CollectionUser).Insert(user)\n    if err != nil {\n        c.Error(err)\n    }\n    c.Redirect(http.StatusMovedPermanently, \"/users\")\n}\n</code></pre>\n\n<p>And the registration form is:</p>\n\n<pre><code>  &lt;form action=\"/user/create\" method=\"POST\"&gt;\n\n\n    &lt;div class=\"form-group\"&gt;\n      &lt;label for=\"username\"&gt;Username&lt;/label&gt;\n      &lt;input type=\"text\" name=\"username\" class=\"form-control\" id=\"username\" placeholder=\"Enter the username of the user\" &gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n      &lt;label for=\"email\"&gt;Email&lt;/label&gt;\n      &lt;input name=\"email\" class=\"form-control\" placeholder=\"Enter user email\" /&gt;\n    &lt;/div&gt;\n\n    &lt;div class=\"form-group\"&gt;\n    &lt;label for=\"password\"&gt;Password&lt;/label&gt;\n        &lt;input type=\"password\" name=\"password\" class=\"form-control\" placeholder=\"Password\" required&gt;\n    &lt;/div&gt;\n\n    &lt;button type=\"submit\" class=\"btn btn-default\"&gt;Submit&lt;/button&gt;\n\n  &lt;/form&gt;\n</code></pre>\n\n<p>In the terminal I get:</p>\n\n<pre><code>[GIN-debug] Listening and serving HTTP on :7000\n[GIN] 2016/04/25 - 06:30:04 | 200 |     549.499\u00b5s | 127.0.0.1 |   GET     /register\nrequest body is: username=bob&amp;email=bob%40me.com&amp;password=1234 \nuser is: {ObjectIdHex(\"\")    0 0001-01-01 00:00:00 +0000 UTC 0001-01-01 00:00:00 +0000 UTC 0}\nusername is:  and emails is \n</code></pre>\n\n<p>AS you can see <code>username</code>, <code>email</code> and <code>password</code> field values are passed to the controller. When I check <code>users</code> collection in the the mongo database, I see that the objects are created but the fields submitted from the form are empty. \nI could not figure out why this happens, so appreciate your hints. </p>\n"}, {"tags": ["date", "go", "time"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1461562292, "post_id": 36830212, "comment_id": 61235976, "body": "<code>LastDay</code> won&#39;t be right if there&#39;s a transition to or from DST in the last day of the month in your local timezone."}], "answers": [{"tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 47, "last_activity_date": 1461543344, "creation_date": 1461543344, "answer_id": 36830387, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/36830387#36830387", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p><code>time.Month</code> is a type, not a value, so you can't <code>Add</code> it.  Also, your logic is wrong because if you add a month and subtract a day, you aren't getting the end of the month, you're getting something in the middle of next month.  If today is 24 April, you'll get 23 May.</p>\n\n<p>The following code will do what you're looking for:</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"fmt\"\n)\n\nfunc main() {\n    now := time.Now()\n    currentYear, currentMonth, _ := now.Date()\n    currentLocation := now.Location()\n\n    firstOfMonth := time.Date(currentYear, currentMonth, 1, 0, 0, 0, 0, currentLocation)\n    lastOfMonth := firstOfMonth.AddDate(0, 1, -1)\n\n    fmt.Println(firstOfMonth)\n    fmt.Println(lastOfMonth)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/F7GoesAAcK\">Playground link</a></p>\n"}, {"comments": [{"owner": {"reputation": 9858, "user_id": 973380, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b760f503c84d1bf47322f401066c753f?s=128&d=identicon&r=PG", "display_name": "fiatjaf", "link": "https://stackoverflow.com/users/973380/fiatjaf"}, "edited": false, "score": 0, "creation_date": 1489321325, "post_id": 36830416, "comment_id": 72611409, "body": "If you don&#39;t wanna use this library you can at least learn from the way it does (you can actually copy the parts that you need): <a href=\"https://github.com/jinzhu/now/blob/master/now.go\" rel=\"nofollow noreferrer\">github.com/jinzhu/now/blob/master/now.go</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1509099500, "post_id": 36830416, "comment_id": 80892854, "body": "BUG ALERT: The <a href=\"https://github.com/jinzhu/now\" rel=\"nofollow noreferrer\">now package</a> does not give correct results during daylight saving transitions. It incorrectly assumes that there are always 24 hours in a day: <code>func (now *Now) BeginningOfMonth() time.Time</code>: <code>* 24 * time.Hour</code>."}, {"owner": {"reputation": 415, "user_id": 2851543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14ccf22c2997ad9d6512b4a0a5527e6a?s=128&d=identicon&r=PG&f=1", "display_name": "Jinzhu", "link": "https://stackoverflow.com/users/2851543/jinzhu"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 9, "creation_date": 1521035078, "post_id": 36830416, "comment_id": 85561281, "body": "@peterSO fixed that, sorry for the problem."}], "tags": [], "owner": {"reputation": 2090, "user_id": 2797642, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/7f18efc80d45cd819f45c9ee71c9d2a9?s=128&d=identicon&r=PG", "display_name": "Apin", "link": "https://stackoverflow.com/users/2797642/apin"}, "is_accepted": true, "score": 14, "last_activity_date": 1461543602, "creation_date": 1461543602, "answer_id": 36830416, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/36830416#36830416", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>You can use <strong>now</strong> library, it really simple :</p>\n\n<pre><code>now.BeginningOfMonth()    // 2013-11-01 00:00:00 Fri\nnow.EndOfMonth()          // 2013-11-30 23:59:59.999999999 Sat\n</code></pre>\n\n<p>Please take a look here for detail : <a href=\"https://github.com/jinzhu/now\" rel=\"noreferrer\">https://github.com/jinzhu/now</a></p>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 6638523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lb7L5.jpg?s=128&g=1", "display_name": "Xian Shu", "link": "https://stackoverflow.com/users/6638523/xian-shu"}, "is_accepted": false, "score": 2, "last_activity_date": 1559781350, "last_edit_date": 1559781350, "creation_date": 1487585871, "answer_id": 42341863, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/42341863#42341863", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>goutils provides many useful func tools. <a href=\"https://github.com/printfcoder/goutils\" rel=\"nofollow noreferrer\">goutils</a></p>\n\n<pre><code>beginningOfTMonth:=time.TimeBeginningOfMonth(t)\nendOfTMonth:=time.TimeEndOfMonth(t)\n\n\nbeginningOfTWeek:=time.TimeBeginningOfWeek(t)\nendOfTWeek:=time.TimeEndOfWeek(t)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 72977, "user_id": 95944, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/SprKq.jpg?s=128&g=1", "display_name": "Richard Knop", "link": "https://stackoverflow.com/users/95944/richard-knop"}, "is_accepted": false, "score": 3, "last_activity_date": 1495792298, "creation_date": 1495792298, "answer_id": 44198536, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/44198536#44198536", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>I would do it like this:</p>\n\n<pre><code>// LastDayOfMonth returns 28-31 - the last day in the month of the time object\n// passed in to the function\nfunc LastDayOfMonth(t time.Time) int {\n    firstDay := time.Date(t.Year(), t.Month(), 1, 0, 0, 0, 0, time.UTC)\n    lastDay := firstDay.AddDate(0, 1, 0).Add(-time.Nanosecond)\n    return lastDay.Day()\n}\n</code></pre>\n\n<p>a</p>\n"}, {"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 4, "creation_date": 1509099608, "post_id": 46964105, "comment_id": 80892918, "body": "I added a BUG ALERT comment to <a href=\"https://stackoverflow.com/a/36830416/221700\">@Apin&#39;s answer</a> for you."}], "tags": [], "owner": {"reputation": 191, "user_id": 3644928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xakrR.jpg?s=128&g=1", "display_name": "gabs", "link": "https://stackoverflow.com/users/3644928/gabs"}, "is_accepted": false, "score": 19, "last_activity_date": 1519852638, "last_edit_date": 1519852638, "creation_date": 1509053224, "answer_id": 46964105, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/46964105#46964105", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>The <a href=\"https://stackoverflow.com/a/36830416/221700\">@Apin's answer</a> is dangerous because the <strong>now</strong> lib makes <strong>many wrong assumptions</strong> (it bit me in the foot too).<br>\nThe now lib doesn't consider daylight saving times and many other things:\n<a href=\"https://github.com/jinzhu/now/issues/13\" rel=\"noreferrer\">https://github.com/jinzhu/now/issues/13</a>  </p>\n\n<p>This is how I'm doing it:  </p>\n\n<pre><code>t := time.Now()\nfirstday := time.Date(t.Year(), t.Month(), 1, 0, 0, 0, 0, time.Local)\nlastday := firstday.AddDate(0, 1, 0).Add(time.Nanosecond * -1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1509120093, "last_edit_date": 1509120093, "creation_date": 1509074648, "answer_id": 46967019, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/46967019#46967019", "title": "Get the first and last day of current month in Go/Golang?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n\n<pre><code>import \"time\" \n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/time/#Date\" rel=\"nofollow noreferrer\">func Date</a></p>\n\n<pre><code>func Date(year int, month Month, day, hour, min, sec, nsec int, loc *Location) Time\n</code></pre>\n  \n  <p>Date returns the Time corresponding to</p>\n  \n  <p><code>yyyy-mm-dd hh:mm:ss + nsec nanoseconds</code></p>\n  \n  <p>in the appropriate zone for that time in the given location.</p>\n  \n  <p>The month, day, hour, min, sec, and nsec values may be outside their\n  usual ranges and will be normalized during the conversion. For\n  example, October 32 converts to November 1.</p>\n  \n  <p>A daylight savings time transition skips or repeats times. For\n  example, in the United States, March 13, 2011 2:15am never occurred,\n  while November 6, 2011 1:15am occurred twice. In such cases, the\n  choice of time zone, and therefore the time, is not well-defined. Date\n  returns a time that is correct in one of the two zones involved in the\n  transition, but it does not guarantee which.</p>\n  \n  <p>Date panics if loc is nil.</p>\n</blockquote>\n\n<p>Month and day values outside their usual ranges will be normalized. For example, for the first and last day of the month time interval,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc monthInterval(t time.Time) (firstDay, lastDay time.Time) {\n    y, m, _ := t.Date()\n    loc := t.Location()\n    firstDay = time.Date(y, m, 1, 0, 0, 0, 0, loc)\n    lastDay = time.Date(y, m+1, 1, 0, 0, 0, -1, loc)\n    return firstDay, lastDay\n}\n\nfunc main() {\n    t := time.Now()\n    fmt.Println(t.Round(0))\n    first, last := monthInterval(t)\n    fmt.Println(first)\n    fmt.Println(last)\n\n    dstLoc, err := time.LoadLocation(\"America/Los_Angeles\")\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    // Sunday, March 12, 2017, 2:00:00 am to Sunday, March 12, 2017, 3:00:00 am\n    dstStart := time.Date(2017, 03, 12, 2+1, 0, 0, 0, dstLoc)\n    // Sunday, November 5, 2017, 2:00:00 am to Sunday, November 5, 2017, 1:00:00 am\n    dstEnd := time.Date(2017, 11, 5, 2-1, 0, 0, 0, dstLoc)\n    t = dstStart\n    fmt.Println()\n    fmt.Println(t)\n    first, last = monthInterval(t)\n    fmt.Println(first)\n    fmt.Println(last)\n    t = dstEnd.Add(time.Hour)\n    fmt.Println()\n    fmt.Println(t)\n    first, last = monthInterval(t)\n    fmt.Println(first)\n    fmt.Println(last)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>2017-10-27 05:45:08.197312082 -0400 EDT\n2017-10-01 00:00:00 -0400 EDT\n2017-10-31 23:59:59.999999999 -0400 EDT\n\n2017-03-12 03:00:00 -0700 PDT\n2017-03-01 00:00:00 -0800 PST\n2017-03-31 23:59:59.999999999 -0700 PDT\n\n2017-11-05 01:00:00 -0800 PST\n2017-11-01 00:00:00 -0700 PDT\n2017-11-30 23:59:59.999999999 -0800 PST\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2618, "user_id": 382564, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/o2wAN.jpg?s=128&g=1", "display_name": "Angad", "link": "https://stackoverflow.com/users/382564/angad"}, "edited": false, "score": 0, "creation_date": 1613641189, "post_id": 55215625, "comment_id": 117139467, "body": "This is by and far the most elegant approach."}], "tags": [], "owner": {"reputation": 856, "user_id": 3098229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/883d4c56b4d5bacdec04472d199669e9?s=128&d=identicon&r=PG", "display_name": "Shreyas", "link": "https://stackoverflow.com/users/3098229/shreyas"}, "is_accepted": false, "score": 11, "last_activity_date": 1552890255, "creation_date": 1552890255, "answer_id": 55215625, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/55215625#55215625", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>Not sure when <code>AddDate(...)</code> was added to <code>time.Time</code>, but quite possibly it was added after this question had its prime time :) </p>\n\n<p>Here's another way to achieving the same with <code>time.Time.AddDate(...)</code> -</p>\n\n<pre><code>func BeginningOfMonth(date time.Time)  (time.Time) {\n    return date.AddDate(0, 0, -date.Day() + 1)\n}\n\nfunc EndOfMonth(date time.Time) (time.Time) {\n    return date.AddDate(0, 1, -date.Day())\n}\n</code></pre>\n\n<p>Then you could use <code>today := time.Now()</code> and pass it over to one/both of the functions like so - <code>eom := EndOfMonth(today)</code> to get the appropriate date. </p>\n\n<p>If time, DST and such are important, it should be pretty straightforward to ornament those details on top of it once you get the date. </p>\n\n<p>Finally, here's a playground link where you can play around with it - <a href=\"https://play.golang.org/p/DxnGuqh6g4k\" rel=\"noreferrer\">https://play.golang.org/p/DxnGuqh6g4k</a></p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 9006813, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3GHPX.jpg?s=128&g=1", "display_name": "RajGohel", "link": "https://stackoverflow.com/users/9006813/rajgohel"}, "is_accepted": false, "score": 4, "last_activity_date": 1572869042, "last_edit_date": 1572869042, "creation_date": 1572866941, "answer_id": 58692513, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang/58692513#58692513", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>This can also be a solution:</p>\n\n<pre><code>currentTimestamp := time.Now().UTC()\ncurrentYear, currentMonth, _ := currentTimestamp.Date()\ncurrentLocation := currentTimestamp.Location()\n\nfirstOfMonth := time.Date(currentYear, currentMonth, 1, 0, 0, 0, 0, currentLocation)\nlastOfMonth := time.Date(currentYear, currentMonth+1, 0, 23, 59, 59, 999999999, currentLocation)\n\nfmt.Println(firstOfMonth)\nfmt.Println(lastOfMonth)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>firstOfMonth: 2019-11-01 00:00:00 +0000 UTC\nlastOfMonth: 2019-11-30 23:59:59.999999999 +0000 UTC\n</code></pre>\n\n<p>Click here to try it out:\n<a href=\"https://play.golang.org/p/qcL6Tt6oe1j\" rel=\"nofollow noreferrer\">Playground Link</a></p>\n"}], "owner": {"reputation": 597, "user_id": 3731722, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100000181698389/picture?type=large", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/3731722/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28513, "favorite_count": 9, "accepted_answer_id": 36830416, "answer_count": 8, "score": 28, "last_activity_date": 1572869042, "creation_date": 1461541741, "question_id": 36830212, "link": "https://stackoverflow.com/questions/36830212/get-the-first-and-last-day-of-current-month-in-go-golang", "title": "Get the first and last day of current month in Go/Golang?", "body": "<p>I'm trying to get the first and last day of the current month. You can add days and hours but not the month, which I was thinking of subtracting one day from the next month to get the last day of this month. Something like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\n    date := time.Now()\n    nextMonth := date.Add(time.Month)\n    LastDay := nextMonth.Add(-time.Hour * 24)\n\n    fmt.Println(LastDay)\n\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1461537090, "post_id": 36827577, "comment_id": 61230414, "body": "You can also pre-initialize the <i>capacity</i> of the slice with <code>make(T, 0, cap)</code> - this is useful when you know how many results (or at least, the minimum number) you&#39;ll have."}], "tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": true, "score": 5, "last_activity_date": 1461524929, "last_edit_date": 1461524929, "creation_date": 1461524515, "answer_id": 36827577, "question_id": 36827439, "link": "https://stackoverflow.com/questions/36827439/what-does-this-line-of-golang-do-exactly-why-pointers-why-the-0-param/36827577#36827577", "title": "What does this line of Golang do exactly? Why pointers? Why the 0 param?", "body": "<blockquote>\n  <p>Wouldn't you want a slice so you can insert books arbitrarily into it?</p>\n</blockquote>\n\n<p><code>make([]Type, initLength)</code> creates a slice of values of type <code>Type</code>. When <code>initLength &gt; 0</code> then the slice is pre-filled with that many number of zero-value instances of type <code>Type</code>. In this case the author doesn't want to have any zero-values, and instead chooses to append non-zero values as they're received from the DB. So <code>bks</code> is indeed a slice.</p>\n\n<p>Example: <a href=\"http://play.golang.org/p/g0dALT-sLn\">http://play.golang.org/p/g0dALT-sLn</a></p>\n\n<p>More information: <a href=\"http://blog.golang.org/go-slices-usage-and-internals\">http://blog.golang.org/go-slices-usage-and-internals</a></p>\n\n<blockquote>\n  <p>And why is it a <em>slice</em> of pointers instead of an <em>slice</em> of books?</p>\n</blockquote>\n\n<p>This is hard to answer without more context. Using a pointer to Book will allow you to store <code>nil</code> values, which might be useful depending on how <code>bks</code> is used.</p>\n\n<p>The tutorial you linked to doesn't show <code>bks</code> being used in any way that makes use of the fact the values are pointers. You could probably convert the slice to type <code>[]Book</code> without any problems.</p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 36827577, "answer_count": 1, "score": 0, "last_activity_date": 1461531843, "creation_date": 1461523789, "question_id": 36827439, "link": "https://stackoverflow.com/questions/36827439/what-does-this-line-of-golang-do-exactly-why-pointers-why-the-0-param", "title": "What does this line of Golang do exactly? Why pointers? Why the 0 param?", "body": "<p>I was following <a href=\"http://www.alexedwards.net/blog/practical-persistence-sql\" rel=\"nofollow\">this tutorial</a> on PostgreSQL in Go and it has the following line:</p>\n\n<pre><code>  bks := make([]*Book, 0)\n</code></pre>\n\n<p>Which is part of the bigger code block:</p>\n\n<pre><code>  bks := make([]*Book, 0)\n  for rows.Next() {\n    bk := new(Book)\n    err := rows.Scan(&amp;bk.isbn, &amp;bk.title, &amp;bk.author, &amp;bk.price)\n    if err != nil {\n      log.Fatal(err)\n    }\n    bks = append(bks, bk)\n  }\n</code></pre>\n\n<p>Why does the author pass 0 in <code>make</code>? I understand that's the length, but why 0 length? And why is it an array of pointers instead of an array of books? Wouldn't you want a slice so you can insert books arbitrarily into it?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461521208, "post_id": 36826863, "comment_id": 61224835, "body": "And the problem here - that shouldn&#39;t happen if <code>GOMAXRPOCS</code> is bigger than 1. <code>for {}</code> will lock only one thread, other goroutines can be scheduled on other threads. But for some reason that doesn&#39;t happen"}, {"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461521387, "post_id": 36826863, "comment_id": 61224903, "body": "@creker - Yes, I wondered the same. I&#39;m currently investigating why, as I am not sure of the cause."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461521746, "post_id": 36826863, "comment_id": 61225038, "body": "and even more puzzling the fact that it runs for some time before deadlocking. I would understand if it would lock up immediately and that would be perfectly fine. It would perfectly fit the case of <code>for {}</code> locking the process before the runtime had any chance to spawn more worker threads."}, {"owner": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461522303, "post_id": 36826863, "comment_id": 61225248, "body": "Just for info: i am running the latest golang version, so gomaxprocs shouldnot be 1. I understand the issue with 1 cpu only (at least i do now), but for multiple cpus i am still at a loss."}, {"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "edited": false, "score": 0, "creation_date": 1461522757, "post_id": 36826863, "comment_id": 61225410, "body": "The behaviour that we&#39;re interested in is defined by the scheduler. The scheduler will only switch a thread&#39;s context when the current goroutine (i) finishes, (ii) makes a blocking syscall, (ii) makes a blocking Go runtime call; or (iv) invokes another function (somethines) (ref: <a href=\"http://www.slideshare.net/matthewrdale/demystifying-the-go-scheduler\" rel=\"nofollow noreferrer\">slideshare.net/matthewrdale/demystifying-the-go-scheduler</a>). I&#39;m still a bit new to Go, but I&#39;m wondering: perhaps context switches in otherwise-independent threads are dependent on the running threads invoking the scheduler. Our main goroutine won&#39;t ever invoke it."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461522779, "post_id": 36826863, "comment_id": 61225419, "body": "You&#39;re not the only one, you might be onto something here. Even this locks up <a href=\"https://play.golang.org/p/GqPG6NhDox\" rel=\"nofollow noreferrer\">play.golang.org/p/GqPG6NhDox</a> I took go 1.2.2, the oldest one I could find, and it behaves differently - it locks up immediately in both cases. Maybe someone should post that as an issue for golang team to investigate. If it&#39;s not a bug maybe it would at least give us an explanation."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461522870, "post_id": 36826863, "comment_id": 61225452, "body": "@icio, but here we have multiple goroutines and they do yield execution and allow the runtime to multiplex goroutines to other threads. In my case even main goroutine is no longer blocked but <code>for {}</code> in other one is still locking up the process."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461524252, "post_id": 36826863, "comment_id": 61225990, "body": "I put <code>time.Sleep(100 * time.Millisecond)</code> after <code>log.Println(&quot;Sent&quot;)</code> and now it no longer locks up. Or at least it runs much longer than before. If I put <code>time.Sleep(1 * time.Millisecond)</code> then it&#39;s locks up again. @JustMe, which OS did you test it on? I ran it on Windows 10."}, {"owner": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461524483, "post_id": 36826863, "comment_id": 61226072, "body": "@creker Mac OSX - El capitan 10.11.4 (15E65) here. Results are exactly the same as the ones you got."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1461528439, "post_id": 36826863, "comment_id": 61227682, "body": "<code>select {}</code> is preferred to <code>for {     runtime.Gosched() }</code>.  The select statement indicates that the goroutine is blocked until the program terminates.  The for loop spins asking the runtime to schedule another goroutine."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "reply_to_user": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461746791, "post_id": 36826863, "comment_id": 61334244, "body": "@JustMe, I created an issue <a href=\"https://github.com/golang/go/issues/15442\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/15442</a> and now we have an explanation. Process hangs when GC is triggered. Process runs fine for a while, then GC is triggered. Because one of the goroutines hogs one of the threads it doesn&#39;t stop for GC which leads to entire process just hang as GC waits for goroutine to stop it&#39;s work. As I said in my last comment there, <code>runtime.GC()</code> will trigger the issue immediatelly."}, {"owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461746865, "post_id": 36826863, "comment_id": 61334301, "body": "Wonderful work, @creker -- thank you for the follow-up!"}, {"owner": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461881653, "post_id": 36826863, "comment_id": 61413809, "body": "Super. Thank you very much for the help."}], "tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": true, "score": 2, "last_activity_date": 1461521126, "last_edit_date": 1461521126, "creation_date": 1461520667, "answer_id": 36826863, "question_id": 36826622, "link": "https://stackoverflow.com/questions/36826622/why-is-the-following-code-sample-stuck-after-some-iterations/36826863#36826863", "title": "Why is the following code sample stuck after some iterations?", "body": "<p>The main goroutine (running the <code>for {}</code> loop) is hogging the thread, and none of the other goroutines are able to execute because of it. If you change the end of your <code>main</code> function to:</p>\n\n<pre><code>for {\n    runtime.Gosched()\n}\n</code></pre>\n\n<p>then the thread will be released and another goroutine made active.</p>\n\n<blockquote>\n  <p><code>func Gosched()</code></p>\n  \n  <p>Gosched yields the processor, allowing other goroutines to run. It does not suspend the current goroutine, so execution resumes automatically.</p>\n</blockquote>\n\n<p>-- <a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow\">https://golang.org/pkg/runtime/#Gosched</a></p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461522532, "post_id": 36826866, "comment_id": 61225327, "body": "Why would the order of operations matter? The channel is opened before any other routine runs. running latest version of go, so there is no issue with the number of cpus. (would love to understand how this happens)."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "reply_to_user": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "edited": false, "score": 0, "creation_date": 1461526770, "post_id": 36826866, "comment_id": 61226983, "body": "Maybe an example batter explain what I mean <a href=\"http://play.golang.org/p/lrbs5NCEck\" rel=\"nofollow noreferrer\">play.golang.org/p/lrbs5NCEck</a> . And this is expected behaviour."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1461520683, "creation_date": 1461520683, "answer_id": 36826866, "question_id": 36826622, "link": "https://stackoverflow.com/questions/36826622/why-is-the-following-code-sample-stuck-after-some-iterations/36826866#36826866", "title": "Why is the following code sample stuck after some iterations?", "body": "<p>Order of execution of goroutings is undefined. Code gets stuck is legal. You can be more deterministic doing communication with <code>main()</code>. For example place</p>\n\n<pre><code>for {\n   deliveryChann &lt;- true\n   log.Println(\"Sent\")\n}\n</code></pre>\n\n<p><code>in main()</code> instead of <code>go func()</code> </p>\n"}], "owner": {"reputation": 3, "user_id": 6248216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6111c41d6a2c9bb1b350218f7060a0?s=128&d=identicon&r=PG&f=1", "display_name": "Just Me", "link": "https://stackoverflow.com/users/6248216/just-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 36826863, "answer_count": 2, "score": 0, "last_activity_date": 1461521126, "creation_date": 1461519314, "last_edit_date": 1461519400, "question_id": 36826622, "link": "https://stackoverflow.com/questions/36826622/why-is-the-following-code-sample-stuck-after-some-iterations", "title": "Why is the following code sample stuck after some iterations?", "body": "<p>I am trying to learn golang and i got a little piece of code that i do not understand why it gets stuck after some time.</p>\n\n<pre><code>package main\n\nimport \"log\"\n\nfunc main() {\n    deliveryChann := make(chan bool, 10000)\n\n    go func() {\n        for {\n            deliveryChann &lt;- true\n            log.Println(\"Sent\")\n        }\n    }()\n\n    go func() {\n        for {\n            select {\n            case &lt;-deliveryChann:\n                log.Println(\"received\")\n            }\n        }\n    }()\n\n    go func() {\n        for {\n            select {\n            case &lt;-deliveryChann:\n                log.Println(\"received\")\n            }\n        }\n    }()\n\n    go func() {\n        for {\n            select {\n            case &lt;-deliveryChann:\n                log.Println(\"received\")\n            }\n        }\n    }()\n\n    for {\n    }\n}\n</code></pre>\n\n<p>An basic start on how to investigate would suffice.</p>\n"}, {"tags": ["object", "methods", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1461518387, "post_id": 36826362, "comment_id": 61223768, "body": "Thank you. Not just destructors, but if there is a method like <code>object.run()</code>, which sets some variables, and without which the object can throw some nilpointer error, is there any way to mandate the user to use <code>.run()</code> method?"}, {"owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "edited": false, "score": 0, "creation_date": 1461518706, "post_id": 36826362, "comment_id": 61223876, "body": "Perfect @icza, Thanks a lot."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1461518754, "last_edit_date": 1461518754, "creation_date": 1461517972, "answer_id": 36826362, "question_id": 36826232, "link": "https://stackoverflow.com/questions/36826232/how-to-make-sure-that-a-method-is-used-after-an-object-is-created-in-golang/36826362#36826362", "title": "How to make sure that a method is used after an object is created in golang?", "body": "<p>There is no way to force the call of a <code>Close()</code> method. The best you can do is document it clearly that if the value of your type is not needed anymore, its <code>Close()</code> method must be called.</p>\n\n<p>In the extreme situation when a program is terminated forcibly, you can't have any guarantees that any code will run.</p>\n\n<p>Note that there is a <a href=\"https://golang.org/pkg/runtime/#SetFinalizer\" rel=\"noreferrer\"><code>runtime.SetFinalizer()</code></a> function which allows you register a function which will be called when the garbage collector finds a value / block unreachable. But know that there is no guarantee that your registered function will be run before the program exits. Quoting from its doc:</p>\n\n<blockquote>\n  <p>There is no guarantee that finalizers will run before a program exits, so typically they are useful only for releasing non-memory resources associated with an object during a long-running program.</p>\n</blockquote>\n\n<p>A good design is to make your type unexported, but provide an exported constructor function like <code>NewMyType()</code> in which you can properly initialize your struct / type. Also return an interface type and not a concrete type, and the interface should contain everything others want to do with your value. And your concrete type must implement that interface of course. You can't force others to call its <code>Close()</code> method when they are done with your value, but at least you can stop worrying about improper initialization.</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1461518017, "last_edit_date": 1495540982, "creation_date": 1461518017, "answer_id": 36826373, "question_id": 36826232, "link": "https://stackoverflow.com/questions/36826232/how-to-make-sure-that-a-method-is-used-after-an-object-is-created-in-golang/36826373#36826373", "title": "How to make sure that a method is used after an object is created in golang?", "body": "<p>In short, it is not possible in go.</p>\n\n<p>The term you are looking for is destructors, which Go does not implement. For more information, read through the excellent answer here: <a href=\"https://stackoverflow.com/questions/32768243/go-destructors\">Go destructors?</a></p>\n"}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2893, "favorite_count": 2, "accepted_answer_id": 36826362, "answer_count": 2, "score": 4, "last_activity_date": 1461518754, "creation_date": 1461517336, "question_id": 36826232, "link": "https://stackoverflow.com/questions/36826232/how-to-make-sure-that-a-method-is-used-after-an-object-is-created-in-golang", "title": "How to make sure that a method is used after an object is created in golang?", "body": "<p>I have a <code>struct</code>, and I have a <code>new</code> method that I have written, that generates the object and return its pointer.</p>\n\n<p>Now I also have another method for example, <code>Close</code>, but as of now, it is not mandatory to call this method once the object is created. I want to make sure that this method has to be called if the object is created. How do I do that in Golang? If this is possible, I don't know what is this termed as either. Please help. Thank you.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461515706, "post_id": 36825597, "comment_id": 61222724, "body": "What do you want to parse out of it? What have you tried? Where did you get stuck? Check out the <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow noreferrer\"><code>encoding&#47;xml</code></a> package to get started."}, {"owner": {"reputation": 77, "user_id": 3071089, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/059239c99a3862d29acc00ec9a6a83e1?s=128&d=identicon&r=PG&f=1", "display_name": "osmo", "link": "https://stackoverflow.com/users/3071089/osmo"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461516424, "post_id": 36825597, "comment_id": 61222999, "body": "ive just managed to work it out. i was missing the &quot;attr&quot; to pick up the attributes of the Id."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1461517228, "creation_date": 1461517228, "answer_id": 36826209, "question_id": 36825597, "link": "https://stackoverflow.com/questions/36825597/golang-xml-parsing-unmarshal/36826209#36826209", "title": "GOlang XML parsing / unmarshal", "body": "<p>For anyone wondering, here's a sample that will roundtrip the mentioned XML to go structs and back:</p>\n\n<pre><code>func TestXml(t *testing.T) {\n    type Id struct {\n        Code string `xml:\"code,attr\"`\n        Quantity int `xml:\"quantity,attr\"`\n    }\n\n    type Feed struct {\n        Version string `xml:\"version,attr\"`\n        Format string `xml:\"format,attr\"`\n        Date string `xml:\"date,attr\"`\n        Ids []Id `xml:\"Ids&gt;Id\"`\n    }\n\n    x := []byte(`\n        &lt;Feed version='1.03' format='FULL' date='2016-04-22T18:31:01.4988282+01:00'&gt;\n            &lt;Ids&gt;\n                &lt;Id code='000001' quantity='4' /&gt;\n                &lt;Id code='000002' quantity='0' /&gt;\n            &lt;/Ids&gt;\n        &lt;/Feed&gt;\n    `)\n\n    f := Feed{}\n    xml.Unmarshal(x, &amp;f)\n    t.Logf(\"%#v\", f)\n    t.Log(\"Code 0:\", f.Ids[0].Code)\n\n    b, _ := xml.Marshal(f)\n    t.Log(string(b))\n}\n</code></pre>\n\n<p>This produces the following output:</p>\n\n<pre><code>xml_test.go:42: domain.Feed{Version:\"1.03\", Format:\"FULL\", Date:\"2016-04-22T18:31:01.4988282+01:00\", Ids:[]domain.Id{domain.Id{Code:\"000001\", Quantity:4}, domain.Id{Code:\"000002\", Quantity:0}}}\nxml_test.go:43: Code 0: 000001\nxml_test.go:46: &lt;Feed version=\"1.03\" format=\"FULL\" date=\"2016-04-22T18:31:01.4988282+01:00\"&gt;&lt;Ids&gt;&lt;Id code=\"000001\" quantity=\"4\"&gt;&lt;/Id&gt;&lt;Id code=\"000002\" quantity=\"0\"&gt;&lt;/Id&gt;&lt;/Ids&gt;&lt;/Feed&gt;\n</code></pre>\n\n<p>The documentation for <a href=\"https://golang.org/pkg/encoding/xml/\" rel=\"nofollow\"><code>xml</code></a> contains great examples.</p>\n"}], "owner": {"reputation": 77, "user_id": 3071089, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/059239c99a3862d29acc00ec9a6a83e1?s=128&d=identicon&r=PG&f=1", "display_name": "osmo", "link": "https://stackoverflow.com/users/3071089/osmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461517228, "creation_date": 1461513914, "last_edit_date": 1461515755, "question_id": 36825597, "link": "https://stackoverflow.com/questions/36825597/golang-xml-parsing-unmarshal", "title": "GOlang XML parsing / unmarshal", "body": "<p>I'm having trouble parsing xml in Go. Can anyone help? The XML format is:</p>\n\n<pre><code>&lt;Feed version='1.03' format='FULL' date='2016-04-22T18:31:01.4988282+01:00'&gt;\n\n    &lt;Ids&gt;\n            &lt;Id code='000001' quantity='4' /&gt;\n            &lt;Id code='000002' quantity='0' /&gt;\n     &lt;/Ids&gt;\n\n&lt;/Feed&gt;\n</code></pre>\n"}, {"tags": ["postgresql", "go", "architecture", "goroutine", "ticker"], "answers": [{"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461509457, "post_id": 36824586, "comment_id": 61220504, "body": "Okay, phenomenal, thank you. I&#39;ll actually go finish building it and if I encounter any performance woes I&#39;ll post accordingly. Just wanted to make sure that I wasn&#39;t making any incredibly foolish mistakes."}, {"owner": {"reputation": 342, "user_id": 833088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eb00e8dc8118e1994912401679a26d?s=128&d=identicon&r=PG", "display_name": "mrrusof", "link": "https://stackoverflow.com/users/833088/mrrusof"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 1, "creation_date": 1461517603, "post_id": 36824586, "comment_id": 61223461, "body": "Regarding your comment on Cl&#233;ment&#39;s answer, &#39;So there&#39;s not anything that I said that makes you wince in horror though?&#39; I do not see anything like that. What I do not see is that you are applying goroutines for a reason. The code in goroutines will not execute in parallel unless your machine can do so and you tell Go to execute goroutines in parallel.  Even if goroutines do not execute in parallel, executing goroutines concurrently opens the possibility of waiting at any given time for multiple SQL queries to finish.  Sorry, I cannot comment in other answers, I don&#39;t have enough points yet."}, {"owner": {"reputation": 342, "user_id": 833088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eb00e8dc8118e1994912401679a26d?s=128&d=identicon&r=PG", "display_name": "mrrusof", "link": "https://stackoverflow.com/users/833088/mrrusof"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461953105, "post_id": 36824586, "comment_id": 61448329, "body": "For more on concurrency vs parallelism in Go, I suggest reading the material indicated by <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">blog.golang.org/concurrency-is-not-parallelism</a>"}, {"owner": {"reputation": 342, "user_id": 833088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eb00e8dc8118e1994912401679a26d?s=128&d=identicon&r=PG", "display_name": "mrrusof", "link": "https://stackoverflow.com/users/833088/mrrusof"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461953263, "post_id": 36824586, "comment_id": 61448392, "body": "Do not disregard Cl&#233;ment&#39;s or Icza&#39;s answers. They touch complementary aspects of Doug&#39;s problem."}], "tags": [], "owner": {"reputation": 342, "user_id": 833088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eb00e8dc8118e1994912401679a26d?s=128&d=identicon&r=PG", "display_name": "mrrusof", "link": "https://stackoverflow.com/users/833088/mrrusof"}, "is_accepted": true, "score": 1, "last_activity_date": 1461509339, "last_edit_date": 1495542704, "creation_date": 1461509033, "answer_id": 36824586, "question_id": 36824400, "link": "https://stackoverflow.com/questions/36824400/suggested-golang-architecture-for-polling-user-accounts-frequently/36824586#36824586", "title": "Suggested Golang architecture for polling user accounts frequently", "body": "<p>Let me answer given what you describe.</p>\n\n<blockquote>\n  <p>I want to make sure this isn't an absolutely absurd setup.</p>\n</blockquote>\n\n<p>I understand the following. For each user, you create a tick every 5 seconds in one goroutine. Another goroutine consumes those ticks, performing the polling and comparing the date of the last message with the date you have recorded in your PostgreSQL database.</p>\n\n<p>The answer is: it depends. How many users do you have and how many can your application support? In my experience the best way to answer this question is to measure performance of your application.</p>\n\n<blockquote>\n  <p>Is the amount of calls to the database sensible?</p>\n</blockquote>\n\n<p>It depends. To give you some reassurance, I have seen a single PostgreSQL database take hundreds of <code>SELECT</code> per second. I don't see a design mistake, so benchmarking your application is the way to go.</p>\n\n<blockquote>\n  <p>I am abusing goroutines?</p>\n</blockquote>\n\n<p>Do you mean like executing too many of them? <a href=\"https://stackoverflow.com/questions/8509152/max-number-of-goroutines\">I think it is unlikely that you are abusing goroutines that way.</a> If there is a particular reason you think this could be the case, posting the corresponding code snippet could make your question more precise.</p>\n"}, {"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461515062, "post_id": 36825453, "comment_id": 61222507, "body": "Sounds good! So there&#39;s not anything that I said that makes you wince in horror though?"}, {"owner": {"reputation": 5768, "user_id": 2523414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHE73.jpg?s=128&g=1", "display_name": "Cl&#233;ment Pr&#233;vost", "link": "https://stackoverflow.com/users/2523414/cl%c3%a9ment-pr%c3%a9vost"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461515494, "post_id": 36825453, "comment_id": 61222644, "body": "Nope, interval polling is a totally valid option for a starting project IMHO. It&#39;s simple to setup and maintain.  Also, as @mrrusof said, SQL databases are good at handling many concurrent read/write requests and golang can withstand a LOT of goroutines."}], "tags": [], "owner": {"reputation": 5768, "user_id": 2523414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHE73.jpg?s=128&g=1", "display_name": "Cl&#233;ment Pr&#233;vost", "link": "https://stackoverflow.com/users/2523414/cl%c3%a9ment-pr%c3%a9vost"}, "is_accepted": false, "score": 1, "last_activity_date": 1461513149, "creation_date": 1461513149, "answer_id": 36825453, "question_id": 36824400, "link": "https://stackoverflow.com/questions/36824400/suggested-golang-architecture-for-polling-user-accounts-frequently/36825453#36825453", "title": "Suggested Golang architecture for polling user accounts frequently", "body": "<ul>\n<li>Is your architecture the most efficient way to go ? <strong>No</strong>.</li>\n<li>Should you do something about it now ? <strong>No</strong>, you should test your solution.</li>\n</ul>\n\n<p>You can always go deeper with optimisations, in your case you need client throughput so you can use a bunch of well known optimisations like switching to a reactive model, add some cache server, spread the load on multiple DB slaves, ... </p>\n\n<p>You should test your solution at scale, if it fits your needs in term of user throughput and server cost, then your solution is the right one.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1461517144, "creation_date": 1461517144, "answer_id": 36826187, "question_id": 36824400, "link": "https://stackoverflow.com/questions/36824400/suggested-golang-architecture-for-polling-user-accounts-frequently/36826187#36826187", "title": "Suggested Golang architecture for polling user accounts frequently", "body": "<p>Your proposed solution: 1 query in every 5 seconds for every user. Having 100 users this is:</p>\n\n<pre><code>1 * 100 / 5 seconds = 20 queries / second\n</code></pre>\n\n<p>This is not considered a big load if the queries are fast.</p>\n\n<p>But why do you need to do this for every users separately? If you need to pick up updates in the granularity of 5 seconds, you could just execute 1 query in every 5 seconds which does not filter by user but checks for updates from <em>all</em> the users.</p>\n\n<p>If the above query gives results, you can iterate over the results and do the necessary for each user that had updates in the last 5 seconds. This results in:</p>\n\n<pre><code>1 query / 5 seconds = 0.2 query / second\n</code></pre>\n\n<p>Which is a hundred times less queries, still getting you all the updates in the same time granularity.</p>\n\n<p>If the task to be performed for the updates is long or depends on external systems (e.g. a call to another server), you may perform those tasks in separate goroutines. You may choose to either launch a new goroutine for each task, or you may have a pool of worker goroutines which consume these queued tasks, and just queue the task (using channels).</p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 646, "favorite_count": 0, "accepted_answer_id": 36824586, "answer_count": 3, "score": 3, "last_activity_date": 1461517144, "creation_date": 1461508137, "question_id": 36824400, "link": "https://stackoverflow.com/questions/36824400/suggested-golang-architecture-for-polling-user-accounts-frequently", "title": "Suggested Golang architecture for polling user accounts frequently", "body": "<p>I'm creating a small service where I poll around 100 accounts (in a Twitter-like service) frequently (every 5 seconds or so) to check for new messages, as the service doesn't yet provide a streaming API (like Twitter actually does).</p>\n\n<p>In my head, I have the architecture planned as queuing <code>Ticker</code>s every 5 seconds for every user. Once the tick fires I make an API call to the service, check their messages, and call <code>SELECT</code> to my Postgres database to get the specific user details and check the date of the most recent message, and if there are messages newer than that <code>UPDATE</code> the entry and notify the user. Repeat ad nauseum.</p>\n\n<p>I'm not very experienced in backend things and architecture, so I want to make sure this isn't an absolutely absurd setup. Is the amount of calls to the database sensible? Am I abusing goroutines? </p>\n"}, {"tags": ["parsing", "go", "yacc"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1461646913, "post_id": 36822702, "comment_id": 61279524, "body": "What do you mean by parse result?"}, {"owner": {"reputation": 16323, "user_id": 355499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/78892b9338a302a4ba3cc1aa77edd99f?s=128&d=identicon&r=PG", "display_name": "Emil H", "link": "https://stackoverflow.com/users/355499/emil-h"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1461648527, "post_id": 36822702, "comment_id": 61280145, "body": "When parsing the input I build a tree structure. It is stored in the <code>$$.expr</code>. I want to get the root of that tree. The above <code>Result</code> function seem to access the right result, but it feels a bit hacky. I&#39;m not 100% sure that <code>p.stack[1]</code> will be where the root/parse result is always stored..."}, {"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1461649460, "post_id": 36822702, "comment_id": 61280512, "body": "Yeah, don&#39;t grovel in yacc&#39;s undocumented data structures, I suppose. I guess it&#39;s either &quot;global variables&quot; or &quot;fields of the yyLexer interface&#39;s underlying type&quot;; I use the latter"}, {"owner": {"reputation": 16323, "user_id": 355499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/78892b9338a302a4ba3cc1aa77edd99f?s=128&d=identicon&r=PG", "display_name": "Emil H", "link": "https://stackoverflow.com/users/355499/emil-h"}, "reply_to_user": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 0, "creation_date": 1461653976, "post_id": 36822702, "comment_id": 61283106, "body": "Thanks, that seems like the better approach. The above also breaks if I use another prefix so it&#39;s not very robust. I just wrote my own lexer anyway so, while it doesn&#39;t feel like the right place to store the result it&#39;s a lot better than a global variable. Just noticed that the parser also has a global <code>yyErrorMessages</code> variable :\\ hmm.."}], "answers": [{"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 5, "last_activity_date": 1466673449, "last_edit_date": 1466673449, "creation_date": 1466671269, "answer_id": 37986398, "question_id": 36822702, "link": "https://stackoverflow.com/questions/36822702/accessing-result-of-a-golang-yacc-generated-parser/37986398#37986398", "title": "Accessing result of a golang yacc generated parser", "body": "<p>No, accessing <code>stack[1]</code> does not work reliably. It doesn\u2019t contain any result as soon as the stack needs to grow beyond 16, its initial size. (See <a href=\"https://github.com/golang/go/issues/16163\" rel=\"nofollow\">#16163</a>.)</p>\n\n<p>The <code>if</code> statement after the <code>yystack</code> label then creates a new stack and totally forgets about the one saved in <code>yyParserImpl</code>.</p>\n\n<hr>\n\n<p>I did the following.</p>\n\n<p>Add a <code>result</code> field to the lexer type:</p>\n\n<pre><code>type ShellLexer struct {\n    /* \u2026 */\n    result *ShellProgram\n}\n</code></pre>\n\n<p>Extend the grammar by the following rule at the very beginning:</p>\n\n<pre><code>start : program {\n    shyylex.(*ShellLexer).result = $$\n}\n</code></pre>\n\n<p>(This depends on the parameter name of the <code>Parse</code> method (which can have a custom prefix), but I think that\u2019s ok.)</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4358296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31618f624b5b2de0dca943f0db0da710?s=128&d=identicon&r=PG&f=1", "display_name": "tollek", "link": "https://stackoverflow.com/users/4358296/tollek"}, "is_accepted": false, "score": 1, "last_activity_date": 1486770139, "creation_date": 1486770139, "answer_id": 42170463, "question_id": 36822702, "link": "https://stackoverflow.com/questions/36822702/accessing-result-of-a-golang-yacc-generated-parser/42170463#42170463", "title": "Accessing result of a golang yacc generated parser", "body": "<p>Alternative solution: use sed to insert additional field into the generated parser. Then, in your grammar action, assign the value.</p>\n\n<pre><code>go tool yacc -o parser.go -p Filter parser.y\nsed -i '/type FilterParserImpl struct/a tree *treeNode' parser.go\n</code></pre>\n\n<p>The generated parser:</p>\n\n<pre><code>type FilterParserImpl struct {\ntree *treeNode\n    lval  FilterSymType\n    stack [FilterInitialStackSize]FilterSymType\n    char  int\n}\n</code></pre>\n\n<p>Grammar action:</p>\n\n<pre><code>filter { Filterrcvr.tree = $1 }\n</code></pre>\n"}], "owner": {"reputation": 16323, "user_id": 355499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/78892b9338a302a4ba3cc1aa77edd99f?s=128&d=identicon&r=PG", "display_name": "Emil H", "link": "https://stackoverflow.com/users/355499/emil-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 520, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1486770139, "creation_date": 1461498552, "last_edit_date": 1461499217, "question_id": 36822702, "link": "https://stackoverflow.com/questions/36822702/accessing-result-of-a-golang-yacc-generated-parser", "title": "Accessing result of a golang yacc generated parser", "body": "<p>I am trying to create a parser using <a href=\"https://golang.org/cmd/yacc/\" rel=\"noreferrer\">golang's yacc tool</a>. I found <a href=\"https://github.com/blynn/nex\" rel=\"noreferrer\">nex</a> to simplify creating a lexer to give the parser. My problem now is that the generated parser has no method or field to give me access to the parsing result. I could just store the parse result in a global variable, but that seems wrong.</p>\n\n<p>Currently I've added the following as an initial attempt to the top of my parser.y file:</p>\n\n<pre><code>type ResultParser interface {\n  yyParser // Generated parser interface\n  Result() s.Expr // s.Expr is an interface for the parsed result\n}\n\nfunc (p *yyParserImpl) Result() s.Expr {\n  return p.stack[1].expr\n}\n\nfunc NewResultParser() ResultParser {\n  return &amp;yyParserImpl{}\n}\n</code></pre>\n\n<p><strong>Is there a recomended/better way of getting at the result from the parser?</strong><br>\n(Since this feels like a bit of an abuse of the generator...)</p>\n"}, {"tags": ["go", "exec", "bind", "mount"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1461494519, "creation_date": 1461494519, "answer_id": 36822054, "question_id": 36821613, "link": "https://stackoverflow.com/questions/36821613/how-to-check-in-golang-if-a-particular-directory-has-a-mount-bind-on-it/36822054#36822054", "title": "How to check in golang if a particular directory has a mount --bind on it?", "body": "<p>You can use language machinery for piping, something like</p>\n\n<pre><code>c1 := exec.Command(\"mount\")\nc2 := exec.Command(\"grep\", toDir)\nc2.Stdin, _ = c1.StdoutPipe()\nc2.Stdout = os.DevNull\nc2.Start()\nc1.Run()\nc2.Wait()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 26911, "user_id": 225262, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/10f7602ff38f6486cb1580052746fc05?s=128&d=identicon&r=PG", "display_name": "satoru", "link": "https://stackoverflow.com/users/225262/satoru"}, "edited": false, "score": 0, "creation_date": 1541559273, "post_id": 36822150, "comment_id": 93256016, "body": "What&#39;s the difference between using <code>sh -c</code> and using the command directly?"}], "tags": [], "owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "is_accepted": true, "score": 1, "last_activity_date": 1461495139, "creation_date": 1461495139, "answer_id": 36822150, "question_id": 36821613, "link": "https://stackoverflow.com/questions/36821613/how-to-check-in-golang-if-a-particular-directory-has-a-mount-bind-on-it/36822150#36822150", "title": "How to check in golang if a particular directory has a mount --bind on it?", "body": "<p>Since your command involves pipes, you can pass it as a command string to bash instead of executing it directly. Something like this should work.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    res, _ := exec.Command(\"sh\", \"-c\", \"mount | grep /home\").Output()\n    fmt.Printf(\"%s\", res)\n}\n</code></pre>\n"}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1612, "favorite_count": 0, "accepted_answer_id": 36822150, "answer_count": 2, "score": 2, "last_activity_date": 1461495139, "creation_date": 1461491550, "question_id": 36821613, "link": "https://stackoverflow.com/questions/36821613/how-to-check-in-golang-if-a-particular-directory-has-a-mount-bind-on-it", "title": "How to check in golang if a particular directory has a mount --bind on it?", "body": "<p>I use following command to check if a directory is mounted.</p>\n\n<pre><code>res := exec.Command(\"mount\", \"|\", \"grep\", toDir, \"&gt;\", \"/dev/null\").Run()\n</code></pre>\n\n<p>But it returns <code>exit status 1</code> no matter if a directory is mounted or not.</p>\n\n<p>mount | grep /path/to/dir > /dev/null</p>\n\n<p>On command line works fine.</p>\n\n<p>How can I get the information?</p>\n"}, {"tags": ["go", "compiler-errors", "alias", "channel"], "answers": [{"comments": [{"owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "edited": false, "score": 0, "creation_date": 1461487909, "post_id": 36821007, "comment_id": 61213980, "body": "Great! The spec looks like it&#39;s exactly my case! However, I&#39;ve ended up with using named types for channel&#39;s val-type but not the entire channel."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "edited": false, "score": 1, "creation_date": 1461488357, "post_id": 36821007, "comment_id": 61214060, "body": "@IvanVelichko Exactly what you should do, as detailed in the edited answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1477473424, "last_edit_date": 1592644375, "creation_date": 1461487459, "answer_id": 36821007, "question_id": 36820663, "link": "https://stackoverflow.com/questions/36820663/type-alias-for-channel-in-go-works-strange/36821007#36821007", "title": "Type alias for channel in Go works strange", "body": "<p><code>test1()</code> has one parameter of type <code>ChIn</code>. This is a named type. You want to pass a value of type <code>Ch</code> which is a bidirectional channel type, and is also a named type.</p>\n<p>So in order for this to compile, a value of <code>Ch</code> should be assignable to type <code>ChIn</code>. This is not allowed by the language specification.</p>\n<p>Quoting <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\"><strong>Assignability</strong></a> (highlighted the one that applies here):</p>\n<blockquote>\n<p>A value <code>x</code> is assignable to a <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">variable</a> of type <code>T</code> (&quot;<code>x</code> is assignable to <code>T</code>&quot;) in any of these cases:</p>\n<ul>\n<li><code>x</code>'s type is identical to <code>T</code>.</li>\n<li><code>x</code>'s type <code>V</code> and <code>T</code> have identical <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">underlying types</a> and at least one of <code>V</code> or <code>T</code> is not a named type.</li>\n<li><code>T</code> is an interface type and <code>x</code> <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">implements</a> <code>T</code>.</li>\n<li><strong><code>x</code> is a bidirectional channel value, <code>T</code> is a channel type, <code>x</code>'s type <code>V</code> and <code>T</code> have identical element types, and at least one of <code>V</code> or <code>T</code> is not a named type.</strong></li>\n<li><code>x</code> is the predeclared identifier <code>nil</code> and <code>T</code> is a pointer, function, slice, map, channel, or interface type.</li>\n<li><code>x</code> is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> representable by a value of type <code>T</code>.</li>\n</ul>\n</blockquote>\n<p>You can make it work if you try to pass a value of unnamed type but having the same underlying type, which can be achieved by using a type conversion, e.g.:</p>\n<pre><code>test1((chan int)(make(Ch)))\n</code></pre>\n<p>But the above conversion would defeat the purpose of having the named <code>Ch</code> type (as you have to repeat its type literal in order to convert it to an unnamed type just so you can pass it to <code>test1()</code>).</p>\n<p>What you should do is don't hide that the type is a channel (don't include <code>chan</code> in the type literal of the type declaration), only create a new type for the element type of the channel, e.g.:</p>\n<pre><code>type Msg int\n\nfunc test(in chan&lt;- Msg) {\n    fmt.Println(in)\n}\n\nfunc main() {\n    test(make(chan Msg))\n    test(make(chan&lt;- Msg))\n\n    ch := make(chan Msg)\n    chIn := (chan&lt;- Msg)(ch)\n    test(chIn)\n}\n</code></pre>\n<p>Try it on the <a href=\"http://play.golang.org/p/aISchHqG0k\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 5551, "user_id": 1201488, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cce2b982a2acdfb40f3c376489403f1e?s=128&d=identicon&r=PG", "display_name": "Ivan Velichko", "link": "https://stackoverflow.com/users/1201488/ivan-velichko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 1, "accepted_answer_id": 36821007, "answer_count": 1, "score": 2, "last_activity_date": 1477473424, "creation_date": 1461484825, "question_id": 36820663, "link": "https://stackoverflow.com/questions/36820663/type-alias-for-channel-in-go-works-strange", "title": "Type alias for channel in Go works strange", "body": "<p>I want to organize communication between two functions via channels. The callee can only send data to the channel while the caller will wait for it in the <code>select</code>. And I want to show this restriction in the callee signature. Another thing that I want is working with type aliases for channels. For example, instead of having <code>chan string</code> I want to work with <code>MsgChan</code> defined as <code>type MsgChan chan string</code>. And I faced with the problem - the code below won't compile if uncomment line <code>test1(make(Ch))</code>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Ch chan int\ntype ChIn chan&lt;- int\n\nfunc test1(in ChIn) {\n    fmt.Println(in)\n}\n\nfunc test2(in chan&lt;- int) {\n    fmt.Println(in)\n}\n\nfunc main() {\n    //test1(make(Ch))\n    test1(make(chan int))\n    test2(make(Ch))\n    test2(make(ChIn))\n}\n</code></pre>\n\n<p>I don't understand why I can't use such approach?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"tags": [], "owner": {"reputation": 2065, "user_id": 645974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dBQ9J.png?s=128&g=1", "display_name": "Friedrich Gro&#223;e", "link": "https://stackoverflow.com/users/645974/friedrich-gro%c3%9fe"}, "is_accepted": false, "score": 1, "last_activity_date": 1461488403, "creation_date": 1461488403, "answer_id": 36821125, "question_id": 36820470, "link": "https://stackoverflow.com/questions/36820470/how-to-detect-a-zeroed-value-of-struct-safely-in-go/36821125#36821125", "title": "How to detect a zeroed value of struct safely in Go?", "body": "<p>You can always just insert an empty string into your table column. If it is truly important to know the difference between the zero value or complete absence of a value you would need to use pointers.</p>\n\n<pre><code>type User struct {\n    ID        int64\n    Username  *string\n}\n</code></pre>\n\n<p>This changes the zero value to be <code>nil</code> so you can distinguish that from <code>\"\"</code>.\nThe downside is that this makes this type less easy to use (<code>nil</code> checks are often forgotten in practice) and you have to dereference that field to get the actual string.</p>\n\n<p>In your specific example I don't see why you need to worry about the empty value at all. Can't you just insert <code>\"\"</code> into the database and enforce validation (non-emptiness) in your code instead of using database constraints?</p>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1461512126, "creation_date": 1461512126, "answer_id": 36825249, "question_id": 36820470, "link": "https://stackoverflow.com/questions/36820470/how-to-detect-a-zeroed-value-of-struct-safely-in-go/36825249#36825249", "title": "How to detect a zeroed value of struct safely in Go?", "body": "<p>To handle database columns that may be <code>NULL</code>, you can either use pointers as Friedrich Gro\u00dfe suggests, or use the <code>Null...</code>-variants found in the <code>db</code> package, for instance <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"nofollow\"><code>sql.NullString</code></a>.</p>\n\n<p>To use the Null-variants, the struct would be</p>\n\n<pre><code>type User struct {\n    ID        int64\n    Username  string\n    Password  string\n    Email     sql.NullString\n    Comment   sql.NullString\n}\n</code></pre>\n\n<p>You can then detect of a value is set by checking <code>NullString.Valid</code>. The downside of using <code>NullString</code> is that you have to add special cases when printing or marshaling them, as they don't implement the <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow\"><code>Stringer</code></a> interface, nor <code>MarshalJSON</code> or <code>UnmarshalJSON</code>. You also have to remember to set <code>NullString.Valid</code> manually when setting the value of the string.</p>\n\n<p>For instance, a test like</p>\n\n<pre><code>func TestNullString(t *testing.T) {\n    s := sql.NullString{}\n    t.Log(s)\n\n    s.String = \"Test\"\n    s.Valid = true\n    t.Log(s)\n}\n</code></pre>\n\n<p>Prints</p>\n\n<pre><code>null_string_test.go:21: { false}\nnull_string_test.go:25: {Test true}\n</code></pre>\n\n<p>To print a <code>NullString</code> you have to instead do</p>\n\n<pre><code>func TestNullString(t *testing.T) {\n    s := sql.NullString{}\n    t.Log(s.String)\n\n    s.String = \"Test\"\n    s.Value = true\n    t.Log(s.String)\n}\n</code></pre>\n\n<p>Which prints:</p>\n\n<pre><code>null_string_test.go:21: \nnull_string_test.go:25: Test\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 4737876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tygIZ.jpg?s=128&g=1", "display_name": "Muge", "link": "https://stackoverflow.com/users/4737876/muge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 36825249, "answer_count": 2, "score": 0, "last_activity_date": 1461512126, "creation_date": 1461483189, "last_edit_date": 1461483510, "question_id": 36820470, "link": "https://stackoverflow.com/questions/36820470/how-to-detect-a-zeroed-value-of-struct-safely-in-go", "title": "How to detect a zeroed value of struct safely in Go?", "body": "<p>I tried to written an simple ORM for MySQL, I got a problem, if a defined struct missing some field:</p>\n\n<pre><code>type User struct {\n    ID        int64\n    Username  string\n    Password  string\n    Email     string\n    Comment   string\n}\n\nvar u = User{Username: \"user_0001\", Password: \"password\"}\n</code></pre>\n\n<p>Some fields of User didn't given a value, then it's value will be a zeroed value, such as string <code>\"\"</code>, bool <code>false</code>, integer <code>0</code> and so on.</p>\n\n<p>So I am using <code>reflect</code> to get field name and value, generate a sql to insert row.</p>\n\n<p><code>INSERT INTO User (Id, Username, Password, Email, Comment) Values (0, \"user_0001\",  \"password\", , ,)</code>  </p>\n\n<p>You can see there has some zeroed value of string, if I detect empty string <code>\"\"</code> and skip them, I may skip normal value. </p>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 515, "user_id": 414031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76564311beb510875b9db52dba389777?s=128&d=identicon&r=PG", "display_name": "dragosplesca", "link": "https://stackoverflow.com/users/414031/dragosplesca"}, "edited": false, "score": 0, "creation_date": 1461584979, "post_id": 36818212, "comment_id": 61249318, "body": "If you want to avoid this kind of issues you can try using the <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">json-to-go tool</a>. It basically converts json to a type definition."}], "answers": [{"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461461386, "post_id": 36818249, "comment_id": 61208989, "body": "Could you explain this a little more? I&#39;m not sure I understand."}, {"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461462795, "post_id": 36818249, "comment_id": 61209239, "body": "I think I see, <a href=\"http://stackoverflow.com/a/25966781/998117\">this answer</a> details it a bit, but isn&#39;t it optional to do it this way (ie: me using two outer structs to do it should still work)?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1461470798, "last_edit_date": 1461470798, "creation_date": 1461460724, "answer_id": 36818249, "question_id": 36818212, "link": "https://stackoverflow.com/questions/36818212/why-does-go-error-when-trying-to-marshal-this-json/36818249#36818249", "title": "Why does Go error when trying to marshal this JSON?", "body": "<p>The structure of the Go types must match the structure in the JSON data. The application is missing a level of nesting for the bolded range of this JSON:   {\"tracks\":{<strong>\"track\":</strong>[{</p>\n\n<p>Here's how to update the types to match the JSON:</p>\n\n<pre><code>type Tracks struct {\n    Tracks struct {\n      Track []Track\n    }\n}\n\n...\n\nfor _, track := range tracks.Tracks.Track {\n    fmt.Printf(\"%s: %s\\n\", track.Artist.Name, track.Name)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": false, "score": 1, "last_activity_date": 1461468857, "creation_date": 1461468857, "answer_id": 36819001, "question_id": 36818212, "link": "https://stackoverflow.com/questions/36818212/why-does-go-error-when-trying-to-marshal-this-json/36819001#36819001", "title": "Why does Go error when trying to marshal this JSON?", "body": "<p>If you look at the JSON structure of the response to your query you'll see that a single object with a <code>tracks</code> property is returned.  </p>\n\n<pre><code>{\n    \"tracks\": {\n        \"track\": [ {...} ]\n    }\n}\n</code></pre>\n\n<p>If you compare this to to the given structs you can see that the structure does not align. Your given <code>Tracks</code> struct has a field that is a slice of <code>Track</code>s. If I were to cast this as JSON it would be represented as the following.</p>\n\n<pre><code>{ \n    \"tracks\": [ { ... } ]\n}\n</code></pre>\n\n<p>This is the root of your error. The JSON decoder is expecting the <code>tracks</code> field of the root JSON object to be an array. What is returned is an object that contains the <code>tracks</code> property but its values is another JSON object which contains the <code>track</code> property which <strong>is</strong> the array of tracks. You could update your structures to reflect this schema as follows.</p>\n\n<pre><code>// A response object from the API\ntype Response struct {\n    Tracks Tracks\n}\n\n// Tracks a group of Track types\ntype Tracks struct {\n    Track []Track\n}\n\n// Track represents a singular track\ntype Track struct {\n    Name   string\n    URL    string\n    Artist Artist\n}\n</code></pre>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1236, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461470798, "creation_date": 1461460297, "question_id": 36818212, "link": "https://stackoverflow.com/questions/36818212/why-does-go-error-when-trying-to-marshal-this-json", "title": "Why does Go error when trying to marshal this JSON?", "body": "<p>I'm trying a rather simple example of trying to decode a JSON file into some structs using golang. However, when attempting to I get the error that</p>\n\n<blockquote>\n  <p>json: cannot unmarshal object into Go value of type []main.Track</p>\n</blockquote>\n\n<p>Which I don't understand. Here's the code in question, and the JSON can be <a href=\"http://ws.audioscrobbler.com/2.0/?method=geo.gettoptracks&amp;api_key=c1572082105bd40d247836b5c1819623&amp;format=json&amp;country=Netherlands\" rel=\"nofollow\">found here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n)\n\n// Tracks a group of Track types\ntype Tracks struct {\n    Tracks []Track\n}\n\n// Track represents a singular track\ntype Track struct {\n    Name   string\n    URL    string\n    Artist Artist\n}\n\n// Artist represents a single artist\ntype Artist struct {\n    Name string\n    MBID string\n    URL  string\n}\n\nfunc main() {\n    url := \"http://ws.audioscrobbler.com/2.0/?method=geo.gettoptracks&amp;api_key=c1572082105bd40d247836b5c1819623&amp;format=json&amp;country=Netherlands\"\n    response, err := http.Get(url)\n\n    if err != nil {\n        fmt.Printf(\"%s\\n\", err)\n        os.Exit(1)\n    }\n\n    defer response.Body.Close()\n\n    var tracks Tracks\n    decodeErr := json.NewDecoder(response.Body).Decode(&amp;tracks)\n\n    if decodeErr != nil {\n        fmt.Printf(\"%s\\n\", decodeErr)\n        os.Exit(1)\n    }\n\n    for _, track := range tracks.Tracks {\n        fmt.Printf(\"%s: %s\\n\", track.Artist.Name, track.Name)\n    }\n}\n</code></pre>\n\n<p>My initial thought was maybe you need to categorize every single JSON value with structs, which I didn't do, but upon reading <a href=\"https://eager.io/blog/go-and-json/\" rel=\"nofollow\">this article</a> which says:</p>\n\n<blockquote>\n  <p>There are two answers to this. The easy option, for when you know what your data will look like, is to parse the JSON into a struct you\u2019ve defined. <strong>Any field which doesn\u2019t fit in the struct will just be ignored.</strong> We\u2019ll cover that option first.</p>\n</blockquote>\n\n<p>Which leads me to believe that it isn't that.</p>\n\n<p>What am I doing wrong in this scenario?</p>\n"}, {"tags": ["json", "api", "go", "jsonp"], "answers": [{"comments": [{"owner": {"reputation": 555, "user_id": 4461141, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0dhjb.jpg?s=128&g=1", "display_name": "hbd", "link": "https://stackoverflow.com/users/4461141/hbd"}, "edited": false, "score": 0, "creation_date": 1461554090, "post_id": 36818242, "comment_id": 61233762, "body": "I was referring to the ex below the JavaScript example:  <code>detailResultHandler( {    &quot;marketdetails&quot;: {      &quot;GoogleLink&quot;:&quot;http:&#47;&#47;maps.google.com&#47;?q=38.881112%2C%20-77.1&zwnj;&#8203;12179%20(%22Ballston&zwnj;&#8203;+FRESHFARM+Market%22&zwnj;&#8203;)&quot;,      &quot;Address&quot;:&quot;901 N Taylor St, Ballston, Virginia, 22203&quot;,      &quot;Schedule&quot;:&quot;June - October Thursday 3:00 PM to 7:00 PM&quot;,      &quot;Products&quot;:&quot;Baked goods; Cheese and&#47;or dairy products; Eggs; Fresh fruit and vegetables; Fresh and&#47;or dried herbs; Honey; Meat; Poultry&quot;    } } );</code>   Although, I understand your point and will refactor it using two structs, <code>marketDetails</code> and what&#39;s inside"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 2, "last_activity_date": 1461460666, "creation_date": 1461460666, "answer_id": 36818242, "question_id": 36818136, "link": "https://stackoverflow.com/questions/36818136/how-can-i-unmarshall-jsonp-returned-from-a-request/36818242#36818242", "title": "How can I unmarshall JSONp returned from a request?", "body": "<p>The response body is JSON - as per the response's <code>Content-Type:application/json; charset=utf-8</code> header.</p>\n\n<p>The issue is that your <code>marketResponse</code> struct bears no relation to the JSON returned. Using <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow\">JSON-to-Go</a>, your struct should look like:</p>\n\n<pre><code>type MarketResponse struct {\n    Results []Result `json:\"results\"`\n}\n\ntype Result struct {\n    ID string `json:\"id\"`\n    Marketname string `json:\"marketname\"`\n}\n</code></pre>\n\n<p>It's not clear where your existing <code>marketResponse</code> struct fits here, as neither API endpoint returns data with that structure.</p>\n\n<p>PS: You should handle (or return) your errors and not just log them; logging them still means that your function continues with unhandled error. Your code might then panic when it encounters a nil response body or JSON unmarshalling error.</p>\n"}], "owner": {"reputation": 555, "user_id": 4461141, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0dhjb.jpg?s=128&g=1", "display_name": "hbd", "link": "https://stackoverflow.com/users/4461141/hbd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 2, "accepted_answer_id": 36818242, "answer_count": 1, "score": 2, "last_activity_date": 1461460666, "creation_date": 1461459448, "question_id": 36818136, "link": "https://stackoverflow.com/questions/36818136/how-can-i-unmarshall-jsonp-returned-from-a-request", "title": "How can I unmarshall JSONp returned from a request?", "body": "<p>I'm attempting to use the <a href=\"http://search.ams.usda.gov/farmersmarkets/v1/svcdesc.html\" rel=\"nofollow\">USDA's Farmers Market Directory API</a> to receive a data about where nearby farmer's markets are located, using a zip code. I store the unmarshalled body of the response in:</p>\n\n<pre><code>type marketResponse struct {\n        MapsLink string `json:\"GoogleLink\"`\n        Address  string `json:\"Address\"`\n        Schedule string `json:\"Schedule\"`\n        Products string `json:\"Products\"`\n}\n</code></pre>\n\n<p>Using the code:</p>\n\n<pre><code>//TODO: location: \"http://search.ams.usda.gov/farmersmarkets/v1/data.svc/locSearch?lat=\" + lat + \"&amp;lng=\" + lng\nresp, err := http.Get(\"http://search.ams.usda.gov/farmersmarkets/v1/data.svc/zipSearch?zip=\" + zipcode)\nif err != nil {\n        log.Printf(\"Could net search zipcode %s: %v\", zipcode, err)\n}\ndefer func() {\n        if err := resp.Body.Close(); err != nil {\n                log.Println(err)\n        }\n}()\n\nbody, err := ioutil.ReadAll(resp.Body)\nif err != nil {\n        log.Println(err)\n}\n\nnewMarket := &amp;marketResponse{}\nif err := json.Unmarshal(body, newMarket); err != nil {\n        log.Println(err)\n}\n\nlog.Println(\"response: \" + newMarket.Address)\n</code></pre>\n\n<p>The problem is, the response body is in JSONp, and I'm unmarshalling in JSON. How can I unmarshal in JSONp, using an external package, or not?</p>\n"}, {"tags": ["go", "go-gorm"], "answers": [{"comments": [{"owner": {"reputation": 475, "user_id": 2209233, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/iu8vv.jpg?s=128&g=1", "display_name": "a-b-r-o-w-n", "link": "https://stackoverflow.com/users/2209233/a-b-r-o-w-n"}, "edited": false, "score": 0, "creation_date": 1461453827, "post_id": 36816752, "comment_id": 61207534, "body": "Thanks for the response. I am still a little confused. My goal is to create an interface for <code>gorm.DB</code> in order to use a mock in a unit test.  Since I don&#39;t have control over what <code>gorm.DB</code> methods return, I am unsure of how to correctly define the interface."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1461447546, "creation_date": 1461447546, "answer_id": 36816752, "question_id": 36816553, "link": "https://stackoverflow.com/questions/36816553/how-to-properly-define-a-gorm-db-interface/36816752#36816752", "title": "How to properly define a gorm db interface?", "body": "<p><code>TestDB</code> methods must return <code>*DBProxy</code> to implement <code>DBProxy</code></p>\n\n<pre><code>func (t *TestDB) Create(values interface{}) *DBProxy {\n    return t\n}\nfunc (t *TestDB) Update(values interface{}) *DBProxy {\n    return t\n}\n</code></pre>\n\n<p>later you will need to assert <code>CreatedDBProxy.(TestDB)</code> </p>\n"}], "owner": {"reputation": 475, "user_id": 2209233, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/iu8vv.jpg?s=128&g=1", "display_name": "a-b-r-o-w-n", "link": "https://stackoverflow.com/users/2209233/a-b-r-o-w-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1168, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1461456565, "creation_date": 1461446333, "last_edit_date": 1461456565, "question_id": 36816553, "link": "https://stackoverflow.com/questions/36816553/how-to-properly-define-a-gorm-db-interface", "title": "How to properly define a gorm db interface?", "body": "<p>I am trying to unit test methods that use type <code>*gorm.DB</code> and am curious how to properly define an interface that will enable me to test without hitting a db.</p>\n\n<p>Here is a small example of what I want to do:</p>\n\n<pre><code>type DBProxy interface {\n    Create(values interface{}) *DBProxy\n    Update(values interface{}) *DBProxy\n}\n\ntype TestDB struct{}\n\nfunc (t *TestDB) Create(values interface{}) *TestDB {\n    return t\n}\n\nfunc (t *TestDB) Update(values interface{}) *TestDB {\n    return t\n}\n\nfunc Connect() DBProxy {\n    return &amp;TestDB{}\n}\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code>cannot use TestDB literal (type *TestDB) as type DBProxy in return argument:\n    *TestDB does not implement DBProxy (wrong type for Create method)\n            have Create(interface {}) *TestDB\n            want Create(interface {}) *DBProxy\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n\n<hr>\n\n<p>UPDATE</p>\n\n<p>Here is my actual application code:</p>\n\n<pre><code>package database\n\nimport (\n    \"log\"\n    \"os\"\n\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n)\n\ntype DBProxy interface {\n    Create(values interface{}) DBProxy\n    Update(values interface{}) DBProxy\n}\n\nfunc Connect() DBProxy {\n    databaseUrl := os.Getenv(\"DATABASE_URL\")\n\n    db, err := gorm.Open(\"postgres\", databaseUrl)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    return db\n}\n</code></pre>\n\n<p>Which results in:</p>\n\n<pre><code>cannot use db (type *gorm.DB) as type DBProxy in return argument:\n    *gorm.DB does not implement DBProxy (wrong type for Create method)\n            have Create(interface {}) *gorm.DB\n            want Create(interface {}) DBProxy\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1461457991, "post_id": 36816904, "comment_id": 61208355, "body": "The template -&gt; buffer trick is a good one (I just wanted to second that). You can also (if you&#39;re not being a HTTP reverse proxy) use the gzip middleware from <a href=\"https://github.com/gorilla/handlers\" rel=\"nofollow noreferrer\">gorilla/handlers</a> to gzip responses, as well as logging &amp; panic recovery. Those won&#39;t speed things up, but they&#39;ll help make your application more robust."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1461449306, "last_edit_date": 1461449306, "creation_date": 1461448514, "answer_id": 36816904, "question_id": 36816412, "link": "https://stackoverflow.com/questions/36816412/basic-web-tweaks-that-all-applications-should-have/36816904#36816904", "title": "Basic web tweaks that all applications should have", "body": "<ol>\n<li><p>You don't need to set/change <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow\"><code>runtime.GOMAXPROCS()</code></a> as since Go 1.5 it defaults to the number of available CPU cores.</p></li>\n<li><p>Buffering output? From the performance point of view, you don't need to. But there may be other considerations for which you may.</p></li>\n</ol>\n\n<p>For example, your <code>renderTemplate()</code> function may potentially panic. If executing the template starts writing to the output, it involves setting the HTTP response code and other headers prior to writing data. And if a template execution error occurs after that, it will return an error, and so your code attempts to send back an error response. At this point HTTP headers are already written, and this <a href=\"https://golang.org/pkg/net/http/#Error\" rel=\"nofollow\"><code>http.Error()</code></a> function will try to set headers again => panic.</p>\n\n<p>One way to avoid this is to first render the template into a buffer (e.g. <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow\"><code>bytes.Buffer</code></a>), and if no error is returned by the template execution, then you can write the content of the buffer to the response writer. If error occurs, then of course you won't write the content of the buffer, but send back an error response just like you did.</p>\n\n<p>To sum it up, your code is production ready performance-wise (excluding the way you handle template execution errors).</p>\n"}, {"tags": [], "owner": {"reputation": 6120, "user_id": 1309352, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/8ff1bfcff680fcc6dcd170ba54194ecb?s=128&d=identicon&r=PG", "display_name": "Bleeding Fingers", "link": "https://stackoverflow.com/users/1309352/bleeding-fingers"}, "is_accepted": false, "score": 0, "last_activity_date": 1461448531, "creation_date": 1461448531, "answer_id": 36816909, "question_id": 36816412, "link": "https://stackoverflow.com/questions/36816412/basic-web-tweaks-that-all-applications-should-have/36816909#36816909", "title": "Basic web tweaks that all applications should have", "body": "<ol>\n<li><code>WelcomeHandler</code> should return when <code>err != nil</code> is true.</li>\n<li>Log the error when one is hit to help investigation.</li>\n<li>Place <code>templates = template.Must(template.ParseFiles(\"templates/home.html\")</code> in the <code>init</code>. Split it into separate lines. If <code>template.ParseFiles</code> returns an then error make a <code>Fatal</code> log. And if you have multiple templates to initialize then initialize them in goroutines with a common <code>WaitGroup</code> to speed up the startup.</li>\n<li>Since you are using mux, <em><a href=\"https://groups.google.com/d/topic/golang-nuts/zWPOOJjCgNQ/discussion\" rel=\"nofollow\">HTTP Server is too clean with its URLs</a></em> might also be good to know.</li>\n<li>You might also want to reconsider the decision of letting the user's know why they got the <code>http.StatusInternalServerError</code> response.</li>\n<li>Setting the <code>GOMAXPROCS</code> > 1 if you have more the one core would definitely be a good idea but I would keep it less than number of cores available.</li>\n</ol>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1461449306, "creation_date": 1461445479, "question_id": 36816412, "link": "https://stackoverflow.com/questions/36816412/basic-web-tweaks-that-all-applications-should-have", "title": "Basic web tweaks that all applications should have", "body": "<p>Currently my web app is just a router and handlers.</p>\n\n<p>What are some important things I am missing to make this production worthy?</p>\n\n<ol>\n<li><p>I believe I have to set the # of procs to ensure this uses maximum goroutines?</p></li>\n<li><p>Should I be using output buffering?   </p></li>\n</ol>\n\n<p>Anything else you see missing that is best-practise?</p>\n\n<pre><code>var (\n  templates = template.Must(template.ParseFiles(\"templates/home.html\")\n)\n\nfunc main() {\n  r := mux.NewRouter()\n  r.HandleFunc(\"/\", WelcomeHandler)\n\n  http.ListenAndServe(\":9000\", r)\n}\n\nfunc WelcomeHandler(w http.ResponseWriter, r *http.Request) {\n    homePage, err := api.LoadHomePage()\n    if err != nil {\n    }\n    tmpl := \"home\"\n    renderTemplate(w, tmpl, homePage)\n}\n\nfunc renderTemplate(w http.ResponseWriter, tmpl string, hp *HomePage) {\n\n    err := templates.ExecuteTemplate(w, tmpl+\".html\", hp)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 2065, "user_id": 645974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dBQ9J.png?s=128&g=1", "display_name": "Friedrich Gro&#223;e", "link": "https://stackoverflow.com/users/645974/friedrich-gro%c3%9fe"}, "reply_to_user": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1461486486, "post_id": 36814965, "comment_id": 61213634, "body": "If you already have all the data as <code>[]byte</code> then I prefer using <code>json.Marshal</code>. If you work with streamed data and/or you just have an <code>io.Reader</code> the <code>json.Decoder</code> is the way to go."}], "tags": [], "owner": {"reputation": 2065, "user_id": 645974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dBQ9J.png?s=128&g=1", "display_name": "Friedrich Gro&#223;e", "link": "https://stackoverflow.com/users/645974/friedrich-gro%c3%9fe"}, "is_accepted": false, "score": 2, "last_activity_date": 1461437148, "creation_date": 1461437148, "answer_id": 36814965, "question_id": 36814394, "link": "https://stackoverflow.com/questions/36814394/how-to-encode-a-struct-back-to-a-bytes-buffer/36814965#36814965", "title": "How to encode a struct back to a bytes buffer", "body": "<p>I am a bit confused by your question but maybe this helps a bit:</p>\n\n<p>Assuming you would use the standard <a href=\"https://godoc.org/net/http#Client\" rel=\"nofollow\"><code>http.Client</code></a> your HTTP call would be done via <code>Client.Do</code> which returns an <a href=\"https://godoc.org/net/http#Response\" rel=\"nofollow\"><code>*http.Response</code></a>.</p>\n\n<p>You can read the response body from the <code>Body</code> field which is of type <a href=\"https://godoc.org/io#ReadCloser\" rel=\"nofollow\"><code>io.ReadCloser</code></a>. This is actually just an interface that combines the <a href=\"https://godoc.org/io#Reader\" rel=\"nofollow\"><code>io.Reader</code></a> and <a href=\"https://godoc.org/io#Closer\" rel=\"nofollow\"><code>io.Closer</code></a> interface. If you know the response is <code>json</code> you can now create a <code>json.Decoder</code> using <a href=\"https://godoc.org/encoding/json#NewDecoder\" rel=\"nofollow\"><code>json.NewDecoder</code></a> which accepts any <code>io.Reader</code>.</p>\n\n<p>Its important to keep in mind that all types <em>implicitly</em> implement <code>io.Reader</code> by having the following function defined on them:</p>\n\n<pre><code>Read(p []byte) (n int, err error)\n</code></pre>\n\n<p>Just as the <code>*http.Response</code> <code>Body</code> field is an <code>io.Reader</code> any <code>bytes.Buffer</code> implements <code>io.Reader</code> because it implements the <a href=\"https://godoc.org/bytes#Buffer.Read\" rel=\"nofollow\"><code>Buffer.Read</code></a> function.</p>\n\n<p>In contrast a <code>[]byte</code> (byte array) is a scalar type that does not implement any functions on its own. Therefore <code>[]byte</code> does not implement <code>io.Reader</code> so you can not just pass this into <code>json.NewDecoder</code>. If you want to decode JSON from a byte array/slice you should probably just use <a href=\"https://godoc.org/encoding/json#Unmarshal\" rel=\"nofollow\"><code>json.Unmarshal</code></a> or create a <code>bytes.Buffer</code> from your <code>[]byte</code> using <a href=\"https://godoc.org/bytes#NewBuffer\" rel=\"nofollow\"><code>bytes.NewBuffer</code></a> and then again pass that to the <code>json.Decoder</code>.</p>\n\n<p>The same concepts apply for encoding JSON back but this time instead of an <code>io.Reader</code> you need an <code>io.Writer</code> and a <a href=\"https://godoc.org/encoding/json#NewEncoder\" rel=\"nofollow\"><code>json.Encoder</code></a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1461437166, "creation_date": 1461437166, "answer_id": 36814971, "question_id": 36814394, "link": "https://stackoverflow.com/questions/36814394/how-to-encode-a-struct-back-to-a-bytes-buffer/36814971#36814971", "title": "How to encode a struct back to a bytes buffer", "body": "<p><code>io.Reader</code> and <code>io.Writer</code> are interfaces specifying object behaviour regardless of it implementation. <code>bytes.Buffer</code> is data structure implementing both <code>io.Reader</code> and <code>io.Writer</code>. array is just core language data structure similar with others languages have. Most interfaces advantage is you can operate with them uniformly despite underlying implementations. For example io library has <code>func TeeReader(r Reader, w Writer) Reader</code> which returns a Reader that writes to w what it reads from r. You can use it to gzip response as you read and decode it.</p>\n\n<pre><code>SomeWriter, err := os.OpenFile(\"some/File\", os.O_WRONLY, os.ModePerm ) //gzip to file for example\ngzipper := gzip.NewWriter(SomeWriter) //but can be any Writer\ntee := io.TeeReader(response, gzipper)\n//and then\nerr = json.NewDecoder(tee).Decode(&amp;result)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 151, "user_id": 6245323, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZiMWDvaRjho/AAAAAAAAAAI/AAAAAAAAAcM/9udCViYeq9Y/photo.jpg?sz=128", "display_name": "Andreas Schyman", "link": "https://stackoverflow.com/users/6245323/andreas-schyman"}, "is_accepted": false, "score": 3, "last_activity_date": 1461437652, "creation_date": 1461437652, "answer_id": 36815057, "question_id": 36814394, "link": "https://stackoverflow.com/questions/36814394/how-to-encode-a-struct-back-to-a-bytes-buffer/36815057#36815057", "title": "How to encode a struct back to a bytes buffer", "body": "<p>If you want to store your struct as json, the simplest way is usually to use <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\"><code>json.Marshal()</code></a>, as in:</p>\n\n<pre><code>b, err := json.Marshal(&amp;myStruct)\n</code></pre>\n\n<p>b will in this case be a byte slice ([]byte). This can later be gzipped using the <code>gzip</code> package. For instance, to gzip the bytes to a file, you could use:</p>\n\n<pre><code>f, _ := os.Create(\"/tmp/s.gz\")\ndefer f.Close()\n\nw := gzip.NewWriter(f)\nw.Write(b)\nw.Close()\n</code></pre>\n\n<p>If you want to, you can bypass creating the byte slice by using <a href=\"https://golang.org/pkg/encoding/json/#Encoder.Encode\" rel=\"nofollow\"><code>json.Encoder.Encode()</code></a> directly instead.</p>\n\n<pre><code>f, _ := os.Create(\"/tmp/s.gz\")\ndefer f.Close()\n\nw := gzip.NewWriter(f)\njson.NewEncoder(w).Encode(&amp;myStruct)\nw.Close()\n</code></pre>\n\n<p>Depending on where you want to store or send the gzipped json, you can replace the parameter <code>f</code> used in <code>gzip.NewWriter(f)</code> to be any object that implements <code>io.Writer</code>. For instance, you can send the gzipped response using <code>http.ResponseWriter</code> directly in a handler:</p>\n\n<pre><code>func MyHandler(w http.ResponseWriter, r *http.Request) {\n    myStruct := ...          // Get struct from somewhere\n    gz := gzip.NewWriter(w)\n    json.NewEncoder(gz).Encode(&amp;myStruct)\n    gz.Close()\n}\n</code></pre>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1418, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1461437652, "creation_date": 1461434174, "question_id": 36814394, "link": "https://stackoverflow.com/questions/36814394/how-to-encode-a-struct-back-to-a-bytes-buffer", "title": "How to encode a struct back to a bytes buffer", "body": "<p>I am making a API request and the response I get back is a bytes.Buffer.\nI then json decode that into my struct:</p>\n\n<pre><code>resp, status, err := // api call that calls http client do and returns byte buff\n\nresult := MyStruct{}\nerr = json.NewDecoder(response).Decode(&amp;result)\n</code></pre>\n\n<p>I know want to take my struct, result, and gzip it.  </p>\n\n<p><strong>Should I be using a json decoder to get the value back?</strong></p>\n\n<p>I want to then take that decoded json so I can then gzip it eventually.</p>\n\n<p>Also, I am confused between a byte array, bytebuffer and then these readers.  Is this hierarchy like java?</p>\n"}, {"tags": ["image", "go", "rpc", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1461430750, "creation_date": 1461430750, "answer_id": 36813784, "question_id": 36813361, "link": "https://stackoverflow.com/questions/36813361/sending-and-image-through-gorpc/36813784#36813784", "title": "sending and image through goRPC", "body": "<p>Type <code>image.Image</code> is an interface so you can't register it, it's too abstract. Underlaying implementations for jpeg however are either <code>image.Gray</code> or <code>image.YCbCr</code>, both concrete structs, you may type assert <code>img.(Gray)</code> to decide which. Try to register both <code>image.Gray</code> and <code>image.YCbCr</code>, assert which you have have and then send as concrete type.</p>\n"}], "owner": {"reputation": 75, "user_id": 5739130, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f019a2cde05dc1b7585530a341841f80?s=128&d=identicon&r=PG&f=1", "display_name": "dbaus", "link": "https://stackoverflow.com/users/5739130/dbaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 36813784, "answer_count": 1, "score": 0, "last_activity_date": 1506098534, "creation_date": 1461428782, "question_id": 36813361, "link": "https://stackoverflow.com/questions/36813361/sending-and-image-through-gorpc", "title": "sending and image through goRPC", "body": "<p>I want to send an image through rpc using the golang packet <a href=\"https://godoc.org/github.com/valyala\" rel=\"nofollow\">valyala goRPC</a> and I'm having some problems to receive the image type in the server.</p>\n\n<p>This is my client code, who takes an .jpg image, decodes it and send it through rpc:</p>\n\n<pre><code>c := &amp;gorpc.Client{\n  // TCP address of the server.\n   Addr: \"127.0.0.1:12345\",\n}\nc.Start()\nreader, err := os.Open(\"barranco.jpg\")\nif err != nil{\n    log.Fatal(err)\n}\n\ndefer reader.Close()\n\nimg, _, err := image.Decode(reader)\nif err != nil {\n    log.Fatal(err)\n}\n\n\nfmt.Print(\"Pulsa intro para enviar.\\n\")\nbufio.NewReader(os.Stdin).ReadBytes('\\n') \n\ngorpc.RegisterType(img)\n\nresp, err := c.Call(img)\n</code></pre>\n\n<p>So in this code, I take an image called barranco.jpg, I decode it but before sending it to the server I register the type on the client.\nMy problem is, how can I register that type in the server? I always get the same fail in the server because I can't register that image type /:</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1461428861, "post_id": 36813338, "comment_id": 61199546, "body": "<code>sudo</code> changes your environment, meaning <code>GOPATH</code> is no longer exported. Run the command again without <code>sudo</code> (this is standard practice)."}, {"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1461428907, "post_id": 36813338, "comment_id": 61199568, "body": "@TimCooper But then I get a bunch of &quot;permission denied&quot; errors"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1461437297, "post_id": 36813338, "comment_id": 61202647, "body": "If you must use <code>sudo</code>, try: <code>sudo env GOPATH=~&#47;Dropbox&#47;golang go get -u golang.org&#47;x&#47;tools&#47;cmd&#47;...</code> \u2014 the <code>env</code> command adds to the environment (when invoked like this) and then runs the <code>go</code> command you originally intended \u2014 but it all happens after <code>sudo</code> tinkers with the environment.  Obviously, this assumes <code>sudo</code> allows you to run <code>env</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461428999, "post_id": 36813385, "comment_id": 61199610, "body": "I get a bunch of permission denied errors if I don&#39;t run it as sudo. I&#39;m following <a href=\"http://marcio.io/2015/07/supercharging-atom-editor-for-go-development/\" rel=\"nofollow noreferrer\">this tutorial</a> which says to do that command under &quot;Installing Packages&quot;."}, {"owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "reply_to_user": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "edited": false, "score": 0, "creation_date": 1461429267, "post_id": 36813385, "comment_id": 61199697, "body": "Yes, some of the packages under <code>tools&#47;...</code> need special permissions, but if you installed go correctly you should already have them. You need to identify which tools you need but don&#39;t have and only install those. (That tutorial recommends installing <code>...</code> because the author presumably installed go in a way that doesn&#39;t require root permissions, probably via homebrew)."}], "tags": [], "owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "is_accepted": true, "score": 2, "last_activity_date": 1461428902, "creation_date": 1461428902, "answer_id": 36813385, "question_id": 36813338, "link": "https://stackoverflow.com/questions/36813338/why-does-golang-say-my-gopath-isnt-set-when-i-set-it-the-command-directly-befor/36813385#36813385", "title": "Why does Golang say my GOPATH isn&#39;t set when I set it the command directly before?", "body": "<p><code>sudo</code> removes environment variables by default, so the command running as <code>root</code> can't see the environment variable set as <code>doug</code>. In general you shouldn't need <code>sudo</code> to run <code>go get</code>, although some of the <code>golang.org/x/tools</code> packages are somewhat special. Try installing just the ones you need (without sudo) instead of using <code>...</code></p>\n"}, {"tags": [], "owner": {"reputation": 2065, "user_id": 645974, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dBQ9J.png?s=128&g=1", "display_name": "Friedrich Gro&#223;e", "link": "https://stackoverflow.com/users/645974/friedrich-gro%c3%9fe"}, "is_accepted": false, "score": 1, "last_activity_date": 1461435001, "creation_date": 1461435001, "answer_id": 36814582, "question_id": 36813338, "link": "https://stackoverflow.com/questions/36813338/why-does-golang-say-my-gopath-isnt-set-when-i-set-it-the-command-directly-befor/36814582#36814582", "title": "Why does Golang say my GOPATH isn&#39;t set when I set it the command directly before?", "body": "<p>I especially like about go that its entire environment is particularly easy to setup just with <code>wget</code> and <code>tar</code> and <strong>without the need for any special permissions</strong>.</p>\n\n<p>This is how I usually install (and update) go on any system:</p>\n\n<pre><code>$ wget https://storage.googleapis.com/golang/go1.6.2.linux-amd64.tar.gz\n$ tar -xzvf go1.6.2.linux-amd64.tar.gz\n$ export GOROOT=$PWD/go\n$ export PATH=$PWD/go/bin:$PATH\n$ which go\n/tmp/example/go/bin/go\n$ go version\ngo version go1.6.2 linux/amd64\n</code></pre>\n\n<p>You can find the links to the tar archives here: <a href=\"https://golang.org/dl/\" rel=\"nofollow\">https://golang.org/dl/</a></p>\n\n<p>I like to download and extract each version I use to <code>$HOME/Programs</code> and then just set a symlink to point to the one I actually want to use:</p>\n\n<pre><code>ls -la /home/fgrosse/Programs | grep go\nlrwxrwxrwx   1 fgrosse fgrosse    6 Mar  9 20:52 go -&gt; go1.6.1\ndrwxr-xr-x  11 fgrosse fgrosse 4.0K Feb 17 21:47 go1.5.4\ndrwxr-xr-x  11 fgrosse fgrosse 4.0K Feb 17 21:47 go1.6\ndrwxrwxr-x  11 fgrosse fgrosse 4.0K Apr 23 19:58 go1.6.1\ndrwxrwxr-x  11 fgrosse fgrosse 4.0K Apr 23 19:58 go1.6.2\n$ echo $GOROOT\n/home/fgrosse/Programs/go\n</code></pre>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 36813385, "answer_count": 2, "score": 0, "last_activity_date": 1461435001, "creation_date": 1461428642, "question_id": 36813338, "link": "https://stackoverflow.com/questions/36813338/why-does-golang-say-my-gopath-isnt-set-when-i-set-it-the-command-directly-befor", "title": "Why does Golang say my GOPATH isn&#39;t set when I set it the command directly before?", "body": "<p>This is becoming very frustrating. I set my GOPATH in my <code>~/.bash_profile</code>, but Go still says it's not set. So I set it manually, and it still says.</p>\n\n<pre><code>computer:~ doug$ export GOPATH=~/Dropbox/golang\ncomputer:~ doug$ sudo go get -u golang.org/x/tools/cmd/...\npackage golang.org/x/tools/cmd/...: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>What am I doing wrong here? If I type <code>goenv</code> it even lists it as being set to the right path.</p>\n"}, {"tags": ["http", "curl", "go", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1461429098, "last_edit_date": 1461429098, "creation_date": 1461428623, "answer_id": 36813334, "question_id": 36813307, "link": "https://stackoverflow.com/questions/36813307/go-gin-framework-testing-query-and-post-with-curl/36813334#36813334", "title": "Go gin-framework: Testing query and POST with cURL", "body": "<p>The ampersand (<code>&amp;</code>) is a special character in your shell. It causes the previous command to run in the background. Your shell was interpreting the command as:</p>\n\n<pre><code>curl -d \"name=Maru&amp;message=Nice\" 0.0.0.0:8080/post?id=2 &amp; # run curl in the background\npage=3 # set page=3\n</code></pre>\n\n<p>Escaping the character will give you the expected result:</p>\n\n<pre><code>curl -d \"name=Maru&amp;message=Nice\" \"0.0.0.0:8080/post?id=2&amp;page=3\"\n</code></pre>\n\n\n\n<pre><code>curl -d \"name=Maru&amp;message=Nice\" 0.0.0.0:8080/post?id=2\\&amp;page=3\n</code></pre>\n"}], "owner": {"reputation": 977, "user_id": 1419809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0Plto.jpg?s=128&g=1", "display_name": "Pauli", "link": "https://stackoverflow.com/users/1419809/pauli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 0, "accepted_answer_id": 36813334, "answer_count": 1, "score": 0, "last_activity_date": 1461444757, "creation_date": 1461428483, "last_edit_date": 1461444757, "question_id": 36813307, "link": "https://stackoverflow.com/questions/36813307/go-gin-framework-testing-query-and-post-with-curl", "title": "Go gin-framework: Testing query and POST with cURL", "body": "<p>I'm trying a code example in <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">the README of gin framework</a> (\"Another example: query + post form\"):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n    router := gin.Default()\n\n    router.POST(\"/post\", func(c *gin.Context) {\n        id := c.Query(\"id\")\n        page := c.DefaultQuery(\"page\", \"0\")\n        name := c.PostForm(\"name\")\n        message := c.PostForm(\"message\")\n\n        fmt.Printf(\"id: %s; page: %s; name: %s; message: %s\\n\", id, page, name, message)\n    })\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>Testing the code with cURL:</p>\n\n<pre><code>curl -d \"name=Maru&amp;message=Nice\" 0.0.0.0:8080/post?id=2&amp;page=3\n</code></pre>\n\n<p>The server returns: <code>id: 2; page: 0; name: Maru; message: Nice</code>. </p>\n\n<p>Is the curl testing correct? Why isn't <code>page</code> in the returned value equal to 3?</p>\n"}, {"tags": ["go", "ssh", "ssh-tunnel"], "comments": [{"owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "edited": false, "score": 0, "creation_date": 1461431684, "post_id": 36813277, "comment_id": 61200592, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/21417223/simple-ssh-port-forward-in-golang\">Simple SSH port forward in Golang</a>"}, {"owner": {"reputation": 20508, "user_id": 2196426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e8759ad9a50739704dca2e84fa9b50?s=128&d=identicon&r=PG", "display_name": "Jakuje", "link": "https://stackoverflow.com/users/2196426/jakuje"}, "edited": false, "score": 0, "creation_date": 1461431693, "post_id": 36813277, "comment_id": 61200599, "body": "It looks like Go&#39;s <code>ssh</code> package does not support that."}], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 7093791, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U3SlziR2xH4/AAAAAAAAAAI/AAAAAAAAAXM/SCqt1gfQmCQ/photo.jpg?sz=128", "display_name": "Ali K. Nouri", "link": "https://stackoverflow.com/users/7093791/ali-k-nouri"}, "is_accepted": false, "score": 0, "last_activity_date": 1539173193, "creation_date": 1539173193, "answer_id": 52739893, "question_id": 36813277, "link": "https://stackoverflow.com/questions/36813277/how-can-i-create-a-socks5-tunnel-with-gos-ssh-package/52739893#52739893", "title": "How can I create a socks5 tunnel with Go&#39;s ssh package?", "body": "<p>Have you tried the command below ?</p>\n\n<p><code> ssh -D 8888 -N -q user@host </code></p>\n"}], "owner": {"reputation": 1889, "user_id": 892404, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6c64aa7f128d8b6e4cfeafae93782ec7?s=128&d=identicon&r=PG", "display_name": "Parham Doustdar", "link": "https://stackoverflow.com/users/892404/parham-doustdar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 375, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1539173193, "creation_date": 1461428345, "last_edit_date": 1461735393, "question_id": 36813277, "link": "https://stackoverflow.com/questions/36813277/how-can-i-create-a-socks5-tunnel-with-gos-ssh-package", "title": "How can I create a socks5 tunnel with Go&#39;s ssh package?", "body": "<p>While I understand Go, I don't quite understand what the following command does in <code>ssh</code> terminology:</p>\n\n<pre><code>ssh -N -C -D 8888 user@host.com\n</code></pre>\n\n<p>Doing this allows me to provide <code>127.0.0.1:8888</code> as a socks5 proxy to applications that support proxying.</p>\n\n<p>This is not about port forwarding like other existing questions; this is about dynamic port forwarding.</p>\n\n<p>How can I do a similar thing with <a href=\"http://golang.org/x/crypto/ssh\" rel=\"nofollow\">Go's ssh package</a>? I am trying to create a tunnel to bypass censorship.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 1, "creation_date": 1461479902, "post_id": 36808307, "comment_id": 61212165, "body": "Strings can&#39;t be nil in go."}], "answers": [{"tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": true, "score": 3, "last_activity_date": 1461402882, "creation_date": 1461402882, "answer_id": 36808848, "question_id": 36808307, "link": "https://stackoverflow.com/questions/36808307/check-if-any-field-of-struct-is-nil/36808848#36808848", "title": "Check if any field of struct is nil", "body": "<p>You should first check that Bind doesn't return an error. If it doesn't then all fields will be set to their appropriate values or initialized to zero values if not. This means that the strings are guaranteed to not be nil (though they will be set to <code>\"\"</code> if they did not have a value). </p>\n"}], "owner": {"reputation": 17319, "user_id": 3124746, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/0ihpR.jpg?s=128&g=1", "display_name": "vishes_shell", "link": "https://stackoverflow.com/users/3124746/vishes-shell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "accepted_answer_id": 36808848, "answer_count": 1, "score": 0, "last_activity_date": 1461519264, "creation_date": 1461398952, "last_edit_date": 1461519264, "question_id": 36808307, "link": "https://stackoverflow.com/questions/36808307/check-if-any-field-of-struct-is-nil", "title": "Check if any field of struct is nil", "body": "<p>If there any clean way to check if any field value of <code>struct</code> is <code>nil</code>?</p>\n\n<p>Suppose i have</p>\n\n<pre><code>type test_struct struct {\n    Name    string `json:\"name\" binding:\"required\"`\n    Email   string `json:\"email\" binding:\"required\"`\n    Message string `json:\"message\" binding:\"required\"`\n}\n</code></pre>\n\n<p>And with <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\"><code>Gin</code></a> i am filling the <code>struct</code> with values as</p>\n\n<pre><code>var temp test_struct\nc.Bind(&amp;temp)\n</code></pre>\n\n<p>And everything works fine, but i want to check if any of <code>temp.Name</code>, <code>temp.Email</code>, <code>temp.Message</code> is <code>nil</code>, sure we can check it by simply comparing each field with <code>nil</code>: <code>if temp.Name == nil</code> and so on, but i am looking for a cleaner version of that, is there any?</p>\n\n<p><strong>UPD</strong>: Due to a lack of knowledge in <code>Go</code> language i didn't know that the <code>Bind</code> function of <code>gin</code> package return an error if we pass a strucure with <code>binding:\"required\"</code> fields. Thanks to @matt.s i get it. So the answer would be to check the <code>err</code>:</p>\n\n<pre><code>var temp test_struct\nerr := c.Bind(&amp;temp)\nif err != nil {\n    // Do my stuff(some of fields are not set)\n}\n</code></pre>\n"}, {"tags": ["function", "go", "interface"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1461398633, "post_id": 36808224, "comment_id": 61189719, "body": "I am aiming for something similar to the fmt.Println function how it accepts nearly any built-in type."}, {"owner": {"reputation": 474, "user_id": 601730, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Phh2.png?s=128&g=1", "display_name": "Jessidhia", "link": "https://stackoverflow.com/users/601730/jessidhia"}, "edited": false, "score": 0, "creation_date": 1461399129, "post_id": 36808224, "comment_id": 61189839, "body": "Doesn&#39;t sound like the kind of thing you can&#39;t do without having multiple functions, an interface, or using reflect"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1461427454, "post_id": 36808495, "comment_id": 61199010, "body": "@Acidic, while this answer provides you with a solution, it does not explain how <code>fmt.Printf()</code> manages to achieve it. If you&#39;re interested in how a Go function might deal with arguments of varying types, you might read up on <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">type switches</a> and <a href=\"https://www.google.com/search?q=golang+reflection\" rel=\"nofollow noreferrer\">reflection</a>. And the fact you did not know at least about the first one suggests you did not read an introductory book on Go; please do!"}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 0, "last_activity_date": 1461400248, "creation_date": 1461400248, "answer_id": 36808495, "question_id": 36808224, "link": "https://stackoverflow.com/questions/36808224/how-can-i-write-a-function-in-golang-which-takes-multiple-types-as-a-parameter/36808495#36808495", "title": "How can I write a function in Golang which takes multiple types as a parameter?", "body": "<p>You could simply use <code>fmt.Sprintf</code> for this:</p>\n\n<pre><code>type foo struct {\n    bar  string\n    more int\n}\n\nfunc main() {\n    s := []string{\"a\", \"b\", \"c\"}\n    fmt.Println(Serialize(s))\n\n    m := map[string]string{\"a\": \"a\", \"b\": \"b\"}\n    fmt.Println(Serialize(m))\n\n    t := foo{\"x\", 7}    \n    fmt.Println(Serialize(t))\n}\n\nfunc Serialize(data interface{}) string {\n    str := fmt.Sprintf(\"%v\", data)\n    return str\n}\n</code></pre>\n\n<p>This will print:</p>\n\n<p><code>[a b c]</code></p>\n\n<p><code>map[b:b a:a]</code></p>\n\n<p><code>{x 7}</code></p>\n\n<p>You can easily trim off the <code>{}</code>, <code>[]</code> and <code>map[]</code> if desired/required with <code>strings.TrimSuffix</code> and <code>strings.TrimPrefix</code></p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 36808495, "answer_count": 1, "score": 0, "last_activity_date": 1461400248, "creation_date": 1461398361, "question_id": 36808224, "link": "https://stackoverflow.com/questions/36808224/how-can-i-write-a-function-in-golang-which-takes-multiple-types-as-a-parameter", "title": "How can I write a function in Golang which takes multiple types as a parameter?", "body": "<p>I am trying to write a function in Golang which will serialize a map and a slice (convert it to a string). I want it to take one parameter but I am unsure of how to make it accept a map and a slice only. I know I can use something like the following function but beyond this point I am confused. I am still trying to wrap my head around interfaces.</p>\n\n<pre><code>func Serialize(data interface{}) string {\n    return \"\"\n}\n</code></pre>\n\n<p>It is preferred if I don't need to create my own struct for it. An explanation of how I could allow this Serialize function to accept maps and structs would be hugely appreciated.</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 1, "creation_date": 1461399325, "post_id": 36808107, "comment_id": 61189885, "body": "Why did you say you presume? Have you seen the output (ie. before passing it to whatever gives the error you&#39;ve quoted)?"}, {"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 0, "creation_date": 1461399369, "post_id": 36808107, "comment_id": 61189897, "body": "And are you using <code>text&#47;template</code> or <code>html&#47;template</code>?"}, {"owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "reply_to_user": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "edited": false, "score": 0, "creation_date": 1461410681, "post_id": 36808107, "comment_id": 61193174, "body": "Yes, I&#39;ve seen the output before passing it, there are no quotations in it.  I&#39;m using text/template"}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "edited": false, "score": 0, "creation_date": 1461457857, "post_id": 36813141, "comment_id": 61208326, "body": "Weird, I must be doing something wrong elsewhere then. I&#39;ll do some more digging. Thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1471854917, "last_edit_date": 1471854917, "creation_date": 1461427510, "answer_id": 36813141, "question_id": 36808107, "link": "https://stackoverflow.com/questions/36808107/go-templates-range-loop-is-quoting-my-value/36813141#36813141", "title": "Go templates range loop is quoting my value", "body": "<p>The <code>{{range}}</code> does not quote anything. If you see <code>\"ID\"</code> in your output, then your input value <em>is</em> <code>\"ID\"</code> with quotation marks included!</p>\n\n<p>See this example:</p>\n\n<pre><code>func main() {\n    m := map[string]interface{}{\n        \"Id\":     \"Id1\",\n        \"Quoted\": `\"Id2\"`,\n        \"Ids\":    []string{\"Id1\", `\"Id2\"`, \"Abc\"},\n    }\n    t := template.Must(template.New(\"\").Parse(src))\n    t.Execute(os.Stdout, m)\n}\n\nconst src = `{{.Id}} {{index .Ids 0}} {{.Quoted}} \n{{range $key, $value := .Ids}}{{$value}}\n{{end}}\n`\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/CPG-cnX7ro\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>Id1 Id1 \"Id2\" \nId1\n\"Id2\"\nAbc\n</code></pre>\n"}], "owner": {"reputation": 1303, "user_id": 779404, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1312959fa177c836dc5ecee589dc487f?s=128&d=identicon&r=PG", "display_name": "b0xxed1n", "link": "https://stackoverflow.com/users/779404/b0xxed1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 777, "favorite_count": 0, "accepted_answer_id": 36813141, "answer_count": 1, "score": 0, "last_activity_date": 1471854917, "creation_date": 1461397548, "last_edit_date": 1461401427, "question_id": 36808107, "link": "https://stackoverflow.com/questions/36808107/go-templates-range-loop-is-quoting-my-value", "title": "Go templates range loop is quoting my value", "body": "<p>I've got a slice of strings (.Table.PKey.Columns) that I'm trying to loop over in my template to generate a go file that does some appends, but when I output $value in my template, apparently Go is quoting it for me, so it is giving me the error: </p>\n\n<pre><code>5:27: expected selector or type assertion, found 'STRING' \"ID\"\n</code></pre>\n\n<p>i.e., instead of the template output looking something like <code>o.ID</code> -- which is what I'm aiming for, it ends up looking something like <code>o.\"ID\"</code> (I presume).</p>\n\n<p>Am I right in my assumption that this is the result of using a range loop? Because it seems when I access variables directly in other places (for example, say I had a string and I did: <code>o.{{.Table.MyString}}</code>) it works fine, but as soon as I try and incorporate a range loop into the mix it seems to be quoting things.</p>\n\n<pre><code>{{- range $key, $value := .Table.PKey.Columns }}\n  args = append(args, o.{{$value}})\n{{ end -}}\n</code></pre>\n\n<p>Any suggestions? Thank you.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 4, "last_activity_date": 1461398451, "creation_date": 1461398451, "answer_id": 36808238, "question_id": 36807948, "link": "https://stackoverflow.com/questions/36807948/golang-switch-got-an-used-as-value-error/36808238#36808238", "title": "golang switch got an ` used as value` error?", "body": "<p>Yes you are right, it is syntax error; it should be SimpleStmt or\nExprSwitchStmt = \"switch\" [ SimpleStmt \";\" ] [ Expression ] \"{\" { ExprCaseClause } \"}\" .<br>\nsee:\n<a href=\"https://golang.org/ref/spec#Switch_statements\" rel=\"nofollow\">https://golang.org/ref/spec#Switch_statements</a><br>\n In an expression switch, the cases contain expressions that are compared against the value of the switch expression. \nAnd this will work:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Test struct {\n    kind int\n}\n\nfunc (s *Test) Kind() int {\n    return s.kind\n}\nfunc main() {\n    f := &amp;Test{12}\n    //fmt.Println(k := f.Kind()) //syntax error: unexpected :=, expecting comma or )\n    switch k := f.Kind(); k {\n    case 12:\n        fmt.Println(k) //12\n    case 0:\n        fmt.Println(\"Bye!\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 411, "user_id": 4737876, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tygIZ.jpg?s=128&g=1", "display_name": "Muge", "link": "https://stackoverflow.com/users/4737876/muge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2616, "favorite_count": 0, "accepted_answer_id": 36808238, "answer_count": 1, "score": 0, "last_activity_date": 1461398451, "creation_date": 1461396290, "question_id": 36807948, "link": "https://stackoverflow.com/questions/36807948/golang-switch-got-an-used-as-value-error", "title": "golang switch got an ` used as value` error?", "body": "<p>I don't know really why <code>switch t := some.(type){}</code> works well, but if I tried  <code>switch k := f.Kind(){}</code> or so on.</p>\n\n<pre><code>.\\mym.go:58: k := f.Kind() used as value\n\nexit status 2\n</code></pre>\n"}, {"tags": ["date", "go", "time", "date-conversion"], "answers": [{"tags": [], "owner": {"reputation": 163028, "user_id": 477878, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qounX.jpg?s=128&g=1", "display_name": "Joachim Isaksson", "link": "https://stackoverflow.com/users/477878/joachim-isaksson"}, "is_accepted": true, "score": 8, "last_activity_date": 1461394900, "creation_date": 1461394900, "answer_id": 36807731, "question_id": 36807596, "link": "https://stackoverflow.com/questions/36807596/how-to-convert-date-format-in-golang/36807731#36807731", "title": "How to convert date format in golang?", "body": "<p>You could use the time package's <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"noreferrer\"><code>Parse</code></a> and <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\"><code>Format</code></a> to convert it to the desired text format. Both take a reference time (2006-01-02 15:04:05) in the format you require as a parameter which makes the format fairly easy to understand.</p>\n\n<pre><code>dtstr1 := \"2010-01-23 11:44:20\"\ndt,_ := time.Parse(\"2006-01-02 15:04:05\", dtstr1)\n\ndtstr2 := dt.Format(\"Jan 2 '06 at 15:04\")\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KlbCQCmaKA\" rel=\"noreferrer\">A playground to test with</a>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1461396598, "creation_date": 1461396598, "answer_id": 36807992, "question_id": 36807596, "link": "https://stackoverflow.com/questions/36807596/how-to-convert-date-format-in-golang/36807992#36807992", "title": "How to convert date format in golang?", "body": "<p>One way is to use the time package's Parse and Format functions,<br>\nor another way is to write your own formatter function like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"time\"\n)\n\n//2010-01-23 11:44:20 to Jan 23 '10 at 11:44\nfunc FormatDateTime(t time.Time) string {\n    var buffer bytes.Buffer\n    buffer.WriteString(t.Month().String()[:3])\n    buffer.WriteString(fmt.Sprintf(\" %2d '%2d at %2d:%2d\", t.Day(), t.Year()%100, t.Hour(), t.Minute()))\n    return buffer.String()\n}\n\nfunc main() {\n    t := time.Now()\n    str := FormatDateTime(t)\n    fmt.Println(str) //Apr 23 '16 at 11:50\n}\n</code></pre>\n"}], "owner": {"reputation": 2144, "user_id": 3103732, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/ddea83f3d0a1cde074665d4c1382c3cc?s=128&d=identicon&r=PG&f=1", "display_name": "Dany", "link": "https://stackoverflow.com/users/3103732/dany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10542, "favorite_count": 0, "accepted_answer_id": 36807731, "answer_count": 2, "score": 3, "last_activity_date": 1461396598, "creation_date": 1461393814, "question_id": 36807596, "link": "https://stackoverflow.com/questions/36807596/how-to-convert-date-format-in-golang", "title": "How to convert date format in golang?", "body": "<p>I would like to convert date format from <code>2010-01-23 11:44:20</code> to <code>Jan 23 '10 at 11:44</code> in golang. I tried few functions from <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow\">time</a> package but couldn't make it. </p>\n\n<p>Could someone help me with this?</p>\n"}, {"tags": ["angularjs", "go"], "answers": [{"tags": [], "owner": {"reputation": 160, "user_id": 5058468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c7c330481869ea1e246205ecda342f2?s=128&d=identicon&r=PG", "display_name": "Gabriel METZGER", "link": "https://stackoverflow.com/users/5058468/gabriel-metzger"}, "is_accepted": false, "score": 0, "last_activity_date": 1461395668, "creation_date": 1461395668, "answer_id": 36807860, "question_id": 36807433, "link": "https://stackoverflow.com/questions/36807433/why-my-image-root-not-found/36807860#36807860", "title": "why my image root not found", "body": "<p>Have you tried with <code>ng-src</code> instead of <code>src</code> ?</p>\n"}, {"comments": [{"owner": {"reputation": 1579, "user_id": 2251689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KFFuV.jpg?s=128&g=1", "display_name": "atefth", "link": "https://stackoverflow.com/users/2251689/atefth"}, "reply_to_user": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "edited": false, "score": 0, "creation_date": 1461397494, "post_id": 36807861, "comment_id": 61189439, "body": "What do you mean @tigerprogrammer ? It is the official angular site.. Anyway accept my answer please"}], "tags": [], "owner": {"reputation": 1579, "user_id": 2251689, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KFFuV.jpg?s=128&g=1", "display_name": "atefth", "link": "https://stackoverflow.com/users/2251689/atefth"}, "is_accepted": false, "score": 0, "last_activity_date": 1461395678, "creation_date": 1461395678, "answer_id": 36807861, "question_id": 36807433, "link": "https://stackoverflow.com/questions/36807433/why-my-image-root-not-found/36807861#36807861", "title": "why my image root not found", "body": "<p>If you use <strong>ng-src</strong> instead of <em>src</em> in your <strong>img</strong> tag, you can resolve this issue.</p>\n\n<blockquote>\n  <p>Using Angular markup like {{hash}} in a src attribute doesn't work\n  right: The browser will fetch from the URL with the literal text\n  {{hash}} until Angular replaces the expression inside {{hash}}. The\n  ngSrc directive solves this problem.</p>\n</blockquote>\n\n<p>Check out the docs <a href=\"https://docs.angularjs.org/api/ng/directive/ngSrc\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 37, "user_id": 5895067, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/432c26e117b9272658291dfab8b09d74?s=128&d=identicon&r=PG&f=1", "display_name": "ADF programmer", "link": "https://stackoverflow.com/users/5895067/adf-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461395678, "creation_date": 1461392568, "question_id": 36807433, "link": "https://stackoverflow.com/questions/36807433/why-my-image-root-not-found", "title": "why my image root not found", "body": "<p>i am using go-lang with angular to build a car view in this approach:\nthis is my main.go</p>\n\n<pre><code>router.GET(\"/shopping\", carBaseController.CarsViewIndex)\nrouter.GET(\"/images\", galleryBaseController.GetImages)\n</code></pre>\n\n<p>in my controller\\cars.go</p>\n\n<pre><code>    func (controller CarController) CarsViewIndex(c *gin.Context) {\n        c.HTML(http.StatusOK, \"carview.html\", gin.H{\n            \"title\": \"Car Page\"})\n    }\n\nfunc (controller GalleryController) GetImages(c *gin.Context)  {\n    imageList := controller.galleryService.FindImages(&amp;bson.M{})\n    c.JSON(http.StatusOK, &amp;imageList)\n    fmt.Println(imageList)\n}\n</code></pre>\n\n<p>in my carview.html</p>\n\n<pre><code>                                    &lt;div class=\"row mix-grid\" ng-init=\"GetAllImages()\" &gt;\n                                    &lt;div class=\"col-md-3 mix photography\" ng-repeat=\"image in allimages\"&gt;\n                                        &lt;div class=\"hover-effect\"  &gt;\n                                            &lt;div class=\"img\" &gt;&lt;img  src=\"imagesT/gallery/Thumb/{{image.imagename}}\" alt=\"\"\n                                                                  class=\"img-responsive\"/&gt;&lt;/div&gt;\n                                            &lt;div class=\"info\"&gt;&lt;h3&gt;Manage Images&lt;/h3&gt;&lt;a href=\"#\"\n                                                                                               class=\"mix-link\"&gt;&lt;i\n                                                    class=\"glyphicon glyphicon-link\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;a\n                                                    href=\"imagesT/gallery/{{image.imagename}}\" data-lightbox=\"image-1\"\n                                                    data-title=\"Image 1\" class=\"mix-zoom\"&gt;&lt;i\n                                                    class=\"glyphicon glyphicon-search\"&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;\n                                        &lt;/div&gt;\n                                        this is the site fo cars\n                                        &lt;a class=\"btn btn-default\" href=\"carinfo\"&gt;Learn More\n                                            &lt;span class=\"glyphicon glyphicon-chevron-right\"&gt;&lt;/span&gt;&lt;/a&gt;\n                                    &lt;/div&gt;\n\n                                &lt;/div&gt;\n</code></pre>\n\n<p>when i  enter <a href=\"http://localhost:3030/shopping\" rel=\"nofollow\">http://localhost:3030/shopping</a> every thing work fine but i found this error</p>\n\n<pre><code>    \"NetworkError: 404 Not Found -\nhttp://localhost:3030/imagesT/gallery/Thumb/%7B%7Bimage.imagename%7D%7D\"\n</code></pre>\n\n<p>i do not know why this error happen while every thing work fine and this what i fount with firbug :</p>\n\n<pre><code>&lt;img class=\"img-responsive\" alt=\"\" src=\"imagesT/gallery/Thumb/2016-chevrolet-cruze-spied-completely-uncovered-news-car-and-driver-photo-658949-s-217x132.jpg\"&gt;\n</code></pre>\n"}, {"tags": ["rest", "go", "struct"], "comments": [{"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 2, "creation_date": 1461394455, "post_id": 36806886, "comment_id": 61188653, "body": "Please run <code>go fmt</code> on your code before posting it here. Especially in Go it is very weird to see code formatted like this."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "edited": false, "score": 0, "creation_date": 1461397664, "post_id": 36808019, "comment_id": 61189484, "body": "So what is the change that you suggest I make? Yes thats right, Im trying to save all values, previously inserted and the new ones as well."}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1461399869, "last_edit_date": 1461399869, "creation_date": 1461396823, "answer_id": 36808019, "question_id": 36806886, "link": "https://stackoverflow.com/questions/36806886/converting-go-map-to-struct/36808019#36808019", "title": "Converting GO map to struct", "body": "<p>MapStructure populates a struct with fields the same name as the keys of the map.  Your example generates zero values ( <code>{Key: 0, Value: \"\"}</code> because there are no keys in the map <code>x</code> with names <code>Key</code> and <code>Value</code>. </p>\n\n<p>Will the following do what you want?</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n    \"strconv\"\n\n    \"github.com/drone/routes\"\n)\n\n// Infos is a slice of Info\nvar Infos = []Info{}\n\n// Info is a Key, Value struct\ntype Info struct {\n    Key   int    `json:\"key\"`\n    Value string `json:\"value\"`\n}\n\nfunc main() {\n    mux := routes.New()\n    mux.Put(\"/:key1/:value1\", PutData)\n\n    mux.Get(\"/profile\", GetProfile)\n    http.Handle(\"/\", mux)\n    http.ListenAndServe(\":3000\", nil)\n}\n\n// PutData puts the new key,values in to Infos\nfunc PutData(w http.ResponseWriter, r *http.Request) {\n\n    keyData := r.URL.Query().Get(\":key1\")\n    valueData := r.URL.Query().Get(\":value1\")\n    key2, err := strconv.Atoi(keyData)\n    if err != nil {\n        panic(err)\n    } else {\n        Infos = append(Infos, Info{\n            Key:   key2,\n            Value: valueData,\n        })\n    }\n\n    w.WriteHeader(204)\n\n}\n\n// GetProfile displays the Infos\nfunc GetProfile(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    for _, p := range Infos {\n\n        outgoingJSON, err := json.MarshalIndent(p, \"\", \"    \")\n        if err != nil {\n            panic(err)\n            break\n        }\n        w.WriteHeader(200)\n        fmt.Fprint(w, string(outgoingJSON))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6243408, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/d60f6a951dcd00ec1da7091a7aa0330c?s=128&d=identicon&r=PG&f=1", "display_name": "RJP", "link": "https://stackoverflow.com/users/6243408/rjp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461423936, "creation_date": 1461388133, "last_edit_date": 1461423936, "question_id": 36806886, "link": "https://stackoverflow.com/questions/36806886/converting-go-map-to-struct", "title": "Converting GO map to struct", "body": "<p>I was wondering if there is anyway to convert a map into a struct in GO. I came across the package called map structure. However, when i run it, my struct is not getting the values for my map.I have posted relevant bits of my code below </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"strconv\"\n\n    \"github.com/drone/routes\"\n    \"github.com/mitchellh/mapstructure\"\n)\n\nvar Infos = []Info{}\n\ntype Info struct {\n    Keyy   int    `json:\"key\"`\n    Valuee string `json:\"value\"`\n}\n\nvar m map[int]string\nvar outgoingJSON string\nvar x map[string]string\n\nfunc main() {\n    m = make(map[int]string)\n    x = make(map[string]string)\n    mux := routes.New()\n    mux.Put(\"/:key1/:value1\", PutData)\n\n    mux.Get(\"/profile\", GetProfile)\n    http.Handle(\"/\", mux)\n    http.ListenAndServe(\":3000\", nil)\n}\nfunc PutData(w http.ResponseWriter, r *http.Request) {\n\n    key_data := r.URL.Query().Get(\":key1\")\n    value_data := r.URL.Query().Get(\":value1\")\n    key2, err := strconv.Atoi(key_data)\n    if err != nil {\n        panic(err)\n    } else {\n        m[key2] = value_data\n    }\n\n    for key2, value_data := range m {\n        log.Println(key2, value_data)\n        log.Println(m)\n        x[strconv.FormatInt(int64(key2), 10)] = value_data\n        log.Println(x)\n        var result Info\n        err1 := mapstructure.Decode(x, &amp;result)\n        if err1 != nil {\n            panic(err1)\n        }\n        Infos = append(Infos, result)\n        //log.Println(key2,value_data)\n        //  outgoingJSON, err := json.MarshalIndent(x,\"\",\"    \")\n        //  if err != nil {\n        //  panic(err)\n        //    break\n        //  }\n\n    }\n    w.WriteHeader(204)\n\n    //log.Println(key_data)\n}\nfunc GetProfile(w http.ResponseWriter, r *http.Request) {\n    w.Header().Set(\"Content-Type\", \"application/json\")\n\n    for _, p := range Infos {\n\n        outgoingJSON, err := json.MarshalIndent(p, \"\", \"    \")\n        if err != nil {\n            panic(err)\n            break\n        }\n        w.WriteHeader(200)\n        fmt.Fprint(w, string(outgoingJSON))\n    }\n}\n</code></pre>\n\n<p>I have create a map[int]string first, converted it into map[string]string and then converted it into my struct. Please help. My struct returns 0 as key and null string as value.</p>\n\n<p>Output:</p>\n\n<pre><code>{\n    \"key\": \"\",\n    \"value\": \"\"\n}{\n    \"key\": \"\",\n    \"value\": \"\"\n</code></pre>\n"}, {"tags": ["go", "command-line"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1461381645, "creation_date": 1461381645, "answer_id": 36806268, "question_id": 36806262, "link": "https://stackoverflow.com/questions/36806262/golang-command-line-argument-with-charecter/36806268#36806268", "title": "Golang :command line argument with -&gt; charecter", "body": "<p>Your shell is interpreting the <code>&gt;</code> as IO <a href=\"https://en.wikipedia.org/wiki/Redirection_(computing)\" rel=\"nofollow\">redirection</a>.  The shell opened the file <code>A</code> as standard output for the command and passed the argument <code>1-</code> to the command.</p>\n\n<p>Quote the argument to avoid this:</p>\n\n<pre><code>go run app.go \"1-&gt;A\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6125569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d8d299dcd3483320274084c5158ca0?s=128&d=identicon&r=PG&f=1", "display_name": "piper_chapman", "link": "https://stackoverflow.com/users/6125569/piper-chapman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 36806268, "answer_count": 1, "score": 0, "last_activity_date": 1470223447, "creation_date": 1461381558, "last_edit_date": 1470223447, "question_id": 36806262, "link": "https://stackoverflow.com/questions/36806262/golang-command-line-argument-with-charecter", "title": "Golang :command line argument with -&gt; charecter", "body": "<p>I need to accept command line argument to run a Go program in the below format:</p>\n\n<pre><code> go run app.go 1-&gt;A\n</code></pre>\n\n<p>I am using <code>os.Args[1]</code>. But it only accepts till '1-' . '>A' is being skipped.</p>\n\n<p>Any help to resolve this issue is highly appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "beego", "go-html-template"], "comments": [{"owner": {"reputation": 2543, "user_id": 1489249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/36c25752e58738efaf922255c05e24cb?s=128&d=identicon&r=PG", "display_name": "chespinoza", "link": "https://stackoverflow.com/users/1489249/chespinoza"}, "edited": false, "score": 0, "creation_date": 1461381686, "post_id": 36806042, "comment_id": 61186158, "body": "You are getting the pointer addresses, what about if you change log.Printf(&quot;Your note title is %s&quot; , &amp;n.Title) for this -&gt; log.Printf(&quot;Your note title is %s&quot; , n.Title)"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 2543, "user_id": 1489249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/36c25752e58738efaf922255c05e24cb?s=128&d=identicon&r=PG", "display_name": "chespinoza", "link": "https://stackoverflow.com/users/1489249/chespinoza"}, "edited": false, "score": 0, "creation_date": 1461425002, "post_id": 36806042, "comment_id": 61198093, "body": "Then I get things like <code>Your note title is 0xc820267d18</code>"}, {"owner": {"reputation": 2543, "user_id": 1489249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/36c25752e58738efaf922255c05e24cb?s=128&d=identicon&r=PG", "display_name": "chespinoza", "link": "https://stackoverflow.com/users/1489249/chespinoza"}, "edited": false, "score": 0, "creation_date": 1461426007, "post_id": 36806042, "comment_id": 61198461, "body": "But, checking the documentation the way to define the struct (in your case Note) is as a struct type not as a pointer (&amp;) to that struct, then in your code you should be n:=Note{}"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 2543, "user_id": 1489249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/36c25752e58738efaf922255c05e24cb?s=128&d=identicon&r=PG", "display_name": "chespinoza", "link": "https://stackoverflow.com/users/1489249/chespinoza"}, "edited": false, "score": 1, "creation_date": 1461426348, "post_id": 36806042, "comment_id": 61198582, "body": "You are right. please answer and I&#39;ll accept. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 2543, "user_id": 1489249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/36c25752e58738efaf922255c05e24cb?s=128&d=identicon&r=PG", "display_name": "chespinoza", "link": "https://stackoverflow.com/users/1489249/chespinoza"}, "is_accepted": true, "score": 2, "last_activity_date": 1461426631, "creation_date": 1461426631, "answer_id": 36812966, "question_id": 36806042, "link": "https://stackoverflow.com/questions/36806042/cannot-parse-posted-form-data-from-beego/36812966#36812966", "title": "Cannot parse posted form data from beego", "body": "<p>From the documentation, the way to define the receiver struct should be using a struct type, not a pointer to that struct:</p>\n\n<pre><code>func (this *MainController) Post() {\n    u := User{}\n    if err := this.ParseForm(&amp;u); err != nil {\n        //handle error\n    }\n}\n</code></pre>\n\n<p>Then, in your controller, the things should be better if you.. </p>\n\n<pre><code>func (this *HelloController) Post() {\n    n := Note{}\n    ...\n }\n</code></pre>\n\n<p>More info about pointers in go: <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow\">https://tour.golang.org/moretypes/1</a></p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1030, "favorite_count": 0, "accepted_answer_id": 36812966, "answer_count": 1, "score": 0, "last_activity_date": 1461426631, "creation_date": 1461379257, "question_id": 36806042, "link": "https://stackoverflow.com/questions/36806042/cannot-parse-posted-form-data-from-beego", "title": "Cannot parse posted form data from beego", "body": "<p>I'm new to go and experiencing beego. </p>\n\n<p>I'm trying to get the posted form data from:</p>\n\n<pre><code> &lt;form  action=\"/hello\" method=\"post\"&gt;\n    {{.xsrfdata}}\n    Title\uff1a&lt;input name=\"title\" type=\"text\" /&gt;&lt;br&gt;\n    Body\uff1a&lt;input name=\"body\" type=\"text\" /&gt;&lt;br&gt;    \n    &lt;input type=\"submit\" value=\"submit\" /&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>To the controller:</p>\n\n<pre><code>type HelloController struct {\n    beego.Controller\n}\n\n\ntype Note struct {\n    Id    int        `form:\"-\"`\n    Title  string `form:\"title\"` \n    Body   string `form:\"body\"`            \n}\n\nfunc (this *HelloController) Get() {\n    this.Data[\"xsrfdata\"]= template.HTML(this.XSRFFormHTML())\n    this.TplName = \"hello.tpl\"\n}\n\nfunc (this *HelloController) Post() {\n    n := &amp;Note{}\n    if err := this.ParseForm(&amp;n); err != nil {    \n            s := err.Error()\n           log.Printf(\"type: %T; value: %q\\n\", s, s)             \n    }\n\n    log.Printf(\"Your note title is %s\" , &amp;n.Title)\n    log.Printf(\"Your note body is %s\" , &amp;n.Body)\n    this.Ctx.Redirect(302, \"/\")    \n}\n</code></pre>\n\n<p>But instead of the string values entered into field I get :</p>\n\n<pre><code>Your note title is %!s(*string=0xc82027a368)\nYour note body is %!s(*string=0xc82027a378)\n</code></pre>\n\n<p>I followed <a href=\"http://beego.me/docs/mvc/controller/params.md\" rel=\"nofollow\">the docs</a> on request processing, but left clueless why can not the posted strings. </p>\n"}, {"tags": ["url", "go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 4, "creation_date": 1461374049, "post_id": 36805476, "comment_id": 61184709, "body": "Potentially useful: <a href=\"http://stackoverflow.com/q/16784419/142162\">In golang, how to determine the final URL after a series of redirects?</a>"}, {"owner": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1461374126, "post_id": 36805476, "comment_id": 61184720, "body": "Thanks for the link, exactly what I was looking for"}], "owner": {"reputation": 3262, "user_id": 1900537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/I7rTU.jpg?s=128&g=1", "display_name": "romants", "link": "https://stackoverflow.com/users/1900537/romants"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1461376765, "answer_count": 0, "score": 0, "last_activity_date": 1461373876, "creation_date": 1461373876, "question_id": 36805476, "link": "https://stackoverflow.com/questions/36805476/is-there-a-way-to-expand-shortened-urls-in-go", "closed_reason": "Duplicate", "title": "Is there a way to expand shortened URLs in Go", "body": "<p>I am writing a program that keeps track of different URLs and collects certain statistics about them. I have encountered many \"shortened\" URLs, and I was wondering if there is a way (or a package) in Go to expand shortened URLs?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "edited": false, "score": 0, "creation_date": 1461365349, "post_id": 36804423, "comment_id": 61182775, "body": "Check this out <a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#interface_conversions</a>"}, {"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1461365419, "post_id": 36804423, "comment_id": 61182795, "body": "it&#39;s a handy way to get at the concrete type which implements the interface. it&#39;s type assertion. the interface{} can accept any type, in this case if that type is []byte then it will be assigned to &#39;bytes&#39; and &#39;ok&#39; will indicate that it was that type, i.e. ok is a bool. check this out <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Type_assertions</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "is_accepted": true, "score": 4, "last_activity_date": 1464740538, "last_edit_date": 1464740538, "creation_date": 1461366203, "answer_id": 36804593, "question_id": 36804423, "link": "https://stackoverflow.com/questions/36804423/what-is-this-doing-in-go-looks-like-a-cast/36804593#36804593", "title": "What is this doing in Go, looks like a cast", "body": "<p>We refer to this as \"type assertion.\"</p>\n\n<p>This is perfectly documented in the <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">Language Spec</a>. In order to have the whole answer here on SO (since it is the whole answer) and not a link-only answer, I will include it the most relevant information from the spec. This is documentation, not my answer...</p>\n\n<blockquote>\n  <p>For an expression x of interface type and a type T, the primary\n  expression</p>\n\n<pre><code>x.(T)\n</code></pre>\n  \n  <p>asserts that x is not nil and that the value stored in x is of\n  type T. The notation x.(T) is called a type assertion.</p>\n  \n  <p>More precisely, if T is not an interface type, x.(T) asserts that the\n  dynamic type of x is identical to the type T. In this case, T must\n  implement the (interface) type of x; otherwise the type assertion is\n  invalid since it is not possible for x to store a value of type T. If\n  T is an interface type, x.(T) asserts that the dynamic type of x\n  implements the interface T.</p>\n  \n  <p>If the type assertion holds, the value of the expression is the value\n  stored in x and its type is T. If the type assertion is false, a\n  run-time panic occurs. In other words, even though the dynamic type of\n  x is known only at run time, the type of x.(T) is known to be T in a\n  correct program.</p>\n\n<pre><code>var x interface{} = 7  // x has dynamic type int and value 7 \ni := x.(int)           // i has type int and value 7\n\ntype I interface { m() }\nvar y I\ns := y.(string)        // illegal: string does not implement I (missing method m) \nr := y.(io.Reader)     // r has type io.Reader and y must implement both I and io.Reader \n</code></pre>\n  \n  <p>A type assertion used in an assignment or initialization of the special\n  form</p>\n\n<pre><code>v, ok = x.(T) \nv, ok := x.(T)\nvar v, ok = x.(T) \n</code></pre>\n  \n  <p>yields an additional\n  untyped boolean value. The value of ok is true if the assertion holds.\n  Otherwise it is false and the value of v is the zero value for type T.\n  No run-time panic occurs in this case.</p>\n</blockquote>\n\n<p>Effective Go is another great resource, which also includes a section on Interface conversions and type assertions:\n<a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#interface_conversions</a></p>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "closed_date": 1461377638, "accepted_answer_id": 36804593, "answer_count": 1, "score": -2, "last_activity_date": 1464740538, "creation_date": 1461365079, "question_id": 36804423, "link": "https://stackoverflow.com/questions/36804423/what-is-this-doing-in-go-looks-like-a-cast", "closed_reason": "Duplicate", "title": "What is this doing in Go, looks like a cast", "body": "<p>Can someone explain what the following syntax means in Go, specifially:</p>\n\n<pre><code>x.([]byte)\n</code></pre>\n\n<p><strong>I am not sure what this means, is this a cast?  But for what method since it is just after a dot?</strong></p>\n\n<pre><code>func of(x interface{}) ByteView {\n    if bytes, ok := x.([]byte); ok {\n        return ByteView{b: bytes}\n    }\n    return ByteView{s: x.(string)}\n}\n</code></pre>\n\n<p>Reference: <a href=\"https://github.com/golang/groupcache/blob/master/byteview_test.go#L55\" rel=\"nofollow\">https://github.com/golang/groupcache/blob/master/byteview_test.go#L55</a></p>\n"}, {"tags": ["string", "go", "type-conversion", "character"], "comments": [{"owner": {"reputation": 2580, "user_id": 1233197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cue35.jpg?s=128&g=1", "display_name": "Mike B", "link": "https://stackoverflow.com/users/1233197/mike-b"}, "edited": false, "score": 0, "creation_date": 1461363340, "post_id": 36803999, "comment_id": 61182138, "body": "two options - create an array of all the letters and get it&#39;s index+1 from an array. Second - use ascii table and subtract needed number."}], "answers": [{"comments": [{"owner": {"reputation": 3749, "user_id": 845248, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/43fbc7dec381c9b652d33edbb3ec0850?s=128&d=identicon&r=PG", "display_name": "afreeland", "link": "https://stackoverflow.com/users/845248/afreeland"}, "edited": false, "score": 1, "creation_date": 1530017790, "post_id": 36804185, "comment_id": 89077904, "body": "Might be a dumb question but how did you know that you could add a number to a constant character ( &quot;A&quot; ) to navigate the characters?  Is this something in most languages, go specific, or rune specific?  Never messed with rune() before..."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3749, "user_id": 845248, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/43fbc7dec381c9b652d33edbb3ec0850?s=128&d=identicon&r=PG", "display_name": "afreeland", "link": "https://stackoverflow.com/users/845248/afreeland"}, "edited": false, "score": 1, "creation_date": 1530020516, "post_id": 36804185, "comment_id": 89079794, "body": "@afreeland <code>rune</code> in Go is an alias for <code>int32</code>. If you have a constant like <code>&#39;A&#39;</code>, that is equivalent to a value <code>65</code>. The types <code>rune</code> and <code>int32</code> are one and the same, completely interchangable. So when you write <code>&#39;A&#39; + 1</code>, it&#39;s the same as if you&#39;d write <code>65 + 1</code>."}, {"owner": {"reputation": 3749, "user_id": 845248, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/43fbc7dec381c9b652d33edbb3ec0850?s=128&d=identicon&r=PG", "display_name": "afreeland", "link": "https://stackoverflow.com/users/845248/afreeland"}, "edited": false, "score": 0, "creation_date": 1530021797, "post_id": 36804185, "comment_id": 89080757, "body": "Awesome, thanks for breaking it down a little further for me...I feel much better now =)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 24, "last_activity_date": 1475355001, "last_edit_date": 1475355001, "creation_date": 1461363694, "answer_id": 36804185, "question_id": 36803999, "link": "https://stackoverflow.com/questions/36803999/golang-alphabetic-representation-of-a-number/36804185#36804185", "title": "Golang Alphabetic representation of a number", "body": "<p>For simplicity range check is omitted from below solutions.<br>\nThey all can be tried on the <a href=\"http://play.golang.org/p/dzO0kdJWJW\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<h3>Number -> <code>rune</code></h3>\n\n<p>Simply add the number to the const <code>'A' - 1</code> so adding <code>1</code> to this you get <code>'A'</code>, adding <code>2</code> you get <code>'B'</code> etc.:</p>\n\n<pre><code>func toChar(i int) rune {\n    return rune('A' - 1 + i)\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>for _, i := range []int{1, 2, 23, 26} {\n    fmt.Printf(\"%d %q\\n\", i, toChar(i))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 'A'\n2 'B'\n23 'W'\n26 'Z'\n</code></pre>\n\n<h3>Number -> <code>string</code></h3>\n\n<p>Or if you want it as a <code>string</code>:</p>\n\n<pre><code>func toCharStr(i int) string {\n    return string('A' - 1 + i)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 \"A\"\n2 \"B\"\n23 \"W\"\n26 \"Z\"\n</code></pre>\n\n<p>This last one (converting a number to <code>string</code>) is documented in the <a href=\"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type\" rel=\"noreferrer\">Spec: Conversions to and from a string type</a>:</p>\n\n<blockquote>\n  <p>Converting a signed or unsigned integer value to a string type yields a string containing the UTF-8 representation of the integer.</p>\n</blockquote>\n\n<h3>Number -> <code>string</code> (cached)</h3>\n\n<p>If you need to do this a lot of times, it is profitable to store the <code>strings</code> in an array for example, and just return the <code>string</code> from that:</p>\n\n<pre><code>var arr = [...]string{\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\",\n    \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\"}\n\nfunc toCharStrArr(i int) string {\n    return arr[i-1]\n}\n</code></pre>\n\n<p>Note: a slice (instead of the array) would also be fine.</p>\n\n<p>Note #2: you may improve this if you add a dummy first character so you don't have to subtract <code>1</code> from <code>i</code>:</p>\n\n<pre><code>var arr = [...]string{\".\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\",\n    \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\"}\n\nfunc toCharStrArr(i int) string { return arr[i] }\n</code></pre>\n\n<h3>Number -> <code>string</code> (slicing a <code>string</code> constant)</h3>\n\n<p>Also another interesting solution:</p>\n\n<pre><code>const abc = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n\nfunc toCharStrConst(i int) string {\n    return abc[i-1 : i]\n}\n</code></pre>\n\n<p>Slicing a <code>string</code> is efficient: the new <code>string</code> will share the backing array (it can be done because <code>string</code>s are immutable).</p>\n"}, {"tags": [], "owner": {"reputation": 1710, "user_id": 3590237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EsWLO.jpg?s=128&g=1", "display_name": "Aravinda Meewalaarachchi", "link": "https://stackoverflow.com/users/3590237/aravinda-meewalaarachchi"}, "is_accepted": false, "score": 2, "last_activity_date": 1586155127, "last_edit_date": 1586155127, "creation_date": 1521387346, "answer_id": 49349736, "question_id": 36803999, "link": "https://stackoverflow.com/questions/36803999/golang-alphabetic-representation-of-a-number/49349736#49349736", "title": "Golang Alphabetic representation of a number", "body": "<p>The simplest solution would be </p>\n\n<pre><code>func stringValueOf(i int) string {\n   var foo = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n   return string(foo[i-1])\n}\n</code></pre>\n\n<p>Hope this will help you to solve your problem. Happy Coding!!</p>\n"}, {"tags": [], "owner": {"reputation": 48, "user_id": 8367985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e59e2773eb0b5b979e04bf23357d9541?s=128&d=identicon&r=PG&f=1", "display_name": "arturwwl", "link": "https://stackoverflow.com/users/8367985/arturwwl"}, "is_accepted": false, "score": 0, "last_activity_date": 1613134823, "last_edit_date": 1613134823, "creation_date": 1613134503, "answer_id": 66172278, "question_id": 36803999, "link": "https://stackoverflow.com/questions/36803999/golang-alphabetic-representation-of-a-number/66172278#66172278", "title": "Golang Alphabetic representation of a number", "body": "<p>If you need not a rune, but a string and also more than one character for e.g. excel column</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;fmt&quot;\n)\n\nfunc IntToLetters(number int32) (letters string){\n    number--\n    if firstLetter := number/26; firstLetter &gt;0{\n        letters += IntToLetters(firstLetter)\n        letters += string('A' + number%26)\n    } else {\n        letters += string('A' + number)\n    }\n        \n    return \n}\n\nfunc main() {\n    fmt.Println(IntToLetters(1))// print A\n    fmt.Println(IntToLetters(26))// print Z\n    fmt.Println(IntToLetters(27))// print AA\n    fmt.Println(IntToLetters(1999))// print BXW\n}\n\n</code></pre>\n<p>preview here: <a href=\"https://play.golang.org/p/GAWebM_QCKi\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GAWebM_QCKi</a></p>\n"}], "owner": {"reputation": 259, "user_id": 6232007, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3241e0eedf4475d6e31b29497c1af8ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pete", "link": "https://stackoverflow.com/users/6232007/pete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12645, "favorite_count": 2, "accepted_answer_id": 36804185, "answer_count": 3, "score": 9, "last_activity_date": 1613134823, "creation_date": 1461362616, "last_edit_date": 1461365584, "question_id": 36803999, "link": "https://stackoverflow.com/questions/36803999/golang-alphabetic-representation-of-a-number", "title": "Golang Alphabetic representation of a number", "body": "<p>Is there an easy way to convert a number to a letter?</p>\n\n<p>For example,<br>\n <code>3</code> => <code>\"C\"</code> and <code>23</code> => <code>\"W\"</code>?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461359105, "post_id": 36803268, "comment_id": 61180538, "body": "There is no way to interrupt reading stdin without entering a value. You need to either leave the read pending and ignore it, or don&#39;t start a new read once you have what you want."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6242560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc4fa951a80c6ca9e6713de6f5fdbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Singh", "link": "https://stackoverflow.com/users/6242560/robin-singh"}, "edited": false, "score": 0, "creation_date": 1461361649, "post_id": 36803552, "comment_id": 61181540, "body": "not sure how this would look in code. It&#39;s still my first day on Go."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1461360292, "creation_date": 1461360292, "answer_id": 36803552, "question_id": 36803268, "link": "https://stackoverflow.com/questions/36803268/how-can-i-exit-reader-readstring-from-waiting-for-user-input/36803552#36803552", "title": "How can I exit reader.ReadString from waiting for user input?", "body": "<p>The only decent mechanism that Go gives you to proceed when <em>either</em> of two things happens is <code>select</code>, and <code>select</code> only selects on channel reads, so your only option is to change your signal-handler goroutine to write to a channel, and add another goroutine that handles stdin and passes lines of input to a channel, then select on the two channels.</p>\n\n<p>However, that still leaves your question half-unanswered: your main program can stop waiting for input on a Ctrl-C, but the goroutine that's reading input will still be waiting for input. In some cases that might be okay... if you will never need stdin again, or if you will go right back to processing lines in the same exact way. But if you want to do something <em>other</em> than <code>ReadString</code> from that reader, you're stuck... literally. The only solution I see would be to write your own state machine around <code>Read</code> or <code>ReadByte</code> that is capable of changing its behavior in response to external conditions, but that can easily get horribly complicated.</p>\n\n<p>Basically, this looks like a case where Go simplifies things compared to the underlying system (not exposing anything like <code>EINTR</code>, not allowing select on filehandles), but ends up providing less power to the programmer.</p>\n"}], "owner": {"reputation": 31, "user_id": 6242560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efc4fa951a80c6ca9e6713de6f5fdbd0?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Singh", "link": "https://stackoverflow.com/users/6242560/robin-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 332, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1461360292, "creation_date": 1461359032, "question_id": 36803268, "link": "https://stackoverflow.com/questions/36803268/how-can-i-exit-reader-readstring-from-waiting-for-user-input", "title": "How can I exit reader.ReadString from waiting for user input?", "body": "<p>I am making it so that it stops asking for input upon CTRL-C.</p>\n\n<p>What I have currently is that a separate go-routine, upon receiving a CTRL-C, changes the value of a variable so it won't ask for another line. However, I can't seem to find a way around the current line.</p>\n\n<p>i.e. I still have to press enter once, to get out of the current iteration of reading for \\n. </p>\n\n<p>Is there perhaps a way to push a \"\\n\" into stdin for the reader.ReadString to read. Or a way to stop its execution altogether.</p>\n"}, {"tags": ["go", "httphandler"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1461356971, "post_id": 36802714, "comment_id": 61179604, "body": "You should include a minimal example that would reproduce the problem. I use Go on Windows 10 and didn&#39;t find anything special about how Go or any other language works on it. I could understand if it happend after days of uptime but 3 minutes is just too little to do anything"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461357085, "post_id": 36802714, "comment_id": 61179647, "body": "Please show the code in question. A full stack trace from the application would be very useful as well (use <code>GOTRACEBACK=all</code> if you generate the stack via a panic)"}, {"owner": {"reputation": 155, "user_id": 2048713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561e3a9aaad516ea652edd59ae2b55e?s=128&d=identicon&r=PG", "display_name": "jcasado94", "link": "https://stackoverflow.com/users/2048713/jcasado94"}, "edited": false, "score": 0, "creation_date": 1461357572, "post_id": 36802714, "comment_id": 61179862, "body": "Edited. I call GOMAXPROCS just to make sure it uses all that&#39;s available."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1461357634, "post_id": 36802714, "comment_id": 61179892, "body": "There is no need to start 10000000 OS threads. Please set GOMAXPROCS to a reasonable value or use the default which is equal to the number of cores on the machine."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461357699, "post_id": 36802714, "comment_id": 61179917, "body": "@jcasado94, but it actually will not use anything. <code>GOMAXPROCS</code> is not allocating anything, it&#39;s more like an upper bound. Go will allocate threads as it needs them. If it only needs 1 thread then that&#39;s what it will allocate even if your <code>GOMAXPROCS</code> is 10000000"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1461359224, "post_id": 36802714, "comment_id": 61180584, "body": "Couldn&#39;t reproduce the problem with this <a href=\"https://play.golang.org/p/YCrvKYFVTV\" rel=\"nofollow noreferrer\">play.golang.org/p/YCrvKYFVTV</a> Let it run for about 10 minutes before sending a request, didn&#39;t even touch the PC the whole time."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1461359554, "post_id": 36802714, "comment_id": 61180739, "body": "What you&#39;ve shown here isn&#39;t the problem, but we have no idea what is behind the <code>common.*</code> calls. A stacktrace showing where things are blocks will help."}, {"owner": {"reputation": 155, "user_id": 2048713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561e3a9aaad516ea652edd59ae2b55e?s=128&d=identicon&r=PG", "display_name": "jcasado94", "link": "https://stackoverflow.com/users/2048713/jcasado94"}, "edited": false, "score": 0, "creation_date": 1461362581, "post_id": 36802714, "comment_id": 61181877, "body": "It&#39;s hard to catch the problem, so please understand if I&#39;m slow with posting the stacktrace. Thanks."}, {"owner": {"reputation": 155, "user_id": 2048713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561e3a9aaad516ea652edd59ae2b55e?s=128&d=identicon&r=PG", "display_name": "jcasado94", "link": "https://stackoverflow.com/users/2048713/jcasado94"}, "edited": false, "score": 0, "creation_date": 1461571077, "post_id": 36802714, "comment_id": 61240376, "body": "I just realised it&#39;s not a problem only from the named binary. I am running a random query generator for my server, and it got stucked the same way. It&#39;s not doing complicated stuff, just creating queries and printing the responses. Looking at the behavior it had, it could&#39;ve got stucked before the CTRL+C either at a <code>body, _ := ioutil.ReadAll(resp.Body)</code> or at a <code>fmt.Println(string(body))</code>..."}, {"owner": {"reputation": 155, "user_id": 2048713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561e3a9aaad516ea652edd59ae2b55e?s=128&d=identicon&r=PG", "display_name": "jcasado94", "link": "https://stackoverflow.com/users/2048713/jcasado94"}, "edited": false, "score": 0, "creation_date": 1461783260, "post_id": 36802714, "comment_id": 61361161, "body": "Added the stack trace. Sorry for the delay, been busy these days."}], "owner": {"reputation": 155, "user_id": 2048713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5561e3a9aaad516ea652edd59ae2b55e?s=128&d=identicon&r=PG", "display_name": "jcasado94", "link": "https://stackoverflow.com/users/2048713/jcasado94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494473591, "creation_date": 1461356598, "last_edit_date": 1461783218, "question_id": 36802714, "link": "https://stackoverflow.com/questions/36802714/golang-stucked-until-i-press-ctrlc-windows-10", "title": "Golang stucked until I press CTRL+C (Windows 10)", "body": "<p>I've got a server-like program in Windows 10 where the main program waits for the requests with http.Handle(dst, handlerStruct), and for every query does the corresponding operations and returns a result or just prints something through the screen.</p>\n\n<p>It usually works fine, but sometimes, and just sometimes, when I leave the program running \"waiting\" for requests to come in for a long time (3 minutes up) and then I send a request, it just gets \"stucked\" until I press CTRL+C, and then it returns the values inmediately. So it looks like the program runs well, but the returning thread is having a break or something when I leave it a long time without requests. </p>\n\n<p>This happens ever since I started developing the program, and not only when using functions with goroutines.</p>\n\n<p>For me it looks like it has more to do with Windows 10 than with Golang itself, but it's just very annoying, and of course I don't want this to happen with my server...</p>\n\n<p>Hope you can see what's going wrong here...</p>\n\n<p>Thanks.</p>\n\n<hr>\n\n<p>EDIT</p>\n\n<p>This is the main program waiting for the requests:</p>\n\n<pre><code>func main() {\n\n    runtime.GOMAXPROCS(10000000)\n\n    http.Handle(\"/sameDayCombinations\", CBR.SameDayCombinationsHandler{})\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Now this is the code of ServeHTTP for the handler:</p>\n\n<pre><code>func (h SameDayCombinationsHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n\n    t1 := time.Now()\n\n    q := common.DecodeRequest(r)\n    json := common.EncodeAnswer((&amp;h).RetrieveSpecificSolutions(q.Year, q.Month, q.Day, q.DepID, q.ArrID, q.Adults, q.Children, q.Infants), true)\n    fmt.Fprintf(w, json)\n\n    t2 := time.Now()\n    fmt.Println(t2.Sub(t1))\n}\n</code></pre>\n\n<hr>\n\n<p>EDIT2</p>\n\n<p>Here I add the stack of a program execution after the appearance of this weird behavior. So, after doing CTRL+C I got this; looks pretty normal to me.</p>\n\n<p><a href=\"http://pastebin.com/DduvtNZr\" rel=\"nofollow\">http://pastebin.com/DduvtNZr</a></p>\n\n<p>Though, now, by empirical demonstration, I'm sure it has to do with the console Prints (probably large prints?). That's a good new, cause it'll only happen while debugging, but stills a weird behavior...</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1461356562, "post_id": 36802591, "comment_id": 61179391, "body": "You have an extra space in your json tags: <code>json:&quot;first_name&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 308, "user_id": 3134049, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6J1Ml.jpg?s=128&g=1", "display_name": "ahaltindis", "link": "https://stackoverflow.com/users/3134049/ahaltindis"}, "is_accepted": true, "score": 2, "last_activity_date": 1461361273, "creation_date": 1461361273, "answer_id": 36803739, "question_id": 36802591, "link": "https://stackoverflow.com/questions/36802591/why-am-i-not-able-to-decode-this-json-with-golang-it-always-prints-an-empty-str/36803739#36803739", "title": "Why am I not able to decode this JSON with golang? It always prints an empty string", "body": "<p>Your code is searching <code>FirstName</code> and <code>LastName</code> keys in your json. If you want struct tags take effect, you need to remove space between colon and quote. <code>json:\"first_name\"</code></p>\n\n<p><a href=\"https://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow\">https://golang.org/pkg/reflect/#StructTag</a></p>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 36803739, "answer_count": 1, "score": 0, "last_activity_date": 1461361273, "creation_date": 1461356094, "question_id": 36802591, "link": "https://stackoverflow.com/questions/36802591/why-am-i-not-able-to-decode-this-json-with-golang-it-always-prints-an-empty-str", "title": "Why am I not able to decode this JSON with golang? It always prints an empty string", "body": "<p>I have a JSON file on my server that is very simple, just </p>\n\n<pre><code>{\n    \"first_name\": \"John\",\n    \"last_name\": \"Doe\"\n}\n</code></pre>\n\n<p>I then wrote a golang script to print out the first name:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"encoding/json\"\n)       \n\ntype Person struct {\n    FirstName string `json: \"first_name\"`\n    LastName string `json: \"last_name\"`\n}\n\nfunc main() {\n    url := \"http://myserver.com/test.json\"\n\n    res, err := http.Get(url)\n\n    if err != nil {\n        fmt.Printf(\"%s\", err)\n    }\n\n    defer res.Body.Close()\n\n    var person Person\n    dec := json.NewDecoder(res.Body).Decode(&amp;person)\n\n    if dec != nil {\n        fmt.Printf(\"%s\", dec)\n    }\n\n    fmt.Println(person.FirstName)\n}\n</code></pre>\n\n<p>But if I type <code>go run test.go</code> it always just prints a newline character seemingly.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["http", "google-app-engine", "go", "tar"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1461354235, "post_id": 36800168, "comment_id": 61178281, "body": "Related: <a href=\"http://stackoverflow.com/questions/36717098/correct-way-to-read-file-in-go-appengine\">Correct way to read file in Go AppEngine</a>. There are certain rules how you can access a file, and also files/folders marked as static are unavailable by default. Read the linked question+answer."}], "answers": [{"comments": [{"owner": {"reputation": 168, "user_id": 3896932, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d8379ff9ef6e97233006b64f8b28235?s=128&d=identicon&r=PG&f=1", "display_name": "smolloy", "link": "https://stackoverflow.com/users/3896932/smolloy"}, "edited": false, "score": 0, "creation_date": 1461494117, "post_id": 36800607, "comment_id": 61215526, "body": "Thanks.  The paths in the tarit function needed to be relative, as you said.  I also added <code>application_readable: true</code> to the app.yaml as suggested by @icza."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1461350383, "last_edit_date": 1461350383, "creation_date": 1461348402, "answer_id": 36800607, "question_id": 36800168, "link": "https://stackoverflow.com/questions/36800168/creating-a-tar-file-to-be-served-via-google-app-engine/36800607#36800607", "title": "Creating a tar file to be served via Google App Engine", "body": "<p>Specify directories using paths relative to the directory containing app.yaml. The path in the posted code is the absolute path \"/files\".  Perhaps you should change it to \"files\".</p>\n\n<p>Log the errors returned from os.Stat and filepath.Walk.  The errors will probably lead you to the problem.</p>\n"}], "owner": {"reputation": 168, "user_id": 3896932, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d8379ff9ef6e97233006b64f8b28235?s=128&d=identicon&r=PG&f=1", "display_name": "smolloy", "link": "https://stackoverflow.com/users/3896932/smolloy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 36800607, "answer_count": 1, "score": 0, "last_activity_date": 1461350383, "creation_date": 1461346871, "question_id": 36800168, "link": "https://stackoverflow.com/questions/36800168/creating-a-tar-file-to-be-served-via-google-app-engine", "title": "Creating a tar file to be served via Google App Engine", "body": "<p>I'm writing an application for Google AppEngine using Go, and need to tar together a bunch of files to serve to the user when they navigate to a particular URL.  At the moment the files are static, and so I could solve this problem by tarring them before upload to the server.  In the future I would like to dynamically alter them before tarring, and so would like to learn how to tar &amp; serve the static files on request.</p>\n\n<p>In my init() function I have the following line:</p>\n\n<pre><code>http.HandleFunc(\"/download.tar\", tarit)\n</code></pre>\n\n<p>The function tarit is the one I am having a problem with, and it currently looks like the following:</p>\n\n<pre><code>func tarit(w http.ResponseWriter, r *http.Request) {\n    tarball := tar.NewWriter(w)\n    defer tarball.Close()\n\n    info, err := os.Stat(\"/files\")\n    if err != nil {\n        return\n    }\n\n    var baseDir string\n    if info.IsDir() {\n        baseDir = filepath.Base(\"/files\")\n    }\n\n    filepath.Walk(\"/files\", func(path string, info os.FileInfo, err error) error {\n        if err != nil {\n            return err\n        }\n        header, err := tar.FileInfoHeader(info, info.Name())\n        if err != nil {\n            return err\n        }\n\n        if baseDir != \"\" {\n            header.Name = filepath.Join(baseDir, strings.TrimPrefix(path, \"/files\"))\n        }\n\n        if err := tarball.WriteHeader(header); err != nil {\n            return err\n        }\n\n        if info.IsDir() {\n            return nil\n        }\n\n        file, err := os.Open(path)\n        if err != nil {\n            return err\n        }\n        defer file.Close()\n        _, err = io.Copy(tarball, file)\n        return err\n    })\n}\n</code></pre>\n\n<p>The files I am trying to add to the tarball are located in /files, and I've added this folder as a static_dir in the app.yaml.</p>\n\n<p>When navigating to the appropriate URL, the browser downloads a tar file that is only 1 KB in size, and appears to be empty.</p>\n\n<p>I would very much appreciate if someone could point out where I am going wrong, or what I am misunderstanding.  I'd also be very happy to provide any other details that you would like.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1461368483, "post_id": 36799573, "comment_id": 61183619, "body": "I think you may not need NewInstance, instead create <a href=\"https://cloud.google.com/appengine/docs/go/tools/localunittesting/\" rel=\"nofollow noreferrer\">aetest.NewContext()</a>, and use that context to call the external facebook service using <a href=\"https://cloud.google.com/appengine/docs/go/urlfetch/\" rel=\"nofollow noreferrer\">URL Fetch</a>"}, {"owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1461509087, "post_id": 36799573, "comment_id": 61220340, "body": "Gettting a <code>context</code> pointer works if you are testing a method/service that requires a context pointer (memcache, datastore, email, etc), but using an instance to test an endpoint is the only way I can find to create a <code>http.Request</code> that works, but then the docs are pretty weak so there might be a way that isn&#39;t shown."}], "answers": [{"tags": [], "owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1461508703, "creation_date": 1461508703, "answer_id": 36824521, "question_id": 36799573, "link": "https://stackoverflow.com/questions/36799573/problems-with-go-appengine-endpoint-tests/36824521#36824521", "title": "Problems with Go Appengine endpoint tests", "body": "<p>I was really hoping to perform api blackbox tests, but that <em>seems</em> to be undoable with appengine. Instead I am now performing the tests on the endpoint directly.</p>\n\n<pre><code>req, _ := inst.NewRequest(\"POST\", \"/auth\", reader)\nreq.Header.Add(AppAuthToken, \"foobar\")\nresp := httptest.NewRecorder()\n\nhandlePostAuth(resp, req)\nassert.Equal(t, http.StatusCreated, resp.Code)\n</code></pre>\n"}], "owner": {"reputation": 4176, "user_id": 26849, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-tO7nkYt2C3Q/AAAAAAAAAAI/AAAAAAAAAr4/UstVddaB4E4/photo.jpg?sz=128", "display_name": "chris", "link": "https://stackoverflow.com/users/26849/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1462954495, "creation_date": 1461344595, "last_edit_date": 1461353112, "question_id": 36799573, "link": "https://stackoverflow.com/questions/36799573/problems-with-go-appengine-endpoint-tests", "title": "Problems with Go Appengine endpoint tests", "body": "<p>I am trying to create an endpoint test when using appengine. Unfortunately, the tests keep failing because of the lack of a schema (and host) within the url used when creating the test <code>*Request</code> struct. When running appengine tests a server is spawned for that specific test that runs on a semi-random port number, which makes it seemingly impossible to define the full url to perform the test on.</p>\n\n<p>The <a href=\"https://cloud.google.com/appengine/docs/go/tools/localunittesting/\" rel=\"nofollow\">official docs</a> on running tests like this are very sparse and only give half of an example, so I am left scratching my head on how to get this to work.</p>\n\n<p>This is the error that I get from the marked line within the code snippet\n<code>\nError: Received unexpected error \"Post /auth: unsupported protocol scheme \\\"\\\"\"\n</code></p>\n\n<p><strong>Test Code</strong></p>\n\n<pre><code>func TestEndpoints_Auth(t *testing.T) {\n\n    // input data\n    account := Account{\n        AuthProvider:   \"facebook\",\n        AuthProviderId: \"123345456\",\n    }\n    b, _ := json.Marshal(&amp;account)\n    reader := bytes.NewReader(b)\n\n    // test server\n    inst, err := aetest.NewInstance(nil)\n    if !assert.NoError(t, err) { return }\n    defer inst.Close()\n\n    // request\n    client := http.Client{}\n    req, err := inst.NewRequest(\"POST\", \"/auth\", reader)\n    if !assert.NoError(t, err) { return }\n    req.Header.Add(AppAuthToken, \"foobar\")\n    resp, err := client.Do(req)\n    if !assert.NoError(t, err) { return }   // &lt;=== Where the error occurs\n\n    // tests\n    if !assert.Nil(t, err) { return }\n    assert.Equal(t, http.StatusCreated, resp.StatusCode)\n}\n</code></pre>\n\n<p>Logs\n<code>\n[GIN-debug] POST   /auth                     --&gt; bitbucket.org/chrisolsen/chriscamp.(*endpoints).Auth-fm (5 handlers)\n[GIN-debug] GET    /accounts/me              --&gt; bitbucket.org/chrisolsen/chriscamp.(*endpoints).GetMyAccount-fm (7 handlers)\nINFO     2016-04-22 13:23:39,278 devappserver2.py:769] Skipping SDK update check.\nWARNING  2016-04-22 13:23:39,278 devappserver2.py:785] DEFAULT_VERSION_HOSTNAME will not be set correctly with --port=0\nWARNING  2016-04-22 13:23:39,345 simple_search_stub.py:1126] Could not read search indexes from c:\\users\\chris\\appdata\\local\\temp\\appengine.testapp\\search_indexes\nINFO     2016-04-22 13:23:39,354 api_server.py:205] Starting API server at: http://localhost:54461\nINFO     2016-04-22 13:23:41,043 dispatcher.py:197] Starting module \"default\" running at: http://localhost:54462\nINFO     2016-04-22 13:23:41,046 admin_server.py:116] Starting admin server at: http://localhost:54466\n</code></p>\n"}, {"tags": ["go", "rpc", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 2, "last_activity_date": 1461344394, "creation_date": 1461344394, "answer_id": 36799526, "question_id": 36798854, "link": "https://stackoverflow.com/questions/36798854/gorpc-newdispatcher-imported-and-not-used/36799526#36799526", "title": "goRPC newdispatcher imported and not used", "body": "<p>Try to qualify identifiers with import prefix to make them defined</p>\n\n<pre><code>d := gorpc.NewDispatcher()\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5739130, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f019a2cde05dc1b7585530a341841f80?s=128&d=identicon&r=PG&f=1", "display_name": "dbaus", "link": "https://stackoverflow.com/users/5739130/dbaus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 36799526, "answer_count": 1, "score": 0, "last_activity_date": 1461345569, "creation_date": 1461342128, "last_edit_date": 1461345569, "question_id": 36798854, "link": "https://stackoverflow.com/questions/36798854/gorpc-newdispatcher-imported-and-not-used", "title": "goRPC newdispatcher imported and not used", "body": "<p>I'm working with the <a href=\"https://godoc.org/github.com/valyala/gorpc#example-Server\" rel=\"nofollow\">valyala goRPC package</a>. I'm trying to implement this example:</p>\n\n<pre><code>package main\n\nimport (\n\"errors\"\n\"fmt\"\n\"log\"\n)\n\ntype ExampleDispatcherService struct {\nstate int\n}\n\nfunc (s *ExampleDispatcherService) Get() int { return s.state }\n\nfunc (s *ExampleDispatcherService) Set(x int) { s.state = x }\n\nfunc (s *ExampleDispatcherService) GetError42() (int, error) {\n    if s.state == 42 {\n    return 0, errors.New(\"error42\")\n    }\nreturn s.state, nil\n}\n\nfunc (s *ExampleDispatcherService) privateFunc(string) { s.state = 0 }\n\nfunc main() {\nd := NewDispatcher()\n\nservice := &amp;ExampleDispatcherService{\n    state: 123,\n}\n\n// Register exported service functions\nd.AddService(\"MyService\", service)\n\n// Start rpc server serving registered service.\naddr := \"127.0.0.1:7892\"\ns := NewTCPServer(addr, d.NewHandlerFunc())\nif err := s.Start(); err != nil {\n    log.Fatalf(\"Cannot start rpc server: [%s]\", err)\n}\ndefer s.Stop()\n\n// Start rpc client connected to the server.\nc := NewTCPClient(addr)\nc.Start()\ndefer c.Stop()\n\n// Create client wrapper for calling service functions.\ndc := d.NewServiceClient(\"MyService\", c)\n\nres, err := dc.Call(\"Get\", nil)\nfmt.Printf(\"Get=%+v, %+v\\n\", res, err)\n\nservice.state = 456\nres, err = dc.Call(\"Get\", nil)\nfmt.Printf(\"Get=%+v, %+v\\n\", res, err)\n\nres, err = dc.Call(\"Set\", 78)\nfmt.Printf(\"Set=%+v, %+v, %+v\\n\", res, err, service.state)\n\nres, err = dc.Call(\"GetError42\", nil)\nfmt.Printf(\"GetError42=%+v, %+v\\n\", res, err)\n\nservice.state = 42\nres, err = dc.Call(\"GetError42\", nil)\nfmt.Printf(\"GetError42=%+v, %+v\\n\", res, err)\n\n}\n</code></pre>\n\n<p>But when I try to build this I got this error:</p>\n\n<pre><code>PS C:\\Work\\goRPC&gt; go build .\\prueba1.go\n# command-line-arguments\n.\\prueba1.go:27: undefined: NewDispatcher\n.\\prueba1.go:38: undefined: NewTCPServer\n.\\prueba1.go:45: undefined: NewTCPClient\n</code></pre>\n\n<p>I added the package <code>import \"github.com/valyala/gorpc\"</code> but now I get this error:</p>\n\n<pre><code># command-line-arguments\n.\\prueba1.go:7: imported and not used: \"git\n.\\prueba1.go:29: undefined: NewDispatcher\n.\\prueba1.go:40: undefined: NewTCPServer\n.\\prueba1.go:47: undefined: NewTCPClient\n</code></pre>\n\n<p>I know this is a noobie doubt about golang, but I'm clueless about what to do.</p>\n\n<p>Thanks for your time.</p>\n"}]