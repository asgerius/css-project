[{"tags": ["mongodb", "go", "mongodb-query"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574293527, "post_id": 58964972, "comment_id": 104185286, "body": "Is this the program you&#39;re running? It should give a syntax error in: <code>&quot;request_params&quot;,bson.D{{&quot;username&quot;,&quot;test_user&quot;},&quot;service_co&zwnj;&#8203;de&quot;: &quot;MR&quot;}</code>, the service_code part."}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574294569, "post_id": 58964972, "comment_id": 104185498, "body": "@BurakSerdar No syntax error or any other, program runs smoothly."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574294911, "post_id": 58964972, "comment_id": 104185579, "body": "Here&#39;s the part that&#39;s troubling: <code>bson.D{{&quot;username&quot;,&quot;test_user&quot;},&quot;service_code&quot;: &quot;MR&quot;}</code> It should be `bson.D{{&quot;username&quot;,&quot;test_user&quot;},{&quot;service_code&quot;, &quot;MR&quot;}}"}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574295281, "post_id": 58964972, "comment_id": 104185673, "body": "Sorry that was a copy-paste mistake when I pasted code here still not working. updated question"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574295599, "post_id": 58964972, "comment_id": 104185748, "body": "Try: <code>bson.M{&quot;status&quot;:&quot;success&quot;,&quot;request_params&quot;:bson.D{{&quot;username&zwnj;&#8203;&quot;,&quot;test_user&quot;},{&quot;ser&zwnj;&#8203;vice_code&quot;,&quot;MR&quot;}}}</code>"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1574330735, "post_id": 58964972, "comment_id": 104198091, "body": "@rafidkotta could you elaborate what do you mean by getting nothing ? As in, your print statement for <code>elem</code> does not print anything ? Using your example document, and your example code, I&#39;m unable to reproduce the issue that you&#39;re seeing."}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574332357, "post_id": 58964972, "comment_id": 104199111, "body": "@BurakSerdar still empty cursor"}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1574332452, "post_id": 58964972, "comment_id": 104199175, "body": "@WanBachtiar I am getting an empty cursor while there is 100s of docs satisfying the condition. - updated in question"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1574333087, "post_id": 58964972, "comment_id": 104199565, "body": "i don&#39;t understand how the driver is supposed to decode to <code>*interface{}</code>. OP code is dubious"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1574333479, "post_id": 58964972, "comment_id": 104199816, "body": "@rafidkotta which version of the driver are you using ? Also, is the code above the code that you&#39;re testing with ? Could you try copying a handful of documents (5-10) to a test collection and check with the code above ?"}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1574344784, "post_id": 58964972, "comment_id": 104206417, "body": "@WanBachtiar document has other data other than passed data. When i pass whole data it&#39;s returning the document but i can&#39;t pass the that. Updated the question with more info, Thanks"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574346748, "post_id": 58964972, "comment_id": 104207741, "body": "@rafidkotta the way you&#39;re searching for the <code>request_params</code> is likely the culprit. Can you try this: <code>bson.M{&quot;status&quot;:&quot;success&quot;,&quot;request_params.username&quot;:&quot;testuse&zwnj;&#8203;r&quot;,&quot;request_params.s&zwnj;&#8203;ervice_code&quot;:&quot;MR&quot;}</code> Note it is bson.M, not bson.D. With bson.D, order matters."}, {"owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574347700, "post_id": 58964972, "comment_id": 104208344, "body": "@BurakSerdar  Yes I saw the your answer when I came to reply Thank you all"}], "answers": [{"tags": [], "owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574382607, "creation_date": 1574382607, "answer_id": 58985764, "question_id": 58964972, "link": "https://stackoverflow.com/questions/58964972/how-to-find-documents-with-multiple-conditions-using-mongo-driver-mongo/58985764#58985764", "title": "How to find documents with multiple conditions using mongo-driver/mongo", "body": "<p>The issue here is because of the query filter. There is a difference between the following queries:</p>\n\n<pre><code>// Query A: {\"status\": \"success\", \"request_params\": {\"username\":\"test_user\"}}\nfind := bson.D{{\"status\",\"success\"},{\"request_params\",bson.D{{\"username\",\"test_user\"}}}}\n\n// Query B: {\"status\": \"success\", \"request_params.username\":\"test_user\"}\nfind := bson.D{{\"status\",\"success\"},{\"request_params.username\",\"test_user\"}}\n</code></pre>\n\n<p>Query A means that you would like to match an exact document of <code>request_params</code> where the value object exactly equal to <code>{\"username\":\"test_user\"}</code>. None of the documents in your collection matches this criteria. The documents also contains <code>{\"service_code\":\"MR\"}</code>. While query B uses <a href=\"https://docs.mongodb.com/manual/core/document/#document-dot-notation\" rel=\"nofollow noreferrer\">dot notation</a>, which means that you would like to match <code>request_params</code> field where it <em>contains</em> a value of <code>{\"username\":\"test_user\"}</code>.</p>\n\n<p>See also <a href=\"https://docs.mongodb.com/manual/tutorial/query-embedded-documents/#query-on-nested-field\" rel=\"nofollow noreferrer\">Query on Nested Field</a> for more information. </p>\n"}], "owner": {"reputation": 449, "user_id": 9538631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fJJ1-R2Z8Js/AAAAAAAAAAI/AAAAAAAAACQ/KbvKKHRlgKs/photo.jpg?sz=128", "display_name": "Rafid Kotta", "link": "https://stackoverflow.com/users/9538631/rafid-kotta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 0, "accepted_answer_id": 58985764, "answer_count": 1, "score": 0, "last_activity_date": 1574382607, "creation_date": 1574292495, "last_edit_date": 1574343372, "question_id": 58964972, "link": "https://stackoverflow.com/questions/58964972/how-to-find-documents-with-multiple-conditions-using-mongo-driver-mongo", "title": "How to find documents with multiple conditions using mongo-driver/mongo", "body": "<p>While querying the below data, returned cursor is empty. while there is 100s of documents which satisfy the condition. </p>\n\n<pre><code> {\n  \"_id\": \"5dd68c51a39809125944ffba\",\n  \"status\": \"success\",\n  \"balance\": \"0.000\",\n  \"request_params\": {\n   \"username\": \"test_user\",\n   \"service_code\": \"MR\"\n }\n</code></pre>\n\n<p>using below code</p>\n\n<p>MongoDB driver  \"go.mongodb.org/mongo-driver/mongo\"</p>\n\n<pre><code>func saveLog(data Log) bool {\n    mongo, err := openMongo()\n    if err != nil {\n        log.Println(err)\n        fmt.Println(\"Connection failed\")\n        return false\n    } else {\n        LogCollection := mongo.Database(LogDb).Collection(CollectionLog)\n        insertedApi, err := LogCollection.InsertOne(context.TODO(), data)\n        if err != nil {\n            log.Println(err)\n            fmt.Println(\"Insert failed\")\n            return false\n        } else {\n            log.Println(insertedApi.InsertedID)\n            return true\n        }\n    }\n}\n\nfunc parseLog() {\n    db, err := openMongo()\n    if err != nil {\n        fmt.Println(err)\n        fmt.Println(\"Connection failed\")\n        return\n    } else {\n        logCollection := db.Database(LogDb).Collection(CollectionLog)\n        var results [] *Log\n        find := bson.D{{\"status\",\"success\"},{\"request_params\",bson.D{{\"username\",\"test_user\"}}}}\n        fmt.Println(find)\n        cur, err := logCollection.Find(context.TODO(), find)\n        if err != nil {\n            log.Fatal(err)\n        }else {\n            for cur.Next(context.TODO()) {\n                var elem Log\n                err := cur.Decode(&amp;elem)\n                if err != nil {\n                    fmt.Println(\"Parse error : \",err)\n                }\n                fmt.Println(\"Log : \",elem)\n                results = append(results, &amp;elem)\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>Log write</p>\n\n<pre><code>saveLog(Log{\"success\",\"0.000\",RequestParams{\"test_user\",\"MR\"}})\n</code></pre>\n\n<p>Log read</p>\n\n<pre><code>parseLog()\n</code></pre>\n\n<p>Log struct</p>\n\n<pre><code>type Log struct {\n    Status string `bson:\"status\"`\n    Balance string `bson:\"balance\"`\n    RequestParams RequestParams `bson:\"request_params\"`\n}\ntype RequestParams struct {\n    Username string `bson:\"username\"`\n    ServiceCode     string `bson:\"service_code\"`\n}\n</code></pre>\n\n<p>MongoDB data</p>\n\n<p><a href=\"https://i.stack.imgur.com/tNX3Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tNX3Q.png\" alt=\"MongoDB data\"></a></p>\n\n<p>status only is returning whole 8k documents</p>\n\n<pre><code>bson.D{{\"status\",\"success\"}}\n</code></pre>\n\n<p>Isn't  collection.Find() function the right one for it.</p>\n\n<p>Shell command is returning documents correctly</p>\n\n<pre><code>db.log.find({\"status\":\"success\",\"request_params.username\":\"test_user\"}).limit(10).pretty()\n</code></pre>\n"}, {"tags": ["postgresql", "go", "gorp"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5390720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf24df276d124fe96700780744f4af71?s=128&d=identicon&r=PG&f=1", "display_name": "luepin", "link": "https://stackoverflow.com/users/5390720/luepin"}, "edited": false, "score": 0, "creation_date": 1574460412, "post_id": 58964707, "comment_id": 104255062, "body": "Thanks! This worked for me! Just one correction, the insert requires that it&#39;s argument be of type []interface{} so you need to convert s.EmbeddedStruct to that first before inserting the variadic number of slices"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1574290682, "creation_date": 1574290682, "answer_id": 58964707, "question_id": 58962574, "link": "https://stackoverflow.com/questions/58962574/how-to-insert-slice/58964707#58964707", "title": "How to insert slice", "body": "<p>Gorp supports inserting a <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow noreferrer\">variadic</a> number of slices, so if you have a slice <code>records</code>, you can do:</p>\n\n<pre><code> err = db.Insert(records...)\n</code></pre>\n\n<p>However, from your question it seems you want to save a single record that has a slice struct field.</p>\n\n<p><a href=\"https://github.com/go-gorp/gorp\" rel=\"nofollow noreferrer\">https://github.com/go-gorp/gorp</a></p>\n\n<blockquote>\n  <p>gorp doesn't know anything about the relationships between your structs (at least not yet). </p>\n</blockquote>\n\n<p>So, you have to handle the relationship yourself.  The way I personally would solve this issue is to have <a href=\"https://github.com/go-gorp/gorp#mapping-structs-to-tables\" rel=\"nofollow noreferrer\">Gorp ignore the slice on the parent</a>:</p>\n\n<pre><code>type Struct1 struct {\n    ID              string\n    Name            string\n    Location        string\n    EmbeddedStruct  []EmbeddedStruct `db:\"-\"`\n}\n</code></pre>\n\n<p>And then use the <code>PostInsert</code> <a href=\"https://github.com/go-gorp/gorp#hooks\" rel=\"nofollow noreferrer\">hook</a> to save the <code>EmbeddedStruct</code> (side note, this is a poor name as it is not actually an <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">embedded struct</a>)</p>\n\n<pre><code>func (s *Struct1) PostInsert(sql gorp.SqlExecutor) error {\n    for i := range s.EmbeddedStruct {\n        s.EmbeddedStruct[i].struct1Id = s.ID\n    }\n    return sql.Insert(s.EmbeddedStruct...)\n}\n</code></pre>\n\n<p>And then repeat the process on <code>EmbeddedStruct2</code>.</p>\n\n<p>Take care to setup the relationships properly on the DB side to ensure referential integrity (e.g. ON DELETE CASCADE / RESTRICT), and it would probably be a good idea to wrap the whole thing in a transaction.</p>\n"}], "owner": {"reputation": 11, "user_id": 5390720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf24df276d124fe96700780744f4af71?s=128&d=identicon&r=PG&f=1", "display_name": "luepin", "link": "https://stackoverflow.com/users/5390720/luepin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574325671, "creation_date": 1574280652, "last_edit_date": 1574325671, "question_id": 58962574, "link": "https://stackoverflow.com/questions/58962574/how-to-insert-slice", "title": "How to insert slice", "body": "<p>I have a postgres db that I would like to generate tables for and write to using Gorp, however I get an error message when I try to insert due to the slices contained within my structs \"sql: converting argument $4 type: unsupported type []core.EmbeddedStruct, a slice of struct.</p>\n\n<p>My structs look as follows:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>type Struct1 struct {\r\n\tID              string\r\n\tName            string\r\n\tLocation        string\r\n\tEmbeddedStruct  []EmbeddedStruct\r\n}\r\n\r\ntype EmbeddedStruct struct {\r\n\tID         string\r\n\tName       string\r\n\tstruct1Id  string\r\n\tEmbeddedStruct2  []EmbeddedStruct2\r\n}\r\n\r\ntype EmbeddedStruct2 struct {\r\n\tID               string\r\n\tName             string\r\n\tembeddedStructId string\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>func (repo *PgStruct1Repo) Write(t *core.Struct1) error {\r\n\ttrans, err := createTransaction(repo.dbMap)\r\n\tdefer closeTransaction(trans)\r\n\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\r\n\t// Check to see if struct1 item already exists\r\n\texists, err := repo.exists(t.ID, trans)\r\n\tif err != nil {\r\n\t\treturn err\r\n\t}\r\n\r\n\tif !exists {\r\n\t\tlog.Debugf(\"saving new struct1 with ID %s\", t.ID)\r\n\t\terr = trans.Insert(t)\r\n\t\tif err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\t\treturn nil\r\n\t}\r\n\r\n\treturn nil\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Does anyone have any experience with/or know if Gorp supports inserting slices? From what I've read it seems to only support slices for SELECT statements</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1574279771, "post_id": 58962350, "comment_id": 104179913, "body": "Yes, they have the same underlying type and that&#39;s why <i>conversion</i> (<code>T(v)</code>) works, however <i>type assertion</i> (<code>v.(T)</code>) is another thing."}, {"owner": {"reputation": 371, "user_id": 6031948, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nW0RvlDi2rA/AAAAAAAAAAI/AAAAAAAAAww/LYw7gFx44nk/photo.jpg?sz=128", "display_name": "Brian Wagner", "link": "https://stackoverflow.com/users/6031948/brian-wagner"}, "edited": false, "score": 5, "creation_date": 1574279934, "post_id": 58962350, "comment_id": 104179994, "body": "Adding to above, the assertion is strict. <a href=\"https://stackoverflow.com/questions/41501596/custom-type-passed-to-function-as-a-parameter\" title=\"custom type passed to function as a parameter\">stackoverflow.com/questions/41501596/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574283262, "post_id": 58962350, "comment_id": 104181505, "body": "If you are new to Go you do not need a sync.Map."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574280244, "creation_date": 1574280244, "answer_id": 58962485, "question_id": 58962350, "link": "https://stackoverflow.com/questions/58962350/type-definition-and-interface-conversion/58962485#58962485", "title": "Type definition and interface conversion", "body": "<p>This stores a <code>string</code> in the map:</p>\n\n<pre><code>a.Store(\"a\", \"A\")\n</code></pre>\n\n<p>This loads the value from the map, but returns an interface that is pointing to the value inserted above, which is a <code>string</code>:</p>\n\n<pre><code>b, _ := a.Load(\"a\")\n</code></pre>\n\n<p>This will check if <code>b</code> is a <code>T</code>:</p>\n\n<pre><code>c = b.(T)\n</code></pre>\n\n<p>But <code>b</code> is a <code>string</code>, so the assertion fails.</p>\n\n<p>If you do:</p>\n\n<pre><code>a.Store(\"a\",T(\"A\"))\n</code></pre>\n\n<p>then the assertion should work, because the type of the value in the map is now a <code>T</code>.</p>\n"}], "owner": {"reputation": 1790, "user_id": 2991410, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/5cdbc3590e5bcb211129003a5d9121e7?s=128&d=identicon&r=PG", "display_name": "JasmineOT", "link": "https://stackoverflow.com/users/2991410/jasmineot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58962485, "answer_count": 1, "score": -2, "last_activity_date": 1574325693, "creation_date": 1574279647, "last_edit_date": 1574325693, "question_id": 58962350, "link": "https://stackoverflow.com/questions/58962350/type-definition-and-interface-conversion", "title": "Type definition and interface conversion", "body": "<p>I have tried out the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype T string\n\nfunc main() {\n    var a sync.Map // map[interface{}]interface{}\n    var c T\n    // a.Store(\"a\", T(\"A\"))\n    a.Store(\"a\", \"A\")\n    b, _ := a.Load(\"a\")\n    c = b.(T)\n    fmt.Println(c)\n}\n</code></pre>\n\n<p>This gets an error of <code>panic: interface conversion: interface {} is string, not main.T</code>.\nHowever, it works if I use the commented line.</p>\n\n<p>Aren't <code>T</code> and <code>string</code> of same underlying types? What's behind this?</p>\n"}, {"tags": ["pointers", "go", "stack"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574278885, "post_id": 58961986, "comment_id": 104179456, "body": "x does not point to a stack address. see <a href=\"https://stackoverflow.com/questions/38234487/returning-a-pointer-on-stack\" title=\"returning a pointer on stack\">stackoverflow.com/questions/38234487/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/52996452/returning-pointer-from-a-local-variable-in-function\" title=\"returning pointer from a local variable in function\">stackoverflow.com/questions/52996452/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/52996452/returning-pointer-from-a-local-variable-in-function\" title=\"returning pointer from a local variable in function\">stackoverflow.com/questions/52996452/&hellip;</a>, etc"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574279382, "post_id": 58961986, "comment_id": 104179712, "body": "&quot;the address of a variable which was created in a function is a wrong approach since the created local variable will be in stack, and after completing the function the variable will be popped from stack&quot; false. Any variable that will have a pointer taken of it will be allocated on the heap and managed by GC."}, {"owner": {"reputation": 47, "user_id": 10027580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJSXu_hg-x0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq12lbowKhQv81AF9Y60L-pkAqz28g/mo/photo.jpg?sz=128", "display_name": "computerengineer", "link": "https://stackoverflow.com/users/10027580/computerengineer"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574279391, "post_id": 58961986, "comment_id": 104179718, "body": "@JimB thanks for your response. I could not find the links."}, {"owner": {"reputation": 1814, "user_id": 12258482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812d353caef22c1ee1ae0e5ceee57508?s=128&d=identicon&r=PG", "display_name": "I Love Reflection", "link": "https://stackoverflow.com/users/12258482/i-love-reflection"}, "edited": false, "score": 0, "creation_date": 1574292296, "post_id": 58961986, "comment_id": 104184978, "body": "The <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">specification</a> is silent on the distinction between heap and stack allocation. In fact, spec does not contain the words &quot;heap&quot; or &quot;stack&quot;.  The question is based on conceptual baggage from some other language."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574278916, "creation_date": 1574278916, "answer_id": 58962155, "question_id": 58961986, "link": "https://stackoverflow.com/questions/58961986/returning-address-of-local-variable-generates-unexpected-value/58962155#58962155", "title": "Returning Address of Local Variable Generates Unexpected Value", "body": "<p>It is called \"escape analysis\".</p>\n\n<p>Go compiler tries to find out if the address of a variable \"escapes\" a function, and if it does, it allocates the variable in the heap instead of stack. In this case, it finds that the address of <code>t</code> escapes the <code>changeName</code> function, so it is allocated in the heap, not in the stack. That is the reason why your program works.</p>\n\n<p>For instance, this is a common way to construct structs:</p>\n\n<pre><code>type X struct {\n  ...\n}\n\nfunc NewX() *X {\n   a:=X{}\n   ...\n   return &amp;a\n}\n</code></pre>\n\n<p>Here, <code>a</code> is allocated in the heap, not on stack because the compiler knows that <code>a</code> escapes the function.</p>\n\n<p>The following is also valid:</p>\n\n<pre><code>func f() {\n  i:=0\n  go func() {\n    ...\n    i++\n    ...\n   }()\n}\n</code></pre>\n\n<p>Above, <code>i</code> escapes <code>f</code>, because address of <code>i</code> is in the closure of the newly created goroutine. After <code>f</code> returns, <code>i</code> continues to live.</p>\n"}], "owner": {"reputation": 47, "user_id": 10027580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LJSXu_hg-x0/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq12lbowKhQv81AF9Y60L-pkAqz28g/mo/photo.jpg?sz=128", "display_name": "computerengineer", "link": "https://stackoverflow.com/users/10027580/computerengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58962155, "answer_count": 1, "score": -2, "last_activity_date": 1574278916, "creation_date": 1574278235, "question_id": 58961986, "link": "https://stackoverflow.com/questions/58961986/returning-address-of-local-variable-generates-unexpected-value", "title": "Returning Address of Local Variable Generates Unexpected Value", "body": "<p>I have written the below code. I know that returning the address of a variable which was\ncreated in a function is a wrong approach since the created local variable will be in stack, and \nafter completing the function the variable will be popped from stack. \nI have created a person whose name is 'latif'. Then I have used changeName() function. It changes name field of the person struct as 'uluman'. It has returned the address of the local variable.  After finishing the function, the local variable should be popped. Then I have called sum() function for guarenting that the stack will change (paremeters of sum function will pushed. With other words, the cell value x points in the memory should change ). So the x points somewhere in stack. </p>\n\n<pre><code>package main\n    import \"fmt\"\n\n    type Person struct{\n        name string\n        age int\n\n    }\n    func sum(a, b int)int{\n       return a+b\n    }\n    func (t Person ) changeName(value string)*Person{\n        t.name = value\n        return &amp;t  //Delibiratly the address of the local variable is returned\n    }\n    func main(){\n        t := Person{name : \"latif\" }\n\n        fmt.Println(\"Before\" , t.name)\n        x := t.changeName(\"uluman\")\n        _= sum(5,10)\n        fmt.Println(\"After\" , x.name)\n\n\n\n        return\n    }\n</code></pre>\n\n<p>I have expected that the <strong>fmt.Println(x.name)</strong> should print something different from <strong>'uluman'</strong> since the x points stack address and it has changed, but it has printed 'uluman'.\nWhat is wrong in here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574268678, "post_id": 58959501, "comment_id": 104174300, "body": "<code>log.Println(command, args)</code>?"}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574268745, "post_id": 58959501, "comment_id": 104174333, "body": "@mkopriva thanks but how can I create a variable string from command and args before printing?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1574268773, "post_id": 58959501, "comment_id": 104174354, "body": "You can use <a href=\"https://golang.org/pkg/strings/#Join\" rel=\"nofollow noreferrer\"><code>strings.Join</code></a>. For example <code>strings.Join(append([]string{command}, args...), &quot;,&quot;)</code> (change <code>&quot;,&quot;</code> to whatever you desire the separator to be)."}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574269128, "post_id": 58959501, "comment_id": 104174561, "body": "@mkopriva great, thanks a lot, would you please post it as answer?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574269254, "post_id": 58959501, "comment_id": 104174628, "body": "If it&#39;s all the same to you you can accept Shrikant&#39;s answer."}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574269566, "post_id": 58959501, "comment_id": 104174788, "body": "Shrikant&#39;s answer is fine as well, but I was looking for something provided by the language itself, that&#39;s why I wanted to accept your answer"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574269678, "post_id": 58959501, "comment_id": 104174851, "body": "<code>strings.Join</code>, loop over them with <code>for</code>, it really depends on what you want the output to actually end up like, which isn&#39;t specified in the question."}, {"owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574269878, "post_id": 58959501, "comment_id": 104174948, "body": "@Adrian I believe I mentioned that I need to concatenate the two arguments into one string. And I had the for loop idea in mind, just because I&#39;m new to Go I expected another way provided by the language itself which is strings.Join"}], "answers": [{"tags": [], "owner": {"reputation": 664, "user_id": 1344924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0870afb0998f9e34fdda5991f743649d?s=128&d=identicon&r=PG", "display_name": "Shrikant", "link": "https://stackoverflow.com/users/1344924/shrikant"}, "is_accepted": true, "score": 2, "last_activity_date": 1574269673, "last_edit_date": 1574269673, "creation_date": 1574269138, "answer_id": 58959645, "question_id": 58959501, "link": "https://stackoverflow.com/questions/58959501/how-to-create-a-string-from-variadic/58959645#58959645", "title": "How to create a string from variadic", "body": "<p>One of the straight forward way of doing this can be like below - </p>\n\n<pre><code>func sum(command string, args ...string) {\n    for _, arg := range args {\n        command += \" \" + arg\n    }\n    fmt.Println(command)\n}\n</code></pre>\n\n<p>Also thanks to <a href=\"https://stackoverflow.com/users/965900/mkopriva\">mkopriva</a> it can be achieved this way as well:</p>\n\n<pre><code>strings.Join(append([]string{command}, args...), \",\")\n</code></pre>\n"}], "owner": {"reputation": 10456, "user_id": 235123, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/N9D2y.jpg?s=128&g=1", "display_name": "Mina Samy", "link": "https://stackoverflow.com/users/235123/mina-samy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58959645, "answer_count": 1, "score": 0, "last_activity_date": 1574273004, "creation_date": 1574268620, "last_edit_date": 1574273004, "question_id": 58959501, "link": "https://stackoverflow.com/questions/58959501/how-to-create-a-string-from-variadic", "title": "How to create a string from variadic", "body": "<p>I have a function that accepts a variadic string argument like this:</p>\n\n<pre><code>func RunCommand(command string, args ...string) {\n}\n</code></pre>\n\n<p>Now for logging purposes, I need to construct a string which consists of the command + arguments.</p>\n\n<p>So I need to have a single string variable that includes both arguments.</p>\n\n<p>How to do that in Go?</p>\n"}, {"tags": ["pointers", "go", "struct", "pass-by-reference"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1574262498, "post_id": 58957455, "comment_id": 104170432, "body": "See <a href=\"https://stackoverflow.com/questions/45751608/why-is-http-client-prefixed-with/45751833#45751833\">Why is http.Client{} prefixed with &amp;?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 11875319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274eec3a9c69fcdcf70cfd9ed6d2fa43?s=128&d=identicon&r=PG&f=1", "display_name": "codemonkey", "link": "https://stackoverflow.com/users/11875319/codemonkey"}, "edited": false, "score": 0, "creation_date": 1574265597, "post_id": 58957582, "comment_id": 104172459, "body": "Okay, thanks for the explanation, really helped out."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "reply_to_user": {"reputation": 185, "user_id": 11875319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274eec3a9c69fcdcf70cfd9ed6d2fa43?s=128&d=identicon&r=PG&f=1", "display_name": "codemonkey", "link": "https://stackoverflow.com/users/11875319/codemonkey"}, "edited": false, "score": 0, "creation_date": 1574276661, "post_id": 58957582, "comment_id": 104178347, "body": "Glad I could be of service! If this does answer your question, be sure to hit the big green checkmark to mark it as the answer and help  anyone else searching for this in the future. Thanks!"}], "tags": [], "owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "is_accepted": false, "score": 3, "last_activity_date": 1574262620, "creation_date": 1574262620, "answer_id": 58957582, "question_id": 58957455, "link": "https://stackoverflow.com/questions/58957455/tour-of-go-difference-between-and-no-when-referring-to-a-vector-struct/58957582#58957582", "title": "Tour of Go, difference between &amp; and no &amp; when referring to a Vector struct", "body": "<p>You will not get the exact same output, notice that the output no longer indicates that you've passed a pointer (the <code>&amp;</code> is missing):</p>\n\n<pre><code>Before scaling: {X:3 Y:4}, Abs: 5\nAfter scaling: {X:15 Y:20}, Abs: 25\n</code></pre>\n\n<p>The reason you can still call the absolute value method is because Go implicitly takes the address of <code>v</code> for you when it sees that the method exists on a pointer type but you've used the struct directly since it is always possible to take the address of the struct and derive a method call on the pointer receiver.</p>\n\n<p>For more information, see the \"Method expressions\" section of the Go spec: <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Method_expressions</a></p>\n\n<p>There isn't really enough information in this specific instance to tell you whether it's good or bad practice to use the struct value or always pass a pointer around. This is very dependent on the situation, the size of the struct, whether you want your value stack or heap allocated, and any number of other factors. However, for most programs it probably won't make a difference and I'd advise that it's not worth worrying about early on as you learn Go.</p>\n"}], "owner": {"reputation": 185, "user_id": 11875319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274eec3a9c69fcdcf70cfd9ed6d2fa43?s=128&d=identicon&r=PG&f=1", "display_name": "codemonkey", "link": "https://stackoverflow.com/users/11875319/codemonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574325891, "creation_date": 1574262299, "last_edit_date": 1574325891, "question_id": 58957455, "link": "https://stackoverflow.com/questions/58957455/tour-of-go-difference-between-and-no-when-referring-to-a-vector-struct", "title": "Tour of Go, difference between &amp; and no &amp; when referring to a Vector struct", "body": "<p>I know using &amp; symbol address the address of the stored value, but as I'm going the \"Tour of Go\", in the sections where they introducing pointers and special receivers, they have code as follow for referring to a Vector struct to scale and get the absolute value as shown:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\ntype Vertex struct {\n    X, Y float64\n}\n\nfunc (v *Vertex) Scale(f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc (v *Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := &amp;Vertex{3, 4}\n    fmt.Printf(\"Before scaling: %+v, Abs: %v\\n\", v, v.Abs())\n    v.Scale(5)\n    fmt.Printf(\"After scaling: %+v, Abs: %v\\n\", v, v.Abs())\n}\n</code></pre>\n\n<p>With an output of: </p>\n\n<pre><code>Before scaling: &amp;{X:3 Y:4}, Abs: 5\nAfter scaling: &amp;{X:15 Y:20}, Abs: 25\n</code></pre>\n\n<p>But if I change the main function call to have <code>v := Vector{3.4}</code> instead of <code>v:= &amp;Vector{3.4}</code>, I get the same output. Is it better practice to refer to the memeory address in this case? More of a conceptual circumstance I don't seem to understand.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 2, "creation_date": 1574261729, "post_id": 58957209, "comment_id": 104169903, "body": "Can you give an example?"}], "answers": [{"tags": [], "owner": {"reputation": 303, "user_id": 5333616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PGUDA8SH-yA/AAAAAAAAAAI/AAAAAAAAACI/3lqTNI5j8jA/photo.jpg?sz=128", "display_name": "Maxim Panfilov", "link": "https://stackoverflow.com/users/5333616/maxim-panfilov"}, "is_accepted": false, "score": -1, "last_activity_date": 1574261913, "creation_date": 1574261913, "answer_id": 58957318, "question_id": 58957209, "link": "https://stackoverflow.com/questions/58957209/get-json-from-url-and-parse-into-a-multidimensional-array-without-struct/58957318#58957318", "title": "Get Json from url and parse into a multidimensional array without struct", "body": "<p>Now let\u2019s look at decoding JSON data into Go values. Here\u2019s an example for a generic data structure.</p>\n\n<pre><code>byt := []byte(`{\"num\":6.13,\"strs\":[\"a\",\"b\"]}`)\n</code></pre>\n\n<p>We need to provide a variable where the JSON package can put the decoded data. This map[string]interface{} will hold a map of strings to arbitrary data types.</p>\n\n<pre><code>var dat map[string]interface{}\n</code></pre>\n\n<p>Here\u2019s the actual decoding, and a check for associated errors.</p>\n\n<pre><code>if err := json.Unmarshal(byt, &amp;dat); err != nil {\n    panic(err)\n}\nfmt.Println(dat)\n</code></pre>\n\n<p>In order to use the values in the decoded map, we\u2019ll need to convert them to their appropriate type. For example here we convert the value in num to the expected float64 type.</p>\n\n<pre><code>num := dat[\"num\"].(float64)\nfmt.Println(num)\n</code></pre>\n\n<p>Accessing nested data requires a series of conversions.</p>\n\n<pre><code>strs := dat[\"strs\"].([]interface{})\nstr1 := strs[0].(string)\nfmt.Println(str1)\n</code></pre>\n\n<p>See: <a href=\"https://gobyexample.com/json\" rel=\"nofollow noreferrer\">https://gobyexample.com/json</a></p>\n\n<p>You can work with any types with type casting <code>data.(your_type)</code></p>\n"}, {"tags": [], "owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "is_accepted": false, "score": 1, "last_activity_date": 1574268524, "creation_date": 1574268524, "answer_id": 58959480, "question_id": 58957209, "link": "https://stackoverflow.com/questions/58957209/get-json-from-url-and-parse-into-a-multidimensional-array-without-struct/58959480#58959480", "title": "Get Json from url and parse into a multidimensional array without struct", "body": "<p>Of course this is possible in Go, however without using structs it can become quite cumbersome.</p>\n\n<p>If you already know the depth of the resulting array, you can define your slice using the <a href=\"https://tour.golang.org/methods/14\" rel=\"nofollow noreferrer\">empty interface</a> (e.g. for a depth of 3):</p>\n\n<pre><code>var decoded [][][]interface{}\n</code></pre>\n\n<p>If you don't know the depth, use a normal <code>[]interface{}</code> instead and combine it with type assertions.</p>\n\n<p>After that, a normal <a href=\"https://godoc.org/encoding/json#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal</code></a> call will produce the desired result:</p>\n\n<pre><code>err := json.Unmarshal(respData, &amp;decoded)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XUY-hIraPQ0\" rel=\"nofollow noreferrer\">Example link</a></p>\n"}], "owner": {"reputation": 21, "user_id": 10320052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2b9uq.png?s=128&g=1", "display_name": "Exobit", "link": "https://stackoverflow.com/users/10320052/exobit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "closed_date": 1574325962, "answer_count": 2, "score": -4, "last_activity_date": 1574325909, "creation_date": 1574261621, "last_edit_date": 1574325909, "question_id": 58957209, "link": "https://stackoverflow.com/questions/58957209/get-json-from-url-and-parse-into-a-multidimensional-array-without-struct", "closed_reason": "Duplicate", "title": "Get Json from url and parse into a multidimensional array without struct", "body": "<p>How do I parse json from a url into a multidimensional array without a struct?</p>\n\n<p>Is this even possible to do in Go?</p>\n\n<p>I've seen a lot of different answers on stack, and other sites. But not one without a struct.</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574261970, "post_id": 58955135, "comment_id": 104170066, "body": "You can use the existing <code>FileSet</code> to avoid having everything misplaced, and then set the desired <code>token.Pos</code> for the import declaration. <a href=\"https://play.golang.org/p/hCLQB3daxOF\" rel=\"nofollow noreferrer\">play.golang.org/p/hCLQB3daxOF</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574270545, "post_id": 58955135, "comment_id": 104175332, "body": "do you any suggestion about descending the tree to adjust the pos of every element following the newly inserted node ? I did some more testing and it seems to me it is risky to only use a reference and add/remove an offset."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574271598, "post_id": 58955135, "comment_id": 104175879, "body": "Maybe try using <code>golang.org&#47;x&#47;tools&#47;go&#47;ast&#47;astutil</code> and also take a look at its source to see how it calculates the position. Can&#39;t say more than that as I&#39;ve never used it myself."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574271752, "post_id": 58955135, "comment_id": 104175964, "body": "thank you, i have forgotten about astutil. should help indeed."}, {"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 0, "creation_date": 1574293381, "post_id": 58955135, "comment_id": 104185251, "body": "We got caught by this same problem. I think the ast package documentation should be updated a bit. (We ended up going a different way entirely)"}], "answers": [{"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1574275013, "creation_date": 1574275013, "answer_id": 58961205, "question_id": 58955135, "link": "https://stackoverflow.com/questions/58955135/using-package-loader-how-to-update-an-ast-containing-comments-and-print-the-res/58961205#58961205", "title": "using package loader, how to update an ast containing comments and print the resulting code", "body": "<p>for my specific use case, add an import statement, the solution is to use astutil.AddImport, as suggested by @mkopriva</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>astutil.AddImport(prog.Fset, f, \"package/path\")\n</code></pre>\n"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574275013, "creation_date": 1574255352, "question_id": 58955135, "link": "https://stackoverflow.com/questions/58955135/using-package-loader-how-to-update-an-ast-containing-comments-and-print-the-res", "title": "using package loader, how to update an ast containing comments and print the resulting code", "body": "<p>given this code, how do i print it with the extra import spec without breaking comments nodes.</p>\n\n<p><a href=\"https://play.golang.org/p/N6_y1ehM1Qc\" rel=\"nofollow noreferrer\">https://play.golang.org/p/N6_y1ehM1Qc</a></p>\n\n<pre><code>package main\n\nimport (\n    \"go/ast\"\n    \"go/parser\"\n    \"go/printer\"\n    \"go/token\"\n    \"log\"\n    \"os\"\n\n    \"golang.org/x/tools/go/loader\"\n)\n\nfunc main() {\n\n    var conf loader.Config\n    conf.ParserMode = parser.ParseComments\n\n    f, err := conf.ParseFile(\"main.go\", `// some comment goes here \npackage main\n\n// some comment here.\n\n// main comment here.\nfunc main(){\n}\n`)\n    if err != nil {\n        log.Fatal(err)\n    }\n    conf.CreateFromFiles(\"main\", f)\n    prog, err := conf.Load()\n    if err != nil {\n        log.Println(err)\n    }\n\n    g := &amp;ast.GenDecl{}\n    g.Tok = token.IMPORT\n    spec := &amp;ast.ImportSpec{\n        Path: &amp;ast.BasicLit{Value: \"package/path\"},\n    }\n    g.Specs = append(g.Specs, spec)\n    f.Decls = append([]ast.Decl{g}, f.Decls...)\n    _ = prog\n    printer.Fprint(os.Stdout, token.NewFileSet(), f)\n    //printer.Fprint(os.Stdout, prog.Fset, f)\n}\n</code></pre>\n\n<p>This program shows</p>\n\n<pre><code>package main // some comment goes here\n// some comment here.\n// main comment here.\nimport package/path\n\nfunc main() {\n}\n</code></pre>\n\n<p>I was expecting to get a similar output to (not sure if the <code>import</code> statement would go before or after the lone 2nd comment line)</p>\n\n<pre><code>// some comment goes here\npackage main\n\n// some comment here.\nimport package/path\n\n// main comment here.\nfunc main() {\n}\n</code></pre>\n\n<p>In more complex program, the output is broken. I get scrambled go code such as</p>\n\n<pre><code>// some comment goes here\npackage main\n\nimport // some comment here.\npackage/path\n\n// main comment here.\nfunc main() {\n}\n</code></pre>\n"}, {"tags": ["go", "synchronization", "race-condition", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1574253122, "post_id": 58954237, "comment_id": 104164586, "body": "Yes WaitGroup provides synchronization. Variables shared between goroutines can\u2019t be stack allocated, they must escape to the heap."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574254013, "post_id": 58954237, "comment_id": 104165113, "body": "@JimB is than an answer or a comment? And, if it is an answer, could you please provide some source / reference backing that statement?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1574255563, "post_id": 58954237, "comment_id": 104166081, "body": "Also note that there are no &quot;on stack&quot; or &quot;on heap&quot; variables in Go. While technically there is a stack and a heap Go as the language makes absolutely no claim about this: All variables are equal. Also There is zero need to think about CPUs, cores or threads. Your code is either correct or not (your&#39;s is). All that stack/heap, CPU/core/thread stuff is handled by the compiler."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574255568, "post_id": 58954237, "comment_id": 104166083, "body": "@Volker what is triviality? How <code>WaitGroup</code> works? If yes, then I agree, it&#39;s trivial. However, the question is about something else,... and not about how <code>WaitGroup</code> works,... The question is about safety of shared variables (there are caches involved, and other factors,... ), which doesn&#39;t always need to be immediately in synchronized states among different threads/cores/cpus."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1574255995, "post_id": 58954237, "comment_id": 104166339, "body": "&quot;there are caches involved, and other factors,... &quot;, No there are not. CPU caches and that like is abstracted away by Go the language. See the Go Memory Model. Several things ensure a happens-before relation and package sync is one of them (channel send/receives an other). From a Go perspective there simply is nether a stack variable nor a CPU cache. If there is a HB relation between write and read you will read what you wrote. Dead simple. The whole raison-d&#39;etre of Go is to get rid of the nasty details."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1574256254, "post_id": 58954237, "comment_id": 104166470, "body": "To put it another way, a <code>WaitGroup</code> wouldn&#39;t be of much use if it didn&#39;t actually work. The <code>WaitGroup</code> here is to ensure that <code>a, b = a+1, b+1</code> has executed, so there&#39;s no reason to assume it hasn&#39;t."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1574259547, "post_id": 58954237, "comment_id": 104168540, "body": "The title asks one question, the body asks four more different questions. Please limit posts to focus on one question per post."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1574262956, "post_id": 58954237, "comment_id": 104170731, "body": "I&#39;m sorry you feel that way. I&#39;m trying to help you craft a question that can be effectively answered. You can take or leave that advice, but if you want to get a good answer from the community, you might want to consider it."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574263138, "post_id": 58954237, "comment_id": 104170864, "body": "@Adrian can you please phrase these four more different questions? From my PoV, these questions are just different phrasing of the title, or they mention possible edge-cases,... However, the primary question is still the same: if I use WaitGroup and write to stack variables, then is safety guaranteed?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574263912, "post_id": 58954237, "comment_id": 104171400, "body": "As @JimB noted, if a value is shared between goroutines, it cannot be stack-allocated, so the question is moot (see <a href=\"https://stackoverflow.com/questions/51489323/how-are-go-closures-layed-out-in-memory\" title=\"how are go closures layed out in memory\">stackoverflow.com/questions/51489323/&hellip;</a>). <code>WaitGroup</code> works correctly."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574264156, "post_id": 58954237, "comment_id": 104171543, "body": "@Adrian that&#39;s actually part of the correct answer, a clarification, because I didn&#39;t know those variables would turn to be a heap allocated memory. And, where are these <i>four different</i> questions in the body, as you&#39;ve stated before?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574264322, "post_id": 58954237, "comment_id": 104171647, "body": "They&#39;re easily spotted by the question marks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574264322, "post_id": 58954237, "comment_id": 104171648, "body": "To answer some of the other questions, no the <code>-race</code> detector is not a guarantee that there are no possible data races, just that none happened during execution. You have no control over if the goroutine is on another core, or another socket; the guarantees you have are laid out by the go memory model, which is well documented."}, {"owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574264590, "post_id": 58954237, "comment_id": 104171810, "body": "@JimB can you please answer the question with references to documentation you&#39;re stating? I would like to read it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574264788, "post_id": 58954237, "comment_id": 104171936, "body": "<a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">golang.org/ref/mem</a>"}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 2, "last_activity_date": 1574293262, "creation_date": 1574293262, "answer_id": 58965078, "question_id": 58954237, "link": "https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur/58965078#58965078", "title": "Is it safe to write to on-stack variables from different go routine blocking current one with WaitGroup?", "body": "<p>JimB should perhaps provide this as the answer, but I'll copy it from <a href=\"https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur#comment104171648_58954237\">his</a> <a href=\"https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur#comment104171936_58954237\">comments</a>, starting with <a href=\"https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur#comment104166470_58954237\">this one</a>:</p>\n\n<blockquote>\n  <p>The <code>WaitGroup</code> here is to ensure that <code>a, b = a+1, b+1</code> has executed, so there's no reason to assume it hasn't.</p>\n</blockquote>\n\n<p>[and]</p>\n\n<blockquote>\n  <p>[T]he guarantees you have are laid out by the go memory model, which is well documented [<a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">here</a>].  [Specifically, the combination of <code>wg.Done()</code> and <code>wg.Wait()</code> in the example suffices to guarantee non-racy access to the two variables <code>a</code> and <code>b</code>.]</p>\n</blockquote>\n\n<p>As long as this question exists, it's probably a good idea to copy <a href=\"https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur#comment104171400_58954237\">Adrian's comment</a> too:</p>\n\n<blockquote>\n  <p>As @JimB noted, if a value is shared between goroutines, it cannot be stack-allocated, so the question is moot (see <a href=\"https://stackoverflow.com/questions/51489323/how-are-go-closures-layed-out-in-memory\">How are Go closures layed out in memory?</a>). WaitGroup works correctly.</p>\n</blockquote>\n\n<p>The fact that closure variables are heap-allocated is an implementation detail: it might not be true in the future.  But the <code>sync.WaitGroup</code> guarantee <em>will</em> still be true in the future, even if some clever future Go compiler is able to keep those variables on some stack.</p>\n\n<p>(\"Which stack?\" is another question entirely, but one for the hypothetical future clever Go compiler to answer.  The <code>WaitGroup</code> and memory model provide the rules.)</p>\n"}], "owner": {"reputation": 9300, "user_id": 409102, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/060588f22d2a4c5e049156f23fcf1405?s=128&d=identicon&r=PG", "display_name": "kravemir", "link": "https://stackoverflow.com/users/409102/kravemir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58965078, "answer_count": 1, "score": -2, "last_activity_date": 1574293262, "creation_date": 1574252448, "question_id": 58954237, "link": "https://stackoverflow.com/questions/58954237/is-it-safe-to-write-to-on-stack-variables-from-different-go-routine-blocking-cur", "title": "Is it safe to write to on-stack variables from different go routine blocking current one with WaitGroup?", "body": "<p>There are various task executors, with different properties, and some of them only support non-blocking calls. So, I was thinking, whether there's a need to use mutex/channel to safely deliver task results to calling go-routine, or whether is it enough simple <code>WaitGroup</code>?</p>\n\n<p>For sake of simplicity, and specificity of the question, an example using very naive task executor launching function directly as go routine:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func TestRace(t *testing.T) {\n    var wg sync.WaitGroup\n\n    a, b := 1, 2\n\n    wg.Add(1)\n\n    // this func would be passed to real executor\n    go func() {\n        a, b = a+1, b+1\n        wg.Done()\n    }()\n\n    wg.Wait()\n\n    assert.Equal(t, a, 2)\n    assert.Equal(t, b, 3)\n}\n</code></pre>\n\n<p>Execution of the test above with <code>-race</code> option didn't fail, on my machine. However, is that enough guarantee? What if go-routine is executed on different CPU core, or on CPU core block (AMD CCX), or on different CPU in multi-socket setups?</p>\n\n<p>So, the question is, can I use <code>WaitGroup</code> to provide synchronization (block and return values) for non-blocking executors?</p>\n"}, {"tags": ["git", "go", "circleci", "go-packages"], "comments": [{"owner": {"reputation": 7437, "user_id": 375721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nosh5.png?s=128&g=1", "display_name": "martins", "link": "https://stackoverflow.com/users/375721/martins"}, "edited": false, "score": 0, "creation_date": 1574250864, "post_id": 58953315, "comment_id": 104163282, "body": "<code>go get -v go: finding github.com&#47;acme&#47;project v0.0.3 go: github.com&#47;acme&#47;project@v0.0.3: unknown revision v0.0.3 go: error loading module requirements </code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1574252051, "post_id": 58953315, "comment_id": 104163942, "body": "Why on earth would &quot;github.com/acme/project&quot; require &quot;github.com/acme/project&quot;? A module cannot require itself; not in any version."}, {"owner": {"reputation": 7437, "user_id": 375721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nosh5.png?s=128&g=1", "display_name": "martins", "link": "https://stackoverflow.com/users/375721/martins"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574253612, "post_id": 58953315, "comment_id": 104164883, "body": "Sorry, by mistake I replaced both the real project name and library name as <code>project</code>. I&#39;ve updated the post now."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1574260149, "post_id": 58953315, "comment_id": 104168918, "body": "If you can&#39;t <code>git ls-remote</code> from the container, it seems the issue is not with go modules, but with your github authentication."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 12406209, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB7P4N4Da8vGCU-HNe_3urOQse1z1OAvbINywEgfQ=k-s128", "display_name": "abh", "link": "https://stackoverflow.com/users/12406209/abh"}, "is_accepted": true, "score": 1, "last_activity_date": 1574279203, "creation_date": 1574279203, "answer_id": 58962236, "question_id": 58953315, "link": "https://stackoverflow.com/questions/58953315/im-unable-to-clone-from-multiple-repos-on-circleci/58962236#58962236", "title": "I&#39;m unable to clone from multiple repos on CircleCi", "body": "<p>You need to configure Circle CI to be able to read additional private repositories: <a href=\"https://circleci.com/docs/2.0/gh-bb-integration/#enable-your-project-to-check-out-additional-private-repositories\" rel=\"nofollow noreferrer\">https://circleci.com/docs/2.0/gh-bb-integration/#enable-your-project-to-check-out-additional-private-repositories</a> ?</p>\n\n<p>To be able to create reproducible builds, have you considered vendoring in /acme/project: <a href=\"https://tip.golang.org/cmd/go/#hdr-Modules_and_vendoring\" rel=\"nofollow noreferrer\">https://tip.golang.org/cmd/go/#hdr-Modules_and_vendoring</a> ?</p>\n"}], "owner": {"reputation": 7437, "user_id": 375721, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/nosh5.png?s=128&g=1", "display_name": "martins", "link": "https://stackoverflow.com/users/375721/martins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 58962236, "answer_count": 1, "score": -2, "last_activity_date": 1574325874, "creation_date": 1574249385, "last_edit_date": 1574325874, "question_id": 58953315, "link": "https://stackoverflow.com/questions/58953315/im-unable-to-clone-from-multiple-repos-on-circleci", "title": "I&#39;m unable to clone from multiple repos on CircleCi", "body": "<p>I'm unable to download my newly released go package from CircleCi. Locally it works.\nI'm able to verify that the tag I'm trying to use is available by visiting \n<a href=\"https://github.com/acme/my-lib/tree/v0.0.3\" rel=\"nofollow noreferrer\">https://github.com/acme/my-lib/tree/v0.0.3</a></p>\n\n<p>However, <code>go get</code> will not download it.</p>\n\n<p>I have <code>GOPRIVATE=github.com/acme/</code>  I've also tried with <code>github.com/acme/*</code> also, the same result.</p>\n\n<p>Running <code>go get</code> returns this</p>\n\n<pre><code>go: finding github.com/acme/my-lib v0.0.3\ngo: github.com/acme/my-lib@v0.0.3: unknown revision v0.0.3\ngo: error loading module requirements\n</code></pre>\n\n<p>go.mod</p>\n\n<pre><code>module github.com/acme/project\n\nrequire (\n          github.com/acme/my-lib v0.0.3\n)\n</code></pre>\n\n<p>Why doesn't go recognize my tagged release when running from CircleCi`</p>\n\n<p>I have also tried changing my <code>.git/config</code>:</p>\n\n<pre><code>[remote \"origin\"]\n        # url = git@github.com:acme/my-lib.git\n        url = https://github.com/acme/my-lib.git\n</code></pre>\n\n<p>Neither https or ssh works.</p>\n\n<p><strong>git ls-remote from desktop</strong></p>\n\n<pre><code>git ls-remote https://github.com/acme/my-lib | ack v0.0.3\n$SHA        refs/tags/v0.0.3\n</code></pre>\n\n<p><strong>git ls-remote from circleci</strong></p>\n\n<pre><code>git ls-remote https://github.com/acme/my-lib | grep v0.0.3\nERROR: Repository not found.\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n</code></pre>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1574328293, "post_id": 58953402, "comment_id": 104196467, "body": "oh wow what an idiot I am! I totally missed that \ud83e\udd26\ud83c\udffc\u200d\u2642\ufe0fthank you for pointing that out to me!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1574249630, "creation_date": 1574249630, "answer_id": 58953402, "question_id": 58953213, "link": "https://stackoverflow.com/questions/58953213/go-code-is-reporting-incorrect-underlying-array-for-an-updated-slice/58953402#58953402", "title": "Go code is reporting incorrect underlying array for an updated slice?", "body": "<p>That's because after the append you use the data pointer from the updated slice header, but you still convert the data pointer to <code>*[4]int</code>, a pointer to an array with length=4. What length other than 4 could it have?</p>\n\n<p>Doing so is OK, but you will only be able to access the first 4 elements of the underlying bigger array. Instead use <code>[8]int</code>:</p>\n\n<pre><code>data2 := *(*[8]int)(unsafe.Pointer(hdr.Data))\nfmt.Printf(\"data: %#v\\n\", data2) // [8]int{1, 2, 3, 4, 5, 0, 0, 0}\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/1f8dhsbFRtc\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>data: [8]int{1, 2, 3, 4, 5, 0, 0, 0}\n</code></pre>\n"}], "owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 58953402, "answer_count": 1, "score": -1, "last_activity_date": 1574249630, "creation_date": 1574249066, "question_id": 58953213, "link": "https://stackoverflow.com/questions/58953213/go-code-is-reporting-incorrect-underlying-array-for-an-updated-slice", "title": "Go code is reporting incorrect underlying array for an updated slice?", "body": "<p>I have the following code (<a href=\"https://play.golang.org/p/lkq1RNP_z_O\" rel=\"nofollow noreferrer\">Go Playground Example</a>) which defines a slice (internally this will create an array and have the slice's pointer set to the array location in memory) and then appends a new value to it...</p>\n\n<pre><code>s := []int{1, 2, 3, 4}\n\nhdr := (*reflect.SliceHeader)(unsafe.Pointer(&amp;s))\ndata := *(*[4]int)(unsafe.Pointer(hdr.Data))\n\nfmt.Printf(\"slice:  %T\\n\\t%#v\\n\\tlen: %d\\n\\tcap: %d\\n\", s, s, len(s), cap(s))\nfmt.Printf(\"hdr: %#v\\n\", hdr)   // &amp;reflect.SliceHeader{Data:0x40e020, Len:4, Cap:4}\nfmt.Printf(\"data: %#v\\n\", data) // [4]int{1, 2, 3, 4}\n\ns = append(s, 5)\n\nhdr = (*reflect.SliceHeader)(unsafe.Pointer(&amp;s))\ndata = *(*[4]int)(unsafe.Pointer(hdr.Data))\n\nfmt.Printf(\"slice:  %T\\n\\t%#v\\n\\tlen: %d\\n\\tcap: %d\\n\", s, s, len(s), cap(s))\nfmt.Printf(\"hdr: %#v\\n\", hdr)   // &amp;reflect.SliceHeader{Data:0x45e020, Len:5, Cap:8}\nfmt.Printf(\"data: %#v\\n\", data) // [4]int{1, 2, 3, 4}\n</code></pre>\n\n<p>The problem I have with this code is the last line which indicates that although appending a new value will cause the underlying array to be recreated (as it needs to be resized), the value reported by the <code>data</code> variable appears to show the <em>original</em> array content (e.g. it has a length of 4) and not the updated content.</p>\n\n<p>This is even though the <code>SliceHeader</code> that we're pulling the <code>Data</code> field from is showing the length of the underlying array as having the expected <em>updated</em> length of 5?</p>\n\n<p>What am I missing here. Why would this final line not print something like <code>[8]int{1, 2, 3, 4, 5, 0, 0, 0}</code>.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "edited": false, "score": 0, "creation_date": 1574252132, "post_id": 58953006, "comment_id": 104163988, "body": "can you upload the full source of your test somewhere?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1574252191, "post_id": 58953006, "comment_id": 104164011, "body": "Is <code>repository.proto</code> somewhere in your include path?"}, {"owner": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1574254433, "post_id": 58953006, "comment_id": 104165356, "body": "@colminator yes"}, {"owner": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "reply_to_user": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "edited": false, "score": 0, "creation_date": 1574254862, "post_id": 58953006, "comment_id": 104165622, "body": "@MarcoPantaleoni <a href=\"https://drive.google.com/drive/folders/1E5cQtDmbruqJdnfDnVyLwzkV8YOhYNFj?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/drive/folders/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "edited": false, "score": 0, "creation_date": 1574370739, "post_id": 58955440, "comment_id": 104220159, "body": "that worked, but i had gRPC command in server as well, but it wasn&#39;t getting imported thats why i used grpc, i know it may be irrelevent to the question but what is so much different b/w grpc and gRPC ?"}, {"owner": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "reply_to_user": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "edited": false, "score": 0, "creation_date": 1574429067, "post_id": 58955440, "comment_id": 104240732, "body": "@whishky not sure, maybe there are multiple paths in protoc/protoc-gen-go that consider the plugins value, where in some it&#39;s considered in a case-insensitive way, and not in others, but this is only a wild guess."}], "tags": [], "owner": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "is_accepted": true, "score": 3, "last_activity_date": 1574256260, "creation_date": 1574256260, "answer_id": 58955440, "question_id": 58953006, "link": "https://stackoverflow.com/questions/58953006/registerservice-and-handler-methods-are-not-getting-generate-grpc-and-go/58955440#58955440", "title": "RegisterService and handler methods are not getting generate gRPC and go", "body": "<p>The problem is caused by the use of <code>gRPC</code> instead of <code>grpc</code> in the <code>protoc</code> command-line. Try with:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ protoc -I$GOPATH/src --go_out=plugins=grpc:$GOPATH/src PATH_TO_PROTO_FILE\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 6021141, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-HYxHwhV_pCY/AAAAAAAAAAI/AAAAAAAAC7U/c14EUCgteQg/photo.jpg?sz=128", "display_name": "Marvin Collins", "link": "https://stackoverflow.com/users/6021141/marvin-collins"}, "is_accepted": false, "score": 0, "last_activity_date": 1614719929, "creation_date": 1614719929, "answer_id": 66447310, "question_id": 58953006, "link": "https://stackoverflow.com/questions/58953006/registerservice-and-handler-methods-are-not-getting-generate-grpc-and-go/66447310#66447310", "title": "RegisterService and handler methods are not getting generate gRPC and go", "body": "<p>For anyone who is still facing a problem with this issue. Apparently, Plugins are no longer supported. You can use <code>--go-grpc_out=path_to_out</code> instead of <code>go_out=plugins=grpc:path_to_out</code></p>\n<p>Full example <code>protoc -I. --go-grpc_out=. path_to_proto_file</code> This will generate all the functions and methods</p>\n"}], "owner": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 58955440, "answer_count": 2, "score": 3, "last_activity_date": 1614719929, "creation_date": 1574248377, "question_id": 58953006, "link": "https://stackoverflow.com/questions/58953006/registerservice-and-handler-methods-are-not-getting-generate-grpc-and-go", "title": "RegisterService and handler methods are not getting generate gRPC and go", "body": "<p>I was trying to implement an example from internet for gRPC integration with go. \n<a href=\"https://dzone.com/articles/writing-a-microservice-in-golang-which-communicate\" rel=\"nofollow noreferrer\">https://dzone.com/articles/writing-a-microservice-in-golang-which-communicate</a></p>\n\n<p>So in the generated file there are no RegisterServer methods not the handler for the methods inside services.</p>\n\n<p>my repository-service.proto file</p>\n\n<pre><code>\npackage service;\n\noption go_package = \"grpc_test/internal/gRPC/service\";\n\nimport \"grpc_test/internal/proto-files/domain/repository.proto\";\n\n//RepositoryService Definition\nservice RepositoryService {\n    rpc add (domain.Repository) returns (AddRepositoryResponse);\n}\n\nmessage AddRepositoryResponse {\n    domain.Repository addedRepository = 1;\n    Error error = 2;\n}\nmessage Error {\n    string code = 1;\n    string message = 2;\n}\n</code></pre>\n\n<p>the generated .pb.go file</p>\n\n<pre><code>// source: grpc_test/internal/proto-files/service/repository-service.proto\n\npackage service\n\nimport (\n    fmt \"fmt\"\n    proto \"github.com/golang/protobuf/proto\"\n    domain \"grpc_test/internal/gRPC/domain\"\n    math \"math\"\n)\n\n// Reference imports to suppress errors if they are not otherwise used.\nvar _ = proto.Marshal\nvar _ = fmt.Errorf\nvar _ = math.Inf\n\n// This is a compile-time assertion to ensure that this generated file\n// is compatible with the proto package it is being compiled against.\n// A compilation error at this line likely means your copy of the\n// proto package needs to be updated.\nconst _ = proto.ProtoPackageIsVersion3 // please upgrade the proto package\n\ntype AddRepositoryResponse struct {\n    AddedRepository      *domain.Repository `protobuf:\"bytes,1,opt,name=addedRepository,proto3\" json:\"addedRepository,omitempty\"`\n    Error                *Error             `protobuf:\"bytes,2,opt,name=error,proto3\" json:\"error,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{}           `json:\"-\"`\n    XXX_unrecognized     []byte             `json:\"-\"`\n    XXX_sizecache        int32              `json:\"-\"`\n}\n\nfunc (m *AddRepositoryResponse) Reset()         { *m = AddRepositoryResponse{} }\nfunc (m *AddRepositoryResponse) String() string { return proto.CompactTextString(m) }\nfunc (*AddRepositoryResponse) ProtoMessage()    {}\nfunc (*AddRepositoryResponse) Descriptor() ([]byte, []int) {\n    return fileDescriptor_621a2418b03aa6f6, []int{0}\n}\n\nfunc (m *AddRepositoryResponse) XXX_Unmarshal(b []byte) error {\n    return xxx_messageInfo_AddRepositoryResponse.Unmarshal(m, b)\n}\nfunc (m *AddRepositoryResponse) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) {\n    return xxx_messageInfo_AddRepositoryResponse.Marshal(b, m, deterministic)\n}\nfunc (m *AddRepositoryResponse) XXX_Merge(src proto.Message) {\n    xxx_messageInfo_AddRepositoryResponse.Merge(m, src)\n}\nfunc (m *AddRepositoryResponse) XXX_Size() int {\n    return xxx_messageInfo_AddRepositoryResponse.Size(m)\n}\nfunc (m *AddRepositoryResponse) XXX_DiscardUnknown() {\n    xxx_messageInfo_AddRepositoryResponse.DiscardUnknown(m)\n}\n\nvar xxx_messageInfo_AddRepositoryResponse proto.InternalMessageInfo\n\nfunc (m *AddRepositoryResponse) GetAddedRepository() *domain.Repository {\n    if m != nil {\n        return m.AddedRepository\n    }\n    return nil\n}\n\nfunc (m *AddRepositoryResponse) GetError() *Error {\n    if m != nil {\n        return m.Error\n    }\n    return nil\n}\n\ntype Error struct {\n    Code                 string   `protobuf:\"bytes,1,opt,name=code,proto3\" json:\"code,omitempty\"`\n    Message              string   `protobuf:\"bytes,2,opt,name=message,proto3\" json:\"message,omitempty\"`\n    XXX_NoUnkeyedLiteral struct{} `json:\"-\"`\n    XXX_unrecognized     []byte   `json:\"-\"`\n    XXX_sizecache        int32    `json:\"-\"`\n}\n\nfunc (m *Error) Reset()         { *m = Error{} }\nfunc (m *Error) String() string { return proto.CompactTextString(m) }\nfunc (*Error) ProtoMessage()    {}\nfunc (*Error) Descriptor() ([]byte, []int) {\n    return fileDescriptor_621a2418b03aa6f6, []int{1}\n}\n\nfunc (m *Error) XXX_Unmarshal(b []byte) error {\n    return xxx_messageInfo_Error.Unmarshal(m, b)\n}\nfunc (m *Error) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) {\n    return xxx_messageInfo_Error.Marshal(b, m, deterministic)\n}\nfunc (m *Error) XXX_Merge(src proto.Message) {\n    xxx_messageInfo_Error.Merge(m, src)\n}\nfunc (m *Error) XXX_Size() int {\n    return xxx_messageInfo_Error.Size(m)\n}\nfunc (m *Error) XXX_DiscardUnknown() {\n    xxx_messageInfo_Error.DiscardUnknown(m)\n}\n\nvar xxx_messageInfo_Error proto.InternalMessageInfo\n\nfunc (m *Error) GetCode() string {\n    if m != nil {\n        return m.Code\n    }\n    return \"\"\n}\n\nfunc (m *Error) GetMessage() string {\n    if m != nil {\n        return m.Message\n    }\n    return \"\"\n}\n\nfunc init() {\n    proto.RegisterType((*AddRepositoryResponse)(nil), \"service.AddRepositoryResponse\")\n    proto.RegisterType((*Error)(nil), \"service.Error\")\n}\n\nfunc init() {\n    proto.RegisterFile(\"grpc_test/internal/proto-files/service/repository-service.proto\", fileDescriptor_621a2418b03aa6f6)\n}\n\nvar fileDescriptor_621a2418b03aa6f6 = []byte{\n    // 248 bytes of a gzipped FileDescriptorProto\n    0x1f, 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xff, 0xe2, 0xb2, 0x4f, 0x2f, 0x2a, 0x48,\n    0x8e, 0x2f, 0x49, 0x2d, 0x2e, 0xd1, 0xcf, 0xcc, 0x2b, 0x49, 0x2d, 0xca, 0x4b, 0xcc, 0xd1, 0x2f,\n    0x28, 0xca, 0x2f, 0xc9, 0xd7, 0x4d, 0xcb, 0xcc, 0x49, 0x2d, 0xd6, 0x2f, 0x4e, 0x2d, 0x2a, 0xcb,\n    0x4c, 0x4e, 0xd5, 0x2f, 0x4a, 0x2d, 0xc8, 0x2f, 0xce, 0x2c, 0xc9, 0x2f, 0xaa, 0xd4, 0x85, 0x0a,\n    0xe9, 0x81, 0x95, 0x09, 0xb1, 0x43, 0xb9, 0x52, 0x66, 0x04, 0x4c, 0x4a, 0xc9, 0xcf, 0x4d, 0xcc,\n    0xcc, 0x43, 0x32, 0x08, 0x62, 0x80, 0x52, 0x35, 0x97, 0xa8, 0x63, 0x4a, 0x4a, 0x10, 0x5c, 0x38,\n    0x28, 0xb5, 0xb8, 0x20, 0x3f, 0xaf, 0x38, 0x55, 0xc8, 0x86, 0x8b, 0x3f, 0x31, 0x25, 0x25, 0x15,\n    0x49, 0x4a, 0x82, 0x51, 0x81, 0x51, 0x83, 0xdb, 0x48, 0x48, 0x0f, 0x62, 0x96, 0x1e, 0x92, 0x26,\n    0x74, 0xa5, 0x42, 0x2a, 0x5c, 0xac, 0xa9, 0x45, 0x45, 0xf9, 0x45, 0x12, 0x4c, 0x60, 0x3d, 0x7c,\n    0x7a, 0x30, 0x67, 0xbb, 0x82, 0x44, 0x83, 0x20, 0x92, 0x4a, 0xa6, 0x5c, 0xac, 0x60, 0xbe, 0x90,\n    0x10, 0x17, 0x4b, 0x72, 0x7e, 0x4a, 0x2a, 0xd8, 0x06, 0xce, 0x20, 0x30, 0x5b, 0x48, 0x82, 0x8b,\n    0x3d, 0x37, 0xb5, 0xb8, 0x38, 0x31, 0x3d, 0x15, 0x6c, 0x08, 0x67, 0x10, 0x8c, 0x6b, 0xe4, 0xc7,\n    0x25, 0x88, 0xb0, 0x2a, 0x18, 0x62, 0xb0, 0x90, 0x25, 0x17, 0x73, 0x62, 0x4a, 0x8a, 0x10, 0x16,\n    0xd7, 0x49, 0xc9, 0xc1, 0x6d, 0xc7, 0xea, 0x55, 0x27, 0xc5, 0x28, 0x79, 0x2c, 0xa1, 0x97, 0x1e,\n    0x14, 0xe0, 0x0c, 0x8b, 0x80, 0x24, 0x36, 0x70, 0x68, 0x19, 0x03, 0x02, 0x00, 0x00, 0xff, 0xff,\n    0x27, 0x43, 0x03, 0x2a, 0xb1, 0x01, 0x00, 0x00,\n}\n</code></pre>\n\n<p>Ideally it should have \"RegisterRepositoryServiceServer\" method but it's not getting generated, seems like i have missed something during installation.</p>\n\n<p>Command for generating stub is </p>\n\n<p><code>protoc -I $GOPATH/src --go_out=plugins=gRPC:$GOPATH/src $GOPATH/src/path to .proto file</code></p>\n\n<p>Any help will be appreciated. thanks</p>\n"}, {"tags": ["go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 4, "last_activity_date": 1574248854, "creation_date": 1574248854, "answer_id": 58953152, "question_id": 58952868, "link": "https://stackoverflow.com/questions/58952868/golang-slice-defaults-confusion-in-lower-bound-and-upper-bound/58953152#58953152", "title": "GoLang Slice defaults confusion in lower bound and upper bound", "body": "<p>A slice refers to an underlying array. Re-slicing a slice has no effect on the underlying array.</p>\n\n<p>The offsets in the slice expression (i.e. the 0 in <code>[0:4]</code>) refers to the start of the <em>slice</em>, not the start of the <em>array</em>. Consequently you cannot \"go back\" to earlier values of the array after they have been sliced out. To do that you have to keep an earlier slice value around.</p>\n\n<p>Here is the progression of which part of the underlying array (denoted by square brackets) can be \"seen\" through the slice (denoted by curly braces):</p>\n\n<pre><code>initial:  [{2,  3,  5 , 7,  11, 13}]\ns=s[0:4]: [{2,  3,  5 , 7}, 11, 13 ]\ns=s[1:4]: [ 2, {3,  5 , 7}, 11, 13 ]\ns=s[:2]:  [ 2, {3,  5}, 7,  11, 13 ]\ns=s[1:]:  [ 2,  3, {5}, 7,  11, 13 ]\ns=s[:]:   [ 2,  3, {5}, 7,  11, 13 ] // no-op\ns=s[0:4]: [ 2,  3, {5 , 7,  11, 13}]\n</code></pre>\n\n<p>Note how the array stays the same and the left curly brace only moves to the right (if at all).</p>\n\n<p>For further details see <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">\"Go Slices: usage and internals\"</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 9106111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd738d66a94bab3e75847de116dd1a7?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep gaur", "link": "https://stackoverflow.com/users/9106111/sandeep-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1574769895, "creation_date": 1574247962, "last_edit_date": 1574769895, "question_id": 58952868, "link": "https://stackoverflow.com/questions/58952868/golang-slice-defaults-confusion-in-lower-bound-and-upper-bound", "title": "GoLang Slice defaults confusion in lower bound and upper bound", "body": "<pre><code>package main\nimport \"fmt\"\nfunc main() {\n    s := []int{2, 3, 5, 7, 11, 13}\n\n    s=s[0:4]\n    fmt.Println(s)  // 1st\n\n    s = s[1:4]\n    fmt.Println(s) // 2nd\n\n    s = s[:2]\n    fmt.Println(s) //3rd\n\n    s = s[1:]\n    fmt.Println(s) // 4th\n\n    s= s[:]\n    fmt.Println(s)  // 5th\n\n    s=s[0:4]\n    fmt.Println(s)  // 6th \n}\n</code></pre>\n\n<p>The out put I am getting is this</p>\n\n<pre><code>[2 3 5 7]\n[3 5 7]\n[3 5]\n[5]\n[5]\n[5 7 11 13]\n\n</code></pre>\n\n<p>why in 3rd out put \nonly 3 5 why not 2 3</p>\n\n<p>suppose if I am going thru this logic\nat each time the slicing goes decreases then :\nwhy last line has out 5 7 11 13.</p>\n\n<p>if suppose the above mentioned logic is wrong then \n: why the last line has output [5 7 11 13] why not starting with 2</p>\n\n<p><a href=\"https://tour.golang.org/moretypes/10\" rel=\"nofollow noreferrer\">Here is the link from where I am going thru</a></p>\n"}, {"tags": ["postgresql", "unit-testing", "go", "mocking", "go-sqlmock"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574247586, "post_id": 58951297, "comment_id": 104161457, "body": "Seems to me that you should use <code>sqlmock.Rows</code> with one row added to them when you want to test <code>QueryRow</code> (<a href=\"https://github.com/DATA-DOG/go-sqlmock/blob/e64ef33e8bdaf17d91e3ecb35b9c1d0e420b3309/expectations_test.go#L175-L176\" rel=\"nofollow noreferrer\">github.com/DATA-DOG/go-sqlmock/blob/&hellip;</a>). Note that this resembles the behaviour of the <code>database&#47;sql</code> package since <code>*sql.DB.QueryRow</code> delegates to <code>*sql.DB.Query</code> to do its job."}, {"owner": {"reputation": 432, "user_id": 6910939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19dd2f303a71a4d4344796b4f640bd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shoba ", "link": "https://stackoverflow.com/users/6910939/shoba"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574254525, "post_id": 58951297, "comment_id": 104165419, "body": "@mkopriva But QueryRow return type is *sql.row ; Query return type is *sql.rows.It throws type exception .."}, {"owner": {"reputation": 432, "user_id": 6910939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19dd2f303a71a4d4344796b4f640bd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shoba ", "link": "https://stackoverflow.com/users/6910939/shoba"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574254682, "post_id": 58951297, "comment_id": 104165513, "body": "func mockRowsToSqlRows(mockRows sqlmock.Rows) *sql.Rows {     db, mock, _ := sqlmock.New()     mock.ExpectQuery(&quot;select&quot;).WillReturnRows(mockRows)     rows, _ := db.Query(&quot;select&quot;)     return rows }"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574254805, "post_id": 58951297, "comment_id": 104165593, "body": "Please update the question and add the code where you&#39;re testing the QueryRow and also the code that results in the &quot;type exception&quot;. Code in comments is unreadable."}], "owner": {"reputation": 432, "user_id": 6910939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19dd2f303a71a4d4344796b4f640bd6f?s=128&d=identicon&r=PG&f=1", "display_name": "Shoba ", "link": "https://stackoverflow.com/users/6910939/shoba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 472, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574243351, "creation_date": 1574243351, "question_id": 58951297, "link": "https://stackoverflow.com/questions/58951297/how-to-mock-db-queryrow-using-sqlmock", "title": "How to mock db.QueryRow using sqlmock", "body": "<p>I created mockrows for sql.rows. I referred this document to create mockrows <a href=\"https://github.com/DATA-DOG/go-sqlmock\" rel=\"nofollow noreferrer\">https://github.com/DATA-DOG/go-sqlmock</a></p>\n\n<p>I need to create mockrow for sql.row (i.e db.QueryRow). I am not able to find any suitable method in sql.mock.<br>\nIs there any way to mock QueryRow using sqlmock?</p>\n"}, {"tags": ["go", "protocol-buffers", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 2329, "user_id": 1363486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d556e3afbb20ad2623b46413d1cb345?s=128&d=identicon&r=PG", "display_name": "Marco Pantaleoni", "link": "https://stackoverflow.com/users/1363486/marco-pantaleoni"}, "is_accepted": false, "score": 0, "last_activity_date": 1574254065, "creation_date": 1574254065, "answer_id": 58954725, "question_id": 58950377, "link": "https://stackoverflow.com/questions/58950377/how-to-wrap-a-proto-message-in-a-go-model/58954725#58954725", "title": "How to wrap a proto message in a go model", "body": "<p>If you want to use the go models as the source of truth, why you do want to use the .proto generated ones for the REST request/response? Is it because you'd like to use <a href=\"https://github.com/src-d/proteus#generate-services\" rel=\"nofollow noreferrer\">proteus service generation</a> (and share the code between REST and gRPC)?</p>\n\n<p>Usually, if you wanted to migrate from REST to gRPC, the most common way probably would be to use <a href=\"https://github.com/grpc-ecosystem/grpc-gateway\" rel=\"nofollow noreferrer\">grpc-gateway</a> (note that since around 1.10.x you can use it <a href=\"https://github.com/grpc-ecosystem/grpc-gateway/pull/947\" rel=\"nofollow noreferrer\">in-process without resorting to the reverse proxy</a>), but this would be \"gRPC-first\", where you derive REST from that, while it seems you want \"REST- first\", since you have your REST APIs already in production. In fact for this reason grpc-gateway probably wouldn't be totally suitable, because it could generate slightly different endpoints from your existing ones. It depends on how much can you afford to break backward compatibility (maybe you could generate a \"v2\" set of APIs and keep the old \"v1\" around for a little while, giving time to existing clients to migrate).</p>\n"}], "owner": {"reputation": 278, "user_id": 5059265, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/7cdc11a3aaae83404ba937ee364f10c5?s=128&d=identicon&r=PG&f=1", "display_name": "whishky", "link": "https://stackoverflow.com/users/5059265/whishky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574254065, "creation_date": 1574240476, "question_id": 58950377, "link": "https://stackoverflow.com/questions/58950377/how-to-wrap-a-proto-message-in-a-go-model", "title": "How to wrap a proto message in a go model", "body": "<p>I am currently working on moving our rest api based go service to gRPC, using protobuf. it's a huge service with a lot of APIs and already in production so i don't want to make so many changes to ruin the existing system.</p>\n\n<p>So i want to use my go models as source of truth, and to generate .proto messages i think i can manage with this - <a href=\"https://stackoverflow.com/questions/38724556/generate-proto-file-from-golang-struct\">Generate proto file from golang struct</a></p>\n\n<p>Now my APIs also expect the request and response according to the defined go models, i will change them to use the .proto models for request and response. but when request/response is passed i want to wrap them in my go models and then the rest of the code doesn't need any changes.</p>\n\n<p>In that case if the request is small i can simply copy all the fields in my go model but in case of big requests or nested models it's a big problem.</p>\n\n<p>1) Am i doing this right way ?</p>\n\n<p>2) No, what's the right way ?</p>\n\n<p>3) Yes, how i can copy the big proto messages to go model and vice-versa for response ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1574238569, "post_id": 58949737, "comment_id": 104156109, "body": "The difference is that <code>i</code>&#39;s type is <code>float32</code> which is a named type, while <code>d</code>&#39;s type is <code>func(string)</code> which is an unnamed type, and assignability rules apply in the second case but not in the first case. See the marked duplicate for details."}, {"owner": {"reputation": 15, "user_id": 12402589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4139e42040424c0d24427a57746e15b?s=128&d=identicon&r=PG&f=1", "display_name": "shuming", "link": "https://stackoverflow.com/users/12402589/shuming"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1574307112, "post_id": 58949737, "comment_id": 104188429, "body": "Thank you for your explanation! @icza I just checked the Go Spec, there is a little update on the second rule.  <i><b>x&#39;s type V and T have identical underlying types and at least one of V or T is not a defined type.</b></i> I am more confused. 1. float32 and myfloat have the identical underlying type. 2. float32 is not a defined type. Why can&#39;t assign i to myfloat?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1574353863, "post_id": 58949737, "comment_id": 104212134, "body": "You wrote: <i>&quot;float32 is not a defined type&quot;</i>. This is not true, <code>float32</code> is a predefined type. So your quoted part from assignability rules don&#39;t apply, that&#39;s why you can&#39;t assign <code>i</code> (of type <code>float32</code>) to a variable of type <code>myfloat</code> (also a named, defined type)."}, {"owner": {"reputation": 15, "user_id": 12402589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4139e42040424c0d24427a57746e15b?s=128&d=identicon&r=PG&f=1", "display_name": "shuming", "link": "https://stackoverflow.com/users/12402589/shuming"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1574646420, "post_id": 58949737, "comment_id": 104293376, "body": "Thank you! named / unamed, defined / non-defined type are not easy to understand for new comers :( This article explains this concept clearly. Post here for others  [link] <a href=\"https://go101.org/article/type-system-overview.html\" rel=\"nofollow noreferrer\">go101.org/article/type-system-overview.html</a>"}], "owner": {"reputation": 15, "user_id": 12402589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4139e42040424c0d24427a57746e15b?s=128&d=identicon&r=PG&f=1", "display_name": "shuming", "link": "https://stackoverflow.com/users/12402589/shuming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1574238494, "answer_count": 0, "score": 1, "last_activity_date": 1574326176, "creation_date": 1574238350, "last_edit_date": 1574326176, "question_id": 58949737, "link": "https://stackoverflow.com/questions/58949737/type-conversion-for-func-type", "closed_reason": "Duplicate", "title": "Type conversion for func type", "body": "<p>I am learning the go basic grammar. The document says \"go doesn\u2019t support the Automatic Type Conversion or Implicit Type Conversion \". I wrote some code to test it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype myfloat float32\n\ntype myfunc func(string)\n\nfunc bbb(a myfloat) {\n    fmt.Printf(\"bbb %T\\n\", a)\n}\n\nfunc ccc(m myfunc) {\n    fmt.Printf(\"ccc %T\\n\", m)\n}\n\nfunc main() {\n    i := float32(1.1)\n    bbb(i) //can't build\n\n    d := func(s string) {}\n    ccc(d)\n}\n</code></pre>\n\n<p>bbb(i) can't build successfully, this is due to the type is different. My question is why ccc(d) can pass build? <strong>myfunc</strong> is also a user defined type, which is similar like the myfloat.</p>\n"}, {"tags": ["mongodb", "go", "docker-compose"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574322537, "post_id": 58948359, "comment_id": 104193376, "body": "Hey and welcome to SO! You wrote a nice first question, imho. You might want to add the <code>authSource</code> URI parameter (or use <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo/options#ClientOptions.SetAuth\" rel=\"nofollow noreferrer\">SetAuth</a> to pass <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo/options#Credential\" rel=\"nofollow noreferrer\">Credentials</a> with <code>AuthSource</code> set accordingly). If we set it explicitly, we ensure that this does not cause any of the problems. Since your root user usually is created in the <code>admin</code> database any according to your init script, your &quot;standard&quot; user is created in <code>&lt;database_name&gt;</code>."}, {"owner": {"reputation": 4572, "user_id": 304371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/xEeQM.jpg?s=128&g=1", "display_name": "Artru", "link": "https://stackoverflow.com/users/304371/artru"}, "edited": false, "score": 0, "creation_date": 1618013281, "post_id": 58948359, "comment_id": 118482361, "body": "<a href=\"https://stackoverflow.com/a/67029598/304371\">stackoverflow.com/a/67029598/304371</a>"}], "owner": {"reputation": 11, "user_id": 12402034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uTNVg.jpg?s=128&g=1", "display_name": "hexterisk", "link": "https://stackoverflow.com/users/12402034/hexterisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574322638, "creation_date": 1574232733, "last_edit_date": 1574322638, "question_id": 58948359, "link": "https://stackoverflow.com/questions/58948359/creating-multiple-access-users-in-mongodb-container", "title": "Creating multiple access users in mongodb container", "body": "<p>I am building a web server in Go and I want to use two different users for different purposes, an admin user and a regular user with r/w access. When I try to authenticate  </p>\n\n<pre><code>client, err := mongo.NewClient(options.Client().ApplyURI(\"mongodb://&lt;username&gt;:&lt;password&gt;@host:port\"))\n</code></pre>\n\n<p>the admin account gets connected, but the regualr user throws an error.\nThe error says:</p>\n\n<pre><code>\"2019/11/20 06:34:58 client is disconnected\nexit status 1\"  \n</code></pre>\n\n<p>The docker-compose file is as follows:</p>\n\n<pre><code>version: \"3.6\"\nservices:\n  mongo:\n    image: mongo\n    container_name: mongo_database\n    ports:\n    - \"27017:27017\"\n    volumes:\n    - ./init-mongo.sh:/docker-entrypoint-initdb.d/init-mongo.sh\n    - ../../db/data-volume:/data/db\n    command: mongod --auth\n    environment:\n      - MONGO_INITDB_ROOT_USERNAME_FILE=/run/secrets/mongo_admin_user\n      - MONGO_INITDB_ROOT_PASSWORD_FILE=/run/secrets/mongo_admin_password\n      - MONGO_INITDB_USERNAME_FILE=/run/secrets/mongo_user\n      - MONGO_INITDB_PASSWORD_FILE=/run/secrets/mongo_password\n      - MONGO_INITDB_DATABASE=admin\n    secrets:\n      - mongo_admin_password\n      - mongo_admin_user\n      - mongo_password\n      - mongo_user\nvolumes:\n  data-volume:\nsecrets:\n  mongo_admin_user:\n          file: ./secrets/mongo_admin_user\n  mongo_admin_password:\n          file: ./secrets/mongo_admin_password\n  mongo_user:\n          file: ./secrets/mongo_user\n  mongo_password:\n          file: ./secrets/mongo_password\n</code></pre>\n\n<p>And the <code>init-mongo.sh</code> is as follows:</p>\n\n<pre><code>mongo -- \"$MONGO_INITDB_DATABASE\" &lt;&lt;EOF\n    var rootUser = '$(cat \"$MONGO_INITDB_ROOT_USERNAME_FILE\")';\n    var rootPassword = '$(cat \"$MONGO_INITDB_ROOT_PASSWORD_FILE\")';\n    db.auth(rootUser, rootPassword);\n    db = db.getSiblingDB(&lt;database_name&gt;);\n\n    var user = '$(cat \"$MONGO_INITDB_USERNAME_FILE\")';\n    var passwd = '$(cat \"$MONGO_INITDB_PASSWORD_FILE\")';\n    db.createUser({user: user, pwd: passwd, roles: 'readWrite'});\nEOF\n</code></pre>\n"}, {"tags": ["mysql", "go", "model", "go-gorm"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1574241171, "post_id": 58947804, "comment_id": 104157530, "body": "dup of <a href=\"https://stackoverflow.com/questions/58889672/calling-model-dynamically-in-go/58889925\" title=\"calling model dynamically in go\">stackoverflow.com/questions/58889672/&hellip;</a> ? in gorm you can do queries like <code>db.Table(&quot;users&quot;).Select(&quot;COALESCE(age,?)&quot;, 42).Rows()</code> or <code>db.Table(&quot;users&quot;).Select(&quot;COALESCE(age,?)&quot;, 42).Find(&amp;users)</code>etc"}, {"owner": {"reputation": 33, "user_id": 12401930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acddd15d1749c2c62609394b973a1a2?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/12401930/coder"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1574243046, "post_id": 58947804, "comment_id": 104158661, "body": "Do we have something like  prod := models.Product{table: &quot;shirts&quot;} db.prod.Select(&quot;COALESCE(age,?)&quot;, 42).Rows()"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1574243342, "post_id": 58947804, "comment_id": 104158826, "body": "have you read the doc ?"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 11900571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3127066989e308d523b778000254c7cb?s=128&d=identicon&r=PG", "display_name": "Dat Ngo", "link": "https://stackoverflow.com/users/11900571/dat-ngo"}, "is_accepted": true, "score": 6, "last_activity_date": 1574614582, "last_edit_date": 1574614582, "creation_date": 1574587050, "answer_id": 59016218, "question_id": 58947804, "link": "https://stackoverflow.com/questions/58947804/how-to-pass-dynamic-table-name-in-gorm-model/59016218#59016218", "title": "How to pass dynamic table name in gorm model", "body": "<p>You're almost there by using <code>table</code> field inside the struct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Product struct{\n  ID int\n  Name strig\n  Quantity int\n\n  // private field, ignored from gorm\n  table string `gorm:\"-\"`\n}\n\nfunc (p Product) TableName() string {\n  // double check here, make sure the table does exist!!\n  if p.table != \"\" {\n    return p.table\n  }\n  return \"products\" // default table name\n}\n\n// for the AutoMigrate\ndb.AutoMigrate(&amp;Product{table: \"jeans\"}, &amp;Product{table: \"skirts\"}, &amp;Product{})\n\n// to do the query\nprod := Product{table: \"jeans\"}\ndb.Where(\"quantity &gt; 0\").First(&amp;prod)\n</code></pre>\n\n<p>Unfortunately, that does not work with <code>db.Find()</code> when you need to query for multiple records... The workaround is to specify your table before doing the query</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>prods := []*Product{}\ndb.Table(\"jeans\").Where(\"quantity &gt; 0\").Find(&amp;prods)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 12401930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3acddd15d1749c2c62609394b973a1a2?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/12401930/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1689, "favorite_count": 1, "accepted_answer_id": 59016218, "answer_count": 1, "score": 2, "last_activity_date": 1574614582, "creation_date": 1574230201, "last_edit_date": 1574232558, "question_id": 58947804, "link": "https://stackoverflow.com/questions/58947804/how-to-pass-dynamic-table-name-in-gorm-model", "title": "How to pass dynamic table name in gorm model", "body": "<p>I am using <strong>Gorm</strong> ORM for my current application. I have one model correspondents to many tables with identical table structures(i.e. column name and type). So my requirement how can I change the table name dynamically while doing the query.</p>\n\n<p>For e.g.</p>\n\n<p>I have product model like Product.go</p>\n\n<pre><code>type Product struct{\n  ID int\n  Name strig\n  Quantity int\n}\n</code></pre>\n\n<p>And we have different products like shirts, jeans and so on and we have same tables like shirts, jeans.</p>\n\n<p>Now I wanted to query the product as per name of the product how can we do that also  want to have table created through migrations. But there is only One model than how can we run use Automigrate feature with Gorm.</p>\n"}, {"tags": ["mongodb", "go", "bson", "mongo-go"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1574221125, "creation_date": 1574221125, "answer_id": 58946293, "question_id": 58944778, "link": "https://stackoverflow.com/questions/58944778/how-to-serialize-nil-pointer-of-structure-with-custom-marshalbsonvalue-into-bson/58946293#58946293", "title": "How to serialize nil pointer of structure with custom MarshalBSONValue into BSON?", "body": "<p>You need to remove the space before omitempty:</p>\n\n<pre><code>type Foo struct {\n    Bar *Bar`bson:\"Bar,omitempty\"`\n}\n</code></pre>\n\n<p>The parser cannot handle \", omitempty\", because the code is as folllows:</p>\n\n<pre><code>for idx, str := range strings.Split(tag, \",\") {\n        if idx == 0 &amp;&amp; str != \"\" {\n            key = str\n        }\n        switch str {\n        case \"omitempty\":\n</code></pre>\n"}], "owner": {"reputation": 1239, "user_id": 5421426, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/96a1eeb26ff88da78645596f42df3735?s=128&d=identicon&r=PG", "display_name": "Dr.Nemo", "link": "https://stackoverflow.com/users/5421426/dr-nemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "accepted_answer_id": 58946293, "answer_count": 1, "score": 0, "last_activity_date": 1574221125, "creation_date": 1574208860, "question_id": 58944778, "link": "https://stackoverflow.com/questions/58944778/how-to-serialize-nil-pointer-of-structure-with-custom-marshalbsonvalue-into-bson", "title": "How to serialize nil pointer of structure with custom MarshalBSONValue into BSON?", "body": "<p>mongodb official golang dirver used in my program.</p>\n\n<pre><code>\npackage main\n\nimport (\n    \"fmt\"\n    \"github.com/pkg/errors\"\n    \"go.mongodb.org/mongo-driver/bson\"\n    \"go.mongodb.org/mongo-driver/bson/bsontype\"\n    \"go.mongodb.org/mongo-driver/x/bsonx\"\n    \"go.mongodb.org/mongo-driver/x/bsonx/bsoncore\"\n    \"log\"\n    \"strconv\"\n)\n\ntype Bar struct {\n    a int64\n}\n\nfunc (b Bar) MarshalBSONValue() (bsontype.Type, []byte, error) {\n    return bsonx.String(fmt.Sprintf(\"%d\", b.a)).MarshalBSONValue()\n}\n\nfunc (b *Bar) UnmarshalBSONValue(t bsontype.Type, data []byte) error {\n    if t != bsontype.String {\n        return errors.Errorf(\"bsontype(%s) not allowed in Bar.UnmarshalBSONValue, only string accept\", t.String())\n    }\n    str, _, ok := bsoncore.ReadString(data)\n    if !ok {\n        return errors.Errorf(\"decode string, but string not found\")\n    }\n\n    dec, err := strconv.ParseInt(str, 10, 64)\n    if err != nil {\n        return err\n    }\n    b = &amp;Bar{a:dec}\n    return nil\n}\n\ntype Foo struct {\n    Bar *Bar`bson:\"Bar, omitempty\"`\n}\n\nfunc main() {\n    f := Foo{}\n    _, err := bson.Marshal(f)\n    if err != nil {\n        log.Fatalf(\"Failed to marshal. Error: %v\", err)\n    }\n}\n\n</code></pre>\n\n<p>this program will panic with error:</p>\n\n<pre><code>panic: value method main.Bar.MarshalBSONValue called using nil *Bar pointer\n\ngoroutine 1 [running]:\nmain.(*Bar).MarshalBSONValue(0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n        &lt;autogenerated&gt;:1 +0x87\nreflect.Value.call(0x11ebc60, 0xc000010330, 0x293, 0x1218915, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n        /usr/local/go/src/reflect/value.go:447 +0x461\n\n</code></pre>\n"}, {"tags": ["database", "go", "redis", "redigo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1574219689, "post_id": 58944679, "comment_id": 104150159, "body": "The error is returned from the net package dial function when there is no listener for the specified address.  There may be other scenarios where this error is returned."}, {"owner": {"reputation": 466, "user_id": 10461720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WEcLo.png?s=128&g=1", "display_name": "D.C. Joo", "link": "https://stackoverflow.com/users/10461720/d-c-joo"}, "edited": false, "score": 2, "creation_date": 1574238562, "post_id": 58944679, "comment_id": 104156103, "body": "How do you run Redis? Can you connect to it using other client?"}, {"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "edited": false, "score": 1, "creation_date": 1574690873, "post_id": 58944679, "comment_id": 104310669, "body": "Is your local redis instance running?"}], "owner": {"reputation": 438, "user_id": 6773878, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/556347854557492/picture?type=large", "display_name": "Trevor Jordy", "link": "https://stackoverflow.com/users/6773878/trevor-jordy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1001, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1574208024, "creation_date": 1574208024, "question_id": 58944679, "link": "https://stackoverflow.com/questions/58944679/redis-connection-received-error-dial-tcp-16379-connect-connection-refus", "title": "Redis connection: Received error &quot;dial tcp [::1]:6379: connect: connection refused&quot; when attempting to Dial with Redigo", "body": "<p>I'm trying to run </p>\n\n<pre><code>conn, err := redis.Dial(\"tcp\", \"localhost:6379\")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>using redis Redigo, the golang driver. I have not changed any configurations or anything. My error is: </p>\n\n<pre><code>go run redisgotest.go\n2019/11/19 15:51:05 dial tcp [::1]:6379: connect: connection refused\nexit status 1\n</code></pre>\n"}, {"tags": ["sockets", "go", "network-programming", "system-calls"], "comments": [{"owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "edited": false, "score": 1, "creation_date": 1574207023, "post_id": 58944184, "comment_id": 104147435, "body": "Probably a mistake when doing the <code>sendto</code> design. The return value is often important. <code>Sendmsg</code> likewise should return the number of bytes sent."}], "answers": [{"tags": [], "owner": {"reputation": 324088, "user_id": 1256452, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fa1648baa6108c85886312af93bb32c0?s=128&d=identicon&r=PG", "display_name": "torek", "link": "https://stackoverflow.com/users/1256452/torek"}, "is_accepted": true, "score": 3, "last_activity_date": 1574214550, "last_edit_date": 1574214550, "creation_date": 1574212596, "answer_id": 58945231, "question_id": 58944184, "link": "https://stackoverflow.com/questions/58944184/why-doesnt-the-sendto-syscall-return-the-number-of-sent-bytes/58945231#58945231", "title": "Why doesn&#39;t the Sendto() syscall return the number of sent bytes?", "body": "<p>It really should\u2014but often, you can get away without it.</p>\n\n<p>I said in a comment that the return value is \"often\" important, but that's probably too strong a claim.  Note that each OS may have subtle differences here; I'm going to describe a traditional behavior from long ago:</p>\n\n<ol>\n<li><p><code>sendto</code> on a stream-type, connected socket (<code>SOCK_STREAM</code> with <code>AF_UNIX</code> or <code>AF_INET</code> etc) is basically the same as <code>send</code>: it loops, sending part of the data, until some interesting event occurs.  Interesting events include, but may not be limited to, these:</p>\n\n<ul>\n<li>all data are sent</li>\n<li>a signal interrupts the sending</li>\n<li>the connection is reset by the other end</li>\n</ul>\n\n<p><br>At this point the <code>sendto</code> call returns.  The return value is <code>-1</code> with error <code>EINTR</code> if <em>no</em> data were sent, or a short count if some data were sent, but not all data.  This behavior is identical to that of the <code>write</code> system call.</p></li>\n<li><p><code>sendto</code> on a stream-type but unconnected socket just fails with <code>ENOTCONN</code>.</p></li>\n<li><p><code>sendto</code> on a connected datagram socket errors with a complaint that it's already connected (<code>EISCONN</code>).</p></li>\n<li><p><code>sendto</code> on an unconnected datagram socket temporarily connects it (for the duration of the call), sends the message as a single datagram and succeeds and returns the sent length, or fails and sends nothing and returns -1 and <code>EMSGSIZE</code> or some other more appropriate error (e.g., if the connect fails or the target host rejects the packet or whatever\u2014though not all of these errors can occur on all protocols).</p></li>\n<li><p><code>sendto</code> on a <code>SOCK_SEQPACKET</code> socket (packetized stream-like entity) acts kind of like <code>SOCK_STREAM</code> except that either the entire message goes as a single packet, or the send fails entirely.</p></li>\n</ol>\n\n<p>So, except for case 1\u2014<code>sendto</code> on a <code>SOCK_STREAM</code> socket that might get interrupted\u2014the return value is always either <code>len</code> or <code>-1</code>.  For case 1, you can just call <code>write</code> instead.  The <code>EINTR</code> case should never happen in normal use in Go, because the Go runtime directs all signals to a dedicated OS-level thread within the process, which means the only time you can get a short return is when some data get sent and then the remote host abruptly closes (and resets) the stream.  Even if <code>EINTR</code> <em>does</em> happen, an OS <code>write</code> will produce the correct return value.</p>\n\n<p>The <code>sendmsg</code> system call is more complicated because it allows for so many flags, and has different return values on different systems.  The BSD documentation says that it returns the number of <em>messages</em> sent while the Linux documentation says that it returns the number of <em>bytes</em> sent.  The various message flags are also rather OS-dependent.  A simple wrapper like the Go one can't really hide these differences easily.  (However, I see the Go library has <a href=\"https://godoc.org/golang.org/x/sys/unix#SendmsgN\" rel=\"nofollow noreferrer\"><code>SendmsgN</code></a> anyway.)</p>\n"}], "owner": {"reputation": 25103, "user_id": 3199595, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TwK8q.png?s=128&g=1", "display_name": "Malt", "link": "https://stackoverflow.com/users/3199595/malt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 58945231, "answer_count": 1, "score": 0, "last_activity_date": 1574326192, "creation_date": 1574204538, "last_edit_date": 1574326192, "question_id": 58944184, "link": "https://stackoverflow.com/questions/58944184/why-doesnt-the-sendto-syscall-return-the-number-of-sent-bytes", "title": "Why doesn&#39;t the Sendto() syscall return the number of sent bytes?", "body": "<p>In Go's standard library, the networking syscall <code>Sendto()</code> looks like this: </p>\n\n<p><a href=\"https://godoc.org/golang.org/x/sys/windows#Sendto\" rel=\"nofollow noreferrer\">Windows</a>:</p>\n\n<p><code>func Sendto(fd Handle, p []byte, flags int, to Sockaddr) (err error)</code></p>\n\n<p><a href=\"https://godoc.org/golang.org/x/sys/unix#Sendto\" rel=\"nofollow noreferrer\">Unix</a>:</p>\n\n<p><code>func Sendto(fd int, p []byte, flags int, to Sockaddr) (err error)</code></p>\n\n<p>However, the underlying system call returns the number of sent bytes on all operating systems (<a href=\"https://linux.die.net/man/2/sendto\" rel=\"nofollow noreferrer\">Linux</a>, <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-sendto#return-value\" rel=\"nofollow noreferrer\">Windows</a>), so why does Go return only an error?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574198886, "post_id": 58942901, "comment_id": 104144556, "body": "You&#39;re modifying <code>sfZoo</code>, then outputing <code>result</code>, so of course you&#39;re not seeing a change."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6063930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed9e8ef1498839e0f50393b6ff98c32?s=128&d=identicon&r=PG&f=1", "display_name": "samoand", "link": "https://stackoverflow.com/users/6063930/samoand"}, "edited": false, "score": 0, "creation_date": 1574201136, "post_id": 58942963, "comment_id": 104145592, "body": "Changing order is not an option in the actual app though. The app needs to access by key and mutate a structure after it&#39;s been entered into a map."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 3, "user_id": 6063930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed9e8ef1498839e0f50393b6ff98c32?s=128&d=identicon&r=PG&f=1", "display_name": "samoand", "link": "https://stackoverflow.com/users/6063930/samoand"}, "edited": false, "score": 0, "creation_date": 1574237151, "post_id": 58942963, "comment_id": 104155501, "body": "anyway, the &quot;order&quot; was not the most important keyword in that answer. Hopeless."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1574199163, "last_edit_date": 1574199163, "creation_date": 1574198375, "answer_id": 58942963, "question_id": 58942901, "link": "https://stackoverflow.com/questions/58942901/failing-to-update-slice-of-maps-in-struct/58942963#58942963", "title": "Failing to update slice of maps in struct", "body": "<p>Because <code>sfZoo</code> is value, it is being copied to <code>result</code> before it is modified by <code>addAnimalData</code>. If you call for <code>addAnimalData</code> first, then set <code>result</code>, you will get the expected output.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Zoo struct {\n    Animals []map[string]string\n}\n\nfunc (zoo *Zoo) addAnimalData(el map[string]string) {\n    zoo.Animals = append(zoo.Animals, el)\n}\n\n\nfunc main() {\n    result := make(map[string]Zoo)\n    sfZoo := Zoo{\n        Animals: make([]map[string]string, 0),\n    }\n\n    animals := make(map[string]string)\n    animals[\"elephant\"] = \"Vegetarian\"\n    animals[\"bear\"] = \"Omnivore\"\n    sfZoo.addAnimalData(animals)\n    result[\"San Francisco Zoo\"] = sfZoo\n    jsonified, _ := json.MarshalIndent(result, \"\", \"  \")\n    fmt.Println(string(jsonified))\n}\n</code></pre>\n\n<p>shows</p>\n\n<pre><code>{\n  \"San Francisco Zoo\": {\n    \"Animals\": [\n      {\n        \"bear\": \"Omnivore\",\n        \"elephant\": \"Vegetarian\"\n      }\n    ]\n  }\n}\n\nProgram exited.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 6063930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed9e8ef1498839e0f50393b6ff98c32?s=128&d=identicon&r=PG&f=1", "display_name": "samoand", "link": "https://stackoverflow.com/users/6063930/samoand"}, "edited": false, "score": 0, "creation_date": 1574200686, "post_id": 58942965, "comment_id": 104145398, "body": "This works. I&#39;d think that the copy would work as well because maps/slices are what they used to call &quot;reference types&quot; and there&#39;s a pointer under the hood. Anyways, this works - thanks"}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 2, "last_activity_date": 1574198389, "creation_date": 1574198389, "answer_id": 58942965, "question_id": 58942901, "link": "https://stackoverflow.com/questions/58942901/failing-to-update-slice-of-maps-in-struct/58942965#58942965", "title": "Failing to update slice of maps in struct", "body": "<p>The problem is that you're adding the map to <code>sfZoo</code>, not to the <code>Zoo</code> instance in the result map. When you add <code>sfZoo</code> into the <code>result</code> map, you added a copy of a <code>Zoo</code> instance. When you add new elements to <code>sfZoo</code>, you are adding them to <code>sfZoo.Animals</code>, not to <code>result[\"San Francisco Zoo\"].Animals</code>.</p>\n\n<p>The easiest way to fix it is to declare the result as:</p>\n\n<pre><code>    result := make(map[string]*Zoo)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>    result[\"San Francisco Zoo\"] = &amp;sfZoo\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8949140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ast5Yft_xIg/AAAAAAAAAAI/AAAAAAAAAMc/FBw_HFepAjA/photo.jpg?sz=128", "display_name": "Leo Wilbur", "link": "https://stackoverflow.com/users/8949140/leo-wilbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1574221589, "creation_date": 1574221589, "answer_id": 58946350, "question_id": 58942901, "link": "https://stackoverflow.com/questions/58942901/failing-to-update-slice-of-maps-in-struct/58946350#58946350", "title": "Failing to update slice of maps in struct", "body": "<p>Change into this, I hope that can solve your problems</p>\n\n<p><code>result := make(map[string]*Zoo)</code></p>\n\n<p><code>result[\"San Francisco Zoo\"] = &amp;sfZoo</code></p>\n\n<p>Try it:</p>\n\n<p><a href=\"https://play.golang.org/p/mDYc6orYUfk\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mDYc6orYUfk</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6063930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ed9e8ef1498839e0f50393b6ff98c32?s=128&d=identicon&r=PG&f=1", "display_name": "samoand", "link": "https://stackoverflow.com/users/6063930/samoand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1574221589, "creation_date": 1574198070, "last_edit_date": 1574198188, "question_id": 58942901, "link": "https://stackoverflow.com/questions/58942901/failing-to-update-slice-of-maps-in-struct", "title": "Failing to update slice of maps in struct", "body": "<p>I'm trying to update a slice of maps in a structure. It fails: the slice remains unchanged. Please see the playground: <a href=\"https://play.golang.org/p/FIcLgyj2FE-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/FIcLgyj2FE-</a>\nAny help is much appreciated</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Zoo struct {\n    Animals []map[string]string\n}\n\nfunc (zoo *Zoo) addAnimalData(el map[string]string) {\n    zoo.Animals = append(zoo.Animals, el)\n}\n\n\nfunc main() {\n    result := make(map[string]Zoo)\n    sfZoo := Zoo{\n        Animals: make([]map[string]string, 0),\n    }\n    result[\"San Francisco Zoo\"] = sfZoo\n    animals := make(map[string]string)\n    animals[\"elephant\"] = \"Vegetarian\"\n    animals[\"bear\"] = \"Omnivore\"\n    sfZoo.addAnimalData(animals)\n\n    jsonified, _ := json.MarshalIndent(result, \"\", \"  \")\n    fmt.Println(string(jsonified))\n}\n</code></pre>\n"}, {"tags": ["python", "python-3.x", "performance", "go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 2, "creation_date": 1574193312, "post_id": 58941840, "comment_id": 104142138, "body": "It is very likely because of buffering. Try using a bufio.Writer with the go tests."}, {"owner": {"reputation": 346, "user_id": 3105129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZAH0F.jpg?s=128&g=1", "display_name": "Kamori", "link": "https://stackoverflow.com/users/3105129/kamori"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574193695, "post_id": 58941840, "comment_id": 104142320, "body": "Added an edit with that change. Wow that is much faster than Python. Thank you!"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574194842, "post_id": 58941840, "comment_id": 104142793, "body": "Python output is probably line-buffered. To be fairer, you should flush the buffer for the go test after each line."}], "answers": [{"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 6, "last_activity_date": 1574193403, "creation_date": 1574193403, "answer_id": 58941927, "question_id": 58941840, "link": "https://stackoverflow.com/questions/58941840/why-does-my-python-print-run-faster-than-gos-fmt-print-and-os-stdout-write/58941927#58941927", "title": "Why does my python print run faster than Go&#39;s fmt.Print and os.Stdout.Write", "body": "<p>Python3 buffers the output of <code>print</code>.</p>\n\n<p><a href=\"https://docs.python.org/3/library/functions.html#print\" rel=\"noreferrer\">https://docs.python.org/3/library/functions.html#print</a></p>\n\n<blockquote>\n  <p>Whether output is buffered is usually determined by file, but if the flush keyword argument is true, the stream is forcibly flushed.</p>\n</blockquote>\n\n<p>You would need to do:</p>\n\n<pre><code>print(\"Hello World!\", flush=True)\n</code></pre>\n\n<p>for the tests to be equivalent</p>\n"}], "owner": {"reputation": 346, "user_id": 3105129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZAH0F.jpg?s=128&g=1", "display_name": "Kamori", "link": "https://stackoverflow.com/users/3105129/kamori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 58941927, "answer_count": 1, "score": 2, "last_activity_date": 1574213543, "creation_date": 1574192987, "last_edit_date": 1574213543, "question_id": 58941840, "link": "https://stackoverflow.com/questions/58941840/why-does-my-python-print-run-faster-than-gos-fmt-print-and-os-stdout-write", "title": "Why does my python print run faster than Go&#39;s fmt.Print and os.Stdout.Write", "body": "<p>I'm trying to research some details about efficiency with Go because I'm new to it. One of the tests I wanted to perform was to see if Go's <code>fmt.Print</code> was faster or slower than <code>os.Stdout.WriteLine</code></p>\n\n<p>Here are the results.</p>\n\n<p><strong>fmt.Print speed</strong></p>\n\n<pre><code>[kamori@kamori-pc playground]$ cat print.go \npackage main\n\nimport \"fmt\"\nimport \"os\"\n\nfunc main(){\n   os.Stderr.WriteString(\"Printing Hello World! 1000000000 times\")\n   for i := 0; i &lt; 1000000000; i++{\n       fmt.Print(\"Hello World!\\n\")\n   }\n}\n[kamori@kamori-pc playground]$ go build print.go\n[kamori@kamori-pc playground]$ time ./print &gt;/dev/null\nPrinting Hello World! 1000000000 times\nreal    13m9.127s\nuser    8m52.461s\nsys 4m15.433s\n\n\n</code></pre>\n\n<p><strong>os.Stdout.WriteString</strong></p>\n\n<pre><code>[kamori@kamori-pc playground]$ cat stdoutwrite.go \npackage main\n\nimport \"os\"\n\nfunc main(){\n   os.Stderr.WriteString(\"StdoutWriting Hello World! 1000000000 times\")\n    for i := 0; i &lt; 1000000000; i++{\n       os.Stdout.WriteString(\"Hello World!\\n\")\n   }\n}\n[kamori@kamori-pc playground]$ go build stdoutwrite.go \n[kamori@kamori-pc playground]$ time ./stdoutwrite &gt;/dev/null\nStdoutWriting Hello World! 1000000000 times\nreal    11m36.198s\nuser    7m31.211s\nsys    4m0.080s\n\n</code></pre>\n\n<p>I understand this isn't the best way to test this process. But it was the one I chose and it was interesting. I'm still curious to know the differences but the results <em>kinda</em> make sense to me. <strong>However</strong>, just for fun, I did the same thing with Python 3 and it went way faster</p>\n\n<p><strong>Python 3</strong></p>\n\n<pre><code>[kamori@kamori-pc playground]$ cat print.py\n\nfor i in range(1000000000):\n    print(\"Hello World!\")\n[kamori@kamori-pc playground]$ time python3 print.py &gt;/dev/null\n\nreal    6m46.542s\nuser    6m44.450s\nsys    0m0.836s\n</code></pre>\n\n<p>Here is version details</p>\n\n<pre><code>[kamori@kamori-pc playground]$ go version\ngo version go1.13.4 linux/amd64\n[kamori@kamori-pc playground]$ python --version\nPython 3.7.4\n[kamori@kamori-pc playground]$ uname -a\nLinux kamori-pc 4.19.59-rt23-MANJARO #1 SMP PREEMPT RT Sat Jul 20 07:14:03 UTC 2019 x86_64 GNU/Linux\n\n</code></pre>\n\n<p>My question is, <strong>why did python out perform Go?</strong> My expectation was Go would be faster as its a compiled language. Sure there isn't a ton of logic that needs to be figured out on the fly so Python might be able to take some shortcuts. But, these workloads seem really small, IMO both languages should be returning pretty fast besides the startup overhead.</p>\n\n<p>--- <strong>Edit</strong> ---</p>\n\n<p>I saw comments about using bufio to buffer my writes. And holy moly.</p>\n\n<pre><code>[kamori@kamori-pc playground]$ cat bufferio.go \npackage main\n\n//import \"fmt\"\nimport \"os\"\nimport \"bufio\"\nfunc main(){\n   os.Stderr.WriteString(\"Printing Hello World! 1000000000 times\")\n   mywrite := bufio.NewWriter(os.Stdout)\n   for i := 0; i &lt; 1000000000; i++{\n       mywrite.WriteString(\"Hello World!\\n\")\n   }\n}\n[kamori@kamori-pc playground]$ go build bufferio.go \n[kamori@kamori-pc playground]$ time ./bufferio &gt;/dev/null\nPrinting Hello World! 1000000000 times\nreal    0m9.882s\nuser    0m9.003s\nsys 0m0.865s\n</code></pre>\n\n<p>--- <strong>Edit2</strong> ---\nFor dave's answer I went ahead and set flush=True and here are the results. This is what I expected to see in my original comparison. Looks like buffering saves the day!</p>\n\n<pre><code>[kamori@kamori-pc playground]$ cat print_with_flush_true.py \n\nfor i in range(1000000000):\n    print(\"Hello World!\", flush=True)\n[kamori@kamori-pc playground]$ time python3 print_with_flush_true.py &gt;/dev/null \n\nreal    27m38.319s\nuser    23m15.274s\nsys 4m16.869s\n\n</code></pre>\n"}, {"tags": ["amazon-web-services", "unit-testing", "go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574189870, "post_id": 58940962, "comment_id": 104140598, "body": "You&#39;re setting a non-nil error in the mocked implementation, and it looks like the implementation is interpreting as (correctly) an error condition, and not doing what it is supposed to do. Try with nil error in retriever.SSM instead."}, {"owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574191090, "post_id": 58940962, "comment_id": 104141153, "body": "If I change err: to nil in retriever.SSM, I&#39;ll get a nil pointer deference panic. I checked the value of &quot;req&quot; when passing in the mock value, but nothing comes through."}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574191282, "post_id": 58940962, "comment_id": 104141229, "body": "Where do you get the panic?"}, {"owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574191375, "post_id": 58940962, "comment_id": 104141272, "body": "Panic occurs in the <code>GetSSMValue()</code> function at  <code>SSMValue := *req.Parameter.Value</code>"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574191815, "post_id": 58940962, "comment_id": 104141479, "body": "That&#39;s got nothing to do with err. When err is non-nil, your code returns before that statement. When you made err nil, now the code passes the error check, but self.SSM.GetParameter returned nil (i.e. req is nil), or req.Parameter is nil, or req.Parameter.Value is nil."}, {"owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574197262, "post_id": 58940962, "comment_id": 104143881, "body": "I guess what I&#39;m asking is how do I have the test return the mocked output of <code>outputParameter</code> so that <code>SSMValue</code> would be &quot;MyTestOutput&quot;?"}, {"owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574197414, "post_id": 58940962, "comment_id": 104143950, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/202677/discussion-between-theorangeremix-and-burak-serdar\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "is_accepted": false, "score": 0, "last_activity_date": 1574205909, "creation_date": 1574205909, "answer_id": 58944381, "question_id": 58940962, "link": "https://stackoverflow.com/questions/58940962/mocking-aws-go-ssm-getparameter-call/58944381#58944381", "title": "Mocking AWS Go SSM GetParameter call", "body": "<p>I had to insert the mocked output inside the <code>GetParameter()</code> function in the test module. This seems to work:</p>\n\n<pre><code>func (sp *mockSSM) GetParameter(input *ssm.GetParameterInput) (*ssm.GetParameterOutput, error) {\n        // Defines actual value that is received in the response\n        output := &amp;ssm.GetParameterOutput{\n                Parameter: &amp;ssm.Parameter{\n                        Type: aws.String(\"String\"),\n                        Value: aws.String(\"MyTestOutput\"),\n                },\n        }\n        return output, nil\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 1, "last_activity_date": 1574236777, "creation_date": 1574236777, "answer_id": 58949339, "question_id": 58940962, "link": "https://stackoverflow.com/questions/58940962/mocking-aws-go-ssm-getparameter-call/58949339#58949339", "title": "Mocking AWS Go SSM GetParameter call", "body": "<p>Actually everything was right, you just need add 1 line of code to initialise output.Parameter: <code>output.Parameter = &amp;ssm.Parameter{Value: aws.String(\"MyTestOutput\")}</code></p>\n\n<p>And you func must looks like this:</p>\n\n<pre><code>func (sp *mockSSM) GetParameter(input *ssm.GetParameterInput) (*ssm.GetParameterOutput, error) {\n    output := new(ssm.GetParameterOutput)\n    output.Parameter = &amp;ssm.Parameter{Value: aws.String(\"MyTestOutput\")}\n    return output, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 2581239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/df9b0a6adfadea9b54da90b0aa350357?s=128&d=identicon&r=PG", "display_name": "TheOrangeRemix", "link": "https://stackoverflow.com/users/2581239/theorangeremix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574236777, "creation_date": 1574189387, "last_edit_date": 1574199039, "question_id": 58940962, "link": "https://stackoverflow.com/questions/58940962/mocking-aws-go-ssm-getparameter-call", "title": "Mocking AWS Go SSM GetParameter call", "body": "<p>I'm trying to follow <a href=\"https://github.com/aws/aws-sdk-go/blob/master/example/service/dynamodb/unitTest/unitTest_test.go\" rel=\"nofollow noreferrer\">this example</a>, but using it to mock the SSM GetParameter call instead.\nAll I want to do is to send the value of <code>inputParameter</code> and verify that the output is the value of <code>outputParameter</code>.</p>\n\n<p>When I run a <code>go test</code>, it just throws the error that I defined, but not sure why. What am I doing wrong?</p>\n\n<p>Here is my function:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"log\"\n        \"github.com/aws/aws-sdk-go/aws\"\n        \"github.com/aws/aws-sdk-go/aws/session\"\n        \"github.com/aws/aws-sdk-go/service/ssm\"\n        \"github.com/aws/aws-sdk-go/service/ssm/ssmiface\"\n\n)\n\ntype AWS struct {\n        Config  *aws.Config\n        Session *session.Session\n        SSM     ssmiface.SSMAPI\n}\n\n\n\nfunc (self *AWS) GetSSMValue(SSMPath string) string {\n        req, err := self.SSM.GetParameter(&amp;ssm.GetParameterInput{\n                Name:           aws.String(SSMPath),\n                WithDecryption: aws.Bool(false),\n        })\n        if err != nil {\n                log.Fatalln(\"Unable to retrieve value: \", err)\n        }\n        SSMValue := *req.Parameter.Value\n\n        return SSMValue\n}\n\n\nfunc main() {\n        Aws := new(AWS)\n        Aws.Config = &amp;aws.Config{Region: aws.String(\"us-west-2\")}\n        Aws.Session, _ = session.NewSession(Aws.Config)\n\n        ssmsvc := ssm.New(Aws.Session)\n        Aws.SSM = ssmiface.SSMAPI(ssmsvc)\n\n        inputParam := \"/path/to/my/parameter\"\n        myValue := Aws.GetSSMValue(inputParam)\n        fmt.Println(myValue)\n\n}\n</code></pre>\n\n<p>and my test:</p>\n\n<pre><code>package main\n\nimport (\n        \"errors\"\n        \"github.com/aws/aws-sdk-go/service/ssm\"\n        \"github.com/aws/aws-sdk-go/service/ssm/ssmiface\"\n        \"testing\"\n)\n\ntype mockSSM struct {\n        ssmiface.SSMAPI\n        response string\n        err  error\n}\n\nfunc (sp *mockSSM) GetParameter(input *ssm.GetParameterInput) (*ssm.GetParameterOutput, error) {\n        output := new(ssm.GetParameterOutput)\n        return output, sp.err\n\n}\n\nfunc TestGetSSMValue(t *testing.T) {\n        inputParameter := \"path/to/my/test\"\n        outputParameter := \"MyTestOutput\"\n        retriever := new(AWS)\n        retriever.SSM = &amp;mockSSM{\n                response: outputParameter,\n                err:  errors.New(\"my custom error\"),\n        }\n        if actualValue := retriever.GetSSMValue(inputParameter); actualValue != outputParameter {\n                t.Errorf(\"Expected %q but got %q\", outputParameter, actualValue)\n        }\n\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "namespaces", "containers", "linux-namespaces"], "comments": [{"owner": {"reputation": 323, "user_id": 225692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9f02c235ec5d1fd0794135aef6cc22?s=128&d=identicon&r=PG", "display_name": "ivzhh", "link": "https://stackoverflow.com/users/225692/ivzhh"}, "edited": false, "score": 0, "creation_date": 1574178500, "post_id": 58936711, "comment_id": 104134382, "body": "Actually I run your example, it works as expected. <code>mnt</code> requires <code>sudo</code> to run and after executing your commands, the three <code>txt</code> files cannot be seen from other processes (only the folder <code>&#47;tmp&#47;testmount</code> is accessible)."}, {"owner": {"reputation": 13761, "user_id": 1909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/44d4d7681bfc6f7e6f0c8d606c33d832?s=128&d=identicon&r=PG", "display_name": "ashwnacharya", "link": "https://stackoverflow.com/users/1909/ashwnacharya"}, "reply_to_user": {"reputation": 323, "user_id": 225692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9f02c235ec5d1fd0794135aef6cc22?s=128&d=identicon&r=PG", "display_name": "ivzhh", "link": "https://stackoverflow.com/users/225692/ivzhh"}, "edited": false, "score": 0, "creation_date": 1574182768, "post_id": 58936711, "comment_id": 104137023, "body": "@etc-100g Very interesting. I am running this in a &quot;bento/centos-7&quot; vagrant box. I have no idea why it is working for you. What OS are you trying it on?"}, {"owner": {"reputation": 323, "user_id": 225692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9f02c235ec5d1fd0794135aef6cc22?s=128&d=identicon&r=PG", "display_name": "ivzhh", "link": "https://stackoverflow.com/users/225692/ivzhh"}, "edited": false, "score": 0, "creation_date": 1574188027, "post_id": 58936711, "comment_id": 104139703, "body": "WSL2/Ubuntu 18.04. You are right, after testing on other CentOS-7/Virtualbox, the result is the same as you."}, {"owner": {"reputation": 323, "user_id": 225692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9f02c235ec5d1fd0794135aef6cc22?s=128&d=identicon&r=PG", "display_name": "ivzhh", "link": "https://stackoverflow.com/users/225692/ivzhh"}, "edited": false, "score": 0, "creation_date": 1574188093, "post_id": 58936711, "comment_id": 104139733, "body": "Maybe because of this: <a href=\"https://stackoverflow.com/a/45524409/225692\">stackoverflow.com/a/45524409/225692</a>"}], "answers": [{"tags": [], "owner": {"reputation": 323, "user_id": 225692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a9f02c235ec5d1fd0794135aef6cc22?s=128&d=identicon&r=PG", "display_name": "ivzhh", "link": "https://stackoverflow.com/users/225692/ivzhh"}, "is_accepted": false, "score": 0, "last_activity_date": 1596574177, "creation_date": 1596574177, "answer_id": 63254839, "question_id": 58936711, "link": "https://stackoverflow.com/questions/58936711/how-to-correctly-implement-mount-namespaces-in-go/63254839#63254839", "title": "How to correctly implement mount namespaces in go", "body": "<p>I was <a href=\"https://stackoverflow.com/questions/58936711/how-to-correctly-implement-mount-namespaces-in-go#comment104139733_58936711\">right</a> about the <a href=\"https://stackoverflow.com/a/45524409/225692\">solution</a>. But I did not know why. For documentation purpose, I will make this post complete.If you can read Chinese, go directly read <a href=\"https://zhuanlan.zhihu.com/p/166393945\" rel=\"nofollow noreferrer\">this Zhihu Zhuanlan post</a>. That author is very professional on Linux container and docker.</p>\n<p>The knowledge keywords are: <a href=\"https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt\" rel=\"nofollow noreferrer\">Shared Subtrees</a> and <a href=\"https://man7.org/linux/man-pages/man7/mount_namespaces.7.html\" rel=\"nofollow noreferrer\">propagation types: MS_SHARED, MS_PRIVATE, and MS_SLAVE</a>. By default, system assumes you want to reuse the mounted file systems. But if you don't want that, you have to do some extra work:</p>\n<blockquote>\n<p>A process wants to clone its own namespace, but still wants to access the CD\nthat got mounted recently.  Shared subtree semantics provide the necessary\nmechanism to accomplish the above.</p>\n</blockquote>\n<p>On command line, you can <code>mount --make-rprivate /</code>; in code, you need to use <a href=\"https://github.com/lizrice/containers-from-scratch/issues/3#issuecomment-347890483\" rel=\"nofollow noreferrer\"><code>syscall.MS_PRIVATE | syscall.MS_REC</code></a> to create an isolated mount.</p>\n"}], "owner": {"reputation": 13761, "user_id": 1909, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/44d4d7681bfc6f7e6f0c8d606c33d832?s=128&d=identicon&r=PG", "display_name": "ashwnacharya", "link": "https://stackoverflow.com/users/1909/ashwnacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1596574177, "creation_date": 1574175059, "last_edit_date": 1574183135, "question_id": 58936711, "link": "https://stackoverflow.com/questions/58936711/how-to-correctly-implement-mount-namespaces-in-go", "title": "How to correctly implement mount namespaces in go", "body": "<p>I have the following code <code>mnt.go</code></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"syscall\"\n)\n\nfunc main() {\n    fmt.Println(\"Entering go program\")\n\n    cmd := exec.Command(\"/bin/bash\")\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = os.Stdin\n\n    cmd.SysProcAttr = &amp;syscall.SysProcAttr{ \n        Cloneflags: syscall.CLONE_NEWNS,\n    }\n\n    if err := cmd.Run(); err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(\"Exiting go program\")\n}\n</code></pre>\n\n<p>I want to run the above code to spawn a bash shell, and run the following commands:</p>\n\n<pre><code>./mnt\nmkdir /tmp/testmount\nmount -n -o size=1m -t tmpfs tmpfs /tmp/testmount\ncd /tmp/testmount\ntouch 1.txt 2.txt 3.txt\n</code></pre>\n\n<p>Now when I launch another shell and run the command </p>\n\n<pre><code>ls /tmp/testmount\n</code></pre>\n\n<p>I should not be able to see the files <code>1.txt</code>, <code>2.txt</code> and <code>3.txt</code>. Since the temp file system has been mounted inside a mount namespace, it should not be visible from the outside.</p>\n\n<p>But that is not how it works for me. Why is the <code>syscall.CLONE_NEWNS</code> not working as expected? What should I do differently?</p>\n\n<p>One of the comments mentions that this code works fine for them. FWIW, I am running a \"bento/centos-7\" Vagrant box with golang installed and no other customizations. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574172197, "post_id": 58935710, "comment_id": 104130387, "body": "Whether or not it&#39;s a &quot;pattern&quot;, and if so, which kind, is a question of your definition. If it&#39;s happened at least twice or three times, it can be called a pattern. How, and if, you label that pattern is a matter of opinion."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574172321, "post_id": 58935710, "comment_id": 104130460, "body": "Is there an actual problem you&#39;re trying to solve? This looks like primarily a taxonomy question, which probably is not <a href=\"https://stackoverflow.com/help/on-topic\">&quot;a practical, answerable problem that is unique to software development&quot;</a>"}, {"owner": {"reputation": 95, "user_id": 10158971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac98844f1394b819968710029e9afb3?s=128&d=identicon&r=PG&f=1", "display_name": "Hill", "link": "https://stackoverflow.com/users/10158971/hill"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574176790, "post_id": 58935710, "comment_id": 104133261, "body": "Thank you for commenting on my question. I want to enhance my knowledge from the repository. There is not any problem for solving it. I&#39;m sorry for asking bad question. I should close this question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574176839, "post_id": 58935710, "comment_id": 104133293, "body": "Improving knowledge is good, and can make for good questions. But the question should be focused, and not based on opinions."}], "owner": {"reputation": 95, "user_id": 10158971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ac98844f1394b819968710029e9afb3?s=128&d=identicon&r=PG&f=1", "display_name": "Hill", "link": "https://stackoverflow.com/users/10158971/hill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574172158, "creation_date": 1574171769, "last_edit_date": 1574172158, "question_id": 58935710, "link": "https://stackoverflow.com/questions/58935710/repository-pattern-of-golang-echo-realworld-example-app", "title": "repository pattern of golang-echo-realworld-example-app", "body": "<p>I am developing my personal project, referring to <a href=\"https://github.com/xesina/golang-echo-realworld-example-app\" rel=\"nofollow noreferrer\">golang-echo-realworld-example-app</a> But I have some points which I don't still understand about this example projet.</p>\n\n<ul>\n<li>How do you call this repository pattern?</li>\n<li>Is this any design pattern? This seems like an adapter pattern to me.</li>\n<li>Does this have Store interface of user and article in order to mock it for testing? <a href=\"https://github.com/xesina/golang-echo-realworld-example-app/blob/master/user/user.go\" rel=\"nofollow noreferrer\">link here</a></li>\n</ul>\n"}, {"tags": ["go", "deadlock"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574172969, "post_id": 58935376, "comment_id": 104130861, "body": "The first sentence of that page says &quot;In concurrent computing, a deadlock is a state in which each member of a group is waiting for another member&quot; which describes the situation exactly."}, {"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574173070, "post_id": 58935376, "comment_id": 104130930, "body": "and in Necessary conditions part it says  &gt; Hold and wait or resource holding: a process is currently holding at least one resource and requesting additional resources which are being held by other processes."}, {"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574173129, "post_id": 58935376, "comment_id": 104130972, "body": "so the reason explain will be <code>necessary conditions</code> is for linux process model. not for goroutine model."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574173206, "post_id": 58935376, "comment_id": 104131024, "body": "All four conditions are met. &quot;Process&quot; in the article doesn&#39;t (necissarily) mean CPU process. It means process in the general sense."}, {"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574173304, "post_id": 58935376, "comment_id": 104131099, "body": "could you kindly tell why <code>Hold and wait or resource holding</code> is met? f2 and main is not ask for any other resource. and main even not hold any resource"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1574173487, "post_id": 58935376, "comment_id": 104131198, "body": "<code>mu.Lock()</code> is how the &quot;hold and wait&quot; requirement is met."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1574173526, "post_id": 58935376, "comment_id": 104131221, "body": "@petelin The resource here is the lock. Getting the lock is <code>mu.Lock()</code>. Both <code>main()</code> and <code>f2()</code> tries to do that, but the lock is a &quot;thing&quot; which can only be locked once. It can only be locked again if someone unlocks it first. But nobody unlocks it in your code."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1574175339, "post_id": 58935376, "comment_id": 104132338, "body": "Go&#39;s definition of a deadlock is right there in the error message: &quot;all goroutines are asleep&quot;. Wikipedia&#39;s definition of a deadlock is irrelevant."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1574175367, "post_id": 58935376, "comment_id": 104132359, "body": "There is absolutely zero point in discussing whether the Wikipedia definition of deadloack apllies to this deadlock or. You have a deadlock! If you think Wikipedia&#39;s definition does not apply: Change the definition on WP. This is pointless."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574176024, "post_id": 58935376, "comment_id": 104132768, "body": "I suspect there&#39;s an honest, legitimate question in here, about the nature of a deadlock. But the OP&#39;s rude comments, coupled with poor English (which I do not hold against the OP at all, for the record) has turned it into an adversarial question."}], "answers": [{"comments": [{"owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "edited": false, "score": 0, "creation_date": 1574172502, "post_id": 58935423, "comment_id": 104130572, "body": "Thanks, i know all the thing you are talk, about i still do not think this is a <code>deadlock</code> .as a deadlock there have four condition. <a href=\"https://en.wikipedia.org/wiki/Deadlock#Deadlock_handling\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Deadlock#Deadlock_handling</a>  maybe those Necessary conditions is only useful to detect <code>process</code> model, not <code>goroutine</code> model. since in process if you kill a thead with out release the lock. os will that part"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1574186340, "last_edit_date": 1574186340, "creation_date": 1574170841, "answer_id": 58935423, "question_id": 58935376, "link": "https://stackoverflow.com/questions/58935376/is-this-is-dead-lock-why-does-executing-the-program-say-it-is-a-dead-lock/58935423#58935423", "title": "Is this is dead lock? Why does executing the program say it is a dead lock?", "body": "<p><strong>Note beforehand:</strong>  A \"goroutine deadlock\" (this is what you experience) is a state when all existing goroutines are blocked and cannot proceed on their own (ever). It doesn't matter if there are multiple existing goroutines or just a single one. If the go runtime detects a goroutine deadlock, terminates the app (there's no point letting the app hang forever, it will never recover, it's in the definition of goroutine deadlock).</p>\n\n<hr>\n\n<p>You have a single mutex in your code which is locked in 2 goroutines: in the <code>main</code> goroutine and the one executing <code>f2()</code>.</p>\n\n<p>If <code>f2()</code> reaches sooner the point to lock the mutex, the main goroutine will never be able to lock it again because no one unlocks the mutex, so then it's a deadlock. Because <code>f2()</code> will return after locking and printing, and its goroutine will end, and the only remaining <code>main</code> goroutine is blocked trying to lock <code>mu</code>. And since you used a 2-seconds sleep in <code>main()</code> between launching <code>f2</code> (as a goroutine) and  locking the mutex, you will observe this deadlock <em>like always</em>.</p>\n\n<p>Note that if the <code>main</code> goroutine would be scheduled to lock the mutex first, no deadlock would occur because the <code>main()</code> function could continue to run, and once returning, the app would terminate (not waiting for <code>f2()</code> to finish). But again, due to the sleep you inserted, you will <em>likely never</em> get this outcome.</p>\n\n<p>I used the phrases <em>\"like always\"</em> and <em>\"likely never\"</em> because although a sleep instruction is a good scheduling point for the goroutine scheduler, it is not a synchronization point. The runtime will schedule other goroutines to run while a goroutine is in sleep (why wouldn't it), but this is not guaranteed. Synchronization points could give you guarantee (such as channel communications, locks, <code>sync.Once</code> etc.). This is detailed in <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">The Go Memory Model</a>.</p>\n"}], "owner": {"reputation": 340, "user_id": 5159891, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a718f7cb4a6342a2a9709eeeac2b04b8?s=128&d=identicon&r=PG&f=1", "display_name": "pete lin", "link": "https://stackoverflow.com/users/5159891/pete-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "closed_date": 1574212181, "answer_count": 1, "score": -6, "last_activity_date": 1574186340, "creation_date": 1574170682, "last_edit_date": 1574173213, "question_id": 58935376, "link": "https://stackoverflow.com/questions/58935376/is-this-is-dead-lock-why-does-executing-the-program-say-it-is-a-dead-lock", "closed_reason": "Needs details or clarity", "title": "Is this is dead lock? Why does executing the program say it is a dead lock?", "body": "<p>When I run this program:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar mu = new(sync.Mutex)\n\nfunc f2() {\n    mu.Lock()\n    fmt.Println(\"call f2...\")\n}\n\nfunc main() {\n    go f2()\n    time.Sleep(time.Second * 2)\n    mu.Lock()\n    fmt.Println(\"get lock in main\")\n}\n\n</code></pre>\n\n<p>I get this output:</p>\n\n<pre><code>call f2...\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/-P3CuXyaqBd\" rel=\"nofollow noreferrer\">playground link</a>.</p>\n\n<p>As we know there are four condition to have dead lock, one is <code>Hold and wait or resource holding</code> which require there are at least two kind of resource to get, but here is only one resource.</p>\n\n<p>So is this a dead lock or not? </p>\n\n<p>I know quit a lot of concurrence programming. It just in this case it is only <code>f2()</code> not release lock, and that is not a deadlock as <a href=\"https://en.wikipedia.org/wiki/Deadlock\" rel=\"nofollow noreferrer\">wikipedia defines</a>.</p>\n"}, {"tags": ["unit-testing", "go", "testing", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1574164503, "post_id": 58933144, "comment_id": 104126021, "body": "An even easier test would be to import a non-existant library in your test, then watch the standard build succeed."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1574163804, "last_edit_date": 1574163804, "creation_date": 1574163182, "answer_id": 58933144, "question_id": 58932966, "link": "https://stackoverflow.com/questions/58932966/are-libraries-for-testing-incorporated-in-final-build/58933144#58933144", "title": "Are libraries for testing incorporated in final build", "body": "<p>Official doc: <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"noreferrer\">Command go: Compile packages and dependencies:</a></p>\n\n<blockquote>\n  <p>When compiling packages, build ignores files that end in '_test.go'.</p>\n</blockquote>\n\n<p>Also from package doc of <a href=\"https://golang.org/pkg/testing/\" rel=\"noreferrer\"><code>testing</code></a>:</p>\n\n<blockquote>\n  <p>To write a new test suite, create a file whose name ends _test.go that contains the TestXxx functions as described here. Put the file in the same package as the one being tested. The file will be excluded from regular package builds but will be included when the \u201cgo test\u201d command is run.</p>\n</blockquote>\n\n<p>Building your app doesn't even touch the test files. So no, dependencies only referred to from tests are not included in the executable binary.</p>\n\n<p>Also how hard is it to test? Write a simple app, build it. Note the size of the compiled binary.</p>\n\n<p>Add a test file, refer to some lib. Build again, the size won't change. Now if you refer to the package from the app and build again, it will grow.</p>\n\n<p>Example:</p>\n\n<pre><code>package main\n\nfunc main() {\n    println(\"Hello world\")\n}\n</code></pre>\n\n<p>Built on linux (Go 1.13), size is: <strong>1,148,861 bytes</strong>.</p>\n\n<p>Adding a test:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"testing\"\n    \"time\"\n)\n\nfunc TestOne(t *testing.T) {\n    fmt.Println(time.Now())\n}\n</code></pre>\n\n<p>Size doesn't change. Now adding this <code>TestOne()</code> function (along with the required imports) to the main app: size increased to <strong>2,165,259 bytes</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 1, "last_activity_date": 1574197984, "creation_date": 1574197984, "answer_id": 58942883, "question_id": 58932966, "link": "https://stackoverflow.com/questions/58932966/are-libraries-for-testing-incorporated-in-final-build/58942883#58942883", "title": "Are libraries for testing incorporated in final build", "body": "<blockquote>\n  <p>I'm wondering if the libraries that I use for tests only will be\n  included in the final build distribution. I see dependencies in\n  go.mod/go.sum files but I can't check final binary.</p>\n</blockquote>\n\n<p>When the binary is built, it contains a tons of additional information, including a table of symbols. Where a symbol is an identifiable name in your code.</p>\n\n<p>read more about this <a href=\"https://www.grant.pizza/dissecting-go-binaries/\" rel=\"nofollow noreferrer\">https://www.grant.pizza/dissecting-go-binaries/</a></p>\n\n<p>Using that you can list imported packages using programs like <code>readelf</code>, <code>objdump</code> or <code>nm</code> for linux like systems, for a windows system, the executable file format is named <a href=\"https://stackoverflow.com/questions/2221806/any-tool-software-in-windows-for-viewing-elf-file-format\">PE</a> and you will need specific interpreters.</p>\n\n<p>see those two sessions</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>[mh-cbon@Host-001 pyt] $ cat main.go \npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"hello world!\")\n}\n[mh-cbon@Host-001 pyt] $ go build -o bin\n[mh-cbon@Host-001 pyt] $ nm bin | grep testing\n</code></pre>\n\n<p>A program built with the <code>testing</code> package</p>\n\n<pre><code>[mh-cbon@Host-001 pyt] $ cat main.go \npackage main\n\nimport (\n    \"fmt\"\n    \"testing\"\n)\n\nfunc main() {\n    fmt.Println(\"hello world!\")\n    _ = testing.T{}\n}\n[mh-cbon@Host-001 pyt] $ go build -o bin\n[mh-cbon@Host-001 pyt] $ nm bin | grep testing\n00000000004e30e0 R go.itab.*testing.benchTimeFlag,flag.Value\n0000000000574b90 B testing.benchmarkMemory\n00000000005614b0 D testing.benchTime\n0000000000494320 T testing.(*benchTimeFlag).Set\n</code></pre>\n"}], "owner": {"reputation": 4447, "user_id": 616290, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Px1aG.jpg?s=128&g=1", "display_name": "Dmytro Boichenko", "link": "https://stackoverflow.com/users/616290/dmytro-boichenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58933144, "answer_count": 2, "score": -2, "last_activity_date": 1574197984, "creation_date": 1574162683, "last_edit_date": 1574163255, "question_id": 58932966, "link": "https://stackoverflow.com/questions/58932966/are-libraries-for-testing-incorporated-in-final-build", "title": "Are libraries for testing incorporated in final build", "body": "<p>I'm wondering if the libraries that I use for tests only will be included in the final build distribution. I see dependencies in <code>go.mod</code>/<code>go.sum</code> files but I can't check final binary.</p>\n\n<p>I guess that the Go build tool deals somehow with redundant code but I didn't find any pieces of evidence.</p>\n\n<p>Could somebody point me to that spot in the documentation or describe behavior?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574174621, "post_id": 58932671, "comment_id": 104131851, "body": "If the field is a UUID, then it might be returning a raw []byte instead of a string. You might want to try entry.GetRawAttributeValue(), and <code>fmt.Sprintf(&quot;%x&quot;,value)</code>. There is also a github.com/google/uuid package which you can use to parse it as UUID."}, {"owner": {"reputation": 6184, "user_id": 4985099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eKVVD.jpg?s=128&g=1", "display_name": "sushanth", "link": "https://stackoverflow.com/users/4985099/sushanth"}, "edited": false, "score": 0, "creation_date": 1598533372, "post_id": 58932671, "comment_id": 112494037, "body": "@noize were you able to get through in converting GUID to string ?"}, {"owner": {"reputation": 147, "user_id": 1867836, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ece8ef45fe1d4a28e45d2fee43c627bf?s=128&d=identicon&r=PG", "display_name": "Noize", "link": "https://stackoverflow.com/users/1867836/noize"}, "reply_to_user": {"reputation": 6184, "user_id": 4985099, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eKVVD.jpg?s=128&g=1", "display_name": "sushanth", "link": "https://stackoverflow.com/users/4985099/sushanth"}, "edited": false, "score": 0, "creation_date": 1598623881, "post_id": 58932671, "comment_id": 112528146, "body": "@sushanth yes i used Burak help  .html.EscapeString(fmt.Sprintf(&quot;%x&quot;, entry.GetRawAttributeValue(&quot;objectGUID&quot;)))"}], "owner": {"reputation": 147, "user_id": 1867836, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ece8ef45fe1d4a28e45d2fee43c627bf?s=128&d=identicon&r=PG", "display_name": "Noize", "link": "https://stackoverflow.com/users/1867836/noize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 196, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1574161747, "creation_date": 1574161747, "question_id": 58932671, "link": "https://stackoverflow.com/questions/58932671/go-active-directory-objectguid-attribute", "title": "Go Active Directory OBJECTGUID attribute", "body": "<p>I'm pretty new to Go and I'm creating an LDAP Extractor,</p>\n\n<p>Currently having problems converting the OBJECTGUID attribute into a human readable human string to be inserted into a database later.</p>\n\n<p>I'm using the <code>github.com/go-ldap/ldap/v3</code> package I've tried both \n<code>entry.GetAttributeValue(\"objectGUID\")</code> and <code>entry.GetRawAttributeValue(\"objectGUID\")</code></p>\n\n<p>I've string <code>string(variable)</code> have tried the  <code>hex.DecodeString(s)</code>  and still getting non-readable characters.</p>\n\n<p>Anyone has any idea how could i convert this into a normal ut8 string?</p>\n"}, {"tags": ["mongodb", "unit-testing", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1574163695, "post_id": 58931684, "comment_id": 104125560, "body": "To satisfy an interface the methods <b>must</b> match <i>verbatim</i>. <code>Foo() DatabaseHelper</code> does not match <code>Foo() *mongo.Database</code> <i>verbatim</i>, it does not matter that <code>*mongo.Database</code> implements <code>DatabaseHelper</code>, what matters is the method name and singature."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574163878, "post_id": 58931684, "comment_id": 104125665, "body": "... and therefore, to be able to do what you want, you need to write wrappers around the implementations and have those wrappers return the correct type from the interface-implementing methods."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574164052, "post_id": 58931684, "comment_id": 104125753, "body": "something like this: <a href=\"https://stackoverflow.com/a/53823961/965900\">stackoverflow.com/a/53823961/965900</a>"}, {"owner": {"reputation": 185, "user_id": 6218694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d32b49d627732e3097e6f7af1f9e35?s=128&d=identicon&r=PG&f=1", "display_name": "vesna", "link": "https://stackoverflow.com/users/6218694/vesna"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574166402, "post_id": 58931684, "comment_id": 104127113, "body": "Thanks for your answer, helps me a lot. I find it a bit disappointing but at least I know what to do now !"}], "owner": {"reputation": 185, "user_id": 6218694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29d32b49d627732e3097e6f7af1f9e35?s=128&d=identicon&r=PG&f=1", "display_name": "vesna", "link": "https://stackoverflow.com/users/6218694/vesna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1574158881, "creation_date": 1574158881, "question_id": 58931684, "link": "https://stackoverflow.com/questions/58931684/write-down-interfaces-for-testing-the-go-mongo-driver", "title": "Write down interfaces for testing the Go Mongo driver", "body": "<p>I am trying to write tests for a new project which makes use of the golang mongo driver. They sadly didn't use interfaces so I'm basically trying to write them down by myself for the few methods I'm making use of but am probably missing something with Go.</p>\n\n<p>Let's say I have the following <code>struct</code> which is the root of the repository part:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type MongoChecksRunner struct {\n    Client ClientHelper\n}\n</code></pre>\n\n<p><code>ClientHelper</code> is the following interface which the original <code>*mongo.Client</code> implements:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type ClientHelper interface {\n    Database(name string, opts ...*options.DatabaseOptions) DatabaseHelper\n    Connect(ctx context.Context) error\n}\n</code></pre>\n\n<p>Every level is interfaced, so for the original <code>*mongo.Database</code> structure, we get:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type DatabaseHelper interface {\n    RunCommand(ctx context.Context, runCommand interface{}, opts ...*options.RunCmdOptions) SingleResultHelper\n}\n</code></pre>\n\n<p>And finally, for the original <code>*mongo.SingleResult</code> structure, we have:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type SingleResultHelper interface {\n    Decode(v interface{}) error\n    Err() error\n}\n</code></pre>\n\n<p>However, when I try to instantiate a new <code>MongoChecksRunner</code>, it does not compile:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func NewMongoChecksRunner(host string, port int) (*MongoChecksRunner, error) {\n    client, err := mdriver.NewClient(\n        options.Client().ApplyURI(fmt.Sprintf(\"mongodb://%s:%d\", host, port)),\n        options.Client().SetDirect(true),\n    )\n    if err != nil {\n        return nil, err\n    }\n\n    return &amp;MongoChecksRunner{\n        Client: client,\n    }, nil\n}\n</code></pre>\n\n<p>I get the following error: <code>cannot use client (variable of type *mongo.Client) as ClientHelper value in struct literal: wrong type for method Database</code>.</p>\n\n<p>Are there any limitations with Golang which prevents you from having multiple levels of nesting for interfaces ?</p>\n\n<p>Please find below the original <code>mongo</code> package structures' method signatures :</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (c *Client) Database(name string, opts ...*options.DatabaseOptions) *Database\nfunc (c *Client) Connect(ctx context.Context) error\nfunc (db *Database) RunCommand(ctx context.Context, runCommand interface{}, opts ...*options.RunCmdOptions) *SingleResult\nfunc (sr *SingleResult) Decode(v interface{}) error\nfunc (sr *SingleResult) Err() error\n</code></pre>\n\n<p>Thank you in advance for any kind of help</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574166102, "post_id": 58931239, "comment_id": 104126935, "body": "I changed them before posting the struct here, they all start with the uppercase in my code"}, {"owner": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574170950, "post_id": 58931239, "comment_id": 104129661, "body": "is a generic example for a problem that I&#39;m currently facing, the field name is not relevant currently but I will fix the naming in the question thanks"}], "answers": [{"comments": [{"owner": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "edited": false, "score": 0, "creation_date": 1574165535, "post_id": 58932770, "comment_id": 104126595, "body": "I can&#39;t reach the IsBlank function because with and without the omitempty everytime I post a json without the field3 keyword I get an error <code>Key: &#39;SearchData.field3&#39; Error:Field validation for &#39;field3&#39; failed on the &#39;alphanum&#39; tag</code>"}, {"owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "reply_to_user": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "edited": false, "score": 0, "creation_date": 1574167606, "post_id": 58932770, "comment_id": 104127775, "body": "Wait, please share how do you retrieve the parameter and how do you send them trough curl"}, {"owner": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "edited": false, "score": 0, "creation_date": 1574171181, "post_id": 58932770, "comment_id": 104129806, "body": "Can&#39;t post too long code snippet here, I added it at the end of the question"}], "tags": [], "owner": {"reputation": 1723, "user_id": 9361998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4903f0d1b79d5499e942a376d853475?s=128&d=identicon&r=PG&f=1", "display_name": "alessiosavi", "link": "https://stackoverflow.com/users/9361998/alessiosavi"}, "is_accepted": false, "score": 1, "last_activity_date": 1574162081, "creation_date": 1574162081, "answer_id": 58932770, "question_id": 58931239, "link": "https://stackoverflow.com/questions/58931239/gin-problems-with-posted-data-validation/58932770#58932770", "title": "GIN problems with posted data validation", "body": "<p>Gin return an empty string if the parameter was not provided.\nYou can use the following method in order to verify if the string is provided:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// IsBlank is delegated to verify that the does not contains only empty char\nfunc IsBlank(str string) bool {\n    // Check length\n    if len(str) &gt; 0 {\n        // Iterate string\n        for i := range str {\n            // Check about char different from whitespace\n            if str[i] &gt; 32 {\n                return false\n            }\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>You can read some useful utils method in this repository in order to validate string and execute common task on string:<br>\n<a href=\"https://github.com/alessiosavi/GoGPUtils/blob/master/string/stringutils.go\" rel=\"nofollow noreferrer\">https://github.com/alessiosavi/GoGPUtils/blob/master/string/stringutils.go</a></p>\n\n<p>For the second problem, you can use the <code>DefaultQuery</code> in order to set a predefined value if no one are provided, here an example</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func get() gin.HandlerFunc {\n    fn := func(c *gin.Context) {\n        // firstname will be \"NOT_PRESENT\" if the user does not send the parameter\n        firstname := c.DefaultQuery(\"test\", \"NOT_PRESENT\")\n        lastname := c.Query(\"test1\")\n        fmt.Println(firstname, lastname)\n\n    }\n    return gin.HandlerFunc(fn)\n}\n</code></pre>\n\n<p>Here the documentation about <code>DefaultQuery</code>:<br>\n<a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.DefaultQuery\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/gin-gonic/gin#Context.DefaultQuery</a></p>\n"}], "owner": {"reputation": 242, "user_id": 5217484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06552c25d8c0ada46cfcc34d921e117c?s=128&d=identicon&r=PG&f=1", "display_name": "FakeAccount", "link": "https://stackoverflow.com/users/5217484/fakeaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1055, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574170970, "creation_date": 1574157562, "last_edit_date": 1574170970, "question_id": 58931239, "link": "https://stackoverflow.com/questions/58931239/gin-problems-with-posted-data-validation", "title": "GIN problems with posted data validation", "body": "<p>I'm currently learning GO and I wanted to replicate one of the services we are running in production using GO for training. I'm working with the framework GIN and I need to validate a simple struct like this. It is posted to the search endpoint</p>\n\n<pre><code>type SearchData struct {\n    Field1           string `json:\"field1,omitempty\"`\n    Field2           string `json:\"field2,omitempty\"`\n    Field3           string `json:\"field,omitempty\" binding:\"alphanum\"`\n}\n</code></pre>\n\n<p>first problem: I can't check <code>if Field3 != nil</code> because is a string, one solution I found by reading online is that I can cast it as a pointer, the problem is that then I get an error from the binding alphanum because nil fail the validation. </p>\n\n<p>second problem: I can remove the omitempty check but if I do so the alphanum validator fail and the fields are set to their default value \"\". I can't check if the user want to submit \"\" or is the bindingJSON method that is setting the default value.</p>\n\n<p>By reading online I see that there isn't a proper solution to this problem (or maybe yes), as I'm new to GO I will be happy to see how other people handle this in published / production APIs.</p>\n\n<p>EDIT: This is how I parse the json</p>\n\n<pre><code>func Search(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n    var json SearchData\n\n    if err := c.ShouldBindJSON(&amp;json); err != nil {\n        fmt.Println(err)\n        utils.ReturnError400(c, \"Invalid\")\n        return\n    }\n\n        // the json is used here\n}\n</code></pre>\n"}, {"tags": ["linux", "go", "filesystems", "lvm"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 12396558, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tgbXT.png?s=128&g=1", "display_name": "str4in", "link": "https://stackoverflow.com/users/12396558/str4in"}, "is_accepted": false, "score": 1, "last_activity_date": 1574158710, "creation_date": 1574158710, "answer_id": 58931623, "question_id": 58931111, "link": "https://stackoverflow.com/questions/58931111/how-to-fetch-logical-volume-information-in-linux/58931623#58931623", "title": "How to fetch Logical volume information in Linux?", "body": "<p>You can use the command <code>lvs</code> instead of <code>lvdisplay</code></p>\n\n<p><code>lvs</code> lists all logical volumes within its name,size and volume group among each other.</p>\n"}], "owner": {"reputation": 1, "user_id": 10404036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7252555775fdb0ff03829461024e925a?s=128&d=identicon&r=PG&f=1", "display_name": "agent jack", "link": "https://stackoverflow.com/users/10404036/agent-jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574158710, "creation_date": 1574157183, "question_id": 58931111, "link": "https://stackoverflow.com/questions/58931111/how-to-fetch-logical-volume-information-in-linux", "title": "How to fetch Logical volume information in Linux?", "body": "<p>I am working on a assignment where i have to fetch logical volume information from Linux . This information includes name , description , used space and total space . lvdisplay can display the logical volume but is there any other way to fetch the info ?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1574152551, "post_id": 58929585, "comment_id": 104119303, "body": "If the server says <code>Retry-After: 60</code>, your <code>RoundTripper</code> and thus <code>client.Get()</code> will wait 60 seconds. That doesn&#39;t feel right at all to me."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 4, "creation_date": 1574152593, "post_id": 58929585, "comment_id": 104119333, "body": "From my perspective, retries should be dealt with explicitly in your application. The risk of modifying Roundtripper is that you hide the retry logic at the position in your code where it matters most: when someone (including you, after 6 months) tries to find out what the application does.The risk being explicitly that the retry logic is missed, and someone comes along seeing code which implicitly assumes the request is successful - and writes a retry logic/error handling at a different point in the code."}, {"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "edited": false, "score": 0, "creation_date": 1574152673, "post_id": 58929585, "comment_id": 104119381, "body": "Thank you for your comment, you are completely right! However, this question is more on how and if I can use <code>http.RoundTripper</code> for doing so. That&#39;s why excluded the implementation at all."}, {"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574152741, "post_id": 58929585, "comment_id": 104119423, "body": "Thank you, @MarkusWMahlberg. Would you mind to post it as an answer?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 3, "creation_date": 1574152749, "post_id": 58929585, "comment_id": 104119425, "body": "Well, you can, as you demonstrated yourself. But imho, it is a bad idea."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574152818, "post_id": 58929585, "comment_id": 104119464, "body": "@MichelDorner Done, see below."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1574160848, "post_id": 58929585, "comment_id": 104123960, "body": "&quot;RoundTrip should not attempt to handle higher-level protocol details such as redirects, authentication, or cookies.&quot; I consider retries a higher-level feature."}], "answers": [{"comments": [{"owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "edited": false, "score": 0, "creation_date": 1574152995, "post_id": 58929760, "comment_id": 104119548, "body": "I totally can follow your logic (especially about the explicitness of failed/retried requests). But then the only purpose of this RoundTripper I can imagine is caching."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "edited": false, "score": 1, "creation_date": 1574153173, "post_id": 58929760, "comment_id": 104119645, "body": "@MichaelDorner And do the actual RoundTrip ;) Seriously, another thing could be implementing an http based wire protocol. And implement http protocol versions to come."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1574153610, "last_edit_date": 1574153610, "creation_date": 1574152786, "answer_id": 58929760, "question_id": 58929585, "link": "https://stackoverflow.com/questions/58929585/retries-using-httproundtripper/58929760#58929760", "title": "Retries using HTTPRoundTripper", "body": "<p>From my perspective, retries should be dealt with explicitly in your application.</p>\n\n<p>The risk of modifying Roundtripper is that you hide the retry logic at the position in your code where it matters most: when someone (including you, after 6 months) tries to find out what the application does.</p>\n\n<p>The risk being explicitly that the retry logic is missed, and someone comes along seeing code which implicitly assumes the request is successful - and writes a retry logic/error handling at a different point in the code.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>As for retry and backoff, I tend to use <a href=\"https://gopkg.in/cenkalti/backoff.v3\" rel=\"nofollow noreferrer\">https://gopkg.in/cenkalti/backoff.v3</a>, which makes it easy and concise to retry an operation</p>\n\n<pre><code>var (\n   resp *http.Response\n   err error\n)\n\noperation := func() error {\n    resp, err = http.Get(\"http://example.com/\")\n    // Handle Retry-After here, if you wish...\n    // If err is nil, no retry will occur\n    return err\n}\n\nerr := backoff.Retry(operation, backoff.NewExponentialBackOff())\nif err != nil {\n    panic(\"getting resource: permanent error during backoff\")\n}\n\n// resp is non-nil\n</code></pre>\n"}], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 58929760, "answer_count": 1, "score": 2, "last_activity_date": 1574153946, "creation_date": 1574152136, "last_edit_date": 1574153946, "question_id": 58929585, "link": "https://stackoverflow.com/questions/58929585/retries-using-httproundtripper", "title": "Retries using HTTPRoundTripper", "body": "<p>Is <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\"><code>http.RoundTripper</code></a> the right place to implement a retry mechanism for http GET requests based on HTTP status codes (e.g. 429) in Go?</p>\n\n<p>It somehow \"feels right\" (<a href=\"https://play.golang.org/p/qwxgzFKVIvR\" rel=\"nofollow noreferrer\">Go Playground</a>) and does not change the existing interfaces to <code>http.Client</code> or <code>http.Request</code>/<code>http.Response</code>. However, the <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">documentation explicitly states</a>:</p>\n\n<blockquote>\n  <p>RoundTrip should not attempt to interpret the response. </p>\n</blockquote>\n\n<p>and </p>\n\n<blockquote>\n  <p>RoundTrip should not modify the request, except for consuming and\n  closing the Request's Body. </p>\n</blockquote>\n\n<p>Am I already interpreting responses by evaluating HTTP status codes and/or modifying requests by resending failed HTTP requests when I use <code>http.RoundTripper</code> for doing so and, therefore, work against the original intention of <code>http.RoundTripper</code>? Why is it a bad idea (if so)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574151851, "post_id": 58929348, "comment_id": 104118954, "body": "You should redesign and stop mocking. You should test package b and assume it is working correctly while testing package a and just call methods of b. Mocking is a bad technique, especially in Go."}, {"owner": {"reputation": 35, "user_id": 5517849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799099175e6a023be2b04a55a0300d2b?s=128&d=identicon&r=PG&f=1", "display_name": "cainam", "link": "https://stackoverflow.com/users/5517849/cainam"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574152301, "post_id": 58929348, "comment_id": 104119177, "body": "@Volker I&#39;m creating unit testing for my function and need to do this. I see another post about mocking function like this <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go\" title=\"mock functions in go\">stackoverflow.com/questions/19167970/mock-functions-in-go</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574153052, "post_id": 58929348, "comment_id": 104119583, "body": "It is not possible to call <code>b.functionB</code>, whether it&#39;s a function or a method, from <code>a</code> because it is <i>not</i> <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">exported</a>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574154478, "post_id": 58929348, "comment_id": 104120278, "body": "&quot;[I] need to do this&quot;. That&#39;s why I recommend to redesign because you should not do this."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 5517849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799099175e6a023be2b04a55a0300d2b?s=128&d=identicon&r=PG&f=1", "display_name": "cainam", "link": "https://stackoverflow.com/users/5517849/cainam"}, "edited": false, "score": 0, "creation_date": 1574152520, "post_id": 58929510, "comment_id": 104119280, "body": "thank you for your reply but my problem is about the declaration using var in <code>b</code>"}, {"owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "reply_to_user": {"reputation": 35, "user_id": 5517849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799099175e6a023be2b04a55a0300d2b?s=128&d=identicon&r=PG&f=1", "display_name": "cainam", "link": "https://stackoverflow.com/users/5517849/cainam"}, "edited": false, "score": 0, "creation_date": 1574152723, "post_id": 58929510, "comment_id": 104119411, "body": "Your are welcome. It is difficult to answer, because you state your problem in a very abstract way. If you could provide more details of what you actually want to achieve, it would be easier to answer."}], "tags": [], "owner": {"reputation": 4420, "user_id": 1360318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a60c954665247aae8de274c26e843867?s=128&d=identicon&r=PG", "display_name": "mbuechmann", "link": "https://stackoverflow.com/users/1360318/mbuechmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1574152170, "last_edit_date": 1574152170, "creation_date": 1574151849, "answer_id": 58929510, "question_id": 58929348, "link": "https://stackoverflow.com/questions/58929348/testing-function-calling-using-var-declaration-to-mock-the-result/58929510#58929510", "title": "testing function calling using var declaration to mock the result", "body": "<p>If you want to use a definition of one package in another package you have to export it. This is done by letting the definition start with a capital letter. Your type should be defined like this:</p>\n\n<pre><code>type B struct {...}\n</code></pre>\n\n<p>You cannot access a function via its type. This line</p>\n\n<pre><code>var functionB = b.FuncInB\n</code></pre>\n\n<p>will not work, as you can refer to the function only from an existing struct. You shoule remove this line and call it differently (see below).</p>\n\n<p>Your package a has now two minor issues. When you want to use struct <code>B</code> from package <code>b</code> you have to either refer to it like this <code>b.B</code></p>\n\n<pre><code>import \"b\"\n\nb.B{...}\n</code></pre>\n\n<p>or make a dot import for package b:</p>\n\n<pre><code>import . \"b\"\n\nB{...}\n</code></pre>\n\n<p>The last thing is, that you shadow the package name when assigning a variable with the same name as the package. In that, you should use a different variable name:</p>\n\n<pre><code>func (a *a) functionA() {\n    myB := b{...}\n    myB.FunctionB()\n    ...\n}\n</code></pre>\n\n<p>So in the end, your packages should look like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package b\n\ntype B struct {\n    // ...\n}\n\nfunc (b *B) FuncInB() {\n    // ...\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package a\n\nimport \"b\"\n\ntype a struct {\n    // ...\n}\n\nfunc (a *a) functionA () {\n    myB := B {\n        // ...\n    }\n    myB.functionB()\n    // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 5517849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/799099175e6a023be2b04a55a0300d2b?s=128&d=identicon&r=PG&f=1", "display_name": "cainam", "link": "https://stackoverflow.com/users/5517849/cainam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574152170, "creation_date": 1574151198, "last_edit_date": 1574151892, "question_id": 58929348, "link": "https://stackoverflow.com/questions/58929348/testing-function-calling-using-var-declaration-to-mock-the-result", "title": "testing function calling using var declaration to mock the result", "body": "<p>I'm testing a function which called another function in Go. And here's what I have</p>\n\n<pre><code>package b\n\ntype b struct {...}\n\nfunc (b *b) functionB(){...}\n</code></pre>\n\n<pre><code>package a\n\nimport \"b\"\n\ntype a struct {...}\n\nfunc (a *a) functionA() {\n    b := b{...}\n    b.functionB()\n    ...\n}\n</code></pre>\n\n<p>I want to modify the function declaration in <code>b</code> like this:</p>\n\n<pre><code>package b\n\ntype b struct {...}\n\nvar functionB = b.FuncInB\n\nfunc (b *b) FuncInB(){...}\n</code></pre>\n\n<p>so that I can mock the return of <code>functionB</code> in a. However, I got error message in a that says <code>b.functionB</code> is undefined because it should be the function of b object. How can I make this work?</p>\n"}, {"tags": ["go", "archlinux"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1574142896, "post_id": 58927403, "comment_id": 104115542, "body": "Are you sure <code>syscall.Statfs(path, &amp;fs)</code> does not return you an error?"}, {"owner": {"reputation": 1372, "user_id": 2891692, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2Lf2V.jpg?s=128&g=1", "display_name": "SL5net", "link": "https://stackoverflow.com/users/2891692/sl5net"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1574144907, "post_id": 58927403, "comment_id": 104116171, "body": "@zerkms error never happens to me. (same with explicit error <a href=\"https://gist.github.com/8c16fbcb2a96888966c20b4490ceb2ca\" rel=\"nofollow noreferrer\">gist.github.com/8c16fbcb2a96888966c20b4490ceb2ca</a> )"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1574145554, "post_id": 58927403, "comment_id": 104116385, "body": "Good, it was just a general recommendation to not write code that ignores errors."}, {"owner": {"reputation": 303, "user_id": 5333616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PGUDA8SH-yA/AAAAAAAAAAI/AAAAAAAAACI/3lqTNI5j8jA/photo.jpg?sz=128", "display_name": "Maxim Panfilov", "link": "https://stackoverflow.com/users/5333616/maxim-panfilov"}, "edited": false, "score": 0, "creation_date": 1574149064, "post_id": 58927403, "comment_id": 104117777, "body": "On my machine that working good: /boot/efi : All: 0.50 GB Avail: 0.49 GB Used: 0.01 GB  / : All: 467.02 GB Avail: 305.26 GB Used: 137.97 GB"}, {"owner": {"reputation": 1372, "user_id": 2891692, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2Lf2V.jpg?s=128&g=1", "display_name": "SL5net", "link": "https://stackoverflow.com/users/2891692/sl5net"}, "reply_to_user": {"reputation": 303, "user_id": 5333616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PGUDA8SH-yA/AAAAAAAAAAI/AAAAAAAAACI/3lqTNI5j8jA/photo.jpg?sz=128", "display_name": "Maxim Panfilov", "link": "https://stackoverflow.com/users/5333616/maxim-panfilov"}, "edited": false, "score": 0, "creation_date": 1574158323, "post_id": 58927403, "comment_id": 104122372, "body": "@MaximPanfilov here its mounted via <code>mount -t nfs afp:&#47;&#47;ix4-300d.local:share &#47;mnt&#47;ix4300d</code>. its an old NAS (ix4-200d)"}, {"owner": {"reputation": 1372, "user_id": 2891692, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2Lf2V.jpg?s=128&g=1", "display_name": "SL5net", "link": "https://stackoverflow.com/users/2891692/sl5net"}, "edited": false, "score": 0, "creation_date": 1574247244, "post_id": 58927403, "comment_id": 104161239, "body": "It might be a bug in xfce (<a href=\"https://bugzilla.xfce.org/show_bug.cgi?id=16202\" rel=\"nofollow noreferrer\">bugzilla.xfce.org/show_bug.cgi?id=16202</a>)"}], "owner": {"reputation": 1372, "user_id": 2891692, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2Lf2V.jpg?s=128&g=1", "display_name": "SL5net", "link": "https://stackoverflow.com/users/2891692/sl5net"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 233, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1574154287, "creation_date": 1574142368, "last_edit_date": 1574154287, "question_id": 58927403, "link": "https://stackoverflow.com/questions/58927403/disk-usage-info", "title": "Disk Usage info", "body": "<p>I first wrote a sh-bash (<a href=\"https://gist.github.com/19286d19b906a98030cfa838d5ae0187\" rel=\"nofollow noreferrer\">Disk Info sh-script</a>) script, and now a similar script in Go. The Go program shows mounted from server directories wrong by me.</p>\n\n<p>I using:</p>\n\n<p>Kernel: 5.3.11-1-MANJARO x86_64 bits: 64 compiler: gcc v: 9.2.0 Desktop: Xfce 4.14.1 tk: Gtk 3.24.12 \n           info: xfce4-panel wm: xfwm4 dm: LightDM 1.30.0 Distro: Manjaro Linux </p>\n\n<p>Here is the Go program:</p>\n\n<pre><code>//pacman -S go\n//go get -u golang.org/x/sys/unix\n\npackage main\n\nimport (\n    \"fmt\"\n    syscall \"golang.org/x/sys/unix\"\n)\n\ntype DiskStatus struct {\n    All   uint64 `json:\"all\"`\n    Used  uint64 `json:\"used\"`\n    Free  uint64 `json:\"free\"`\n    Avail uint64 `json:\"avail\"`\n}\n\n// disk usage of path/disk\nfunc DiskUsage(path string) (disk DiskStatus) {\n    fs := syscall.Statfs_t{}\n    err := syscall.Statfs(path, &amp;fs)\n    if err != nil {\n        return\n    }\n    disk.All = fs.Blocks * uint64(fs.Bsize)\n    disk.Avail = fs.Bavail * uint64(fs.Bsize)\n    disk.Free = fs.Bfree * uint64(fs.Bsize)\n    disk.Used = disk.All - disk.Free\n    return\n}\n\nconst (\n    B  = 1\n    KB = 1024 * B\n    MB = 1024 * KB\n    GB = 1024 * MB\n)\n\nfunc main() {\n    path := \"/\"\n    funcName(\"/mnt/ix4\")\n    funcName(\"/mnt/ix4300d\")\n    funcName(path)\n    //funcName(\"192.168.178.42/share\")\n}\n\nfunc funcName(path string) {\n    disk := DiskUsage(path)\n    fmt.Println(\"\")\n    fmt.Println(path, \":\")\n    fmt.Printf(\"All: %.2f GB\\n\", float64(disk.All)/float64(GB))\n    fmt.Printf(\"Avail: %.2f GB\\n\", float64(disk.Avail)/float64(GB))\n    fmt.Printf(\"Used: %.2f GB\\n\", float64(disk.Used)/float64(GB))\n}\n</code></pre>\n\n<p>the correct values for /mnt/ix4300d\nare</p>\n\n<pre><code>5216716992 = blocks_avail\n5216 GB free\n9%used 192.168.178.42:/share\n</code></pre>\n\n<p>the Golang version gives me for /mnt/ix4300d\nare</p>\n\n<pre><code>/mnt/ix4300d :\nAll: 862.34 GB\nAvail: 180.74 GB\nUsed: 637.73 GB\n</code></pre>\n\n<p>Go gives the same values \u200b\u200bas my system partition (\"/\").</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 1, "creation_date": 1574139652, "post_id": 58926538, "comment_id": 104114646, "body": "The implementation can differ based upon your environment. Take a look at this article. You may find your answer here. <a href=\"https://www.socketloop.com/tutorials/golang-display-list-of-timezones-with-gmt\" rel=\"nofollow noreferrer\">socketloop.com/tutorials/&hellip;</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 7, "creation_date": 1574149730, "post_id": 58926538, "comment_id": 104118054, "body": "You <i>are</i> aware that the answer is ambiguous? That there are multiple localities for any given offset?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574154495, "post_id": 58926538, "comment_id": 104120288, "body": "Related: <a href=\"https://stackoverflow.com/q/55411566/13860\">stackoverflow.com/q/55411566/13860</a> <a href=\"https://stackoverflow.com/questions/54552101/how-to-construct-time-time-with-timezone-offset-in-go\" title=\"how to construct time time with timezone offset in go\">stackoverflow.com/questions/54552101/&hellip;</a> <a href=\"https://stackoverflow.com/questions/51346476/how-to-get-timezone-from-country\" title=\"how to get timezone from country\">stackoverflow.com/questions/51346476/&hellip;</a>"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 1, "creation_date": 1574159072, "post_id": 58926538, "comment_id": 104122845, "body": "Not only are there multiple timezones per offset, the location also shifts with daylight saving time. This is something you do not want to do."}, {"owner": {"reputation": 83, "user_id": 3953646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec8fc67aabddcfb4fda8b24adc957c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoliy Fedorenko", "link": "https://stackoverflow.com/users/3953646/anatoliy-fedorenko"}, "edited": false, "score": 0, "creation_date": 1574163331, "post_id": 58926538, "comment_id": 104125348, "body": "right, I know. it was not really matter for my needs which one in particular would be used. But I guess that is not relevant anymore. I just decided to parse the offset and get location with FixedZone func"}], "owner": {"reputation": 83, "user_id": 3953646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec8fc67aabddcfb4fda8b24adc957c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Anatoliy Fedorenko", "link": "https://stackoverflow.com/users/3953646/anatoliy-fedorenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1574154302, "creation_date": 1574136757, "last_edit_date": 1574154302, "question_id": 58926538, "link": "https://stackoverflow.com/questions/58926538/get-timezone-name-from-offset", "title": "Get Timezone name from offset", "body": "<p>I need to get a timezone name like <code>Asia/Bishkek</code> from a given timezone offset like \"GMT+6\" using Go. Right now the only solution i can think of is to make a map of all the offsets as keys and timezone names as values (even the single tz name is enough for my needs) and use that map. Does anyone know a better solution? </p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574129635, "post_id": 58925619, "comment_id": 104112484, "body": "Have you tried this without Gopkg.lock?"}, {"owner": {"reputation": 1562, "user_id": 3053228, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003319530324/picture?type=large", "display_name": "prashant", "link": "https://stackoverflow.com/users/3053228/prashant"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574129867, "post_id": 58925619, "comment_id": 104112515, "body": "you mean I should delete goplkg.lock and then try go mod init?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574129967, "post_id": 58925619, "comment_id": 104112533, "body": "Yes, that&#39;s what I would try. Looks like that module is at v28 already."}, {"owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "edited": false, "score": 0, "creation_date": 1574130075, "post_id": 58925619, "comment_id": 104112560, "body": "What does &#39;go get -u&#39; say?"}, {"owner": {"reputation": 1562, "user_id": 3053228, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003319530324/picture?type=large", "display_name": "prashant", "link": "https://stackoverflow.com/users/3053228/prashant"}, "edited": false, "score": 0, "creation_date": 1574130267, "post_id": 58925619, "comment_id": 104112604, "body": "go get .: path /home/prary3/go_projects/src/github.com/GoogleContainerTools&zwnj;&#8203;/kaniko is not a package in module rooted at /home/prary3/go_projects/src/github.com/GoogleContainerTools&zwnj;&#8203;/kaniko"}, {"owner": {"reputation": 1562, "user_id": 3053228, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003319530324/picture?type=large", "display_name": "prashant", "link": "https://stackoverflow.com/users/3053228/prashant"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1574130328, "post_id": 58925619, "comment_id": 104112617, "body": "@BurakSerdar that helped but faced new issue after running go mod tidy  go: github.com/GoogleContainerTools/kaniko/pkg/util imports         github.com/minio/HighwayHash: github.com/minio/HighwayHash@v1.0.0: parsing go.mod:         module declares its path as: github.com/minio/highwayhash                 but was required as: github.com/minio/HighwayHash"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1574130821, "post_id": 58925619, "comment_id": 104112717, "body": "It looks like a capitalization problem. You might need to change your include path to highwayhash, but I&#39;ve never seen this myself so I  may be wrong."}, {"owner": {"reputation": 1562, "user_id": 3053228, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003319530324/picture?type=large", "display_name": "prashant", "link": "https://stackoverflow.com/users/3053228/prashant"}, "edited": false, "score": 0, "creation_date": 1574135176, "post_id": 58925619, "comment_id": 104113619, "body": "updated the fresh errors"}], "answers": [{"comments": [{"owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "edited": false, "score": 0, "creation_date": 1574147968, "post_id": 58928466, "comment_id": 104117292, "body": "Except containerd is a depenedency of <code>moby&#47;buildkit</code>, and not the project from the asker. Try to update everything using <code>go get -u</code>."}], "tags": [], "owner": {"reputation": 1161, "user_id": 6013663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4a7b2e785ad782e5103fd679b9ec849?s=128&d=identicon&r=PG", "display_name": "Masudur Rahman", "link": "https://stackoverflow.com/users/6013663/masudur-rahman"}, "is_accepted": false, "score": 2, "last_activity_date": 1574147576, "creation_date": 1574147576, "answer_id": 58928466, "question_id": 58925619, "link": "https://stackoverflow.com/questions/58925619/upgrading-golang-through-modules/58928466#58928466", "title": "Upgrading golang through modules", "body": "<p>It seems there's a problem with the <code>containerd</code> commit you are using. You can replace that with a working <code>containerd</code> version or commit. </p>\n\n<p>You can achieve this by adding the following section to your <code>go.mod</code> file.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>replace (\n    github.com/containerd/containerd v1.3.0-0.20190507210959-7c1e88399ec0 =&gt; github.com/containerd/containerd v1.3.0\n)\n</code></pre>\n\n<p><br>\nIf you want to have the recent changes in your project, you can use the following instead of the previous section.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>replace (\n    github.com/containerd/containerd v1.3.0-0.20190507210959-7c1e88399ec0 =&gt; github.com/containerd/containerd v1.3.1-0.20191118201915-499f346be357\n)\n</code></pre>\n\n<p>Reference : <a href=\"https://github.com/containerd/containerd/issues/3031#issuecomment-541737892\" rel=\"nofollow noreferrer\">https://github.com/containerd/containerd/issues/3031#issuecomment-541737892</a></p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1611572991, "last_edit_date": 1611572991, "creation_date": 1605382157, "answer_id": 64837822, "question_id": 58925619, "link": "https://stackoverflow.com/questions/58925619/upgrading-golang-through-modules/64837822#64837822", "title": "Upgrading golang through modules", "body": "<p>Update Nov. 2020, from <a href=\"https://github.com/containerd/containerd/issues/3031#issuecomment-690619939\" rel=\"nofollow noreferrer\">issue 3031</a> and <a href=\"https://github.com/containerd/cri/pull/1377#issuecomment-705172957\" rel=\"nofollow noreferrer\"><code>containerd/cri</code> PR1377</a></p>\n<p><code>go mod init</code> should now work. The move to go modules has been completed for <a href=\"https://github.com/containerd/containerd\" rel=\"nofollow noreferrer\"><code>github.com/containerd/containerd</code></a>.</p>\n<p>The go.mod looks complete:</p>\n<p>module github.com/containerd/containerd</p>\n<pre><code>go 1.15\n\nrequire (\n        github.com/BurntSushi/toml v0.3.1\n        github.com/Microsoft/go-winio v0.4.15-0.20200908182639-5b44b70ab3ab\n        github.com/Microsoft/hcsshim v0.8.10\n        ...\n</code></pre>\n<p>Update Jan. 2021: <a href=\"https://github.com/containerd/containerd/issues/3031#issuecomment-766701615\" rel=\"nofollow noreferrer\"><code>containerd/containerd</code> issue 3031</a> just got completed with <a href=\"https://github.com/containerd/containerd/pull/4760\" rel=\"nofollow noreferrer\">PR 4760</a> &quot;Move to Go modules&quot;.</p>\n<p><a href=\"https://github.com/containerd/containerd/commit/fbf1a72de7da110187b7d3dace433914b9beca10\" rel=\"nofollow noreferrer\">Commit fbf1a72</a> from last Dec. 2020 has all the details, with a <a href=\"https://github.com/containerd/containerd/blob/fbf1a72de7da110187b7d3dace433914b9beca10/go.mod\" rel=\"nofollow noreferrer\">brand new <code>go.mod</code></a>.</p>\n"}], "owner": {"reputation": 1562, "user_id": 3053228, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003319530324/picture?type=large", "display_name": "prashant", "link": "https://stackoverflow.com/users/3053228/prashant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1611572991, "creation_date": 1574129320, "last_edit_date": 1574135109, "question_id": 58925619, "link": "https://stackoverflow.com/questions/58925619/upgrading-golang-through-modules", "title": "Upgrading golang through modules", "body": "<p>I am upgrading my project dependencies through golang modules. Ran </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>mod init\n</code></pre>\n\n<p>command and got this issue, not sure how to resolve.</p>\n\n<pre><code>$ go mod init \ngo: creating new go.mod: module github.com/GoogleContainerTools/kaniko\ngo: copying requirements from Gopkg.lock\ngo: converting Gopkg.lock: stat github.com/google/go-github@v18.2.0: github.com/google/go-github@v18.2.0: invalid version: module contains a go.mod file, so major version must be compatible: should be v0 or v1, not v18\n</code></pre>\n\n<p>Invalid version: module contains a go.mod file, so major version must be compatible: should be v0 or v1, not v18</p>\n\n<p>Updates: </p>\n\n<pre><code>removed Gopkg.toml\ngo mod init\ngo build\nfixed some dependencies related to HighwayHash\nfinally stuck on below error\n</code></pre>\n\n<pre><code>go: github.com/moby/buildkit@v0.6.3 requires\n        github.com/containerd/containerd@v1.3.0-0.20190507210959-7c1e88399ec0: invalid pseudo-version: version before v1.3.0 would have negative patch number\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 0, "creation_date": 1574123438, "post_id": 58924842, "comment_id": 104111266, "body": "What&#39;s the value of your GOPATH environment variable?"}, {"owner": {"reputation": 11, "user_id": 6709105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebbf4faff675b91a57d73d5479134ab9?s=128&d=identicon&r=PG&f=1", "display_name": "mwdoerner", "link": "https://stackoverflow.com/users/6709105/mwdoerner"}, "reply_to_user": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 1, "creation_date": 1574123531, "post_id": 58924842, "comment_id": 104111284, "body": "@J.B It is <code>C:\\Users\\bob\\Documents\\go</code>"}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "is_accepted": true, "score": 0, "last_activity_date": 1574127919, "creation_date": 1574127919, "answer_id": 58925460, "question_id": 58924842, "link": "https://stackoverflow.com/questions/58924842/import-package-from-same-project-in-go/58925460#58925460", "title": "Import package from same project in go", "body": "<p>the import statement should be the path after src, so in this case <code>prj_temp/proto_messages</code> is correct.</p>\n\n<p>On jenkins, make sure you copy the code into the correct folder: <code>$GOPATH/src/prj_temp</code> (whatever the gopath is on jenkins)</p>\n\n<p>Additionally, I recommend nesting your projects into an organization level directory, to follow the convention. Even if you have no plans to push this to a github repo, I recommend you keep your project locally at <code>C:\\Users\\bob\\Documents\\go\\src\\github.com\\bob\\someproject</code> and change all your imports to <code>github.com/bob/someproject/proto_messages</code>. I think it will make things easier when you start fetching 3rd party projects.</p>\n\n<p><em>Disclaimer: answer is based on knowledge I acquired prior to the release of go modules. Some of the above may no longer be necessary or recommended when fully utilizing go modules.</em></p>\n"}], "owner": {"reputation": 11, "user_id": 6709105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebbf4faff675b91a57d73d5479134ab9?s=128&d=identicon&r=PG&f=1", "display_name": "mwdoerner", "link": "https://stackoverflow.com/users/6709105/mwdoerner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 58925460, "answer_count": 1, "score": 0, "last_activity_date": 1574127919, "creation_date": 1574122591, "question_id": 58924842, "link": "https://stackoverflow.com/questions/58924842/import-package-from-same-project-in-go", "title": "Import package from same project in go", "body": "<p>I have a question regarding the package structure in Go. I have a project structured like this in my src directory:</p>\n\n<pre><code>- project\n    - proto_messages\n    - client\n        - clientcode.go\n    - server\n        - servercode.go\n</code></pre>\n\n<p>In my client and server code I use imports like this: \"../proto_messages\" and it builds on my jenkins without any problems. The problem is, that I can't develop like this - VS Code/Go delivers the following error:</p>\n\n<pre><code>unexpected directory layout:\n    import path: _/C_/Users/bob/Documents/go/src/prj_temp/proto_messages\n    root: C:\\Users\\bob\\Documents\\go\\src\n    dir: C:\\Users\\bob\\Documents\\go\\src\\prj_temp\\proto_messages\n    expand root: C:\\Users\\bob\\Documents\\go\n    expand dir: C:\\Users\\bob\\Documents\\go\\src\\prj_temp\\proto_messages\n    separator: \\\n\n</code></pre>\n\n<p>when I change the import statement to \"prj_temp/proto_messages\" it works locally, but the jenkins build failes as it can't find the proto_messages package. Any ideas?</p>\n\n<p>Greetings\nBob</p>\n"}, {"tags": ["go", "wrapper", "channel", "knative"], "answers": [{"tags": [], "owner": {"reputation": 72, "user_id": 5419764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff33d1d86e64b81e9367b01d97b24286?s=128&d=identicon&r=PG&f=1", "display_name": "Britt", "link": "https://stackoverflow.com/users/5419764/britt"}, "is_accepted": false, "score": 1, "last_activity_date": 1574127642, "creation_date": 1574127642, "answer_id": 58925430, "question_id": 58923740, "link": "https://stackoverflow.com/questions/58923740/create-wrapper-for-multiple-instances-of-an-event-handler/58925430#58925430", "title": "Create wrapper for multiple instances of an Event Handler", "body": "<p>Presumably, you should be able to differentiate events by using the different sources/methods coming from that event. A quick look at the <a href=\"https://github.com/cloudevents/spec/blob/master/spec.md#event\" rel=\"nofollow noreferrer\">event spec</a> shows you could split into channels based on source, for example.</p>\n\n<p>The main thing I see that isn't being utilized here is the context object. It seems you could glean the source from that context. This can be seen in their <a href=\"https://knative.dev/docs/eventing/samples/helloworld/helloworld-go/\" rel=\"nofollow noreferrer\">hello world</a> example (check out the receive function).</p>\n\n<p>For your example:</p>\n\n<pre><code>// these are all the handlers for the different sources.\ntype EventHandlers map[string]CloudEventHandler\n\nvar _eventHandlerKey = \"cloudEventHandlers\"\n\nfunc HandlerWrapper(ctx context.Context, event cloudevents.Event) {\n    // Get event source from event context.\n    src := event.Context.Source\n    // Then get the appropriate handler for that source (attached to context).\n    handler := ctx.Value(_eventHandlers).(Values)[src]\n    // ex: src = \"/foo\" \n    handler.SendToChannel(event)\n}\n\nfunc main() {\n    eventHandlers := make(map[string]CloudEventHandler)\n    // create all the channels we need, add it to the context.\n    for _, source := range sourceTypes { // foo bar baz\n        handler := NewHandler(source)\n        eventHandlers[source] = handler\n    }\n\n  // start HTTP server\n  go func() {\n    // Add the handlers to the context.\n    context := context.WithValue(context.Background(), _eventHandlerKey, eventHandlers)\n    log.Fatal(c.StartReceiver(context.Background(), HandlerWrapper))\n  }\n}()\n\n</code></pre>\n\n<p>If there are say 3 different sources to be supported, you can use the <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\" rel=\"nofollow noreferrer\">factory pattern</a> to instantiate those different channels and an interface that all of those implement.</p>\n\n<pre><code>// CloudEventHandler Handles sending cloud events to the proper channel for processing.\ntype CloudEventHandler interface {\n    SendToChannel(cloudEvents.Event)\n}\n\ntype fooHandler struct {channel chan string}\ntype barHandler struct {channel chan int}\ntype bazHandler struct {channel chan bool}\n\nfunc NewHandler(source string) CloudEventHandler {\n    switch source {\n    case \"/foo\":\n        return &amp;fooHandler{channel: make(chan string, 2)} // buffered channel\n    case \"/bar\":\n        return &amp;barHandler{channel: make(chan int, 2)}\n    case \"/baz\":\n        return &amp;bazHandler{channel: make(chan bool, 2)}\n    }\n}\n\nfunc (fh *fooHandler) SendToChannel(event CloudEvents.Event) {\n    var data string\n    if err := event.DataAs(&amp;data); err != nil {\n        // (...)\n    }\n\n    go func() {\n        fh.channel &lt;- data\n    }()\n}\n\nfunc (bh *barHandler) SendToChannel(event CloudEvents.Event) {\n    var data int\n    if err := event.DataAs(&amp;data); err != nil {\n        // (...)\n    }\n\n    go func() {\n        bh.channel &lt;- data\n    }()\n}\n</code></pre>\n"}], "owner": {"reputation": 875, "user_id": 1118461, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WFNAP.png?s=128&g=1", "display_name": "Zed_Blade", "link": "https://stackoverflow.com/users/1118461/zed-blade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574155082, "creation_date": 1574115523, "last_edit_date": 1574155082, "question_id": 58923740, "link": "https://stackoverflow.com/questions/58923740/create-wrapper-for-multiple-instances-of-an-event-handler", "title": "Create wrapper for multiple instances of an Event Handler", "body": "<p>I'm trying to deal with a problem (most probably a design one) regarding the usage of Channels and the proper handling of those.\nI'm using Knative Eventing/Cloud Events to create and eventing pipeline.</p>\n\n<p>I want to be able to handle different channels in order to receive events originating from different sources/methods.</p>\n\n<p>In order to do so, I have the implementation that follows (code has been removed in order to be concise with detailing the issue).</p>\n\n<p>I have a <code>file1.go</code> which defines a <code>EventHandler</code> struct, associated methods and a couple of exported methods (<code>CreatePreview()</code> and <code>SaveAndPublish()</code>) that are the \"normal\" behaviour of the app and that actually receives/deals with whatever value comes on the Channel:</p>\n\n<pre><code>type EventHandler struct {\n  Channel chan string\n}\n\nfunc (ev *EventHandler) Handle(event cloudevents.Event) {\n  if event.Data == nil {\n    (...)\n  }\n\n  var data string\n  if err := event.DataAs(&amp;data); err != nil {\n    (...)\n  }\n\n  ev.Channel &lt;- data\n\n  defer close(ev.Channel)\n}\n\nfunc (ev *EventHandler) Create(param *Element) (error) {\n  (...) //Unimportant code\n}\n\nfunc (repo *Repository) CreatePreview(param1 string, param2 string, eventHandler *EventHandler) (*pb.PreviewResponse, error) {\n  (...)\n  err := eventHandler.Create(&amp;document)\n  (...)\n  preview := &lt;- eventHandler.Channel\n  (...)\n}\n\nfunc (repo *Repository) SaveAndPublish(param1 string, param2 bool, eventHandler *EventHandler) (*pb.PublishResponse, error) {\n\n  (...)\n  err := eventHandler.Create(&amp;documentToUpdate)\n  (...)\n\n  published := &lt;- eventHandler.Channel\n  (...)\n  return repo.SomeOtherMethod(published.ID)\n}\n</code></pre>\n\n<p>Now, on my <code>main.go</code> function, I have the \"regular\" start of a service, including a gRPC Listener, a HTTP Listener and handling of events. This is done via <code>cmux</code>. So here's a sample of the code (again, code simplified):</p>\n\n<pre><code>func HandlerWrapper(event cloudevents.Event) {\n    //TODO: HOW DO I HANDLE THIS???\n}\n\n// This approach seems to cause issues since it's always the same instance\n// var (\n//  eventHandler = &amp;rep.EventHandler{Channel: make(chan string)}\n// )\n\nfunc (service *RPCService) Start() (err error) {\n\n  port, err := strconv.Atoi(os.Getenv(\"LISTEN_PORT\"))\n  if err != nil {\n    log.Fatalf(\"failed to listen: %v\", err)\n  }\n\n  lis, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", port))\n  if err != nil {\n    log.Fatalf(\"failed to listen: %v\", err)\n  }\n\n  // Create multiplexer and listener types\n  mux := cmux.New(lis)\n  grpcLis := mux.Match(cmux.HTTP2())\n  httpLis := mux.Match(cmux.HTTP1())\n\n  // *************\n  // gRPC\n  // *************\n  service.server = grpc.NewServer()\n  reflection.Register(service.server)\n  pb.RegisterStoryServiceServer(service.server, service)\n\n  // *************\n  // HTTP\n  // *************\n\n  // Declare new CloudEvents Receiver\n  c, err := kncloudevents.NewDefaultClient(httpLis)\n  if err != nil {\n    log.Fatal(\"Failed to create client, \", err)\n  }\n\n  // *************\n  // Start Listeners\n  // *************\n\n  // start gRPC server\n  go func() {\n    if err := service.server.Serve(grpcLis); err != nil {\n      log.Fatalf(\"failed to gRPC serve: %s\", err)\n    }\n  }()\n\n  // start HTTP server\n  go func() {\n    // With this line bellow, I'd have to create a Received per eventHandler. Not cool\n    // log.Fatal(c.StartReceiver(context.Background(), eventHandler.Handle))\n\n    // Here we use a wrapper to deal with the event handling and have a single listener\n    log.Fatal(c.StartReceiver(context.Background(), HandlerWrapper))\n  }()\n\n  if err := mux.Serve(); err != nil {\n    log.Fatalf(\"failed to Mux serve: %s\", err)\n  }\n\n  return\n}\n\n//CreatePreview is used to save a preview for a story \nfunc (service *RPCService) CreatePreview(ctx context.Context, input *pb.PreviewRequest) (*pb.PreviewResponse, error){\n\n  eventHandler := &amp;rep.EventHandler{Channel: make(chan string)}\n\n  story, err := service.repo.CreatePreview(\"param1\", \"param2\", eventHandler)\n  if err != nil {\n    return nil, err\n  }\n\n  // Return matching the `CreatePreviewResponse` message we created in our\n  // protobuf definition.\n  return &amp;pb.PreviewResponse{Story: story}, nil\n}\n\n// SaveAndPublish is used to save a story and publish it, returning the story saved. \nfunc (service *RPCService) SaveAndPublish(ctx context.Context, input *pb.PublishRequest) (*pb.PublishResponse, error){\n\n  eventHandler := &amp;rep.EventHandler{Channel: make(chan string)}\n\n  story, err := service.repo.SaveAndPublish(\"param1\", true, eventHandler)\n\n  if err != nil {\n    return nil, err\n  }\n\n  // Return matching the `SaveAndPublishResponse` message we created in our\n  // protobuf definition.\n  return &amp;pb.PublishResponse{Story: story}, nil\n}\n</code></pre>\n\n<p>Now, I know that instead of having to instantiate a single, global <code>eventHandler</code>, in order to use the <code>eventHandler.Handle</code> method on <code>c.StartReceiver()</code> on <code>main.go</code> I can define a wrapper that would, maybe, contain a list of eventHandlers (the <code>HandlerWrapper()</code> method on <code>main.go</code>).</p>\n\n<p>However, I do not know how I could identify which instance of an <code>EventHandler</code> is which and how to properly handle and route these operations, and that is my question:</p>\n\n<p>How do I go about this case where I want to create a Wrapper (a single function to pass into <code>c.StartReceive()</code>) and then let it be handled by the correct instance of <code>Handle()</code>?</p>\n\n<p>I hope the question is clear. I've been trying to get my head around this for a couple days already and can't figure out how to do it.</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574104915, "post_id": 58921222, "comment_id": 104104260, "body": "<code>gorm.Model</code> already has an <code>ID</code> field, so either remove or rename yours, or don&#39;t embed <code>gorm.Model</code> (if that&#39;s even possible)."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574105021, "post_id": 58921222, "comment_id": 104104326, "body": "<a href=\"https://gorm.io/docs/conventions.html\" rel=\"nofollow noreferrer\">gorm.io/docs/conventions.html</a>"}, {"owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574105235, "post_id": 58921222, "comment_id": 104104448, "body": "I thought that may be the case, it&#39;s weird that all of the online <code>gorm</code> tutorials include an <code>ID</code> field in the model. I imagine it&#39;s also unique and auto incremented by default? (stupid question, i know, but just making sure)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574105525, "post_id": 58921222, "comment_id": 104104585, "body": "... looking at the generated <code>CREATE TABLE</code> command I would say yes, the <code>AUTO_INCREMENT</code> is being used and both <code>id</code> columns, the original and yours, are included at the end in the <code>PRIMARY KEY</code> clause. The struct tag in the model&#39;s source says only <code>primary_key</code>... I&#39;m not sure if that by default means auto-increment as well or whether they assign auto-increment using some other rule."}], "owner": {"reputation": 1792, "user_id": 3068500, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/0cf641fb92b7fd2625f7690aac7f424c?s=128&d=identicon&r=PG&f=1", "display_name": "Gambit2007", "link": "https://stackoverflow.com/users/3068500/gambit2007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 467, "favorite_count": 0, "closed_date": 1574108063, "answer_count": 0, "score": 0, "last_activity_date": 1574107985, "creation_date": 1574103714, "last_edit_date": 1574107985, "question_id": 58921222, "link": "https://stackoverflow.com/questions/58921222/getting-a-duplicate-column-name-id-error-when-using-gorms-automigrate", "closed_reason": "Duplicate", "title": "Getting a &quot;Duplicate column name &#39;id&#39;&quot; error when using gorm&#39;s AutoMigrate", "body": "<p>I have a model in <code>gorm</code> that looks something like this:</p>\n\n<pre><code>type MyModel struct {\n    gorm.Model\n    ID                               int `gorm:\"primary_key;AUTO_INCREMENT;not null;unique\"`\n    CountryID                        int `gorm:\"not null\"`\n    SomeID                       int `gorm:\"not null;unique\"`\n...\n...\n</code></pre>\n\n<p>But when I run:</p>\n\n<pre><code>server.DB.Debug().AutoMigrate(&amp;models.MyModel{})\n</code></pre>\n\n<p>I see that the following query is being run on the DB:</p>\n\n<pre><code>CREATE TABLE `my_model` (`id` int unsigned AUTO_INCREMENT,`created_at` timestamp NULL,`updated_at` timestamp NULL,`deleted_at` timestamp NULL,`id` int AUTO_INCREMENT NOT NULL UNIQUE,`country_id` int NOT NULL,varchar(255),`has_self` boolean,`limit` boolean , PRIMARY KEY (`id`,`id`))  \n</code></pre>\n\n<p>And I get the error:</p>\n\n<blockquote>\n  <p>Error 1060: Duplicate column name 'id'</p>\n</blockquote>\n\n<p>Why is this happening and how can I fix it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "edited": false, "score": 3, "creation_date": 1574100622, "post_id": 58920549, "comment_id": 104102380, "body": "duh...go ahead and slam me...i am initializing the array with a length of 3 then appending..."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1574100682, "post_id": 58920549, "comment_id": 104102407, "body": "You&#39;re working with a slice, not an array."}, {"owner": {"reputation": 897, "user_id": 1861929, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/5c134ef910060cb631a127701578dad5?s=128&d=identicon&r=PG", "display_name": "Hubert", "link": "https://stackoverflow.com/users/1861929/hubert"}, "edited": false, "score": 2, "creation_date": 1574159538, "post_id": 58920549, "comment_id": 104123132, "body": "Is it only my impression that questions about go are much more often downvoted than questions from other categories (-2 at the time of writing this comment)? This one is perfectly valid for me. Upvote."}], "answers": [{"tags": [], "owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "is_accepted": true, "score": 4, "last_activity_date": 1615228961, "last_edit_date": 1615228961, "creation_date": 1574100694, "answer_id": 58920582, "question_id": 58920549, "link": "https://stackoverflow.com/questions/58920549/why-do-i-get-6-entries-in-an-array-created-from-a-map-with-only-3-entities/58920582#58920582", "title": "Why do I get 6 entries in an array created from a map with only 3 entities?", "body": "<p>With</p>\n<pre><code>keys := make([]string, len(supportedCards))\n</code></pre>\n<p>you create a <code>[]string</code> with three empty elements. You can assign them using their indicies.</p>\n<p>When you append it later, new entries are added at the end, producing your result with a length of 6, where the first three are empty.</p>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 11900571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3127066989e308d523b778000254c7cb?s=128&d=identicon&r=PG", "display_name": "Dat Ngo", "link": "https://stackoverflow.com/users/11900571/dat-ngo"}, "is_accepted": false, "score": 1, "last_activity_date": 1574580348, "creation_date": 1574580348, "answer_id": 59015506, "question_id": 58920549, "link": "https://stackoverflow.com/questions/58920549/why-do-i-get-6-entries-in-an-array-created-from-a-map-with-only-3-entities/59015506#59015506", "title": "Why do I get 6 entries in an array created from a map with only 3 entities?", "body": "<p>In addition to @xarantolus's answer, instead of using indices you can keep your for-range loop unchanged by:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>keys := make([]string, 0, len(supportedCards))\n</code></pre>\n\n<p>The third argument is capacity of the slide. Ref: <a href=\"https://tour.golang.org/moretypes/13\" rel=\"nofollow noreferrer\">https://tour.golang.org/moretypes/13</a></p>\n"}], "owner": {"reputation": 7545, "user_id": 370605, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/r8v6e.png?s=128&g=1", "display_name": "beauXjames", "link": "https://stackoverflow.com/users/370605/beauxjames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58920582, "answer_count": 2, "score": 0, "last_activity_date": 1615228961, "creation_date": 1574100542, "last_edit_date": 1574100722, "question_id": 58920549, "link": "https://stackoverflow.com/questions/58920549/why-do-i-get-6-entries-in-an-array-created-from-a-map-with-only-3-entities", "title": "Why do I get 6 entries in an array created from a map with only 3 entities?", "body": "<p>I have a seemingly simple issue with my understanding of map types in Go. If I create a simple map such as </p>\n\n<pre><code>var thisMap = map[string]string {\n  \"8f14e45fceea167a5a36dedd4bea2543\": \"Charming\",\n  \"1679091c5a880faf6fb5e6087eb1b2dc\": \"Citi\",\n  \"e4da3b7fbbce2345d7772b0674a318d5\": \"Chase\",\n}\n</code></pre>\n\n<p>Populate the keys into an array</p>\n\n<pre><code>keys := make([]string, len(supportedCards))\nfor k := range supportedCards {\n    keys = append(keys, k)\n}\n</code></pre>\n\n<p>Then try to join these keys into a comma separated value that I can append to any string</p>\n\n<pre><code>fmt.Println(strings.Join(keys,\",\"))\n</code></pre>\n\n<p>I expect the result to be </p>\n\n<pre><code>8f14e45fceea167a5a36dedd4bea2543,1679091c5a880faf6fb5e6087eb1b2dc,e4da3b7fbbce2345d7772b0674a318d5\n</code></pre>\n\n<p>But what I really see is</p>\n\n<pre><code>,,,8f14e45fceea167a5a36dedd4bea2543,1679091c5a880faf6fb5e6087eb1b2dc,e4da3b7fbbce2345d7772b0674a318d5\n</code></pre>\n\n<p>Why does iterating through the map create 6 entries instead of just 3?</p>\n\n<p><a href=\"https://play.golang.org/p/Ou67K1Kfvsf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ou67K1Kfvsf</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1574091883, "post_id": 58918013, "comment_id": 104097814, "body": "a <code>Reader</code> itself is not interrupt-able. If the underlying type happens to have a <code>Close</code> method that will interrupt the <code>Read</code>, you could assert to that type first, but not all Reads can be interrupted in the first place."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1574092411, "post_id": 58918013, "comment_id": 104098122, "body": "Can you provide more details? As written the question doesn&#39;t make sense - the Reader would need some way to receive any signal you want to be able to send it. Nothing outside of that reader is going to be able to magically make that happen if the reader has no way internally to signal that."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574094628, "post_id": 58918013, "comment_id": 104099380, "body": "This looks a lot like an XY Problem. Can you step back a bit and explain the larger problem you&#39;re trying to solve?"}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1574096095, "post_id": 58919334, "comment_id": 104100179, "body": "Don&#39;t just link to code, include it in the answer. Links may become invalid over time, rendering the answer useless."}, {"owner": {"reputation": 9, "user_id": 1424447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd09393421512c02d8c0c95c293c02d0?s=128&d=identicon&r=PG", "display_name": "pakohan", "link": "https://stackoverflow.com/users/1424447/pakohan"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1574096519, "post_id": 58919334, "comment_id": 104100408, "body": "@Peter: I know about the problem, but I didn&#39;t expect the Go playground to go down someday. Nevertheless, added the code here"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574100986, "post_id": 58919334, "comment_id": 104102529, "body": "Nothing here interrupts an actual <code>Read</code> call"}], "tags": [], "owner": {"reputation": 9, "user_id": 1424447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd09393421512c02d8c0c95c293c02d0?s=128&d=identicon&r=PG", "display_name": "pakohan", "link": "https://stackoverflow.com/users/1424447/pakohan"}, "is_accepted": false, "score": -1, "last_activity_date": 1574096458, "last_edit_date": 1574096458, "creation_date": 1574095662, "answer_id": 58919334, "question_id": 58918013, "link": "https://stackoverflow.com/questions/58918013/idiomatic-way-to-interrupt-a-read-on-a-nopcloser/58919334#58919334", "title": "Idiomatic way to interrupt a read on a NopCloser?", "body": "<p>From what I've understood, this could be the solution: <a href=\"https://play.golang.org/p/-d8eGFvwuYb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/-d8eGFvwuYb</a></p>\n\n<p>But I think it's not idiomatic and sounds to me like a XY-problem as well... Just learned about that term btw, thx for sharing @Flimzy</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"context\"\n    \"fmt\"\n    \"io\"\n    \"time\"\n)\n\nfunc main() {\n    cs := goWrite()\n    read(cs)\n    time.Sleep(1)\n}\n\nfunc goWrite() CloseSignaler {\n    buf := &amp;bytes.Buffer{}\n    cs := NewCloseSignaler(buf)\n    go func() {\n        defer fmt.Println(\"exit writer\")\n        for {\n            select {\n            case &lt;-cs.ctx.Done():\n                return\n            default:\n                buf.Write([]byte(\"A\"))\n            }\n        }\n    }()\n    return cs\n}\n\nfunc read(rc io.ReadCloser) {\n    p := make([]byte, 1)\n    rc.Read(p)\n    fmt.Printf(\"read %s\\n\", string(p))\n    rc.Close()\n}\n\n// CloseSignaler\n\ntype CloseSignaler struct {\n    io.Reader\n    ctx    context.Context\n    cancel func()\n}\n\nfunc NewCloseSignaler(r io.Reader) CloseSignaler {\n    ctx, cancel := context.WithCancel(context.Background())\n    return CloseSignaler{\n        Reader: r,\n        ctx:    ctx,\n        cancel: cancel,\n    }\n}\n\nfunc (cs CloseSignaler) Close() error {\n    cs.cancel()\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574096458, "creation_date": 1574091163, "question_id": 58918013, "link": "https://stackoverflow.com/questions/58918013/idiomatic-way-to-interrupt-a-read-on-a-nopcloser", "title": "Idiomatic way to interrupt a read on a NopCloser?", "body": "<p>I'm streaming data through a reader in a situation where the consumer can cancel at any time. Normally I would just have the consumer call reader.Close(), but in this case the reader needs to be a ReadCloser. NopCloser is the only way I currently know to turn a Reader into a ReadCloser, but then closing doesn't do anything, so if the consumer leaves I have no way to inform the producer. Is there something like NopCloser that emits some sort of signal I can listen for at the producer side?</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1574091201, "post_id": 58917988, "comment_id": 104097387, "body": "docker exec -it container bash or docker exec -it container /bin/bash"}, {"owner": {"reputation": 468, "user_id": 10319719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f455493e522051dfc4bb755e03c408d?s=128&d=identicon&r=PG&f=1", "display_name": "workaround", "link": "https://stackoverflow.com/users/10319719/workaround"}, "reply_to_user": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1574091294, "post_id": 58917988, "comment_id": 104097448, "body": "I use /bin/bash. Is it that different?"}, {"owner": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1574091356, "post_id": 58917988, "comment_id": 104097477, "body": "no you use bin/bash"}, {"owner": {"reputation": 468, "user_id": 10319719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f455493e522051dfc4bb755e03c408d?s=128&d=identicon&r=PG&f=1", "display_name": "workaround", "link": "https://stackoverflow.com/users/10319719/workaround"}, "reply_to_user": {"reputation": 12305, "user_id": 8192635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcaf44c9ff9eeeb51fc78c816891d75a?s=128&d=identicon&r=PG&f=1", "display_name": "LinPy", "link": "https://stackoverflow.com/users/8192635/linpy"}, "edited": false, "score": 0, "creation_date": 1574091510, "post_id": 58917988, "comment_id": 104097570, "body": "Yes you are right.Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 1, "creation_date": 1574227954, "post_id": 58918264, "comment_id": 104152118, "body": "It&#39;s not strictly necessary to specify a full path, but you need to specify the correct path. If your working directory is <code>&#47;App</code>, the path <code>bin&#47;bash</code> refers to <code>&#47;App&#47;bin&#47;bash</code> which of course doesn&#39;t exist. But the correct relative path <code>..&#47;bin&#47;bash</code> would also work. Maybe see also <a href=\"https://stackoverflow.com/questions/31435921/difference-between-and\" title=\"difference between and\">stackoverflow.com/questions/31435921/difference-between-and</a>"}, {"owner": {"reputation": 587, "user_id": 8849858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed553eeb0056926d3af36bf594de34b?s=128&d=identicon&r=PG&f=1", "display_name": "sergkondr", "link": "https://stackoverflow.com/users/8849858/sergkondr"}, "reply_to_user": {"reputation": 137100, "user_id": 874188, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ZcY77.png?s=128&g=1", "display_name": "tripleee", "link": "https://stackoverflow.com/users/874188/tripleee"}, "edited": false, "score": 0, "creation_date": 1574241702, "post_id": 58918264, "comment_id": 104157847, "body": "Yes, you right, it&#39;s a third option - path that relevant to workdir location, I forgot about this one, thank you for your clarification"}], "tags": [], "owner": {"reputation": 587, "user_id": 8849858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed553eeb0056926d3af36bf594de34b?s=128&d=identicon&r=PG&f=1", "display_name": "sergkondr", "link": "https://stackoverflow.com/users/8849858/sergkondr"}, "is_accepted": true, "score": 1, "last_activity_date": 1574224203, "last_edit_date": 1574224203, "creation_date": 1574091879, "answer_id": 58918264, "question_id": 58917988, "link": "https://stackoverflow.com/questions/58917988/how-to-exec-into-docker-container-with-entrypoint-in-its-dockerfile/58918264#58918264", "title": "How to exec into Docker container with ENTRYPOINT in its Dockerfile", "body": "<p>You should to specify full path to the binary file(<code>/bin/bash</code> in your case) or just name of the binary file located somewhere in your container's PATH variable(<code>bash</code>)</p>\n"}], "owner": {"reputation": 468, "user_id": 10319719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f455493e522051dfc4bb755e03c408d?s=128&d=identicon&r=PG&f=1", "display_name": "workaround", "link": "https://stackoverflow.com/users/10319719/workaround"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 58918264, "answer_count": 1, "score": -1, "last_activity_date": 1574224203, "creation_date": 1574091112, "question_id": 58917988, "link": "https://stackoverflow.com/questions/58917988/how-to-exec-into-docker-container-with-entrypoint-in-its-dockerfile", "title": "How to exec into Docker container with ENTRYPOINT in its Dockerfile", "body": "<p>I have a Dockerfile that looks like this:</p>\n\n<pre><code>FROM image\n\nWORKDIR /App\nADD ./App/ /App\nENTRYPOINT [ \"./App\" ]\n</code></pre>\n\n<p>In the App direction I am mounting a golang binary and its config.yml.</p>\n\n<p>The image builds and runs correctly. When I am not running the container detached I can see the app is running as well.</p>\n\n<p>But when I run it detached:</p>\n\n<pre><code>docker run -d image\n</code></pre>\n\n<p>I cannot exec into container after:</p>\n\n<pre><code>docker exec -it container bin/bash\n</code></pre>\n\n<p>With an error message: </p>\n\n<blockquote>\n  <p>OCI runtime exec failed: exec failed: container_linux.go:345: starting\n  container process caused \"exec: \\\"bin/bash\\\": stat bin/bash: no such\n  file or directory\": unknown</p>\n</blockquote>\n\n<p>I can understand <strong>it has to do with the entrypoint</strong> I set, but i am not sure what alternative i could use.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1574090365, "post_id": 58917568, "comment_id": 104096906, "body": "Are you by chance running VSC as root?"}, {"owner": {"reputation": 10206, "user_id": 865866, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QXzpS.jpg?s=128&g=1", "display_name": "0leg", "link": "https://stackoverflow.com/users/865866/0leg"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1574091839, "post_id": 58917568, "comment_id": 104097782, "body": "The <code>ps -ef | grep &#47;usr&#47;bin&#47;code</code> returns <code>&lt;foo_user&gt;     5838  3767  0 17:43 pts&#47;2    00:00:00 grep --color=auto &#47;usr&#47;bin&#47;code</code>. Also, this kind of things never happened with any other file formats so far (have been using dozes of different ones)."}], "owner": {"reputation": 10206, "user_id": 865866, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QXzpS.jpg?s=128&g=1", "display_name": "0leg", "link": "https://stackoverflow.com/users/865866/0leg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574150979, "creation_date": 1574089818, "last_edit_date": 1574150979, "question_id": 58917568, "link": "https://stackoverflow.com/questions/58917568/vscode-go-extension-auto-sets-sum-mod-ownership-to-root", "title": "VSCode Go extension auto-sets *.sum/*.mod ownership to root", "body": "<p>Usinc the latest VSCode (1.40.1 at the time of the post) with the default Go extension (<a href=\"https://marketplace.visualstudio.com/items?itemName=ms-vscode.Go\" rel=\"nofollow noreferrer\">https://marketplace.visualstudio.com/items?itemName=ms-vscode.Go</a>) with the default config.</p>\n\n<p>Every time one would work with a Go project, some functionality (VSCode or the Go extension) updates some <code>go.mod</code> or <code>go.sum</code> files and sets file-ownership to <code>root:root</code>. This happens on saving some of the Go source files (which triggers some auto module/sum check or something).</p>\n\n<p>One has to explicitly <code>chown</code> the file ownership to <code>$USER:$USER</code> all the time.</p>\n\n<h2>Question</h2>\n\n<p>Any clues how to make sure the file ownership not getting changed?</p>\n\n<h2>Potential reason</h2>\n\n<p><a href=\"https://github.com/microsoft/vscode-go/issues/2730\" rel=\"nofollow noreferrer\">https://github.com/microsoft/vscode-go/issues/2730</a></p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574086065, "post_id": 58916195, "comment_id": 104094342, "body": "Pass <code>c</code> as an argument to the function literal, or just reference it in the function literal directly since the surrounding block of the function literal does contain <code>c</code>."}, {"owner": {"reputation": 175, "user_id": 6123774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2U3a.png?s=128&g=1", "display_name": "Vrangz", "link": "https://stackoverflow.com/users/6123774/vrangz"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574086550, "post_id": 58916195, "comment_id": 104094610, "body": "It&#39;s not a solution for it"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574087349, "post_id": 58916195, "comment_id": 104095118, "body": "Seems like that <a href=\"https://github.com/gin-gonic/gin/blob/0f951956d0b8b4b459a2f46bcd4e7118f0306210/context.go#L1042-L1047\" rel=\"nofollow noreferrer\">method</a> is not doing what its documentation states it is doing."}, {"owner": {"reputation": 175, "user_id": 6123774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2U3a.png?s=128&g=1", "display_name": "Vrangz", "link": "https://stackoverflow.com/users/6123774/vrangz"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574089542, "post_id": 58916195, "comment_id": 104096403, "body": "Kinda weird, but hopefully there was <code>c.Request.Context().Done()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 5096688, "user_type": "registered", "profile_image": "https://graph.facebook.com/1037093962967527/picture?type=large", "display_name": "L&#234; Th&#225;i Ph&#250;c Quang", "link": "https://stackoverflow.com/users/5096688/l%c3%aa-th%c3%a1i-ph%c3%bac-quang"}, "edited": false, "score": 1, "creation_date": 1574142194, "post_id": 58916612, "comment_id": 104115330, "body": "I think we should use a clone of Gin context in goroutines, as suggested in <a href=\"https://github.com/gin-gonic/gin#goroutines-inside-a-middleware\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin#goroutines-inside-a-middleware</a>"}], "tags": [], "owner": {"reputation": 175, "user_id": 6123774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2U3a.png?s=128&g=1", "display_name": "Vrangz", "link": "https://stackoverflow.com/users/6123774/vrangz"}, "is_accepted": false, "score": 1, "last_activity_date": 1574086701, "creation_date": 1574086701, "answer_id": 58916612, "question_id": 58916195, "link": "https://stackoverflow.com/questions/58916195/go-gin-middleware-events/58916612#58916612", "title": "Go Gin middleware events", "body": "<p>I found out that there is also <code>c.Request.Context().Done()</code> which works now, stopping <code>goroutine</code> and allowing to handle multiple events</p>\n\n<pre><code>go func() {\n    for {\n        select {\n        case &lt;-listener:\n            fmt.Println(\"event called\")\n        case &lt;-c.Request.Context().Done():\n            return\n        }\n    }\n}()\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 6123774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b2U3a.png?s=128&g=1", "display_name": "Vrangz", "link": "https://stackoverflow.com/users/6123774/vrangz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1691, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1597030924, "creation_date": 1574085331, "last_edit_date": 1597030924, "question_id": 58916195, "link": "https://stackoverflow.com/questions/58916195/go-gin-middleware-events", "title": "Go Gin middleware events", "body": "<p>I'm trying to make middleware for the Gin server to handle events during a single request because I need things like IP address from context and to not pass the whole context I'd rather pass my listener which makes my method not dependent on <code>gin.Context</code>.</p>\n<p>I set up a server</p>\n<pre><code>func main() {\n    router := gin.New()\n    router.Use(gin.Recovery())\n    api := router.Group(&quot;api&quot;, middleware())\n    {\n        api.GET(&quot;test/:id&quot;, endpoint)\n    }\n    router.Run(&quot;localhost:8080&quot;)\n}\n</code></pre>\n<p>and made a middleware</p>\n<pre><code>func middleware() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        listener := make(chan int)\n        c.Set(&quot;EventListener&quot;, listener)\n        go func() {\n            select {\n            case &lt;-listener:\n                fmt.Println(&quot;event called&quot;)\n            default:\n                fmt.Println(&quot;default&quot;)\n            }\n        }()\n        c.Next()\n    }\n}\n</code></pre>\n<p>then I got an endpoint where I get my listener and then pass it to any function I want to</p>\n<pre><code>func endpoint(c *gin.Context) {\n    listener := c.MustGet(&quot;EventListener&quot;).(chan int)\n\n    id := c.Param(&quot;id&quot;)\n    idInt, err := strconv.ParseInt(id, 10, 64)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    doSomething(listener, int(idInt))\n}\n</code></pre>\n<p>and <code>doSomething</code> function to show that no context is used later on</p>\n<pre><code>func doSomething(listener chan int, id int) {\n    if id == 1 {\n        fmt.Println(&quot;ERROR: cause event and exit&quot;)\n        listener &lt;- int(id)\n        return\n    }\n    if id == 2 {\n        fmt.Println(&quot;WARN: cause event but continue&quot;)\n        listener &lt;- int(id)\n    }\n    fmt.Println(&quot;OK: everything is fine&quot;)\n}\n</code></pre>\n<p>And the way it works now is:</p>\n<p>when you call <code>GET http://localhost:8080/api/test/1</code> it will trigger event and exit</p>\n<p>when you call <code>GET http://localhost:8080/api/test/2</code> it will trigger event and keep working</p>\n<p>when you call <code>GET http://localhost:8080/api/test/3</code> it will not trigger event because all is ok.</p>\n<p>So everything is working but only for one event along request. You can not call another one, because <code>select</code> already passed so my question is how to fix it and allow to trigger event multiple times.</p>\n<p>I know I can make it like</p>\n<pre><code>for {\n    select {\n    case &lt;-listener:\n        fmt.Println(&quot;event called&quot;)\n    }\n}\n</code></pre>\n<p>but what would be stop condition of this loop?</p>\n<p>I know there is something like <code>c.Done()</code> which is <code>chan</code> but have no idea how to use it in my case because I can make it like</p>\n<pre><code>for {\n    select {\n    case &lt;-listener:\n        fmt.Println(&quot;event called&quot;)\n    case &lt;-c.Done():\n        return\n    }\n}\n</code></pre>\n<p>but how to pass that <code>c.Done()</code>? This <code>goroutine</code> does not stop.</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1574085080, "post_id": 58915997, "comment_id": 104093755, "body": "It looks like you&#39;re using relative import paths. <a href=\"https://stackoverflow.com/questions/38517593/relative-imports-in-go\">Don&#39;t do that</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086223, "post_id": 58915997, "comment_id": 104094438, "body": "<code>go get</code> works on package names, not filesystem paths. They may be related, but are not the same thing."}, {"owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574086267, "post_id": 58915997, "comment_id": 104094456, "body": "I checked the link, I am using importing the same way recommended in your link: import (&quot;SCMicroServer/controllers/package1&quot;) @Flimzy"}, {"owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086389, "post_id": 58915997, "comment_id": 104094513, "body": "@JimB When I change that line to &quot;RUN go get SCMicroServer&quot;, I still get the same error."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086553, "post_id": 58915997, "comment_id": 104094612, "body": "@Mazdak: outside of the module, go needs a hostname to locate a package for <code>go get</code>. You&#39;re not trying to fetch a remote copy of the package, so if you want to build <code>SCMicroServer</code>, work from within that directory."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574088968, "post_id": 58915997, "comment_id": 104096077, "body": "@Mazdak: That&#39;s NOT what the link says to do. You&#39;re still using relative imports."}], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "is_accepted": false, "score": 0, "last_activity_date": 1574266930, "creation_date": 1574266930, "answer_id": 58958971, "question_id": 58915997, "link": "https://stackoverflow.com/questions/58915997/import-path-does-not-begin-with-hostname/58958971#58958971", "title": "Import path does not begin with hostname", "body": "<p>I found the answer, it was not really Dockerfile problem, I referenced my package 2 times in 2 different way in my main file:</p>\n\n<pre><code>package1 \"SCMicroServer/controllers/package1\"\n\"SCMicroServer/controllers/package1\"\n</code></pre>\n\n<p>After I removed the second one, I stopped receiving the error.</p>\n"}], "owner": {"reputation": 671, "user_id": 445891, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/w7rWI.jpg?s=128&g=1", "display_name": "Mazdak", "link": "https://stackoverflow.com/users/445891/mazdak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 298, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1574266930, "creation_date": 1574084702, "last_edit_date": 1574084990, "question_id": 58915997, "link": "https://stackoverflow.com/questions/58915997/import-path-does-not-begin-with-hostname", "title": "Import path does not begin with hostname", "body": "<p>I have a Go app. Some of its dependencies are in a private Github repo and another part of dependencies are local packages in my app folder. The app compiles and works on my computer without a problem (when I simply compile it without docker). I am using the below Dockerfile.</p>\n\n<pre><code>FROM ubuntu as intermediate\n\n# install git\nRUN apt-get update\nRUN apt-get install -y git\n\n\nRUN mkdir /root/.ssh/\nCOPY github_rsa.ppk /root/.ssh/github_rsa.ppk\nRUN chmod 700 /root/.ssh/github_rsa.ppk\n\nRUN eval $(ssh-agent) &amp;&amp; \\\n    ssh-add /root/.ssh/github_rsa.ppk &amp;&amp; \\\n    ssh-keyscan -H github.com &gt;&gt; /etc/ssh/ssh_known_hosts &amp;&amp; \\\n    git clone git@github.myusername/shared.git\n\n\nFROM golang:latest\nENV GOPATH=/go\n\nRUN echo $GOPATH\n\nADD . /go/src/SCMicroServer\nWORKDIR /go/src/SCMicroServer\nCOPY --from=intermediate /shared /go/src/github.com/myusername/shared\nRUN go get /go/src/SCMicroServer\nRUN go install SCMicroServer\nENTRYPOINT /go/src/SCMicroServer\nEXPOSE 8080\n</code></pre>\n\n<p>First build section related to Git is working fine, It works until this line: <em>RUN go get /go/src/SCMicroServer</em> in second section. I receive this error in mentioned step:</p>\n\n<blockquote>\n  <p>package SCMicroServer/controllers/package1: unrecognized import path \"SCMicroServer/controllers/package1\" (import path does not begin with hostname)<br>\n  The command '/bin/sh -c go get /go/src/SCMicroServer' returned a non-zero code: 1</p>\n</blockquote>\n\n<p>\"SCMicroServer/controllers/package1\" is one of the local packages in my app folder (or its subfolders) and I have many more in my local folder. I am setting GOPATH env variable in my Dockerfile, so I am not sure what I am missing. </p>\n"}, {"tags": ["go", "privacy-policy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574084924, "post_id": 58915985, "comment_id": 104093663, "body": "It would be kind of an obvious security hole if <code>goproxy.golang.org</code> could capture private git credentials (which are never seen by the proxy in the first place)."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574085211, "post_id": 58915985, "comment_id": 104093833, "body": "It need not capture(I mean store the credentials) the credentials in proxy.golang.org. It can just forward or use the credentials when requesting a package from private repository. May be in the name of efficiency, it can just use git for authentication and serve the content from proxy."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574085341, "post_id": 58915985, "comment_id": 104093905, "body": "Git does not forward your private key to the go proxy. Even if git were to communicate with the proxy at all, that&#39;s not how PKI works."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574085677, "post_id": 58915985, "comment_id": 104094122, "body": "Username and password given as input while running go get can be transported to proxy.golang.org and the server can use that to fetch the repo in proxy server and serve it from there."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574085855, "post_id": 58915985, "comment_id": 104094215, "body": "These are not explicitly mentioned in the privacy policy in this link <a href=\"https://proxy.golang.org/\" rel=\"nofollow noreferrer\">proxy.golang.org</a>. I just want to make sure that my private repository is not stored in any other place."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1574086050, "post_id": 58915985, "comment_id": 104094333, "body": "git does not communicate with the proxy. It does not use nor understand the GOPROXY protocol. If you give your username and password to git (which should be using PKI), git is fetching the package, not the go tool."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086266, "post_id": 58915985, "comment_id": 104094455, "body": "@JimB Thanks for the clarification. So I will assume that private repositories are never cached in proxy.golang.org"}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086509, "post_id": 58915985, "comment_id": 104094590, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/202574/discussion-between-spartan-and-jimb\">continue this discussion in chat</a>."}, {"owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574086831, "post_id": 58915985, "comment_id": 104094760, "body": "When I renamed the repository and compiled the go code in new machine with same code ie referring to old git repository, the package was successfully imported and compiled. So the git should have redirected the old repository to point to new repository. I doubted proxy.golang.org for this reason"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574087091, "post_id": 58915985, "comment_id": 104094952, "body": "You can see all the commands the <code>go</code> tool is issuing using the <code>-x</code> flag, and the proxy is just an http api which you can inspect to see what it contains."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1574087485, "post_id": 58915985, "comment_id": 104095199, "body": "The proxy protocol is described <a href=\"https://golang.org/cmd/go/#hdr-Module_proxy_protocol\" rel=\"nofollow noreferrer\">here</a>.  The protocol does not provide a way to transmit credentials. It follows that proxy.golang.org cannot access private repositories and therefore does not cache them."}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 4, "last_activity_date": 1574155001, "last_edit_date": 1592644375, "creation_date": 1574155001, "answer_id": 58930403, "question_id": 58915985, "link": "https://stackoverflow.com/questions/58915985/are-private-repositories-cached-in-proxy-golang-org/58930403#58930403", "title": "Are private repositories cached in proxy.golang.org?", "body": "<p>From <a href=\"https://index.golang.org\" rel=\"nofollow noreferrer\">https://index.golang.org</a>:</p>\n<blockquote>\n<p><strong>If I don't set <code>GOPRIVATE</code> and request a private module from these services, what leaks?</strong>\nThe proxy and checksum database protocols only send module paths and versions to the remote server. If you request a private module, the mirror will try to download it just as any Go user would and fail in the same way. Information about failed requests isn't published anywhere. The only trace of the request will be in internal logs, which are governed by the privacy policy.</p>\n</blockquote>\n<p>With <code>GOPRIVATE</code>working as described at <a href=\"https://golang.org/cmd/go/#hdr-Module_configuration_for_non_public_modules\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-Module_configuration_for_non_public_modules</a></p>\n<blockquote>\n<p>The GOPRIVATE environment variable controls which modules the go command considers to be private (not available publicly) and should therefore not use the proxy or checksum database. The variable is a comma-separated list of glob patterns (in the syntax of Go's path.Match) of module path prefixes. For example,</p>\n<p>GOPRIVATE=*.corp.example.com,rsc.io/private</p>\n<p>causes the go command to treat as private any module with a path prefix matching either pattern, including git.corp.example.com/xyzzy, rsc.io/private, and rsc.io/private/quux.</p>\n</blockquote>\n<p>To sum it up: if it is a private module, the proxy services <em>tries</em> to access it and will fail. I assume Go then will fall back to access it directly, circumventing the proxy altogether. To prevent this roundtrip, add your private repositories to GOPRIVATE and if you still are concerned about it, use something like wireshark to make double sure that your private modules are accessed directly.</p>\n"}], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1151, "favorite_count": 0, "accepted_answer_id": 58930403, "answer_count": 1, "score": 1, "last_activity_date": 1600959965, "creation_date": 1574084649, "last_edit_date": 1600959965, "question_id": 58915985, "link": "https://stackoverflow.com/questions/58915985/are-private-repositories-cached-in-proxy-golang-org", "title": "Are private repositories cached in proxy.golang.org?", "body": "<p>From go 1.13, go modules uses <a href=\"https://proxy.golang.org/\" rel=\"nofollow noreferrer\">https://proxy.golang.org/</a> to cache repositories. Consider that I have a private repository as a go module in github.com/Ihtkas/libraries and I imported the module in another local go code sort.go. When I build the local code with GIT_TERMINAL_PROMPT=1, go builds the sort.go with my login credentials for the local repository. In this case, does go caches the private repository in proxy.golang.com? When someone else imports the same private package and uses valid credentials to access the package, is the package in private repo served from proxy.golang.com with just authentication forwarded to github.com?\nMy exact question is</p>\n<blockquote>\n<p>Does go in anyway hold the private repo code in proxy server?</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574083443, "post_id": 58915226, "comment_id": 104092736, "body": "if that URL needs to come through exactly as you see, the percent-encoded characters need to be escaped a second time. That query string has reserved characters, which is not valid."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574083493, "post_id": 58915347, "comment_id": 104092759, "body": "Thanks! But I need to send value of this parameter to the database, for example. And now I have to parse this string manually, because the url.Parse will always unescape values?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574083824, "post_id": 58915347, "comment_id": 104092999, "body": "@MrGodzilla: If the query was valid in the first place, you should never see that mix of characters. Quote the query string correctly, and it will parse back exactly how you want it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 1, "creation_date": 1574083886, "post_id": 58915347, "comment_id": 104093039, "body": "@MrGodzilla It doesn&#39;t matter if you want to send the parameter into another URL or save into DB. Just save the unescaped value. They are equivalent. Why would you need the original, escaped value?"}, {"owner": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574084263, "post_id": 58915347, "comment_id": 104093273, "body": "@icza Because this exact value will be searched by the user in the form as I wrote above, and I need to store it in the database in this version, despite the fact that the first and second urls are essentially the same :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574084335, "post_id": 58915347, "comment_id": 104093314, "body": "@MrGodzilla Then I would redesign your search engine. I would store the unescaped version, and if someone searches an escaped version, unescape it and then you can match with the stored, unescaped version."}, {"owner": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1574084355, "post_id": 58915347, "comment_id": 104093328, "body": "@JimB Thanks, but I need to support this mix of half-excaped/unescaped values -_-"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574084431, "post_id": 58915347, "comment_id": 104093374, "body": "@MrGodzilla: I would highly encourage you to find a more standard solution, as any intermediary box or middleware would likely corrupt your expected value. Sending a full url in a query parameter is not some unheard of practice, and can be easily achieved in a standards compliant way."}, {"owner": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "edited": false, "score": 0, "creation_date": 1574084800, "post_id": 58915347, "comment_id": 104093602, "body": "I&#39;ll try to use url.QueryEscape() and url.QueryUnescape() methods to be sure that value doesn&#39;t contain unexpected symbols, thanks for your time, guys! :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1574082906, "last_edit_date": 1574082906, "creation_date": 1574082604, "answer_id": 58915347, "question_id": 58915226, "link": "https://stackoverflow.com/questions/58915226/how-to-get-params-from-url-without-unescaping-golang/58915347#58915347", "title": "How to get params from url without unescaping (golang)", "body": "<p>The raw, unescaped query is available in the <a href=\"https://golang.org/pkg/net/url/#URL.RawQuery\" rel=\"nofollow noreferrer\"><code>URL.RawQuery</code></a> field:</p>\n\n<pre><code>fmt.Println(u.RawQuery)\n</code></pre>\n\n<p>This will output:</p>\n\n<pre><code>url=https://pt.wikipedia.org/wiki/B%c3%a1rbara_Gordon\n</code></pre>\n\n<p>Of course this is \"just\" a <code>string</code> and you have to parse it yourself if you only need parts of it, but there is hardly ever a need for this. If your intention is to inject the parameter value into another URL, just use <a href=\"https://golang.org/pkg/net/url/#URL\" rel=\"nofollow noreferrer\"><code>url.URL</code></a> to build it which will properly escape it.</p>\n"}], "owner": {"reputation": 11, "user_id": 12391626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aead2d7472cc31eb4788e3563f3311a9?s=128&d=identicon&r=PG&f=1", "display_name": "MrGodzilla", "link": "https://stackoverflow.com/users/12391626/mrgodzilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 348, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574082906, "creation_date": 1574082259, "question_id": 58915226, "link": "https://stackoverflow.com/questions/58915226/how-to-get-params-from-url-without-unescaping-golang", "title": "How to get params from url without unescaping (golang)", "body": "<p>I need to get exactly what the user has transmitted. But the method Query() unescaped the parameters before writing to map :(\nExample:</p>\n\n<pre><code>package main\n\nimport \"net/url\"\n\nfunc main() {\n    urlString := \"http://www.example.com/?url=https://pt.wikipedia.org/wiki/B%c3%a1rbara_Gordon\"\n    u, _ := url.Parse(urlString)\n    values := u.Query()\n\n    println(values.Get(\"url\"))\n    // expected:https://pt.wikipedia.org/wiki/B%c3%a1rbara_Gordon\n    // output:  https://pt.wikipedia.org/wiki/B\u00e1rbara_Gordon\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4XRTcKKRM2s\" rel=\"nofollow noreferrer\">https://play.golang.org/p/4XRTcKKRM2s</a></p>\n"}, {"tags": ["go", "aws-sdk"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574085531, "post_id": 58915175, "comment_id": 104094023, "body": "Those are called <a href=\"https://dave.cheney.net/2014/10/17/functional-options-for-friendly-apis\" rel=\"nofollow noreferrer\">functional options</a>. Here&#39;s the <a href=\"https://www.youtube.com/watch?v=24lFtGHWxAQ\" rel=\"nofollow noreferrer\">video</a> of the talk."}, {"owner": {"reputation": 496, "user_id": 5977709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wp5WfpAAGHo/AAAAAAAAAAI/AAAAAAAAASc/-Lw55LJlMJ8/photo.jpg?sz=128", "display_name": "Dusan Gligoric", "link": "https://stackoverflow.com/users/5977709/dusan-gligoric"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574087294, "post_id": 58915175, "comment_id": 104095085, "body": "this actually helps a lot, ty, you can post this as an answer and I will approve it @mkopriva"}], "owner": {"reputation": 496, "user_id": 5977709, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wp5WfpAAGHo/AAAAAAAAAAI/AAAAAAAAASc/-Lw55LJlMJ8/photo.jpg?sz=128", "display_name": "Dusan Gligoric", "link": "https://stackoverflow.com/users/5977709/dusan-gligoric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574082112, "creation_date": 1574082112, "question_id": 58915175, "link": "https://stackoverflow.com/questions/58915175/can-someone-give-me-an-example-of-describeinstancespageswithcontext-call", "title": "Can someone give me an example of DescribeInstancesPagesWithContext call", "body": "<p>I am trying to use this Go <a href=\"https://github.com/aws/aws-sdk-go\" rel=\"nofollow noreferrer\">AWS SDK</a>, in particular function <code>DescribeInstancesPagesWithContext</code>. I cannot understand how to use it, having issues with this argument <code>opts ...request.Option</code>, it is defined as <code>type Option func(*Request)</code>. Tried googling but cannot find any example code. Thanks!</p>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 2274, "user_id": 7567579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab9644beeb1d324d1247b2951d28927?s=128&d=identicon&r=PG", "display_name": "Emin Laletovic", "link": "https://stackoverflow.com/users/7567579/emin-laletovic"}, "edited": false, "score": 1, "creation_date": 1574081335, "post_id": 58914677, "comment_id": 104091613, "body": "Channel is blocked when zero is added because channel is unbuffered. Even if you write a value to it, it will block there on that line until channel is read somewhere else."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1574081270, "creation_date": 1574081270, "answer_id": 58914916, "question_id": 58914677, "link": "https://stackoverflow.com/questions/58914677/go-channels-pushing-to-a-channel-stops-execution/58914916#58914916", "title": "Go Channels - Pushing to a channel stops execution", "body": "<p>Your <code>correctAnswersCh</code> channel is unbuffered, so sending anything on it blocks until there is someone receiving from it. And since your <code>main()</code> function only receives from it after the timeout, your app is blocked until then.</p>\n\n<p>One simple workaround is to give 1 buffer to the channel:</p>\n\n<pre><code>correctAnswersCh := make(chan int, 1)\n</code></pre>\n\n<p>Although this is some weird usage of channels. If your intention is to create a concurrency safe counter, use an aotmic counter, e.g. <a href=\"https://golang.org/pkg/sync/atomic/#AddInt32\" rel=\"noreferrer\"><code>atomic.AddInt32()</code></a>. Another option is to use a mutex (<a href=\"https://golang.org/pkg/sync/#Mutex\" rel=\"noreferrer\"><code>sync.Mutex</code></a> or <a href=\"https://golang.org/pkg/sync/#RWMutex\" rel=\"noreferrer\"><code>sync.RWMutex</code></a>) to protect a resource (variable) when accessed concurrently from multiple goroutines.</p>\n"}], "owner": {"reputation": 681, "user_id": 1894292, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/24bbb0e9731796478c7307061bfd1a84?s=128&d=identicon&r=PG", "display_name": "user1894292", "link": "https://stackoverflow.com/users/1894292/user1894292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 58914916, "answer_count": 1, "score": 0, "last_activity_date": 1574081270, "creation_date": 1574080484, "question_id": 58914677, "link": "https://stackoverflow.com/questions/58914677/go-channels-pushing-to-a-channel-stops-execution", "title": "Go Channels - Pushing to a channel stops execution", "body": "<p>I'm trying to create a command line quiz, where users would be asked question after question until they either finish the final question, or they are timed out.</p>\n\n<p>I wanted to use channels so I could learn how to use them properly, and I've hit a blocker, so to speak.</p>\n\n<p>The idea is for correctAnswersCh to start with 0, and after every correct answer, it will increment by 1.</p>\n\n<p>The quiz always stops at line 3 of the quiz() function, after I put zero into the channel.</p>\n\n<p>I've added some code below, but the full code is here:\n<a href=\"https://play.golang.org/p/vzRCTc7MpIK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vzRCTc7MpIK</a></p>\n\n<pre><code>func main() {\n    questions, err := getCsvData()\n    var limit = time.Duration(3)\n\n\n    flag.Parse()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    quizComplete := make(chan bool)\n    correctAnswersCh := make(chan int)\n    go quiz(quizComplete, questions, correctAnswersCh)\n\n    select {\n    case &lt;-time.After(limit*time.Second):\n        fmt.Println(\"Timed Out\")\n    }\n    fmt.Printf(\"Correct Answers: %v\\n\", &lt;-correctAnswersCh)\n}\n\nfunc quiz(quizComplete chan bool, questions [][]string, correctAnswersCh chan int) {\n    reader := bufio.NewReader(os.Stdin)\n    correctAnswersCh &lt;- 0\n    // execution stops here.  0 is added to correctAnswersCh, then the quiz func stops\n    for _, question := range questions {\n\n        fmt.Print(question[0], \"= \")\n        answer, _ := reader.ReadString('\\n')\n\n        if strings.TrimSpace(answer) == question[1] {\n            cA := &lt;-correctAnswersCh\n            cA++\n            correctAnswersCh &lt;- cA\n        }\n    }\n    quizComplete &lt;- true\n}\n</code></pre>\n"}, {"tags": ["node.js", "excel", "go", "window-server"], "answers": [{"tags": [], "owner": {"reputation": 1553, "user_id": 3778960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NegL5.jpg?s=128&g=1", "display_name": "Yaroslav Gaponov", "link": "https://stackoverflow.com/users/3778960/yaroslav-gaponov"}, "is_accepted": false, "score": 0, "last_activity_date": 1574079244, "creation_date": 1574079244, "answer_id": 58914325, "question_id": 58914185, "link": "https://stackoverflow.com/questions/58914185/how-to-run-excel-application-from-golang-or-nodejs-on-window-server/58914325#58914325", "title": "How to run Excel Application from Golang or Nodejs on Window Server?", "body": "<p>If talk about <code>node.js</code> you can use <a href=\"https://www.npmjs.com/package/winax\" rel=\"nofollow noreferrer\">winax</a> library or something similar for work with activex/com/dcom. But I believe you can use just build-in in windows javascript interpreter (not node.js) for it.</p>\n"}], "owner": {"reputation": 459, "user_id": 5718964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df909ea431237aa33f2daeb2e6b78210?s=128&d=identicon&r=PG", "display_name": "Tran B. V. Son", "link": "https://stackoverflow.com/users/5718964/tran-b-v-son"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574079244, "creation_date": 1574078682, "question_id": 58914185, "link": "https://stackoverflow.com/questions/58914185/how-to-run-excel-application-from-golang-or-nodejs-on-window-server", "title": "How to run Excel Application from Golang or Nodejs on Window Server?", "body": "<p>I'm using Excel Application on Window Server to convert Excel to PDF. I want to know whether I can start Excel Application by <code>Golang</code> or <code>Nodejs</code> on Window Server. I see some examples of running Excel Application by <code>Ruby</code>, <code>Python</code>, <code>C#</code>. \nFor example: </p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/10963950/how-do-i-run-an-excel-macro-from-ruby\">Ruby</a>: </li>\n</ul>\n\n<pre class=\"lang-rb prettyprint-override\"><code>require 'win32ole'\n\nclass TestDemo &lt; Test::Unit::TestCase\n   def testExcelMacro\n    # Arrange\n    excel = WIN32OLE.new(\"Excel.Application\")\n    excel.Visible = true\n    excel.Workbooks.Open('C:\\temp\\Test.xlsm')\n\n    # Act\n    excel.run \"Sheet1!WriteToA1\"\n\n    # Assert\n    worksheet = excel.Workbooks.ActiveWorkbook\n    assert_equal(\"blah\", worksheet.Range(\"A1\").Value)\n\n    excel.Quit  \n   end\nend\n</code></pre>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/20854840/xlsx-and-xlslatest-versions-to-pdf-using-python/20867193#20867193\">Python</a></li>\n</ul>\n\n<pre class=\"lang-py prettyprint-override\"><code>from win32com import client\nxlApp = client.Dispatch(\"Excel.Application\")\nbooks = xlApp.Workbooks.Open('C:\\\\excel\\\\trial.xls')\nws = books.Worksheets[0]\nws.Visible = 1\nws.ExportAsFixedFormat(0, 'C:\\\\excel\\\\trial.pdf')\n</code></pre>\n"}, {"tags": ["postgresql", "go", "go-gin"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574077837, "post_id": 58913826, "comment_id": 104089745, "body": "Seems like <code>DBCon</code> is <code>nil</code>, where is the code that initializes that variable?"}, {"owner": {"reputation": 596, "user_id": 9167487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6m6Sb.jpg?s=128&g=1", "display_name": "Justin J", "link": "https://stackoverflow.com/users/9167487/justin-j"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574078327, "post_id": 58913826, "comment_id": 104089990, "body": "No sir, I have configured db with viper and all, I have edited my question"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1574078808, "post_id": 58913826, "comment_id": 104090251, "body": "Nothing in the added code shows that <code>DBCon</code> is initialized properly, and even if it is initialized by some of the delegated method calls, nothing in your question&#39;s code shows that <code>SetupSuite</code> is indeed being executed as promised in its comment... But whatever, let&#39;s say you are correct and <code>DBCon</code> is initialized as you believe, then take a look at the stacktrace, specifically the offending <code>...&#47;teams.go:11</code> part, i.e. take a look at line <code>11</code> of the <code>teams.go</code> file, what do you see there? what code is there, can you add that to your question?"}, {"owner": {"reputation": 596, "user_id": 9167487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6m6Sb.jpg?s=128&g=1", "display_name": "Justin J", "link": "https://stackoverflow.com/users/9167487/justin-j"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574078929, "post_id": 58913826, "comment_id": 104090315, "body": "thank you fpr your comment i will check and ping you"}, {"owner": {"reputation": 596, "user_id": 9167487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6m6Sb.jpg?s=128&g=1", "display_name": "Justin J", "link": "https://stackoverflow.com/users/9167487/justin-j"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574079297, "post_id": 58913826, "comment_id": 104090525, "body": "Yes, it is working"}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 9167487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6m6Sb.jpg?s=128&g=1", "display_name": "Justin J", "link": "https://stackoverflow.com/users/9167487/justin-j"}, "edited": false, "score": 0, "creation_date": 1574078931, "post_id": 58914213, "comment_id": 104090317, "body": "thank you fpr your comment i will check and ping you"}], "tags": [], "owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "is_accepted": true, "score": 1, "last_activity_date": 1574078799, "creation_date": 1574078799, "answer_id": 58914213, "question_id": 58913826, "link": "https://stackoverflow.com/questions/58913826/unit-test-code-runtime-error-invalid-memory-address-or-nil-pointer-dereferen/58914213#58914213", "title": "Unit test code := runtime error: invalid memory address or nil pointer dereference", "body": "<p>In <code>D:/Projects/GoLang/cloudfactory-backend/db/teams.go</code> on line <code>11</code> you refer a field from a nil-pointer. Without your complete source including the line numbers it's impossible to pinpoint, but it's probably <code>DBCon</code> not being initialized.</p>\n"}], "owner": {"reputation": 596, "user_id": 9167487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6m6Sb.jpg?s=128&g=1", "display_name": "Justin J", "link": "https://stackoverflow.com/users/9167487/justin-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "accepted_answer_id": 58914213, "answer_count": 1, "score": -1, "last_activity_date": 1597438251, "creation_date": 1574077454, "last_edit_date": 1597438251, "question_id": 58913826, "link": "https://stackoverflow.com/questions/58913826/unit-test-code-runtime-error-invalid-memory-address-or-nil-pointer-dereferen", "title": "Unit test code := runtime error: invalid memory address or nil pointer dereference", "body": "<p>I have created an API that is working fine, but I got an error like</p>\n<blockquote>\n<p>runtime error: invalid memory address or nil pointer dereference</p>\n</blockquote>\n<p>when the unit test code is executed.</p>\n<p>full response for your reference</p>\n<pre><code>runtime error: invalid memory address or nil pointer dereference\nD:/Go/src/runtime/panic.go:199 (0x447473)\n    panicmem: panic(memoryError)\nD:/Go/src/runtime/signal_windows.go:233 (0x447320)\n    sigpanic: panicmem()\nD:/Projects/GoLang/cloudfactory-backend/db/teams.go:11 (0xb49b36)\n    SelectAllTeams: func SelectAllTeams() (teams []models.Team, err error) {\nD:/Projects/GoLang/cloudfactory-backend/services/teams.go:11 (0xbb09ec)\n    GetTeams: teams, err = db.SelectAllTeams()\nD:/Projects/GoLang/cloudfactory-backend/controllers/api.go:32 (0xbb1b51)\n    ApiController.GetTeams: teams, err := services.GetTeams()\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/context.go:124 (0x9f7da1)\n    (*Context).Next: c.handlers[c.index](c)\nD:/Projects/GoLang/cloudfactory-backend/middlewares/db_logger.go:72 (0xc30430)\n    DBLogger.func1: c.Next()\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/context.go:124 (0x9f7da1)\n    (*Context).Next: c.handlers[c.index](c)\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/recovery.go:83 (0xa0b2ca)\n    RecoveryWithWriter.func1: c.Next()\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/context.go:124 (0x9f7da1)\n    (*Context).Next: c.handlers[c.index](c)\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/logger.go:240 (0xa0a357)\n    LoggerWithConfig.func1: c.Next()\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/context.go:124 (0x9f7da1)\n    (*Context).Next: c.handlers[c.index](c)\nC:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/gin.go:389 (0xa01798)\n    (*Engine).handleHTTPRequest: c.Next()\n C:/Users/justin.joseph/go/pkg/mod/github.com/gin-gonic/gin@v1.4.0/gin.go:351 (0xa00fba)\n    (*Engine).ServeHTTP: engine.handleHTTPRequest(c)\n D:/Projects/GoLang/cloudfactory-backend/tests/controller_tests/api_test.go:73 (0xc69edd)\n    (*ApiSute).TestGetArticle1: suite.Router.ServeHTTP(resp, req)\nD:/Go/src/reflect/value.go:460 (0x4df3ac)\n    Value.call: call(frametype, fn, args, uint32(frametype.size), uint32(retOffset))\nD:/Go/src/reflect/value.go:321 (0x4deb6a)\n    Value.Call: return v.call(&quot;Call&quot;, in)\nC:/Users/justin.joseph/go/pkg/mod/github.com/stretchr/testify@v1.4.0/suite/suite.go:133 (0x7e0d15)\n    Run.func2: method.Func.Call([]reflect.Value{reflect.ValueOf(suite)})\nD:/Go/src/testing/testing.go:909 (0x52a85f)\n    tRunner: fn(t)\nD:/Go/src/runtime/asm_amd64.s:1357 (0x461ab0)\n    goexit: BYTE    $0x90   // NOP\n</code></pre>\n<p>My unit test code function</p>\n<pre><code>func (suite *ApiSute)  TestGetTeams() {\n\n    req, err := http.NewRequest(&quot;GET&quot;, &quot;/api/teams&quot;, nil)\n\n   if err != nil {\n       fmt.Println(err)\n       os.Exit(1)\n   }\n   resp := httptest.NewRecorder()\n   suite.Router.ServeHTTP(resp, req)\n   suite.Equal(suite.Response.Code, 200)\n}\n</code></pre>\n<p>My model function SelectAllTeams</p>\n<pre><code>func SelectAllTeams() (teams []models.Team, err error) {\nsqlStatement := `\nSELECT team_uuid, name, code, description FROM cf.team`\n\nerr = DBCon.Ping()\nif err != nil {\n    log.Print(err)\n    return\n}\n\nerr = DBCon.Select(&amp;teams, sqlStatement)\nif err != nil {\n    log.Print(&quot;Error selecting team...&quot;)\n    log.Print(err)\n    return\n}\nreturn\n}\n</code></pre>\n<p>My Db configuration and other things</p>\n<pre><code>type ApiSute struct {\n    suite.Suite\n    Config *viper.Viper\n    Router *gin.Engine\n    Response *httptest.ResponseRecorder\n}\n\n\n// sets up suite with dev configs and starts sets up the router\n// SetupSuite runs once before executing any tests\nfunc (suite *ApiSute) SetupSuite() {\n    config.Init(&quot;dev&quot;)\n    suite.Config = config.GetConfig()\n    suite.Router = server.SetupRouter()\n}\n</code></pre>\n"}, {"tags": ["csv", "datetime", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1574077707, "post_id": 58912473, "comment_id": 104089671, "body": "<i>&quot;I have tried to execute <code>time.Parse</code> using an empty string, it worked.&quot;</i> is not consistent with what I&#39;m seeing <a href=\"https://play.golang.com/p/5oMhZXYI4ZZ\" rel=\"nofollow noreferrer\">here</a>, are you <i>certain</i> it worked for you? Anyway, to fix this simply check if the <code>csv</code> string&#39;s empty, and if it is then skip the <code>time.Parse</code> step and just return <code>nil</code>."}, {"owner": {"reputation": 481, "user_id": 296318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3867431651fbf3a9e5ae537f4e9f1e68?s=128&d=identicon&r=PG", "display_name": "gtheys", "link": "https://stackoverflow.com/users/296318/gtheys"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574130426, "post_id": 58912473, "comment_id": 104112641, "body": "Ok I made a <a href=\"https://play.golang.com/p/LiKHg1SKugP\" rel=\"nofollow noreferrer\">mistake testing</a> So before time.Parse I have to check the type and cast it to a string to make it work? will try it at least"}], "owner": {"reputation": 481, "user_id": 296318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3867431651fbf3a9e5ae537f4e9f1e68?s=128&d=identicon&r=PG", "display_name": "gtheys", "link": "https://stackoverflow.com/users/296318/gtheys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 461, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1574130843, "creation_date": 1574072861, "last_edit_date": 1574130843, "question_id": 58912473, "link": "https://stackoverflow.com/questions/58912473/gocsv-mapping-to-struct-with-date-time-issue-when-the-field-is-empty", "title": "GOCSV mapping to struct with Date/Time: Issue when the field is empty", "body": "<p><strong>EDIT: I Made a mistake and corrected it</strong></p>\n\n<p>I'm trying to map a <code>CSV</code> file to a struct that defines fields of <code>time.Datetime</code> (later I want to change the datetime format to another format). </p>\n\n<p>This is the output of my program</p>\n\n<pre><code>\u276f go run issue.go                                                                                                                                                 \u2717 master\nrecord:  05/02/2019 15:02:31\nrecord:  05/02/2019 16:02:40\nrecord:\nrecord on line 0; parse error on line 4, column 2: parsing time \"\" as \"02/01/2006 15:04:05\": cannot parse \"\" as \"02\"\n1936  -  2019-02-05 15:02:31 +0000 UTC\n1937  -  2019-02-05 16:02:40 +0000 UTC\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x8 pc=0x10e58cc]\n\ngoroutine 1 [running]:\nmain.main()\n        /Users/gtheys/Code/go/src/github.axa.com/KTAXA/claims-headers-poc/issue.go:49 +0x1bc\nexit status 2\n</code></pre>\n\n<p>I have tried to execute <code>time.Parse</code> using an empty string, it <strong>Didn't work</strong>. So the problem should be here. But I have no idea how to handle it graceful in following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"time\"\n\n    \"github.com/gocarina/gocsv\"\n)\n\ntype DateTime struct {\n    time.Time\n}\n\ntype Issue struct {\n    NotifyNo   string\n    NotifyDate DateTime\n}\n\n// Convert the CSV string as internal date\nfunc (date *DateTime) UnmarshalCSV(csv string) (err error) {\n    fmt.Println(\"record: \", csv)\n    date.Time, err = time.Parse(\"02/01/2006 15:04:05\", csv)\n    return err\n}\n\nfunc main() {\n    //const layout = \"02/05/2006 15:04:00\"\n    issuesFile, err := os.OpenFile(\"ISSUES.txt\", os.O_RDWR|os.O_CREATE, os.ModePerm)\n    if err != nil {\n        panic(err)\n    }\n    defer issuesFile.Close()\n\n    issues := []*Issue{}\n\n    gocsv.SetCSVReader(func(in io.Reader) gocsv.CSVReader {\n        r := csv.NewReader(in)\n        r.Comma = '|'\n        return r // Allows use pipe as delimiter\n    })\n\n    if err := gocsv.UnmarshalFile(issuesFile, &amp;issues); err != nil {\n        fmt.Println(err)\n    }\n    for _, issue := range issues {\n        fmt.Println(issue.NotifyNo, \" - \", issue.NotifyDate)\n    }\n\n    if _, err := issuesFile.Seek(0, 0); err != nil { // Go to the start of the file\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>the csv input file:</p>\n\n<pre><code>NotifyNo|NotifyDate|\n1936|05/02/2019 15:02:31|\n1937|05/02/2019 16:02:40|\n1938||\n1951|05/02/2019 17:02:19|\n</code></pre>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 1, "creation_date": 1574062956, "post_id": 58909806, "comment_id": 104082115, "body": "What value has $WORK?"}, {"owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "edited": false, "score": 2, "creation_date": 1574089684, "post_id": 58909806, "comment_id": 104096492, "body": "The error says it is trying to write to  a folder called &quot;$WORK&quot;. This probably is an invalid path.  Could you share the output of <code>go env</code> ?"}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "edited": false, "score": 0, "creation_date": 1574135981, "post_id": 58909806, "comment_id": 104113770, "body": "$WORK may be an environment variable. And may be replaced by its content"}, {"owner": {"reputation": 15722, "user_id": 56974, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6e5af3c3c57bdcf3e5fe1e7a1269a0e7?s=128&d=identicon&r=PG", "display_name": "Michael Ekoka", "link": "https://stackoverflow.com/users/56974/michael-ekoka"}, "edited": false, "score": 0, "creation_date": 1608235238, "post_id": 58909806, "comment_id": 115528815, "body": "Upvoting the question back to zero, because the answers are useful."}], "answers": [{"tags": [], "owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "is_accepted": false, "score": 2, "last_activity_date": 1574064459, "creation_date": 1574064459, "answer_id": 58910262, "question_id": 58909806, "link": "https://stackoverflow.com/questions/58909806/access-denied-executing-compiled-program/58910262#58910262", "title": "Access denied executing compiled program", "body": "<p>This usually happens when the executable is being edited in some way, or currently running. Check if you have any spare processes of this executable, or in the worst case, try restarting your computer.</p>\n\n<p>Alternatively, it may also be that the linker genuinely does not have write access to the output directory. Make sure that the directory is writable to the user you are compiling your program as.</p>\n"}, {"comments": [{"owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "reply_to_user": {"reputation": 65, "user_id": 9106111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd738d66a94bab3e75847de116dd1a7?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep gaur", "link": "https://stackoverflow.com/users/9106111/sandeep-gaur"}, "edited": false, "score": 1, "creation_date": 1574078318, "post_id": 58910390, "comment_id": 104089987, "body": "Is the error in your question accurate? Because &quot;$WORK&quot; is not a valid path or variable on Windows. Are you executing <code>go run</code> from a command prompt, Powershell, or something like Cygwin?   Have you tried <code>go run -o %USERPROFILE%\\Desktop hello.go</code> ?"}], "tags": [], "owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "is_accepted": false, "score": 4, "last_activity_date": 1574065025, "creation_date": 1574065025, "answer_id": 58910390, "question_id": 58909806, "link": "https://stackoverflow.com/questions/58909806/access-denied-executing-compiled-program/58910390#58910390", "title": "Access denied executing compiled program", "body": "<p>This can be caused by an anti-virus application like AVG or G-Data.</p>\n\n<p>You can use the <code>-o</code> argument with <code>go run</code> to specify the output directory, and add that path to the exclude list of your anti-virus should this be the cause.</p>\n"}], "owner": {"reputation": 65, "user_id": 9106111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cd738d66a94bab3e75847de116dd1a7?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep gaur", "link": "https://stackoverflow.com/users/9106111/sandeep-gaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1574065025, "creation_date": 1574062353, "last_edit_date": 1574063837, "question_id": 58909806, "link": "https://stackoverflow.com/questions/58909806/access-denied-executing-compiled-program", "title": "Access denied executing compiled program", "body": "<p>Using Windows, my Hello World code is in <code>src\\hello\\hello.go</code>.</p>\n\n<p>When using the command \"go run hello.go\"\nGetting Error like this</p>\n\n<pre><code># command-line-arguments\n\n\nC:\\go\\pkg\\tool\\windows_amd64\\link.exe: cannot create $WORK\\b001\\exe\\a.out.exe: open $WORK\\b001\\exe\\a.out.exe: Access is denied.\n</code></pre>\n"}, {"tags": ["go", "couchbase"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574065366, "post_id": 58909263, "comment_id": 104083079, "body": "It doesn&#39;t appear there&#39;s a way to do this at all in Couchbase, in any SDK."}], "answers": [{"tags": [], "owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "is_accepted": true, "score": 4, "last_activity_date": 1574088982, "creation_date": 1574088982, "answer_id": 58917338, "question_id": 58909263, "link": "https://stackoverflow.com/questions/58909263/insert-read-only-document-in-couchbase/58917338#58917338", "title": "Insert Read-Only Document in Couchbase", "body": "<p>There isn't a way to do this at the document level (yet), but one possible workaround with Couchbase Server <em>Enterprise</em> is bucket level permission. You could create a bucket (e.g. \"myreadonly\") and create a user (e.g \"myreadonlyuser\") that only has data reader permission. Of course, someone will need write access to put the document in there in the first place, but anyone using the \"myreadonlyuser\" credentials can only read.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Fp1PQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Fp1PQ.png\" alt=\"screenshot of Couchbase adding a new user\"></a></p>\n\n<p>There might be a way to do it in the upcoming \"scope\" and \"collection\" levels too, but it would likely be a variation of the above approach. Document-level authentication may be on the roadmap for the future.</p>\n"}], "owner": {"reputation": 23, "user_id": 9495920, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UYfH4-AIAKc/AAAAAAAAAAI/AAAAAAAAClk/q6UgMlU_wAo/photo.jpg?sz=128", "display_name": "Nikunj Gupta", "link": "https://stackoverflow.com/users/9495920/nikunj-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58917338, "answer_count": 1, "score": 2, "last_activity_date": 1574088982, "creation_date": 1574059685, "last_edit_date": 1574065372, "question_id": 58909263, "link": "https://stackoverflow.com/questions/58909263/insert-read-only-document-in-couchbase", "title": "Insert Read-Only Document in Couchbase", "body": "<p>Is there any way to Insert Read-Only document or Key-Value pair in Couchbase using couchbase Go SDK?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 5, "creation_date": 1574056236, "post_id": 58908609, "comment_id": 104079644, "body": "How to handle this is explicitly documented in the same file you reference, <a href=\"https://golang.org/src/net/http/client.go?s=17323:17375#L480\" rel=\"nofollow noreferrer\">only a few lines above</a>: <i>&quot;If the returned error is nil, the Response will contain a non-nil Body <b>which the user is expected to close</b>.&quot;</i>"}, {"owner": {"reputation": 563, "user_id": 10714010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1de8ea4503b597aab9c31e5654c197?s=128&d=identicon&r=PG&f=1", "display_name": "user10714010", "link": "https://stackoverflow.com/users/10714010/user10714010"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 1, "creation_date": 1574056539, "post_id": 58908609, "comment_id": 104079741, "body": "yeah, I was expecting some compiler magic to close it, that make sense."}], "answers": [{"tags": [], "owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "is_accepted": true, "score": 2, "last_activity_date": 1574065323, "creation_date": 1574065323, "answer_id": 58910444, "question_id": 58908609, "link": "https://stackoverflow.com/questions/58908609/does-setting-http-response-to-blank-identifier-cause-file-handler-leak/58910444#58910444", "title": "Does setting http response to blank identifier cause file handler leak?", "body": "<p>Yes, this causes a resource leak, preventing the underlying RoundTripper from reusing a persistent (keep-alive) connection.</p>\n\n<p>From the source of <code>http.Response</code>;</p>\n\n<blockquote>\n  <p>It is the caller's responsibility to close Body. \n  The default HTTP client's Transport may not reuse HTTP/1.x \"keep-alive\" TCP connections if the Body is not read to completion and closed.</p>\n</blockquote>\n\n<p>Assigning to the blank identifier doesn't change anything. You are still not reading or closing the <code>http.Response.Body</code>.</p>\n"}], "owner": {"reputation": 563, "user_id": 10714010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1de8ea4503b597aab9c31e5654c197?s=128&d=identicon&r=PG&f=1", "display_name": "user10714010", "link": "https://stackoverflow.com/users/10714010/user10714010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 58910444, "answer_count": 1, "score": -1, "last_activity_date": 1574065392, "creation_date": 1574055855, "last_edit_date": 1574065392, "question_id": 58908609, "link": "https://stackoverflow.com/questions/58908609/does-setting-http-response-to-blank-identifier-cause-file-handler-leak", "title": "Does setting http response to blank identifier cause file handler leak?", "body": "<p>Does this </p>\n\n<pre><code>_, myError := hc.Do(req)\n</code></pre>\n\n<p>cause file handler leak?</p>\n\n<p>I don't see response getting closed in the <a href=\"https://golang.org/src/net/http/client.go?s=17323:17375#L498\" rel=\"nofollow noreferrer\">doc</a> all the time, is the client responsible for closing the response even if its not using it?</p>\n"}, {"tags": ["go", "prisma"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574062066, "post_id": 58908466, "comment_id": 104081701, "body": "The error basically says that <code>[]prisma.Post</code> is not <code>[]*prisma.Post</code>, which is of course correct, those two are indeed different types, and to satisfy an interface your methods must match <i>verbatim</i>. Is there something else besides the error message that is not clear?"}, {"owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574062972, "post_id": 58908466, "comment_id": 104082124, "body": "Thanks for the reply. I might be jumping the gun here since I have no experience in Go. I understand the typing error but I cannot seem to rectify it with my naive attempts to simply adding &#39;*&#39; etc."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574063434, "post_id": 58908466, "comment_id": 104082327, "body": "That&#39;s exactly how you fix it, by simply adding <code>*</code> where it needs to be, well at the least that&#39;s how you fix <i>that</i> specific error. If the compilation still fails that means you have more than just that problem. Please update your question with the fixed code and with the new error message."}, {"owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574065419, "post_id": 58908466, "comment_id": 104083100, "body": "I updated the question with the new error."}, {"owner": {"reputation": 1548, "user_id": 2841607, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjWu8.jpg?s=128&g=1", "display_name": "minitauros", "link": "https://stackoverflow.com/users/2841607/minitauros"}, "edited": false, "score": 1, "creation_date": 1574065836, "post_id": 58908466, "comment_id": 104083280, "body": "Apparently <code>r.Prisma.User(prisma.UserWhereUniqueInput{ID: &amp;obj.ID}).Posts(nil).Exec(ctx)</code> returns <code>[]Post</code> instead of <code>[]*Post</code>. If this is generated code, then maybe you should look a bit further into the documentation (there&#39;s probably some stuff you can do to make Prisma &quot;compatible&quot; with itself)."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574066722, "post_id": 58908466, "comment_id": 104083671, "body": "@Carrein the error indicates, as minitauros pointed out, that the type returned from <code>Exec</code> is <code>[]Post</code>... in that case instead of &quot;adding <code>*</code> where it needs to be&quot; you can &quot;remove <code>*</code> where it shouldn&#39;t be&quot;, i.e. instead of changing the return type of the <code>Posts</code> method on the <code>*userResolver</code> type you can change the return type of the <code>Posts</code> method on the <code>UserResolver</code> interface from <code>[]*Post</code> to <code>[]Post</code>."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 3714327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3eeaade25517984f84f951bbc18b74f?s=128&d=identicon&r=PG&f=1", "display_name": "oscarteg", "link": "https://stackoverflow.com/users/3714327/oscarteg"}, "edited": false, "score": 0, "creation_date": 1578876318, "post_id": 58928024, "comment_id": 105570826, "body": "It says to not edit because it is auto generated by gqlgen"}], "tags": [], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "is_accepted": true, "score": 1, "last_activity_date": 1574145612, "creation_date": 1574145612, "answer_id": 58928024, "question_id": 58908466, "link": "https://stackoverflow.com/questions/58908466/wrong-type-interface-implementation/58928024#58928024", "title": "Wrong type interface implementation", "body": "<p>Modify the <code>generated.go</code> file interfaces to accept a return of <code>[]prisma.Post</code> instead of <code>[]*prisma.Post</code>.</p>\n\n<p>Change:</p>\n\n<pre><code>type UserResolver interface {\n    Posts(ctx context.Context, obj *prisma.User) ([]*prisma.Post, error)\n}\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>type UserResolver interface {\n    Posts(ctx context.Context, obj *prisma.User) ([]prisma.Post, error)\n}\n</code></pre>\n"}], "owner": {"reputation": 2571, "user_id": 6822876, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/i6dGp.jpg?s=128&g=1", "display_name": "Carrein", "link": "https://stackoverflow.com/users/6822876/carrein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 58928024, "answer_count": 1, "score": 0, "last_activity_date": 1574145612, "creation_date": 1574054970, "last_edit_date": 1574065461, "question_id": 58908466, "link": "https://stackoverflow.com/questions/58908466/wrong-type-interface-implementation", "title": "Wrong type interface implementation", "body": "<p>I am trying to follow <a href=\"https://www.prisma.io/docs/get-started/03-build-graphql-servers-with-prisma-GO-g201/\" rel=\"nofollow noreferrer\">Prisma's</a> guide to setting up a GraphQL Go server.</p>\n\n<p><strong>Resolver.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"prismago/hello-world/generated/prisma-client\"\n)\n\n// Resolver struct\ntype Resolver struct {\n    Prisma *prisma.Client\n}\n\n// Mutation MutationResolver\nfunc (r *Resolver) Mutation() MutationResolver {\n    return &amp;mutationResolver{r}\n}\n\n// Post PostResolver\nfunc (r *Resolver) Post() PostResolver {\n    return &amp;postResolver{r}\n}\n\n// Query QueryResolver\nfunc (r *Resolver) Query() QueryResolver {\n    return &amp;queryResolver{r}\n}\n\n// User UserResolver\nfunc (r *Resolver) User() UserResolver {\n    return &amp;userResolver{r}\n}\n\ntype mutationResolver struct{ *Resolver }\n\nfunc (r *mutationResolver) CreateUser(ctx context.Context, name string) (*prisma.User, error) {\n    return r.Prisma.CreateUser(prisma.UserCreateInput{\n        Name: name,\n    }).Exec(ctx)\n}\nfunc (r *mutationResolver) CreateDraft(ctx context.Context, title string, userID string) (*prisma.Post, error) {\n    return r.Prisma.CreatePost(prisma.PostCreateInput{\n        Title: title,\n        Author: &amp;prisma.UserCreateOneWithoutPostsInput{\n            Connect: &amp;prisma.UserWhereUniqueInput{ID: &amp;userID},\n        },\n    }).Exec(ctx)\n}\nfunc (r *mutationResolver) Publish(ctx context.Context, postID string) (*prisma.Post, error) {\n    published := true\n    return r.Prisma.UpdatePost(prisma.PostUpdateParams{\n        Where: prisma.PostWhereUniqueInput{ID: &amp;postID},\n        Data:  prisma.PostUpdateInput{Published: &amp;published},\n    }).Exec(ctx)\n}\n\ntype postResolver struct{ *Resolver }\n\nfunc (r *postResolver) Author(ctx context.Context, obj *prisma.Post) (*prisma.User, error) {\n    return r.Prisma.Post(prisma.PostWhereUniqueInput{ID: &amp;obj.ID}).Author().Exec(ctx)\n}\n\ntype queryResolver struct{ *Resolver }\n\nfunc (r *queryResolver) PublishedPosts(ctx context.Context) ([]prisma.Post, error) {\n    published := true\n    return r.Prisma.Posts(&amp;prisma.PostsParams{\n        Where: &amp;prisma.PostWhereInput{Published: &amp;published},\n    }).Exec(ctx)\n}\nfunc (r *queryResolver) Post(ctx context.Context, postID string) (*prisma.Post, error) {\n    return r.Prisma.Post(prisma.PostWhereUniqueInput{ID: &amp;postID}).Exec(ctx)\n}\nfunc (r *queryResolver) PostsByUser(ctx context.Context, userID string) ([]prisma.Post, error) {\n    return r.Prisma.Posts(&amp;prisma.PostsParams{\n        Where: &amp;prisma.PostWhereInput{\n            Author: &amp;prisma.UserWhereInput{\n                ID: &amp;userID,\n            }},\n    }).Exec(ctx)\n}\nfunc (r *queryResolver) Users(ctx context.Context) ([]prisma.User, error) {\n    return r.Prisma.Users(&amp;prisma.UsersParams{\n        Where: &amp;prisma.UserWhereInput{},\n    }).Exec(ctx)\n}\n\ntype userResolver struct{ *Resolver }\n\nfunc (r *userResolver) Posts(ctx context.Context, obj *prisma.User) ([]prisma.Post, error) {\n    return r.Prisma.User(prisma.UserWhereUniqueInput{ID: &amp;obj.ID}).Posts(nil).Exec(ctx)\n}\n</code></pre>\n\n<p>Running <code>go run ./server</code> generates the following error:</p>\n\n<pre><code>cannot use &amp;userResolver literal (type *userResolver) as type UserResolver in return argument:\n        *userResolver does not implement UserResolver (wrong type for Posts method)\n                have Posts(context.Context, *\"prismago/hello-world/generated/prisma-client\".User) ([]\"prismago/hello-world/generated/prisma-client\".Post, error)\n                want Posts(context.Context, *\"prismago/hello-world/generated/prisma-client\".User) ([]*\"prismago/hello-world/generated/prisma-client\".Post, error)\n\n</code></pre>\n\n<p>I tried to fix the type error:</p>\n\n<pre><code>func (r *userResolver) Posts(ctx context.Context, obj *prisma.User) ([]*prisma.Post, error) {\n    return r.Prisma.User(prisma.UserWhereUniqueInput{ID: &amp;obj.ID}).Posts(nil).Exec(ctx)\n}\n\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>cannot use []\"prismago/hello-world/generated/prisma-client\".Post as type []*\"prismago/hello-world/generated/prisma-client\".Post in return argument\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Related issue: <a href=\"https://github.com/99designs/gqlgen/issues/714\" rel=\"nofollow noreferrer\">https://github.com/99designs/gqlgen/issues/714</a></p>\n"}, {"tags": ["go", "module", "namespaces", "protocol-buffers", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "edited": false, "score": 0, "creation_date": 1574049184, "post_id": 58907225, "comment_id": 104078059, "body": "sorry, I already am importing the types.proto -- corrected above. The problem is that protoc creates two packages, and the one for service_a doesn&#39;t reference the package types."}, {"owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "reply_to_user": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "edited": false, "score": 0, "creation_date": 1574050903, "post_id": 58907225, "comment_id": 104078390, "body": "@DanJenson, correct me if I am wrong 2 packages means 2 package of seperate dto one containing types and other containing SomeRPCRequest ?   SideNote: I think you have to use <code>Result</code> without the <code>types.</code>"}, {"owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "edited": false, "score": 0, "creation_date": 1574051482, "post_id": 58907225, "comment_id": 104078486, "body": "no, &#39;types.Result&#39; is correct; and you&#39;re right, it&#39;s in two packages -- I don&#39;t want that, or I want a clean way for protoc to generate a reference to the latter."}, {"owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "reply_to_user": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "edited": false, "score": 0, "creation_date": 1574051620, "post_id": 58907225, "comment_id": 104078518, "body": "Yeah I have had that issue,  You can use type alias that way it will not allow protoc to generate the same dto again."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "edited": false, "score": 0, "creation_date": 1574152328, "post_id": 58907225, "comment_id": 104119193, "body": "@DanJenson If you do not want two packages, simply do not declare two packages."}], "tags": [], "owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "is_accepted": false, "score": 1, "last_activity_date": 1574043873, "creation_date": 1574043873, "answer_id": 58907225, "question_id": 58906482, "link": "https://stackoverflow.com/questions/58906482/golang-grpc-service-import-types-from-another-file/58907225#58907225", "title": "golang-grpc service - import types from another file", "body": "<p>Well you can import the types.proto in the service_a.proto file and use it  </p>\n\n<p>for example </p>\n\n<pre><code>syntax = \"proto3\";\npackage service_a;\n\n//add this line \nimport \"types.proto\"\n\nservice ServiceA {\n  rpc SomeRPC (SomeRPCRequest) returns (types.Result)\n}\n\nmessage SomeRPCRequest {\n  string x = 1;\n}\n</code></pre>\n\n<p>you can read more here <a href=\"https://developers.google.com/protocol-buffers/docs/proto#importing-definitions\" rel=\"nofollow noreferrer\">https://developers.google.com/protocol-buffers/docs/proto#importing-definitions</a> </p>\n"}, {"tags": [], "owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "is_accepted": false, "score": 0, "last_activity_date": 1574292574, "creation_date": 1574292574, "answer_id": 58964981, "question_id": 58906482, "link": "https://stackoverflow.com/questions/58906482/golang-grpc-service-import-types-from-another-file/58964981#58964981", "title": "golang-grpc service - import types from another file", "body": "<p>This was solved by making both proto files part of the 'pb' package; they can then be compiled to the same output directory (i.e. pb) and have access to symbols defined in both.</p>\n"}], "owner": {"reputation": 605, "user_id": 2909076, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/9384393/picture?type=large", "display_name": "Dan Jenson", "link": "https://stackoverflow.com/users/2909076/dan-jenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1574292574, "creation_date": 1574036031, "last_edit_date": 1574049200, "question_id": 58906482, "link": "https://stackoverflow.com/questions/58906482/golang-grpc-service-import-types-from-another-file", "title": "golang-grpc service - import types from another file", "body": "<p>In my project I have a <code>service_x.proto</code> file for each service and a <code>types.proto</code> file for types shared across all services. However, when I compile for go, it puts them in separate packages; I also can't put <code>go_package = 'service_x'</code> at the top of the <code>types.proto</code> file because it will change for every service <code>x</code> where it is used. What is the cleanest way to compile my service and have access to the message types from <code>types.proto</code> in <code>service_a.pb.go</code>? Here is an example setup:</p>\n\n<p><code>service_a.proto</code>:</p>\n\n<pre><code>syntax = \"proto3\";\npackage service_a;\n\nimport \"types.proto\";\n\nservice ServiceA {\n  rpc SomeRPC (SomeRPCRequest) returns (types.Result)\n}\n\nmessage SomeRPCRequest {\n  string x = 1;\n}\n</code></pre>\n\n<p><code>types.proto</code>:</p>\n\n<pre><code>syntax = \"proto3\";\npackage types;\n\nmessage Result {\n  bool success = 1;\n}\n</code></pre>\n"}, {"tags": ["go", "metaprogramming", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1574037054, "post_id": 58906430, "comment_id": 104075792, "body": "Use <a href=\"https://godoc.org/go/ast#Print\" rel=\"nofollow noreferrer\">ast.Print</a> instead of the spew package when examining the AST.    See <a href=\"https://play.golang.org/p/DDkUT2w3yUV\" rel=\"nofollow noreferrer\">play.golang.org/p/DDkUT2w3yUV</a>"}, {"owner": {"reputation": 675, "user_id": 12259996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zse95.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/12259996/simon"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1574039552, "post_id": 58906430, "comment_id": 104076297, "body": "@CeriseLim&#243;n Thanks! Gonna try this now"}, {"owner": {"reputation": 675, "user_id": 12259996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zse95.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/12259996/simon"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1574043866, "post_id": 58906430, "comment_id": 104077054, "body": "@CeriseLim&#243;n Got <a href=\"https://play.golang.org/p/lT52FOZoj6x\" rel=\"nofollow noreferrer\">play.golang.org/p/lT52FOZoj6x</a> with the help of ast.Print. Good enough for now! (Warning: Borderline hard-coded)"}], "owner": {"reputation": 675, "user_id": 12259996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zse95.jpg?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/12259996/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1574039536, "creation_date": 1574035520, "last_edit_date": 1574039536, "question_id": 58906430, "link": "https://stackoverflow.com/questions/58906430/use-package-go-parser-to-read-ast-of-go-source-code-to-get-an-interfaces-method", "title": "Use package go/parser to read AST of Go source code to get an interface&#39;s methods + their parameters and return types", "body": "<p>For example, I have this interface:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type GenericServer interface {\n    Echo(context.Context, *Message) (*Message, error)\n} \n</code></pre>\n\n<p>And I want to get ONLY:</p>\n\n<pre><code>Echo(context.Context, *Message) (*Message, error)\n</code></pre>\n\n<p>I am able to find the interface and the method name using the answer to this question: <a href=\"https://stackoverflow.com/questions/33836358/parsing-go-src-trying-to-convert-ast-gendecl-to-types-interface\">Parsing go src, trying to convert *ast.GenDecl to types.Interface</a></p>\n\n<p>Using spew hasn't been very helpful because I get a 3600 line dump that I am unable to make much sense of.</p>\n\n<p>If possible I would prefer to stick with importing \"go/ast\", \"go/parser\", \"go/token\", and \"go/types\", and not reading the source file to use regular expressions to find the definition (since I know what the expected name of the interface is). Also, I don't want any sort of manual reflection outside of what's necessary to assert <code>*ast.GenDecl</code> or fields with <code>type interface{}</code> to <code>*ast.Field</code>/<code>*ast.FuncType</code>/etc.</p>\n\n<p>Kudos for some structure that gives me access to the parameters and return types as well.</p>\n"}, {"tags": ["git", "go", "continuous-delivery", "monorepo", "go-git"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 0, "creation_date": 1574076198, "post_id": 58905690, "comment_id": 104088844, "body": "You might need to build it yourself using <a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Tree.Diff\" rel=\"nofollow noreferrer\">Tree.Diff</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574076672, "post_id": 58905690, "comment_id": 104089114, "body": "I&#39;ve updated your title to match the new question, too."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574152225, "post_id": 58905690, "comment_id": 104119146, "body": "TBH, having one repo for multiple applications sounds odd to me in the first place. Have multiple repos each with their own CI, and if you absolutely must, have a &quot;parent&quot; repo which contains the other repos as <a href=\"https://git-scm.com/book/en/v2/Git-Tools-Submodules\" rel=\"nofollow noreferrer\">submodules</a>. Additionally, given that the Go compiler is explicitly optimised for compilation speed (and I rarely have seen any Go program that takes longer than a few seconds to compile), I fail to see the advantage. Like in &quot;at all&quot;."}, {"owner": {"reputation": 603, "user_id": 2904179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XMgKy.png?s=128&g=1", "display_name": "SteveCoffman", "link": "https://stackoverflow.com/users/2904179/stevecoffman"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574173777, "post_id": 58905690, "comment_id": 104131361, "body": "TBH, I agree with you @MarkusWMahlberg but I&#39;m tasked with making the monorepo work, not with deciding whether to do it."}], "answers": [{"tags": [], "owner": {"reputation": 603, "user_id": 2904179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XMgKy.png?s=128&g=1", "display_name": "SteveCoffman", "link": "https://stackoverflow.com/users/2904179/stevecoffman"}, "is_accepted": true, "score": 1, "last_activity_date": 1574108757, "creation_date": 1574108757, "answer_id": 58922399, "question_id": 58905690, "link": "https://stackoverflow.com/questions/58905690/how-to-identify-which-files-have-changed-between-git-commits/58922399#58922399", "title": "How to identify which files have changed between git commits", "body": "<p>It appears that <code>change.Files()</code> gives only the names of the files with <code>to.Name</code>, without the paths inside the repository, however the <code>change.toString()</code> gives the full path.</p>\n\n<p>So if you want to use <a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Tree.Diff\" rel=\"nofollow noreferrer\">Tree.Diff</a>, you have to get the paths like this:</p>\n\n<pre><code>func getChangeName(change *object.Change) string {\n        var empty = object.ChangeEntry{}\n        if change.From != empty {\n            return change.From.Name\n        }\n\n        return change.To.Name\n}\n</code></pre>\n\n<p>So with that, it looks like you can choose either <a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Tree.Diff\" rel=\"nofollow noreferrer\">Tree.Diff</a> or <a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Patch.Stats\" rel=\"nofollow noreferrer\">Patch.Stats</a> depending on your needs:</p>\n\n<pre><code>    currentTree, err := commit.Tree()\n    CheckIfError(err)\n\n    prevTree, err := prevCommit.Tree()\n    CheckIfError(err)\n\n    patch, err := currentTree.Patch(prevTree)\n    CheckIfError(err)\n    fmt.Println(\"----- Patch Stats ------\")\n\n    var changedFiles []string\n    for _, fileStat := range patch.Stats() {\n        fmt.Println(fileStat.Name)\n        changedFiles = append(changedFiles,fileStat.Name)\n    }\n\n    changes, err := currentTree.Diff(prevTree)\n    CheckIfError(err)\n    fmt.Println(\"----- Changes -----\")\n    for _, change := range changes {\n        // Ignore deleted files\n        action, err := change.Action()\n        CheckIfError(err)\n        if action == merkletrie.Delete {\n            //fmt.Println(\"Skipping delete\")\n            continue\n        }\n        // Get list of involved files\n        name := getChangeName(change)\n        fmt.Println(name)\n    }\n</code></pre>\n\n<p><a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Patch.Stats\" rel=\"nofollow noreferrer\">Patch.Stats</a> will skip binary files, where <a href=\"https://godoc.org/gopkg.in/src-d/go-git.v4/plumbing/object#Tree.Diff\" rel=\"nofollow noreferrer\">Tree.Diff</a> will let you ignore deletions.</p>\n"}], "owner": {"reputation": 603, "user_id": 2904179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XMgKy.png?s=128&g=1", "display_name": "SteveCoffman", "link": "https://stackoverflow.com/users/2904179/stevecoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 58922399, "answer_count": 1, "score": 0, "last_activity_date": 1574108757, "creation_date": 1574028607, "last_edit_date": 1592644375, "question_id": 58905690, "link": "https://stackoverflow.com/questions/58905690/how-to-identify-which-files-have-changed-between-git-commits", "title": "How to identify which files have changed between git commits", "body": "<p>How can we use go-git to generate a list of all the files that have changed between two commits similar to <code>git diff --name-only commit1 commit2</code>?</p>\n<p>For context, we have a git monorepo that contains a single root <code>go.mod</code> file but multiple Go applications. When developers push commits to a branch, we would like to get a list of all files that changed between two git commits (<code>git diff --name-only</code>), and filter it down into a list of application directories while excluding some directories. Our ultimate goal is so we can build, deploy, and test just the applications that have changed inside our monorepo. We have a <a href=\"https://github.com/devops-recipes/app-mono/blob/master/detect-changed-services.sh\" rel=\"nofollow noreferrer\">bash script similar to this one from shippable</a> that does this, but we'd like to use pure go and go-git.</p>\n"}, {"tags": ["javascript", "database", "postgresql", "go", "backend"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574021881, "post_id": 58904772, "comment_id": 104072245, "body": "In a phrase: You can&#39;t.  Strictly speaking, you&#39;ll at minimum need a network library, then write your own database access layer. But why would you want to avoid using a proper database library?"}, {"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574022095, "post_id": 58904772, "comment_id": 104072315, "body": "@Flimzy  I want to learn how this things work.  Can you give me some resources."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1574022159, "post_id": 58904772, "comment_id": 104072338, "body": "The proper way to learn how things work is by using the proper library. But resource requests are off-topic on StackOverflow."}, {"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1574022421, "post_id": 58904772, "comment_id": 104072422, "body": "@Flimzy i want to learn how to implement them"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1574022448, "post_id": 58904772, "comment_id": 104072431, "body": "Start by reading the standard one."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1574151883, "post_id": 58904772, "comment_id": 104118974, "body": "You are to be commended that you want to understand how things work on the &quot;inside&quot;. However, expect to walk a rather long and unsatisfying way of reading technical descriptions on <a href=\"https://en.wikipedia.org/wiki/Wire_protocol\" rel=\"nofollow noreferrer\">wire protocols</a>, implementing them and do the whole  &quot;implement=&gt;test=&gt;debutg=&gt;implement&quot; cycle, only to reinvent the wheel, with the slight chance of improving on <b>one</b> database driver. If that still sounds interesting to you, I suggest to start reading the drivers for the database you are most familiar with."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5478472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DUfNk.png?s=128&g=1", "display_name": "Marcelloh", "link": "https://stackoverflow.com/users/5478472/marcelloh"}, "is_accepted": false, "score": 0, "last_activity_date": 1574069279, "creation_date": 1574069279, "answer_id": 58911433, "question_id": 58904772, "link": "https://stackoverflow.com/questions/58904772/how-to-connect-to-a-database-postgresql-from-frontend-and-backend-without-usin/58911433#58911433", "title": "how to connect to a database (postgresql) from frontend and backend without using any library", "body": "<p>You can look at the standard sql library and see how they did that. Next look at some library that uses that standard sql library.</p>\n\n<p>But ehm, by the time you have something working, you'll probably put it inside a... library so if you'll ever succeed to have it without a library, I have my doubts on that.</p>\n"}], "owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 1, "answer_count": 1, "score": -4, "last_activity_date": 1574069279, "creation_date": 1574021634, "question_id": 58904772, "link": "https://stackoverflow.com/questions/58904772/how-to-connect-to-a-database-postgresql-from-frontend-and-backend-without-usin", "title": "how to connect to a database (postgresql) from frontend and backend without using any library", "body": "<p>Please explain how to access a databases from a web app without using any library. I want make query and other database operation without using any library. </p>\n"}, {"tags": ["google-app-engine", "go", "nginx"], "comments": [{"owner": {"reputation": 13407, "user_id": 291180, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Crlpe.png?s=128&g=1", "display_name": "Travis Webb", "link": "https://stackoverflow.com/users/291180/travis-webb"}, "edited": false, "score": 0, "creation_date": 1574043845, "post_id": 58904316, "comment_id": 104077047, "body": "It looks like your app is crashing. where are the application logs?"}, {"owner": {"reputation": 11, "user_id": 12387569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBbOtkjKJYkIJ6OB7liF8zJKe7v5VBgAtUh-1rN=k-s128", "display_name": "Mwangaza", "link": "https://stackoverflow.com/users/12387569/mwangaza"}, "reply_to_user": {"reputation": 13407, "user_id": 291180, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Crlpe.png?s=128&g=1", "display_name": "Travis Webb", "link": "https://stackoverflow.com/users/291180/travis-webb"}, "edited": false, "score": 0, "creation_date": 1574045709, "post_id": 58904316, "comment_id": 104077361, "body": "@TravisWebb I have added the application log file."}], "answers": [{"tags": [], "owner": {"reputation": 1591, "user_id": 10053276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/831841800157687a198362eb5eface93?s=128&d=identicon&r=PG", "display_name": "Methkal Khalawi", "link": "https://stackoverflow.com/users/10053276/methkal-khalawi"}, "is_accepted": false, "score": 0, "last_activity_date": 1574080579, "creation_date": 1574080579, "answer_id": 58914721, "question_id": 58904316, "link": "https://stackoverflow.com/questions/58904316/go-on-google-app-engine-has-frequent-shutdowns/58914721#58914721", "title": "Go on Google App Engine has Frequent Shutdowns", "body": "<p>add <a href=\"https://cloud.google.com/appengine/docs/standard/nodejs/configuring-warmup-requests\" rel=\"nofollow noreferrer\">warmup requests</a> to your App.yaml file:</p>\n\n<pre><code>inbound_services:\n- warmup\n</code></pre>\n\n<p>Also, I suggest you change <strong><a href=\"https://cloud.google.com/appengine/docs/standard/nodejs/config/appref#automatic_scaling_target_cpu_utilization\" rel=\"nofollow noreferrer\">the target_cpu_utilization:</a> 0.6</strong> (which is the default). This will let your instances to start serving as soon as the CPU usage reaches 60%. This will increase your App performance but increase cost.</p>\n"}], "owner": {"reputation": 11, "user_id": 12387569, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBbOtkjKJYkIJ6OB7liF8zJKe7v5VBgAtUh-1rN=k-s128", "display_name": "Mwangaza", "link": "https://stackoverflow.com/users/12387569/mwangaza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1574080579, "creation_date": 1574018625, "last_edit_date": 1574045338, "question_id": 58904316, "link": "https://stackoverflow.com/questions/58904316/go-on-google-app-engine-has-frequent-shutdowns", "title": "Go on Google App Engine has Frequent Shutdowns", "body": "<p>We have a mobile application running off go on Google app engine. We suddenly started having issues with random shut downs from 16th October 2019. First we saw 5xx errors and increased the minimum instances.  Then the error started showing up as container called exit(1). And now, it has changed to terminated process with error exit status 1.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pzsnv.png\" rel=\"nofollow noreferrer\">Error log from nginx</a></p>\n\n<p>This is our current app.yaml setup:</p>\n\n<pre><code>runtime: go111\nenv: standard\ninstance_class: F2\nautomatic_scaling:\n  min_instances: 35\n  max_instances: 35\n  min_idle_instances: 5\n  max_idle_instances: 5  # default value\n  min_pending_latency: 300ms  # default value\n  max_pending_latency: automatic\n  max_concurrent_requests: 50\n  target_cpu_utilization: 0.8\n</code></pre>\n\n<p>The Nginx.conf file</p>\n\n<pre><code>events {\n  worker_connections 768;\n}\n\nhttp {\n  sendfile on;\n  tcp_nopush on;\n  tcp_nodelay on;\n  keepalive_timeout 650;\n  keepalive_requests 10000;\n  types_hash_max_size 2048;\n  include /etc/nginx/mime.types;\n  default_type application/octet-stream;\n\n  # Logs will appear on the Google Developer's Console when logged to this\n  # directory.\n  access_log /var/log/app_engine/app.log;\n  error_log /var/log/app_engine/app.log;\n\n  gzip on;\n  gzip_disable \"msie6\";\n\n  server {\n    # Google App Engine expects the runtime to serve HTTP traffic from\n    # port 8080.\n    listen 8080;\n    root /usr/share/nginx/www;\n    index index.html index.htm;\n  }\n}\n</code></pre>\n\n<p>The application log before the latest shutdown:</p>\n\n<pre><code>2019-11-18 00:30:41.815 EAT\n{\"textPayload\":\"\",\"insertId\":\"5dd1bc01000c72b428121c93\",\"resource\":{\"type\":\"gae_app\",\"labels\":{\"project_id\":\"gumzo-backend-223809\",\"version_id\":\"20191114t210636\",\"module_id\":\"default\",\"zone\":\"us6\"}},\"timestamp\":\"2019-11-17T21:30:41.815796Z\",\"labels\":{\"clone_id\":\"00c61b117ceb00f18aae14afcc55fa0fe6\u2026\n\u00a0\n{\n insertId:\u00a0\"5dd1bc01000c72b428121c93\"\u00a0 \n labels:\u00a0{\n  clone_id:\u00a0\"00c61b117ceb00f18aae14afcc55fa0fe65cfc93726dd8a793451bb6d9c4181ec5fc32\"\u00a0  \n }\n logName:\u00a0\"projects/gumzo-backend-223809/logs/stdout\"\u00a0 \n receiveTimestamp:\u00a0\"2019-11-17T21:30:42.163592840Z\"\u00a0 \n resource:\u00a0{\n  labels:\u00a0{\n   module_id:\u00a0\"default\"\u00a0   \n   project_id:\u00a0\"gumzo-backend-223809\"\u00a0   \n   version_id:\u00a0\"20191114t210636\"\u00a0   \n   zone:\u00a0\"us6\"\u00a0   \n  }\n  type:\u00a0\"gae_app\"\u00a0  \n }\n textPayload:\u00a0\"\"\u00a0 \n timestamp:\u00a0\"2019-11-17T21:30:41.815796Z\"\u00a0 \n}\n2019-11-18 03:15:22.550 EAT\nContainer called exit(1).\n\u00a0\n{\n insertId:\u00a0\"5dd1e29a000864b036cdfc81\"\u00a0 \n labels:\u00a0{\n  clone_id:\u00a0\"00c61b117ced9f166f1fc9560966f8c22ba2187c3d884e466556f0d93d1beb9d7be735db63\"\u00a0  \n }\n logName:\u00a0\"projects/gumzo-backend-223809/logs/varlog%2Fsystem\"\u00a0 \n receiveTimestamp:\u00a0\"2019-11-18T00:15:22.555202950Z\"\u00a0 \n resource:\u00a0{\n  labels:\u00a0{\n   module_id:\u00a0\"default\"\u00a0   \n   project_id:\u00a0\"gumzo-backend-223809\"\u00a0   \n   version_id:\u00a0\"20191114t210636\"\u00a0   \n   zone:\u00a0\"us6\"\u00a0   \n  }\n  type:\u00a0\"gae_app\"\u00a0  \n }\n severity:\u00a0\"WARNING\"\u00a0 \n textPayload:\u00a0\"Container called exit(1).\"\u00a0 \n timestamp:\u00a0\"2019-11-18T00:15:22.550012017Z\"\u00a0 \n}\n\n</code></pre>\n\n<p>Anyone know on how we can keep the application running without multiple shutdowns? Thanks in advance. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574015436, "post_id": 58903676, "comment_id": 104070390, "body": "Using panic-recover for something simple as this has to be, for sure, bad practice. Instead you should use the version you find &quot;ugly&quot; (in my opinion)."}], "owner": {"reputation": 1747, "user_id": 1223777, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/e5d57bacf254409375e9d7b28f2ee952?s=128&d=identicon&r=PG", "display_name": "Subby", "link": "https://stackoverflow.com/users/1223777/subby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "closed_date": 1574022434, "answer_count": 0, "score": 1, "last_activity_date": 1574021262, "creation_date": 1574014734, "last_edit_date": 1574021262, "question_id": 58903676, "link": "https://stackoverflow.com/questions/58903676/best-practice-to-discover-deep-structs-in-golang-that-may-be-nil", "closed_reason": "Duplicate", "title": "Best practice to discover deep structs in golang that may be nil", "body": "<p>At the moment I am using the AWS sdk with golang.\nMost of the API commands return deep structs and all fields of this struct(s) are pointers to be able to represent the absence of data.</p>\n\n<p>But this leads to very ugly code since if you code devensively and want to grab a value deep down the tree this may look like this</p>\n\n<pre><code>func getInstanceID(res *Result) string {\n  if result == nil ||\n     len(result.reservations) == 0  ||\n     result.reservations[0].instance == nil ||\n     result.reservations[0].instance.instanceID == nil {\n     return \"\"\n  }\n\n  return *result.reservations[0].instance.instanceID\n}\n</code></pre>\n\n<p>This is where for example Kotlin safe call feature would come handy.</p>\n\n<p>Could the following code be considered best practice (or rather bad practice) in go:</p>\n\n<pre><code>func getInstanceID(res *Result) string {\n  defer func() { recover() }()\n  return *result.reservations[0].instance.instanceID\n}\n</code></pre>\n\n<p>So you don't have to take care of all the nil and length checks, and if something fails the zero value is returned.</p>\n\n<p>What do you think?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1574001667, "post_id": 58901523, "comment_id": 104066511, "body": "You usually check whether the <code>err</code> is <code>sql.ErrNoRows</code> which means that no row that satisfies the query and its optional where clause exists in the db. As an alternative you could use <code>SELECT EXISTS( ... )</code> instead of <code>SELECT id ...</code> to have the query always result in a boolean value (unless it&#39;s an invalid query) regardless of whether or not the record exists in the database."}], "answers": [{"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1574001706, "creation_date": 1574001706, "answer_id": 58901603, "question_id": 58901523, "link": "https://stackoverflow.com/questions/58901523/how-to-handle-errors-in-sql-requests/58901603#58901603", "title": "How to handle errors in sql requests", "body": "<p>you test the returned error value against <code>sql.ErrNoRows</code> <a href=\"https://golang.org/pkg/database/sql/#pkg-variables\" rel=\"nofollow noreferrer\">https://golang.org/pkg/database/sql/#pkg-variables</a></p>\n\n<p>I also suggest to evaluate client side session storage <a href=\"https://github.com/gorilla/sessions#sessions\" rel=\"nofollow noreferrer\">https://github.com/gorilla/sessions#sessions</a></p>\n"}, {"tags": [], "owner": {"reputation": 1317, "user_id": 7565450, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qgWFA.jpg?s=128&g=1", "display_name": "Varcorb", "link": "https://stackoverflow.com/users/7565450/varcorb"}, "is_accepted": true, "score": 1, "last_activity_date": 1574002835, "last_edit_date": 1574002835, "creation_date": 1574002112, "answer_id": 58901675, "question_id": 58901523, "link": "https://stackoverflow.com/questions/58901523/how-to-handle-errors-in-sql-requests/58901675#58901675", "title": "How to handle errors in sql requests", "body": "<p><code>panic()</code> exits the program. In your example <code>return false</code> is never reached. In this case you can <code>log.Println(err)</code> and then <code>return false</code>. But honestly in a go function like this it is good practice to return a bool and and error. Errors like connection failed, sql errors, est can be returned from your database and needs to be handeled.</p>\n\n<pre><code>func confirmUser(userID string, session string) (error, bool) {\n\n    sqlStatement := `SELECT u.id FROM users u INNER JOIN user_sessions s ON u.id = s.userid WHERE u.id = $1 AND s.session = $2`\n    id := 0\n    err := db.QueryRow(sqlStatement, userID, session).Scan(&amp;id)\n    if err != nil {\n        // if no rows there is no session\n        if err == sql.ErrNoRows {\n           return nil, false\n        }\n        // an error other than no rows was returned, return with error\n        return err, false\n    }\n    fmt.Println(\"Found:\", id)\n    return nil, true\n}\n</code></pre>\n\n<p>On your function that calls <code>confirmUser</code> call your function like this</p>\n\n<pre><code>err, valid := confirmUser(\"myuserid\", \"sessionstring\")\nif err != nil {\n    return err.Error()\n}\n\nif !valid (\n    return \"user not valid\"\n}\n\n// user is valid go on\n</code></pre>\n"}], "owner": {"reputation": 693, "user_id": 1855372, "user_type": "registered", "accept_rate": 55, "profile_image": "https://graph.facebook.com/199601506/picture?type=large", "display_name": "John Sly", "link": "https://stackoverflow.com/users/1855372/john-sly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 58901675, "answer_count": 2, "score": -1, "last_activity_date": 1574002835, "creation_date": 1574001206, "last_edit_date": 1574002795, "question_id": 58901523, "link": "https://stackoverflow.com/questions/58901523/how-to-handle-errors-in-sql-requests", "title": "How to handle errors in sql requests", "body": "<p>I'm working on a project using Go.</p>\n\n<p>I'm trying to validate a user's session by querying the Postgres database. When I get a match, I want to return true, when I don't, I want to return false.</p>\n\n<p>The issue is, when I don't have a match, my program instead throws errors. I am not sure how to catch these errors in Go yet, or if there is a far smarter approach to how I'm running my query.</p>\n\n<pre><code>func confirmUser(userID string, session string) bool {\n    sqlStatement := `SELECT u.id FROM users u INNER JOIN user_sessions s ON u.id = s.userid WHERE u.id = $1 AND s.session = $2`\n    id := 0\n    err := db.QueryRow(sqlStatement, userID, session).Scan(&amp;id)\n    if err != nil {\n        panic(err)\n        return false\n    }\n    fmt.Println(\"Found:\", id)\n    return true\n}\n</code></pre>\n\n<p>My db variable is a global because I'm using it in plenty of places. I think the issue is coming from the <code>.Scan()</code> call, but I'm not sure a better way to go about this. In PHP I'd check if the request was sent successfully, then check the number of rows returned. I'm not sure how to do the equivalent in Go yet.</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12386709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3f9800f0328ff2a570b2206efc675?s=128&d=identicon&r=PG&f=1", "display_name": "sunil khatri", "link": "https://stackoverflow.com/users/12386709/sunil-khatri"}, "edited": false, "score": 2, "creation_date": 1574069948, "post_id": 58911272, "comment_id": 104085271, "body": "Thank you for your response. You have mentioned correctly what &#39;Limit&#39; does. <b>But my use case is different from Limit. I want to limit the results returned after the query has been evaluated(similar to what limit does in Mysql)</b> But what &#39;Limit&#39; does in Dynamodb is, it restricts the rows to be evaluated to the given limit size (in which case I might not even get a single result from query, even though actually there were relevant rows in the database). One more thing, I am using 1.13.1 version of Go and I don&#39;t see any such method/way provided in the documentation. Further help appreciated."}, {"owner": {"reputation": 6333, "user_id": 8891224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZuUL.jpg?s=128&g=1", "display_name": "Nadav Har&#39;El", "link": "https://stackoverflow.com/users/8891224/nadav-harel"}, "reply_to_user": {"reputation": 21, "user_id": 12386709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3f9800f0328ff2a570b2206efc675?s=128&d=identicon&r=PG&f=1", "display_name": "sunil khatri", "link": "https://stackoverflow.com/users/12386709/sunil-khatri"}, "edited": false, "score": 0, "creation_date": 1574070458, "post_id": 58911272, "comment_id": 104085553, "body": "There is no way to do what you want, unfortunately. If you use filtering, it is always possible that even the largest possible page size for the query (if Limit isn&#39;t passed, it defaults to 1MB reads) nothing at all will be returned after filtering. Something you have to remember is that you pay for the amount of data read <b>before</b> filtering. If filtering reads a lot of data and filters most of it out, this will cost you a lot of money - even if the amount of items passed over the network is just one item."}, {"owner": {"reputation": 21, "user_id": 12386709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3f9800f0328ff2a570b2206efc675?s=128&d=identicon&r=PG&f=1", "display_name": "sunil khatri", "link": "https://stackoverflow.com/users/12386709/sunil-khatri"}, "edited": false, "score": 0, "creation_date": 1574133690, "post_id": 58911272, "comment_id": 104113295, "body": "Thank you for this update. I guess then I have only one option i.e. to get all the data and process just the first one."}, {"owner": {"reputation": 6333, "user_id": 8891224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZuUL.jpg?s=128&g=1", "display_name": "Nadav Har&#39;El", "link": "https://stackoverflow.com/users/8891224/nadav-harel"}, "reply_to_user": {"reputation": 21, "user_id": 12386709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3f9800f0328ff2a570b2206efc675?s=128&d=identicon&r=PG&f=1", "display_name": "sunil khatri", "link": "https://stackoverflow.com/users/12386709/sunil-khatri"}, "edited": false, "score": 1, "creation_date": 1574150276, "post_id": 58911272, "comment_id": 104118272, "body": "Yes, just that you don&#39;t need to get &quot;all the data&quot;, you can also set a Limit just be prepared for the possibility that you can get zero results and need to fetch further pages until you get that first result you are looking for."}], "tags": [], "owner": {"reputation": 6333, "user_id": 8891224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AZuUL.jpg?s=128&g=1", "display_name": "Nadav Har&#39;El", "link": "https://stackoverflow.com/users/8891224/nadav-harel"}, "is_accepted": false, "score": 5, "last_activity_date": 1574068690, "creation_date": 1574068690, "answer_id": 58911272, "question_id": 58900865, "link": "https://stackoverflow.com/questions/58900865/how-to-set-limit-on-result-of-a-query-in-dynamodb/58911272#58911272", "title": "How to set limit on result of a query in dynamodb", "body": "<p>As you can see in DynamoDB's official description of the \"Query\" operation - <a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html</a> - the parameter you are looking for is \"Limit\". Please consult your Go library's documentation on how exactly to pass this parameter to the query.</p>\n\n<p>By the way, note that Limit doesn't quite limit the number of returned results, but rather the number of rows read at the server side. If your query has a filter, it can return fewer than Limit results. I don't know whether this matters to you or not.</p>\n"}, {"tags": [], "owner": {"reputation": 2133, "user_id": 220647, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4ffa600af79b1c1830e851bc6e52e7dd?s=128&d=identicon&r=PG", "display_name": "chepukha", "link": "https://stackoverflow.com/users/220647/chepukha"}, "is_accepted": false, "score": 0, "last_activity_date": 1614195270, "creation_date": 1614195270, "answer_id": 66357720, "question_id": 58900865, "link": "https://stackoverflow.com/questions/58900865/how-to-set-limit-on-result-of-a-query-in-dynamodb/66357720#66357720", "title": "How to set limit on result of a query in dynamodb", "body": "<p>You might want to look into pagination. You can use <code>pageSize</code> to control how much you can get in each query.</p>\n<p>More details on pagination can be found <a href=\"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Query.html#Query.Pagination\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 21, "user_id": 12386709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19e3f9800f0328ff2a570b2206efc675?s=128&d=identicon&r=PG&f=1", "display_name": "sunil khatri", "link": "https://stackoverflow.com/users/12386709/sunil-khatri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6534, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1614195270, "creation_date": 1573996932, "last_edit_date": 1574001050, "question_id": 58900865, "link": "https://stackoverflow.com/questions/58900865/how-to-set-limit-on-result-of-a-query-in-dynamodb", "title": "How to set limit on result of a query in dynamodb", "body": "<p>I have a requirement in which I just need a single row to be returned while querying a table in Dynamodb.\nI can see a parameter in aws-cli named 'max-items' which apparently limits the result size of the query.  Here is the sample query:</p>\n\n<pre><code>aws dynamodb query --table-name testTable --key-condition-expression \"CompositePartitionKey = :pk\" \n--expression-attribute-values '{ \":pk\": { \"S\": \"1234_125\" }, \":ps\": { \"S\": \"SOME_STATE\" }\n    }' \n--filter-expression 'StateAttribute IN (:ps) AND attribute_not_exists(AnotherAttribute)' \n--index-name GSI_PK_SK --endpoint-url http://localhost:8000    --max-items 1\n</code></pre>\n\n<p><strong>But I am not able to figure out any similar keyword/attribute in Go.</strong></p>\n\n<p>Here is what I could find relevant: <a href=\"https://stackoverflow.com/questions/31644605/how-to-set-limit-of-matching-items-returned-by-dynamodb-using-java\">How to set limit of matching items returned by DynamoDB using Java?</a></p>\n"}, {"tags": ["go", "logging", "gcloud", "google-cloud-stackdriver", "google-cloud-run"], "comments": [{"owner": {"reputation": 1394, "user_id": 1771963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18964e9a56348e4001a9f2db0ecfd80b?s=128&d=identicon&r=PG", "display_name": "Ramon Medeiros", "link": "https://stackoverflow.com/users/1771963/ramon-medeiros"}, "edited": false, "score": 0, "creation_date": 1573996110, "post_id": 58900506, "comment_id": 104065089, "body": "Why are u trying to use <code>logger.StandardLogger</code> or <code>logging.Info</code> instead of <code>log.Println</code>, which is working?"}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 1394, "user_id": 1771963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18964e9a56348e4001a9f2db0ecfd80b?s=128&d=identicon&r=PG", "display_name": "Ramon Medeiros", "link": "https://stackoverflow.com/users/1771963/ramon-medeiros"}, "edited": false, "score": 0, "creation_date": 1573996660, "post_id": 58900506, "comment_id": 104065217, "body": "@RamonMedeiros because stackdriver logging has great features, like &quot;Trace&quot; and metadata map (&quot;Fields&quot;) for easier search and filtering"}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 1394, "user_id": 1771963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18964e9a56348e4001a9f2db0ecfd80b?s=128&d=identicon&r=PG", "display_name": "Ramon Medeiros", "link": "https://stackoverflow.com/users/1771963/ramon-medeiros"}, "edited": false, "score": 1, "creation_date": 1573997762, "post_id": 58900506, "comment_id": 104065480, "body": "Update: Looks like logging is working, but default filter for &quot;Cloud Run&quot; does not include stackdriver entries. I&#39;ll post an answer soon with all the details."}], "answers": [{"comments": [{"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1574019680, "post_id": 58901110, "comment_id": 104071645, "body": "What do you mean by &quot;written with no errors&quot;? Are the error logs hidden on Cloud Run logs viewer?"}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1574021778, "post_id": 58901110, "comment_id": 104072219, "body": "I mean &quot;log entries are being written successfully&quot;. Will update answer now, thank you for the feedback!"}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1574029660, "post_id": 58901110, "comment_id": 104074379, "body": "Are you using Stackdriver Client libraries to log? Or are you just writing to stdout/stderr? You&#39;re supposed to just write to stdout/stderr on Cloud Run I believe for it to show up in Cloud Run logs viewer."}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1574060538, "post_id": 58901110, "comment_id": 104081082, "body": "Check the code. I use both, but default log viewer&#39;s filter shows only stdout/stderr"}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 1, "creation_date": 1574092698, "post_id": 58901110, "comment_id": 104098312, "body": "@AhmetB-Google Cloud Run logging doc (<a href=\"https://cloud.google.com/run/docs/logging#container-logs\" rel=\"nofollow noreferrer\">cloud.google.com/run/docs/logging#container-logs</a>) says that &quot;Most developers are expected to use stdout and stderr&quot;, but allows to use either, stdout\\stderr, /var/log /dev/log or stackdriver. The fact that stackdriver logs can not be found in &quot;Cloud Run / Logs&quot; part of cloud console UI is not documented."}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1574104717, "post_id": 58901110, "comment_id": 104104165, "body": "Thanks for reporting. I will repro and report this as a bug. Stay tuned on the issue tracker item you reported."}, {"owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "reply_to_user": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "edited": false, "score": 0, "creation_date": 1575705650, "post_id": 58901110, "comment_id": 104662782, "body": "@AhmetB-Google I was able to see my logging entries in &quot;Cloud Run logs&quot; UI section. But to get there, I had to &quot;manually&quot; populate Logging.Entry.Resource with type and labels. Is it expected way to use Stackdriver logging library?"}], "tags": [], "owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "is_accepted": true, "score": 7, "last_activity_date": 1574021810, "last_edit_date": 1574021810, "creation_date": 1573998558, "answer_id": 58901110, "question_id": 58900506, "link": "https://stackoverflow.com/questions/58900506/how-to-use-stackdriver-logging-on-cloud-run/58901110#58901110", "title": "How to use Stackdriver logging on Cloud Run", "body": "<p>It turns out that log entries are written successfully<br>\nBut default Cloud Run filter in <a href=\"https://console.cloud.google.com/logs/viewer\" rel=\"noreferrer\">logviewer web UI</a> does not include them<br>\nFilter expression below worked for me to get all the logs:</p>\n\n<pre><code>resource.type = \"project\" OR resource.type = \"cloud_run_revision\"\n</code></pre>\n\n<p><em>(service name, location, severity omitted)</em><br>\n<a href=\"https://i.stack.imgur.com/xOoKJ.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/xOoKJ.png\" alt=\"Composed logs screenshot\"></a></p>\n\n<p>\"stdout\\stderr\" log entries match <code>resource.type=\"cloud_run_revision\"</code>, while stackdriver log entries match <code>resource.type=\"project\"</code>  </p>\n\n<p>Update: <a href=\"https://issuetracker.google.com/issues/144639502\" rel=\"noreferrer\">I've created a ticket for this in google tracker</a></p>\n"}], "owner": {"reputation": 984, "user_id": 1729543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aLkIU.jpg?s=128&g=1", "display_name": "Slava Medvediev", "link": "https://stackoverflow.com/users/1729543/slava-medvediev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1864, "favorite_count": 0, "accepted_answer_id": 58901110, "answer_count": 1, "score": 7, "last_activity_date": 1596442048, "creation_date": 1573994154, "last_edit_date": 1596442048, "question_id": 58900506, "link": "https://stackoverflow.com/questions/58900506/how-to-use-stackdriver-logging-on-cloud-run", "title": "How to use Stackdriver logging on Cloud Run", "body": "<p>I'm trying to get stackdriver logging working for a simple Go app running in Google Cloud Run (fully managed), but don't see stackdriver entries in CloudRun logs.</p>\n<p>I've created <a href=\"https://github.com/medvedev/cloud-run-stackdriver-logging-issue\" rel=\"nofollow noreferrer\">simplest possible demo app</a> based on <a href=\"https://cloud.google.com/logging/docs/reference/libraries#client-libraries-usage-go\" rel=\"nofollow noreferrer\">&quot;official&quot; stackdriver golang example</a></p>\n<p>Cloud Run docs <a href=\"https://cloud.google.com/run/docs/logging\" rel=\"nofollow noreferrer\">states</a> that no additional actions should be performed to write stackdriver logs</p>\n<p>My service uses default service account</p>\n<p>I'm using Go 1.13 to compile code (Dockerfile is copied from <a href=\"https://cloud.google.com/run/docs/quickstarts/build-and-deploy#containerizing\" rel=\"nofollow noreferrer\">Cloud Run example</a> &quot;as-is&quot;)</p>\n<p>I've tried to deploy it to different regions, with no success</p>\n<p>When running container locally, using service account credentials, stackdriver log message does not appear in local terminal or stackdriver console</p>\n<p>No matter what, on app start I see only <code>&quot;Before stackdriver logging&quot;</code> followed by <code>&quot;After stackdriver logging&quot;</code> with no other messages\\errors in the middle</p>\n<p><a href=\"https://i.stack.imgur.com/TQMG7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TQMG7.png\" alt=\"Logs view screenshot\" /></a></p>\n<p>Here's part of logging code (use link above to get full source, Dockerfile and instructions to build and run the app):</p>\n<pre><code>import (\n    &quot;context&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n    ...\n\n    &quot;cloud.google.com/go/compute/metadata&quot;\n    &quot;cloud.google.com/go/logging&quot;\n)\n\nfunc main() {\n    loggingClient, err := stackdriverClient()\n    ...\n    log.Println(&quot;Before stackdriver logging&quot;)\n    logger.StandardLogger(logging.Info).Println(&quot;Stackdriver log&quot;)\n    if err = logger.Flush(); err != nil {\n        log.Fatalf(&quot;Failed to flush client: %v&quot;, err)\n    }\n    if err = loggingClient.Close(); err != nil {\n        log.Fatalf(&quot;Failed to close client: %v&quot;, err)\n    }\n    log.Println(&quot;After stackdriver logging&quot;)\n    ...\n}\n\nfunc stackdriverClient() (client *logging.Client, err error) {\n    var projectID string\n    if projectID, err = metadata.ProjectID(); err == nil {\n        client, err = logging.NewClient(context.Background(), projectID)\n    }\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "edited": false, "score": 0, "creation_date": 1573994272, "post_id": 58900488, "comment_id": 104064618, "body": "So, you get a json file as API response which contains data of your <code>Root</code> structure?"}, {"owner": {"reputation": 113, "user_id": 5400197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15bd95a827950f2c0a00b6eb48041613?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Chandak", "link": "https://stackoverflow.com/users/5400197/ravi-chandak"}, "edited": false, "score": 1, "creation_date": 1573994831, "post_id": 58900488, "comment_id": 104064773, "body": "I also think the json is not valid, its missing some opening and closing <code>{}</code>  I have corrected the JSON if the json is correct then you should be able to unmarshall the json into the struct and get the required value  <a href=\"https://play.golang.org/p/ysCZCin5kjU\" rel=\"nofollow noreferrer\">play.golang.org/p/ysCZCin5kjU</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6258, "user_id": 11032044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Bz8vL.jpg?s=128&g=1", "display_name": "Kamol Hasan", "link": "https://stackoverflow.com/users/11032044/kamol-hasan"}, "is_accepted": false, "score": 0, "last_activity_date": 1573994730, "creation_date": 1573994730, "answer_id": 58900573, "question_id": 58900488, "link": "https://stackoverflow.com/questions/58900488/i-want-to-get-any-struct-field-value-how-can-i-do-that/58900573#58900573", "title": "I want to get any struct field value , how can I do that?", "body": "<ol>\n<li>Use the same structure to parse the JSON response.</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>data := &amp;Root{}\njson.Unmarshal([]byte(JsonString), data)\n</code></pre>\n\n<ol start=\"2\">\n<li>Then you can access any sub-fields of the <code>Root</code> structure.</li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// like HeWeather structure \nheWeather := data.HEWEATHER6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2132, "user_id": 11125492, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99729fa13566e8998ef1d32c5ee2cff8?s=128&d=identicon&r=PG&f=1", "display_name": "junwen-k", "link": "https://stackoverflow.com/users/11125492/junwen-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1573995011, "creation_date": 1573995011, "answer_id": 58900615, "question_id": 58900488, "link": "https://stackoverflow.com/questions/58900488/i-want-to-get-any-struct-field-value-how-can-i-do-that/58900615#58900615", "title": "I want to get any struct field value , how can I do that?", "body": "<p>You can use <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal</code></a> to unmarshal your json into your structure, and access your value with the dot notation syntax.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\n// Root - 123\ntype Root struct {\n    HEWEATHER6 HeWeather `json:\"HeWeather6\"`\n}\n\n// HeWeather - 123\ntype HeWeather []struct {\n    BASIC  Basic  `json:\"basic\"`\n    UPDATE Update `json:\"update\"`\n    NOW    Now    `json:\"now\"`\n}\n\n// Basic - 123\ntype Basic struct {\n    Cid        string `json:\"cid\"`\n    Location   string `json:\"location\"`\n    ParentCity string `json:\"parent_city\"`\n    AdminArea  string `json:\"admin_area\"`\n    Cnty       string `json:\"cnty\"`\n    Lat        string `json:\"lat\"`\n    Lon        string `json:\"lon\"`\n    Tz         string `json:\"tz\"`\n}\n\n// Update - 123\ntype Update struct {\n    Loc string `json:\"loc\"`\n    Utc string `json:\"utc\"`\n}\n\n// Now - 123\ntype Now struct {\n    Cloud    string `json:\"cloud\"`\n    CondCode string `json:\"cond_code\"`\n    CondTxt  string `json:\"cond_txt\"`\n    Fl       string `json:\"fl\"`\n    Hum      string `json:\"hum\"`\n    Pcpn     string `json:\"pcpn\"`\n    Pres     string `json:\"pres\"`\n    Tmp      string `json:\"tmp\"`\n    Vis      string `json:\"vis\"`\n    WindDeg  string `json:\"wind_deg\"`\n    WindDir  string `json:\"wind_dir\"`\n    WindSc   string `json:\"wind_sc\"`\n    WindSpd  string `json:\"wind_spd\"`\n}\n\nfunc main() {\n    b := `{\n  \"HeWeather6\": [\n    {\n      \"basic\": {\n        \"cid\": \"CN101010100\",\n        \"location\": \"\u5317\u4eac\",\n        \"parent_city\": \"\u5317\u4eac\",\n        \"admin_area\": \"\u5317\u4eac\",\n        \"cnty\": \"\u4e2d\u56fd\",\n        \"lat\": \"39.90498734\",\n        \"lon\": \"116.4052887\",\n        \"tz\": \"+8.00\"\n      },\n      \"update\": {\n        \"loc\": \"2019-11-17 20:09\",\n        \"utc\": \"2019-11-17 12:09\"\n      },\n      \"status\": \"ok\",\n      \"now\": {\n        \"cloud\": \"91\",\n        \"cond_code\": \"101\",\n        \"cond_txt\": \"\u591a\u4e91\",\n        \"fl\": \"-5\",\n        \"hum\": \"12\",\n        \"pcpn\": \"0.0\",\n        \"pres\": \"1024\",\n        \"tmp\": \"4\",\n        \"vis\": \"8\",\n        \"wind_deg\": \"300\",\n        \"wind_dir\": \"\u897f\u5317\u98ce\",\n        \"wind_sc\": \"5\",\n        \"wind_spd\": \"38\"\n      }\n    }\n  ]\n}`\n\n    t := &amp;Root{}\n    err := json.Unmarshal([]byte(b), &amp;t)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(t.HEWEATHER6[0].BASIC.Location)\n\n}\n</code></pre>\n\n<p>Working example here : <a href=\"https://play.golang.org/p/6iGVQeZU1_Z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/6iGVQeZU1_Z</a></p>\n"}], "owner": {"reputation": 7, "user_id": 12386592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27ec05af7216293ee95a3da418eee03e?s=128&d=identicon&r=PG&f=1", "display_name": "xanderchen", "link": "https://stackoverflow.com/users/12386592/xanderchen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1573995628, "creation_date": 1573993991, "last_edit_date": 1573995628, "question_id": 58900488, "link": "https://stackoverflow.com/questions/58900488/i-want-to-get-any-struct-field-value-how-can-i-do-that", "title": "I want to get any struct field value , how can I do that?", "body": "<p>An API returns weather data like this\uff1a</p>\n\n<pre><code>{\n  \"HeWeather6\": [\n    {\n      \"basic\": {\n        \"cid\": \"CN101010100\",\n        \"location\": \"\u5317\u4eac\",\n        \"parent_city\": \"\u5317\u4eac\",\n        \"admin_area\": \"\u5317\u4eac\",\n        \"cnty\": \"\u4e2d\u56fd\",\n        \"lat\": \"39.90498734\",\n        \"lon\": \"116.4052887\",\n        \"tz\": \"+8.00\"\n      },\n      \"update\": {\n        \"loc\": \"2019-11-17 20:09\",\n        \"utc\": \"2019-11-17 12:09\"\n      },\n      \"status\": \"ok\",\n      \"now\": {\n        \"cloud\": \"91\",\n        \"cond_code\": \"101\",\n        \"cond_txt\": \"\u591a\u4e91\",\n        \"fl\": \"-5\",\n        \"hum\": \"12\",\n        \"pcpn\": \"0.0\",\n        \"pres\": \"1024\",\n        \"tmp\": \"4\",\n        \"vis\": \"8\",\n        \"wind_deg\": \"300\",\n        \"wind_dir\": \"\u897f\u5317\u98ce\",\n        \"wind_sc\": \"5\",\n        \"wind_spd\": \"38\"\n      }\n    }\n  ]\n}\n</code></pre>\n\n<p>I created types such as</p>\n\n<pre><code>// Root - 123\ntype Root struct {\n    HEWEATHER6 HeWeather `json:\"HeWeather6\"`\n}\n\n// HeWeather - 123\ntype HeWeather []struct {\n    BASIC  Basic  `json:\"basic\"`\n    UPDATE Update `json:\"update\"`\n    NOW    Now    `json:\"now\"`\n}\n\n// Basic - 123\ntype Basic struct {\n    Cid        string `json:\"cid\"`\n    Location   string `json:\"location\"`\n    ParentCity string `json:\"parent_city\"`\n    AdminArea  string `json:\"admin_area\"`\n    Cnty       string `json:\"cnty\"`\n    Lat        string `json:\"lat\"`\n    Lon        string `json:\"lon\"`\n    Tz         string `json:\"tz\"`\n}\n\n// Update - 123\ntype Update struct {\n    Loc string `json:\"loc\"`\n    Utc string `json:\"utc\"`\n}\n\n// Now - 123\ntype Now struct {\n    Cloud    string `json:\"cloud\"`\n    CondCode string `json:\"cond_code\"`\n    CondTxt  string `json:\"cond_txt\"`\n    Fl       string `json:\"fl\"`\n    Hum      string `json:\"hum\"`\n    Pcpn     string `json:\"pcpn\"`\n    Pres     string `json:\"pres\"`\n    Tmp      string `json:\"tmp\"`\n    Vis      string `json:\"vis\"`\n    WindDeg  string `json:\"wind_deg\"`\n    WindDir  string `json:\"wind_dir\"`\n    WindSc   string `json:\"wind_sc\"`\n    WindSpd  string `json:\"wind_spd\"`\n}\n</code></pre>\n\n<p>How do I store, for example, a single location data into a variable and print it on stdout?</p>\n"}, {"tags": ["http", "go", "unsafe"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1573993068, "post_id": 58900333, "comment_id": 104064303, "body": "you wrap the file server handler, check for the request uri, if it ends in anything undesirable, return an error, otherwise, execute the http file system handler."}, {"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1573993130, "post_id": 58900333, "comment_id": 104064324, "body": "Give me some code example"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574002769, "post_id": 58901542, "comment_id": 104066793, "body": "This only detect .gitignore. But i something that can identity any .file or file in a dot folder"}, {"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574004917, "post_id": 58901542, "comment_id": 104067308, "body": "There is a problem. http.HandlerFunc is  a type not a function. On type conversion it  accepts a function and return a HanerFunc which implement a Handler"}, {"owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "reply_to_user": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574007162, "post_id": 58901542, "comment_id": 104067999, "body": "@deepnum, yes, <code>HandlerFunc</code> accepts a function and converts it into an <code>http.Handler</code>. I had a mistake in the code, which is now corrected.  What the code does is that it registers a handler that checks (the <code>if</code> statement) whether the targeted resource is a <code>.gitignore</code> file. If it is, then a <code>NotFound</code> status code is returned and the request is no longer processed. Otherwise, the original http handler is called, which in your case I presume is an <code>http.FileServer</code>."}, {"owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "reply_to_user": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574007578, "post_id": 58901542, "comment_id": 104068131, "body": "@deepnum, I have extended the code to show how you could detect a <code>.file</code> or file in dot dir. Now, I haven&#39;t tested it nor checked whether it compiles but you should be able to adapt the idea on your own."}, {"owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574007768, "post_id": 58901542, "comment_id": 104068195, "body": "2nd argument of http.Handle accepts a handler interface and http.HandlerFunc implements http.Handler interface."}, {"owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "reply_to_user": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "edited": false, "score": 0, "creation_date": 1574011407, "post_id": 58901542, "comment_id": 104069174, "body": "@deepnum, <code>http.HandlerFunc</code> implements the <code>http.Handler</code> interface, which is exactly what the second argument to <a href=\"https://golang.org/pkg/net/http/#example_Handle\" rel=\"nofollow noreferrer\">http.Handle</a> should be.  I tested the code locally, and it had a problem with the <code>isPrivate</code> function, which is now corrected. The http side of the code is working, however. Are you sure you didn&#39;t accidentally type <code>http.HandleFunc</code> instead of <code>http.HandlerFunc</code>?"}], "tags": [], "owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "is_accepted": false, "score": 1, "last_activity_date": 1574011196, "last_edit_date": 1574011196, "creation_date": 1574001321, "answer_id": 58901542, "question_id": 58900333, "link": "https://stackoverflow.com/questions/58900333/how-to-avoid-dotfiles-or-dot-directories-in-a-http-response/58901542#58901542", "title": "How to avoid dotfiles or dot directories in a http response", "body": "<p>Following is an example partial snippet. The code checks whether the requested file is <code>.gitignore</code>. You will need to adapt this to your code and to extend the <code>if</code> check to handle your specific needs.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>...\n\nfunc isPrivate(urlPath string) bool {\n    for _, segment := range strings.Split(urlPath, \"/\") {\n        if strings.HasPrefix(segment, \".\") {\n            return true\n        }\n    }\n    return false\n}\n...\n\nfunc main() {\n    originalHandler := http.FileServer(http.Dir(\".\")) // or I presume something similar\n\n    http.Handle(\"/\", http.HandlerFunc(func(resp http.ResponseWriter, req *http.Request) {\n        if isPrivate(req.URL.Path) {\n            http.Error(resp, http.StatusText(http.StatusNotFound), http.StatusNotFound)\n            return\n        }\n\n        originalHandler.ServeHTTP(resp, req)\n    }))\n\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9b4288ff00d3bef95903bd068673cce?s=128&d=identicon&r=PG&f=1", "display_name": "deepnum", "link": "https://stackoverflow.com/users/12386599/deepnum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574011196, "creation_date": 1573992999, "last_edit_date": 1574003044, "question_id": 58900333, "link": "https://stackoverflow.com/questions/58900333/how-to-avoid-dotfiles-or-dot-directories-in-a-http-response", "title": "How to avoid dotfiles or dot directories in a http response", "body": "<p>How can I avoid sending files in a dot folder like <code>.git</code> or dot file like <code>.gitignore</code> in a http response?</p>\n\n<p>I want to send a error if user request this kind of files.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1573991830, "post_id": 58898355, "comment_id": 104064032, "body": "A note on terminology: You have absolutely no control over threads in Go. You are only given control of goroutines."}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "is_accepted": false, "score": 0, "last_activity_date": 1573977340, "creation_date": 1573977340, "answer_id": 58898562, "question_id": 58898355, "link": "https://stackoverflow.com/questions/58898355/how-to-exit-from-main-thread/58898562#58898562", "title": "How to exit from main thread", "body": "<p>There is way too much going on in this code. You should restructure your code into short functions that serve specific purposes to make it possible for someone to help you out easily (and help yourself as well).</p>\n\n<p>You should read the following Go article, which goes into concurrency patterns:\n<a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">https://blog.golang.org/pipelines</a></p>\n\n<p>There are multiple ways to make one go-routine wait on some other work to finish. The most common ways are with wait groups (example I have provided) or channels.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\nfunc processSomething(...) {\n    ...\n}\n\nfunc main() {\n    workers := &amp;sync.WaitGroup{}\n\n    for i := 0; i &lt; numWorkers; i++ {\n        workers.Add(1) // you want to call this from the calling go-routine and before spawning the worker go-routine\n\n        go func() {\n            defer workers.Done() // you want to call this from the worker go-routine when the work is done (NOTE the defer, which ensures it is called no matter what)\n            processSomething(....) // your async processing\n        }()\n    }\n\n    // this will block until all workers have finished their work\n    workers.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "is_accepted": false, "score": 1, "last_activity_date": 1573984285, "last_edit_date": 1573984285, "creation_date": 1573979685, "answer_id": 58898802, "question_id": 58898355, "link": "https://stackoverflow.com/questions/58898355/how-to-exit-from-main-thread/58898802#58898802", "title": "How to exit from main thread", "body": "<p>You can use a channel to block <code>main</code> until completion of a goroutine.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n)\n\nfunc main() {\n    c := make(chan struct{})\n\n    go func() {\n        time.Sleep(3 * time.Second)\n        log.Println(\"bye\")\n        close(c)\n    }()\n\n    // This blocks until the channel is closed by the routine\n    &lt;-c\n}\n</code></pre>\n\n<p>No need to write anything into the channel. Reading is blocked until data is read or, which we use here, the channel is closed.</p>\n"}, {"comments": [{"owner": {"reputation": 678, "user_id": 548983, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/cbc0911f0e45dce49d3a2daef5789431?s=128&d=identicon&r=PG", "display_name": "Jorge Machado", "link": "https://stackoverflow.com/users/548983/jorge-machado"}, "edited": false, "score": 0, "creation_date": 1574010951, "post_id": 58899808, "comment_id": 104069050, "body": "wow, Thanks for the detailed explanation. At the end I&#39;m still ending up managing signals and basically gorotines which is not better then other programing language... One question: If I call defer close(r) It will close multiple times the receiving channel,"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 678, "user_id": 548983, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/cbc0911f0e45dce49d3a2daef5789431?s=128&d=identicon&r=PG", "display_name": "Jorge Machado", "link": "https://stackoverflow.com/users/548983/jorge-machado"}, "edited": false, "score": 0, "creation_date": 1574012178, "post_id": 58899808, "comment_id": 104069409, "body": "if you use the <code>v, ok := &lt;-chan</code> syntax you will see it switches once from true to false, meaning chan was closed. not sure what you are referring to. Otherwise, yes this is all &quot;low level&quot; stuff and pretty verbose, it is the essence of golang to make programming as clearer as possible by avoiding hiding things. Now, nothing prevent you from building up an api to handle all this. something like <a href=\"https://github.com/clementauger/orc\" rel=\"nofollow noreferrer\">this</a> might help"}, {"owner": {"reputation": 678, "user_id": 548983, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/cbc0911f0e45dce49d3a2daef5789431?s=128&d=identicon&r=PG", "display_name": "Jorge Machado", "link": "https://stackoverflow.com/users/548983/jorge-machado"}, "edited": false, "score": 0, "creation_date": 1574020977, "post_id": 58899808, "comment_id": 104072009, "body": "I mean, ideally I would close the channel that sends that\u2019s it."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 678, "user_id": 548983, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/cbc0911f0e45dce49d3a2daef5789431?s=128&d=identicon&r=PG", "display_name": "Jorge Machado", "link": "https://stackoverflow.com/users/548983/jorge-machado"}, "edited": false, "score": 0, "creation_date": 1574185028, "post_id": 58899808, "comment_id": 104138178, "body": "that is not sufficient to handle the on going works. That only signals the end of input to the consumers of the channel. It is required to add an additional synchronization mechanism to ensure that the work being in process has a chance to finish, either into the actual expected result, or in the form of a temporary state for future restart. hth."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 2, "last_activity_date": 1573988938, "last_edit_date": 1573988938, "creation_date": 1573988508, "answer_id": 58899808, "question_id": 58898355, "link": "https://stackoverflow.com/questions/58898355/how-to-exit-from-main-thread/58899808#58899808", "title": "How to exit from main thread", "body": "<p>on top of other answers.</p>\n\n<ul>\n<li>Take (great) care that closing a channel should happen on the write call site, not the read call site. In <code>GoCountColumns</code> the <code>r</code> channel being written, the responsibility to close the channel are onto <code>GoCountColumns</code> function. Technical reasons are, it is the only actor knowing for sure that the channel will not being written anymore and thus is safe for close.</li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    func GoCountColumns(in chan []string, r chan Result, quit chan int) {\n        defer close(r)     // this line.\n        for {\n            select {\n            case data := &lt;-in:\n                r &lt;- countColumns(data) // some calculation function\n            case &lt;-quit:\n                return // stop goroutine\n            }\n        }\n    }\n</code></pre>\n\n<ul>\n<li>The function parameters naming convention, if i might say, is to have the destination as first parameter, the source as second, and others parameters along. The <code>GoCountColumns</code> is preferably written:</li>\n</ul>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    func GoCountColumns(dst chan Result, src chan []string, quit chan int) {\n        defer close(dst)\n        for {\n            select {\n            case data := &lt;-src:\n                dst &lt;- countColumns(data) // some calculation function\n            case &lt;-quit:\n                return // stop goroutine\n            }\n        }\n    }\n</code></pre>\n\n<ul>\n<li>You are calling <code>quit</code> right after the process started. Its illogical. This <code>quit</code> command is a force exit sequence, it should be called once an exit signal is detected, to force exit the current processing in best state possible, possibly all broken. In other words, you should be relying on the <code>signal.Notify</code> package to capture exit events, and notify your workers to quit. see <a href=\"https://golang.org/pkg/os/signal/#example_Notify\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/signal/#example_Notify</a></li>\n</ul>\n\n<p>To write better parallel code, list at first the routines you need to manage the program lifetime, identify those you need to block onto to ensure the program has finished before exiting.</p>\n\n<p>In your code, exists <code>read</code>, <code>map</code>. To ensure complete processing, the program main function must ensure that it captures a signal when <code>map</code> exits before exiting itself. Notice that the <code>read</code> function does not matter.</p>\n\n<p>Then, you will also need the code required to capture an exit event from user input.</p>\n\n<p>Overall, it appears we need to block onto two events to manage lifetime. Schematically, </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    go read()\n    go map(mapDone)\n    go signal()\n    select {\n        case &lt;-mapDone:\n        case &lt;-sig:\n    }\n}\n</code></pre>\n\n<p>This simple code is good to <code>process or die</code>. Indeed, when the user event is caught, the program exits immediately, without giving a chance to others routines to do something required upon stop.</p>\n\n<p>To improve those behaviors, you need first a way to signal the program wants to leave to other routines, second, a way to wait for those routines to finish their stop sequence before leaving.</p>\n\n<p>To signal exit event, or cancellation, you can make use of a <code>context.Context</code>, pass it around to the workers, make them listen to it.</p>\n\n<p>Again, schematically,</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    ctx,cancel := context.WithCancel(context.WithBackground())\n    go read(ctx)\n    go map(ctx,mapDone)\n    go signal()\n    select {\n        case &lt;-mapDone:\n        case &lt;-sig:\n            cancel()\n    }\n}\n</code></pre>\n\n<p>(more onto read and map later)</p>\n\n<p>To wait for completion, many things are possible, for as long as they are thread safe. Usually, a <code>sync.WaitGroup</code> is being used. Or, in cases like yours where there is only one routine to wait for, we can re use the current <code>mapDone</code> channel.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    ctx,cancel := context.WithCancel(context.WithBackground())\n    go read(ctx)\n    go map(ctx,mapDone)\n    go signal()\n    select {\n        case &lt;-mapDone:\n        case &lt;-sig:\n            cancel()\n            &lt;-mapDone\n    }\n}\n</code></pre>\n\n<p>That is simple and straight forward. But it is not totally correct. The last mapDone chan might block forever and make the program unstoppable. So you might implement a second signal handler, or a timeout.</p>\n\n<p>Schematically, the timeout solution is</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    ctx,cancel := context.WithCancel(context.WithBackground())\n    go read(ctx)\n    go map(ctx,mapDone)\n    go signal()\n    select {\n        case &lt;-mapDone:\n        case &lt;-sig:\n            cancel()\n            select {\n                case &lt;-mapDone:\n                case &lt;-time.After(time.Second):\n            }\n    }\n}\n</code></pre>\n\n<p>You might also accumulate a signal handling and a timeout in the last select.</p>\n\n<p>Finally, there are few things to tell about <code>read</code> and <code>map</code> context listening.</p>\n\n<p>Starting with <code>map</code>, the implementation requires to read for <code>context.Done</code> channel regularly to detect <code>cancellation</code>. </p>\n\n<p>It is the easy part, it requires to only update the select statement.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    func GoCountColumns(ctx context.Context, dst chan Result, src chan []string) {\n        defer close(dst)\n        for {\n            select {\n            case &lt;-ctx.Done():\n                &lt;-time.After(time.Minute) // do something more useful.\n                return // quit. Notice the defer will be called.\n            case data := &lt;-src:\n                dst &lt;- countColumns(data) // some calculation function\n            }\n        }\n    }\n</code></pre>\n\n<p>Now the <code>read</code> part is bit more tricky as it is an IO it does not provide a <code>select</code>able programming interface and listening to the context channel cancellation might seem contradictory. It is. As IOs are blocking, impossible to listen the context. And while reading from the context channel, impossible to read the IO. In your case, the solution requires to understand that your read loop is not relevant to your program lifetime (recall we only listen onto mapDone?), and that we can just ignore the context. </p>\n\n<p>In other cases, if for example you wanted to restart at last byte read (so at every read, we increment an n, counting bytes, and we want to save that value upon stop). Then, a new routine is required to be started, and thus, multiple routines are to wait for completion. In such cases a <code>sync.WaitGroup</code> will be more appropriate.</p>\n\n<p>Schematically,</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    var wg sync.WaitGroup\n    processDone:=make(chan struct{})\n    ctx,cancel := context.WithCancel(context.WithBackground())\n    go read(ctx)\n    wg.Add(1)\n    go saveN(ctx,&amp;wg)\n    wg.Add(1)\n    go map(ctx,&amp;wg)\n    go signal()\n    go func(){\n        wg.Wait()\n        close(processDone)\n    }()\n    select {\n        case &lt;-processDone:\n        case &lt;-sig:\n            cancel()\n            select {\n                case &lt;-processDone:\n                case &lt;-time.After(time.Second):\n            }\n    }\n}\n</code></pre>\n\n<p>In this last code, the waitgroup is being passed around. Routines are responsible to call for <code>wg.Done()</code>, when all routines are done, the <code>processDone</code> channel is closed, to signal the select.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    func GoCountColumns(ctx context.Context, dst chan Result, src chan []string, wg *sync.WaitGroup) {\n        defer wg.Done()\n        defer close(dst)\n        for {\n            select {\n            case &lt;-ctx.Done():\n                &lt;-time.After(time.Minute) // do something more useful.\n                return // quit. Notice the defer will be called.\n            case data := &lt;-src:\n                dst &lt;- countColumns(data) // some calculation function\n            }\n        }\n    }\n</code></pre>\n\n<p>It is undecided which patterns is preferred, but you might also see <code>waitgroup</code> being managed at call sites only.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main(){\n    var wg sync.WaitGroup\n    processDone:=make(chan struct{})\n    ctx,cancel := context.WithCancel(context.WithBackground())\n    go read(ctx)\n    wg.Add(1)\n    go func(){\n        defer wg.Done()\n        saveN(ctx)\n    }()\n    wg.Add(1)\n    go func(){\n        defer wg.Done()\n        map(ctx)\n    }()\n    go signal()\n    go func(){\n        wg.Wait()\n        close(processDone)\n    }()\n    select {\n        case &lt;-processDone:\n        case &lt;-sig:\n            cancel()\n            select {\n                case &lt;-processDone:\n                case &lt;-time.After(time.Second):\n            }\n    }\n}\n</code></pre>\n\n<p>Beyond all of that and OP questions, you must always evaluate upfront the pertinence of parallel processing for a given task. There is no unique recipe, practice and measure your code performances. see pprof.</p>\n"}], "owner": {"reputation": 678, "user_id": 548983, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/cbc0911f0e45dce49d3a2daef5789431?s=128&d=identicon&r=PG", "display_name": "Jorge Machado", "link": "https://stackoverflow.com/users/548983/jorge-machado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1573988938, "creation_date": 1573974989, "last_edit_date": 1573986784, "question_id": 58898355, "link": "https://stackoverflow.com/questions/58898355/how-to-exit-from-main-thread", "title": "How to exit from main thread", "body": "<pre><code>func GoCountColumns(in chan []string, r chan Result, quit chan int) {\n    for {\n        select {\n        case data := &lt;-in:\n            r &lt;- countColumns(data) // some calculation function\n        case &lt;-quit:\n            return // stop goroutine\n        }\n    }\n\n}\n\nfunc main() {\n    fmt.Println(\"Welcome to the csv Calculator\")\n    file_path := os.Args[1]\n    fd, _ := os.Open(file_path)\n    reader := csv.NewReader(bufio.NewReader(fd))\n    var totalColumnsCount int64 = 0\n    var totallettersCount int64 = 0\n    linesCount := 0\n    numWorkers := 10000\n    rc := make(chan Result, numWorkers)\n    in := make(chan []string, numWorkers)\n    quit := make(chan int)\n    t1 := time.Now()\n\n    for i := 0; i &lt; numWorkers; i++ {\n        go GoCountColumns(in, rc, quit)\n    }\n    //start worksers\n    go func() {\n        for {\n            record, err := reader.Read()\n            if err == io.EOF {\n                break\n            }\n            if err != nil {\n                log.Fatal(err)\n            }\n\n            if linesCount%1000000 == 0 {\n                fmt.Println(\"Adding to the channel\")\n            }\n            in &lt;- record\n            //data := countColumns(record)\n            linesCount++\n            //totalColumnsCount = totalColumnsCount + data.ColumnCount\n            //totallettersCount = totallettersCount + data.LettersCount\n        }\n        close(in)\n    }()\n\n    for i := 0; i &lt; numWorkers; i++ {\n        quit &lt;- 1 // quit goroutines from main\n    }\n    close(rc)\n    for i := 0; i &lt; linesCount; i++ {\n        data := &lt;-rc\n        totalColumnsCount = totalColumnsCount + data.ColumnCount\n        totallettersCount = totallettersCount + data.LettersCount\n    }\n\n    fmt.Printf(\"I counted %d lines\\n\", linesCount)\n    fmt.Printf(\"I counted %d columns\\n\", totalColumnsCount)\n    fmt.Printf(\"I counted %d letters\\n\", totallettersCount)\n    elapsed := time.Now().Sub(t1)\n    fmt.Printf(\"It took %f seconds\\n\", elapsed.Seconds())\n}\n</code></pre>\n\n<p>My Hello World is a program that reads a csv file and passes it to a channel. Then the goroutines should consume from this channel. \nMy Problem is I have no idea how to detect from the main thread that all data was processed and I can exit my program.</p>\n"}, {"tags": ["mongodb", "go", "pagination", "graphql", "cursor"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573989484, "post_id": 58897831, "comment_id": 104063522, "body": "Welcome to SO! You might want to read <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I ask a good question</a>, which enhances the probability for getting a useful answer <i>drastically</i>. You might find <a href=\"https://en.m.wikipedia.org/wiki/Eric_S._Raymond\" rel=\"nofollow noreferrer\">ESR</a>\u2018s excellent essay <a href=\"http://catb.org/~esr/faqs/smart-questions.html\" rel=\"nofollow noreferrer\">How To Ask Questions The Smart Way</a> helpful, too - despite its \u201eharsh\u201c title."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573989941, "post_id": 58897831, "comment_id": 104063613, "body": "The thing is that you need to sort on a specific field, otherwise the results will come in what is called \u201enatural\u201c order, which basically means \u201eundetermined\u201c for your purpose. For a scrolling frontend, I prolly would go for some sort of repository like React\u2018s Flux or Vue\u2018s Vuex, loading roughly 2 times the number of entries shown in each direction. Hard to make more detailed without seeing the actual code, problem and design ;)"}], "owner": {"reputation": 1, "user_id": 6409252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44bd3e85d2da39328828ab1676083168?s=128&d=identicon&r=PG&f=1", "display_name": "awesome", "link": "https://stackoverflow.com/users/6409252/awesome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573969090, "creation_date": 1573969090, "question_id": 58897831, "link": "https://stackoverflow.com/questions/58897831/cursor-based-pagination-in-mongo-db-where-skip-or-limit-is-not-known", "title": "Cursor based pagination in Mongo DB where skip or limit is not known", "body": "<p>I want to use cursor based pagination in Mongo DB. My cursor is an object id. When I run a find query with sort the final result is a list of documents that includes one with above mentioned cursor (object id).</p>\n\n<p>What I want is to be able to get only those documents that are later in the result than given cursor. Which is different from using Skip because I can't know the index of the specific document in the result matching the cursor (object id).</p>\n\n<p>Same goes for backward pagination which is to be able to get only those documents that are before in the result than given cursor.</p>\n\n<p>This is a blocker in my case because of efficiency requirement as the result can be huge list of documents. So I can't just iterate over the result and skip documents before the cursor. I've already tried that and it fails miserably when user keeps scrolling to later part of the result.</p>\n\n<p>Any help will be greatly appreciated.</p>\n\n<p>As a note, I'm using Go Mongo driver and gqlgen graphql server if it's relevant for your answer.</p>\n"}, {"tags": ["go", "webassembly", "tinygo"], "comments": [{"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1573944640, "post_id": 58895956, "comment_id": 104056503, "body": "Bug: <a href=\"https://github.com/tinygo-org/tinygo/issues/728\" rel=\"nofollow noreferrer\">github.com/tinygo-org/tinygo/issues/728</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 0, "last_activity_date": 1573950534, "creation_date": 1573950534, "answer_id": 58896479, "question_id": 58895956, "link": "https://stackoverflow.com/questions/58895956/linkerror-webassembly-instantiate-import-module-env-function-memcpy/58896479#58896479", "title": "LinkError: WebAssembly.instantiate(): Import #... module=&quot;env&quot; function=&quot;memcpy&quot; error: function import requires a callable", "body": "<p>In resolution with the <a href=\"https://github.com/tinygo-org/tinygo/issues/728#issuecomment-554686962\" rel=\"nofollow noreferrer\">workaround post in the bug report</a>, you can fix this bug if it's caused by the use of <code>sha256.Sum</code> or <code>sha256.Write</code> by editing the function in your <a href=\"https://github.com/golang/go/blob/master/src/crypto/sha256/sha256block.go\" rel=\"nofollow noreferrer\"><code>$GOROOT/src/crypto/sha256/sha256block.go</code></a> to:</p>\n\n<pre><code>func blockGeneric(dig *digest, p []byte) {\n    var w [64]uint32\n    h0, h1, h2, h3, h4, h5, h6, h7 := dig.h[0], dig.h[1], dig.h[2], dig.h[3], dig.h[4], dig.h[5], dig.h[6], dig.h[7]\n    for WorkAround1 := 0; WorkAround1 &lt; len(p); WorkAround1 += chunk {\n        WorkAround2 := p[WorkAround1:]\n    //for len(p) &gt;= chunk {\n        // Can interlace the computation of w with the\n        // rounds below if needed for speed.\n        for i := 0; i &lt; 16; i++ {\n            j := i * 4\n            w[i] = uint32(WorkAround2[j])&lt;&lt;24 | uint32(WorkAround2[j+1])&lt;&lt;16 | uint32(WorkAround2[j+2])&lt;&lt;8 | uint32(WorkAround2[j+3])\n        }\n        for i := 16; i &lt; 64; i++ {\n            v1 := w[i-2]\n            t1 := (v1&gt;&gt;17 | v1&lt;&lt;(32-17)) ^ (v1&gt;&gt;19 | v1&lt;&lt;(32-19)) ^ (v1 &gt;&gt; 10)\n            v2 := w[i-15]\n            t2 := (v2&gt;&gt;7 | v2&lt;&lt;(32-7)) ^ (v2&gt;&gt;18 | v2&lt;&lt;(32-18)) ^ (v2 &gt;&gt; 3)\n            w[i] = t1 + w[i-7] + t2 + w[i-16]\n        }\n\n        a, b, c, d, e, f, g, h := h0, h1, h2, h3, h4, h5, h6, h7\n\n        for i := 0; i &lt; 64; i++ {\n            t1 := h + ((e&gt;&gt;6 | e&lt;&lt;(32-6)) ^ (e&gt;&gt;11 | e&lt;&lt;(32-11)) ^ (e&gt;&gt;25 | e&lt;&lt;(32-25))) + ((e &amp; f) ^ (^e &amp; g)) + _K[i] + w[i]\n\n            t2 := ((a&gt;&gt;2 | a&lt;&lt;(32-2)) ^ (a&gt;&gt;13 | a&lt;&lt;(32-13)) ^ (a&gt;&gt;22 | a&lt;&lt;(32-22))) + ((a &amp; b) ^ (a &amp; c) ^ (b &amp; c))\n\n            h = g\n            g = f\n            f = e\n            e = d + t1\n            d = c\n            c = b\n            b = a\n            a = t1 + t2\n        }\n\n        h0 += a\n        h1 += b\n        h2 += c\n        h3 += d\n        h4 += e\n        h5 += f\n        h6 += g\n        h7 += h\n        //p = p[chunk:]\n    }\n\n    dig.h[0], dig.h[1], dig.h[2], dig.h[3], dig.h[4], dig.h[5], dig.h[6], dig.h[7] = h0, h1, h2, h3, h4, h5, h6, h7\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573950534, "creation_date": 1573944602, "question_id": 58895956, "link": "https://stackoverflow.com/questions/58895956/linkerror-webassembly-instantiate-import-module-env-function-memcpy", "title": "LinkError: WebAssembly.instantiate(): Import #... module=&quot;env&quot; function=&quot;memcpy&quot; error: function import requires a callable", "body": "<p>I'm building a Go wasm module (compiled with TinyGo) and it compiles fine. But when I try to run it in the browser I get the above error.</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1573938521, "post_id": 58895218, "comment_id": 104055176, "body": "&quot;is using references in channels a mistake/bad?&quot; --- if it solves your problems: then it&#39;s good no matter what community says. Make decisions based on your needs, not on what the community thinks you should do."}, {"owner": {"reputation": 221, "user_id": 575655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d7c70740ceecad3d069bffef850752?s=128&d=identicon&r=PG", "display_name": "Ken Faulkner", "link": "https://stackoverflow.com/users/575655/ken-faulkner"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1573975040, "post_id": 58895218, "comment_id": 104060832, "body": "It&#39;s more about if there is a general best practice for that type of situation. Yes, absolutely it works for me in this contrived situation... but also the next developer to come along and maintain/modify this code mightn&#39;t realise that another goroutine is modifying the same list, so BOOM things go up in smoke. Personally I&#39;d use it for a small tool thats for me/small group... but if there is a remote chance of it going further I&#39;d want to try to find an alternative ."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573990495, "post_id": 58895218, "comment_id": 104063726, "body": "That is what a little thing called \u201edocumentation\u201c is good for. ;) Godoc <b>and</b> comment your code accordingly."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1574011087, "post_id": 58895218, "comment_id": 104069083, "body": "There are no references in Go. So no: you cannot use nonexisting references."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 575655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d7c70740ceecad3d069bffef850752?s=128&d=identicon&r=PG", "display_name": "Ken Faulkner", "link": "https://stackoverflow.com/users/575655/ken-faulkner"}, "edited": false, "score": 0, "creation_date": 1573939805, "post_id": 58895363, "comment_id": 104055486, "body": "Thanks for the info... yes, I know this is a contrived/non-real-world example, but it got me thinking about reference passing in channels in general."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1573942410, "post_id": 58895363, "comment_id": 104056024, "body": "It would be ideal if the checked answers didn&#39;t use the term &quot;references&quot;: a lot of beginners read it and start to believe there <i>are</i> references in go, while there is no."}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1573943058, "last_edit_date": 1573943058, "creation_date": 1573939479, "answer_id": 58895363, "question_id": 58895218, "link": "https://stackoverflow.com/questions/58895218/is-using-references-in-channels-a-mistake-bad/58895363#58895363", "title": "Is using references in channels a mistake/bad?", "body": "<p>There is nothing wrong with passing pointers, slices, or maps. As long as you synchronize the access to the shared variable, you can pass a pointer and keep on using it in the sending goroutine. For large objects like arrays or large structs, passing a pointer is usually the logical thing to do to avoid expensive copies. Also, avoiding passing pointer means avoiding passing slices and maps, or anything that contains slices, maps, or pointers to other structs.</p>\n\n<p>As you already know, you don't really need channels here, simply start your goroutines after you constructed your slices, and pass the slices directly.</p>\n\n<pre><code>go sortWordsList(words1)\ngo sortWordsList(words2)\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>go sort.Strings(words1)\ngo sort.Strings(words2)\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 575655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17d7c70740ceecad3d069bffef850752?s=128&d=identicon&r=PG", "display_name": "Ken Faulkner", "link": "https://stackoverflow.com/users/575655/ken-faulkner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 58895363, "answer_count": 1, "score": 0, "last_activity_date": 1573943058, "creation_date": 1573938297, "last_edit_date": 1573938498, "question_id": 58895218, "link": "https://stackoverflow.com/questions/58895218/is-using-references-in-channels-a-mistake-bad", "title": "Is using references in channels a mistake/bad?", "body": "<p>Say I have a large list of strings and I want to sort them, beyond the usual sort.Sort and sort.Slice etc I wanted to use more than one core to speed things up. So while reading the large list I add the strings to 2 different slices, strings that start with a-m and n-z (for arguments sake).</p>\n\n<p>Meanwhile I've fired up multiple go routines to read a channel of string slices which will then sort their own sublists. So far, so good, \"potentially\" parallel processing of the lists so my sort time if effectively halved. Great.  Now my question is how do I get the results back to the main goroutine?</p>\n\n<p>Originally each goroutine had 2 channels, one for incoming unsorted list and the other for sorted list. Yes it works...  but uses SOOO much memory (hey give the volume of data I'm tinkering with for this test, that's probably not unreasonable). But then it dawned on me that by passing a slice on a channel is really just passing a reference, so I don't actually NEED to pass anything back. Not having to put the resulting sorted lists in a channel for the return journey is obviously far less taxing memory wise, but it (to me) smells.</p>\n\n<p>This means I could have one of the goroutines sorting away meanwhile the main goroutine (in theory) could be manipulating the same list. As long as discipline is used this wouldn't be an issue, but is still obviously a concern. Is there a generally accepted best practice within Go to say that references shouldn't be passed as input from one goroutine to another.... but IS acceptable that a goroutine generating reference data can be returned via a channel (since the goroutine would then stop using the reference).</p>\n\n<p>Before anyone says it, yes I know I don't have to pass these in via channels etc but this just the case I was tinkering with and got me thinking.</p>\n\n<p>Long and hand wavy I know. Here's a minimal subset of code showing the above.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"sort\"\n    \"strings\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nfunc sortWordsList(id int, ch chan []string ) {\n\n    l := &lt;- ch\n    sort.Strings(l)\n    wg.Done()\n}\n\nfunc main() {\n    file, err := os.Open(\"big.txt\")\n    defer file.Close()\n\n    if err != nil {\n        fmt.Printf(\"BOOM %s\\n\", err.Error())\n        panic(err)\n    }\n\n    // Start reading from the file with a reader.\n    reader := bufio.NewReader(file)\n\n    inCh1 := make(chan []string, 1000)\n    inCh2 := make(chan []string, 1000)\n\n    go sortWordsList(1, inCh1)\n    go sortWordsList(2, inCh2)\n\n    wg.Add(2)\n\n    words1 := []string{}\n    words2 := []string{}\n\n    for {\n        line, err := reader.ReadString('\\n')\n        if err != nil {\n            break\n        }\n\n        sp := strings.Split(line, \" \")\n        for _,w := range sp {\n            word := strings.ToLower(w)\n            word = strings.TrimSuffix(word, \"\\n\")\n            if len(word) &gt; 0 {\n                // figure out where to go.\n                // arbitrary split.\n                if word[0] &lt; 'm' {\n                    words1 = append(words1, word)\n                } else {\n                    words2 = append(words2, word)\n                } \n            }\n        }\n    }\n\n    inCh1 &lt;- words1\n    inCh2 &lt;- words2\n\n    close(inCh1)\n    close(inCh2)\n\n    wg.Wait()\n\n    // now have sorted words1 and words2 slices.\n}\n</code></pre>\n"}, {"tags": ["html", "forms", "go"], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573931503, "creation_date": 1573931503, "question_id": 58894277, "link": "https://stackoverflow.com/questions/58894277/checking-for-missing-file-in-form-post", "title": "Checking for missing file in form post", "body": "<p>Summary: I want to know when a blank HTML file field is submitted, but my code only seems to capture those with file(s) attached. Is there any workaround?</p>\n\n<p>I have a form that allows user to submit files with some metadata about them, something like this:</p>\n\n<pre><code>&lt;form method=\"post\" action=\"/upload\" enctype=\"multipart/form-data\"&gt;\n &lt;label&gt;\n      Paper abstract: \n      &lt;input type=\"text\" name=\"abstract\" /&gt;\n &lt;/label&gt;\n\n &lt;label&gt;\n     &lt;div class=\"item\"&gt;Upload paper in PDF format only&lt;/div&gt;\n     &lt;input type=\"file\" name=\"file\" /&gt;\n &lt;/label&gt;\n\n &lt;!-- the interface allows the html above to be duplicated and submit more papers, e.g., --&gt;\n\n &lt;label&gt;\n      Paper abstract: \n      &lt;input type=\"text\" name=\"abstract\" /&gt;\n &lt;/label&gt;\n\n &lt;label&gt;\n     &lt;div class=\"item\"&gt;Upload paper in PDF format only&lt;/div&gt;\n     &lt;input type=\"file\" name=\"file\" /&gt;\n &lt;/label&gt;\n\n&lt;button type=\"submit\"&gt;Save&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>The server code handles the post something like this:</p>\n\n<pre><code>func Upload(r *http.Request){\n\n    papers := len(r.Form[\"abstract\"])//Check how many papers the user is submitting\n\n    r.ParseMultipartForm(config.MaxMemory)\n\n    for i := 0; i &lt; papers; i++{\n\n      //Saves file and returns bytes -- implemented elsewhere\n      //This line will fail unless every file field has an attachment.\n      //I'd like to see blank file fields too.\n      path, fileSize := uploadFile(r.MultipartForm.File[\"file\"][i])\n\n      paper := &amp;Paper{//struct defined elsewhere\n         Abstract: r.Form[\"abstract\"][i]\n         Path: path, \n         Size: size,\n      }\n\n      savePaper(paper) //implemented elsewhere\n\n    }\n}\n</code></pre>\n\n<p>Thanks for any tips.</p>\n"}, {"tags": ["python", "go", "aws-lambda", "aws-sam"], "comments": [{"owner": {"reputation": 3514, "user_id": 1794802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9404788dd9ecd74e3070ec684adbf439?s=128&d=identicon&r=PG", "display_name": "strongjz", "link": "https://stackoverflow.com/users/1794802/strongjz"}, "edited": false, "score": 0, "creation_date": 1573943680, "post_id": 58894092, "comment_id": 104056311, "body": "What version of the lambda docker container are you using? I just tested it with docker image b8e51a982e64 and it worked. Does the go test pass?"}, {"owner": {"reputation": 1567, "user_id": 810706, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7e50c2321b7235c53a46fee37497a98f?s=128&d=identicon&r=PG", "display_name": "Tyson", "link": "https://stackoverflow.com/users/810706/tyson"}, "reply_to_user": {"reputation": 3514, "user_id": 1794802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9404788dd9ecd74e3070ec684adbf439?s=128&d=identicon&r=PG", "display_name": "strongjz", "link": "https://stackoverflow.com/users/1794802/strongjz"}, "edited": false, "score": 0, "creation_date": 1573951272, "post_id": 58894092, "comment_id": 104057710, "body": "I&#39;m using that same image ID. Running &#39;go test&#39; results in a pass. Running &#39;sam deploy&#39; and uploading to Lambda results in the function working as expected as well - I just can&#39;t get it working locally."}], "answers": [{"tags": [], "owner": {"reputation": 1541, "user_id": 2232135, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7swMf.png?s=128&g=1", "display_name": "smcstewart", "link": "https://stackoverflow.com/users/2232135/smcstewart"}, "is_accepted": false, "score": 0, "last_activity_date": 1576616051, "creation_date": 1576616051, "answer_id": 59381936, "question_id": 58894092, "link": "https://stackoverflow.com/questions/58894092/lambda-function-for-the-route-not-found-error-running-golang-function-locally/59381936#59381936", "title": "&quot;Lambda function for the route not found&quot; error running Golang function locally with SAM?", "body": "<p>Late to the party on this one and you've probably resolved it already. Without seeing any code, it looks like you've made a HEAD request, rather than a GET request and I suspect you have no route for the HEAD method, only GET.</p>\n"}], "owner": {"reputation": 1567, "user_id": 810706, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7e50c2321b7235c53a46fee37497a98f?s=128&d=identicon&r=PG", "display_name": "Tyson", "link": "https://stackoverflow.com/users/810706/tyson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576616051, "creation_date": 1573930298, "question_id": 58894092, "link": "https://stackoverflow.com/questions/58894092/lambda-function-for-the-route-not-found-error-running-golang-function-locally", "title": "&quot;Lambda function for the route not found&quot; error running Golang function locally with SAM?", "body": "<p>I'm attempting to write a Lambda function in Golang (doing development on my MacBook with Docker Desktop running) following <a href=\"https://maori.geek.nz/hello-sam-aws-golang-quickstart-dc8b4b8c49ed\" rel=\"nofollow noreferrer\">this</a> quick-start. I perform the following steps:</p>\n\n<ol>\n<li>Ran \"sam init --runtime go1.x --name testing\" to generate a function from the template.</li>\n<li>Ran \"make deps\" to go get dependencies.</li>\n<li>Ran \"make build\" to build the code that was generated to hello-world/hello-word.</li>\n<li>Ran \"sam local start-api\".</li>\n</ol>\n\n<p>Everything looks like it starts correctly:</p>\n\n<pre><code>Mounting HelloWorldFunction at http://127.0.0.1:3000/hello [GET]\nYou can now browse to the above endpoints to invoke your functions. You do not need to restart/reload SAM CLI while working on your functions, changes will be reflected instantly/automatically. You only need to restart SAM CLI if you update your AWS SAM template\n2019-11-16 10:39:19  * Running on http://127.0.0.1:3000/ (Press CTRL+C to quit)\n</code></pre>\n\n<p>But when I curl the endpoint, I get a 502 and I see an error:</p>\n\n<pre><code>2019-11-16 10:39:23 Exception on /hello [HEAD]\nTraceback (most recent call last):\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/app.py\", line 2317, in wsgi_app\n    response = self.full_dispatch_request()\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/app.py\", line 1840, in full_dispatch_request\n    rv = self.handle_user_exception(e)\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/app.py\", line 1743, in handle_user_exception\n    reraise(exc_type, exc_value, tb)\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/_compat.py\", line 36, in reraise\n    raise value\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/app.py\", line 1838, in full_dispatch_request\n    rv = self.dispatch_request()\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/flask/app.py\", line 1824, in dispatch_request\n    return self.view_functions[rule.endpoint](**req.view_args)\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/samcli/local/apigw/local_apigw_service.py\", line 172, in _request_handler\n    route = self._get_current_route(request)\n  File \"/usr/local/Cellar/aws-sam-cli/0.31.0/libexec/lib/python3.7/site-packages/samcli/local/apigw/local_apigw_service.py\", line 236, in _get_current_route\n    raise KeyError(\"Lambda function for the route not found\")\nKeyError: 'Lambda function for the route not found'\n2019-11-16 10:39:23 127.0.0.1 - - [16/Nov/2019 10:39:23] \"HEAD /hello HTTP/1.1\" 502 -\n</code></pre>\n\n<p>What am I missing?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 5, "creation_date": 1573923382, "post_id": 58893042, "comment_id": 104051260, "body": "please show a complete example.   specifically I need to see the definition of your struct.  also, duplicate fields are out fo the json spec."}, {"owner": {"reputation": 1, "user_id": 11807013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f723f4ad6c3d77719825dd98cd88aba?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Biggs", "link": "https://stackoverflow.com/users/11807013/eric-biggs"}, "reply_to_user": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "edited": false, "score": 0, "creation_date": 1573923649, "post_id": 58893042, "comment_id": 104051323, "body": "If you take the pastebin file and put it into here - <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">mholt.github.io/json-to-go</a> it spits out the struct I&#39;ve been working with. I&#39;ve tried both styles that the tool offers, no luck with either I&#39;m afraid. (I tried to put it into the question, but the character length is too long!)"}, {"owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1573924329, "post_id": 58893042, "comment_id": 104051503, "body": "json.Unmarshal(bytes, &amp;[structname]) error is not being read here ( add the error variable to identify the error your facing err = json.Unmarshal(bytes, &amp;[structname])).. and just a suggestion try unmarshalling the json to map[string]interface{} and parse it individually"}, {"owner": {"reputation": 1, "user_id": 11807013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f723f4ad6c3d77719825dd98cd88aba?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Biggs", "link": "https://stackoverflow.com/users/11807013/eric-biggs"}, "reply_to_user": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1573926334, "post_id": 58893042, "comment_id": 104052013, "body": "@SivaGuru I&#39;m not exactly sure what you mean, could you give me an example of how that looks? (I am a total novice, just going through some courses with go at the moment so I apologize!)"}, {"owner": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1573927466, "post_id": 58893042, "comment_id": 104052313, "body": "<a href=\"https://play.golang.org/p/woFMgfYRdcq\" rel=\"nofollow noreferrer\">play.golang.org/p/woFMgfYRdcq</a>"}, {"owner": {"reputation": 1, "user_id": 11807013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f723f4ad6c3d77719825dd98cd88aba?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Biggs", "link": "https://stackoverflow.com/users/11807013/eric-biggs"}, "reply_to_user": {"reputation": 694, "user_id": 8627962, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4f-Yq3BvCaA/AAAAAAAAAAI/AAAAAAAAARM/NeJoNAwQHT0/photo.jpg?sz=128", "display_name": "Siva Guru", "link": "https://stackoverflow.com/users/8627962/siva-guru"}, "edited": false, "score": 0, "creation_date": 1573928294, "post_id": 58893042, "comment_id": 104052553, "body": "Thanks @SivaGuru, I&#39;ll tinker with this a bit and see if I can learn a thing or two. Appreciate the input! :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11807013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f723f4ad6c3d77719825dd98cd88aba?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Biggs", "link": "https://stackoverflow.com/users/11807013/eric-biggs"}, "edited": false, "score": 0, "creation_date": 1574020635, "post_id": 58901606, "comment_id": 104071924, "body": "Thanks for the feedback. I&#39;m primarily learning from various internet guides as I dip my toes into go so I don&#39;t yet have a firm grasp of what the &quot;right&quot; way to do things are. I appreciate pointing out the optimization!"}], "tags": [], "owner": {"reputation": 339, "user_id": 2852445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03167a12f5062b9b5aec927a2fef5af3?s=128&d=identicon&r=PG&f=1", "display_name": "Momchil Atanasov", "link": "https://stackoverflow.com/users/2852445/momchil-atanasov"}, "is_accepted": false, "score": 0, "last_activity_date": 1574001736, "creation_date": 1574001736, "answer_id": 58901606, "question_id": 58893042, "link": "https://stackoverflow.com/questions/58893042/unmarshalling-json-with-duplicate-fields/58901606#58901606", "title": "Unmarshalling JSON with Duplicate Fields", "body": "<p>In your code, you are not unmarshaling into the <code>channel</code> variable. Furthermore, you can optimize your code to not use <code>ReadAll</code>. Also, don't forget to check for errors (all errors).</p>\n\n<p>Here is an improvement to your code.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>jsonFile, err := os.Open(\"test.json\")\nif err != nil {\n    log.Fatalf(\"could not open file: %v\", err)\n}\ndefer jsonFile.Close()\n\nvar channel Autogenerated\nif err := json.NewDecoder(jsonFile).Decode(&amp;channel); err != nil {\n    log.Fatalf(\"failed to parse json: %v\", err)\n}\n\nfmt.Println(channel.Fieldname)\n</code></pre>\n\n<p>Notice how a reference to <code>channel</code> is passed to <code>Decode</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11807013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f723f4ad6c3d77719825dd98cd88aba?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Biggs", "link": "https://stackoverflow.com/users/11807013/eric-biggs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1574001736, "creation_date": 1573923243, "last_edit_date": 1573925114, "question_id": 58893042, "link": "https://stackoverflow.com/questions/58893042/unmarshalling-json-with-duplicate-fields", "title": "Unmarshalling JSON with Duplicate Fields", "body": "<p>I'm still learning the go language, but I've been trying to find some practical things to work on to get a better handle on it. Currently, I'm trying to build a simple program that goes to a youtube channel and returns some information by taking the public JSON and unmarshalling it. </p>\n\n<p>Thus far I've tried making a completely custom struct that only has a few fields in it, but that doesn't seem to pull in any values. I've also tried using tools like <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> and getting the \"real\" struct that way. The issue with that method is there are numerous duplicates and I don't know enough to really assess how to tackle that.</p>\n\n<p><strong>This is an example JSON (I apologize for its size) <a href=\"https://pastebin.com/6u0b39tU\" rel=\"nofollow noreferrer\">https://pastebin.com/6u0b39tU</a></strong></p>\n\n<p><strong>This is the struct that I get from the above tool: <a href=\"https://pastebin.com/3ZCu96st\" rel=\"nofollow noreferrer\">https://pastebin.com/3ZCu96st</a></strong></p>\n\n<p>the basic pattern of code I've tried is:</p>\n\n<pre><code>jsonFile, err := os.Open(\"test.json\")\nif err != nil {\n    fmt.Println(\"Couldn't open file\", err)\n}\ndefer jsonFile.Close()\n\nbytes, _ := ioutil.ReadAll(jsonFile)\n\nvar channel Autogenerated\n\njson.Unmarshal(bytes, &amp;Autogenerated)\nif err != nil {\n    fmt.Println(\"Failed to Unmarshal\", err)\n}\n\nfmt.Println(channel.Fieldname)\n</code></pre>\n\n<p>Any feedback on the correct approach for how to handle something like this would be great. I get the feeling I'm just completely missing something.</p>\n"}, {"tags": ["image", "go", "clipboard"], "comments": [{"owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1613634945, "post_id": 58892286, "comment_id": 117136801, "body": "did you figured it out?"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 6085396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588eb38d4fc739d3e718bf5a2e25d311?s=128&d=identicon&r=PG&f=1", "display_name": "CSDD", "link": "https://stackoverflow.com/users/6085396/csdd"}, "edited": false, "score": 0, "creation_date": 1573930884, "post_id": 58892443, "comment_id": 104053254, "body": "Thank you for answering my question, but passing <code>CF_BITMAP</code> to <code>GetClipboardData</code> yield another problem which I have updated in my question. Can you have a look?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 123, "user_id": 6085396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588eb38d4fc739d3e718bf5a2e25d311?s=128&d=identicon&r=PG&f=1", "display_name": "CSDD", "link": "https://stackoverflow.com/users/6085396/csdd"}, "edited": false, "score": 0, "creation_date": 1574074084, "post_id": 58892443, "comment_id": 104087606, "body": "@CSDD, this turned out to be trickier to get right than I expected. I&#39;ve got a half-working solution by now; hope to get it ready in several hours."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 3, "last_activity_date": 1573919216, "creation_date": 1573919216, "answer_id": 58892443, "question_id": 58892286, "link": "https://stackoverflow.com/questions/58892286/how-to-get-image-data-from-windows-clipboard/58892443#58892443", "title": "How to get image data from Windows clipboard", "body": "<h2>The problem</h2>\n\n<p>The <code>github.com/atotto/clipboard</code> package appears to specifically target operating on text, and it's cross -platform, so that's what you get.</p>\n\n<p>On Windows\u2122, the package uses the standard Win32 API to access the clipboard.\nSpecifically, <a href=\"https://github.com/atotto/clipboard/blob/579379fa8ff8a6d3fa979cec107f8f6d7f8fde90/clipboard_windows.go#L59\" rel=\"nofollow noreferrer\">this statement</a> calls <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-getclipboarddata\" rel=\"nofollow noreferrer\"><code>GetClipboardData()</code></a> passing it the <a href=\"https://docs.microsoft.com/en-us/windows/win32/dataxchg/clipboard-formats\" rel=\"nofollow noreferrer\"><code>CF_UNICODETEXT</code></a> format parameter, and that's why the operation completes successfully: it returns what text the clipboard contains (in your case\u2014none, an empty string).</p>\n\n<h2>The solution</h2>\n\n<p>The straightforward solution is to copy the relevant bits of the Windows-specific code from that package and modify the argument in the call to <code>GetClipboardData</code> to <code>CF_BITMAP</code> instead.</p>\n\n<p>A more involved solution may be to first perform a series of calls to <a href=\"https://docs.microsoft.com/en-us/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats\" rel=\"nofollow noreferrer\"><code>EnumClipboardFormats()</code></a> and figure out whether any image data (<code>CF_BITMAP</code>) is available, and call <code>GetClipboardData</code> only in the case it is.</p>\n"}, {"tags": [], "owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "is_accepted": false, "score": 0, "last_activity_date": 1613936912, "creation_date": 1613936912, "answer_id": 66306423, "question_id": 58892286, "link": "https://stackoverflow.com/questions/58892286/how-to-get-image-data-from-windows-clipboard/66306423#66306423", "title": "How to get image data from Windows clipboard", "body": "<p>For anyone who still looking for a solution. Here is an active Go package that can deal with UTF8 and image clipboard data:</p>\n<p><a href=\"https://github.com/golang-design/clipboard\" rel=\"nofollow noreferrer\">https://github.com/golang-design/clipboard</a></p>\n<p>It is also cross-platform (Linux/Windows/macOS) without additional dependencies, which is a good replacement for the mentioned atotto/clipboard package.</p>\n"}], "owner": {"reputation": 123, "user_id": 6085396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588eb38d4fc739d3e718bf5a2e25d311?s=128&d=identicon&r=PG&f=1", "display_name": "CSDD", "link": "https://stackoverflow.com/users/6085396/csdd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1613936912, "creation_date": 1573918267, "last_edit_date": 1573930825, "question_id": 58892286, "link": "https://stackoverflow.com/questions/58892286/how-to-get-image-data-from-windows-clipboard", "title": "How to get image data from Windows clipboard", "body": "<p>I am trying to write a program in Golang to get image data from Windows Clipboard.</p>\n\n<p>I understand that <a href=\"http://atotto/clipboard:%20clipboard%20for%20golang%20-%20GitHub\" rel=\"nofollow noreferrer\">there is a plugin for getting data from Windows Clipboard</a>, the problem is it does not support image data, text only. Basically just not what am I looking for.</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n        \"github.com/atotto/clipboard\"\n)\n\n\nfunc main()  {\n    str,err:=clipboard.ReadAll()\n    if err!=nil {\n        fmt.Println(err)        \n    }else {\n        fmt.Println(str)\n    }\n}\n</code></pre>\n\n<p>This will output the \"The operation completed successfully.\" error if the clipboard contains an image.</p>\n\n<p>Any idea how to do this?</p>\n\n<p><strong>Update!:</strong></p>\n\n<p>I tried passing <code>CF_BITMAP</code> to <code>GetClipboardData</code>, which return a handle to a bitmap (Hbitmap). I am not familiar with handling that, but apparently it is a long unsigned number?</p>\n\n<p>Anyway, I tried some googling at came to <a href=\"https://github.com/lxn/win/blob/master/gdiplus.go\" rel=\"nofollow noreferrer\">this</a>. Using the function <code>GdipCreateBitmapFromHBITMAP</code>: </p>\n\n<pre><code>var Bitmap *win.GpBitmap\npBitmap := &amp;Bitmap\nfmt.Println(win.GdipCreateBitmapFromHBITMAP(win.HBITMAP(Hbitmap),0,pBitmap))\n</code></pre>\n\n<p>I got an \"ok\" output, but the Bitmap is empty. And I am stuck again.</p>\n\n<p>How am I supposed to store the bitmap?</p>\n"}, {"tags": ["go", "recursion", "scope"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1573918531, "post_id": 58891848, "comment_id": 104049883, "body": "There&#39;s no variable shadowing in the provided code. Please do not elide that part of the code that you need help with. <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1306, "user_id": 5705686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-jYuOhkTQVgQ/AAAAAAAAAAI/AAAAAAAAA1A/v5x1CDU6W4s/photo.jpg?sz=128", "display_name": "dolan", "link": "https://stackoverflow.com/users/5705686/dolan"}, "is_accepted": false, "score": 0, "last_activity_date": 1573930842, "creation_date": 1573930842, "answer_id": 58894174, "question_id": 58891848, "link": "https://stackoverflow.com/questions/58891848/shadowed-arguments-in-recursive-function/58894174#58894174", "title": "Shadowed arguments in recursive function", "body": "<p>If type <code>x</code> contains any pointer types, those must also be copied if you are updating them in the recursive call. For example, if <code>x</code> looked like this:</p>\n\n<pre><code>type x struct {\n   d *y\n}\n</code></pre>\n\n<p>You would need to update both x and y.</p>\n\n<pre><code>c := new(x)\n*c = *a\nd := new(y)\n*c.d := *d\n</code></pre>\n\n<p>A better strategy might be to eliminate all pointers in the problem. If <code>a</code> were of type <code>x</code> and <code>d</code> were of type <code>y</code>, then <code>f(a, b)</code> would copy both values on invocation.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6216224"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573930842, "creation_date": 1573915393, "question_id": 58891848, "link": "https://stackoverflow.com/questions/58891848/shadowed-arguments-in-recursive-function", "title": "Shadowed arguments in recursive function", "body": "<pre><code>var f func(a *x, b int)\nf = func(a *x, b int) {\n    // a and b are changed here.\n    if ... {\n        return\n    }\n    for ... {\n        c := new(x)\n        *c = *a\n        f(c, b)          \n    }\n}\n</code></pre>\n\n<p>The code illustrates the structure of my program.</p>\n\n<p>I expected that after the return-statement is reached, the arguments are reset to the state prior to the recursive function call and the loop continues with the next iteration.</p>\n\n<p>To my surprise, the debugger labels the expected values as shadowed and the program continues with the manipulated ones, set  by the recursive call.</p>\n\n<p>How can I achieve the expected behavior?</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["go", "logging"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 8, "creation_date": 1573914103, "post_id": 58891593, "comment_id": 104048659, "body": "The log package writes to stderr by default, so you can redirect that stream in your shell: <code>go run hello 2&gt;&#47;dev&#47;null</code>"}, {"owner": {"reputation": 5093, "user_id": 302005, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eDmEQ.png?s=128&g=1", "display_name": "Pioz", "link": "https://stackoverflow.com/users/302005/pioz"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1573914354, "post_id": 58891593, "comment_id": 104048720, "body": "Interesting but weird cause a log message is not an error message."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1573919475, "post_id": 58891593, "comment_id": 104050207, "body": "A log message isn&#39;t productive output either. Imagine implementing grep in Go and log messages would go to stdout."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1573920275, "post_id": 58891593, "comment_id": 104050417, "body": "&quot;Interesting but weird cause a log message is not an error message&quot; -- pretty standard behavior for most unix tools, though."}, {"owner": {"reputation": 1867, "user_id": 1416225, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/sMRhL.jpg?s=128&g=1", "display_name": "meth", "link": "https://stackoverflow.com/users/1416225/meth"}, "edited": false, "score": 0, "creation_date": 1574092815, "post_id": 58891593, "comment_id": 104098371, "body": "<a href=\"https://github.com/sirupsen/logrus\" rel=\"nofollow noreferrer\">logrus</a> may help you. It also has log levels."}], "answers": [{"tags": [], "owner": {"reputation": 1767, "user_id": 1073170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c13e7782e36e3cf978a02ee761c7e70e?s=128&d=identicon&r=PG", "display_name": "Jory Geerts", "link": "https://stackoverflow.com/users/1073170/jory-geerts"}, "is_accepted": true, "score": 1, "last_activity_date": 1574092528, "creation_date": 1574092528, "answer_id": 58918466, "question_id": 58891593, "link": "https://stackoverflow.com/questions/58891593/how-to-suppress-logs/58918466#58918466", "title": "How to suppress logs", "body": "<p>You can either have the shell discard the output using <code>go run hello 2&gt;/dev/null</code> (as @TimCooper mentioned in the comments), or you can overwrite the output of the <code>log</code> package by calling <code>log.SetOutput()</code> and passing an implementation of <code>io.Writer</code> that discards the input (or writes it to whatever you want).</p>\n"}], "owner": {"reputation": 5093, "user_id": 302005, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eDmEQ.png?s=128&g=1", "display_name": "Pioz", "link": "https://stackoverflow.com/users/302005/pioz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 58918466, "answer_count": 1, "score": 1, "last_activity_date": 1574092528, "creation_date": 1573913698, "last_edit_date": 1573919897, "question_id": 58891593, "link": "https://stackoverflow.com/questions/58891593/how-to-suppress-logs", "title": "How to suppress logs", "body": "<p>If I have a code in Go like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"log\"\n\nfunc main() {\n    fmt.Println(\"hello world\")\n    log.Println(\"log hello world\")\n}\n</code></pre>\n\n<p>is it possible to run this program suppressing the log output without change the source code, passing a flag or env variable from command line like for example <code>QUIET=1 go run hello</code>?</p>\n"}, {"tags": ["json", "api", "go", "interface", "maps"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1573904675, "post_id": 58890148, "comment_id": 104046525, "body": "If you know the JSON structure upfront, and you&#39;re willing to use Go structs, then do not use maps and empty interfaces. <a href=\"https://play.golang.com/p/MG1tX8Zbumu\" rel=\"nofollow noreferrer\">play.golang.com/p/MG1tX8Zbumu</a>"}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573908340, "post_id": 58890148, "comment_id": 104047368, "body": "I would also recomment going with structs if the data structure is known. You can <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">convert JSON to Go structs using online tools</a>."}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573910467, "post_id": 58890148, "comment_id": 104047834, "body": "@mkopriva thanks for your answer, it&#39;s really efficient, but I still have one only problem, if I want to add #Distance float64  <code>json:&quot;distance&quot;</code># to the struct and want to get the value by using CalcDistance() function and lon,lat parameters, what should I do ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573910893, "post_id": 58890148, "comment_id": 104047925, "body": "@herotet you could have <code>CalcDistance</code> be a method on the type that has access to the coordinates, whether it be <code>Location</code> or <code>LocationItem</code> is up to you. If you need the <code>Distance</code> to be a field, then you can calculate it after you&#39;re done with the unmarshaling by looping over the struct instances into which you&#39;ve unmarshaled the json, this is very easy. If you want to calculate the distance at the same time as you are unmarshaling, you can have the type, into which you are unmarshaling, implement the <code>json.Unmarshaler</code> interface."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573911499, "post_id": 58890148, "comment_id": 104048071, "body": "@herotet here&#39;s an example of the post-unmarshal-loop <a href=\"https://play.golang.com/p/UTKItnPaXs3\" rel=\"nofollow noreferrer\">play.golang.com/p/UTKItnPaXs3</a>"}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573914441, "post_id": 58890148, "comment_id": 104048730, "body": "@mkopriva can you please have a look at my last answer down on the page ?"}], "answers": [{"tags": [], "owner": {"reputation": 6381, "user_id": 12354911, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Sz0V.jpg?s=128&g=1", "display_name": "Eldar", "link": "https://stackoverflow.com/users/12354911/eldar"}, "is_accepted": false, "score": 0, "last_activity_date": 1573905608, "last_edit_date": 1573905608, "creation_date": 1573904513, "answer_id": 58890357, "question_id": 58890148, "link": "https://stackoverflow.com/questions/58890148/retrieving-data-from-json-response-from-an-api/58890357#58890357", "title": "retrieving data from json response from an API", "body": "<p>Change this line <code>MapofAirports, ok := airportsJsonResponse.([]interface{})</code> to this </p>\n\n<pre><code>MapofAirports, ok := airportsJsonResponse.(map[string]interface{})\n</code></pre>\n\n<p>If you place a break point at this line you will see type of <code>airportsJsonResponse</code> is <code>map[string]interface{}</code>. \nAnd you will have to change this lines into key value iteration</p>\n\n<pre><code>for i := 0; i &lt; lenAiroMap; i++ {\n            locationsMaps[i] = MapofAirports[i].(map[string]interface{})\n        }\n</code></pre>\n\n<p>in to sth like below :</p>\n\n<pre><code>        lenAiroMap := len(MapofAirports)\n        locationsMaps := make([]map[string]interface{},lenAiroMap)\n        for i, value := range MapofAirports[\"locations\"].([]interface{}) {\n            converted := value.(map[string]interface{})\n            locationsMaps[i] = converted\n        }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573914654, "post_id": 58891695, "comment_id": 104048798, "body": "goroutine 1 [running]: main.main() \tC:/Users/herotet/go/src/CT_ProjectV2/main.go:70 +0x536"}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573914737, "post_id": 58891695, "comment_id": 104048823, "body": "and when I debug I get this : json: cannot unmarshal number into Go struct field Coordinates.locations.location.lat of type string"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573914884, "post_id": 58891695, "comment_id": 104048860, "body": "Change Lat Lon field types from <code>string</code> to <code>float64</code>."}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573917762, "post_id": 58891695, "comment_id": 104049672, "body": "I still have one only question, since it&#39;s a group work and others already worked with latitude and longitude as strings , how should i do it i want the same results but with this condition ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573918122, "post_id": 58891695, "comment_id": 104049766, "body": "Do you need it to be <code>string</code> in the <code>Coordinates</code> type? or do you need it to be <code>string</code> in the response json that you&#39;re sending back to the client that made the initial request?"}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573918641, "post_id": 58891695, "comment_id": 104049927, "body": "I would like it to be string in coordinates type"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573918976, "post_id": 58891695, "comment_id": 104050045, "body": "In that case you need to have the <code>*Coordinates</code> type implement the <code>json.Unmarshaler</code> interface. Something like this: <a href=\"https://play.golang.com/p/_UhF5fx5b9j\" rel=\"nofollow noreferrer\">play.golang.com/p/_UhF5fx5b9j</a>"}, {"owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573920346, "post_id": 58891695, "comment_id": 104050439, "body": "excuse me but I can&#39;t see where should i call this function  and also i don&#39;t understand what &#39;(c *Coordinates)&#39; in &lt;&lt; func (c *Coordinates) UnmarshalJSON(data []byte) error&gt;&gt; means"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573920940, "post_id": 58891695, "comment_id": 104050608, "body": "You don&#39;t have to, that&#39;s called automatically by <code>json.Unmarshal</code> (<a href=\"https://play.golang.com/p/EcibN8HSgVj\" rel=\"nofollow noreferrer\">play.golang.com/p/EcibN8HSgVj</a>). And <code>func (x T) M( ...</code> is a method declaration (<a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_declarations</a>)."}], "tags": [], "owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "is_accepted": true, "score": 0, "last_activity_date": 1573914547, "last_edit_date": 1573914547, "creation_date": 1573914370, "answer_id": 58891695, "question_id": 58890148, "link": "https://stackoverflow.com/questions/58890148/retrieving-data-from-json-response-from-an-api/58891695#58891695", "title": "retrieving data from json response from an API", "body": "<p>this is my last update and while running the program it panics at unmarshaling step </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"math\"\n    \"net/http\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Coordinates struct {\n    Longitude string `json:\"lon\"`\n    Latitude  string `json:\"lat\"`\n}\n\ntype Airport struct {\n    Co       Coordinates `json:\"location\"`\n    IATACode string      `json:\"id\"`\n    Distance float64     `json:\"distance\"` // distance to coordinates in kilometer\n}\n\ntype Response struct {\n    Locations []Airport `json:\"locations\"`\n    // add all the other fields you care about\n}\n\nfunc GetCoordinatesFromURL(url string) (float64, float64) {\n\n    parts := strings.Split(url, \"=\")\n\n    lat0 := strings.Split(parts[2], \"&amp;\")\n    lon0 := strings.Split(parts[3], \"&amp;\")\n\n    lat1, _ := strconv.ParseFloat(lat0[0], 64)\n    lon1, _ := strconv.ParseFloat(lon0[0], 64)\n\n    return lat1, lon1\n}\n\nfunc CalcDistance(lat1 float64, long1 float64, lat2 float64, long2 float64) float64 {\n\n    var latitude1 = lat1 * math.Pi / 180\n    var latitude2 = lat2 * math.Pi / 180\n    var longitude1 = long1 * math.Pi / 180\n    var longitude2 = long2 * math.Pi / 180\n\n    var R = 6371.0\n    var d = R * math.Acos(math.Cos(latitude1)*math.Cos(latitude2)*math.Cos(longitude2-longitude1)+math.Sin(latitude1)*math.Sin(latitude2))\n\n    return d\n}\n\nfunc main() {\n\n\n    var url = fmt.Sprintf(\"https://api.skypicker.com/locations?type=radius&amp;lat=40.730610&amp;lon=-73.935242&amp;radius=250&amp;location_types=airport&amp;limit=3&amp;sort=id&amp;active_only=true\")\n\n    UrlLat, UrlLon := GetCoordinatesFromURL(url)\n\n    resp, err := http.Get(url)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer resp.Body.Close()\n\n     data, err := ioutil.ReadAll(resp.Body)\n    res := &amp;Response{}\n    if err := json.Unmarshal(data, res); err != nil {\n        panic(err)\n    }\n    fmt.Println(res.Locations)\n\n    for i, item := range res.Locations {\n        latt,_ := strconv.ParseFloat(item.Co.Latitude, 64)\n        lonn,_ :=strconv.ParseFloat(item.Co.Longitude, 64)\n        res.Locations[i].Distance = CalcDistance(latt,lonn , UrlLat, UrlLon)\n    }\n    fmt.Println(\"after calculate distance\")\n    fmt.Println(res.Locations)\n}\n</code></pre>\n\n<p>what's wrong with that ?</p>\n"}], "owner": {"reputation": 1, "user_id": 12382571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ca60e1f7bd4b0783bb26b75c8d1c09c?s=128&d=identicon&r=PG&f=1", "display_name": "herotet", "link": "https://stackoverflow.com/users/12382571/herotet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 58891695, "answer_count": 2, "score": -1, "last_activity_date": 1573914547, "creation_date": 1573903171, "last_edit_date": 1573904826, "question_id": 58890148, "link": "https://stackoverflow.com/questions/58890148/retrieving-data-from-json-response-from-an-api", "title": "retrieving data from json response from an API", "body": "<p>I'm trying to get data from json response by storing it in some structs (Airport + coordinates) but I don't know how to deal with that since I'm not good enough with maps and interfaces. The code is showing no errors but MapofAirports is completely empty here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    //\"api/client\"\n    //\"api/client/clienterrors\"\n    //\"api/client/openstreetmap\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"math\"\n    \"net/http\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\ntype Coordinates struct {\n    Longitude string `json:\"lon\"`\n    Latitude  string `json:\"lat\"`\n}\n\ntype Airport struct {\n    Co       Coordinates `json:\"location\"`\n    IATACode string      `json:\"id\"`\n    Distance float64     `json:\"distance\"` // distance to coordinates in kilometer\n}\n\nfunc GetCoordinatesFromURL(url string) (float64, float64) {\n\n    parts := strings.Split(url, \"=\")\n\n    lat0 := strings.Split(parts[2], \"&amp;\")\n    lon0 := strings.Split(parts[3], \"&amp;\")\n\n    lat1, _ := strconv.ParseFloat(lat0[0], 64)\n    lon1, _ := strconv.ParseFloat(lon0[0], 64)\n\n    return lat1, lon1\n}\n\nfunc CalcDistance(lat1 float64, long1 float64, lat2 float64, long2 float64) float64 {\n\n    var latitude1 = lat1 * math.Pi / 180\n    var latitude2 = lat2 * math.Pi / 180\n    var longitude1 = long1 * math.Pi / 180\n    var longitude2 = long2 * math.Pi / 180\n\n    var R = 6371.0\n    var d = R * math.Acos(math.Cos(latitude1)*math.Cos(latitude2)*math.Cos(longitude2-longitude1)+math.Sin(latitude1)*math.Sin(latitude2))\n\n    return d\n}\n\nfunc main() {\n    var Locations []Airport\n    Locations = make([]Airport, 0)\n\n    var url = fmt.Sprintf(\"https://api.skypicker.com/locations?type=radius&amp;lat=40.730610&amp;lon=-73.935242&amp;radius=250&amp;location_types=airport&amp;limit=3&amp;sort=id&amp;active_only=true\")\n\n    UrlLat, UrlLon := GetCoordinatesFromURL(url)\n\n    resp, err := http.Get(url)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n\n    var airportsJsonResponse interface{}\n\n    err = json.Unmarshal(body, &amp;airportsJsonResponse)\n\n    MapofAirports, ok := airportsJsonResponse.([]interface{})\n\n    if ok {\n        lenAiroMap := len(MapofAirports)\n\n        locationsMaps := make(map[int]map[string]interface{})\n\n        for i := 0; i &lt; lenAiroMap; i++ {\n            locationsMaps[i] = MapofAirports[i].(map[string]interface{})\n        }\n        var coords Coordinates\n        for i := 0; i &lt; lenAiroMap; i++ {\n            if longitude, ok0 := locationsMaps[i][\"lon\"].(string); ok0 {\n                if latitude, ok1 := locationsMaps[i][\"lat\"].(string); ok1 {\n                    coords = Coordinates{longitude, latitude}\n                }\n            }\n            code := locationsMaps[i][\"id\"].(string)\n\n            latFromCoordinates, _ := strconv.ParseFloat(Locations[i].Co.Latitude, 64)\n            lonFromCoordinates, _ := strconv.ParseFloat(Locations[i].Co.Longitude, 64)\n\n            dist := CalcDistance(latFromCoordinates, lonFromCoordinates, UrlLat, UrlLon)\n            Locations = append(Locations, Airport{\n                Co:       coords,\n                IATACode: code,\n                Distance: dist,\n            })\n        }\n    }\n    LocationsJson, err := json.Marshal(Locations)\n    if err != nil {\n        log.Fatal(\"Cannot encode to JSON \", err)\n    }\n    fmt.Fprintf(os.Stdout, \"%s\", LocationsJson)\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LJNGd.png\" rel=\"nofollow noreferrer\">screenshot of json response</a></p>\n\n<p>in the screenshot this is the json response we have, and I'm processing like this:</p>\n\n<pre><code>{ locations[],meta,last_refresh,results_retrieved } ==&gt; location : { id , location + distance(calculated with a function) }\n</code></pre>\n"}, {"tags": ["go", "dynamic", "struct", "model", "go-gorm"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573901640, "post_id": 58889672, "comment_id": 104045730, "body": "I literally never had a point where I had to load a struct dynamically. Out of cusriosity - what is the use case here."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573909410, "post_id": 58889672, "comment_id": 104047610, "body": "If your product tables are identical, then they should probably be a single table, with a <code>product</code> column."}, {"owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573911695, "post_id": 58889672, "comment_id": 104048112, "body": "@MarkusWMahlberg, To reduce the load on tables. Basically, we are distributing the data in different (respective) tables."}], "answers": [{"comments": [{"owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573901645, "post_id": 58889925, "comment_id": 104045732, "body": "There could be n number of models, I cannot keep adding cases for every model."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 1, "creation_date": 1573901800, "post_id": 58889925, "comment_id": 104045757, "body": "@AmitSharma Again - your architecture seems flawed. I literally never had to dynamically load a data model in roughly 30 years of programming, much less an arbitrary number. \u201eI cannot\u201c seems to be more of a \u201eI do not want to\u201c, tbh. As far as I can see, your question is more of a \u201eIs Go a drop in replacement for Laravell, but with just a few cool features added?\u201c The answer is no."}, {"owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573902407, "post_id": 58889925, "comment_id": 104045919, "body": "I have some scenarios here, currently, I am working on a cryptocurrency exchange platform where users can trade on our platform against various pairs like BTC_USDT, BTC_BNB, BTC_LTC and so on,.So to reduce the database load we thought, we should store the trade orders in the respective crypto pair table. Like BTC_USDT related orders in tbl_btc_usdt and so on. I don&#39;t want to create separate APIs for every pair&#39;s order instead use single API endpoint and dynamically call the table struct."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573902778, "post_id": 58889925, "comment_id": 104046025, "body": "@AmitSharma How about making the currency a freaking value? <code>type Exchange struct { type ExchangeType, currency Currency, amount float}</code> where ExchangeType can be either a put or a call, currency is a <a href=\"https://github.com/golang/go/wiki/Iota\" rel=\"nofollow noreferrer\">iota \u201eenum\u201c</a> and you end with a single data model for all currencies?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573909451, "post_id": 58889925, "comment_id": 104047619, "body": "@AmitSharma: What you are describing is not N models, it&#39;s exactly 1 model, with N instances."}, {"owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1573911214, "post_id": 58889925, "comment_id": 104048000, "body": "@Flimzy To reduce the load on tables, basically, we are distributing the data in respective tables. That&#39;s why we are using N models architecture"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573911949, "post_id": 58889925, "comment_id": 104048163, "body": "@AmitSharma do those N tables have all the same structure? i.e. do all of them have the same columns? If so, why can&#39;t those N tables be represented by single Go struct? How does having N identical struct types declared in Go reduce the load on a database?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573919837, "post_id": 58889925, "comment_id": 104050308, "body": "@AmitSharma: No, you still have only a single model. You just have it spread over multiple tables."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "edited": false, "score": 0, "creation_date": 1573921104, "post_id": 58889925, "comment_id": 104050652, "body": "@AmitSharma And tables do not have a load. A DBMS has. Actually, by using more tables, which all have metadata and stuff, you increase the load you put on your DBMS (at least RAMwise, if not even I/O-wise and CPU-wise). As Flimzy said, you have one model with various instances."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1573989766, "post_id": 58889925, "comment_id": 104063573, "body": "to split your load onto many tables, use a single model with a TableName parameter. With your orm, or whatever, make sure to run sql queries against the TableName parameter. When you instantiate the model, you identify the TableName dynamically."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1573990018, "post_id": 58889925, "comment_id": 104063627, "body": "@mh-cbon Sounds like a way to do it. But still the question is why should one? It adds a layer of complexity to prevent the usage of what clearly is a field."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1573990646, "post_id": 58889925, "comment_id": 104063758, "body": "@MarkusWMahlberg say your dbms engine does not handle row locking, doing so you can split the cost of table locks. I did not intend to mean this is a good idea, only to provide a mean to implement that in a simple solution."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1573997824, "post_id": 58889925, "comment_id": 104065499, "body": "@mh-cbon I see. Still feels like the famous premature optimization, which - as we all know since Donald Knuth - is the root of all evil."}, {"owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1574055140, "post_id": 58889925, "comment_id": 104079334, "body": "@mkopriva, Yes, I have a single model, but multiple-instance or tables. So according to the input I want to insert into a respective table that&#39;s my requirement."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1573901515, "creation_date": 1573901515, "answer_id": 58889925, "question_id": 58889672, "link": "https://stackoverflow.com/questions/58889672/calling-model-dynamically-in-go/58889925#58889925", "title": "calling model dynamically in go", "body": "<p>Do not try to port methods and programming patterns from other languages to Go - it will make your life harder at best and will end in tears at worst.</p>\n\n<p>You can do something like:</p>\n\n<pre><code>type Inventory interface{\n // Your interface defining methods here\n}\n\nvar toUse Inventory\n\nswitch input {\ncase \"ABC\":\n   toUse = ABC{}\ncase \"XY\":\n   toUse = XY{}\n}\n</code></pre>\n\n<p>The question is why you have two <strong><em>types</em></strong> which are (aside from a typo) exactly identical.</p>\n"}], "owner": {"reputation": 1617, "user_id": 4452351, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/1f8e7bca6dce120996532bfe12f787c7?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/4452351/amit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575359698, "creation_date": 1573899538, "last_edit_date": 1575359698, "question_id": 58889672, "link": "https://stackoverflow.com/questions/58889672/calling-model-dynamically-in-go", "title": "calling model dynamically in go", "body": "<p>Consider products like jeans, shirts, shorts and I want to store the orders in respective product tables for eg jeans related order should get stored in jeans tables and so on. Every table would have identical parameters. So while storing orders in table I should be able to call the respective struct and store the order.\nI am coming from Laravel (PHP) background where I can load dynamic model like</p>\n\n<pre><code>$model = \"Dynamic passed model names\"\n\n$class = \"App\\\\Models\\\\$model\";\n</code></pre>\n\n<p>but in Go how can we do that if call dynamic struct</p>\n\n<p>e.g,</p>\n\n<p>in model ABC.go</p>\n\n<pre><code>type ABC struct{\n  Name string\n  Invetory int\n}\n</code></pre>\n\n<p>in model XYZ.go</p>\n\n<pre><code>type XYZ struct {\n  Name string\n  Invetory int\n}\n</code></pre>\n\n<p>So input could be ABC or XYZ and I have to load the struct accordingly.</p>\n\n<p>load the struct ABC</p>\n\n<pre><code>inpt := \"ABC\"\n\nproduct := models.&lt;inpt&gt;{\n  Name: \"prodct name\"\n  Inventory: 10\n}\n</code></pre>\n\n<p>Above snippet the model name is dynamic. How can we do this in Go?</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573889058, "post_id": 58888165, "comment_id": 104043031, "body": "Can you show the definition of the <code>Tag</code> struct?"}, {"owner": {"reputation": 51, "user_id": 11519194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76UyaWXr7Iw/AAAAAAAAAAI/AAAAAAAAAA8/N5vXSh8csig/photo.jpg?sz=128", "display_name": "chezi chezi", "link": "https://stackoverflow.com/users/11519194/chezi-chezi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573895623, "post_id": 58888165, "comment_id": 104044425, "body": "Sorry, I just saw your reply, I edited the question, I am learning, there may be a wrong place, I can&#39;t find it, can you help me see the error?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1573895742, "post_id": 58888165, "comment_id": 104044456, "body": "You also need to show <code>Model</code> since the problem is with <code>created_on</code> which is not present <i>directly</i> in <code>Tag</code>."}, {"owner": {"reputation": 51, "user_id": 11519194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76UyaWXr7Iw/AAAAAAAAAAI/AAAAAAAAAA8/N5vXSh8csig/photo.jpg?sz=128", "display_name": "chezi chezi", "link": "https://stackoverflow.com/users/11519194/chezi-chezi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573896256, "post_id": 58888165, "comment_id": 104044585, "body": "The question has been edited, is the code you want? Thank you for your precious time."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1573896436, "post_id": 58888165, "comment_id": 104044630, "body": "Yes, the problem is that you&#39;re using <code>int</code> as the Go type for the timestamp fields. DB timestamps cannot be automatically decoded into an <code>int</code>. You should either use <code>time.Time</code> for you Go timestamp fields. Or you should change your DB column types from timestamp to integer. Or you need a custom Go <code>int</code> type that knows how to decode a DB timestamp."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1573896577, "post_id": 58888165, "comment_id": 104044658, "body": "If you take a look at the default <code>gorm.Model</code> type you can see that they also use <code>time.Time</code> for timestamp fields. <a href=\"https://gorm.io/docs/conventions.html\" rel=\"nofollow noreferrer\">gorm.io/docs/conventions.html</a>"}, {"owner": {"reputation": 51, "user_id": 11519194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76UyaWXr7Iw/AAAAAAAAAAI/AAAAAAAAAA8/N5vXSh8csig/photo.jpg?sz=128", "display_name": "chezi chezi", "link": "https://stackoverflow.com/users/11519194/chezi-chezi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573896746, "post_id": 58888165, "comment_id": 104044699, "body": "Thank you very much, haha, my learning ability is not good enough, this is the result I got: {&quot;code&quot;:200,&quot;data&quot;:{&quot;lists&quot;:[{&quot;id&quot;:1,&quot;created_on&quot;:&quot;2019- 11-09T18:33:14.923411Z&quot;,&quot;modified_on&quot;:&quot;2019-11-09T18:33:14.9&zwnj;&#8203;23411Z&quot;,&quot;name&quot;:&quot;czxt&zwnj;&#8203;able&quot;,&quot;created_by&quot;:&quot;&zwnj;&#8203;czx&quot;,&quot;modified_by&quot;:&quot;&zwnj;&#8203;&quot;, &quot;state&quot;:1}],&quot;total&quot;:1},&quot;msg&quot;:&quot;ok&quot;} How should I get a format like 2019-11-09T18:33:14? You are a good person"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1573897245, "post_id": 58888165, "comment_id": 104044811, "body": "For that you&#39;ll need to declare a custom timestamp type and implement the <code>json.Marshaler</code> interface. Here&#39;s an example: <a href=\"https://stackoverflow.com/questions/52445696/generic-approach-for-marshalling-a-structs-time-time-fields-to-json-with-custom\" title=\"generic approach for marshalling a structs time time fields to json with custom\">stackoverflow.com/questions/52445696/&hellip;</a>. If you do that however it <i>might</i> break the encoding/decoding to/from the database, so you may need to have the custom timestamp also implement the <code>driver.Valuer</code> and <code>sql.Scanner</code> interfaces."}, {"owner": {"reputation": 51, "user_id": 11519194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76UyaWXr7Iw/AAAAAAAAAAI/AAAAAAAAAA8/N5vXSh8csig/photo.jpg?sz=128", "display_name": "chezi chezi", "link": "https://stackoverflow.com/users/11519194/chezi-chezi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1573897449, "post_id": 58888165, "comment_id": 104044866, "body": "Thank you very much, I need to continue learning."}], "owner": {"reputation": 51, "user_id": 11519194, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-76UyaWXr7Iw/AAAAAAAAAAI/AAAAAAAAAA8/N5vXSh8csig/photo.jpg?sz=128", "display_name": "chezi chezi", "link": "https://stackoverflow.com/users/11519194/chezi-chezi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 648, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573896079, "creation_date": 1573885450, "last_edit_date": 1573896079, "question_id": 58888165, "link": "https://stackoverflow.com/questions/58888165/sql-scan-error-on-column-index-2-name-created-on-converting-driver-value-ty", "title": "sql: Scan error on column index 2, name &quot;created_on&quot;: converting driver.Value type time.Time", "body": "<p>The way I query\uff1a</p>\n\n<pre><code>package models\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    //postgres dv\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n\n    \"ginstatus/pkg/setting\"\n)\n\nvar db *gorm.DB\n\ntype Model struct {\n    ID         int `gorm:\"primary_key\" json:\"id\"`\n    CreatedOn  int `json:\"created_on\"`\n    ModifiedOn int `json:\"modified_on\"`\n}\n\nfunc init() {\n    var (\n        err                                                     error\n        dbType, dbName, user, password, host, port, tablePrefix string\n    )\n\n    sec, err := setting.Cfg.GetSection(\"database\")\n    if err != nil {\n        log.Fatal(2, \"Fail to get section 'database': %v\", err)\n    }\n\n    dbType = sec.Key(\"TYPE\").String()\n    dbName = sec.Key(\"NAME\").String()\n    user = sec.Key(\"USER\").String()\n    password = sec.Key(\"PASSWORD\").String()\n    host = sec.Key(\"HOST\").String()\n    port = sec.Key(\"PORT\").String()\n    tablePrefix = sec.Key(\"TABLE_PREFIX\").String()\n\n    db, err = gorm.Open(dbType, fmt.Sprintf(\"host=%s port=%s user=%s dbname=%s password=%s\",\n        host,\n        port,\n        user,\n        dbName,\n        password))\n    // db, err = gorm.Open(\"postgres\", \"host=192.168.2.200 port=5433 user=czxsql dbname=go_blog password=123456\")\n\n    if err != nil {\n        log.Println(err)\n    }\n    //##############################\n    // db.LogMode(true)\n    //##############################\n\n    gorm.DefaultTableNameHandler = func(db *gorm.DB, defaultTableName string) string {\n        return tablePrefix + defaultTableName\n    }\n\n    db.SingularTable(true)\n    db.DB().SetMaxIdleConns(10)\n    db.DB().SetMaxOpenConns(100)\n}\n\nfunc CloseDB() {\n    defer db.Close()\n}\n\n</code></pre>\n\n<pre><code>package models\n\ntype Tag struct {\n    Model\n\n    Name       string `json:\"name\"`\n    CreatedBy  string `json:\"created_by\"`\n    ModifiedBy string `json:\"modified_by\"`\n    State      int    `json:\"state\"`\n}\n\nfunc GetTags(pageNum int, pageSize int, maps interface{}) (tags []Tag) {\n    db.Where(maps).Offset(pageNum).Limit(pageSize).Find(&amp;tags)\n\n    return\n}\n</code></pre>\n\n<p>/Database data information</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZITOP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZITOP.png\" alt=\"enter image description here\"></a></p>\n\n<p>My results</p>\n\n<pre><code>\"lists\":[{\"id\":1,\"created_on\":0,\"modified_on\":0,\"name\":\"czxtable\",\"created_by\":\"\",\"modified_by\":\"\",\"state\":0}]\n</code></pre>\n\n<pre><code>sql: Scan error on column index 2, name \"created_on\": converting driver.Value type time.Time (\"2019-11-09 18:33:14.923411 +0000 +0000\") to a int: invalid syntax \n</code></pre>\n\n<p>The above is a postgresql query error,</p>\n\n<p>My database time field type \"timestamp\"</p>\n\n<p>I am using \"github.com/jinzhu/gorm\" to query the database, but the query result is \"0\".</p>\n\n<p>What should I do when I query, can I get the correct time format?</p>\n\n<p>ps:<a href=\"https://gorm.io/docs/connecting_to_the_database.html\" rel=\"nofollow noreferrer\">https://gorm.io/docs/connecting_to_the_database.html</a>  </p>\n\n<p>There is only mysql processing, but there is no postgresql processing.</p>\n\n<p>Sorry, give you more trouble, thank you in advance for your help.</p>\n"}, {"tags": ["go", "asn1"], "comments": [{"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573899422, "post_id": 58888162, "comment_id": 104045276, "body": "Emmm, I&#39;m a little confuesd why you input public key into function &quot;ParsePrivateKey&quot;, it would be nice if you show some info about this ssh package."}, {"owner": {"reputation": 493, "user_id": 693191, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31Xmn.jpg?s=128&g=1", "display_name": "anoopb", "link": "https://stackoverflow.com/users/693191/anoopb"}, "reply_to_user": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1573917576, "post_id": 58888162, "comment_id": 104049622, "body": "@p1gd0g pkey is a string of the private key that I got from a webform."}, {"owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "edited": false, "score": 0, "creation_date": 1574009095, "post_id": 58888162, "comment_id": 104068555, "body": "If &quot;pkey&quot; is private key, why did you input &quot;id_rsa.pub&quot;, which is a public key. That was what I am confused. RSA is non-symmetric crypto."}], "answers": [{"tags": [], "owner": {"reputation": 493, "user_id": 8364553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d203cf51ae3926dca4c2c3afcf24948?s=128&d=identicon&r=PG&f=1", "display_name": "p1gd0g", "link": "https://stackoverflow.com/users/8364553/p1gd0g"}, "is_accepted": false, "score": 0, "last_activity_date": 1574014074, "creation_date": 1574014074, "answer_id": 58903563, "question_id": 58888162, "link": "https://stackoverflow.com/questions/58888162/sending-ssh-private-key-via-form-results-in-asn1-syntax-error-data-truncated/58903563#58903563", "title": "Sending ssh private key via form results in &quot;asn1: syntax error: data truncated&quot;", "body": "<blockquote>\n  <p>What's odd is that if i were to read my own \"id_rsa.pub\" using io/ioutil, the error doesn't occur. But only when i paste the contents of \"id_rsa.pub\" file does this error occur.</p>\n</blockquote>\n\n<p>It is odd for me too, why you input \"id_rsa.pub\" (a public key) into <code>ssh.ParsePrivateKey</code>?</p>\n\n<p>In my test, I input \"id_rsa\" (a private key) and no error occurs.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    pkbytes, err := ioutil.ReadFile(\"id_rsa\")\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n    s, err := ssh.ParsePrivateKey(pkbytes)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n\n    log.Println(s.PublicKey())\n</code></pre>\n\n<p>So I guess if you know much about rsa, which is a non-symmetric cryptography, that means you can't transfer a public key into a private key (unless you have known the setup).</p>\n\n<p>Or maybe you need to let us reproduce the error, or show how did you paste the private key.</p>\n"}], "owner": {"reputation": 493, "user_id": 693191, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/31Xmn.jpg?s=128&g=1", "display_name": "anoopb", "link": "https://stackoverflow.com/users/693191/anoopb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1574014074, "creation_date": 1573885428, "last_edit_date": 1573924365, "question_id": 58888162, "link": "https://stackoverflow.com/questions/58888162/sending-ssh-private-key-via-form-results-in-asn1-syntax-error-data-truncated", "title": "Sending ssh private key via form results in &quot;asn1: syntax error: data truncated&quot;", "body": "<p>I have a webform that allows a user to post a private key, hostname, username and it allows me to make a connection to \"hostname\" via ssh using the private key and run a test command.</p>\n\n<p>I'm using golang and the ssh package for this test.</p>\n\n<p>Yes, i am aware of the dangers of sending a private key over a form but this is an internal project for me and not something that will really be used publicly.</p>\n\n<p>So, continuing on, here's what my code looks like</p>\n\n<pre><code>func setupSSHConfigWithKey(user string, pkey string) *ssh.ClientConfig {\n\npkey_bytes := []byte(pkey)\n\n// parse the key\nsigner, err := ssh.ParsePrivateKey(pkey_bytes)\n\n    if err != nil {\n        panic(err)\n    }   \n</code></pre>\n\n<p>When this piece of code runs, it results in the following error</p>\n\n<blockquote>\n  <p>2019/11/15 23:57:14 http: panic serving [::1]:62783: asn1: syntax error: data truncated</p>\n</blockquote>\n\n<p>What's odd is that if i were to read my own \"id_rsa.pub\" using <code>io/ioutil</code>, the error doesn't occur. But only when i paste the contents of \"id_rsa.pub\" file does this error occur.</p>\n\n<p>I'm at a loss as to why this is happening and i'm not sure how to fix it. </p>\n\n<p>I've checked the byte array output of the contents of the id_rsa.pub file as well as the form value and they are both identical and of the same length.</p>\n\n<p>I suspect the error is coming from <a href=\"https://golang.org/src/encoding/asn1/asn1.go\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/asn1/asn1.go</a></p>\n\n<p>so i'm trying to dive deeper into how to fix this but haven't come up with much so far. </p>\n\n<p>Asking here to see how i can get around this error. </p>\n\n<p>Edit:</p>\n\n<p>This morning i've been researching some more and found some more interesting results</p>\n\n<p>if i run the following code, i get no errors. But if i post the private key string below into a web form, and then use the same code below but with http request FormValue instead of just declaring a byte slice, i get the asn1 error denoted above. The below example is a test key.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"encoding/pem\"\n    \"crypto/x509\"\n)\n\nfunc main() {\n\n    pkey_bytes := []byte(`-----BEGIN RSA PRIVATE KEY-----\nMIIEpAIBAAKCAQEAv+B+qNevh/iaPmWAnulN5flRatGo6V97CjbJ7P2tp0YuiI+O\nzCXcoY7Mmv4sDbZicBrtbIvi3l3hKqhbV+1ArhwPmoEem3M9yM1goZqoE6mh5Wst\nzlVOAx1HjfFNYteV3TPpIb8S+5q5vEXguYv/oBmCv44Jjf4wuvGHjbX6vJg8VT4q\nsG5uF74h59+nOOAsox2BQ7wK24ccfZBIl+O/L5juSJWnVJYOoaddJ9fiEB2JqKYQ\n443ZOqwml6Vu0ZeSX3AuqtiSQiDSI+AAX62YtBeza4CzUnYTQIA2HV5/wfp2tFk3\nsP9FjOPENqr6jQjcdPjtgNK+Sd00UI823Q288wIDAQABAoIBAFuiGJsFtjxXS0I1\nM0Gw5ZTIhktfKS2afaYZGEHnvEDAUYTCGk4AXueAzNHQRLWfvk8PbQeDnqrXZqr6\nj/TjxxnfKMx+kWFnncAB5P4IX/BT+I8Zqlx5fLIcD4oIDQ8BKf7jxZhqKeSitcTm\nEjZKV5/bzwcwC/wVwqvkoPnaSI47ycCmXUj88ccZGfItOzoFYEbQ2yI1cMJ2sfBU\n8PkvPzm0IB63L6BixdC2b+2jyoOCadF6VTRRh53BNH6WcyTBFy2CC6VwXajWh5KD\nz5HUTcsUfb+nsZjQdmJjmObdQxvjqpjwlnW9XmNaF9EMjwioiljrgzH0nYSiJOk3\n4cfvTLECgYEA6kW8HKipGN/R2lXy3QtQxyrNxg1IhbVhGbQGtIy5HTLyj+7UgyQW\nxhT0miRHAbEqjFMqd8dpruKFq+PxVzDiJpExac7LzwCfNgywqlg6lzowD5tB9QYm\nBgw7y8EySMHruMd0LgDXTeXNV2eScbzuwQY6h2wDeA6X99Q4zVakWoUCgYEA0awt\nDfyQKQhkrB4YMdmquseouVbN7XyX3YeanRKbpyHWwnGUIqOLv0lYxDDubnxz9+uG\ncD15gps3CE5aQGaNDEgCuPRb6hDN66bN83QW7Lz5USrP95lczTvoMKA1OpLKUzpT\n8IaGMYZEjCjamVut6u7Vub6yt09pNpGpvHMdnxcCgYEAwR4LG3TNL/wQ+XKwaRbS\n19upFQIOLmp+SLnmbR8z2aYN3ih6dkBhpZfQquAMyJBLCrHj6CkyLT/+ANw+LinV\nwwUdPqOBznosxFlhqIpighctVzAdBuayoXmkMSppUSDKN9/zHZkD4ur0goCWb7vW\n9Lc1uDyJ/4XIMDt5N4ucoCECgYEAlr9yuT6gK1BEiVct0BGOZbINRgv6DMhqq7TG\nXi41yQlUTgK5Hdp2LDbA4nXHx5olCtfElcgtJ9EO1SL4Upsox+6yPmY5+2TPmKEa\nK/KIVPddTZU5ZuxVw51RyDw3aQCHBSXHmgQuUUcW26q32FEJDwNemKhZ99/ZZol9\n/ubJIksCgYA9OyXSqXcylevH51xujT99/21pfOjurYqKYWTpcrmq5vuatD++aQim\n6ENMubkz3mNvma8nByzjPwfFBDIZcBPo2f412bvXbrlUPGs6sWIXQVAbCDesf1Lp\nxUTpA9+55L6UtElwdcKyfwwGlXNkwwOUhF0T7XJuCn1s0CSVJD7YsA==\n-----END RSA PRIVATE KEY-----`)\n\n    log.Println(pkey_bytes)\n\n    block, _ := pem.Decode(pkey_bytes)\n    log.Println(\"Block: \" + block.Type)\n    log.Println(block.Headers)\n    log.Println(block.Bytes)\n    _, err := x509.ParsePKCS1PrivateKey(block.Bytes)\n\n    if err != nil {\n        log.Println(err)\n    }   \n}\n</code></pre>\n\n<p>output</p>\n\n<blockquote>\n  <p>2019/11/16 11:04:11 Block: RSA PRIVATE KEY \n  2019/11/16 11:04:11 map[]\n  2019/11/16 11:04:11 [48 130 4 164 2 1 0 2 130 1 1 0 213 0 152 15 73\n  240 7 87 162 114 194 234 45 84 130 9 85 7 95 176 198 251 169 58 203\n  163 2 192 75 109 200 120 10 195 37 24 189 125 27 54 78 217 229 189 64\n  207 138 199 49 255 180 125 75 93 0 220 132 212 152 214 37 43 19 181\n  144 89 80 37 163 12 242 194 170 155 234 172 185 211 32 108 249 155 26\n  234 168 83 177 1 186 48 191 174 238 204 193 75 215 5 123 138 177 67 43\n  126 102 153 69 24 25 240 148 141 236 52 29 160 204 122 172 71 71 66 43\n  8 167 19 218 153 141 113 31 226 169 118 180 18 172 244 178 151 211 253\n  82 203 3 46 145 77 142 223 2 46 248 251 164 251 24 120 12 35 127 82 13\n  250 162 162 55 143 120 88 51 102 11 170 180 181 89 224 69 148 93 253\n  245 31 146 111 77 211 202 63 159 52 255 29 248 148 41 237 159 120 25\n  40 204 241 39 154 123 146 79 77 196 221 167 16 42 24 224 244 229 191 7\n  56 34 158 240 173 159 118 135 93 205 190 52 100 11 94 6 76 73 35 166\n  197 123 35 112 120 152 220 174 217 122 10 94 51 210 157 2 3 1 0 1 2\n  130 1 0 63 218 3 187 97 144 192 194 182 129 236 136 66 186 120 152 207\n  146 124 79 3 247 97 13 173 9 218 195 70 89 76 165 31 164 204 52 20 105\n  178 132 159 50 150 186 26 249 156 66 134 108 126 240 168 108 226 219\n  56 62 122 234 135 13 216 196 174 214 247 61 177 25 42 148 204 140 28\n  215 86 133 65 205 41 46 35 237 128 52 70 117 156 25 12 253 37 188 223\n  157 26 130 28 60 193 82 191 113 14 212 151 111 216 38 212 129 142 243\n  56 134 129 133 172 171 89 99 46 127 83 134 146 26 181 142 57 186 249\n  145 17 157 39 253 37 185 230 25 132 162 59 175 136 187 215 251 176 75\n  70 231 253 19 86 147 106 158 52 100 193 231 203 249 119 254 33 194 240\n  113 92 131 187 65 89 90 63 126 83 225 56 177 211 137 74 155 220 177\n  104 203 106 141 183 150 24 159 123 222 229 107 222 168 41 55 0 84 192\n  173 69 177 227 134 196 27 39 90 28 88 138 124 159 56 254 111 59 114\n  160 217 10 253 207 183 225 66 217 13 47 186 90 254 82 21 59 221 171\n  240 13 106 34 134 168 235 62 1 2 129 129 0 249 28 59 180 159 49 111\n  179 128 82 9 178 195 199 223 240 146 255 34 136 248 187 226 183 14 35\n  50 248 236 235 102 135 196 80 182 27 16 247 199 134 108 140 13 31 158\n  127 210 45 172 18 28 252 82 60 230 221 100 136 5 31 164 246 0 178 127\n  59 211 245 219 50 191 134 178 103 113 109 238 106 44 249 124 155 140\n  184 166 158 74 58 176 8 155 3 108 105 124 106 66 251 146 173 197 195\n  250 183 168 87 244 200 19 64 10 184 94 172 72 74 100 187 79 201 188 22\n  82 96 132 63 175 221 2 129 129 0 218 228 180 240 239 129 76 1 58 133\n  168 65 115 237 70 128 13 179 229 144 56 82 154 92 97 137 196 61 152 41\n  186 145 8 61 5 11 23 201 102 28 119 6 147 133 36 186 157 169 120 245\n  81 81 249 172 104 93 98 96 86 54 231 122 205 178 44 147 165 6 87 105\n  242 179 191 230 166 112 57 244 148 153 204 219 173 143 194 71 182 77\n  29 112 82 132 68 8 183 178 169 200 138 216 46 65 49 37 214 96 198 78\n  184 71 120 145 89 7 138 134 23 236 157 132 36 17 93 153 152 171 225\n  193 2 129 129 0 142 141 32 129 128 227 170 87 30 228 83 86 112 0 173\n  222 158 79 207 244 111 218 28 167 194 56 84 79 236 75 220 245 110 90\n  253 138 201 143 241 38 180 113 4 133 134 143 0 184 80 18 97 113 230\n  161 161 63 41 235 72 123 78 75 212 36 80 248 236 151 113 99 62 4 151\n  140 232 117 15 12 197 69 211 143 179 220 106 196 132 23 199 106 117 66\n  101 68 140 4 198 229 237 142 241 111 239 198 47 88 125 228 12 88 6 138\n  112 234 199 199 130 147 73 218 88 126 177 143 55 190 182 37 2 129 128\n  21 17 150 104 234 100 163 144 42 181 218 176 18 28 112 128 186 208 233\n  243 171 184 39 171 100 168 1 255 123 185 232 127 53 47 202 96 122 245\n  163 162 113 194 108 72 144 116 117 224 110 8 14 191 185 44 99 15 57\n  252 211 207 141 16 64 228 57 110 44 160 35 161 202 254 138 38 5 55 32\n  28 238 128 175 59 37 197 132 137 170 126 89 171 10 6 57 22 45 184 64\n  167 80 213 229 253 216 97 47 245 56 161 51 19 142 3 79 114 110 94 225\n  198 160 146 171 118 16 112 76 69 159 1 2 129 129 0 146 125 104 230 161\n  38 131 49 43 63 55 120 162 242 9 135 203 88 233 46 53 10 163 157 198\n  66 1 219 141 142 207 126 139 42 195 107 199 104 186 220 78 164 72 177\n  193 221 223 241 16 35 22 28 181 75 118 169 34 85 169 230 97 123 206 82\n  193 118 211 182 243 255 68 187 181 251 91 49 173 252 90 238 197 197\n  128 105 43 172 25 253 136 160 24 125 161 54 134 125 180 69 87 64 3 87\n  123 16 219 67 6 225 146 87 18 185 182 66 87 60 43 77 185 109 44 123 29\n  202 80 97 210 159]</p>\n</blockquote>\n"}, {"tags": ["go", "mux", "go-http"], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 1, "last_activity_date": 1573879399, "creation_date": 1573879399, "answer_id": 58887647, "question_id": 58887311, "link": "https://stackoverflow.com/questions/58887311/serve-files-from-a-different-directory-when-request-comes-to-root-directory/58887647#58887647", "title": "Serve files from a different directory when request comes to root directory", "body": "<p>Your file server is already serving files under <code>/public</code>, so you don't need to strip the prefix from the http path. This should work:</p>\n\n<pre><code>    r.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\",fs))\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 2803066, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QytjK.jpg?s=128&g=1", "display_name": "zhughes3", "link": "https://stackoverflow.com/users/2803066/zhughes3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 58887647, "answer_count": 1, "score": 0, "last_activity_date": 1573880624, "creation_date": 1573875298, "question_id": 58887311, "link": "https://stackoverflow.com/questions/58887311/serve-files-from-a-different-directory-when-request-comes-to-root-directory", "title": "Serve files from a different directory when request comes to root directory", "body": "<p>I am having some trouble serving some files from a subdirectory when a client request comes in at the root directory.</p>\n\n<p>I am using <code>gorilla/mux</code> to serve files. Here is my code below:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/zhughes3/zacharyhughes.com/configparser\"\n)\n\nvar config configparser.Configuration\n\nfunc main() {\n    config := configparser.GetConfiguration()\n    r := mux.NewRouter()\n    initFileServer(r)\n\n    server := &amp;http.Server{\n        Handler:      r,\n        Addr:         \":\" + config.Server.Port,\n        WriteTimeout: 15 * time.Second,\n        ReadTimeout:  15 * time.Second,\n    }\n\n    log.Fatal(server.ListenAndServe())\n}\n\nfunc initFileServer(r *mux.Router) {\n    fs := http.FileServer(http.Dir(\"public/\"))\n    r.PathPrefix(\"/public/\").Handler(http.StripPrefix(\"/public/\", fs))\n}\n</code></pre>\n\n<p>The code that creates the file system is in the <code>initFileServer</code> function above.</p>\n\n<p>Currently, it serves the static files as intended when the user goes to <code>localhost:3000/public/</code>. However, I want the files to be served when the user goes to <code>localhost:3000/</code>.</p>\n\n<p>I tried changing the ParsePrefix function call to <code>r.PathPrefix(\"/\").Handler(http.StripPrefix(\"/public/\", fs))</code> but it did not work. Any suggestions would be greatly appreciated...I am pretty new with Go.</p>\n"}, {"tags": ["go", "ssl", "encryption"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1573870389, "post_id": 58886691, "comment_id": 104040762, "body": "The tls package supports <a href=\"https://golang.org/pkg/crypto/tls/#pkg-constants\" rel=\"nofollow noreferrer\">TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA</a>. Without more info there\u2019s not much we can help with"}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1573870924, "post_id": 58886691, "comment_id": 104040839, "body": "You seem to be using the shorthand OpenSSL notations for the ciphersuites. Looking for the ones as specified in the TLS RFC&#39;s may give you better info."}, {"owner": {"reputation": 529, "user_id": 2099929, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b016c67bead3527db00e8d7ce59e7bac?s=128&d=identicon&r=PG", "display_name": "Martin Nilsson", "link": "https://stackoverflow.com/users/2099929/martin-nilsson"}, "edited": false, "score": 0, "creation_date": 1573872830, "post_id": 58886691, "comment_id": 104041073, "body": "Thank you both. I have updated with code."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1573888472, "post_id": 58886691, "comment_id": 104042946, "body": "A handshake failure can have lots of reasons, like cipher mismatch, missing or wrong client certificate, unsupported curves ... . Unfortunately this is hard to debug without having more information about client <b>and server</b>.  And yes, TLS error messages are usually not that helpful because in most cases all one gets  on the client side is that &quot;something went wrong&quot; and that&#39;s why the server is closing the connection. So please provide sufficient information so that others can actually reproduce this problem and then one could try to help better."}, {"owner": {"reputation": 529, "user_id": 2099929, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b016c67bead3527db00e8d7ce59e7bac?s=128&d=identicon&r=PG", "display_name": "Martin Nilsson", "link": "https://stackoverflow.com/users/2099929/martin-nilsson"}, "edited": false, "score": 0, "creation_date": 1573899487, "post_id": 58886691, "comment_id": 104045298, "body": "Yes that would help alot. Sadly, I dont have access to the server. I shall have to investigate further..."}], "answers": [{"tags": [], "owner": {"reputation": 529, "user_id": 2099929, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b016c67bead3527db00e8d7ce59e7bac?s=128&d=identicon&r=PG", "display_name": "Martin Nilsson", "link": "https://stackoverflow.com/users/2099929/martin-nilsson"}, "is_accepted": false, "score": 0, "last_activity_date": 1573996830, "creation_date": 1573996830, "answer_id": 58900851, "question_id": 58886691, "link": "https://stackoverflow.com/questions/58886691/supported-http-cipher-suites-in-go/58900851#58900851", "title": "Supported http cipher suites in go?", "body": "<p>So the solution turned out to be to use client.Do instead of http.Post</p>\n\n<pre><code>req, _ := http.NewRequest(\"POST\", \"example.com/api\", mockjson)\nreq.Header.Set(\"Content-Type\", \"application/json\")\n\nclient := &amp;http.Client{Transport: transport}\nresp, _ := client.Do(req)\n</code></pre>\n\n<p>Not sure about the internal differences</p>\n"}], "owner": {"reputation": 529, "user_id": 2099929, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/b016c67bead3527db00e8d7ce59e7bac?s=128&d=identicon&r=PG", "display_name": "Martin Nilsson", "link": "https://stackoverflow.com/users/2099929/martin-nilsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1573996830, "creation_date": 1573867582, "last_edit_date": 1573872705, "question_id": 58886691, "link": "https://stackoverflow.com/questions/58886691/supported-http-cipher-suites-in-go", "title": "Supported http cipher suites in go?", "body": "<p>Does go support any of these cipher suites for http client?</p>\n\n<ul>\n<li>AES128-SHA</li>\n<li>AES256-SHA</li>\n<li>DHE-RSA-AES128-SHA</li>\n<li>DHE-RSA-AES256-SHA</li>\n<li>ECDHE-RSA-AES256-SHA</li>\n</ul>\n\n<p>I get handshake failure when connecting to the server.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I read one .p12 and one .pem file into a tls.Config that is then used in http.Transport. The final line client.Post returns error \"handshake failure\" which is not very helpful.</p>\n\n<p>I bit of digging reveled that the ciphers above are those permitted on the server.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>b, err := ioutil.ReadFile(\"cert.p12\")\n    if err != nil {\n        fmt.Println(err)\n\n    }\n    rootCA, err := ioutil.ReadFile(\"rootcert.pem\")\n    if err != nil {\n        log.Fatalf(\"reading cert failed : %v\", err)\n    }\n\n    password := \"password\"\n    privateKey, cert, caCertificates, err := pkcs12.DecodeChain(b, password)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    pool := x509.NewCertPool()\n    pool.AddCert(caCertificates[0])\n    pool.AddCert(caCertificates[1])\n    pool.AppendCertsFromPEM(rootCA)\n\n    certificate := tls.Certificate{\n        Certificate: [][]byte{cert.Raw},\n        PrivateKey:  privateKey,\n        Leaf:        cert}\n\n    conf := &amp;tls.Config{\n        Certificates: []tls.Certificate{certificate},\n        RootCAs:      pool,\n        MinVersion:   tls.VersionTLS11,\n        ServerName:   \"api.example.com\"}\n\n    transport := &amp;http.Transport{TLSClientConfig: conf}\n    client := &amp;http.Client{Transport: transport}\n    res, err := client.Post(\"api.example.com\", \"application/json\", bufferObject)\n</code></pre>\n"}, {"tags": ["json", "go", "protocol-buffers", "grpc", "duck-typing"], "answers": [{"tags": [], "owner": {"reputation": 80, "user_id": 4260179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LfTy1.jpg?s=128&g=1", "display_name": "mrlevitas", "link": "https://stackoverflow.com/users/4260179/mrlevitas"}, "is_accepted": true, "score": 1, "last_activity_date": 1574215203, "creation_date": 1574215203, "answer_id": 58945536, "question_id": 58886124, "link": "https://stackoverflow.com/questions/58886124/how-can-i-create-a-duck-typed-grpc-protobuf-message-at-runtime-in-go/58945536#58945536", "title": "How can I create a &quot;duck-typed&quot; grpc protobuf Message at runtime in Go?", "body": "<p>I managed to solve this by whittling down the json to what I want first and then putting it through Unmarshal.</p>\n\n<p>I created a top level Message that takes <code>Profile</code> as a field:</p>\n\n<pre><code>message GetUserResponse {\n  Profile profile = 1;\n}\n</code></pre>\n\n<p>and redefined the response: </p>\n\n<pre><code>rpc GetUser (GetUserRequest) returns (GetUserResponse)\n</code></pre>\n\n<p>To build the allowed/scoped json, I use:</p>\n\n<pre><code>\"github.com/tidwall/gjson\"\n\"github.com/tidwall/sjson\"\n</code></pre>\n\n<p>I copy the json dictated by the scope paths (dot-delimited e.g. <code>[\"profile.foo\"]</code>) over to an initially empty, output, <code>response_json</code> string, and build up only the allowed json to be returned.</p>\n\n<pre><code>var response_json string\n\nvar scopes = []string{\"profile.foo\"}\n\nfor _, scope := range scopes {\n    // copy allowed json subset in raw form\n    value := gjson.Get(myJson, scope + \"|@ugly\")\n\n    // if scope didn't copy a value, skip\n    if value.String() == \"\" {\n        continue\n    } else {\n        // write value to output json using SetRaw since value can be an object\n        response_json, _ = sjson.SetRaw(response_json, scope, value.Raw)\n    }\n}\n</code></pre>\n\n<p>response_json looks like:</p>\n\n<pre><code>{\n  \"profile\": {\n     \"foo\": {\n        \"name\": \"tim\"\n        \"age\": 22\n      }\n  }\n}\n</code></pre>\n\n<p>and then Unmarshal:</p>\n\n<pre><code>response = &amp;pb.VerifyUserResponse{}\nerr = json.Unmarshal([]byte(response_json), response)\n</code></pre>\n"}], "owner": {"reputation": 80, "user_id": 4260179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LfTy1.jpg?s=128&g=1", "display_name": "mrlevitas", "link": "https://stackoverflow.com/users/4260179/mrlevitas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 58945536, "answer_count": 1, "score": 0, "last_activity_date": 1574215203, "creation_date": 1573861632, "question_id": 58886124, "link": "https://stackoverflow.com/questions/58886124/how-can-i-create-a-duck-typed-grpc-protobuf-message-at-runtime-in-go", "title": "How can I create a &quot;duck-typed&quot; grpc protobuf Message at runtime in Go?", "body": "<p>I'm using grpc protobuf Message definitions and implementing them in Go. </p>\n\n<p>My ultimate goal is for my rpc to retrieve some json on a user and return a <code>Profile</code> Message with optional, nested Messages to be used for unmarshalling a subset of the json. </p>\n\n<p>using this rpc:</p>\n\n<pre><code>  rpc GetUser (GetUserRequest) returns (Profile) {\n    option (google.api.http) = {\n      get: \"/user/{id=*}\"\n    };\n  }\n\n</code></pre>\n\n<p>and assuming the following json: </p>\n\n<pre><code>{\n  \"profile\": {\n     \"foo\": {\n        \"name\": \"tim\"\n        \"age\": 22\n      },\n     \"bar\": {\n       \"level\": 5\n     }\n  }\n}\n</code></pre>\n\n<p>I want to return a <code>Profile</code> Message containing  only \"foo\", \"bar\", or both, as nested Messages based on an incoming runtime <code>scope</code> parameter of the grpc request (currently, <code>scope</code> would be a list of strings containing the Message names to be used for subsetting the json into respective Messages e.g. <code>[\"Foo\",\"Bar\"]</code>).</p>\n\n<p>given these Message definitions:</p>\n\n<pre><code>message Profile {\n  //both Foo &amp; Bar are optional by default\n  Foo foo = 1 [json_name=\"foo\"];\n  Bar bar = 2 [json_name=\"bar\"];\n}\n\nmessage Foo {\n  string name = 1 [json_name=\"name\"];\n  int32 age = 2 [json_name=\"age\"];\n}\n\nmessage Bar {\n  string level = 1 [json_name=\"level\"];\n}\n</code></pre>\n\n<p>then in the case that <code>scope</code> is <code>[\"Foo\"]</code>, I'd like the rpc to return:</p>\n\n<pre><code>Profile{\n  Foo: // Foo Message unmarshalled from json\n}\n</code></pre>\n\n<p>or if <code>\"scope\"</code> is <code>[\"Foo\",\"Bar\"]</code> then:</p>\n\n<pre><code>Profile{\n  Foo: \n  Bar:\n}\n</code></pre>\n\n<p>The problem seems to boil down to \"duck-typing\" a Message type.</p>\n\n<h1>Attempt 1</h1>\n\n<p>I got close to finding a solution using <code>protoreflect</code> &amp; <code>protoregistry</code> by doing:</p>\n\n<pre><code>import(\n    \"google.golang.org/protobuf/reflect/protoregistry\"\n    \"google.golang.org/protobuf/reflect/protoreflect\"\n)\n\nvar scope protoreflect.FullName = \"Foo\"\nvar types = new(protoregistry.Types)\nvar message, errs = types.FindMessageByName(scope)\nvar almost_foo = message.New()\n\n// using `myJson` object without top level \"profile\" key to make testing more simple at the moment\nvar myJson = `{ \"foo\": { .. }, \"bar\", { ... } }`\nerr = json.Unmarshal([]byte(myJson), almost_foo)\n</code></pre>\n\n<p>but when I attempt to create Profile Message using <code>almost_foo</code>:</p>\n\n<pre><code>var profile = &amp;pb.Profile{almost_foo}\n</code></pre>\n\n<p>I get error: <code>cannot use almost_foo (type protoreflect.Message) as type *package_name.Foo in field value</code></p>\n\n<h1>Attempt 2</h1>\n\n<p>using </p>\n\n<pre><code>import(\n  \"github.com/jhump/protoreflect/desc\"\n  \"github.com/jhump/protoreflect/dynamic\"\n)\n</code></pre>\n\n<p>I try to dynamically create the message again:</p>\n\n<pre><code>var fd, errs = desc.LoadFileDescriptor(\"github.com/package/path/..\")\nvar message_desc = fd.FindMessage(\"Foo\")\nvar almost_foo = dynamic.NewMessage(message_desc)\n</code></pre>\n\n<p>and a similar error occurs:\n<code>cannot use almost_foo (type *dynamic.Message) as type *package_name.Foo in field value</code></p>\n\n<p>Both attempts almost create a Message but the type system still doesn't allow either to actually be used.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["go", "kubernetes", "yaml", "client-go"], "comments": [{"owner": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 1, "creation_date": 1573948020, "post_id": 58884207, "comment_id": 104057158, "body": "are you using any validation library? like, go-openapi?"}, {"owner": {"reputation": 72, "user_id": 7519842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819bfaa9b05c82b5fcff7f0f7d9423e6?s=128&d=identicon&r=PG&f=1", "display_name": "porgull", "link": "https://stackoverflow.com/users/7519842/porgull"}, "reply_to_user": {"reputation": 2647, "user_id": 4628962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/avtRP.png?s=128&g=1", "display_name": "Abdullah Al Maruf - Tuhin", "link": "https://stackoverflow.com/users/4628962/abdullah-al-maruf-tuhin"}, "edited": false, "score": 0, "creation_date": 1574037726, "post_id": 58884207, "comment_id": 104075915, "body": "@MarufTuhin ohhhh - I see what you&#39;re getting at. Let me check if it is expecting a string tomorrow at work - I will get back to you then."}], "answers": [{"tags": [], "owner": {"reputation": 72, "user_id": 7519842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819bfaa9b05c82b5fcff7f0f7d9423e6?s=128&d=identicon&r=PG&f=1", "display_name": "porgull", "link": "https://stackoverflow.com/users/7519842/porgull"}, "is_accepted": true, "score": 0, "last_activity_date": 1574084912, "creation_date": 1574084912, "answer_id": 58916057, "question_id": 58884207, "link": "https://stackoverflow.com/questions/58884207/marshalyaml-with-client-go-resources/58916057#58916057", "title": "MarshalYAML with Client Go resources", "body": "<p>@MarufTuhin had the right idea - looks like openapi/<code>operator-sdk generate openapi</code> was generating a CRD that expected an integer due to the type of the enum being <code>int</code>. </p>\n\n<p>You can fix this for client-go by adding this kubebuilder comment directly above the enum in the struct (see <a href=\"https://book.kubebuilder.io/reference/reference.html\" rel=\"nofollow noreferrer\">reference</a>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// +kubebuilder:validation:Type=string\nEnum Enum `json:\"enum\"`\n</code></pre>\n\n<p>or by just manually editing the crd generated like so</p>\n\n<pre><code>enum:\n  type: string\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 7519842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/819bfaa9b05c82b5fcff7f0f7d9423e6?s=128&d=identicon&r=PG&f=1", "display_name": "porgull", "link": "https://stackoverflow.com/users/7519842/porgull"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 58916057, "answer_count": 1, "score": 0, "last_activity_date": 1574084912, "creation_date": 1573849493, "question_id": 58884207, "link": "https://stackoverflow.com/questions/58884207/marshalyaml-with-client-go-resources", "title": "MarshalYAML with Client Go resources", "body": "<p>I'm writing a <a href=\"https://github.com/operator-framework/operator-sdk\" rel=\"nofollow noreferrer\">k8s operator</a> with a CRD. Part of that resource's status field is an enum value, using iota like so:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Enum int\n\nconst (\n    Enum1 = iota + 1\n    Enum2\n    Enum3\n    ...\n)\n</code></pre>\n\n<p>I have a function attached to the enum that converts it to a string representation. I want that string representation to be used as the value when client go marshals the enum into the status yaml.</p>\n\n<p>However, when I implement <code>MarshalYAML</code> (exactly as I do in this playground: <a href=\"https://play.golang.org/p/qtfFNoOQ-Dz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qtfFNoOQ-Dz</a>), client go returns an error:</p>\n\n<pre><code>status.test.phase in body must be of type integer: \"string\"\n</code></pre>\n\n<p>(<code>status.test.phase</code> is the location of the enum)</p>\n\n<p>Without the function, it marshals correctly, just with the integer value instead.</p>\n\n<p>What is different, under the hood, between <code>gopkg.in/yaml.v2</code> in the playground (which works fine) and client go's marshaling system?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1573866855, "last_edit_date": 1573866855, "creation_date": 1573857240, "answer_id": 58885559, "question_id": 58883967, "link": "https://stackoverflow.com/questions/58883967/look-for-list-of-words-in-a-sentence-in-go/58885559#58885559", "title": "Look for list of words in a sentence in Go", "body": "<blockquote>\n  <p>In python I have code. What would be the equivalent in Go?</p>\n</blockquote>\n\n<hr>\n\n<p>In Go, a lower-level language, write your own function.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"unicode\"\n)\n\n// Look for list of words in a sentence.\nfunc WordsInSentence(words []string, sentence string) []string {\n    var in []string\n\n    dict := make(map[string]string, len(words))\n    for _, word := range words {\n        dict[strings.ToLower(word)] = word\n    }\n\n    f := func(r rune) bool { return !unicode.IsLetter(r) }\n    for _, word := range strings.FieldsFunc(sentence, f) {\n        if word, ok := dict[strings.ToLower(word)]; ok {\n            in = append(in, word)\n            delete(dict, word)\n        }\n    }\n\n    return in\n}\n\nfunc main() {\n    words := []string{\"tx\", \"texas\", \"houston\"}\n    sentence := \"The Texas song Yellow Rose of Texas was sung in Houston, TX.\"\n    in := WordsInSentence(words, sentence)\n    fmt.Println(in)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/CwSLiDnq928\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CwSLiDnq928</a></p>\n\n<p>Output:</p>\n\n<pre><code>[texas houston tx]\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 5919368, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8c17b1e44c258dcfb5e443d5a6f853ab?s=128&d=identicon&r=PG&f=1", "display_name": "rustyocean", "link": "https://stackoverflow.com/users/5919368/rustyocean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 1, "accepted_answer_id": 58885559, "answer_count": 1, "score": -1, "last_activity_date": 1573866855, "creation_date": 1573848399, "last_edit_date": 1573849001, "question_id": 58883967, "link": "https://stackoverflow.com/questions/58883967/look-for-list-of-words-in-a-sentence-in-go", "title": "Look for list of words in a sentence in Go", "body": "<p>In python I have code like this</p>\n\n<pre><code>search_words_nonTexas = [\"tx\", \"texas\", \"houston\"]\npass = any(word in title for word in search_words_nonTexas)\n</code></pre>\n\n<p>in Go, I have been trying this</p>\n\n<pre><code>firstPass := strings.ContainsAny(\"title\", searchWordsNonTexas)\n</code></pre>\n\n<p>Im getting an error (show below) about the arguments not being right. What would be the equivalent in Go ?</p>\n\n<pre><code>cannot use searchWordsNonTexas (type [10]string) as type string in \nargument to strings.ContainsAny\n</code></pre>\n"}, {"tags": ["go", "terminal", "thrift"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1573851548, "post_id": 58883846, "comment_id": 104036350, "body": "There has to be some makefile or this would not work. If you type &quot;make fmt&quot; in a random dir it will not work, right?"}, {"owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "edited": false, "score": 0, "creation_date": 1574077258, "post_id": 58883846, "comment_id": 104089434, "body": "<code>.gen</code> is not a standard path, it should be <code>gen-go</code>, so that fact also points into a direction where it is very likely it is some custom tool that you are invoking."}], "owner": {"reputation": 1, "user_id": 12380410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e06ecd248de2eb23e2f38f57b4ee7f?s=128&d=identicon&r=PG&f=1", "display_name": "jnvjdbsuw", "link": "https://stackoverflow.com/users/12380410/jnvjdbsuw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573847820, "creation_date": 1573847820, "question_id": 58883846, "link": "https://stackoverflow.com/questions/58883846/how-does-make-fmt-work-in-generating-thrift-files", "title": "How does &quot;make fmt&quot; work in generating thrift files?", "body": "<p>For running and building some goprojects and generating code for thrift files, I was just using <code>make fmt</code> from the command line. </p>\n\n<p>So for example a thrift file could be in the folder <code>root/thriftstuff/a/b/my_service.thrift</code></p>\n\n<p><code>my_service.thrift</code>:</p>\n\n<pre><code>name someNamespace\n\nservice MyService{\n   string hello()\n}\n</code></pre>\n\n<p>I go back into <code>root</code> and I run <code>make fmt</code> without any Makefile or anything and it generates the thrift code for me in <code>root/.gen/go/my_service/myservice.go</code>. I'm wondering what happens and whats running behind the scenes? Seems like a blackbox</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 3, "creation_date": 1573833362, "post_id": 58880464, "comment_id": 104028231, "body": "regexp.MustCompile(fmt.Sprintf(<code>%s\\s\\S.*</code>,city))"}, {"owner": {"reputation": 27, "user_id": 5396778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bcr7YgbvyVw/AAAAAAAAAAI/AAAAAAAAAMw/LNX9-Snwkc0/photo.jpg?sz=128", "display_name": "jon bantay", "link": "https://stackoverflow.com/users/5396778/jon-bantay"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1573833699, "post_id": 58880464, "comment_id": 104028457, "body": "Wow that was so easy for you! It worked like a charm, thank you!. I kept looking for a solution in the regexp package, it was in fmt all along. Sorry for being noob. Thanks again!"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1573833725, "post_id": 58880464, "comment_id": 104028478, "body": "Sounds like a <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>. What are you trying to achieve? And how does the input look like?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1573834167, "post_id": 58880464, "comment_id": 104028732, "body": "You could also just do <code>regexp.MustCompile(city + ``\\s\\S.*``)</code>."}, {"owner": {"reputation": 27, "user_id": 5396778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bcr7YgbvyVw/AAAAAAAAAAI/AAAAAAAAAMw/LNX9-Snwkc0/photo.jpg?sz=128", "display_name": "jon bantay", "link": "https://stackoverflow.com/users/5396778/jon-bantay"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573834818, "post_id": 58880464, "comment_id": 104029096, "body": "@MarkusWMahlberg I have a very specific problem - I would like to insert variable content in to regexp which I honestly do not know. And had a hard time searching for similar problem. I am new to Go and to programming in general. This is just a part of the code which I am asking user to input a city, then it will populate the number of registered voters, land area, etc which is stored in a static file in this case, city.txt."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573838113, "post_id": 58880464, "comment_id": 104030722, "body": "Personally, I would rather parse the file on startup and answer from RAM than dynamically compiling regexes. The very least would be to create a <code>map[string]*regexp.Regexp</code> and reuse compiled regexes over the runtime of your program."}], "answers": [{"comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1573833569, "post_id": 58880616, "comment_id": 104028375, "body": "Furthermore I would like to add that compiling a regexp is a relatively expensive operation."}], "tags": [], "owner": {"reputation": 626, "user_id": 2454720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a13483fe013b55121def2b6bbd68462?s=128&d=identicon&r=PG", "display_name": "Ferdy Pruis", "link": "https://stackoverflow.com/users/2454720/ferdy-pruis"}, "is_accepted": true, "score": 4, "last_activity_date": 1573833599, "last_edit_date": 1573833599, "creation_date": 1573833443, "answer_id": 58880616, "question_id": 58880464, "link": "https://stackoverflow.com/questions/58880464/is-there-a-way-to-insert-variable-in-regexp/58880616#58880616", "title": "Is there a way to insert variable in regexp?", "body": "<p>The input to <code>regexp.MustCompile</code> is a string. Just concatenate your variable with the rest of the pattern;</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>city := \"Boston\"\nsearch1:= regexp.MustCompile(regex.QuoteMeta(city) + `\\s\\S.*`)\n</code></pre>\n\n<p>Make sure to escape user-input (<code>regex.QuoteMeta</code>) to prevent special characters from being evaluated as a pattern.</p>\n"}], "owner": {"reputation": 27, "user_id": 5396778, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bcr7YgbvyVw/AAAAAAAAAAI/AAAAAAAAAMw/LNX9-Snwkc0/photo.jpg?sz=128", "display_name": "jon bantay", "link": "https://stackoverflow.com/users/5396778/jon-bantay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 58880616, "answer_count": 1, "score": -4, "last_activity_date": 1573857779, "creation_date": 1573832922, "last_edit_date": 1573857779, "question_id": 58880464, "link": "https://stackoverflow.com/questions/58880464/is-there-a-way-to-insert-variable-in-regexp", "title": "Is there a way to insert variable in regexp?", "body": "<p>I am trying to use regex pattern based on user input which is saved in a variable. That variable will then be used in a regex search pattern.</p>\n\n<p>Here is some part of the code that is working if city is hard coded to regex pattern:</p>\n\n<pre><code>    //city.txt has the following input information:\n\n    //Boston 100 AA BB\n    //Chicago 200 CC DD\n\n\n    //Get user input\n\n    fmt.Print(\"Enter city: \")\n    scanner.Scan()\n    city:= scanner.Text()\n\n    //Read file from text and convert to string\n\n    citylist, _ := ioutil.ReadFile(\"city.txt\")\n    convertcitytostring:= string(citylist)\n\n    //Use regexp to search the citylist(str)\n\n    search1:= regexp.MustCompile(`Boston\\s\\S.*`)\n    search2:= search1.FindString(convertcitytostring)\n\n    //Convert results to []string\n\n    search3:= strings.Fields(search2)\n\n    //Print\n\n    fmt.Printf(\"%v %T\", search3, search3)\n    fmt.Printf(\"\\n\")\n\n    //Output:\n    //[Boston 100 AA BB] []string\n</code></pre>\n\n<p>What I would like to do is use variable \"city\" instead of hard coded pattern:</p>\n\n<pre><code>    search1:= regexp.MustCompile(`city\\s\\S.*`)\n    search2:= search1.FindString(convertSitestoString)\n</code></pre>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1573833203, "post_id": 58880406, "comment_id": 104028123, "body": "Why would the code be made faster by doing more work?"}, {"owner": {"reputation": 782, "user_id": 7071577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b816a812978bc140df497f0fbdd49c0?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Gonzalez", "link": "https://stackoverflow.com/users/7071577/carlos-gonzalez"}, "edited": false, "score": 4, "creation_date": 1573833236, "post_id": 58880406, "comment_id": 104028145, "body": "Although you are using goroutines you are still doing the additions in a serial manner. You iterate over the list and send the element thought the channel then you wait to get the element back from the channel before going to the next one. So you get no parallalization and you add the overhead of sending things through channels."}, {"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573833236, "post_id": 58880406, "comment_id": 104028146, "body": "Using goroutines usually only make sense when they do IO tasks or database queries, as they are things with many (small) wait times in between. Your code is neither of these and its speed is only dependent on the processor (not disk, network etc). Thus, you&#39;re running more instructions to do the same work, which in turn is slower"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "reply_to_user": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 4, "creation_date": 1573833823, "post_id": 58880406, "comment_id": 104028542, "body": "@xarantolus that&#39;s not true. goroutines makes sense whenever concurrency makes sense, not necessarily related to i/o."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 3, "creation_date": 1573834279, "post_id": 58880406, "comment_id": 104028805, "body": "@xarantolus that&#39;s completely false. Goroutines are a concurrency mechanism which have uses well beyond I/O."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1573850992, "post_id": 58880406, "comment_id": 104036150, "body": "To expand on what Carlos said and maybe give you a better feeling about <i>parallelization\u2026</i> Suppose you have a slice of one million elements and have to run a calculation on <i>each</i> of them, and it takes, say five seconds on a slinge CPU core. Let&#39;s further assume the calculations are all independent from each other. Now you could spawn as much coroutines as you have CPU cores, N, and make each process every Nth element\u2014that is, moving in strides of width N. <i>That</i> would give you almost &#215;N speedup for real."}], "answers": [{"tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": true, "score": 2, "last_activity_date": 1573833241, "creation_date": 1573833241, "answer_id": 58880552, "question_id": 58880406, "link": "https://stackoverflow.com/questions/58880406/why-is-my-code-running-slower-after-trying-goroutines/58880552#58880552", "title": "Why is my code running slower after trying Goroutines?", "body": "<p>You are adding a lot of synchronization overhead to the baseline algorithm. You have len(list) goroutines, all waiting to read from a common channel. When you write to the channel, the scheduler picks one of those goroutines, and that goroutines adds 10, and writes to the channel, which enables the main goroutine again. It is hard to speculate without really measuring it, but if you move the goroutine creation outside the for-loop, then you will have only one goroutine, reducing the scheduler overhead. However, in any comparison to the baseline algorithm this will be slower, because each operation involves two synchronizations and two context switches, which take more that the algorithm itself.</p>\n"}], "owner": {"reputation": 11, "user_id": 11725566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5c4dc46d1d1b34043467a43bd1c402a?s=128&d=identicon&r=PG&f=1", "display_name": "UnboltingZero0", "link": "https://stackoverflow.com/users/11725566/unboltingzero0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 58880552, "answer_count": 1, "score": -3, "last_activity_date": 1573857890, "creation_date": 1573832731, "last_edit_date": 1573857890, "question_id": 58880406, "link": "https://stackoverflow.com/questions/58880406/why-is-my-code-running-slower-after-trying-goroutines", "title": "Why is my code running slower after trying Goroutines?", "body": "<p>I decided to try figuring out Goroutines and channels. I made a function that takes a list and adds 10 to every element. I then made another function that attempts to incorporate channels and goroutines. When I timed the code it ran much slower. I tried doing some research but was unable to figure anything out.</p>\n\n<p>Here is my code with channels:</p>\n\n<pre><code>package main\n\nimport (\"fmt\"\n        \"time\")\n\nfunc addTen(channel chan int) {\n    channel &lt;- 10 + &lt;-channel\n}\n\nfunc listPlusTen(list []int) []int {\n    channel := make(chan int)\n    for i:= 0; i &lt; len(list); i++ {\n        go addTen(channel)\n        channel &lt;- list[i]\n        list[i] = &lt;-channel\n    }\n    return list\n}\n\nfunc main(){\n    var size int\n    list := make([]int, 0)\n    fmt.Print(\"Enter the list size: \")\n    fmt.Scanf(\"%d\", &amp;size)\n\n    for i:=0; i &lt;= size; i++ {\n        list = append(list, i)\n    }\n    start := time.Now()\n    list = listPlusTen(list)\n    end := time.Now()\n    fmt.Println(end.Sub(start)) \n}\n</code></pre>\n"}, {"tags": ["go", "jaeger", "opencensus"], "comments": [{"owner": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573829314, "post_id": 58879198, "comment_id": 104025858, "body": "Do you have any code for connecting to the backend? Can you show how do you send tracing data?"}, {"owner": {"reputation": 77, "user_id": 6309206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e98deb95d2a221f0d11862749c18ca81?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSpk", "link": "https://stackoverflow.com/users/6309206/ivanspk"}, "reply_to_user": {"reputation": 1614, "user_id": 5728357, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ET3iW.jpg?s=128&g=1", "display_name": "xarantolus", "link": "https://stackoverflow.com/users/5728357/xarantolus"}, "edited": false, "score": 0, "creation_date": 1573843577, "post_id": 58879198, "comment_id": 104033221, "body": "@xarantolus, code example added."}, {"owner": {"reputation": 471, "user_id": 2673284, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/40d04b9be7a037d05840c44dcec029ff?s=128&d=identicon&r=PG&f=1", "display_name": "Yuri Shkuro", "link": "https://stackoverflow.com/users/2673284/yuri-shkuro"}, "edited": false, "score": 0, "creation_date": 1575951247, "post_id": 58879198, "comment_id": 104729007, "body": "This is a question about OpenCensus (tag added), not so much about Jaeger."}], "owner": {"reputation": 77, "user_id": 6309206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e98deb95d2a221f0d11862749c18ca81?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSpk", "link": "https://stackoverflow.com/users/6309206/ivanspk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1575962869, "creation_date": 1573828575, "last_edit_date": 1575962869, "question_id": 58879198, "link": "https://stackoverflow.com/questions/58879198/handle-jaeger-errors", "title": "Handle Jaeger errors", "body": "<p>I am planning to use <code>Jaeger</code> tracing in on my <code>Golang</code> server. Everything is ok but I haven't found a way to handle <code>Jaeger</code> errors. I want to catch, for example, connection error to <code>Jaeger</code> backend while sending trace and write it to <code>loggly</code>.  </p>\n\n<p>Code example:  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"golang.org/x/net/context\"\n\n    \"contrib.go.opencensus.io/exporter/jaeger\"\n    \"go.opencensus.io/trace\"\n)\n\nfunc main() {\n    agentEndpointURI := \"localhost:6831\"\n    collectorEndpointURI := \"http://localhost:14268/api/traces\"\n\n    je, err := jaeger.NewExporter(jaeger.Options{\n        AgentEndpoint:     agentEndpointURI,\n        CollectorEndpoint: collectorEndpointURI,\n        ServiceName:       \"example\",\n    })\n    if err != nil {\n        log.Fatalf(\"Failed to create the Jaeger exporter: %v\", err)\n    }\n\n    trace.RegisterExporter(je)\n    trace.ApplyConfig(trace.Config{\n        DefaultSampler: trace.AlwaysSample(),\n    })\n\n    traceMethod()\n}\n\nfunc traceMethod() {\n    ctx := context.Background()\n\n    ctx, span := trace.StartSpan(ctx, \"traceMethod\")\n\n    // Do something here if the trace doesn't reach jaeger backend, write error to loggly\n\n    fmt.Println(\"send trace\")\n\n    defer span.End()\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 370, "user_id": 1212998, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f34c9c0ceb3059ab6045c2513c910881?s=128&d=identicon&r=PG", "display_name": "RVC", "link": "https://stackoverflow.com/users/1212998/rvc"}, "edited": false, "score": 0, "creation_date": 1573827763, "post_id": 58878915, "comment_id": 104024997, "body": "Btw, &quot;body&quot; is the request&#39;s body, extracted this way:body, err := ioutil.ReadAll(req.Body) where req is the httpRequest."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1573827806, "post_id": 58878915, "comment_id": 104025021, "body": "You don&#39;t have the definition for <code>FIDGET</code>, or for the <code>FIDGETS</code> show in the error message."}], "owner": {"reputation": 370, "user_id": 1212998, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f34c9c0ceb3059ab6045c2513c910881?s=128&d=identicon&r=PG", "display_name": "RVC", "link": "https://stackoverflow.com/users/1212998/rvc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1573827950, "answer_count": 0, "score": 0, "last_activity_date": 1573828065, "creation_date": 1573827622, "last_edit_date": 1573828065, "question_id": 58878915, "link": "https://stackoverflow.com/questions/58878915/json-marshalling-of-a-complex-structure-in-golang", "closed_reason": "Duplicate", "title": "json marshalling of a complex structure in Golang", "body": "<p>I just started developing in Golang, and am up against this problem:</p>\n\n<p>I have json data to be accepted by a Golang server.  A sample of one of the fields of this json data is below:</p>\n\n<pre><code> \"DATA\":[[\"(610, 658)\",1573824148],[\"(594, 675)\",1573824148],[\"(578,710)\",1573824148],[\"(571, 728)\",1573824148],[\"(552, 769)\",1573824148],[\"(549, 788)\",1573824148],[\"(549, 796)\",1573824148]]\n</code></pre>\n\n<p>Note that it is an array of lists, each list being a string and an integer.</p>\n\n<p>I have the following data structures declared:</p>\n\n<pre><code>type POINT struct {\n    p    string\n    t    int\n}\n\ntype POINTS struct {\n    A         int\n    B         int\n    C         string\n    DATA     []FIDGET\n}\n</code></pre>\n\n<p>The relevant field is POINTS.DATA which is an array of POINTs. A POINT is a string and an int. To convert from json to Go variables, I use the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\">encoding/json</a> package.</p>\n\n<p>My problem is, when I call</p>\n\n<pre><code>err = json.Unmarshal(body, &amp;m)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>json: cannot unmarshal array into Go struct field POINTS.DATA of type main.POINT\n</code></pre>\n\n<p>Can anyone help me? Thank you in advance!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22713, "user_id": 1086121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85d145ca3d7f8490da86055b72f3d859?s=128&d=identicon&r=PG", "display_name": "canton7", "link": "https://stackoverflow.com/users/1086121/canton7"}, "edited": false, "score": 6, "creation_date": 1573825866, "post_id": 58878413, "comment_id": 104024045, "body": "Your first example has all the overhead of actually doing the loop - all of the instructions in the <code>for</code> part, incrementing and testing <code>i</code>, jumping around, etc. When compared to just assigning an array element, that&#39;s significant."}, {"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 4, "creation_date": 1573825974, "post_id": 58878413, "comment_id": 104024093, "body": "There&#39;s a big difference, the first you have nested loops, the second you have one. The test cases are different, so your finding&#39;s are inconclusive as well."}, {"owner": {"reputation": 90105, "user_id": 106159, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Qfp6z.png?s=128&g=1", "display_name": "Matthew Watson", "link": "https://stackoverflow.com/users/106159/matthew-watson"}, "edited": false, "score": 9, "creation_date": 1573826065, "post_id": 58878413, "comment_id": 104024147, "body": "Congratulations - you have discovered <a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\" rel=\"nofollow noreferrer\">loop unrolling</a>! Note that the .Net JIT compiler <a href=\"https://www.codeproject.com/Articles/844781/Digging-Into-NET-Loop-Performance-Bounds-checking\" rel=\"nofollow noreferrer\">can do loop unrolling for some cases</a> (for release builds)."}, {"owner": {"reputation": 12819, "user_id": 845414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fbe63f77ce3f9656c62b27db4d8583b?s=128&d=identicon&r=PG", "display_name": "Johannes Kuhn", "link": "https://stackoverflow.com/users/845414/johannes-kuhn"}, "edited": false, "score": 0, "creation_date": 1573832985, "post_id": 58878413, "comment_id": 104027996, "body": "I ran some tests in Java using JMH. <a href=\"https://pastebin.com/3Dwj1H5D\" rel=\"nofollow noreferrer\">code</a> <a href=\"https://pastebin.com/SE3c7eQz\" rel=\"nofollow noreferrer\">results</a>. Conclusion: Unrolling it by hand is slightly slower. Also, the value of <code>b.N</code> doesn&#39;t matter, will be optimized away."}], "answers": [{"tags": [], "owner": {"reputation": 8940, "user_id": 3346583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1c10fae65fb338a8d62f4ba464a6db?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher", "link": "https://stackoverflow.com/users/3346583/christopher"}, "is_accepted": true, "score": 5, "last_activity_date": 1573826056, "creation_date": 1573826056, "answer_id": 58878485, "question_id": 58878413, "link": "https://stackoverflow.com/questions/58878413/why-is-assigning-array-entries-in-a-loop-slower/58878485#58878485", "title": "Why is assigning array entries in a loop slower?", "body": "<p>In the 1st example, you have a loop. Each itteration will be at least 1 jump + modifiying and checking the running variable. That is your overhead on top of the assignment. </p>\n\n<p>In the 2nd example, you hardcoded the assignments. Those orders can jsut be read sequentially. No jump, counting or checking related overheads.</p>\n\n<p>However it is worth pointing out, that the difference hardly ever maters:</p>\n\n<p><a href=\"https://ericlippert.com/2012/12/17/performance-rant/\" rel=\"noreferrer\">https://ericlippert.com/2012/12/17/performance-rant/</a></p>\n\n<p>It is not like you could use case 2 for really large lists anyway. At least not this side of some automated code creation,</p>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 0, "last_activity_date": 1573828610, "creation_date": 1573828610, "answer_id": 58879216, "question_id": 58878413, "link": "https://stackoverflow.com/questions/58878413/why-is-assigning-array-entries-in-a-loop-slower/58879216#58879216", "title": "Why is assigning array entries in a loop slower?", "body": "<p>The first example involves few additional computation that uses cpu, memory before real assignation is going to be done. \nBut for the second example it is a direct assignment without more computation.\nAs other answer mentioned it doesn't really matter for this example cases , but for more complex/large data set , it really important how algorithm should work efficiently. </p>\n\n<p>The above result might be same for other programming languages as well since the computation is same.</p>\n\n<p>Some good notes on complexity and big-O , this might be helpful \n<a href=\"http://pages.cs.wisc.edu/~vernon/cs367/notes/3.COMPLEXITY.html\" rel=\"nofollow noreferrer\">http://pages.cs.wisc.edu/~vernon/cs367/notes/3.COMPLEXITY.html</a></p>\n"}], "owner": {"reputation": 89, "user_id": 10548774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4a7a21d3f381f8dfbefd009871b4b26?s=128&d=identicon&r=PG&f=1", "display_name": "dircrys", "link": "https://stackoverflow.com/users/10548774/dircrys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 1, "accepted_answer_id": 58878485, "answer_count": 2, "score": 0, "last_activity_date": 1573828610, "creation_date": 1573825782, "last_edit_date": 1573827277, "question_id": 58878413, "link": "https://stackoverflow.com/questions/58878413/why-is-assigning-array-entries-in-a-loop-slower", "title": "Why is assigning array entries in a loop slower?", "body": "<p>I've found this weird benchmarking result that seems to say assigning the elements of an array is faster if it's not done in a loop. Hopefully someone can explain it. The full Go code is below and the benchmark <code>BenchmarkDirectAssignment</code> seems to run ten times faster even though it's doing the same thing:</p>\n\n<pre><code>package main\n\nimport \"testing\"\n\nfunc BenchmarkLoopAssignment(b *testing.B) {\n  arr := make([]int, 10)\n  for n := 0; n &lt; b.N; n++ {\n    for i := 0; i &lt; 10; i++ {\n      arr[i] = n\n    }\n  }\n}\n\nfunc BenchmarkDirectAssignment(b *testing.B) {\n  arr := make([]int, 10)\n  for n := 0; n &lt; b.N; n++ {\n    arr[0] = n\n    arr[1] = n\n    arr[2] = n\n    arr[3] = n\n    arr[4] = n\n    arr[5] = n\n    arr[6] = n\n    arr[7] = n\n    arr[8] = n\n    arr[9] = n\n  }\n}\n</code></pre>\n\n<pre><code>$ go test -bench=.\ngoos: windows\ngoarch: amd64\nBenchmarkLoopAssignment-16              500000000                3.76 ns/op\nBenchmarkDirectAssignment-16            2000000000               0.25 ns/op\nPASS\nok      _/D_/go_benchmark       3.107s\n</code></pre>\n\n<p>I've replicated this in Java and C# and got the same result - the direct assignment is always faster. Does anyone know why this would happen? Thanks!</p>\n"}, {"tags": ["string", "go", "unicode", "emoji"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1573823856, "last_edit_date": 1573823856, "creation_date": 1573823407, "answer_id": 58877773, "question_id": 58876934, "link": "https://stackoverflow.com/questions/58876934/converting-unicode-to-java/58877773#58877773", "title": "Converting unicode to &quot;java", "body": "<p>If you have the input as a <code>string</code>, e.g.</p>\n\n<pre><code>s := \"\\\\U0001f618\"\n</code></pre>\n\n<p>You may use <a href=\"https://golang.org/pkg/strconv/#Unquote\" rel=\"nofollow noreferrer\"><code>strconv.Unquote()</code></a> to unquote it. Be sure the string you pass to it is quoted (it must be wrapped with backticks or double quotes):</p>\n\n<pre><code>s2, err := strconv.Unquote(`\"` + s + `\"`)\nfmt.Println(s2, err)\n</code></pre>\n\n<p>This will give you an <code>s2</code> string that contains your emoji:</p>\n\n<pre><code>\ud83d\ude18 &lt;nil&gt;\n</code></pre>\n\n<p>Java's string model is a <code>char[]</code> which contains the <a href=\"https://en.wikipedia.org/wiki/UTF-16\" rel=\"nofollow noreferrer\">UTF-16 code points</a>. Go's memory model of <code>string</code> is the <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a> encoded byte sequence.</p>\n\n<p>To convert a Go string to UTF-16, you may use the <a href=\"https://golang.org/pkg/unicode/utf16/\" rel=\"nofollow noreferrer\"><code>unicode/utf16</code></a> package of the standard lib. For example <a href=\"https://golang.org/pkg/unicode/utf16/#Encode\" rel=\"nofollow noreferrer\"><code>utf16.Encode()</code></a> encodes a series of <code>rune</code>s (unicode codepoints) to UTF-16. You get a series of runes from a Go <code>string</code> with a simple type <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">conversion</a>: <code>[]rune(\"some string\")</code>.</p>\n\n<pre><code>u16 := utf16.Encode([]rune(s2))\nfmt.Printf(\"%X\\n\", u16)\n</code></pre>\n\n<p>The above prints the UTF16 codepoints in hexadecimal format:</p>\n\n<pre><code>[D83D DE18]\n</code></pre>\n\n<p>To get the format you want, use this loop:</p>\n\n<pre><code>buf := &amp;strings.Builder{}\nfor _, v := range u16 {\n    fmt.Fprintf(buf, \"\\\\u%X\", v)\n}\nfmt.Println(buf.String())\n</code></pre>\n\n<p>Which outputs:</p>\n\n<pre><code>\\uD83D\\uDE18\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/U9JbYEbvKLo\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>You can capture this series of conversions in a function:</p>\n\n<pre><code>func convert(s string) (string, error) {\n    s2, err := strconv.Unquote(`\"` + s + `\"`)\n    if err != nil {\n        return \"\", err\n    }\n\n    buf := &amp;strings.Builder{}\n    for _, v := range utf16.Encode([]rune(s2)) {\n        fmt.Fprintf(buf, \"\\\\u%X\", v)\n    }\n    return buf.String(), nil\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>fmt.Println(convert(\"\\\\U0001f618\"))\n</code></pre>\n\n<p>Which outputs (try it on the <a href=\"https://play.golang.org/p/6JOF8h3AFCT\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\\uD83D\\uDE18 &lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573823856, "creation_date": 1573820295, "last_edit_date": 1573823442, "question_id": 58876934, "link": "https://stackoverflow.com/questions/58876934/converting-unicode-to-java", "title": "Converting unicode to &quot;java", "body": "<p>I have this a problem with character conversion. It all starts with this string: <code>U+1F618</code>. According to <a href=\"https://www.fileformat.info/info/unicode/char/1f618/index.htm\" rel=\"nofollow noreferrer\">fileformat.info</a>, this string is now (almost) in the <code>HTML Entity (hex)</code> notation.</p>\n\n<p>But I need this character to be converted into a <code>C/C++/Java source code</code>-notation. I really don't know if this is the official name for the notation, but I assume this site to be correct :).</p>\n\n<p>So basically my question is, instead of outputting to the real emoji, how can I get the value <code>\\uD83D\\uDE18</code>?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"html\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    original := \"\\\\U0001f618\"\n\n    // Hex String\n    h := strings.ReplaceAll(original, \"\\\\U\", \"0x\")\n\n    // Hex to Int\n    i, _ := strconv.ParseInt(h, 0, 64)\n\n    // Unescape the string (HTML Entity -&gt; String).\n    str := html.UnescapeString(string(i))\n\n    // Display the emoji.\n    fmt.Println(str)\n\n    // but I want something like this: \\uD83D\\uDE18\n}\n\n</code></pre>\n"}, {"tags": ["variables", "go", "types"], "answers": [{"comments": [{"owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "edited": false, "score": 0, "creation_date": 1573813646, "post_id": 58874928, "comment_id": 104017727, "body": "Ok, this is reasonable. But I can&#39;t understand why sometime it works! Here an example: <a href=\"https://play.golang.org/p/kFGGnfqpnUi\" rel=\"nofollow noreferrer\">play.golang.org/p/kFGGnfqpnUi</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1573828600, "last_edit_date": 1592644375, "creation_date": 1573813292, "answer_id": 58874928, "question_id": 58874864, "link": "https://stackoverflow.com/questions/58874864/initialize-a-custom-type-doesnt-work-with-var-but-works-with/58874928#58874928", "title": "Initialize a custom type doesn&#39;t work with var but works with :=", "body": "<p>In this <a href=\"https://golang.org/ref/spec#Variable_declarations\" rel=\"nofollow noreferrer\">variable declaration</a>:</p>\n<pre><code>var err ErrNegativeSqrt = x\n</code></pre>\n<p>You explicitly give <code>err</code> a type of <code>ErrNegativeSqrt</code>, and you try to assign <code>x</code> to it but <code>x</code> is of type <code>float64</code> which is not assignable to a value of type <code>ErrNegativeSqrt</code>. <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">Assignability</a> rules don't apply, <code>float64</code> and <code>ErrNegativeSqrt</code> are 2 different, distinct types (although the latter has the former as its <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">underlying type</a>, so they are <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">convertible</a> one another).</p>\n<p>When you use this <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>:</p>\n<pre><code>err := ErrNegativeSqrt(x)\n</code></pre>\n<p>You explicitly <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">convert</a> <code>x</code> to <code>ErrNegativeSqrt</code>, so <code>x</code>'s type will be inferred to be <code>ErrNegativeSqrt</code>.</p>\n<p>You may do the same when using the <code>var</code> keyword:</p>\n<pre><code>var err ErrNegativeSqrt = ErrNegativeSqrt(x)\n</code></pre>\n<p>Or simply:</p>\n<pre><code>var err = ErrNegativeSqrt(x)\n</code></pre>\n<p>Which is exactly what the <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a> is a short form for.</p>\n<h2>Notes</h2>\n<p>As said earlier, <code>var err ErrNegativeSqrt = x</code> is invalid because <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability</a> rules don't apply:</p>\n<blockquote>\n<p>A value <code>x</code> is assignable to a <a href=\"https://golang.org/ref/spec#Variables\" rel=\"nofollow noreferrer\">variable</a> of type <code>T</code> (&quot;<code>x</code> is assignable to <code>T</code>&quot;) if one of the following conditions applies:</p>\n<ul>\n<li><code>x</code>'s type is identical to <code>T</code>.</li>\n<li><code>x</code>'s type <code>V</code> and <code>T</code> have identical <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">underlying types</a> and at least one of <code>V</code> or <code>T</code> is not a <a href=\"https://golang.org/ref/spec#Type_definitions\" rel=\"nofollow noreferrer\">defined</a> type.</li>\n<li><code>T</code> is an interface type and <code>x</code> <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">implements</a> <code>T</code>.</li>\n<li><code>x</code> is a bidirectional channel value, <code>T</code> is a channel type, <code>x</code>'s type <code>V</code> and <code>T</code> have identical element types, and at least one of <code>V</code> or <code>T</code> is not a defined type.</li>\n<li><code>x</code> is the predeclared identifier <code>nil</code> and <code>T</code> is a pointer, function, slice, map, channel, or interface type.</li>\n<li><code>x</code> is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> <a href=\"https://golang.org/ref/spec#Representability\" rel=\"nofollow noreferrer\">representable</a> by a value of type <code>T</code>.</li>\n</ul>\n</blockquote>\n<p>As you can see, the second rule &quot;almost&quot; covers what we want to do here:</p>\n<blockquote>\n<p><code>x</code>'s type <code>V</code> and <code>T</code> have identical underlying types and at least one of <code>V</code> or <code>T</code> is not a defined type</p>\n</blockquote>\n<p>The reason why it's just &quot;almost&quot; is because both <code>ErrNegativeSqrt</code> and <code>float64</code> are named (<a href=\"https://golang.org/ref/spec#Type_definitions\" rel=\"nofollow noreferrer\">defined</a>) types.</p>\n<p>When you do:</p>\n<pre><code>var err ErrNegativeSqrt = 1.0\n</code></pre>\n<p>This works because here you are assigning an <em>untyped</em> <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> <code>1.0</code> which can take the required type when needed (like in the above assignment). Since you are assigning to <code>err</code> of type <code>ErrNegativeSqrt</code>, the untyped constant <code>1.0</code> can take the type <code>ErrNegativeSqrt</code> (because <code>ErrNegativeSqrt</code>'s underlying type is <code>float64</code>, and <code>1.0</code> is an untyped floating-point constant). This case is exactly the last assignability rule:</p>\n<blockquote>\n<p><code>x</code> is an untyped <a href=\"https://golang.org/ref/spec#Constants\" rel=\"nofollow noreferrer\">constant</a> <a href=\"https://golang.org/ref/spec#Representability\" rel=\"nofollow noreferrer\">representable</a> by a value of type <code>T</code>.</p>\n</blockquote>\n<p>If you would do:</p>\n<pre><code>var err ErrNegativeSqrt = float64(1.0) // FAIL!!\n</code></pre>\n<p>This would again fail just as your example in the question, because here we're using a <em>typed</em> constant which cannot change type arbitrarily, there is no assignability rule allowing this.</p>\n<p>Read blog post <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">The Go Blog: Constants</a> for more details how constants work in Go.</p>\n"}], "owner": {"reputation": 1122, "user_id": 4970650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/496526a825adf2e6587a19d3a6d391f7?s=128&d=identicon&r=PG", "display_name": "Cirelli94", "link": "https://stackoverflow.com/users/4970650/cirelli94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58874928, "answer_count": 1, "score": 1, "last_activity_date": 1573828600, "creation_date": 1573813096, "last_edit_date": 1573814463, "question_id": 58874864, "link": "https://stackoverflow.com/questions/58874864/initialize-a-custom-type-doesnt-work-with-var-but-works-with", "title": "Initialize a custom type doesn&#39;t work with var but works with :=", "body": "<p>I'm trying to initialize an ErrNegativeSqrt, which is a custom float64 type, but if I do it with <code>var</code> it doesn't work.</p>\n\n<p>Take a look in <code>func Sqrt(x float64) (float64, error)</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype ErrNegativeSqrt float64\n\nfunc (e *ErrNegativeSqrt) Error() string {\n    return fmt.Sprint(\"cannot Sqrt negative number: %f\", float64(*e))\n}\n\nfunc Sqrt(x float64) (float64, error) {\n    if x &lt; 0 {\n        var err ErrNegativeSqrt = x\n        // This works: err := ErrNegativeSqrt(x)\n        return x, &amp;err\n    }\n\n    z := x / 2\n    i := 1\n\n    for prev_z := 0.0; z != prev_z &amp;&amp; Abs(z-prev_z) &gt; 0.000000000000001; i++ {\n        prev_z = z\n        z -= (z*z - x) / (2 * z)\n    }\n\n    return z, nil\n}\n\nfunc Abs(x float64) float64 {\n    if x &lt; 0 {\n        x = -x\n    }\n    return x\n}\n\nfunc main() {\n    fmt.Println(Sqrt(2))\n    fmt.Println(Sqrt(-2))\n}\n</code></pre>\n\n<p>The error is: <code>./prog.go:15:7: cannot use x (type float64) as type ErrNegativeSqrt in assignment</code></p>\n\n<p>Why does it happen? Isn't it the same as the assignment with <code>:=</code>?</p>\n\n<p><a href=\"https://play.golang.org/p/svMq3Dg4jCa\" rel=\"nofollow noreferrer\">Here there is the playground.</a></p>\n"}, {"tags": ["authentication", "go", "google-api", "google-oauth", "google-sheets-api"], "answers": [{"comments": [{"owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "edited": false, "score": 1, "creation_date": 1573817043, "post_id": 58875497, "comment_id": 104019546, "body": "Thanks @ZektorH for sharing the example and links. After changing the Scopes parameter, It worked for me. You really saved my life."}], "tags": [], "owner": {"reputation": 2322, "user_id": 11869748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qh4YQ.jpg?s=128&g=1", "display_name": "ZektorH", "link": "https://stackoverflow.com/users/11869748/zektorh"}, "is_accepted": false, "score": 3, "last_activity_date": 1573815207, "creation_date": 1573815207, "answer_id": 58875497, "question_id": 58874474, "link": "https://stackoverflow.com/questions/58874474/unable-to-access-google-spreadsheets-with-a-service-account-credentials-using-go/58875497#58875497", "title": "Unable to access Google Spreadsheets with a service account credentials using Golang", "body": "<p>After some digging I found some <a href=\"https://github.com/googleapis/google-api-go-client/blob/master/GettingStarted.md#service-accounts\" rel=\"nofollow noreferrer\">documentation</a> that explains how to use Service Accounts on Golang. There is an <a href=\"https://godoc.org/golang.org/x/oauth2/google#ex-package--ServiceAccount\" rel=\"nofollow noreferrer\">example</a> on how to perform authentication with Service Accounts on the documentation:</p>\n\n<blockquote>\n<pre><code>// Your credentials should be obtained from the Google\n// Developer Console (https://console.developers.google.com).\nconf := &amp;jwt.Config{\n    Email: \"xxx@developer.gserviceaccount.com\",\n    // The contents of your RSA private key or your PEM file\n    // that contains a private key.\n    // If you have a p12 file instead, you\n    // can use `openssl` to export the private key into a pem file.\n    //\n    //    $ openssl pkcs12 -in key.p12 -passin pass:notasecret -out key.pem -nodes\n    //\n    // The field only supports PEM containers with no passphrase.\n    // The openssl command will convert p12 keys to passphrase-less PEM containers.\n    PrivateKey: []byte(\"-----BEGIN RSA PRIVATE KEY-----...\"),\n    Scopes: []string{\n        \"https://www.googleapis.com/auth/bigquery\",\n        \"https://www.googleapis.com/auth/blogger\",\n    },\n    TokenURL: google.JWTTokenURL,\n    // If you would like to impersonate a user, you can\n    // create a transport with a subject. The following GET\n    // request will be made on the behalf of user@example.com.\n    // Optional.\n    Subject: \"user@example.com\",\n}\n// Initiate an http.Client, the following GET request will be\n// authorized and authenticated on the behalf of user@example.com.\nclient := conf.Client(oauth2.NoContext)\nclient.Get(\"...\")\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 1634, "user_id": 1734785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda4a051ab231487e0517599ff9bc07f?s=128&d=identicon&r=PG", "display_name": "Christophe Vidal", "link": "https://stackoverflow.com/users/1734785/christophe-vidal"}, "edited": false, "score": 1, "creation_date": 1583748073, "post_id": 58876128, "comment_id": 107207682, "body": "Thank you for the tip on how to resolve the permission issue, this really made me crazy. Also, there is a better way to initialize the credentials as mentioned here <a href=\"https://stackoverflow.com/questions/39691100/golang-google-sheets-api-v4-write-update-example/58797998#58797998\" title=\"golang google sheets api v4 write update example\">stackoverflow.com/questions/39691100/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "is_accepted": true, "score": 6, "last_activity_date": 1574774653, "last_edit_date": 1574774653, "creation_date": 1573817296, "answer_id": 58876128, "question_id": 58874474, "link": "https://stackoverflow.com/questions/58874474/unable-to-access-google-spreadsheets-with-a-service-account-credentials-using-go/58876128#58876128", "title": "Unable to access Google Spreadsheets with a service account credentials using Golang", "body": "<p>@ZektorH answer helped me to complete this code. Below is the complete working example for pulling data from Google spreadsheets using Service Account.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"golang.org/x/oauth2\"\n    \"golang.org/x/oauth2/jwt\"\n    \"google.golang.org/api/sheets/v4\"\n)\n\n\nfunc main() {\n\n    // Create a JWT configurations object for the Google service account\n    conf := &amp;jwt.Config{\n        Email:        \"lambda@quickstart-XXXXXXXXXX.iam.gserviceaccount.com\",\n        PrivateKey:   []byte(\"-----BEGIN PRIVATE KEY-----\\nxxxxxx\\n-----END PRIVATE KEY-----\\n\"),\n        PrivateKeyID: \"a1a6xxxxxxxxxxxxxxxxxxxxxxxe5d8e\",\n        TokenURL:     \"https://oauth2.googleapis.com/token\",\n        Scopes: []string{\n            \"https://www.googleapis.com/auth/spreadsheets.readonly\",\n        },\n    }\n\n    client := conf.Client(oauth2.NoContext)\n\n    // Create a service object for Google sheets\n    srv, err := sheets.New(client)\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve Sheets client: %v\", err)\n    }\n\n    // Change the Spreadsheet Id with yours    \n    spreadsheetId := \"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms\"\n\n    // Define the Sheet Name and fields to select\n    readRange := \"Sheet1!A2:B\"\n\n    // Pull the data from the sheet\n    resp, err := srv.Spreadsheets.Values.Get(spreadsheetId, readRange).Do()\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve data from sheet: %v\", err)\n    }\n\n    // Display pulled data\n    if len(resp.Values) == 0 {\n        fmt.Println(\"No data found.\")\n    } else {\n        fmt.Println(\"Name, Major:\")\n        for _, row := range resp.Values {\n            fmt.Printf(\"%s, %s\\n\", row[0], row[1])\n        }\n    }\n}\n</code></pre>\n\n<p>Also, note that if you get an error as below:</p>\n\n<blockquote>\n  <p>googleapi: Error 403: The caller does not have permission, forbidden</p>\n</blockquote>\n\n<p>then probably you have not given permission to your google account to access that spreadsheet. If so-</p>\n\n<ul>\n<li><p>simply go in your browser to the Google sheet you want to interact with.</p></li>\n<li><p>Go to SHARE on the top right of your screen.</p></li>\n<li>Go to advanced settings and share it with email address of your service account ex. lambda@quickstart-XXXXXXXXXX.iam.gserviceaccount.com</li>\n</ul>\n"}], "owner": {"reputation": 1383, "user_id": 4457831, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh5.googleusercontent.com/-yRdAUOMzpcU/AAAAAAAAAAI/AAAAAAAAAHQ/1fFS--Cdp-k/photo.jpg?sz=128", "display_name": "Rahul Satal", "link": "https://stackoverflow.com/users/4457831/rahul-satal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "accepted_answer_id": 58876128, "answer_count": 2, "score": 0, "last_activity_date": 1574774653, "creation_date": 1573811808, "last_edit_date": 1592644375, "question_id": 58874474, "link": "https://stackoverflow.com/questions/58874474/unable-to-access-google-spreadsheets-with-a-service-account-credentials-using-go", "title": "Unable to access Google Spreadsheets with a service account credentials using Golang", "body": "<p>I am writing an AWS Lambda code for accessing and updating a spreadsheet with the URL as input using Golang. So far I am able to access the spreadsheet locally using OAuth Client ID by following the Google guide - <a href=\"https://developers.google.com/sheets/api/quickstart/go\" rel=\"nofollow noreferrer\">https://developers.google.com/sheets/api/quickstart/go</a></p>\n<p>But as I want to run the code from AWS Lambda, I want to perform authentication using the Google Service account. I have created a service account and have received the credentials which contain the below information.</p>\n<pre><code>{\n&quot;type&quot;: &quot;service_account&quot;,\n&quot;project_id&quot;: &quot;quickstart-1XXXXXXX806&quot;,\n&quot;private_key_id&quot;: &quot;a1XXXXXXXXXXXXXXXXXXXXX3c3e5d8e&quot;,\n&quot;private_key&quot;: &quot;-----BEGIN PRIVATE KEY-----\\nMZ4C8......\\nD\\n-----END PRIVATE KEY-----\\n&quot;,\n&quot;client_email&quot;: &quot;lambda@quickstart-1XXXXXXX806.iam.gserviceaccount.com&quot;,\n&quot;client_id&quot;: &quot;1XXXXXXXXXXXXXXXXX2&quot;,\n&quot;auth_uri&quot;: &quot;https://accounts.google.com/o/oauth2/auth&quot;,\n&quot;token_uri&quot;: &quot;https://oauth2.googleapis.com/token&quot;,\n&quot;auth_provider_x509_cert_url&quot;: &quot;https://www.googleapis.com/oauth2/v1/certs&quot;,\n&quot;client_x509_cert_url&quot;: &quot;https://www.googleapis.com/robot/v1/metadata/x509/lambda%40quickstart-1573627656806.iam.gserviceaccount.com&quot;\n</code></pre>\n<p>}</p>\n<p>I have read much documentation but I didn't find any references for accessing Google spreadsheets using a Google service account using Golang code. Every document refer to the following Github link - <a href=\"https://github.com/googleapis/google-api-go-client\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-api-go-client</a>\nBut as I have recently started working in Golang, I really don't understand how to implement it. After reading the Google guide I understand the flow required for service account as below -\n<a href=\"https://i.stack.imgur.com/XVL6h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XVL6h.png\" alt=\"enter image description here\" /></a></p>\n<p>But I am not still able to write Golang code for this. I would appreciate if anyone could share some references:)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 3997070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c629b0d9f19f3ca9236ee73e06d054?s=128&d=identicon&r=PG&f=1", "display_name": "cheng dong", "link": "https://stackoverflow.com/users/3997070/cheng-dong"}, "edited": false, "score": 0, "creation_date": 1573799574, "post_id": 58871388, "comment_id": 104011178, "body": "i checked, it&#39;s true, if i run 100k go func for 10 times, they use much less memory"}], "tags": [], "owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "is_accepted": false, "score": 12, "last_activity_date": 1573798912, "creation_date": 1573798912, "answer_id": 58871388, "question_id": 58871294, "link": "https://stackoverflow.com/questions/58871294/whats-the-difference-between-two-go-code-below-why-the-use-such-much-different/58871388#58871388", "title": "what&#39;s the difference between two go code below, why the use such much different memory", "body": "<p>They don't do it 10K times, they do it 1M times. The first one, while waiting for 1msec, creates thousands of goroutines, with 2K stack each. If that took 460M, then you have about 230K active concurrent goroutines after everything is done. The second one, while it is creating the same number of goroutines, they terminate quickly, keeping the active concurrent goroutine count much lower.</p>\n"}], "owner": {"reputation": 41, "user_id": 3997070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c629b0d9f19f3ca9236ee73e06d054?s=128&d=identicon&r=PG&f=1", "display_name": "cheng dong", "link": "https://stackoverflow.com/users/3997070/cheng-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573798912, "creation_date": 1573798448, "question_id": 58871294, "link": "https://stackoverflow.com/questions/58871294/whats-the-difference-between-two-go-code-below-why-the-use-such-much-different", "title": "what&#39;s the difference between two go code below, why the use such much different memory", "body": "<p>code A:</p>\n\n<pre><code>MaxCnt := 1000000\nwg := sync.WaitGroup{}\n    wg.Add(MaxCnt)\n    for i:=0; i&lt;MaxCnt; i++ {\n        go func() {\n            time.Sleep(time.Millisecond)\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n</code></pre>\n\n<p>code B:</p>\n\n<pre><code>MaxCnt := 1000000\nwg := sync.WaitGroup{}\n    wg.Add(MaxCnt)\n    for i:=0; i&lt;MaxCnt; i++ {\n        go func() {\n            wg.Done()\n        }()\n    }\n    wg.Wait()\n</code></pre>\n\n<p>code A use about 460MB memory, and code B use a few KB memory, they both go func 10k times.  i want to know why?</p>\n"}, {"tags": ["go", "webassembly", "tinygo"], "comments": [{"owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "edited": false, "score": 1, "creation_date": 1573809916, "post_id": 58871108, "comment_id": 104015475, "body": "shouldn&#39;t <code>lib.Version</code> just be <code>Version</code> if <code>Version</code> is  field in <code>NewObject</code>?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "reply_to_user": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "edited": false, "score": 0, "creation_date": 1573844874, "post_id": 58871108, "comment_id": 104033698, "body": "@AyushGupta Oops! fixed."}], "answers": [{"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 1, "last_activity_date": 1573937869, "last_edit_date": 1573937869, "creation_date": 1573851803, "answer_id": 58884632, "question_id": 58871108, "link": "https://stackoverflow.com/questions/58871108/cannot-use-lib-const-constant-16777216-of-type-lib-version-as-lib-version/58884632#58884632", "title": "Cannot use lib.Const (constant 16777216 of type lib.Version) as lib.Version", "body": "<p>This is a bug with the compiler: <a href=\"https://github.com/tinygo-org/tinygo/issues/726\" rel=\"nofollow noreferrer\">https://github.com/tinygo-org/tinygo/issues/726</a></p>\n\n<p>It stems from importing the same package twice under different names. In this case, it was:</p>\n\n<pre><code>// file1:\nimport \"./lib\"\n\n// file2:\nimport \"../lib\"\n</code></pre>\n\n<p>The above made 2 instances of the package \"lib\". This is normally okay to do when working with the normal Go compiler. But TinyGo does not have mechanisms in place to deal with this properly.</p>\n\n<p>It is recommended to append to the <code>$GOPATH</code> to prevent the use of relative paths:</p>\n\n<pre><code>// file1:\nimport \"lib\"\n\n// file2:\nimport \"lib\"\n</code></pre>\n"}], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1573937869, "creation_date": 1573797280, "last_edit_date": 1573844882, "question_id": 58871108, "link": "https://stackoverflow.com/questions/58871108/cannot-use-lib-const-constant-16777216-of-type-lib-version-as-lib-version", "title": "Cannot use lib.Const (constant 16777216 of type lib.Version) as lib.Version", "body": "<p>I've come across an odd error. I have this larger project that compiles fine with the typical <code>go build</code>. However when I switch to TinyGo (v0.8.0). I get the above error from this code:</p>\n\n<pre><code>func main() {\n\n    _ = lib.NewObject{\n         Version: lib.Const,\n    }\n}\n</code></pre>\n\n<p>I changed the names to be less confusing but the symbols are completely identical. <code>lib.Const</code> is a constant of a <code>lib.Version</code>. And neither are pointers.</p>\n\n<p>I understand this is a very specific question in the sense that it's in the realm TinyGo. This is more \"for the record\"... plus I even had to create the \"tinygo\" tag because this question is so specific. But to add further detail:</p>\n\n<ul>\n<li>It has been compiling before the above code was added.</li>\n<li>The build command in exact is <code>tinygo build -target=wasm -o build/out.wasm src/main-wasm.go</code></li>\n</ul>\n"}, {"tags": ["go", "protocol-buffers", "protobuf-go"], "comments": [{"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1573797565, "post_id": 58871081, "comment_id": 104010507, "body": "What exactly do you mean by &quot;add those two optional parameters at consumer end&quot;? You received a message, how can you add the optional fields?"}, {"owner": {"reputation": 415, "user_id": 10263695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IClZzCdXtC8/AAAAAAAAAAI/AAAAAAAAGAs/4BH-9diuSwM/photo.jpg?sz=128", "display_name": "Vani Polnedi", "link": "https://stackoverflow.com/users/10263695/vani-polnedi"}, "reply_to_user": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 0, "creation_date": 1573797987, "post_id": 58871081, "comment_id": 104010669, "body": "I want to assign value for optinal paramaters at consumer end and send it to another queue . Is it possible?"}, {"owner": {"reputation": 26005, "user_id": 11923999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M84sB.png?s=128&g=1", "display_name": "Burak Serdar", "link": "https://stackoverflow.com/users/11923999/burak-serdar"}, "edited": false, "score": 1, "creation_date": 1573798467, "post_id": 58871081, "comment_id": 104010820, "body": "After receiving the msg, you can modify the struct and marshal it again. It is a new message at that point."}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 7411338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1eb096951cfca58bbe134525498891eb?s=128&d=identicon&r=PG&f=1", "display_name": "robscodebase", "link": "https://stackoverflow.com/users/7411338/robscodebase"}, "is_accepted": true, "score": 0, "last_activity_date": 1573859384, "creation_date": 1573859384, "answer_id": 58885846, "question_id": 58871081, "link": "https://stackoverflow.com/questions/58871081/how-to-set-optional-parameter-after-unmarshalling-protobuf-proto2-in-golang/58885846#58885846", "title": "How to set optional parameter after unmarshalling Protobuf ( proto2 ) in Golang?", "body": "<p>To update a field for a struct that is already in memory declare the variable name with the field like the example below.\nIf someStruct is in memory the value can be overwritten at anytime.</p>\n\n<p>someStruct.SomeField = SomeValue</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Data struct {\n    FieldOne   string\n    FieldTwo   int\n    FieldThree []string\n    FieldFour  float64\n}\n\nfunc main() {\n    data := createData(\"A string\", 9)\n    data = data.rcv()\n    fmt.Println(data)\n}\n\nfunc createData(f1 string, f2 int) *Data {\n    d := &amp;Data{}\n    d.FieldOne = f1\n    d.FieldTwo = f2\n    return d\n}\n\nfunc (d *Data) rcv() *Data {\n    d.FieldThree = []string{\"string1\", \"string2\"}\n    d.FieldFour = 1.2\n    return d\n}\n</code></pre>\n"}], "owner": {"reputation": 415, "user_id": 10263695, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IClZzCdXtC8/AAAAAAAAAAI/AAAAAAAAGAs/4BH-9diuSwM/photo.jpg?sz=128", "display_name": "Vani Polnedi", "link": "https://stackoverflow.com/users/10263695/vani-polnedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 58885846, "answer_count": 1, "score": 0, "last_activity_date": 1573859384, "creation_date": 1573797159, "question_id": 58871081, "link": "https://stackoverflow.com/questions/58871081/how-to-set-optional-parameter-after-unmarshalling-protobuf-proto2-in-golang", "title": "How to set optional parameter after unmarshalling Protobuf ( proto2 ) in Golang?", "body": "<p>I have 5 fields in protobuf ( 3 required fileds and 2 optional fileds ). From producer end i will send 3 required fileds (marshall) and get those (unmarshall) 3 required fileds at consumer end. Now, i want to add those two optional parameters values at consumer end . Is it possible ? if yes, how?</p>\n\n<p>Thanks in Advance</p>\n"}, {"tags": ["go", "struct", "go-echo"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573793297, "post_id": 58870408, "comment_id": 104009484, "body": "What is c.Bind?"}, {"owner": {"reputation": 23, "user_id": 11727168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53NTedcDv04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfl9ihMNEQ6xBHS45NgnZietr1aZA/photo.jpg?sz=128", "display_name": "Doctor Strange", "link": "https://stackoverflow.com/users/11727168/doctor-strange"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573793444, "post_id": 58870408, "comment_id": 104009511, "body": "func CreateNotification (c echo.Context) error { } @CeriseLim&#243;n"}, {"owner": {"reputation": 23, "user_id": 11727168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53NTedcDv04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfl9ihMNEQ6xBHS45NgnZietr1aZA/photo.jpg?sz=128", "display_name": "Doctor Strange", "link": "https://stackoverflow.com/users/11727168/doctor-strange"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573794733, "post_id": 58870408, "comment_id": 104009758, "body": "other package , import model package"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573794793, "post_id": 58870408, "comment_id": 104009770, "body": "Please edit the question to show the import path of the package you are using.  Please show where the error was reported."}, {"owner": {"reputation": 23, "user_id": 11727168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53NTedcDv04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfl9ihMNEQ6xBHS45NgnZietr1aZA/photo.jpg?sz=128", "display_name": "Doctor Strange", "link": "https://stackoverflow.com/users/11727168/doctor-strange"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1573796676, "post_id": 58870408, "comment_id": 104010260, "body": "yes . i sorry i begin with stackoverflow . @CeriseLim&#243;n . i done"}, {"owner": {"reputation": 2219, "user_id": 538901, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ace54294322664e5643b0734a64947ab?s=128&d=identicon&r=PG", "display_name": "rgin", "link": "https://stackoverflow.com/users/538901/rgin"}, "edited": false, "score": 0, "creation_date": 1573797332, "post_id": 58870408, "comment_id": 104010433, "body": "@ThinhPham - try passing a pointer as it&#39;s the only thing I can see wrong with what you&#39;ve given. The error message just doesn&#39;t make sense to me. <code>if err := c.Bind(&amp;req) ...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 350, "user_id": 7036108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UbnEY.jpg?s=128&g=1", "display_name": "v4570", "link": "https://stackoverflow.com/users/7036108/v4570"}, "is_accepted": false, "score": 0, "last_activity_date": 1573825166, "creation_date": 1573825166, "answer_id": 58878249, "question_id": 58870408, "link": "https://stackoverflow.com/questions/58870408/bind-request-method-post/58878249#58878249", "title": "Bind request method POST", "body": "<p>You need to set the JSON equivalent of each field in the model like so:</p>\n\n<pre><code>package models\ntype RequestCreateNotifi struct {\n    Name_param1     string    `json:\"name_param1\" db:\"Name_param1\"`\n    Name_param2     string    `json:\"name_param2\" db:\"Name_param2\"`\n    ....\n    Name_param_n    string    `json:\"name_param_n\" db:\"Name_param n\"`\n}\n</code></pre>\n\n<p>This json field specifies how the field is represented in the request so it can bind it to the correct value.</p>\n"}], "owner": {"reputation": 23, "user_id": 11727168, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-53NTedcDv04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfl9ihMNEQ6xBHS45NgnZietr1aZA/photo.jpg?sz=128", "display_name": "Doctor Strange", "link": "https://stackoverflow.com/users/11727168/doctor-strange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1579850819, "creation_date": 1573792644, "last_edit_date": 1579850819, "question_id": 58870408, "link": "https://stackoverflow.com/questions/58870408/bind-request-method-post", "title": "Bind request method POST", "body": "<p>I have a problem with binding my request, because there are a lot of parameters, so I used struct containing param.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package api\nimport (\n    \"github.com/labstack/echo/v4\"\n    \"net/http\"\n    \"trains-api/domain/models\"\n    \"trains-api/domain/services\"\n)\n\ntype reqCreate struct {\n    RequestNotifi  models.ResquestCreateNotifi  \n}\nfunc CreateNotification (c echo.Context) error {\n    req := reqCreate{}\n\n    if err := c.Bind(req); err != nil {\n        return c.JSON(http.StatusNotFound, err)\n    }\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package models\n\ntype RequestCreateNotifi struct {\n    Name_param1     string    `db:\"Name_param1\"`\n    Name_param2     string    `db:\"Name_param2\"`\n    ....\n    Name_param_n    string    `db:\"Name_paramN\"`\n}\n</code></pre>\n\n<p>error at <code>if err := c.Bind(req); err != nil</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r = {interface {} | string } \"reflect: Elem of invalid type\"\n</code></pre>\n"}]