[{"tags": ["c", "windows", "go"], "answers": [{"tags": [], "owner": {"reputation": 6770, "user_id": 3658660, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b40f4e2bead9eca6951da110a3c84e7?s=128&d=identicon&r=PG&f=1", "display_name": "hlscalon", "link": "https://stackoverflow.com/users/3658660/hlscalon"}, "is_accepted": false, "score": 1, "last_activity_date": 1479927819, "last_edit_date": 1479927819, "creation_date": 1479927128, "answer_id": 40772167, "question_id": 40770786, "link": "https://stackoverflow.com/questions/40770786/go-vgo-robotgo-library-build-error/40772167#40772167", "title": "&quot;go-vgo/robotgo&quot; library build error", "body": "<p>Apparently it's an error in the library.</p>\n\n<p>From <a href=\"https://github.com/go-vgo/robotgo/blob/master/mouse/mouse_c.h#L116\" rel=\"nofollow noreferrer\">https://github.com/go-vgo/robotgo/blob/master/mouse/mouse_c.h#L116</a></p>\n\n<pre><code>...\nINPUT mouseInput;\nmouseInput.type = INPUT_MOUSE;\nmouseInput.mi.dx = point.x;\n...\n</code></pre>\n\n<p>The errors <code>unknown type name 'INPUT'</code>, <code>'INPUT_MOUSE' undeclared</code>, <code>error: request for member 'mi'</code>, suggest that those types aren't known in that file.</p>\n\n<p>From <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646270(v=vs.85).aspx\" rel=\"nofollow noreferrer\">docs</a>, these types are defined in <code>windows.h</code>, which that file doesn't include.</p>\n\n<p>Maybe open an issue and wait for an answer from the devs.</p>\n"}], "owner": {"reputation": 103, "user_id": 2210247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff1b34d4d3e1650a0e6a4a5a9cad9727?s=128&d=identicon&r=PG", "display_name": "Mehedee Hassan", "link": "https://stackoverflow.com/users/2210247/mehedee-hassan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484922891, "creation_date": 1479921999, "last_edit_date": 1479927139, "question_id": 40770786, "link": "https://stackoverflow.com/questions/40770786/go-vgo-robotgo-library-build-error", "title": "&quot;go-vgo/robotgo&quot; library build error", "body": "<p>I was trying to build \"<a href=\"https://github.com/go-vgo/robotgo\" rel=\"nofollow noreferrer\">go-vgo/robotgo</a>\" library .</p>\n\n<p>I have followed each step like downloading \"mingw\"(32bit) and adding \"zlib,pnglib\" from \n<a href=\"https://github.com/go-vgo/Mingw32\" rel=\"nofollow noreferrer\">zlib&amp;libpng Windows32 GCC's Course</a> as stated.\nbut when i try to get it from cmd using this command,</p>\n\n<p><code>go get github.com/go-vgo/robotgo</code> </p>\n\n<p>it shows a enormous list of error.</p>\n\n<p>Can anyone help me please.\nI am using windows 10 (64 bit) and go 1.7.3 (x86).</p>\n\n<p>Errors copied from the cmd is given below, </p>\n\n<pre><code>&gt; G:\\ProgramFiles\\Go32&gt;go get github.com/go-vgo/robotgo \\#\n&gt; github.com/go-vgo/robotgo In file included from\n&gt; ./mouse/goMouse.h:12:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:24: ./mouse/mouse_c.h: In function 'moveMouse': ./mouse/mouse_c.h:116:2:\n&gt; error: unknown type name 'INPUT' ./mouse/mouse_c.h:117:12: error:\n&gt; request for member 'type' in something not a structure or union\n&gt; ./mouse/mouse_c.h:117:20: error: 'INPUT_MOUSE' undeclared (first use\n&gt; in this function) ./mouse/mouse_c.h:117:20: note: each undeclared\n&gt; identifier is reported only once for each function it appears in\n&gt; ./mouse/mouse_c.h:118:12: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:119:12: error: request for\n&gt; member 'mi' in something not a structure or union\n&gt; ./mouse/mouse_c.h:120:12: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:121:12: error: request for\n&gt; member 'mi' in something not a structure or union\n&gt; ./mouse/mouse_c.h:122:12: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:123:12: error: request for\n&gt; member 'mi' in something not a structure or union ./mouse/mouse_c.h:\n&gt; In function 'scrollMouse': ./mouse/mouse_c.h:249:3: error: unknown\n&gt; type name 'INPUT' ./mouse/mouse_c.h:293:19: error: request for member\n&gt; 'type' in something not a structure or union ./mouse/mouse_c.h:293:27:\n&gt; error: 'INPUT_MOUSE' undeclared (first use in this function)\n&gt; ./mouse/mouse_c.h:294:19: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:295:19: error: request for\n&gt; member 'mi' in something not a structure or union\n&gt; ./mouse/mouse_c.h:296:19: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:297:19: error: request for\n&gt; member 'mi' in something not a structure or union\n&gt; ./mouse/mouse_c.h:298:19: error: request for member 'mi' in something\n&gt; not a structure or union ./mouse/mouse_c.h:299:19: error: request for\n&gt; member 'mi' in something not a structure or union In file included\n&gt; from ./key/keypress.h:6:0,\n&gt;                  from ./key/keypress_c.h:1,\n&gt;                  from ./key/goKey.h:14,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:25: ./key/keycode.h: At top level: ./key/keycode.h:249:24: error:\n&gt; 'VK_VOLUME_MUTE' undeclared here (not in a function)\n&gt; ./key/keycode.h:250:24: error: 'VK_VOLUME_DOWN' undeclared here (not\n&gt; in a function) ./key/keycode.h:251:22: error: 'VK_VOLUME_UP'\n&gt; undeclared here (not in a function) ./key/keycode.h:252:17: error:\n&gt; 'VK_MEDIA_PLAY_PAUSE' undeclared here (not in a function)\n&gt; ./key/keycode.h:253:17: error: 'VK_MEDIA_STOP' undeclared here (not in\n&gt; a function) ./key/keycode.h:255:17: error: 'VK_MEDIA_PREV_TRACK'\n&gt; undeclared here (not in a function) ./key/keycode.h:256:17: error:\n&gt; 'VK_MEDIA_NEXT_TRACK' undeclared here (not in a function) In file\n&gt; included from ./key/goKey.h:14:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:25: ./key/keypress_c.h: In function 'win32KeyEvent':\n&gt; ./key/keypress_c.h:57:39: error: 'MAPVK_VK_TO_VSC' undeclared (first\n&gt; use in this function) ./key/keypress_c.h:86:8: error:\n&gt; 'VK_BROWSER_BACK' undeclared (first use in this function)\n&gt; ./key/keypress_c.h:87:8: error: 'VK_BROWSER_FORWARD' undeclared (first\n&gt; use in this function) ./key/keypress_c.h:88:8: error:\n&gt; 'VK_BROWSER_REFRESH' undeclared (first use in this function)\n&gt; ./key/keypress_c.h:89:8: error: 'VK_BROWSER_STOP' undeclared (first\n&gt; use in this function) ./key/keypress_c.h:90:8: error:\n&gt; 'VK_BROWSER_SEARCH' undeclared (first use in this function)\n&gt; ./key/keypress_c.h:91:8: error: 'VK_BROWSER_FAVORITES' undeclared\n&gt; (first use in this function) ./key/keypress_c.h:92:8: error:\n&gt; 'VK_BROWSER_HOME' undeclared (first use in this function)\n&gt; ./key/keypress_c.h:93:8: error: 'VK_LAUNCH_MAIL' undeclared (first use\n&gt; in this function) In file included from ./event/goEvent.h:29:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:27: ./event/hook/windows/input_c.h: At top level:\n&gt; ./event/hook/windows/input_c.h:31:27: error: 'VK_OEM_MINUS' undeclared\n&gt; here (not in a function) ./event/hook/windows/input_c.h:32:27: error:\n&gt; 'VK_OEM_PLUS' undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:70:24: error: 'VK_OEM_COMMA' undeclared\n&gt; here (not in a function) ./event/hook/windows/input_c.h:71:24: error:\n&gt; 'VK_OEM_PERIOD' undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:183:28: error: 'VK_LAUNCH_APP2'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:200:30: error: 'VK_BROWSER_HOME'\n&gt; undeclared here (not in a function) In file included from\n&gt; ./event/goEvent.h:29:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:27: ./event/hook/windows/input_c.h:251:32: error: 'VK_BROWSER_SEARCH'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:252:30: error: 'VK_BROWSER_FAVORITES'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:253:30: error: 'VK_BROWSER_REFRESH'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:254:30: error: 'VK_BROWSER_STOP'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:255:30: error: 'VK_BROWSER_FORWARD'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:256:30: error: 'VK_BROWSER_BACK'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:258:30: error: 'VK_LAUNCH_APP1'\n&gt; undeclared here (not in a function)\n&gt; ./event/hook/windows/input_c.h:259:30: error: 'VK_LAUNCH_MEDIA_SELECT'\n&gt; undeclared here (not in a function) In file included from\n&gt; ./event/goEvent.h:30:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:27: ./event/hook/windows/hook_c.h: In function 'initialize_modifiers':\n&gt; ./event/hook/windows/hook_c.h:90:18: error: 'VK_XBUTTON1' undeclared\n&gt; (first use in this function) ./event/hook/windows/hook_c.h:91:18:\n&gt; error: 'VK_XBUTTON2' undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h: In function 'mouse_hook_event_proc':\n&gt; ./event/hook/windows/hook_c.h:509:8: error: 'WM_XBUTTONDOWN'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:510:8: error: 'WM_NCXBUTTONDOWN'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:511:37: error: 'XBUTTON1' undeclared\n&gt; (first use in this function) ./event/hook/windows/hook_c.h:515:42:\n&gt; error: 'XBUTTON2' undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:551:8: error: 'WM_XBUTTONUP' undeclared\n&gt; (first use in this function) ./event/hook/windows/hook_c.h:552:8:\n&gt; error: 'WM_NCXBUTTONUP' undeclared (first use in this function) In\n&gt; file included from ./event/goEvent.h:30:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:27: ./event/hook/windows/hook_c.h: In function 'win_hook_event_proc':\n&gt; ./event/hook/windows/hook_c.h:616:8: error: 'EVENT_OBJECT_NAMECHANGE'\n&gt; undeclared (first use in this function) ./event/hook/windows/hook_c.h:\n&gt; In function 'hook_run': ./event/hook/windows/hook_c.h:684:4: error:\n&gt; 'EVENT_OBJECT_NAMECHANGE' undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:688:4: error: 'WINEVENT_OUTOFCONTEXT'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:688:28: error: 'WINEVENT_SKIPOWNPROCESS'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/hook_c.h:688:26: error: invalid operands to\n&gt; binary | (have 'const uint16_t (*)[2]' and 'const uint16_t (*)[2]') In\n&gt; file included from ./event/goEvent.h:31:0,\n&gt;                  from src\\github.com\\go-vgo\\robotgo\\robotgo.go:27: ./event/hook/windows/event_c.h: In function 'hook_post_event':\n&gt; ./event/hook/windows/event_c.h:57:2: error: unknown type name 'INPUT'\n&gt; ./event/hook/windows/event_c.h:57:32: error: 'INPUT' undeclared (first\n&gt; use in this function) ./event/hook/windows/event_c.h:57:39: error:\n&gt; invalid operands to binary * (have 'const uint16_t (*)[2]' and 'int')\n&gt; ./event/hook/windows/event_c.h:63:24: error: request for member 'type'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:63:32: error: 'INPUT_KEYBOARD'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/event_c.h:64:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:64:27: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:65:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:65:27: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:66:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:66:27: error: request for member 'time'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:73:22: error: request for member 'type'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:73:30: error: 'INPUT_MOUSE' undeclared\n&gt; (first use in this function) ./event/hook/windows/event_c.h:74:22:\n&gt; error: request for member 'mi' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:74:25: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:75:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:75:25: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:76:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:76:25: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:77:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:77:25: error: request for member 'time'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:80:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:80:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:84:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:84:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:88:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:88:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:92:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:92:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:92:39: error: 'XBUTTON1' undeclared\n&gt; (first use in this function) ./event/hook/windows/event_c.h:93:23:\n&gt; error: request for member 'mi' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:93:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:93:40: error: 'MOUSEEVENTF_XDOWN'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/event_c.h:97:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:97:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:97:39: error: 'XBUTTON2' undeclared\n&gt; (first use in this function) ./event/hook/windows/event_c.h:98:23:\n&gt; error: request for member 'mi' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:98:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:107:23: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:107:26: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:108:27: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:108:30: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:109:24: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:110:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:110:27: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:111:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:111:27: error: request for member\n&gt; 'wScan' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:112:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:112:27: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:123:23: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:123:26: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:124:27: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:124:30: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:125:24: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:126:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:126:27: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:127:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:127:27: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:128:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:128:27: error: request for member\n&gt; 'wScan' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:129:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:129:27: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:141:23: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:142:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:142:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:146:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:146:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:150:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:150:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:154:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:154:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:158:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:158:28: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:162:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:162:28: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:168:26: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:168:29: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:172:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:172:26: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:173:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:173:26: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:175:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:175:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:176:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:176:26: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:182:23: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:183:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:183:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:183:37: error: 'MOUSEEVENTF_XUP'\n&gt; undeclared (first use in this function)\n&gt; ./event/hook/windows/event_c.h:187:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:187:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:191:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:191:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:195:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:195:28: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:199:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:199:28: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:203:25: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:203:28: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:209:26: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:209:29: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:213:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:213:26: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:214:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:214:26: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:216:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:216:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:217:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:217:26: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:223:23: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:224:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:224:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:227:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:227:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:229:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:229:26: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:230:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:230:26: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:232:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:232:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:233:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:233:26: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:242:23: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:243:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:243:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:245:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:245:26: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:246:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:246:26: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:248:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:248:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:249:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:249:26: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:274:24: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:275:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:275:27: error: request for member 'wVk'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:276:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:276:27: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:277:24: error: request for member 'ki'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:277:27: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:284:22: error: request for member\n&gt; 'type' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:285:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:285:25: error: request for member 'dx'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:286:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:286:25: error: request for member 'dy'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:287:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:287:25: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:288:22: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:288:25: error: request for member\n&gt; 'time' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:294:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:294:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:298:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:298:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:302:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:302:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:306:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:306:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:307:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:307:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:311:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:311:26: error: request for member\n&gt; 'mouseData' in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:312:23: error: request for member 'mi'\n&gt; in something not a structure or union\n&gt; ./event/hook/windows/event_c.h:312:26: error: request for member\n&gt; 'dwFlags' in something not a structure or union\n&gt; \n&gt; G:\\ProgramFiles\\Go32&gt;go get github.com/go-vgo/robotgo\n</code></pre>\n"}, {"tags": ["json", "elasticsearch", "go"], "answers": [{"tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": false, "score": 1, "last_activity_date": 1479924429, "creation_date": 1479924429, "answer_id": 40771454, "question_id": 40769798, "link": "https://stackoverflow.com/questions/40769798/how-to-deserialize-hit-source-into-a-struct-in-golang/40771454#40771454", "title": "How to Deserialize hit.Source into a struct in golang", "body": "<p>Well, you are Unmarshalling your data into the document struct, if you want to print it as raw json you can simply Marshal it again, so only the tags you specified in your Document struct are show.</p>\n\n<p>If you want the output to be a json array, just store all your Documents into a slice and then Marshal the whole thing</p>\n\n<pre><code>var documents []Document\nfor (...) {\n    (...)\n    documents = append(documents, d)\n}\n\nrawJsonDocuments, err := json.Marshal(documents)\nfmt.Printf(\"%v\", string(rawJsonDocuments) )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 213, "user_id": 442008, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d6ff846a79ee3dbf5c815150537fe573?s=128&d=identicon&r=PG", "display_name": "Sanx", "link": "https://stackoverflow.com/users/442008/sanx"}, "is_accepted": false, "score": 0, "last_activity_date": 1479985144, "creation_date": 1479985144, "answer_id": 40784647, "question_id": 40769798, "link": "https://stackoverflow.com/questions/40769798/how-to-deserialize-hit-source-into-a-struct-in-golang/40784647#40784647", "title": "How to Deserialize hit.Source into a struct in golang", "body": "<p>I found the next solution:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  j \"github.com/ricardolonga/jsongo\"\n  \"gopkg.in/olivere/elastic.v3\"\n)\n\nfunc main() {\n\n  term := \"villa de cortes\"\n\n  searchJson := j.Object().\n    Put(\"size\", 10).\n    Put(\"query\", j.Object().\n      Put(\"match\", j.Object().\n        Put(\"_all\", j.Object().\n          Put(\"query\", term).\n          Put(\"operator\", \"and\")))).\n    Put(\"sort\", j.Array().\n      Put(j.Object().\n        Put(\"colonia\", j.Object().\n          Put(\"order\", \"asc\").\n          Put(\"mode\", \"avg\"))))\n\n  elasticHost := \"http://172.17.0.2:9200\"\n\n  client, err := elastic.NewClient(elastic.SetURL(elasticHost))\n  if err != nil {\n      panic(err)\n  }\n\n  searchResult, err := client.Search().\n      Index(\"mx\").\n      Type(\"postal_code\").\n      Source(searchJson).\n      Pretty(true). \n      Do()\n  if err != nil {\n      panic(err)\n  }\n\n  if searchResult.Hits.TotalHits &gt; 0 {\n\n    jsonArray := j.Array()\n    for _, hit := range searchResult.Hits.Hits {\n      jsonArray.Put(hit.Source)   \n    }\n\n    fmt.Print(jsonArray.Indent())\n\n  } else {\n    fmt.Print(\"Found no documents\\n\")\n  }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 442008, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/d6ff846a79ee3dbf5c815150537fe573?s=128&d=identicon&r=PG", "display_name": "Sanx", "link": "https://stackoverflow.com/users/442008/sanx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479985144, "creation_date": 1479919001, "question_id": 40769798, "link": "https://stackoverflow.com/questions/40769798/how-to-deserialize-hit-source-into-a-struct-in-golang", "title": "How to Deserialize hit.Source into a struct in golang", "body": "<p>i have been using this repository:</p>\n\n<p><a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">https://github.com/olivere/elastic</a></p>\n\n<p>The next code is a example of elasticsearch query in golang :</p>\n\n<pre><code>  searchResult, err := client.Search().\n      Index(\"mx\").\n      Type(\"postal_code\").\n      Source(searchJson).\n      Pretty(true). \n      Do()\n  if err != nil {\n      panic(err)\n  }\n\n  if searchResult.Hits.TotalHits &gt; 0 {\n\n    for _, hit := range searchResult.Hits.Hits {\n      var d Document\n      err := json.Unmarshal(*hit.Source, &amp;d)\n      if err != nil {\n        // Deserialization failed\n      }\n\n      fmt.Printf(\"Document by %s: %s\\n\", d.Colonia, d.Ciudad)\n\n    }\n\n  } else {\n    fmt.Print(\"Found no documents\\n\")\n  }\n</code></pre>\n\n<p>this works fine, the out is something like this:</p>\n\n<pre><code>Document by Villa de Cortes: Distrito Federal\nDocument by Villa de Cortes: Sinaloa\nDocument by Villa de Cortes: Sinaloa\n</code></pre>\n\n<p>But i need the out like json array, something like this:</p>\n\n<pre><code>[\n  {\n\n      \"cp\": \"03530\",\n      \"colonia\": \"Villa de Cortes\",\n      \"ciudad\": \"Distrito Federal\",\n      \"delegacion\": \"Benito Juarez\",\n      \"location\": {\n        \"lat\": \"19.3487\",\n        \"lon\": \"-99.166\"\n      }\n  },\n  {\n\n      \"cp\": \"81270\",\n      \"colonia\": \"Villa de Cortes\",\n      \"ciudad\": \"Sinaloa\",\n      \"delegacion\": \"Ahome\",\n      \"location\": {\n        \"lat\": \"25.1584\",\n        \"lon\": \"-107.7063\"\n      }\n  },\n  {\n      \"cp\": \"80140\",\n      \"colonia\": \"Villa de Cortes\",\n      \"ciudad\": \"Sinaloa\",\n      \"delegacion\": \"Culiacan\",\n      \"location\": {\n        \"lat\": \"25.0239\",\n        \"lon\": \"-108.032\"\n      }\n  }\n]\n</code></pre>\n\n<p>How can i to deserialize hit.Source into a Document struct?</p>\n\n<pre><code>type Document struct {\n  Ciudad     string `json:\"ciudad\"`\n  Colonia    string `json:\"colonia\"`\n  Cp         string `json:\"cp\"`\n  Delegacion string `json:\"delegacion\"`\n  Location   struct {\n    Lat string `json:\"lat\"`\n    Lon string `json:\"lon\"`\n  } `json:\"location\"`\n}\n</code></pre>\n\n<p>Here is the full source code of the script:</p>\n\n<p><a href=\"https://gist.github.com/hectorgool/67730c8a72f2d34b09e5a8888987ea0c\" rel=\"nofollow noreferrer\">https://gist.github.com/hectorgool/67730c8a72f2d34b09e5a8888987ea0c</a></p>\n"}, {"tags": ["mongodb", "go", "gridfs", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 228, "user_id": 2805425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/501ea501f203bd5f4e0f7bce426017c5?s=128&d=identicon&r=PG", "display_name": "Da Gopherboy", "link": "https://stackoverflow.com/users/2805425/da-gopherboy"}, "is_accepted": false, "score": 1, "last_activity_date": 1479917669, "last_edit_date": 1495542270, "creation_date": 1479917669, "answer_id": 40769313, "question_id": 40769231, "link": "https://stackoverflow.com/questions/40769231/how-to-upload-pictures-into-mongodb-using-golang/40769313#40769313", "title": "how to upload pictures into mongodb using golang", "body": "<p>You may want to read some of the documentation on the <a href=\"https://labix.org/mgo\" rel=\"nofollow noreferrer\">mgo</a> driver.  Specifically under the gridfs section which covers how to store files in MongoDB.  Examples are also available on the mgo website.</p>\n\n<p>Also similar questions have been asked on stack already such as: <a href=\"https://stackoverflow.com/questions/22159665/store-uploaded-file-in-mongodb-gridfs-using-mgo-without-saving-to-memory\">Store Uploaded File in MongoDB GridFS Using mgo without Saving to Memory</a></p>\n"}], "owner": {"reputation": 325, "user_id": 3337007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/3f90dd0966f7cbe2a5ee67634aa227fd?s=128&d=identicon&r=PG&f=1", "display_name": "DevRight", "link": "https://stackoverflow.com/users/3337007/devright"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479917669, "creation_date": 1479917372, "question_id": 40769231, "link": "https://stackoverflow.com/questions/40769231/how-to-upload-pictures-into-mongodb-using-golang", "title": "how to upload pictures into mongodb using golang", "body": "<p>Any ideas on how to upload picture files into Mongodb using Golang. I have done  research and I can find lots of examples with many diiferent languages, but none for Go. Any links for blogs or tutorials would be great help. Thanks.</p>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1479911697, "post_id": 40767218, "comment_id": 68758482, "body": "Yes: Do not produce garbage. How? Measure your allocations and get rid of the most ugly ones."}, {"owner": {"reputation": 1277, "user_id": 1737811, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/ab510b7d0d145c538fcc7638395ee703?s=128&d=identicon&r=PG", "display_name": "mutantkeyboard", "link": "https://stackoverflow.com/users/1737811/mutantkeyboard"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479912861, "post_id": 40767218, "comment_id": 68759283, "body": "@Volker this is the answer in Go fashion :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479913391, "post_id": 40767218, "comment_id": 68759656, "body": "What exactly is your question, since you&#39;re linking to the same question which already has multiple answers?"}, {"owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1479914982, "post_id": 40767218, "comment_id": 68760749, "body": "For example, does it help to allocate contiguous blocks of memory, allocate bigger chunks upfront, or reduce the number different variables created in order to make garbage collection go faster?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479915554, "post_id": 40767218, "comment_id": 68761134, "body": "The only thing that really helps is: Measure it."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1530651857, "creation_date": 1530651857, "answer_id": 51162788, "question_id": 40767218, "link": "https://stackoverflow.com/questions/40767218/best-practices-to-minimize-garbage-collection-hiccups-in-go/51162788#51162788", "title": "best practices to minimize garbage collection hiccups in Go", "body": "<p>\"<a href=\"https://stackoverflow.com/a/24865558/6309\">how to analyse golang memory</a>\" gives some criteria, but the best approach remains to measure:</p>\n\n<ul>\n<li>\"<a href=\"https://dave.cheney.net/2014/07/11/visualising-the-go-garbage-collector\" rel=\"nofollow noreferrer\">Visualising the Go garbage collector</a>\"</li>\n<li>\"<a href=\"https://github.com/golang/go/wiki/Performance#garbage-collector-trace\" rel=\"nofollow noreferrer\">Garbage Collector Trace</a>\": <code>GODEBUG=gctrace=1 ./myserver</code></li>\n</ul>\n"}], "owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1530651857, "creation_date": 1479911616, "last_edit_date": 1495535415, "question_id": 40767218, "link": "https://stackoverflow.com/questions/40767218/best-practices-to-minimize-garbage-collection-hiccups-in-go", "title": "best practices to minimize garbage collection hiccups in Go", "body": "<p>The below article talks about minimizing garbage collection. Are there any best practices from a programmers perspective to make garbage collection efficient in Go?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12277426/how-to-minimize-the-garbage-collection-in-go\">How to minimize the garbage collection in Go?</a></p>\n"}, {"tags": ["go", "gremlin", "gremlin-server"], "answers": [{"tags": [], "owner": {"reputation": 2221, "user_id": 6753576, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Hz05.jpg?s=128&g=1", "display_name": "Florian Hockmann", "link": "https://stackoverflow.com/users/6753576/florian-hockmann"}, "is_accepted": false, "score": 1, "last_activity_date": 1479913642, "creation_date": 1479913642, "answer_id": 40767923, "question_id": 40766988, "link": "https://stackoverflow.com/questions/40766988/how-to-create-graph-traversal-in-dse-graph-using-golang/40767923#40767923", "title": "How to create graph traversal in dse graph using golang", "body": "<p>DSE Graph requires you to pass an alias with your request to bind <code>g</code> to <code>test_graph.g</code> where <code>test_graph</code> is the name of your graph. There is already an issue for go-gremlin that explains how to do that: <a href=\"https://github.com/go-gremlin/gremlin/issues/4\" rel=\"nofollow noreferrer\">https://github.com/go-gremlin/gremlin/issues/4</a></p>\n"}], "owner": {"reputation": 1, "user_id": 7132121, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-u7P712RvA1w/AAAAAAAAAAI/AAAAAAAAIMU/a19L_vmumkU/photo.jpg?sz=128", "display_name": "satyajit mohapatra", "link": "https://stackoverflow.com/users/7132121/satyajit-mohapatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479913642, "creation_date": 1479910910, "question_id": 40766988, "link": "https://stackoverflow.com/questions/40766988/how-to-create-graph-traversal-in-dse-graph-using-golang", "title": "How to create graph traversal in dse graph using golang", "body": "<p>Is there any other way to connect to gremlin server from console without using :remote.</p>\n\n<p>I am using GOLANG to talk to DSE graph. Datastax doesn't provide driver for golang so i am forced use gremlin server to send gremlin queries (there are few GREMLIN plugins for go-gremlin and gremgo). I can create graph using system.graph('test_graph').create() but i am not finding any way to get g for traversing the graph.</p>\n"}, {"tags": ["arrays", "go", "intercept"], "comments": [{"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "edited": false, "score": 0, "creation_date": 1479910709, "post_id": 40766824, "comment_id": 68757782, "body": "These are <code>slice</code>, not array !"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479910782, "post_id": 40766824, "comment_id": 68757849, "body": "Stuff the strings of the shorter slice into a map as the keys for O(1) lookup of existence and iterate the longer slice looking up the values in the map appending to the result set if found. Requires more memory than your approach. Tradeoffs as usual."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1479911416, "post_id": 40766824, "comment_id": 68758289, "body": "Related / possible duplicates: <a href=\"http://stackoverflow.com/a/30452518/1705598\">Check if a value is in a list</a>; and <a href=\"http://stackoverflow.com/a/33207265/1705598\">How can I create an array that contains unique strings?</a>; and <a href=\"http://stackoverflow.com/a/39249045/1705598\">Efficient way to check IP in slice of IP addresses in Golang</a>; and <a href=\"http://stackoverflow.com/a/34111576/1705598\">Finding Unique Items in a Go Slice or Array</a>"}], "answers": [{"comments": [{"owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "edited": false, "score": 0, "creation_date": 1479921957, "post_id": 40769492, "comment_id": 68765272, "body": "How is performance for large set of data using this..Is that reason to use map."}, {"owner": {"reputation": 609, "user_id": 4242336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlAOL.jpg?s=128&g=1", "display_name": "PapEr", "link": "https://stackoverflow.com/users/4242336/paper"}, "reply_to_user": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "edited": false, "score": 0, "creation_date": 1479951541, "post_id": 40769492, "comment_id": 68777193, "body": "@SandunPriyanka The time complexity is O(n), which is much better than the one you posted at O(n^2). The only problem is that it will take more memory. Using empty struct can save some memory"}, {"owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "edited": false, "score": 0, "creation_date": 1479964110, "post_id": 40769492, "comment_id": 68780303, "body": "Thanks for the help."}], "tags": [], "owner": {"reputation": 609, "user_id": 4242336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlAOL.jpg?s=128&g=1", "display_name": "PapEr", "link": "https://stackoverflow.com/users/4242336/paper"}, "is_accepted": true, "score": 2, "last_activity_date": 1479918202, "creation_date": 1479918202, "answer_id": 40769492, "question_id": 40766824, "link": "https://stackoverflow.com/questions/40766824/how-to-finding-result-of-intercept-of-two-slices-in-golang/40769492#40769492", "title": "How to finding result of intercept of two slices in golang", "body": "<pre><code>firstSlice := []string{\"F8-E7-1E-14-AE-00\", \"F8-E7-1E-14-D0-30\",\n    \"84-18-3A-2F-05-E0\", \"84-18-3A-2F-05-E8\"}\nsecondSlice := []string{\"F8-E7-1E-14-D0-30\", \"84-18-3A-2F-05-E8\",\n    \"F8-E7-1E-54-AE-08\"}\n\nresultSlice := []string{}\ncheckMap := map[string]struct{}{}\n\nfor _, addr := range firstSlice {\n    checkMap[addr] = struct{}{}\n}\nfor _, addr := range secondSlice {\n    if _, ok := checkMap[addr]; ok {\n        resultSlice = append(resultSlice, addr)\n    }\n}\n\nfmt.Println(resultSlice)\n</code></pre>\n\n<hr>\n\n<p>The output is what you want.</p>\n\n<p>An empty struct takes no space in monery</p>\n\n<p>What's more, always use camel in golang.</p>\n"}], "owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 40769492, "answer_count": 1, "score": 0, "last_activity_date": 1479922181, "creation_date": 1479910494, "last_edit_date": 1479922181, "question_id": 40766824, "link": "https://stackoverflow.com/questions/40766824/how-to-finding-result-of-intercept-of-two-slices-in-golang", "title": "How to finding result of intercept of two slices in golang", "body": "<p>There is two slices in string type.I want to finding intercept result in set from the two slices in golang.I want to find the best solution rather than iterating each slice.</p>\n\n<pre><code>first_slice := []string{\"F8-E7-1E-14-AE-00\", \"F8-E7-1E-14-D0-30\", \"84-18-3A-2F-05-E0\",\"84-18-3A-2F-05-E8\" } \nsecond_slice := []string{\"F8-E7-1E-14-D0-30\", \"84-18-3A-2F-05-E8\",\"F8-E7-1E-54-AE-08\"}\n\n\nOutput:\n    result_slice := []string{\"F8-E7-1E-14-D0-30\", \"84-18-3A-2F-05-E8\"}\n</code></pre>\n\n<p>I have use following  approaches but it is not best approaches for large data set.</p>\n\n<pre><code>var result_slice *[]string\n\nfor _, i := range first_slice {\n    for _, x := range second_slice {\n        if i == x {\n            &amp;result_slice.append(i)\n        }\n    }\n}\n</code></pre>\n\n<p>Appreciate if give me good solution that.</p>\n"}, {"tags": ["arrays", "pointers", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479898752, "post_id": 40762417, "comment_id": 68749576, "body": "This is all explained very nice in the Tour of Go (<a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">tour.golang.org</a>) and the blog posts about arrays <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a> and slices <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">blog.golang.org/go-slices-usage-and-internals</a>. Short answer: <code>b := a</code> make a copy always. There are no immutable types in Go. 2) Undable with arrays, that&#39;s what slices are for. 3) <code>[]int</code> is a slice and <code>[3]int</code> an array. Please read <a href=\"https://tour.golang.org/moretypes/6\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/6</a> and the followig slides carefully."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1479967204, "last_edit_date": 1495535580, "creation_date": 1479898658, "answer_id": 40762540, "question_id": 40762417, "link": "https://stackoverflow.com/questions/40762417/array-address-when-copying-variables/40762540#40762540", "title": "Array address when copying variables", "body": "<p><code>[3]int</code> is an <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"nofollow noreferrer\">array</a>, <code>[]int</code> is a <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">slice</a>.</p>\n\n<p>An array means all its elements, when passing it around or assigning it, all its elements are copied.</p>\n\n<p>Slices are small, struct-like descriptors pointing to a contigous section of an underlying array. When passed around or assigned, only this header is copied (including the pointer), and so the \"new\" slice will point to the same backing array.</p>\n\n<p>To answer your exact questions:</p>\n\n<ol>\n<li><p>Yes, <code>b := a</code> copies all elements if <code>a</code> is an array, but only the header if <code>a</code> is a slice. Both safe as long as only 1 goroutine accesses (modifies) <code>a</code>, and none is safe if multiple goroutines may modify it.</p></li>\n<li><p>If an array is copied, it will be completely independent from the \"original\", modifying the copy will have no effect on the original. If a slice is copied, the copy will point to the same backing array where the elements are stored. If you modify an element via the copy slice, you modify the one and only element, and so checking it via the original slice you will just check the only \"instance\" of the element (and observe the modified value).</p></li>\n<li><p>This is in the first sentence: <code>[]int</code> is a slice, <code>[n]int</code> is an array.</p></li>\n</ol>\n\n<p><strong>See related questions:</strong></p>\n\n<p><a href=\"https://stackoverflow.com/questions/38645175/why-have-arrays-in-go/38645895#38645895\">Why have arrays in Go?</a><br>\n<a href=\"https://stackoverflow.com/questions/40514555/golang-passing-arrays-to-the-function-and-modifying-it/40514753#40514753\">Golang passing arrays to the function and modifying it</a></p>\n\n<p><strong>Read the following blog posts for more details on slices and arrays:</strong></p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a><br>\n<a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}], "owner": {"reputation": 117, "user_id": 3746949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8209cd3f2211066ddf31eb9b1040b3c2?s=128&d=identicon&r=PG&f=1", "display_name": "Yuguang", "link": "https://stackoverflow.com/users/3746949/yuguang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1479967204, "creation_date": 1479898367, "last_edit_date": 1479899035, "question_id": 40762417, "link": "https://stackoverflow.com/questions/40762417/array-address-when-copying-variables", "title": "Array address when copying variables", "body": "<p>I want to explore something about how the memory is allocated when we try to copy a variable. I did some tests and this one confuses me:</p>\n\n<pre><code>func testArrayAddress() {\n    var a [3]int\n    b := a\n    fmt.Printf(\"address of a %p and of b %p \\n\", &amp;(a[0]), &amp;(b[0]))\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>address of a 0xc8200126e0 and of b 0xc820012700\n</code></pre>\n\n<p>However as I assume a and b and pointing to the same array so the starting address of the first element should be the same?</p>\n\n<p>This made me doubt that what happened when we exec the statement <code>b := a</code>? Originally I thought it will just allocate one memory block for the array when we init variable <code>a</code>, and <code>b := a</code> makes <code>b</code> pointing to the same memory location, but then it cannot explain why the address of the first element is not the same (which should be same element).</p>\n\n<p>I changed the first line of code:</p>\n\n<pre><code>func testArrayAddress() {\n    var a = []int{1, 2, 3}\n    b := a\n    fmt.Printf(\"address of a's first element %p and of b %p \\n\", &amp;(a[0]), &amp;(b[0]))\n}\n</code></pre>\n\n<p>Then the output is:</p>\n\n<pre><code>address of a's first element 0xc8200126e0 and of b 0xc8200126e0\n</code></pre>\n\n<p>It gives me the same result now.</p>\n\n<p>The question I want to ask are:</p>\n\n<ol>\n<li><p>In Golang when we do variable copy (<code>b := a</code>), are we also creating a copy of data in the memory? And is it the same for both immutable and mutable type?</p></li>\n<li><p>If we are copying for mutable type (eg. array) as well, how it manages to achieve modifying variable will also affects others (<code>a[0] = 42</code> will affect <code>b[0]</code>)?</p></li>\n<li><p>How is <code>[]int</code> type different from <code>[number]int</code> type which I tested in the last case?</p></li>\n</ol>\n"}, {"tags": ["string", "go", "trim"], "comments": [{"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 3, "creation_date": 1479893594, "post_id": 40760490, "comment_id": 68745917, "body": "<a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#Replace</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 0, "creation_date": 1479895442, "post_id": 40760694, "comment_id": 68747172, "body": "Somehow I did missed the &#39;leading and trailing&#39; par, Thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 60, "last_activity_date": 1591389371, "last_edit_date": 1591389371, "creation_date": 1479893909, "answer_id": 40760694, "question_id": 40760490, "link": "https://stackoverflow.com/questions/40760490/how-to-trim-char-from-a-string-in-golang/40760694#40760694", "title": "How to Trim &quot;[&quot; char from a string in Golang", "body": "<p>You are missing reading the doc. <a href=\"https://golang.org/pkg/strings/#Trim\" rel=\"noreferrer\"><code>strings.Trim()</code></a>:</p>\n\n<blockquote>\n<pre><code>func Trim(s string, cutset string) string\n</code></pre>\n  \n  <p>Trim returns a slice of the string s with all <strong>leading and trailing</strong> Unicode code points contained in cutset removed.</p>\n</blockquote>\n\n<p>The <code>[</code> character in your input is not in a <em>leading</em> nor in a <em>trailing</em> position, it is in the <em>middle</em>, so <code>strings.Trim()</code> \u2013 being well behavior \u2013 will not remove it.</p>\n\n<p>Try <a href=\"https://golang.org/pkg/strings/#Replace\" rel=\"noreferrer\"><code>strings.Replace()</code></a> instead:</p>\n\n<pre><code>s := \"this[things]I would like to remove\"\nt := strings.Replace(s, \"[\", \"\", -1)\nfmt.Printf(\"%s\\n\", t)   \n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/1_78sBjk0C\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>thisthings]I would like to remove\n</code></pre>\n\n<p>There is also a <a href=\"https://golang.org/pkg/strings/#ReplaceAll\" rel=\"noreferrer\"><code>strings.ReplaceAll()</code></a> added in Go 1.12 (which is basically a \"shorthand\" for <code>Replace(s, old, new, -1)</code>).</p>\n"}], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62054, "favorite_count": 3, "accepted_answer_id": 40760694, "answer_count": 1, "score": 33, "last_activity_date": 1591389371, "creation_date": 1479893321, "last_edit_date": 1479894061, "question_id": 40760490, "link": "https://stackoverflow.com/questions/40760490/how-to-trim-char-from-a-string-in-golang", "title": "How to Trim &quot;[&quot; char from a string in Golang", "body": "<p>Probably a silly thing but got stuck on it for a bit...</p>\n\n<p>Can't trim a <code>\"[\"</code> char from a string, things I tried with outputs:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    s := \"this[things]I would like to remove\"\n    t := strings.Trim(s, \"[\")\n\n    fmt.Printf(\"%s\\n\", t)   \n}\n\n// output: this[things]I would like to remove\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cZNwX4fsrw\" rel=\"noreferrer\">go playground</a></p>\n\n<p>Also tried all of those, with no success:</p>\n\n<pre><code>s := \"this [ things]I would like to remove\"\nt := strings.Trim(s, \" [ \")\n// output: this [ things]I would like to remove\n\n\ns := \"this [ things]I would like to remove\"\nt := strings.Trim(s, \"[\")\n// output: this [ things]I would like to remove\n</code></pre>\n\n<p>None worked. What am I missing here?</p>\n"}, {"tags": ["c++", "templates", "go"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1479886750, "post_id": 40758497, "comment_id": 68741973, "body": "thank you very much , according to my code , which way do you prefer most"}, {"owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1479886895, "post_id": 40758497, "comment_id": 68742049, "body": "and what is  non-empty interfaces"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "edited": false, "score": 0, "creation_date": 1479887630, "post_id": 40758497, "comment_id": 68742423, "body": "Non-empty interfaces are interfaces with methods. See e.g. <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a>. I can&#39;t tell you which is the best way because there is no good way. I&#39;d say, start with <code>interface{}</code> and go from there."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1479886438, "creation_date": 1479886438, "answer_id": 40758497, "question_id": 40757832, "link": "https://stackoverflow.com/questions/40757832/how-to-implement-c-templatet-in-golang/40758497#40758497", "title": "How to implement c++ template&lt;T&gt; in golang", "body": "<p>Go doesn't support templates or generics. There are three things you can do:</p>\n\n<ul>\n<li>use non-empty interfaces where applicable</li>\n<li>generate code with <code>go generate</code></li>\n<li><p>use <code>interface{}</code>:</p>\n\n<pre><code>type GoTemp struct {\n    a interface{}\n}\n\nfunc (gt *GoTemp) foo(v interface{}) {\n    // ...\n}\n\nfunc foo2(v interface{}) {\n    // ...\n}\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 113, "user_id": 4002702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4c995ad0bf81e069876f183eca38fb10?s=128&d=identicon&r=PG&f=1", "display_name": "hui zhang", "link": "https://stackoverflow.com/users/4002702/hui-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1580, "favorite_count": 1, "closed_date": 1480044689, "accepted_answer_id": 40758497, "answer_count": 1, "score": 0, "last_activity_date": 1479886438, "creation_date": 1479883870, "question_id": 40757832, "link": "https://stackoverflow.com/questions/40757832/how-to-implement-c-templatet-in-golang", "closed_reason": "Needs more focus", "title": "How to implement c++ template&lt;T&gt; in golang", "body": "<p>How to translate this cpp code to golang ?</p>\n\n<pre><code>template&lt;T&gt; class CppTemp {\n    T  a;\n    T* pa;\n    T foo(T &amp;t);\n};\n\ntemplate&lt;T&gt; T foo2(const T &amp;t)\n</code></pre>\n"}, {"tags": ["logging", "go", "supervisord"], "answers": [{"comments": [{"owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "edited": false, "score": 0, "creation_date": 1479976914, "post_id": 40766596, "comment_id": 68786054, "body": "Is that possible that logrotate setting will interfere with supervisord? I am doubting logrotate is interfering"}, {"owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "reply_to_user": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "edited": false, "score": 0, "creation_date": 1480080765, "post_id": 40766596, "comment_id": 68833177, "body": "I don&#39;t think it&#39;s possible that it would prevent supervisor from writing logs."}], "tags": [], "owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "is_accepted": false, "score": 1, "last_activity_date": 1479909916, "creation_date": 1479909916, "answer_id": 40766596, "question_id": 40755404, "link": "https://stackoverflow.com/questions/40755404/supervisor-does-not-write-more-log/40766596#40766596", "title": "supervisor does not write more log", "body": "<p>There could be multiple reasons for supervisor not being able to write the log files. </p>\n\n<ol>\n<li>Maybe you already created the log file with different permissions that don't allow supervisor to write in there.</li>\n<li>When you don't specify <code>stdout_logfile</code> and <code>stderr_logfile</code> in your application's configuration, supervisor will append a unique ID at the end of the log file name.</li>\n<li>Supervisor only writes what's being sent to <code>stdout</code> and <code>stderr</code>. Are you sure you're not writing somewhere else ?</li>\n</ol>\n\n<p>Also make sure to have a look inside the <code>/var/log/supervisor/supervisord.log</code> file, maybe there are errors you're unaware of. </p>\n\n<p>Also make sure you read the documentation about child process logging <a href=\"http://supervisord.org/logging.html\" rel=\"nofollow noreferrer\" title=\"there\">there</a>.</p>\n"}], "owner": {"reputation": 1001, "user_id": 4160965, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/fbb0ff599a13cc579cbac731d8d38a81?s=128&d=identicon&r=PG&f=1", "display_name": "want_to_be_calm", "link": "https://stackoverflow.com/users/4160965/want-to-be-calm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3574, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479909916, "creation_date": 1479870954, "question_id": 40755404, "link": "https://stackoverflow.com/questions/40755404/supervisor-does-not-write-more-log", "title": "supervisor does not write more log", "body": "<p>I am using supervisord to deploy my go application, and I have a /var/log/supervisor directory, which is the directory of application log. However, I found after certain times. No new log is write to the application log. Seems supervisord cannot write to the file. What can be the reason causing it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1512577090, "post_id": 40755315, "comment_id": 82316818, "body": "Check out, may help: <a href=\"https://blog.learngoprogramming.com/golang-defer-simplified-77d3b2b817ff\" rel=\"nofollow noreferrer\">blog.learngoprogramming.com/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 47233, "user_id": 119081, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4fa5be67e1e4b49c0765d218cfe7689b?s=128&d=identicon&r=PG", "display_name": "Blixt", "link": "https://stackoverflow.com/users/119081/blixt"}, "is_accepted": false, "score": 10, "last_activity_date": 1479872456, "last_edit_date": 1479872456, "creation_date": 1479870813, "answer_id": 40755384, "question_id": 40755315, "link": "https://stackoverflow.com/questions/40755315/how-to-understand-defer-in-go-language/40755384#40755384", "title": "How to understand `defer` in go language?", "body": "<p>Note the part that says \"may read and assign to the returning function's <strong>named return values</strong>.\"</p>\n\n<p>This means that:</p>\n\n<pre><code>func b() int {\n    var i int\n    defer func() { fmt.Println(i); i++ }()\n    return i\n}\n</code></pre>\n\n<p>will say <code>0</code> and <code>result = 0</code>, while:</p>\n\n<pre><code>func b() (i int) {\n    defer func() { fmt.Println(i); i++ }()\n    return i\n}\n</code></pre>\n\n<p>will say <code>0</code> and <code>result = 1</code>.</p>\n\n<p>It might help to imagine that the <code>return i</code> in my first example assigns the <code>i</code> value to a hidden return variable (because it's not named), then goes on to execute the <code>defer</code> statements (which only modify the local variable <code>i</code>), while in the second example we assign directly to the return variable (because it's named) and so the <code>defer</code> statement is able to change it.</p>\n\n<p>Basically your program could be interpreted like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc b() (hiddenVariable int) {\n    i := 0\n    for ; i &lt; 4; i++ {\n        defer func() { fmt.Println(i); i++ }()\n    }\n    hiddenVariable = i; return // implicit meaning of return i\n}\n\nfunc main() {\n    fmt.Println(\"result = \", b())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4564293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EtNoI.gif?s=128&g=1", "display_name": "PC Princess", "link": "https://stackoverflow.com/users/4564293/pc-princess"}, "is_accepted": false, "score": 0, "last_activity_date": 1479870906, "creation_date": 1479870906, "answer_id": 40755397, "question_id": 40755315, "link": "https://stackoverflow.com/questions/40755315/how-to-understand-defer-in-go-language/40755397#40755397", "title": "How to understand `defer` in go language?", "body": "<p>Based solely on what I learned about defer and after looking at your code, I'd like to say that the for loop defers the print out of subsequent 'i's until later, however, the for loop still runs and therefore affects the 'i' returned by \nfunc b(), which is 4.</p>\n\n<pre><code>for ; i &lt; 4; i++ {\n    defer func() {fmt.Println(i); i++} ()\n}\nreturn i\n</code></pre>\n\n<p>Because the print statement and it's 'value' for 'i' is deferred, they increment beyond 4, but the 'i' after the for loop remains at 4.</p>\n"}, {"tags": [], "owner": {"reputation": 157, "user_id": 1229135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03a6cceffa5333f338fa79f69ffb219?s=128&d=identicon&r=PG", "display_name": "jackbean818", "link": "https://stackoverflow.com/users/1229135/jackbean818"}, "is_accepted": false, "score": 0, "last_activity_date": 1502135263, "creation_date": 1502135263, "answer_id": 45554642, "question_id": 40755315, "link": "https://stackoverflow.com/questions/40755315/how-to-understand-defer-in-go-language/45554642#45554642", "title": "How to understand `defer` in go language?", "body": "<p><code>A defer statement pushes a function call onto a list. The list of saved calls is executed after the surrounding function returns.</code> Your <strong>func b()</strong> is semantically equivalent to:</p>\n\n<pre><code>func b() int {\n    i := 0\n    for ; i &lt; 4; i++ {\n    }\n    ret := i\n    fmt.Println(i); i++\n    fmt.Println(i); i++\n    fmt.Println(i); i++\n    fmt.Println(i); i++\n    return ret\n}\n</code></pre>\n\n<p>Ergo b() returns 4.</p>\n"}], "owner": {"reputation": 8978, "user_id": 2223579, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wQuP6.jpg?s=128&g=1", "display_name": "BlackMamba", "link": "https://stackoverflow.com/users/2223579/blackmamba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1502135263, "creation_date": 1479870157, "last_edit_date": 1479901538, "question_id": 40755315, "link": "https://stackoverflow.com/questions/40755315/how-to-understand-defer-in-go-language", "title": "How to understand `defer` in go language?", "body": "<p>In the godoc(<a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">https://blog.golang.org/defer-panic-and-recover</a>), there is an example:</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Deferred functions may read and assign to the returning function's named return values.</li>\n  </ol>\n  \n  <p>In this example, a deferred function increments the return value i\n  after the surrounding function returns. Thus, this function returns 2:</p>\n</blockquote>\n\n<pre><code>func c() (i int) {\n    defer func() { i++ }()\n    return i\n}\n</code></pre>\n\n<p>I also wrote a small progam:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc b() int {\n    i := 0\n    for ; i &lt; 4; i++ {\n        defer func() {fmt.Println(i); i++} ()\n    }\n    return i\n}\nfunc main() {\n  fmt.Println(\"result = \", b())\n}\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>4\n5\n6\n7\nresult =  4\n</code></pre>\n\n<p>So I am confused, why does the second example not output <code>8</code> ?</p>\n"}, {"tags": ["go", "webserver", "real-time", "stdout", "httphandler"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 5, "creation_date": 1479862047, "post_id": 40754221, "comment_id": 68734355, "body": "The ajax call will not complete until the handler returns.  Use <a href=\"https://en.wikipedia.org/wiki/Server-sent_events\" rel=\"nofollow noreferrer\">SSE</a> or <a href=\"https://en.wikipedia.org/wiki/WebSocket\" rel=\"nofollow noreferrer\">WebSockets</a>.  Here&#39;s <a href=\"https://github.com/gorilla/websocket/tree/master/examples/command\" rel=\"nofollow noreferrer\">an example showing how to pipe the output of a command through a websocket</a>."}], "owner": {"reputation": 35, "user_id": 7197274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d43d0a387994d31c6209dd463e261e7?s=128&d=identicon&r=PG&f=1", "display_name": "acer89", "link": "https://stackoverflow.com/users/7197274/acer89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1438, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1496399489, "creation_date": 1479861719, "last_edit_date": 1480114534, "question_id": 40754221, "link": "https://stackoverflow.com/questions/40754221/how-to-direct-terminal-command-real-time-output-to-webpage-running-on-localhost", "title": "How to direct terminal command real-time output to webpage running on localhost written in golang?", "body": "<p>I relatively new to golang, and I am currently running into an issue of redirecting my terminal output to my webpage running on localhost. In golang, I have written a webserver running on localhost with a html button on it. When clicked, the button will execute the following terminal command: </p>\n\n<pre><code>sudo nmap -F -sS X.X.X.0/24 --stats-every 2s | grep --line-buffered 'Ping Scan Timing' | awk '{print $5}'\n</code></pre>\n\n<p>This outputs the execution time of the command every 2s to my os.stdout terminal. The output looks something like this:</p>\n\n<pre><code>10%\n15%\n30%\n.\n.\n.\n</code></pre>\n\n<p>But now I have modified my code because I am trying to redirect this output to my webpage, and render it in realtime, so that it I can see how much progress is left for the execution to be completed since this command can take a while to load. </p>\n\n<p>The problem I am running into is that I cannot properly use the stdoutpipe function to redirect the output to my webpage. Here is a snippet of my code for the handler that gets triggered when I click the button in my webpage:</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n    conn, ok := w.(http.Flusher)\n\n    if !ok {\n            http.Error(w, \"Oops\", http.StatusInternalServerError)\n            return\n    }\n\n    w.Header().Set(\"Content-Type\", \"text/event-stream\")\n    w.WriteHeader(http.StatusOK)\n\n\n    nmap_chain := \"nmap -F -sS X.X.X.0/24 -oX output.xml --stats-every 2s | grep --line-buffered 'Ping Scan Timing' | awk '{print $5}'\"\n    cmd := exec.Command(\"bash\",\"-c\",nmap_chain)\n    stdout, err := cmd.StdoutPipe()\n    if err != nil {\n            log.Fatal(err)\n    }\n    if err := cmd.Start(); err != nil {\n            log.Fatal(err)\n    }\n\n    in := bufio.NewScanner(stdout)\n\n    for in.Scan() {\n            fmt.Fprintf(w,\"%d\\n\\n\",in) \n            conn.Flush()\n            time.Sleep(time.Second)\n    }\n\n    if err := in.Err(); err != nil {\n            log.Printf(\"error: %s\", err)\n    }\n\n\n}\n</code></pre>\n\n<p>My html file looks like the following as well:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;head&gt;\r\n    &lt;meta charset=\"utf-8\"&gt;\r\n    &lt;title&gt;NMAP Demo&lt;/title&gt;\r\n    &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"layout/mystyle.css\"&gt;\r\n    &lt;script src=\"https://code.jquery.com/jquery-2.2.4.min.js\"&gt;&lt;/script&gt;\r\n    &lt;script type=\"text/javascript\"&gt;\r\n\t$(document).ready(function() {\r\n\t    $(\"#exec\").on(\"click\", function() {\r\n\t\t$('#exec').prop('disabled', true);\r\n                $.ajax({\r\n\t\t    url: \"/exec\",\r\n\t\t    method: \"GET\",\r\n\t\t    success: function(data) {\r\n\t\t    $(\"#response\").html(data);\r\n\t\t    $('#exec').prop('disabled', false);\r\n\t\t    },\r\n\t        });\r\n\t    });\r\n\t});\r\n    &lt;/script&gt;\r\n&lt;/head&gt;\r\n&lt;body&gt;\r\n    &lt;div id=\"headerBar\"&gt;&lt;/div&gt;\r\n    &lt;div&gt;\r\n        &lt;button id=\"exec\"&gt;Execute Command&lt;/button&gt;\r\n    &lt;/div&gt;\r\n    &lt;div id=\"results\"&gt;\r\n        &lt;textarea readonly id=\"response\" rows=\"50\" cols=\"50\" style=\"resize\"&gt;&lt;/textarea&gt;\r\n    &lt;/div&gt;\r\n&lt;/body&gt;\r\n&lt;/html&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>As of right now, I cannot see any output in my html textarea when this handler is executed. I've also tried creating a basic function that would execute the nmap command mentioned, and redirect the output to a log instead of os.stdout using stdoutpipe. But still I cannot see any output.</p>\n\n<p>Any suggestions would be helpful.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1479863975, "post_id": 40754337, "comment_id": 68734820, "body": "Thanks for your comment."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 2, "last_activity_date": 1479862587, "creation_date": 1479862587, "answer_id": 40754337, "question_id": 40754061, "link": "https://stackoverflow.com/questions/40754061/pointer-newbie-correct-me/40754337#40754337", "title": "Pointer newbie - Correct me", "body": "<p>Changing the value of a parameter to a function inside the function never has an effect on the parameter passed by the caller. All parameters are passed by value. If you want to change the value of <code>Power</code> inside the object pointed to by <code>s</code> (<code>pod</code> in the caller), use <code>s.Power = 2</code>. If you actually want to set the pointer variable in the caller to a different <code>Pod</code> object, you need to declare the parameter to <code>Change</code> as <code>s **pos</code>, change the assignment in the function to <code>*s = &amp;Pod{2}</code>, and call <code>Change(&amp;pod)</code>. That's probably not what you want to do, though.</p>\n"}, {"comments": [{"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1479864038, "post_id": 40754374, "comment_id": 68734833, "body": "Thank You and Well explained."}, {"owner": {"reputation": 9826, "user_id": 467732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93af4ec7a03d6ec6e95eff3a83af3dd4?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/467732/lucas"}, "reply_to_user": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1479864535, "post_id": 40754374, "comment_id": 68734956, "body": "@Nair I saw your previous comment which is gone now, but because of that I just edited the answer to provide additional information. I hope that helps you :)"}, {"owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "edited": false, "score": 0, "creation_date": 1479865511, "post_id": 40754374, "comment_id": 68735191, "body": "Yes. That was related to pointer derefencing which I forgot for a quick moment and now recollected what I learned in college. We have been going pointer less for a while with all new gen languages. Ignore me."}], "tags": [], "owner": {"reputation": 9826, "user_id": 467732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93af4ec7a03d6ec6e95eff3a83af3dd4?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/467732/lucas"}, "is_accepted": true, "score": 4, "last_activity_date": 1479864497, "last_edit_date": 1479864497, "creation_date": 1479862845, "answer_id": 40754374, "question_id": 40754061, "link": "https://stackoverflow.com/questions/40754061/pointer-newbie-correct-me/40754374#40754374", "title": "Pointer newbie - Correct me", "body": "<p>It's because when you pass arguments to functions etc, they are always passed by value.</p>\n\n<p>In other words, even though you are accepting a pointer in the function parameter, the address of the struct will be copied.</p>\n\n<p>Then when you assign to <code>s</code> to try and change the address it only changes that local copy, not the one outside the function.</p>\n\n<p>To change the address from within the function you would need to pass in a pointer pointer, then assign to the dereferenced <code>s</code>, for example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Pod struct {\n    Power int\n}\n\nfunc main() {\n    pod := &amp;Pod{1}\n    fmt.Println(pod.Power)\n    Change(&amp;pod)\n    fmt.Println(pod.Power)\n}\n\nfunc Change(s **Pod) {\n    *s = &amp;Pod{2}\n}\n</code></pre>\n\n<p>In this case a copy of an address is still being passed into the function, but because it's a pointer to a pointer it means that when you dereference <code>s</code> as <code>*s</code> you will get the address of the struct outside of the function. This means if you assign to <code>*s</code> you can change the address of the pointer outside the function.</p>\n\n<p>Of course, like Andy Schweig says, you probably wouldn't really want to do that though, and would probably just change individual fields as needed with the normal pointer version of the function.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Pod struct {\n    Power int\n}\n\nfunc main() {\n    pod := &amp;Pod{1}\n    fmt.Println(pod.Power)\n    Change(pod)\n    fmt.Println(pod.Power)\n}\n\nfunc Change(s *Pod) {\n    s.Power = 2\n}\n</code></pre>\n\n<p>This works because when you type <code>s.Power = 2</code> Go will actually do something like <code>(*s).Power = 2</code> for you. So it automatically dereferences <code>s</code> for you which  gives you the actual <code>Pod</code> struct to work with.</p>\n\n<p>You can't do <code>*s = &amp;Pod{2}</code> in this normal pointer example because in that case <code>*s</code> will actually equal type <code>Pod</code>, not <code>*Pod</code>.</p>\n\n<p>Because of that if you want to use the <code>&amp;Pod{2}</code> syntax to assign an address you need to pass a pointer to the pointer. In the case of <code>s **Pod</code> the dereferenced <code>*s</code> will point to the address of the <code>Pod</code> instead of the actual <code>Pod</code>, so <code>*s</code> will be of type <code>*Pod</code> which allows you to assign <code>&amp;Pod{2}</code>.</p>\n\n<p>Having said all of that, a <code>**Pod</code> is only required if you want to assign an <em>address</em> with the <code>&amp;Pod{2}</code> syntax.</p>\n\n<p>If you don't need to use the <code>&amp;Pod{2}</code> syntax you can just dereference <code>s</code> and assign with a normal <code>Pod{2}</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Pod struct {\n    Power int\n}\n\nfunc main() {\n    pod := &amp;Pod{1}\n    fmt.Println(pod.Power)\n    Change(pod)\n    fmt.Println(pod.Power)\n}\n\nfunc Change(s *Pod) {\n    *s = Pod{2}\n}\n</code></pre>\n\n<p>This also works, because now <code>s</code> is a copy of an address, and when you dereference you get to the value outside the function which is type <code>Pod</code>, not <code>*Pod</code>.</p>\n\n<p>That means you can just assign to it by removing the <code>&amp;</code>.</p>\n\n<p>Basically if you use <code>&amp;</code> it means you want to assign an <em>address</em> rather than the actual value.</p>\n\n<p>I hope this explanation isn't too confusing. I explained using a <code>**Pod</code> because I thought you wanted to use the <code>&amp;Pod{2}</code> syntax rather than <code>Pod{2}</code>, but if that's not the case then my <code>s.Power = 2</code> or <code>*s = Pod{2}</code> examples may make more sense.</p>\n"}], "owner": {"reputation": 4425, "user_id": 2346961, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/lZJot.jpg?s=128&g=1", "display_name": "Sreejith Nair", "link": "https://stackoverflow.com/users/2346961/sreejith-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 2, "accepted_answer_id": 40754374, "answer_count": 2, "score": 2, "last_activity_date": 1479864497, "creation_date": 1479860509, "last_edit_date": 1479862809, "question_id": 40754061, "link": "https://stackoverflow.com/questions/40754061/pointer-newbie-correct-me", "title": "Pointer newbie - Correct me", "body": "<p>I am still learning go and need a hand to clear my head.</p>\n\n<p>Following program output <code>Power</code> value as <code>1</code> in each <code>Println</code>. I was expecting <code>1</code> as first output and <code>2</code> as second output.\nMy assumption was the <code>Change</code> <code>func</code> overwrite the <code>address of</code> <code>s</code> with a<code>new address</code> and this change will reflect back to the caller (<code>main func</code>). In such case, the original address would be pointing to newly created address when it call the second <code>Println</code>.\nMy assumption is wrong but I can't figure out why.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n)\ntype Pod struct{\n    Power int\n}\nfunc main() {\n    pod := &amp;Pod{1}\n    fmt.Println(pod.Power)\n    Change(pod)\n    fmt.Println(pod.Power)\n}\nfunc Change(s *Pod) {\n    s = &amp;Pod{2}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/n4We0JhqoH\" rel=\"nofollow noreferrer\">Code</a></p>\n\n<p>To explore further on what happens under cover, I did tried to print addresses this time and it looks like below;</p>\n\n<pre><code>import (\n    \"fmt\"\n)\n\ntype Pod struct{\n    Power int\n}\nfunc main() {\n    pod := &amp;Pod{ 1}\n    fmt.Println(&amp;pod) //0xc04202c020\n    Change(pod)\n    fmt.Println(&amp;pod) //0xc04202c020\n}\nfunc Change(s *Pod) {\n    fmt.Println(&amp;s) //0xc04202c030 ( I was expecting 0xc04202c020 here)\n    s = &amp;Pod{ 2}\n    fmt.Println(&amp;s) //0xc04202c030\n}\n</code></pre>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 3, "creation_date": 1479867463, "post_id": 40752817, "comment_id": 68735695, "body": "I highly highly recommend you take a moment and reorganize your packages and read <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">effective go</a>."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1479855929, "last_edit_date": 1479855929, "creation_date": 1479854814, "answer_id": 40753058, "question_id": 40752817, "link": "https://stackoverflow.com/questions/40752817/implement-a-log-file-appender-in-golang/40753058#40753058", "title": "Implement a log file appender in Golang", "body": "<p>Your version doesn't work because you're shadowing the <code>f</code> variable in the if blocks. If you declared <code>err</code> first and use a simple assignment, this would appear to work in most cases.</p>\n\n<p>However, stat'ing a file then trying to create or open it is inherently racy. Just open it with the correct flags in one try. If you want \"write only\", \"append\", and \"create\", then: </p>\n\n<pre><code>os.OpenFile(name, os.O_WRONLY|os.O_APPEND|os.O_CREATE, 0600)\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 3002512, "user_type": "registered", "profile_image": "https://graph.facebook.com/100004180990268/picture?type=large", "display_name": "user3002512", "link": "https://stackoverflow.com/users/3002512/user3002512"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 40753058, "answer_count": 1, "score": 3, "last_activity_date": 1479855929, "creation_date": 1479853758, "last_edit_date": 1479854829, "question_id": 40752817, "link": "https://stackoverflow.com/questions/40752817/implement-a-log-file-appender-in-golang", "title": "Implement a log file appender in Golang", "body": "<p>I have a Golang application which uses the go-logging library (<a href=\"https://github.com/op/go-logging\" rel=\"nofollow noreferrer\">https://github.com/op/go-logging</a>). A log file is correctly generated but when I stop and relaunch the Go application then this logfile is overwrited by a new log file. It is not a bug, Golang does what it asked to do. But if possible I would like that the new logs be appended in the existent log file. </p>\n\n<p>First, an excerpt of my main.go :</p>\n\n<pre><code>package main\n\nimport (\n\n\"utils\"\n\"webapp\"\n\"odbc\"\n\"constants\"\n\"github.com/op/go-logging\"\n)\n\nvar config = &amp;Configuration{}\n\nvar log = logging.MustGetLogger(\"main\")\n\nfunc main() {\n\n     // Load the configuration file\n    utils.Load(constants.CONFIG_PATH, config)\n\n    utils.InitLog(config.LOG)\n\n    ...\n    }\n</code></pre>\n\n<p>My appUtils.go where the utilitary functions are defined :</p>\n\n<pre><code>package utils\n\nimport (\n\"github.com/op/go-logging\"\n\"os\"\n\"fmt\"\n )\n\n func InitLog(config LOG) {\n\n f, err := os.Create(config.LogFile)\n\n backend := logging.NewLogBackend(f, \"\", 0)\n\n format := logging.MustStringFormatter(config.FORMAT,)\n\nbackendFormatter := logging.NewBackendFormatter(backend, format)\n\n// Only errors and more severe messages should be sent to backend1 logging.Level\nlogging.SetBackend(backendFormatter)\n\n\n  level, err :=  logging.LogLevel(config.LEVEL)\n  if err != nil {\n     logging.SetLevel(logging.ERROR, \"\")\n  } else{\n    logging.SetLevel( level, \"\")\n   }\n }\n\ntype LOG struct {\n  FORMAT    string\n  LEVEL    string\n  LogFile  string\n}\n</code></pre>\n\n<p>If needed I also put the content of my config.json :</p>\n\n<pre><code>{\n  \"LOG\":{\n      \"LEVEL\": \"DEBUG\",\n      \"FORMAT\": \"%{color}%{time:15:04:05.000} %{shortfunc} =&gt; %{level:.4s} %{id:03x}%{color:reset} %{message}\",\n      \"LogFile\": \"logfile.log\"\n      }\n }\n</code></pre>\n\n<p>Is what I want feasible?\nI have understood that the problem comes from this line :</p>\n\n<pre><code> f, err := os.Create(config.LogFile)\n</code></pre>\n\n<p>A new file is created after a (re)launch of the application.\nTo avoid that I tried this :</p>\n\n<pre><code>  var f *os.File\n  if _, err := os.Stat(config.LogFile); os.IsNotExist(err) {\n      f, err := os.Create(config.LogFile)\n  }\n  else {\n     f, err := os.OpenFile(config.LogFile, os.O_APPEND|os.O_WRONLY,   0600)    \n  }\n</code></pre>\n\n<p>but it's quite bullsh*t, it does not work at all.</p>\n\n<p>If it's not feasible, should I modify my config.json in order to generate files that have in their name the date with the milliseconds, for instance?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 2, "creation_date": 1479854477, "post_id": 40752795, "comment_id": 68732040, "body": "I think the idea is that you just don&#39;t <code>append</code> to views into shared data. If you want to take a subslice and append to it, you make a copy."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1479855568, "post_id": 40752795, "comment_id": 68732440, "body": "It only appears inconsistent if you don&#39;t understand the simple semantics behind slices. There&#39;s a lot of resource you can read if you&#39;re not sure what&#39;s going on: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a>, <a href=\"https://tour.golang.org/moretypes/7\" rel=\"nofollow noreferrer\">A Tour of Go: Slices</a>, The spec on <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow noreferrer\">Slice Types</a> and <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">Appending any Copying Slices</a>,  <a href=\"https://gobyexample.com/slices\" rel=\"nofollow noreferrer\">Go By Example: Slices</a>, and <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">Slice Tricks</a>"}, {"owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1479857694, "post_id": 40752795, "comment_id": 68733190, "body": "@user2357112 Thanks, now I am clear."}, {"owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479857722, "post_id": 40752795, "comment_id": 68733201, "body": "@JimB Thanks, I will read into them."}, {"owner": {"reputation": 325, "user_id": 5017655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/68dR5.jpg?s=128&g=1", "display_name": "HelloNewWorld", "link": "https://stackoverflow.com/users/5017655/hellonewworld"}, "edited": false, "score": 0, "creation_date": 1479866209, "post_id": 40752795, "comment_id": 68735358, "body": "And this article: <a href=\"https://www.goinggo.net/2013/08/understanding-slices-in-go-programming.html\" rel=\"nofollow noreferrer\">Understanding Slices in Go Programming</a>"}], "answers": [{"tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": false, "score": 6, "last_activity_date": 1479903764, "last_edit_date": 1479903764, "creation_date": 1479880673, "answer_id": 40757079, "question_id": 40752795, "link": "https://stackoverflow.com/questions/40752795/why-golangs-slice-operation-so-complicated/40757079#40757079", "title": "Why Golang&#39;s slice operation so complicated", "body": "<p>This is a gotcha related to how slices are implemented in Go. </p>\n\n<p><a href=\"https://golang.org/src/runtime/slice.go#L11\" rel=\"nofollow noreferrer\"><code>slice</code>'s struct</a> looks like:</p>\n\n<pre><code>type slice struct {\n    array unsafe.Pointer\n    len   int\n    cap   int\n}\n</code></pre>\n\n<p>So, a slice has a length and a capacity. If you try to append items to the slice such that it exceeds the current capacity then a new array is created underneath to hold the new data, but as the previous subslices may still be pointing to the older array it is kept as is until there are no more references left to it.</p>\n\n<hr>\n\n<p>Now let's say we have a slice <code>A</code>: <code>[1, 2, 3, 4, 5, 6]</code> and a subslice <code>B</code> that points to last 3 items in <code>A</code>: [4, 5, 6].</p>\n\n<pre><code>[1, 2, 3, 4, 5, 6]\n ^        ^\n |        |\n |        B------\n |\n A---------------  \n</code></pre>\n\n<p>Now if we append an item to <code>B</code> then from your expected behaviour it should update <code>A</code> as well hence a new array will be created due to that. This can be inefficient if the size of subslice is small compared to the actual array(for appending 1 item copying 1000 items from original array).</p>\n\n<p>Plus to keep it consistent all other references(subslices) that point to the old array will have to be updated to point to appropriate positions in the new array, that means we will have to store additional information in our slices, like start index. And this can get tricky if we have a subslice of a subslice.</p>\n\n<p>Hence the current implementation makes sense.</p>\n\n<hr>\n\n<p>The recommended approach here is to make a copy of subslice instead of working on it directly to prevent such issues. Another advantage of having a copy is that if the original slice is huge and has no references anymore then it can be garbage collected, but in case if it there was a subslice then the original array will be kept it memory till the subslice is still referencing to it.</p>\n"}], "owner": {"reputation": 10027, "user_id": 1647559, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ab1e142a46861a6e6653ef30bcd9ea88?s=128&d=identicon&r=PG", "display_name": "Kuan", "link": "https://stackoverflow.com/users/1647559/kuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479903764, "creation_date": 1479853686, "last_edit_date": 1479863262, "question_id": 40752795, "link": "https://stackoverflow.com/questions/40752795/why-golangs-slice-operation-so-complicated", "title": "Why Golang&#39;s slice operation so complicated", "body": "<p>It's my first day in Golang, and when I try its slice operation, like <code>append()</code>, there is one thing that makes me so confused:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    s := []int{2, 3, 5, 7, 11, 13}\n    a:= s[2:4];\n    a = append(a, 1000, 1001);\n    a[1] = 100; \n    printSlice(\"a:\", a)\n    printSlice(\"s:\", s)\n}\n\nfunc printSlice(title string, s []int) {\n    fmt.Printf(\"%s  len=%d cap=%d %v\\n\", title,  len(s), cap(s), s)\n}\n</code></pre>\n\n<p>When I append only two numbers to <code>a</code>, like:</p>\n\n<pre><code>a = append(a, 1000, 1001);\n</code></pre>\n\n<p>...the result is:</p>\n\n<pre><code>a:  len=4 cap=4 [5 100 1000 1001]\ns:  len=6 cap=6 [2 3 5 100 1000 1001]\n</code></pre>\n\n<p>Which, I think, shows <code>a</code> as a reference to <code>s</code>.</p>\n\n<p>But when I change that line of code to:</p>\n\n<pre><code>a = append(a, 1000, 1001, 1002);\n</code></pre>\n\n<p>...the result becomes:</p>\n\n<pre><code>a:  len=5 cap=8 [5 100 1000 1001 1002]\ns:  len=6 cap=6 [2 3 5 7 11 13]\n</code></pre>\n\n<p>Which, I think, <code>a</code> has been reassigned to another segment of memory, to hold the whole thing, and detach the reference to <code>s</code>.</p>\n\n<p>This is so inconsistent, and makes me so confused, that sometimes it is really easy to make this error (like when you have a random number of values to append). </p>\n\n<p><strong>Why is Golang designed like this? How can this be avoided, if I just want an operation like in JavaScript's <code>slice</code> and <code>push</code>?</strong></p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1479843093, "post_id": 40749222, "comment_id": 68726147, "body": "Depends on what you are trying to do.  TCP proxies are possible, however, you can&#39;t redirect traffic based on the host because the TCP transport protocol does not include a host header like HTTP does."}, {"owner": {"reputation": 449, "user_id": 1299930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67005382b9156d5db68cc3bc4d78ed4e?s=128&d=identicon&r=PG", "display_name": "theeddieh", "link": "https://stackoverflow.com/users/1299930/theeddieh"}, "reply_to_user": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1479855121, "post_id": 40749222, "comment_id": 68732291, "body": "Yeah, after reading more, I came to the same conclusion. Thanks for answering."}], "answers": [{"comments": [{"owner": {"reputation": 1340, "user_id": 2460419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420012dce5396e696185023fa03c5046?s=128&d=identicon&r=PG", "display_name": "Prisacari Dmitrii", "link": "https://stackoverflow.com/users/2460419/prisacari-dmitrii"}, "edited": false, "score": 0, "creation_date": 1567771147, "post_id": 40753701, "comment_id": 102073189, "body": "Unfortunately this script hangs on dialing to remote address"}, {"owner": {"reputation": 441, "user_id": 1730482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8390436ac549ea4b6e9703566c097cc7?s=128&d=identicon&r=PG", "display_name": "marklap", "link": "https://stackoverflow.com/users/1730482/marklap"}, "reply_to_user": {"reputation": 1340, "user_id": 2460419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420012dce5396e696185023fa03c5046?s=128&d=identicon&r=PG", "display_name": "Prisacari Dmitrii", "link": "https://stackoverflow.com/users/2460419/prisacari-dmitrii"}, "edited": false, "score": 0, "creation_date": 1599054926, "post_id": 40753701, "comment_id": 112655149, "body": "@PrisacariDmitrii if you don&#39;t change the value of <code>proxy_addr</code> to a working SOCKS5 proxy, then I&#39;d imagine it would hang yes. At the time of writing this and with valid values for <code>proxy_addr</code> and <code>remote_addr</code>, this code worked just fine."}], "tags": [], "owner": {"reputation": 441, "user_id": 1730482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8390436ac549ea4b6e9703566c097cc7?s=128&d=identicon&r=PG", "display_name": "marklap", "link": "https://stackoverflow.com/users/1730482/marklap"}, "is_accepted": false, "score": -1, "last_activity_date": 1479858278, "creation_date": 1479858278, "answer_id": 40753701, "question_id": 40749222, "link": "https://stackoverflow.com/questions/40749222/sending-tcp-packets-to-proxy/40753701#40753701", "title": "Sending TCP packets to proxy", "body": "<p>This is possible but not with an HTTP Proxy. You want a SOCKS proxy. Check out the <a href=\"https://godoc.org/golang.org/x/net/proxy\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/net/proxy</a> package that provides a SOCKS5 Dialer.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n\n    \"golang.org/x/net/proxy\"\n)\n\nvar (\n    proxy_addr  = \"my.socks.proxy.local:8088\"\n    remote_addr = \"chat.freenode.net:6697\"\n)\n\nfunc main() {\n    dialer, err := proxy.SOCKS5(\"tcp\", proxy_addr, nil, proxy.Direct)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"proxy connection error:\", err)\n        os.Exit(1)\n    }\n    conn, err := dialer.Dial(\"tcp\", remote_addr)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"remote connection error:\", err)\n        os.Exit(1)\n    }\n    defer conn.Close()\n\n    // communicate with remote addr here\n}\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 1299930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67005382b9156d5db68cc3bc4d78ed4e?s=128&d=identicon&r=PG", "display_name": "theeddieh", "link": "https://stackoverflow.com/users/1299930/theeddieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 562, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479858278, "creation_date": 1479839712, "question_id": 40749222, "link": "https://stackoverflow.com/questions/40749222/sending-tcp-packets-to-proxy", "title": "Sending TCP packets to proxy", "body": "<p>I've familiar with <code>HTTP_PROXY</code> and defining a <code>DefaultTransport</code> to proxy HTTP requests. But I can't find anything about how to do the same for TCP. Is this possible? Or do I have to rely on on the proxy itself to forward the packet?</p>\n"}, {"tags": ["json", "go", "struct", "stream", "unmarshalling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479839308, "post_id": 40749036, "comment_id": 68723966, "body": "If there&#39;s a &quot;type&quot; field, and all the attributes are strings, why not just unmarshal into <code>[]map[string]string</code>?"}, {"owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479839737, "post_id": 40749036, "comment_id": 68724234, "body": "Imagine the JSON objects having lots of properties including sub-objects and arrays of objects."}], "answers": [{"tags": [], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "is_accepted": false, "score": 2, "last_activity_date": 1479899802, "last_edit_date": 1495542844, "creation_date": 1479899802, "answer_id": 40763015, "question_id": 40749036, "link": "https://stackoverflow.com/questions/40749036/how-to-decode-json-based-on-object-type-in-golang/40763015#40763015", "title": "How to decode JSON based on object type in Golang", "body": "<p>If you want to manipulate the objects you will have to know what type they are.\nBut if you only want to pass them over, for example:\nIf you get from DB some big object only to <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">Marshal</a> it and pass it to client side, \nyou can use an empty <code>interface{}</code> type: </p>\n\n<pre><code>type HomeType struct {\n  Name                  interface{}        `json:\"name,omitempty\"`\n  Description           interface{}        `json:\"description,omitempty\"`\n  Bathrooms             interface{}        `json:\"bathrooms,omitempty\"`\n  ... more properties that are unique to a home\n}\n\ntype BikeType struct {\n  Name                  interface{}        `json:\"name,omitempty\"`\n  Description           interface{}        `json:\"description,omitempty\"`\n  Tires                 interface{}        `json:\"tires,omitempty\"`\n  ... more properties that are unique to a bike\n}\n</code></pre>\n\n<p>Read here for more about empty interfaces - <a href=\"https://stackoverflow.com/questions/23148812/go-whats-the-meaning-of-interface\">link</a></p>\n\n<p>Hope this is what you ment</p>\n"}], "owner": {"reputation": 740, "user_id": 4488456, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4146daa51bdb93084db63bbf9b5d5c43?s=128&d=identicon&r=PG", "display_name": "jordan2175", "link": "https://stackoverflow.com/users/4488456/jordan2175"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479899802, "creation_date": 1479839086, "last_edit_date": 1479865963, "question_id": 40749036, "link": "https://stackoverflow.com/questions/40749036/how-to-decode-json-based-on-object-type-in-golang", "title": "How to decode JSON based on object type in Golang", "body": "<p>If you have the following JSON structure:</p>\n\n<pre><code>[\n  {\n    \"type\": \"home\",\n    \"name\": \"house #1\",\n    ... some number of properties for home #1\n  },\n  {\n    \"type\": \"bike\",\n    \"name\": \"trek bike #1\",\n    ... some number of properties for bike #1\n  },\n  {\n    \"type\": \"home\",\n    \"name\": \"house #2\",\n    ... some number of properties for home #2\n  }\n]\n</code></pre>\n\n<p>How do you decode this in Golang to a struct without knowing what each type is until you unmarshall the object. It seems like you would have to do this unmarshalling twice.</p>\n\n<p>Also from what I can tell, I should probably be using the RawMessage to delay the decoding.  But I am not sure how this would look.</p>\n\n<p>Say I had the following structs:</p>\n\n<pre><code>type HomeType struct {\n  Name                  string       `json:\"name,omitempty\"`\n  Description           string       `json:\"description,omitempty\"`\n  Bathrooms             string       `json:\"bathrooms,omitempty\"`\n  ... more properties that are unique to a home\n}\n\ntype BikeType struct {\n  Name                  string       `json:\"name,omitempty\"`\n  Description           string       `json:\"description,omitempty\"`\n  Tires                 string       `json:\"tires,omitempty\"`\n  ... more properties that are unique to a bike\n}\n</code></pre>\n\n<p>Second question.  Is it possible to do this in streaming mode? For when this array is really large?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479836768, "post_id": 40748301, "comment_id": 68722486, "body": "Reading up to the point of the error isn&#39;t going to do any better, you&#39;re just replacing the Unmarshal error with an unexpected EOF error."}, {"owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479836955, "post_id": 40748301, "comment_id": 68722578, "body": "Eventually I&#39;m wanting to use the Offset to obtain the key causing the issue during unmarshaling, but being able to read response.Body is step 1."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479837091, "post_id": 40748301, "comment_id": 68722663, "body": "So are you just asking how to buffer the repsonse body?"}, {"owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479837470, "post_id": 40748301, "comment_id": 68722862, "body": "I&#39;m already able to buffer the response body. The json decoder takes care of that. But given the offset value (of type int64) I would like to read <code>response.Body</code> up to that offset so I can at least know the location where the error is occurring. See <a href=\"https://github.com/golang/go/issues/8254\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/8254</a> for a further explanation of what I&#39;m trying to accomplish."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479837724, "post_id": 40748301, "comment_id": 68722998, "body": "The json decoder is not buffering the entire response body for you. You need to read that first yourself if you want to print the portion around the error offset."}, {"owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479848261, "post_id": 40748301, "comment_id": 68729054, "body": "I see what you&#39;re saying. My question has been answered (see accepted answer below) but this is good info for the future. I didn&#39;t realize the json decoder won&#39;t buffer the entire response body."}], "answers": [{"comments": [{"owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "edited": false, "score": 0, "creation_date": 1479842396, "post_id": 40749615, "comment_id": 68725806, "body": "This works great. In my example I used <code>json.NewDecoder(response.Body).Decode(&amp;body)</code> but here you use <code>json.Unmarshal</code>. Based on prior reading (<a href=\"http://stackoverflow.com/a/21198571/1569757\">stackoverflow.com/a/21198571/1569757</a>) it&#39;s better to use <code>json.Decoder</code>. Is it even possible to extract the byte array with json.Decoder like you do here?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "reply_to_user": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "edited": false, "score": 0, "creation_date": 1479852229, "post_id": 40749615, "comment_id": 68731058, "body": "@Alex - No. Using <code>json.Decoder</code> is beneficial if you want to minimize allocations but that same efficiency prevents you from using the response body again."}, {"owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "edited": false, "score": 0, "creation_date": 1479852778, "post_id": 40749615, "comment_id": 68731316, "body": "That makes sense. Marked as accepted. You&#39;ve been super helpful. Thanks!"}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1479841016, "creation_date": 1479841016, "answer_id": 40749615, "question_id": 40748301, "link": "https://stackoverflow.com/questions/40748301/how-can-i-make-use-of-offset-value-in-enconding-jsons-unmarshaltypeerror-for-be/40749615#40749615", "title": "How can I make use of offset value in enconding/json&#39;s UnmarshalTypeError for better error handling?", "body": "<p>Since you want to reuse the request body you should read and store the body before you Unmarshal the body, then if there is a JSON syntax or type error you can return a more useful error using the body you previously stored.</p>\n\n<p>Proof of concept:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\ntype Hello struct {\n    Name    string `json:\"name\"`\n    Message string `json:\"message\"`\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        b, err := ioutil.ReadAll(r.Body)\n        if err != nil {\n            http.Error(w, \"Error reading body\", 400)\n            return\n        }\n\n        h := &amp;Hello{}\n        if err := json.Unmarshal(b, &amp;h); err != nil {\n            var msg string\n            switch t := err.(type) {\n            case *json.SyntaxError:\n                jsn := string(b[0:t.Offset])\n                jsn += \"&lt;--(Invalid Character)\"\n                msg = fmt.Sprintf(\"Invalid character at offset %v\\n %s\", t.Offset, jsn)\n            case *json.UnmarshalTypeError:\n                jsn := string(b[0:t.Offset])\n                jsn += \"&lt;--(Invalid Type)\"\n                msg = fmt.Sprintf(\"Invalid value at offset %v\\n %s\", t.Offset, jsn)\n            default:\n                msg = err.Error()\n            }\n            http.Error(w, msg, 400)\n            return\n        }\n\n        w.Write([]byte(`Good to go!`))\n    })\n\n    if err := http.ListenAndServe(\":8000\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 1569757, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a52fb98fd080686d7d829763f82c6620?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1569757/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 40749615, "answer_count": 1, "score": 1, "last_activity_date": 1479841016, "creation_date": 1479836475, "question_id": 40748301, "link": "https://stackoverflow.com/questions/40748301/how-can-i-make-use-of-offset-value-in-enconding-jsons-unmarshaltypeerror-for-be", "title": "How can I make use of offset value in enconding/json&#39;s UnmarshalTypeError for better error handling?", "body": "<p>A little over a year ago, Go added an <code>Offset</code> value to the <code>json.UnmarshalTypeError</code> type (see closed issue <a href=\"https://github.com/golang/go/issues/9693\" rel=\"nofollow noreferrer\">here</a> for context). The purpose behind the offset value makes sense, but I'm not sure how it can be used when reading a go http response body, which is of type <code>io.ReadCloser</code>.</p>\n\n<pre><code>// An UnmarshalTypeError describes a JSON value that was\n// not appropriate for a value of a specific Go type.\ntype UnmarshalTypeError struct {\n    Value  string       // description of JSON value - \"bool\", \"array\",   \"number -5\"\n    Type   reflect.Type // type of Go value it could not be assigned to\n    Offset int64        // error occurred after reading Offset bytes\n}\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>var body CustomType\ndecoderErr := json.NewDecoder(response.Body).Decode(&amp;body)\n\nif decoderErr != nil {\n\n    if typeError, ok := decoderErr.(*json.UnmarshalTypeError); ok {\n        // Do something with typeError.Offset here\n    }\n\n\n}\n</code></pre>\n\n<p>At the point of the error getting caught, I've already read from <code>response.Body</code> via <code>json.NewDecoder...</code>. I'm looking for a way to read <code>response.Body</code> again, but only up to the point of the error by using the Offset value in typeError. </p>\n"}, {"tags": ["http", "go", "pipe", "mux"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479833456, "post_id": 40747152, "comment_id": 68720533, "body": "I think you&#39;re misunderstanding the purpose of an io.Pipe. Why not just copy the data from the response.Body to the ReponseWriter? (also, an http.Response doesn&#39;t have a Close method, you&#39;re shadowing the PipeWriter with the http.Response, and you need to check the error first)"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1479833551, "post_id": 40747394, "comment_id": 68720599, "body": "though there&#39;s no point in this io.Pipe fiasco, this is just an io.Copy with more copies."}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479833589, "post_id": 40747394, "comment_id": 68720626, "body": "@JimB I agree but I figured he might be trying to learn how to use it, I&#39;ll add another snip without it."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 8, "last_activity_date": 1479833627, "last_edit_date": 1479833627, "creation_date": 1479833476, "answer_id": 40747394, "question_id": 40747152, "link": "https://stackoverflow.com/questions/40747152/write-pipe-reading-into-http-response-in-golang/40747394#40747394", "title": "Write pipe reading into http response in golang", "body": "<p>You are not actually writing to it, you're replacing the pipe's write.</p>\n\n<p>Something along the lines of:</p>\n\n<pre><code>func testHandler(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Println(\"FIRST REQUEST RECEIVED\")\n\n    vars := mux.Vars(r)\n    hash := vars[\"hash\"]\n\n    read, write := io.Pipe()\n\n    // writing without a reader will deadlock so write in a goroutine\n    go func() {\n        defer write.Close()\n        resp, err := http.Get(\"http://localhost:9090/test/\" + hash)\n        if err != nil {\n            return\n        }\n        defer resp.Body.Close()\n        io.Copy(write, resp.Body)\n\n    }()\n\n    io.Copy(w, read)\n\n}\n</code></pre>\n\n<p>Although, I agree with @JimB, for this instance, the pipe isn't even needed, something like this should be more efficient:</p>\n\n<pre><code>func testHandler(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    hash := vars[\"hash\"]\n\n    resp, err := http.Get(\"http://localhost:9090/test/\" + hash)\n    if err != nil {\n        // handle error\n        return\n    }\n    defer resp.Body.Close()\n\n    io.Copy(w, resp.Body)\n}\n</code></pre>\n"}], "owner": {"reputation": 1126, "user_id": 6199193, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/405e0c65a7b74c935b7209988a971006?s=128&d=identicon&r=PG&f=1", "display_name": "Alburkerk", "link": "https://stackoverflow.com/users/6199193/alburkerk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4845, "favorite_count": 1, "accepted_answer_id": 40747394, "answer_count": 1, "score": 1, "last_activity_date": 1479846164, "creation_date": 1479832719, "last_edit_date": 1479846164, "question_id": 40747152, "link": "https://stackoverflow.com/questions/40747152/write-pipe-reading-into-http-response-in-golang", "title": "Write pipe reading into http response in golang", "body": "<p>Here is the schema :</p>\n\n<p>Client sends a POST request to server A</p>\n\n<p>server A process this and sends a GET to server B</p>\n\n<p>server B sends a response through A to the client</p>\n\n<hr>\n\n<p>I though the best idea was to make a pipe which would read the response of the GET, and write into the response of the POST, but I got many types problems.</p>\n\n<pre><code>func main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/test/{hash}\", testHandler)\n\n    log.Fatal(http.ListenAndServe(\":9095\", r))\n}\n\nfunc handleErr(err error) {\n    if err != nil {\n        log.Fatalf(\"%s\\n\", err)\n    }\n}\n\n\nfunc testHandler(w http.ResponseWriter, r *http.Request){\n\n    fmt.Println(\"FIRST REQUEST RECEIVED\")\n    vars := mux.Vars(r)\n    hash := vars[\"hash\"]\n    read, write := io.Pipe()\n\n    // writing without a reader will deadlock so write in a goroutine\n    go func() {\n        write, _ = http.Get(\"http://localhost:9090/test/\" + hash)\n        defer write.Close()\n    }()\n\n    w.Write(read)\n}\n</code></pre>\n\n<p>When I run this I get the following error:</p>\n\n<p>./ReverseProxy.go:61: cannot use read (type *io.PipeReader) as type []byte in argument to w.Write </p>\n\n<p>Is there a way, to properly insert a io.PipeReader format into an http response? \nOr am I doing this in a totally wrong way?</p>\n"}, {"tags": ["sockets", "ssl", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479832632, "post_id": 40746740, "comment_id": 68720002, "body": "I don&#39;t understand the question, what do you mean that the server replies with &quot;some encrypted data which [you are] unable to check&quot; . Please show what you expect to happen, and what you actually saw."}, {"owner": {"reputation": 97, "user_id": 4863795, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f314f032f51811bccda45e9fa45b533b?s=128&d=identicon&r=PG&f=1", "display_name": "Yash", "link": "https://stackoverflow.com/users/4863795/yash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479833210, "post_id": 40746740, "comment_id": 68720386, "body": "I am getting the error &quot;client: dial: EOF&quot;, the request is hanging at the tls.dial and is not going farther, so my data is not even sent yet. EDIT: I expect to send data over an encrypted socket using a certificate and a key."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479833854, "post_id": 40746740, "comment_id": 68720774, "body": "So the server is <i>not</i> sending back data, and just closing the connection? What does the server log for the connection attempt?"}, {"owner": {"reputation": 97, "user_id": 4863795, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f314f032f51811bccda45e9fa45b533b?s=128&d=identicon&r=PG&f=1", "display_name": "Yash", "link": "https://stackoverflow.com/users/4863795/yash"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479834405, "post_id": 40746740, "comment_id": 68721069, "body": "Unfortunately, I do not have access to the server nor to the logs. I&#39;m sure this has nothing to do with the server, this code used to be written in Java, now i&#39;m trying the same thing in Go."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479836099, "post_id": 40746740, "comment_id": 68722117, "body": "If the server is closing the connection immediately, you haven&#39;t provided any information here that can help. My only other guess is that the server only supports an old TLS version or unsupported cipher suites and doesn&#39;t understand or accept the client connection, but you have to troubleshoot that yourself."}], "owner": {"reputation": 97, "user_id": 4863795, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f314f032f51811bccda45e9fa45b533b?s=128&d=identicon&r=PG&f=1", "display_name": "Yash", "link": "https://stackoverflow.com/users/4863795/yash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1315, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1479832071, "creation_date": 1479831435, "last_edit_date": 1479832071, "question_id": 40746740, "link": "https://stackoverflow.com/questions/40746740/ssl-socket-client-in-golang", "title": "SSL Socket client in Golang", "body": "<p>I'm trying to connect to a server through a socket using an ssl certificate. I have the private key and the certificate needed to connect to the server, i have looked around for something to help me write this code in Go but i have not found anything helpful. Here is the code i write so far, but it does not seem to get me anywhere, it seems to be sending data(tls.dial) before getting to the actual data, which forces the server to reply with some encrypted data which i am unable to check.</p>\n\n<pre><code>func main() {\n    cert, err := tls.LoadX509KeyPair(\"cert.pem\", \"key.pem\")\n    if err != nil {\n        log.Fatalf(\"server: loadkeys: %s\", err)\n    }\n    config := tls.Config{Certificates: []tls.Certificate{cert}, InsecureSkipVerify: true}\n    conn, err := tls.Dial(\"tcp\", \"1.2.3.4:1234\", &amp;config)\n    if err != nil {\n        log.Fatalf(\"client: dial: %s\", err)\n    }\n    defer conn.Close()\n    log.Println(\"client: connected to: \", conn.RemoteAddr())\n\n    state := conn.ConnectionState()\n    for _, v := range state.PeerCertificates {\n        fmt.Println(x509.MarshalPKIXPublicKey(v.PublicKey))\n        fmt.Println(v.Subject)\n    }\n    log.Println(\"client: handshake: \", state.HandshakeComplete)\n    log.Println(\"client: mutual: \", state.NegotiatedProtocolIsMutual)\n\n    message := \"data\"\n    n, err := io.WriteString(conn, message)\n    if err != nil {\n        log.Fatalf(\"client: write: %s\", err)\n    }\n    log.Printf(\"client: wrote %q (%d bytes)\", message, n)\n\n    reply := make([]byte, 256)\n    n, err = conn.Read(reply)\n    log.Printf(\"client: read %q (%d bytes)\", string(reply[:n]), n)\n    log.Print(\"client: exiting\")\n}\n</code></pre>\n"}, {"tags": ["intellij-idea", "go"], "comments": [{"owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 1, "creation_date": 1479824547, "post_id": 40744063, "comment_id": 68714162, "body": "I&#39;ve setup projects on both intelliJ and <a href=\"https://marketplace.visualstudio.com/items?itemName=lukehoban.Go\" rel=\"nofollow noreferrer\">VSCode</a> and found the second to be simpler but then again it&#39;s less of an IDE experience. Speaking of an IDE-less experience, there&#39;s nothing wrong with following the <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">Getting Started</a> guide."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479825959, "post_id": 40744063, "comment_id": 68715200, "body": "does not seem so crappy to me <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/wiki\" rel=\"nofollow noreferrer\">github.com/go-lang-plugin-org/go-lang-idea-plugin/wiki</a>"}, {"owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "reply_to_user": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "edited": false, "score": 0, "creation_date": 1479873107, "post_id": 40744063, "comment_id": 68737060, "body": "@NathanCooper I found out that this is the case also. (VSCode is simpler)"}], "answers": [{"tags": [], "owner": {"reputation": 321, "user_id": 3240162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f324400cb43d28e25b2c3aaf2f24889c?s=128&d=identicon&r=PG&f=1", "display_name": "Hagen", "link": "https://stackoverflow.com/users/3240162/hagen"}, "is_accepted": false, "score": 4, "last_activity_date": 1480324158, "creation_date": 1480324158, "answer_id": 40840576, "question_id": 40744063, "link": "https://stackoverflow.com/questions/40744063/go-project-setup-using-intellij/40840576#40840576", "title": "Go Project Setup Using IntelliJ", "body": "<p>I use the plugin with WebStorm, and it is quite an improvement over previous Go IDE attempts.</p>\n\n<p>The issue you run into is quite simple. The auto-generated code does not have the package set to <code>main</code>. For that reason, the main file is invalid. You need to manually set the package to main, and add a function called <code>main</code>.</p>\n\n<p>My steps to ensure a working Go development environment and set up a new project are:</p>\n\n<ul>\n<li>Install Go</li>\n<li>Set GOROOT environment variable to Go installation, e.g. <code>/usr/local/go</code></li>\n<li>Create a go directory in your home folder, and set GOPATH to it.</li>\n<li>Install IntelliJ + plugin</li>\n<li>Create a new Go project in a subfolder of <code>$GOPATH/src</code></li>\n<li>Set the Go SDK in IntelliJ</li>\n<li>Create a main .go file and make sure package name is main, and a main function exists.</li>\n<li>Now you can create a proper Run configuration.</li>\n</ul>\n\n<p>For me, this works quite well, including debugging and running unit tests.</p>\n"}], "owner": {"reputation": 643, "user_id": 900699, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/2b86b9658de8687e42728e8747f176f2?s=128&d=identicon&r=PG", "display_name": "Graham Seed", "link": "https://stackoverflow.com/users/900699/graham-seed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8651, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1480324158, "creation_date": 1479823781, "last_edit_date": 1479916772, "question_id": 40744063, "link": "https://stackoverflow.com/questions/40744063/go-project-setup-using-intellij", "title": "Go Project Setup Using IntelliJ", "body": "<p>Just installed version 2016.2.5 of the Community edition of IntelliJ and then installed the Go plugin from:</p>\n\n<p><a href=\"https://plugins.jetbrains.com/plugin/5047\" rel=\"nofollow noreferrer\">https://plugins.jetbrains.com/plugin/5047</a></p>\n\n<p>I followed the wizard for creating a new project but when I come to run a simple hello.go file I get a \"Main file is invalid\" in the \"Run Configurations\" dialog.</p>\n\n<p>Does anyone know of a step by step guide to setting up and running the simplest of Go projects?</p>\n\n<p>I've tried GoClipse and now IntelliJ and for both the user documentation is absoluetly crap. It's always the same: they spend ages developing this stuff and proide zero useful documentation!</p>\n\n<p>Thanks\nGraham</p>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "edited": false, "score": 1, "creation_date": 1479821469, "post_id": 40743101, "comment_id": 68711957, "body": "Is the <code>Text()</code> method that you&#39;re looking for ?  <a href=\"https://godoc.org/golang.org/x/net/html#Tokenizer.Text\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/net/html#Tokenizer.Text</a>"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "reply_to_user": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "edited": false, "score": 0, "creation_date": 1479821730, "post_id": 40743101, "comment_id": 68712132, "body": "Yeah, not sure how to use it here. t.Text ?"}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 3, "creation_date": 1479822158, "post_id": 40743101, "comment_id": 68712387, "body": "I think StartTagToken&#39;s Data will always contain the tag&#39;s name (in this case &quot;value&quot;). You should advance the tokenizer once more to get the TextToken. It&#39;s Data should be the text itself (i.e &quot;1,2,3&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1479826796, "post_id": 40744170, "comment_id": 68715853, "body": "z.Next().Text undefined (type html.TokenType has no field or method Text)"}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 1, "creation_date": 1479826866, "post_id": 40744170, "comment_id": 68715905, "body": "Edited. Sorry for the mistake."}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1479827044, "post_id": 40744170, "comment_id": 68716045, "body": "now: z.Next().Token undefined (type html.TokenType has no field or method Token)"}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 1, "creation_date": 1479827287, "post_id": 40744170, "comment_id": 68716213, "body": "Edited again. Hope I don&#39;t have to do it again ;)"}, {"owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1479827558, "post_id": 40744170, "comment_id": 68716426, "body": "for some reason it prints me empty brackets [] as Text. I think I had it before. I tried to change to &lt;value&gt;1&lt;/value&gt; with single character but makes no difference"}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "edited": false, "score": 0, "creation_date": 1479828168, "post_id": 40744170, "comment_id": 68716942, "body": "Try replacing <code>Text()</code> with <code>Token().Data()</code>"}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": false, "score": 1, "last_activity_date": 1479827211, "last_edit_date": 1479827211, "creation_date": 1479824055, "answer_id": 40744170, "question_id": 40743101, "link": "https://stackoverflow.com/questions/40743101/how-to-print-text-between-css-selectors-in-golang-using-html-package/40744170#40744170", "title": "How to print text between css selectors in golang using html package?", "body": "<p>You have to use <code>Text()</code> method on the next <code>Token</code>.</p>\n\n<pre><code>if isAnchor := t.Data == \"value\"; isAnchor {\n    z.Next()\n    fmt.Println(z.Text())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 680906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92d0acd7c48668139953457729851453?s=128&d=identicon&r=PG", "display_name": "whytheplatypus", "link": "https://stackoverflow.com/users/680906/whytheplatypus"}, "is_accepted": true, "score": 4, "last_activity_date": 1479831449, "creation_date": 1479831449, "answer_id": 40746744, "question_id": 40743101, "link": "https://stackoverflow.com/questions/40743101/how-to-print-text-between-css-selectors-in-golang-using-html-package/40746744#40746744", "title": "How to print text between css selectors in golang using html package?", "body": "<p>This seems to work for me:</p>\n\n<pre><code>r := strings.NewReader(\"&lt;value&gt;1,2,3&lt;/value&gt;&lt;value&gt;,1,3,5&lt;/value&gt;\")\ndoc, err := html.Parse(r)\nif err != nil {\n    log.Fatal(err)\n}\nvar f func(*html.Node)\nf = func(n *html.Node) {\n    if n.Type == html.ElementNode &amp;&amp; n.Data == \"value\" {\n        fmt.Println(n.FirstChild.Data)\n    }\n    for c := n.FirstChild; c != nil; c = c.NextSibling {\n        f(c)\n    }\n}\nf(doc)\n</code></pre>\n\n<p>I think the key is grabbing the FirstChild after finding the \"value\" node.</p>\n"}], "owner": {"reputation": 2468, "user_id": 4615576, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e78eebf8d65e460bf5f39b2edfddf69e?s=128&d=identicon&r=PG", "display_name": "irom", "link": "https://stackoverflow.com/users/4615576/irom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "accepted_answer_id": 40746744, "answer_count": 2, "score": 0, "last_activity_date": 1479831449, "creation_date": 1479821243, "question_id": 40743101, "link": "https://stackoverflow.com/questions/40743101/how-to-print-text-between-css-selectors-in-golang-using-html-package", "title": "How to print text between css selectors in golang using html package?", "body": "<p>I have html document </p>\n\n<pre><code>&lt;value&gt;1,2,3&lt;/value&gt;\n &lt;value&gt;,1,3,5&lt;/value&gt;\n</code></pre>\n\n<p>and what to extract text with code below but it only prints 'value' tags (css selectors). How to print the text from between tags instead using golang html package ?</p>\n\n<pre><code>z := html.NewTokenizer(b)\n    for {\n        tt := z.Next()\n        switch {\n        case tt == html.ErrorToken:\n            return\n        case tt == html.StartTagToken:\n            t := z.Token()\n            isAnchor := t.Data == \"value\"\n            if isAnchor {\n                fmt.Println(t.Data)\n            }\n        }\n    }\n</code></pre>\n"}, {"tags": ["bash", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1479821415, "post_id": 40743087, "comment_id": 68711912, "body": "Never sudo go get. Never. Also: never set GOROOT (unless you know what you are doing)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1479823380, "post_id": 40743087, "comment_id": 68713288, "body": "Not only should you not set GOROOT, but that isn&#39;t a valid value for GOROOT to begin with."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479830538, "post_id": 40746391, "comment_id": 68718650, "body": "environment variables like PATH, GOPATH, etc should always be in a profile file, not in an rc file."}, {"owner": {"reputation": 609, "user_id": 4242336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlAOL.jpg?s=128&g=1", "display_name": "PapEr", "link": "https://stackoverflow.com/users/4242336/paper"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479831050, "post_id": 40746391, "comment_id": 68718980, "body": "@JimB Thanks, it would be a good habit doing that, updated my answer."}, {"owner": {"reputation": 1577, "user_id": 5436714, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e6477e717551919bfd49eb1645e1acdc?s=128&d=identicon&r=PG&f=1", "display_name": "xxxvincxxx", "link": "https://stackoverflow.com/users/5436714/xxxvincxxx"}, "edited": false, "score": 0, "creation_date": 1479831297, "post_id": 40746391, "comment_id": 68719138, "body": "so what would be the solution in this case?"}, {"owner": {"reputation": 609, "user_id": 4242336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlAOL.jpg?s=128&g=1", "display_name": "PapEr", "link": "https://stackoverflow.com/users/4242336/paper"}, "reply_to_user": {"reputation": 1577, "user_id": 5436714, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e6477e717551919bfd49eb1645e1acdc?s=128&d=identicon&r=PG&f=1", "display_name": "xxxvincxxx", "link": "https://stackoverflow.com/users/5436714/xxxvincxxx"}, "edited": false, "score": 1, "creation_date": 1479831980, "post_id": 40746391, "comment_id": 68719577, "body": "@xxxvinxxx I updated my answer again, actually, go get without sudo should be ok."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479837493, "post_id": 40746391, "comment_id": 68722874, "body": "As covered in the comments above, don&#39;t set GOROOT (and /usr/bin/go is definitely not the value of GOROOT)"}], "tags": [], "owner": {"reputation": 609, "user_id": 4242336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IlAOL.jpg?s=128&g=1", "display_name": "PapEr", "link": "https://stackoverflow.com/users/4242336/paper"}, "is_accepted": false, "score": 3, "last_activity_date": 1479865255, "last_edit_date": 1479865255, "creation_date": 1479830391, "answer_id": 40746391, "question_id": 40743087, "link": "https://stackoverflow.com/questions/40743087/gopath-error-while-installing-json2csv/40746391#40746391", "title": "$GOPATH error while installing json2csv", "body": "<p>The reason is  that you lost some of your ENV when you use <code>sudo</code>.<br>\nyou could use <code>-E</code> to preserve it.</p>\n\n<p>you can check it out here:<br>\n<a href=\"https://linux.die.net/man/8/sudo\" rel=\"nofollow\">https://linux.die.net/man/8/sudo</a></p>\n\n<p><strong>But</strong> you should <strong>not</strong> use sudo to go get.</p>\n\n<p>By the way, you could save you env in <code>.bash_profile</code>, so it can load automatically. </p>\n\n<hr>\n\n<p>In this case, you should set <code>GOROOT</code> and  <code>GOPATH</code> with</p>\n\n<pre><code>export GOROOT=/usr/local/go\nexport GOPATH=$HOME/projects/go\n</code></pre>\n\n<p>Mind that the <code>GOROOT</code> is the folder of go, no the binary of go.</p>\n\n<p>then, go get without sudo.</p>\n\n<pre><code>go get github.com/jehiah/json2csv\n</code></pre>\n"}], "owner": {"reputation": 1577, "user_id": 5436714, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e6477e717551919bfd49eb1645e1acdc?s=128&d=identicon&r=PG&f=1", "display_name": "xxxvincxxx", "link": "https://stackoverflow.com/users/5436714/xxxvincxxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479865255, "creation_date": 1479821203, "question_id": 40743087, "link": "https://stackoverflow.com/questions/40743087/gopath-error-while-installing-json2csv", "title": "$GOPATH error while installing json2csv", "body": "<p>I'm running Linux 3.16.0-4-amd64 x86_64. \nI want to install json2csv.</p>\n\n<p>I try:</p>\n\n<pre><code>sudo  go get github.com/jehiah/json2csv\n</code></pre>\n\n<p>and get:</p>\n\n<pre><code>package github.com/jehiah/json2csv: cannot download, $GOPATH not set. For more details see: go help gopath\n</code></pre>\n\n<p>go is installed:</p>\n\n<pre><code>GOARCH=\"amd64\" \nGOBIN=\"\"\nGOCHAR=\"6\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go\"\nGOTOOLDIR=\"/usr/lib/go/pkg/tool/linux_amd64\" \nCC=\"gcc\" \nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\" \nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>I set:</p>\n\n<pre><code>export GOROOT=/usr/bin/go\nexport GOPATH=$HOME/projects/go\n</code></pre>\n\n<p>but I still get the same error.</p>\n\n<p>Any idea?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479819269, "post_id": 40742371, "comment_id": 68710557, "body": "If you need to conditionally execute the success path, then you either need to return early (the idiomatic approach) or you need to put that code in a another conditional block."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1479819280, "post_id": 40742371, "comment_id": 68710569, "body": "A simple &quot;No&quot; is too short for SO but would be the right answer: No."}, {"owner": {"reputation": 1571, "user_id": 1587118, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cBN8s.jpg?s=128&g=1", "display_name": "SRC", "link": "https://stackoverflow.com/users/1587118/src"}, "edited": false, "score": 0, "creation_date": 1479820680, "post_id": 40742371, "comment_id": 68711412, "body": "I do not understand the reason of downvoting"}, {"owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "edited": false, "score": 0, "creation_date": 1479821540, "post_id": 40742371, "comment_id": 68711997, "body": "Usually, if users find the question helpful, sooner or later it gets some upvotes that balance initial downvotes so that&#39;s fine."}], "answers": [{"comments": [{"owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "edited": false, "score": 0, "creation_date": 1479823134, "post_id": 40743528, "comment_id": 68713092, "body": "I think I&#39;d better just leave these <code>return</code>s as they are now, just need to get used to them, thanks!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1479831102, "last_edit_date": 1479831102, "creation_date": 1479822433, "answer_id": 40743528, "question_id": 40742371, "link": "https://stackoverflow.com/questions/40742371/is-it-possible-for-function-to-make-a-naked-return-on-error-in-golang/40743528#40743528", "title": "Is it possible for function to make a naked return on error in Golang?", "body": "<p>It's possible by calling <code>panic()</code> e.g. in your <code>ReturnErrorResponse()</code> function (after sending back the error), but it's neither idiomatic nor efficient.</p>\n\n<p>Using <code>panic()</code> would of course require to call <code>recover()</code> in a deferred function, which could be done in one place, e.g. in a \"master\" handler passed to <a href=\"https://golang.org/pkg/net/http/#ListenAndServe\" rel=\"nofollow noreferrer\"><code>http.ListenAndServe()</code></a>.</p>\n\n<p>What you're doing is the proper way. Do not use <code>panic()</code> for this.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 40743528, "answer_count": 1, "score": 1, "last_activity_date": 1479831102, "creation_date": 1479819100, "last_edit_date": 1479819270, "question_id": 40742371, "link": "https://stackoverflow.com/questions/40742371/is-it-possible-for-function-to-make-a-naked-return-on-error-in-golang", "title": "Is it possible for function to make a naked return on error in Golang?", "body": "<p>I have a set of constructs like this:</p>\n\n<pre><code>func LoginUser(w http.ResponseWriter, req *http.Request) {\n    // do some check here \n    if err != nil {\n        ReturnErrorResponse(w, errors.LoginError)\n        return\n    }\n\n    // do some check here \n    if err != nil {\n        ReturnErrorResponse(w, errors.BannedUserError)\n        return\n    }\n\n    //success\n}\n</code></pre>\n\n<p>I wonder if it's possible to get rid of these <code>return</code>s and somehow embed them into the <code>ReturnErrorResponse</code> function?</p>\n\n<p>So, if an error happens, I return a JSONified response with error code and make a naked return.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": false, "score": 1, "last_activity_date": 1479818090, "creation_date": 1479818090, "answer_id": 40741998, "question_id": 40741719, "link": "https://stackoverflow.com/questions/40741719/how-to-input-ip-address-from-keyboard-in-go/40741998#40741998", "title": "How to input ip address from keyboard in Go?", "body": "<p>The issue is that you're using <code>Scanner</code>'s instance for comparison here not the input. You should store the value returned by <a href=\"https://golang.org/pkg/bufio/#Scanner.Text\" rel=\"nofollow noreferrer\"><code>Text()</code></a> in a variable and use it for comparison.</p>\n\n<pre><code>typeofoperation_input := typeofoperation.Text()\nadd_input := addr.Text()\n\nif typeofoperation_input == \"tcp\" {\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6888659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a896b9f921dab33257ca3e8c0aab5ad?s=128&d=identicon&r=PG&f=1", "display_name": "faras234", "link": "https://stackoverflow.com/users/6888659/faras234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479818090, "creation_date": 1479817186, "question_id": 40741719, "link": "https://stackoverflow.com/questions/40741719/how-to-input-ip-address-from-keyboard-in-go", "title": "How to input ip address from keyboard in Go?", "body": "<p>Im trying to input IP address from keyboard in Go. When Im trying to input IP address using bufio i can`t convert \"*bufio.Convert\" type to \"string\" type. When Im trying to input ip address using Scanf() program skips input of second variable. What I must to do if i want to convert input to string?</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"fmt\"\n    \"net\"\n    \"os\"\n)\n\nfunc checkerror(err error) {\n   if err != nil {\n        fmt.Println(\"Error:=\", err)\n   }\n}\n\nfunc main() {\n   typeofoperation := bufio.NewScanner(os.Stdin)\n   typeofoperation.Scan()\n   typeofoperation.Text()\n   //fmt.Println(\"IP or TCP dial?\")\n   //fmt.Println(\"Input Address\")\n   //fmt.Scanf(\"%s\", &amp;typeofoperation)\n   //fmt.Scanf(\"%s\", &amp;addr)\n   addr := bufio.NewScanner(os.Stdin)\n   addr.Scan()\n   addr.Text()\n      if typeofoperation == \"tcp\" {\n         address, err := net.ResolveTCPAddr(\"tcp\", addr)\n         checkerror(err)\n         conn, err1 := net.DialTCP(\"tcp\", nil, address)\n         checkerror(err1)\n         fmt.Println(conn, \"TCP end\")\n      } else if typeofoperation == \"ip\" {\n         address, err := net.ResolveIPAddr(\"ip\", addr)\n         checkerror(err)\n         conn, err1 := net.DialIP(\"ip\", nil, address)\n         checkerror(err1)\n         fmt.Println(conn, \"IP end\")\n   }\n      fmt.Println(\"End\")\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1479816966, "creation_date": 1479816966, "answer_id": 40741632, "question_id": 40741357, "link": "https://stackoverflow.com/questions/40741357/prevent-package-import-for-3rd-parties/40741632#40741632", "title": "Prevent package import for 3rd parties", "body": "<p>Yes, you can use an <a href=\"https://golang.org/cmd/go/#hdr-Internal_Directories\" rel=\"nofollow noreferrer\">internal directory</a>. </p>\n\n<blockquote>\n  <p>Code in or below a directory named \"internal\" is importable only by code in the directory tree rooted at the parent of \"internal\". </p>\n</blockquote>\n"}], "owner": {"reputation": 15085, "user_id": 598500, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bd0a1f6e3de136eb18d7e2981bf4b195?s=128&d=identicon&r=PG", "display_name": "shadyyx", "link": "https://stackoverflow.com/users/598500/shadyyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40741632, "answer_count": 1, "score": 1, "last_activity_date": 1479816966, "creation_date": 1479816193, "question_id": 40741357, "link": "https://stackoverflow.com/questions/40741357/prevent-package-import-for-3rd-parties", "title": "Prevent package import for 3rd parties", "body": "<p>For my current project I am implementing a code (separate package) to be part of binary which (this package) can also be imported by other projects (binaries) as if it was a library. The reason why such package is not a part of shared library is that it's functionality is tied tightly with the mentioned project.</p>\n\n<p>The problem is this package provides an interface with two implementations </p>\n\n<ul>\n<li>one with direct access to underlying database which should only be used within the current project</li>\n<li>another with HTTP request to be imported in other projects (HTTP requests going to current project)</li>\n</ul>\n\n<p>My question is: <em>is there a mechanism in Go how to prevent certain part of package or it's sub-package from being imported by another projects</em>?</p>\n\n<p>It's mostly just an aesthetic issue since the DB-accessing implementation won't work at all (throwing errors) when used outside of current project.</p>\n"}, {"tags": ["go", "tags"], "answers": [{"comments": [{"owner": {"reputation": 12786, "user_id": 499125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e0971e368bdad6e495b2eafcdeb7796?s=128&d=identicon&r=PG", "display_name": "Some Noob Student", "link": "https://stackoverflow.com/users/499125/some-noob-student"}, "edited": false, "score": 0, "creation_date": 1479859149, "post_id": 40738847, "comment_id": 68733648, "body": "Good ol&#39; reflection."}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": true, "score": 1, "last_activity_date": 1479811185, "last_edit_date": 1479811185, "creation_date": 1479808914, "answer_id": 40738847, "question_id": 40738292, "link": "https://stackoverflow.com/questions/40738292/how-do-you-tag-fields-of-embedded-structs-which-you-cannot-modify/40738847#40738847", "title": "How do you tag fields of embedded structs which you cannot modify?", "body": "<p><strong>EDIT: wrong answer, my bad</strong></p>\n\n<p>Okep i think i got it. I have never used reflect before so maybe i'm wrong. But :</p>\n\n<p>Take a look at what I just do :</p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/p/U0uyomL-It\" rel=\"nofollow noreferrer\">https://play.golang.org/p/U0uyomL-It</a></p>\n</blockquote>\n\n<p>I have a struct</p>\n\n<pre><code>type User struct {\n    name string\n    age  int\n}\n</code></pre>\n\n<p>With no tag.</p>\n\n<p>I get the field with</p>\n\n<pre><code>field, ok := reflect.TypeOf(user).Elem().FieldByName(\"name\")\nif !ok {\n    panic(\"Field not found\")\n}\n</code></pre>\n\n<p>And i set a new tag with </p>\n\n<pre><code>//setStructTag(&amp;field)\n\nfunc setStructTag(f *reflect.StructField) {\n    f.Tag = \"`json:name-field`\"\n}\n</code></pre>\n\n<p>Hope my researche will help you :)</p>\n"}, {"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479812067, "post_id": 40739813, "comment_id": 68705761, "body": "The conclusion is totally correct, you cannot modify existing tags. But your argumentation is wrong. Types can be created at runtime, see e.g. <a href=\"https://golang.org/pkg/reflect/#StructOf\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#StructOf</a> (albeit a bit limited) and objects can be created from such types. You even can create function types during runtime."}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1479812466, "post_id": 40739813, "comment_id": 68706055, "body": "Very interesting thank you :)  Yes it is a bit limited, but it exists and I ditn&#39;t know."}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": false, "score": 0, "last_activity_date": 1479811582, "creation_date": 1479811582, "answer_id": 40739813, "question_id": 40738292, "link": "https://stackoverflow.com/questions/40738292/how-do-you-tag-fields-of-embedded-structs-which-you-cannot-modify/40739813#40739813", "title": "How do you tag fields of embedded structs which you cannot modify?", "body": "<p>Go is introspective.\nIt has introspection (e.g. find-class allows to look at existing classes) but no intercession (e.g. ensure-class creates/modifies a class at runtime).</p>\n\n<p>So you can't.</p>\n"}], "owner": {"reputation": 12786, "user_id": 499125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e0971e368bdad6e495b2eafcdeb7796?s=128&d=identicon&r=PG", "display_name": "Some Noob Student", "link": "https://stackoverflow.com/users/499125/some-noob-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1264, "favorite_count": 0, "accepted_answer_id": 40738847, "answer_count": 2, "score": 2, "last_activity_date": 1479811582, "creation_date": 1479807449, "question_id": 40738292, "link": "https://stackoverflow.com/questions/40738292/how-do-you-tag-fields-of-embedded-structs-which-you-cannot-modify", "title": "How do you tag fields of embedded structs which you cannot modify?", "body": "<p>Suppose there is an external library <code>libA</code> who declares <code>NotMyType</code>. </p>\n\n<pre><code>type NotMyType struct {\n  NotMyField string\n}\n</code></pre>\n\n<p>And you would like to embed it with one of your own types, which you use with an ORM, which uses the tags to adjust column properties.</p>\n\n<pre><code>type MyType struct {\n  SomeData0 string  `orm:\"nullable\"`\n  SomeData1 string  `orm:\"nullable\"`\n  libA.NotMyType\n}\n</code></pre>\n\n<p>For example, columns <code>MyType.SomeData0</code> and <code>MyType.SomeData1</code> are NULLABLE.</p>\n\n<p>Is it possible to tag <code>NotMyField</code> with <code>orm:\"nullable\"</code> without modifying <code>NotMyType</code>?</p>\n"}, {"tags": ["json", "go", "yaml"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479804535, "post_id": 40737122, "comment_id": 68700535, "body": "create body var like this: <code>body := make(map[string]interface{})</code>"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 3045395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32300ed11ee8f05047f97204477f4c4?s=128&d=identicon&r=PG&f=1", "display_name": "huynhminhtuan", "link": "https://stackoverflow.com/users/3045395/huynhminhtuan"}, "edited": false, "score": 0, "creation_date": 1479811944, "post_id": 40737676, "comment_id": 68705664, "body": "Thank you very much Icza, you are so nice :D"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 29, "last_activity_date": 1516121330, "last_edit_date": 1516121330, "creation_date": 1479805586, "answer_id": 40737676, "question_id": 40737122, "link": "https://stackoverflow.com/questions/40737122/convert-yaml-to-json-without-struct/40737676#40737676", "title": "Convert yaml to json without struct", "body": "<p><strong>Foreword:</strong> I optimized and improved the below solution, and released it as a library here: <a href=\"https://github.com/icza/dyno\" rel=\"noreferrer\"><code>github.com/icza/dyno</code></a>. The below <code>convert()</code> function is available as <a href=\"https://godoc.org/github.com/icza/dyno#ConvertMapI2MapS\" rel=\"noreferrer\"><code>dyno.ConvertMapI2MapS()</code></a>.</p>\n\n<hr>\n\n<p>The problem is that if you use the most generic <code>interface{}</code> type to unmarshal into, the default type used by the <a href=\"https://github.com/go-yaml/yaml\" rel=\"noreferrer\"><code>github.com/go-yaml/yaml</code></a> package to unmarshal key-value pairs will be <code>map[interface{}]interface{}</code>.</p>\n\n<p>First idea would be to use <code>map[string]interface{}</code>:</p>\n\n<pre><code>var body map[string]interface{}\n</code></pre>\n\n<p>But this attempt falls short if the depth of the yaml config is more than one, as this <code>body</code> map will contain additional maps whose type will again be <code>map[interface{}]interface{}</code>.</p>\n\n<p>The problem is that the depth is unknown, and there may be other values than maps, so using <code>map[string]map[string]interface{}</code> is not good.</p>\n\n<p>A viable approach is to let <code>yaml</code> unmarshal into a value of type <code>interface{}</code>, and go through the result <em>recursively</em>, and convert each encountered <code>map[interface{}]interface{}</code> to a <code>map[string]interface{}</code> value. Both maps and slices have to be handled.</p>\n\n<p>Here's an example of this converter function:</p>\n\n<pre><code>func convert(i interface{}) interface{} {\n    switch x := i.(type) {\n    case map[interface{}]interface{}:\n        m2 := map[string]interface{}{}\n        for k, v := range x {\n            m2[k.(string)] = convert(v)\n        }\n        return m2\n    case []interface{}:\n        for i, v := range x {\n            x[i] = convert(v)\n        }\n    }\n    return i\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>func main() {\n    fmt.Printf(\"Input: %s\\n\", s)\n    var body interface{}\n    if err := yaml.Unmarshal([]byte(s), &amp;body); err != nil {\n        panic(err)\n    }\n\n    body = convert(body)\n\n    if b, err := json.Marshal(body); err != nil {\n        panic(err)\n    } else {\n        fmt.Printf(\"Output: %s\\n\", b)\n    }\n}\n\nconst s = `Services:\n-   Orders:\n    -   ID: $save ID1\n        SupplierOrderCode: $SupplierOrderCode\n    -   ID: $save ID2\n        SupplierOrderCode: 111111\n`\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Input: Services:\n-   Orders:\n    -   ID: $save ID1\n        SupplierOrderCode: $SupplierOrderCode\n    -   ID: $save ID2\n        SupplierOrderCode: 111111\n\nOutput: {\"Services\":[{\"Orders\":[\n    {\"ID\":\"$save ID1\",\"SupplierOrderCode\":\"$SupplierOrderCode\"},\n    {\"ID\":\"$save ID2\",\"SupplierOrderCode\":111111}]}]}\n</code></pre>\n\n<p>One thing to note: by switching from yaml to JSON via Go maps you'll lose the order of the items, as elements (key-value pairs) in a Go map are not ordered. This may or may not be a problem.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3466042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e05040110716b16fcc9286832c2c52a7?s=128&d=identicon&r=PG&f=1", "display_name": "Lauri Peltonen", "link": "https://stackoverflow.com/users/3466042/lauri-peltonen"}, "is_accepted": false, "score": 9, "last_activity_date": 1608739956, "last_edit_date": 1608739956, "creation_date": 1517483134, "answer_id": 48561236, "question_id": 40737122, "link": "https://stackoverflow.com/questions/40737122/convert-yaml-to-json-without-struct/48561236#48561236", "title": "Convert yaml to json without struct", "body": "<p><a href=\"http://sigs.k8s.io/yaml\" rel=\"nofollow noreferrer\">http://sigs.k8s.io/yaml</a> is &quot;a wrapper around go-yaml designed to enable a better way of handling YAML when marshaling to and from structs&quot;. Among other things, it provides <code>yaml.YAMLToJSON</code> method that should do what you want.</p>\n"}], "owner": {"reputation": 181, "user_id": 3045395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a32300ed11ee8f05047f97204477f4c4?s=128&d=identicon&r=PG&f=1", "display_name": "huynhminhtuan", "link": "https://stackoverflow.com/users/3045395/huynhminhtuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14615, "favorite_count": 5, "accepted_answer_id": 40737676, "answer_count": 2, "score": 11, "last_activity_date": 1608739956, "creation_date": 1479803805, "last_edit_date": 1525969829, "question_id": 40737122, "link": "https://stackoverflow.com/questions/40737122/convert-yaml-to-json-without-struct", "title": "Convert yaml to json without struct", "body": "<pre><code>Services: \n-   Orders: \n    -   ID: $save ID1\n        SupplierOrderCode: $SupplierOrderCode\n    -   ID: $save ID2\n        SupplierOrderCode: 111111\n</code></pre>\n\n<p>I want to convert this yaml string to json, cause the source data is dynamic, so I can't map it to a struct:</p>\n\n<pre><code>var body interface{}\nerr := yaml.Unmarshal([]byte(s), &amp;body)\n</code></pre>\n\n<p>Then I want to convert that interface to json string again:</p>\n\n<pre><code>b, _ := json.Marshal(body)\n</code></pre>\n\n<p>But an error occur:</p>\n\n<pre><code>panic: json: unsupported type: map[interface {}]interface {}\n</code></pre>\n"}, {"tags": ["arrays", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 575, "user_id": 550324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5450829d6fe4fdd97aa2f73fd6ae7b74?s=128&d=identicon&r=PG", "display_name": "Chao Sun", "link": "https://stackoverflow.com/users/550324/chao-sun"}, "edited": false, "score": 0, "creation_date": 1479799909, "post_id": 40735944, "comment_id": 68698018, "body": "Thanks! this is a perfect answer to my question."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1479802225, "last_edit_date": 1479802225, "creation_date": 1479799285, "answer_id": 40735944, "question_id": 40735738, "link": "https://stackoverflow.com/questions/40735738/golang-array-update-doesnt-work/40735944#40735944", "title": "Golang array update doesn&#39;t work", "body": "<p><code>s</code> is a slice with elements of type <code>Foo</code>. <code>Foo</code> is a struct type. Structs, when assigned to a value, passed as an argument, or appended to a slice, are copied by value. Your <code>append</code> line is adding a <em>copy</em> of <code>foo</code> to <code>s</code>, while you intended to add a <em>reference</em> to <code>foo</code>. </p>\n\n<p>To fix, make <code>s</code> a slice of <em>pointers</em> to your struct:</p>\n\n<pre><code>s := make([]*Foo)\nvar foo Foo\ns = append(s, &amp;foo)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/daXunJAn1A\" rel=\"nofollow noreferrer\">playground link</a></p>\n\n<p>Pointers may seem scary to people who have only experienced them painfully in c. In go, they simply allow you to control if you want to copy something or pass a reference to it.</p>\n"}, {"tags": [], "owner": {"reputation": 737, "user_id": 6275844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f7071f7e0149f02e945420a120a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan 0", "link": "https://stackoverflow.com/users/6275844/dan-0"}, "is_accepted": false, "score": 2, "last_activity_date": 1479799289, "creation_date": 1479799289, "answer_id": 40735946, "question_id": 40735738, "link": "https://stackoverflow.com/questions/40735738/golang-array-update-doesnt-work/40735946#40735946", "title": "Golang array update doesn&#39;t work", "body": "<p>In your example you are appending <code>foo</code> as it currently exists to <code>s</code>. This copies <code>foo</code> by value, creating a copy of <code>foo</code> appended to <code>s</code>. When you print <code>s</code>, you're printing the newly created (when it was initialized to 0) <code>foo</code> that was added to <code>s</code>, not the modified <code>foo</code> array.</p>\n\n<p>When you switch <code>s = append(s, foo)</code> and <code>foo.A[0] = 42</code>, you're doing the same thing, but this time you're seeing your expected result because you're copying the <code>foo</code> array, with 42, into <code>s</code>. If you were to modify <code>foo</code> again <code>fmt.Printf(\"%v\", s[0].A)</code> would still give you <code>[42,0,0,0,0]</code></p>\n"}], "owner": {"reputation": 575, "user_id": 550324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5450829d6fe4fdd97aa2f73fd6ae7b74?s=128&d=identicon&r=PG", "display_name": "Chao Sun", "link": "https://stackoverflow.com/users/550324/chao-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 344, "favorite_count": 0, "accepted_answer_id": 40735944, "answer_count": 2, "score": 0, "last_activity_date": 1479802225, "creation_date": 1479798567, "question_id": 40735738, "link": "https://stackoverflow.com/questions/40735738/golang-array-update-doesnt-work", "title": "Golang array update doesn&#39;t work", "body": "<p>Hi Golang newbie coming from Java world. I have this very simple piece of program:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n  A [5]int\n}\n\nfunc main() {\n  s := make([]Foo, 0)\n  var foo Foo\n  s = append(s, foo)\n  foo.A[0] = 42\n  fmt.Printf(\"%v\", s[0].A)\n}\n</code></pre>\n\n<p>However, this prints <code>[0,0,0,0,0]</code> instead of <code>[42,0,0,0,0]</code> that I expected. After swapping the line <code>s = append(s, foo)</code> and <code>foo.A[0] = 42</code>, it does print <code>[42,0,0,0,0]</code>. Why is that? Thanks in advance.</p>\n"}, {"tags": ["json", "web-services", "curl", "go"], "comments": [{"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 2, "creation_date": 1479803652, "post_id": 40735237, "comment_id": 68699998, "body": "Have a look at <a href=\"https://github.com/gin-gonic/gin#querystring-parameters\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin#querystring-parameters</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479829998, "post_id": 40735237, "comment_id": 68718283, "body": "<a href=\"https://github.com/gin-gonic/gin#model-binding-and-validation\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin#model-binding-and-validation</a> To bind a request body into a type, use model binding. We currently support binding of <b>JSON, XML and standard form</b> values (foo=bar&amp;boo=baz). see also <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/schema</a> ?"}], "owner": {"reputation": 31, "user_id": 7146134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cbf644ed3ffdf7ee99d075707acf546?s=128&d=identicon&r=PG&f=1", "display_name": "user7146134", "link": "https://stackoverflow.com/users/7146134/user7146134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479796360, "creation_date": 1479796360, "question_id": 40735237, "link": "https://stackoverflow.com/questions/40735237/how-to-bind-query-string-in-go", "title": "how to bind query string in go?", "body": "<pre><code>package main\n\nimport \"log\"\nimport \"github.com/gin-gonic/gin\"\n\ntype Person struct {\n    Name    string `json:\"name\"`\n    Address string `json:\"address\"`\n}\n\nfunc main() {\n    log.Println(\"Hello World\")\n    route := gin.Default()\n    route.GET(\"/testing\", startPage)\n    route.Run(\":8085\")\n}\n\nfunc startPage(c *gin.Context) {\n    var person Person\n    if c.BindJSON(&amp;person) == nil {\n        log.Println(person.Name)\n        log.Println(person.Address)\n        log.Println(\"Binding success...............\")\n    } else {\n        log.Println(\"Binding failed...............\")\n    }\n\n    c.String(200, \"Success\")\n}\n</code></pre>\n\n<p>The above code works only for <code>curl -X GET localhost:8085/testing --data '{\"name\":\"JJ\", \"address\":\"xyz\"}' -H \"Content-Type:application/json\"</code> but not <code>curl -X GET localhost:8085/testing?name=JJ&amp;address=xyz -H \"Content-Type:application/json\"</code></p>\n\n<p>if i use <code>c.Bind(&amp;person)</code>, binding failed both case.\nHow can i write the above code which binds both query string and json. What is difference between passing arguments via --data and passing in query string.</p>\n"}, {"tags": ["pointers", "dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1479768319, "post_id": 40730701, "comment_id": 68688768, "body": "You keep adding the same pointer to <code>v</code> to the slice. See also <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1479771844, "post_id": 40730701, "comment_id": 68689939, "body": "If you want pointers you need to make your map&#39;s value a pointer type like <code>*int</code>. Map items can move around in memory, so you can&#39;t get a pointer directly into the map. <a href=\"http://stackoverflow.com/a/32751792/2714852\">Here&#39;s a slightly expanded version of that.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1479770793, "post_id": 40731129, "comment_id": 68689595, "body": "I am not sure what&#39;s OP expected value here, but doing it this way the pointers inside the array and map will now deference to different places."}], "tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": true, "score": 2, "last_activity_date": 1479771323, "last_edit_date": 1479771323, "creation_date": 1479769953, "answer_id": 40731129, "question_id": 40730701, "link": "https://stackoverflow.com/questions/40730701/behavior-of-maps-value-pointer-being-added-to-slice/40731129#40731129", "title": "behavior of map&#39;s value pointer being added to slice", "body": "<p>Quoting from <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">this doc</a>:</p>\n\n<blockquote>\n  <p>[...] each iteration of the loop uses the same instance of the variable v, so each closure shares that single variable [...]</p>\n</blockquote>\n\n<p>In other words, the loop variable <code>v</code> is reused in all iterations, so your assigning the same pointer to all your slice elements.</p>\n\n<p>Variables declared <em>inside</em> the loop won't be recycled like that, so this will work as you would expect:</p>\n\n<pre><code>for _, v := range m {\n    vv := v\n    array[i] = &amp;vv\n    fmt.Printf(\"Add to array: %d\\n\", v)\n    i++\n}\n</code></pre>\n\n<p>Btw, you haven't explained why you want to use <code>*int</code> as the type of the values. All this would be simpler if you used simply <code>int</code> values.</p>\n"}, {"tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": false, "score": 1, "last_activity_date": 1479769979, "creation_date": 1479769979, "answer_id": 40731133, "question_id": 40730701, "link": "https://stackoverflow.com/questions/40730701/behavior-of-maps-value-pointer-being-added-to-slice/40731133#40731133", "title": "behavior of map&#39;s value pointer being added to slice", "body": "<p>The issue here is that the variable <code>v</code> created during the loop is actually a copy of the value we have in the map. The memory related to <code>v</code> is allocated once at the start of the loop and is re-used later on for other values, as the last value here points to is 912 in this case you're seeing 912 inside the array.</p>\n\n<p>A simple proof for this will be: <a href=\"https://play.golang.org/p/K0yAbEIf3G\" rel=\"nofollow noreferrer\">https://play.golang.org/p/K0yAbEIf3G</a></p>\n\n<p>One fix for this will be to change your map value to be *int pointers instead of values and later on we can dereference them to get the actual values:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Test Map Value Pointer 2\")\n    a, b, c, d := 3711, 2138, 1908, 912\n    m := map[string]*int{\"rsc\": &amp;a, \"r\": &amp;b, \"gri\": &amp;c, \"adg\": &amp;d}\n    n := len(m)\n    array := make([]*int, n)\n    i := 0\n    for _, v := range m {\n        array[i] = v\n        fmt.Printf(\"Add to array: %d\\n\", *v)\n        i++\n    }\n    for _, k := range array {\n        fmt.Printf(\"Value: %d\\n\", *k)\n    }\n}\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/TpkXlCElLx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TpkXlCElLx</a></p>\n"}], "owner": {"reputation": 19, "user_id": 7191677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/178dd8b19e2f7da2d368af7291f3b434?s=128&d=identicon&r=PG&f=1", "display_name": "Henry0100", "link": "https://stackoverflow.com/users/7191677/henry0100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 40731129, "answer_count": 2, "score": 0, "last_activity_date": 1479772927, "creation_date": 1479767957, "last_edit_date": 1479772927, "question_id": 40730701, "link": "https://stackoverflow.com/questions/40730701/behavior-of-maps-value-pointer-being-added-to-slice", "title": "behavior of map&#39;s value pointer being added to slice", "body": "<pre><code>func TestMapValuePointer2(t *testing.T) {\n    fmt.Println(\"Test Map Value Pointer 2\")\n    m := map[string]int{\"rsc\": 3711, \"r\": 2138, \"gri\": 1908, \"adg\": 912}\n    n := len(m)\n    array := make([]*int, n)\n    i := 0\n    for _, v := range m {\n        array[i] = &amp;v\n        fmt.Printf(\"Add to array: %d\\n\", v)\n        i++\n    }\n    for _, k := range array {\n        fmt.Printf(\"Value: %d\\n\", *k)\n    }\n}\n</code></pre>\n\n<p>The output is not:</p>\n\n<pre>\nValue: 912\nValue: 3711\nValue: 2138\nValue: 1908\n</pre>\n\n<p>Instead, the output maybe like:</p>\n\n<pre>\nValue: 912\nValue: 912\nValue: 912\nValue: 912\n</pre>\n\n<p>Can someone explain why the results are like the above?</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479757839, "post_id": 40728020, "comment_id": 68683488, "body": "If know you can connect to the database at <code>127.0.0.1:3306</code>, why not try that address?"}, {"owner": {"reputation": 1072, "user_id": 3882878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1dafa934bec9656c0a04f89d1bf355d2?s=128&d=identicon&r=PG&f=1", "display_name": "fiddlest", "link": "https://stackoverflow.com/users/3882878/fiddlest"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479757979, "post_id": 40728020, "comment_id": 68683553, "body": "I already tried with localhost:3306       db, err := sql.Open(&quot;mysql&quot;, &quot;root:welcome@/tcp(127.0.0.1:3306)/test&quot;)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479758201, "post_id": 40728020, "comment_id": 68683670, "body": "If &quot;sequel pro&quot; can connect to <code>localhost:3306</code>, there&#39;s no reason the Go driver shouldn&#39;t be able to. What is the difference between the 2 processes?"}, {"owner": {"reputation": 1072, "user_id": 3882878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1dafa934bec9656c0a04f89d1bf355d2?s=128&d=identicon&r=PG&f=1", "display_name": "fiddlest", "link": "https://stackoverflow.com/users/3882878/fiddlest"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479758315, "post_id": 40728020, "comment_id": 68683718, "body": "That is why I posted question ... it should work but its not"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479758720, "post_id": 40728020, "comment_id": 68683935, "body": "What is the error from Go? How are you running &quot;sequel pro&quot; so that it will connect? What is the port published for the container?"}, {"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1479759054, "post_id": 40728020, "comment_id": 68684124, "body": "Can you confirm that: MySQL is running in a docker container &quot;sql pro&quot; is running on your dockerhost   Where are you trying to connect from with go? Another docker container?"}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 3, "last_activity_date": 1479761225, "creation_date": 1479761225, "answer_id": 40729059, "question_id": 40728020, "link": "https://stackoverflow.com/questions/40728020/how-to-correctly-connect-mysql-docker-container-with-go/40729059#40729059", "title": "How to correctly connect mysql docker container with go ?", "body": "<p>Your connection is wrong, use</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:welcome@tcp(127.0.0.1:3306)/test\")\n</code></pre>\n\n<p>Notice that \"/\" is removed after \"@\"</p>\n\n<p>The README says a valid connection path is like</p>\n\n<pre><code>[username[:password]@][protocol[(address)]]/dbname\n</code></pre>\n"}], "owner": {"reputation": 1072, "user_id": 3882878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1dafa934bec9656c0a04f89d1bf355d2?s=128&d=identicon&r=PG&f=1", "display_name": "fiddlest", "link": "https://stackoverflow.com/users/3882878/fiddlest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1478, "favorite_count": 0, "accepted_answer_id": 40729059, "answer_count": 1, "score": -1, "last_activity_date": 1479761225, "creation_date": 1479757106, "question_id": 40728020, "link": "https://stackoverflow.com/questions/40728020/how-to-correctly-connect-mysql-docker-container-with-go", "title": "How to correctly connect mysql docker container with go ?", "body": "<p>I started to learn docker today and have big blocker. \nWhat I am trying to do is thatopen mysql connection using go-sql-driver/mysql.</p>\n\n<p>I can connect mysql container using sequel pro with localhost:3306<br>\nHowever, it seems not working with go-sql-driver/mysql</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:welcome@/tcp(127.0.0.1:3306)/test\")\n</code></pre>\n\n<p>//tried 172.17.0.1:3306 and 172.17.0.2:3306</p>\n\n<p>and this is my container's network info </p>\n\n<pre><code>\"Networks\": {\n            \"bridge\": {\n                \"IPAMConfig\": null,\n                \"Links\": null,\n                \"Aliases\": null,\n                \"NetworkID\": \"47b2a5c798522f5eb6688c4540b4017335eb174528d510b9f1d35d125313017c\",\n                \"EndpointID\": \"ca2256684928e4184efd36f880cd70d3809d79db5b30c10ab37c66ccbbbba610\",\n                \"Gateway\": \"172.17.0.1\",\n                \"IPAddress\": \"172.17.0.2\",\n                \"IPPrefixLen\": 16,\n                \"IPv6Gateway\": \"\",\n                \"GlobalIPv6Address\": \"\",\n                \"GlobalIPv6PrefixLen\": 0,\n                \"MacAddress\": \"02:42:ac:11:00:02\"\n            }\n        }\n</code></pre>\n\n<p>I am not sure which info I should provide to get right answer since I am new to vm</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "is_accepted": true, "score": 2, "last_activity_date": 1479750717, "creation_date": 1479750717, "answer_id": 40726383, "question_id": 40726110, "link": "https://stackoverflow.com/questions/40726110/parsing-json-file-in-golang/40726383#40726383", "title": "Parsing json file in golang", "body": "<p>You can use Go's <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package quite easily. Here is a <a href=\"https://play.golang.org/p/WgWPBTCGni\" rel=\"nofollow noreferrer\">playground link</a> to the code below.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n)\n\nvar a = `{  \n\"sometext\":[  \n  {  \n     \"sha\":\"1234567\",\n     \"message\":\"hello world\",\n     \"author\":\"varung\",\n     \"timestamp\":1479445228\n  }\n]\n}`\n\ntype Root struct {\n    Text []*Object `json:\"sometext\"`\n}\n\ntype Object struct {\n    Sha       string `json:\"sha\"`\n    Message   string `json:\"message\"`\n    Author    string `json:\"author\"`\n    Timestamp int    `json:\"timestamp\"`\n}\n\nfunc main() {\n    var j Root\n    err := json.Unmarshal([]byte(a), &amp;j)\n    if err != nil {\n        log.Fatalf(\"error parsing JSON: %s\\n\", err.Error())\n    }\n    fmt.Printf(\"%+v\\n\", j.Text[0].Sha)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": false, "score": 0, "last_activity_date": 1479750720, "creation_date": 1479750720, "answer_id": 40726385, "question_id": 40726110, "link": "https://stackoverflow.com/questions/40726110/parsing-json-file-in-golang/40726385#40726385", "title": "Parsing json file in golang", "body": "<p>I don't know of any way other than unmarshaling the json.</p>\n\n<pre><code>import (\n        \"time\"\n        \"fmt\"\n        \"encoding/json\"\n)\n\ntype MyObj struct {\n  Sha string `json:\"sha\"`\n  Message string `json:\"message\"`\n  Author string `json:\"author\"`\n  Timestamp time.Time `json:\"timestamp\"`\n}\n\ntype MyObjs struct {\n  Objs []MyObj `json:\"some text\"`\n} \n\nfunc PrintSha(json []byte) {\n  var myObjs MyObjs\n  if err := json.Unmarshal(json, &amp;myObjs); err != nil {\n    panic(err)\n  }\n  myObj := myObjs[0]\n  fmt.Println(myObj.sha)\n}\n</code></pre>\n"}], "owner": {"reputation": 1339, "user_id": 1726183, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/e052c9c68ad2978015d389b4c00513f0?s=128&d=identicon&r=PG", "display_name": "Varun Gupta", "link": "https://stackoverflow.com/users/1726183/varun-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "closed_date": 1479765477, "accepted_answer_id": 40726383, "answer_count": 2, "score": -1, "last_activity_date": 1479750720, "creation_date": 1479749759, "question_id": 40726110, "link": "https://stackoverflow.com/questions/40726110/parsing-json-file-in-golang", "closed_reason": "Needs more focus", "title": "Parsing json file in golang", "body": "<p>I have a json structure like this</p>\n\n<pre><code>{  \n\"some text\":[  \n  {  \n     \"sha\":\"1234567\",\n     \"message\":\"hello world\",\n     \"author\":\"varung\",\n     \"timestamp\":1479445228\n  }\n]\n}\n</code></pre>\n\n<p>I need to access the value of sha, using golang. How can I do it?</p>\n"}, {"tags": ["postgresql", "go", "interface", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6806129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690e3b3e5142425fbaaf4ad6c5aa2c8d?s=128&d=identicon&r=PG&f=1", "display_name": "mfish", "link": "https://stackoverflow.com/users/6806129/mfish"}, "edited": false, "score": 0, "creation_date": 1479749257, "post_id": 40725129, "comment_id": 68679157, "body": "Thank you for your quick response. The problem is that if I define Ia_date within a struct ( which I do --&gt; ccc.Ia_date) as *time.Time, I cannot assign the newly converted string back to that value as it will only accept objects of type *time.Time So I will try your interface solution."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1479747330, "last_edit_date": 1495540976, "creation_date": 1479746502, "answer_id": 40725129, "question_id": 40724954, "link": "https://stackoverflow.com/questions/40724954/how-to-convert-time-time-object-to-formatted-string-using-format-in-golang/40725129#40725129", "title": "How to convert time.Time object to formatted string using .Format in golang?", "body": "<p>If you have an <code>interface{}</code> value holding a <a href=\"https://golang.org/pkg/time/#Time\" rel=\"nofollow noreferrer\"><code>time.time</code></a> value, you may use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a> to obtain the wrapped <code>time.Time</code>:</p>\n\n<pre><code>if t, ok := ccc.Ia_date.(time.Time); ok {\n    // here t is of type time.Time, and so you can call its Format() method:\n    fmt.Println(t.Format(layout))\n} else {\n    // ccc.Ia_date is not of type time.Time, or it is nil\n}\n</code></pre>\n\n<p>Note that it would be easier to just use a pointer <code>*time.Time</code> if you want to allow <code>nil</code>, and so you don't need to use type assertion. See this answer for more details: <a href=\"https://stackoverflow.com/questions/32643815/golang-json-omitempty-with-time-time-field/32646035#32646035\">Golang JSON omitempty With time.Time Field</a></p>\n\n<p>If <code>ccc.Ia_date</code> would be of type <code>*time.Time</code>:</p>\n\n<pre><code>if ccc.Ia_date != nil {\n    fmt.Println(ccc.Ia_date.Format(layout))\n}\n</code></pre>\n\n<p>And the layout string for your desired format is:</p>\n\n<pre><code>layout := \"2006-01-02T15:04:05\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 0, "last_activity_date": 1479753496, "last_edit_date": 1479753496, "creation_date": 1479746656, "answer_id": 40725171, "question_id": 40724954, "link": "https://stackoverflow.com/questions/40724954/how-to-convert-time-time-object-to-formatted-string-using-format-in-golang/40725171#40725171", "title": "How to convert time.Time object to formatted string using .Format in golang?", "body": "<p>You have multiple issues.  First off, if <code>ccc.Ia_date</code> is an <code>interface{}</code>, you must type-assert it to a <code>time.Time</code> before you can use any methods of a <code>time.Time</code>.  You can do this using the two-argument type-assertion form to avoid panics:</p>\n\n<pre><code>t, ok := ccc.Ia_date.(time.Time)\nif !ok {\n    // wrong type or nil value, handle it\n}\nt.Format(timeFormat)\n</code></pre>\n\n<p>You also need to define your format string.  The format string is defined as a standardized date and time, that being <code>Mon Jan 2 15:04:05 -0700 MST 2006</code>.  So for your format, you want:</p>\n\n<pre><code>time_format := \"2006-01-02T15:04:05\"\nt.Format(timeFormat)\n</code></pre>\n\n<p>However, this lacks a timezone.  It is also nearly identical to RFC3339 (<code>\"2006-01-02T15:04:05Z07:00\"</code>), which you can use instead:</p>\n\n<pre><code>t.Format(time.RFC3339)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6806129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690e3b3e5142425fbaaf4ad6c5aa2c8d?s=128&d=identicon&r=PG&f=1", "display_name": "mfish", "link": "https://stackoverflow.com/users/6806129/mfish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1708, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1479753496, "creation_date": 1479745935, "last_edit_date": 1495535431, "question_id": 40724954, "link": "https://stackoverflow.com/questions/40724954/how-to-convert-time-time-object-to-formatted-string-using-format-in-golang", "title": "How to convert time.Time object to formatted string using .Format in golang?", "body": "<p>I'm currently attempting to fetch a time.Time object from my SQL database and convert the retrieved value to a formatted string that looks like so:</p>\n\n<pre><code>TIME_FORMAT := \"%Y-%m-%dT%H:%M:%S\"\n</code></pre>\n\n<p>This is the format I have used to do the same thing in Python, but I know it is not correct for go. I have already grabbed the value from the DB, and now just need to format it. Please note I have defined ccc.Ia_date as interface{} type because it is possible that this value in the DB could be null. Here is a clip of my code:</p>\n\n<pre><code>fmt.Println(reflect.TypeOf(ccc.Ia_date))  //gives me time.Time\nt := ccc.Ia_date //which prints as: 2016-11-16 21:06:39 +0000 +0000\nfmt.Println(t.Format())\n</code></pre>\n\n<p>and I get the following error:</p>\n\n<p>t.Format undefined (type interface {} is interface with no methods)</p>\n\n<p>Am I missing an import? Or is this just not possible using interface types? If so, what alternatives do I have to accept null values from the DB?\n(I have already seen the related answer to <a href=\"https://stackoverflow.com/questions/33119748/golang-convert-time-time-to-string\">Golang: convert time.Time to string</a> - I tried that solution but I'm not grabbing time.Now and that's the only difference I see)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479736333, "post_id": 40721668, "comment_id": 68670443, "body": "&quot;github.com/cweill/gotests&quot; is not a &quot;main&quot; package, so there is no binary artifact."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479736399, "post_id": 40721668, "comment_id": 68670487, "body": "The command to install, from the <a href=\"https://github.com/cweill/gotests#installation\" rel=\"nofollow noreferrer\">Installation section in the README</a> is <code>$ go get -u github.com&#47;cweill&#47;gotests&#47;...</code>"}, {"owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479736651, "post_id": 40721668, "comment_id": 68670650, "body": "If there is no binary artifact how we should use the gotests command from the command Line as mentioned in the <a href=\"https://github.com/cweill/gotests#installation\" rel=\"nofollow noreferrer\">github.com/cweill/gotests#installation</a> section"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479736903, "post_id": 40721668, "comment_id": 68670853, "body": "The command in the README is not what you executed. The &quot;main&quot; package is in a subdirectory you haven&#39;t installed."}, {"owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479746992, "post_id": 40721668, "comment_id": 68677720, "body": "Thanks this helped:)"}], "answers": [{"tags": [], "owner": {"reputation": 168, "user_id": 3270012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w5xo5.png?s=128&g=1", "display_name": "rb16", "link": "https://stackoverflow.com/users/3270012/rb16"}, "is_accepted": false, "score": 5, "last_activity_date": 1479743708, "creation_date": 1479743708, "answer_id": 40724221, "question_id": 40721668, "link": "https://stackoverflow.com/questions/40721668/how-to-install-gotests-command/40724221#40724221", "title": "How to install &quot;gotests&quot; command?", "body": "<p>since there is NO main package, Use this command </p>\n\n<pre><code>$ go get github.com/cweill/gotests/...\n</code></pre>\n\n<p>this itself download all dependencies for the current package, and creates bin file, after downloading this package. see in $GOPATH/bin there will be a bin file named <strong>gotests</strong></p>\n\n<p>for more see <a href=\"https://github.com/alco/gostart#10-how-do-i-download-remote-packages\" rel=\"noreferrer\">HERE</a></p>\n"}], "owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1933, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479750461, "creation_date": 1479735849, "last_edit_date": 1479750461, "question_id": 40721668, "link": "https://stackoverflow.com/questions/40721668/how-to-install-gotests-command", "title": "How to install &quot;gotests&quot; command?", "body": "<p>I need to use the test driven development in Go using \"gotests\" command.</p>\n\n<pre><code>gotests -all *\n</code></pre>\n\n<p>This is not working. I did <code>go get -u /github.com/cweill/gotests</code>\nand <code>go install</code>. But there is no binary created in <code>$GOPATH/bin</code>.</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1479739480, "post_id": 40721475, "comment_id": 68672596, "body": "can you show code for ... filling the struct ...?"}, {"owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1479742894, "post_id": 40721475, "comment_id": 68674943, "body": "I&#39;ve edited the code"}, {"owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1479803866, "post_id": 40721475, "comment_id": 68700164, "body": "I fill all the structure except id&#39;s, it should be filled by gorm"}], "answers": [{"tags": [], "owner": {"reputation": 307, "user_id": 5971811, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b2a43df97ca256f9306ce4c1e19cffd2?s=128&d=identicon&r=PG&f=1", "display_name": "iambicSam", "link": "https://stackoverflow.com/users/5971811/iambicsam"}, "is_accepted": false, "score": 0, "last_activity_date": 1485908963, "creation_date": 1485908963, "answer_id": 41969993, "question_id": 40721475, "link": "https://stackoverflow.com/questions/40721475/gorm-has-one-relation-with-anonymous-field/41969993#41969993", "title": "Gorm - Has One relation with anonymous field", "body": "<p>I was having a similar issue, but I discovered it was an issue with anonymous types.</p>\n\n<p>If you have </p>\n\n<pre><code>type Thing struct {\n    Identifier string\n    ext\n}\n\ntype ext struct {\n    ExtValue string\n}\n</code></pre>\n\n<p>gorm won't be able to find <code>ext</code>, so it won't appear in the table at all.  </p>\n\n<p>However, if you have </p>\n\n<pre><code>type Thing struct {\n    Identifier string\n    Ext\n}\n\ntype Ext struct {\n    ExtValue string\n}\n</code></pre>\n\n<p><code>ExtValue</code> will appear in the table as a normal string, as if it were a part of the <code>Thing</code> object.  </p>\n\n<p>If you want to make a has-one relationship, you have to include an id in your struct.  So the above example would look like this:</p>\n\n<pre><code>type Thing struct {\n    Identifier string\n    Ext\n}\n\ntype Ext struct {\n    ThingId  uint\n    ExtValue string\n}\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485908963, "creation_date": 1479735258, "last_edit_date": 1479742854, "question_id": 40721475, "link": "https://stackoverflow.com/questions/40721475/gorm-has-one-relation-with-anonymous-field", "title": "Gorm - Has One relation with anonymous field", "body": "<p>I use Golang and GORM.\nI have a <code>User</code> structure which has one <code>Association</code>.</p>\n\n<pre><code>type User struct {\n    ID       int\n    ...\n}\n\ntype Association struct {\n    ID       int\n    UserID   int\n}\n</code></pre>\n\n<p>I also have an <code>AssoUser</code> structure, which is composed of a anonymous field <code>User</code>, and has a pointer to <code>Assocation</code>.</p>\n\n<pre><code>type AssoUser struct {\n    User\n    Asso *Association\n}\n</code></pre>\n\n<p>When I run </p>\n\n<pre><code>var assoUser AssoUser\nassoUser.Asso = &amp;Association{\n   Name : \"asso_name\",\n   ...\n}\nassoUser.Name = \"user_name\"\n...\n\n// filling the struct\ndb.Debug().Create(&amp;assoUser)\n</code></pre>\n\n<p>I expect it to create the <code>User</code> AND the <code>Association</code>, but it only creates the User.</p>\n\n<p>What am I doing wrong ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 1, "creation_date": 1479734441, "post_id": 40720039, "comment_id": 68669169, "body": "On what depends, whether you will get details or not? If you know that when you call the function, is better to have 2 different functions. If not, and OrderWith/WithoutDetails is nearly the same, you can write a function, func findOrder (Order, *[]Detail, error), that returns details or nil. Also you can put *Details to order. And also fine is return interface{}, or better interface, that returns you details."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1479753418, "post_id": 40720076, "comment_id": 68681341, "body": "Underscores in names are not idiomatic in Go.  Go uses CamelCase, not snake_case.  This is particularly important because, in your example, the interface <code>reDB</code> and the <code>my_print()</code> function within it are not exported, and thus cannot be accessed outside the defining package."}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1479806130, "post_id": 40720076, "comment_id": 68701584, "body": "Yep, I knew for the <code>CamelCase</code>, I wrote quickly, with my practice from C. But it has nothing to do with exported or not, only the first letter has something to do with, and <code>CamelCase</code> is not <code>PascalCase</code>. Plus here we don&#39;t care about exported or not, maybe he doesn&#39;t want to export these func / var ;)"}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": true, "score": 0, "last_activity_date": 1479731224, "last_edit_date": 1479731224, "creation_date": 1479730884, "answer_id": 40720076, "question_id": 40720039, "link": "https://stackoverflow.com/questions/40720039/how-to-make-possible-to-return-structs-of-different-types-from-one-function-with/40720076#40720076", "title": "How to make possible to return structs of different types from one function with Golang?", "body": "<p>You can use <code>interface{}</code></p>\n\n<pre><code>func queryDb() interface{}{\n\n}\n</code></pre>\n\n<p>But the better will be if your 2 type of struct can have a common function, that can satisfy a common interface, it will be cleaner.\nExample : </p>\n\n<pre><code>type s1 struct{\n  id int\n  name string\n}\n\ntype s2 struct{\n  id int\n  age int\n}\n\ntype reDB interface {\n  my_print()\n}\n\nfunc (r *s1) my_print(){\n  fmt.Print(s1.id)\n}\n\nfunc (r *s2) my_print(){\n  fmt.Print(s1.id)\n}\n\nfunc queryDb() reDB{\n ...\n}\n</code></pre>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 865, "favorite_count": 2, "accepted_answer_id": 40720076, "answer_count": 1, "score": 1, "last_activity_date": 1479731224, "creation_date": 1479730720, "question_id": 40720039, "link": "https://stackoverflow.com/questions/40720039/how-to-make-possible-to-return-structs-of-different-types-from-one-function-with", "title": "How to make possible to return structs of different types from one function with Golang?", "body": "<p>I have a function which queries database, then, depending on result form it, can create a struct <code>OrderWithoutDetails</code> or <code>OrderWithDetails</code> depending on the presence of details about the order.</p>\n\n<p>How do I make the function to be able to return result of both types?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 0, "creation_date": 1479733814, "post_id": 40719846, "comment_id": 68668756, "body": "It works if we use ` \\n ` for command-line arguments"}, {"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "reply_to_user": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "edited": false, "score": 0, "creation_date": 1479808019, "post_id": 40719846, "comment_id": 68702835, "body": "Oh dear - seems one of the previous respondents deleted their comment, then downvoted this question, then accessed my profile and downvoted all my previous questions :D Poor John"}], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "edited": false, "score": 0, "creation_date": 1479735087, "post_id": 40721174, "comment_id": 68669604, "body": "Great answer. Thanks for that."}], "tags": [], "owner": {"reputation": 312, "user_id": 4920026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KR0NK.jpg?s=128&g=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4920026/priyanka"}, "is_accepted": true, "score": 1, "last_activity_date": 1479735380, "last_edit_date": 1479735380, "creation_date": 1479734370, "answer_id": 40721174, "question_id": 40719846, "link": "https://stackoverflow.com/questions/40719846/cmd-line-parameter-string-contains-behaving-differently-from-hardcoded-parameter/40721174#40721174", "title": "cmd line parameter string.Contains behaving differently from hardcoded parameter", "body": "<p>It behaves differently because in hardcoded \\n is considered as new line parameter.\nAnd in command line arguments , argument type is string, where given condition is for \"\\n\" which is considered as new line parameter.\nSimply ` \\n   compaires with two consecutive characters \"\\\" and \"n\" not with \"\\n\" a new line character.  </p>\n\n<p>So for command line arguments use,  </p>\n\n<pre><code>if strings.Contains(os.Args[1], `\\n`) == false {\n        panic(errors.New(\"The parameter string should contain a new line.\"))\n    }\n</code></pre>\n\n<p>Reference : <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#String_literals</a></p>\n\n<blockquote>\n  <p>Raw string literals are character sequences between back quotes, as in <code>foo</code>. Within the quotes, any character may appear except back quote. The value of a raw string literal is the string composed of the uninterpreted (implicitly UTF-8-encoded) characters between the quotes; in particular, backslashes have no special meaning and the string may contain newlines.</p>\n</blockquote>\n"}], "owner": {"reputation": 574, "user_id": 1652623, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/AbSax.jpg?s=128&g=1", "display_name": "Airomega", "link": "https://stackoverflow.com/users/1652623/airomega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 40721174, "answer_count": 1, "score": 0, "last_activity_date": 1479738430, "creation_date": 1479730183, "last_edit_date": 1479738430, "question_id": 40719846, "link": "https://stackoverflow.com/questions/40719846/cmd-line-parameter-string-contains-behaving-differently-from-hardcoded-parameter", "title": "cmd line parameter string.Contains behaving differently from hardcoded parameter", "body": "<p>I'm looking to get some clarification on why these two strings.Contains() calls behave differently. </p>\n\n<pre><code>package main\n\nimport (\n    \"strings\"\n    \"os\"\n    \"errors\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    hardcoded := \"col1,col2,col3\\nval1,val2,val3\"\n    if strings.Contains(hardcoded, \"\\n\") == false {\n        panic(errors.New(\"The hardcoded string should contain a new line\"))\n    }\n    fmt.Println(\"New line found in hardcoded string\")\n\n    if len(os.Args) == 2 {\n        fmt.Println(\"parameter:\", os.Args[1])\n        if strings.Contains(os.Args[1], \"\\n\") == false {\n            panic(errors.New(\"The parameter string should contain a new line.\"))\n        }\n        fmt.Println(\"New line found in parameter string\")\n    }\n\n}\n</code></pre>\n\n<p>If I run this with </p>\n\n<pre><code>go run input-tester.go col1,col2,col3\\\\nval1,val2,val3\n</code></pre>\n\n<p>I get the following </p>\n\n<pre><code>New line found in hardcoded string\nparameter: col1,col2,col3\\nval1,val2,val3\npanic: The parameter string should contain a new line.\n\ngoroutine 1 [running]:\npanic(0x497100, 0xc42000e310)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\nmain.main()\n    /home/user/Desktop/input-tester.go:21 +0x343\nexit status 2\n</code></pre>\n\n<p>I can see that the string printed out is the same format as the string that is hardcoded yet the string.Contains() doesn't find the \"\\n\". </p>\n\n<p>I'm guessing this is an oversight on my part. Can anyone explain what I'm missing or misunderstanding?</p>\n"}, {"tags": ["postgresql", "go", "docker", "docker-compose", "dockerfile"], "comments": [{"owner": {"reputation": 17055, "user_id": 164966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c72f100bc09518cd468b9fe146f1f22?s=128&d=identicon&r=PG", "display_name": "R0MANARMY", "link": "https://stackoverflow.com/users/164966/r0manarmy"}, "edited": false, "score": 0, "creation_date": 1479750986, "post_id": 40717975, "comment_id": 68680117, "body": "Are you able to connect to postgres using psql and verify that the database exists?"}], "answers": [{"comments": [{"owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "edited": false, "score": 0, "creation_date": 1479803686, "post_id": 40721788, "comment_id": 68700027, "body": "I try this too (i will keept this syntax thx), but it wasn&#39;t in fact a problem of environment !"}], "tags": [], "owner": {"reputation": 949, "user_id": 1826943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sJ7zF.jpg?s=128&g=1", "display_name": "hecko84", "link": "https://stackoverflow.com/users/1826943/hecko84"}, "is_accepted": false, "score": 1, "last_activity_date": 1479736507, "last_edit_date": 1479736507, "creation_date": 1479736194, "answer_id": 40721788, "question_id": 40717975, "link": "https://stackoverflow.com/questions/40717975/extend-docker-postgres-image-to-create-extra-database/40721788#40721788", "title": "Extend docker postgres image to create extra database", "body": "<p>If you want to create the DB by passing ENV variables using docker-compose you can specify something like</p>\n\n<pre><code>  postgres:\n    container_name: postgres\n    image: library/postgres\n    ports:\n      - \"5432:5432\"\n    environment:\n      - POSTGRES_DATABASE=docker\n      - POSTGRES_USER=docker\n      - POSTGRES_PASSWORD=docker\n      - POSTGRES_ADMIN_PASSWORD=docker\n</code></pre>\n\n<p>in your compose YML file.\nThis should create you a postgres container with an DB docker with user/pwd docker, no need for your own dockerfile anymore (so you can use any postgres image that supports this behavior)</p>\n\n<p>After running compose (and if it doesn't work as you expect) you should have a look at the logs if your postgres container is working at all, or if there is an issue with your app.</p>\n"}, {"tags": [], "owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "is_accepted": true, "score": 3, "last_activity_date": 1479803515, "creation_date": 1479803515, "answer_id": 40737048, "question_id": 40717975, "link": "https://stackoverflow.com/questions/40717975/extend-docker-postgres-image-to-create-extra-database/40737048#40737048", "title": "Extend docker postgres image to create extra database", "body": "<p>It was a problem of docker volume. </p>\n\n<p>I have to <code>docker volume rm postgresvolume</code> and do again a <code>docker-compose up --build</code></p>\n\n<p>It wasn't a problem of environment variables, but juste the fact that the init.sql was in cash and not run at the begining.  It's due to some test I make a the start of the project</p>\n"}], "owner": {"reputation": 905, "user_id": 2323245, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/692ba01c39a0306d91a706c1273ca840?s=128&d=identicon&r=PG", "display_name": "sbouaked", "link": "https://stackoverflow.com/users/2323245/sbouaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1280, "favorite_count": 0, "accepted_answer_id": 40737048, "answer_count": 2, "score": 4, "last_activity_date": 1479812116, "creation_date": 1479724212, "last_edit_date": 1495541623, "question_id": 40717975, "link": "https://stackoverflow.com/questions/40717975/extend-docker-postgres-image-to-create-extra-database", "title": "Extend docker postgres image to create extra database", "body": "<p>I've already seen this topic : <a href=\"https://stackoverflow.com/a/26599273/2323245\">https://stackoverflow.com/a/26599273/2323245</a></p>\n\n<p>But I have the following problem :</p>\n\n<pre><code>postgres_1  | FATAL:  role \"docker\" does not exist\napp_1       | Error: Could not establish a connection with the database\n</code></pre>\n\n<p>This is my docker-compose.yml file</p>\n\n<pre><code>version: \"2\"\n\nservices:\n  app:\n    build:\n      context: .\n      dockerfile: Dockerfiles/app.dockerfile\n    links:\n      - postgres\n    depends_on:\n      - postgres\n    ports:\n      - \"8080:8080\"\n    environment:\n      PORT: 8080\n    networks:\n      - neo_dev\n    restart: always\n\n  postgres:\n    build:\n          context: .\n          dockerfile: Dockerfiles/postgres.dockerfile\n    networks:\n      - neo_dev\n    volumes:\n      - postgresql:/var/lib/postgresql\n      # This needs explicit mapping due to https://github.com/docker-library/postgres/blob/4e48e3228a30763913ece952c611e5e9b95c8759/Dockerfile.template#L52\n      - postgresql_data:/var/lib/postgresql/data\n    ports:\n      - \"5430:5432\"  #in case you already have postgres running in your host machine\n\nnetworks:\n    neo_dev:\n      driver: bridge\n\nvolumes:\n  postgresql:\n  postgresql_data:\n</code></pre>\n\n<p>My postgres.dockerfile is </p>\n\n<pre><code>FROM library/postgres\n\nMAINTAINER Samir Bouaked \"sbouaked@neocasesoftware.com\"\n\nADD Dockerfiles/init.sql /docker-entrypoint-initdb.d/\n</code></pre>\n\n<p>And this is my init.sql file</p>\n\n<pre><code>CREATE USER docker with password 'docker';\nCREATE DATABASE docker;\nGRANT ALL PRIVILEGES ON DATABASE docker TO docker;\n</code></pre>\n\n<p>In my golang app, i'm trying to reach the database with</p>\n\n<pre><code>router.GET(\"/db\", func(c *gin.Context) {\n        db, err := sql.Open(\"postgres\", \"host=postgres port=5432 user=docker dbname=docker password=docker sslmode=disable\")\n        if err != nil {\n            log.Fatal(\"Error: The data source arguments are not valid - \" + err.Error())\n        }\n        err = db.Ping()\n\n        if err != nil {\n            log.Println(\"Error: Could not establish a connection with the database\")\n            c.String(http.StatusOK, \"hotstName : %s\\nDbStatus : %s\", os.Getenv(\"HOSTNAME\"), err)\n        } else {\n            c.String(http.StatusOK, \"\\nhotstName : %s\\nDbStatus : connection ok !\\n\", os.Getenv(\"HOSTNAME\"))\n        }\n        defer db.Close()\n    })\n</code></pre>\n\n<p>I tried different solutions like passing directly in the dockerfile env variables like that</p>\n\n<pre><code>ENV POSTGRES_USER docker\nENV POSTGRES_PASSWORD docker\nENV POSTGRES_DB docker\n</code></pre>\n\n<p>But have always the same result...\nFor more information you can check this repo <a href=\"https://github.com/neocase/docker-go-starter-kit\" rel=\"nofollow noreferrer\">https://github.com/neocase/docker-go-starter-kit</a></p>\n\n<p>I don't understand the problem</p>\n"}, {"tags": ["go", "server"], "comments": [{"owner": {"reputation": 565, "user_id": 438740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8538ea463355ac8e5abb1741541f5ca0?s=128&d=identicon&r=PG", "display_name": "xen", "link": "https://stackoverflow.com/users/438740/xen"}, "edited": false, "score": 0, "creation_date": 1479722024, "post_id": 40716869, "comment_id": 68661482, "body": "Are you saying you don&#39;t want people to access these images but other files in the same folder?"}, {"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "reply_to_user": {"reputation": 565, "user_id": 438740, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8538ea463355ac8e5abb1741541f5ca0?s=128&d=identicon&r=PG", "display_name": "xen", "link": "https://stackoverflow.com/users/438740/xen"}, "edited": false, "score": 0, "creation_date": 1479723182, "post_id": 40716869, "comment_id": 68662182, "body": "@xen I dont want people access to file in this folder with folder path"}, {"owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "edited": false, "score": 0, "creation_date": 1479725384, "post_id": 40716869, "comment_id": 68663554, "body": "It this your issue? <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/bStLPdIVM6w\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/bStLPdIVM6w</a>"}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1479734966, "post_id": 40718195, "comment_id": 68669524, "body": "but what should i do with this line : fs := http.FileServer(http.Dir(&quot;./assets&quot;)) ??"}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 2, "creation_date": 1479735243, "post_id": 40718195, "comment_id": 68669702, "body": "I think you have to replace <code>http.Dir(&quot;&#47;tmp&#47;&quot;)</code> with <code>http.Dir(&quot;.&#47;assets&quot;)</code>"}, {"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1479735620, "post_id": 40718195, "comment_id": 68669974, "body": "Ok it works perfectly but my api on this server no longer works, so should I make 2 servers?"}, {"owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "reply_to_user": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1479735806, "post_id": 40718195, "comment_id": 68670097, "body": "I have no idea how your server works, i can&#39;t tell you is you should or shouldn&#39;t have a second server. Maybe try to close this question and open a new one explaining your new problem !"}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": true, "score": 2, "last_activity_date": 1479732063, "last_edit_date": 1479732063, "creation_date": 1479724918, "answer_id": 40718195, "question_id": 40716869, "link": "https://stackoverflow.com/questions/40716869/prevent-access-to-files-in-folder-with-a-golang-server/40718195#40718195", "title": "prevent access to files in folder with a golang server", "body": "<p>If you want to block a directory using <code>http</code> package, maybe this will be useful to you :</p>\n\n<blockquote>\n  <p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/bStLPdIVM6w\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/bStLPdIVM6w</a></p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n  \"os\"\n)\n\ntype justFilesFilesystem struct {\n  fs http.FileSystem\n}\n\nfunc (fs justFilesFilesystem) Open(name string) (http.File, error) {\n  f, err := fs.fs.Open(name)\n  if err != nil {\n      return nil, err\n  }\n  return neuteredReaddirFile{f}, nil\n}\n\ntype neuteredReaddirFile struct {\n  http.File\n}\n\nfunc (f neuteredReaddirFile) Readdir(count int) ([]os.FileInfo, error) {\n  return nil, nil\n}\n\nfunc main() {\n  fs := justFilesFilesystem{http.Dir(\"/tmp/\")}\n  http.ListenAndServe(\":8080\", http.FileServer(fs))\n}\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "edited": false, "score": 0, "creation_date": 1479735072, "post_id": 40718649, "comment_id": 68669593, "body": "it&#39;s not exactly what i need know but thanks, I&#39;m sure one day I&#39;ll need this example :)"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 1, "last_activity_date": 1479726409, "creation_date": 1479726409, "answer_id": 40718649, "question_id": 40716869, "link": "https://stackoverflow.com/questions/40716869/prevent-access-to-files-in-folder-with-a-golang-server/40718649#40718649", "title": "prevent access to files in folder with a golang server", "body": "<p>A little wrapper over FileServer() solves your problem, now you have to add some sort of logic to do Authorization, it looks like you have unique names, that's good, so I just filter the image name for you creating a map of names, now you can add something more dynamic like a key/store(memcached, redis. etc.) Hope you can follow the comments</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"strings\"\n)\n\n// put the allowed hashs or keys here\n// you may consider put them in a key/value store\n//\nvar allowedImages = map[string]bool{\n    \"key-abc.jpg\": true,\n    \"key-123.jpg\": true,\n}\n\nfunc main() {\n\n    http.Handle(\"/Images/\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\n        // here we can do any kind of checking, in this case we'll just split the url and\n        // check if the image name is in the allowedImages map, we can check in a DB or something\n        //\n        parts := strings.Split(r.URL.Path, \"/\")\n        imgName := parts[len(parts)-1]\n\n        if _, contains := allowedImages[imgName]; !contains { // if the map contains the image name\n\n            log.Printf(\"Not found image: %q path: %s\\n\", imgName, r.URL.Path)\n\n            // if the image is not found we write a 404\n            //\n            // Bonus: we don't list the directory, so nobody can know what's inside :)\n            //\n            http.NotFound(w, r)\n            return\n        }\n\n        log.Printf(\"Serving allowed image: %q\\n\", imgName)\n\n        fileServer := http.StripPrefix(\"/Images/\", http.FileServer(http.Dir(\"./assets\")))\n\n        fileServer.ServeHTTP(w, r) // StripPrefix() and FileServer() return a Handler that implements ServerHTTP()\n    }))\n\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ehrd_AWXim\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ehrd_AWXim</a></p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3088, "favorite_count": 0, "accepted_answer_id": 40718195, "answer_count": 2, "score": 2, "last_activity_date": 1479732063, "creation_date": 1479720867, "question_id": 40716869, "link": "https://stackoverflow.com/questions/40716869/prevent-access-to-files-in-folder-with-a-golang-server", "title": "prevent access to files in folder with a golang server", "body": "<p>I've a server in golang who handle folder path like that : </p>\n\n<pre><code>fs := http.FileServer(http.Dir(\"./assets\"))\nhttp.Handle(\"/Images/\", fs)\nhttp.ListenAndServe(\":8000\", nil)\n</code></pre>\n\n<p>But in this folder there are privates images, and it shouldn't be possible to access files. So how can i secure image access and prevent anybody to access content of folder.</p>\n\n<p>like that for example : </p>\n\n<p><a href=\"https://i.stack.imgur.com/6zljU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6zljU.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1479747942, "post_id": 40715889, "comment_id": 68678344, "body": "For the record, this modified version proves that it&#39;s the <code>fmt.Println(err)</code> statement that calls <code>.Error()</code>.  I use <code>fmt.Printf(&quot;%#v&quot;)</code> to inspect the contents of the error structure without actually invoking its <code>.Error()</code> method, and I moved the setting of the timestamp to the <code>.Error()</code> method itself so you can see it change when <code>.Error()</code> is called.  <a href=\"https://play.golang.org/p/3UN98EoiYs\" rel=\"nofollow noreferrer\">play.golang.org/p/3UN98EoiYs</a>"}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 0, "creation_date": 1479787564, "post_id": 40715889, "comment_id": 68693807, "body": "Specifically, the line that&#39;s calling Error() is here (link to master branch HEAD at the time of this comment): <a href=\"https://github.com/golang/go/blob/6f31abd23a6f768c21c8b308f355f3a1bae521d2/src/fmt/print.go#L584\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "is_accepted": true, "score": 2, "last_activity_date": 1479717686, "creation_date": 1479717686, "answer_id": 40715889, "question_id": 40715792, "link": "https://stackoverflow.com/questions/40715792/why-does-returning-a-type-that-implements-error-interface-call-the-error-metho/40715889#40715889", "title": "Why does returning a type that implements error interface call the Error() method automatically?", "body": "<p>Here <code>fmt.Println()</code> is responsible for calling <code>Error()</code> method not <code>run()</code>.</p>\n\n<p>Quoting from <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>The fmt package formats an error value by calling its <code>Error()</code> string\n  method.</p>\n  \n  <p>It is the error implementation's responsibility to summarize the\n  context. The error returned by os.Open formats as \"open /etc/passwd:\n  permission denied,\" not just \"permission denied.\" The error returned\n  by our Sqrt is missing information about the invalid argument.</p>\n</blockquote>\n\n<p>Hence, when you're trying to print <code>err</code> inside <code>main()</code> its <code>Error()</code> method is getting invoked.</p>\n\n<p>Replace it with something else, then you won't see it in output: <a href=\"https://play.golang.org/p/IqScH02iGu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IqScH02iGu</a></p>\n"}], "owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 383, "favorite_count": 0, "accepted_answer_id": 40715889, "answer_count": 1, "score": 0, "last_activity_date": 1608204329, "creation_date": 1479717299, "last_edit_date": 1608204329, "question_id": 40715792, "link": "https://stackoverflow.com/questions/40715792/why-does-returning-a-type-that-implements-error-interface-call-the-error-metho", "title": "Why does returning a type that implements error interface call the Error() method automatically?", "body": "<p>Link:\n<a href=\"https://play.golang.org/p/z50pUnAe4q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/z50pUnAe4q</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype MyError struct {\n    When time.Time\n    What string\n}\n\nfunc (e *MyError) Error() string {\n    return fmt.Sprintf(\"at %v, %s\",\n        e.When, e.What)\n}\n\nfunc run() error {\n    return &amp;MyError{\n        time.Now(),\n        \"it didn't work\",\n    }\n}\n\nfunc main() {\n    if err := run(); err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>I understand that the built in type <code>error</code> looks like this,</p>\n\n<pre><code>type error interface {\n    Error() string\n}\n</code></pre>\n\n<p>Meaning <code>MyError</code> implements <code>error</code>.\nThe <code>run()</code> method returns a pointer to <code>MyError</code> type. </p>\n\n<p>But the return type of <code>run()</code> method in the method signature is of type <code>error</code>.</p>\n\n<p>How does the return statement in <code>run()</code> automatically call the <code>Error()</code> method?</p>\n"}, {"tags": ["go", "google-cloud-datastore"], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 416, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1481037531, "creation_date": 1479717057, "last_edit_date": 1481037531, "question_id": 40715734, "link": "https://stackoverflow.com/questions/40715734/google-datastore-go-client-storing-dynamic-data", "title": "Google Datastore go client, storing dynamic data", "body": "<p>Our application provides functionality which enables a customer to create dynamic forms and business rules. We recently decided to explore Google infrastructures so we don't have to spend time tweaking and adjusting our infrastructure.</p>\n\n<p>Thus far, we have managed well using a NOSQL database such as arangodb to store random data sets through their JSON HTTP REST APIs, that stores any sort of data structure, so long as it is a valid JSON. However, Google data store go client library and Datastore doesn;t work with JSON and also imposes rules like no silce []type, no map map[type]type failing with errors such as <code>datastore: invalid Value type</code> e.t.c</p>\n\n<p>I explored option of implementing PropertyLoadSaver interface load/save functions with modifications to create PropertyList and Property to crate a []Property. Case below Collection is <code>type Collection map[string]interface{}</code> which holds an sort of data set</p>\n\n<pre><code>    func (m Collection) Save() ([]datastore.Property, error) {\n    data := []datastore.Property{}\n    for key, value := range m {\n        if util.IsSlice(value) {\n            props := datastore.PropertyList{}\n            for _, item := range value.([]string) {\n                props = append(props, datastore.Property{Name: key, Value: item})\n            }\n            data = append(data, datastore.Property{Name: key, Value: props})\n        } else {\n            data = append(data, datastore.Property{Name: key, Value: value, NoIndex: true})\n        }\n    }\n\n    json.NewEncoder(os.Stdout).Encode(data)\n\n    return data, nil\n}\n</code></pre>\n\n<p>Yes, we can create a struct which we can populate based on map data and save that to Datastore. We were however wondering if there possibly is an easier way to just receive a map and save it to Datastore with no added complexity.</p>\n\n<p>Alternative</p>\n\n<pre><code>type Person struct{\n Name string\n Surname string\n Addresses []Address\n ...\n}\n\ntype Address struct{\n  Type string\n  Detail string\n}\n</code></pre>\n\n<p>This <code>map[string]interface{}{Name:\"Kwasi\", Surname:\"Gyasi-Agyei\", Addresses:...}</code>  can than be marshaled into above struct to be saved by Datastore go client lib.</p>\n\n<p>Am however more interested in taking advantage of PropertList, []Property, unless that route is unnecessarily complex. What am basically asking is, which is the most appropriate route that offer the same type of flexibility as a schemaless database.</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "edited": false, "score": 0, "creation_date": 1479718599, "post_id": 40715285, "comment_id": 68659565, "body": "don&#39;t try to change <code>GOPATH</code> for each project, <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"nofollow noreferrer\">use <code>vendor</code> folder</a>"}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 6863221, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-f5m1FK2hI1s/AAAAAAAAAAI/AAAAAAAAABw/o6L7n6Vydlw/photo.jpg?sz=128", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6863221/matthias"}, "edited": false, "score": 4, "creation_date": 1479719183, "post_id": 40716061, "comment_id": 68659854, "body": "This is not very sufficient when you have a solution with different projects of different languages."}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "reply_to_user": {"reputation": 777, "user_id": 6863221, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-f5m1FK2hI1s/AAAAAAAAAAI/AAAAAAAAABw/o6L7n6Vydlw/photo.jpg?sz=128", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6863221/matthias"}, "edited": false, "score": 0, "creation_date": 1479720135, "post_id": 40716061, "comment_id": 68660362, "body": "What do you mean with different languages? GOPATH is only your workspace for yours golang projects. If you&#39;re using other languages, they&#39;re not affected by GOPATH env variable. If you&#39;re taking about versioning, the vendor directory is your solution."}, {"owner": {"reputation": 777, "user_id": 6863221, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-f5m1FK2hI1s/AAAAAAAAAAI/AAAAAAAAABw/o6L7n6Vydlw/photo.jpg?sz=128", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6863221/matthias"}, "edited": false, "score": 4, "creation_date": 1479731318, "post_id": 40716061, "comment_id": 68667015, "body": "Consider you are writing applications of many microservices each and in each one of them is written in <code>Go</code> the others in <code>C++</code>, <code>JavaScript</code>, whatever... . Then your workspace tree looks strange..."}, {"owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "edited": false, "score": 0, "creation_date": 1539926332, "post_id": 40716061, "comment_id": 92685413, "body": "helpful answer. this is kinda dumb design tho, it assumes you want all your <code>go</code> code in only one directory: <code>$GOPATH&#47;src</code>, but what if I want more than one <code>$GOPATH&#47;src</code> folder on my machine?"}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 5, "last_activity_date": 1479718400, "creation_date": 1479718400, "answer_id": 40716061, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project/40716061#40716061", "title": "Setting `GOPATH` for each vscode project", "body": "<p>The GOPATH is your workspace and it's divided in</p>\n\n<pre><code>GOPATH/\n    |- bin/\n    |- pkg/\n    |- src/ &lt;--- your projects are saved here\n        |- .../my_project1\n        |- .../my_project2\n</code></pre>\n\n<p>With this separation, your don't need to set a new GOPATH for each project. I recommend you read <a href=\"https://golang.org/doc/code.html\" rel=\"noreferrer\">How to Write Go Code</a></p>\n"}, {"tags": [], "owner": {"reputation": 18922, "user_id": 3633742, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/thyJX.jpg?s=128&g=1", "display_name": "n00dl3", "link": "https://stackoverflow.com/users/3633742/n00dl3"}, "is_accepted": true, "score": 3, "last_activity_date": 1479803015, "last_edit_date": 1479803015, "creation_date": 1479718983, "answer_id": 40716240, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project/40716240#40716240", "title": "Setting `GOPATH` for each vscode project", "body": "<p>Go 1.5 added the vendor directory that allows a per-project dependency management.</p>\n\n<blockquote>\n  <p>If there is a source directory d/vendor, then, when compiling a source file within the subtree rooted at d, import \"p\" is interpreted as import \"d/vendor/p\" if that path names a directory containing at least one file with a name ending in \u201c.go\u201d.</p>\n</blockquote>\n\n<p><a href=\"https://docs.google.com/document/d/1Bz5-UB7g2uPBdOx-rw5t9MxJwkfpx90cqG9AFL0JAYo/edit\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>This feature has been enabled by default with Go 1.6:</p>\n\n<blockquote>\n  <p>Go 1.5 introduced experimental support for a \u201cvendor\u201d directory that was enabled by an environment variable. In Go 1.6, the feature is now enabled by default. </p>\n</blockquote>\n\n<p><a href=\"https://blog.golang.org/go1.6\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>Even with the 1.6 version, depending on the tools you use, you might need to set the <code>GO15VENDOREXPERIMENT</code> environment variable to <code>1</code> (<code>export GO15VENDOREXPERIMENT=1</code> on unix-based OS)</p>\n"}, {"comments": [{"owner": {"reputation": 465, "user_id": 4772957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-MCsc5b0IGSE/AAAAAAAAAAI/AAAAAAAAAA8/u8deo9ORnnE/photo.jpg?sz=128", "display_name": "merito", "link": "https://stackoverflow.com/users/4772957/merito"}, "edited": false, "score": 0, "creation_date": 1539227731, "post_id": 44225017, "comment_id": 92427318, "body": "<code>inferGopath</code> with <code>toolsGopath</code> is great. Thx"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 465, "user_id": 4772957, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-MCsc5b0IGSE/AAAAAAAAAAI/AAAAAAAAAA8/u8deo9ORnnE/photo.jpg?sz=128", "display_name": "merito", "link": "https://stackoverflow.com/users/4772957/merito"}, "edited": false, "score": 0, "creation_date": 1539242342, "post_id": 44225017, "comment_id": 92432105, "body": "@merito Indeed, but note that all that is obolete with Go modules now (1.11+): <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules</a>. I have edited the answer accordingly."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 14, "last_activity_date": 1539242314, "last_edit_date": 1539242314, "creation_date": 1495958116, "answer_id": 44225017, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project/44225017#44225017", "title": "Setting `GOPATH` for each vscode project", "body": "<p>(Q2 2018:\nNote that with the <a href=\"https://stackoverflow.com/a/48914523/6309\">vgo project</a>, <code>GOPATH</code> might end up being deprecated in favor of a project-based workflow. That would avoid the manual project-based <code>GOPATH</code> I was proposing below, two years ago)</p>\n\n<p>With Go 1.11 (August 2018), <a href=\"https://golang.org/doc/go1.11#modules\" rel=\"noreferrer\"><code>GOPATH</code> can be optional, with <strong>modules</strong></a>.</p>\n\n<p>It is more and more supported with VSCode:</p>\n\n<ul>\n<li><a href=\"https://github.com/Microsoft/vscode-go/issues/1532#issuecomment-424906159\" rel=\"noreferrer\">vscode-go/issue 1532</a></li>\n<li>\"<a href=\"https://github.com/Microsoft/vscode-go/wiki/Go-modules-support-in-Visual-Studio-Code\" rel=\"noreferrer\">Go modules support in Visual Studio Code</a>\"</li>\n</ul>\n\n<hr>\n\n<p>In addition to vendor folder, you still can have one <code>GOPATH</code> per project.</p>\n\n<p>See \"<a href=\"https://github.com/Microsoft/vscode-go/wiki/GOPATH-in-the-VS-Code-Go-extension#gopath-from-goinfergopath-setting\" rel=\"noreferrer\"><code>GOPATH</code> from <code>go.inferGopath</code> setting</a>\":</p>\n\n<blockquote>\n  <h2><code>GOPATH</code> from <code>go.inferGopath</code> setting</h2>\n  \n  <p>Setting <code>go.inferGopath</code> overrides all of the above.<br>\n  If <code>go.inferGopath</code> is set to <code>true</code>, the extension will try to infer the <code>GOPATH</code> from the path of the workspace i.e. the directory opened in vscode. It searches upwards in the path for the <code>src</code> directory, and sets <code>GOPATH</code> to one level above that.</p>\n  \n  <p>For example, if your project looks like <code>/aaa/bbb/ccc/src/...</code>, then opening the directory <code>/aaa/bbb/ccc/src</code> (or anything below that) will cause the extension to search upwards, find the <code>src</code> component in the path, and set the <code>GOPATH</code> to one level above that i.e. <code>GOPATH=/aaa/bbb/ccc</code>.</p>\n  \n  <p>This setting is useful when you are working on different Go projects which have different <code>GOPATH</code>s. Instead of setting the <code>GOPATH</code> in the workspace settings of each project or setting all the paths as <code>;/:</code> separated string, you can just set <code>go.inferGopath</code> to <code>true</code> and the extension uses the right <code>GOPATH</code> automatically.  </p>\n  \n  <h2><code>GOPATH</code> for installing the Go tools using <code>go.toolsGopath</code></h2>\n  \n  <p>By default, all the dependent Go tools are used from the <code>GOPATH</code> derived from the above logic.<br>\n  If they are available on your <code>PATH</code>, the <code>PATH</code> is used to locate the Go tools.<br>\n  If the Go tools are not in your path, you might end up with the same Go tools installed in each of your <code>GOPATH</code>s.<br>\n  To prevent the Go tools from cluttering your <code>GOPATH</code>, use the <code>go.toolsGopath</code> setting to provide a separate location for the Go tools.</p>\n  \n  <p>The first time you set go.toolsGopath, you will have to run <code>Go: Install Tools</code> command so that the Go tools get installed in the provided location.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 6507135, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/969f23f049732f59611a6f667a76a560?s=128&d=identicon&r=PG&f=1", "display_name": "bmalhi", "link": "https://stackoverflow.com/users/6507135/bmalhi"}, "edited": false, "score": 0, "creation_date": 1597285899, "post_id": 51112258, "comment_id": 112084960, "body": "This is correct to setup the default GOPATH for VS Code. As in my case I had a different GOPATH while VSCODE was still pointing to the old GOPATH. Thus, I added this config and <code>\u201cgo.toolsGopath\u201d: \u201c&#47;Users&#47;user&#47;go&#47;\u201d</code> to tell VS Code to install tools in correct GOPATH. Thanks for sharing"}], "tags": [], "owner": {"reputation": 831, "user_id": 1048072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53725fd0dee3ecda7cab96db0c5fd0b?s=128&d=identicon&r=PG", "display_name": "hustljian", "link": "https://stackoverflow.com/users/1048072/hustljian"}, "is_accepted": false, "score": 2, "last_activity_date": 1530339257, "creation_date": 1530339257, "answer_id": 51112258, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project/51112258#51112258", "title": "Setting `GOPATH` for each vscode project", "body": "<p>set <code>workspace settings</code>, in windows:</p>\n\n<ol>\n<li>goto settings: <code>ctrl+,</code></li>\n<li><p>set workspace setting:</p>\n\n<pre><code>{ \n     \"go.gopath\": \"d:\\\\gopath;E:\\\\src\"\n}\n</code></pre></li>\n</ol>\n\n<p>use <code>;</code> for multiple path</p>\n\n<ol start=\"3\">\n<li>restart visual studio code to take effect.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 4499795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb1f069e2b69ae9cdb8216ab6b7e9fe?s=128&d=identicon&r=PG&f=1", "display_name": "Louis", "link": "https://stackoverflow.com/users/4499795/louis"}, "is_accepted": false, "score": 0, "last_activity_date": 1605675618, "creation_date": 1605675618, "answer_id": 64887352, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project/64887352#64887352", "title": "Setting `GOPATH` for each vscode project", "body": "<p>If your VSCode project directory is organized,</p>\n<ol>\n<li>go to Settings</li>\n<li>either search &quot;Infer Gopath&quot; or find this entry under Extensions/Go</li>\n<li>check the box</li>\n</ol>\n<p>Then VSCode infers GOPATH from your workspace root, which solves my problem immediately. I believe this is explained in other answers. I am posting this just to give a shorter version.</p>\n"}], "owner": {"reputation": 777, "user_id": 6863221, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-f5m1FK2hI1s/AAAAAAAAAAI/AAAAAAAAABw/o6L7n6Vydlw/photo.jpg?sz=128", "display_name": "Matthias", "link": "https://stackoverflow.com/users/6863221/matthias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30638, "favorite_count": 5, "accepted_answer_id": 40716240, "answer_count": 5, "score": 12, "last_activity_date": 1605675618, "creation_date": 1479715137, "question_id": 40715285, "link": "https://stackoverflow.com/questions/40715285/setting-gopath-for-each-vscode-project", "title": "Setting `GOPATH` for each vscode project", "body": "<p>Setting the <code>GOPATH</code> variable global as an enviroment variable works fine with Visual Studio Code.</p>\n\n<p>But setting a project specific variable globally doesn't seem very nice to me. Consider you have multiple <code>Go</code> projects, you would have to change this variable each time you, compile, debug, ... etc. a project.</p>\n\n<p>Is there a possibility to set the <code>GOPATH</code> variable as a project variable in Visual Studio Code? Ether in <code>settings.json</code> or <code>launch.json</code>?</p>\n"}, {"tags": ["video", "go", "video-encoding", "mjpeg"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1479733800, "post_id": 40715272, "comment_id": 68668746, "body": "Finished my MJPEG writer library. Please see edited answer."}], "answers": [{"comments": [{"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1479754021, "post_id": 40717258, "comment_id": 68681624, "body": "Hey, I am really excited about the package you built. I just got home from work and tried it. I get an avi file but it does not play. VLC reports the following error. <code>[00007fe028009478] avi demux error: no key frame set for track 0</code> If you want to check the my code: <a href=\"https://bitbucket.org/coder8/cam\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1479767704, "post_id": 40717258, "comment_id": 68688541, "body": "@user3017869 You have to keep open the <code>AviWriter</code> as long as you intend to add new image frames, and close it when you&#39;re done. Also, can you play the video with <a href=\"http://www.mplayerhq.hu/design7/news.html\" rel=\"nofollow noreferrer\">mplayer</a>? Because I tested it with mplayer and there were no errors (<code>sudo apt install mplayer</code>)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1479770091, "post_id": 40717258, "comment_id": 68689371, "body": "@user3017869 Added an example program with images and result video. Please check that: <a href=\"https://github.com/icza/mjpeg/tree/master/example\" rel=\"nofollow noreferrer\">example</a>"}, {"owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "edited": false, "score": 0, "creation_date": 1479835014, "post_id": 40717258, "comment_id": 68721430, "body": "Total brainfart, I had the mjpeg.New func in the continuous for loop. And I ended up with a single frame video. Your solution worked gr8 from the very beginning. Ty"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1479734792, "last_edit_date": 1479734792, "creation_date": 1479721933, "answer_id": 40717258, "question_id": 40715272, "link": "https://stackoverflow.com/questions/40715272/create-video-from-camera-frames/40717258#40717258", "title": "Create video from camera frames", "body": "<p>The easiest would be to save your JPEG images in a video file of format <a href=\"https://en.wikipedia.org/wiki/Motion_JPEG\" rel=\"nofollow noreferrer\">MJPEG</a>, which is a simple video format consisting a series of JPEG images.</p>\n\n<p>You may turn to different ready-to-use encoders to turn a series of JPEG images into an MJPEG (or any other format) video file, such as <a href=\"https://www.ffmpeg.org/\" rel=\"nofollow noreferrer\">ffmpeg</a>. Using <code>ffmpeg</code>, you could do it with the following command:</p>\n\n<pre><code>ffmpeg -r 2 -i \"%02d.jpg\" -vcodec mjpeg test.avi\n</code></pre>\n\n<p>If you want to do it in Go, you may use the dead-simple <a href=\"https://github.com/icza/mjpeg\" rel=\"nofollow noreferrer\"><code>github.com/icza/mjpeg</code></a> package (<em>disclosure: I'm the author</em>).</p>\n\n<p>Let's see an example how to turn the JPEG files <code>1.jpg</code>, <code>2.jpg</code>, ..., <code>10.jpg</code> into a movie file:</p>\n\n<pre><code>checkErr := func(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\n// Video size: 200x100 pixels, FPS: 2\naw, err := mjpeg.New(\"test.avi\", 200, 100, 2)\ncheckErr(err)\n\n// Create a movie from images: 1.jpg, 2.jpg, ..., 10.jpg\nfor i := 1; i &lt;= 10; i++ {\n    data, err := ioutil.ReadFile(fmt.Sprintf(\"%d.jpg\", i))\n    checkErr(err)\n    checkErr(aw.AddFrame(data))\n}\n\ncheckErr(aw.Close())\n</code></pre>\n"}], "owner": {"reputation": 393, "user_id": 3017869, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bdd06e12c2e59b5d2b9ec7328b51c190?s=128&d=identicon&r=PG&f=1", "display_name": "user3017869", "link": "https://stackoverflow.com/users/3017869/user3017869"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3539, "favorite_count": 0, "accepted_answer_id": 40717258, "answer_count": 1, "score": 2, "last_activity_date": 1479734792, "creation_date": 1479715073, "last_edit_date": 1479734005, "question_id": 40715272, "link": "https://stackoverflow.com/questions/40715272/create-video-from-camera-frames", "title": "Create video from camera frames", "body": "<p>I've been playing around with v4l2 and I finally managed to connect to my laptop's camera and set it to stream. </p>\n\n<p>At the moment I save the frames as <code>1.jpg</code>, <code>2.jpg</code> etc. </p>\n\n<p>Thinking on a basic level, I need a storage container for those jpegs and then a video player runs the container contents in sequence and I get video.</p>\n\n<p>I assume the video format is going to be my container.</p>\n\n<p>How do I create and write to one? </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1479735213, "creation_date": 1479735213, "answer_id": 40721455, "question_id": 40714880, "link": "https://stackoverflow.com/questions/40714880/how-do-i-change-the-import-file/40721455#40721455", "title": "How do I change the import file?", "body": "<p>The problem here is that your <code>github.com/aws/aws-sdk-go/aws/session</code> package is <em>vendored</em>, it is loaded from the folder <code>stash/cloud/sphinx/vendor/github.com/aws/aws-sdk-go/aws</code>.</p>\n\n<p>But the function you want to pass it: <code>iam.New()</code> is not vendored, it does not come from the same vendor folder (<code>stash/cloud/sphinx/vendor/xxx</code>) but it comes directly from <code>github.com/aws/aws-sdk-go/service/iam</code>.</p>\n\n<p>Either put both packages under the same vendor folder, or none. It is possible that one of your dependency tool does this, (e.g. <code>glide</code>), in which case you should instruct your tool to handle both as vendored.</p>\n"}], "owner": {"reputation": 421, "user_id": 6862012, "user_type": "registered", "accept_rate": 18, "profile_image": "https://www.gravatar.com/avatar/f6e2aaae0112ecfad3fed2ba18452b7f?s=128&d=identicon&r=PG&f=1", "display_name": "John Dui", "link": "https://stackoverflow.com/users/6862012/john-dui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1479735213, "creation_date": 1479713412, "question_id": 40714880, "link": "https://stackoverflow.com/questions/40714880/how-do-i-change-the-import-file", "title": "How do I change the import file?", "body": "<p>I have the following function in golang: </p>\n\n<pre><code>import (\n    \"github.com/aws/aws-sdk-go/service/iam\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"fmt\"\n)\nfunc NewIAM() *SphinxIAM {\n//  awsConfig := aws.NewConfig()\n    sess, err := session.NewSession()\n    if err != nil {\n        fmt.Println(\"Failed to create session,\", err)\n        return nil\n    }\n    session := &amp;SphinxIAM{iam: iam.New(sess)}\n    return session\n}\n</code></pre>\n\n<p>Now, I am getting the following error when I run this: </p>\n\n<pre><code>cannot use sess (type *session.Session) as type \"github.com/aws/aws-sdk-go/aws/client\".ConfigProvider in argument to iam.New:\n    *session.Session does not implement \"github.com/aws/aws-sdk-go/aws/client\".ConfigProvider (wrong type for ClientConfig method)\n        have ClientConfig(string, ...*\"stash/cloud/sphinx/vendor/github.com/aws/aws-sdk-go/aws\".Config) \"stash/cloud/sphinx/vendor/github.com/aws/aws-sdk-go/aws/client\".Config\n        want ClientConfig(string, ...*\"github.com/aws/aws-sdk-go/aws\".Config) \"github.com/aws/aws-sdk-go/aws/client\".Config\n</code></pre>\n\n<p>I have to change the method getting imported but how do I exactly do that?</p>\n\n<p>Thanks! </p>\n"}, {"tags": ["go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1479719144, "last_edit_date": 1479719144, "creation_date": 1479718739, "answer_id": 40716175, "question_id": 40714378, "link": "https://stackoverflow.com/questions/40714378/how-to-extend-a-template-in-go/40716175#40716175", "title": "How to extend a template in go?", "body": "<p>You can only include / insert <a href=\"https://golang.org/pkg/text/template/#hdr-Associated_templates\" rel=\"nofollow noreferrer\">associated templates</a>. </p>\n\n<p>If you have multiple template files, use <a href=\"https://golang.org/pkg/html/template/#ParseFiles\" rel=\"nofollow noreferrer\"><code>template.ParseFiles()</code></a> or <a href=\"https://golang.org/pkg/html/template/#ParseGlob\" rel=\"nofollow noreferrer\"><code>template.ParseGlob()</code></a> to parse them <em>all</em>, and the result template will have all the templates, already associated, so they can refer to each other.</p>\n\n<p>If you do use the above functions to parse your templates, then the reason why it can't find <code>likebar.tmpl</code> is because you are referring to it by an invalid name (e.g. missing folder name).</p>\n\n<p>When parsing from <code>string</code> source, you may use the <a href=\"https://golang.org/pkg/html/template/#Template.Parse\" rel=\"nofollow noreferrer\"><code>Template.Parse()</code></a> method, which also associates nested templates to the top level template.</p>\n\n<p>See these 2 working examples:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Parse(templ1))\n    if err := t.Execute(os.Stdout, nil); err != nil {\n        panic(err)\n    }\n\n    t2 := template.Must(template.New(\"\").Parse(templ2))\n    template.Must(t2.Parse(templ2Like))\n    if err := t2.Execute(os.Stdout, nil); err != nil {\n        panic(err)\n    }\n}\n\nconst templ1 = `Base template #1\nAnd included one: {{template \"likebar\"}}\n{{define \"likebar\"}}I'm likebar #1.{{end}}\n`\n\nconst templ2 = `Base template #2\nAnd included one: {{template \"likebar\"}}\n`\n\nconst templ2Like = `{{define \"likebar\"}}I'm likebar #2.{{end}}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/ozf4sUVYuj\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Base template #1\nAnd included one: I'm likebar #1.\n\nBase template #2\nAnd included one: I'm likebar #2.\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2643, "favorite_count": 1, "accepted_answer_id": 40716175, "answer_count": 1, "score": 1, "last_activity_date": 1479719144, "creation_date": 1479711118, "last_edit_date": 1479712878, "question_id": 40714378, "link": "https://stackoverflow.com/questions/40714378/how-to-extend-a-template-in-go", "title": "How to extend a template in go?", "body": "<p>Here is the problem: There are several <code>article</code>s on each page's <code>content</code> section and I'd like to insert a <code>likebar</code> template below each article. </p>\n\n<p>So the <code>base.tmpl</code> is like:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;head&gt;    \n    {{template \"head.tmpl\" .}}\n  &lt;/head&gt;\n  &lt;body&gt;    \n    {{template \"content.tmpl\" .}}   \n   &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>and in <code>article.tmpl</code> I want to have :</p>\n\n<pre><code>    {{define \"content\"}}    \n          &lt;div&gt;article 1 \n             {{template \"likebar.tmpl\" .}} \n          &lt;/div&gt; \n          &lt;div&gt;article 2\n             {{template \"likebar.tmpl\" .}} \n         &lt;/div&gt;\n       ... //these divs are generated dynamically\n    {{end}}\n</code></pre>\n\n<p>How can I achieve this with <code>html/template</code>? \nI have tried to insert a <code>{{template \"iconbar\" .}}</code> in <code>base.tmpl</code> and then nested <code>{{template \"likebar.tmpl\" .}}</code> inside <code>{{define  \"content\"</code> but it failed with:</p>\n\n<blockquote>\n  <p>Template File Error: html/template:base.tmpl:122:12: no such template\n  \"likebar.tmpl\"</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479698601, "post_id": 40712193, "comment_id": 68652499, "body": "The first call to <code>sc.clone()</code> gives the error you&#39;re seeing, and not the call in <code>cloneAndGetName</code>. You can replace main with <code>sc := &amp;SubClass{}; sc.clone()</code> to verify."}, {"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479700807, "post_id": 40712193, "comment_id": 68652950, "body": "Not sure about that, Paul.  If I comment <code>fmt.Printf(&quot;-&gt; %s\\n&quot;, sc.clone().getName())</code>, the error continues."}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479702398, "post_id": 40712193, "comment_id": 68653277, "body": "Both are erroneous, but the one that appears first (the <code>sc.clone()</code> in main) causes the error you&#39;re seeing. If you comment it out, you get the same error from the other command. The text of your question suggested that you believed that only the second (the code in <code>cloneAndGetName</code>) causes the error, and that &quot;the call to <code>clone</code> in <code>main</code> works perfectly, naturally.&quot;"}, {"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479702841, "post_id": 40712193, "comment_id": 68653401, "body": "Commenting out the call to <code>sc.cloneAndGetName</code> and leaving in <code>sc.clone().getName()</code> in main, does work.  (I did find a naming error in my originally posted code; though; fixed now.)"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479738772, "post_id": 40712193, "comment_id": 68672106, "body": "yes, now it works after you changed the code :P"}, {"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1479741401, "post_id": 40712193, "comment_id": 68673975, "body": "Again, my apologies for that.  Giving incorrect example code does nothing when I&#39;m asking for help.  Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479702295, "post_id": 40712365, "comment_id": 68653257, "body": "My apologies; I had some incorrect method declarations, fixed above.  Implementing the methods in <code>BaseStruct</code>, however, does not invoke the overrides in <code>SubClass</code>, so the outcome isn&#39;t as expected."}, {"owner": {"reputation": 81, "user_id": 3386584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fedd018b3227bc4043934309da8c290?s=128&d=identicon&r=PG", "display_name": "duguying", "link": "https://stackoverflow.com/users/3386584/duguying"}, "reply_to_user": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479703104, "post_id": 40712365, "comment_id": 68653470, "body": "you should add implements for BaseStruct first"}, {"owner": {"reputation": 81, "user_id": 3386584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fedd018b3227bc4043934309da8c290?s=128&d=identicon&r=PG", "display_name": "duguying", "link": "https://stackoverflow.com/users/3386584/duguying"}, "reply_to_user": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479703168, "post_id": 40712365, "comment_id": 68653480, "body": "and then print will be  <code>-&gt;A</code>"}, {"owner": {"reputation": 81, "user_id": 3386584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fedd018b3227bc4043934309da8c290?s=128&d=identicon&r=PG", "display_name": "duguying", "link": "https://stackoverflow.com/users/3386584/duguying"}, "reply_to_user": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479703267, "post_id": 40712365, "comment_id": 68653512, "body": "i changed the code, try it."}], "tags": [], "owner": {"reputation": 81, "user_id": 3386584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fedd018b3227bc4043934309da8c290?s=128&d=identicon&r=PG", "display_name": "duguying", "link": "https://stackoverflow.com/users/3386584/duguying"}, "is_accepted": false, "score": 0, "last_activity_date": 1479703233, "last_edit_date": 1479703233, "creation_date": 1479699347, "answer_id": 40712365, "question_id": 40712193, "link": "https://stackoverflow.com/questions/40712193/interface-method-cant-be-found-on-subclass-from-super-class/40712365#40712365", "title": "Interface method can&#39;t be found on subclass from super class", "body": "<p>you should implement the function in the interface first.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype BaseItf1 interface {\n    getName() string\n    clone() *BaseStruct\n}\n\ntype BaseStruct struct {\n    BaseItf1\n}\n\nfunc (bs *BaseStruct) cloneAndGetName() string {\n    sc := bs.clone()\n    return sc.getName()\n}\n\nfunc (bs *BaseStruct) getName() string {\n    return \"\"\n}\n\nfunc (bs *BaseStruct) clone() *BaseStruct {\n    return nil\n}\n\ntype SubClass struct {\n    BaseStruct\n}\n\nfunc (sc *SubClass) getName() string {\n    return \"A\"\n}\n\nfunc (sc *SubClass) clone() *SubClass {\n    return &amp;SubClass{}\n}\n\nfunc main() {\n    sc := &amp;SubClass{}\n    fmt.Printf(\"-&gt; %s\\n\", sc.clone().getName())\n    fmt.Printf(\"-&gt; %s\\n\", sc.cloneAndGetName())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479702434, "post_id": 40712482, "comment_id": 68653280, "body": "I had some incorrect method declarations initially; have corrected them above.  However, following your example doesn&#39;t give the anticipated / desired error.  The method overrides in <code>SubClass</code> are not invoked, just the methods in <code>BaseStruct</code>."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 0, "last_activity_date": 1479700312, "creation_date": 1479700312, "answer_id": 40712482, "question_id": 40712193, "link": "https://stackoverflow.com/questions/40712193/interface-method-cant-be-found-on-subclass-from-super-class/40712482#40712482", "title": "Interface method can&#39;t be found on subclass from super class", "body": "<p>When you have a struct and you want to satisfy an interface you have to implement all the methods of that interface, it's different when you have an interface with other interface inside, for structs it's just having a field, if you check in the code <code>sc.BaseItf1</code> has a type  and value , so the call to <code>.clone()</code> and <code>.cloneAndGetName()</code> are failing. Implemented the methods here:</p>\n\n<pre><code>type BaseItf1 interface {\n    getName() string\n    clone() *BaseStruct\n}\n\ntype BaseStruct struct {\n    BaseItf1 // shortcut to BaseItf1 BaseItf1  &lt;fieldName&gt; &lt;Type&gt;\n}\n\nfunc (bs *BaseStruct) clone() *BaseStruct {\n    return &amp;BaseStruct{}\n}\n\nfunc (bs *BaseStruct) getName() string {\n    //\n    // maybe BaseStruct should have a field Name, not sure if you want to\n    // in that case we can do:\n    //\n    // return bs.Name\n\n    return \"a BaseStruct has no name\"\n}\n\nfunc (bs *BaseStruct) cloneAndGetName() string {\n    sc := bs.clone()\n    return sc.getName()\n}\n\ntype SubClass struct {\n    BaseStruct\n}\n\nfunc (sc *SubClass) methodA() string {\n  return \"A\"\n}\n\nfunc (sc *SubClass) methodB() *SubClass {\n  return &amp;SubClass{}\n}\n\nfunc main() {\n    sc := &amp;SubClass{}\n\n    fmt.Printf(\"type: %T and value: %v \\n\\n\", sc.BaseItf1, sc.BaseItf1)\n\n    fmt.Printf(\"-&gt; %q\\n\", sc.clone().getName())\n    fmt.Printf(\"-&gt; %q\\n\", sc.cloneAndGetName())\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/tHScVktrDZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tHScVktrDZ</a></p>\n"}, {"comments": [{"owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "edited": false, "score": 0, "creation_date": 1479741440, "post_id": 40712795, "comment_id": 68673998, "body": "Indeed.  I&#39;ve read numerous examples of exactly this problem, but I still failed to see it in my own code.  Thanks!"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1479703019, "last_edit_date": 1479703019, "creation_date": 1479702635, "answer_id": 40712795, "question_id": 40712193, "link": "https://stackoverflow.com/questions/40712193/interface-method-cant-be-found-on-subclass-from-super-class/40712795#40712795", "title": "Interface method can&#39;t be found on subclass from super class", "body": "<p><code>bs.clone()</code> fails because it's trying to call <code>bs.BaseItf1.clone()</code> and <code>bs.BaseItf1</code> is <code>nil</code>. You can't call the <code>clone()</code> defined for <code>*SubClass</code> from a variable of type <code>*BaseStruct</code>. Embedding types in Go is not the same as subclassing in other languages.</p>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1479749147, "creation_date": 1479749147, "answer_id": 40725938, "question_id": 40712193, "link": "https://stackoverflow.com/questions/40712193/interface-method-cant-be-found-on-subclass-from-super-class/40725938#40725938", "title": "Interface method can&#39;t be found on subclass from super class", "body": "<p>You're confusing embedding with interface fulfillment.  In its current state, you have a struct <code>SubClass</code> which embeds the struct <code>BaseStruct</code>, which then embeds an interface <code>BaseItf1</code>.  However, you have a problem: <code>SubClass</code> does not override the <code>cloneAndGetName()</code> method.  As such, this method is called on the embedded <code>BaseStruct</code> struct.  Embedded method calls are invoked using the <em>embedded struct</em> as the receiver, not the embedding struct.  The <code>BaseStruct</code> struct thus only has access to its own methods, not those of the <code>SubClass</code> struct wrapping it.  Since those methods themselves are the result of the embedded <code>BaseItf1</code> interface, <code>BaseStruct</code> calls those methods on that embedded interface, which is <code>nil</code>.  This, of course, triggers a segfault.</p>\n\n<p>In this case, it appears that you want to have a standard method defined on some base structure, but then be able to override that behavior with a subclass.  In this case, place an instance of <code>SubClass</code> into the interface field within the <code>BaseClass</code>:</p>\n\n<pre><code>sc := BaseStruct{&amp;SubClass{}}\nfmt.Printf(\"-&gt; %s\\n\", sc.clone().getName())\nfmt.Printf(\"-&gt; %s\\n\", sc.cloneAndGetName())\n</code></pre>\n\n<p>In this instance, <code>sc.closeAndGetName()</code> will be called on the <code>BaseStruct</code>, but the <code>clone()</code> and <code>getName()</code> calls will occur on the substruct.  </p>\n\n<p>You can even define default behavior if the interface is nil:</p>\n\n<pre><code>type BaseItf1 interface {\n  getName() string\n  clone() *BaseStruct\n}\n\ntype BaseStruct struct {\n  sub BaseItf1\n}\n\nfunc (bs *BaseStruct) cloneAndGetName() string {\n  sc := bs.clone()\n  return sc.getName()\n}\n\nfunc (bs *BaseStruct) getName() string {\n  if bs.sub != nil {\n    return bs.sub.getName()\n  }\n  // default behavior\n  return \"&lt;nil&gt;\"\n}\n\nfunc (bs *BaseStruct) clone() *BaseStruct {\n  if bs.sub != nil {\n    return bs.sub.clone()\n  }\n  // default behavior\n  return bs\n}\n\ntype SubClass struct {\n  // Doesn't need to embed BaseStruct\n  // ...\n}\n\nfunc (sc *SubClass) getName() string {\n  return \"A\"\n}\n\nfunc (sc *SubClass) clone() *BaseStruct {\n  return &amp;BaseStruct{&amp;SubClass{}}\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/CWdScZMXZ_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CWdScZMXZ_</a></p>\n"}], "owner": {"reputation": 660, "user_id": 1301815, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1094e58a243a72fe22550252633458cf?s=128&d=identicon&r=PG", "display_name": "object88", "link": "https://stackoverflow.com/users/1301815/object88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "closed_date": 1479777572, "accepted_answer_id": 40712795, "answer_count": 4, "score": -2, "last_activity_date": 1479749147, "creation_date": 1479697856, "last_edit_date": 1479701763, "question_id": 40712193, "link": "https://stackoverflow.com/questions/40712193/interface-method-cant-be-found-on-subclass-from-super-class", "closed_reason": "Duplicate", "title": "Interface method can&#39;t be found on subclass from super class", "body": "<p>Given this code...</p>\n\n<pre><code>type BaseItf1 interface {\n  getName() string\n  clone() *BaseStruct\n}\n\ntype BaseStruct struct {\n  BaseItf1\n}\n\nfunc (bs *BaseStruct) cloneAndGetName() string {\n  sc := bs.clone()\n  return sc.getName()\n}\n\ntype SubClass struct {\n  BaseStruct\n}\n\nfunc (sc *SubClass) getName() string {\n  return \"A\"\n}\n\nfunc (sc *SubClass) clone() *SubClass {\n  return &amp;SubClass{}\n}\n\nfunc main() {\n  sc := &amp;SubClass{}\n  fmt.Printf(\"-&gt; %s\\n\", sc.clone().getName())\n  fmt.Printf(\"-&gt; %s\\n\", sc.cloneAndGetName())\n}\n</code></pre>\n\n<p>I can't quite figure out why I'm getting this error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0xffffffff addr=0x0 pc=0x2004a]\n</code></pre>\n\n<p>The call to <code>clone</code> in <code>main</code> works perfectly, naturally.</p>\n\n<p>In <code>cloneAndGetName</code>, however, the <code>clone</code> method can't be invoked.  <code>bs</code> is typed to a pointer to <code>BaseStruct</code>, which has the <code>BaseItf</code> interface with the <code>clone</code> method.  It would seem like the concrete <code>sc</code> instance in <code>main</code> that invoked <code>cloneAndGetName</code> knows how to locate the <code>clone</code> method.</p>\n\n<p>What am I missing?  Is there a better way to go about this?  In my real code, I need a way to create a new instance of an object from some shared code.</p>\n"}, {"tags": ["json", "dictionary", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1479694593, "post_id": 40711643, "comment_id": 68651588, "body": "Check the error from Unmarshal, that&#39;s not valid JSON."}], "answers": [{"tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": false, "score": 0, "last_activity_date": 1479701940, "creation_date": 1479701940, "answer_id": 40712680, "question_id": 40711643, "link": "https://stackoverflow.com/questions/40711643/go-json-map-newbie/40712680#40712680", "title": "Go JSON map newbie", "body": "<p>The field <code>cookies</code> need to be exported, i.e. be upper case:</p>\n\n<pre><code>type htmlDoc struct {\n    Cookies map[string] string `json:\"Cookies\"`\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "edited": false, "score": 0, "creation_date": 1479732332, "post_id": 40715017, "comment_id": 68667721, "body": "Exactly what I am looking for. I am fairly new to json and Go.  This really helps!  Thank you!"}], "tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 1, "last_activity_date": 1479714034, "creation_date": 1479714034, "answer_id": 40715017, "question_id": 40711643, "link": "https://stackoverflow.com/questions/40711643/go-json-map-newbie/40715017#40715017", "title": "Go JSON map newbie", "body": "<p>There are some errors in your code, first your json is invalid, I believe the expected JSON is:</p>\n\n<pre><code>{\"Cookies\": [\n    {\"name1\": \"Value1\"},\n    {\"name2\": \"Value2\"},\n    {\"name3\": \"Value3\"}]\n}\n</code></pre>\n\n<p>Also, as md2perpe commented, you have to export Cookies from htmlDoc. Another matter, if Cookies is an array of maps, the htmlDoc must have the following structure</p>\n\n<pre><code>type htmlDoc struct {\n    Cookies []map[string]string `json:\"Cookies\"`\n}\n</code></pre>\n\n<p>And the main func</p>\n\n<pre><code>func main() {\n    jsonString := `{\"Cookies\": [\n        {\"name1\": \"Value1\"},\n        {\"name2\": \"Value2\"},\n        {\"name3\": \"Value3\"}]}`\n\n    var doc htmlDoc\n    json.Unmarshal([]byte(jsonString), &amp;doc)\n\n    for _, value := range doc.Cookies {\n        for k, v := range value {\n            fmt.Printf(\"%s\\t%s\\n\", k, v)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 2443447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8795d5deffe711e8c547513f35438b40?s=128&d=identicon&r=PG", "display_name": "user2443447", "link": "https://stackoverflow.com/users/2443447/user2443447"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1479714034, "creation_date": 1479692729, "last_edit_date": 1479693005, "question_id": 40711643, "link": "https://stackoverflow.com/questions/40711643/go-json-map-newbie", "title": "Go JSON map newbie", "body": "<p>How would I get this little program to work? I'm trying to read a bunch of cookies from a json string into a map and print the map.  The below program prints nothing.</p>\n\n<pre><code>type htmlDoc struct {\n    cookies map[string] string `json:\"Cookies\"`\n}\n\nfunc main() {\n    jsonString := `{    Cookies: {\n        [\"name1\": \"Value1\"],\n        [\"name2\": \"Value2\"],\n        [\"name3\": \"Value3\"]\n    }}`\n\n    var doc htmlDoc\n    json.Unmarshal([]byte(jsonString), &amp;doc)\n\n    for name, value := range doc.cookies {\n        fmt.Printf(\"%s\\t%s\\n\", name, value)\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go", "concurrency"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1479690371, "post_id": 40711091, "comment_id": 68650704, "body": "What would make it limit it to 10 goroutines? The number 10 is nowhere to be seen in your code. Check out this related question: <a href=\"http://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204\">Is this an idiomatic worker thread pool in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "edited": false, "score": 0, "creation_date": 1526244000, "post_id": 40711570, "comment_id": 87656667, "body": "Sorry to revisit the question, but what if you have bounded parallelism scenario, in which you need to read the URLs from a file and you do want to loop through the file line by line."}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": 7, "last_activity_date": 1479692012, "creation_date": 1479692012, "answer_id": 40711570, "question_id": 40711091, "link": "https://stackoverflow.com/questions/40711091/process-concurrent-http-requests-in-golang/40711570#40711570", "title": "Process concurrent HTTP requests in Golang", "body": "<p>A pool of 10 go routines reading from a <a href=\"https://tour.golang.org/concurrency/2\" rel=\"noreferrer\"><code>channel</code></a> should fulfill your requirements.</p>\n\n<pre><code>work := make(chan string)\n\n// get original 200 urls\nvar urlsToProcess []string = seedUrls() \n\n// startup pool of 10 go routines and read urls from work channel \nfor i := 0; i&lt;=10; i++ {\n  go func(w chan string) {\n     url := &lt;-w\n  }(work)\n}\n\n// write urls to the work channel, blocking until a worker goroutine\n// is able to start work\nfor _, url := range urlsToProcess {\n  work &lt;- url\n}\n</code></pre>\n\n<p>Cleanup and request results are left as an exercise for you.  Go channels is will block until one of the worker routines is able to read.</p>\n"}, {"comments": [{"owner": {"reputation": 1589, "user_id": 5944798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7532aec0ae828a8c2e98970b40fd1cc7?s=128&d=identicon&r=PG&f=1", "display_name": "Julien Lopez", "link": "https://stackoverflow.com/users/5944798/julien-lopez"}, "edited": false, "score": 4, "creation_date": 1479809511, "post_id": 40738395, "comment_id": 68703913, "body": "While this code may answer the question, providing additional context regarding why and/or how this code answers the question improves its long-term value."}], "tags": [], "owner": {"reputation": 21, "user_id": 6198041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jb5fr.jpg?s=128&g=1", "display_name": "fengxsong", "link": "https://stackoverflow.com/users/6198041/fengxsong"}, "is_accepted": false, "score": 2, "last_activity_date": 1479869488, "last_edit_date": 1479869488, "creation_date": 1479807724, "answer_id": 40738395, "question_id": 40711091, "link": "https://stackoverflow.com/questions/40711091/process-concurrent-http-requests-in-golang/40738395#40738395", "title": "Process concurrent HTTP requests in Golang", "body": "<p>code like this</p>\n\n<pre><code>longTimeAct := func(index int, w chan struct{}, wg *sync.WaitGroup) {\n        defer wg.Done()\n        time.Sleep(1 * time.Second)\n        println(index)\n        &lt;-w\n}\nwg := new(sync.WaitGroup)\nws := make(chan struct{}, 10)\nfor i := 0; i &lt; 100; i++ {\n        ws &lt;- struct{}{}\n        wg.Add(1)\n        go longTimeAct(i, ws, wg)\n}\nwg.Wait()\n</code></pre>\n"}], "owner": {"reputation": 843, "user_id": 728226, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7840ff7b45650a9687e8b599461c4269?s=128&d=identicon&r=PG", "display_name": "Jau L", "link": "https://stackoverflow.com/users/728226/jau-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5956, "favorite_count": 0, "accepted_answer_id": 40711570, "answer_count": 2, "score": -1, "last_activity_date": 1479869488, "creation_date": 1479688016, "last_edit_date": 1479688949, "question_id": 40711091, "link": "https://stackoverflow.com/questions/40711091/process-concurrent-http-requests-in-golang", "title": "Process concurrent HTTP requests in Golang", "body": "<p>I'm trying to process a file which contains 200 URLs and use each URL to make an HTTP request. I need to process 10 URLs concurrently maximum each time (code should block until 10 URLs finish processing). Tried to solve it in go but I keep getting the whole file processed with 200 concurrent connection created.</p>\n\n<pre><code>for scanner.Scan() { // loop through each url in the file\n        // send each url to golang HTTPrequest\n        go HTTPrequest(scanner.Text(), channel, &amp;wg)\n}\nfmt.Println(&lt;-channel)\nwg.Wait()\n</code></pre>\n\n<p>What should i do?</p>\n"}, {"tags": ["javascript", "node.js", "go", "websocket"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479684099, "post_id": 40710545, "comment_id": 68649245, "body": "I recommend you to use gorilla/websocket is the best implementation in Go, take a look at the examples: <a href=\"https://github.com/gorilla/websocket/tree/master/examples\" rel=\"nofollow noreferrer\">github.com/gorilla/websocket/tree/master/examples</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5182, "user_id": 1366533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cqijr.png?s=128&g=1", "display_name": "johlo", "link": "https://stackoverflow.com/users/1366533/johlo"}, "is_accepted": true, "score": 1, "last_activity_date": 1479717419, "creation_date": 1479717419, "answer_id": 40715820, "question_id": 40710545, "link": "https://stackoverflow.com/questions/40710545/how-to-keep-a-websocket-connection-in-open-readystate-after-send/40715820#40715820", "title": "How to keep a websocket connection in OPEN readystate after send?", "body": "<p>When the handler function returns, in your case <code>EchoServer</code> the socket will be automatically closed by the http framework.\nSince you start a go routine for the loop writing the <code>yahoo</code>response to the client the <code>EchoServer</code> function will terminate (and therefor closing the socket) before it has time to send a response.</p>\n\n<p>The solution is to remove the spawning of the go routine and just do the loop inside the <code>EchoServer</code>.</p>\n"}], "owner": {"reputation": 2887, "user_id": 3068541, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/787075573/picture?type=large", "display_name": "JackyJohnson", "link": "https://stackoverflow.com/users/3068541/jackyjohnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3303, "favorite_count": 0, "accepted_answer_id": 40715820, "answer_count": 1, "score": 1, "last_activity_date": 1479722644, "creation_date": 1479683527, "last_edit_date": 1479722644, "question_id": 40710545, "link": "https://stackoverflow.com/questions/40710545/how-to-keep-a-websocket-connection-in-open-readystate-after-send", "title": "How to keep a websocket connection in OPEN readystate after send?", "body": "<p>I am new to websockets.  </p>\n\n<p>In my setup I have a trivial websocket server written in Go (<a href=\"https://play.golang.org/p/H6ctw_tFlx\" rel=\"nofollow noreferrer\">playground</a>)</p>\n\n<p>I make a <code>WebSocket</code> object, set up its <code>onmessage</code> callback and call its <code>send</code> method to test.</p>\n\n<pre><code>var w = new WebSocket(\"ws://localhost:12345/echo\")\n\nw.onmessage = (msg) =&gt; {\n   console.log(msg.data)\n}\n\nw.onopen = () =&gt; {\n   w.send(\"Hello\")  // this fires OK\n}\n</code></pre>\n\n<p>What I expect to happen based on the server code is to receive the \"Hello\" message and to keep sending \"yahoo\" every 1.5s to the client.  What actually happens is \"Hello\" is sent, but none of the \"yahoo\"'s make it thru.  It seems somewhere along the WebSocket.readystate becomes 3 (CLOSED).  </p>\n\n<p>To clarify, the server receives and prints \"Hello\" then actually fires a \"yahoo\" message every 1.5s, but the connection is closed by then so the <code>onmessage</code> callback never fires.</p>\n\n<p>Am I missing or misunderstanding anything? </p>\n\n<p>EDIT: Ran across <a href=\"https://github.com/gorilla/websocket#gorilla-websocket-compared-with-other-packages\" rel=\"nofollow noreferrer\">comparison github.com/gorilla vs. golang.org/x/net</a>, claims golang.org/x/net websocket implementation does not support pong.  This may be the confirmation of it.</p>\n\n<p>EDIT: Package golang.org/x/net/websocket closes the websocket connection when the handler ServeHTTP function returns.  By default a websocket connection is tied to an instance of the handler.</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1479674269, "post_id": 40708924, "comment_id": 68646119, "body": "Even if you are only shifting 1 by 63 bits, in C <code>uint64_t n = 1&lt;&lt;63;</code> will not work when <code>int</code> is 32 bits, it would need to be <code>uint64_t n = (uint64_t)1&lt;&lt;63;</code>, and secondly shifting out 64 bits will leave you with <code>0</code> anyway. Would this apply to Go, especially the second point?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1479679757, "post_id": 40708924, "comment_id": 68647989, "body": "Thanks @WeatherVane, I didn&#39;t know cast is required in C! In Go, 1&lt;&lt;64 - 1 is (1&lt;&lt;64) - 1 according to <a href=\"https://golang.org/ref/spec#Operators\" rel=\"nofollow noreferrer\">operator precedence</a>. The layout, forced by <a href=\"https://blog.golang.org/go-fmt-your-code\" rel=\"nofollow noreferrer\">gofmt</a>, tries to imply the precedence. Regarding the second point, constants can be very large in Go, as long as they fit into a type on assignment. <a href=\"https://play.golang.org/p/nA_NfBJycS\" rel=\"nofollow noreferrer\">1 &lt;&lt; 400, for example</a>. See also <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"nofollow noreferrer\">constant expressions</a>. When the code above is run, it writes 18446744073709551615 three times."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479736236, "post_id": 40708924, "comment_id": 68670378, "body": "GoBytes copies a C allocated buffer into a slice with Go allocated memory. If that&#39;s what you want, then use GoBytes. Here you&#39;re not even keeping that copy, so there&#39;s no reason to do it."}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479842936, "post_id": 40708924, "comment_id": 68726072, "body": "Thanks @JimB, you&#39;ve answered the question, much appreciated :-)"}], "answers": [{"tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1480787526, "creation_date": 1480787526, "answer_id": 40950744, "question_id": 40708924, "link": "https://stackoverflow.com/questions/40708924/is-c-gobytes-required-to-retrieve-a-c-buffer-or-is-a-pointer-sufficient-here/40950744#40950744", "title": "Is C.GoBytes required to retrieve a C buffer, or is a pointer sufficient here?", "body": "<p>Marking question answered by copying JimB's answer from comment: </p>\n\n<blockquote>\n  <p>GoBytes copies a C allocated buffer into a slice with Go allocated\n  memory. If that's what you want, then use GoBytes. Here you're not\n  even keeping that copy, so there's no reason to do it.</p>\n</blockquote>\n\n<p>Also, benchmark is interesting:</p>\n\n<pre><code>$ go test -bench . -benchmem\nBenchmarkGoBytes-8      20000000            97.8 ns/op        32 B/op          3 allocs/op\nBenchmarkDirect-8       2000000000           0.84 ns/op        0 B/op          0 allocs/op\nPASS\n</code></pre>\n"}], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3037, "favorite_count": 0, "accepted_answer_id": 40950744, "answer_count": 1, "score": 1, "last_activity_date": 1480787526, "creation_date": 1479673149, "question_id": 40708924, "link": "https://stackoverflow.com/questions/40708924/is-c-gobytes-required-to-retrieve-a-c-buffer-or-is-a-pointer-sufficient-here", "title": "Is C.GoBytes required to retrieve a C buffer, or is a pointer sufficient here?", "body": "<p>The cgo code below has a function to put a Go value in a C buffer, and two alternative functions to get it back; getViaGoBytes and getDirect. </p>\n\n<p>Is getViaGoBytes any better than getDirect?</p>\n\n<p>I assume not, and the intermediary slice created in getViaGoBytes is unnecessary. </p>\n\n<p>Am I correct in thinking Go allocates enough memory when the uint64 y variable is declared, and the assignment to y copies the memory from C to Go?</p>\n\n<pre><code>package main\n/*\nchar buf[8];\n\nvoid put(char * input, int size) {\n    while (size--) {\n        buf[size] = input[size];\n    }\n}\n*/\nimport \"C\"\nimport \"unsafe\"\n\nfunc put(input uint64) {\n    C.put((*C.char)(unsafe.Pointer(&amp;input)), C.int(unsafe.Sizeof(input)))\n}\n\nfunc getViaGoBytes() uint64 {\n    var out uint64\n    data := C.GoBytes(unsafe.Pointer(&amp;(C.buf[0])), C.int(unsafe.Sizeof(out)))\n    out = *(*uint64)(unsafe.Pointer(&amp;data[0]))\n    return out\n}\n\nfunc getDirect() uint64 {\n    return *(*uint64)(unsafe.Pointer(&amp;(C.buf[0])))\n}\n\nfunc main() {\n    var input uint64 = 1&lt;&lt;64 - 1\n    println(input)\n    put(input)\n    var x uint64 = getViaGoBytes()\n    println(x)\n    var y uint64 = getDirect()\n    println(y)\n}\n</code></pre>\n"}, {"tags": ["join", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 426, "user_id": 1182721, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20f3f1dc553f33f198493f9061a0ac97?s=128&d=identicon&r=PG", "display_name": "Lu.nemec", "link": "https://stackoverflow.com/users/1182721/lu-nemec"}, "is_accepted": false, "score": 1, "last_activity_date": 1508329378, "last_edit_date": 1508329378, "creation_date": 1508329070, "answer_id": 46810004, "question_id": 40708913, "link": "https://stackoverflow.com/questions/40708913/gorm-joins-not-mapping-to-models/46810004#46810004", "title": "Gorm Joins not mapping to models", "body": "<p>Gorm doesn't automatically load data into related tables. You have to use <code>Preload(\"table\")</code> for that in your query. When creating records with related fields, <a href=\"http://jinzhu.me/gorm/crud.html#associations\" rel=\"nofollow noreferrer\">use associations</a>.</p>\n\n<p><a href=\"http://jinzhu.me/gorm/crud.html#preloading-eager-loading\" rel=\"nofollow noreferrer\">Docs</a></p>\n\n<p>Gorm <a href=\"https://github.com/jinzhu/gorm/issues/1436\" rel=\"nofollow noreferrer\">doesn't currently support preloading with JOINS</a>, you have to create SQL with <a href=\"http://jinzhu.me/gorm/advanced.html#sql-builder\" rel=\"nofollow noreferrer\">SQL Builder</a> and map the resulting <code>rows</code> to your structures.</p>\n"}], "owner": {"reputation": 33, "user_id": 6456157, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61d5a4230c5177894984363c6df720fe?s=128&d=identicon&r=PG&f=1", "display_name": "Kristijan Ujevic", "link": "https://stackoverflow.com/users/6456157/kristijan-ujevic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7707, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1602007485, "creation_date": 1479673078, "question_id": 40708913, "link": "https://stackoverflow.com/questions/40708913/gorm-joins-not-mapping-to-models", "title": "Gorm Joins not mapping to models", "body": "<p>I'm trying to optimize my app by using sql joins instead of Preload().\nBut i've ran into an issue where the joined table in the model is always empty.</p>\n\n<p>In desperation i've opened a new project and found some simple sample code, and again the same problem.\nIf you run the code below you'll see that the joined table is always an empty array.</p>\n\n<p>Am i doing something wrong?</p>\n\n<pre><code>import (\n\"fmt\"\n\"log\"\n\n\"github.com/jinzhu/gorm\"\n_ \"github.com/lib/pq\"\n)\n\ntype Language struct {\n    ID   uint `gorm:\"primary_key\"`\n    Name string\n}\n\ntype Movie struct {\n    ID         uint `gorm:\"primary_key\"`\n    Title      string\n    Language   Language\n    LanguageID uint\n}\n\ntype Artist struct {\n    ID     uint `gorm:\"primary_key\"`\n    Name   string\n    Movies []Movie `gorm:\"many2many:artist_movies\"`\n}\n\nfunc createArtists() {\n    langs := []Language{{Name: \"english\"},\n        {Name: \"tamil\"},\n        {Name: \"french\"}}\n\n    for i, _ := range langs {\n        if err := db.Create(&amp;langs[i]).Error; err != nil {\n            log.Fatal(err)\n        }\n    }\n\n    movies := []Movie{\n        {Title: \"Nayagan\", Language: langs[1]},\n        {Title: \"Anbe sivam\", Language: langs[1]},\n        {Title: \"3 idiots\", Language: langs[2]},\n        {Title: \"Shamithab\", Language: langs[2]},\n        {Title: \"Dark Knight\", Language: langs[0]},\n        {Title: \"310 to Yuma\", Language: langs[0]},\n    }\n    for i, _ := range movies {\n        if err := db.Create(&amp;movies[i]).Error; err != nil {\n            log.Fatal(err)\n        }\n    }\n\n    artists := []Artist{\n        {Name: \"Madhavan\", Movies: []Movie{movies[1],movies[2]}},\n        {Name: \"Kamal Hassan\", Movies: []Movie{movies[0], movies[1]}},\n        {Name: \"Dhanush\", Movies: []Movie{movies[3]}},\n        {Name: \"Aamir Khan\", Movies: []Movie{movies[2]}},\n        {Name: \"Amitabh Bachchan\", Movies: []Movie{movies[3]}},\n        {Name: \"Christian Bale\", Movies: []Movie{movies[4], movies[5]}},\n        {Name: \"Russell Crowe\", Movies: []Movie{movies[5]}},\n    }\n\n    for i, _ := range artists {\n    if err := db.Create(&amp;artists[i]).Error; err != nil {\n        log.Fatal(err)\n        }\n    }\n}\n\nvar db *gorm.DB\n\nfunc main() {\n    var err error\n    db, err = gorm.Open(\"postgres\", \"user=admin password=1234 dbname=test sslmode=disable\")\nif err != nil {\n    log.Fatal(err)\n}\ndb.AutoMigrate(new(Language), new(Movie), new(Artist))\ndb.LogMode(true)\n\ncreateArtists()\n\nvar artists []Artist\n\nif err = db.Joins(\"JOIN artist_movies on artist_movies.artist_id=artists.id\").\n    Joins(\"JOIN movies on movies.id=artist_movies.movie_id\").\n    Joins(\"JOIN languages on movies.language_id=languages.id\").\n    Where(\"languages.name=?\", \"tamil\").\n    Group(\"artists.id\").Find(&amp;artists).Error; err != nil {\n    log.Fatal(err)\n}\nfor _, ar := range artists {\n    fmt.Println(ar.Movies)\n}\n\nartists = []Artist{}\nif err = db.Joins(\"JOIN artist_movies on artist_movies.artist_id=artists.id\").\n    Joins(\"JOIN movies on artist_movies.movie_id=movies.id\").Where(\"movies.title=?\", \"Nayagan\").\n    Group(\"artists.id\").Find(&amp;artists).Error; err != nil {\n    log.Fatal(err)\n}\n\nfor _, ar := range artists {\n    fmt.Println(ar.Movies)\n}\n\nartists = []Artist{}\n\nif err = db.Joins(\"JOIN artist_movies on artist_movies.artist_id=artists.id\").\n    Joins(\"JOIN movies on artist_movies.movie_id=movies.id\").\n    Where(\"movies.title in (?)\", []string{\"3 idiots\", \"Shamitabh\", \"310 to Yuma\"}).\n    Group(\"artists.id\").Find(&amp;artists).Error; err != nil {\n    log.Fatal(err)\n}\nfor _, ar := range artists {\n    fmt.Println(ar.Movies)\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 4, "creation_date": 1479672509, "post_id": 40708750, "comment_id": 68645545, "body": "<code>Get</code> URL should be: <code>http:&#47;&#47;localhost:80&#47;static</code>. To debug instead of ignoring the errors you should handle them."}, {"owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "reply_to_user": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1479673321, "post_id": 40708750, "comment_id": 68645798, "body": "If I ignore the error. Why Go goes to panic? Is it always what happen if I ignore the error?"}, {"owner": {"reputation": 216447, "user_id": 846892, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/E9dZn.png?s=128&g=1", "display_name": "Ashwini Chaudhary", "link": "https://stackoverflow.com/users/846892/ashwini-chaudhary"}, "edited": false, "score": 0, "creation_date": 1479675616, "post_id": 40708750, "comment_id": 68646636, "body": "Depends. In this case the error is thrown because <code>resp.Body</code> doesn&#39;t exist due to the invalid <code>http.Get</code> call. Unlike some other languages Go never raises exceptions but we should be handling an error if a function returns one."}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 1, "last_activity_date": 1479705712, "creation_date": 1479705712, "answer_id": 40713267, "question_id": 40708750, "link": "https://stackoverflow.com/questions/40708750/go-cannot-create-a-server-in-go-routine/40713267#40713267", "title": "Go: cannot create a server in go routine", "body": "<p>You must use (with \"http://\" in this case)</p>\n\n<pre><code>resp, _ := http.Get(\"http://localhost:80/static\")\n</code></pre>\n\n<p>and check the errors before use the response, just in case the request fails </p>\n\n<pre><code>resp, err := http.Get(\"http://localhost:80/static\")\nif err != nil {\n    // do something\n} else {\n    ans, _ := ioutil.ReadAll(resp.Body)\n    fmt.Printf(\"response: %s\", ans)\n}\n</code></pre>\n\n<p>Also, if you want to get any response from your handler, you have to write a response in it.</p>\n\n<pre><code>func myHandler(rw http.ResponseWriter, req *http.Request) {\n    fmt.Printf(req.URL.Path)\n    rw.Write([]byte(\"Hello World!\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 16685, "user_id": 1229624, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33221e57892f65c519a16ff5cd30f874?s=128&d=identicon&r=PG", "display_name": "Aminadav Glickshtein", "link": "https://stackoverflow.com/users/1229624/aminadav-glickshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40713267, "answer_count": 1, "score": -3, "last_activity_date": 1479705712, "creation_date": 1479672057, "question_id": 40708750, "link": "https://stackoverflow.com/questions/40708750/go-cannot-create-a-server-in-go-routine", "title": "Go: cannot create a server in go routine", "body": "<p>When trying to <code>ListenAndServer</code> inside a go routine I get an error:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/static/\", myHandler)\n    go func() {\n        http.ListenAndServe(\"localhost:80\", nil)\n    }()\n\n    fmt.Printf(\"we are here\")\n    resp, _ := http.Get(\"localhost:80/static\")\n\n    ans, _ := ioutil.ReadAll(resp.Body)\n    fmt.Printf(\"response: %s\", ans)\n}\n\nfunc myHandler(rw http.ResponseWriter, req *http.Request) {\n    fmt.Printf(req.URL.Path)\n}\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x48 pc=0x401102]\n\ngoroutine 1 [running]:\npanic(0x6160c0, 0xc0420080a0)\n        c:/go/src/runtime/panic.go:500 +0x1af\nmain.main()\n        C:/gowork/src/exc/14.go:20 +0xc2\nexit status 2\n</code></pre>\n\n<p>All I want is to create an <code>http</code> server. And then test it and connect to it from the code. What's wrong with Go? (or with me?)</p>\n"}, {"tags": ["go", "switch-statement"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1479664524, "post_id": 40702527, "comment_id": 68642667, "body": "<code>fakeString</code> type isn&#39;t equivalent to <code>string</code>, but it does implement <code>Stringer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": false, "score": 4, "last_activity_date": 1479637355, "creation_date": 1479637355, "answer_id": 40702912, "question_id": 40702527, "link": "https://stackoverflow.com/questions/40702527/why-does-switch-match-a-different-type-in-below-code-sample-in-golang/40702912#40702912", "title": "Why does switch match a different type in below code sample in golang", "body": "<p>In Go to satisfy an interface all you have to do is implement the methods of that interface nothing else. In this case to have a behavior as a <strong>Stringer</strong> you have to implement <code>String() string</code>, so the type fakeString behaves as a <strong>Stringer</strong> because implement that method; in terms of OOP we use interfaces just to define behavior not types or values. So you may be implementing Go interfaces all day without knowing, but not big deal, it only matters when you have to satisfy behaviors.</p>\n\n<p>Actually in a real project you may want to add a <code>default</code> case to your switch in the method <code>printString</code>, to detect when the interface{} is something else, like this:</p>\n\n<pre><code>func printString(value interface{}) {\n    switch str := value.(type) {\n    case string:\n        fmt.Println(\"string\", str)\n    case Stringer:\n        fmt.Println(\"Stringer\", str.String())\n    default:\n        fmt.Printf(\"unexpected type: %T value: '%v'\", str, str)\n    }\n}\n\n// main:\nprintString(2)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pmxSXfUu4e\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pmxSXfUu4e</a></p>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "edited": false, "score": 0, "creation_date": 1479713711, "post_id": 40712417, "comment_id": 68657287, "body": "Thanks. It took some time for me to understand that <code>func (s *fakeString) String() string</code> == <code>fakeString</code> implementing <code>Stringer</code>. It seemed just a function that take <code>s</code> of type <code>*fakeString</code> as input."}, {"owner": {"reputation": 9643, "user_id": 1925083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3khW.jpg?s=128&g=1", "display_name": "cizixs", "link": "https://stackoverflow.com/users/1925083/cizixs"}, "reply_to_user": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "edited": false, "score": 0, "creation_date": 1479721485, "post_id": 40712417, "comment_id": 68661142, "body": "@Ivan Unlike other language(like Java), golang interface and its implementation does not have explicit code declaration, the <i>satisfies check</i> runs behind the scene. This can be confusing for starters!"}], "tags": [], "owner": {"reputation": 9643, "user_id": 1925083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3khW.jpg?s=128&g=1", "display_name": "cizixs", "link": "https://stackoverflow.com/users/1925083/cizixs"}, "is_accepted": true, "score": 1, "last_activity_date": 1479699846, "creation_date": 1479699846, "answer_id": 40712417, "question_id": 40702527, "link": "https://stackoverflow.com/questions/40702527/why-does-switch-match-a-different-type-in-below-code-sample-in-golang/40712417#40712417", "title": "Why does switch match a different type in below code sample in golang", "body": "<p>This is <strong>interface satisfaction</strong> in golang.</p>\n\n<p>There are two kinds of type in golang: <em>interface type</em> and <em>concrete type</em>. </p>\n\n<ul>\n<li><code>concrete type</code> works exactly as you expected in <code>switch</code>: the variable is an instance of the given type</li>\n<li><code>interface type</code> on the other hand works differently, it checks if the variable <strong>satisfies</strong> the interface.</li>\n</ul>\n\n<p>Hum, <strong>safisfies</strong>? How does it work? </p>\n\n<blockquote>\n  <p><strong>A (concrete) type satisfies an interface if it possesses all the methods the interface requires.</strong></p>\n  \n  <p>-- the golang programming language</p>\n</blockquote>\n\n<p>In the case, <code>Stringer</code> is an interface, declaring only one method: <code>String() string</code>. And <code>fakeString</code> satisfies it by having its own <code>String() string</code> method.</p>\n\n<p>Two things to note however:</p>\n\n<ol>\n<li>concrete type can have many other methods, it still satisfies the interface if it possesses all methods declared in interface</li>\n<li>the methods order does not matter, all that matters is the set of methods.</li>\n</ol>\n"}], "owner": {"reputation": 159, "user_id": 4501628, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c27574c3da5710cbe5bd0783b0f9765c?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan", "link": "https://stackoverflow.com/users/4501628/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 1, "accepted_answer_id": 40712417, "answer_count": 2, "score": 1, "last_activity_date": 1479699846, "creation_date": 1479634501, "question_id": 40702527, "link": "https://stackoverflow.com/questions/40702527/why-does-switch-match-a-different-type-in-below-code-sample-in-golang", "title": "Why does switch match a different type in below code sample in golang", "body": "<p>Link:\n<a href=\"https://play.golang.org/p/69I8PAuoAV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/69I8PAuoAV</a></p>\n\n<p>Extract:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Stringer interface {\n    String() string\n}\n\ntype fakeString struct {\n    content string\n}\n\n// function used to implement the Stringer interface\nfunc (s *fakeString) String() string {\n    return s.content\n}\n\nfunc printString(value interface{}) {\n    switch str := value.(type) {\n    case string:\n        fmt.Println(str)\n    case Stringer:\n        fmt.Println(str.String())\n    }\n}\n\nfunc main() {\n    s := &amp;fakeString{\"Ceci n'est pas un string\"}\n    printString(s)\n    printString(\"Hello, Gophers\")\n\n}\n</code></pre>\n\n<p>The <code>printString(s)</code> function call when reaching case matches the <code>case Stringer</code> part.\n<code>s</code> is of type <code>*fakeString</code> not <code>Stringer</code>.\nWhy does it match <code>Stringer</code>.</p>\n\n<p>I did a <code>fmt.Println(reflect.TypeOf(str))</code> and it confirmed the type as <code>*main.fakeString</code></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1479663730, "post_id": 40702632, "comment_id": 68642359, "body": "I.e. it&#39;s fmt.Println() that behaves different for a pointer to a string and a pointer to a struct."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "reply_to_user": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1479698638, "post_id": 40702632, "comment_id": 68652510, "body": "i.e. fmt.Println will try to call a String() method and each type has a default string representation"}], "tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 10, "last_activity_date": 1479723314, "last_edit_date": 1479723314, "creation_date": 1479635285, "answer_id": 40702632, "question_id": 40702421, "link": "https://stackoverflow.com/questions/40702421/why-the-operator-on-struct-doesnt-return-a-digital-address/40702632#40702632", "title": "Why the &amp; operator on struct doesn&#39;t return a digital address?", "body": "<p>The unitary operator <code>&amp;</code> behaves the same for builtin types and structs, it's used to get the memory address of a var. In this case we'll see <code>&amp;{Sam 55}</code> because Go always checks by default if the parameter in fmt.Println() is a struct or a pointer to struct and in that case will try to print each field of the struct for debugging purposes, but if you want to see a pointer you can use fmt.Printf() with <code>%p</code>, like this:</p>\n\n<pre><code>func main() {\n    s1 := \"abc\"\n    fmt.Println(\"s1 address =\", &amp;s1)\n\n    s2 := person{\"Sam\", 55}\n\n    fmt.Println(\"s2 as pointer =\", &amp;s2)\n\n    fmt.Printf(\"s2 address = %p value with fields %+v\", &amp;s2, s2)\n}\n</code></pre>\n\n<p>Bonus: you can use <code>%+v</code> to print field names and values</p>\n\n<p><a href=\"https://play.golang.org/p/p7OVRu8YWB\" rel=\"nofollow noreferrer\">https://play.golang.org/p/p7OVRu8YWB</a></p>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 4, "accepted_answer_id": 40702632, "answer_count": 1, "score": 2, "last_activity_date": 1479723314, "creation_date": 1479633565, "last_edit_date": 1479634394, "question_id": 40702421, "link": "https://stackoverflow.com/questions/40702421/why-the-operator-on-struct-doesnt-return-a-digital-address", "title": "Why the &amp; operator on struct doesn&#39;t return a digital address?", "body": "<p>I just started to learn the golang.</p>\n\n<p>I found the <code>&amp;</code> operator behaves differently for simple type and struct.</p>\n\n<ul>\n<li><p>For simple type, <code>&amp;</code> returns an address.</p></li>\n<li><p>For struct, it returns something else.</p></li>\n</ul>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype person struct {\n    name string\n    age  int\n}\n\nfunc main() {\n    s1 := \"abc\"\n    fmt.Println(\"s1 address =\", &amp;s1)\n\n    s2 := person{\"Sam\", 55}\n    fmt.Println(\"s2 address = \", &amp;s2)\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[ `hello` | done: 79.0079ms ]\n    s1 address = 0xc04203c1e0\n    s2 address =  &amp;{Sam 55}   &lt;======== What's this? And why not some address like above?\n</code></pre>\n\n<p>Again, is this design a <code>have-to</code> or a <code>happen-to</code>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "edited": false, "score": 5, "creation_date": 1479631295, "post_id": 40702062, "comment_id": 68632669, "body": "You can found some reasons here: <a href=\"https://blog.golang.org/gos-declaration-syntax\" rel=\"nofollow noreferrer\">blog.golang.org/gos-declaration-syntax</a>"}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "reply_to_user": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "edited": false, "score": 1, "creation_date": 1479631364, "post_id": 40702062, "comment_id": 68632681, "body": "The resource @sisoft provided is excellent (but doesn&#39;t explain where it comes from). My hunch is the following: since Go has three ancestors (CSP, Pascal/Oberon, and C) I suppose that the variable declaration and definition style is inherited from Pascal/Oberon line."}, {"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1479631562, "post_id": 40702062, "comment_id": 68632725, "body": "Second part of your question is simple: <code>type</code> defines more than just <code>struct</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": true, "score": 7, "last_activity_date": 1479631983, "creation_date": 1479631983, "answer_id": 40702247, "question_id": 40702062, "link": "https://stackoverflow.com/questions/40702062/why-does-the-golang-place-the-type-specifier-after-the-variable-name/40702247#40702247", "title": "Why does the golang place the type specifier &quot;after&quot; the variable name?", "body": "<p>I <em>think</em> the Go programming language follows these principles:</p>\n\n<ul>\n<li>declarations start with a keyword, so that the parser can be implemented with a single token look-ahead (like in Pascal)</li>\n<li>the rest of the declaration follows the English grammar, with every redundant word left out (also like in Pascal, but with fewer keywords)</li>\n</ul>\n\n<p>Examples:</p>\n\n<ul>\n<li>The type <code>Frequency</code> is a <code>map</code> indexed by <code>string</code>, mapping to <code>int</code><br>\n<code>type Frequency map[string]int</code></li>\n<li>The type <code>Point</code> is a <code>struct</code> with two fields, <code>x</code> and <code>y</code> of type <code>int</code><br>\n<code>type Point struct { x, y int }</code></li>\n</ul>\n\n<p>The above sentences focus more on the names than on the types, which makes sense since the names convey more meaning.</p>\n\n<p>If I had to explain to novice programmers how to write declarations in Go, I would let them first describe it in plain English and then remove every word that <em>might even seem</em> redundant.</p>\n\n<p>Up to now, I didn't find any contradictions to these rules.</p>\n"}], "owner": {"reputation": 52274, "user_id": 264052, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8ccbe08a132ba61eae9ff8984ca44e81?s=128&d=identicon&r=PG", "display_name": "smwikipedia", "link": "https://stackoverflow.com/users/264052/smwikipedia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 1, "accepted_answer_id": 40702247, "answer_count": 1, "score": 3, "last_activity_date": 1479631983, "creation_date": 1479630436, "last_edit_date": 1479631284, "question_id": 40702062, "link": "https://stackoverflow.com/questions/40702062/why-does-the-golang-place-the-type-specifier-after-the-variable-name", "title": "Why does the golang place the type specifier &quot;after&quot; the variable name?", "body": "<p>Just out of curiosity, why does the <code>golang</code> place the type specifier after the variable name like below. Have to? Or happen to?</p>\n\n<pre><code>type person struct {\n    name string\n    age  int\n}\n</code></pre>\n\n<p>Why not just like this? It's more natural IMHO, and it saves the <code>type</code> keyword.</p>\n\n<pre><code>struct person {\n    string name\n    int age\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 690, "user_id": 26465, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6NmZ5.png?s=128&g=1", "display_name": "Creasixtine", "link": "https://stackoverflow.com/users/26465/creasixtine"}, "edited": false, "score": 0, "creation_date": 1479632532, "post_id": 40702061, "comment_id": 68632949, "body": "That&#39;s it! Thanks a lot!"}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 1, "last_activity_date": 1479630432, "creation_date": 1479630432, "answer_id": 40702061, "question_id": 40701992, "link": "https://stackoverflow.com/questions/40701992/copy-a-html-response-then-get-the-string/40702061#40702061", "title": "Copy a html.Response, then get the string", "body": "<p>I guess you want to use <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow noreferrer\">ioutil.ReadAll</a> which returns <code>[]byte</code>:</p>\n\n<pre><code>resp, err := http.Get(url.Address)\nif err != nil {\n   // handle error\n}\ndefer resp.Body.Close()\nurl.Body, err = ioutil.ReadAll(resp.Body)\n</code></pre>\n"}], "owner": {"reputation": 690, "user_id": 26465, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/6NmZ5.png?s=128&g=1", "display_name": "Creasixtine", "link": "https://stackoverflow.com/users/26465/creasixtine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 40702061, "answer_count": 1, "score": 0, "last_activity_date": 1479630432, "creation_date": 1479629699, "question_id": 40701992, "link": "https://stackoverflow.com/questions/40701992/copy-a-html-response-then-get-the-string", "title": "Copy a html.Response, then get the string", "body": "<p>I have made an <code>Url</code> type that should contain the response body.</p>\n\n<pre><code>type Url struct {\n    Address string\n    Refresh string\n    Watch   string\n    Found   bool\n    Body    bytes.Buffer // bytes.Buffer needs no initialization\n}\n</code></pre>\n\n<p>An Url object is created with the right <code>Address</code>, and then I do</p>\n\n<pre><code>resp, err := http.Get(url.Address)\n</code></pre>\n\n<p>Now I would like to do something like the following, but I cannot get out of it:</p>\n\n<pre><code>io.Copy(url.Body, b) // Copy that to the Url buffer\n</code></pre>\n\n<p>As for now, the <code>Url.Body</code> field can be modified to another type if needed.</p>\n\n<p>Afterwards, I want to get the string from that Buffer/Writer/whatever, but I assume this will be easy as soon as I will manage the former copy.</p>\n\n<p>Regards,\nLe Barde.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 1, "creation_date": 1479602441, "post_id": 40698909, "comment_id": 68627960, "body": "You should take a look here <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">blog.golang.org/defer-panic-and-recover</a>.. basically if err != nil you should panic the err, then catch it with a recover, create a copy of the session and defer that copy in the session. You&#39;re closing the connection properly already with your defer.  However if your throwing an error on insert you should also investigate why instead of relying on trying to reinsert.  I&#39;ve done millions of inserts with mgo and I&#39;ve never had an error thrown.  In fact most Mongo errors I&#39;ve experienced are with Mongo itself not the driver."}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479647732, "post_id": 40698909, "comment_id": 68636767, "body": "@reticentroot thx for the info on defer; regarding the reason behind insert error: do you have advice where to look? I already searched for the error message and found posts on stackoverflow, which indicate that it&#39;s because of timeout; for me timeout does not seem probable, since a) the inserts are rather small and b) once the error occurs, it re-occurs on every subsequent insert; still, I wrote code to measure the time for insert and log it in case an error is returned, but since then (yesterday), no such error re-occurred yet"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479660358, "post_id": 40698909, "comment_id": 68641064, "body": "Check your mongod instance. It can time out if you are opening more connections then your instance can handle. Can you add the error to your post?"}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479673517, "post_id": 40698909, "comment_id": 68645861, "body": "@reticentroot there were no errors in the mongodb logs; there were just many &quot;connection accepted&quot; followed by &quot;end connection&quot; log entries (with timestamps separated by merely 10 ms); no inserts were mentioned for failed inserts - normally, for inserts the log has an entry &quot;insert &lt;DB_NAME&gt;.&lt;COLLECTION_NAME&gt; query: &lt;JSON DOC&gt;&quot;"}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479673642, "post_id": 40698909, "comment_id": 68645912, "body": "actually, in my original setup where the error occured, I used the session pointer directly from two different goroutines, without creating a Copy in each goroutine; now, since I changed to the code shown above in the storeEvents() func, the error did not yet appear; I will wait for Monday and see what happens on business days with more events"}], "answers": [{"comments": [{"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "edited": false, "score": 0, "creation_date": 1479673189, "post_id": 40707986, "comment_id": 68645757, "body": "the storeEvents() is just a copy of the code I posted above - you do not panic on error and use Recover to create a new session as you suggested in your comment to my post"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "edited": false, "score": 0, "creation_date": 1479674902, "post_id": 40707986, "comment_id": 68646375, "body": "That&#39;s because in my production code, I&#39;m using a go server using gollira mux and custom handlers (middleware), which wrap my routes and recover the server on panics. Whereas in your code I didn&#39;t see if you were using a go server. So my recover example may not work for you. You&#39;d have to write your own recovery methods. And yes I copied your code above so that you can see how I&#39;d use my example with your code, which is the typical thing to do when giving someone an example. Lastly the main thing to note is the use of the struct holding my session and init function."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "edited": false, "score": 0, "creation_date": 1479678896, "post_id": 40707986, "comment_id": 68647742, "body": "@alex also, I&#39;ve updated the code above to provide an example of recoveries, it&#39;s still something you should research yourself and understand if you&#39;re going to use Go. If you&#39;re coming other languages this is the same as trying and catching exceptions. You don&#39;t want to create sessions in an infinite loop like you did above with the for {}, because you can spawn too many connections and because there is always the possibility that your break condition won&#39;t be met. If the inserts are causing timeouts, with low volume, then there is something critically wrong with the setup of mongo server."}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1479678480, "last_edit_date": 1495542287, "creation_date": 1479667682, "answer_id": 40707986, "question_id": 40698909, "link": "https://stackoverflow.com/questions/40698909/re-creating-mgo-sessions-in-case-of-errors-read-tcp-127-0-0-146954-127-0-0-1/40707986#40707986", "title": "Re-creating mgo sessions in case of errors (read tcp 127.0.0.1:46954-&gt;127.0.0.1:27017: i/o timeout)", "body": "<p>So I don't know if this is going to help you any, but I don't have any issues with this set up.</p>\n\n<p>I have a mongo package that I import from. This is a template of my mongo.go file</p>\n\n<pre><code>package mongo\n\nimport (\n    \"time\"\n\n    \"gopkg.in/mgo.v2\"\n)\n\nvar (\n    // MyDB ...\n    MyDB DataStore\n)\n\n// create the session before main starts\nfunc init() {\n    MyDB.ConnectToDB()\n}\n\n// DataStore containing a pointer to a mgo session\ntype DataStore struct {\n    Session *mgo.Session\n}\n\n// ConnectToTagserver is a helper method that connections to pubgears' tagserver\n// database\nfunc (ds *DataStore) ConnectToDB() {\n    mongoDBDialInfo := &amp;mgo.DialInfo{\n        Addrs:    []string{\"ip\"},\n        Timeout:  60 * time.Second,\n        Database: \"db\",\n    }\n    sess, err := mgo.DialWithInfo(mongoDBDialInfo)\n    if err != nil {\n        panic(err)\n    }\n    sess.SetMode(mgo.Monotonic, true)\n    MyDB.Session = sess\n}\n\n// Close is a helper method that ensures the session is properly terminated\nfunc (ds *DataStore) Close() {\n    ds.Session.Close()\n}\n</code></pre>\n\n<p>Then in another package, for example main <strong>Updated Based on the comment below</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"../models/mongo\"\n)\n\nfunc main() {\n    // Grab the main session which was instantiated in the mongo package init function\n    sess := mongo.MyDB.Session\n    // pass that session in\n    storeEvents(sess)\n}\n\nfunc storeEvents(session *mgo.Session) {\n    session_copy := session.Copy()\n    defer session_copy.Close()\n\n    // Handle panics in a deferred fuction\n    // You can turn this into a wrapper (middleware)\n    // remove this this function, and just wrap your calls with it, using switch cases\n    // you can handle all types of errors\n    defer func(session *mgo.Session) {\n        if err := recover(); err != nil {\n            fmt.Printf(\"Mongo insert has caused a panic: %s\\n\", err)\n            fmt.Println(\"Attempting to insert again\")\n            session_copy := session.Copy()\n            defer session_copy.Close()\n            col := session_copy.DB(\"DB_NAME\").C(\"COLLECTION_NAME\")\n            event := GetEvent()\n            err := col.Insert(&amp;event)\n            if err != nil {\n                fmt.Println(\"Attempting to insert again failed\")\n                return\n            }\n            fmt.Println(\"Attempting to insert again succesful\")\n        }\n    }(session)\n\n    col := session_copy.DB(\"DB_NAME\").C(\"COLLECTION_NAME\")\n    event := GetEvent()\n    err := col.Insert(&amp;event)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>I use a similar setup on my production servers on AWS. I do over 1 million inserts an hour. Hope this helps.  Another things I've done to ensure that the mongo servers can handle the connections is increate the ulimit on my production machines.  It's talked about in this <a href=\"https://stackoverflow.com/questions/16713415/mongodb-increasing-max-connections-in-mongodb\">stack</a></p>\n"}], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 734, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1479678480, "creation_date": 1479596994, "last_edit_date": 1495540415, "question_id": 40698909, "link": "https://stackoverflow.com/questions/40698909/re-creating-mgo-sessions-in-case-of-errors-read-tcp-127-0-0-146954-127-0-0-1", "title": "Re-creating mgo sessions in case of errors (read tcp 127.0.0.1:46954-&gt;127.0.0.1:27017: i/o timeout)", "body": "<p>I wonder about MongoDB session management in Go using <a href=\"https://gopkg.in/mgo.v2\" rel=\"nofollow noreferrer\">mgo</a>, especially about how to correctly ensure a session is closed and how to react on write failures.</p>\n\n<p>I have read the following:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26574594/best-practice-to-maintain-a-mgo-session\">Best practice to maintain a mgo session</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/33275357/should-i-copy-session-for-each-operation-in-mgo?noredirect=1&amp;lq=1\">Should I copy session for each operation in mgo?</a></p>\n\n<p>Still, cannot apply it to my situation.</p>\n\n<p>I have two goroutines which store event after event into MongoDB sharing the same *mgo.Session, both looking essiantially like the following:</p>\n\n<pre><code>func storeEvents(session *mgo.Session) {\n    session_copy := session.Copy()\n    // *** is it correct to defer the session close here? &lt;-----\n    defer session_copy.Close()\n    col := session_copy.DB(\"DB_NAME\").C(\"COLLECTION_NAME\")\n    for {\n        event := GetEvent()\n        err := col.Insert(&amp;event)\n        if err != nil {\n            // *** insert FAILED - how to react properly? &lt;-----\n            session_copy = session.Copy()\n            defer session_copy.Close()\n        }\n    }\n}\n</code></pre>\n\n<p>col.Insert(&amp;event) after some hours returns the error</p>\n\n<pre><code>read tcp 127.0.0.1:46954-&gt;127.0.0.1:27017: i/o timeout\n</code></pre>\n\n<p>and I am unsure how to react on this. After this error occurs, it occurs on all subsequent writes, hence it seems I have to create a new session. Alternatives for me seem:</p>\n\n<p>1) restart the whole goroutine, i.e.</p>\n\n<pre><code>if err != nil {\n    go storeEvents(session)\n    return\n}\n</code></pre>\n\n<p>2) create a new session copy</p>\n\n<pre><code>if err != nil {\n    session_copy = session.Copy()\n    defer session_copy.Close()\n    col := session_copy.DB(\"DB_NAME\").C(\"COLLECTION_NAME\")\n    continue\n}\n</code></pre>\n\n<p>--> Is it correct how I use <code>defer session_copy.Close()</code>? (Note the above defer references the Close() function of another session. Anyway, those sessions will never be closed since the function never returns. I.e., with time, many sessions will be created and not closed.</p>\n\n<p>Other options?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 30089, "user_id": 22147, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/x74x2.png?s=128&g=1", "display_name": "Rhythmic Fistman", "link": "https://stackoverflow.com/users/22147/rhythmic-fistman"}, "is_accepted": true, "score": 3, "last_activity_date": 1479592338, "creation_date": 1479592338, "answer_id": 40698304, "question_id": 40698237, "link": "https://stackoverflow.com/questions/40698237/go-create-a-new-file-in-a-specified-path/40698304#40698304", "title": "go - Create a new file in a specified path", "body": "<p><code>Open()</code> won't create the file. Try <code>Create()</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 2, "last_activity_date": 1479603535, "creation_date": 1479603535, "answer_id": 40699567, "question_id": 40698237, "link": "https://stackoverflow.com/questions/40698237/go-create-a-new-file-in-a-specified-path/40699567#40699567", "title": "go - Create a new file in a specified path", "body": "<p>You were probably looking to use <a href=\"https://golang.org/pkg/os/#OpenFile\" rel=\"nofollow noreferrer\">os.OpenFile</a></p>\n\n<p>As the other poster mentioned you can use <code>Create()</code> and then <code>Open()</code> after it's created.</p>\n\n<p>If you need high specificity, <code>os.OpenFile</code> can be useful as it allows you to set the path, flags (read only, write only etc.) and permissions all in one go.</p>\n\n<p>Eg.</p>\n\n<pre><code>f, err := os.OpenFile(filepath, os.O_WRONLY|os.O_CREATE, 0666)\nif err != nil {\n    //handle error\n}\n\ndefer f.Close()\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2580104"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3751, "favorite_count": 0, "accepted_answer_id": 40698304, "answer_count": 2, "score": 2, "last_activity_date": 1479603535, "creation_date": 1479591750, "question_id": 40698237, "link": "https://stackoverflow.com/questions/40698237/go-create-a-new-file-in-a-specified-path", "title": "go - Create a new file in a specified path", "body": "<p>Trying to make a portable way to create a file in a specified directory within my $GOPATH.</p>\n\n<pre><code>  var FileName string = \"Foci.db\" \n  var Driver string = \"sqlite3\" \n\n  func Connect(fileName string) (*sql.DB, error) { \n      filePath, _ := filepath.Abs(\"../data/\" + FileName) \n      // Create db if it doesn't exist \n      os.Open(filePath)\n      // Open existing db \n      return sql.Open(Driver, filePath) \n  } \n</code></pre>\n\n<p>However, this doesn't seem to create the file in the data directory as I hoped. Am I doing something wrong?</p>\n"}, {"tags": ["go", "server", "host", "lan"], "comments": [{"owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 7, "creation_date": 1479585410, "post_id": 40697131, "comment_id": 68623879, "body": "I&#39;m pretty sure you should learn a bit how networks work before start to write servers. You can&#39;t bind a listener to IP that is not assigned to the server."}, {"owner": {"reputation": 125, "user_id": 5238942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n_oYM5dMyT8/AAAAAAAAAAI/AAAAAAAAAH8/ikYQdg5Ml-E/photo.jpg?sz=128", "display_name": "Andrej Lavrinovic", "link": "https://stackoverflow.com/users/5238942/andrej-lavrinovic"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1479592593, "post_id": 40697131, "comment_id": 68625889, "body": "Yea, I am not very good in networking. But also I am not writing a server, I mean I do, but this is not a goal. I need to build an app in go language that will serve requests. To set the listener you need just put iris.Listen(&quot;:9898&quot;) line on the end of main method. It will host the service globaly (0.0.0.0:9898). I just want to find out is there any way to restrict external access?  Or may be there is not access from outside of  my LAN?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "edited": false, "score": 0, "creation_date": 1479602820, "post_id": 40697131, "comment_id": 68628027, "body": "Forst I agree with @RomanR. Second if you are using WiFi and you run your go server on your localhost (like your suppose to),  you can access the web server from any device connected to the same WiFi, by visiting the localhost from that machine."}, {"owner": {"reputation": 125, "user_id": 5238942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n_oYM5dMyT8/AAAAAAAAAAI/AAAAAAAAAH8/ikYQdg5Ml-E/photo.jpg?sz=128", "display_name": "Andrej Lavrinovic", "link": "https://stackoverflow.com/users/5238942/andrej-lavrinovic"}, "edited": false, "score": 0, "creation_date": 1479757762, "post_id": 40697131, "comment_id": 68683454, "body": "Thanks lads for help and explanation. Will learn networking."}], "answers": [{"tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 4, "last_activity_date": 1479617817, "last_edit_date": 1479617817, "creation_date": 1479604657, "answer_id": 40699677, "question_id": 40697131, "link": "https://stackoverflow.com/questions/40697131/how-to-set-the-golang-server-listener-available-for-only-my-lan-network/40699677#40699677", "title": "How to set the golang server listener available for only my LAN network", "body": "<p>You should read up on how networking works but here are some points to get you started.</p>\n\n<p>You listen on a port, not an IP address. So whatever machine you're using as your server, find your local IP address:</p>\n\n<p>On Linux or Mac you can do it many ways:</p>\n\n<p><code>ifconfig | grep netmask</code> and get your local address eg. <code>192.168.x.xx</code></p>\n\n<p>Then start up your server with your Go program and listen on a localhost port like 8080.</p>\n\n<p>eg. </p>\n\n<pre><code>if err := http.ListenAndServe(\":8080\", nil); err != nil {\n    //handle error\n}\n</code></pre>\n\n<p>Then you can access the server with other machines in your house assuming they are on the same Wifi. Use a different computer and visit <code>192.168.x.xx:8080</code> from a browser.</p>\n\n<p>To answer your question in your comments, outsiders cannot access your local server unless they have a connection to your Wifi.</p>\n"}], "owner": {"reputation": 125, "user_id": 5238942, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n_oYM5dMyT8/AAAAAAAAAAI/AAAAAAAAAH8/ikYQdg5Ml-E/photo.jpg?sz=128", "display_name": "Andrej Lavrinovic", "link": "https://stackoverflow.com/users/5238942/andrej-lavrinovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5116, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1479617817, "creation_date": 1479584342, "question_id": 40697131, "link": "https://stackoverflow.com/questions/40697131/how-to-set-the-golang-server-listener-available-for-only-my-lan-network", "title": "How to set the golang server listener available for only my LAN network", "body": "<p>I am using iris platform to do programming in go language (I am very beginner). I want to make all my computers at home be available for accessing to go server which is one of the local machine as well. When I set the listener with my network IP (192.168.0.0) or with any specified IP (192.168.0.15) it gives me panic error back. Only available 0.0.0.0 or 127.0.0.1/localhost or 192.168.0.19 - that is same as localhost</p>\n\n<pre><code>import \"net\"\n\n...\n\nln, err := net.Listen(\"tcp4\", \"192.168.12:9999\")\n    if err != nil{\n        panic(err)\n    }\n\n    iris.Serve(ln)\n\n...\n</code></pre>\n\n<p>The error is: <strong>panic: listen tcp4 192.168.0.12:9999: bind: The requested address is not valid in its context.</strong></p>\n\n<p>Thanks to all for help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1479585849, "post_id": 40697126, "comment_id": 68624016, "body": "Does it still hang when you remove the line <code>cmd.Stderr = &amp;stderr</code>?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 4, "creation_date": 1479586364, "post_id": 40697126, "comment_id": 68624159, "body": "mysql waits for more input."}, {"owner": {"reputation": 666, "user_id": 4061068, "user_type": "registered", "accept_rate": 31, "profile_image": "https://graph.facebook.com/1342754480/picture?type=large", "display_name": "Andrius Solopovas", "link": "https://stackoverflow.com/users/4061068/andrius-solopovas"}, "edited": false, "score": 0, "creation_date": 1479593895, "post_id": 40697126, "comment_id": 68626203, "body": "if I remove cmd.Stderr it doesn&#39;t change."}], "answers": [{"tags": [], "owner": {"reputation": 4254, "user_id": 1351597, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e2b94150c4f96fe11dae1494a054f7b?s=128&d=identicon&r=PG", "display_name": "Dekker1", "link": "https://stackoverflow.com/users/1351597/dekker1"}, "is_accepted": true, "score": 3, "last_activity_date": 1479661087, "creation_date": 1479661087, "answer_id": 40706762, "question_id": 40697126, "link": "https://stackoverflow.com/questions/40697126/go-exec-command-wait-hangs-for-ever/40706762#40706762", "title": "Go exec.Command(...).Wait() hangs for ever", "body": "<p>The problem is that you haven't closed the <code>stdin</code> pipe. MySQL will remain active until it is.</p>\n\n<p>The fix is thus simple:</p>\n\n<pre><code>// Write data to pipe\nio.WriteString(stdin, data)\nstdin.Close()\nfmt.Println(\"Importing \" + x.DB + \" to localhost...\")\n</code></pre>\n\n<p>The fact that <code>StdinPipe()</code> acts in this way is documented as such:</p>\n\n<blockquote>\n  <p>StdinPipe returns a pipe that will be connected to the command's standard input when the command starts. <em>The pipe will be closed automatically after Wait sees the command exit. A caller need only call Close to force the pipe to close sooner.</em> For example, if the command being run <strong>will not exit until standard input is closed</strong>, the caller must close the pipe.</p>\n</blockquote>\n"}], "owner": {"reputation": 666, "user_id": 4061068, "user_type": "registered", "accept_rate": 31, "profile_image": "https://graph.facebook.com/1342754480/picture?type=large", "display_name": "Andrius Solopovas", "link": "https://stackoverflow.com/users/4061068/andrius-solopovas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2481, "favorite_count": 1, "accepted_answer_id": 40706762, "answer_count": 1, "score": 0, "last_activity_date": 1479661087, "creation_date": 1479584318, "last_edit_date": 1479584913, "question_id": 40697126, "link": "https://stackoverflow.com/questions/40697126/go-exec-command-wait-hangs-for-ever", "title": "Go exec.Command(...).Wait() hangs for ever", "body": "<p>Hi guys for some reason Wait() when I execute mysql command hangs for ever, does anyone know why?\nHere is my code.</p>\n\n<pre><code>// Import imports data into Local database\nfunc (x MySQL) Import(data string, opt LocalDb) {\n    var stderr bytes.Buffer\n    cmd := exec.Command(\"mysql\", x.importOptions(opt)...)\n    // Set &lt; pipe variable\n    stdin, err := cmd.StdinPipe()\n    errChk(err)\n\n    cmd.Stderr = &amp;stderr\n    cmd.Start()\n\n    // Write data to pipe\n    io.WriteString(stdin, data)\n    fmt.Println(\"Importing \" + x.DB + \" to localhost...\")\n\n    // Log mysql error\n    if err := cmd.Wait(); err != nil {\n        log.Fatal(stderr.String())\n    } else {\n        fmt.Println(\"Importing complete\")\n    }\n}\n</code></pre>\n\n<p>This function accomplishes everything and mysql imports the data into database but it never return from Wait() just freezes there even though is completed.</p>\n"}, {"tags": ["go", "goroutine", "game-loop"], "answers": [{"comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 4, "creation_date": 1479581811, "post_id": 40696552, "comment_id": 68622799, "body": "it can even be written in a shorter way: <code>for range time.Tick(16 * time.Millisecond) { ... } </code>. And your suggestion is WAY better - more compact, more readable, less GC pressure, less context switches, and of course more idiomatic."}, {"owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "edited": false, "score": 0, "creation_date": 1479637123, "post_id": 40696552, "comment_id": 68633957, "body": "Well, i found this more elegant than <code>time.AfterFunc()</code>. Thanks for the answer."}, {"owner": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1494004512, "post_id": 40696552, "comment_id": 74660169, "body": "Is this like having a time step? Does this work for 30 frames per second?"}, {"owner": {"reputation": 77, "user_id": 465894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c81b21962ff63a2c31ad7e62b3128fb?s=128&d=identicon&r=PG", "display_name": "tsalaroth", "link": "https://stackoverflow.com/users/465894/tsalaroth"}, "reply_to_user": {"reputation": 14826, "user_id": 3134069, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5002efc769839cea1738a0e530f0e5d6?s=128&d=identicon&r=PG", "display_name": "majidarif", "link": "https://stackoverflow.com/users/3134069/majidarif"}, "edited": false, "score": 0, "creation_date": 1598123666, "post_id": 40696552, "comment_id": 112357697, "body": "@majidarif if you do the math, it could, yes - the answer here is based on 60fps (16ms * 60 ~= 1s)."}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": 7, "last_activity_date": 1479601228, "last_edit_date": 1479601228, "creation_date": 1479580663, "answer_id": 40696552, "question_id": 40696458, "link": "https://stackoverflow.com/questions/40696458/game-loop-simulation-in-golang/40696552#40696552", "title": "Game Loop simulation in Golang", "body": "<p><code>AfterFunc</code> executes the registered function in a goroutine.  <a href=\"https://golang.org/pkg/time/#AfterFunc\" rel=\"noreferrer\">https://golang.org/pkg/time/#AfterFunc</a>  </p>\n\n<p>While there are only 2 go routines running at a time, there have been 314 (maybe?? Not sure how goroutine ids work) goroutines throughout the program.</p>\n\n<hr>\n\n<p>i don't consider it a \"better\" way, but a different way, and my preferred, could be to model the game loop as a <code>for</code> loop.</p>\n\n<pre><code>func gameLoop()  {\n    tick := time.Tick(16 * time.Millisecond)\n\n    for {\n        select {\n        case &lt;-tick:\n\n        }\n    }\n}\n</code></pre>\n\n<p>In addition to concisely registering a case for an interval, selecting over a channel allows you to easily model a timeout, by adding another case for <code>&lt;-time.After</code>, or for cancellation, by adding another case for a <code>&lt;-done</code> channel.</p>\n"}], "owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1497, "favorite_count": 2, "accepted_answer_id": 40696552, "answer_count": 1, "score": 1, "last_activity_date": 1479601228, "creation_date": 1479580039, "question_id": 40696458, "link": "https://stackoverflow.com/questions/40696458/game-loop-simulation-in-golang", "title": "Game Loop simulation in Golang", "body": "<p>I want to create game loop in go(lang), so i tried this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    // \"runtime\"\n    \"sync\"\n    \"time\"\n)\n\nvar v = 0\nvar wg sync.WaitGroup\nvar sec = 5\n\nfunc main() {\n    wg.Add(1)\n    gameLoop()\n    wg.Wait()\n}\n\nfunc gameLoop() {\n    time.AfterFunc(16*time.Millisecond, gameLoop)\n    v++\n    fmt.Println(v)\n    if v == sec*60 {\n        // fmt.Println(\"Goroutines: \", runtime.NumGoroutine())\n        panic(\"err\")\n        wg.Done()\n    }\n}\n</code></pre>\n\n<p>This program running at 62.5Hz <code>(16*time.Millisecond)</code>, var <code>sec</code> is used for calling <code>wg.Done()</code> after 5 second and caused var <code>v</code> printed 300 times.</p>\n\n<p>calling <code>panic(\"err\")</code> making the result like this:</p>\n\n<pre><code>panic: err\n\ngoroutine 314 [running]:\npanic(0x493c60, 0xc420094370)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\nmain.gameLoop()\n    /home/billyzaelani/Desktop/main.go:26 +0x11f\ncreated by time.goFunc\n    /usr/local/go/src/time/sleep.go:154 +0x44\nexit status 2\n</code></pre>\n\n<p>Well what is the meaning of <code>goroutine 314 [running]</code> ? did i use 314 goroutine for 5 second game loop? how if this run for hours?</p>\n\n<p>But, if the program use runtime package and print <code>runtime.NumGoroutine</code> which is return number of goroutine, the result is <code>Goroutines:  2</code></p>\n\n<p>So, back again what is the meaning of <code>goroutine 314 [running]</code>? while runtime package say different things.</p>\n\n<p>Last one, if anyone can show me the better way to create game loop in golang, i really appreciate that, thankyou</p>\n"}, {"tags": ["go", "concurrency"], "answers": [{"tags": [], "owner": {"reputation": 745, "user_id": 1823636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56dc271a930773cc7ce95dfceedcd83e?s=128&d=identicon&r=PG", "display_name": "sisoft", "link": "https://stackoverflow.com/users/1823636/sisoft"}, "is_accepted": true, "score": 4, "last_activity_date": 1479572802, "last_edit_date": 1479572802, "creation_date": 1479572026, "answer_id": 40695088, "question_id": 40694698, "link": "https://stackoverflow.com/questions/40694698/how-to-run-a-golang-function-call-once-per-key-parameter-in-concurrent-environme/40695088#40695088", "title": "How to run a golang function call once per key parameter in concurrent environment?", "body": "<p>I think <code>sync.Once</code> is not well for such task. You need to maintain some flag (\"once\") for each key individually. Map with mutexed access is one of possible solutions.</p>\n\n<p>Full working example:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"sync\"\n        \"time\"\n)\n\nvar once map[string]bool\nvar onceMutex sync.Mutex\nvar itIsTheTimeToRefreshData = true\n\nfunc Get(key string) {\n        fmt.Printf(\"Access for key: %s\\n\", key)\n        if itIsTheTimeToRefreshData {\n                onceBody := func() {\n                        fmt.Printf(\"Only once for key: %s\\n\", key)\n                        //fetchDataInBackground()\n                }\n\n                onceMutex.Lock()\n                if !once[key] { // is it first time?\n                        once[key] = true\n                        onceMutex.Unlock()\n\n                        // refresh something here\n                        go onceBody()\n                } else {\n                        onceMutex.Unlock()\n                }\n        }\n}\n\nfunc main() {\n        once = make(map[string]bool)\n\n        // do it first time in parallel\n        for i := 0; i &lt; 10; i++ {\n                key := fmt.Sprintf(\"i%d\", i)\n                go func(key string) {\n                        Get(key)\n                }(key)\n        }\n        // and another time\n        for i := 0; i &lt; 10; i++ {\n                key := fmt.Sprintf(\"i%d\", i)\n                go func(key string) {\n                        Get(key)\n                }(key)\n        }\n        fmt.Println(\"All requested.\")\n        time.Sleep(1 * time.Second)\n}\n</code></pre>\n"}], "owner": {"reputation": 664, "user_id": 935203, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/764e5f288b3534281b1fe7a1b95218ae?s=128&d=identicon&r=PG", "display_name": "Ramin Mir.", "link": "https://stackoverflow.com/users/935203/ramin-mir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 0, "accepted_answer_id": 40695088, "answer_count": 1, "score": 1, "last_activity_date": 1479572802, "creation_date": 1479569897, "question_id": 40694698, "link": "https://stackoverflow.com/questions/40694698/how-to-run-a-golang-function-call-once-per-key-parameter-in-concurrent-environme", "title": "How to run a golang function call once per key parameter in concurrent environment?", "body": "<p>This example seems to fetch data once, but I don't think it will invoke a <code>fetchDataInBackground</code> function in background for each <code>key</code> concurrently.</p>\n\n<pre><code>func Get(key string){\n    ...\n    if itIsTheTimeToRefreshData{\n         var once sync.Once\n         onceBody := func() {\n            fetchDataInBackground()\n         }\n         go func() {\n            once.Do(onceBody)\n         }()\n     }\n     ...\n }\n</code></pre>\n\n<p>what I need to do is to assign each <code>Once</code> instance to a <code>key</code> so that all fetch data for different keys can be done concurrently.\nhow do I do that?</p>\n"}, {"tags": ["go", "firebase-cloud-messaging"], "answers": [{"comments": [{"owner": {"reputation": 1609, "user_id": 6109459, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Hg2RO.jpg?s=128&g=1", "display_name": "Kishan Oza", "link": "https://stackoverflow.com/users/6109459/kishan-oza"}, "edited": false, "score": 0, "creation_date": 1540992534, "post_id": 40782104, "comment_id": 93065765, "body": "yah right !! I am struggling with the payload .. I mean do u know how to set some user defined payload as firebase needs two keys &quot;notification&quot; and &quot;data&quot;..I am new in GO but I made the similar for PHP over here(<a href=\"https://gist.github.com/KishanIos007/e9064cd5e553ab507805dbcf0d713a18\" rel=\"nofollow noreferrer\">gist.github.com/KishanIos007/e9064cd5e553ab507805dbcf0d&zwnj;&#8203;713a18</a>).. I want that same payload in go ... can you help me :)"}], "tags": [], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "is_accepted": false, "score": 2, "last_activity_date": 1479978753, "creation_date": 1479978753, "answer_id": 40782104, "question_id": 40691612, "link": "https://stackoverflow.com/questions/40691612/how-to-send-fcm-push-notification-using-goalng-fcm-server/40782104#40782104", "title": "how to send fcm push notification using goalng fcm server", "body": "<p>Your question is vague and you could have answered it by simply googling fcm golang or something around the line. Basically here's a list of libraries:</p>\n\n<p><a href=\"https://golanglibs.com/top?q=firebase\" rel=\"nofollow noreferrer\">https://golanglibs.com/top?q=firebase</a> </p>\n\n<p>It seems like most of them have some examples + docs.\nI'd generally speaking go with the most popular:</p>\n\n<p><a href=\"https://github.com/zabawaba99/firego\" rel=\"nofollow noreferrer\">https://github.com/zabawaba99/firego</a></p>\n\n<p>Because you can inspire yourself from github issues and the docs are kind of decent:</p>\n\n<p><a href=\"https://godoc.org/gopkg.in/zabawaba99/firego.v1\" rel=\"nofollow noreferrer\">https://godoc.org/gopkg.in/zabawaba99/firego.v1</a></p>\n\n<p>Small note, if any go library seems to lack examples/docs try running godocs in the folder or (even faster), try to first look for a GoDocs link on the github page.</p>\n"}, {"comments": [{"owner": {"reputation": 602, "user_id": 7298476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-GFvrO_XBTc0/AAAAAAAAAAI/AAAAAAAAABY/ZJozy2uC2fc/photo.jpg?sz=128", "display_name": "sarvesh chavan", "link": "https://stackoverflow.com/users/7298476/sarvesh-chavan"}, "edited": false, "score": 0, "creation_date": 1566121772, "post_id": 40817880, "comment_id": 101550173, "body": "@solomon abel what if we want to give sound for notification?"}], "tags": [], "owner": {"reputation": 136, "user_id": 5275486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d664ec65414eeef0725929cedc41e1a8?s=128&d=identicon&r=PG&f=1", "display_name": "solomon abel", "link": "https://stackoverflow.com/users/5275486/solomon-abel"}, "is_accepted": true, "score": 4, "last_activity_date": 1480159750, "creation_date": 1480159750, "answer_id": 40817880, "question_id": 40691612, "link": "https://stackoverflow.com/questions/40691612/how-to-send-fcm-push-notification-using-goalng-fcm-server/40817880#40817880", "title": "how to send fcm push notification using goalng fcm server", "body": "<pre><code>    package main\n\n    import (\n        \"fmt\"\n        \"github.com/NaySoftware/go-fcm\"\n    )\n\n    const (\n         serverKey = \"YOUR-KEY\"\n    )\n\n    func main() {\n\n  var NP fcm.NotificationPayload \n   NP.Title=\"hello\"\n   NP.Body=\"world\"\n\n        data := map[string]string{\n            \"msg\": \"Hello World1\",\n            \"sum\": \"Happy Day\",\n        }\n\n      ids := []string{\n          \"token1\",\n      }\n\n\n      xds := []string{\n          \"token5\",\n          \"token6\",\n          \"token7\",\n      }\n\n        c := fcm.NewFcmClient(serverKey)\n        c.NewFcmRegIdsMsg(ids, data)\n        c.AppendDevices(xds)\n        c.SetNotificationPayload(&amp;NP)\n        status, err := c.Send()\n        if err == nil {\n        status.PrintResults()\n        } else {\n            fmt.Println(err)`enter code here`\n        }\n\n    }\n</code></pre>\n\n<p>try this it works cool.</p>\n"}], "owner": {"reputation": 63, "user_id": 6705017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d07c333960ec279550374c351ac7558?s=128&d=identicon&r=PG&f=1", "display_name": "veer", "link": "https://stackoverflow.com/users/6705017/veer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4966, "favorite_count": 3, "accepted_answer_id": 40817880, "answer_count": 2, "score": 4, "last_activity_date": 1480159750, "creation_date": 1479550280, "last_edit_date": 1480157538, "question_id": 40691612, "link": "https://stackoverflow.com/questions/40691612/how-to-send-fcm-push-notification-using-goalng-fcm-server", "title": "how to send fcm push notification using goalng fcm server", "body": "<p>i am doing ionic apps, using cordova fcm plugin i get the device token.Now i want send the push notification from go server.please help me how use go as the fcm server.I need some implementation example</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 524914, "user_type": "registered", "profile_image": "https://graph.facebook.com/1077908942/picture?type=large", "display_name": "WebSwami", "link": "https://stackoverflow.com/users/524914/webswami"}, "edited": false, "score": 0, "creation_date": 1479553900, "post_id": 40692003, "comment_id": 68613863, "body": "Thanks @Geek_KK , Changing region solved this issue, Actually one of my colleague was trying to access these AWS credentials and he accidentally set region to default value and I was using &#39;ap-south-1&#39; this region. Thanks again"}], "tags": [], "owner": {"reputation": 184, "user_id": 1240668, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/SMJlV.jpg?s=128&g=1", "display_name": "Geek_KK", "link": "https://stackoverflow.com/users/1240668/geek-kk"}, "is_accepted": true, "score": 1, "last_activity_date": 1479552715, "creation_date": 1479552715, "answer_id": 40692003, "question_id": 40690665, "link": "https://stackoverflow.com/questions/40690665/panic-runtime-error-while-fetching-records-from-dynamodb-using-golang/40692003#40692003", "title": "panic runtime error while fetching records from DynamoDB using golang", "body": "<p>I have gone through your code and it seems to me that, there is problem with your database connectivity. You are trying to connect to maybe some different region. So, please first recheck your region. It is there in the URL of AWS account of your dynamodb.(e.g us-east-2). You can also check or configure your region by typing this command into the terminal : aws configure . Then it will ask you to enter your access key, secret key, region name etc .Enter all the details here. That's it. Cheers. </p>\n"}], "owner": {"reputation": 208, "user_id": 524914, "user_type": "registered", "profile_image": "https://graph.facebook.com/1077908942/picture?type=large", "display_name": "WebSwami", "link": "https://stackoverflow.com/users/524914/webswami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 40692003, "answer_count": 1, "score": 0, "last_activity_date": 1479552715, "creation_date": 1479543238, "last_edit_date": 1479552361, "question_id": 40690665, "link": "https://stackoverflow.com/questions/40690665/panic-runtime-error-while-fetching-records-from-dynamodb-using-golang", "title": "panic runtime error while fetching records from DynamoDB using golang", "body": "<p>I am facing issue while accessing aws-sdk-go, I am trying to connect to dynamo DB using aws-sdk-go. I am able to establish connection to database and insert operation is working fine, but when I am trying to retrieve data from table I am getting \"panic runtime error invalid memory address or nil pointer dereference golang\" error. Please find code I used. I am new to both technologies.</p>\n\n<pre><code>package main \nimport (\n  \"github.com/aws/aws-sdk-go/aws\"\n  \"github.com/aws/aws-sdk-go/aws/session\"\n  \"github.com/aws/aws-sdk-go/aws/credentials\"\n  \"github.com/aws/aws-sdk-go/service/dynamodb\"\n  \"github.com/user/dynamo_connect/data\"\n  \"github.com/user/insert_api/read\"\n)\nimport (\n  \"fmt\"\n  \"log\"\n  \"net/http\"\n  \"crypto/md5\"\n  \"encoding/hex\"\n  \"io\"\n  \"time\"\n  \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n  router := mux.NewRouter().StrictSlash(true)\n  router.HandleFunc(\"/get\", GetCampaignRecord)\n  log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n\nfunc GetCampaignRecord(w http.ResponseWriter, r *http.Request) {\n  var testCredentials = credentials.NewStaticCredentials(\"AKIxxxxxxxxxxxxxxxxx\", \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\", \"\")\n  sess, err := session.NewSession()\n  svc := dynamodb.New(sess, &amp;aws.Config{\n    Region: aws.String(\"ap-south-1\"),\n    Credentials: testCredentials,\n  })\n\n  resp, err := read.GetCampaignData(svc)\n  if err != nil {\n    fmt.Println(\"An error occurred while writing to the Employee table\")\n    fmt.Println(err.Error())\n  }\n\n  if resp != nil {\n    fmt.Println(\"An error occurred while writing to the Employee table\")\n    fmt.Println(err.Error())\n  }\n}\n</code></pre>\n\n<p>package read</p>\n\n<pre><code>    package read\n    import \"github.com/aws/aws-sdk-go/service/dynamodb\"\n    import \"github.com/aws/aws-sdk-go/aws\"\n\n    func GetCampaignData(svc *dynamodb.DynamoDB) (*dynamodb.BatchGetItemOutput, error) {\n      params := &amp;dynamodb.BatchGetItemInput{\n        RequestItems: map[string]*dynamodb.KeysAndAttributes{\n            \"employee\": {\n                Keys: []map[string]*dynamodb.AttributeValue{\n                    {\n                        \"employee_id\": {\n                            S:    aws.String(\"1\"),\n                        },\n                    },\n                },\n                ProjectionExpression: aws.String(\"employee_id, employee_name\"),\n            },\n        },\n        ReturnConsumedCapacity: aws.String(\"TOTAL\"),\n    }\n\n    return svc.BatchGetItem(params)\n    }\n</code></pre>\n\n<p>Full Error I am getting </p>\n\n<blockquote>\n  <p>http: panic serving 127.0.0.1:36034: runtime error: invalid memory address or nil pointer dereference\n      goroutine 18 [running]:\n      net/http.(*conn).serve.func1(0xc820102000)\n       /usr/local/go/src/net/http/server.go:1389 +0xc1\n      panic(0x8919a0, 0xc82000a110)\n       /usr/local/go/src/runtime/panic.go:443 +0x4e9\n      github.com/aws/aws-sdk-go/aws/session.(*Session).Copy(0x0, 0xc82012a020, 0x1, 0x1, 0x0)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:365 +0x2a\n      github.com/aws/aws-sdk-go/aws/session.(*Session).ClientConfig(0x0, 0x935410, 0x8, 0xc82012a020, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, ...)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:378 +0x72\n      github.com/aws/aws-sdk-go/service/dynamodb.New(0x7f20477cd248, 0x0, 0xc82012a020, 0x1, 0x1, 0xc820112260)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/service/dynamodb/service.go:153 +0x78\n      main.GetCampaignRecord(0x7f20477cd058, 0xc820122000, 0xc82010e000)\n       /home/MyUser/work/src/github.com/user/insert_api/insert_api.go:80 +0x329\n      net/http.HandlerFunc.ServeHTTP(0xa07d38, 0x7f20477cd058, 0xc820122000, 0xc82010e000)\n       /usr/local/go/src/net/http/server.go:1618 +0x3a\n      github.com/gorilla/mux.(*Router).ServeHTTP(0xc8200125a0, 0x7f20477cd058, 0xc820122000, 0xc82010e000)\n       /home/MyUser/work/src/github.com/gorilla/mux/mux.go:114 +0x2a8\n      net/http.serverHandler.ServeHTTP(0xc82006e180, 0x7f20477cd058, 0xc820122000, 0xc82010e000)\n       /usr/local/go/src/net/http/server.go:2081 +0x19e\n      net/http.(*conn).serve(0xc820102000)\n       /usr/local/go/src/net/http/server.go:1472 +0xf2e\n      created by net/http.(*Server).Serve\n       /usr/local/go/src/net/http/server.go:2137 +0x44e\n      2016/11/19 13:31:34 http: panic serving 127.0.0.1:36035: runtime error: invalid memory address or nil pointer dereference\n      goroutine 5 [running]:\n      net/http.(*conn).serve.func1(0xc82006e200)\n       /usr/local/go/src/net/http/server.go:1389 +0xc1\n      panic(0x8919a0, 0xc82000a110)\n       /usr/local/go/src/runtime/panic.go:443 +0x4e9\n      github.com/aws/aws-sdk-go/aws/session.(*Session).Copy(0x0, 0xc82012a038, 0x1, 0x1, 0x0)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:365 +0x2a\n      github.com/aws/aws-sdk-go/aws/session.(*Session).ClientConfig(0x0, 0x935410, 0x8, 0xc82012a038, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, ...)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:378 +0x72\n      github.com/aws/aws-sdk-go/service/dynamodb.New(0x7f20477cd248, 0x0, 0xc82012a038, 0x1, 0x1, 0xc820112540)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/service/dynamodb/service.go:153 +0x78\n      main.GetCampaignRecord(0x7f20477cd058, 0xc8201224e0, 0xc8200d20e0)\n       /home/MyUser/work/src/github.com/user/insert_api/insert_api.go:80 +0x329\n      net/http.HandlerFunc.ServeHTTP(0xa07d38, 0x7f20477cd058, 0xc8201224e0, 0xc8200d20e0)\n       /usr/local/go/src/net/http/server.go:1618 +0x3a\n      github.com/gorilla/mux.(*Router).ServeHTTP(0xc8200125a0, 0x7f20477cd058, 0xc8201224e0, 0xc8200d20e0)\n       /home/MyUser/work/src/github.com/gorilla/mux/mux.go:114 +0x2a8\n      net/http.serverHandler.ServeHTTP(0xc82006e180, 0x7f20477cd058, 0xc8201224e0, 0xc8200d20e0)\n       /usr/local/go/src/net/http/server.go:2081 +0x19e\n      net/http.(*conn).serve(0xc82006e200)\n       /usr/local/go/src/net/http/server.go:1472 +0xf2e\n      created by net/http.(*Server).Serve\n       /usr/local/go/src/net/http/server.go:2137 +0x44e\n      2016/11/19 13:31:34 http: panic serving 127.0.0.1:36036: runtime error: invalid memory address or nil pointer dereference\n      goroutine 34 [running]:\n      net/http.(*conn).serve.func1(0xc820114280)\n       /usr/local/go/src/net/http/server.go:1389 +0xc1\n      panic(0x8919a0, 0xc82000a110)\n       /usr/local/go/src/runtime/panic.go:443 +0x4e9\n      github.com/aws/aws-sdk-go/aws/session.(*Session).Copy(0x0, 0xc82012a058, 0x1, 0x1, 0x0)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:365 +0x2a\n      github.com/aws/aws-sdk-go/aws/session.(*Session).ClientConfig(0x0, 0x935410, 0x8, 0xc82012a058, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0, ...)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/aws/session/session.go:378 +0x72\n      github.com/aws/aws-sdk-go/service/dynamodb.New(0x7f20477cd248, 0x0, 0xc82012a058, 0x1, 0x1, 0xc820112840)\n       /home/MyUser/work/src/github.com/aws/aws-sdk-go/service/dynamodb/service.go:153 +0x78\n      main.GetCampaignRecord(0x7f20477cd058, 0xc820122820, 0xc82016c000)\n       /home/MyUser/work/src/github.com/user/insert_api/insert_api.go:80 +0x329\n      net/http.HandlerFunc.ServeHTTP(0xa07d38, 0x7f20477cd058, 0xc820122820, 0xc82016c000)\n       /usr/local/go/src/net/http/server.go:1618 +0x3a\n      github.com/gorilla/mux.(*Router).ServeHTTP(0xc8200125a0, 0x7f20477cd058, 0xc820122820, 0xc82016c000)\n       /home/MyUser/work/src/github.com/gorilla/mux/mux.go:114 +0x2a8\n      net/http.serverHandler.ServeHTTP(0xc82006e180, 0x7f20477cd058, 0xc820122820, 0xc82016c000)\n       /usr/local/go/src/net/http/server.go:2081 +0x19e\n      net/http.(*conn).serve(0xc820114280)\n       /usr/local/go/src/net/http/server.go:1472 +0xf2e\n      created by net/http.(*Server).Serve\n       /usr/local/go/src/net/http/server.go:2137 +0x44e</p>\n</blockquote>\n"}, {"tags": ["go", "google-cloud-pubsub"], "comments": [{"owner": {"reputation": 11, "user_id": 7181173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIThX.jpg?s=128&g=1", "display_name": "Mad Min", "link": "https://stackoverflow.com/users/7181173/mad-min"}, "edited": false, "score": 0, "creation_date": 1479589201, "post_id": 40689553, "comment_id": 68624966, "body": "Hmm, now, on GAE, the MessageIterator.Next() call won&#39;t respond at all even though there are queued message for the topic."}], "owner": {"reputation": 11, "user_id": 7181173, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JIThX.jpg?s=128&g=1", "display_name": "Mad Min", "link": "https://stackoverflow.com/users/7181173/mad-min"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1479533674, "creation_date": 1479533315, "last_edit_date": 1479533674, "question_id": 40689553, "link": "https://stackoverflow.com/questions/40689553/google-cloud-pubsub-message-iterator-next-times-out-instead-of-returning-itera", "title": "Google Cloud Pubsub message iterator.Next() times out instead of returning iterator.Done (Go client)", "body": "<p>I'm trying to pull messages from a <code>Pubsub</code> subscription on an App Engine app. (The <code>GAE</code> app currently uses Go client library for <code>GCP</code>.) And after consuming all the queued messages, I am constantly hitting the following <code>RPC</code> error.</p>\n\n<blockquote>\n  <p>rpc error: code = 13 desc = transport is closing</p>\n</blockquote>\n\n<p>According to the doc, I'm supposed to get iterator. Done as an error from the <code>Next()</code> call after the last message in the queue, but it always returns the above RPC error.</p>\n\n<p>Is it an intended behavior?</p>\n"}, {"tags": ["python", "python-3.x", "go", "cgo"], "comments": [{"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 3, "creation_date": 1479522233, "post_id": 40688567, "comment_id": 68607502, "body": "Looks like <code>Py_None</code> is a macro: <a href=\"https://github.com/python/cpython/blob/321fd597f9dff757185bcfeb5fc39536746e06ab/Include/object.h#L908\" rel=\"nofollow noreferrer\">github.com/python/cpython/blob/&hellip;</a>"}, {"owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "reply_to_user": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1479522333, "post_id": 40688567, "comment_id": 68607519, "body": "Wow, I never would have guessed that. How on earth are you supposed to return None from Go? Surely this is something that somebody&#39;s bumped into..."}, {"owner": {"reputation": 31371, "user_id": 281108, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b160d50a7ecfe6018348629cb8677538?s=128&d=identicon&r=PG", "display_name": "Ismail Badawi", "link": "https://stackoverflow.com/users/281108/ismail-badawi"}, "edited": false, "score": 0, "creation_date": 1479522766, "post_id": 40688567, "comment_id": 68607571, "body": "I don&#39;t know anything about cgo, but presumably you can somehow refer to the address of <code>_Py_NoneStruct</code>, which is what <code>Py_None</code> expands to."}], "answers": [{"tags": [], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "is_accepted": false, "score": 1, "last_activity_date": 1479522828, "last_edit_date": 1495541625, "creation_date": 1479522828, "answer_id": 40688635, "question_id": 40688567, "link": "https://stackoverflow.com/questions/40688567/why-isnt-go-build-finding-py-none/40688635#40688635", "title": "Why isn&#39;t go build finding Py_None?", "body": "<p>Thanks to a comment from <a href=\"https://stackoverflow.com/users/281108/ismail-badawi\">Ismail Badawi</a>, the answer is to write a function in C that returns None. This is required because <code>Py_None</code> is a macro, which Go can't see.</p>\n\n<p><strong>none.c</strong></p>\n\n<pre><code>#define Py_LIMITED_API\n#include &lt;Python.h&gt;\n\nPyObject *IncrNone() {\n        Py_RETURN_NONE;\n}\n</code></pre>\n\n<p><strong>mymodule.go</strong></p>\n\n<pre><code>/*\n#cgo pkg-config: python3\n#define Py_LIMITED_API\n#include &lt;Python.h&gt;\n\nPyObject *IncrNone();\n*/\nimport \"C\"\n\n//export Nothing\nfunc Nothing(self, args *C.PyObject) (status *C.PyObject) {\n        return C.IncrNone()\n}\n</code></pre>\n"}], "owner": {"reputation": 2392, "user_id": 620679, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cb547106a24ce46841e936a917ed610d?s=128&d=identicon&r=PG", "display_name": "Scott Deerwester", "link": "https://stackoverflow.com/users/620679/scott-deerwester"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479522828, "creation_date": 1479522059, "last_edit_date": 1479522253, "question_id": 40688567, "link": "https://stackoverflow.com/questions/40688567/why-isnt-go-build-finding-py-none", "title": "Why isn&#39;t go build finding Py_None?", "body": "<p>I'm wrapping a Go library for Python. I need to be able to return None, but it's not finding it at compile time:</p>\n\n<pre><code>/*\n#cgo pkg-config: python3\n#define Py_LIMITED_API\n#include &lt;Python.h&gt;\n*/\nimport \"C\"\n\n//export Nothing\nfunc Nothing(self, args *C.PyObject) (status *C.PyObject) {\n    C.Py_IncRef(C.Py_None)\n    return C.Py_None\n}\n</code></pre>\n\n<p>Here's the output of <code>go build</code></p>\n\n<pre><code>go build -buildmode=c-shared -o mymodule.so\n# example.com/mywrapper\n/tmp/go-build293667616/example.com/mywrapper/_obj/_cgo_main.o:(.data.rel+0x0): undefined reference to `Py_None'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>I'm not understanding how it can be finding all of the other Py* functions and types (<code>PyArgs_ParseTuple</code> and <code>PyLong_FromLong</code> work just fine), but can't find <code>Py_None</code>. The Python library is obviously being loaded. What's going on here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1479502799, "post_id": 40685717, "comment_id": 68602256, "body": "In best, you should write a parser / lexer. For simplicity &amp; speed, have you considered to not delete the lines, but replace it with some comments, that you ll be able to replace again when time come to re insert the data ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479504966, "post_id": 40685717, "comment_id": 68603217, "body": "Since you can&#39;t &quot;insert&quot; bytes into a file, it&#39;s usually much easier (especially with small files like this) to read the file, manipulate the text as needed, and write a new file as a whole. That also allows you to wrote a complete temp file and replace the original atomically, rather than risk corruption of the original."}, {"owner": {"reputation": 47, "user_id": 2395760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69324be11b012bc3c5fb8c9d6732369?s=128&d=identicon&r=PG", "display_name": "Roger Welin", "link": "https://stackoverflow.com/users/2395760/roger-welin"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479507491, "post_id": 40685717, "comment_id": 68604119, "body": "@mh-cbon thanks for the idea, commenting out lines is probably the easiest way for this case"}], "owner": {"reputation": 47, "user_id": 2395760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69324be11b012bc3c5fb8c9d6732369?s=128&d=identicon&r=PG", "display_name": "Roger Welin", "link": "https://stackoverflow.com/users/2395760/roger-welin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 729, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1479502132, "creation_date": 1479502132, "question_id": 40685717, "link": "https://stackoverflow.com/questions/40685717/insert-string-after-certain-position-in-file", "title": "Insert string after certain position in file", "body": "<p>I have this file:</p>\n\n<pre><code>upstream frontends {\n    server service-example1.example.com;\n    server service-example2.example.com;\n}\n\nserver {\n  listen 80;\n\n  location / {\n      proxy_pass http://frontends;\n  }\n}\n</code></pre>\n\n<p>What I want to do is to remove and add lines in the upstream frontends section. Removing lines is quite easy:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    content, err := ioutil.ReadFile(\"nginx.conf\")\n    if err != nil {\n        panic(err)\n    }\n\n    lines := bytes.Replace(content, []byte(\"server service-example1.example.com;\"), []byte(\"\"), 1)\n    fmt.Println(string(lines))\n    err = ioutil.WriteFile(\"nginx.conf\", lines, 0644)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>However, I find it a lot more difficult to add the same line that I removed again. My scenario is that I want to remove the line containing \"<em>server service-example2.example.com;</em>\", reload nginx conf. Later I want to add the same line at it's previous position and reload nginx again. </p>\n\n<p>I find it difficult to get the exact byte position in the file where I want to add the line again with *(f <em>File) WriteAt</em>. I've been looking at this example: <a href=\"https://play.golang.org/p/eaWYAkxyLI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eaWYAkxyLI</a>, but cannot figure out a good way how to do it.</p>\n\n<p>Anyone got any idea how I can solve this?</p>\n"}, {"tags": ["go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 2, "last_activity_date": 1479502772, "creation_date": 1479502772, "answer_id": 40685851, "question_id": 40685601, "link": "https://stackoverflow.com/questions/40685601/goyaml-convert-string-to-int-constant/40685851#40685851", "title": "goyaml convert string to int constant", "body": "<p><code>go-yaml</code> can't do it automatically because it can only see what <code>package reflect</code> exposes about types, and that doesn't include the names of constants in a package. There isn't really a notion of packages from <code>reflect</code>'s perspective at all.</p>\n\n<p>It sounds like you're willing to do it yourself (you've already made a <code>map</code>, etc). So I <em>think</em> what you <em>can</em> do is make <code>SectionType</code> or <code>*[]SectionType</code> an <a href=\"https://godoc.org/gopkg.in/yaml.v2#Unmarshaler\" rel=\"nofollow noreferrer\"><code>Unmarshaler</code></a>, by providing a function that turns the strings the YAML package decodes into values; I lack the specific experience with <code>go-yaml</code> to be able to tell you exactly how to implement it, but in general that's what interfaces like <code>Unmarshaler</code> do.</p>\n\n<p>If this is something you run into often enough, it might be worthwhile writing something along the lines of <a href=\"https://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"nofollow noreferrer\"><code>stringer</code></a> to generate the maps and deserialization functions for you (by inspecting the source files that define the types). There have to be a lot of types before that's worthwhile though.</p>\n"}], "owner": {"reputation": 28653, "user_id": 527288, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/9e175031c4adde62f40456f86a5e91b0?s=128&d=identicon&r=PG", "display_name": "Kurtis Nusbaum", "link": "https://stackoverflow.com/users/527288/kurtis-nusbaum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 40685851, "answer_count": 1, "score": 0, "last_activity_date": 1479502772, "creation_date": 1479501700, "last_edit_date": 1479502284, "question_id": 40685601, "link": "https://stackoverflow.com/questions/40685601/goyaml-convert-string-to-int-constant", "title": "goyaml convert string to int constant", "body": "<p>Suppose we have the following go code</p>\n\n<pre><code>type SectionType int\n\nconst (\n    Header SectionType = iota\n    Footer\n    Body\n)\n\nvar sectionTypeNames = map[string]SectionType{\n  \"header\": Header\n  \"footer\": Footer\n  \"body\":   Body\n}\n\ntype Page struct {\n    Sections: []SectionType `yaml:\"sections\"`\n}\n</code></pre>\n\n<p>And we have the following yaml</p>\n\n<pre><code>page1:\n  - header\n  - body\n</code></pre>\n\n<p>Is there a way to get goyaml to convert the strings of \"header\" and \"body\" into their respective int constant types (as defined in <code>sectionTypeNames</code> map) we deserializing the <code>Page</code> struct?</p>\n"}, {"tags": ["go", "sass"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479502264, "post_id": 40685427, "comment_id": 68602005, "body": "I use a node stack directly to manage all the transpile stuff, then in my go http server i have a regular http file server."}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479502407, "post_id": 40685427, "comment_id": 68602067, "body": "@mh-cbon After compiling your js/sass/css source, do you commit it to source in git for deployment?  If i understand correctly, that is how the process would work."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479502599, "post_id": 40685427, "comment_id": 68602169, "body": "It depends at lot of the overall workflow (from dev to deploy), for many teams its very usual to proceed like so yes, mostly for simplicity."}, {"owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1479505050, "post_id": 40685427, "comment_id": 68603252, "body": "@mh-cbon - thanks.  I wasn&#39;t aware of the nodejs option, and it gives me a resolution for the question posted.  Would you like to post it as an answer so I can accept?"}], "answers": [{"tags": [], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "is_accepted": false, "score": 1, "last_activity_date": 1487004061, "last_edit_date": 1487004061, "creation_date": 1479674533, "answer_id": 40709155, "question_id": 40685427, "link": "https://stackoverflow.com/questions/40685427/sass-rendering-in-go/40709155#40709155", "title": "SASS Rendering in Go", "body": "<p>I'm not familiar with Ruby on Rails but, I assume, that ruby on rails gave you some sort of tools for managing the source to distribution client-side asset transition (polyfills, transpiling, minification, compiling of SASS/SCSS to CSS, compiling of XScript to JavaScript ... etc).</p>\n\n<p>While a web development framework might do that to try and ease in developers quickly (I assume rails does that, not ruby) its not exactly the way Go does stuff.</p>\n\n<p>Go is a language, not a framework + language, just a compiler, a few build tools and a set of standards for how to write, test, document and indent stuff (with the indent,test and document part being optional).</p>\n\n<p>A go server, at least the way I built servers with go, is somewhat decoupled from the client. It server static assets when they are needed (e.g. it serves the minified JavaScript and the stylsheets and the html, and jsons with info from the databases... etc), but it doesn't really care about what those are, its a server. The go toolchain is made for building golang applications (e.g. said server), but its not made for building client-side web applications (those consisting of js, css and html).</p>\n\n<p>Now, you may use a framework similar to rails written in go that helps \"pack up\" css, js, html. But I'm unaware if there are any.</p>\n\n<p>You may use a compiler which turns go into client-side code (i.e. javascript) <a href=\"https://github.com/gopherjs/gopherjs\" rel=\"nofollow noreferrer\">https://github.com/gopherjs/gopherjs</a> , if you enjoy the go toolchian and want to use it for client-side development. But, go-like performance isn't something this gives you AND you are working with a subset of go. Its really just a different way to write javascript.</p>\n\n<p>However, what you most likely need in your case is a \"build-chain\" for your client side. Here there are 3 tools which (in my opinion) stand out in 2016:</p>\n\n<p>npm\nwebpack\nbower</p>\n\n<p>I could write an essay about using this tools but here's the summary:</p>\n\n<p>Webpack is used to create a \"pipeline\" for your code which does thing like, calling babel on javascript, compiling sass to css, minifying assets, allowing js to be written with import syntax... etc, really, its a swis army knife in your js development arsenal and probably matches the functionality of whatever you were using before.</p>\n\n<p>Npm is the node package manager BUT even if you are not using node for your server. It can be useful to keep tracks of dependencies for building your application (like webpack) and for downloading modules. Its also useful for running various scripts and deployment, its a bit of an overkill to use both npm and weback though you will probably have an easier time setting up the webpack enviornment if you have a package.json (config file for npm) with each of your project.</p>\n\n<p>Bower is one I actually don't use for small projects. But its basically a repository for javascript libraries (among other things), so you can easily say, write \"bower install jquery\" and you've downloaded jQuery for your current project.</p>\n\n<p>Again, there are many other tools out there, these are just some of the ones I like, but, check some of them out. They can help you replaces your previous pipeline. Don't think of client and server side code as being the same, they are decoupled and having a strong separation between them might help you a lot.</p>\n"}], "owner": {"reputation": 1791, "user_id": 363243, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/5527ddcd6dfc9e1df739c2aa0c8daa20?s=128&d=identicon&r=PG", "display_name": "dingalingchickenwiing", "link": "https://stackoverflow.com/users/363243/dingalingchickenwiing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1520338906, "creation_date": 1479500828, "question_id": 40685427, "link": "https://stackoverflow.com/questions/40685427/sass-rendering-in-go", "title": "SASS Rendering in Go", "body": "<p>I am beginning to use Go for web development, but I am having issues with asset management.  I would prefer to have a tool like Rails' Asset Pipeline for managing (and compressing) css/js files (as well as SASS), but I am still able to work with css and js files. </p>\n\n<p>While I am able to work with css and js, I am not able to work with SASS.  Is there a way to use SASS in a Golang project?  I am not using a framework.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["go", "multipartform-data", "httpserver"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 5, "creation_date": 1479497290, "post_id": 40684307, "comment_id": 68599742, "body": "maybe you are looking for <a href=\"https://golang.org/pkg/net/http/#Request.FormFile\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.FormFile</a> ?"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1479497659, "post_id": 40684307, "comment_id": 68599905, "body": "Also this is what I have used to parse multiple files: <a href=\"https://golang.org/pkg/mime/multipart/#Form\" rel=\"nofollow noreferrer\">golang.org/pkg/mime/multipart/#Form</a>"}, {"owner": {"reputation": 371, "user_id": 7179784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a89a794418d36064ef7560ec17ab2e?s=128&d=identicon&r=PG&f=1", "display_name": "user7179784", "link": "https://stackoverflow.com/users/7179784/user7179784"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1479498189, "post_id": 40684307, "comment_id": 68600172, "body": "@mh-cbon that&#39;s it! I get a <code>[]byte</code>, which prints properly, which means I&#39;ve got something to work with. Thanks!"}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479514290, "post_id": 40684307, "comment_id": 68606075, "body": "I have an example here <a href=\"https://github.com/yanpozka/go-httprouter-upfiles-token/blob/master/handlers.go#L49\" rel=\"nofollow noreferrer\">github.com/yanpozka/go-httprouter-upfiles-token/blob/master/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 2229, "user_id": 484529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rp6uy.png?s=128&g=1", "display_name": "ijt", "link": "https://stackoverflow.com/users/484529/ijt"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 2, "creation_date": 1488694403, "post_id": 40684307, "comment_id": 72340310, "body": "@mh-cbon please add your answer as an answer so it can be marked as accepted and this question can be filtered out when people are looking for questions to answer."}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1516177952, "post_id": 40684307, "comment_id": 83577814, "body": "can this be done with a file and a struct in the same request?"}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 7, "creation_date": 1489340512, "post_id": 40699578, "comment_id": 72617985, "body": "Note that to avoid memory consumption you might write ondisk directly at <code>io.Copy(&amp;Buf, file)</code> where Buf is to replace with a File handler."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1489340660, "post_id": 40699578, "comment_id": 72618037, "body": "True that, large file no es bueno."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1576700631, "post_id": 40699578, "comment_id": 104988103, "body": "i also put +1 on below answer from keith wachira for pointing it out."}, {"owner": {"reputation": 1168, "user_id": 786389, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11a3c4e1a6577f9a0a0b1c169588472f?s=128&d=identicon&r=PG", "display_name": "y3sh", "link": "https://stackoverflow.com/users/786389/y3sh"}, "edited": false, "score": 0, "creation_date": 1604960518, "post_id": 40699578, "comment_id": 114502190, "body": "I checked the error that&#39;s return on <code>defer file.Close()</code> and it seems the file is unable to be closed -- is that actually needed here?"}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 39, "last_activity_date": 1576662770, "last_edit_date": 1576662770, "creation_date": 1479603628, "answer_id": 40699578, "question_id": 40684307, "link": "https://stackoverflow.com/questions/40684307/how-can-i-receive-an-uploaded-file-using-a-golang-net-http-server/40699578#40699578", "title": "How can I receive an uploaded file using a Golang net/http server?", "body": "<p>Here's a quick example</p>\n\n<pre><code>func ReceiveFile(w http.ResponseWriter, r *http.Request) {\n    r.ParseMultipartForm(32 &lt;&lt; 20) // limit your max input length!\n    var buf bytes.Buffer\n    // in your case file would be fileupload\n    file, header, err := r.FormFile(\"file\")\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n    name := strings.Split(header.Filename, \".\")\n    fmt.Printf(\"File name %s\\n\", name[0])\n    // Copy the file data to my buffer\n    io.Copy(&amp;buf, file)\n    // do something with the contents...\n    // I normally have a struct defined and unmarshal into a struct, but this will\n    // work as an example\n    contents := buf.String()\n    fmt.Println(contents)\n    // I reset the buffer in case I want to use it again\n    // reduces memory allocations in more intense projects\n    buf.Reset()\n    // do something else\n    // etc write header\n    return\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 1, "creation_date": 1516103178, "post_id": 42970984, "comment_id": 83544467, "body": "what if revieving a serialized abject and a file in the same request?"}, {"owner": {"reputation": 587, "user_id": 1099855, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc25b64b1efc299ef8bec33c64eaa58f?s=128&d=identicon&r=PG", "display_name": "Ayyappa A", "link": "https://stackoverflow.com/users/1099855/ayyappa-a"}, "edited": false, "score": 0, "creation_date": 1524736751, "post_id": 42970984, "comment_id": 87096168, "body": "@pltvs if i pass the content-length explicitly through file upload in postman. handler is throwing an error.  with the above code. looking for suggestions."}, {"owner": {"reputation": 127, "user_id": 829117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3934c9e215585832abd9b13529d66a73?s=128&d=identicon&r=PG", "display_name": "aviau", "link": "https://stackoverflow.com/users/829117/aviau"}, "edited": false, "score": 0, "creation_date": 1527526026, "post_id": 42970984, "comment_id": 88150903, "body": "do you mean header instead of handler?"}, {"owner": {"reputation": 2883, "user_id": 151652, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abc432bb0450574a25b15ff23d399d5a?s=128&d=identicon&r=PG", "display_name": "Farcaller", "link": "https://stackoverflow.com/users/151652/farcaller"}, "edited": false, "score": 2, "creation_date": 1550528782, "post_id": 42970984, "comment_id": 96294035, "body": "<code>&quot;.&#47;test&#47;&quot;+handler.Filename</code> \u2013 in general it&#39;s a very bad idea to write to files with paths controllable by external input. Don&#39;t do this."}, {"owner": {"reputation": 15416, "user_id": 2441637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z8fpp.jpg?s=128&g=1", "display_name": "Hasan A Yousef", "link": "https://stackoverflow.com/users/2441637/hasan-a-yousef"}, "edited": false, "score": 0, "creation_date": 1596824935, "post_id": 42970984, "comment_id": 111945403, "body": "How about uploading multiple files at single upload?"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 14, "last_activity_date": 1598009714, "last_edit_date": 1598009714, "creation_date": 1490258547, "answer_id": 42970984, "question_id": 40684307, "link": "https://stackoverflow.com/questions/40684307/how-can-i-receive-an-uploaded-file-using-a-golang-net-http-server/42970984#42970984", "title": "How can I receive an uploaded file using a Golang net/http server?", "body": "<p>You should use <code>FormFile</code> instead of <code>FormValue</code>:</p>\n<pre><code>file, fileHeader, err := r.FormFile(&quot;fileupload&quot;)\ndefer file.Close()\n\n// copy example\nf, err := os.OpenFile(&quot;./downloaded&quot;, os.O_WRONLY|os.O_CREATE, 0666)\ndefer f.Close()\nio.Copy(f, file)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 122628, "user_id": 445131, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/2b4pE.jpg?s=128&g=1", "display_name": "Eric Leschinski", "link": "https://stackoverflow.com/users/445131/eric-leschinski"}, "edited": false, "score": 0, "creation_date": 1531638829, "post_id": 51345650, "comment_id": 89665225, "body": "The indentation for your attached code is inconsistent, please fix it."}, {"owner": {"reputation": 15416, "user_id": 2441637, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z8fpp.jpg?s=128&g=1", "display_name": "Hasan A Yousef", "link": "https://stackoverflow.com/users/2441637/hasan-a-yousef"}, "edited": false, "score": 0, "creation_date": 1596824931, "post_id": 51345650, "comment_id": 111945400, "body": "How about uploading multiple files at single upload?"}], "tags": [], "owner": {"reputation": 81, "user_id": 10083126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbdddafebc0218b5e6ae9e63d364eb4e?s=128&d=identicon&r=PG&f=1", "display_name": "keith wachira", "link": "https://stackoverflow.com/users/10083126/keith-wachira"}, "is_accepted": false, "score": 7, "last_activity_date": 1576651956, "last_edit_date": 1576651956, "creation_date": 1531634048, "answer_id": 51345650, "question_id": 40684307, "link": "https://stackoverflow.com/questions/40684307/how-can-i-receive-an-uploaded-file-using-a-golang-net-http-server/51345650#51345650", "title": "How can I receive an uploaded file using a Golang net/http server?", "body": "<p>Here a function i wrote to help me in uploading my files.You can check the full version here . <a href=\"https://kenyaappexperts.com/blog/how-to-upload-files-in-go-step-by-step/\" rel=\"nofollow noreferrer\" title=\"How to upload files in Golang\">How to upload files in golang </a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package helpers\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"os\"\n)\n\n// This function returns the filename(to save in database) of the saved file\n// or an error if it occurs\nfunc FileUpload(r *http.Request) (string, error) {\n    // ParseMultipartForm parses a request body as multipart/form-data\n    r.ParseMultipartForm(32 &lt;&lt; 20)\n\n    file, handler, err := r.FormFile(\"file\") // Retrieve the file from form data\n\n    if err != nil {\n        return \"\", err\n    }\n    defer file.Close()                       // Close the file when we finish\n\n    // This is path which we want to store the file\n    f, err := os.OpenFile(\"/pathToStoreFile/\"+handler.Filename, os.O_WRONLY|os.O_CREATE, 0666)\n\n    if err != nil {\n        return \"\", err\n    }\n\n    // Copy the file to the destination path\n    io.Copy(f, file)\n\n    return handler.Filename, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 371, "user_id": 7179784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a89a794418d36064ef7560ec17ab2e?s=128&d=identicon&r=PG&f=1", "display_name": "user7179784", "link": "https://stackoverflow.com/users/7179784/user7179784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49646, "favorite_count": 10, "answer_count": 3, "score": 37, "last_activity_date": 1598009714, "creation_date": 1479495848, "question_id": 40684307, "link": "https://stackoverflow.com/questions/40684307/how-can-i-receive-an-uploaded-file-using-a-golang-net-http-server", "title": "How can I receive an uploaded file using a Golang net/http server?", "body": "<p>I'm playing around with <a href=\"https://github.com/gorilla/mux\" rel=\"noreferrer\">Mux</a> and <code>net/http</code>. Lately, I'm trying to get a simple server with one endpoint to accept a file upload.</p>\n\n<p>Here's the code I've got so far:</p>\n\n<p><strong>server.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    router := mux.NewRouter()\n    router.\n        Path(\"/upload\").\n        Methods(\"POST\").\n        HandlerFunc(UploadCsv)\n    fmt.Println(\"Starting\")\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n\n<p><strong>endpoint.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc UploadFile(w http.ResponseWriter, r *http.Request) {\n    err := r.ParseMultipartForm(5 * 1024 * 1024)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(r.FormValue(\"fileupload\"))\n}\n</code></pre>\n\n<p>I think I've narrowed the issue down to actually retrieving the body from the request inside <code>UploadFile</code>. When I run this cURL command:</p>\n\n<pre><code>curl http://localhost:8080/upload -F \"fileupload=@test.txt\" -vvv\n</code></pre>\n\n<p>I get an empty response (as expected; I'm not printing to the <code>ResponseWriter</code>), but I just get a new (empty) line printed at the prompt where I'm running the server, instead of the request body.</p>\n\n<p>I'm sending the file as multipart (AFAIK, implied by using <code>-F</code> rather than <code>-d</code> in cURL), and cURL's verbose output is showing 502 bytes sent:</p>\n\n<pre><code>$ curl http://localhost:8080/upload -F \"fileupload=@test.txt\" -vvv\n*   Trying ::1...\n* TCP_NODELAY set\n* Connected to localhost (::1) port 8080 (#0)\n&gt; POST /upload HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.51.0\n&gt; Accept: */*\n&gt; Content-Length: 520\n&gt; Expect: 100-continue\n&gt; Content-Type: multipart/form-data; boundary=------------------------b578878d86779dc5\n&gt; \n&lt; HTTP/1.1 100 Continue\n&lt; HTTP/1.1 200 OK\n&lt; Date: Fri, 18 Nov 2016 19:01:50 GMT\n&lt; Content-Length: 0\n&lt; Content-Type: text/plain; charset=utf-8\n&lt; \n* Curl_http_done: called premature == 0\n* Connection #0 to host localhost left intact\n</code></pre>\n\n<p>What's the proper way to receive files uploaded as multipart form data using a <code>net/http</code> server in Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 192, "user_id": 5892082, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XWNJkpBvNTA/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckIPAAFPQ1hxvXFoIEbXHY5xpMFow/photo.jpg?sz=128", "display_name": "xen-dara", "link": "https://stackoverflow.com/users/5892082/xen-dara"}, "edited": false, "score": 0, "creation_date": 1479495460, "post_id": 40684160, "comment_id": 68598855, "body": "have you tried screen <a href=\"http://www.tecmint.com/screen-command-examples-to-manage-linux-terminals/\" rel=\"nofollow noreferrer\">tecmint.com/screen-command-examples-to-manage-linux-terminal&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479495759, "post_id": 40684160, "comment_id": 68599008, "body": "The only way to execute multiple commands in a single session is to execute them together in a shell script, or interactively by parsing the shell output and writing to the input. This is the same as if you were using ssh on the command line."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479496612, "post_id": 40684160, "comment_id": 68599403, "body": "@Tyler: interactively using the remote shell isn&#39;t really advised, it&#39;s more of a last resort option, and one usually uses something like &quot;expect&quot; for that. As for sending a series of commands in a script, what example do you need? You have it implemented here already, just send the text to be interpreted by the remote shell (remember, ssh is just a remote &quot;secure shell&quot;, not a general RPC system)"}], "answers": [{"tags": [], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "is_accepted": true, "score": 3, "last_activity_date": 1479502091, "creation_date": 1479502091, "answer_id": 40685700, "question_id": 40684160, "link": "https://stackoverflow.com/questions/40684160/running-multiple-commands-in-one-ssh-session/40685700#40685700", "title": "Running multiple commands in one SSH session", "body": "<p>Thanks to @JimB I am now doing this instead:</p>\n\n<pre><code>// Create a single command that is semicolon seperated\ncommands := []string{\n    \"docker login\",\n    \"docker ps\",\n}\ncommand := strings.Join(commands, \"; \")\n</code></pre>\n\n<p>And then running it the same as before:</p>\n\n<pre><code>if err := session.Run(command); err != nil {\n    panic(\"Failed to run command: \" + command + \"\\nBecause: \" + err.Error())\n}\nfmt.Println(output.String())\n</code></pre>\n"}], "owner": {"reputation": 15349, "user_id": 2282538, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/0a4fff09f1f0e3360daeabb30c2c06bb?s=128&d=identicon&r=PG", "display_name": "Tyler", "link": "https://stackoverflow.com/users/2282538/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1531, "favorite_count": 1, "accepted_answer_id": 40685700, "answer_count": 1, "score": 3, "last_activity_date": 1479502091, "creation_date": 1479495154, "question_id": 40684160, "link": "https://stackoverflow.com/questions/40684160/running-multiple-commands-in-one-ssh-session", "title": "Running multiple commands in one SSH session", "body": "<p>I need to run multiple commands in a single ssh session:</p>\n\n<pre><code>// Define the client configuration\nconfig := &amp;ssh.ClientConfig{\n    User: USERNAME,\n    Auth: []ssh.AuthMethod{\n        ssh.PublicKeys(pem),\n    },\n}\n\n// Connect to the machine\n client, err := ssh.Dial(\"tcp\", HOSTNAME + \":\" + PORT, config)\n if err != nil {\n    panic(\"Failed to dial: \" + err.Error())\n}\n\n// Create a session\nsession, err := client.NewSession()\nif err != nil {\n    panic(\"Failed to create session: \" + err.Error())\n}\ndefer session.Close()\n\n// Start running commands!\nvar output bytes.Buffer\nsession.Stdout = &amp;output\n\n// 1)  Login to swarm registry\nfmt.Println(\"Logging into swarm registry...\")\nif err := session.Run(\"docker login ...\"); err != nil {\n    panic(\"Failed to login to swarm registry: \" + err.Error())\n}\nfmt.Println(output.String())\n\n// 2)  List all of the docker processes\nfmt.Println(\"List swarm processes...\")\nif err := session.Run(\"docker ps\"); err != nil {    // &lt;-------- FAILS HERE\n    panic(\"Failed to list swarm processes: \" + err.Error())\n}\nfmt.Println(output.String())\n</code></pre>\n\n<p>I read through the source file (<code>session.go</code>) and for the <code>Session.Run</code> command and it says:</p>\n\n<blockquote>\n  <p>A Session only accepts one call to Run, Start, Shell, Output, or CombinedOutput.</p>\n</blockquote>\n\n<p>For my use case I need to issue the first command to log the session in, and then issue subsequent commands once I am logged in.</p>\n\n<p>Is there an alternate way to run multiple commands using the same ssh session?</p>\n"}, {"tags": ["go", "tiedot"], "answers": [{"tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": false, "score": 3, "last_activity_date": 1479493570, "creation_date": 1479493570, "answer_id": 40683759, "question_id": 40683635, "link": "https://stackoverflow.com/questions/40683635/error-need-type-assertion/40683759#40683759", "title": "ERROR: need type assertion", "body": "<p>It looks like your converting to a concrete type and throwing away the conversion, I think this should work:</p>\n\n<pre><code>    if somePinString, ok := readBack[\"SomePIN\"].(string); ok {\n        return c.String(http.StatusOK, somePinString)\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24240, "user_id": 495935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d310e51ac60b2a54b68b96e90593277b?s=128&d=identicon&r=PG", "display_name": "Surreal Dreams", "link": "https://stackoverflow.com/users/495935/surreal-dreams"}, "is_accepted": true, "score": 6, "last_activity_date": 1479493609, "creation_date": 1479493609, "answer_id": 40683773, "question_id": 40683635, "link": "https://stackoverflow.com/questions/40683635/error-need-type-assertion/40683773#40683773", "title": "ERROR: need type assertion", "body": "<p>You are asserting <code>readBack[\"SomePIN\"]</code> as a string - <em>in the <code>if</code> statement</em>.  That doesn't make any change to <code>readBack[\"SomePIN\"]</code>, however - it's still an interface{}.  In Go, nothing ever changes type.  Here's what will work:</p>\n\n<pre><code>for id := range queryResult {\n    readBack, err := aCollection.Read(id)\n    if err != nil {\n        panic(err)\n    }\n    if readBack[\"OtherID\"] == otherID {\n        if somePIN, ok := readBack[\"SomePIN\"].(string); ok {\n            return c.String(http.StatusOK, somePIN)\n        }\n    }\n}\n</code></pre>\n\n<p>You were tossing the string value from your type assertion, but you want it.  So keep it, as <code>somePIN</code>, and then use it.</p>\n\n<p>Final note - using the <code>value, ok = interfaceVal.(type)</code> syntax is a good practice.  If <code>interfaceVal</code> turns out to be a non-string, you'll get <code>value = \"\"</code> and <code>ok = false</code>.  If you eliminate the ok value from the type assertion and interfaceVal is a non-string, the program will panic.</p>\n"}], "owner": {"reputation": 137, "user_id": 5582322, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/--PGm-3UrfZY/AAAAAAAAAAI/AAAAAAAAAC8/pF7VTJ2slws/photo.jpg?sz=128", "display_name": "Ohenepee Peps", "link": "https://stackoverflow.com/users/5582322/ohenepee-peps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3322, "favorite_count": 0, "accepted_answer_id": 40683773, "answer_count": 2, "score": 2, "last_activity_date": 1521028335, "creation_date": 1479493112, "last_edit_date": 1521028335, "question_id": 40683635, "link": "https://stackoverflow.com/questions/40683635/error-need-type-assertion", "title": "ERROR: need type assertion", "body": "<p>I thought I have asserted (as far as I've learnt Go), but I keep getting this error\n<code>cannot use readBack[\"SomePIN\"] (type interface {}) as type string in argument to c.String: need type assertion</code></p>\n\n<p>Here is my code (this snippet is from a Request Handler function and I'm using Echo Web framework and Tiedot NoSQL database)</p>\n\n<pre><code>// To get query result document, simply \n// read it [as stated in the Tiedot readme.md]\nfor id := range queryResult {\n    readBack, err := aCollection.Read(id)\n    if err != nil {\n        panic(err)\n    }\n    if readBack[\"OtherID\"] == otherID {\n        if _, ok := readBack[\"SomePIN\"].(string); ok {\n            return c.String(http.StatusOK, readBack[\"SomePIN\"])\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "pipe", "exec"], "answers": [{"tags": [], "owner": {"reputation": 885, "user_id": 990212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4e9e0cbad55fb36be31c38b79562f0?s=128&d=identicon&r=PG", "display_name": "Yadvendar", "link": "https://stackoverflow.com/users/990212/yadvendar"}, "is_accepted": false, "score": 0, "last_activity_date": 1479541963, "creation_date": 1479541963, "answer_id": 40690509, "question_id": 40683557, "link": "https://stackoverflow.com/questions/40683557/how-can-i-get-the-error-message-from-a-chain-of-exec-commands-which-emit-errors/40690509#40690509", "title": "How can i get the error message from a chain of exec commands which emit errors to stdout", "body": "<p>Try this:</p>\n\n<pre><code>var firstStdErr, firstStdOut bytes.Buffer\nfirstCommand := exec.Command(\n    \"sort\",\n    sortFlag,\n)\n\nfirstCommand.Stdout = &amp;firstStdOut\nfirstCommand.Stderr = &amp;firstStdErr\nif err := firstCommand.Run(); err !=nil {\n    fmt.Println(\"error: %s %s %s\", err, firstStdErr, firstStdOut)\n} else{\n    waitStatus := firstCommand.ProcessState.Sys().(syscall.WaitStatus)\n    if waitStatus.ExitStatus() != 0 {\n        fmt.Println(\"Non-zero exit code: \" + strconv.Itoa(waitStatus.ExitStatus()))\n    }\n}\nvar secondStdErr, secondStdOut bytes.Buffer\nsecondCommand := exec.Command(\n    \"command 2\",\n)\nsecondCommand.Stdin = &amp;firstStdOut\nsecondCommand.Stdout = &amp;secondStdOut\nsecondCommand.Stderr = &amp;secondStdErr\nif err := secondCommand.Run(); err !=nil {\n    fmt.Println(\"error: %s %s %s\", err, secondStdErr, secondStdOut)\n}\nfileOut, err := os.Create(filePath)\nif err != nil {\n    fmt.Errorf(\"file create error: %s : %s\", filePath, err)\n}\ndefer fileOut.Close()\n\n// sample writing to a file\nfileOut.Write(firstStdErr.Bytes())\nfileOut.Write(firstStdOut.Bytes())\nfileOut.Write(secondStdOut.Bytes())\n</code></pre>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479541963, "creation_date": 1479492813, "question_id": 40683557, "link": "https://stackoverflow.com/questions/40683557/how-can-i-get-the-error-message-from-a-chain-of-exec-commands-which-emit-errors", "title": "How can i get the error message from a chain of exec commands which emit errors to stdout", "body": "<p>In my searches I've found many examples of how to retrieve the stdOut error for a single exec command but I'm struggling with a whole chain of the things.</p>\n\n<p>In my actual code I have 5 exec processes and a file write of the result all joined by io pipes. This is a simplified version of what I have going on, in real world the stdOut from the pipe is used as the stdIn of the next process until we copy across for the final file write :</p>\n\n<pre><code>    fileOut, err := os.Create(filePath)\n    if err != nil {\n        return fmt.Errorf(\"file create error: %s : %s\", filePath, err)\n    }\n\n    writer := bufio.NewWriter(fileOut)\n    defer writer .Flush()\n\n    var exSortStdErr bytes.Buffer\n\n    sort := exec.Command(\"sort\", sortFlag)\n    sort.Stderr = &amp;sortStdErr\n    sortStdOut, err := sort.StdoutPipe()\n\n    if err != nil {\n        return fmt.Errorf(\"sort pipe error: %s : %s\", err, sortStdErr.String())\n    }\n\n    if err := sort.Start(); err != nil {\n        return fmt.Errorf(\"sort start error : %s : %s\", err, sortStdErr.String())\n    }\n\n    io.Copy(writer, sortStdOut)\n\n    if err = sort.Wait(); err != nil {\n        //catching error here\n        return fmt.Errorf(\"sort wait error : %s: %s\", err, sortStdErr.String())\n    }\n</code></pre>\n\n<p>I have simplified the above to illustrate the point (so the actual process throwing the error isn't there), but I know that Im getting an error related to one of the exec processes connected by io pipes in a chain like above but the process in question puts its error to stdOut, recreating from the terminal I see </p>\n\n<blockquote>\n  <p>comm: file 1 is not in sorted order</p>\n</blockquote>\n\n<p>from a comm process which sits in there somewhere but what i see from the final error catch is simply:</p>\n\n<blockquote>\n  <p>exit status 1</p>\n</blockquote>\n\n<p>the examples I saw suggested reading from stdOut something like this:</p>\n\n<pre><code>var sortStdErr, sortStdOut bytes.Buffer\nsort:= exec.Command(\"sort\", sortFlag)\nsort.Stdout = &amp;sortStdOut\nsort.Stderr = &amp;sortStdErr\n\nif err := sort.Run(); err !=nil {\n    fmt.Println(\"error: %s %s\", err, sortStdOut)\n} \n</code></pre>\n\n<p>And this does indeed work, but I don't know how to marry this up with piping the results to the next process. Is there a way to read the error off the pipe from within the cmd.wait error handling or is there a better approach?</p>\n\n<p>On go 1.7, though i doubt that matters.</p>\n\n<p>If someone could point me in the right direction, ideally with an example, that would be much appreciated.</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 0, "last_activity_date": 1479492277, "creation_date": 1479492277, "answer_id": 40683421, "question_id": 40683362, "link": "https://stackoverflow.com/questions/40683362/json-nesting-a-populated-struct-into-a-new-struct/40683421#40683421", "title": "JSON: Nesting a populated struct into a new struct", "body": "<p>I think you could statically declare another struct to use:</p>\n\n<pre><code>type WrappedOutput struct {\n  fields my_struct\n  meta string\n}\n</code></pre>\n\n<p>Then you could embed your struct before marshalling</p>\n\n<p><code>o := WrappedOutput{fields: output}</code></p>\n\n<p>Brand new to go so not sure if this is the easiest way to do it</p>\n"}, {"comments": [{"owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1479549388, "post_id": 40683719, "comment_id": 68612547, "body": "The problem I have here is that I don&#39;t <i>always</i> need big_struct, it&#39;s a conditional thing. Is there a way to do it <i>without</i> doing it this way?"}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "reply_to_user": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "edited": false, "score": 0, "creation_date": 1479571761, "post_id": 40683719, "comment_id": 68619340, "body": "@Frap You can&#39;t initialize <code>My_struct</code> specifically with a new field that you didn&#39;t declare. Go doesn&#39;t have the same type of Object Oriented inheritance like you see in Python. You can, however, declare a conditional anonymous struct and nest <code>My_struct</code> inside it on the fly. I&#39;ve edited my answer with a second example."}], "tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 0, "last_activity_date": 1479571573, "last_edit_date": 1479571573, "creation_date": 1479493435, "answer_id": 40683719, "question_id": 40683362, "link": "https://stackoverflow.com/questions/40683362/json-nesting-a-populated-struct-into-a-new-struct/40683719#40683719", "title": "JSON: Nesting a populated struct into a new struct", "body": "<p>The clean way to do this would be to declare 2 structs (I've done it globally below) and nest <code>My_struct</code> inside the higher level struct.</p>\n\n<p>Then you can initialize the higher level struct before Mashalling it:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype My_struct struct {\n    First  string `json:\"first\"`\n    Second string `json:\"second\"`\n    Number int    `json:\"number\"`\n}\n\ntype Big_struct struct {\n    Fields My_struct\n    Meta   string\n}\n\nfunc main() {\n\n    output := Big_struct{\n        Fields: My_struct{\n            First:  \"my_string\",\n            Second: \"another_string\",\n            Number: 2,\n        },\n        Meta: \"data\",\n    }\n\n    output_json, err := json.Marshal(output)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(string(output_json))\n\n}\n</code></pre>\n\n<p>if you don't want <code>Big_struct</code> you can declare an anonymous struct within your code as you need it and nest <code>My_struct</code> inside:</p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/json\"\n        \"fmt\"\n)\n\ntype My_struct struct {\n        First  string `json:\"first\"`\n        Second string `json: \"second\"`\n        Number int    `json:\"number\"`\n}\n\nfunc main() {\n\n        output := struct {\n                Fields My_struct\n                Meta   string\n        }{  \n                Fields: My_struct{\n                        First:  \"my_string\",\n                        Second: \"another_string\",\n                        Number: 2,\n                },  \n                Meta: \"data\",\n        }   \n\n        output_json, err := json.Marshal(output)\n        if err != nil {\n                fmt.Println(err)\n        }   \n\n        fmt.Println(string(output_json))\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": false, "score": 0, "last_activity_date": 1479707653, "creation_date": 1479707653, "answer_id": 40713616, "question_id": 40683362, "link": "https://stackoverflow.com/questions/40683362/json-nesting-a-populated-struct-into-a-new-struct/40713616#40713616", "title": "JSON: Nesting a populated struct into a new struct", "body": "<p>If you don't want to use a new structure, you can do:</p>\n\n<pre><code>data := my_struct{First: \"first\", Second: \"2\", Number: 123}\nresult, _ := json.Marshal(&amp;map[string]interface{}{\"fields\":data,\"meta\":\"data\"})\nfmt.Println(string(result))\n</code></pre>\n\n<p>it's not clean, but it does the work.</p>\n"}], "owner": {"reputation": 9348, "user_id": 645002, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/b89ca9c20cfefbd831a5d5756b3bc3ed?s=128&d=identicon&r=PG", "display_name": "jaxxstorm", "link": "https://stackoverflow.com/users/645002/jaxxstorm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1479707653, "creation_date": 1479492088, "question_id": 40683362, "link": "https://stackoverflow.com/questions/40683362/json-nesting-a-populated-struct-into-a-new-struct", "title": "JSON: Nesting a populated struct into a new struct", "body": "<p>I have a struct like so:</p>\n\n<pre><code>type my_struct struct {\n  First  string `json:\"first\"`\n  Second string `json:\"second\"`\n  Number int    `json:\"number\"`\n}\n</code></pre>\n\n<p>When I marshal that into JSON, it outputs very simple JSON as you'd expect:</p>\n\n<pre><code>var output_json []byte\noutput_json, _ = json.Marshal(output)\nfmt.Println(string(output_json))\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>{\"first\":\"my_string\",\"second\":\"another_string\",\"number\":2}\n</code></pre>\n\n<p>All fine so far!</p>\n\n<p>What I'd like to do, before marshalling that struct into JSON, is nest it inside another struct. The resulting output would be JSON that looks like this:</p>\n\n<pre><code>{\n  \"fields\": {\n    \"first\": \"my_string\",\n    \"number\": 2,\n    \"second\": \"another_string\"\n  },\n  \"meta\": \"data\"\n}\n</code></pre>\n\n<p>How can I do that?</p>\n"}, {"tags": ["networking", "go", "system-calls"], "comments": [{"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1479492050, "post_id": 40682760, "comment_id": 68596992, "body": "does <code>net.Interfaces()</code> contain the gateway? <a href=\"https://golang.org/pkg/net/#Interfaces\" rel=\"nofollow noreferrer\">golang.org/pkg/net/#Interfaces</a>"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1479492121, "post_id": 40682760, "comment_id": 68597033, "body": "@dm03514 I do not believe it does."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1479492524, "post_id": 40682760, "comment_id": 68597255, "body": "Out of curiosity, why do you need this?"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1479543456, "post_id": 40682760, "comment_id": 68611168, "body": "@captncraig to know / print default gateways routes when using a VPN"}], "answers": [{"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1479543388, "post_id": 40683474, "comment_id": 68611156, "body": "This seems to be on linux but what about unixes (freebsd, mac os, etc) I would like something os agnostic."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 2, "last_activity_date": 1479492513, "creation_date": 1479492513, "answer_id": 40683474, "question_id": 40682760, "link": "https://stackoverflow.com/questions/40682760/what-syscall-method-could-i-use-to-get-the-default-network-gateway/40683474#40683474", "title": "what syscall/method could I use to get the default network gateway", "body": "<p>One option would be to read <code>/proc/net/route</code>. On one of my systems this contains:</p>\n\n<pre><code>Iface   Destination Gateway     Flags   RefCnt  Use Metric  Mask        MTU Window  IRTT                                                       \nteam0   00000000    010017BA    0003    0   0   0   00000000    0   0   0                                                                              \nteam0   0000070A    00000000    0001    0   0   0   00FEFFFF    0   0   0                                                                              \n</code></pre>\n\n<p>You could read that in, capture the gateway with some text processing, and convert the hex string to a net.IP. Kinda a runaround, but I could not find any package that can access this for you in the std lib or elsewhere.</p>\n"}, {"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1479640671, "post_id": 40695315, "comment_id": 68634841, "body": "This is the kind of things I would like to avoid, I would like to know some syscalls in order to make this more os agnostic"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1479743859, "post_id": 40695315, "comment_id": 68675610, "body": "@nbari: syscalls won&#39;t make it any more OS agnostic, syscalls are even more system dependent. Each OS has its own tools for this which you need to use. You can probably find some subset of the <code>netstat</code> command which will print routing tables on most OSes, otherwise just call out to the appropriate command for each OS."}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479746270, "post_id": 40695315, "comment_id": 68677237, "body": "@JimB my goal of using the syscalls despite the fact I would have to maintain them and also cross-compile is to avoid depending on external commands, in that way I could produce an binary that could behave the same on almost all systems."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1479777543, "post_id": 40695315, "comment_id": 68691430, "body": "If you are going to customize the syscalls per-platform, you are going to have a file per platform with build tags anyways. If that uses a syscall or execs something, they are equally un-portable. Just exec the tool that is availible on your os."}, {"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "edited": false, "score": 0, "creation_date": 1533295936, "post_id": 40695315, "comment_id": 90305804, "body": "imports would be nice ;)"}], "tags": [], "owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "is_accepted": false, "score": 3, "last_activity_date": 1479573475, "creation_date": 1479573475, "answer_id": 40695315, "question_id": 40682760, "link": "https://stackoverflow.com/questions/40682760/what-syscall-method-could-i-use-to-get-the-default-network-gateway/40695315#40695315", "title": "what syscall/method could I use to get the default network gateway", "body": "<p>For Linux, you can use the procfs as suggested by captncraig. Here is a snippet that extracts the gateway address and convert it to quad dotted ipV4.</p>\n\n<pre><code>/* /proc/net/route file:\nIface   Destination Gateway     Flags   RefCnt  Use Metric  Mask\neno1    00000000    C900A8C0    0003    0   0   100 00000000    0   00                                                                             \neno1    0000A8C0    00000000    0001    0   0   100 00FFFFFF    0   00 \n*/\n\nconst (\n    file  = \"/proc/net/route\"\n    line  = 1    // line containing the gateway addr. (first line: 0)\n    sep   = \"\\t\" // field separator\n    field = 2    // field containing hex gateway address (first field: 0)\n)\n\nfunc main() {\n\n    file, err := os.Open(file)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n    for scanner.Scan() {\n\n        // jump to line containing the agteway address\n        for i := 0; i &lt; line; i++ {\n            scanner.Scan()\n        }\n\n        // get field containing gateway address\n        tokens := strings.Split(scanner.Text(), sep)\n        gatewayHex := \"0x\" + tokens[field]\n\n        // cast hex address to uint32\n        d, _ := strconv.ParseInt(gatewayHex, 0, 64)\n        d32 := uint32(d)\n\n        // make net.IP address from uint32\n        ipd32 := make(net.IP, 4)\n        binary.LittleEndian.PutUint32(ipd32, d32)\n        fmt.Printf(\"%T --&gt; %[1]v\\n\", ipd32)\n\n        // format net.IP to dotted ipV4 string\n        ip := net.IP(ipd32).String()\n        fmt.Printf(\"%T --&gt; %[1]v\\n\", ip)\n\n        // exit scanner\n        break\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 945, "user_id": 382458, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6a1abc11b3d1e432758d39dfd7c69a20?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/382458/mark"}, "edited": false, "score": 1, "creation_date": 1499469078, "post_id": 42047531, "comment_id": 76937081, "body": "Not sure why this got accepted, as the question asks about the gateway IP. If you look at the interface.go link, the code does nothing with gateways; it merely checks the addresses on the local interfaces and returns one it is happy with."}, {"owner": {"reputation": 366, "user_id": 8215209, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mUcp9x419TE/AAAAAAAAAAI/AAAAAAAAAAA/x_oltuemiFo/photo.jpg?sz=128", "display_name": "achilles", "link": "https://stackoverflow.com/users/8215209/achilles"}, "edited": false, "score": 0, "creation_date": 1572851344, "post_id": 42047531, "comment_id": 103675314, "body": "I was not able to retrieve the gateway IP of an interface using the nettest package. Can you be more specific ?"}], "tags": [], "owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "is_accepted": true, "score": -3, "last_activity_date": 1486257178, "creation_date": 1486257178, "answer_id": 42047531, "question_id": 40682760, "link": "https://stackoverflow.com/questions/40682760/what-syscall-method-could-i-use-to-get-the-default-network-gateway/42047531#42047531", "title": "what syscall/method could I use to get the default network gateway", "body": "<p>Play with the RoutedInterface() code at <a href=\"https://github.com/golang/net/blob/master/internal/nettest/interface.go\" rel=\"nofollow noreferrer\">https://github.com/golang/net/blob/master/internal/nettest/interface.go</a></p>\n\n<p>Sample code snip:</p>\n\n<pre><code>rifs := nettest.RoutedInterface(\"ip\", net.FlagUp | net.FlagBroadcast)\nif rifs != nil {\n    fmt.Println(\"Routed interface is \",rifs.HardwareAddr.String())\n    fmt.Println(\"Flags are\", rifs.Flags.String())\n}\n</code></pre>\n\n<p>Note:  You will need to copy the golang code into a local library, since /internal calls are not allowed directly.</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3638, "favorite_count": 0, "accepted_answer_id": 42047531, "answer_count": 3, "score": 4, "last_activity_date": 1486257178, "creation_date": 1479489794, "last_edit_date": 1479640878, "question_id": 40682760, "link": "https://stackoverflow.com/questions/40682760/what-syscall-method-could-i-use-to-get-the-default-network-gateway", "title": "what syscall/method could I use to get the default network gateway", "body": "<p>Using <a href=\"https://golang.org/\" rel=\"nofollow noreferrer\">Go</a> what package, native function, syscall could be used to obtain the default gateway on a <a href=\"https://en.wikipedia.org/wiki/Unix-like\" rel=\"nofollow noreferrer\">*nix system</a></p>\n\n<p>I would like to avoid creating a wrapper arround <a href=\"https://en.wikipedia.org/wiki/Netstat\" rel=\"nofollow noreferrer\">netstat</a>, route, ip,  etc commands, or read, parse an existing file, the idea is to obtain the values the most <a href=\"https://en.wikipedia.org/wiki/Cross-platform\" rel=\"nofollow noreferrer\">os/platform agnostic</a> way posible.</p>\n\n<p>For example this is the output of the <a href=\"https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man8/route.8.html\" rel=\"nofollow noreferrer\">route</a> command:</p>\n\n<pre><code>$ route -n get default\n   route to: default\ndestination: default\n       mask: default\n    gateway: 192.168.1.1\n  interface: en1\n      flags: &lt;UP,GATEWAY,DONE,STATIC,PRCLONING&gt;\n recvpipe  sendpipe  ssthresh  rtt,msec    rttvar  hopcount      mtu     expire\n       0         0         0         0         0         0      1500         0\n</code></pre>\n\n<p>I would like to do something simliar in order to just print/obtain the gateeway address/interface.</p>\n"}, {"tags": ["go", "methods", "interface", "django-inheritance"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1479489947, "last_edit_date": 1479489947, "creation_date": 1479489636, "answer_id": 40682719, "question_id": 40682578, "link": "https://stackoverflow.com/questions/40682578/implementation-and-extending-interfaces-from-different-packages/40682719#40682719", "title": "Implementation and extending interfaces from different packages", "body": "<p>It's only telling you that <code>io.ReaderAt</code> doesn't have an <code>A()</code> method.</p>\n\n<p>You need a type assertion to get an <code>*Aaa</code> out of the <code>io.ReaderAt</code>.</p>\n\n<pre><code>a := io.ReaderAt(&amp;Aaa{})\nif a, ok := a.(*Aaa); ok {\n    a.A()\n}\n</code></pre>\n\n<p>Interfaces don't need to be defined in any particular place, so if your code needs a <code>ReaderAtA</code> with those methods, you could define it yourself, and any <code>ReaderAtA</code> value would also be an <code>io.ReaderAt</code></p>\n\n<pre><code>type ReaderAtA interface {\n    io.ReaderAt\n    A()\n}\n\n\na := ReaderAtA(&amp;Aaa{})\na.A()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/0bl5djJ0im\" rel=\"noreferrer\">https://play.golang.org/p/0bl5djJ0im</a></p>\n"}], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 0, "accepted_answer_id": 40682719, "answer_count": 1, "score": 1, "last_activity_date": 1479489947, "creation_date": 1479489065, "question_id": 40682578, "link": "https://stackoverflow.com/questions/40682578/implementation-and-extending-interfaces-from-different-packages", "title": "Implementation and extending interfaces from different packages", "body": "<p>I'm wondering, is it possible to extend existing interfaces? There is a simple code snippet which doesn't work.</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"io\"\n)\n\ntype Aaa struct {}\n\n// Implementing io.ReaderAt interface\nfunc (a Aaa)ReadAt(p []byte, off int64) (n int, err error) {\n    return\n}\n\n// Extending it\nfunc (a *Aaa) A() {\n    fmt.Println(\"A\")\n}\n\nfunc main() {\n    list := [1]io.ReaderAt{Aaa{}} // Use Aaa object as io.ReaderAt type\n    list[0].A() //Trying to use an extended type. &lt;&lt; Error occurred here\n}\n</code></pre>\n\n<blockquote>\n  <p>list[0].A undefined (type io.ReaderAt has no field or method A)</p>\n</blockquote>\n\n<p>Is it a way to tell me that I can't implement interfaces from different package?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 3, "creation_date": 1479487060, "post_id": 40681963, "comment_id": 68594189, "body": "If i understood correctly you&#39;re having trouble redirecting? If so have you tried/seen this. http.Redirect(w, r, redirectURL, http.StatusFound)"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479487220, "post_id": 40681963, "comment_id": 68594278, "body": "Yes exacly, I wan to redirect to the calling page. The problem is that <code>redirectURL</code> can be many different urls."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479487551, "post_id": 40681963, "comment_id": 68594460, "body": "Have you read the docs? <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a> ? You can just write a response back at the end.   w.Write([]bytes)   , which will write back to the calling url... or if ajax is expecting a response in json you can use   json.NewEncoder(w).Encode(res)"}, {"owner": {"reputation": 3363, "user_id": 2876504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f861d39e1561dc8147fc6442d1235e8?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro C.", "link": "https://stackoverflow.com/users/2876504/alejandro-c"}, "edited": false, "score": 3, "creation_date": 1479487556, "post_id": 40681963, "comment_id": 68594463, "body": "You can look at the <code>referer</code> (sic) header"}, {"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1479488286, "post_id": 40681963, "comment_id": 68594927, "body": "I could not find my answer in the docs, that&#39;s why I asked it on OS."}], "answers": [{"comments": [{"owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "edited": false, "score": 0, "creation_date": 1479684918, "post_id": 40706072, "comment_id": 68649468, "body": "Yes. Indeed I used this one liner: <code>http.Redirect(w, r, r.Referer(), http.StatusFound) </code>"}], "tags": [], "owner": {"reputation": 694, "user_id": 4475267, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--RSHYsfQegM/AAAAAAAAAAI/AAAAAAAAAI0/NQY8UBQZ-ag/photo.jpg?sz=128", "display_name": "noisypixy", "link": "https://stackoverflow.com/users/4475267/noisypixy"}, "is_accepted": true, "score": 1, "last_activity_date": 1479657135, "creation_date": 1479657135, "answer_id": 40706072, "question_id": 40681963, "link": "https://stackoverflow.com/questions/40681963/how-to-redirect-to-calling-url-after-ajax-call/40706072#40706072", "title": "How to redirect to calling url after ajax call?", "body": "<p>As suggested in the comments, you can use the <code>Referer</code> (sic) header and <a href=\"https://godoc.org/net/http#Redirect\" rel=\"nofollow noreferrer\"><code>http.Redirect</code></a> to respond with a redirection.</p>\n\n<pre><code>func AddLike(w http.ResponseWriter, r *http.Request) {\n    // TODO: Your stuff.\n\n    redirectURL := r.Header.Get(\"Referer\")\n    if redirectURL == \"\" {\n        // TODO: What to do in case you don't know\n        // where to redirect.\n        return\n    }\n\n    http.Redirect(w, r, redirectURL, http.StatusFound)\n}\n</code></pre>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 40706072, "answer_count": 1, "score": 0, "last_activity_date": 1479657135, "creation_date": 1479486754, "last_edit_date": 1479492062, "question_id": 40681963, "link": "https://stackoverflow.com/questions/40681963/how-to-redirect-to-calling-url-after-ajax-call", "title": "How to redirect to calling url after ajax call?", "body": "<p>I have a controller function that is posted by ajax call:</p>\n\n<pre><code>func AddLike(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Println(\"form posted \\n\\n\")\n    // Get session\n    sess := session.Instance(r)\n    var params httprouter.Params\n    params = context.Get(r, \"params\").(httprouter.Params)\n    Name := params.ByName(\"name\")\n   //do stuff\n  //How to return to calling page?\n}\n</code></pre>\n\n<p>This controller can be posted from several differnet urls. \nIn the current situation, I see a blank page as the function returns to the url of ajax post, which is  <code>/addlike</code>.</p>\n\n<p>I'm wondering how to return/redirect to the calling page after post being processed?</p>\n"}, {"tags": ["go", "rabbitmq"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479487052, "post_id": 40681935, "comment_id": 68594185, "body": "The obvious answer is you call Close when you&#39;re done with the connection; where that is in your code is up to you. If <code>Queue</code> is a proxy for the connection, why not expose a Close method there?"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479487873, "post_id": 40681935, "comment_id": 68594667, "body": "You&#39;re absolutely right! That is kinda obvious now you&#39;ve pointed it out. I&#39;ve exposed the channel and connection properties and am now calling defer on those in my main function."}], "answers": [{"tags": [], "owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1479757818, "last_edit_date": 1479757818, "creation_date": 1479487862, "answer_id": 40682254, "question_id": 40681935, "link": "https://stackoverflow.com/questions/40681935/using-golangs-defer-in-a-separate-method/40682254#40682254", "title": "Using golang&#39;s defer in a separate method", "body": "<p>The simple solution is to call <code>conn.Close()</code> from elsewhere.  This might just be me, but I think it's kinda odd that you wouldn't expose the connection elsewhere, i.e. as a field in <code>Queue</code>.  Exposing the ability to close the connection from the Queue would solve this and give you more flexibility.  </p>\n\n<p>So this:</p>\n\n<pre><code>type Queue struct {\n    // your original fields\n    Conn amqp.Connection\n}\n\n// Somewhere else\nqueue.Conn.Close()\n</code></pre>\n\n<p>You're other option is connecting, then doing all the actions you want with that connection, then closing.  I'm thinking something like:</p>\n\n<pre><code>func action(conn amqp.Connection, args ...interface{}) (&lt;-chan bool) {\n    done := make(chan bool)\n    go func(amqpConn amqp.Connection, dChan chan bool){\n        // Do what you want with the connection\n        dChan &lt;- true\n    }(conn, done)\n    return done\n}\n\nfunc (queue *Queue) Connect(args ...interface{}) {\n     // your connection code\n     doneChans := make([](chan bool), 5)\n     for i := 0; i &lt; 5; i++ {\n          conn, err := amqp.Dial(uri)\n          defer conn.Close()\n          if err != nil {\n              // handle error\n          }\n          done := action(conn)\n     }\n     // This for loop will block until the 5 action calls are done\n     for j := range doneChans {\n         isFinish := &lt;-doneChans[j]\n         if !isFinish {\n             // handle bad state\n         }\n     }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 751, "user_id": 187228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e167e7956e34df5e338576f19399e596?s=128&d=identicon&r=PG", "display_name": "Joe Friedl", "link": "https://stackoverflow.com/users/187228/joe-friedl"}, "is_accepted": false, "score": 1, "last_activity_date": 1479488352, "creation_date": 1479488352, "answer_id": 40682370, "question_id": 40681935, "link": "https://stackoverflow.com/questions/40681935/using-golangs-defer-in-a-separate-method/40682370#40682370", "title": "Using golang&#39;s defer in a separate method", "body": "<p>One option is to have <code>Connect</code> return <code>conn</code>, and call <code>defer conn.Close()</code> in the caller.</p>\n\n<pre><code>package driver\n\n// imports, etc\n\nfunc (queue *Queue) Connect(args ...interface{}) amqp.Connection, error {\n    // ...\n\n    conn, err := amqp.Dial(uri)\n    if err != nil {\n        return nil, err\n    }\n\n    // ...\n\n    return conn, nil\n}\n</code></pre>\n\n<p>Then in another package:</p>\n\n<pre><code>package stuff\n\n// imports, etc\n\nfunc doStuff() {\n    queue = driver.NewQueue()\n\n    conn, err := queue.Connect(args...)\n    if err != nil {\n        log.Fatalf(\"oh no! %v!\", err)\n    }\n\n    defer conn.Close()\n\n    // Do stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 0, "accepted_answer_id": 40682254, "answer_count": 2, "score": 1, "last_activity_date": 1479757818, "creation_date": 1479486690, "question_id": 40681935, "link": "https://stackoverflow.com/questions/40681935/using-golangs-defer-in-a-separate-method", "title": "Using golang&#39;s defer in a separate method", "body": "<p>I'm using the golang RabbitMQ library in a project, and I have a <code>Connect</code> function in a separate package. I'm calling Connect, in my <code>main</code> function, however because I connect to RabbitMQ in a separate function, the <code>defer conn.Close()</code> function is called, which closes the connection within the Connect function. Which makes perfect sense, but that begs the question, where then, do I call <code>conn.Close()</code>? </p>\n\n<pre><code>package drivers\n\nimport (\n\n    // Core\n    \"log\"\n    \"os\"\n    \"time\"\n\n    // Third party\n    \"github.com/streadway/amqp\"\n)\n\ntype Queue struct {\n    Channel *amqp.Channel\n}\n\nfunc NewQueue() *Queue {\n    return &amp;Queue{}\n}\n\n// Queue interface\ntype IQueue interface {\n    Connect(args ...interface{})\n    Publish(queue string, payload []byte) error\n    Listen(queue string) (&lt;-chan amqp.Delivery, error)\n    Declare(queue string) (amqp.Queue, error)\n}\n\n// Connect - Connects to RabbitMQ\nfunc (queue *Queue) Connect(args ...interface{}) {\n\n    var uri string\n\n    if args == nil {\n\n        // Get from env vars\n        uri = os.Getenv(\"RABBIT_MQ_URI\")\n\n        if uri == \"\" {\n            log.Panic(\"No uri for queue given\")\n        }\n    } else {\n        uri = args[0].(string)\n    }\n\n    // Make max 5 connection attempts, with a 1 second timeout\n    for i := 0; i &lt; 5; i++ {\n\n        log.Println(\"Connecting to:\", uri)\n\n        // If connection is successful, return new instance\n        conn, err := amqp.Dial(uri)\n        defer conn.Close()\n\n        if err == nil {\n            log.Println(\"Successfully connected to queue!\")\n            channel, _ := conn.Channel()\n            queue.Channel = channel\n            return\n        }\n\n        log.Println(\"Failed to connect to queue, retrying...\", err)\n\n        // Wait 1 second\n        time.Sleep(5 * time.Second)\n    }\n}\n\n// Declare a new queue\nfunc (queue *Queue) Declare(queueName string) (amqp.Queue, error) {\n    return queue.Channel.QueueDeclare(\n        queueName,\n        true,\n        false,\n        false,\n        false,\n        nil,\n    )\n}\n\n// Publish a message\nfunc (queue *Queue) Publish(queueName string, payload []byte) error {\n    return queue.Channel.Publish(\n        \"\",\n        queueName,\n        false,\n        false,\n        amqp.Publishing{\n            DeliveryMode: amqp.Persistent,\n            ContentType:  \"application/json\",\n            Body:         payload,\n        },\n    )\n}\n\n// Listen for a new message\nfunc (queue *Queue) Listen(queueName string) (&lt;-chan amqp.Delivery, error) {\n    return queue.Channel.Consume(\n        queueName,\n        \"\",\n        true,\n        false,\n        false,\n        false,\n        nil,\n    )\n}\n</code></pre>\n\n<p>As you can see in the code above, I'm calling <code>defer conn.Close()</code> after making a connection, however, this immediately closes the connection again.</p>\n\n<p>Here's a Go Playground spoofing what I'm talking about... <a href=\"https://play.golang.org/p/5cz2D4gDgn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/5cz2D4gDgn</a>  </p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 2, "creation_date": 1479487808, "post_id": 40681161, "comment_id": 68594625, "body": "Go has it&#39;s own built in testing tools. See here <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">golang.org/pkg/testing</a> ... if you play around on github to see other go packages that are well used you&#39;ll often come across files that end with _test.go.. these files are for unit testing, but using the cmd go test and using the testing package. Also the package you mentioned is also a good place to start.  After your test, since this is a server, I&#39;d probably follow up with a Siege test to put some stress on the server to see how it handles <a href=\"https://www.joedog.org/siege-home/\" rel=\"nofollow noreferrer\">joedog.org/siege-home</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": true, "score": 1, "last_activity_date": 1479493668, "creation_date": 1479493668, "answer_id": 40683790, "question_id": 40681161, "link": "https://stackoverflow.com/questions/40681161/unit-testing-in-golang/40683790#40683790", "title": "Unit testing in golang", "body": "<p>It really completely depends.  Go provides pretty much all the tools you need to test your application at every single level.</p>\n\n<p><strong>Unit Tests</strong></p>\n\n<p>Design is important because there aren't many tricks to dynamically provide mock/stub objects.  You can override variables for tests, but it unlocks all sorts of problems with cleanup.  I would focus on IO free unit tests to check that your specific logic works.</p>\n\n<p>For example, you could test <code>BBPeripheral.Get</code> method by making <code>client</code> an interface, requiring it during instantiation, and providing a stub one for the test.</p>\n\n<pre><code>func Test_BBPeripheral_Get_Success(*testing.T) {\n  bb := BBPeripheral{client: &amp;StubSuccessClient, ...}\n  p, err := bb.Get(...) \n  if err != nil {\n     t.Fail()\n  }\n}\n</code></pre>\n\n<p>Then you could create a stub error client that exercises error handling in the <code>Get</code> method:</p>\n\n<pre><code>func Test_BBPeripheral_Get_Success(*testing.T) {\n  bb := BBPeripheral{client: &amp;StubErrClient, ...}\n  _, err := bb.Get(...) \n  if err == nil {\n     t.Fail()\n  }\n}\n</code></pre>\n\n<p><strong>Component/Integration Tests</strong></p>\n\n<p>These tests can help exercise that each individual unit in your package can work together in unison.  Since your code talks over http, Go provides the <code>httptest</code> package that could be used.</p>\n\n<p>To do this the test could create an httptest server with a handler registered to provide the response that <code>this.endpoint</code> expects.  You could then exercise your code using its public interface by requesting a <code>NewBBPeripheral</code>, passing in <code>this.endpoint</code> corresponding to the <a href=\"https://golang.org/src/net/http/httptest/server.go?s=471:1196#L16\" rel=\"nofollow noreferrer\"><code>Server.URL</code></a> property.</p>\n\n<p>This allows you to simulate your code talking to a real server.</p>\n\n<p><strong>Go Routine Tests</strong></p>\n\n<p>Go makes it so easy to write concurrent code, and makes it just as easy to test it.  Testing the top level code that spawns a go routine that exercises <code>NewBBPeripheral</code> could look very much like the test above.  In addition to starting up a test server your test will have to wait your your asynchronous code to complete.  If you don't have a service wide way to cancel/shutdown/signal complete then one may be required to test it using go routines.</p>\n\n<p><strong>RaceCondition/Load Testing</strong></p>\n\n<p>Using go's built in bechmark test combined with <code>-race</code> flag, you can easily exercise your code, and profile it for race conditions, leveraging the tests you wrote above.</p>\n\n<hr>\n\n<p>One thing to keep in mind, if the implementation of your application is still in flux, writing unit tests may cost a large amount of time.  Creating a couple tests, which exercise the public interface of your code, should allow you to easily verify that your application is working, while allowing the implementation to change.</p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1353, "favorite_count": 1, "accepted_answer_id": 40683790, "answer_count": 1, "score": 0, "last_activity_date": 1479560529, "creation_date": 1479484190, "last_edit_date": 1479560529, "question_id": 40681161, "link": "https://stackoverflow.com/questions/40681161/unit-testing-in-golang", "title": "Unit testing in golang", "body": "<p>I'm currently looking into creating some unit tests for my service in Go, as well as other functions that build up on top of that functionality, and I'm wondering what is the best way to unit test that in Go? My code looks like:</p>\n\n<pre><code>type BBPeripheral struct {\n    client   *http.Client\n    endpoint string\n}\n\ntype BBQuery struct {\n    Name string `json:\"name\"`\n}\n\ntype BBResponse struct {\n    Brand          string `json:\"brand\"`\n    Model          string `json:\"model\"`\n    ...\n}\n\ntype Peripheral struct {\n    Brand          string \n    Model          string \n    ...\n}\n\ntype Service interface {\n    Get(name string) (*Peripheral, error)\n}\n\nfunc NewBBPeripheral(config *peripheralConfig) (*BBPeripheral, error) {\n    transport, err := setTransport(config)\n    if err != nil {\n        return nil, err\n    }\n\n    BB := &amp;BBPeripheral{\n        client:   &amp;http.Client{Transport: transport},\n        endpoint: config.Endpoint[0],\n    }\n\n    return BB, nil\n}\n\n\nfunc (this *BBPeripheral) Get(name string) (*Peripheral, error) {\n\n    data, err := json.Marshal(BBQuery{Name: name})\n    if err != nil {\n        return nil, fmt.Errorf(\"BBPeripheral.Get Marshal: %s\", err)\n    }\n\n    resp, err := this.client.Post(this.endpoint, \"application/json\", bytes.NewBuffer(data))\n    if resp != nil {\n        defer resp.Body.Close()\n    }\n    if err != nil {\n        return nil, err\n    }\n    if resp.StatusCode != http.StatusOK {\n        return nil, fmt.Errorf(resp.StatusCode)\n    }\n\n    var BBResponse BBResponse\n\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return nil, err\n    }\n\n    err = json.Unmarshal(body, &amp;BBResponse)\n    if err != nil {\n        return nil, err\n    }\n\n    peripheral := &amp;Peripheral{}\n\n    peripheral.Model = BBResponse.Model\n    if peripheral.Model == \"\" {\n        peripheral.Model = NA\n    }\n\n    peripheral.Brand = BBResponse.Brand\n    if peripheral.Brand == \"\" {\n        peripheral.Brand = NA\n    }\n\n    return peripheral, nil\n}\n</code></pre>\n\n<p>Is the most efficient way of testing this code and the code that uses these functions to spin up a separate goroutine to act like the server, use http.httptest package, or something else? that's the first time that i try to write a test then i don't realy know how.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1479484340, "post_id": 40681118, "comment_id": 68592357, "body": "<a href=\"https://golang.org/pkg/reflect/#Zero\" rel=\"nofollow noreferrer\">golang.org/pkg/reflect/#Zero</a> ? interface{} zero value is nil. see more at <a href=\"https://golang.org/ref/spec#Types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Types</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479484551, "post_id": 40681118, "comment_id": 68592504, "body": "There&#39;s no way to map a string to a type via reflection, and if you don&#39;t use a type in your code it likely won&#39;t exist in the compiled output. You need to make a map of the types you&#39;re interested in yourself."}, {"owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "edited": false, "score": 0, "creation_date": 1479493107, "post_id": 40681118, "comment_id": 68597617, "body": "There is no way to reflect an input to a type ? automating a <code>if typeof(..) == int { val := 0 }</code> kind of thing?"}], "owner": {"reputation": 4637, "user_id": 1787782, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/808be24722ffc3ee245b9d487ed416b1?s=128&d=identicon&r=PG", "display_name": "buddy123", "link": "https://stackoverflow.com/users/1787782/buddy123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479484207, "creation_date": 1479484047, "last_edit_date": 1479484207, "question_id": 40681118, "link": "https://stackoverflow.com/questions/40681118/given-string-representing-a-type-get-its-zero-value-in-golang", "title": "Given string representing a type, get its zero value in golang", "body": "<p>Im not too faimilar with golang reflection, and I came across a parsing issue where I try to parse a given string representing a value/struct, to its zero value.\nFor example:</p>\n\n<pre><code>\"string\" -&gt; \"\"\nint -&gt; 0\n[]string -&gt; []string{}\nmap[..]... -&gt; map[..]...{}\n</code></pre>\n\n<p>anything else that is probably an interface/struct -> interface{} or struct{}\nIs there a generic way to determine that using the reflect library?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 4, "creation_date": 1479483812, "post_id": 40680981, "comment_id": 68591956, "body": "<a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">blog.golang.org/go-maps-in-action</a>: Map types are reference types, like pointers or slices, and so the value of m above is nil; it doesn&#39;t point to an initialized map. A nil map behaves like an empty map when reading, but attempts to write to a nil map will cause a runtime panic; don&#39;t do that. To initialize a map, use the built in make function"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479485165, "post_id": 40680981, "comment_id": 68592964, "body": "<i>Everything</i> in Go is passed by value. Some values happen to be pointers, or structures that contain pointers. (you may want a <code>*map</code> in some cases, if you need to reassign the map value at an address)"}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1557151253, "post_id": 40680981, "comment_id": 98659076, "body": "mh-cbon, there are no reference types in Go."}, {"owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557154786, "post_id": 40680981, "comment_id": 98660912, "body": "@mh-cbon I wasn&#39;t talking about a reference type. I was asking if a map is <i>passed</i> by reference, which is equivalent to ask if the address of the map is passed as argument or a &quot;copy&quot; of the map (passed by value)."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558879075, "post_id": 40680981, "comment_id": 99237503, "body": "@mh-cbon No, map values are not map header values; they are themselves are pointers to map headers, unlike slices they don&#39;t contain a header."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1558879364, "post_id": 40680981, "comment_id": 99237576, "body": "@chmike In Go, nothing is passed by ref and passing the address of a map is not equivalent to pass by ref. The pointer is also copied. If a map value was a ref type, then the pointer would&#39;t be copied. A map value is itself a pointer to a map header and when you pass it, that pointer will be copied."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "edited": false, "score": 0, "creation_date": 1558881219, "post_id": 40680981, "comment_id": 99238016, "body": "@InancGumus  like here ? <a href=\"https://github.com/golang/go/blob/master/src/runtime/map.go#L286\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/runtime/map.go#L286</a> thanks for your comments."}, {"owner": {"reputation": 16259, "user_id": 115363, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/49cf5d5ff161eed26b99e75694299fe1?s=128&d=identicon&r=PG", "display_name": "inanc", "link": "https://stackoverflow.com/users/115363/inanc"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1558883170, "post_id": 40680981, "comment_id": 99238518, "body": "@mh-cbon Exactly, maps are pointers to hmap."}], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 722558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99206469055adcccdbf2daf83eb4db?s=128&d=identicon&r=PG", "display_name": "Sindre Myren", "link": "https://stackoverflow.com/users/722558/sindre-myren"}, "edited": false, "score": 17, "creation_date": 1532677774, "post_id": 40681058, "comment_id": 90073415, "body": "To avoid any pitfals, be aware that maps are only passed by reference once <i>initialized</i>, and when re-initialized inside a function, the original <i>reference</i> will not be updated. Here is a illustrative playground example: <a href=\"https://play.golang.org/p/Q6vrAmmJWR6\" rel=\"nofollow noreferrer\">play.golang.org/p/Q6vrAmmJWR6</a>  Or a full article by Dave Cheny <a href=\"https://dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2017/04/29/there-is-no-pass-by-reference-in-&zwnj;&#8203;go</a>"}], "tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": true, "score": 91, "last_activity_date": 1479483899, "last_edit_date": 1495541881, "creation_date": 1479483899, "answer_id": 40681058, "question_id": 40680981, "link": "https://stackoverflow.com/questions/40680981/are-maps-passed-by-value-or-by-reference-in-go/40681058#40681058", "title": "Are maps passed by value or by reference in Go?", "body": "<p>In this thread you will find your answer :</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28384343/golang-accessing-a-map-using-its-reference\">Golang: Accessing a map using its reference</a></p>\n\n<blockquote>\n  <p>You don't need to use a pointer with a map.</p>\n  \n  <p>Map types are reference types, like pointers or slices[1]</p>\n  \n  <p>If you needed to change the Session you could use a pointer:</p>\n\n<pre><code>map[string]*Session\n</code></pre>\n  \n  <p><a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"noreferrer\">https://blog.golang.org/go-maps-in-action</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1761, "user_id": 4813600, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/D3xtB.jpg?s=128&g=1", "display_name": "alamin", "link": "https://stackoverflow.com/users/4813600/alamin"}, "is_accepted": false, "score": 3, "last_activity_date": 1604861885, "last_edit_date": 1604861885, "creation_date": 1542593079, "answer_id": 53367390, "question_id": 40680981, "link": "https://stackoverflow.com/questions/40680981/are-maps-passed-by-value-or-by-reference-in-go/53367390#53367390", "title": "Are maps passed by value or by reference in Go?", "body": "<p>No. Maps are reference by default.</p>\n<pre><code>    package main\n\n    import &quot;fmt&quot;\n\n    func mapToAnotherFunction(m map[string]int) {\n        m[&quot;hello&quot;] = 3\n        m[&quot;world&quot;] = 4\n        m[&quot;new_word&quot;] = 5\n    }\n\n    // func mapToAnotherFunctionAsRef(m *map[string]int) {\n    // m[&quot;hello&quot;] = 30\n    // m[&quot;world&quot;] = 40\n    // m[&quot;2ndFunction&quot;] = 5\n    // }\n\n    func main() {\n        m := make(map[string]int)\n        m[&quot;hello&quot;] = 1\n        m[&quot;world&quot;] = 2\n\n        // Initial State\n        for key, val := range m {\n            fmt.Println(key, &quot;=&gt;&quot;, val)\n        }\n\n        fmt.Println(&quot;-----------------------&quot;)\n\n        mapToAnotherFunction(m)\n        // After Passing to the function as a pointer\n        for key, val := range m {\n            fmt.Println(key, &quot;=&gt;&quot;, val)\n        }\n\n        // Try Un Commenting This Line\n        fmt.Println(&quot;-----------------------&quot;)\n\n        // mapToAnotherFunctionAsRef(&amp;m)\n        // // After Passing to the function as a pointer\n        // for key, val := range m {\n        //  fmt.Println(key, &quot;=&gt;&quot;, val)\n        // }\n\n        // Outputs\n        // hello =&gt; 1\n        // world =&gt; 2\n        // -----------------------\n        // hello =&gt; 3\n        // world =&gt; 4\n        // new_word =&gt; 5\n        // -----------------------\n\n    }\n</code></pre>\n<p>From Golang Blog-</p>\n<blockquote>\n<p>Map types are reference types, like pointers or slices, and so the value of m above is nil; it doesn't point to an initialized map. A nil map behaves like an empty map when reading, but attempts to write to a nil map will cause a runtime panic; don't do that. To initialize a map, use the built in make function:</p>\n</blockquote>\n<pre><code>// Ex of make function\nm = make(map[string]int)\n</code></pre>\n<p><a href=\"https://play.golang.org/p/szbqYdt3YLR\" rel=\"nofollow noreferrer\">Code Snippet Link</a> Play with it.</p>\n"}, {"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 20, "last_activity_date": 1597805934, "last_edit_date": 1597805934, "creation_date": 1544249034, "answer_id": 53680008, "question_id": 40680981, "link": "https://stackoverflow.com/questions/40680981/are-maps-passed-by-value-or-by-reference-in-go/53680008#53680008", "title": "Are maps passed by value or by reference in Go?", "body": "<p>Here are some parts from <a href=\"https://dave.cheney.net/2017/04/30/if-a-map-isnt-a-reference-variable-what-is-it\" rel=\"nofollow noreferrer\">If a map isn\u2019t a reference variable, what is it?</a> by Dave Cheney:</p>\n<blockquote>\n<p>A map value is a pointer to a <code>runtime.hmap</code> structure.</p>\n</blockquote>\n<p>and conclusion:</p>\n<blockquote>\n<p><strong>Conclusion</strong></p>\n<p>Maps, like channels, but unlike slices, are just pointers to runtime\ntypes. As you saw above, a map is just a pointer to a <code>runtime.hmap</code>\nstructure.</p>\n<p>Maps have the same pointer semantics as any other pointer value in a\nGo program. There is no magic save the rewriting of map syntax by the\ncompiler into calls to functions in <code>runtime/hmap.go</code>.</p>\n</blockquote>\n<p>And an interesting bit about history/explanation of <code>map</code> syntax:</p>\n<blockquote>\n<p><strong>If maps are pointers, shouldn\u2019t they be <code>*map[key]value</code>?</strong></p>\n<p>It\u2019s a good question that if maps are pointer values, why does the\nexpression <code>make(map[int]int)</code> return a value with the type\n<code>map[int]int</code>. Shouldn\u2019t it return a <code>*map[int]int</code>? Ian Taylor\n<a href=\"https://groups.google.com/forum/#!msg/golang-nuts/SjuhSYDITm4/jnrp7rRxDQAJ\" rel=\"nofollow noreferrer\">answered this recently in a golang-nuts</a> thread<sup>1</sup>.</p>\n<blockquote>\n<p>In the very early days what we call maps now were written as pointers,\nso you wrote <code>*map[int]int</code>. We moved away from that when we realized\nthat no one ever wrote <code>map</code> without writing <code>*map</code>.</p>\n</blockquote>\n<p>Arguably renaming the type from <code>*map[int]int</code> to <code>map[int]int</code>, while\nconfusing because the type does not look like a pointer, was less\nconfusing than a pointer shaped value which cannot be dereferenced.</p>\n</blockquote>\n"}], "owner": {"reputation": 17373, "user_id": 75517, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/404fabbcb3e36bac8da7d1904d260ec0?s=128&d=identicon&r=PG", "display_name": "chmike", "link": "https://stackoverflow.com/users/75517/chmike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67117, "favorite_count": 20, "accepted_answer_id": 40681058, "answer_count": 3, "score": 103, "last_activity_date": 1604861885, "creation_date": 1479483726, "question_id": 40680981, "link": "https://stackoverflow.com/questions/40680981/are-maps-passed-by-value-or-by-reference-in-go", "title": "Are maps passed by value or by reference in Go?", "body": "<p>Are maps passed by value or reference in Go ?</p>\n\n<p>It is always possible to define a function as following, but is this an overkill ?</p>\n\n<pre><code>func foo(dat *map[string]interface{}) {...}\n</code></pre>\n\n<p>Same question for return value. Should I return a pointer to the map, or return the map as value ? </p>\n\n<p>The intention is of course to avoid unnecessary data copy. </p>\n"}, {"tags": ["http", "go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479483638, "post_id": 40680642, "comment_id": 68591846, "body": "What is <code>getBusPostStatus</code>? What are you stuck on?"}, {"owner": {"reputation": 3, "user_id": 7122305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adcbd29f34b91a279f2c2b55adea78?s=128&d=identicon&r=PG&f=1", "display_name": "Brokes", "link": "https://stackoverflow.com/users/7122305/brokes"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479484198, "post_id": 40680642, "comment_id": 68592250, "body": "It was an &quot;idea&quot; for make a thread every 200 calls to the URL, but I don&#39;t know how to make in threads, it was the &quot;old system&quot; without threads. I&#39;m stucked on the way to make 1500 URL using threads, because the first function which is commented, the old /*main*/, takes over 16 minutes to take the 1500 responses... Thank you so much for helping!!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1479484312, "post_id": 40680642, "comment_id": 68592334, "body": "Go doesn&#39;t have threads, but if you mean goroutines, you&#39;re using them already by dispatching the function with the <code>go</code> keyword."}, {"owner": {"reputation": 3, "user_id": 7122305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adcbd29f34b91a279f2c2b55adea78?s=128&d=identicon&r=PG&f=1", "display_name": "Brokes", "link": "https://stackoverflow.com/users/7122305/brokes"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479484609, "post_id": 40680642, "comment_id": 68592548, "body": "Yeap, sorry, goroutines, but i don&#39;t know how to make many of them for doing the 1500 calls &quot;in parallel&quot; mode... Because without goroutines it takes 16 minutes to take the 1500 calls...."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1479485006, "post_id": 40680642, "comment_id": 68592856, "body": "1500 http calls in parallel is not going to be more efficient. see: <a href=\"https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/37813844#37813844\" title=\"go http get concurrency and connection reset by peer\">stackoverflow.com/questions/37774624/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 7122305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adcbd29f34b91a279f2c2b55adea78?s=128&d=identicon&r=PG&f=1", "display_name": "Brokes", "link": "https://stackoverflow.com/users/7122305/brokes"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1479487066, "post_id": 40680642, "comment_id": 68594193, "body": "Well, the idea is not to make the 1500 calls on a time, the idea is to make for example to this url:<a href=\"http://www.urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=2\" rel=\"nofollow noreferrer\">urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=2</a> the calls for checking if the post is alive or nope, from 0 to 1500, and i&#39;m trying to make 3 or 4 calls on a time, if the bus post is alive, it will send HTTP-&gt;200, if is dead, HTTP-&gt; 500, and i&#39;m trying to get these status, but now i&#39;m only doing 1 by 1 the calls to the URL, without threads... Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7122305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adcbd29f34b91a279f2c2b55adea78?s=128&d=identicon&r=PG&f=1", "display_name": "Brokes", "link": "https://stackoverflow.com/users/7122305/brokes"}, "edited": false, "score": 0, "creation_date": 1479486790, "post_id": 40681454, "comment_id": 68594025, "body": "Thanks for helping! Well, the idea is: you make a call to an url, for example: <a href=\"http://www.urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=2\" rel=\"nofollow noreferrer\">urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=2</a>, where the last number, in this case &quot;2&quot; is the number of the post, and in this case HTTP will return a HTTP -&gt; 200 because this post exist... The problem is to make one by one, secuencially the 1500 calls from the 0 to the 1500... I don&#39;t know HOW to make the goroutines to make 3 or 4 calls at a time with Go &quot;threads&quot;, from 0 to 1500... Many thanks for your help, bcoz i&#39;m completely stucked since yesterday on this..."}], "tags": [], "owner": {"reputation": 3589, "user_id": 337988, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/a0929a98013283051149383445c2fad5?s=128&d=identicon&r=PG", "display_name": "philipjkim", "link": "https://stackoverflow.com/users/337988/philipjkim"}, "is_accepted": true, "score": 2, "last_activity_date": 1479485124, "creation_date": 1479485124, "answer_id": 40681454, "question_id": 40680642, "link": "https://stackoverflow.com/questions/40680642/multiple-threads-go-for-http-get/40681454#40681454", "title": "Multiple threads Go for HTTP get", "body": "<p>Following is a simplified example code which requests 100 times concurrently and prints results, using goroutine and channel. Hope this code helps.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main() {\n    rep := 100\n    results := make(chan string)\n\n    // Use goroutine to send multiple time-consuming jobs to the channel.\n    for i := 0; i &lt; rep; i++ {\n        go func(num int) {\n            results &lt;- mockHTTPRequest(num)\n        }(i)\n    }\n\n    // Receive results from the channel and use them.\n    for i := 0; i &lt; rep; i++ {\n        fmt.Println(&lt;-results)\n    }\n}\n\nfunc mockHTTPRequest(num int) string {\n    timeDelay := rand.Intn(5000)\n    time.Sleep(time.Duration(timeDelay) * time.Millisecond)\n    if timeDelay%2 == 0 {\n        return fmt.Sprintf(\"OK: The bus post %v exists\", num)\n    }\n    return fmt.Sprintf(\"WARN: The bus post %v does not exist\", num)\n}\n</code></pre>\n\n<p>You can run this code on <a href=\"https://play.golang.org/p/RR34roRIl4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RR34roRIl4</a> .</p>\n"}], "owner": {"reputation": 3, "user_id": 7122305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70adcbd29f34b91a279f2c2b55adea78?s=128&d=identicon&r=PG&f=1", "display_name": "Brokes", "link": "https://stackoverflow.com/users/7122305/brokes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2175, "favorite_count": 0, "accepted_answer_id": 40681454, "answer_count": 1, "score": 0, "last_activity_date": 1479496947, "creation_date": 1479482622, "last_edit_date": 1479496947, "question_id": 40680642, "link": "https://stackoverflow.com/questions/40680642/multiple-threads-go-for-http-get", "title": "Multiple threads Go for HTTP get", "body": "<p>I'm working with Go in an API for the bus frequency of my city, but i'm a little bit stuck on the threads when i try to make HTTP Get to many urls.\nWithout concurrency, the programs takes over 16 minutes to complete the 1500 url calls to take the HTTP status code, and i was trying to use the concurrency, but after reading many posts i don't understand how goroutines work... </p>\n\n<p>The idea is to make ONE function and change the number of requests, like here:</p>\n\n<pre><code> go getBusPostStatus(600, 800)\n</code></pre>\n\n<p>But i'm completely stucked on that...</p>\n\n<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n\"strconv\"\n\"time\"\n)\nvar i int = 0\nvar convStr string\nvar message = make(chan string)\n\n/*func main(){\n    for i = 0; i &lt; 1500; i++ {\n        z = strconv.Itoa(i)\n        url := \"http://www.urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=\" + z\n        resp, err := http.Get(url)\n        if err != nil {\n            fmt.Println(\"Houston, we've got problems\")\n        }else{\n            if resp.StatusCode == 200{\n                fmt.Println(\"OK: El poste \"+z+\" existe\")\n            }else{\n                fmt.Println(\"WARN: El poste \"+z+\" NO existe\")\n            }\n        }\n    }\n}*/\n\n//Return 2 houndred posts\nfunc returnTH(c chan string){\n for i = 0; i &lt; 200; i++ {  \n    convStr = strconv.Itoa(i)\n    url := \"http://www.urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=\" + convStr\n    resp, err := http.Get(url)\n    if err != nil {\n        fmt.Println(\"Houston, we've got problems\")\n    }else{\n        if resp.StatusCode == 200{\n            //fmt.Println(\"OK: El poste \"+z+\" existe\")\n            c &lt;- \"OK: The bus post \"+convStr+\" exists\"\n        }else{\n            //fmt.Println(\"WARN: El poste \"+z+\" NO existe\")\n            c &lt;- \"WARN: The bus post \"+convStr+\" does not exist\"\n        }   \n    }\n  }\n}\nfunc returnFH(z chan string){\n  for i = 201; i &lt; 400; i++ {   \n   convStr = strconv.Itoa(i)\n   url := \"http://www.urbanosdezaragoza.es/frm_esquemaparadatime.php?poste=\" + convStr\n    resp, err := http.Get(url)\n    if err != nil {\n        fmt.Println(\"Houston, we've got problems\")\n    }else{\n        if resp.StatusCode == 200{\n            //fmt.Println(\"OK: El poste \"+z+\" existe\")\n            z &lt;- \"OK: The bus post \"+convStr+\" exists\"\n        }else{\n            //fmt.Println(\"WARN: El poste \"+z+\" NO existe\")\n            z &lt;- \"WARN: The bus post \"+convStr+\" does not exist\"\n        }   \n    } \n  }\n}\n\nfunc threadPrint(c, z chan string){\n   for {\n       threadOne := &lt;- c\n       threadTwo := &lt;- z\n       fmt.Println(threadOne)\n       fmt.Println(threadTwo)\n   }\n}\nfunc main(){\n    start := time.Now()\n    var c chan string = make(chan string)\n    var z chan string = make(chan string)\n    //for i = 0; i &lt; 1500; i++{\n    go returnTH(c)\n    go returnFH(z)\n    go threadPrint(c,z)\n    /*go getBusPostStatus(400, 600)\n    go getBusPostStatus(600, 800)\n    go getBusPostStatus(800, 1000)\n    go getBusPostStatus(1000, 1200)\n    go getBusPostStatus(1200, 1400)\n    go getBusPostStatus(1400, 1500)*/\n    //}\n    timeExec:= time.Since(start)\n    fmt.Println(\"Time to exec code = \", timeExec)\n\n    /*var input string\n    fmt.Scanln(&amp;input)\n    fmt.Println(\"done\")*/\n}\n</code></pre>\n\n<p>Many thanks in advance!! </p>\n"}, {"tags": ["http", "testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1479482338, "post_id": 40680498, "comment_id": 68590906, "body": "You mean the <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\"><code>httptest</code> package</a>?"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1479503436, "post_id": 40680498, "comment_id": 68602575, "body": "<a href=\"https://golang.org/pkg/net/http/httptest/#example_ResponseRecorder\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/httptest/#example_ResponseRecorder</a>"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 8, "last_activity_date": 1544717948, "last_edit_date": 1544717948, "creation_date": 1479503694, "answer_id": 40686046, "question_id": 40680498, "link": "https://stackoverflow.com/questions/40680498/how-to-test-http-request-handlers/40686046#40686046", "title": "How to test http request handlers", "body": "<p>Go provides a mock writer for use in testing handlers.  The <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">standard library documentation</a> provides an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"net/http/httptest\"\n)\n\nfunc main() {\n    handler := func(w http.ResponseWriter, r *http.Request) {\n        http.Error(w, \"something failed\", http.StatusInternalServerError)\n    }\n\n    req := httptest.NewRequest(\"GET\", \"http://example.com/foo\", nil)\n    w := httptest.NewRecorder()\n    handler(w, req)\n\n    fmt.Printf(\"%d - %s\", w.Code, w.Body.String())\n}\n</code></pre>\n\n<p>I think having a global dependency (<code>db</code>) throws a wrench into clean unit testing.  Using go your test could reassign a value, masking, the global value of <code>db</code>.  </p>\n\n<p>Another strategy (my preferred) is to package your handler in a struct, which has a <code>db</code> attribute..</p>\n\n<pre><code>type Handlers struct {\n  db DB_INTERFACE\n}\n\nfunc (hs *Handlers) GetProductsHandler(w http.ResponseWriter, req *http.Request) {...}\n</code></pre>\n\n<p>This way your test can instantiate a <code>Handlers</code> with a stub <code>db</code> object which will allow you to create IO free unit tests.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4461, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1559821581, "creation_date": 1479482231, "last_edit_date": 1559821581, "question_id": 40680498, "link": "https://stackoverflow.com/questions/40680498/how-to-test-http-request-handlers", "title": "How to test http request handlers", "body": "<p>I have a set of requests handlers like the one below:</p>\n\n<pre><code>func GetProductsHandler(w http.ResponseWriter, req *http.Request) {\n    defer req.Body.Close()\n    products := db.GetProducts()\n\n    //    ...\n    // return products as JSON array\n}\n</code></pre>\n\n<p>How do I test them the right way? Should I send mock ResponseWriter and Request objects to the function and see the results?</p>\n\n<p>Are there tools to mock request and response objects in Go to simplify the process without having to start server before testing?</p>\n"}, {"tags": ["go", "data-structures"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1479480064, "post_id": 40679748, "comment_id": 68589298, "body": "Coded with <code>interface{}</code> is <b>never</b> <b>elegant</b> so: Either get rid of this monster or live with it."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1479516721, "post_id": 40679748, "comment_id": 68606550, "body": "if you&#39;re using only interface{} you&#39;re using a very weak abstraction, I recommend you look a little more deep in your data structures and try to create interfaces with methods like Merge(other type) etc."}], "owner": {"reputation": 50, "user_id": 1371278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95347e8e7f2363ead9834fcbd20ae1af?s=128&d=identicon&r=PG", "display_name": "Matt Spaulding", "link": "https://stackoverflow.com/users/1371278/matt-spaulding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479479986, "creation_date": 1479479986, "question_id": 40679748, "link": "https://stackoverflow.com/questions/40679748/how-can-i-merge-arbitrary-data-structures-in-go", "title": "How can I merge arbitrary data structures in Go?", "body": "<p>I have a situation where I have two data structures.  Each is statically typed as an <code>interface{}</code> and can either be an int, string, slice, or map.  The function should be able to merge these two data structures together, except in some cases (for instance, you can't merge a string with a map).  I've written the following code which works, but I'm wondering if there is a more elegant approach.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc mergeDataStructures(a, b interface{}) (interface{}, error) {\n    var retVal interface{}\n\n    switch a.(type) {\n    case string, int:\n        switch b.(type) {\n        case string, int:\n            retVal = []interface{}{}\n            retVal = append(retVal.([]interface{}), b)\n            retVal = append(retVal.([]interface{}), a)\n        case []interface{}:\n            retVal = append(retVal.([]interface{}), a)\n        case map[interface{}]interface{}:\n            return nil, fmt.Errorf(\"unable to merge string with map\")\n        default:\n            return nil, fmt.Errorf(\"unknown value type %q\", reflect.TypeOf(b))\n        }\n    case []interface{}:\n        switch b.(type) {\n        case string, int:\n            retVal = []interface{}{}\n            retVal = append(retVal.([]interface{}), a.([]interface{})...)\n            retVal = append(retVal.([]interface{}), b)\n        case []interface{}:\n            retVal = []interface{}{}\n            retVal = append(retVal.([]interface{}), a.([]interface{})...)\n            retVal = append(retVal.([]interface{}), b.([]interface{})...)\n        case map[interface{}]interface{}:\n            return nil, fmt.Errorf(\"unable to merge slice with map\")\n        default:\n            return nil, fmt.Errorf(\"unknown value type %q\", reflect.TypeOf(b))\n        }\n    case map[interface{}]interface{}:\n        switch b.(type) {\n        case string, int:\n            return nil, fmt.Errorf(\"unable to merge map with string\")\n        case []interface{}:\n            return nil, fmt.Errorf(\"unable to merge map with slice\")\n        case map[interface{}]interface{}:\n            retVal = make(map[interface{}]interface{})\n            for k, v := range a.(map[interface{}]interface{}) {\n                retVal.(map[interface{}]interface{})[k] = v\n            }\n            for k, v := range b.(map[interface{}]interface{}) {\n                retVal.(map[interface{}]interface{})[k] = v\n            }\n        default:\n            return nil, fmt.Errorf(\"unknown value type %q\", reflect.TypeOf(b))\n        }\n    default:\n        return nil, fmt.Errorf(\"unknown value type %q\", reflect.TypeOf(a))\n    }\n\n    return retVal, nil\n}\n\nfunc main() {\n  var a, b interface{}\n\n  a = []interface{}{1,2,3}\n  b = 4\n  c, err := mergeDataStructures(a, b)\n  if err != nil {\n    panic(err)\n  }\n  fmt.Printf(\"%#v\\n\", c) // prints: []interface{}{1,2,3,4}\n}\n</code></pre>\n"}, {"tags": ["go", "docker", "dockerfile"], "comments": [{"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 0, "creation_date": 1479480079, "post_id": 40679585, "comment_id": 68589307, "body": "I suspect there&#39;s something in that make file that calls a package manager or curl, etc, and then checks for a GPG key that is not added.  For example, if it&#39;s an <code>apt-get install</code>, you&#39;d probably have to run <code>apt-key adv --keyserver &lt;url&gt; &lt;options&gt;</code>"}, {"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 0, "creation_date": 1479480198, "post_id": 40679585, "comment_id": 68589405, "body": "Also you&#39;re missing the line it&#39;s probably failing on, which is the <code>apt-get install</code>, the force yes should cause that to not be the issue, but it&#39;s generally a bad thing to ignore GPG keys."}], "owner": {"reputation": 27466, "user_id": 139150, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/7064369714bbb01ca2e42c699f95d60d?s=128&d=identicon&r=PG", "display_name": "shantanuo", "link": "https://stackoverflow.com/users/139150/shantanuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479483374, "creation_date": 1479479461, "last_edit_date": 1479483374, "question_id": 40679585, "link": "https://stackoverflow.com/questions/40679585/docker-image-for-a-go-package", "title": "docker image for a go package", "body": "<p>I am trying to build an image using this dockerfile.</p>\n\n<p><a href=\"https://github.com/shantanuo/docker_go_mysql_elasticsearch/blob/master/Dockerfile\" rel=\"nofollow noreferrer\">https://github.com/shantanuo/docker_go_mysql_elasticsearch/blob/master/Dockerfile</a></p>\n\n<p>I get an error:</p>\n\n<pre><code>GPG error: http://ftp.osuosl.org jessie InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUB\n</code></pre>\n\n<p>But the original author of this repo has successfully built the automated image. Here is his dockerfile...</p>\n\n<p><a href=\"https://github.com/EagleChen/docker_go_mysql_elasticsearch/blob/master/Dockerfile\" rel=\"nofollow noreferrer\">https://github.com/EagleChen/docker_go_mysql_elasticsearch/blob/master/Dockerfile</a></p>\n\n<p>Is the way of building go packages changed during the last months?</p>\n\n<pre><code>RUN apt-get update &amp;&amp; \\\n  go get github.com/tools/godep &amp;&amp; \\\n  (go get github.com/siddontang/go-mysql-elasticsearch || true ) &amp;&amp; \\\n  cd /go/src/github.com/siddontang/go-mysql-elasticsearch &amp;&amp; \\\n  make\n</code></pre>\n\n<p>Is there any other way to write the above RUN command?</p>\n\n<hr>\n\n<p>Update:</p>\n\n<p>I changed the RUN command to the following:</p>\n\n<pre><code>RUN go get github.com/tools/godep &amp;&amp; \\\n  (go get github.com/siddontang/go-mysql-elasticsearch || true ) &amp;&amp; \\\n  cd /go/src/github.com/siddontang/go-mysql-elasticsearch &amp;&amp; \\\n  make\n</code></pre>\n\n<p>And now getting this error:</p>\n\n<pre><code>imports github.com/siddontang/go-mysql-elasticsearch: no buildable Go source files in /go/src/github.com/siddontang/go-mysql-elasticsearch\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1479478809, "post_id": 40679298, "comment_id": 68588383, "body": "Why is algorithmically not the &quot;go-way&quot;? Just fill your slice with every 1 you find."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1479479004, "post_id": 40679298, "comment_id": 68588532, "body": "The algorithm to output indicies of the 1 bits can be found in this related question: <a href=\"http://stackoverflow.com/questions/40235464/bitmasking-conversion-of-cpu-ids-with-go/40235914#40235914\">Bitmasking conversion of CPU ids with Go</a>"}], "owner": {"reputation": 5767, "user_id": 27800, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/f8d805c02bfa80a79df1381984ac5d3a?s=128&d=identicon&r=PG", "display_name": "Peter Miehle", "link": "https://stackoverflow.com/users/27800/peter-miehle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1479478653, "creation_date": 1479478653, "question_id": 40679298, "link": "https://stackoverflow.com/questions/40679298/can-i-convert-a-bitencoded-integer-to-array-of-bit-positions", "title": "Can I convert a bitencoded integer to array of bit positions?", "body": "<p>I have a bit-wise coded value <code>0b00100110</code> and I want to extract an array of int with bit-positions like <code>[2,3,6]</code>.</p>\n\n<p>I am very new to golang, so coming from C I would do this algorithmically. But I would like it to do the go-way</p>\n"}, {"tags": ["go", "jwt"], "comments": [{"owner": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 2, "creation_date": 1496154444, "post_id": 40679073, "comment_id": 75537987, "body": "Hi Rob, could you find the more elegant way of providing varying levels of access? I&#39;m looking for the same."}, {"owner": {"reputation": 2009, "user_id": 1087890, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/0f8ec58f46e4af3a67f768675c20aac8?s=128&d=identicon&r=PG", "display_name": "Yang Luo", "link": "https://stackoverflow.com/users/1087890/yang-luo"}, "reply_to_user": {"reputation": 1082, "user_id": 751524, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/023e4f238b75274e7d16c1db67f62376?s=128&d=identicon&r=PG", "display_name": "utiq", "link": "https://stackoverflow.com/users/751524/utiq"}, "edited": false, "score": 2, "creation_date": 1525959673, "post_id": 40679073, "comment_id": 87565325, "body": "@utiq you can use Casbin: <a href=\"https://github.com/casbin/casbin\" rel=\"nofollow noreferrer\">github.com/casbin/casbin</a>"}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 3697197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uRGZM.jpg?s=128&g=1", "display_name": "Erasmus Mann Larbi", "link": "https://stackoverflow.com/users/3697197/erasmus-mann-larbi"}, "is_accepted": false, "score": 6, "last_activity_date": 1521826711, "creation_date": 1521826711, "answer_id": 49455492, "question_id": 40679073, "link": "https://stackoverflow.com/questions/40679073/elegant-role-based-jwt-security-in-go-server/49455492#49455492", "title": "Elegant role-based JWT security in Go server", "body": "<ul>\n<li>I hope its not too late, my response.\n<a href=\"http://casbin.org\" rel=\"noreferrer\">Casbin</a> resolves this issue nicely.\n\n<ul>\n<li>In addition, a very simple tutorial explaining the basics can be found at <a href=\"https://zupzup.org/casbin-http-role-auth\" rel=\"noreferrer\">zupzup.org</a> and <a href=\"https://doc.xuwenliang.com/docs/casbin/188\" rel=\"noreferrer\">https://doc.xuwenliang.com/docs/casbin/188</a></li>\n</ul></li>\n</ul>\n\n<p>I find working with it using JWT and/or Session/Cookie based authentication mechanisms also very simple as. I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 49, "user_id": 11873703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3a6d199979f17122e691b4f2cd53fc5?s=128&d=identicon&r=PG&f=1", "display_name": "McWally", "link": "https://stackoverflow.com/users/11873703/mcwally"}, "is_accepted": false, "score": 3, "last_activity_date": 1575971407, "creation_date": 1575971407, "answer_id": 59264383, "question_id": 40679073, "link": "https://stackoverflow.com/questions/40679073/elegant-role-based-jwt-security-in-go-server/59264383#59264383", "title": "Elegant role-based JWT security in Go server", "body": "<p>Just Use <code>github.com/casbin/casbin</code> for a better precision in ur authorization and authentication middleware because it helped me a lot too.</p>\n\n<p>And for more explanatory example of to use it; Use <code>https://zupzup.org/casbin-http-role-auth/</code></p>\n"}], "owner": {"reputation": 806, "user_id": 304957, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wYo2j.jpg?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/304957/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4842, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1575971407, "creation_date": 1479477942, "question_id": 40679073, "link": "https://stackoverflow.com/questions/40679073/elegant-role-based-jwt-security-in-go-server", "title": "Elegant role-based JWT security in Go server", "body": "<p>I'm writing a Go web API which uses JWT for tokens/auth etc. and I was wondering if there was a more elegant way of providing varying levels of access to my route handlers than the following?</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n    jwt \"gopkg.in/appleboy/gin-jwt.v2\"\n)\n\nvar (\n    users = map[string]byte{\n        \"admin\":    1,\n        \"manager\":  2,\n        \"employee\": 3,\n    }\n)\n\nfunc main() {\n    router := gin.Default()\n    group := router.Group(\"/v1\")\n\n    jwtMiddleware := &amp;jwt.GinJWTMiddleware{\n        Realm:         \"realm\",\n        Key:           []byte(\"password\"),\n        Authenticator: authenticate,\n        PayloadFunc:   payload,\n    }\n\n    group.Use(jwtMiddleware.MiddlewareFunc())\n    group.GET(\"/refreshToken\", jwtMiddleware.RefreshHandler)\n    group.GET(\"/hello\", hello)\n\n    router.POST(\"/login\", jwtMiddleware.LoginHandler)\n    router.Run(\":1234\")\n}\n\nfunc hello(c *gin.Context) {\n    switch getRoleFromContext(c) {\n    case 1:\n        helloAdmin(c)\n    case 2:\n        helloManager(c)\n    case 3:\n        helloEmployee(c)\n    default:\n        c.AbortWithStatus(http.StatusForbidden)\n    }\n}\n\nfunc helloAdmin(c *gin.Context)    { c.String(http.StatusOK, \"Hello, admin!\") }\nfunc helloManager(c *gin.Context)  { c.String(http.StatusOK, \"Hello, manager!\") }\nfunc helloEmployee(c *gin.Context) { c.String(http.StatusOK, \"Hello, employee!\") }\n\nfunc authenticate(email string, password string, c *gin.Context) (string, bool) {\n    if _, ok := users[email]; ok {\n        return email, true\n    }\n\n    return \"\", false\n}\n\nfunc payload(email string) map[string]interface{} {\n    return map[string]interface{}{\n        \"role\": users[email],\n    }\n}\n\nfunc getRoleFromContext(c *gin.Context) (role byte) {\n    claims := jwt.ExtractClaims(c)\n\n    rawRole, ok := claims[\"role\"]\n    if !ok {\n        c.AbortWithStatus(http.StatusForbidden)\n    }\n\n    floatRole, ok := rawRole.(float64)\n    if !ok {\n        c.AbortWithStatus(http.StatusForbidden)\n    }\n\n    return byte(floatRole)\n}\n</code></pre>\n\n<p>In my real code (consisting of only 18 or so routes), I've created a Routes struct, which provides handlers for all of the routes my API provides.  Within that, I'm performing the above switching logic to specialised Route structs, which ensures only administrative users can perform specific functions, while other functions are callable by multiple types of users, just with different behaviour.</p>\n\n<p>I've tried throwing together middleware-based auth as follows:</p>\n\n<pre><code>func roleCheckerMiddleware(roles ...byte) gin.HandlerFunc {\n    return func(c *gin.Context) {\n        contextRole := getRoleFromContext(c)\n        for _, role := range roles {\n            if contextRole == role {\n                c.Next()\n                return\n            }\n        }\n\n        c.AbortWithStatus(http.StatusForbidden)\n    }\n}\n</code></pre>\n\n<p>...and applying it as follows:</p>\n\n<pre><code>adminGroup := group.Group(\"/\")\nadminGroup.GET(\"/hello\", helloAdmin)\nadminGroup.Use(roleCheckerMiddleware(1))\n\nmanagerGroup := group.Group(\"/\")\nmanagerGroup.GET(\"/hello\", helloManager)\nmanagerGroup.Use(roleCheckerMiddleware(2, 1))\n\nemployeeGroup := group.Group(\"/\")\nemployeeGroup.GET(\"/hello\", helloEmployee)\nemployeeGroup.Use(roleCheckerMiddleware(3, 2, 1))\n</code></pre>\n\n<p>...but the obvious duplication of the /hello route means this method isn't (as far as I'm aware) possible, without the introduction of groupings for /admin, /manager and /employee.  I'd love to be shown otherwise though as this feels more elegant that my switching logic!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479488448, "post_id": 40678504, "comment_id": 68595013, "body": "Can you be a bit more specific? Looking at your code I see nothing wrong with your structs.  Output is a type of S3, so you&#39;ve already created a nested object.. And if the file is converted into a byte array then the field File should have no problem accepting it.  So I guess can you give more details about the issue, Error messages, etc."}, {"owner": {"reputation": 2544, "user_id": 2734665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/7GwAG.jpg?s=128&g=1", "display_name": "Mati Tucci", "link": "https://stackoverflow.com/users/2734665/mati-tucci"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479492279, "post_id": 40678504, "comment_id": 68597138, "body": "@reticentroot yeah, my strucs are correct but where do I use them? how can I send them to the POST request?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479492965, "post_id": 40678504, "comment_id": 68597524, "body": "Check out this stack, the accepted answer  <a href=\"http://stackoverflow.com/questions/24455147/how-do-i-send-a-json-string-in-a-post-request-in-go\" title=\"how do i send a json string in a post request in go\">stackoverflow.com/questions/24455147/&hellip;</a>  it shows you how to make a post, you just might have to marshal your data using the json package."}, {"owner": {"reputation": 2544, "user_id": 2734665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/7GwAG.jpg?s=128&g=1", "display_name": "Mati Tucci", "link": "https://stackoverflow.com/users/2734665/mati-tucci"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479493831, "post_id": 40678504, "comment_id": 68598022, "body": "@reticentroot but can I json encode a file? that&#39;s my issue"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479493927, "post_id": 40678504, "comment_id": 68598083, "body": "File is just the name you gave it, it&#39;s of type byte array, so yes. Json should be able to Marshal the struct and all its data."}, {"owner": {"reputation": 2544, "user_id": 2734665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/7GwAG.jpg?s=128&g=1", "display_name": "Mati Tucci", "link": "https://stackoverflow.com/users/2734665/mati-tucci"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479494593, "post_id": 40678504, "comment_id": 68598416, "body": "@reticentroot I tried but didn&#39;t work. Can you answer me with the code, please? And will upvote it."}], "answers": [{"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1479512278, "last_edit_date": 1479512278, "creation_date": 1479511051, "answer_id": 40687381, "question_id": 40678504, "link": "https://stackoverflow.com/questions/40678504/post-file-and-nested-params-golang/40687381#40687381", "title": "POST file and nested params golang", "body": "<p>Okay, So given what you've told me and what little information I have with your example, I might do something like this.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"net/http\"\n)\n\ntype S3 struct {\n    Accesskeyid     string\n    Secretaccesskey string\n    Bucket          string\n}\n\ntype Test struct {\n    Outputformat string\n    Wait         string\n    Output       S3\n    File         []byte\n}\n\nfunc main() {\n    myStrut := Test{\n        Outputformat: \"Json\",\n        Wait:         \"Some Time\",\n        Output: S3{\n            Accesskeyid:     \"my id\",\n            Secretaccesskey: \"secret id\",\n            Bucket:          \"east\",\n        },\n        File: []byte(`some bytes`),\n    }\n    jsonValue, err := json.Marshal(myStrut)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"Test showing that data was marshalled\\n %q\\n\", jsonValue)\n    resp, err := http.Post(\"some url\", \"application/json\", bytes.NewBuffer(jsonValue))\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(resp.Status)\n\n}\n</code></pre>\n\n<p>Now from what i gleamed in the comments you might be also having trouble opening the file as a byte array to assign to your struct. Here's an example you can use you help you open the file as a byte array so that you can assign those bytes to your struct.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n\n    //An example of how to open a file and turn it into bytes for your struct\n    byteArray, err := ioutil.ReadFile(\"input.txt\")\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(byteArray)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 2544, "user_id": 2734665, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/7GwAG.jpg?s=128&g=1", "display_name": "Mati Tucci", "link": "https://stackoverflow.com/users/2734665/mati-tucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479714443, "creation_date": 1479476209, "last_edit_date": 1479714443, "question_id": 40678504, "link": "https://stackoverflow.com/questions/40678504/post-file-and-nested-params-golang", "title": "POST file and nested params golang", "body": "<p>I'm already posting a file and some params, but now I need to send nested params with a struct and I don't know where to use that (I'm new in Go).</p>\n\n<p>This is what I have: <a href=\"https://play.golang.org/p/L4qx6AZhUO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/L4qx6AZhUO</a></p>\n\n<p>Now, I'm creating this structs:</p>\n\n<pre><code>type S3 struct {\n    Accesskeyid     string\n    Secretaccesskey string\n    Bucket          string\n}\n\ntype Test struct {\n    Outputformat string\n    Wait         string\n    Output       S3\n    File         []byte\n}\n</code></pre>\n\n<p>And I would like to send the <code>Test</code> struct WITH the file. Any ideas?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "ftp"], "comments": [{"owner": {"reputation": 708, "user_id": 4144758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cfea5e29717057a628f9363b652e5a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Daniele D", "link": "https://stackoverflow.com/users/4144758/daniele-d"}, "edited": false, "score": 0, "creation_date": 1479473602, "post_id": 40677539, "comment_id": 68585007, "body": "Please provide a reproducable example"}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": false, "score": 2, "last_activity_date": 1479474012, "creation_date": 1479474012, "answer_id": 40677792, "question_id": 40677539, "link": "https://stackoverflow.com/questions/40677539/implement-github-com-jlaffaye-ftp-in-golang/40677792#40677792", "title": "implement github.com/jlaffaye/ftp in golang", "body": "<p>You have to precede a function with the package from where this function is.</p>\n\n<p>In your example <code>Connect</code> is from <code>ftp</code> package, you should write <code>ftp.Connect</code> instead.</p>\n\n<p>Do not forget to import the package :</p>\n\n<pre><code>import github.com/jlaffaye/ftp\n</code></pre>\n\n<p>at the beginning of the file.</p>\n"}], "owner": {"reputation": 89, "user_id": 5124032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50b593302405409d5b2f916309d962e0?s=128&d=identicon&r=PG&f=1", "display_name": "Jilan", "link": "https://stackoverflow.com/users/5124032/jilan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1912, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1479474012, "creation_date": 1479473270, "question_id": 40677539, "link": "https://stackoverflow.com/questions/40677539/implement-github-com-jlaffaye-ftp-in-golang", "title": "implement github.com/jlaffaye/ftp in golang", "body": "<p>I am new to golang I'm trying to implement an FTP client to get files from a server.\nI tried several packages like :\"github.com/dutchcoders/goftp\" but walk support was not working.\nIm currently trying with \"github.com/jlaffaye/ftp\" but cant seem to connect to the server.</p>\n\n<p>I imported the package and Im simply using the following code to connect:</p>\n\n<p>func main(){</p>\n\n<pre><code>ftp,err := Connect(address:port)\n\nftp.Login(\"user\", \"password\")\nif ftp.Code == 530 {\n    log.Println(\"Failed to Login\")\n}\n\n\nlog.Println(\"Successfully Connected to\",  ftp)\n</code></pre>\n\n<p>}</p>\n\n<p>when i run it gives undefined: Connect</p>\n\n<p>I am following the godocs for this package</p>\n\n<p>GODOC:    <a href=\"https://godoc.org/github.com/jlaffaye/ftp\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/jlaffaye/ftp</a></p>\n"}, {"tags": ["authentication", "go", "proxy"], "comments": [{"owner": {"reputation": 1895, "user_id": 605948, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/e2fd8602397f2e842f5bd64b2a3269a5?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/605948/matthew"}, "edited": false, "score": 0, "creation_date": 1542785058, "post_id": 40676825, "comment_id": 93688898, "body": "Wanted to share this post, which worked: <a href=\"https://stackoverflow.com/questions/53406874/golang-how-to-properly-use-proxies-in-my-http-requests\" title=\"golang how to properly use proxies in my http requests\">stackoverflow.com/questions/53406874/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 291, "user_id": 2723547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63d0c184657291a566702fa2c81a381?s=128&d=identicon&r=PG", "display_name": "LeoCBS", "link": "https://stackoverflow.com/users/2723547/leocbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1479901185, "creation_date": 1479901185, "answer_id": 40763542, "question_id": 40676825, "link": "https://stackoverflow.com/questions/40676825/proxy-golang-https/40763542#40763542", "title": "Proxy golang https", "body": "<p>I found the solution. Golang don't pass header parameters in method CONNECT, then parameter Proxy-Authorization aren't sent to proxy server.</p>\n\n<p>to resolve this, field ProxyConnectHeader was added to struct Transport. but this change until released, this change are only in master.</p>\n\n<p>to test this new field using golang from master, i made on project in github and worked.</p>\n\n<p><a href=\"https://github.com/golang/go/commit/b06c93e45b7b03a5d670250ff35e42d62aface82\" rel=\"nofollow noreferrer\">link to golang path</a></p>\n\n<p><a href=\"https://github.com/LeoCBS/poc-proxy-https\" rel=\"nofollow noreferrer\">link to project in github that test this new field</a></p>\n"}], "owner": {"reputation": 291, "user_id": 2723547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a63d0c184657291a566702fa2c81a381?s=128&d=identicon&r=PG", "display_name": "LeoCBS", "link": "https://stackoverflow.com/users/2723547/leocbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3596, "favorite_count": 0, "accepted_answer_id": 40763542, "answer_count": 1, "score": 2, "last_activity_date": 1479901185, "creation_date": 1479471065, "question_id": 40676825, "link": "https://stackoverflow.com/questions/40676825/proxy-golang-https", "title": "Proxy golang https", "body": "<p>i am trying to make one get in <a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a> using proxy with authentication, i already passing header parameter </p>\n\n<blockquote>\n  <p>Proxy-Authorization</p>\n</blockquote>\n\n<p>but proxy server return </p>\n\n<blockquote>\n  <p>Proxy Authentication Required</p>\n</blockquote>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"encoding/base64\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"net/url\"\n    \"os\"\n)\n\nfunc main() {\n    req, _ := http.NewRequest(\"GET\", \"https://www.google.com.br\", nil)\n    req.Header.Set(\"Host\", \"www.google.com.br\")\n\n    proxyURL := url.URL{\n        Host: \"IP-HERE:PORT-HEERE\"}\n\n    transport := &amp;http.Transport{\n        Proxy:           http.ProxyURL(&amp;proxyURL),\n        TLSClientConfig: &amp;tls.Config{},\n    }\n    client := &amp;http.Client{Transport: transport}\n    req.RequestURI = \"\"\n\n    auth := fmt.Sprintf(\"USER:PASSWORD\")\n    basic := \"Basic \" + base64.StdEncoding.EncodeToString([]byte(auth))\n    req.Header.Add(\"Proxy-Authorization\", basic)\n\n    resp, err := client.Do(req)\n    if err != nil {\n        fmt.Printf(\"erro: %s\", err)\n    }\n    fmt.Printf(\"code: %s\", resp.StatusCode)\n    htmlData, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    fmt.Println(os.Stdout, string(htmlData))\n}\n</code></pre>\n\n<p>I have to pass another parameter?</p>\n\n<p>When i perform one get in <a href=\"http://www.google.com.br\" rel=\"nofollow noreferrer\">http://www.google.com.br</a>, without https.. proxy authentication with success. why?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3843, "user_id": 2843030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6c54e4c03b5028d13921bcbad5111bf?s=128&d=identicon&r=PG", "display_name": "Franck Jeannin", "link": "https://stackoverflow.com/users/2843030/franck-jeannin"}, "is_accepted": false, "score": 0, "last_activity_date": 1479467745, "last_edit_date": 1479467745, "creation_date": 1479467283, "answer_id": 40675557, "question_id": 40675421, "link": "https://stackoverflow.com/questions/40675421/golang-map-with-array-of-values/40675557#40675557", "title": "Golang Map with array of values", "body": "<p>It means the member <code>bookMap</code> of a <code>struct</code> <code>Student</code> contains a <code>map</code> which takes a <code>string</code> as a <em>key</em>, and an array (slice) of pointers to instances of <code>model.Books</code> as <em>value</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": true, "score": 1, "last_activity_date": 1479467659, "creation_date": 1479467659, "answer_id": 40675706, "question_id": 40675421, "link": "https://stackoverflow.com/questions/40675421/golang-map-with-array-of-values/40675706#40675706", "title": "Golang Map with array of values", "body": "<p>That statement is initializing the map <code>Student.bookMap</code> to an empty map (which has the following structure: key -> <code>string</code>, value -> slice of pointers of <code>model.Books</code>).</p>\n"}], "owner": {"reputation": 253, "user_id": 7177729, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mA9oA1YPkkE/AAAAAAAAAAI/AAAAAAAACl4/mzf-itgXvcU/photo.jpg?sz=128", "display_name": "Preethi Rajaraman", "link": "https://stackoverflow.com/users/7177729/preethi-rajaraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2951, "favorite_count": 1, "accepted_answer_id": 40675706, "answer_count": 2, "score": 1, "last_activity_date": 1479467745, "creation_date": 1479466939, "last_edit_date": 1479467173, "question_id": 40675421, "link": "https://stackoverflow.com/questions/40675421/golang-map-with-array-of-values", "title": "Golang Map with array of values", "body": "<p>What does this statement mean in Go:</p>\n\n<pre><code>Student.bookMap=map[string][]*model.Books{}\n</code></pre>\n\n<p>Where <code>Student</code> is:</p>\n\n<pre><code>type Student struct{\n    bookMap map[string][]*model.Books\n}\n</code></pre>\n\n<p>and we have a model package</p>\n\n<pre><code>package model\n\ntype Books struct {\n    bookName   string  `db:\"Name\"`\n    bookAuthor string  `db:\"Author\"`\n}\n</code></pre>\n"}, {"tags": ["sql", "postgresql", "go", "sqlx"], "comments": [{"owner": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "edited": false, "score": 4, "creation_date": 1479467049, "post_id": 40675365, "comment_id": 68580962, "body": "PostgreSQL supports <code>RETURNING</code> syntax for <code>INSERT</code> statements. Example: <code>INSERT INTO users(...) VALUES(...) RETURNING id, name, foo, bar</code>"}, {"owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "reply_to_user": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "edited": false, "score": 0, "creation_date": 1479471018, "post_id": 40675365, "comment_id": 68583342, "body": "Can you please put it as an answer and I will mark it as a correct one?"}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2919292, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2mgIC.jpg?s=128&g=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/2919292/alexm"}, "is_accepted": false, "score": 2, "last_activity_date": 1479791031, "creation_date": 1479791031, "answer_id": 40734109, "question_id": 40675365, "link": "https://stackoverflow.com/questions/40675365/get-back-newly-inserted-row-in-postgres-with-sqlx/40734109#40734109", "title": "Get back newly inserted row in Postgres with sqlx", "body": "<p>PostgreSQL supports <code>RETURNING</code> syntax for <code>INSERT</code> statements. </p>\n\n<p>Example: </p>\n\n<pre><code>INSERT INTO users(...) VALUES(...) RETURNING id, name, foo, bar\n</code></pre>\n\n<p>Documentaion: <a href=\"https://www.postgresql.org/docs/9.6/static/sql-insert.html\" rel=\"nofollow noreferrer\">https://www.postgresql.org/docs/9.6/static/sql-insert.html</a></p>\n\n<blockquote>\n  <p>The optional RETURNING clause causes INSERT to compute and return value(s) based on each row actually inserted (or updated, if an ON CONFLICT DO UPDATE clause was used). This is primarily useful for obtaining values that were supplied by defaults, such as a serial sequence number. However, any expression using the table's columns is allowed. The syntax of the RETURNING list is identical to that of the output list of SELECT. Only rows that were successfully inserted or updated will be returned.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 36140, "user_id": 6463558, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/g22sX.jpg?s=128&g=1", "display_name": "slideshowp2", "link": "https://stackoverflow.com/users/6463558/slideshowp2"}, "is_accepted": false, "score": 2, "last_activity_date": 1561625188, "creation_date": 1561625188, "answer_id": 56787271, "question_id": 40675365, "link": "https://stackoverflow.com/questions/40675365/get-back-newly-inserted-row-in-postgres-with-sqlx/56787271#56787271", "title": "Get back newly inserted row in Postgres with sqlx", "body": "<p>Here is docs about transaction of <code>sqlx</code>:</p>\n\n<blockquote>\n  <p>The result has two possible pieces of data: LastInsertId() or RowsAffected(), the availability of which is driver dependent. In MySQL, for instance, LastInsertId() will be available on inserts with an auto-increment key, but in PostgreSQL, this information can only be retrieved from a normal row cursor by using the RETURNING clause.</p>\n</blockquote>\n\n<p>So I made a complete demo for how to execute transaction using <code>sqlx</code>, the demo will create an address row in <code>addresses</code> table and then create a user in <code>users</code> table using the new <code>address_id</code> PK as <code>user_address_id</code> FK of the user.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package transaction\n\nimport (\n    \"database/sql\"\n    \"github.com/jmoiron/sqlx\"\n    \"log\"\n    \"github.com/pkg/errors\"\n)\nimport (\n    \"github.com/icrowley/fake\"\n)\n\ntype User struct {\n    UserID int `db:\"user_id\"`\n    UserNme string `db:\"user_nme\"`\n    UserEmail string `db:\"user_email\"`\n    UserAddressId sql.NullInt64 `db:\"user_address_id\"`\n}\n\ntype ITransactionSamples interface {\n    CreateUserTransaction() (*User, error)\n}\n\ntype TransactionSamples struct {\n    Db *sqlx.DB\n}\n\nfunc NewTransactionSamples(Db *sqlx.DB) ITransactionSamples {\n    return &amp;TransactionSamples{Db}\n}\n\nfunc (ts *TransactionSamples) CreateUserTransaction() (*User, error) {\n    tx := ts.Db.MustBegin()\n    var lastInsertId int\n    err := tx.QueryRowx(`INSERT INTO addresses (address_id, address_city, address_country, address_state) VALUES ($1, $2, $3, $4) RETURNING address_id`, 3, fake.City(), fake.Country(), fake.State()).Scan(&amp;lastInsertId)\n    if err != nil {\n        tx.Rollback()\n        return nil, errors.Wrap(err, \"insert address error\")\n    }\n    log.Println(\"lastInsertId: \", lastInsertId)\n\n    var user User\n    err = tx.QueryRowx(`INSERT INTO users (user_id, user_nme, user_email, user_address_id) VALUES ($1, $2, $3, $4) RETURNING *;`, 6, fake.UserName(), fake.EmailAddress(), lastInsertId).StructScan(&amp;user)\n    if err != nil {\n        tx.Rollback()\n        return nil, errors.Wrap(err, \"insert user error\")\n    }\n    err = tx.Commit()\n    if err != nil {\n        return nil, errors.Wrap(err, \"tx.Commit()\")\n    }\n    return &amp;user, nil\n}\n</code></pre>\n\n<p>Here is test result:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>\u2601  transaction [master] \u26a1  go test -v -count 1 ./...\n=== RUN   TestCreateUserTransaction\n2019/06/27 16:38:50 lastInsertId:  3\n--- PASS: TestCreateUserTransaction (0.01s)\n    transaction_test.go:28: &amp;transaction.User{UserID:6, UserNme:\"corrupti\", UserEmail:\"reiciendis_quam@Thoughtstorm.mil\", UserAddressId:sql.NullInt64{Int64:3, Valid:true}}\nPASS\nok      sqlx-samples/transaction        3.254s\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4677, "user_id": 1420332, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Xms75.png?s=128&g=1", "display_name": "Dmitry Harnitski", "link": "https://stackoverflow.com/users/1420332/dmitry-harnitski"}, "is_accepted": false, "score": 0, "last_activity_date": 1612455535, "last_edit_date": 1612455535, "creation_date": 1612454018, "answer_id": 66049124, "question_id": 40675365, "link": "https://stackoverflow.com/questions/40675365/get-back-newly-inserted-row-in-postgres-with-sqlx/66049124#66049124", "title": "Get back newly inserted row in Postgres with sqlx", "body": "<p>This is a sample code that works with named queries and strong type structures for inserted data and ID.</p>\n<p>Query and struct included to cover used syntax.</p>\n<pre><code>const query = `INSERT INTO checks (\n        start, status) VALUES (\n        :start, :status)\n        returning id;`\n\ntype Row struct {\n    Status string `db:&quot;status&quot;`\n    Start time.Time `db:&quot;start&quot;`\n}\n\nfunc InsertCheck(ctx context.Context, row Row, tx *sqlx.Tx) (int64, error) {\n    return insert(ctx, row, insertCheck, &quot;checks&quot;, tx)\n}\n\n\n// insert inserts row into table using query SQL command\n// table used only for loging, actual table name defined in query\n// should not be used from services directly - implement strong type wrappers\n// function expects query with named parameters\nfunc insert(ctx context.Context, row interface{}, query string, table string, tx *sqlx.Tx) (int64, error) {\n    // convert named query to native parameters format\n    query, args, err := tx.BindNamed(query, row)\n    if err != nil {\n        return 0, fmt.Errorf(&quot;cannot bind parameters for insert into %q: %w&quot;, table, err)\n    }\n\n    var id struct {\n        Val int64 `db:&quot;id&quot;`\n    }\n\n    err = sqlx.GetContext(ctx, tx, &amp;id, query, args...)\n    if err != nil {\n        return 0, fmt.Errorf(&quot;cannot insert into %q: %w&quot;, table, err)\n    }\n\n    return id.Val, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4673, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1612455535, "creation_date": 1479466741, "question_id": 40675365, "link": "https://stackoverflow.com/questions/40675365/get-back-newly-inserted-row-in-postgres-with-sqlx", "title": "Get back newly inserted row in Postgres with sqlx", "body": "<p>I use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"noreferrer\">https://github.com/jmoiron/sqlx</a> to make queries to Postgres.</p>\n\n<p>Is it possible to get back the whole row data when inserting a new row?</p>\n\n<p>Here is the query I run:</p>\n\n<pre><code>result, err := Db.Exec(\"INSERT INTO users (name) VALUES ($1)\", user.Name)\n</code></pre>\n\n<p>Or should I just use my existing <code>user</code> struct as the source of truth about the new entry in the database?</p>\n"}, {"tags": ["string", "go", "hashtable"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1479475072, "post_id": 40675029, "comment_id": 68585912, "body": "Is your question about Go&#39;s builtin map type or about cmap? For Go: Read the spec. If there is no limit on map key length (there isn&#39;t) then there is no limit. For cmap: Why not ask the author?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1479475278, "post_id": 40675029, "comment_id": 68586049, "body": "Btw: There are several gotchas in your code but non is related to map-key lengths."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1480309118, "post_id": 40675029, "comment_id": 68891965, "body": "because internally cmap uses map"}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 6640806, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10207119967343824/picture?type=large", "display_name": "Boris Le M&#233;ec", "link": "https://stackoverflow.com/users/6640806/boris-le-m%c3%a9ec"}, "is_accepted": true, "score": 9, "last_activity_date": 1479466542, "creation_date": 1479466542, "answer_id": 40675307, "question_id": 40675029, "link": "https://stackoverflow.com/questions/40675029/is-there-any-string-length-limit-in-golangs-string-map-key/40675307#40675307", "title": "Is there any string length limit in GoLang&#39;s string map key?", "body": "<p>I think the only limit is your memory.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5888393, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f2tgM.jpg?s=128&g=1", "display_name": "Rafi Mahmud", "link": "https://stackoverflow.com/users/5888393/rafi-mahmud"}, "is_accepted": false, "score": 2, "last_activity_date": 1616727330, "creation_date": 1616727330, "answer_id": 66810396, "question_id": 40675029, "link": "https://stackoverflow.com/questions/40675029/is-there-any-string-length-limit-in-golangs-string-map-key/66810396#66810396", "title": "Is there any string length limit in GoLang&#39;s string map key?", "body": "<p>According to the go document, <code>len()</code> function has to be compatible with <code>string</code> which is returning <code>int</code>. The int type is usually 32 bits wide on 32-bit systems and 64 bits wide on 64-bit systems.</p>\n<p>So, the range for signed <code>int</code> is <code>-2^(n -1) ~ 2^(n-1) -1</code>. Since length can't be negative, it should be <code>0 ~ 2^(n-1) -1</code></p>\n<p>Ref - <a href=\"https://golang.org/pkg/builtin/#len\" rel=\"nofollow noreferrer\">https://golang.org/pkg/builtin/#len</a></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9210, "favorite_count": 1, "accepted_answer_id": 40675307, "answer_count": 2, "score": 0, "last_activity_date": 1616736263, "creation_date": 1479465704, "last_edit_date": 1616736263, "question_id": 40675029, "link": "https://stackoverflow.com/questions/40675029/is-there-any-string-length-limit-in-golangs-string-map-key", "title": "Is there any string length limit in GoLang&#39;s string map key?", "body": "<p>Is there any maximum length of Go's string map key?\nActually I use <a href=\"https://github.com/OneOfOne/cmap\" rel=\"nofollow noreferrer\">https://github.com/OneOfOne/cmap</a> instead of Go's map.</p>\n<p>The question is, the key I use in that <code>cmap</code> is about 200-4000 characters in length, will it be a problem/gotchas?</p>\n<pre><code>import &quot;github.com/kokizzu/gotro/I&quot;\nimport &quot;sync/atomic&quot;\n\nvar CACHE_IDX int64\nvar CACHE_KEYS cmap.CMap\n\nfunc init() {\n    CACHE_KEYS = cmap.New()\n}\n\n// change a really long string to a shorter one \nfunc RamKey_ByQuery(query string) string {\n    nkey := CACHE_KEYS.Get(query)\n    if nkey != nil {\n        return nkey.(string)\n    }\n    new_idx := atomic.AddInt64(&amp;CACHE_IDX, 1)\n    ram_key := `:` + I.ToS(new_idx) // convert integer to string\n    CACHE_KEYS.Set(query, ram_key)\n    return ram_key\n}\n</code></pre>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 3254, "user_id": 2927601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06918d96014e4de287f37dc5ecba1b1?s=128&d=identicon&r=PG", "display_name": "Laily", "link": "https://stackoverflow.com/users/2927601/laily"}, "edited": false, "score": 1, "creation_date": 1479465861, "post_id": 40674920, "comment_id": 68580139, "body": "you should tell others what redis library you use. And also you can search about how to use it in &quot;godoc.com&quot;"}, {"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "reply_to_user": {"reputation": 3254, "user_id": 2927601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d06918d96014e4de287f37dc5ecba1b1?s=128&d=identicon&r=PG", "display_name": "Laily", "link": "https://stackoverflow.com/users/2927601/laily"}, "edited": false, "score": 0, "creation_date": 1479483697, "post_id": 40674920, "comment_id": 68591884, "body": "I use redigo library in my client side to connect with the redigo server..and i use like this c.Do(&quot;HMSET&quot;, ciphertext, 3200, datastruct).Here cipertext is the key,3200 is ttl,datastruct is the struc that contains the details of the token.But checking ttl for that key it shows -1...Appreciate any help.Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1479476071, "post_id": 40675136, "comment_id": 68586570, "body": "Thanks.the expiry time is set only when i set separately . But when i combine both in hset and when i check the ttl using the key it shows -1.May i know what went wrong here.I used something like this c.Do(&quot;HMSET&quot;, ciphertext, 3200, datastruct).For your info  datastruct is the token struct that have some fields in it.Thanks Appreciate any help..."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1479488768, "post_id": 40675136, "comment_id": 68595192, "body": "Setting it separately as two calls may be best if it&#39;s working for you. If you&#39;re not committed to the package you&#39;re using it might be worth it to check out this package <a href=\"https://github.com/keimoon/gore/wiki/Pipeline\" rel=\"nofollow noreferrer\">github.com/keimoon/gore/wiki/Pipeline</a>.. With the pipeline tool you can set up calls and run them in tandem. So set then expire."}, {"owner": {"reputation": 885, "user_id": 990212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4e9e0cbad55fb36be31c38b79562f0?s=128&d=identicon&r=PG", "display_name": "Yadvendar", "link": "https://stackoverflow.com/users/990212/yadvendar"}, "edited": false, "score": 0, "creation_date": 1479536685, "post_id": 40675136, "comment_id": 68609772, "body": "You need to set it separately only. As per Redis&#39;s official documentation it supports &quot;SETEX&quot; <a href=\"http://redis.io/commands/setex\" rel=\"nofollow noreferrer\">redis.io/commands/setex</a> - setting string data as value and expiry to a given key. It does not support any &quot;HMSETEX&quot; command, so I think you need to call that separately only."}], "tags": [], "owner": {"reputation": 885, "user_id": 990212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4e9e0cbad55fb36be31c38b79562f0?s=128&d=identicon&r=PG", "display_name": "Yadvendar", "link": "https://stackoverflow.com/users/990212/yadvendar"}, "is_accepted": true, "score": 5, "last_activity_date": 1479537003, "last_edit_date": 1479537003, "creation_date": 1479466032, "answer_id": 40675136, "question_id": 40674920, "link": "https://stackoverflow.com/questions/40674920/how-to-set-the-expiry-of-the-redis-keys-in-golang/40675136#40675136", "title": "how to set the expiry of the redis keys in golang", "body": "<p><a href=\"http://redis.io/commands/hmset\" rel=\"noreferrer\">Redis documentation</a> does not support a command like \"HMSETEX\".\n\"HMSET\" modifies the hashkeys and not the root key. TTL is supported at root key level and not at the hash key level. Hence, in your case you must be doing something like this in a separate call:</p>\n\n<pre><code>redisCon.Do(\"EXPIRE\", key, ttl)\n</code></pre>\n\n<p>Which client are you using to connect to redis?</p>\n\n<p>For redigo you can use this - <a href=\"https://github.com/yadvendar/redigo-wrapper\" rel=\"noreferrer\">https://github.com/yadvendar/redigo-wrapper</a>\nIn that use call</p>\n\n<pre><code>func Expire(RConn *redigo.Conn, key string, ttl int)\n</code></pre>\n\n<p>For goredis - <a href=\"https://godoc.org/gopkg.in/redis.v5#Client.TTL\" rel=\"noreferrer\">https://godoc.org/gopkg.in/redis.v5#Client.TTL</a>\nIn this use:</p>\n\n<pre><code>func (c *Client) TTL(key string) *DurationCmd\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58753, "user_id": 33522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/3MBg6.png?s=128&g=1", "display_name": "chovy", "link": "https://stackoverflow.com/users/33522/chovy"}, "edited": false, "score": 0, "creation_date": 1614986038, "post_id": 61596805, "comment_id": 117562058, "body": "it says invalid time expiration"}, {"owner": {"reputation": 24435, "user_id": 3191896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVtnn.png?s=128&g=1", "display_name": "Jossef Harush", "link": "https://stackoverflow.com/users/3191896/jossef-harush"}, "reply_to_user": {"reputation": 58753, "user_id": 33522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/3MBg6.png?s=128&g=1", "display_name": "chovy", "link": "https://stackoverflow.com/users/33522/chovy"}, "edited": false, "score": 0, "creation_date": 1615112835, "post_id": 61596805, "comment_id": 117586091, "body": "@chovy which redis version are you using? is this the exact error you got &quot;invalid time expiration&quot;? what&#39;s the value in seconds you tried to set?"}, {"owner": {"reputation": 58753, "user_id": 33522, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/3MBg6.png?s=128&g=1", "display_name": "chovy", "link": "https://stackoverflow.com/users/33522/chovy"}, "edited": false, "score": 0, "creation_date": 1615199115, "post_id": 61596805, "comment_id": 117608124, "body": "I wasn&#39;t using <code>time.Hour</code> i guess that&#39;s required. I was just passing <code>86400</code> and i guess that&#39;s nanoseconds too so it was expiring right away."}], "tags": [], "owner": {"reputation": 24435, "user_id": 3191896, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qVtnn.png?s=128&g=1", "display_name": "Jossef Harush", "link": "https://stackoverflow.com/users/3191896/jossef-harush"}, "is_accepted": false, "score": 3, "last_activity_date": 1588609058, "creation_date": 1588609058, "answer_id": 61596805, "question_id": 40674920, "link": "https://stackoverflow.com/questions/40674920/how-to-set-the-expiry-of-the-redis-keys-in-golang/61596805#61596805", "title": "how to set the expiry of the redis keys in golang", "body": "<p>For those who use <code>go-redis</code> library, you can set expiration by calling </p>\n\n<pre><code>_, err = redisClient.Expire(\"my:redis:key\", 1 * time.Hour).Result()\n</code></pre>\n\n<p>Alternatively, you can do that upon insertion</p>\n\n<pre><code>_, err = redisClient.Set(\"my:redis:key\", \"value\", 1 * time.Hour).Result()\n</code></pre>\n"}], "owner": {"reputation": 156, "user_id": 7160458, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ebe17787e8e4aa63793d78924da1ed6e?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/7160458/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14235, "favorite_count": 0, "accepted_answer_id": 40675136, "answer_count": 2, "score": 6, "last_activity_date": 1588609058, "creation_date": 1479465400, "last_edit_date": 1479466988, "question_id": 40674920, "link": "https://stackoverflow.com/questions/40674920/how-to-set-the-expiry-of-the-redis-keys-in-golang", "title": "how to set the expiry of the redis keys in golang", "body": "<p>I am using golang as my backend.I am storing some token values in redis.I m setting the values HSET and getting the values in HGETALL.I would like to know if there is any function to set the expiry for the keys that i m storing in the redis database.i want the token and its data to be deleted after 1hour. I m using Redigo package for redis. Thanks.Appreciate any help.</p>\n\n<pre><code>I use this to set the struct with has token as key    \nredisCon.Do(\"HMSET\", redis.Args{}.Add(hashToken).AddFlat(&amp;dataStruct)...)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1479481825, "last_edit_date": 1479481825, "creation_date": 1479481137, "answer_id": 40680142, "question_id": 40674759, "link": "https://stackoverflow.com/questions/40674759/behavior-change-of-gzip-reader-in-golang-1-7-3-compared-to-1-6-3/40680142#40680142", "title": "Behavior change of gzip Reader in golang 1.7.3 (compared to 1.6.3)", "body": "<p>What you're seeing is the correct behavior. The old behavior of the gzip.Reader was a side effect of it being able to return a final read without <code>io.EOF</code>, then <code>(0, io.EOF)</code> in a subsequent call. Now that it properly waits for <code>io.EOF</code>, it will block waiting for the next gzip header or <code>io.EOF</code>.</p>\n\n<p>If you don't expect more files, and you want to have the gzip trailer indicate the end of the file regardless of <code>io.EOF</code>, you have to set <a href=\"https://golang.org/pkg/compress/gzip/#Reader.Multistream\" rel=\"nofollow noreferrer\"><code>Reader.Multistream(false)</code></a>.</p>\n\n<p>Your example works with that addition:</p>\n\n<pre><code>func readFrom(pipeReader *io.PipeReader) {\n    // decompress and unmarshall\n    gzipIn, err := gzip.NewReader(pipeReader)\n    if err != nil {\n        fmt.Printf(\"Error creating reader: %s\\n\", err)\n        return\n    }\n    gzipIn.Multistream(false)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BdaulxMza0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BdaulxMza0</a></p>\n"}], "owner": {"reputation": 267, "user_id": 5287253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-GN_S1OP65cw/AAAAAAAAAAI/AAAAAAAAP0M/SJF9jPLf-C0/photo.jpg?sz=128", "display_name": "Sascha Trifunovic", "link": "https://stackoverflow.com/users/5287253/sascha-trifunovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 40680142, "answer_count": 1, "score": 3, "last_activity_date": 1479481825, "creation_date": 1479465047, "question_id": 40674759, "link": "https://stackoverflow.com/questions/40674759/behavior-change-of-gzip-reader-in-golang-1-7-3-compared-to-1-6-3", "title": "Behavior change of gzip Reader in golang 1.7.3 (compared to 1.6.3)", "body": "<p>I have a program that reads gzip compressed json packets from a network connection. The sender does not close the connection after sending the gzip packet. In <code>go1.6.3</code> this works perfectly, i.e., the gzip packet is decoded after the gzip end-sequence is received, but in <code>go1.7.3</code> the reader blocks as there is no <code>io.EOF</code>.</p>\n\n<p>Here is a sample that simulates the network connection using a pipe (note that the writer stays open to simulate the open connection):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n    \"compress/gzip\"\n    \"io\"\n    \"runtime\"\n)\n\ntype TestJSON struct {\n  TestString string `json:\"test\"`\n}\n\nfunc main() {\n    fmt.Printf(\"Version: %s\\n\", runtime.Version())\n    pipeReader, pipeWriter := io.Pipe();\n\n    go writeTo(pipeWriter);\n    readFrom(pipeReader);\n}\n\nfunc writeTo(pipeWriter *io.PipeWriter){\n    // marshall and compress\n    testJSON := TestJSON{TestString: \"test\",}\n\n    jsonString, err := json.Marshal(testJSON)\n    if err != nil {\n      fmt.Printf(\"Marshalling Error: %s\\n\", err)\n      return\n    }\n\n    gzipOut := gzip.NewWriter(pipeWriter)\n    _, err = gzipOut.Write(jsonString)\n    if err != nil {\n      fmt.Printf(\"Error Writing: %s\\n\", err)\n      return\n    }\n    gzipOut.Close()\n    //pipeWriter.Close()\n}\n\nfunc readFrom(pipeReader *io.PipeReader){\n    // decompress and unmarshall\n    gzipIn, err := gzip.NewReader(pipeReader)\n    if err != nil {\n      fmt.Printf(\"Error creating reader: %s\\n\", err)\n      return\n    }\n    defer gzipIn.Close()\n\n    jsonDecoder := json.NewDecoder(gzipIn)\n    msg := new(TestJSON)\n    err = jsonDecoder.Decode(msg)\n    if err != nil {\n      fmt.Printf(\"Error decoding: %s\\n\", err)\n      return\n    }\n    fmt.Printf(\"Recived: %v\\n\", msg)\n}\n</code></pre>\n\n<p>Based on this situation I have 2 questions:</p>\n\n<ol>\n<li>Which is the correct behavior?</li>\n<li>If <code>go1.7.3</code> behaves correctly, how can I decode incoming gzip packets on an open network connection?</li>\n</ol>\n"}, {"tags": ["go", "photon", "gvm", "photon-os"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1479471275, "post_id": 40672786, "comment_id": 68583499, "body": "A <code>$PATH</code> issue? I mean, the <code>gvm</code> command is not listed in the <code>PATH</code> environment variable of the account which tried to access it. Say, for non-root users, <code>&#47;sbin</code> and <code>&#47;usr&#47;sbin</code> are typically <i>not</i> listed there. Since I have absolutely zero knowledge about what &quot;PhotonOS&quot; is, I can&#39;t really verify this -- make your research."}, {"owner": {"reputation": 422, "user_id": 2653036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YHTKp.jpg?s=128&g=1", "display_name": "Anahit Serobyan", "link": "https://stackoverflow.com/users/2653036/anahit-serobyan"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1479475575, "post_id": 40672786, "comment_id": 68586242, "body": "Thanks for comment, I&#39;ll try to add gvm to $PATH."}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 2653036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YHTKp.jpg?s=128&g=1", "display_name": "Anahit Serobyan", "link": "https://stackoverflow.com/users/2653036/anahit-serobyan"}, "edited": false, "score": 0, "creation_date": 1483654757, "post_id": 41465363, "comment_id": 70197645, "body": "Thanks a lot for answer, will try it."}], "tags": [], "owner": {"reputation": 1, "user_id": 7374486, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/7ce55dd8f394f6026f12917f305600dd?s=128&d=identicon&r=PG", "display_name": "djakubowicz", "link": "https://stackoverflow.com/users/7374486/djakubowicz"}, "is_accepted": false, "score": 0, "last_activity_date": 1483541909, "last_edit_date": 1483541909, "creation_date": 1483537613, "answer_id": 41465363, "question_id": 40672786, "link": "https://stackoverflow.com/questions/40672786/unable-to-change-go-version-in-photonos/41465363#41465363", "title": "Unable to change GO version in PhotonOS", "body": "<p>use : </p>\n\n<pre><code>docker run -v $(pwd):/go/src/github.com/vmware/vic \\-w /go/src/github.com/vmware/vic golang:1.7 make all\n</code></pre>\n\n<p>command instead, that will work on PhotonOS</p>\n"}], "owner": {"reputation": 422, "user_id": 2653036, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YHTKp.jpg?s=128&g=1", "display_name": "Anahit Serobyan", "link": "https://stackoverflow.com/users/2653036/anahit-serobyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483541909, "creation_date": 1479459023, "last_edit_date": 1592644375, "question_id": 40672786, "link": "https://stackoverflow.com/questions/40672786/unable-to-change-go-version-in-photonos", "title": "Unable to change GO version in PhotonOS", "body": "<p>I have deployed PhotonOS using directions from <a href=\"http://cormachogan.com/2016/04/07/getting-started-photon-os-vsphere-integrated-containers/\" rel=\"nofollow noreferrer\">photon and VIC configuration</a>, while running command <code>docker run -v $(pwd):/go/src/github.com/vmware/vic \\-w /go/src/github.com/vmware/vic golang:1.6 make all </code>\nan Error appears:</p>\n<blockquote>\n<p>Please install go1.7 (found: go version go1.6.3 linux/amd64)</p>\n<p>Makefile:152: recipe for target 'goversion' failed</p>\n<p>make: *** [goversion] Error 1</p>\n</blockquote>\n<p>`\nto solve it I have tried to update</p>\n<blockquote>\n<p>go1.6.3 to go1.7 using solution - <a href=\"https://stackoverflow.com/a/34384978/2653036\">changeing go version manually</a></p>\n</blockquote>\n<p>after steps go version is showing go1.4.2, but the previous error still complains on go version 1.6.3.\nAlso, I have tried to install &quot;gvm&quot; using <code>bash &lt; &lt;(curl -s -S -L https://raw.github.com/moovweb/gvm/master/binscripts/gvm-installer)</code> , whenever I try to call <code>gvm install go1.7</code> it brings</p>\n<blockquote>\n<p>-bash: gvm: command not found</p>\n</blockquote>\n<p>whenever I retry running <code>gvm-installer</code> it says</p>\n<blockquote>\n<p>ERROR: Already installed!</p>\n</blockquote>\n<p>Any help is highly appreciated!!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1479459818, "post_id": 40671429, "comment_id": 68576055, "body": "<code>Unix</code> is a function and you are printing the function (i.e. its address), not the value <code>Unix</code>would produce if you would invoke the function as in <code>Unix()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "edited": false, "score": 0, "creation_date": 1479454153, "post_id": 40671553, "comment_id": 68573295, "body": "Aaah. I missed the &quot;()&quot; after Unix. So lame! Thanks anyway."}], "tags": [], "owner": {"reputation": 24723, "user_id": 3150943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06074c6f020f2509f0b51a2c0ad3a9a8?s=128&d=identicon&r=PG", "display_name": "nu11p01n73R", "link": "https://stackoverflow.com/users/3150943/nu11p01n73r"}, "is_accepted": true, "score": 1, "last_activity_date": 1479454156, "last_edit_date": 1479454156, "creation_date": 1479453958, "answer_id": 40671553, "question_id": 40671429, "link": "https://stackoverflow.com/questions/40671429/time-getting-printed-as-0x814ff30/40671553#40671553", "title": "Time getting printed as &#39;0x814ff30&#39;", "body": "<p>Use <a href=\"https://golang.org/pkg/time/#Time.Unix\" rel=\"nofollow noreferrer\"><code>time.Unix()</code></a> function</p>\n\n<pre><code>fmt.Println(time.Now().Unix())\n//1479454089\n</code></pre>\n"}], "owner": {"reputation": 2411, "user_id": 2037570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5fa24420cee32bd1d97e2fd3a61de37f?s=128&d=identicon&r=PG", "display_name": "Hemant Bhargava", "link": "https://stackoverflow.com/users/2037570/hemant-bhargava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40671553, "answer_count": 1, "score": -2, "last_activity_date": 1479454156, "creation_date": 1479453446, "question_id": 40671429, "link": "https://stackoverflow.com/questions/40671429/time-getting-printed-as-0x814ff30", "title": "Time getting printed as &#39;0x814ff30&#39;", "body": "<p>Learning go lang. Might be a basic question.</p>\n\n<p>I have an time.Time object and I wanted to get the epoch time for it. What I write to get that is :</p>\n\n<pre><code>fmt.Println(startTime.Unix)\n</code></pre>\n\n<p>where startTime is an object of time.Time. Now, I would have expected it to print some big number, something as, 1257894000, but what I get is : <strong>0x814ff30</strong>.</p>\n\n<p>Did not understand why? Would be happy to write more in case it is not clear.</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "owner": {"reputation": 11, "user_id": 7016629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3f5fd947edcb3b62def3e76c7cef3fd?s=128&d=identicon&r=PG&f=1", "display_name": "kodama", "link": "https://stackoverflow.com/users/7016629/kodama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 464, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1479455698, "creation_date": 1479452620, "last_edit_date": 1479455698, "question_id": 40671189, "link": "https://stackoverflow.com/questions/40671189/how-to-run-tests-using-gorm-with-mysql-in-golang", "title": "How to run tests using gorm with mysql in golang?", "body": "<p>I'm puzzled.\nI try to run test cases using gorm with mysql in golang and I wanna buile MySQL just for testing, but it does not run safely.</p>\n\n<p>I wanna use this package <a href=\"https://github.com/lestrrat/go-test-mysqld\" rel=\"nofollow noreferrer\">go-test-mysqld</a></p>\n\n<p>Error message is below.<br />\n<code>panic: sql: Register called twice for driver mysql</code></p>\n\n<p>My code is</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    mysqld, err := mysqltest.NewMysqld(nil)\n    if err != nil {\n        log.Fatal(\"runTests: failed\", err)\n    }\n\n    defer mysqld.Stop()\n    dbm, err = gorm.Open(\"mysqld\", mysqld.Datasource(\"test\", \"\", \"\", 0 ))\n    if err != nil {\n        log.Fatal(\"db connection error:\", err)\n    }\n\n    defer dbm.Close()\n    code := m.Run()\n    os.Exit(code)\n}\n</code></pre>\n\n<p>What is the problems in my code?\nOr is it impossible to build another mysql in using gorm?</p>\n\n<p>Do you have some ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1479449827, "post_id": 40670228, "comment_id": 68571299, "body": "Check the error returned from <code>Output</code>.  Also, use <code>fmt.Printf(&quot;%s\\n&quot;, output)</code> to view the output as text."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 3386584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fedd018b3227bc4043934309da8c290?s=128&d=identicon&r=PG", "display_name": "duguying", "link": "https://stackoverflow.com/users/3386584/duguying"}, "is_accepted": false, "score": 8, "last_activity_date": 1479452078, "last_edit_date": 1479452078, "creation_date": 1479450335, "answer_id": 40670623, "question_id": 40670228, "link": "https://stackoverflow.com/questions/40670228/how-to-run-binary-files-inside-golang-program/40670623#40670623", "title": "How to run Binary Files inside GoLang Program?", "body": "<p>I can get the output.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    output, err := exec.Command(\"/Users/duguying/gopath/bin/test\").Output()\n    if err!=nil {\n        fmt.Println(err.Error())\n    }\n    fmt.Println(string(output))\n}\n</code></pre>\n\n<p>check you binary file first or binary filepath is correcting. try to print out your error message.</p>\n"}, {"comments": [{"owner": {"reputation": 698, "user_id": 1592192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bc215a04d36243c6ad4ed50fbfe2b13?s=128&d=identicon&r=PG", "display_name": "Mir Adnan", "link": "https://stackoverflow.com/users/1592192/mir-adnan"}, "edited": false, "score": 0, "creation_date": 1518222812, "post_id": 43336359, "comment_id": 84431286, "body": "Is there a better way to this? This would run as a separate job. Running it under goroutines makes it even bad. More jobs running at the same time, which will eventually use all server resources."}, {"owner": {"reputation": 856, "user_id": 2992539, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/HyA49.png?s=128&g=1", "display_name": "Somnium", "link": "https://stackoverflow.com/users/2992539/somnium"}, "edited": false, "score": 0, "creation_date": 1564389101, "post_id": 43336359, "comment_id": 100999967, "body": "For me, on Windows, <code>exec</code> only works with full path to executable. E.g. <code>.&#47;test.bat</code> doesn&#39;t work."}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 1, "last_activity_date": 1542890235, "last_edit_date": 1542890235, "creation_date": 1491882149, "answer_id": 43336359, "question_id": 40670228, "link": "https://stackoverflow.com/questions/40670228/how-to-run-binary-files-inside-golang-program/43336359#43336359", "title": "How to run Binary Files inside GoLang Program?", "body": "<p>When I'm looking at the source of the <code>exec.Command()</code> it doesnt return an error but only returns <code>Cmd</code> which is struct in the package <code>exe</code>  :\n<a href=\"https://golang.org/src/os/exec/exec.go#L129\" rel=\"nofollow noreferrer\">source</a></p>\n\n<pre><code>....\n\nfunc Command(name string, arg ...string) *Cmd {\n    cmd := &amp;Cmd{\n        Path: name,\n        Args: append([]string{name}, arg...),\n    }\n    if filepath.Base(name) == name {\n        if lp, err := LookPath(name); err != nil {\n            cmd.lookPathErr = err\n        } else {\n            cmd.Path = lp\n        }\n    }\n    return cmd\n}\n\n....\n</code></pre>\n\n<p>I have succesfully got the binary file running using this code : </p>\n\n<pre><code>package main\n\nimport (\n\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    command:= exec.Command(\"Your binary file path\")\n\n    // set var to get the output\n    var out bytes.Buffer\n\n     // set the output to our variable\n     command.Stdout = &amp;out\n     err = command.Run()\n     if err != nil {\n         log.Println(err)\n     }\n\n    fmt.Println(out.String())\n}\n</code></pre>\n\n<p>This one works for me for running a binary file that will print some random string.</p>\n"}], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10104, "favorite_count": 0, "accepted_answer_id": 43336359, "answer_count": 2, "score": 5, "last_activity_date": 1542890235, "creation_date": 1479448421, "question_id": 40670228, "link": "https://stackoverflow.com/questions/40670228/how-to-run-binary-files-inside-golang-program", "title": "How to run Binary Files inside GoLang Program?", "body": "<p>I want to execute Binary Files inside GoLang Program.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os/exec\"\n)\n\nfunc main() {\n    output, _ := exec.Command(\"/home/user/Golang/bin/hello\").Output()\n    fmt.Println(output)\n}\n</code></pre>\n\n<p>But I get the output as: []</p>\n\n<p>Thanks in advance.</p>\n"}]