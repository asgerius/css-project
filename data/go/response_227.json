[{"tags": ["javascript", "html", "go", "redirect"], "comments": [{"owner": {"reputation": 978, "user_id": 3987870, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/085666bc4cd656478bb2f8237be2a457?s=128&d=identicon&r=PG&f=1", "display_name": "Nosajimiki", "link": "https://stackoverflow.com/users/3987870/nosajimiki"}, "edited": false, "score": 0, "creation_date": 1557955880, "post_id": 56157621, "comment_id": 98944753, "body": "I don&#39;t know Go, but the general solution for this problem is that HTML Forms just are designed to go to a new page when you submit.  If you replace your submit button with one that triggers a JS function, you could use that function to collect the values of your form and then AJAX them to a backend script. Your backend script can both validate it and save it to your DB. Then it and returns a response to your page to let it know if you succeeded or failed validation.  That response is then loaded into a placeholder as innerHTML without a full page reload."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557956303, "post_id": 56157621, "comment_id": 98944881, "body": "What happens if you move e.preventDefault below all of your validation and execute it only if the validation failed? E.g. <code>if (form.isNotValid()) { e.preventDefault() }</code>"}, {"owner": {"reputation": 63, "user_id": 11506423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7sRjBNOTwx4/AAAAAAAAAAI/AAAAAAAAAAQ/Pph68ncuN0s/photo.jpg?sz=128", "display_name": "Jake Goldstein", "link": "https://stackoverflow.com/users/11506423/jake-goldstein"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557960882, "post_id": 56157621, "comment_id": 98945993, "body": "@mkopriva the issue is more that I want to validate everything again on the backend before I just throw everything into a database and redirect the user instantly. I think your solution would still kind of be validation on the front end which is not an issue. The form wont submit if the user doesn&#39;t have a valid email, matching password ect..."}, {"owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1557989831, "post_id": 56157621, "comment_id": 98952533, "body": "@JakeGoldstein Hi, my question is can you do some sort of front end validations byusing the jquery form validator.I think it will work fine in your case. <a href=\"http://www.formvalidator.net/\" rel=\"nofollow noreferrer\">formvalidator.net</a>"}, {"owner": {"reputation": 63, "user_id": 11506423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7sRjBNOTwx4/AAAAAAAAAAI/AAAAAAAAAAQ/Pph68ncuN0s/photo.jpg?sz=128", "display_name": "Jake Goldstein", "link": "https://stackoverflow.com/users/11506423/jake-goldstein"}, "reply_to_user": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "edited": false, "score": 0, "creation_date": 1558044059, "post_id": 56157621, "comment_id": 98980721, "body": "@ASHWINRAJEEV how so? we are doing form validation on the front end but even so I still want to ensure on the back end before I send things off to a database or redirect the user. The main issue here is the use of the e.preventDefault() in the javascript because once I comment that line out the form makes the post request. Except I kind of need that javascript because it allows for a smooth validation on the front end except it blocks the POST request from happening. I know this because I tried to handle different methods within my signupHandler and I would only be able to see the GET."}], "owner": {"reputation": 63, "user_id": 11506423, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7sRjBNOTwx4/AAAAAAAAAAI/AAAAAAAAAAQ/Pph68ncuN0s/photo.jpg?sz=128", "display_name": "Jake Goldstein", "link": "https://stackoverflow.com/users/11506423/jake-goldstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1557954337, "creation_date": 1557954337, "question_id": 56157621, "link": "https://stackoverflow.com/questions/56157621/how-do-i-collect-form-data-and-add-it-to-a-database-only-redirecting-on-success", "title": "How do I collect form data and add it to a database only redirecting on success?", "body": "<p>I am setting up routing and a database for my API and I am having issues linking my front end logic with my backend logic. Essentially I want to POST form data and check all of it in the backend and redirect to a new page if it is successful. </p>\n\n<p>I have tried using e.preventDefault() in the front end except that stops the POST request from going to the backend regardless of success of not.</p>\n\n<p>Here are my Request handlers in my main function:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>http.HandleFunc(\"/signup\", signupHandler)\nhttp.HandleFunc(\"/registered\", registeredHandler)\n</code></pre>\n\n<p>Here is the actual handler functions:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func signupHandler(w http.ResponseWriter, r *http.Request) {\n    tpl.ExecuteTemplate(w, \"signup.html\", nil)\n\n    fmt.Printf(\"METHOD: %s | URL: %v\\n\", r.Method, r.URL)\n    fmt.Printf(\"User Visting Signup Form\\n\")\n}\n\nfunc registeredHandler(w http.ResponseWriter, r *http.Request) {\n    tpl.ExecuteTemplate(w, \"login.html\", nil)\n    fmt.Printf(\"METHOD: %s | URL: %v\\n\", r.Method, r.URL)\n    r.ParseForm()\n    f := r.PostFormValue(\"fname\")\n    l := r.PostFormValue(\"lname\")\n    e := r.PostFormValue(\"email\")\n    pw := r.PostFormValue(\"pass\")\n\n    hash, err := helper.HashPassword(pw) // returns byte slice use conversion\n    if err != nil {\n        fmt.Printf(\"Hashing Error\")\n    }\n\n    fmt.Println(\"LoginValues\")\n    fmt.Printf(\"%s\\n, %s\\n, %s\\n, %s\\n\", f, l, e, hash)\n}\n</code></pre>\n\n<p>HTML signup form signup.html (localhost:8080/signup):</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n   &lt;meta charset=\"UTF-8\"&gt;\n   &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;\n   &lt;meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\"&gt;\n   &lt;link rel=\"stylesheet\" href=\"../static/css/signup-styles.css\"&gt;\n   &lt;link rel=\"icon\" href=\"../static/img/favicon.ico\" type=\"image/x-icon\"/&gt;\n   &lt;title&gt;Register&lt;/title&gt;\n\n   &lt;div class=\"container\"&gt;\n\n      &lt;img src=\"../static/img/logo.png\" alt=\"logo\"&gt;\n\n      &lt;form action=\"/registered\" method=\"post\"&gt;\n         &lt;h3&gt;First Name&lt;/h3&gt;\n         &lt;input name=\"fname\" type=\"text\" class=\"firstName\"&gt;\n         &lt;p class=\"firstNameError\"&gt;&lt;/p&gt;\n         &lt;h3&gt;Last Name&lt;/h3&gt;\n         &lt;input name=\"lname\" type=\"text\" class=\"lastName\"&gt;\n         &lt;p class=\"lastNameError\"&gt;&lt;/p&gt;\n         &lt;h3&gt;Email&lt;/h3&gt;\n         &lt;input name=\"email\" type=\"text\" class=\"email\"&gt;\n         &lt;p class=\"emailError\"&gt;&lt;/p&gt;\n         &lt;h3&gt;Create Password&lt;/h3&gt;\n         &lt;input name=\"pass\" type=\"password\" class=\"createPassword\"&gt;\n         &lt;p class=\"createPasswordError\"&gt;&lt;/p&gt;\n         &lt;h3&gt;Verify Password&lt;/h3&gt;\n         &lt;input type=\"password\" class=\"verifyPassword\"&gt;\n         &lt;p class=\"verifyPasswordError\"&gt;&lt;/p&gt;\n         &lt;button class=\"btn\" type=\"submit\"&gt;Register&lt;/button&gt;\n      &lt;/form&gt;\n\n   &lt;/div&gt;\n\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;script src=\"../static/js/signup.js\"&gt;&lt;/script&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>front end javascript logic:</p>\n\n<pre><code>btn.addEventListener('click', function(e) {\n\n    e.preventDefault()\n    if (/^\\s+$/.test(firstName) || firstName == null || firstName == '') {\n        document.querySelector('.firstNameError').innerHTML = 'First Name is a required field'\n        document.querySelector('.firstName').style.borderBottom = '1px solid red'\n    // There a ton more if/else doing front end form validation\n    ...\n}\n</code></pre>\n\n<p>I would've assumed the post request still would've worked since I had a handler for that route, except the e.preventDefault() completely stops the post from happening. I have taken away the preventDefault and the post request works fine but the issue is even if the form is NOT valid on the front end the form will still post.</p>\n"}, {"tags": ["go", "hyperledger-fabric", "glide-golang"], "answers": [{"tags": [], "owner": {"reputation": 430, "user_id": 11352925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f73f694f6a5663aa1b97e893bfc095c?s=128&d=identicon&r=PG&f=1", "display_name": "lindluni", "link": "https://stackoverflow.com/users/11352925/lindluni"}, "is_accepted": false, "score": 0, "last_activity_date": 1558346420, "creation_date": 1558346420, "answer_id": 56218543, "question_id": 56154424, "link": "https://stackoverflow.com/questions/56154424/cant-find-attrmgr-from-goroot-and-gopath/56218543#56218543", "title": "can&#39;t find attrmgr (from $GOROOT) and $GOPATH?", "body": "<p>Install the fabric dependency in your GOPATH, <code>go get -u github.com/hyperledger/fabric</code></p>\n"}], "owner": {"reputation": 11, "user_id": 4389618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12ae26885c9053e8b1c5e0c0d217531b?s=128&d=identicon&r=PG&f=1", "display_name": "Amy Lee", "link": "https://stackoverflow.com/users/4389618/amy-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 262, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1558346420, "creation_date": 1557940007, "question_id": 56154424, "link": "https://stackoverflow.com/questions/56154424/cant-find-attrmgr-from-goroot-and-gopath", "title": "can&#39;t find attrmgr (from $GOROOT) and $GOPATH?", "body": "<p>I am trying to install chaincode. I used cid package inside my chaincode When I try to install chaincode, I got the following error:\ncannot load package: </p>\n\n<pre><code>package github.com/hyperledger/fabric/core/chaincode/lib/cid: cannot find package \"github.com/hyperledger/fabric/core/chaincode/lib/cid\" in any of:\n/opt/go/src/github.com/hyperledger/fabric/core/chaincode/lib/cid (from $GOROOT)\n/opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/lib/cid (from $GOPATH)\n</code></pre>\n\n<p>I have used glide tool( here <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow noreferrer\">https://github.com/Masterminds/glide</a>) to fix it,\nnow i see another error that I couldn't fix which is:</p>\n\n<pre><code>Error: could not assemble transaction, err proposal response was not successful, error code 500, msg error starting container: error starting container: Failed to generate platform-specific docker build: Error returned from build: 1 \"chaincode/input/src/github.com/chaincode/vendor/github.com/hyperledger/fabric/core/chaincode/lib/cid/cid.go:29:2: cannot find package \"github.com/hyperledger/fabric/common/attrmgr\" in any of:\n    /chaincode/input/src/github.com/chaincode/vendor/github.com/hyperledger/fabric/vendor/github.com/hyperledger/fabric/common/attrmgr (vendor tree)\n    /chaincode/input/src/github.com/chaincode/vendor/github.com/hyperledger/fabric/common/attrmgr\n    /opt/go/src/github.com/hyperledger/fabric/common/attrmgr (from $GOROOT)\n    /chaincode/input/src/github.com/hyperledger/fabric/common/attrmgr (from $GOPATH)\n    /opt/gopath/src/github.com/hyperledger/fabric/common/attrmgr\n</code></pre>\n\n<p>Any suggestion\u061f</p>\n"}, {"tags": ["go", "travis-ci", "cross-compiling"], "answers": [{"tags": [], "owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "is_accepted": false, "score": 0, "last_activity_date": 1557934998, "creation_date": 1557934998, "answer_id": 56153176, "question_id": 56153175, "link": "https://stackoverflow.com/questions/56153175/how-to-cross-compile-a-go-project-from-linux-to-windows-on-travis-ci/56153176#56153176", "title": "How to cross-compile a Go project from Linux to Windows on Travis-CI", "body": "<p>This builds natively for Linux, natively for OSX, and cross compiles for windows, as part of the linux build:</p>\n\n<p><code>.travis.yml</code>:</p>\n\n<pre><code>language: go\nsudo: false\n\nmatrix:\n  include:\n    - go: tip\n      os: linux\n      env: CROSS_COMPILE=true\n    - go: tip\n      os: osx\n\nbefore_install:\n  - if [ \"$CROSS_COMPILE\" = \"true\" ]; then sudo apt update; fi\n\ninstall:\n  - if [ \"$CROSS_COMPILE\" = \"true\" ]; then sudo apt install gcc-mingw-w64 libc6-dev-i386; fi\n  - go get github.com/some/go-dependency\n  - go get -t -v ./...\n\nscript:\n  - go build\n  - go test\n  - if [ \"$TRAVIS_OS_NAME\" = \"linux\" -a \"$CROSS_COMPILE\" = \"true\" ]; then env CGO_ENABLED=1 GOOS=windows GOARCH=amd64 CC=x86_64-w64-mingw32-gcc go build -v; fi\n</code></pre>\n"}], "owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557934998, "creation_date": 1557934998, "question_id": 56153175, "link": "https://stackoverflow.com/questions/56153175/how-to-cross-compile-a-go-project-from-linux-to-windows-on-travis-ci", "title": "How to cross-compile a Go project from Linux to Windows on Travis-CI", "body": "<p>Because Travis-CI native windows support for Go seems to be lacking,\nI though about going this route.</p>\n\n<p>How would I best do that?</p>\n"}, {"tags": ["go", "google-cloud-functions", "google-cloud-pubsub"], "comments": [{"owner": {"reputation": 36140, "user_id": 6463558, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/g22sX.jpg?s=128&g=1", "display_name": "slideshowp2", "link": "https://stackoverflow.com/users/6463558/slideshowp2"}, "edited": false, "score": 0, "creation_date": 1562141009, "post_id": 56152806, "comment_id": 100280000, "body": "Is there a documentation about the <code>Function-Execution-Id</code> request header? I didn&#39;t find any documentation about it after searching a lot."}], "answers": [{"comments": [{"owner": {"reputation": 6111, "user_id": 7804058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BuRRt.png?s=128&g=1", "display_name": "norbjd", "link": "https://stackoverflow.com/users/7804058/norbjd"}, "edited": false, "score": 1, "creation_date": 1557993802, "post_id": 56157415, "comment_id": 98954655, "body": "Thanks for your answer. However, <code>EventID</code> is different from the execution ID of the Cloud Function, as we can see in Stackdriver (label <code>execution_id</code> of any log entry). This is this particular execution ID that I try to retrieve (the same contained in <code>Function-Execution-Id</code> header in HTTP functions). Is it really not possible in PubSub triggered functions?"}, {"owner": {"reputation": 705, "user_id": 11494461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d59162f0714c8b18529f3464bd35f75?s=128&d=identicon&r=PG", "display_name": "Lauren", "link": "https://stackoverflow.com/users/11494461/lauren"}, "reply_to_user": {"reputation": 6111, "user_id": 7804058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BuRRt.png?s=128&g=1", "display_name": "norbjd", "link": "https://stackoverflow.com/users/7804058/norbjd"}, "edited": false, "score": 0, "creation_date": 1558109647, "post_id": 56157415, "comment_id": 99005191, "body": "You&#39;re correct, Pub/Sub-triggered events do actually have <code>execution_id</code> labels in the log entries. Note that the Pub/Sub-triggered event <code>execution_id</code> is a different format than the HTTP-request-triggered <code>execution_id</code>. The <code>EventID</code> in the context metadata matches the <code>execution_id</code> label."}, {"owner": {"reputation": 6111, "user_id": 7804058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BuRRt.png?s=128&g=1", "display_name": "norbjd", "link": "https://stackoverflow.com/users/7804058/norbjd"}, "edited": false, "score": 1, "creation_date": 1558121655, "post_id": 56157415, "comment_id": 99009735, "body": "<code>EventID</code> is different from the <code>execution_id</code> label in Stackdriver logs, I&#39;ve checked it with the exact code you added, and tested it by sending a PubSub event from the <i>Testing</i> tab in the Console. They do not have the same format : <code>EventID</code> is an UUID, while <code>execution_id</code> on Stackdriver logs (in <code>labels</code> field of the log entry) is a string of alphanumeric characters (12 characters in my case, but it seems to vary from one project to another). Anyway, these are not the same IDs. Are they somehow related? How is this <code>execution_id</code> added by the Cloud Function on Stackdriver logs?"}, {"owner": {"reputation": 6111, "user_id": 7804058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BuRRt.png?s=128&g=1", "display_name": "norbjd", "link": "https://stackoverflow.com/users/7804058/norbjd"}, "edited": false, "score": 0, "creation_date": 1558122268, "post_id": 56157415, "comment_id": 99010003, "body": "I got it; I&#39;ve tried to send a message directly on the PubSub topic (<b>not</b> via the <i>Testing</i> tab in the Console), and it generates - as you said - an <code>EventID</code> matching the <code>execution_id</code> label on Stackdriver logs. Looks like testing the Cloud Function from the Console have mysterious outcome. I&#39;m curious, do you know why I got this behaviour when sending an event from the <i>Testing</i> tab? Maybe this is because it does not send a real message to the source PubSub topic? Anyway, it works, thanks for your help."}, {"owner": {"reputation": 1747, "user_id": 1236326, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19364e9fcedf07efd137d751295402d2?s=128&d=identicon&r=PG", "display_name": "ProGirlXOXO", "link": "https://stackoverflow.com/users/1236326/progirlxoxo"}, "edited": false, "score": 3, "creation_date": 1590780570, "post_id": 56157415, "comment_id": 109821366, "body": "Please mark that this answer is no longer accurate.  PubSub triggered cloud functions get an event id but that ID does not match execution id.  Event IDs are numeric while execution ids are alphanumeric.  Event ids are uniquely given to a cloud function triggered by pubsub.  If that event must be retried, it keeps the same event id but execution id changes."}], "tags": [], "owner": {"reputation": 705, "user_id": 11494461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d59162f0714c8b18529f3464bd35f75?s=128&d=identicon&r=PG", "display_name": "Lauren", "link": "https://stackoverflow.com/users/11494461/lauren"}, "is_accepted": true, "score": 3, "last_activity_date": 1558109623, "last_edit_date": 1558109623, "creation_date": 1557953308, "answer_id": 56157415, "question_id": 56152806, "link": "https://stackoverflow.com/questions/56152806/get-execution-id-for-google-cloud-functions-triggered-from-pubsub-event/56157415#56157415", "title": "Get execution ID for Google Cloud Functions triggered from PubSub event", "body": "<p>A Pub/Sub-triggered event does not have an execution ID; instead it has an <code>EventID</code> contained in the context metadata, which is a unique ID for the event.</p>\n\n<p>You can access the <code>EventID</code> as follows:</p>\n\n<pre><code>import (\n    \"context\"\n    \"log\"\n    \"cloud.google.com/go/functions/metadata\"\n)\n\nfunc F(ctx context.Context, m PubSubMessage) error {\n    ctxMetadata, err := metadata.FromContext(ctx)\n    if err != nil {\n        log.Fatal(err);\n    }\n    log.Println(\"EventID: \" + ctxMetadata.EventID)\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1747, "user_id": 1236326, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/19364e9fcedf07efd137d751295402d2?s=128&d=identicon&r=PG", "display_name": "ProGirlXOXO", "link": "https://stackoverflow.com/users/1236326/progirlxoxo"}, "is_accepted": false, "score": 2, "last_activity_date": 1590780880, "creation_date": 1590780880, "answer_id": 62093445, "question_id": 56152806, "link": "https://stackoverflow.com/questions/56152806/get-execution-id-for-google-cloud-functions-triggered-from-pubsub-event/62093445#62093445", "title": "Get execution ID for Google Cloud Functions triggered from PubSub event", "body": "<p>No, it is currently not possible to get execution id from pubsub triggered events.</p>\n\n<p>You can get the event id from context as Lauren stated but that does <em>not</em> match execution id.</p>\n\n<p>Also, pubsub triggered events <em>do</em> have execution ids.  You can see this by using a default logger to log the event id.  In stackdriver there will be an attached execution id label and it will not match the event id.  We have observed that event id is numeric while execution id is alphanumeric.</p>\n\n<p>Further, if the function is retried, it will keep the same event id but get a different execution id.</p>\n\n<p>This is a recent (undocumented) change but can be easily observed. </p>\n"}], "owner": {"reputation": 6111, "user_id": 7804058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BuRRt.png?s=128&g=1", "display_name": "norbjd", "link": "https://stackoverflow.com/users/7804058/norbjd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2209, "favorite_count": 0, "accepted_answer_id": 56157415, "answer_count": 2, "score": 1, "last_activity_date": 1590780880, "creation_date": 1557933696, "question_id": 56152806, "link": "https://stackoverflow.com/questions/56152806/get-execution-id-for-google-cloud-functions-triggered-from-pubsub-event", "title": "Get execution ID for Google Cloud Functions triggered from PubSub event", "body": "<p>For Google Cloud Functions triggered from HTTP, it is possible to retrieve the execution id by inspecting the headers of the HTTP request (<code>\"Function-Execution-Id\"</code>) :</p>\n\n<pre><code>package p\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc F(w http.ResponseWriter, r *http.Request) {\n    executionID := r.Header.Get(\"Function-Execution-Id\")\n    fmt.Println(executionID)\n}\n</code></pre>\n\n<p>However, for GCF triggered by PubSub events, I can't find how to retrieve this execution ID :</p>\n\n<pre><code>package p\n\nimport (\n    \"context\"\n)\n\ntype PubSubMessage struct {\n    Data []byte `json:\"data\"`\n}\n\nfunc F(ctx context.Context, m PubSubMessage) error {\n    executionID := \"\" // ???\n    fmt.Println(executionID)\n    return nil\n}\n</code></pre>\n\n<p>I have looked into the <code>PubSubMessage</code> (<a href=\"https://cloud.google.com/pubsub/docs/reference/rest/v1/PubsubMessage\" rel=\"nofollow noreferrer\">https://cloud.google.com/pubsub/docs/reference/rest/v1/PubsubMessage</a>), but it only contains <code>data</code> + an empty <code>attributes</code> map.</p>\n\n<p>I have also checked if execution ID is in the <code>metadata</code> handled by the context. However, from my tests, and the docs (<a href=\"https://godoc.org/cloud.google.com/go/functions/metadata#FromContext\" rel=\"nofollow noreferrer\">https://godoc.org/cloud.google.com/go/functions/metadata#FromContext</a>), only <code>EventID</code>, <code>Timestamp</code>, <code>EventType</code> and <code>Resource</code> are present.</p>\n\n<p>How can I retrieve the execution id of a GCF function triggered by a PubSub event?</p>\n"}, {"tags": ["http", "go", "localhost", "polymer-3.x"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557931350, "post_id": 56151973, "comment_id": 98933436, "body": "Can&#39;t you just change your go port from <code>8080</code> to <code>8081</code>?"}, {"owner": {"reputation": 11, "user_id": 11504702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1js1EjS0-FU/AAAAAAAAAAI/AAAAAAAAApI/oU8KXjbDSzw/photo.jpg?sz=128", "display_name": "Tibate", "link": "https://stackoverflow.com/users/11504702/tibate"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557931759, "post_id": 56151973, "comment_id": 98933729, "body": "you mean in the ListenAndServe method? the problem is it also runs on the 8080 socket. So i cannot just change the port to 8081 otherwise i wont be able the run the polymer app"}, {"owner": {"reputation": 387, "user_id": 7447711, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/06fc8aa94e57d803061286afdcd0f309?s=128&d=identicon&r=PG&f=1", "display_name": "Mikael", "link": "https://stackoverflow.com/users/7447711/mikael"}, "edited": false, "score": 0, "creation_date": 1557950390, "post_id": 56151973, "comment_id": 98942650, "body": "Why are you serving the Polymer app? Shouldn&#39;t you just build it and make Go serve it? If you&#39;re running the Polymer app with something like <code>npm</code> or <code>yarn</code>, the frontend will not be able to find the Go server without extra work."}, {"owner": {"reputation": 11, "user_id": 11504702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1js1EjS0-FU/AAAAAAAAAAI/AAAAAAAAApI/oU8KXjbDSzw/photo.jpg?sz=128", "display_name": "Tibate", "link": "https://stackoverflow.com/users/11504702/tibate"}, "edited": false, "score": 0, "creation_date": 1557991018, "post_id": 56151973, "comment_id": 98953118, "body": "Thank you !  That was in fact the problem. I was running go and polymer both at the same time. Plus in the version given to me the directories were not at the right position so that&#39;s why i had some 404 errors when running only go. Moving the polymer files in the right dir made everything work ! problem fixed ! Thanks everyone"}], "owner": {"reputation": 11, "user_id": 11504702, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1js1EjS0-FU/AAAAAAAAAAI/AAAAAAAAApI/oU8KXjbDSzw/photo.jpg?sz=128", "display_name": "Tibate", "link": "https://stackoverflow.com/users/11504702/tibate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557932783, "creation_date": 1557931137, "last_edit_date": 1557932783, "question_id": 56151973, "link": "https://stackoverflow.com/questions/56151973/how-to-fix-the-path-for-my-request-to-a-go-server-from-a-polymer-app", "title": "how to fix the path for my request to a go server from a polymer app?", "body": "<p>I am working on a GO/Polymer app (Polymer as frontEnd and go as Backend) the server is done with go and functioning and the app with polymer and it is working aswell. </p>\n\n<p>The problem i have is when i try to run the app on localhost my requests are sent to the wrong socket so the server never gets them therefore i cannot test anything nor modify the existing app. </p>\n\n<p>I'm trying to run the app that has already been built by others and add new features but i am a beginner with polymer.\nI tried to modify the URL given in the requests... without any success...</p>\n\n<p>the server : </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>router.PathPrefix(\"/polymer/\").Handler(http.StripPrefix(\"/polymer/\", http.FileServer(http.Dir(\"/polymer/build/es6-bundled/\"))))\n    log.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n\n<p>The directories are set up this way : \nC://Users/go/Myapp/</p>\n\n<p>in this you will find a server directory with all .go files\nand a polymer directory with the files related to polymer and the frontend.</p>\n\n<p>So when i run the server and build/serve the polymer app i get the following link : <a href=\"http://127.0.0.1:8081\" rel=\"nofollow noreferrer\">http://127.0.0.1:8081</a>\nwhen i try to use a query (e.g connecting to the app with credentials stored in a mongoDB database.) it sends the following link  <a href=\"http://127.0.0.1/8081/login/?password=xxxx&amp;username=xxxxx\" rel=\"nofollow noreferrer\">http://127.0.0.1/8081/login/?password=xxxx&amp;username=xxxxx</a></p>\n\n<p>So it never reaches the server which is listening to the socket 8080. \nWhen i change the request link to <a href=\"http://127.0.0.1:8080/login/?password=xxxx&amp;username=xxxxx\" rel=\"nofollow noreferrer\">http://127.0.0.1:8080/login/?password=xxxx&amp;username=xxxxx</a> i get the response from the server.</p>\n\n<p>So i know where the problem is but i dont know how to fix it to run my app on the localhost...</p>\n\n<p>Thank you for helping ! If you need anymore resources i can provide.</p>\n"}, {"tags": ["go", "memory", "profiling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1557927895, "post_id": 56150617, "comment_id": 98931088, "body": "The runtime isn&#39;t necessarily able to allocation only the minimum required memory. How are you determining the peak usage? What does the gctrace output show as required for the heap while the program is running?"}, {"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1557952456, "post_id": 56150617, "comment_id": 98943493, "body": "Possibly related to recently solved issue <a href=\"https://github.com/golang/go/issues/30333\" rel=\"nofollow noreferrer\">30333</a>: &quot;...a temporary spike in memory causes the Go runtime to grow the heap, but it takes a very long time (on the order of minutes) to return that unneeded memory back to the system...&quot;."}, {"owner": {"reputation": 78, "user_id": 6756487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5a96cb3af09e12943baf986a292f32?s=128&d=identicon&r=PG&f=1", "display_name": "Gronnesby", "link": "https://stackoverflow.com/users/6756487/gronnesby"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557996225, "post_id": 56150617, "comment_id": 98955954, "body": "@JimB I am fine with the runtime allocating more memory than needed, but ~14 GB extra seems a bit excessive. I have used <code>pprof.WriteHeapProfile()</code> to trace memory usage, but as you can see it is not very helpful. Which leads me to believe that I am either not using it correctly, or I have misunderstood its capabilities."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558012039, "post_id": 56150617, "comment_id": 98965186, "body": "@Gronnesby: that&#39;s why I mentioned <code>gctrace</code>, which will show the heap allocation in relation to the garbage collector goals. Also make sure you&#39;re using go1.12.5."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1558012313, "post_id": 56150617, "comment_id": 98965362, "body": "The go profile is a sampling profiler, so it&#39;s not an absolute measure, you use to compare thing relative to each other. You can increase the <code>MemProfileRate</code> and see if that helps narrow things down for you. You can also write benchmarks for the individual components, and use <code>-benchmem</code> to see where the allocations are happening."}, {"owner": {"reputation": 78, "user_id": 6756487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5a96cb3af09e12943baf986a292f32?s=128&d=identicon&r=PG&f=1", "display_name": "Gronnesby", "link": "https://stackoverflow.com/users/6756487/gronnesby"}, "edited": false, "score": 0, "creation_date": 1558530535, "post_id": 56150617, "comment_id": 99131648, "body": "Setting the <code>MemProfileRate=1</code> seems to work. There are now additional functions listed in the <code>pprof</code> profile that was previously omitted."}], "answers": [{"tags": [], "owner": {"reputation": 78, "user_id": 6756487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5a96cb3af09e12943baf986a292f32?s=128&d=identicon&r=PG&f=1", "display_name": "Gronnesby", "link": "https://stackoverflow.com/users/6756487/gronnesby"}, "is_accepted": true, "score": 1, "last_activity_date": 1579089094, "creation_date": 1579089094, "answer_id": 59750870, "question_id": 56150617, "link": "https://stackoverflow.com/questions/56150617/golang-alloc-and-heapalloc-vs-pprof-large-discrepancies/59750870#59750870", "title": "Golang Alloc and HeapAlloc vs pprof large discrepancies", "body": "<p>As mentioned in the comments by <a href=\"https://stackoverflow.com/users/32880/jimb\">JimB</a>, the go profile is a sampling profiler and samples memory usage at certain intervals. In my case the sampling was not frequent enough to catch a function (JSON marshalling) that was using extensive amounts of memory.</p>\n\n<p>Increasing the sample rate of the profiler by setting the environment variable</p>\n\n<p><code>$ export GODEBUG=memprofilerate=1</code></p>\n\n<p>Will update<a href=\"https://golang.org/pkg/runtime/?source=post_page---------------------------#pkg-variables\" rel=\"nofollow noreferrer\"><code>runtime.MemProfileRate</code></a>and the profile now includes every allocated block.</p>\n"}, {"tags": [], "owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "is_accepted": false, "score": 0, "last_activity_date": 1604353480, "creation_date": 1604353480, "answer_id": 64653785, "question_id": 56150617, "link": "https://stackoverflow.com/questions/56150617/golang-alloc-and-heapalloc-vs-pprof-large-discrepancies/64653785#64653785", "title": "Golang Alloc and HeapAlloc vs pprof large discrepancies", "body": "<p>A possible solution (as it was in my case) is that the binary was compiled with <code>-race</code>, which enables checking for race conditions.</p>\n<p>The overhead for this is <em>huge</em> and will look like a massive memory leak if checking with <code>htop</code> or something similar, but won't show in any pprof output</p>\n"}], "owner": {"reputation": 78, "user_id": 6756487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5a96cb3af09e12943baf986a292f32?s=128&d=identicon&r=PG&f=1", "display_name": "Gronnesby", "link": "https://stackoverflow.com/users/6756487/gronnesby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1034, "favorite_count": 2, "accepted_answer_id": 59750870, "answer_count": 2, "score": 5, "last_activity_date": 1604353480, "creation_date": 1557927021, "last_edit_date": 1557995862, "question_id": 56150617, "link": "https://stackoverflow.com/questions/56150617/golang-alloc-and-heapalloc-vs-pprof-large-discrepancies", "title": "Golang Alloc and HeapAlloc vs pprof large discrepancies", "body": "<p>I have a Go program that calculates large correlation matrices in memory. To do this I've set up a pipeline of 3 goroutines where the first reads in files, the second calculates the correlation matrix and the last stores the result to disk. </p>\n\n<p>Problem is, when I run the program, the Go runtime allocates ~17GB of memory while a matrix only takes up ~2-3GB. Using <code>runtime.ReadMemStats</code> shows that the program is using ~17GB (and verified by using htop), but <code>pprof</code> only reports about ~2.3GB.</p>\n\n<p>If I look at the mem stats after running one file through the pipeline:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var mem runtime.MemStats\nruntime.ReadMemStats(&amp;mem)\nfmt.Printf(\"Total alloc: %d GB\\n\", mem.Alloc/1000/1000/1000)\n</code></pre>\n\n<p>This shows the total allocation of the program:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>Total alloc: 17 GB\n</code></pre>\n\n<p>However, if I run <code>go tool pprof mem.prof</code> I get the following results:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>(pprof) top5\nShowing nodes accounting for 2.21GB, 100% of 2.21GB total\nShowing top 5 nodes out of 9\n      flat  flat%   sum%        cum   cum%\n    1.20GB 54.07% 54.07%     1.20GB 54.07%  dataset.(*Dataset).CalcCorrelationMatrix\n    1.02GB 45.93%   100%     1.02GB 45.93%  bytes.makeSlice\n         0     0%   100%     1.02GB 45.93%  bytes.(*Buffer).WriteByte\n         0     0%   100%     1.02GB 45.93%  bytes.(*Buffer).grow\n         0     0%   100%     1.02GB 45.93%  encoding/json.Indent\n\n</code></pre>\n\n<p>So I am wondering how I can go about to find out why the program allocates 17 GB, when it seems that the peak memory usage is only ~2.5GB? \nIs there a way to trace the memory usage throughout the program using pprof?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I ran the program again with GODEBUG=gctrace=1 and got the following trace:</p>\n\n<pre><code>gc 1 @0.017s 0%: 0.005+0.55+0.003 ms clock, 0.022+0/0.47/0.11+0.012 ms cpu, 1227-&gt;1227-&gt;1226 MB, 1228 MB goal, 4 P\ngc 2 @14.849s 0%: 0.003+1.7+0.004 ms clock, 0.015+0/1.6/0.11+0.018 ms cpu, 1227-&gt;1227-&gt;1227 MB, 2452 MB goal, 4 P\ngc 3 @16.850s 0%: 0.006+60+0.003 ms clock, 0.027+0/0.46/59+0.015 ms cpu, 1876-&gt;1876-&gt;1712 MB, 2455 MB goal, 4 P\ngc 4 @22.861s 0%: 0.005+238+0.003 ms clock, 0.021+0/0.46/237+0.015 ms cpu, 3657-&gt;3657-&gt;3171 MB, 3658 MB goal, 4 P\ngc 5 @30.716s 0%: 0.005+476+0.004 ms clock, 0.022+0/0.44/476+0.017 ms cpu, 5764-&gt;5764-&gt;5116 MB, 6342 MB goal, 4 P\ngc 6 @46.023s 0%: 0.005+949+0.004 ms clock, 0.020+0/0.47/949+0.017 ms cpu, 10302-&gt;10302-&gt;9005 MB, 10303 MB goal, 4 P\ngc 7 @64.878s 0%: 0.006+382+0.004 ms clock, 0.024+0/0.46/382+0.019 ms cpu, 16548-&gt;16548-&gt;7728 MB, 18011 MB goal, 4 P\ngc 8 @89.774s 0%: 0.86+2805+0.006 ms clock, 3.4+0/24/2784+0.025 ms cpu, 20208-&gt;20208-&gt;17088 MB, 20209 MB goal, 4 P\n</code></pre>\n\n<p>So it is quite obvious that the heap grows steadily through the program, but I am not able to pinpoint where. I've profiled memory usage using <code>pprof.WriteHeapProfile</code> after calling the memory intensive functions:</p>\n\n<pre><code>func memoryProfile(profpath string) {\n\n    if _, err := os.Stat(profpath); os.IsNotExist(err) {\n        os.Mkdir(profpath, os.ModePerm)\n    }\n\n    f, err := os.Create(path.Join(profpath, \"mem.mprof\"))\n    fmt.Printf(\"Creating memory profile in %s\", \"data/profile/mem.mprof\\n\")\n    if err != nil {\n        panic(err)\n    }\n\n    if err := pprof.WriteHeapProfile(f); err != nil {\n        panic(err)\n    }\n    f.Close()\n}\n</code></pre>\n"}, {"tags": ["go", "grpc-go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1557923692, "post_id": 56149367, "comment_id": 98928310, "body": "The &quot;normal&quot; HTTP request isn&#39;t a valid gRPC call (not just the method, the path is wrong too). You should not handcraft HTTP requests for a gRPC service. Use the gRPC client libraries instead."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7564646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1wkiz.png?s=128&g=1", "display_name": "JasdeepSingh", "link": "https://stackoverflow.com/users/7564646/jasdeepsingh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557997149, "creation_date": 1557997149, "answer_id": 56164682, "question_id": 56149367, "link": "https://stackoverflow.com/questions/56149367/getting-405-http-error-in-client-to-call-grpc-web/56164682#56164682", "title": "Getting 405 http error in Client to call gRPC Web", "body": "<p>Current Browsers dont support grpc natively. So I try to use a sidecar proxy from envoy (envoy by lyft) which acts as an interface for my grpc backend.</p>\n\n<pre><code>...\nstatic_resources:\ncluster:\n- name: local_service\n    connect_timeout: 0.25s\n    type: strict_dns\n    lb_policy: round_robin\n    load_assignment:\n      cluster_name: local_service\n      endpoints:\n      - lb_endpoints:\n        - endpoint:\n            address:\n              socket_address:\n                address: 127.0.0.1\n                port_value: 8080\n...\n</code></pre>\n\n<p>This is how i write a service in my envoy config, and this more details on this can be found on <a href=\"https://github.com/envoyproxy/envoy\" rel=\"nofollow noreferrer\">Envoy's Github Repository</a>, they have multiple examples for better understanding the process.</p>\n"}], "owner": {"reputation": 21, "user_id": 11504060, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16Xifax8NzY/AAAAAAAAAAI/AAAAAAAAArk/K_7FWISSxH4/photo.jpg?sz=128", "display_name": "Vivek Siddharth", "link": "https://stackoverflow.com/users/11504060/vivek-siddharth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557997149, "creation_date": 1557923282, "question_id": 56149367, "link": "https://stackoverflow.com/questions/56149367/getting-405-http-error-in-client-to-call-grpc-web", "title": "Getting 405 http error in Client to call gRPC Web", "body": "<p>I am getting http error code 405 while calling the gRPC service from rest client. </p>\n\n<p>I tried calling the delete method using the gRPC client, it is working fine (i.e. getting 200). </p>\n\n<p>REST CLIENT</p>\n\n<pre><code>req, err = http.NewRequest(\"DELETE\", fmt.Sprintf(\"%s%s\", *address, \"/v1/todo\"), nil)\n    resp, err = http.DefaultClient.Do(req)\n    if err != nil {\n        log.Fatalf(\"failed to call DeleteAll method: %v\", err)\n    }\n    bodyBytes, err = ioutil.ReadAll(resp.Body)\n    resp.Body.Close()\n    if err != nil {\n        body = fmt.Sprintf(\"failed read Delete response body: %v\", err)\n    } else {\n        body = string(bodyBytes)\n    }\n    log.Printf(\"Delete response: Code=%d, Body=%s\\n\\n\", resp.StatusCode, body)\n</code></pre>\n\n<p>gRPC Client</p>\n\n<pre><code>req6 := v1.DeleteAllRequest{\n        Api: apiVersion,\n    }\n    res6, err := c.DeleteAll(ctx, &amp;req6)\n    if err != nil {\n        log.Fatalf(\"Delete failed: %v\", err)\n    }\n    log.Printf(\"Delete all result: &lt;%+v&gt;\\n\\n\", res6)\n</code></pre>\n\n<p>Expected to get the delete function executed properly and get 200 http response.</p>\n"}, {"tags": ["docker", "go", "redis"], "comments": [{"owner": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 1, "creation_date": 1557923625, "post_id": 56149231, "comment_id": 98928267, "body": "I am assuming this is Kubernetes, are you connecting from the same namespace?"}, {"owner": {"reputation": 177, "user_id": 9022359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R4yW8qwpC4/AAAAAAAAAAI/AAAAAAAAAAc/FN8-Wu-zaXY/photo.jpg?sz=128", "display_name": "being of habits", "link": "https://stackoverflow.com/users/9022359/being-of-habits"}, "reply_to_user": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 0, "creation_date": 1557923718, "post_id": 56149231, "comment_id": 98928325, "body": "Nope. Honestly, I have no access to k8s itself, but my teammate says, that redis is inside one. But Currently, my container w/ go is not. So it&#39;s not the same pod"}, {"owner": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 1, "creation_date": 1557923970, "post_id": 56149231, "comment_id": 98928477, "body": "Can you tell me in what namespace redis is? You need to construct the url using the namespace if it&#39;s not the same one you are connecting from"}, {"owner": {"reputation": 177, "user_id": 9022359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R4yW8qwpC4/AAAAAAAAAAI/AAAAAAAAAAc/FN8-Wu-zaXY/photo.jpg?sz=128", "display_name": "being of habits", "link": "https://stackoverflow.com/users/9022359/being-of-habits"}, "reply_to_user": {"reputation": 4057, "user_id": 1914440, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/96950854138967a35884c26aeb048f3d?s=128&d=identicon&r=PG", "display_name": "fons", "link": "https://stackoverflow.com/users/1914440/fons"}, "edited": false, "score": 0, "creation_date": 1557924208, "post_id": 56149231, "comment_id": 98928604, "body": "Seems like to be a good hint. Am I able to get a namespace with no access to k8s itself?"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 1, "creation_date": 1557924648, "post_id": 56149231, "comment_id": 98928894, "body": "Since you can connect using <code>redis-cli</code>, your Redis is running locally on <code>127.0.0.1:6379</code>. But if you are using Docker, you should use Docker network. In case you are using docker-compose, you can connect using network name: something like <code>redis:6379</code>. In case of k8s you should use k8s DNS convention - <a href=\"https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/\" rel=\"nofollow noreferrer\">kubernetes.io/docs/concepts/services-networking/dns-pod-serv&zwnj;&#8203;ice</a>"}], "answers": [{"tags": [], "owner": {"reputation": 155, "user_id": 10161086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10624247a7bd663b5927403964d8706c?s=128&d=identicon&r=PG&f=1", "display_name": "PPetkov", "link": "https://stackoverflow.com/users/10161086/ppetkov"}, "is_accepted": false, "score": 0, "last_activity_date": 1557924863, "creation_date": 1557924863, "answer_id": 56149874, "question_id": 56149231, "link": "https://stackoverflow.com/questions/56149231/failed-to-connect-to-separate-docker-container-with-redis/56149874#56149874", "title": "Failed to connect to separate docker container with Redis", "body": "<p>You could use something like this</p>\n\n<p><code>docker-compose.yaml</code></p>\n\n<pre><code>web:\n    build: .\n    working_dir: /go/src\n    ports:\n     - \"5000:5000\"\n    volumes:\n     - .:/go/src\n    links:\n     - db\ndb:\n    image: redis\n    ports:\n     - \"6379:6379\"\n</code></pre>\n\n<p>Its creating a link between you containers so they can communicate to eachother.\nIf you don't want to use <code>docker-compose.yaml</code> then you could use the <code>--link</code> flag when building your image</p>\n"}, {"tags": [], "owner": {"reputation": 29, "user_id": 11143335, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QTr1k0uQ2cE/AAAAAAAAAAI/AAAAAAAAJo8/MfGTdDcaruw/photo.jpg?sz=128", "display_name": "Prashant Patel", "link": "https://stackoverflow.com/users/11143335/prashant-patel"}, "is_accepted": false, "score": -1, "last_activity_date": 1557929938, "creation_date": 1557929938, "answer_id": 56151570, "question_id": 56149231, "link": "https://stackoverflow.com/questions/56149231/failed-to-connect-to-separate-docker-container-with-redis/56151570#56151570", "title": "Failed to connect to separate docker container with Redis", "body": "<p>Kubernetes would make the discovery simple. I have written a redis replication and fail over k8s config with read write in go to redis. <a href=\"https://github.com/kubesure/premium\" rel=\"nofollow noreferrer\">check https://github.com/kubesure/premium</a> </p>\n"}], "owner": {"reputation": 177, "user_id": 9022359, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6R4yW8qwpC4/AAAAAAAAAAI/AAAAAAAAAAc/FN8-Wu-zaXY/photo.jpg?sz=128", "display_name": "being of habits", "link": "https://stackoverflow.com/users/9022359/being-of-habits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 575, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557929938, "creation_date": 1557922789, "last_edit_date": 1557923621, "question_id": 56149231, "link": "https://stackoverflow.com/questions/56149231/failed-to-connect-to-separate-docker-container-with-redis", "title": "Failed to connect to separate docker container with Redis", "body": "<p>I have redis exposed via a container:</p>\n\n<p><code>service_redis 0.0.0.0:6379-&gt;6379/tcp</code></p>\n\n<p>And I can even connect to it via <code>redis-cli</code> command with. But what I actually can't do, is to connect to via Go code (which also exists in a separate container, btw)</p>\n\n<p>Here's how my client looks like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>opts := &amp;redis.Options{\n    Addr: addr,\n    Password: pass,\n    DB: db,\n}\n\n\ncli := redis.NewClient(opts)\nfmt.Println(master.Ping().Err())\nfmt.Println(slave.Get(\"REAL_KEY\").String())\n</code></pre>\n\n<p>I've tried to put in the <code>addr</code> variable the following:</p>\n\n<ol>\n<li><code>0.0.0.0:6379</code> AND <code>127.0.0.1:6379</code>. The response was e.g.:</li>\n</ol>\n\n<pre><code>&lt;nil&gt;\nget REAL KEY: dial tcp 0.0.0.0:6379: connect: connection refused\n</code></pre>\n\n<ol start=\"2\">\n<li><code>service_redis:6379</code> with the following response:</li>\n</ol>\n\n<pre><code>\n&lt;nil&gt;\nget REAL KEY: dial tcp: lookup service_redis on 169.254.169.254:53: no such host\n</code></pre>\n\n<p>How can I solve the problem and what did I wrong?</p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1557924788, "post_id": 56147647, "comment_id": 98928998, "body": "Your shared screenshot shows <code>fmain</code> snippet which generates empty main func, which is handy. What happens if you type <code>fmt.</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 9717132, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f7hldCt1OsQ/AAAAAAAAAAI/AAAAAAAAABk/bOP59Q7vf5M/photo.jpg?sz=128", "display_name": "Angel Pensive", "link": "https://stackoverflow.com/users/9717132/angel-pensive"}, "edited": false, "score": 1, "creation_date": 1557931642, "post_id": 56149917, "comment_id": 98933648, "body": "I have it installed. I was helped to turn on go.autocompleteUnimportedPackages."}], "tags": [], "owner": {"reputation": 223, "user_id": 1656938, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/aa2e089f7fe0f3859db24ae01c562574?s=128&d=identicon&r=PG", "display_name": "Veljex", "link": "https://stackoverflow.com/users/1656938/veljex"}, "is_accepted": true, "score": 0, "last_activity_date": 1557924979, "creation_date": 1557924979, "answer_id": 56149917, "question_id": 56147647, "link": "https://stackoverflow.com/questions/56147647/how-to-make-autocomplete-for-undeclared-libraries/56149917#56149917", "title": "How to make autocomplete for undeclared libraries?", "body": "<p>Within VS Code go to the extensions tab and search for \"Go\". There will be one listed created by Microsoft which provides IntelliSense. Install this extension and restart VS Code, you should have the functionality you are looking for.</p>\n\n<p>Note: you will need to be in a <code>.go</code> file for the IntelliSense to kick in.</p>\n"}], "owner": {"reputation": 127, "user_id": 9717132, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-f7hldCt1OsQ/AAAAAAAAAAI/AAAAAAAAABk/bOP59Q7vf5M/photo.jpg?sz=128", "display_name": "Angel Pensive", "link": "https://stackoverflow.com/users/9717132/angel-pensive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 56149917, "answer_count": 1, "score": 0, "last_activity_date": 1557924979, "creation_date": 1557917691, "last_edit_date": 1557922940, "question_id": 56147647, "link": "https://stackoverflow.com/questions/56147647/how-to-make-autocomplete-for-undeclared-libraries", "title": "How to make autocomplete for undeclared libraries?", "body": "<p>How to make autocompletion as in goland?\nFor VSC.</p>\n\n<p><a href=\"https://i.stack.imgur.com/7OUza.png\" rel=\"nofollow noreferrer\">How do I need.</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Bl7Tj.png\" rel=\"nofollow noreferrer\">No good.</a></p>\n\n<p>I have installed packages:</p>\n\n<pre><code>gocode\ngodef\ngolint\ngo-find-references\ngo-outline\ngoreturns\ngorename\ngopkgs\ngo-symbols\n</code></pre>\n\n<p>And configured settings.json:</p>\n\n<pre><code>{\n    \"go.toolsGopath\": \"/home/user/go\",\n    \"go.gopath\": \"/home/user/go\",\n    \"go.goroot\": \"/snap/go/3739\",\n    \"go.buildOnSave\": true,\n    \"go.lintOnSave\": true,\n    \"go.vetOnSave\": true,\n    \"go.buildFlags\": [],\n    \"go.lintFlags\": [],\n    \"go.vetFlags\": [],\n    \"go.useCodeSnippetsOnFunctionSuggest\": false,\n    \"go.formatOnSave\": false,\n    \"go.formatTool\": \"goreturns\"\n}\n</code></pre>\n"}, {"tags": ["xml", "go", "struct", "slice", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 305, "user_id": 9048198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OY2Ya.jpg?s=128&g=1", "display_name": "gold-kou", "link": "https://stackoverflow.com/users/9048198/gold-kou"}, "edited": false, "score": 0, "creation_date": 1557918553, "post_id": 56147463, "comment_id": 98925179, "body": "Shame on me. Thank you ! The end tag had nothing to do with my error. <code>,attr</code> is also key point."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 7, "last_activity_date": 1557917099, "creation_date": 1557917099, "answer_id": 56147463, "question_id": 56147396, "link": "https://stackoverflow.com/questions/56147396/how-can-i-get-data-from-nested-xml-which-doesnt-use-end-tag-in-repeat-items/56147463#56147463", "title": "How can I get data from nested xml which doesn&#39;t use end tag in repeat items?", "body": "<p><code>&lt;Child&gt;</code> in your XML is a \"child\" of <code>Parent</code>, so get rid of the <code>Children</code> wrapper struct, the slice should be a field of <code>Parent</code>. Also the values in <code>&lt;Child&gt;</code> are in attributes, so you have to use the <code>,attr</code> option.</p>\n\n<p>Working model:</p>\n\n<pre><code>type Parent struct {\n    Val   string\n    Child []Child\n}\n\ntype Child struct {\n    Val string `xml:\",attr\"`\n}\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/gJ84ZA0jME_w\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>{Hello [{Hello} {Hello} {Hello}]}\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 9048198, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OY2Ya.jpg?s=128&g=1", "display_name": "gold-kou", "link": "https://stackoverflow.com/users/9048198/gold-kou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557993786, "creation_date": 1557916879, "last_edit_date": 1557993786, "question_id": 56147396, "link": "https://stackoverflow.com/questions/56147396/how-can-i-get-data-from-nested-xml-which-doesnt-use-end-tag-in-repeat-items", "title": "How can I get data from nested xml which doesn&#39;t use end tag in repeat items?", "body": "<p>According to the below link, we can get data from nested xml by using <code>&gt;</code> or another struct.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/34941539/how-do-i-unmarshal-nested-xml-elements-into-an-array/42618835\">How do I unmarshal nested XML elements into an array?\n</a></p>\n\n<p>However it doesn't work in case of not using end tag like this.</p>\n\n<p>code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\nfunc main() {\n\n    container := Parent{}\n    err := xml.Unmarshal([]byte(xml_data), &amp;container)\n\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Println(container)  \n    }\n}\n\nvar xml_data = `&lt;Parent&gt;\n            &lt;Val&gt;Hello&lt;/Val&gt;\n                &lt;Child Val=\"Hello\"/&gt;\n                &lt;Child Val=\"Hello\"/&gt;\n                &lt;Child Val=\"Hello\"/&gt;\n        &lt;/Parent&gt;`\n\ntype Parent struct {\n    Val string\n    Children Children\n}\n\ntype Children struct {\n    Child []Child\n}\n\ntype Child struct {\n    Val string\n}\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>{Hello {[]}}\n</code></pre>\n\n<p>Any solution?</p>\n"}, {"tags": ["linux", "go"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7564646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1wkiz.png?s=128&g=1", "display_name": "JasdeepSingh", "link": "https://stackoverflow.com/users/7564646/jasdeepsingh"}, "is_accepted": false, "score": 1, "last_activity_date": 1557998460, "creation_date": 1557998460, "answer_id": 56165111, "question_id": 56147174, "link": "https://stackoverflow.com/questions/56147174/http-accept-error-accept-tcp-8080-accept4-too-many-open-files/56165111#56165111", "title": "http: Accept error: accept tcp [::]:8080: accept4: too many open files;", "body": "<p>One problem could be not closing the opened files or releasing the resources. <br>\nFor example: the body object in http request is of type io.ReadCloser\nThis read closer has a close method which you must call after your process has been finished to release the resources.</p>\n\n<pre><code>func UserHandler(w http.ResponseWriter, r *http.request) {\n    var user User\n\n    if err := json.NewDecoder(r.Body).Decode(&amp;user); err != nil {\n      //handle error\n    }\n    defer r.Body.Close()\n\n  // More Code\n}\n\n</code></pre>\n\n<p>Here calling a <strong>defer</strong> on the <strong><em>r.Body.Close()</em></strong> will lead to releasing the associated resources after the method has returned its value.</p>\n\n<p>Similar To this, there are alot of methods which implement this interface, like: <strong>* os.File, sql.DB, mgo.Session*</strong> etc. So you can just check if you're properly closing the resources.</p>\n"}], "owner": {"reputation": 21, "user_id": 10174898, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CnATIX1fnbY/AAAAAAAAAAI/AAAAAAAADRA/_1mmpA_LoFY/photo.jpg?sz=128", "display_name": "maruthi podila", "link": "https://stackoverflow.com/users/10174898/maruthi-podila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2126, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557998460, "creation_date": 1557916179, "last_edit_date": 1557916809, "question_id": 56147174, "link": "https://stackoverflow.com/questions/56147174/http-accept-error-accept-tcp-8080-accept4-too-many-open-files", "title": "http: Accept error: accept tcp [::]:8080: accept4: too many open files;", "body": "<p>I have written REST API in Golang and I am doing performance test of my API using Jmeter. \nWhen I run the test with 300 or more users, each user sending 20 requests with a gap of 500ms between each request I get the below error:</p>\n\n<blockquote>\n  <p>http: Accept error: accept tcp [::]:8080: accept4: too many open files;</p>\n</blockquote>\n\n<p>I am running this Go application in AWS EC2 server. I am running this app on a 8GB RAM machine. \nBelow is what I have tried already:</p>\n\n<ol>\n<li>I have increased the ulimit to a sufficiently good number. When I run ulimit -n command the output is: 1048576</li>\n<li>In my code I made sure that the response body is closed.</li>\n</ol>\n\n<p>But, none of these solved the issue. Any help is appreciated.\nThanks in advance.</p>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": true, "score": 1, "last_activity_date": 1557912727, "creation_date": 1557912727, "answer_id": 56146014, "question_id": 56145811, "link": "https://stackoverflow.com/questions/56145811/golang-json-payload-preparation-with-multiple-data/56146014#56146014", "title": "GoLang JSON payload preparation with multiple data", "body": "<p>Hope this helps :</p>\n\n<pre><code>type Template struct {\nTemplateURL string `json:\"templateUrl\" param:\"templateUrl\"`\nTemplateName string `json:\"templateName\" param:\"templateName\"`\n}\n\ntype Date struct {\nUserId string `json:\"UserId\" param:\"UserId\"`\nName string `json:\"Name\" param:\"Name\"`\n}\n</code></pre>\n\n<pre><code>type NameAny struct {\n*Template\nTransactionType string `json:\"transactiontype\" param:\"transactiontype\"`\nEmailType string `json:\"emailType\" param:\"emailType\"`\nData []Date `json:\"date\" param:\"date\"`\n}\n</code></pre>\n\n<pre><code>Data, _ := json.Marshal(NameAny)\nJson(c, string(Data))(w, r)\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 38, "user_id": 7266656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ea81b2c8cc2626611e7f2d06ab5e31?s=128&d=identicon&r=PG&f=1", "display_name": "r3vit", "link": "https://stackoverflow.com/users/7266656/r3vit"}, "is_accepted": false, "score": 1, "last_activity_date": 1557936045, "last_edit_date": 1557936045, "creation_date": 1557935582, "answer_id": 56153320, "question_id": 56145811, "link": "https://stackoverflow.com/questions/56145811/golang-json-payload-preparation-with-multiple-data/56153320#56153320", "title": "GoLang JSON payload preparation with multiple data", "body": "<p>You can use an online tool to convert a json into a valid Go struct: <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a></p>\n\n<p>Given your JSON, the Go struct is:</p>\n\n<pre><code>type AutoGenerated struct {\n    Transactiontype string `json:\"transactiontype\"`\n    EmailType       string `json:\"emailType\"`\n    Template        struct {\n        TemplateURL  string `json:\"templateUrl\"`\n        TemplateName string `json:\"templateName\"`\n    } `json:\"template\"`\n    Date []struct {\n        UserID int    `json:\"UserId\"`\n        Name   string `json:\"Name\"`\n    } `json:\"date\"`\n}\n</code></pre>\n\n<p>After the conversion, use the <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\">json.Marshal</a> (Go Struct to JSON) and <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">json.Unmarshal</a> (JSON to Go Struct) </p>\n\n<p>Complete example with your data: <a href=\"https://play.golang.org/p/RJuGK4cY1u-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RJuGK4cY1u-</a></p>\n"}, {"tags": [], "owner": {"reputation": 1187, "user_id": 10390273, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZnPo-zLAkpE/AAAAAAAAAAI/AAAAAAAAAQ0/eDv2tBJWBWM/photo.jpg?sz=128", "display_name": "ASHWIN RAJEEV", "link": "https://stackoverflow.com/users/10390273/ashwin-rajeev"}, "is_accepted": false, "score": 1, "last_activity_date": 1557989261, "creation_date": 1557989261, "answer_id": 56162379, "question_id": 56145811, "link": "https://stackoverflow.com/questions/56145811/golang-json-payload-preparation-with-multiple-data/56162379#56162379", "title": "GoLang JSON payload preparation with multiple data", "body": "<pre><code>// Transaction is a struct which stores the transaction details\ntype Transaction struct {\n    TransactionType string   `json:\"transaction_type\"`\n    EmailType       string   `json:\"email_type\"`\n    Template        Template `json:\"template\"`\n    Date            []Date   `json:\"date\"`\n}\n\n//Template is a struct which stores the template details\ntype Template struct {\n    TemplateURL  string `json:\"template_url\"`\n    TemplateName string `json:\"template_name\"`\n}\n\n// Date is a struct which stores the user details\ntype Date struct {\n    UserID int    `json:\"user_id\"`\n    Name   string `json:\"name\"`\n}\n</code></pre>\n\n<p>Above given structs are the correct data structure for storing your json body you can use json decoder for perfectly storing the data into struct</p>\n\n<pre><code>func exampleHandler(w http.ResponseWriter, r *http.Request) {\n    var trans Transaction\n    decoder := json.NewDecoder(r.Body)\n    err := decoder.Decode(&amp;trans)\n    if err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 607, "user_id": 5164776, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/999423470091088/picture?type=large", "display_name": "Chandan Kumar", "link": "https://stackoverflow.com/users/5164776/chandan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 56146014, "answer_count": 3, "score": 0, "last_activity_date": 1557989261, "creation_date": 1557912104, "last_edit_date": 1557913227, "question_id": 56145811, "link": "https://stackoverflow.com/questions/56145811/golang-json-payload-preparation-with-multiple-data", "title": "GoLang JSON payload preparation with multiple data", "body": "<p>I want to create JSON payload in given below format. I want a code or pattern that prepares the given format.</p>\n\n<pre><code>{\n    transactiontype: 'DDDDD'\n    emailType: 'QQQQQQ'\n    template: {\n        templateUrl: 'xry.kk'\n        templateName: 'chanda'\n    }\n    date: [\n        {\n            UserId: 1\n            Name: chadnan\n        },\n        {\n            UserId: 2\n            Name: kkkkkk\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["go", "mysql-connector"], "comments": [{"owner": {"reputation": 6486, "user_id": 1116230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55a894894150db28d6641f0c57e48bac?s=128&d=identicon&r=PG", "display_name": "Nico Haase", "link": "https://stackoverflow.com/users/1116230/nico-haase"}, "edited": false, "score": 3, "creation_date": 1557908827, "post_id": 56144735, "comment_id": 98919470, "body": "What do you mean by &quot;simpler&quot;?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557909035, "post_id": 56144735, "comment_id": 98919574, "body": "If you don&#39;t want to write SQL by hand and use that together with <code>database&#47;sql</code> then you could look for 3rd party ORMs.. not that I would recommend using an ORM but that seems to be the default path for people who consider plain SQL to be too much of a hassle."}, {"owner": {"reputation": 19, "user_id": 11502821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13718fcf7af6047b3883e7ed6f15b9cf?s=128&d=identicon&r=PG&f=1", "display_name": "jetoguza", "link": "https://stackoverflow.com/users/11502821/jetoguza"}, "edited": false, "score": 0, "creation_date": 1557909099, "post_id": 56144735, "comment_id": 98919608, "body": "My apologies, I meant to say if there was a <i>cleaner</i> way of doing this command or is this the right way to go about doing it?"}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 4, "creation_date": 1557909378, "post_id": 56144735, "comment_id": 98919736, "body": "What do you mean by <code>cleaner way</code>?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557909763, "post_id": 56144735, "comment_id": 98919936, "body": "You might wanna do something like this: <a href=\"https://play.golang.org/p/0yf9O4Zhxin\" rel=\"nofollow noreferrer\">play.golang.org/p/0yf9O4Zhxin</a> to avoid the unnecessary back-and-forth between your app and the db."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557936424, "post_id": 56144735, "comment_id": 98936489, "body": "What specifically are you trying to improve about this code?"}], "answers": [{"tags": [], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "is_accepted": false, "score": 0, "last_activity_date": 1557928162, "creation_date": 1557928162, "answer_id": 56150990, "question_id": 56144735, "link": "https://stackoverflow.com/questions/56144735/golang-and-mysql-db/56150990#56150990", "title": "GoLang and MySQL DB", "body": "<p><a href=\"https://godoc.org/github.com/jmoiron/sqlx#NamedExec\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/jmoiron/sqlx#NamedExec</a> makes it slightly better. It could be, something like:</p>\n\n<pre><code>result, err := db.NamedExec(`INSERT INTO table1 (id, title, name, dob, address, email, notes) VALUES (:id, :title, :name, :dob, :address, :email, :notes)`,\nperson)\n</code></pre>\n\n<p>Do have a look at my <a href=\"https://github.com/kaihendry/GoApiTutorial/blob/master/model.go\" rel=\"nofollow noreferrer\">model.go example</a> for further details.</p>\n"}], "owner": {"reputation": 19, "user_id": 11502821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13718fcf7af6047b3883e7ed6f15b9cf?s=128&d=identicon&r=PG&f=1", "display_name": "jetoguza", "link": "https://stackoverflow.com/users/11502821/jetoguza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557928162, "creation_date": 1557908712, "last_edit_date": 1557909856, "question_id": 56144735, "link": "https://stackoverflow.com/questions/56144735/golang-and-mysql-db", "title": "GoLang and MySQL DB", "body": "<p>Is there a simpler way of executing MySQL commands in Go using the <code>github.com/go-sql-driver/mysql</code> package?</p>\n\n<p>Essentially this is the current command I am using:</p>\n\n<pre><code>db.Exec(\"INSERT INTO table1 (id, title, name, dob, address, email, notes) VALUES (?, ?, ?, ?, ?, ?, ?)\", id, title, name, dob, address, email, notes)\n</code></pre>\n\n<p>And how I'm using this command would be:</p>\n\n<pre><code>var people []people\n\nfor _, person := range people {\n     db.Exec(\"INSERT INTO table1 (id, title, name, dob, address, email, notes) VALUES (?, ?, ?, ?, ?, ?, ?)\", person.id, person.title, person.name, person.dob, person.address, person.email, person.notes)\n}\n</code></pre>\n"}, {"tags": ["mysql", "go", "controller", "mariadb", "beego"], "answers": [{"tags": [], "owner": {"reputation": 117184, "user_id": 9473764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aGMXl.jpg?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/9473764/nick"}, "is_accepted": true, "score": 1, "last_activity_date": 1557908033, "creation_date": 1557908033, "answer_id": 56144532, "question_id": 56144277, "link": "https://stackoverflow.com/questions/56144277/how-to-select-sum-of-specific-id-in-select-query-mysql-beego/56144532#56144532", "title": "How to select sum of specific id in select query MySQL, Beego", "body": "<p>You can use this query. It JOINs the <code>invoice</code> table to a derived table of <code>SUM</code>s of all the amounts paid per invoice from <code>invoice_paid</code>, subtracting that total from the invoice amount to get the outstanding amount:</p>\n\n<pre><code>SELECT i.id, i.uuid, i.user_id, i.created_date, i.amount - COALESCE(p.amount, 0) AS amount, i.name\nFROM invoice i\nLEFT JOIN (SELECT uuid, SUM(paid_amount) AS amount\n           FROM invoice_paid\n           GROUP BY uuid) p ON p.uuid = i.uuid\nORDER BY i.id\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>id  uuid    user_id created_date        name    amount\n1   ABC     1       2019-05-01 00:00:00 xa      5\n2   PQR     2       2019-05-05 00:00:00 xb      150\n</code></pre>\n\n<p><a href=\"https://dbfiddle.uk/?rdbms=mariadb_10.2&amp;fiddle=c0833a670f1c5b7d671660f3823ad470\" rel=\"nofollow noreferrer\">Demo on dbfiddle</a></p>\n"}], "owner": {"reputation": 598, "user_id": 9629581, "user_type": "registered", "profile_image": "https://graph.facebook.com/1204435359699826/picture?type=large", "display_name": "Bilguun", "link": "https://stackoverflow.com/users/9629581/bilguun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 56144532, "answer_count": 1, "score": 1, "last_activity_date": 1557908033, "creation_date": 1557907170, "question_id": 56144277, "link": "https://stackoverflow.com/questions/56144277/how-to-select-sum-of-specific-id-in-select-query-mysql-beego", "title": "How to select sum of specific id in select query MySQL, Beego", "body": "<p>I want to get a result like</p>\n\n<pre><code>result \n-------------------------------------------------------\nid | uuid | user_id |created_date |    amount    | name \n-------------------------------------------------------\n1  | ABC  |    1    |   2019/5/1  |      5       | xa\n2  | PQR  |    2    |   2019/5/5  |      150     | xb\n</code></pre>\n\n<p>A query that I trying to use</p>\n\n<pre><code>SELECT(SELECT SUM(paid_amount) WHERE ID = t1.**HERE**) AS sub1,\n(t1.amount - sub1) AS sub2\nFROM invoice t1 CROSS JOIN\ninvoice_paid t2;\n</code></pre>\n\n<p>Table struct in my DB</p>\n\n<pre><code>table invoice_paid        \n------------------------------------\nid | uuid | paid_date | paid_amount\n------------------------------------\n1  | ABC  | 2019/5/1  | 15\n2  | ABC  | 2019/5/5  | 80 \n\ntable invoice\n-------------------------------------------------------\nid | uuid | user_id |created_date |    amount    | name \n-------------------------------------------------------\n1  | ABC  |    1    |   2019/5/1  |      100     | xa\n2  | PQR  |    2    |   2019/5/5  |      150     | xb\n</code></pre>\n\n<p>I can use sum only 1 condition like where id = 1 but how do I combine this query in select query with a join query.\nI use beego(golang), MariaDB </p>\n"}, {"tags": ["go", "azure-iot-hub", "azure-eventhub"], "comments": [{"owner": {"reputation": 1126, "user_id": 3508174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vfMCq.jpg?s=128&g=1", "display_name": "Sergey Narozhnyy", "link": "https://stackoverflow.com/users/3508174/sergey-narozhnyy"}, "edited": false, "score": 0, "creation_date": 1558469287, "post_id": 56143584, "comment_id": 99109763, "body": "Tany, I see it is not implemented yet. So might be worth <a href=\"https://github.com/Azure/azure-event-hubs-go/issues/85#issuecomment-494473104\" rel=\"nofollow noreferrer\">waiting for</a> @devigned to deal with."}, {"owner": {"reputation": 494, "user_id": 6392978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/C7NNr.jpg?s=128&g=1", "display_name": "Opnauticus", "link": "https://stackoverflow.com/users/6392978/opnauticus"}, "edited": false, "score": 0, "creation_date": 1558624481, "post_id": 56143584, "comment_id": 99170825, "body": "Whoops, I misread your question and didn&#39;t see that you were using the EventProcessor. I agree with the above comment - that doesn&#39;t appear to be implemented yet."}], "owner": {"reputation": 972, "user_id": 1942143, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07ea405257dacba3ec422d2755585398?s=128&d=identicon&r=PG", "display_name": "Tany", "link": "https://stackoverflow.com/users/1942143/tany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1558624169, "creation_date": 1557904505, "question_id": 56143584, "link": "https://stackoverflow.com/questions/56143584/go-azure-event-processor-host-to-read-events-from-now", "title": "(Go) Azure Event Processor Host to read events from now?", "body": "<p>I am using azure-event-hubs-go client to read events from an Azure IoTHub. I am creating an Event Processor Host and providing an Handler to process events (as show in the sample in <a href=\"https://github.com/Azure/azure-event-hubs-go\" rel=\"noreferrer\">https://github.com/Azure/azure-event-hubs-go</a>). </p>\n\n<p>How do I set the Event Processor Host to receive events from current time onwards ? I do not see any option like InitialOffsetProvider to set the offset manually.</p>\n\n<p>Ths is similar to <a href=\"https://stackoverflow.com/questions/33881020/how-to-set-the-eventprocessorhost-to-read-events-from-now-on-utc/33908060\">How to set the EventProcessorHost to read events from now on (UTC)?</a> but this is very specifically for Go client.</p>\n"}, {"tags": ["go", "google-cloud-firestore", "google-cloud-functions"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1557905430, "post_id": 56143580, "comment_id": 98917651, "body": "Can you please share the code you are using?"}, {"owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "edited": false, "score": 0, "creation_date": 1588866172, "post_id": 56143580, "comment_id": 109071092, "body": "Hey, any answer? :("}, {"owner": {"reputation": 3977, "user_id": 4057016, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/zBmW8.png?s=128&g=1", "display_name": "thenakulchawla", "link": "https://stackoverflow.com/users/4057016/thenakulchawla"}, "edited": false, "score": 0, "creation_date": 1588984307, "post_id": 56143580, "comment_id": 109120378, "body": "I am also looking for something similar for push notifications."}], "owner": {"reputation": 1, "user_id": 8475620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c9d08384fb0f8a91f07da6f54a96dc0?s=128&d=identicon&r=PG&f=1", "display_name": "Balder Lai", "link": "https://stackoverflow.com/users/8475620/balder-lai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557907030, "creation_date": 1557904493, "last_edit_date": 1557907030, "question_id": 56143580, "link": "https://stackoverflow.com/questions/56143580/how-to-set-cloud-function-trigger-by-firestore-in-go", "title": "How to set cloud function trigger by firestore in GO", "body": "<p>I'm trying to setup a cloud function trigger by firestore, and just use google's sample code \n<a href=\"https://cloud.google.com/functions/docs/calling/cloud-firestore\" rel=\"nofollow noreferrer\">https://cloud.google.com/functions/docs/calling/cloud-firestore</a></p>\n\n<p>I just want to print log for document write event, and i only change that function's name</p>\n\n<p>I deploy go file like this</p>\n\n<p>gcloud functions deploy HelloLogger --runtime go111  --trigger-event providers/cloud.firestore/eventTypes/document.write --trigger-resource projects/[my project id]/databases/default/documents/post/{pushId}</p>\n\n<p>Database looks like this : <a href=\"https://imgur.com/3LSldnK\" rel=\"nofollow noreferrer\">https://imgur.com/3LSldnK</a></p>\n\n<p>and the function page : <a href=\"https://imgur.com/vW5KiJX\" rel=\"nofollow noreferrer\">https://imgur.com/vW5KiJX</a></p>\n\n<p>I create new document and to some update, buy my HelloLogger not logging any message</p>\n\n<p>what went wrong in my function?</p>\n\n<p>EDIT:</p>\n\n<p>fallowing are the sample code I use, almost nothing change</p>\n\n<pre><code>package logger\n\nimport (\n        \"context\"\n        \"fmt\"\n        \"log\"\n        \"time\"\n\n        \"cloud.google.com/go/functions/metadata\"\n)\n\n// FirestoreEvent is the payload of a Firestore event.\ntype FirestoreEvent struct {\n        OldValue   FirestoreValue `json:\"oldValue\"`\n        Value      FirestoreValue `json:\"value\"`\n        UpdateMask struct {\n                FieldPaths []string `json:\"fieldPaths\"`\n        } `json:\"updateMask\"`\n}\n\n// FirestoreValue holds Firestore fields.\ntype FirestoreValue struct {\n        CreateTime time.Time `json:\"createTime\"`\n        // Fields is the data for this value. The type depends on the format of your\n        // database. Log the interface{} value and inspect the result to see a JSON\n        // representation of your database fields.\n        Fields     interface{} `json:\"fields\"`\n        Name       string      `json:\"name\"`\n        UpdateTime time.Time   `json:\"updateTime\"`\n}\n\n// HelloFirestore is triggered by a change to a Firestore document.\nfunc HelloLogger(ctx context.Context, e FirestoreEvent) error {\n        meta, err := metadata.FromContext(ctx)\n        if err != nil {\n                return fmt.Errorf(\"metadata.FromContext: %v\", err)\n        }\n        log.Printf(\"Function triggered by change to: %v\", meta.Resource)\n        log.Printf(\"Old value: %+v\", e.OldValue)\n        log.Printf(\"New value: %+v\", e.Value)\n        return nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1557903921, "post_id": 56143325, "comment_id": 98916911, "body": "That doesn&#39;t set the max file size. It sets the max memory to be used in parsing multi-part requests. They are related, but not the same."}], "answers": [{"tags": [], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "is_accepted": false, "score": 0, "last_activity_date": 1558401565, "creation_date": 1558401565, "answer_id": 56229917, "question_id": 56143325, "link": "https://stackoverflow.com/questions/56143325/gin-web-framework-limit-upload-file-size-not-working/56229917#56229917", "title": "gin web framework limit upload file size not working", "body": "<p>as comment, code</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>  router.MaxMultipartMemory = 1 // 8 MiB\n\n</code></pre>\n\n<p>just limit program can use how much memory when upload file, not limit upload file size.</p>\n"}], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1345, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1558401565, "creation_date": 1557903330, "last_edit_date": 1557906158, "question_id": 56143325, "link": "https://stackoverflow.com/questions/56143325/gin-web-framework-limit-upload-file-size-not-working", "title": "gin web framework limit upload file size not working", "body": "<p>i run the gin example about file upload , this repo is from <a href=\"https://github.com/gin-gonic/examples/tree/5898505356e9064c49abb075eae89596a3c5cd67/upload-file/single\" rel=\"nofollow noreferrer\">https://github.com/gin-gonic/examples/tree/5898505356e9064c49abb075eae89596a3c5cd67/upload-file/single</a>. \nwhen i change is limit </p>\n\n<pre><code>    router.MaxMultipartMemory = 1 // 8 MiB\n</code></pre>\n\n<p>but not woking for upload big file, anyone know this.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nfunc main() {\n\n    router := gin.Default()\n    // Set a lower memory limit for multipart forms (default is 32 MiB)\n    router.MaxMultipartMemory = 1 // 8 MiB\n    fmt.Println(router.MaxMultipartMemory)\n\n    router.Static(\"/\", \"./public\")\n    router.POST(\"/upload\", func(c *gin.Context) {\n        ct := c.Request.Header.Get(\"Content-Type\")\n        fmt.Println(ct)\n        name := c.PostForm(\"name\")\n        email := c.PostForm(\"email\")\n        // Source\n        file, err := c.FormFile(\"file\")\n        if err != nil {\n            c.String(http.StatusBadRequest, fmt.Sprintf(\"get form err: %s\", err.Error()))\n            return\n        }\n\n        if err := c.SaveUploadedFile(file, file.Filename); err != nil {\n            c.String(http.StatusBadRequest, fmt.Sprintf(\"upload file err: %s\", err.Error()))\n            return\n        }\n\n        c.String(http.StatusOK, fmt.Sprintf(\"File %s uploaded successfully with fields name=%s and email=%s.\", file.Filename, name, email))\n    })\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>i expect when file size bigger than limit ,there should be a error.</p>\n\n<h1>update</h1>\n\n<p>misunderstand , the MaxMultipartMemory just limt the memory, not for file upload file size , even file size is more big than this , will write to temp file.</p>\n"}, {"tags": ["go", "methods", "reflection", "types"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1557902769, "post_id": 56143142, "comment_id": 98916342, "body": "<a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_values</a> <i>The method value x.M is a <b>function</b> value that is callable with the same arguments as a method call of x.M.</i>"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557902911, "post_id": 56143142, "comment_id": 98916423, "body": "@mkopriva so can we call <code>t(&amp;obj, a , b)</code> ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1557903033, "post_id": 56143142, "comment_id": 98916498, "body": "@AnkitDeshpande not with a method value, the docs continue on to say that during evaluation a copy of <code>x</code> is saved and used in subsequent calls to the method value as the receiver, therefore &amp;obj is not needed."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1557911255, "last_edit_date": 1557911255, "creation_date": 1557902874, "answer_id": 56143219, "question_id": 56143142, "link": "https://stackoverflow.com/questions/56143142/why-typeofmethod-does-not-return-reflect-method-instance/56143219#56143219", "title": "Why typeof(method) does not return reflect.Method instance?", "body": "<p>As mentioned by mkopriva, what you have is a <a href=\"https://golang.org/ref/spec#Method_values\" rel=\"nofollow noreferrer\">method value</a>: <code>obj.Get</code>. And the method value is a function whose signature is identical to the method's without the receiver type:</p>\n\n<blockquote>\n  <p>If the expression <code>x</code> has static type <code>T</code> and <code>M</code> is in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of type <code>T</code>, <code>x.M</code> is called a <em>method value</em>. The method value <code>x.M</code> is a function value that is callable with the <strong>same arguments as a method call of <code>x.M</code></strong>. The expression x is evaluated and saved during the evaluation of the method value; the saved copy is then used as the receiver in any calls, which may be executed later.</p>\n</blockquote>\n\n<p>If you use a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a> (instead of a method value), the receiver type \"shows\" up in the parameter list (it's always the first):</p>\n\n<pre><code>fmt.Println(reflect.TypeOf((*Foo).Get))\n</code></pre>\n\n<p>Outputs (try it on the <a href=\"https://play.golang.org/p/9GrjyRKb2Bd\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func(*main.Foo, int, string) (string, error)\n</code></pre>\n\n<p>The method expression:</p>\n\n<blockquote>\n  <p>If <code>M</code> is in the <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a> of type <code>T</code>, <code>T.M</code> is a function that is callable as a regular function with the same arguments as <code>M</code> <strong>prefixed by an additional argument that is the receiver of the method</strong>.</p>\n</blockquote>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38897529/golang-pass-method-to-function/38897667#38897667\">golang - pass method to function</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/28251283/golang-function-alias-on-method-receiver/28252088#28252088\">golang function alias on method receiver</a></p>\n"}], "owner": {"reputation": 2507, "user_id": 769097, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/ee769c59ea4469d8251105086b4b6cee?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/769097/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 56143219, "answer_count": 1, "score": 2, "last_activity_date": 1557911255, "creation_date": 1557902598, "last_edit_date": 1557904003, "question_id": 56143142, "link": "https://stackoverflow.com/questions/56143142/why-typeofmethod-does-not-return-reflect-method-instance", "title": "Why typeof(method) does not return reflect.Method instance?", "body": "<p>Let's say I have Foo struct with a method defined as follows:</p>\n\n<pre><code>type Foo struct {\n    Name string\n}\n\nfunc (f *Foo) Get(a int, b string) (string, error) {\n    return f.Name, nil\n}\n</code></pre>\n\n<p>If I write</p>\n\n<pre><code>obj := &amp;Foo{}\nt := reflect.TypeOf(obj.Get)\n</code></pre>\n\n<p><code>t.Kind()</code> returns <code>reflect.Func</code> and apparently I have no way to access information that <code>Get</code> func I extracted type information from \"belongs\" to the <code>Foo</code> struct, that is receiver is of <code>Foo</code> type, it is not even surfaced in the in-parameters.</p>\n\n<p>I guess that's intentional and I miss something fundamental about functions that made language authors throw away receiver information for typeof operations applied to method references.</p>\n\n<p>I have two questions:</p>\n\n<ol>\n<li>Am I correct and there is no way to get receiver type in the snippet with <code>TypeOf</code> call above?</li>\n<li>What are the alternatives I have if I want to pass reflection information about a method to some code that intends to analyze function and related receiver (that is, in essence a method)?</li>\n</ol>\n\n<p>Trying to answer second question myself and based on what I see in the official documentation, it looks like my only options are to either pass TypeOf(receiver) and TypeOf(receiver.method) or TypeOf(receiver) and the name of the receiver's method.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 6, "creation_date": 1557899465, "post_id": 56142381, "comment_id": 98914954, "body": "Unless there&#39;s another branch of the select that you are not showing, use <code>for v := range ch {}</code>.  The code is simpler and easier to understand.  If you need to do the receive inside the loop for some reason, then use <code>for { v, ok := &lt;-ch; if !ok { break } }</code>.  Don&#39;t use select unless you need it."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557899528, "post_id": 56142381, "comment_id": 98914985, "body": "@CeriseLim&#243;n ye i said it is a select with one case"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1557899560, "post_id": 56142381, "comment_id": 98915003, "body": "A rule of thumb: don&#39;t use a select if there&#39;s only one case and no default.  A simple channel operation can do the same thing."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1557899792, "post_id": 56142381, "comment_id": 98915089, "body": "Select with one case is like a switch with just a default case: Use such stuff excessively in obfuscation contests."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557910935, "post_id": 56142381, "comment_id": 98920607, "body": "@CeriseLim&#243;n feel free to move your comment to an answer"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1557957002, "last_edit_date": 1557957002, "creation_date": 1557924351, "answer_id": 56149693, "question_id": 56142381, "link": "https://stackoverflow.com/questions/56142381/is-it-better-to-range-over-channel-or-use-select/56149693#56149693", "title": "Is it better to range over channel or use select?", "body": "<p>Unless there's another branch of the select, use the following:</p>\n\n<pre><code>for v := range ch {\n    // do some stuff\n}\n</code></pre>\n\n<p>The code is simpler and easier to understand than the for/select presented in the question.</p>\n\n<p>If you need to do the receive inside the loop for some reason, then use the following code:</p>\n\n<pre><code> for  { \n     // do some stuff\n     v, ok := &lt;-ch\n     if !ok { \n        break \n     } \n     // do some other stuff\n }\n</code></pre>\n\n<p>As a rule of thumb, single branch select statements should be avoided. A select with a single branch is functionally the same as the branch alone. </p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5283994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBQB8.jpg?s=128&g=1", "display_name": "kylehqcom", "link": "https://stackoverflow.com/users/5283994/kylehqcom"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1609104358, "post_id": 65459869, "comment_id": 115749359, "body": "That&#39;s exactly what my &quot;simplified&quot; version does, there is no for loop? Did you only see the verbose/incorrect version? Even in my comment &quot;then you can drop the for loop entirely&quot;"}], "tags": [], "owner": {"reputation": 41, "user_id": 5283994, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NBQB8.jpg?s=128&g=1", "display_name": "kylehqcom", "link": "https://stackoverflow.com/users/5283994/kylehqcom"}, "is_accepted": false, "score": -1, "last_activity_date": 1609010278, "creation_date": 1609010278, "answer_id": 65459869, "question_id": 56142381, "link": "https://stackoverflow.com/questions/56142381/is-it-better-to-range-over-channel-or-use-select/65459869#65459869", "title": "Is it better to range over channel or use select?", "body": "<p>If you are simply awaiting on a done channel where you do not need the value returned, then you can drop the for loop entirely as the chan will block. Eg</p>\n<pre><code>// Verbose\ngo func() {\n    for {\n        select {\n            case &lt;-blah.Context.Done():\n                // Cleanup/Close\n                return\n        }\n    }\n}()\n\n// Simplified\ngo func() {\n    &lt;-blah.Context.Done():\n    // Cleanup/Close (No return required either)\n}()\n</code></pre>\n"}], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1204, "favorite_count": 1, "accepted_answer_id": 56149693, "answer_count": 2, "score": 5, "last_activity_date": 1609010278, "creation_date": 1557898697, "last_edit_date": 1557899214, "question_id": 56142381, "link": "https://stackoverflow.com/questions/56142381/is-it-better-to-range-over-channel-or-use-select", "title": "Is it better to range over channel or use select?", "body": "<p>guys i was wondering if it is better to to range over channel or use select, if I have only one case (my channel) and signal the end with close of the given channel ?</p>\n\n<p>Given the examples:</p>\n\n<h3>1. <a href=\"https://play.golang.org/p/3ZFdbgHSKyN\" rel=\"noreferrer\">https://play.golang.org/p/3ZFdbgHSKyN</a></h3>\n\n<pre><code>go func() {\n    for v := range ch {\n        // do some stuff\n    }\n}()\n</code></pre>\n\n<h3>2. <a href=\"https://play.golang.org/p/iCCkDge8j72\" rel=\"noreferrer\">https://play.golang.org/p/iCCkDge8j72</a></h3>\n\n<pre><code>go func() {\n    for {\n        select {\n        case v, ok := &lt;-ch:\n            if !ok {\n                return\n            }\n\n            // do some stuff\n        }\n    }\n}()\n</code></pre>\n\n<p>Which solution would be preferred and why ? Please consider the fact that goroutines as such might be spawned many times (many workers).</p>\n"}, {"tags": ["go", "cgo", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557903589, "post_id": 56142641, "comment_id": 98916782, "body": "thanks, but when i use go get, i got all the c dynamic libraries. I suppose go get or go module just download use vcs like git to download package, and don&#39;t concern what the package is, is it like this?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557904036, "post_id": 56142641, "comment_id": 98916961, "body": "@lihaichao I have to admit I do not understand what you are asking. Running <code>go get</code> will install all Go related dependencies and <i>nothing</i> else. No fonts, no shared libraries, no nothing."}, {"owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557904658, "post_id": 56142641, "comment_id": 98917255, "body": "I thought go get will fetching  like <a href=\"https://github.com//test?go-get=1\" rel=\"nofollow noreferrer\">github.com//test?go-get=1</a>, and parsing meta tags of reply to get the git url, then use git to clone the package"}, {"owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557904689, "post_id": 56142641, "comment_id": 98917270, "body": "So i suppose go get will not concern what kind of file is in the package"}, {"owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557904825, "post_id": 56142641, "comment_id": 98917327, "body": "And right now, go module will download the c shared libraries of my package, but not all of them, go module only downloaded the shared libraries that isn&#39;t soft link"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 1, "creation_date": 1557905459, "post_id": 56142641, "comment_id": 98917668, "body": "go get clones a repo. Whatever is in the repo is cloned. This is not a subtitute for installing stuff to your system."}, {"owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "edited": false, "score": 0, "creation_date": 1557906610, "post_id": 56142641, "comment_id": 98918294, "body": "oh, thanks. So is this mean that i can&#39;t put c shared libraries in my package?  Is here  an option about how go get install package?"}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1557900273, "creation_date": 1557900273, "answer_id": 56142641, "question_id": 56141846, "link": "https://stackoverflow.com/questions/56141846/go-module-didnt-download-cgo-soft-links-of-dynamic-library-correctly/56142641#56142641", "title": "go module didn&#39;t download cgo soft links of dynamic library correctly", "body": "<p>Go (in modules mode as well as in GOPATH mode) is concerned <em>only</em> with Go source code and will download only Go packages (which might contain C code) but it <em>never</em> installs shared libraries on your system or does other installation work (like creating symlinks).</p>\n\n<p>There is <em>no</em> <em>way</em> you can convince or force the <code>go</code> tool to do what you think it should do.</p>\n\n<p>Install the required shared object files and the necessary symlinks in any other means you find convenient n your system.</p>\n"}], "owner": {"reputation": 25, "user_id": 11501649, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58b0772493acf611a86a4da4534e1f22?s=128&d=identicon&r=PG&f=1", "display_name": "lihaichao", "link": "https://stackoverflow.com/users/11501649/lihaichao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557973398, "creation_date": 1557895016, "last_edit_date": 1557973398, "question_id": 56141846, "link": "https://stackoverflow.com/questions/56141846/go-module-didnt-download-cgo-soft-links-of-dynamic-library-correctly", "title": "go module didn&#39;t download cgo soft links of dynamic library correctly", "body": "<p>The environment is ubuntu 16.04 64bit, go version go1.12 linux/amd64</p>\n\n<p>I am trying to switch my golang project from gopath to gomodule. One of the packages my project imported is using cgo to call ffmpeg, the package have several dynamic ffmpeg libraries, for example, libavcodec.so, libavcodec.so.57, libavcodec.so.57.107.100, the first two files is soft link file\nThe problem is when I go build my golang project, go module only download libavcodec.so.57.107.100, it didn't download the two soft link file</p>\n\n<p>I tried to go get the package, and successfully get all the libraries including soft link file</p>\n\n<p>I expect go module download all c dynamic libraries files including soft link files, but I didn't get the soft link files</p>\n\n<hr>\n\n<p>Update: I submitted a issue in github, and seemed that this is intentional, see <a href=\"https://github.com/golang/go/issues/32050\" rel=\"nofollow noreferrer\">issue #32050</a></p>\n"}, {"tags": ["http", "go", "testing"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 2, "creation_date": 1557894985, "post_id": 56141783, "comment_id": 98913595, "body": "Is there a reason you don&#39;t want to test <code>sanityTest</code> directly with <code>httptest.ResponseRecorder</code>?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1557897143, "post_id": 56141783, "comment_id": 98914186, "body": "Create a function that creates a mux, configures handlers in that mux and returns the mux as an http.Handler.  in main:  <code>log.Fatal(http.ListenAndServe(&quot;:8000&quot;, setupMux())</code>  In tests:  <code>server := httptest.NewServer(setupMux())</code>.  Because it&#39;s difficult to audit additions to http.DefaultServeMux, it&#39;s usually best to avoid http.DefaultServeMux in any serious application."}], "answers": [{"comments": [{"owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "edited": false, "score": 1, "creation_date": 1557927655, "post_id": 56143681, "comment_id": 98930915, "body": "Keep up the videos. I updated <a href=\"https://travis-ci.org/kaihendry/count/builds/532820235?utm_source=github_status&amp;utm_medium=notification\" rel=\"nofollow noreferrer\">travis-ci.org/kaihendry/count/builds/&hellip;</a> with your advice."}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 2, "last_activity_date": 1557904906, "creation_date": 1557904906, "answer_id": 56143681, "question_id": 56141783, "link": "https://stackoverflow.com/questions/56141783/minimal-http-service-test-without-resetting-up-routes/56143681#56143681", "title": "Minimal http service test without resetting up routes?", "body": "<p>You can re-use routes between tests and main.go file, also it's helpful if you want to mock something in your handlers (add a new argument to <code>router()</code> func below)</p>\n\n<p>main.go:</p>\n\n<pre><code>func sanityTest(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"%s\", \"sanity test\")\n}\n\nfunc router() *http.ServeMux {\n    h := http.NewServeMux()\n    h.HandleFunc(\"/\", sanityTest)\n    return h\n}\n\nfunc main() {\n    http.ListenAndServe(\":8080\", router())\n}\n</code></pre>\n\n<p>main_test.go:</p>\n\n<pre><code>func TestSanity(t *testing.T) {\n    tests := []struct {\n        name string\n        uri  string\n        want string\n    }{\n        {\"1\", \"/\", \"sanity test\"},\n    }\n\n    ts := httptest.NewServer(router())\n    defer ts.Close()\n\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            url := ts.URL + tt.uri\n            resp, _ := http.Get(url)\n            respBody, _ := ioutil.ReadAll(resp.Body)\n            resp.Body.Close()\n\n            got := string(respBody)\n            if got != tt.want {\n                t.Errorf(\"got %s, Want %s\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8233, "user_id": 4534, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/29ab3f223a10c7b19916ea38141da74d?s=128&d=identicon&r=PG", "display_name": "hendry", "link": "https://stackoverflow.com/users/4534/hendry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56143681, "answer_count": 1, "score": -1, "last_activity_date": 1557904906, "creation_date": 1557894533, "question_id": 56141783, "link": "https://stackoverflow.com/questions/56141783/minimal-http-service-test-without-resetting-up-routes", "title": "Minimal http service test without resetting up routes?", "body": "<p>Say I have a very simple Web service.</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", sanityTest)\n    log.Fatal(http.ListenAndServe(\":8000\", nil))\n}\n</code></pre>\n\n<p>If I want to test it, I could minimally just have:</p>\n\n<pre><code>func ExampleTest() {\n        server := httptest.NewServer(http.DefaultServeMux)\n        defer server.Close()\n\n        resp, err := http.Get(server.URL)\n        if err != nil {\n                log.Fatal(err)\n        }\n        body, _ := ioutil.ReadAll(resp.Body)\n\n        fmt.Println(resp.StatusCode)\n        fmt.Println(resp.Header.Get(\"Content-Type\"))\n        fmt.Println(string(body))\n\n        // Output:\n        // 200\n        // text/plain; charset=utf-8\n        // OK\n\n}\n</code></pre>\n\n<p>But that will result in a 404, since it doesn't know about the routes. So what I've seen main_test.go code do, is re-setup the handles in the test file's init, like so:</p>\n\n<pre><code>func init() {\n    http.HandleFunc(\"/\", sanityTest)\n}\n</code></pre>\n\n<p>Which leads to duplication, and inevitably I have to create a function in main.go like:</p>\n\n<pre><code>func setupRoutes() {\n        http.HandleFunc(\"/\", sanityTest)\n}\n</code></pre>\n\n<p>Which I find a little ugly. Am I missing a trick to instantiate the routes from main.go and avoid the init?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 3, "creation_date": 1557894740, "post_id": 56141530, "comment_id": 98913543, "body": "visit the go-tour to get a refresher on pointers vs. values: <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">tour.golang.org/moretypes/1</a>"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1557896095, "post_id": 56141530, "comment_id": 98913878, "body": "Sometimes the compiler is helping you with defining the pointer. So maybe both can work."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1557899485, "creation_date": 1557899485, "answer_id": 56142506, "question_id": 56141530, "link": "https://stackoverflow.com/questions/56141530/what-is-the-difference-between-http-client-and-http-client-in-go-version-1/56142506#56142506", "title": "what is the difference between &#39;http.Client&#39; and &#39;&amp;http.Client&#39; in go version 1.12", "body": "<blockquote>\n  <p>The best practices is?</p>\n</blockquote>\n\n<p>The best practice is to learn the fundamental concept of the language. Here values and pointers. A starting point is <a href=\"https://tour.golang.org/moretypes/1\" rel=\"nofollow noreferrer\">https://tour.golang.org/moretypes/1</a> (or better the whole Tour).</p>\n\n<p>It is of little value to memorize whether to use &amp;http.Client{} or http.Client{}.</p>\n\n<p>And if in doubt: Just peek at the standard library, e.g. with <code>go doc -src net/http.DefaultClient</code>.</p>\n"}], "owner": {"reputation": 71, "user_id": 10125510, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_qfS36ltJTU/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7qctxv4YWwWczLPQY4IbzDYIiR20A/mo/photo.jpg?sz=128", "display_name": "xu feng", "link": "https://stackoverflow.com/users/10125510/xu-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557899485, "creation_date": 1557892348, "question_id": 56141530, "link": "https://stackoverflow.com/questions/56141530/what-is-the-difference-between-http-client-and-http-client-in-go-version-1", "title": "what is the difference between &#39;http.Client&#39; and &#39;&amp;http.Client&#39; in go version 1.12", "body": "<p>I'm creating a http request by 'net/http', the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">official document</a> use <code>&amp;http.Client{}</code>, but I try to delete <code>&amp;</code> can run normally.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>client := &amp;http.Client{}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>client := http.Client{}\n</code></pre>\n\n<p>What is the difference between two way? The best practices is?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557888352, "post_id": 56141009, "comment_id": 98912386, "body": "I have figured that much out. I am trying to find out if there is a way to handle both the format of the &quot;Points&quot; key ([]float64) as well as the &quot;Polygon&quot; key ([][]float64)."}, {"owner": {"reputation": 12299, "user_id": 609290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/WUBht.jpg?s=128&g=1", "display_name": "DazWilkin", "link": "https://stackoverflow.com/users/609290/dazwilkin"}, "edited": false, "score": 0, "creation_date": 1557888409, "post_id": 56141009, "comment_id": 98912399, "body": "I think you can&#39;t do it with a struct because, as you point out, you&#39;d need two alternatives for <code>Coordinates</code> both <code>[]float64</code> and <code>[][]float64</code>. One solution would be to pre-process the API output and convert any <code>Coordinates</code> of type <code>[]float64</code> to <code>[][]float64</code> so that every <code>Coordinates</code> is the same type and then marshal that. Alternatively -- not done this -- could you define <code>Coordinates</code> as <code>interface{}</code> and then post-process these?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1557889469, "last_edit_date": 1557889469, "creation_date": 1557888972, "answer_id": 56141169, "question_id": 56141009, "link": "https://stackoverflow.com/questions/56141009/how-to-parse-variable-depth-arrays-into-a-struct-from-json/56141169#56141169", "title": "How to parse variable depth arrays into a struct from JSON", "body": "<p>Use <a href=\"https://godoc.org/encoding/json#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> to capture the value that varies by geometry type:</p>\n\n<pre><code>Geometries []struct {\n    Type        string          `json:\"type\"`\n    Coordinates json.RawMessage `json:\"coordinates\"`\n} `json:\"geometries\"`\n</code></pre>\n\n<p>Unmarshal the coordinates to a value appropriate for each type:</p>\n\n<pre><code>for _, geo := range x.Geometries {\n    switch geo.Type {\n    case \"Point\":\n        var coords []float64\n        if err := json.Unmarshal(geo.Coordinates, &amp;coords); err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(coords)\n    case \"Polygon\":\n        var coords [][][]float64\n        if err := json.Unmarshal(geo.Coordinates, &amp;coords); err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(coords)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ZKaFtF055Hs\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p>Another option is to unmarshal to <code>interface{}</code> and use <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertions</a> to dig through the value:</p>\n\n<pre><code>Geometries []struct {\n    Type        string      `json:\"type\"`\n    Coordinates interface{} `json:\"coordinates\"`\n} `json:\"geometries\"`\n\n...\n\nfor _, geo := range x.Geometries {\n    fmt.Println(geo.Type)\n    dump(geo.Coordinates, \"\")\n}\n\n...\n\nfunc dump(v interface{}, indent string) {\n    switch v := v.(type) {\n    case []interface{}:\n        fmt.Println(indent, \"[\")\n        for _, v := range v {\n            dump(v, indent+\"  \")\n        }\n        fmt.Println(indent, \"]\")\n    default:\n        fmt.Println(indent, v)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/fOESzW4eyEw\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 423, "user_id": 6696730, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9739bd34a651dd139cc0e7061dbff95d?s=128&d=identicon&r=PG&f=1", "display_name": "K Pekosh", "link": "https://stackoverflow.com/users/6696730/k-pekosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1557904001, "creation_date": 1557887477, "last_edit_date": 1557904001, "question_id": 56141009, "link": "https://stackoverflow.com/questions/56141009/how-to-parse-variable-depth-arrays-into-a-struct-from-json", "title": "How to parse variable depth arrays into a struct from JSON", "body": "<p>I am parsing JSON from an API into a struct. My code representing the struct is not working, and I have noticed that it is because the API is returning variable depth arrays (e.g. sometimes []float64, sometimes [][]float64). I do not know how to design a struct to handle this.</p>\n\n<p>I have tried messing with my struct definition by swapping out the offending type between []float64, [][]float64, and []interface{}.</p>\n\n<p>My code for my struct definition:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>...\nGeometries []struct {\n    Type        string    `json:\"type\"`\n    Coordinates []float64 `json:\"coordinates\"`\n} `json:\"geometries\"`\n...\n</code></pre>\n\n<p>Below is a sample output from the API:</p>\n\n<pre><code>...\n\"geometries\": [{\"type\": \"Point\", \"coordinates\": [-81.7046006, 41.4955689]}, {\"type\": \"Polygon\", \"coordinates\": [[[-81.7176885, 41.507513], [-81.7205424, 41.4857622], [-81.6915158, 41.4836231], [-81.6886557, 41.5053737], [-81.7176885, 41.507513]]]}]\n...\n</code></pre>\n\n<p>I expect the JSON to parse into the struct. Instead, I see the following error with the code:\n<code>json: cannot unmarshal array into Go struct field .coordinates of type float64</code></p>\n"}, {"tags": ["go", "cockroachdb"], "answers": [{"tags": [], "owner": {"reputation": 20703, "user_id": 2805033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TasHL.jpg?s=128&g=1", "display_name": "Ben Darnell", "link": "https://stackoverflow.com/users/2805033/ben-darnell"}, "is_accepted": false, "score": 1, "last_activity_date": 1557888262, "creation_date": 1557888262, "answer_id": 56141082, "question_id": 56140779, "link": "https://stackoverflow.com/questions/56140779/return-row-id-created-by-cockroachdb-after-a-transaction/56141082#56141082", "title": "Return row ID created by CockroachDB after a transaction", "body": "<p>You've got the right idea: declare variables outside the transaction and assign them inside the transaction closure. This is the idiomatic way to \"return\" things in Go from a closure like this, since the only alternative is to have the function return an <code>interface{}</code> which would need a runtime cast to be useful. </p>\n\n<p>There are a couple of shortcuts available here: since <code>responseStruct</code> and <code>res</code> are the same type, you don't need to list all the fields. You can simply say <code>responseStruct = res</code>.</p>\n\n<p>You can even assign the result of <code>myTransaction</code> directly to <code>responseStruct</code>, avoiding the temporary <code>res</code> entirely. However, you have to be careful with your variable scopes here - you can't use <code>:=</code> because that would create a new <code>responseStruct</code> inside the closure. Instead, you must declare all <em>other</em> variables (here, <code>err</code>) so that you can use the plain <code>=</code> assignment:</p>\n\n<pre><code>var responseStruct MyTxnResponse\nerr := crdb.ExecuteTx(context.Background(), db, nil, func(tx *sql.Tx) error {\n    var err error\n    responseStruct, err = myTransaction(ctx, tx)\n    return err\n})\n// use responseStruct (but only if err is nil)\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11501488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7bbedbdec17c075c3911ea52321333b?s=128&d=identicon&r=PG&f=1", "display_name": "luvu", "link": "https://stackoverflow.com/users/11501488/luvu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557888262, "creation_date": 1557885105, "question_id": 56140779, "link": "https://stackoverflow.com/questions/56140779/return-row-id-created-by-cockroachdb-after-a-transaction", "title": "Return row ID created by CockroachDB after a transaction", "body": "<p>After executing a cockroachDB transaction which creates a row, I would like to return that id to my application.</p>\n\n<p>I am currently defining a transaction using the <code>database/sql</code> golang package. I then use the <code>crdb</code> client to execute the transaction against CockroachDB.</p>\n\n<p>I cannot return anything from the <code>crdb</code> transaction except for an error relating to the <code>crdb</code> transaction itself. How do people retrieving their most recently created rows if the interface does not provide a way to return a new row id?</p>\n\n<p>I have some transaction that executes two inserts. I get the resulting ids of those inserts and return a response with both of those id values.</p>\n\n<pre><code>func myTransaction(ctx context.Context, tx *sql.Tx) (MyTxnResponse, error) {\n  var aResult string\n  if err := tx.QueryRowContext(ctx, `INSERT INTO foo (a,b,c) VALUES (1,2,3) RETURNING foo_id`).Scan(&amp;aResult); err != nil { ... }\n\n  var bResult string\n  if err := tx.QueryRowContext(ctx, `INSERT INTO bar (d,e,f) VALUES (4,5,6) RETURNING bar_id`).Scan(&amp;bResult); err != nil { ... }\n\n  return MyTxnResponse{A: aResult, B: bResult}\n}\n</code></pre>\n\n<p>Now, I want to execute the transaction against CRDB</p>\n\n<pre><code>var responseStruct MyTxnResponse\nerr := crdb.ExecuteTx(ctx.Background(), db, nil, func(tx *sql.Tx) error {\n    res, err := myTransaction(ctx,tx)\n\n    // This is what I am currently doing... it seems bad\n    responseStruct.A = res.A\n    responseStruct.B = res.B\n\n    return err\n}\n... use responseStruct for something\n</code></pre>\n\n<p>I am able to get the result of the transaction by using this external var solution and just mutating it's state in the closure, but that seems like a really bad pattern. I'm sure I'm missing something that will blow up in my face if I keep this pattern.</p>\n\n<p>Is there a standard way to return something from a transaction?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557884753, "post_id": 56140620, "comment_id": 98911797, "body": "I assume you want to the size of the file transformed into <code>base64</code>, correct?"}, {"owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1557889508, "post_id": 56140620, "comment_id": 98912589, "body": "@colminator, i want get the original file size from datas"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557936665, "post_id": 56140620, "comment_id": 98936604, "body": "<a href=\"https://golang.org/pkg/encoding/base64/#Encoding.DecodedLen\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/base64/#Encoding.DecodedLen</a>"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "edited": false, "score": 0, "creation_date": 1557888869, "post_id": 56140773, "comment_id": 98912476, "body": "about 3, the string not ends with &quot;==&quot; or end with &quot;=&quot;"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557894208, "post_id": 56140773, "comment_id": 98913421, "body": "Almost. The &quot;bit loss&quot; number <code>y</code> needs to be moved inside the parenthesis - then divide by 4."}], "tags": [], "owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "is_accepted": false, "score": 0, "last_activity_date": 1557885053, "creation_date": 1557885053, "answer_id": 56140773, "question_id": 56140620, "link": "https://stackoverflow.com/questions/56140620/how-to-get-original-file-size-from-base64-encode-string/56140773#56140773", "title": "how to get original file size from base64 encode string", "body": "<p>Well, base64 encoded string has different length then original file. To get original size you can do next:\n1. In function <code>encodeFile</code> return <code>len(content)</code> which is size of original file.</p>\n\n<ol start=\"2\">\n<li>OR you can calculate the file size using below formula:</li>\n</ol>\n\n<p>x = (n * (3/4)) - y\nWhere:</p>\n\n<ol>\n<li>x is the size of a file in bytes</li>\n<li>n is the <code>len(datas)</code></li>\n<li>y will be 2 if Base64 ends with '==' and 1 if Base64 ends with '='.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 0, "last_activity_date": 1557893664, "creation_date": 1557893664, "answer_id": 56141678, "question_id": 56140620, "link": "https://stackoverflow.com/questions/56140620/how-to-get-original-file-size-from-base64-encode-string/56141678#56141678", "title": "how to get original file size from base64 encode string", "body": "<p>This should do it:</p>\n\n<pre><code>func calcOrigBinaryLength(datas string) int {\n\n    l := len(datas)\n\n    // count how many trailing '=' there are (if any)\n    eq := 0\n    if l &gt;= 2 {\n        if datas[l-1] == '=' {\n            eq++\n        }\n        if datas[l-2] == '=' {\n            eq++\n        }\n\n        l -= eq\n    }\n\n    // basically:\n    //\n    // eq == 0 :    bits-wasted = 0\n    // eq == 1 :    bits-wasted = 2\n    // eq == 2 :    bits-wasted = 4\n\n    // each base64 character = 6 bits\n\n    // so orig length ==  (l*6 - eq*2) / 8\n\n    return (l*3 - eq) / 4\n}\n</code></pre>\n\n<p>Playground validation: <a href=\"https://play.golang.org/p/Y4v102k74V5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Y4v102k74V5</a></p>\n"}], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "accepted_answer_id": 56141678, "answer_count": 2, "score": 0, "last_activity_date": 1557893664, "creation_date": 1557883479, "last_edit_date": 1557889595, "question_id": 56140620, "link": "https://stackoverflow.com/questions/56140620/how-to-get-original-file-size-from-base64-encode-string", "title": "how to get original file size from base64 encode string", "body": "<p>I want to get  size of the original file from a string variable, which is obtained by using a base64 encode file.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>\n\npackage main\n\nimport (\n    \"bufio\"\n    \"encoding/base64\"\n    \"io/ioutil\"\n    \"os\"\n)\n\nfunc encodeFile(file string) string {\n    f, err := os.Open(file)\n    if err != nil {\n        panic(err)\n    }\n\n    reader := bufio.NewReader(f)\n    content, _ := ioutil.ReadAll(reader)\n    encoded := base64.StdEncoding.EncodeToString(content)\n    return encoded\n}\n\nfunc main() {\n    datas := encodeFile(\"/tmp/hello.json\")\n    //how to get  file size from datas\n}\n</code></pre>\n\n<p>how to get the file size from <code>datas</code>? thks.</p>\n"}, {"tags": ["go", "aes"], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 4967572, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh3.googleusercontent.com/-nC0Nx6Cz-RA/AAAAAAAAAAI/AAAAAAAAABY/0zyI_Lm338M/photo.jpg?sz=128", "display_name": "Larry Robertson", "link": "https://stackoverflow.com/users/4967572/larry-robertson"}, "is_accepted": false, "score": 0, "last_activity_date": 1557887379, "last_edit_date": 1557887379, "creation_date": 1557886664, "answer_id": 56140933, "question_id": 56140458, "link": "https://stackoverflow.com/questions/56140458/what-does-crypto-cipher-xorkeystream-do-to-the-src-byte/56140933#56140933", "title": "What does crypto/cipher-XORKeyStream do to the src []byte?", "body": "<p>I'm not familiar a crypto/cypher-XORKeyStream but I can tell you what XOR does to bits if that is helpfull.  I have some Electronic experience and here is the truth table to an XOR gate:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6H7pe.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6H7pe.jpg\" alt=\"XOR Gate Truth Table\"></a></p>\n\n<p>Inputs X and Y represent two bits. The output Z is the result of XOR-ing X and Y.</p>\n\n<p>In English you would say to yourself \"Inputs, either one or the other but not both\" results in an output of \"True\". </p>\n\n<p>Don't know how much help this will be or how to apply it to more than two input bits with a crypto/cypher-XORKeyStream.\nBut here would be an example:</p>\n\n<pre><code>X = 00110001010\nY = 11111111111\nZ = 11001110101\n</code></pre>\n\n<p>Good Luck!</p>\n"}], "owner": {"reputation": 11, "user_id": 9894814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa23ae8fbd724172c3a73263f7c9289c?s=128&d=identicon&r=PG&f=1", "display_name": "Ou_Satoru", "link": "https://stackoverflow.com/users/9894814/ou-satoru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557887379, "creation_date": 1557881740, "last_edit_date": 1557884323, "question_id": 56140458, "link": "https://stackoverflow.com/questions/56140458/what-does-crypto-cipher-xorkeystream-do-to-the-src-byte", "title": "What does crypto/cipher-XORKeyStream do to the src []byte?", "body": "<p>I'm doing AES encryption using Go, I found that the source bytes changed after encryption. Seems that XORKeyStream function does the change if cap(source) > len(source), what it exactly does to the src []byte?</p>\n\n<p>go version go1.12.5 darwin/amd64</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    byte1 := []byte(\"123abc\")\n    fmt.Println(\"content1:\", byte1, \"len1:\", len(byte1), \"cap1:\", cap(byte1)) // content1: [49 50 51 97 98 99] len1: 6 cap1: 6\n    buf := bytes.NewBuffer([]byte(\"123abc\"))\n    byte2, _ := ioutil.ReadAll(buf)\n    fmt.Println(\"content2:\", byte2, \"len2:\", len(byte2), \"cap2:\", cap(byte2)) // content2: [49 50 51 97 98 99] len2: 6 cap2: 1536\n\n    _, _, _, err := crypt.AESEnc(byte1)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"content1:\", byte1, \"len1:\", len(byte1), \"cap1:\", cap(byte1)) // content1: [49 50 51 97 98 99] len1: 6 cap1: 6\n    _, _, _, err = crypt.AESEnc(byte2)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(\"content2:\", byte2, \"len2:\", len(byte2), \"cap2:\", cap(byte2)) // content2: [132 200 7 200 195 8] len2: 6 cap2: 1536\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func AESEnc(data []byte) ([]byte, []byte, string, error) {\n    key := make([]byte, 16)\n    iv := make([]byte, 16)\n    _, err := io.ReadFull(rand.Reader, key)\n    if err != nil {\n        return nil, nil, \"\", err\n    }\n    _, err = io.ReadFull(rand.Reader, iv)\n    if err != nil {\n        return nil, nil, \"\", err\n    }\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, nil, \"\", err\n    }\n    pdata := pckspadding(data, block.BlockSize())\n    stream := cipher.NewCFBEncrypter(block, iv)\n    stream.XORKeyStream(pdata, pdata)\n    return key, iv, base64.StdEncoding.EncodeToString(pdata), nil\n}\n\nfunc pckspadding(ciphertext []byte, blockSize int) []byte {\n    padding := blockSize - len(ciphertext)%blockSize\n    padtext := bytes.Repeat([]byte{byte(padding)}, padding)\n    return append(ciphertext, padtext...)\n}\n</code></pre>\n\n<p>byte2 changes after encryption, what happened?</p>\n"}, {"tags": ["go", "go-gorm", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1557886656, "post_id": 56140631, "comment_id": 98912104, "body": "It works but while returning gives error  cannot use countries (type *[]DbModel.MpCountry) as type DbModel.MpCountry in return argument  <b>func GetCountryCodeAndName(DbModel.MpCountry)(         countries := &amp;[]DbModel.MpCountry{}         DbModel.DB.Debug().Find(countries)         fmt.Println(*countries)         fmt.Println(&quot;test&quot;)         return countries }</b>"}, {"owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "reply_to_user": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1557955823, "post_id": 56140631, "comment_id": 98944727, "body": "What&#39;s the return type of your function?"}, {"owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1557960638, "post_id": 56140631, "comment_id": 98945934, "body": "Before you suggested changes above, I was using <b>DbModel.MpCountry</b>  but after changing code as per above changes, It give error  <b>cannot use countries (type *[]DbModel.MpCountry) as type DbModel.MpCountry in return argument</b>    I tried many things but not able to resolve"}, {"owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "reply_to_user": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1557961499, "post_id": 56140631, "comment_id": 98946112, "body": "Looks like you&#39;re trying to return the slice instead of the single struct that it&#39;s expecting. Change the function to return a slice instead."}], "tags": [], "owner": {"reputation": 1035, "user_id": 8685016, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-W693VKuEKv0/AAAAAAAAAAI/AAAAAAAAABM/v4pY2Z8NYB4/photo.jpg?sz=128", "display_name": "robbieperry22", "link": "https://stackoverflow.com/users/8685016/robbieperry22"}, "is_accepted": true, "score": 0, "last_activity_date": 1557883626, "creation_date": 1557883626, "answer_id": 56140631, "question_id": 56140303, "link": "https://stackoverflow.com/questions/56140303/how-to-display-all-records-using-struct/56140631#56140631", "title": "How to display all records using struct", "body": "<p>You are only passing in a struct, not a slice of structs. It is therefore replacing the values in the struct, until it reaches the last record.</p>\n\n<p>Instead, pass in a pointer to a slice:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>countries := &amp;[]DbModel.MpCountry{}\nDbModel.DB.Debug().Find(countries)\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 56140631, "answer_count": 1, "score": 1, "last_activity_date": 1597435929, "creation_date": 1557880295, "last_edit_date": 1597435929, "question_id": 56140303, "link": "https://stackoverflow.com/questions/56140303/how-to-display-all-records-using-struct", "title": "How to display all records using struct", "body": "<p>I am trying to fetch all data from a table. It returns all data but it is displaying only the last record. I am using GORM and GIN with Golang.</p>\n\n<p>I tried to create a struct and pass that struct to the <code>Find</code> method.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type MpCountry struct{\n        id uint\n        Iso string\n        Name string\n        Nicename string\n        Iso3 string\n        Numcode uint\n        phonecode uint\n}\n</code></pre>\n\n<p>Code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>countries:=  DbModel.MpCountry{}\nDbModel.DB.Debug().Find(&amp;countries)\nfmt.Println(countries)\nfmt.Println(\"test\")\nlog.Printf(\"%+v\", countries)\nreturn  &amp;countries\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>SELECT * FROM `mp_countries`\n[239 rows affected or returned ]\n\n{id:0 Iso:ZW Name:ZIMBABWE Nicename:Zimbabwe Iso3:ZWE Numcode:716 phonecode:0}\n</code></pre>\n"}, {"tags": ["http", "go", "cookies", "go-gin"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557876891, "post_id": 56139310, "comment_id": 98910406, "body": "<code>2019&#47;05&#47;15 01:23:46</code> is a prefix added by the log package.  The value of the Expires field is <code>0001-01-01 00:00:00 +0000 UTC</code>, the zero value for time.Time."}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 7622324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0ce92942a6cf8be13def73772e99091?s=128&d=identicon&r=PG&f=1", "display_name": "Omer Lubin", "link": "https://stackoverflow.com/users/7622324/omer-lubin"}, "edited": false, "score": 0, "creation_date": 1557877468, "post_id": 56139905, "comment_id": 98910544, "body": "Oh well. That kinda sucks. Thing is, while using <code>http.Request.Cookie()</code> it seemed to work. Did it just look like it&#39;s working? Or is it something about GinGonic? And how could I solve it in a decent way?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 408, "user_id": 7622324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0ce92942a6cf8be13def73772e99091?s=128&d=identicon&r=PG&f=1", "display_name": "Omer Lubin", "link": "https://stackoverflow.com/users/7622324/omer-lubin"}, "edited": false, "score": 0, "creation_date": 1557878327, "post_id": 56139905, "comment_id": 98910703, "body": "This has nothing to do with GinGonic.  Clients do not send the expiration time. Look for a &quot;secure cookie&quot; package. Most of these packages include an expiration time in the cookie value."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1557876553, "creation_date": 1557876553, "answer_id": 56139905, "question_id": 56139310, "link": "https://stackoverflow.com/questions/56139310/how-to-check-if-a-cookie-is-expired/56139905#56139905", "title": "How to check if a cookie is expired", "body": "<p>Because clients send names and values only in a <a href=\"https://tools.ietf.org/html/rfc6265#section-4.2\" rel=\"nofollow noreferrer\">Cookie header</a>, the Name and Value fields are the only fields set in this context. The <a href=\"https://godoc.org/net/http#Cookie.Expires\" rel=\"nofollow noreferrer\">Expires</a> field has the time.Time <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero value</a> as the log output indicates.</p>\n\n<p>The application must do something outside of the cookie protocol to determine if the cookie is still valid. </p>\n"}], "owner": {"reputation": 408, "user_id": 7622324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0ce92942a6cf8be13def73772e99091?s=128&d=identicon&r=PG&f=1", "display_name": "Omer Lubin", "link": "https://stackoverflow.com/users/7622324/omer-lubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 0, "accepted_answer_id": 56139905, "answer_count": 1, "score": 1, "last_activity_date": 1585483495, "creation_date": 1557871946, "last_edit_date": 1585483495, "question_id": 56139310, "link": "https://stackoverflow.com/questions/56139310/how-to-check-if-a-cookie-is-expired", "title": "How to check if a cookie is expired", "body": "<p>How do I check if a cookie I get through a GET request is expired or not?\nI tried:</p>\n\n<pre><code>cookie, err := c.Request.Cookie(\"session\")\nif err == nil &amp;&amp; time.Now().Before(cookie.Expires) {\n    log.Printf(\"COOKIE IS STILL GOOD. YUM!\\n\")\n    return\n}\n</code></pre>\n\n<p>But when I debug I see the expiration date is incorrect:</p>\n\n<pre><code>2019/05/15 01:23:46 0001-01-01 00:00:00 +0000 UTC\n</code></pre>\n\n<p>The date is today, rather than 2051 like I set it to be, and nothing else makes sense. What is happening?</p>\n"}, {"tags": ["go", "mips", "embedded-linux", "mips32", "cgo"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 1, "creation_date": 1557868460, "post_id": 56138616, "comment_id": 98908147, "body": "Oh, and wildly guessing here, it is possible that your C library is built expecting FPU hardware. I&#39;d have to see the assembly but that sigsetjmp function might be trying to save FPU register state, and that&#39;s a C library code, not Go."}, {"owner": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1557932374, "post_id": 56138616, "comment_id": 98934118, "body": "@ZanLynx I&#39;ve updated the question to show the assembly if that helps"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1557937546, "post_id": 56138616, "comment_id": 98937001, "body": "See <a href=\"https://stackoverflow.com/q/1165807/13422\">stackoverflow.com/q/1165807/13422</a> that is a floating point instruction."}], "answers": [{"tags": [], "owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "is_accepted": false, "score": 4, "last_activity_date": 1557868232, "creation_date": 1557868232, "answer_id": 56138651, "question_id": 56138616, "link": "https://stackoverflow.com/questions/56138616/building-a-small-go-program-for-mips-with-no-hardware-floating-point-softfloat/56138651#56138651", "title": "Building a small Go program for MIPS with no hardware floating point (softfloat required)", "body": "<p>I had to run Go on MIPS one time, and solved the problem by building the kernel with floating point emulation. It's slow but it works.</p>\n"}, {"comments": [{"owner": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "edited": false, "score": 0, "creation_date": 1557933159, "post_id": 56139747, "comment_id": 98934596, "body": "I tried adding the CGO_CFLAGS and CGO_LDFLAGS you mentioned, I run into the following issue:  <code>In file included from &#47;usr&#47;mips-linux-gnu&#47;include&#47;features.h:391:0,                  from &#47;usr&#47;mips-linux-gnu&#47;include&#47;stdlib.h:24,                  from _cgo_export.c:3: &#47;usr&#47;mips-linux-gnu&#47;include&#47;gnu&#47;stubs.h:8:33: fatal error: gnu&#47;stubs-o32_soft.h: No such file or directory</code> Do you know where this file might be missing from and how I might include it in my build process? Thank you!"}, {"owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "reply_to_user": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "edited": false, "score": 1, "creation_date": 1558027773, "post_id": 56139747, "comment_id": 98974102, "body": "You are missing the soft-float C library support.  But I don&#39;t know where to get it.  I do know that it will depend on the GNU/Linux distro you are using."}], "tags": [], "owner": {"reputation": 251, "user_id": 2774002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ntpn9.gif?s=128&g=1", "display_name": "Ian Lance Taylor", "link": "https://stackoverflow.com/users/2774002/ian-lance-taylor"}, "is_accepted": false, "score": 3, "last_activity_date": 1557875284, "creation_date": 1557875284, "answer_id": 56139747, "question_id": 56138616, "link": "https://stackoverflow.com/questions/56138616/building-a-small-go-program-for-mips-with-no-hardware-floating-point-softfloat/56139747#56139747", "title": "Building a small Go program for MIPS with no hardware floating point (softfloat required)", "body": "<p>In addition to <code>CFLAGS=-msoft-float</code> add <code>CGO_CFLAGS=-msoft-float</code> and <code>CGO_LDFLAGS=-msoft-float</code>.  Note that this will only work if you have a soft-float version of libc.a installed; look for <code>/usr/lib/gcc-cross/mips-linux-gnu/5/../../../../mips-linux-gnu/lib/../lib/soft-float/libc.a</code> (I added a <code>soft-float</code> directory at the end).</p>\n"}], "owner": {"reputation": 244, "user_id": 1575431, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0f7058a49c1dc4696e4ec48fc5f8ce4f?s=128&d=identicon&r=PG", "display_name": "MattLock", "link": "https://stackoverflow.com/users/1575431/mattlock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1557932330, "creation_date": 1557868049, "last_edit_date": 1557932330, "question_id": 56138616, "link": "https://stackoverflow.com/questions/56138616/building-a-small-go-program-for-mips-with-no-hardware-floating-point-softfloat", "title": "Building a small Go program for MIPS with no hardware floating point (softfloat required)", "body": "<p>I have small program written in go that I'm trying to cross compile to get working on a MIPS architecture machine. I've been trying to cross compile using the XGO cross compilation library but have had limited success getting my program to run (<a href=\"https://github.com/karalabe/xgo\" rel=\"nofollow noreferrer\">https://github.com/karalabe/xgo</a>).</p>\n\n<p>Here is the cpuinfo of the device, which is currently running a version of openwrt.</p>\n\n<pre><code>system type     : Qualcomm Atheros QCA9533 ver 2 rev 0\nmachine         : GL.iNet GL-AR750\nprocessor       : 0\ncpu model       : MIPS 24Kc V7.4\nBogoMIPS        : 432.53\nwait instruction    : yes\nmicrosecond timers  : yes\ntlb_entries     : 16\nextra interrupt vector  : yes\nhardware watchpoint : yes, count: 4, address/irw mask: [0x0ffc, 0x0ffc, 0x0ffb, 0x0ffb]\nisa         : mips1 mips2 mips32r1 mips32r2\nASEs implemented    : mips16\nshadow register sets    : 1\nkscratch registers  : 0\npackage         : 0\ncore            : 0\nVCED exceptions     : not available\nVCEI exceptions     : not available\n</code></pre>\n\n<p>Running the program I get a SIGILL Illegal instruction from the following:</p>\n\n<pre><code>Program terminated with signal SIGILL, Illegal instruction.\n#0  0x008274a8 in __sigsetjmp_aux () \n</code></pre>\n\n<p>I can see that __sigsetjmp_aux() is defined here</p>\n\n<pre><code>/usr/lib/gcc-cross/mips-linux-gnu/5/../../../../mips-linux-gnu/lib/../lib/libc.a(setjmp_aux.o): definition of __sigsetjmp_aux \n</code></pre>\n\n<p>How can I ensure all my dependencies are compiled using SOFTFLOAT ?</p>\n\n<p>I've been passing xgo the following environment variables but it seems GLIBC is not being compiled as soft-float </p>\n\n<pre><code>CC=mips-linux-gnu-gcc-5 CXX=mips-linux-gnu-g++-5 GOOS=linux GOARCH=mips GOMIPS=softfloat CGO_ENABLED=1 CFLAGS=msoft-float\n</code></pre>\n\n<p>Any help would be appreciated thanks!</p>\n\n<p><strong>EDIT</strong>\nHere is the asm layout</p>\n\n<pre><code>    0x8274a4 &lt;__sigsetjmp_aux+4&gt;    addiu  gp,gp,-19312                                                                                                                          \u2502\n  &gt;\u25020x8274a8 &lt;__sigsetjmp_aux+8&gt;    sdc1   $f20,56(a0)                                                                                                                           \u2502\n   \u25020x8274ac &lt;__sigsetjmp_aux+12&gt;   sdc1   $f22,64(a0) \n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 4, "creation_date": 1557861962, "post_id": 56137256, "comment_id": 98905616, "body": "The json you provide is invalid. <a href=\"https://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1557862000, "post_id": 56137256, "comment_id": 98905641, "body": "<a href=\"https://play.golang.org/p/bR6NG5MZyu6\" rel=\"nofollow noreferrer\">play.golang.org/p/bR6NG5MZyu6</a> invalid json, one comma too many, and also <code>account_id</code> is not gonna match <code>AccountId</code> so use a tag."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1557862030, "post_id": 56137256, "comment_id": 98905655, "body": "Lesson: <b>always</b> check the returned errors!"}, {"owner": {"reputation": 992, "user_id": 191370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6979c0a012afd192e9a89ec0c350c634?s=128&d=identicon&r=PG", "display_name": "edwin.nathaniel", "link": "https://stackoverflow.com/users/191370/edwin-nathaniel"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557863940, "post_id": 56137256, "comment_id": 98906502, "body": "@mkopriva why do I have to use tag? I thought JSON marshaller is smart enough to convert &quot;account_id&quot; to &quot;AccountId&quot; ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1557864043, "post_id": 56137256, "comment_id": 98906552, "body": "You can try it without the tag and see for yourself. But I believe it&#39;s only &quot;smart enough&quot; to handle uppercase and lowercase as the one and the same."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557866312, "post_id": 56137256, "comment_id": 98907416, "body": "It is &quot;smart enough&quot; to do <i>exactly</i> what it says in its documentation - no more, no less: <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/json/#Unmarshal</a> &quot;Unmarshal matches incoming object keys to the keys used by Marshal (either the struct field name or its tag), preferring an exact match but also accepting a case-insensitive match.&quot;"}, {"owner": {"reputation": 1285, "user_id": 5974780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db181de522cb3dcfcddaeb95fa2925a3?s=128&d=identicon&r=PG&f=1", "display_name": "Nesan Mano", "link": "https://stackoverflow.com/users/5974780/nesan-mano"}, "edited": false, "score": 0, "creation_date": 1557867170, "post_id": 56137256, "comment_id": 98907705, "body": "You must review your own work before asking any questions! Your JSON is obviously invalid."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 1136337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/092ca98b0b2898e6ef2b973ec93e29bd?s=128&d=identicon&r=PG&f=1", "display_name": "Alfonso", "link": "https://stackoverflow.com/users/1136337/alfonso"}, "is_accepted": false, "score": 1, "last_activity_date": 1557878904, "creation_date": 1557878904, "answer_id": 56140165, "question_id": 56137256, "link": "https://stackoverflow.com/questions/56137256/converting-json-that-contains-only-1-field-of-arrays/56140165#56140165", "title": "Converting JSON that contains only 1 field of arrays", "body": "<p>use a explicit tag in your stucture type.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Account struct {\n    AccountId string `json:\"account_id, omitempty\"`\n}\n</code></pre>\n\n<p>If you are a novice, keep in mind the JSON size, if is large then use a stream library (jstream or easyjson etc),\nother advice is check nullables or omit when they are empty anyway you can use nullable library like <a href=\"https://github.com/guregu/null\" rel=\"nofollow noreferrer\">https://github.com/guregu/null</a></p>\n\n<p>Cheers! </p>\n"}], "owner": {"reputation": 992, "user_id": 191370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6979c0a012afd192e9a89ec0c350c634?s=128&d=identicon&r=PG", "display_name": "edwin.nathaniel", "link": "https://stackoverflow.com/users/191370/edwin-nathaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1557878904, "creation_date": 1557861732, "question_id": 56137256, "link": "https://stackoverflow.com/questions/56137256/converting-json-that-contains-only-1-field-of-arrays", "title": "Converting JSON that contains only 1 field of arrays", "body": "<p>I'm trying to convert a JSON that contains only 1 field which apparently an array to a complex struct in Golang but unfortunately I'm not getting the data back, instead, I got:</p>\n\n<pre><code>{Result:[]}\n</code></pre>\n\n<p>Anyone knows why? (code below)</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Account struct {\n    AccountId string\n}\n\n\ntype Response struct {\n    Result []Account\n}\n\nfunc main() {\n    input := []byte(`{\n            \"result\": [\n                {\"account_id\" : \"1\"},\n                {\"account_id\" : \"2\"},\n                {\"account_id\" : \"3\"},\n            ]\n        }\n\n    `)\n\n    var resp Response\n    json.Unmarshal(input, &amp;resp)\n    fmt.Printf(\"%+v\\n\", resp)\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sns"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557854003, "post_id": 56135354, "comment_id": 98901918, "body": "<code>session.NewSession(&amp;aws.Config{Region: aws.String(region)})</code>"}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "edited": false, "score": 0, "creation_date": 1557856492, "post_id": 56135449, "comment_id": 98903046, "body": "I did this at least region error is not coming but below is coming caused by: Post <a href=\"https://sns.us-west-2.amazonaws.com/\" rel=\"nofollow noreferrer\">sns.us-west-2.amazonaws.com</a>: dial tcp: lookup sns.us-west-2.amazonaws.com on 192.168.0.1:78: read udp 192.168.0.89:51137-&gt;192.168.0.11:53: i/o timeout"}, {"owner": {"reputation": 123, "user_id": 2591936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/FU946.jpg?s=128&g=1", "display_name": "Mika Sa", "link": "https://stackoverflow.com/users/2591936/mika-sa"}, "edited": false, "score": 2, "creation_date": 1566277837, "post_id": 56135449, "comment_id": 101595029, "body": "So it needs another region config even after declaring it in env variable?"}], "tags": [], "owner": {"reputation": 678, "user_id": 595362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sx7ju.png?s=128&g=1", "display_name": "noisewaterphd", "link": "https://stackoverflow.com/users/595362/noisewaterphd"}, "is_accepted": true, "score": 7, "last_activity_date": 1557854026, "creation_date": 1557854026, "answer_id": 56135449, "question_id": 56135354, "link": "https://stackoverflow.com/questions/56135354/missingregion-could-not-find-region-configuration-in-golang-and-aws-sns/56135449#56135449", "title": "MissingRegion: could not find region configuration in golang and aws sns", "body": "<p>You have to configure the SDK. To set just the region you would do something like <code>sess, err := session.NewSession(&amp;aws.Config{\n    Region: aws.String(\"us-west-2\")},\n)</code></p>\n\n<p>You can see full details on config here: <a href=\"https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html\" rel=\"noreferrer\">https://docs.aws.amazon.com/sdk-for-go/v1/developer-guide/configuring-sdk.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 1182, "user_id": 3639687, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c93d8e07b0e0ba4ebeacf0305691cdc9?s=128&d=identicon&r=PG&f=1", "display_name": "Pratham", "link": "https://stackoverflow.com/users/3639687/pratham"}, "is_accepted": false, "score": 3, "last_activity_date": 1605177922, "creation_date": 1605177922, "answer_id": 64802402, "question_id": 56135354, "link": "https://stackoverflow.com/questions/56135354/missingregion-could-not-find-region-configuration-in-golang-and-aws-sns/64802402#64802402", "title": "MissingRegion: could not find region configuration in golang and aws sns", "body": "<p>The Go SDK does not recognize the env variable <code>AWS_DEFAULT_REGION</code><br />\nThe region can be specified using the <code>AWS_REGION</code> name as below</p>\n<pre><code>export AWS_REGION=&quot;us-west-2&quot;\n</code></pre>\n<p>The other way is to explicitly pass the region while creating the session as per the answer by <a href=\"https://stackoverflow.com/a/56135449/3639687\">noisewaterphd</a></p>\n"}], "owner": {"reputation": 119, "user_id": 10689245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ffe56b89216fa21e1e85a1d9ab0c47?s=128&d=identicon&r=PG&f=1", "display_name": "Amit Upa", "link": "https://stackoverflow.com/users/10689245/amit-upa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5032, "favorite_count": 0, "accepted_answer_id": 56135449, "answer_count": 2, "score": 4, "last_activity_date": 1605177922, "creation_date": 1557853636, "question_id": 56135354, "link": "https://stackoverflow.com/questions/56135354/missingregion-could-not-find-region-configuration-in-golang-and-aws-sns", "title": "MissingRegion: could not find region configuration in golang and aws sns", "body": "<p>I am new to Golang and AWS. I am trying to send SMS using AWS SNS.\nI have set Environment variable First then try send SMS.</p>\n\n<pre><code>export AWS_ACCESS_KEY_ID=AKIAIOSFODN..\nexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEM..\nexport AWS_DEFAULT_REGION=us-west-2\n</code></pre>\n\n<p>I tried to debug where i am getting wrong\nBut always getting error \n<strong>MissingRegion: could not find region configuration</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/sns\"\n)\n\nfunc main() {\n    fmt.Println(\"creating session\")\n    sess := session.Must(session.NewSession())\n    fmt.Println(\"session created\")\n    svc := sns.New(sess)\n    fmt.Println(\"service created\")\n    params := &amp;sns.PublishInput{\n        Message: aws.String(\"testing 123\"),         \n        PhoneNumber: aws.String(\"+14445556666\"),    \n    }\n    resp, err := svc.Publish(params)\n\n    if err != nil {\n        fmt.Println(err.Error())\n        return\n    }\n    fmt.Println(resp)\n}\n</code></pre>\n\n<p>I am trying to do this since last 2 days.Please help me where i am going wrong.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "edited": false, "score": 2, "creation_date": 1557848087, "post_id": 56133992, "comment_id": 98899013, "body": "The code you have posted produces exactly the output I would expect. There are no lines of code that generate messages about <code>ls</code> or it&#39;s usage in your program."}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "reply_to_user": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "edited": false, "score": 0, "creation_date": 1557848323, "post_id": 56133992, "comment_id": 98899141, "body": "When I comment out log.Fatal(err) I get this output which tells me that &#39;2&#39; is an invalid option to the &#39;ls&#39; command:"}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "reply_to_user": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "edited": false, "score": 0, "creation_date": 1557848328, "post_id": 56133992, "comment_id": 98899146, "body": "# go run main.go  2019/05/14 11:37:42 Error: exit status 2 Output ls: invalid option -- &#39;2&#39; Try &#39;ls --help&#39; for more information."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1557848382, "post_id": 56133992, "comment_id": 98899177, "body": "log.Fatal <b>terminates</b> your program. With log.Fatal the stdoutStderr is <i>never</i> printed because that line is never reached."}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "edited": false, "score": 0, "creation_date": 1557848593, "post_id": 56133992, "comment_id": 98899313, "body": "but I&#39;m calling log.Printf first and then log.Fatal."}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "edited": false, "score": 0, "creation_date": 1557849060, "post_id": 56133992, "comment_id": 98899547, "body": "why does commenting out log.Fatal() produce a different output for log.Printf()?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557849136, "post_id": 56133992, "comment_id": 98899592, "body": "@momo106: because one calls <code>log.Fatal</code>, which exits the program immediately. The documentation for the <code>Fatal*</code> methods are all very concise: <code>Fatal is equivalent to l.Print() followed by a call to os.Exit(1)</code>"}, {"owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "edited": false, "score": 1, "creation_date": 1557849333, "post_id": 56133992, "comment_id": 98899698, "body": "Because if you don&#39;t call <code>log.Fatal</code> your program continues on to fmt.Printf() which prints the error message for ls."}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557849388, "post_id": 56133992, "comment_id": 98899734, "body": "@JimB: so if i understand this correctly, printf is called but it does not complete quick enough before log.Fata() is called and thus the whole output of printf is not printed to the screen?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1557849464, "post_id": 56133992, "comment_id": 98899779, "body": "@momo106: How would you expect the last <code>Printf</code> to be called at all if you&#39;ve already exited the program?"}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1558030734, "post_id": 56133992, "comment_id": 98975432, "body": "@JimB,@Volker,@JonGuiton thank you for the clarification. It makes sense now."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "edited": false, "score": 0, "creation_date": 1557848482, "post_id": 56134122, "comment_id": 98899245, "body": "but I&#39;m calling log.Printf first and then log.Fatal. When I do this it does not print the full output of log.Printf."}, {"owner": {"reputation": 1247, "user_id": 388398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9bd10eedb6c17c1604a7cadefed6b02?s=128&d=identicon&r=PG", "display_name": "Jon Guiton", "link": "https://stackoverflow.com/users/388398/jon-guiton"}, "edited": false, "score": 1, "creation_date": 1557849069, "post_id": 56134122, "comment_id": 98899550, "body": "The calls to printf before the call to log.Fatal() <b>are</b> executed and <b>do</b> produce output. The calls to printf <b>after</b> log.Fatal() are never reached. log.Printf <b>does</b> print &quot;Error exit status 2&quot;"}, {"owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "edited": false, "score": 0, "creation_date": 1558030775, "post_id": 56134122, "comment_id": 98975455, "body": "thank you, makes sense now."}], "tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": false, "score": 1, "last_activity_date": 1558031268, "last_edit_date": 1558031268, "creation_date": 1557848354, "answer_id": 56134122, "question_id": 56133992, "link": "https://stackoverflow.com/questions/56133992/why-is-log-printf-not-printing/56134122#56134122", "title": "Why is log.Printf() not printing?", "body": "<p><code>log.Fatal</code> calls <code>os.Exit()</code> after printing the log message. So statements after <code>log.Fatal()</code> will not be called. I believe that is the reason you are not seeing output of <code>fmt.Printf(\"Output %s\\n\", stdoutStderr)</code> in the logs.</p>\n"}], "owner": {"reputation": 33, "user_id": 2168050, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/140fd5bfbf30f096d30f4e37db2d42b0?s=128&d=identicon&r=PG&f=1", "display_name": "masa976", "link": "https://stackoverflow.com/users/2168050/masa976"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1695, "favorite_count": 0, "closed_date": 1557852259, "answer_count": 1, "score": -3, "last_activity_date": 1558031268, "creation_date": 1557847910, "last_edit_date": 1558030624, "question_id": 56133992, "link": "https://stackoverflow.com/questions/56133992/why-is-log-printf-not-printing", "closed_reason": "Not suitable for this site", "title": "Why is log.Printf() not printing?", "body": "<p>I'm learning Go and came across this behavior I don't understand. When I do error checking and use log.Printf() I see the os error that I would normally see if I make that same error on the command line.</p>\n\n<p>But when I use log.Fatal() the last log.Printf() does not print to the screen.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os/exec\"\n    \"fmt\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"ls\", \"-2\")\n\n    stdoutStderr, err := cmd.CombinedOutput()\n    if err != nil {\n        log.Printf(\"Error: %v\", err)\n        fmt.Println(\"Printing log fatal()\")\n        log.Fatal(err)\n    }\n    fmt.Printf(\"Output %s\\n\", stdoutStderr)\n\n}\n</code></pre>\n\n<p>I was expecting to see this output:</p>\n\n<pre><code># go run main.go \n2019/05/14 11:23:34 Error: exit status 2\nOutput ls: invalid option -- '2'\nTry 'ls --help' for more information.\nPrinting log fatal()\n2019/05/14 11:24:45 exit status 2\nexit status 1\n</code></pre>\n\n<p>But My actual result is:</p>\n\n<pre><code># go run main.go\n2019/05/14 11:24:45 Error: exit status 2\nPrinting log fata()\n2019/05/14 11:24:45 exit status 2\nexit status 1\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3", "concurrency", "channels"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1557848242, "post_id": 56133485, "comment_id": 98899095, "body": "Yes, you can put the guts of that <code>for</code> loop in a goroutine (although make sure to make a local copy of <code>pathOfFile</code> inside the loop or pass it to the goroutine function as a parameter). You&#39;ll probably want to use a <code>sync.WaitGroup</code> so you can wait for them all to finish (or not \u2013 that depends on how your program is structured). Also, you don&#39;t need to read the file into a buffer. You can set <code>file</code> as the value of <code>Body</code> in <code>PutObjectInput</code>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1557848578, "post_id": 56133485, "comment_id": 98899305, "body": "Unfortunately, in current code you have not implemented any concurrency. Do your homework, learn for go concurrency patterns, try something, get stuck, and we ll help you. <a href=\"https://www.google.com/search?q=go+concurrency+patterns\" rel=\"nofollow noreferrer\">google.com/search?q=go+concurrency+patterns</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557851190, "post_id": 56133485, "comment_id": 98900608, "body": "&quot;for each file I iterate through, I want to spin off a goroutine that uploads the file&quot; so implement that. Your current code blocks because it&#39;s single-threaded. Goroutines, channels, and other basic concepts are covered in the <a href=\"https://tour.golang.org\" rel=\"nofollow noreferrer\">Tour of Go</a>."}, {"owner": {"reputation": 299, "user_id": 9251661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe82b31be61cbd6a9adc00757d17c42?s=128&d=identicon&r=PG&f=1", "display_name": "trurohit", "link": "https://stackoverflow.com/users/9251661/trurohit"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1557913372, "post_id": 56133485, "comment_id": 98922070, "body": "@AndySchweig So I&#39;ve revised the code to implement channel instead of WaitGroup. However, I&#39;m not entirely sure if this is the right approach. The files are getting uploaded still and the code is working but not sure if it&#39;s working in parallel."}, {"owner": {"reputation": 299, "user_id": 9251661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe82b31be61cbd6a9adc00757d17c42?s=128&d=identicon&r=PG&f=1", "display_name": "trurohit", "link": "https://stackoverflow.com/users/9251661/trurohit"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557913490, "post_id": 56133485, "comment_id": 98922146, "body": "@mh-cbon just implemented this using Goroutines and Channels. Not sure if this is the right approach though. Would be great if I could get your suggestions on this."}], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 9251661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe82b31be61cbd6a9adc00757d17c42?s=128&d=identicon&r=PG&f=1", "display_name": "trurohit", "link": "https://stackoverflow.com/users/9251661/trurohit"}, "edited": false, "score": 0, "creation_date": 1557913675, "post_id": 56140880, "comment_id": 98922259, "body": "Thank you for your very elaborate response. I will try to implement this using WaitGroups. I&#39;ve revised my code above where I&#39;ve used Channels to achieve the same. But I&#39;m not entirely sure if it&#39;s the right approach or not. I found Channels easier to understand and implement than WaitGroup. Do let me know if you have any suggestions on how to improve the code.   But I will definitely try to implement your solution so I can understand WaitGroups better."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 1, "creation_date": 1557914181, "post_id": 56140880, "comment_id": 98922578, "body": "I will not recommend creating a single go routine per file. If there are 1000 files, it will create 1000 go routines and will try to upload all the files at once. Instead you should look into worker pools to control no of concurrent uploads."}, {"owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "reply_to_user": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1557918522, "post_id": 56140880, "comment_id": 98925165, "body": "@ankit-deshpande agree with you. But I just showed how to run it concurrently. About worker pool - maybe he read in some other place"}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1557918772, "post_id": 56140880, "comment_id": 98925324, "body": "@Solorad Agreed."}], "tags": [], "owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "is_accepted": false, "score": 3, "last_activity_date": 1557886107, "creation_date": 1557886107, "answer_id": 56140880, "question_id": 56133485, "link": "https://stackoverflow.com/questions/56133485/uploading-multiple-files-in-parallel-to-amazon-s3-with-goroutines-channels/56140880#56140880", "title": "Uploading multiple files in parallel to Amazon S3 with Goroutines &amp; Channels", "body": "<p>So, you are looking for concurrency, which is rooted in <code>go</code> instruction. For synchronization between started in loop goroutine, you can use <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\"><code>chanels</code></a> OR <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\"><code>sync.WaitGroup</code></a>. The second option is a little bit easier to do.\nAlso you have to refactor your function and move internal <code>for</code> logic into a separate function.</p>\n\n<pre><code>func uploadDirToS3(dir string, svc *s3.S3) {\n    fileList := []string{}\n    filepath.Walk(dir, func(path string, f os.FileInfo, err error) error {\n        fileList = append(fileList, path)\n        return nil\n    })\n    var wg sync.WaitGroup\n    wg.Add(len(fileList))\n    for _, pathOfFile := range fileList[1:] {\n        //maybe spin off a goroutine here??\n        go putInS3(pathOfFile, svc, &amp;wg)\n    }\n    wg.Wait()\n}\n\nfunc putInS3(pathOfFile string, svc *s3.S3, wg *sync.WaitGroup) {\n    defer func() {\n        wg.Done()\n    }()\n    file, _ := os.Open(pathOfFile)\n    defer file.Close()\n    fileInfo, _ := file.Stat()\n    size := fileInfo.Size()\n    buffer := make([]byte, size)\n    file.Read(buffer)\n    fileBytes := bytes.NewReader(buffer)\n    fileType := http.DetectContentType(buffer)\n    path := file.Name()\n    params := &amp;s3.PutObjectInput{\n        Bucket:        aws.String(\"bucket-name\"),\n        Key:           aws.String(path),\n        Body:          fileBytes,\n        ContentLength: aws.Int64(size),\n        ContentType:   aws.String(fileType),\n    }\n\n    resp, _ := svc.PutObject(params)\n    fmt.Printf(\"response %s\", awsutil.StringValue(resp))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1558873702, "last_edit_date": 1558873702, "creation_date": 1558005406, "answer_id": 56167293, "question_id": 56133485, "link": "https://stackoverflow.com/questions/56133485/uploading-multiple-files-in-parallel-to-amazon-s3-with-goroutines-channels/56167293#56167293", "title": "Uploading multiple files in parallel to Amazon S3 with Goroutines &amp; Channels", "body": "<hr>\n\n<p>Following does not strictly speaking answer the OP, however its an attempt to introduce parallel processing using the go language.</p>\n\n<p>hope this helps.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n\n    // processInSync()\n    // The processing takes up to 3seconds,\n    // it displays all the output and handles errors.\n\n    // processInParallel1()\n    // The processing takes up to few microseconds,\n    // it displays some of the output and does not handle errors.\n    // It is super fast, but incorrect.\n\n    // processInParallel2()\n    // The processing takes up to 1s,\n    // It correctly displays all the output,\n    // But it does not yet handle return values.\n\n    processInParallel3()\n    // The processing takes up to 1s,\n    // It correctly displays all the output,\n    // and it is able to return the first error encountered.\n\n    // This merely just an introduction to what you are able to do.\n    // More examples are required to explains the subtletlies of channels\n    // to implement unbound work processing.\n    // I leave that as an exercise to the reader.\n    // For more information and explanations about channels,\n    // Read The Friendly Manual and the tons of examples\n    // we left on the internet.\n    // https://golang.org/doc/effective_go.html#concurrency\n    // https://gobyexample.com/channels\n    // https://gobyexample.com/closing-channels\n}\n\nfunc aSlowProcess(name string) error {\n    log.Println(\"aSlowProcess \", name)\n    &lt;-time.After(time.Second)\n    return nil\n}\n\n//processInSync a dummy function calling a slow function one after the other.\nfunc processInSync() error {\n    now := time.Now()\n    // it calls the slow process three time,\n    // one after the other;\n    // If an error is returned, returns asap.\n    if err := aSlowProcess(\"#1\"); err != nil {\n        return err\n    }\n    if err := aSlowProcess(\"#2\"); err != nil {\n        return err\n    }\n    if err := aSlowProcess(\"#3\"); err != nil {\n        return err\n    }\n    // This is a sync process because it does not involve\n    // extra synchronisation mechanism.\n    log.Printf(\"processInSync spent %v\\n\", time.Now().Sub(now))\n    return nil\n}\n\n// processInParallel1 implements parallel processing example.\n// it is not yet a fully working example, to keep it simple,\n// it only implements the sending part of the processing.\nfunc processInParallel1() error {\n    now := time.Now()\n\n    // We want to execute those function calls in parallel\n    // for that we use the go keyword which allows to run the function\n    // into a separate routine/process/thread.\n    // It is called async because the main thread and the\n    // the new routines requires to be synchronized.\n    // To synchronize two independant routine we must use\n    // atomic (race free) operators.\n\n    // A channel is an atomic operator because it is safe to\n    // read and write from it from multiple parallel\n    // and independant routines.\n\n    // before we implement such processing, we must ask ourselve\n    // what is the input i need to distribute among routines,\n    // and what are the values i want to get from those routines.\n\n    // lets create a channel of string to distribute the input to multiple\n    // independant workers.\n    distributor := make(chan string)\n\n    // The input channel MUST be read from the new routines.\n    // We create three workers of slow process, reading and processing.\n    go func() {\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n    go func() {\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n    go func() {\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n\n    // we must now write the values into the distributor\n    // so that each worker can read and process data.\n    distributor &lt;- \"#1\"\n    distributor &lt;- \"#2\"\n    distributor &lt;- \"#3\"\n\n    log.Printf(\"processInParallel1 spent %v\\n\", time.Now().Sub(now))\n\n    return nil\n}\n\n// processInParallel2 implements parallel processing example.\n// it is not yet a fully working example, to keep it simple,\n// it implements the sending part of the processing,\n// and the synchronization mechanism to wait for all workers\n// to finish before returning.\nfunc processInParallel2() error {\n    now := time.Now()\n\n    // We saw in the previous example how to send values and process\n    // them in parallel, however, that function was not able to wait for\n    // those async process to finish before returning.\n\n    // To implement such synchronization mechanism\n    // where the main thread waits for all workers to finish\n    // before returning we need to use the sync package.\n    // It provides the best pattern to handle that requirements.\n\n    // In addition to the previous example we now instantiate a\n    // WaitGroup https://golang.org/pkg/sync/#WaitGroup\n    // The purpose of the wait group is to record a number\n    // of async jobs to process and wait for them to finish.\n\n    var wg sync.WaitGroup\n\n    distributor := make(chan string)\n\n    // Because we have three workers, we add three to the group.\n    wg.Add(1)\n    go func() {\n        // Then we make sure that we signal to the waitgroup \n    // that the process is done.\n        defer wg.Done()\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n    //-\n    wg.Add(1)\n    go func() {\n        defer wg.Done() // as an exercise, comment this line \n    // and inspect the output of your program.\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n    //-\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        value := &lt;-distributor\n        aSlowProcess(value)\n    }()\n\n    // we can now write the data for processing....\n    distributor &lt;- \"#1\"\n    distributor &lt;- \"#2\"\n    distributor &lt;- \"#3\"\n\n    //....and wait for their completion\n    wg.Wait()\n\n    log.Printf(\"processInParallel2 spent %v\\n\", time.Now().Sub(now))\n\n    return nil\n}\n\n// processInParallel3 implements parallel processing example.\n// It is a fully working example that distribute jobs, \n// wait for completion and catch for return values.\nfunc processInParallel3() error {\n    now := time.Now()\n\n    var wg sync.WaitGroup\n    distributor := make(chan string)\n\n    // To catch for return values we must implement a\n    // way for output values to safely reach the main thread.\n    // We create a channel of errors for that purpose.\n    receiver := make(chan error)\n\n    // As previsouly we start the workers, and attach them to a waitgroup.\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        value := &lt;-distributor\n        err := aSlowProcess(value)\n        // to return the value we write on the output channel.\n        receiver &lt;- err\n    }()\n    //-\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        value := &lt;-distributor\n        receiver &lt;- aSlowProcess(value)\n    }()\n    //-\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        value := &lt;-distributor\n        receiver &lt;- aSlowProcess(value)\n    }()\n\n    // we can now write the data for processing....\n    distributor &lt;- \"#1\"\n    distributor &lt;- \"#2\"\n    distributor &lt;- \"#3\"\n\n    /// ... read the output values\n    err1 := &lt;-receiver\n    err2 := &lt;-receiver\n    err3 := &lt;-receiver\n\n    //....and wait for routines completion....\n    wg.Wait()\n\n    log.Printf(\"processInParallel3 spent %v\\n\", time.Now().Sub(now))\n\n    // finally check for errors\n    if err1 != nil {\n        return err1\n    }\n    if err2 != nil {\n        return err2\n    }\n    if err3 != nil {\n        return err3\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 9251661, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe82b31be61cbd6a9adc00757d17c42?s=128&d=identicon&r=PG&f=1", "display_name": "trurohit", "link": "https://stackoverflow.com/users/9251661/trurohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1583, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558873702, "creation_date": 1557846218, "last_edit_date": 1557913964, "question_id": 56133485, "link": "https://stackoverflow.com/questions/56133485/uploading-multiple-files-in-parallel-to-amazon-s3-with-goroutines-channels", "title": "Uploading multiple files in parallel to Amazon S3 with Goroutines &amp; Channels", "body": "<p>I'm trying to upload a directory into Amazon S3 bucket. However, the only way to upload a directory is to iterate through all the files inside the directory and upload them one by one. </p>\n\n<p>I'm using Go to iterate over the files in directory. However, for each file I iterate through, I want to spin off a goroutine that uploads the file while the main thread iterates through the next element in the directory and spins off another goroutine to upload the same. </p>\n\n<p>Any idea on how I can upload all the files in the directory parallelly using Goroutines and Channels?</p>\n\n<p>Revised code snippet that implements a goroutine and a channel to upload files in parallel. But I'm not sure if this is the right implementation.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func uploadDirToS3(dir string, svc *s3.S3) {\n    fileList := []string{}\n    filepath.Walk(dir, func(path string, f os.FileInfo, err error) error {\n        fmt.Println(\"PATH ==&gt; \" + path)\n        fileList = append(fileList, path)\n        return nil\n    })\n    for _, pathOfFile := range fileList[1:] {\n        channel := make(chan bool)\n        go uploadFiletoS3(pathOfFile, svc, channel)\n        &lt;-channel\n    }\n}\n\nfunc uploadFiletoS3(path string, svc *s3.S3, channel chan bool) {\n    file, err := os.Open(path)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer file.Close()\n    fileInfo, _ := file.Stat()\n    size := fileInfo.Size()\n\n    buffer := make([]byte, size)\n    file.Read(buffer)\n    fileBytes := bytes.NewReader(buffer)\n    fileType := http.DetectContentType(buffer)\n\n    s3Path := file.Name()\n\n    params := &amp;s3.PutObjectInput{\n        Bucket:        aws.String(\"name-of-bucket\"),\n        Key:           aws.String(s3Path),\n        Body:          fileBytes,\n        ContentLength: aws.Int64(size),\n        ContentType:   aws.String(fileType),\n    }\n\n    resp, err := svc.PutObject(params)\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Printf(\"response %s\", awsutil.StringValue(resp))\n    close(channel)\n}\n</code></pre>\n\n<p>Any ideas on how I could implement this better? I've looked into WaitGroups but for some reason, I found Channels much easier to understand and implement in this situation. </p>\n"}, {"tags": ["go", "math", "biginteger", "bigfloat"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 4, "last_activity_date": 1557848952, "creation_date": 1557848952, "answer_id": 56134272, "question_id": 56133476, "link": "https://stackoverflow.com/questions/56133476/precision-issue-of-golang-big-float/56134272#56134272", "title": "Precision issue of Golang big.Float", "body": "<p>From <code>go doc math/big.Float</code>:</p>\n\n<blockquote>\n  <p>A nonzero finite Float represents a multi-precision floating point number</p>\n  \n  <p>sign \u00d7 mantissa \u00d7 2**exponent</p>\n  \n  <p>with 0.5 &lt;= mantissa &lt; 1.0, and MinExp &lt;= exponent &lt;= MaxExp.</p>\n</blockquote>\n\n<p>And SetPrec sets the bitwidth of the mantissa not some decimal precision.</p>\n\n<p>Like with float64s not every decimal number can be represented exact in a big.Float and your code shows this. The fact that you see what you expect to see with prec=512 is due to different rounding and printing.</p>\n\n<p>Rule of thumb: big.Floats behave like \"normal\" floats with all their shortcomings (here not every decimal fraction can be represented) but may show less rounding errors.</p>\n"}], "owner": {"reputation": 13, "user_id": 5709861, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154443426847564/picture?type=large", "display_name": "William Shih", "link": "https://stackoverflow.com/users/5709861/william-shih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "accepted_answer_id": 56134272, "answer_count": 1, "score": 0, "last_activity_date": 1557848952, "creation_date": 1557846194, "question_id": 56133476, "link": "https://stackoverflow.com/questions/56133476/precision-issue-of-golang-big-float", "title": "Precision issue of Golang big.Float", "body": "<p>I've met some interesting problem of Golang big.Float calculation.</p>\n\n<p>The Problem is</p>\n\n<p>10001000100010001000100010001000100010001000100015.5533 / 1000000000000000000</p>\n\n<p>= 10001000100010001000100010001000.1000100010001000155533</p>\n\n<p>However, big.Float gave \"10001000100010001000100010001000.10001000100010001555329999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999997\"</p>\n\n<p>The code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var prec uint = 1024 // 512\ndec, _ := new(big.Float).SetPrec(prec).SetString(\"1000000000000000000\")\nf, _ := new(big.Float).SetPrec(prec).SetString(\"10001000100010001000100010001000100010001000100015.5533\")\nq := f.Quo(f, dec)\n\nfmt.Printf(\"Percision: %d\\n\", prec)\nfmt.Printf(\"Quotient: %s\\n\", q.Text('f', -1))\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Percision: 1024\nQuotient: 10001000100010001000100010001000.10001000100010001555329999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999997\n</code></pre>\n\n<p>And the more confusing part is, if I set prec = 512, a smaller precision, it produced correct result instead.</p>\n\n<pre><code>Percision: 512\nQuotient: 10001000100010001000100010001000.1000100010001000155533\n</code></pre>\n\n<p>Doses any one know what's wrong of my code or how to configure big.Float to get expected result?</p>\n\n<p>Thanks to all!</p>\n"}, {"tags": ["go", "testing", "logging"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557845829, "post_id": 56133298, "comment_id": 98897702, "body": "&quot;my log output has a ton of extra noise&quot; - that&#39;s probably something you should address. You can also run individual tests if you need to using <code>-run</code>."}, {"owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557845902, "post_id": 56133298, "comment_id": 98897754, "body": "@Adrian These tests are being automated by Travis. I can selectively choose which ones to test if I need to fix them"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557846001, "post_id": 56133298, "comment_id": 98897823, "body": "Then your best bet would be to start by cutting the noise from your logs."}], "owner": {"reputation": 1747, "user_id": 2896976, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa97daedb276fbd0cdca06d6de4d2d?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/2896976/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557846295, "creation_date": 1557845561, "last_edit_date": 1557846295, "question_id": 56133298, "link": "https://stackoverflow.com/questions/56133298/how-to-only-print-stdout-stderr-from-failing-tests-not-failing-packages", "title": "How to ONLY print stdout/stderr from failing tests, not failing packages?", "body": "<p>If a single test fails, the entire package fails and thus the output from all tests within that package are printed. This is cumbersome since the functions being tested have logging in them. I could suppress the logging entirely but that makes it difficult to track down the root when a test fails because my log output has a ton of extra noise.</p>\n\n<p>Is it possible to only print the output from a specific test that fails, instead of printing the entire package?</p>\n\n<p>The first solution that comes to mind is to wrap each test in a function which redirects the log output to a buffer, and then only print the buffer if the test it's wrapping fails, but that obviously adds extra boilerplate to my tests that I'd rather not have to add.</p>\n"}, {"tags": ["go", "fileserver"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844128, "post_id": 56132743, "comment_id": 98896528, "body": "What is your question?"}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844203, "post_id": 56132743, "comment_id": 98896580, "body": "How to set it up so that the Server is started from the same directory where the shell is."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844360, "post_id": 56132743, "comment_id": 98896699, "body": "The behavior you&#39;re describing is exactly what you should be getting, assuming two things: you are executing a built binary, <i>not</i> using <code>go run</code>; and you&#39;re in the correct directory <i>before</i> starting your application."}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844461, "post_id": 56132743, "comment_id": 98896770, "body": "I was using <code>go run</code>, perhaps that was the problem. Didn&#39;t know it could vary if I used <code>go run</code> instead of the built binary."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844478, "post_id": 56132743, "comment_id": 98896782, "body": "You should almost never use <code>go run</code>."}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844751, "post_id": 56132743, "comment_id": 98896966, "body": "Why so? I didn&#39;t know it was such a bad idea. I am a newbie, so any important stuff is welcome"}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557844866, "post_id": 56132743, "comment_id": 98897054, "body": "I built the binary and tried <code>cd</code>-ing before launching the server, I am still getting the default path.."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557845721, "post_id": 56132743, "comment_id": 98897633, "body": "Go is not a scripting language, it&#39;s meant to be compiled to binary and the binary executed; that&#39;s what <code>go run</code> does under the hood, creating a temporary binary and forking it. That forking can cause various issues. In your code, try printing <code>wdir</code> during the startup process and confirm it&#39;s what you&#39;re expecting."}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557992476, "post_id": 56132743, "comment_id": 98953939, "body": "printing <code>wdir</code> gives me the right directory, and I get the same result whether I use <code>go run</code> or <code>go build</code> and then execute the binary"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "edited": false, "score": 0, "creation_date": 1557984586, "post_id": 56135392, "comment_id": 98950491, "body": "I don&#39;t want it to always be <code>opt</code>, I want the Fileserver to serve files from the directory I&#39;m in. Nevertheless, I tried with <code>directory := flag.String(&quot;d&quot;, wdir, wdir) \tflag.Parse() \tm.Handle(&quot;&#47;&quot;, http.FileServer(http.Dir(*directory)))</code> and didn&#39;t work either"}, {"owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "edited": false, "score": 0, "creation_date": 1557992007, "post_id": 56135392, "comment_id": 98953664, "body": "Problem with flags is that I might want to redefine a flag, and that is not allowed. I might want to start a server in <code>&#47;opt</code> first, then kill the server and start the server in <code>&#47;home&#47;user</code>. setting <code>directory := flag.String(&quot;d&quot;, wdir, &quot;directory&quot;)</code> will set the correct directory, but I will not be able to set a new path to the server, which is what I want."}], "tags": [], "owner": {"reputation": 4970, "user_id": 892788, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e233ae4d7776dd50ffc5dd43eab2d8e8?s=128&d=identicon&r=PG", "display_name": "diyoda_", "link": "https://stackoverflow.com/users/892788/diyoda"}, "is_accepted": false, "score": 0, "last_activity_date": 1557853820, "creation_date": 1557853820, "answer_id": 56135392, "question_id": 56132743, "link": "https://stackoverflow.com/questions/56132743/golang-fileserver-set-directory/56135392#56135392", "title": "golang FileServer set directory", "body": "<p>You can bring in the FileServer <code>path</code> as a flag and use that to create the FileServer.</p>\n\n<pre><code>http.FileServer(http.Dir(path + \"/opt\")).\n</code></pre>\n\n<p>Please check the flag <a href=\"https://golang.org/pkg/flag/\" rel=\"nofollow noreferrer\">library</a> provided by go. </p>\n\n<p>And in the terminal you can feed <code>pwd</code> into that flag value</p>\n"}], "owner": {"reputation": 391, "user_id": 7547440, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-gxeBmchq7Ik/AAAAAAAAAAI/AAAAAAAAQRA/Qvq-l6_odA0/photo.jpg?sz=128", "display_name": "Hamperfait", "link": "https://stackoverflow.com/users/7547440/hamperfait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557985477, "creation_date": 1557843917, "last_edit_date": 1557844284, "question_id": 56132743, "link": "https://stackoverflow.com/questions/56132743/golang-fileserver-set-directory", "title": "golang FileServer set directory", "body": "<p>I have a <code>Golang</code> Shell with a FileServer function that I want to be able to change the src directory.\nHere is what I have:</p>\n\n<pre><code>func Server() {\n    wdir, _ := os.Getwd()\n    m := http.NewServeMux()\n    fs := http.FileServer(http.Dir(wdir))\n    m.Handle(\"/\", http.StripPrefix(\"/\", fs))\n    s := http.Server{Addr: \":8000\", Handler: m}\n    m.HandleFunc(\"/shutdown\", func(w http.ResponseWriter, r *http.Request) {\n        s.Shutdown(context.Background())\n    })\n    if err := s.ListenAndServe(); err != nil &amp;&amp; err != http.ErrServerClosed {\n        log.Fatal(err)\n    }\n    log.Printf(\"Finished\")\n}\n</code></pre>\n\n<p>I have it this way so that if I get to <code>shutdown</code>, the FileServer closes.\nBut no matter from what path I launch <code>Server()</code>, the path remains always the same.</p>\n\n<p>So if from the shell I <code>cd</code> into another folder and launch <code>Server()</code>, I will still get the files from the directory where the executable is.</p>\n\n<p>What I want is that if I run the shell from <code>/home/user/Downloads/shell</code> and inside the shell I <code>cd</code> into <code>/opt</code>, the files to show in the server are the ones in <code>/opt</code>, not the ones in <code>/home/user/Downloads/shell</code></p>\n"}, {"tags": ["go", "mux"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1557841163, "post_id": 56131723, "comment_id": 98894658, "body": "Setting headers after they have already been written has no effect. Either remove the WriteHeader call (it&#39;s redundant if called with 200), or call WriteHeader after all headers have been set."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1557842357, "post_id": 56131723, "comment_id": 98895383, "body": "Content-Length and chunked encoding are mutually exclusive. You can&#39;t do both."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557842410, "post_id": 56131723, "comment_id": 98895418, "body": "@Peter: Not entirely true... it <i>can</i> have an effect, by setting footers."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1557841111, "creation_date": 1557841111, "answer_id": 56131861, "question_id": 56131723, "link": "https://stackoverflow.com/questions/56131723/in-http-response-for-a-chunked-data-how-to-set-content-length/56131861#56131861", "title": "In HTTP response for a chunked data how to set Content-Length", "body": "<p>Remove the <code>WriteHeader</code> call at the top. You can only write headers to a response once. After you call <code>WriteHeader</code> you can't set any more headers.</p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\">Per the ResponseWriter documentation</a>:</p>\n\n<pre><code>    // Changing the header map after a call to WriteHeader (or\n    // Write) has no effect unless the modified headers are\n    // trailers.\n</code></pre>\n\n<p>So you can't call it first; but you also don't need to call it at all - from the same docs:</p>\n\n<pre><code>    // If WriteHeader is not called explicitly, the first call to Write\n    // will trigger an implicit WriteHeader(http.StatusOK).\n    // Thus explicit calls to WriteHeader are mainly used to\n    // send error codes.\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 56131861, "answer_count": 1, "score": -3, "last_activity_date": 1557842339, "creation_date": 1557840701, "last_edit_date": 1557842339, "question_id": 56131723, "link": "https://stackoverflow.com/questions/56131723/in-http-response-for-a-chunked-data-how-to-set-content-length", "title": "In HTTP response for a chunked data how to set Content-Length", "body": "<p>We have written a service which sends some encoded data as chunked to a proxy service which need Content-Length header to be set so that it can send proper response to end point. Even if I set the Content-Length header still it get stripped as part of the response to the client.\nBelow is the code which set the header</p>\n\n<pre><code>func HTTPSuccessResponse(rw http.ResponseWriter, bufferLen int, media []byte) {\n        rw.WriteHeader(http.StatusOK)\n\n        rw.Header().Set(\"Content-Type\", \"opus/ogg; audio/ogg; codec=opus\")\n        length := strconv.Itoa(len(media));\n        rw.Header().Set(\"Content-Length\", length)\n        rw.Write(media)\n}\n</code></pre>\n\n<p>Below is the response I get when I try to the request using curl</p>\n\n<pre><code>bash-4.2# curl -v -X GET -k -H  -i 'http://127.0.0.1:8090/preview'\n* About to connect() to 127.0.0.1 port 8090 (#0)\n*   Trying 127.0.0.1...\n* Connected to 127.0.0.1 (127.0.0.1) port 8090 (#0)\n&gt; GET /preview HTTP/1.1\n&gt; User-Agent: curl/7.29.0\n&gt; Host: 127.0.0.1:8090\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 200 OK\n&lt; Date: Tue, 14 May 2019 13:08:20 GMT\n&lt; Content-Type: text/plain; charset=utf-8\n&lt; Transfer-Encoding: chunked\n&lt;\n</code></pre>\n\n<p>I am using Gorrila Mux library for setting up HTTP server. Any thoughts how to make the header as part of the response.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557840582, "post_id": 56131632, "comment_id": 98894293, "body": "It can be interrupted as in put on hold while another goroutine runs on that thread, but it won&#39;t exit. A goroutine is the function called with <code>go x()</code>; just like any other function call, it does not stop until it panics or returns."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1557840659, "post_id": 56131632, "comment_id": 98894347, "body": "You probably have a lock contention issue or something along those lines - when you think the routine is hung, send your app a <code>SIGQUIT</code> to get a stack trace of all running goroutines, that should help find where the issue is."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1557841367, "post_id": 56131632, "comment_id": 98894773, "body": "If you have tests, try running it with the race detector. go test -race ./..."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557842796, "post_id": 56131632, "comment_id": 98895662, "body": "you do not need testing suite to check for race detection <code>go build -race</code> or <code>go run -race</code> also works."}], "owner": {"reputation": 127, "user_id": 4541972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41UK4.jpg?s=128&g=1", "display_name": "lilin", "link": "https://stackoverflow.com/users/4541972/lilin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557840398, "creation_date": 1557840398, "question_id": 56131632, "link": "https://stackoverflow.com/questions/56131632/is-there-any-possibility-of-a-goroutine-interrupt-without-panic", "title": "Is there any possibility of a goroutine interrupt without panic?", "body": "<p>i'm setting up a service, provide http server and run goroutine to deal with some job, look code</p>\n\n<p>once in a cycle, a sub job seems like interrupt\uff0c there is no logs after one func call</p>\n\n<p>it didn't catch any panic err, and the defer seems not trigger because the mutex lock is not unlock  </p>\n\n<p>the log is not interrupted or lost\nlog of other job is complete\nthere is no restart or exit or oom kill on those time</p>\n\n<p>this is for a CentOS 7.5, my service running in docker</p>\n\n<p>go1.11\ndocker 18.09</p>\n\n<p>this is an occasional bug, i add more log and open pprof, and try to reproduce this bug</p>\n\n<p>main.go </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func main() {\n    ....\n    // this is a cycle job, with custom time intervals\n    router.Cycle(r)\n    ....\n    endless.ListenAndServe(\":\"+conf.Conf.Port, r)\n}\n</code></pre>\n\n<p>router/cycle.go</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// this is a loop job, when job end, sleep custom time intervals and run again\n// implemented by encapsulating a goroutine, and create a context \nfunc Cycle(g *gin.Engine) {\n    cyclec := cli.InitCycle(g)\n    cyclec.AddFunc(time.Second, schedule.RunSomeDeal)\n    cyclec.Start()\n}\n\n///RunSomeDeal\nfunc RunSomeDeal(c *gin.Context) error {\n    ...\n    // deal some sub job\n    for i := 0; i &lt; missionLen; i++ {\n                // this is once job, like cycle but only run once\n                // a new context is generated by passing the exist context and a goroutine executes the callback function\n        helpers.Job.Run(c, func(newCtx *gin.Context) error {\n                        return DealMission(newCtx, someparams...)\n        })\n    }\n    return nil\n}\n\n// Job.Run\nfunc (c *Job) Run(ctx *gin.Context, f func(ctx *gin.Context) error) {\n    e := &amp;Entry{\n        Job: FuncJob(f),\n    }\n\n    if c.getJobContext != nil {\n        e.span = c.getJobContext(ctx)\n    }\n    go c.runWithRecovery(e)\n}\n\nfunc (c *Job) runWithRecovery(e *Entry) {\n    ctx := gin.CreateNewContext(c.gin)\n    ...\n    defer func() {\n        if r := recover(); r != nil {\n            const size = 64 &lt;&lt; 10\n            buf := make([]byte, size)\n            buf = buf[:runtime.Stack(buf, false)]\n\n            requestId, _ := ctx.Get(\"requestId\")\n            handleName := ctx.CustomContext.HandlerName()\n            info, _ := json.Marshal(map[string]interface{}{\n                ...some kv for log\n            })\n            log.Printf(...)\n        }\n        gin.RecycleContext(c.gin, ctx)\n    }()\n\n    if c.beforeRun != nil {\n        ok := c.beforeRun(ctx, e.span)\n        if !ok {\n            return\n        }\n    }\n\n    error := e.Job.Run(ctx)\n    ...\n    if c.afterRun != nil {\n        c.afterRun(ctx)\n    }\n}\n\n\n// DealMission\n\nfunc DealMission(c *gin.Context, params...) {\n    // lock something use sync.mutex\n    doSomeLock()\n\n    defer func() {\n        // ...not trigger\n        unlockErr := unlockxxxxx(...)\n        if unlockErr != nil {\n            panic(\"some error info\")\n        }\n    } ()\n\n    base.DebugLog(...)\n    err := SomeOtherFunc(c, params...)\n    base.DebugLog(...)\n}\n\n// some other func\nfunc SomeOtherFunc(ctx *gin.Context, params...) error {\n    err := CallOther()\n    base.DebugLog(...)\n\n    err := CallOther()\n    base.DebugLog(...)\n\n    //  there is no logs after this call func, and Job.runWithRecovery not catch any panic error\n    err := CallOther()\n    // print log...  \n    base.DebugLog(...)\n}\n\n</code></pre>\n\n<p>in this sub job, the log stop at a certain line\uff0c and no panic\uff0cno error\uff0c and the defer seems not trigger because the mutex lock is not unlock  </p>\n\n<p>log for other job is well, and log of next cycle job is well too</p>\n"}, {"tags": ["ssl", "go", "openssl", "rsa", "tls1.2"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557834687, "post_id": 56129533, "comment_id": 98890669, "body": "Your PEM data is apparently invalid. But since we can&#39;t see what data you&#39;re using, it&#39;s pretty difficult to validate/debug."}, {"owner": {"reputation": 3351, "user_id": 6633434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Z3AKA.png?s=128&g=1", "display_name": "Sumit Agarwal", "link": "https://stackoverflow.com/users/6633434/sumit-agarwal"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557834745, "post_id": 56129533, "comment_id": 98890706, "body": "but I am using same pem data for my openssl command which work fine for making the connection"}, {"owner": {"reputation": 3351, "user_id": 6633434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Z3AKA.png?s=128&g=1", "display_name": "Sumit Agarwal", "link": "https://stackoverflow.com/users/6633434/sumit-agarwal"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557834801, "post_id": 56129533, "comment_id": 98890731, "body": "Also I read that it pulls system cert pools, is that the case? I haven&#39;t added these certs to my mac keychain"}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 5, "last_activity_date": 1557839039, "creation_date": 1557839039, "answer_id": 56131169, "question_id": 56129533, "link": "https://stackoverflow.com/questions/56129533/tls-with-certificate-private-key-and-pass-phrase/56131169#56131169", "title": "TLS with Certificate, Private Key and Pass Phrase", "body": "<p>You seem to be confusing certificate authorities with client certificates. Client certificates prove to the server that you are who you say you are (much like a username and password would), and CAs are used so that you know that you're talking to the correct server.</p>\n\n<p>Judging from the openssl command that works for you, your bank gave you a client certificate and key (although that is highly unusal; no one except yourself should ever hold your private key and especially the passphrase).</p>\n\n<p><a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"noreferrer\">The <code>tls.Config.Certificates</code> field</a>, if used by a client, is used to configure client certificates.</p>\n\n<blockquote>\n  <p>Certificates contains one or more certificate chains to present to the other side of the connection. [...] Clients doing client-authentication may set either Certificates or GetClientCertificate.</p>\n</blockquote>\n\n<p>Certificates for TLS are typically loaded with <a href=\"https://golang.org/pkg/crypto/tls/#LoadX509KeyPair\" rel=\"noreferrer\">tls.LoadX509KeyPair</a> or <a href=\"https://golang.org/pkg/crypto/tls/#X509KeyPair\" rel=\"noreferrer\">tls.X509KeyPair</a>. However, these functions do not directly support encrypted keys.</p>\n\n<p>Instead, you have to load the key yourself, decrypt it using <a href=\"https://golang.org/pkg/crypto/x509/#DecryptPEMBlock\" rel=\"noreferrer\">x509.DecryptPEMBlock</a>, and then you can use tls.X509KeyPair.</p>\n\n<p>The following example uses an EC key because its encoding is short, but it works the same with RSA keys.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"encoding/pem\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n)\n\nvar bundle = []byte(`\n-----BEGIN EC PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: AES-256-CBC,99586A658F5D2DAC4A8A3CA387CF71CE\n\n25EtKb7ycOI/5R47fYwpiaNERgYnCxCtcrMXJuOgueuxUXjiU0n93hpUpIQqaTLH\ndDKhsR1UHvGJVTV4h577RQ+nEJ5z8K5Y9NWFqzfa/Q5SY43kqqoJ/fS/OCnTmH48\nz4bL/dJBDE/a5HwJINgqQhGi9iUkCWUiPQxriJQ0i2s=\n-----END EC PRIVATE KEY-----\n-----BEGIN CERTIFICATE-----\nMIIB2TCCAX+gAwIBAgIUUTZvgwwnbC05WHgIHMXxrbZzr6wwCgYIKoZIzj0EAwIw\nQjELMAkGA1UEBhMCWFgxFTATBgNVBAcMDERlZmF1bHQgQ2l0eTEcMBoGA1UECgwT\nRGVmYXVsdCBDb21wYW55IEx0ZDAeFw0xOTA1MTQxMzAwMDJaFw0xOTA1MTUxMzAw\nMDJaMEIxCzAJBgNVBAYTAlhYMRUwEwYDVQQHDAxEZWZhdWx0IENpdHkxHDAaBgNV\nBAoME0RlZmF1bHQgQ29tcGFueSBMdGQwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNC\nAAScgLGx6SXchEo/s0X3AoF0mQkh3bGf9QY0s/2dPqf3/9irwz35DiDGoaP+FDZv\nHnUX+D3tUEPhxkLyzWKKT9HHo1MwUTAdBgNVHQ4EFgQU3eB8oRcmvzZrx9Dkb6ma\nMMtu1MkwHwYDVR0jBBgwFoAU3eB8oRcmvzZrx9Dkb6maMMtu1MkwDwYDVR0TAQH/\nBAUwAwEB/zAKBggqhkjOPQQDAgNIADBFAiAvw/FqAmGbSlBklp6AHJy9kf9VPyhe\nRA93ccNQ+7m1fAIhAOXr8c2QsH2oOYRTbn6bPZjkYQ2jLMaxatKhChBIuyZA\n-----END CERTIFICATE-----\n`)\n\nfunc main() {\n    keyBlock, certsPEM := pem.Decode(bundle)\n\n    fmt.Println(x509.IsEncryptedPEMBlock(keyBlock)) // Output: true\n\n    // Decrypt key\n    keyDER, err := x509.DecryptPEMBlock(keyBlock, []byte(\"foobar\"))\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Update keyBlock with the plaintext bytes and clear the now obsolete\n    // headers.\n    keyBlock.Bytes = keyDER\n    keyBlock.Headers = nil\n\n    // Turn the key back into PEM format so we can leverage tls.X509KeyPair,\n    // which will deal with the intricacies of error handling, different key\n    // types, certificate chains, etc.\n    keyPEM := pem.EncodeToMemory(keyBlock)\n\n    cert, err := tls.X509KeyPair(certsPEM, keyPEM)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    config := &amp;tls.Config{\n        Certificates: []tls.Certificate{cert},\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3351, "user_id": 6633434, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Z3AKA.png?s=128&g=1", "display_name": "Sumit Agarwal", "link": "https://stackoverflow.com/users/6633434/sumit-agarwal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2123, "favorite_count": 0, "accepted_answer_id": 56131169, "answer_count": 1, "score": 0, "last_activity_date": 1557839039, "creation_date": 1557833814, "last_edit_date": 1557834657, "question_id": 56129533, "link": "https://stackoverflow.com/questions/56129533/tls-with-certificate-private-key-and-pass-phrase", "title": "TLS with Certificate, Private Key and Pass Phrase", "body": "<p>I am integrating with a bank server which has provided me with the certificates. I create a <code>pem</code> file out of the certificates, so now I have the Certificates, Private Key in a <code>pem</code> file and the Pass Phrase for the key separately.</p>\n\n<p>The newly generated file <code>pem</code> is working for making an SSL connection using the OpenSSL command as follows:</p>\n\n<pre><code>openssl s_client -connect host:port -key key.pem -cert cert.pem\n</code></pre>\n\n<p>This command requests for the passphrase and I am able to connect. But I am not able to connect to the same using my Go code, which looks like this: </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"fmt\"\n    \"net/http\"\n)\n\nfunc main() {\n    caCert := []byte(`certs pem data`) // this contains both private key and certificates\n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(caCert)\n\n    // Setup HTTPS client\n    tlsConfig := &amp;tls.Config{\n        RootCAs:            caCertPool,\n        InsecureSkipVerify: true,\n    }\n    tlsConfig.BuildNameToCertificate()\n    transport := &amp;http.Transport{TLSClientConfig: tlsConfig}\n    client := &amp;http.Client{Transport: transport}\n\n    httpRequest, _ := http.NewRequest(\"GET\", \"https://test.com\", nil)\n    resp, err := client.Do(httpRequest)\n    fmt.Printf(\"resp: [%v] \\n Error: [%v]\", resp, err)\n}\n</code></pre>\n\n<p>I am also not sure where to add the passphrase in my HTTP request.</p>\n\n<p>The error I am getting: <code>remote error: tls: bad certificate</code></p>\n"}, {"tags": ["go", "mercurial", "clone"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557841679, "post_id": 56124802, "comment_id": 98894960, "body": "bitbucket.org does not support ssl3 (it is not considered secure anymore), and for some reason mercurial doesn&#39;t negotiate a more modern TLS version. Which version of hg is installed and how did you install it?"}, {"owner": {"reputation": 1359, "user_id": 2965046, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/66ff520e36df56c1d18af18126133642?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Dafny", "link": "https://stackoverflow.com/users/2965046/guy-dafny"}, "edited": false, "score": 2, "creation_date": 1563867983, "post_id": 56124802, "comment_id": 100832592, "body": "Had same problem.  solved by updating the mercurial to latest version."}, {"owner": {"reputation": 2147, "user_id": 5649639, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d62527cc72c1a877a15b7bfc27d79a50?s=128&d=identicon&r=PG&f=1", "display_name": "SebMa", "link": "https://stackoverflow.com/users/5649639/sebma"}, "edited": false, "score": 1, "creation_date": 1578452993, "post_id": 56124802, "comment_id": 105439943, "body": "@boedrs If you need to update <code>hg</code> and you are using Ubuntu, you can do it with <a href=\"https://launchpad.net/~mercurial-ppa/+archive/ubuntu/releases\" rel=\"nofollow noreferrer\">this PPA repository</a>"}], "owner": {"reputation": 53, "user_id": 3838748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1c757d2b9e6e9c9dac3335c55cdb175?s=128&d=identicon&r=PG&f=1", "display_name": "boedrs", "link": "https://stackoverflow.com/users/3838748/boedrs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1266, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1557817781, "creation_date": 1557817781, "question_id": 56124802, "link": "https://stackoverflow.com/questions/56124802/how-to-solve-sslv3-alert-handshake-failure-during-hg-clone-called-from-go-get", "title": "How to solve sslv3 alert handshake failure during hg clone called from go get?", "body": "<p>I am trying to install package for golang using the following command:</p>\n\n<pre><code>go get github.com/go-redis/redis\n</code></pre>\n\n<p>However, I got the following error:</p>\n\n<pre><code>go: bitbucket.org/zombiezen/gopdf@v0.0.0-20150317163809-1c63dc69751b: hg clone -U https://bitbucket.org/zombiezen/gopdf . in $GOPATH/go/pkg/mod/cache/vcs/296ef794d9a4113ffd8a947e0289b60e1e2cdeaebc09fe0be1f071e0ced6dbaf: exit status 255:\nabort: error: [SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:590)\n</code></pre>\n\n<p>go: error loading module requirements</p>\n\n<p>It seems that hg clone is failing. </p>\n\n<p>I tried few other package installation, such as:</p>\n\n<pre><code>go get bitbucket.org/zombiezen/gopdf/pdf\nhg clone -U https://bitbucket.org/zombiezen/gopdf\nhg clone https://github.com/golang/oauth2\n</code></pre>\n\n<p>But it produces the same error, which is <code>abort: error: [SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:590)</code></p>\n\n<p>I have tried this solution: <a href=\"https://stackoverflow.com/questions/35405092/sslerror-sslv3-alert-handshake-failure\">SSLError: sslv3 alert handshake failure</a></p>\n\n<p>But it does not work on my case.</p>\n\n<p>Anyone can help?</p>\n"}, {"tags": ["pdf", "go"], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 1, "last_activity_date": 1557830119, "creation_date": 1557830119, "answer_id": 56128466, "question_id": 56124490, "link": "https://stackoverflow.com/questions/56124490/how-to-print-text-data-into-pdf-by-gopdf/56128466#56128466", "title": "How to print text data into pdf by gopdf?", "body": "<p>Do not skip error handling, that's why you don't see what is the reason of failure.</p>\n\n<p>Please add err check to <code>SetFont</code>, <code>Text</code>, <code>WritePdf</code> functions. In my case I found that error was coming from <code>SetFont</code> since it was not found.</p>\n\n<p>This code works well if you have <code>open-sans.ttf</code> in your working dir:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/signintech/gopdf\"\n)\n\nfunc main() {\n    pdf := gopdf.GoPdf{}\n    pdf.Start(gopdf.Config{PageSize: *gopdf.PageSizeA4})\n    pdf.AddPage()\n\n    if err := pdf.AddTTFFont(\"open-sans\", \"open-sans.ttf\"); err != nil {\n        log.Print(err.Error())\n        return\n    }\n\n    if err := pdf.SetFont(\"open-sans\", \"\", 14); err != nil {\n        log.Print(err.Error())\n        return\n    }\n\n    pdf.SetX(100)\n    pdf.SetY(200)\n\n    data := \"Line1 &lt;br/&gt;\\n\" +\n        \"Line2 \\n\" +\n        \"Line3 \\n\" +\n        \"Line4\"\n\n    if err := pdf.Text(data); err != nil {\n        log.Print(err.Error())\n        return\n    }\n\n    if err := pdf.WritePdf(\"hello.pdf\"); err != nil {\n        log.Print(err.Error())\n        return\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 419, "user_id": 11296502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8969a369d6753a2caf66c8cb370dad2?s=128&d=identicon&r=PG&f=1", "display_name": "02040402", "link": "https://stackoverflow.com/users/11296502/02040402"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56128466, "answer_count": 1, "score": -1, "last_activity_date": 1557830119, "creation_date": 1557816586, "last_edit_date": 1557818646, "question_id": 56124490, "link": "https://stackoverflow.com/questions/56124490/how-to-print-text-data-into-pdf-by-gopdf", "title": "How to print text data into pdf by gopdf?", "body": "<p>What I tried:</p>\n\n<pre><code>var data string\ndata = \"Line1 &lt;br&gt;\\n\" +\n       \"Line2 \\n\" +\n       \"Line3 \\n\" +\n       \"Line4\" // It's got from DB which saved by br data.\n\npdf.SetFont(\"wts11\", \"\", 14)\npdf.SetX(100)\npdf.SetY(200)\npdf.Text(data)\n</code></pre>\n\n<p>Result:</p>\n\n<p>The pdf shows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/uOfNh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uOfNh.png\" alt=\"enter image description here\"></a></p>\n\n<p>And all other printed data disappeared.</p>\n\n<p>Maybe it can't parse <code>&lt;br&gt;</code>.</p>\n\n<p>Even change <code>pdf.Text(data)</code> to <code>pdf.Cell(nil, text)</code>, also the same result.</p>\n\n<p>Ref:</p>\n\n<blockquote>\n  <p><a href=\"https://github.com/signintech/gopdf\" rel=\"nofollow noreferrer\">https://github.com/signintech/gopdf</a></p>\n</blockquote>\n\n<p>Similar issue:</p>\n\n<p><a href=\"https://github.com/signintech/gopdf/issues/78\" rel=\"nofollow noreferrer\">https://github.com/signintech/gopdf/issues/78</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 351, "user_id": 1774646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e594c1d84998cb4cdfe7008014788201?s=128&d=identicon&r=PG", "display_name": "abvarun226", "link": "https://stackoverflow.com/users/1774646/abvarun226"}, "edited": false, "score": 0, "creation_date": 1557813006, "post_id": 56123650, "comment_id": 98879475, "body": "This might help, <a href=\"https://stackoverflow.com/questions/53422587/need-to-parse-integers-in-json-as-integers-not-floats\" title=\"need to parse integers in json as integers not floats\">stackoverflow.com/questions/53422587/&hellip;</a>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557814133, "post_id": 56123650, "comment_id": 98879884, "body": "Why are you using the %f verb if you want an int?"}, {"owner": {"reputation": 11, "user_id": 7349062, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ilBii86Ryu0/AAAAAAAAAAI/AAAAAAAAAQE/UL8onzBHTF4/photo.jpg?sz=128", "display_name": "ineva", "link": "https://stackoverflow.com/users/7349062/ineva"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557901020, "post_id": 56123650, "comment_id": 98915565, "body": "@Volker because <code>code</code> can be int or float."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557904186, "post_id": 56123650, "comment_id": 98917031, "body": "In JSON all numbers are floats. Or just don&#39;t decode into the empty interface{}? This looks suspiciously like a XY-problem."}], "answers": [{"tags": [], "owner": {"reputation": 460, "user_id": 4547125, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eAwIB.jpg?s=128&g=1", "display_name": "minji", "link": "https://stackoverflow.com/users/4547125/minji"}, "is_accepted": false, "score": 1, "last_activity_date": 1557818562, "last_edit_date": 1557818562, "creation_date": 1557818259, "answer_id": 56124915, "question_id": 56123650, "link": "https://stackoverflow.com/questions/56123650/how-to-format-int-number-from-jsons-mapstringinterface-without-exponent/56124915#56124915", "title": "How to format int number from json&#39;s map[string]interface{} without exponent?", "body": "<p>try this code</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc isIntegral(val float64) bool {\n    return val == float64(int(val))\n}\n\nfunc main() {\n    jsonStr := `{\"code1\":10080061,\"code2\":12.2, \"code3\": 123.23123, \"code4\": \"string\"}`\n\n    data := map[string]interface{}{}\n    _ = json.Unmarshal([]byte(jsonStr), &amp;data)\n\n    for k, v := range data {\n        switch v.(type) {\n        case float64:\n           // check the v is integer or float\n            if isIntegral(v.(float64)) {\n                // if v is an integer, try to cast\n                fmt.Printf(\"%v: %d\\n\", k, int(v.(float64)))\n            } else {\n                fmt.Printf(\"%v: %v\\n\", k, v)\n            }\n        default:\n            fmt.Printf(\"%v: %v\\n\", k, v)\n        }\n    }\n}\n</code></pre>\n\n<p>output</p>\n\n<pre><code>code1: 10080061\ncode2: 12.2\ncode3: 123.23123\ncode4: string\n</code></pre>\n\n<p>ref</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/43182427/go-lang-how-to-check-if-float-value-is-actually-int?noredirect=1&amp;lq=1\">Go lang how to check if float value is actually int</a></p></li>\n<li><p><a href=\"https://newfivefour.com/golang-interface-type-assertions-switch.html\" rel=\"nofollow noreferrer\">https://newfivefour.com/golang-interface-type-assertions-switch.html</a></p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 7349062, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ilBii86Ryu0/AAAAAAAAAAI/AAAAAAAAAQE/UL8onzBHTF4/photo.jpg?sz=128", "display_name": "ineva", "link": "https://stackoverflow.com/users/7349062/ineva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557818562, "creation_date": 1557812319, "question_id": 56123650, "link": "https://stackoverflow.com/questions/56123650/how-to-format-int-number-from-jsons-mapstringinterface-without-exponent", "title": "How to format int number from json&#39;s map[string]interface{} without exponent?", "body": "<p>This demo: <a href=\"https://play.golang.org/p/7tpQNlNkHgG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/7tpQNlNkHgG</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\nfunc main() {\n    jsonStr := `{\"code1\":10080061,\"code2\":12.2}`\n    data := map[string]interface{}{}\n    json.Unmarshal([]byte(jsonStr), &amp;data)\n    for k, v := range data {\n        fmt.Printf(\"%v:%v, %v:%f, %v:%.0f\\n\", k, v, k, v, k, v)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>code1:1.0080061e+07, code1:10080061.000000, code1:10080061\ncode2:12.2, code2:12.200000, code2:12\n</code></pre>\n\n<p>I want code1 to output <code>10080061</code> and code2 to output <code>12.2</code>.\nHow can I do this done.</p>\n"}, {"tags": ["go", "github", "go-modules"], "comments": [{"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 1, "creation_date": 1557802085, "post_id": 56122066, "comment_id": 98876944, "body": "guess you only change master branch, not tag v2.3.1?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557804815, "post_id": 56122066, "comment_id": 98877459, "body": "You a github fork is a new package with new import path and 100% unrelated to the original. YOu must rewrite all import in your fork."}, {"owner": {"reputation": 595, "user_id": 1263251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7b94fa8ccc8a8eb41069a7d45659633a?s=128&d=identicon&r=PG", "display_name": "vreal", "link": "https://stackoverflow.com/users/1263251/vreal"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1557880574, "post_id": 56122066, "comment_id": 98911095, "body": "@zzn My change was in add_features branch and tagged as v2.3.1. You can check my source."}, {"owner": {"reputation": 595, "user_id": 1263251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7b94fa8ccc8a8eb41069a7d45659633a?s=128&d=identicon&r=PG", "display_name": "vreal", "link": "https://stackoverflow.com/users/1263251/vreal"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557880674, "post_id": 56122066, "comment_id": 98911114, "body": "@Volker I did what you&#39;ve said in master with tag v2.3.2 already but still got the similar error when I run go get github.com/vrealzhou/goformation@v2.3.2"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557899256, "post_id": 56122066, "comment_id": 98914876, "body": "You must understand that you basically <b>cannot</b> &quot;fork&quot; (in the Github sense) a Go repo. What you can do is create a new package and everything in there must use the new package import path, starting from the go.mod and all imports. Probably you should not &quot;customize&quot; goformation but provide a wrapper."}, {"owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "edited": false, "score": 0, "creation_date": 1559137831, "post_id": 56122066, "comment_id": 99327697, "body": "You can use <code>replace</code> in your <code>go.mod</code> to do exactly what you&#39;re looking for - use a fork without updating imports or anything. I posted an answer with the updates needed for the <code>go.mod</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8505, "user_id": 28275, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/44285eaa05bd797bcc7b22133318120a?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/28275/david"}, "edited": false, "score": 0, "creation_date": 1610724390, "post_id": 56362174, "comment_id": 116230501, "body": "I believe this is missing the <code>module</code> line at the top of the example. In this case, any module name will work as it is not published"}], "tags": [], "owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "is_accepted": true, "score": 11, "last_activity_date": 1559137787, "creation_date": 1559137787, "answer_id": 56362174, "question_id": 56122066, "link": "https://stackoverflow.com/questions/56122066/go-get-on-forked-github-repo-got-unexpected-module-path-error/56362174#56362174", "title": "go get on forked github repo got &quot;unexpected module path&quot; error", "body": "<p>You can use <code>replace</code> in your <code>go.mod</code> to use a fork instead of the upstream version. That way, you can make whatever modifications you need to the code without having to update the module path or import paths.</p>\n\n<p>To be specific, in this case, you can do the following in your <code>go.mod</code> (I tested this by forking the repo, making a small change, and confirming it showed up):</p>\n\n<pre><code>require github.com/awslabs/goformation v1.4.1\n\nreplace github.com/awslabs/goformation =&gt; github.com/vrealzhou/goformation master\n</code></pre>\n\n<p>The first time you build or test, <code>master</code> will be replaced by the latest pseudo-version for your fork to make sure you get repeatable builds. The <code>replace</code> requires a specific version for the replacement.</p>\n"}], "owner": {"reputation": 595, "user_id": 1263251, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/7b94fa8ccc8a8eb41069a7d45659633a?s=128&d=identicon&r=PG", "display_name": "vreal", "link": "https://stackoverflow.com/users/1263251/vreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1173, "favorite_count": 1, "accepted_answer_id": 56362174, "answer_count": 1, "score": 7, "last_activity_date": 1559137787, "creation_date": 1557799623, "question_id": 56122066, "link": "https://stackoverflow.com/questions/56122066/go-get-on-forked-github-repo-got-unexpected-module-path-error", "title": "go get on forked github repo got &quot;unexpected module path&quot; error", "body": "<p>I'm currently working something on AWS Cloudformation which using this repo <a href=\"https://github.com/awslabs/goformation\" rel=\"noreferrer\">https://github.com/awslabs/goformation</a>. Because I did some customise so I made a fork <a href=\"https://github.com/vrealzhou/goformation\" rel=\"noreferrer\">https://github.com/vrealzhou/goformation</a>.</p>\n\n<p>Now in my other project (using go module) I'm trying to using <code>go get github.com/vrealzhou/goformation@v2.3.1</code> and I've got this error:</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>go: github.com/vrealzhou/goformation@v0.0.0-20190513073615-ff3b65adb278: parsing go.mod: unexpected module path \"github.com/awslabs/goformation\"\ngo: error loading module requirements\n</code></pre>\n\n<p>Does anyone know the reason and how to solve this problem? Thanks</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1557805124, "post_id": 56120908, "comment_id": 98877524, "body": "You must realize that <code>interface{}</code> does not mean &quot;any type&quot;: It means literally <code>interface{}</code> and as Go is strict in its type you cannot use <code>interface{}</code> where something else is expected like <code>string</code>. Just because you can <i>assign</i> any type of value to a variable of type <code>interface{}</code> does not mean that <code>interface{}</code> is not its own, strict type which must match literaly."}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 5, "last_activity_date": 1557795265, "last_edit_date": 1557795265, "creation_date": 1557794822, "answer_id": 56121580, "question_id": 56120908, "link": "https://stackoverflow.com/questions/56120908/go-interface-property-is-undefined/56121580#56121580", "title": "Go Interface property is undefined", "body": "<p>There are a couple of problems here:</p>\n\n<p>You can't call a method on an empty interface (<code>interface{}</code>) because the empty interface has no methods defined.</p>\n\n<p>You can't reference fields through an interface type, only methods.</p>\n\n<p>You need to determine what behavior something you set as the value of <code>user</code> should have and define an interface to reflect that. For example, if the only thing you need a user to be able to do is provide a password, the interface would be</p>\n\n<pre><code>type User interface {\n    Password() string\n}\n</code></pre>\n\n<p>Your struct would then be</p>\n\n<pre><code>type userResp struct {\n  user User\n}\n</code></pre>\n\n<p>You would then return the password like this:</p>\n\n<pre><code>return ur.user.Password()\n</code></pre>\n\n<p>Whatever types you want to store in the <code>user</code> field would have to have the <code>Password</code> method defined on them so they satisfy the <code>User</code> interface</p>\n"}], "owner": {"reputation": 57, "user_id": 11495381, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdLPE.png?s=128&g=1", "display_name": "TayLorWebK", "link": "https://stackoverflow.com/users/11495381/taylorwebk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557811300, "creation_date": 1557788632, "last_edit_date": 1557811300, "question_id": 56120908, "link": "https://stackoverflow.com/questions/56120908/go-interface-property-is-undefined", "title": "Go Interface property is undefined", "body": "<p>I have a specific problem where I need a variable that can take the value of one or another structure. I create a userResp structure with a user field which has the value of an interface, but if I add a function that returns a sub property of user called Password, returns error. The value of user will be a struct that have the Password property.</p>\n\n<p>The struct:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type userResp struct {\n  user interface{}\n}\n</code></pre>\n\n<p>the function</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (ur *userResp) password() string {\n  return ur.user.Password\n}\n</code></pre>\n\n<p>I get <code>ur.user.Password undefined (type interface {} is interface with no methods)</code> but the interface <code>user</code> can be a Admin or User struct with a <code>Password</code> field.</p>\n\n<p>Any idea how do this, I need to work with an struct of either the user or admin and return it.</p>\n\n<p>I can't use 2 functions because the logic is the same in both cases. I need the entire struct of User or Admin</p>\n"}, {"tags": ["go", "grpc", "grpc-go"], "answers": [{"tags": [], "owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "is_accepted": false, "score": 1, "last_activity_date": 1557787814, "creation_date": 1557787814, "answer_id": 56120801, "question_id": 56119785, "link": "https://stackoverflow.com/questions/56119785/is-a-nil-server-message-possible-with-grpc/56120801#56120801", "title": "is a nil server message possible with gRPC?", "body": "<p>Yes, this should never happen. GRPC is responsible for that.</p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 2, "last_activity_date": 1557955410, "last_edit_date": 1557955410, "creation_date": 1557865408, "answer_id": 56138075, "question_id": 56119785, "link": "https://stackoverflow.com/questions/56119785/is-a-nil-server-message-possible-with-grpc/56138075#56138075", "title": "is a nil server message possible with gRPC?", "body": "<p>Investigating further with a contrived server example:</p>\n\n<pre><code>func (s *mygRPC) GetStatus(context.Context, *empty.Empty) (*pb.Status, error) {\n    log.Println(\"cli: GetStatus()\")\n\n    //return &amp;pb.Status{}, nil\n    return nil, nil // &lt;- can server return a nil status message (with nil error)\n}\n</code></pre>\n\n<p>and testing client/server reactions:</p>\n\n<p><strong>CLIENT:</strong></p>\n\n<pre><code>ERROR: rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil\n</code></pre>\n\n<p><strong>SERVER:</strong></p>\n\n<pre><code>2019/05/14 16:09:50 cli: GetStatus()\nERROR: 2019/05/14 16:09:50 grpc: server failed to encode response:  rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil\n</code></pre>\n\n<p>So even if one wanted to <em>legitimately</em> return a nil value, the <code>gRPC</code> transport will not allow it.</p>\n\n<p><strong>Note:</strong> the server-side code is still executed - as expected - but as far as the client is concerned, the <code>gRPC</code> call failed.</p>\n\n<p><strong>Conclusion:</strong> a valid (<code>err==nil</code>) server response will <em>always</em> return a valid (non-<code>nil</code>) message.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Inspecting the <code>gRPC</code> source reveals where a <code>nil</code> message is caught:</p>\n\n<p><a href=\"https://github.com/grpc/grpc-go/blob/master/server.go#L837\" rel=\"nofollow noreferrer\">server.go</a></p>\n\n<pre><code>func (s *Server) sendResponse(t transport.ServerTransport, stream *transport.Stream, msg interface{}, cp Compressor, opts *transport.Options, comp encoding.Compressor) error {\n    data, err := encode(s.getCodec(stream.ContentSubtype()), msg)\n    if err != nil {\n        grpclog.Errorln(\"grpc: server failed to encode response: \", err)\n        return err\n    }\n    // ...\n}\n</code></pre>\n\n<p><a href=\"https://github.com/grpc/grpc-go/blob/master/rpc_util.go#L543\" rel=\"nofollow noreferrer\">rpc_util.go</a></p>\n\n<pre><code>func encode(c baseCodec, msg interface{}) ([]byte, error) {\n    if msg == nil { // NOTE: typed nils will not be caught by this check\n        return nil, nil\n    }\n    b, err := c.Marshal(msg)\n    if err != nil {\n        return nil, status.Errorf(codes.Internal, \"grpc: error while marshaling: %v\", err.Error())\n    }\n    // ...\n}\n</code></pre>\n\n<p>The comment in this line is key:</p>\n\n<pre><code>if msg == nil { // NOTE: typed nils will not be caught by this check }\n</code></pre>\n\n<p>So if one were to use reflect on our typed-nil, <code>reflect.ValueOf(msg).IsNil()</code> would return <code>true</code>. The following <code>c.Marshal(msg)</code> errors - and the call fails to send a message response to the client.</p>\n"}], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1716, "favorite_count": 0, "accepted_answer_id": 56138075, "answer_count": 2, "score": 3, "last_activity_date": 1557955410, "creation_date": 1557781112, "last_edit_date": 1557787736, "question_id": 56119785, "link": "https://stackoverflow.com/questions/56119785/is-a-nil-server-message-possible-with-grpc", "title": "is a nil server message possible with gRPC?", "body": "<p>In the following <code>gRPC</code>-client code, is the second <code>if</code> necessary?</p>\n\n<pre><code>status, err := cli.GetStatus(ctx, &amp;empty.Empty{})\nif err != nil {\n    return err\n}\n\nif status == nil {\n    // this should NEVER happen - right?\n    return fmt.Errorf(\"nil Status result returned\") \n}\n</code></pre>\n\n<p>Intuitively, one should always check for nil in <code>go</code> <em>just in case</em>.\nHowever, there is a runtime check to catch any client-to-server <code>nil</code> usage e.g.</p>\n\n<pre><code>status, err := cli.GetStatus(ctx, nil) // &lt;- runtime error\n\nif err != nil {\n    // \"rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil\"\n    return err\n}\n</code></pre>\n\n<p>So is there a similar server-to-client runtime guarantee, and thus remove the need for a <code>status == nil</code> check?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557774366, "post_id": 56118409, "comment_id": 98870091, "body": "Why are you starting at <code>i:=d</code> instead of <code>i:=0</code>? And it your <code>max</code> variable actually for holding the <i>minimum</i> value found, why is it called <code>max</code>, am I missing something? Also it appears your logic only allows for removing <code>d</code> <i>contiguous</i> digits, but from the description it seems like the answer you&#39;re looking for requires removing <i>any</i> <code>d</code> digits, is that right?"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557775511, "post_id": 56118409, "comment_id": 98870571, "body": "this is a recursion problem, no?   I would expect to see some recursive calling within your solution."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557778956, "post_id": 56118409, "comment_id": 98871872, "body": "If I parsed the question correctly, what you&#39;re after is called &quot;Cartesian product&quot;: the exhaustive search for any <code>d</code> is performed by <code>d</code> nested loops, each of which, on each iteration, removes a digit (in any order, say, from left to right) and calls the remaining loops on what it ended up with. Say, with <code>n = 1234</code> and <code>d = 2</code>, the outermost loop would call the inner loop with the inputs <code>234</code>, <code>134</code>, <code>124</code> and <code>123</code>, and the inner loop would test, e.g., <code>34</code>, <code>24</code> and <code>23</code> for the 1st input from the outer loop, and so on."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1557779064, "post_id": 56118409, "comment_id": 98871907, "body": "I&#39;m voting to close this question as off-topic because it&#39;s a homework question which has nothing to do with Go."}, {"owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557779692, "post_id": 56118409, "comment_id": 98872161, "body": "@Adrian if i use i:=0 it gives me a slice bounds out of range error. The &quot;max&quot; variable was called so because in the beginning i read that I had to look for the biggest number, so It was a mistake of mine. I can remove any digit in any position, but I can&#39;t move the numbers themselves"}, {"owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1557780147, "post_id": 56118409, "comment_id": 98872335, "body": "@kostix I think I understood, thank you. Basically I call the funcion d times and, everytime it is called, I remove one digit. I&#39;m going to sleep right now but tomorrow I&#39;m going to try it, thanks"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 1, "creation_date": 1557780147, "post_id": 56118409, "comment_id": 98872336, "body": "@PandaSekh: remove <code>d</code> not contiguous digits then find smallest number. I recommend one loop for <code>d</code> digits <code>for i := 0; i &lt; d; i++ {</code> and another loop for finding the <code>k</code> position to remove <code>for j := 0; j &lt; k; j++ {</code>."}, {"owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "reply_to_user": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "edited": false, "score": 0, "creation_date": 1557780299, "post_id": 56118409, "comment_id": 98872388, "body": "@A.R thanks for your answer, I&#39;m going to try it asap"}], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557779410, "post_id": 56119335, "comment_id": 98872047, "body": "the digits to remove do not appear to be contiguous, based on the input/output provided: <b>3</b>2<b>75</b>1960 -&gt; <code>21960</code>"}, {"owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557780221, "post_id": 56119335, "comment_id": 98872364, "body": "As @colminator pointed out, I can remove digits from any position. My code was wrong from the concept itself"}, {"owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "edited": false, "score": 0, "creation_date": 1557819847, "post_id": 56119335, "comment_id": 98882627, "body": "The one with only one loops doesn&#39;t work with certain inputs, while the first one always works. Thanks!"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "edited": false, "score": 1, "creation_date": 1557832325, "post_id": 56119335, "comment_id": 98889336, "body": "@PandaSekh: You&#39;re welcome. Corrected One loop version to start a loop from the beginning for each digit. so you may check it again."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": true, "score": 3, "last_activity_date": 1557832119, "last_edit_date": 1557832119, "creation_date": 1557778646, "answer_id": 56119335, "question_id": 56118409, "link": "https://stackoverflow.com/questions/56118409/cant-get-for-loop-to-iterate-enough-times-for-my-program-to-work/56119335#56119335", "title": "Can&#39;t get for loop to iterate enough times for my program to work", "body": "<p>You need think about algorithm first.<br>\nAnd the digits to remove do not appear to be contiguous:<br>\nHere <code>temp := num[:i-d] + num[i:]</code> you are trying to remove 3 adjacent digits (for <code>d=3</code>) and you should try to remove also not adjacent digits.<br>\nTip:<br>\nRemove one digit at a time (<code>k</code>): <code>n = n[:k] + n[k+1:]</code>     </p>\n\n<hr>\n\n<ol>\n<li>First for learning purpose, I recommend you to try the Brute-force method:   Generate all possible states and find the smallest number among them all.</li>\n</ol>\n\n<hr>\n\n<ol start=\"2\">\n<li>For smallest number left digit is smaller than right side digit.<br>\nRemove <code>d</code> not contiguous digits then find smallest number. I recommend one loop for <code>d</code> digits:<br>\n<code>for i := 0; i &lt; d; i++ {</code><br>\nand another loop for finding the <code>k</code> position to remove:<br>\n<code>for j := 0; j &lt; k; j++ {</code>.  </li>\n</ol>\n\n<p>Like <a href=\"https://play.golang.org/p/Djdv8cxcEei\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://play.golang.org/p/W-LrR009K0g\" rel=\"nofollow noreferrer\">this</a>:  </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    n := \"32751960\"\n    d := 3\n    // fmt.Scan(&amp;n, &amp;d)\n    for i := 0; i &lt; d; i++ {\n        k := len(n) - 1\n        for j := 0; j &lt; k; j++ {\n            if n[j] &gt; n[j+1] {\n                k = j\n                break\n            }\n        }\n        n = n[:k] + n[k+1:]\n    }\n    fmt.Println(n) // 21960\n}\n</code></pre>\n\n<hr>\n\n<ol start=\"3\">\n<li>Using 1 loop, like <a href=\"https://play.golang.org/p/d2OZ-vREgdg\" rel=\"nofollow noreferrer\">this</a>:  </li>\n</ol>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    n := \"322311\"\n    d := 3\n    // fmt.Scan(&amp;n, &amp;d)\n    for j := 0; j &lt; len(n)-1; j++ {\n        if n[j] &gt; n[j+1] {\n            n = n[:j] + n[j+1:]\n            j = -1\n            d--\n            if d &lt;= 0 {\n                break\n            }\n        }\n    }\n    n = n[:len(n)-d]\n    fmt.Println(n) // 211\n}\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8848493, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee766fbeaa2bef4061d687ca63e9d7db?s=128&d=identicon&r=PG&f=1", "display_name": "PandaSekh", "link": "https://stackoverflow.com/users/8848493/pandasekh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 56119335, "answer_count": 1, "score": 2, "last_activity_date": 1557832119, "creation_date": 1557774073, "last_edit_date": 1557809294, "question_id": 56118409, "link": "https://stackoverflow.com/questions/56118409/cant-get-for-loop-to-iterate-enough-times-for-my-program-to-work", "title": "Can&#39;t get for loop to iterate enough times for my program to work", "body": "<p>I'm trying to do some exercise our professor gave us to prepare for the exam, but I'm stuck on a pretty annoying problem.<br>\nThe exercise require two inputs, n and d, and the program has to find the smallest number removing d decimals from the number n. The problem lies around line 40 or 41, because I don't know how to get enough loops to try out every possibily. As for now, the program is limited and won't work properly with most of the inputs.    </p>\n\n<p><strong>Example input:</strong> 32751960 3<br>\n<strong>Expected output:</strong> 21960 (which is the smallest number we can get by removing 3 decimals from the first number)<br>\n<strong>What I get:</strong> 31960    </p>\n\n<p>Thanks in advance to anyone willing to help me.    </p>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"bufio\"\n    \"strconv\"\n    \"strings\"\n    \"math\"\n)\n\nvar (\n    input string\n    n, d, max int\n    num, dec string\n    in []int\n)\n\nfunc main (){\n    getInput()\n    max = n\n    fmt.Println(\"Variables: \", n, d)\n\n    //Check\n    if d&gt;len(num){\n        fmt.Println(math.NaN())\n        os.Exit(0)\n    }\n\n    //The problematic cicle\n    for i:=d; i&lt;=len(num); i++{ //On line 40 or 41 lies the problem: I don't get enough loops to check every possible combination,\n                                //and at the same time i have to limit the i var to not exceed the slice boundaries\n        temp := num[:i-d] + num[i:] \n        if temp == \"\"{ //To avoid blank strings\n            continue\n        }\n        itemp, _ := strconv.Atoi(temp)\n        fmt.Println(itemp)\n        if itemp &lt; max {\n            max = itemp\n        }\n\n    }\n    fmt.Println(\"Best number:\",max)\n}\n\nfunc getInput(){\n    scanner := bufio.NewScanner(os.Stdin)\n    if scanner.Scan(){\n        input = scanner.Text()\n    }\n    for _, s := range strings.Fields(input){\n        i, err := strconv.Atoi(s)\n        if err != nil {\n            fmt.Println(err)\n        }\n        in = append(in, i) //\n    }\n    n = in[0] //main number\n    d = in[1] //decimals to remove\n    num = strconv.Itoa(n)\n    dec = strconv.Itoa(d) \n}\n</code></pre>\n"}, {"tags": ["go", "import", "goland", "go-modules", "vgo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1557769749, "post_id": 56117459, "comment_id": 98868193, "body": "Yeah, that&#39;s how that works. What is your question about it?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557769755, "post_id": 56117459, "comment_id": 98868194, "body": "What problem did you have? Within the same module, go will find the source as expected."}, {"owner": {"reputation": 4418, "user_id": 603774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEUS9.jpg?s=128&g=1", "display_name": "Ali Mamedov", "link": "https://stackoverflow.com/users/603774/ali-mamedov"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1557770113, "post_id": 56117459, "comment_id": 98868347, "body": "@Adrian, I have extended my answer. And that extension describes the problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557770114, "post_id": 56117459, "comment_id": 98868349, "body": "That looks like an issue with Goland. Have you verified that it works with the go tools themselves?"}], "answers": [{"tags": [], "owner": {"reputation": 4418, "user_id": 603774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEUS9.jpg?s=128&g=1", "display_name": "Ali Mamedov", "link": "https://stackoverflow.com/users/603774/ali-mamedov"}, "is_accepted": true, "score": 9, "last_activity_date": 1557772276, "creation_date": 1557772276, "answer_id": 56118009, "question_id": 56117459, "link": "https://stackoverflow.com/questions/56117459/import-local-go-module-in-goland-ide/56118009#56118009", "title": "Import local Go module in Goland IDE", "body": "<p>As @JimB mentioned, the problem related to Goland IDE. I found solution <a href=\"https://github.com/Macilias/goVGOexample\" rel=\"noreferrer\">here</a>.</p>\n\n<p>Enabling Go modules (vgo) integration solves my problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HrGGF.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/HrGGF.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 4418, "user_id": 603774, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GEUS9.jpg?s=128&g=1", "display_name": "Ali Mamedov", "link": "https://stackoverflow.com/users/603774/ali-mamedov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 1, "accepted_answer_id": 56118009, "answer_count": 1, "score": 3, "last_activity_date": 1557772366, "creation_date": 1557769607, "last_edit_date": 1557772366, "question_id": 56117459, "link": "https://stackoverflow.com/questions/56117459/import-local-go-module-in-goland-ide", "title": "Import local Go module in Goland IDE", "body": "<p>What is proper way to import (use) go module internally?</p>\n\n<p>For example: </p>\n\n<p>creating a new module by: <code>go mod init example.com/my-project</code> (example.com or another domain, which doesn't exist)</p>\n\n<p>and using it in the same project: </p>\n\n<pre><code>import (\n    \"example.com/my-project/package\"\n)\n</code></pre>\n\n<p>This sample was taken from <a href=\"https://lets-go.alexedwards.net/\" rel=\"nofollow noreferrer\">Let's Go</a> book (but extremely simplified)</p>\n\n<p><strong>The problem:</strong></p>\n\n<p>I am using Goland, and It doesn't recognize this local module. Goland advice me to use <code>go get -t example.com/my-project/package</code> command. But <code>example.com/...</code> just a name for a module</p>\n\n<p><a href=\"https://i.stack.imgur.com/5Reax.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Reax.png\" alt=\"enter image description here\"></a> </p>\n"}, {"tags": ["go", "google-classroom", "google-api-go-client"], "answers": [{"comments": [{"owner": {"reputation": 1928, "user_id": 3611375, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2brwv.jpg?s=128&g=1", "display_name": "lesley2958", "link": "https://stackoverflow.com/users/3611375/lesley2958"}, "edited": false, "score": 0, "creation_date": 1558698447, "post_id": 56126791, "comment_id": 99196392, "body": "You can file feature requests here: <a href=\"https://issuetracker.google.com/issues/new?component=191645&amp;template=823908\" rel=\"nofollow noreferrer\">issuetracker.google.com/issues/&hellip;</a>  For this specific issue, however, there&#39;s already an issue for this here: <a href=\"http://issuetracker.google.com/36882823\" rel=\"nofollow noreferrer\">issuetracker.google.com/36882823</a>  I encourage you to follow this issue for updates. I also recommend clicking \u201cMe too!\u201d at the top of the listed issue and posting comments with your specific use cases."}], "tags": [], "owner": {"reputation": 3042, "user_id": 8342742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMVCJ.jpg?s=128&g=1", "display_name": "M\u03b1\u03c0\u03bcQ\u03bc\u03b1\u03c0k\u03b3V\u03c0.0", "link": "https://stackoverflow.com/users/8342742/m%ce%b1%cf%80%ce%bcq%ce%bc%ce%b1%cf%80k%ce%b3v%cf%80-0"}, "is_accepted": true, "score": 0, "last_activity_date": 1557825300, "creation_date": 1557825300, "answer_id": 56126791, "question_id": 56116063, "link": "https://stackoverflow.com/questions/56116063/is-it-possible-to-use-the-google-classroom-go-api-to-comment-on-things/56126791#56126791", "title": "Is it possible to use the Google Classroom Go API to comment on things?", "body": "<p>As of the moment, there is no direct method to do comment on assignment/post in Class API. You can visit <a href=\"https://developers.google.com/classroom/guides/manage-coursework#top_of_page\" rel=\"nofollow noreferrer\">this</a> to check what available actions is feasible with the current API. You can <a href=\"https://code.google.com/a/google.com/p/apps-api-issues/issues/entry?template=Feature%20request\" rel=\"nofollow noreferrer\">file a feature request</a> and follow the updates in the <a href=\"https://cloud.googleblog.com/2015/06/new-ways-to-integrate-with-Google-Classroom.html\" rel=\"nofollow noreferrer\">official blog</a>.</p>\n"}], "owner": {"reputation": 574, "user_id": 8676269, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9350b3c1b355151a3e616d5182fa683a?s=128&d=identicon&r=PG&f=1", "display_name": "W. Reyna", "link": "https://stackoverflow.com/users/8676269/w-reyna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 56126791, "answer_count": 1, "score": 0, "last_activity_date": 1591348723, "creation_date": 1557763447, "last_edit_date": 1575361466, "question_id": 56116063, "link": "https://stackoverflow.com/questions/56116063/is-it-possible-to-use-the-google-classroom-go-api-to-comment-on-things", "title": "Is it possible to use the Google Classroom Go API to comment on things?", "body": "<p>I'm wondering if there's a way to comment on a Google Classroom assignment/post through the Google Classroom API (specifically the <a href=\"https://github.com/googleapis/google-api-go-client/tree/master/classroom/v1\" rel=\"nofollow noreferrer\">Go client</a>). I've searched the docs but couldn't find anything.</p>\n"}, {"tags": ["go", "kubernetes", "client-go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557761471, "post_id": 56115197, "comment_id": 98864583, "body": "I believe the idiomatic approach is to have a conditional and an assignment inside to handle a true condition. That is, <code>if field == &quot;&quot; { field = defaultvalue }</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557761743, "post_id": 56115197, "comment_id": 98864719, "body": "You could of course make your life easier by using <code>reflect</code> to do it for you however I&#39;m not sure that would be considered idiomatic. That said, if you need this mainly for testing I would definitely recommend you use <code>reflect</code>."}, {"owner": {"reputation": 1560, "user_id": 667409, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ac46f9edf4508a6caec4706efe8246d?s=128&d=identicon&r=PG", "display_name": "kispaljr", "link": "https://stackoverflow.com/users/667409/kispaljr"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557761909, "post_id": 56115197, "comment_id": 98864797, "body": "Hi @mkopriva! Thank you for the answer. I&#39;ve realized that I wasn&#39;t clear enough, so I&#39;ve edited the question to reflect that I don&#39;t want to manually set all default values for every possible API objects and for every fields, but wanted to ask if it is already implemented in the Go client for me?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557762038, "post_id": 56115197, "comment_id": 98864858, "body": "If by client you mean the Go std lib, then no, there&#39;s nothing like that ready-made. If by client you mean k8s related packages then I&#39;m afraid I don&#39;t know, I&#39;ve haven&#39;t used kubernetes so far."}, {"owner": {"reputation": 1560, "user_id": 667409, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ac46f9edf4508a6caec4706efe8246d?s=128&d=identicon&r=PG", "display_name": "kispaljr", "link": "https://stackoverflow.com/users/667409/kispaljr"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557762203, "post_id": 56115197, "comment_id": 98864935, "body": "Yes, I meant the Kubernetes client. Sorry again for the sloppy phrasing"}, {"owner": {"reputation": 1560, "user_id": 667409, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ac46f9edf4508a6caec4706efe8246d?s=128&d=identicon&r=PG", "display_name": "kispaljr", "link": "https://stackoverflow.com/users/667409/kispaljr"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557762579, "post_id": 56115197, "comment_id": 98865152, "body": "@VasilyAngapov I can do that, but I still would have to manually implement the logic for all problematic fields of all API objects that I use, wouldn&#39;t I? The main motivation behind the question is to avoid that"}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 2428569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dDpJ6.png?s=128&g=1", "display_name": "Nick Revin", "link": "https://stackoverflow.com/users/2428569/nick-revin"}, "is_accepted": true, "score": 4, "last_activity_date": 1558084261, "creation_date": 1558084261, "answer_id": 56183199, "question_id": 56115197, "link": "https://stackoverflow.com/questions/56115197/how-to-idiomatically-fill-empty-fields-with-default-values-for-kubernetes-api-ob/56183199#56183199", "title": "How to idiomatically fill empty fields with default values for Kubernetes API objects?", "body": "<p>There are helpers to fill in default values in place of empty/zero ones.</p>\n\n<p>Look at the <a href=\"https://godoc.org/k8s.io/kubernetes/pkg/apis/apps/v1#SetObjectDefaults_Deployment\" rel=\"nofollow noreferrer\">SetObjectDefaults_Deployment</a> for Deployment for instance.</p>\n\n<p>Looks like the proper way to call it is via <a href=\"https://godoc.org/k8s.io/apimachinery/pkg/runtime#Scheme.Default\" rel=\"nofollow noreferrer\"><code>(*runtime.Scheme).Default</code></a>.\nBelow is the snippet to show the general idea:</p>\n\n<pre><code>import (\n    \"reflect\"\n\n    appsv1 \"k8s.io/api/apps/v1\"\n    \"k8s.io/client-go/kubernetes/scheme\"\n)\n\nfunc compare() {\n    scheme := scheme.Scheme\n\n    // fetch the existing &amp;appsv1.Deployment via API\n    actual := ...\n    expected := &amp;appsv1.Deployment{}\n\n    // fill in the fields to generate your expected state\n    // ...\n\n    scheme.Default(expected)\n    // now you should have your empty values filled in\n    if !reflect.DeepEqual(expected.Spec, actual.Spec) {\n        reconcile(expected, actual)\n    }\n}\n</code></pre>\n\n<p>If you need less strict comparison for instance if you need to tolerate some injected containers then something more relaxed should be used like <a href=\"https://github.com/amaizfinance/redis-operator/blob/master/pkg/controller/redis/deepcontains.go\" rel=\"nofollow noreferrer\">this</a>.</p>\n"}], "owner": {"reputation": 1560, "user_id": 667409, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0ac46f9edf4508a6caec4706efe8246d?s=128&d=identicon&r=PG", "display_name": "kispaljr", "link": "https://stackoverflow.com/users/667409/kispaljr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 56183199, "answer_count": 1, "score": 2, "last_activity_date": 1558084261, "creation_date": 1557760210, "last_edit_date": 1557778650, "question_id": 56115197, "link": "https://stackoverflow.com/questions/56115197/how-to-idiomatically-fill-empty-fields-with-default-values-for-kubernetes-api-ob", "title": "How to idiomatically fill empty fields with default values for Kubernetes API objects?", "body": "<p>I want to compare two Kubernetes API objects (e.g. <code>v1.PodSpec</code>s): one of them was created manually (expected state), the other one was received from the Kubernetes API/client (actual state). \nThe problem is that even if the two objects are semantically equal, the manually created struct has zerovalues for unspecified fields where the other struct has default values, and so the two doesn't match. It means that a simple <code>reflect.DeepEqual()</code> call is not sufficient for comparison.</p>\n\n<p>E.g. after this:</p>\n\n<pre><code>expected := &amp;v1.Container{\n    Name:  \"busybox\",\n    Image: \"busybox\",\n}\n\nactual := getContainerSpecFromApi(...)\n</code></pre>\n\n<p><code>expected.ImagePullPolicy</code> will be <code>\"\"</code>, while <code>actual.ImagePullPolicy</code> will be <code>\"IfNotPresent\"</code> (the default value), so the comparison fails.</p>\n\n<p>Is there an idiomatic way to replace zerovalues with default values in Kubernetes API structs specifically? Or alternatively is a constructor function that initializes the struct with default values available for them somewhere?</p>\n\n<p>EDIT:\nCurrently I am using handwritten equality tests for each K8s API object types, but this doesn't seem to be maintainable to me. I am looking for a simple (set of) function(s) that \"knows\" the default values for all built-in Kubernetes API object fields (maybe somewhere under <code>k8s.io/api*</code>?). Something like this:</p>\n\n<pre><code>expected = api.ApplyContainerDefaults(expected)\nif !reflect.DeepEqual(expected, actual) {\n    reconcile(expected, actual)\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "edited": false, "score": 0, "creation_date": 1557753728, "post_id": 56112537, "comment_id": 98860040, "body": "Just as a question, is there any reason why you would want to have two different images as a base for test and prod? One of the main reasons for using Docker in the first place is that the underlying os and dependencies on the image are the same for each environment."}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "reply_to_user": {"reputation": 3237, "user_id": 9741769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4b0913fe3d348f510777caaf5540169?s=128&d=identicon&r=PG&f=1", "display_name": "Blokje5", "link": "https://stackoverflow.com/users/9741769/blokje5"}, "edited": false, "score": 0, "creation_date": 1557753888, "post_id": 56112537, "comment_id": 98860143, "body": "well, I wouldn&#39;t like to develop on a scratch image, there is nothing in it, not very practical. and I don&#39;t want golang image in production because it is too big."}, {"owner": {"reputation": 2052, "user_id": 4527878, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2Xf8iNcWL1Y/AAAAAAAAAAI/AAAAAAAAAGc/UUSRGDEXvXg/photo.jpg?sz=128", "display_name": "Murtaza Hussain", "link": "https://stackoverflow.com/users/4527878/murtaza-hussain"}, "edited": false, "score": 0, "creation_date": 1557759025, "post_id": 56112537, "comment_id": 98863186, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46440909/how-to-configure-different-dockerfile-for-development-and-production\">How to configure different dockerfile for development and production</a>"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1557835595, "post_id": 56112537, "comment_id": 98891167, "body": "Why not just install the Go toolchain on your host, and use that for development?"}], "answers": [{"comments": [{"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 1, "creation_date": 1557824283, "post_id": 56114663, "comment_id": 98884795, "body": "It did the trick ! I didn&#39;t use FROM ${BUILD_ENVIRONMENT}, but I use docker build --target=prod... to build prod, and docker build --target=dev... to build dev"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1557824356, "post_id": 56114663, "comment_id": 98884843, "body": "Your solution is simpler=better than the one here: <a href=\"https://stackoverflow.com/questions/46440909/how-to-configure-different-dockerfile-for-development-and-production\" title=\"how to configure different dockerfile for development and production\">stackoverflow.com/questions/46440909/&hellip;</a>"}, {"owner": {"reputation": 2848, "user_id": 9094093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0wK119YgtUg/AAAAAAAAAAI/AAAAAAAAAWs/nJevJpVLTqU/photo.jpg?sz=128", "display_name": "Javier Aviles", "link": "https://stackoverflow.com/users/9094093/javier-aviles"}, "reply_to_user": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1557830805, "post_id": 56114663, "comment_id": 98888517, "body": "let&#39;s update it in the answer so it fits to your question :)"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1558014821, "post_id": 56114663, "comment_id": 98967009, "body": "the only issue with this approach, as I used it a few days, is that if I use <code>docker build --target=prod</code>, it will also execute the <code>dev</code> part, that is useless. It is not a filter, but it gives you the opportunity to run partial Dockerfiles"}, {"owner": {"reputation": 2848, "user_id": 9094093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0wK119YgtUg/AAAAAAAAAAI/AAAAAAAAAWs/nJevJpVLTqU/photo.jpg?sz=128", "display_name": "Javier Aviles", "link": "https://stackoverflow.com/users/9094093/javier-aviles"}, "reply_to_user": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1558018739, "post_id": 56114663, "comment_id": 98969448, "body": "why don&#39;t you include <code>CMD [&quot;.&#47;release&#47;api&quot;]</code> in the first image, and rename the &quot;AS base&quot; to &quot;AS dev&quot;, then it will stop there, but if prod, will build the next one? <code>CMD [&quot;.&#47;release&#47;api&quot;]</code> should not affect anything in the first image"}, {"owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "edited": false, "score": 0, "creation_date": 1558019497, "post_id": 56114663, "comment_id": 98969936, "body": "yes, but I am working now in another case of NodeJs, and I install different libs depending on env, so, it works, but build takes more time."}], "tags": [], "owner": {"reputation": 2848, "user_id": 9094093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0wK119YgtUg/AAAAAAAAAAI/AAAAAAAAAWs/nJevJpVLTqU/photo.jpg?sz=128", "display_name": "Javier Aviles", "link": "https://stackoverflow.com/users/9094093/javier-aviles"}, "is_accepted": true, "score": 3, "last_activity_date": 1557830998, "last_edit_date": 1557830998, "creation_date": 1557758428, "answer_id": 56114663, "question_id": 56112537, "link": "https://stackoverflow.com/questions/56112537/how-to-use-the-same-dockerfile-for-dev-and-prod/56114663#56114663", "title": "How to use the same dockerfile for dev and prod", "body": "<p>What about something like this? I didn't test it and didn't think through your example deeply, but maybe is somewhere close to what you need/helps you finding out the final solution?</p>\n\n<pre><code>FROM golang:alpine AS base\nWORKDIR /go/src/gitlab.com/company/project\nCOPY . .\nRUN go build -o ./release/api .\n\nFROM base AS dev\nCMD [\"./release/api\"]\n\nFROM scratch AS prod\nEXPOSE 9999\nCOPY --from=base /go/src/gitlab.com/company/project/release/api .\nCMD [\"./api\"]\n</code></pre>\n\n<p>Depending on the value specified in target <code>docker build --target=prod</code> or <code>docker build --target=dev</code>, a different image will get built.</p>\n"}], "owner": {"reputation": 14185, "user_id": 1956558, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/8D66D.jpg?s=128&g=1", "display_name": "Juliatzin", "link": "https://stackoverflow.com/users/1956558/juliatzin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "accepted_answer_id": 56114663, "answer_count": 1, "score": 1, "last_activity_date": 1557830998, "creation_date": 1557751077, "question_id": 56112537, "link": "https://stackoverflow.com/questions/56112537/how-to-use-the-same-dockerfile-for-dev-and-prod", "title": "How to use the same dockerfile for dev and prod", "body": "<p>I have 2 Dockerfile, 1 for dev, and 1 for prod:</p>\n\n<p>PROD:</p>\n\n<pre><code>FROM golang AS builder\nWORKDIR /go/src/gitlab.com/company/project\nCOPY . .\nRUN go build -o ./release/api .\n\nFROM scratch\nEXPOSE 9999\nCOPY --from=builder /go/src/gitlab.com/company/project/release/api .\nCMD [\"./api\"]\n</code></pre>\n\n<p>and DEV:</p>\n\n<pre><code>FROM golang\nWORKDIR /go/src/gitlab.com/company/PROJECT\nCOPY . .\nRUN go build -o ./release/api .\nCMD [\"./release/api\"]\n</code></pre>\n\n<p>I would like to merge those two into a single one, as maintaining 2 Dockerfile is a <a href=\"https://docs.docker.com/develop/develop-images/multistage-build/\" rel=\"nofollow noreferrer\">bad practice</a></p>\n\n<p>The main difference is that in dev, I work on <code>golang</code> image, which is practical, and in prod, I work with <code>scratch</code> image, which reduce a lot the size of my binary.</p>\n\n<p>It seems that I can use multiple stages in a Dockerfile, and specify stage name at build time: </p>\n\n<pre><code>docker build . --target=builder\n</code></pre>\n\n<p>But If I do this, I don't know how to conditionnaly run my app in the first stage = [ If I am in dev, run the app in the first stage, otherwise, run the app in the second stage]</p>\n\n<p>How should I do it ?</p>\n"}, {"tags": ["pointers", "go", "struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1557750321, "post_id": 56112289, "comment_id": 98858062, "body": "Have you tried the <code>%p</code> verb, with <code>fmt.Printf</code>? (<a href=\"https://play.golang.org/p/DpXgfJwsW63\" rel=\"nofollow noreferrer\">play.golang.org/p/DpXgfJwsW63</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 1630, "user_id": 5444273, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1319024d84e8bf8140da5b4e18406ee3?s=128&d=identicon&r=PG&f=1", "display_name": "Kiwi Rupela", "link": "https://stackoverflow.com/users/5444273/kiwi-rupela"}, "edited": false, "score": 0, "creation_date": 1557750678, "post_id": 56112375, "comment_id": 98858269, "body": "How can I &quot;0x414020&quot; store this value in some variable"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1630, "user_id": 5444273, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1319024d84e8bf8140da5b4e18406ee3?s=128&d=identicon&r=PG&f=1", "display_name": "Kiwi Rupela", "link": "https://stackoverflow.com/users/5444273/kiwi-rupela"}, "edited": false, "score": 1, "creation_date": 1557750848, "post_id": 56112375, "comment_id": 98858360, "body": "@KiwiRupela Use <code>s := fmt.Sprintf(&quot;%p&quot;, &amp;r)</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 14, "last_activity_date": 1557750522, "last_edit_date": 1592644375, "creation_date": 1557750522, "answer_id": 56112375, "question_id": 56112289, "link": "https://stackoverflow.com/questions/56112289/how-to-print-the-address-of-struct-variable-in-go/56112375#56112375", "title": "How to print the address of struct variable in go", "body": "<p>When you print values using <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"noreferrer\"><code>fmt.Println()</code></a>, the default format will be used. Quoting from package doc of <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\"><code>fmt</code></a>:</p>\n<blockquote>\n<p>The default format for %v is:</p>\n<pre><code>bool:                    %t\nint, int8 etc.:          %d\nuint, uint8 etc.:        %d, %#x if printed with %#v\nfloat32, complex64, etc: %g\nstring:                  %s\nchan:                    %p\npointer:                 %p\n</code></pre>\n<p>For compound objects, the elements are printed using these rules, recursively, laid out like this:</p>\n<pre><code>struct:             {field0 field1 ...}\narray, slice:       [elem0 elem1 ...]\nmaps:               map[key1:value1 key2:value2 ...]\npointer to above:   &amp;{}, &amp;[], &amp;map[]\n</code></pre>\n</blockquote>\n<p>The address of a struct value is the last line, so it is treated special and thus printed using the <code>&amp;{}</code> syntax.</p>\n<p>If you want to print its address, don't use the default format, but use a format string and specify you want the address (pointer) explicitly with the <code>%p</code> verb:</p>\n<pre><code>fmt.Printf(&quot;%p\\n&quot;, &amp;r)\n</code></pre>\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/jrSghe4UANv\" rel=\"noreferrer\">Go Playground</a>):</p>\n<pre><code>0x414020\n</code></pre>\n"}], "owner": {"reputation": 1630, "user_id": 5444273, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1319024d84e8bf8140da5b4e18406ee3?s=128&d=identicon&r=PG&f=1", "display_name": "Kiwi Rupela", "link": "https://stackoverflow.com/users/5444273/kiwi-rupela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6249, "favorite_count": 3, "accepted_answer_id": 56112375, "answer_count": 1, "score": 4, "last_activity_date": 1557751251, "creation_date": 1557750217, "last_edit_date": 1557751251, "question_id": 56112289, "link": "https://stackoverflow.com/questions/56112289/how-to-print-the-address-of-struct-variable-in-go", "title": "How to print the address of struct variable in go", "body": "<p>I am new to go I want to print the address of struct variable in go \nhere is my program</p>\n\n<pre><code>type Rect struct {\n width int\n name int \n}\n\nfunc main() {\n r := Rect{4,6}\n p := &amp;r\n p.width = 15\n\nfmt.Println(\"-----\",&amp;p,r,p,&amp;r)\n\n}\n</code></pre>\n\n<p>output of this </p>\n\n<pre><code>  _____0x40c130 {15 6} &amp;{15 6} &amp;{15 6}\n</code></pre>\n\n<p>but i want to print the address of r variable as i know that '&amp;' represents the address and '*' points the value of pointer location but here i am unable to print the address of r, I am using online editor of go-lang <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">https://play.golang.org/</a></p>\n\n<p>As well I want to store this address in some variable.</p>\n"}, {"tags": ["go", "streaming", "http2"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557758863, "post_id": 56112261, "comment_id": 98863086, "body": "maybe should you establish a websocket instead."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9325352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc961025b3c43f5f0dbc9f4c0f124b5?s=128&d=identicon&r=PG&f=1", "display_name": "Cheng", "link": "https://stackoverflow.com/users/9325352/cheng"}, "edited": false, "score": 0, "creation_date": 1557823026, "post_id": 56121620, "comment_id": 98884197, "body": "Thanks for the answer, but can i use the resp got from <code>client.Get</code> to send data to the server? If yes, how?"}, {"owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "reply_to_user": {"reputation": 5, "user_id": 9325352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc961025b3c43f5f0dbc9f4c0f124b5?s=128&d=identicon&r=PG&f=1", "display_name": "Cheng", "link": "https://stackoverflow.com/users/9325352/cheng"}, "edited": false, "score": 0, "creation_date": 1557848481, "post_id": 56121620, "comment_id": 98899244, "body": "You can&#39;t use <code>resp</code> to send data to the server, unless i&#39;m missing something about your question. Could you expand on what you are trying to achieve?"}, {"owner": {"reputation": 5, "user_id": 9325352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc961025b3c43f5f0dbc9f4c0f124b5?s=128&d=identicon&r=PG&f=1", "display_name": "Cheng", "link": "https://stackoverflow.com/users/9325352/cheng"}, "edited": false, "score": 0, "creation_date": 1557888198, "post_id": 56121620, "comment_id": 98912359, "body": "Sure. I want to open a stream to the server and send data to server via this stream, so that when some data comes to me, I can process it and send it to server using this stream. currently I use <code>func (c *Client) Post(url, contentType string, body io.Reader) (resp *Response, err error)</code>, and for the third argument, I implement my own Reader function. Previously I used <code>bytes.NewBuffer</code> function but it gives me error like unexpected EOF. I want to know what&#39;s the right way to implement this function?"}], "tags": [], "owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "is_accepted": false, "score": 0, "last_activity_date": 1557795197, "creation_date": 1557795197, "answer_id": 56121620, "question_id": 56112261, "link": "https://stackoverflow.com/questions/56112261/fail-to-use-streaming-in-http2-in-golang/56121620#56121620", "title": "fail to use streaming in http2 in golang", "body": "<p>In HTTP/2 streams are short lived, and correspond to a request/response exchange. In effect the end of the response closes the stream. Issuing another request via <code>client.Get</code> will automatically open a new stream on the connection, if the underlying connection is using HTTP/2.</p>\n"}], "owner": {"reputation": 5, "user_id": 9325352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dc961025b3c43f5f0dbc9f4c0f124b5?s=128&d=identicon&r=PG&f=1", "display_name": "Cheng", "link": "https://stackoverflow.com/users/9325352/cheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557795197, "creation_date": 1557750106, "question_id": 56112261, "link": "https://stackoverflow.com/questions/56112261/fail-to-use-streaming-in-http2-in-golang", "title": "fail to use streaming in http2 in golang", "body": "<p>How to reuse http2 stream in golang?</p>\n\n<p>Hi all, recently I tried many ways to reuse a stream to send http2 data but failed, and I didn't find many related solutions in http2, can anyone give me some hints or demos?</p>\n\n<pre><code>client := http.Client{\n\n        Transport: &amp;http2.Transport{\n            DialTLS: func(network, addr string, cfg *tls.Config) (net.Conn, error) {\n                return net.DialTimeout(network, addr, time.Second)\n            },\n                AllowHTTP: true,\n        },\n    }\n\n    resp, err := client.Get(path)\n</code></pre>\n\n<p>I tried to use resp as client and write to this resp to send data to server. Is it right way to do it?</p>\n"}, {"tags": ["node.js", "mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557749833, "post_id": 56111999, "comment_id": 98857796, "body": "The better question would be: why is there no primary in the cluster. The fact that npm eats anything and just does something is not surprising."}, {"owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557751437, "post_id": 56111999, "comment_id": 98858682, "body": "I think the primary is discovered by the driver though, so it might be that the nodejs driver can find the primary but go can&#39;t."}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1558398094, "post_id": 56111999, "comment_id": 99079081, "body": "Which version of <code>mongo-go-driver</code>? also, what&#39;s the content of <code>MONGO_HOST</code> (Please just use template, don&#39;t post credentials. i.e. <code>mongodb:&#47;&#47;USER:PWD@server1.mongodb.net:27017</code> etc)?"}, {"owner": {"reputation": 779, "user_id": 4332541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cac70958d7941ebb8d75d4f165983c2e?s=128&d=identicon&r=PG&f=1", "display_name": "pariola", "link": "https://stackoverflow.com/users/4332541/pariola"}, "edited": false, "score": 0, "creation_date": 1569004651, "post_id": 56111999, "comment_id": 102469380, "body": "@AyushGupta I was able to solve it when i added ca-certificates"}, {"owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "reply_to_user": {"reputation": 779, "user_id": 4332541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cac70958d7941ebb8d75d4f165983c2e?s=128&d=identicon&r=PG&f=1", "display_name": "pariola", "link": "https://stackoverflow.com/users/4332541/pariola"}, "edited": false, "score": 0, "creation_date": 1569004767, "post_id": 56111999, "comment_id": 102469426, "body": "@pariola in my case there was a bug in the mongo-go-driver 1.0.1, upgrading to 1.1.0 fixed it"}, {"owner": {"reputation": 779, "user_id": 4332541, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cac70958d7941ebb8d75d4f165983c2e?s=128&d=identicon&r=PG&f=1", "display_name": "pariola", "link": "https://stackoverflow.com/users/4332541/pariola"}, "edited": false, "score": 0, "creation_date": 1569004894, "post_id": 56111999, "comment_id": 102469470, "body": "okay nice, i was experiencing this on docker with the scratch image. So adding the ca-certificates helped resolve that. Thanks"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 13169568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68d240f0ac9985fc8b46790454504116?s=128&d=identicon&r=PG&f=1", "display_name": "Sakura-by", "link": "https://stackoverflow.com/users/13169568/sakura-by"}, "is_accepted": false, "score": 2, "last_activity_date": 1595483964, "last_edit_date": 1595483964, "creation_date": 1595472787, "answer_id": 63046143, "question_id": 56111999, "link": "https://stackoverflow.com/questions/56111999/mongo-go-driver-fails-with-server-selection-timeout-when-using-mongodb-atlas/63046143#63046143", "title": "mongo-go-driver fails with Server Selection Timeout when using MongoDB Atlas", "body": "<p>I had the same problem and have solved it. If you have the same question, maybe my solution will help you.\nTry to add param <code>connect=direct</code> after your mongo connect url.</p>\n"}], "owner": {"reputation": 6835, "user_id": 6021597, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/iyl6H.jpg?s=128&g=1", "display_name": "Ayush Gupta", "link": "https://stackoverflow.com/users/6021597/ayush-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2511, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1595483964, "creation_date": 1557749176, "question_id": 56111999, "link": "https://stackoverflow.com/questions/56111999/mongo-go-driver-fails-with-server-selection-timeout-when-using-mongodb-atlas", "title": "mongo-go-driver fails with Server Selection Timeout when using MongoDB Atlas", "body": "<p>Go Version: 1.12.5</p>\n\n<p>I have this code which uses the node.js mongo driver</p>\n\n<pre><code>const MongoClient = require('mongodb').MongoClient;\nconst uri = process.env.MONGO_HOST + \"dbname?retryWrites=true\";\nconst client = new MongoClient(uri, {\n    useNewUrlParser: true\n});\n\nclient.connect(async (err) =&gt; {\n    if (err) {\n        throw err\n    }\n    const collection = client.db(\"dbname\").collection(\"collectionName\");\n    const cursor = collection.find()\n    await cursor.forEach(console.log)\n    // perform actions on the collection object\n    client.close();\n});\n</code></pre>\n\n<p>Which works fine.</p>\n\n<p>Using the <code>mongo-go-driver</code>, I do:</p>\n\n<pre><code>client, err := mongo.NewClient(options.Client().ApplyURI(os.Getenv(\"MONGO_HOST\") + \"dbname?retryWrites=true\")\nif err != nil {\n    panic(err)\n}\nctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\nerr = client.Connect(ctx)\nif err != nil {\n    panic(err)\n}\ndatabase := client.Database(\"dbname\")\ncollection := database.Collection(\"collectionName\")\n\nres, err := collection.Find(context.Background(), bson.M{}, &amp;options.FindOptions{\n    Sort: bson.M{\n        \"priority\": -1,\n    },\n})\nif err != nil {\n    panic(err)\n}\nresults := make([]structs.ResponseType, 0)\nerr = res.All(context.Background(), &amp;results)\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>But this panics with:</p>\n\n<pre><code>panic: server selection error: server selection timeout\ncurrent topology: Type: ReplicaSetNoPrimary\n</code></pre>\n\n<p>I am not running this inside a container/docker.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1557739087, "post_id": 56109190, "comment_id": 98852063, "body": "Quoting from <a href=\"https://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Request.FormValue</a>: &quot;To access multiple values of the same key, call ParseForm and then inspect Request.Form directly&quot;."}, {"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 1, "creation_date": 1557739305, "post_id": 56109190, "comment_id": 98852200, "body": "If you have access to raw query, <code>url.ParseQuery</code> which returns a <code>url.Values</code> should also work."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1557740324, "post_id": 56109190, "comment_id": 98852826, "body": "side note, CircuitStatus is not present in the url you have provided. Have you been able to prepare a reproducible example ?"}], "answers": [{"comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 1, "creation_date": 1557739465, "post_id": 56109343, "comment_id": 98852297, "body": "You probably tried the singular. See the \u201cs\u201d. That returns a slice."}, {"owner": {"reputation": 13686, "user_id": 1663919, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0abe37f1cd26ea99091568cf4edf448?s=128&d=identicon&r=PG", "display_name": "Zdeslav Vojkovic", "link": "https://stackoverflow.com/users/1663919/zdeslav-vojkovic"}, "edited": false, "score": 0, "creation_date": 1557739483, "post_id": 56109343, "comment_id": 98852304, "body": "Your example uses <code>QueryParameter</code>, not <code>QueryParameters</code>"}, {"owner": {"reputation": 2393, "user_id": 7648377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lK7JG.jpg?s=128&g=1", "display_name": "Andrei Lupuleasa", "link": "https://stackoverflow.com/users/7648377/andrei-lupuleasa"}, "edited": false, "score": 0, "creation_date": 1557739661, "post_id": 56109343, "comment_id": 98852421, "body": "I&#39;ve tried that also and I only have the first value and it ignored the rest"}, {"owner": {"reputation": 2393, "user_id": 7648377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lK7JG.jpg?s=128&g=1", "display_name": "Andrei Lupuleasa", "link": "https://stackoverflow.com/users/7648377/andrei-lupuleasa"}, "edited": false, "score": 1, "creation_date": 1557739765, "post_id": 56109343, "comment_id": 98852484, "body": "I&#39;ve updated my question, thank you for trying to help."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "edited": false, "score": 0, "creation_date": 1557740108, "post_id": 56109343, "comment_id": 98852688, "body": "<a href=\"https://github.com/emicklei/go-restful/blob/master/request_test.go#L21\" rel=\"nofollow noreferrer\">github.com/emicklei/go-restful/blob/master/request_test.go#L&zwnj;&#8203;21</a>  This test also indicates similar usage. Not sure why it is not working in your case. Can you also print the request with url to see which params are actually being passed."}], "tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": true, "score": 6, "last_activity_date": 1557739699, "last_edit_date": 1557739699, "creation_date": 1557739350, "answer_id": 56109343, "question_id": 56109190, "link": "https://stackoverflow.com/questions/56109190/how-to-resolve-duplicate-parameters-in-url-with-go/56109343#56109343", "title": "How to resolve duplicate parameters in URL with Go", "body": "<p>Use <strong>QueryParameters</strong> according to the <a href=\"https://github.com/emicklei/go-restful/blob/master/request.go#L55\" rel=\"nofollow noreferrer\">code</a> this should return <code>[]string</code></p>\n\n<pre><code>req.QueryParameters(\"CircuitStatus\")\n</code></pre>\n"}], "owner": {"reputation": 2393, "user_id": 7648377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lK7JG.jpg?s=128&g=1", "display_name": "Andrei Lupuleasa", "link": "https://stackoverflow.com/users/7648377/andrei-lupuleasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56109343, "answer_count": 1, "score": 0, "last_activity_date": 1557744750, "creation_date": 1557738851, "last_edit_date": 1557744750, "question_id": 56109190, "link": "https://stackoverflow.com/questions/56109190/how-to-resolve-duplicate-parameters-in-url-with-go", "title": "How to resolve duplicate parameters in URL with Go", "body": "<p>I'm having a call from a frontend app which serializes arrays by using duplicate keys:</p>\n\n<pre><code>queryString.stringify({foo: [1, 2, 3]});\n//=&gt; 'foo=1&amp;foo=2&amp;foo=3'\n</code></pre>\n\n<p>and generates an url like:</p>\n\n<pre><code>https://endpoint?format=json&amp;Status=Active&amp;Status=Disabled&amp;Status=Test\n</code></pre>\n\n<p>The backend is in Go and uses: <a href=\"https://github.com/emicklei/go-restful\" rel=\"nofollow noreferrer\">https://github.com/emicklei/go-restful</a></p>\n\n<p>How can I resolve the duplicated parameters in URL?\nRight now I can only get the last value.</p>\n\n<p>The go code I've tried:</p>\n\n<pre><code>req.QueryParameter(\"CircuitStatus\")\nlogger.Log.Debug().Msgf(\"CircuitStatus %v\", CircuitStatus)\n</code></pre>\n\n<p>The logs:</p>\n\n<pre><code>{\"level\":\"debug\",\"time\":\"2019-05-13T11:43:47+03:00\",\"message\":\"CircuitStatus Test\"}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"tags": [], "owner": {"reputation": 3429, "user_id": 11332370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f6dff2145c158175c200ae87e88fbc1?s=128&d=identicon&r=PG&f=1", "display_name": "Alassane Ndiaye", "link": "https://stackoverflow.com/users/11332370/alassane-ndiaye"}, "is_accepted": false, "score": 0, "last_activity_date": 1557750413, "creation_date": 1557750413, "answer_id": 56112340, "question_id": 56108743, "link": "https://stackoverflow.com/questions/56108743/is-in-the-kubernetes-api-a-function-to-fetch-all-services-by-annotations/56112340#56112340", "title": "Is in the kubernetes API a function to fetch all services by annotations", "body": "<p>As specified in the <a href=\"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/\" rel=\"nofollow noreferrer\">Kubernetes documentation</a>, annotations are meant for non-identifying information, so naturally you shouldn't use them for finding objects.</p>\n\n<p>If that's an option, you can attach a prefix (max length of 253 characters) to your label in this manner: <code>&lt;label prefix&gt;/&lt;label name&gt;</code>. Additional information can be found from the link provided above.</p>\n"}, {"tags": [], "owner": {"reputation": 2534, "user_id": 1745139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PgRJn.jpg?s=128&g=1", "display_name": "antweiss", "link": "https://stackoverflow.com/users/1745139/antweiss"}, "is_accepted": false, "score": 0, "last_activity_date": 1557753264, "creation_date": 1557753264, "answer_id": 56113150, "question_id": 56108743, "link": "https://stackoverflow.com/questions/56108743/is-in-the-kubernetes-api-a-function-to-fetch-all-services-by-annotations/56113150#56113150", "title": "Is in the kubernetes API a function to fetch all services by annotations", "body": "<p>There is no FieldSelector for annotations. What you can do is get all services into your list and then filter them based on annotations found in each.</p>\n"}], "owner": {"reputation": 377, "user_id": 7652996, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ItnHH.png?s=128&g=1", "display_name": "Volker Raschek", "link": "https://stackoverflow.com/users/7652996/volker-raschek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 370, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557753264, "creation_date": 1557737309, "question_id": 56108743, "link": "https://stackoverflow.com/questions/56108743/is-in-the-kubernetes-api-a-function-to-fetch-all-services-by-annotations", "title": "Is in the kubernetes API a function to fetch all services by annotations", "body": "<p>I'm setting up a kubernet cluster to roll out our container applications. The applications actually need all labels, but the labels are longer than 63 characters and I get an <a href=\"https://stackoverflow.com/questions/50412837/kubernetes-label-name-63-character-limit\">error</a>. This makes me dependent on annotations. </p>\n\n<p>An annotation for a service looks like this: <code>com.example.development.london/component.proxy-config.secure-routes.backend.proxy-path</code>. The <code>/</code> only serves to bypass an RFC domain error. </p>\n\n<p>In a Golang application all services of a namespace are requested. Actually based on the labels. For this I have used the following code so far.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func (kc *KubernetesCollector) generateRoutes(errorChannel chan&lt;- error) {\n    log.Println(\"INFO: Try to generate routes\")\n    services, err := kc.iface.Services(kc.namespace).List(metav1.ListOptions{\n        LabelSelector: fmt.Sprintf(\"%s==true\", ConvertLabelToKubernetesAnnotation(ProxyConfDiscoverableLabel)),\n    })\n...\n\nfunc ConvertLabelToKubernetesAnnotation(label string) string {\n    return strings.Replace(label, \"com.example.development.london.\", \"com.example.development.london/\", -1)\n}\n</code></pre>\n\n<p>But there is no possibility to return the services using annotations. Does anyone know another way how I can get all services that apply to an annotation with Go?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557734988, "post_id": 56108117, "comment_id": 98849860, "body": "The code you posted does not match your output, see <a href=\"https://play.golang.org/p/zUbG9WvKe-3\" rel=\"nofollow noreferrer\">Playground</a>. In your code <code>b</code> is of type <code>int</code> and will be printed simply like <code>7</code>. <code>&amp;b</code> will be an address, so will be <code>&amp;i</code>. Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 19, "user_id": 11491436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400bcfd72952975c99f23d6a297de5ce?s=128&d=identicon&r=PG&f=1", "display_name": "omgoverflow", "link": "https://stackoverflow.com/users/11491436/omgoverflow"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557735838, "post_id": 56108117, "comment_id": 98850280, "body": "thx for help, fixed it"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1557735850, "post_id": 56108117, "comment_id": 98850289, "body": "<code>i</code> is a variable of type <code>*int</code>. And <code>&amp;i</code> evaluates to a <code>**int</code>. Meaning is the same: &quot;take this thing&#39;s address&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 679, "user_id": 2798036, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000968694726/picture?type=large", "display_name": "viveksyngh", "link": "https://stackoverflow.com/users/2798036/viveksyngh"}, "is_accepted": false, "score": 1, "last_activity_date": 1557735931, "creation_date": 1557735931, "answer_id": 56108389, "question_id": 56108117, "link": "https://stackoverflow.com/questions/56108117/whats-the-meaning-of-i-when-i-b/56108389#56108389", "title": "What&#39;s the meaning of &#39;&amp;i&#39; when i := &amp;b", "body": "<p>Here <code>&amp;b</code> returns address of <code>b</code> and the same address is stored in <code>i</code>. Since <code>i</code> is also a variable <code>&amp;i</code> will return the address of variable i.   </p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1557740111, "last_edit_date": 1557740111, "creation_date": 1557736018, "answer_id": 56108410, "question_id": 56108117, "link": "https://stackoverflow.com/questions/56108117/whats-the-meaning-of-i-when-i-b/56108410#56108410", "title": "What&#39;s the meaning of &#39;&amp;i&#39; when i := &amp;b", "body": "<p><code>&amp;</code> is the <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">address operator</a>, evaluating it results in a memory address, which when passed to the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package, usually the memory address is printed in hexadecimal format (\"base 16 notation, with leading 0x\").</p>\n\n<p>A memory address is just that: a memory address. It doesn't matter if it's an address of an <code>int</code> variable or a <code>string</code>, or a variable of a pointer type. When printed, they all look the \"same\".</p>\n\n<p>The address operator:</p>\n\n<blockquote>\n  <p>For an operand <code>x</code> of type <code>T</code>, the address operation <code>&amp;x</code> generates a pointer of type <code>*T</code> to <code>x</code>. </p>\n</blockquote>\n\n<p>So the address operator gives you a pointer value which when you dereference, you get back the original value.</p>\n\n<p><code>&amp;b</code> will be an address of the variable <code>b</code>, of type <code>*int</code>, which when you dereference: <code>*b</code> will give you (the value of) <code>b</code>.</p>\n\n<p><code>&amp;i</code> will be the address of the variable <code>i</code>, of type <code>**int</code>, which when you dereference: <code>*i</code> will give you the value of <code>i</code> which is the address of <code>b</code>. So if you also dereference that: <code>**(&amp;i)</code>, that will also give you (the value of) <code>b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 233, "user_id": 4850239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2BoP4.jpg?s=128&g=1", "display_name": "Suhas Kulkarni", "link": "https://stackoverflow.com/users/4850239/suhas-kulkarni"}, "is_accepted": false, "score": 1, "last_activity_date": 1557737441, "creation_date": 1557737441, "answer_id": 56108785, "question_id": 56108117, "link": "https://stackoverflow.com/questions/56108117/whats-the-meaning-of-i-when-i-b/56108785#56108785", "title": "What&#39;s the meaning of &#39;&amp;i&#39; when i := &amp;b", "body": "<p>So <code>&amp;</code> operator generates a pointer to it's operand. So <code>&amp;i</code> basically generates a pointer to <code>i</code> which is already a pointer to <code>b</code> which is nothing but a memory address. So when you do <code>fmt.Println(&amp;i)</code> it prints the memory address of <code>i</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 11491436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/400bcfd72952975c99f23d6a297de5ce?s=128&d=identicon&r=PG&f=1", "display_name": "omgoverflow", "link": "https://stackoverflow.com/users/11491436/omgoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 56108410, "answer_count": 3, "score": 0, "last_activity_date": 1557740111, "creation_date": 1557734846, "last_edit_date": 1557736223, "question_id": 56108117, "link": "https://stackoverflow.com/questions/56108117/whats-the-meaning-of-i-when-i-b", "title": "What&#39;s the meaning of &#39;&amp;i&#39; when i := &amp;b", "body": "<p>I'm learning the go, I tried the '&amp;' to get the memory address.But I werid that what's the meaning of '&amp;i',and 'i' came from i := &amp;b , b is a int.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>b := 7\ni := &amp;b\nfmt.Println(&amp;b) //print =&gt; 0xc000088000\nfmt.Println(i) //print =&gt; 0xc000088000\nfmt.Println(&amp;i) //print =&gt; 0xc00000e018\n</code></pre>\n\n<p>In this case , What's the meaning of '&amp;i'?</p>\n"}, {"tags": ["mysql", "go", "command", "exec"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1557733985, "post_id": 56107734, "comment_id": 98849389, "body": "Why are you doing this? It would be much better to use the standard mysql library."}, {"owner": {"reputation": 5, "user_id": 11491336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9d5c4c8d3e38cfe1f30677c0493060?s=128&d=identicon&r=PG&f=1", "display_name": "littlec", "link": "https://stackoverflow.com/users/11491336/littlec"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1557735293, "post_id": 56107734, "comment_id": 98850012, "body": "I want to write a command line tool, with it I can login mysql, transport data between tables on different server, etc. of course I can use mysqldump,or I can write some  command in shell file, but I want to this command tool undertake more jobs, so I want implement it with GoLang."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1557740208, "post_id": 56107734, "comment_id": 98852749, "body": "That&#39;s great. Write in in Go. Just don&#39;t use exec.Command--use the standard mysql library instead."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1557745589, "post_id": 56107734, "comment_id": 98855711, "body": "this looks like a nice starter: <a href=\"http://go-database-sql.org/\" rel=\"nofollow noreferrer\">go-database-sql.org</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 11491336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9d5c4c8d3e38cfe1f30677c0493060?s=128&d=identicon&r=PG&f=1", "display_name": "littlec", "link": "https://stackoverflow.com/users/11491336/littlec"}, "is_accepted": false, "score": 0, "last_activity_date": 1558060189, "creation_date": 1558060189, "answer_id": 56178782, "question_id": 56107734, "link": "https://stackoverflow.com/questions/56107734/how-to-login-mysql-with-exec-command/56178782#56178782", "title": "How to login mysql with exec.Command", "body": "<p>After my trying, the answer is this:</p>\n\n<pre><code>cmd := exec.Command(\"mysql\",\"-h\"+host,\"-u\"+user,\"-p\"+password,\"-P\"+port)\ncmd.Stdin = os.Stdin\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\nerr := cmd.Run()\n</code></pre>\n\n<p>only need give os.Stdin to cmd.Stdin, then we will enter into mysql script interface.</p>\n"}], "owner": {"reputation": 5, "user_id": 11491336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b9d5c4c8d3e38cfe1f30677c0493060?s=128&d=identicon&r=PG&f=1", "display_name": "littlec", "link": "https://stackoverflow.com/users/11491336/littlec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1558060189, "creation_date": 1557733266, "last_edit_date": 1557734240, "question_id": 56107734, "link": "https://stackoverflow.com/questions/56107734/how-to-login-mysql-with-exec-command", "title": "How to login mysql with exec.Command", "body": "<p>I want to login MySql with exec.Command of GoLang, I am sure that I can login success, but I can not enter into MySql script interface.</p>\n\n<p>The program do not output any error, it exit after finished, that is not what I expected, I want to enter into the mysql script interface.</p>\n\n<p>The code is like this:</p>\n\n<pre><code>    host := \"localhost\"\n    user := \"root\"\n    password := \"root\"\n\n    cmd := exec.Command(\"mysql\",\"-h\"+host,\"-u\"+user,\"-p\"+password)\n    cmd.Output()\n</code></pre>\n\n<p>I want to see this after the program run:</p>\n\n<p>Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.</p>\n\n<p>mysql></p>\n\n<p>then I can write mysql script continue.\nthanks!</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "serverless-framework"], "answers": [{"tags": [], "owner": {"reputation": 1510, "user_id": 6476791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d5de71330e6307063fdb6dde80d7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/6476791/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1558541423, "last_edit_date": 1558541423, "creation_date": 1557768427, "answer_id": 56117191, "question_id": 56107229, "link": "https://stackoverflow.com/questions/56107229/having-multiple-main-go-files-in-order-to-deploy-aws-lambda-based-application/56117191#56117191", "title": "Having multiple main.go files in order to deploy AWS Lambda based application", "body": "<p>The deployment of lambda function comes down to package/module organization and automation deployment tools.\nThe first looks like being address in your question where the shared code is placed to util and each lambda has an individual package.  In the question, it is not clear what the deployment method is being used. There are various way to get lambda deployed </p>\n\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/cli/latest/reference/deploy/index.html\" rel=\"nofollow noreferrer\">aws CLI</a> </li>\n<li><a href=\"https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/what-is-sam.html\" rel=\"nofollow noreferrer\">AWS Serverless Application Model</a></li>\n<li><a href=\"https://github.com/viant/endly/tree/master/system/cloud/aws/lambda\" rel=\"nofollow noreferrer\">Endly - automation and e2e runner</a></li>\n<li><a href=\"https://www.hashicorp.com/products/terraform/\" rel=\"nofollow noreferrer\">terraform</a></li>\n</ul>\n\n<p>While I've been e2e and automation advocate, with endly runner multi lambda deployment workflow for various events may look like the following</p>\n\n<pre><code>init:\n  fn1ZipLocation: somepath1.zip\n  fn2ZipLocation: somepath2.zip\n  fnXZipLocation: somepathX.zip\n\npipeline:\n\n  build:\n    fn1:\n      action: exec:run\n      target: $target\n      sleepTimeMs: 1500\n      errors:\n        - ERROR\n      commands:\n        - cd ${appPath}aeroagg/app\n        - unset GOPATH\n        - export GOOS=linux\n        - export GOARCH=amd64\n        - go build -o function1\n        - zip -j somepath1.zip function1\n\n  ...\n\n  deployFunctions:\n    fn1:\n      action: aws/lambda:deploy\n      credentials: aws-e2e\n      functionname: fn1\n      runtime:  go1.x\n      handler: main\n      code:\n        zipfile: $LoadBinary(${fn1ZipLocation})\n      rolename: lambda-fn1-executor\n      define:\n        - policyname: xxx-resource-fn1-role\n          policydocument: $Cat('${privilegePolicy}')\n      attach:\n        - policyarn: arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\n      triggers:\n        - source: somequeue\n          type: sqs\n          enabled: true\n          batchSize: 20000\n    fn2:\n      action: aws/lambda:deploy\n      credentials: aws-e2e\n      functionname: fn2\n      runtime:  go1.x\n      handler: main\n      code:\n        zipfile: $LoadBinary(${fn2ZipLocation})\n      rolename: lambda-fn2-executor\n      define:\n        - policyname: xxx-resource-fn2-role\n          policydocument: $Cat('${privilegePolicy}')\n      attach:\n        - policyarn: arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\n\n      notification:\n        action: aws/s3:setupBucketNotification\n        bucket: someBucket\n        lambdaFunctionConfigurations:\n          - functionName: fn2\n            id: ObjectCreatedEvents\n            events:\n              - s3:ObjectCreated:*\n            filter:\n              prefix:\n                - folderXXX\n              suffix:\n                - .csv\n\n      ...\n    fnX:\n      action: aws/lambda:deploy\n        functionname: fnX\n        runtime:  go1.x\n        handler: main\n        timeout: 360\n        vpcMatcher:\n          instance:\n            name: instanceWithVPC\n\n        environment:\n          variables:\n            CONFIG: $AsString($config)\n        code:\n          zipfile: $LoadBinary(${fn2ZipLocation})\n        rolename: lambda-fn3-executor\n        define:\n          - policyname: lambda-sns-execution-role\n            policydocument: $Cat('${privilegePolicy}')\n        attach:\n          - policyarn: arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\n          - policyarn: arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole\n      setupSubscription:\n        action: aws/sns:setupSubscription\n        protocol: lambda\n        endpoint: fnX\n        topic: someTopic\n\n    deployGatewayAPI:\n      redeploy: true\n      action: aws/apigateway:setupRestAPI\n      '@name': myAPIName\n      resources:\n        - path: /\n          methods:\n            - httpMethod: GET\n              functionname: fn3\n        - path: /{proxy+}\n          methods:\n            - httpMethod: GET\n              functionname: fn4\n        - path: /v1/api/fn4\n          methods:\n            - httpMethod: GET\n              functionname: fn5\n</code></pre>\n\n<p>Finally you can check  <a href=\"https://github.com/adrianwit/serverless_e2e/tree/master/lambda\" rel=\"nofollow noreferrer\">serverless e2e</a> with lambda e2e practical testing examples.</p>\n"}], "owner": {"reputation": 905, "user_id": 8560600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-zQ0B8tCv38k/AAAAAAAAAAI/AAAAAAAAAAw/bWWd0qZVS8I/photo.jpg?sz=128", "display_name": "Stefan Radonjic", "link": "https://stackoverflow.com/users/8560600/stefan-radonjic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 762, "favorite_count": 0, "accepted_answer_id": 56117191, "answer_count": 1, "score": 2, "last_activity_date": 1558541423, "creation_date": 1557731042, "last_edit_date": 1557734056, "question_id": 56107229, "link": "https://stackoverflow.com/questions/56107229/having-multiple-main-go-files-in-order-to-deploy-aws-lambda-based-application", "title": "Having multiple main.go files in order to deploy AWS Lambda based application", "body": "<p>I have following complex structure:</p>\n\n<pre><code>utils:\n    - utils.go\nfunction1:\n    pkg1_specific_to_fn1:\n        -pkg1_specific_to_fn1.go\n    pkg2_specific_to_fn1:\n        -pkg2_specific_to_fn1.go\n    main.go\nfunction2:\n    pkg1_specific_to_fn1:\n        -pkg1_specific_to_fn2.go\n    pkg2_specific_to_fn1:\n        -pkg2_specific_to_fn2.go\n    main.go\nfunction3:\n    pkg1_specific_to_fn1:\n        -pkg1_specific_to_fn3.go\n    pkg2_specific_to_fn1:\n        -pkg2_specific_to_fn3.go\n    main.go\n</code></pre>\n\n<p>How do I create .YML deployment file for all these functions in GoLang? Will there be any issues if all of these functions have their own main? I am new to GoLang, but as far as I know, package can contain only one main.go file, and in YML file for <code>handler</code> property I have to specify executable from <code>bin</code>. Here is what I had in mind:</p>\n\n<pre><code>service: myService\n\nprovider:\n  name: aws\n  runtime: go1.x\n\nfunctions:\n  function1:\n    handler: bin/function1/main\n    description: ..\n    events: ..\n  function2:\n    handler: bin/function2/main\n    events: ..\n  function3:\n    handler: bin/function3/main\n</code></pre>\n\n<p>Since I have multiple packages representing multiple Lambda functions, it should be okay for me to have main.go in each of them, correct? If not then what is the right way to do this? Also, if this is fine, how do I specify correct <code>main</code> binary for each function, and is this really the convention to deploy multiple lambdas with GoLang?</p>\n\n<p><strong>NOTE:</strong> <em>in each main.go there is a corresponding function Handler.</em></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 8837721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W71lo.jpg?s=128&g=1", "display_name": "ukurik", "link": "https://stackoverflow.com/users/8837721/ukurik"}, "is_accepted": true, "score": 0, "last_activity_date": 1557731365, "creation_date": 1557731365, "answer_id": 56107307, "question_id": 56106971, "link": "https://stackoverflow.com/questions/56106971/inside-loop-define-the-parent-links/56107307#56107307", "title": "Inside loop define the parent links", "body": "<p>Done the above mentioned using map\n<a href=\"https://play.golang.org/p/8C5M0L-es6o\" rel=\"nofollow noreferrer\">https://play.golang.org/p/8C5M0L-es6o</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\n// Table with Fields and Assoc\ntype Table struct {\n    Name  string\n    Assoc map[string]int\n}\n\n// Assoc is a name of associated Table\n// type Assoc struct {\n//  Name string\n// }\n\nfunc main() {\n    tables := []string{\n        \"a\",\n        \"b\",\n        \"c\",\n        \"d\",\n        \"f\",\n        \"a_b\",\n        \"a_c\",\n        \"a_d_f\",\n        \"c_d\",\n    }\n\n    var tbls = make(map[string]map[string]int)\n\n    for _, t := range tables {\n        if strings.Contains(t, \"_\") {\n            splitAssocs := strings.Split(t, \"_\")            \n            for i:=0;i&lt;=len(splitAssocs)-2;i++ {\n                for j:=(i+1);j&lt;=len(splitAssocs)-1;j++{\n                    _, ok := tbls[splitAssocs[i]]\n                    if !ok{\n                        tbls[splitAssocs[i]] = make(map[string]int)\n                    }\n                     _, ok = tbls[splitAssocs[j]]\n                    if !ok{\n                        tbls[splitAssocs[j]] = make(map[string]int)\n                    }\n                    tbls[splitAssocs[i]][splitAssocs[j]] = 1\n                    tbls[splitAssocs[j]][splitAssocs[i]] = 1\n                }\n\n            }\n\n        } else {\n            _, ok := tbls[t]            \n            if !ok{\n                tbls[t] = make(map[string]int)\n            }\n        }\n\n    }\n\n    fmt.Println(tbls)\n}\n</code></pre>\n"}], "owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56107307, "answer_count": 1, "score": 0, "last_activity_date": 1557731365, "creation_date": 1557729754, "question_id": 56106971, "link": "https://stackoverflow.com/questions/56106971/inside-loop-define-the-parent-links", "title": "Inside loop define the parent links", "body": "<p>I would like to loop on the name of my tables to add the associations defined by the symbol \"<code>_</code>\".</p>\n\n<p>If table <code>a_b</code> and <code>a</code> then <code>b</code> exists then <code>a = [b]</code>, <code>b = [a]</code>.\nFinally, I do not have to print the tables containing a \"<code>_</code>\" in the name</p>\n\n<p>Struct</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Table with Fields and Assoc\ntype Table struct {\n    Name       string\n    Assoc      []Assoc\n}\n\n// Assoc is a name of associated Table\ntype Assoc struct {\n  Name string\n}\n</code></pre>\n\n<pre class=\"lang-golang prettyprint-override\"><code>tables := []string{\n    \"a\",\n    \"b\",\n    \"c\",\n    \"d\",\n    \"f\",\n    \"a_b\",\n    \"a_c\",\n    \"a_d_f\",\n    \"c_d\",      \n}\n\nvar tbls []Table\n\nfor _, t := range tables {\n    if strings.Contains(t, \"_\") {\n        // Split to find \"_\" like assoc := strings.Split(t, \"_\") ?\n        // append in struct \"Table{Name:a, Assoc:  [b,c,d,f]}\"\n        // append in struct \"Table{Name:b, Assoc:  [a]}\"\n        // append in struct \"Table{Name:c, Assoc:  [a,d]}\"\n        // append in struct \"Table{Name:d, Assoc:  [a,c,f]}\"\n        // append in struct \"Table{Name:f, Assoc:  [a,d]}\"      \n    } else {\n        n := Table{\n            Name: t,\n        }\n        tbls = append(tbls, n)\n    }\n\n}\n</code></pre>\n\n<p>Return like <code>fmt.Println(tbls)</code> : </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>[{a [b,c,d,f]} {b [a]} {c [a,d]} {d [a,c,f]} {f [a,d]}]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/T51qtVn1fVe\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "is_accepted": false, "score": 4, "last_activity_date": 1557722092, "creation_date": 1557722092, "answer_id": 56105802, "question_id": 56105779, "link": "https://stackoverflow.com/questions/56105779/same-package-name-on-different-files/56105802#56105802", "title": "Same package name on different files", "body": "<p>Can the function defined in the file b.go access a.go without importing anything? yes</p>\n\n<p>What can be the reasoning behind dividing the code into two different files? This is just a structuring mechanism, for example when the file would become too large otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 8837721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W71lo.jpg?s=128&g=1", "display_name": "ukurik", "link": "https://stackoverflow.com/users/8837721/ukurik"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1557729929, "post_id": 56105843, "comment_id": 98847716, "body": "any method/variable starting with a capital letter is considered as public."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1557745714, "post_id": 56105843, "comment_id": 98855761, "body": "<a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">That is called exported</a>, not public. And identifiers need not be exported to be accessible within a package, i.e <i>all</i> identifiers in a.go can be used in b.go, not just the exported ones."}], "tags": [], "owner": {"reputation": 79, "user_id": 8837721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W71lo.jpg?s=128&g=1", "display_name": "ukurik", "link": "https://stackoverflow.com/users/8837721/ukurik"}, "is_accepted": false, "score": 1, "last_activity_date": 1557722576, "creation_date": 1557722576, "answer_id": 56105843, "question_id": 56105779, "link": "https://stackoverflow.com/questions/56105779/same-package-name-on-different-files/56105843#56105843", "title": "Same package name on different files", "body": "<p>Yes, the Public functions/variables in a.go can be accessed by b.go and vice-versa. The main reason why we put them in different files is to keep all related methods and functionalities together.\nFor eg:\nIn package employee:</p>\n\n<ul>\n<li>Combining all use case methods together in a file(let's call its usecase.go)</li>\n<li>Combining all repository methods together in another file(let's call it repository.go)</li>\n<li>Combining all constants/enum like constants in another file(let's call it constants.go)</li>\n</ul>\n\n<p>All these are available under the same domain package employee.\nEach file can access other files public variables/functions. Here usecase.go GetEmployeeData() will access repository.go>GetEmployeeForID(ID int)\nSimilarly, same usecase method GetEmployeeData() will access constants.go constant Employee_Type to decide some logic based on it.</p>\n\n<p>We group things in a file and try making it small and easy to read. \nHope this helps.</p>\n"}], "owner": {"reputation": 75, "user_id": 6517649, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ac564d24b3ba69720d6e977220cba64c?s=128&d=identicon&r=PG&f=1", "display_name": "Parth Verma", "link": "https://stackoverflow.com/users/6517649/parth-verma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1557728642, "creation_date": 1557721877, "last_edit_date": 1557728642, "question_id": 56105779, "link": "https://stackoverflow.com/questions/56105779/same-package-name-on-different-files", "title": "Same package name on different files", "body": "<p>There is same package name in different files in the same folder.</p>\n\n<pre><code>a.go\n\npackage abc\n\ntype B struct {\n}\n</code></pre>\n\n<pre><code>b.go\n\npackage abc\n\nfunc (b *B) Run() {\n}\n</code></pre>\n\n<p>Can the function defined in the file <code>b.go</code> access <code>a.go</code> without importing anything?</p>\n\n<p>What can be the reasoning behind dividing the code into two different files?</p>\n"}, {"tags": ["authentication", "go", "cas", "http-redirect", "traefik"], "owner": {"reputation": 265, "user_id": 4576192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FQgHX.jpg?s=128&g=1", "display_name": "vx3r", "link": "https://stackoverflow.com/users/4576192/vx3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 281, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557718781, "creation_date": 1557718013, "last_edit_date": 1557718781, "question_id": 56105407, "link": "https://stackoverflow.com/questions/56105407/traefik-auth-proxy-to-cas-server", "title": "Traefik /auth proxy to CAS server", "body": "<p>I am trying to use <a href=\"https://docs.traefik.io/configuration/entrypoints/#forward-authentication\" rel=\"nofollow noreferrer\">Traefik's forward authentication</a> for SSO my docker applications. Indeed we already have a CAS server in company and the idea would be to reuse it. I understand that I can not directly point Traefic to the CAS server (the redirect to login is considered as an answer, other than 2XX login failed). I can write a small proxy in Golang for example to forward  the request to CAS, a bit like <a href=\"https://github.com/thomseddon/traefik-forward-auth\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>My question is whether or not it is possible? If yes a flow schema would be welcome and any other help to realize the project.</p>\n"}, {"tags": ["go", "grpc", "grpc-go"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1557716985, "post_id": 56105302, "comment_id": 98844606, "body": "this is the golang grpc goroutines and how can I write this code?  currently I have this as   ``` dronePos := &lt;-position  maybe ill add   err = stream.Send(&amp;dronePosition)  and stream.CloseSend() ```  Please correct me  where should i add this result?"}, {"owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "reply_to_user": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 1, "creation_date": 1557717398, "post_id": 56105302, "comment_id": 98844666, "body": "Well, I see that you have here client streaming ( by calling <code>stream.Recv()</code> in a cycle. I don&#39;t know how your <code>.proto</code> file looks like, but you need for your task change it in a way that it supports bidirectional data streaming, regenerate service code (if it was not bidirectional) and add logic for returning answer via <code>err = stream.Send(&amp;dronePosition)</code>"}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1557717494, "post_id": 56105302, "comment_id": 98844686, "body": "This is my current code I changed i ``` itemParameter := models.ItemParameter{ \t\t\t\tLatitude:  msg.Latitude, \t\t\t\tLongitude: msg.Longitude, \t\t\t\tAltitude:  msg.Altitude, \t\t\t}  \t\t\tdronePosition := models.DronePosition{ \t\t\t\tName:          uavID.Aircraft, \t\t\t\tItemParameter: itemParameter, \t\t\t}  \t\t\tposition &lt;- dronePosition ``` but the problem is how can I pass to my api? this is written in golang and also there is grpc server function that sends a message so my job is to return the response to api stream simultaneously"}, {"owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "reply_to_user": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1557717713, "post_id": 56105302, "comment_id": 98844715, "body": "maube I don&#39;t understand your initial question. Do you want to pass it immediately? Then just turn it back in bidirectional way. If you need to pass it to another endpoint (some integration) -&gt; then just put it for a while into DB"}, {"owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1557718131, "post_id": 56105302, "comment_id": 98844788, "body": "what really happen my api must accept multiple request   ``` stream API must have a compatible client from the UI. and multi client/object. meaning, it supports multiple stream from your API to multiple drone on the map  single connection but supports multiple drone ``` which if i use get request this would be difficult to achieve also the streaming is happening in the grpc and also the api should stream as well (golang) am finding a way how to handle this and also as I ask a while a go, i searched last week on how to get result from the go routines which is difficult."}, {"owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "reply_to_user": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "edited": false, "score": 0, "creation_date": 1557750411, "post_id": 56105302, "comment_id": 98858125, "body": "I suggest you to read about grpc. For example, there is a good example of bidirectional grpc calling: <a href=\"https://rakyll.org/grpc-streaming/\" rel=\"nofollow noreferrer\">rakyll.org/grpc-streaming</a>"}], "tags": [], "owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "is_accepted": false, "score": 4, "last_activity_date": 1557716731, "creation_date": 1557716731, "answer_id": 56105302, "question_id": 56105039, "link": "https://stackoverflow.com/questions/56105039/how-to-stream-result-from-grpc-server-and-how-to-return-result-from-goroutines-g/56105302#56105302", "title": "How to stream result from grpc-server and how to return result from goroutines grpc server-stream to pass result to api", "body": "<p>If I understood you correctly -> this is server grpc endpoint and your problem is how to send <code>models.DronePosition</code> back to the client. If so, then you have bidirectional streaming and you can solve this problem as:</p>\n\n<pre><code>dronePosition := models.DronePosition{\n                Name:          uavID.Aircraft,\n                ItemParameter: itemParameter,\n            }\nposition &lt;- dronePosition\nerr = stream.Send(&amp;dronePosition)\n</code></pre>\n\n<p>And on the client there should be the corresponding update to support bidirectional data streaming</p>\n"}], "owner": {"reputation": 125, "user_id": 10230139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac213abfb2729d97f0c3fa6f76d9ccd2?s=128&d=identicon&r=PG&f=1", "display_name": "Yabetsu2018", "link": "https://stackoverflow.com/users/10230139/yabetsu2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 697, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1557734190, "creation_date": 1557713796, "last_edit_date": 1557734190, "question_id": 56105039, "link": "https://stackoverflow.com/questions/56105039/how-to-stream-result-from-grpc-server-and-how-to-return-result-from-goroutines-g", "title": "How to stream result from grpc-server and how to return result from goroutines grpc server-stream to pass result to api", "body": "<p>I have an api created via golang which return the result of </p>\n\n<pre><code>{\n   id : drone4\n   item_parameter : {\n       altitude : 20,\n       longitude : 10.20\n      latitude : 24.5\n}\n</code></pre>\n\n<p>as a json result, but in the code it uses\ngo routines which call the go func() to process \nthe result from grpc-server golang</p>\n\n<p>like this </p>\n\n<pre><code>go func() {\n        fmt.Print(\"start getPosition loop\")\n        for {\n            msg, err := stream.Recv() // msg UAVPosition\n            if err == io.EOF {\n                // read done.\n                fmt.Print(\"start getPosition loop closed\")\n                close(position)\n                return\n            }\n            if err != nil {\n                log.Fatalf(\"Failed to receive getPosition : %v\", err)\n                close(position)\n                return\n            }\n            log.Printf(\"Position point[%s](%f, %f, %f)\", uavID.Aircraft, msg.Latitude, msg.Longitude, msg.Altitude)\n\n            itemParameter := models.ItemParameter{\n                Latitude:  msg.Latitude,\n                Longitude: msg.Longitude,\n                Altitude:  msg.Altitude,\n            }\n\n            position &lt;- models.DronePosition{\n                Name:          uavID.Aircraft,\n                ItemParameter: itemParameter,\n            }\n        }\n    }()\n\n</code></pre>\n\n<p>I need to get the positon value which is i used this channel </p>\n\n<pre><code>position := make(chan models.DronePosition)\n</code></pre>\n\n<p>if any chance how can I get this result to stream to the ui using go?\nany suggestion how to work this streaming way in ui?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1557723995, "post_id": 56104471, "comment_id": 98845811, "body": "A regex is the wrong tool here. E.g. simply counting and outputing after the the last &quot; if there is an odd number of &quot; is much simpler."}], "answers": [{"tags": [], "owner": {"reputation": 79, "user_id": 8837721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W71lo.jpg?s=128&g=1", "display_name": "ukurik", "link": "https://stackoverflow.com/users/8837721/ukurik"}, "is_accepted": true, "score": 3, "last_activity_date": 1557722947, "last_edit_date": 1557722947, "creation_date": 1557709554, "answer_id": 56104732, "question_id": 56104471, "link": "https://stackoverflow.com/questions/56104471/regular-expression-for-finding-malformed-quoted-strings/56104732#56104732", "title": "Regular expression for finding malformed quoted strings", "body": "<p>Doing all with regex can be done.. will take some more time to perfect the solution. But using some strings function will make it bit easy for you.</p>\n\n<p>Hope this helps!!</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"regexp\"\n\"strings\"\n)\n\nfunc main() {\nstr := `\n    \"The fish was 2 long. I said: Give me that fish!.\nThe fish was 2\" long. I said: Give me that fish!.\n\"The fish was 2 long. I said: Give me that fish!.\"\n\"\"sdfsdf\n`\nsplitStr := strings.Split(str, \"\\n\")\nre := regexp.MustCompile(`\"{1}[A-Za-z0-9 .:!]+\"{0}[A-Za-z0-9 .:!]+$`)\nfor _,v := range splitStr {\n    if len(strings.Trim(v, \" \")) &gt;= 0{\n    // some extra check\n    if strings.Count(v, \"\\\"\") % 2 == 1 {\n        fmt.Println( re.FindString(v))\n    }\n\n    } \n}\n</code></pre>\n\n<p>}</p>\n\n<p>Code sample available here: <a href=\"https://play.golang.org/p/LYte6FRocv3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/LYte6FRocv3</a></p>\n"}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 56104732, "answer_count": 1, "score": 0, "last_activity_date": 1557722947, "creation_date": 1557706224, "last_edit_date": 1557707969, "question_id": 56104471, "link": "https://stackoverflow.com/questions/56104471/regular-expression-for-finding-malformed-quoted-strings", "title": "Regular expression for finding malformed quoted strings", "body": "<p>I am trying to build an regular expression for sub string which have a starting quote but didn't have ending quote. Below is an sample string</p>\n\n<pre><code>\"The fish was 2 long. I said: Give me that fish!.\nThe fish was 2\" long. I said: Give me that fish!.\n\"The fish was 2 long. I said: Give me that fish!.\"\nThe fish \"was 2 long\". I said: \"Give me that fish!.\n</code></pre>\n\n<p>So the valid output for the expression would be</p>\n\n<pre><code>String 1 - The fish was 2 long. I said: Give me that fish!\nString 2 -  long. I said: Give me that fish!.\nString 3 - No output\nString 4 - Give me that fish!.\n</code></pre>\n\n<p>Any thoughts how I can build the regular expression.</p>\n"}, {"tags": ["string", "macos", "go", "stdout"], "comments": [{"owner": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "edited": false, "score": 5, "creation_date": 1557701518, "post_id": 56103775, "comment_id": 98842566, "body": "What happens if you remove the &#39;\\n&#39; from the end of the string?"}, {"owner": {"reputation": 53, "user_id": 11489905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f10440f535b5deb06d514a8abefacb58?s=128&d=identicon&r=PG&f=1", "display_name": "smaraghi", "link": "https://stackoverflow.com/users/11489905/smaraghi"}, "reply_to_user": {"reputation": 1419, "user_id": 488095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ro1E0.jpg?s=128&g=1", "display_name": "jamieguinan", "link": "https://stackoverflow.com/users/488095/jamieguinan"}, "edited": false, "score": 1, "creation_date": 1557711942, "post_id": 56103775, "comment_id": 98843917, "body": "I removed the \\n. Oddly enough on some lines the stdout is overwritten but on most it is still not working.    I also removed the code from the bytes package. It seems it is no longer needed."}], "answers": [{"tags": [], "owner": {"reputation": 549, "user_id": 618352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/348d2acd843f6a6f8486fa54cf67c350?s=128&d=identicon&r=PG", "display_name": "Jacques Supcik", "link": "https://stackoverflow.com/users/618352/jacques-supcik"}, "is_accepted": false, "score": 4, "last_activity_date": 1557730246, "last_edit_date": 1557730246, "creation_date": 1557728025, "answer_id": 56106639, "question_id": 56103775, "link": "https://stackoverflow.com/questions/56103775/how-to-print-formatted-string-to-the-same-line-in-stdout-with-go/56106639#56106639", "title": "How to print formatted string to the same line in stdout with Go?", "body": "<p>You can use the <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code\" rel=\"nofollow noreferrer\">ANSI Escape Codes</a></p>\n\n<p>First, save the position of the cursor with <code>fmt.Print(\"\\033[s\")</code>, then for each line, restore the position and clear the line before printing the line with <code>fmt.Print(\"\\033[u\\033[K\")</code></p>\n\n<p>Your code could be:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// before entering the loop\nfmt.Print(\"\\033[s\") // save the cursor position\n\nfor ... {\n    ...\n    fmt.Print(\"\\033[u\\033[K\") // restore the cursor position and clear the line\n    if err != nil {\n        fmt.Printf(\"Could not retrieve file info for %s\\n\", f)\n    } else {\n        fmt.Printf(\"Retrieved %s\\n\", f)\n    }\n    ...\n}\n</code></pre>\n\n<p>It should work unless your program prints the line at the bottom of the screen, generating a scrolling of your text. In this case, you should remove the <code>\\n</code> and make sure that no line exceeds the screen (or window) width.</p>\n\n<p>Another option could be to move the cursor up after each write:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for ... {\n    ...\n    fmt.Print(\"\\033[G\\033[K\") // move the cursor left and clear the line\n    if err != nil {\n        fmt.Printf(\"Could not retrieve file info for %s\\n\", f)\n    } else {\n        fmt.Printf(\"Retrieved %s\\n\", f)\n    }\n    fmt.Print(\"\\033[A\") // move the cursor up\n    ...\n}\n</code></pre>\n\n<p>Again, this works as long as your line fits on the screen/window width.</p>\n"}], "owner": {"reputation": 53, "user_id": 11489905, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f10440f535b5deb06d514a8abefacb58?s=128&d=identicon&r=PG&f=1", "display_name": "smaraghi", "link": "https://stackoverflow.com/users/11489905/smaraghi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2427, "favorite_count": 3, "answer_count": 1, "score": 3, "last_activity_date": 1557730246, "creation_date": 1557698173, "question_id": 56103775, "link": "https://stackoverflow.com/questions/56103775/how-to-print-formatted-string-to-the-same-line-in-stdout-with-go", "title": "How to print formatted string to the same line in stdout with Go?", "body": "<p>I am iterating over an array and printing a formatted string with each array element to the terminal (stdout). Rather than printing each element on a new line, I want to overwrite the previous output with the program's newest output. </p>\n\n<p>I am using macosx.</p>\n\n<p>I have tried a few ways:</p>\n\n<pre><code>// 'f' is the current element of the array\nb := bytes.NewBufferString(\"\")\nif err != nil {\n    fmt.Printf(\"\\rCould not retrieve file info for %s\\n\", f)\n    b.Reset()\n} else {\n    fmt.Printf(\"\\rRetrieved %s\\n\", f)\n    b.Reset()\n}\n</code></pre>\n\n<p>A second way was to remove <code>\\r</code> from the string and add and additional Printf before each output: <code>fmt.Printf(\"\\033[0;0H\")</code>.</p>\n"}, {"tags": ["go", "graphics", "png"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1557749619, "post_id": 56103481, "comment_id": 98857689, "body": "can you give a concrete example of what you mean by &quot;color number&quot;  ?"}, {"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1557756861, "post_id": 56103481, "comment_id": 98861951, "body": "With pixelart software and on more or less vintage computers, you have a limited palette with RGB values, and you refer each pixels by a color number, which points to the palette..."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1557763910, "post_id": 56103481, "comment_id": 98865806, "body": "above you show color of a pixel in rgba as {91 71 0 255}   so what would be the &quot;color number&quot; of that pixel ?   are you looking for a  triplet equivalent in hex as in conversion from rgb of   85,255,85  into its hex of  #55FF55   ?"}, {"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1557765822, "post_id": 56103481, "comment_id": 98866612, "body": "The color number would be its rank inside the palette. <a href=\"https://www.jessechapo.com/posts/Developers-Guide-to-Images.html\" rel=\"nofollow noreferrer\">jessechapo.com/posts/Developers-Guide-to-Images.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "edited": false, "score": 1, "creation_date": 1557722320, "post_id": 56103621, "comment_id": 98845453, "body": "Hi Scott, I need the color number, not the RGBA. each pixel should have a color number, the RGB itself is defined by the image palette."}], "tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": false, "score": 0, "last_activity_date": 1557696686, "last_edit_date": 1557696686, "creation_date": 1557696380, "answer_id": 56103621, "question_id": 56103481, "link": "https://stackoverflow.com/questions/56103481/getting-a-pixel-color-number-from-an-indexed-png-file-in-golang/56103621#56103621", "title": "Getting a pixel color number from an indexed PNG file in golang", "body": "<p>just make a call to RGBA as in</p>\n\n<pre><code>for y := 0; y &lt; img.Bounds().Max.Y; y++ {\n    for x := 0; x &lt; img.Bounds().Max.X; x++ {\n        // color := img.At(x, y)\n        r,g,b,a := img.At(x, y).RGBA()\n        // fmt.Printf(\"%v\", color)\n        fmt.Printf(\"red %d  green %d  blue %d  alpha %d\", r,g,b,a)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://blog.golang.org/go-image-package\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-image-package</a></p>\n"}], "owner": {"reputation": 2905, "user_id": 2036995, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/af70d05f380d9930df7a7cd9f3907920?s=128&d=identicon&r=PG", "display_name": "franck", "link": "https://stackoverflow.com/users/2036995/franck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 477, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557813463, "creation_date": 1557695049, "last_edit_date": 1557813463, "question_id": 56103481, "link": "https://stackoverflow.com/questions/56103481/getting-a-pixel-color-number-from-an-indexed-png-file-in-golang", "title": "Getting a pixel color number from an indexed PNG file in golang", "body": "<p>Golang let you get the RGBA value for each pixels of a png file by using png.Decode and img.At:</p>\n\n<pre><code>file, _ := os.Open(\"file.png\")\nimg, err := png.Decode(file)\nif err != nil {\n    log.Fatal(err)\n}\nfor y := 0; y &lt; img.Bounds().Max.Y; y++ {\n    for x := 0; x &lt; img.Bounds().Max.X; x++ {\n        color := img.At(x, y)\n        fmt.Printf(\"%v\", color)\n    }\n}\n</code></pre>\n\n<p>Will return {91 71 0 255}{91 71 2 255}{92 72 1 255} (...) How to get each color number instead?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1558398577, "post_id": 56103394, "comment_id": 99079185, "body": "Why don&#39;t you just store the desired document into a single collection ? Also, what have you tried ?"}], "answers": [{"tags": [], "owner": {"reputation": 814, "user_id": 6396157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHCim.jpg?s=128&g=1", "display_name": "Praveen Rewar", "link": "https://stackoverflow.com/users/6396157/praveen-rewar"}, "is_accepted": true, "score": 1, "last_activity_date": 1616133052, "creation_date": 1616133052, "answer_id": 66703125, "question_id": 56103394, "link": "https://stackoverflow.com/questions/56103394/mongo-aggregate-nested-array-lookup/66703125#66703125", "title": "Mongo Aggregate Nested Array, Lookup", "body": "<p>I was able to solve the problem in 3 steps:</p>\n<ol>\n<li>Include all the permissions for every role and add a flag called <code>checked</code>. This increased data redundancy but that wasn't a big issue.</li>\n<li>Do a <code>group by</code> on <code>resource</code> field in <code>roles</code> collection.</li>\n<li>Populate the missing <code>privileges</code> for every <code>resource</code> with <code>isEditable</code> set to false on server side.</li>\n</ol>\n<p>I had to traverse the data on server side, but this was the most efficient way I could think of.</p>\n"}], "owner": {"reputation": 814, "user_id": 6396157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHCim.jpg?s=128&g=1", "display_name": "Praveen Rewar", "link": "https://stackoverflow.com/users/6396157/praveen-rewar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 66703125, "answer_count": 1, "score": 2, "last_activity_date": 1616133052, "creation_date": 1557694415, "question_id": 56103394, "link": "https://stackoverflow.com/questions/56103394/mongo-aggregate-nested-array-lookup", "title": "Mongo Aggregate Nested Array, Lookup", "body": "<p>I am creating a web application using MongoDB and Go, which includes role based access control. I am storing the information regarding this in 2 collections, <code>permissions</code> and <code>roles</code>.</p>\n\n<p>This is how these two collections look like.\nPermissions</p>\n\n<pre><code>{\n    \"operation\": \"create\",\n    \"resource\": \"project\"\n}\n{\n    \"operation\": \"read\",\n    \"resource\": \"project\"\n}\n{\n    \"operation\": \"update\",\n    \"resource\": \"project\"\n}\n{\n    \"operation\": \"delete\",\n    \"resource\": \"project\"\n}\n{\n    \"operation\": \"create\",\n    \"resource\": \"user\"\n}\n</code></pre>\n\n<p><code>resource</code> is something on which an <code>operation</code> is performed. So if there is some operation which cannot be performed on some resource, then, I needn't store it. For example user can only be created hence only <code>create</code> <code>user</code> need to be stored.\nCurrently there are only 4 operations(create, read, update, delete) in the scope of the application, but could increase, like <code>upload</code> could come into picture.</p>\n\n<p>Roles</p>\n\n<pre><code>{\n    \"role\": \"admin\",\n    \"display_name\": \"Administrator\",\n    \"permissions\": [\n      {\n        \"operation\": \"create\",\n        \"resource\": \"project\"\n      },\n      {\n        \"operation\": \"read\",\n        \"resource\": \"project\"\n      },\n      {\n        \"operation\": \"update\",\n        \"resource\": \"project\"\n      },\n      {\n        \"operation\": \"delete\",\n        \"resource\": \"project\"\n      }\n    ]\n}\n</code></pre>\n\n<p>Roles contain role, the name of role to be displayed on UI and the set of permissions that role has.</p>\n\n<p>I need to send this information to UI using a REST API in a specific format, which would describe whether a specific role can perform an operation on a resource or not using the <code>checked</code> flag and whether a specific operation on a resource is editable or not by using the flag <code>isEditable</code>.\nFor example the permissions collection doesn't contain an operation delete on resource user, so it should not be editable, hence flag is set to false. Similarly user can be created, hence it is set to true.</p>\n\n<pre><code> {\n    display_name: \"System Administrator\",\n    role: \"admin\",\n    permissions: [\n      {\n        resource: \"user\",\n        privilages: {\n          create: { checked: false, isEditable: true },\n          delete: { checked: false, isEditable: false },\n          update: { checked: false, isEditable: false },\n          read: { checked: false, isEditable: false }\n        }\n      },\n      {\n        resource: \"project\",\n        privilages: {\n          create: { checked: true, isEditable: true },\n          delete: { checked: true, isEditable: true },\n          update: { checked: true, isEditable: true },\n          read: { checked: true, isEditable: true }\n        }\n      }\n   ]\n}\n</code></pre>\n\n<p>Is it possible to perform this using mongo aggregations? Or do I need to make modifications in my schema, If yes, then what modifications should I make.</p>\n"}, {"tags": ["go", "grpc", "grpc-go"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1557693946, "post_id": 56103045, "comment_id": 98841095, "body": "No this is not normal. Do you have access to console logs of your server? There must be a panic or some other runtime error to cause the server to stop. The console would give clues to why that is. Liberal use of <code>log</code> will help too."}, {"owner": {"reputation": 49, "user_id": 11448681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6341e947247566dd0b788ccd0c5fd6?s=128&d=identicon&r=PG&f=1", "display_name": "Karina sarkisovae", "link": "https://stackoverflow.com/users/11448681/karina-sarkisovae"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557694241, "post_id": 56103045, "comment_id": 98841165, "body": "@colminator Im using amazon aws ec2 instance and I own it. I just need you to tell me where to find it. :/"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1557694454, "post_id": 56103045, "comment_id": 98841212, "body": "AWS: <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-console.html\" rel=\"nofollow noreferrer\">Getting Console Output</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 8637053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4trS5.jpg?s=128&g=1", "display_name": "Shahed Ahmed", "link": "https://stackoverflow.com/users/8637053/shahed-ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1557694620, "creation_date": 1557694620, "answer_id": 56103420, "question_id": 56103045, "link": "https://stackoverflow.com/questions/56103045/grpc-server-stops-for-no-reason/56103420#56103420", "title": "gRPC Server stops for no reason", "body": "<p>I'm studying golang recently, I found go lang error handling different. If you want it will not force you to use err, and bad part is it will not show you anything. \nSo please check your programs have any error or not. And also for experts help you need to be more clear about question. Show some code or indication than people can observe where is the problem. Just saying my program crashed will help you by anything.</p>\n"}, {"tags": [], "owner": {"reputation": 79, "user_id": 8837721, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W71lo.jpg?s=128&g=1", "display_name": "ukurik", "link": "https://stackoverflow.com/users/8837721/ukurik"}, "is_accepted": false, "score": 0, "last_activity_date": 1557711338, "creation_date": 1557711338, "answer_id": 56104847, "question_id": 56103045, "link": "https://stackoverflow.com/questions/56103045/grpc-server-stops-for-no-reason/56104847#56104847", "title": "gRPC Server stops for no reason", "body": "<p>Try these options\n1. Check your logs of what happens before it exits(Dump the logs to a file to verify the issue)\n2. Did you add any external package to the codebase which caused this?</p>\n"}, {"tags": [], "owner": {"reputation": 844, "user_id": 3521098, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c9b0243aa390cc2f9d25ed5e22e09669?s=128&d=identicon&r=PG", "display_name": "Solorad", "link": "https://stackoverflow.com/users/3521098/solorad"}, "is_accepted": false, "score": 1, "last_activity_date": 1580573125, "last_edit_date": 1580573125, "creation_date": 1557715678, "answer_id": 56105210, "question_id": 56103045, "link": "https://stackoverflow.com/questions/56103045/grpc-server-stops-for-no-reason/56105210#56105210", "title": "gRPC Server stops for no reason", "body": "<ol>\n<li>You can add in your handler recovery part </li>\n</ol>\n\n<pre><code>import    \"runtime/debug\"\n\ndefer func() {\n   if err := recover(); err != nil {\n      log.Errorf(\"Recovered from err: %v\\n %s\", err, debug.Stack())\n   }\n}()\n</code></pre>\n\n<ol start=\"2\">\n<li>More than that: there are specific middleware for catching such panic: <a href=\"https://github.com/kazegusuri/grpc-panic-handler\" rel=\"nofollow noreferrer\">https://github.com/kazegusuri/grpc-panic-handler</a>\nFrom documentation:</li>\n</ol>\n\n<pre><code>import (\n    panichandler \"github.com/kazegusuri/grpc-panic-handler\"\n)\n\nfunc main() {\n    uIntOpt := grpc.UnaryInterceptor(panichandler.UnaryPanicHandler)\n    sIntOpt := grpc.StreamInterceptor(panichandler.StreamPanicHandler)\n    grpc.NewServer(uIntOpt, sIntOpt)\n}\n</code></pre>\n\n<p>The second approach is more reliable when recovery handler approach is faster to add</p>\n"}], "owner": {"reputation": 49, "user_id": 11448681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee6341e947247566dd0b788ccd0c5fd6?s=128&d=identicon&r=PG&f=1", "display_name": "Karina sarkisovae", "link": "https://stackoverflow.com/users/11448681/karina-sarkisovae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1580573125, "creation_date": 1557691695, "last_edit_date": 1557734647, "question_id": 56103045, "link": "https://stackoverflow.com/questions/56103045/grpc-server-stops-for-no-reason", "title": "gRPC Server stops for no reason", "body": "<p>My Go gRPC Server stops without I stop it by myself.\nRight now I need to start the server again by entering the command \"go run server.go\" whenever I see it not responding every 30 or 60 minutes.</p>\n\n<p>Is this normal? Do I need to restart the server after specific amount of time?</p>\n"}, {"tags": ["python", "go", "jvm"], "comments": [{"owner": {"reputation": 807, "user_id": 3141682, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d819f6690487d613814827f695ae2335?s=128&d=identicon&r=PG&f=1", "display_name": "Adi Ohana", "link": "https://stackoverflow.com/users/3141682/adi-ohana"}, "edited": false, "score": 1, "creation_date": 1557690664, "post_id": 56101959, "comment_id": 98840277, "body": "You can write your own client for web driver protocol but it is not recommend"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1557692666, "post_id": 56101959, "comment_id": 98840759, "body": "in golang, if that is what you want, you can check for <a href=\"https://github.com/chromedp/chromedp\" rel=\"nofollow noreferrer\">github.com/chromedp/chromedp</a>"}, {"owner": {"reputation": 25741, "user_id": 374693, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/03c70489237ec9fc2e571af68b2dcaae?s=128&d=identicon&r=PG", "display_name": "JimEvans", "link": "https://stackoverflow.com/users/374693/jimevans"}, "edited": false, "score": 0, "creation_date": 1557708367, "post_id": 56101959, "comment_id": 98843429, "body": "Can you help me understand why you don\u2019t want to use Selenium? Is it WebDriver that you find objectionable? If you don\u2019t care about cross-browser execution, any of the Chromium Debig Protocol solutions might provide an option. If cross-browser execution is important, what is your resistance to using W3C web standards like WebDriver (which is akin to supporting the monoculture of IE6 in the 90s or Chrome today)?"}], "owner": {"user_type": "does_not_exist", "display_name": "user6457056"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1557776898, "creation_date": 1557683817, "last_edit_date": 1557776898, "question_id": 56101959, "link": "https://stackoverflow.com/questions/56101959/how-to-control-the-web-components-without-the-use-of-selenium-or-any-other-third", "title": "How to control the web components without the use of Selenium or any other third party libraries?", "body": "<p>I want to automate the webpage interactions without the use of Selenium web drivers. I didn't find the solution yet, how can I do it without the help of any third party libraries.</p>\n\n<p>Is it possible to do with only built-in features of any language. Is it possible using Golang, Python or Java?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "dependency-management", "package-managers", "go-modules", "godeps"], "answers": [{"tags": [], "owner": {"reputation": 2572, "user_id": 5472819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a71137528d9b9dfa1e5f2bbb81cad352?s=128&d=identicon&r=PG", "display_name": "Sean DuBois", "link": "https://stackoverflow.com/users/5472819/sean-dubois"}, "is_accepted": true, "score": 3, "last_activity_date": 1557702112, "creation_date": 1557702112, "answer_id": 56104156, "question_id": 56101497, "link": "https://stackoverflow.com/questions/56101497/how-to-use-go-module-as-dependency-in-go-dep-project/56104156#56104156", "title": "How to use go module as dependency in go dep project?", "body": "<p>Thanks for using Pion :)</p>\n\n<p>We had the same <a href=\"https://github.com/pion/webrtc/issues/493\" rel=\"nofollow noreferrer\">issue</a> opened on Pion WebRTC issue tracker. There is a <a href=\"https://github.com/golang/dep/pull/1963\" rel=\"nofollow noreferrer\">PR</a> to fix dep for this case.</p>\n\n<p>If possible I would switch to modules though, but in the meantime hopefully using this patched version of dep should help!</p>\n"}], "owner": {"reputation": 1383, "user_id": 4167563, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/90cc579fcc609be0144e24cdd6e056fa?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4167563/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 56104156, "answer_count": 1, "score": 1, "last_activity_date": 1557702112, "creation_date": 1557680507, "question_id": 56101497, "link": "https://stackoverflow.com/questions/56101497/how-to-use-go-module-as-dependency-in-go-dep-project", "title": "How to use go module as dependency in go dep project?", "body": "<p>I have Go <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">dep</a> project. I want to use go module as dependency. For example. I need this one <a href=\"https://github.com/pion/webrtc\" rel=\"nofollow noreferrer\"><a href=\"https://github.com/pion/webrtc\" rel=\"nofollow noreferrer\">https://github.com/pion/webrtc</a></a>.</p>\n\n<p>So, I try to declare the dependency like this, in <strong>Gopkg.toml</strong>:</p>\n\n<pre><code>[[constraint]]\n  name = \"github.com/pion/webrtc\"\n  revision = \"6a0b7020b1724dcb302ddfadab0c80fabc144c97\"\n</code></pre>\n\n<p>When I do <code>dep ensure</code>, I got errors:</p>\n\n<pre><code>Solving failure: No versions of github.com/pion/webrtc met constraints:\n        6a0b7020b1724dcb302ddfadab0c80fabc144c97: \"github.com/pion/webrtc\" imports \"github.com/pion/webrtc/v2/pkg/rtcerr\", which con\ntains malformed code: no package exists at \"github.com/pion/webrtc/v2/pkg/rtcerr\"\n        v2.0.14: Could not introduce github.com/pion/webrtc@v2.0.14, as it is not allowed by constraint 6a0b7020b1724dcb302ddfadab0c\n80fabc144c97 from project ***.\n        v2.0.13: Could not introduce github.com/pion/webrtc@v2.0.13, as it is not allowed by constraint 6a0b7020b1724dcb302ddfadab0c\n80fabc144c97 from project ***.\n</code></pre>\n\n<p>It seems, that the problem is connected with <em>2 version</em> of library. When it was <em>1</em>, everything works fine.</p>\n"}, {"tags": ["go", "dll"], "comments": [{"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1557718832, "post_id": 56100506, "comment_id": 98844903, "body": "When rc == 0 the defer activates. The point is, place defer before anything else because when you have an error, the connection stays open and will give strange results. Rebooting computer is the only option to close the connection."}, {"owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "reply_to_user": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1557739030, "post_id": 56100506, "comment_id": 98852035, "body": "@Dippo Are you referring specifically to EHLAPI Connect/Disconnect? Or something generic. The defer is to ensure that the session with PC3270 is closed; it doesn&#39;t make sense if the Connect hasn&#39;t been successful."}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1557753321, "post_id": 56100506, "comment_id": 98859785, "body": "You must replace the defer with a Println. The defer must be the first line in the main procedure. So, when something goes wrong, the defer must kick in to remove everything what has to do with the dll connection. An example can be found here: <a href=\"https://github.com/golang/go/wiki/WindowsDLLs\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/WindowsDLLs</a>"}, {"owner": {"reputation": 194, "user_id": 1478294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1b079763724f5d11cd9381594bb925d?s=128&d=identicon&r=PG", "display_name": "Dippo", "link": "https://stackoverflow.com/users/1478294/dippo"}, "edited": false, "score": 0, "creation_date": 1557753552, "post_id": 56100506, "comment_id": 98859940, "body": "Also, i think something is wrong in the function ecall, rc is never overwritten once you call the dll."}], "owner": {"reputation": 8757, "user_id": 9634, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/6181812b2747dc091b4b7ec97fb67c2f?s=128&d=identicon&r=PG", "display_name": "Brent.Longborough", "link": "https://stackoverflow.com/users/9634/brent-longborough"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1557673480, "creation_date": 1557673480, "question_id": 56100506, "link": "https://stackoverflow.com/questions/56100506/calling-a-dll-from-go-what-am-i-doing-wrong", "title": "Calling a DLL from Go - what am I doing wrong?", "body": "<p>I'm trying to convert a program from Python (2.7, 32-bit) to Go (1.12.5, 32bit), and failing miserably with an access violation. The program calls a function in a 32-bit dll (ehlapi32.dll).</p>\n\n<p>The following clips of the Python code appear to work perfectly (I'm not affirming that they are correct!):</p>\n\n<pre><code>class ehlapi32:\n    hllDll       = \"C:\\Program Files (x86)\\IBM\\Personal Communications\\EHLAPI32.dll\"\n    hllDll       = ctypes.WinDLL(hllDll)\n    hllApiProto  = ctypes.WINFUNCTYPE(ctypes.c_int,ctypes.c_void_p,ctypes.c_void_p,\n                                      ctypes.c_void_p,ctypes.c_void_p)\n    hllApiParams = (1, \"p1\", 0), (1, \"p2\", 0), (1, \"p3\",0), (1, \"p4\",0),\n    hllApi       = hllApiProto ((\"HLLAPI\", hllDll), hllApiParams)\n    pFunConnect  = ctypes.c_int(1)\n...\n    def connect(self):\n        shlSession = self.session + b'\\0\\0\\0'\n        pText      = ctypes.c_char_p (shlSession)\n        pLength    = ctypes.c_int (len(shlSession))\n        pReturn    = ctypes.c_int (13)\n\n        ehlapi32.hllApi (ctypes.byref (ehlapi32.pFunConnect), pText,\n                         ctypes.byref (pLength), ctypes.byref (pReturn))\n</code></pre>\n\n<p>Now here's what I'm trying as the Go equivalent. This fails:</p>\n\n<pre><code>// ElFunc: EHLLAPI Functions\ntype ElFunc uint32\n\nconst (\n    eConnect    ElFunc = 1  // Connect to a terminal\n)\n...\n// Session: a 3270 session handle\ntype Session struct {\n    SessId  string\n    SysId   string\n    Entry   string\n    Result  []string\n    Headers int\n    Footers int\n    Rows    int\n    Cols    int\n    Scroll  int\n    Proc    *syscall.LazyProc\n}\n...\nfunc (s Session) Connect() uint32 {\n    // Load EHLLAPI DLL\n    dll := syscall.NewLazyDLL(dllName)\n    s.Proc = dll.NewProc(dllProc)\n    // Connect to session\n    rc := s.ecall(eConnect, s.SessId, 1, 0)\n    if rc == 0 {\n        defer s.Disconnect()\n    }\n...\n// ecall: provides simplified EHLLAPI DLL calls\n\nfunc (s Session) ecall(fun ElFunc, buffer string, count uint32, ps uint32) uint32 {\n    rc := ps\n    _, _, _ = s.Proc.Call(\n        uintptr(unsafe.Pointer(uintptr(uint32(fun)))),\n        uintptr(unsafe.Pointer(&amp;buffer)),\n        uintptr(unsafe.Pointer(uintptr(count))),\n        uintptr(unsafe.Pointer(uintptr(rc))),\n    )\n    return rc\n}\n</code></pre>\n\n<p>The failure looks like an access violation at <code>s.Proc.Call</code> in <code>ecall()</code>.</p>\n\n<p>I realise that <code>syscall</code> is deprecated; I have also tried with <code>golang.org/x/sys/windows</code>, without success. I have no constraints as to which I use.</p>\n\n<p>I'll confess I'm way out of my depth here.</p>\n"}, {"tags": ["go", "aws-sdk-go"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 1, "creation_date": 1557669548, "post_id": 56099864, "comment_id": 98834776, "body": "Use an interface!"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557676392, "post_id": 56099864, "comment_id": 98836487, "body": "with the reflection package you can create new functions at runtime.They can take any input, output type, just define it. see reflect.FuncOf and reflect.MakeFunc."}, {"owner": {"reputation": 208, "user_id": 2855360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yS7a7.jpg?s=128&g=1", "display_name": "bart", "link": "https://stackoverflow.com/users/2855360/bart"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557678876, "post_id": 56099864, "comment_id": 98837189, "body": "thank you @mh-cbon was just looking at reflection but its not as simple as it looks :)"}, {"owner": {"reputation": 208, "user_id": 2855360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yS7a7.jpg?s=128&g=1", "display_name": "bart", "link": "https://stackoverflow.com/users/2855360/bart"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 1, "creation_date": 1557679614, "post_id": 56099864, "comment_id": 98837423, "body": "@Abdullah , an example would be much more valuable then short comment."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557691174, "post_id": 56099864, "comment_id": 98840394, "body": "reflect looks impressive but it only requires practice to master it."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1557692392, "post_id": 56099864, "comment_id": 98840666, "body": "If your functions are really that similar to each other, you can easily generate their bodies (with any text processing tool of your choosing. Go has some built-in). And if you do that, then you don&#39;t care about all the duplication."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1557692585, "post_id": 56099864, "comment_id": 98840734, "body": "forthe latter see <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\">blog.golang.org/generate</a> i think some good projects exists to helps around that, check on github."}, {"owner": {"reputation": 208, "user_id": 2855360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yS7a7.jpg?s=128&g=1", "display_name": "bart", "link": "https://stackoverflow.com/users/2855360/bart"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557741141, "post_id": 56099864, "comment_id": 98853287, "body": "this is interesting concept @SergioTulentsev, was just looking at aws-sdk-go source and looks like this is exactly how they generate the go code for the sdk based on json models"}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1557691925, "post_id": 56102979, "comment_id": 98840550, "body": "Code generation might be easier than reflection :)"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557691995, "post_id": 56102979, "comment_id": 98840569, "body": "yeah, when it works for your use case ; ) in this case it might, provide your answer!"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 2, "creation_date": 1557692215, "post_id": 56102979, "comment_id": 98840622, "body": "I would have, but I&#39;ve had a few too many beers tonight. Maybe tomorrow :)"}, {"owner": {"reputation": 208, "user_id": 2855360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yS7a7.jpg?s=128&g=1", "display_name": "bart", "link": "https://stackoverflow.com/users/2855360/bart"}, "edited": false, "score": 0, "creation_date": 1557728892, "post_id": 56102979, "comment_id": 98847308, "body": "@mh-cbon , very nice and complete answer, thank you."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 0, "last_activity_date": 1557691772, "last_edit_date": 1557691772, "creation_date": 1557691138, "answer_id": 56102979, "question_id": 56099864, "link": "https://stackoverflow.com/questions/56099864/generic-function-with-variable-input-output-types/56102979#56102979", "title": "Generic function with variable input/output types", "body": "<p>Because you only deal with functions it is possible to use the reflect package to generate functions at runtime.</p>\n\n<p>Using the object type (Volume, Vpc) it is possible to derive all subsequents information to provide a fully generic implementation that is really dry, at the extent at the being more complex and slower.</p>\n\n<p>It is untested, you are welcome to help in testing and fixing it, but something like this should put you on the track</p>\n\n<p><a href=\"https://play.golang.org/p/mGjtYVG2OZS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mGjtYVG2OZS</a></p>\n\n<p>The registry idea come from this answer <a href=\"https://stackoverflow.com/a/23031445/4466350\">https://stackoverflow.com/a/23031445/4466350</a></p>\n\n<p>for reference the golang documentation of the reflect package is at <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/reflect/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    fmt.Printf(\"%T\\n\", getter(Volume{}))\n    fmt.Printf(\"%T\\n\", getter(Vpc{}))\n}\n\ntype DescribeVolumesInput struct{}\ntype DescribeVpcs struct{}\n\ntype Volume struct{}\ntype Vpc struct{}\n\ntype Session struct{}\n\ntype Client struct{}\n\nfunc New(s *Session) Client { return Client{} }\n\nvar typeRegistry = make(map[string]reflect.Type)\n\nfunc init() {\n    some := []interface{}{DescribeVolumesInput{}, DescribeVpcs{}}\n    for _, v := range some {\n        typeRegistry[fmt.Sprintf(\"%T\", v)] = reflect.TypeOf(v)\n    }\n}\n\nvar errV = errors.New(\"\")\nvar errType = reflect.ValueOf(&amp;errV).Elem().Type()\nvar zeroErr = reflect.Zero(reflect.TypeOf((*error)(nil)).Elem())\nvar nilErr = []reflect.Value{zeroErr}\n\nfunc getter(of interface{}) interface{} {\n\n    outType := reflect.SliceOf(reflect.PtrTo(reflect.TypeOf(of)))\n    fnType := reflect.FuncOf([]reflect.Type{reflect.TypeOf(new(Session))}, []reflect.Type{outType, errType}, false)\n    fnBody := func(input []reflect.Value) []reflect.Value {\n\n        client := reflect.ValueOf(New).Call(input)[0]\n\n        t := reflect.MakeSlice(outType, 0, 0)\n        name := fmt.Sprintf(\"Describe%TsInput\", of)\n        descInput := reflect.New(typeRegistry[name]).Elem()\n\n        mName := fmt.Sprintf(\"Describe%Ts\", of)\n        meth := client.MethodByName(mName)\n        if !meth.IsValid() {\n            return []reflect.Value{\n                t,\n                reflect.ValueOf(fmt.Errorf(\"no such method %q\", mName)),\n            }\n        }\n        for {\n            out := meth.Call([]reflect.Value{descInput.Addr()})\n            if len(out) &gt; 0 {\n                errOut := out[len(out)-1]\n                if errOut.Type().Implements(errType) &amp;&amp; errOut.IsNil() == false {\n                    return []reflect.Value{t, errOut}\n                }\n            }\n            result := out[1]\n            fName := fmt.Sprintf(\"%Ts\", of)\n            if x := result.FieldByName(fName); x.IsValid() {\n                t = reflect.AppendSlice(t, x)\n            } else {\n                return []reflect.Value{\n                    t,\n                    reflect.ValueOf(fmt.Errorf(\"field not found %q\", fName)),\n                }\n            }\n\n            if x := result.FieldByName(\"NextToken\"); x.IsValid() {\n                descInput.FieldByName(\"NextToken\").Set(x)\n            } else {\n                break\n            }\n        }\n        return []reflect.Value{t, zeroErr}\n    }\n    fn := reflect.MakeFunc(fnType, fnBody)\n    return fn.Interface()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1510, "user_id": 6476791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d5de71330e6307063fdb6dde80d7ca?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/6476791/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1557702188, "last_edit_date": 1557702188, "creation_date": 1557701073, "answer_id": 56104078, "question_id": 56099864, "link": "https://stackoverflow.com/questions/56099864/generic-function-with-variable-input-output-types/56104078#56104078", "title": "Generic function with variable input/output types", "body": "<p>Proxying 3rd party API, is quite simple to implement with\ngo, here is how' it got implemented with endly e2e test runner <a href=\"https://github.com/viant/endly/blob/master/system/cloud/aws/proxy.go\" rel=\"nofollow noreferrer\">AWS proxy</a></p>\n\n<p>I would say that AWS API is perfect candidate for proxying, as long as reflection performance price is not an issue. </p>\n\n<p>Some other 3rd party  API like <a href=\"https://github.com/viant/endly/blob/master/system/kubernetes/shared/proxy.go\" rel=\"nofollow noreferrer\">kubernetes</a>\n are much more challenging, but still quite easy to proxy with go, which is a combination of reflection and code generation: </p>\n"}], "owner": {"reputation": 208, "user_id": 2855360, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yS7a7.jpg?s=128&g=1", "display_name": "bart", "link": "https://stackoverflow.com/users/2855360/bart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 56102979, "answer_count": 2, "score": -1, "last_activity_date": 1557727054, "creation_date": 1557668810, "last_edit_date": 1557727054, "question_id": 56099864, "link": "https://stackoverflow.com/questions/56099864/generic-function-with-variable-input-output-types", "title": "Generic function with variable input/output types", "body": "<p>Just playing with aws sdk for go. When listing resources of different types I tend to have alot of very similar functions like the two in the example bellow.\nIs there a way to rewrite them as one generic function that will return a specific type depending on what is passed on as param?</p>\n\n<p>Something like:</p>\n\n<pre><code>func generic(session, funcToCall, t, input) (interface{}, error) {}\n</code></pre>\n\n<p>currently I have to do this (functionality is the same just types change):</p>\n\n<pre><code>func getVolumes(s *session.Session) ([]*ec2.Volume, error) {\n\n    client := ec2.New(s)\n\n    t := []*ec2.Volume{}\n    input := ec2.DescribeVolumesInput{}\n\n    for {\n        result, err := client.DescribeVolumes(&amp;input)\n        if err != nil {\n            return nil, err\n        }\n\n        t = append(t, result.Volumes...)\n\n        if result.NextToken != nil {\n            input.NextToken = result.NextToken\n        } else {\n            break\n        }\n    }\n    return t, nil\n}\n\nfunc getVpcs(s *session.Session) ([]*ec2.Vpc, error) {\n\n    client := ec2.New(s)\n\n    t := []*ec2.Vpc{}\n    input := ec2.DescribeVpcsInput{}\n\n    for {\n        result, err := client.DescribeVpcs(&amp;input)\n        if err != nil {\n            return nil, err\n        }\n\n        t = append(t, result.Vpcs...)\n\n        if result.NextToken != nil {\n            input.NextToken = result.NextToken\n        } else {\n            break\n        }\n    }\n    return t, nil\n} \n</code></pre>\n"}, {"tags": ["go", "go-modules"], "answers": [{"tags": [], "owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "is_accepted": false, "score": 0, "last_activity_date": 1559136859, "creation_date": 1559136859, "answer_id": 56361875, "question_id": 56097766, "link": "https://stackoverflow.com/questions/56097766/how-to-version-publish-snapshot-not-finished-work-on-a-go-module/56361875#56361875", "title": "How to version &amp; publish snapshot/not-finished work on a go module?", "body": "<p>Versions for modules are tagged by using repo tags (e.g. <code>git tag</code>), following semantic versioning (<a href=\"https://semver.org/\" rel=\"nofollow noreferrer\">https://semver.org/</a>).</p>\n\n<p>So, any version starting with <code>v0</code> is treated as unstable and may make breaking changes at any time. Once you release a <code>v1</code>, you cannot make any breaking changes without bumping your major version, which also means you change your module name.</p>\n\n<p>You also have the option of appending <code>+foo</code> to the end of your version to indicate additional information about the version.</p>\n\n<p>I wrote <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">https://blog.golang.org/using-go-modules</a> as an overview of how to get started using modules.</p>\n"}], "owner": {"reputation": 700, "user_id": 998642, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/MFkm7.jpg?s=128&g=1", "display_name": "Reza Same&#39;ei", "link": "https://stackoverflow.com/users/998642/reza-sameei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1559136859, "creation_date": 1557652557, "question_id": 56097766, "link": "https://stackoverflow.com/questions/56097766/how-to-version-publish-snapshot-not-finished-work-on-a-go-module", "title": "How to version &amp; publish snapshot/not-finished work on a go module?", "body": "<p>I'm new in Golang, and I'm trying to develop a go-module and share it with my colleagues while I'm developing it; In JVM/sbt I used to publish my work with a 'SNAPSHOT' postfixed to version value. but How I can achieve the same in with go-modules? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 6, "creation_date": 1557645586, "post_id": 56096881, "comment_id": 98829421, "body": "I think the answer can be found in the docs on <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>: <i>&quot; if T is not an interface type, x.(T) asserts that the dynamic type of x is identical to the type T. In this case, T must implement the (interface) type of x; otherwise the type assertion is invalid since it is not possible for x to store a value of type T. <b>If T is an interface type, x.(T) asserts that the dynamic type of x implements the interface T.</b>&quot;</i>"}, {"owner": {"reputation": 530, "user_id": 10753492, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vpFmr9vacTw/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-jiHeIG7f13oRVc9pqOOOdXPCY9Gg/mo/photo.jpg?sz=128", "display_name": "user10753492", "link": "https://stackoverflow.com/users/10753492/user10753492"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557714111, "post_id": 56096881, "comment_id": 98844213, "body": "@mkopriva you should post that as an answer"}], "answers": [{"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1557656666, "creation_date": 1557656666, "answer_id": 56098275, "question_id": 56096881, "link": "https://stackoverflow.com/questions/56096881/why-does-a-type-switch-on-an-error-type-not-work/56098275#56098275", "title": "Why does a type switch on an error type not work?", "body": "<p>using composite struct you can match error, myError or something else easily.</p>\n\n<p>error and myError are exclusive within the same switch statement, but it should not be a problem.</p>\n\n<p>Instantiation is slightly different <code>myError{error:fmt.Errorf(\"TEST2\")}</code>.</p>\n\n<p>You do not need to use a ptr *myError (ie <code>&amp;myError..</code>) as error is an interface, thus it will match the method set defined on the value receiver of your type.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype myError struct {\n    error\n}\n\nfunc checkType(value interface{}) {\n    switch value.(type) {\n    case myError:\n        fmt.Printf(\"%v is a myError\\n\", value)\n    // case error:\n    //  fmt.Printf(\"%v is a %T\\n\", value, value)\n    default:\n        fmt.Printf(\"%v is something else\\n\", value)\n    }\n}\n\nfunc main() {\n    checkType(fmt.Errorf(\"TEST1\"))\n    checkType(myError{error:fmt.Errorf(\"TEST2\")})\n}\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>TEST1 is something else\nTEST2 is a myError\n</code></pre>\n"}], "owner": {"reputation": 12876, "user_id": 377446, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0479a8c7ebd088dbcf459147ba3b2569?s=128&d=identicon&r=PG", "display_name": "Karl", "link": "https://stackoverflow.com/users/377446/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557656666, "creation_date": 1557644000, "question_id": 56096881, "link": "https://stackoverflow.com/questions/56096881/why-does-a-type-switch-on-an-error-type-not-work", "title": "Why does a type switch on an error type not work?", "body": "<p>The code:</p>\n\n<pre><code>type baseStruct struct {\n    value int\n}\n\ntype myStruct baseStruct\n\nfunc checkType(value interface{}) {\n    switch value.(type) {\n    case myStruct:\n        fmt.Printf(\"%v is a myStruct\\n\", value)\n    default:\n        fmt.Printf(\"%v is something else\\n\", value)\n    }\n}\n\nfunc main() {\n    checkType(*new(baseStruct))\n    checkType(myStruct(*new(baseStruct)))\n}\n</code></pre>\n\n<p>outputs the following:</p>\n\n<pre><code>{0} is something else\n{0} is a myStruct\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/f8GjAe_Pc2l\" rel=\"nofollow noreferrer\">https://play.golang.org/p/f8GjAe_Pc2l</a></p>\n\n<p>Same for primitive types: <a href=\"https://play.golang.org/p/sD320wtkAs2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/sD320wtkAs2</a></p>\n\n<p>And yet the code:</p>\n\n<pre><code>type myError error\n\nfunc checkType(value interface{}) {\n    switch value.(type) {\n    case myError:\n        fmt.Printf(\"%v is a myError\\n\", value)\n    default:\n        fmt.Printf(\"%v is something else\\n\", value)\n    }\n}\n\nfunc main() {\n    checkType(fmt.Errorf(\"TEST1\"))\n    checkType(myError(fmt.Errorf(\"TEST2\")))\n}\n</code></pre>\n\n<p>outputs the following:</p>\n\n<pre><code>TEST1 is a myError\nTEST2 is a myError\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/g6ZmSv3hDzA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/g6ZmSv3hDzA</a></p>\n\n<p>Why does a type switch work on everything except an error?</p>\n"}, {"tags": ["postgresql", "api", "go"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1557637488, "post_id": 56096298, "comment_id": 98828346, "body": "Could you provide a more clear example of your schema, please?"}, {"owner": {"reputation": 434877, "user_id": 330315, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4b152262d9ba55197f609625358ff7e0?s=128&d=identicon&r=PG", "display_name": "a_horse_with_no_name", "link": "https://stackoverflow.com/users/330315/a-horse-with-no-name"}, "edited": false, "score": 0, "creation_date": 1557638648, "post_id": 56096298, "comment_id": 98828472, "body": "You can get the information which type it is with a single query. But it&#39;s not possible to include all columns from all descendant tables with that query. To get the other columns, you need to query the other tables."}], "owner": {"reputation": 761, "user_id": 1122249, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/c722c9bf26818067b037a9f279206df0?s=128&d=identicon&r=PG", "display_name": "Byrd", "link": "https://stackoverflow.com/users/1122249/byrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557636453, "creation_date": 1557636453, "question_id": 56096298, "link": "https://stackoverflow.com/questions/56096298/how-to-query-a-parent-table-and-inherited-child-table-together-in-one-query", "title": "How to query a parent table and inherited child table together in one query", "body": "<p>I am using go and pq to interface with my postgres database. </p>\n\n<p>I have a simple user table which has basic fields. Id, name, type. My auxillary table, admin inherits from user and adds it's own field <code>panel</code>, and another one that is owner and adds <code>owner</code>. Whether that be using table inheritance, or a supporting table. </p>\n\n<p>My question is if I hit and endpoint that points to <code>user/1</code> at this point I don't know what type of user this person is yet here. I know we can use jwts and other ways to provide this from the front end. I'm more curious about if there is a way to figure out the user and it's type and query the additional fields in one query?</p>\n\n<p>Ie. I hit the endpoint I would Select from users, get the type, then use that type to get the additional fields. So I would effectively be doing two queries on two tables to get the complete data. Is there a better solution of doing this? Is there some optimizations I could do. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1557657239, "post_id": 56095600, "comment_id": 98831756, "body": "When you comment the done channel, it lets the function ExempleNewWatcher finish, thus the call to watcher.Close that was deferred is called. Thus the watcher is closed, thus no events."}, {"owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557708985, "post_id": 56095600, "comment_id": 98843510, "body": "@mh-cbon that right answer. thks"}, {"owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557709078, "post_id": 56095600, "comment_id": 98843524, "body": "@mh-cbon can I post you comment as answer?"}], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 660, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557657187, "creation_date": 1557625433, "last_edit_date": 1557657187, "question_id": 56095600, "link": "https://stackoverflow.com/questions/56095600/go-use-fsnotify-watch-file-ischanged-not-working", "title": "go use fsnotify watch file ischanged not working", "body": "<p>I use the library (<a href=\"http://github.com/fsnotify/fsnotify\" rel=\"nofollow noreferrer\">http://github.com/fsnotify/fsnotify</a>) to monitor the file system.</p>\n\n<p>I m trying to adjust the repository example to match my requirements, but when i do so the program is not working anymore.</p>\n\n<p>I commented the done channel within the ExampleNewWatcher function</p>\n\n<pre><code>done := make(chan bool)\n&lt;-done\n</code></pre>\n\n<p>As a result, now when i run the example, this channel does not output anything anymore.</p>\n\n<pre><code>event, ok := &lt;-watcher.Events\n</code></pre>\n\n<p>Complete code\uff1a</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/fsnotify/fsnotify\"\n    \"log\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc ExampleNewWatcher() {\n    watcher, err := fsnotify.NewWatcher()\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer watcher.Close()\n\n    done := make(chan bool) // if i commen this line the `panic` not norking\n    go func() {\n        for {\n            select {\n            case event, ok := &lt;-watcher.Events:\n                if !ok {\n                    return\n                }\n                log.Println(\"event:\", event)\n                if event.Op&amp;fsnotify.Write == fsnotify.Write {\n                    log.Println(\"modified file:\", event.Name)\n                }\n                panic(\"just for test\") // new output this line\n\n            case err, ok := &lt;-watcher.Errors:\n                if !ok {\n                    return\n                }\n                log.Println(\"error:\", err)\n            }\n        }\n    }()\n\n    err = watcher.Add(\"/tmp/foo\")\n    if err != nil {\n        log.Fatal(err)\n    }\n   &lt;-done // comment this\n}\n\nfunc check(err error) {\n    if err != nil {\n        panic(err)\n    }\n\n}\nfunc main() {\n    // create the test file\n    var err error\n    file, err := os.Create(\"/tmp/foo\")\n    check(err)\n\n    _, err = file.Write([]byte(\"hello world\"))\n    check(err)\n\n    stopchan := make(chan struct{})\n\n    // test change file\n    go func() {\n\n        for i := 0; i &lt; 10; i++ {\n            file1, err := os.OpenFile(\"/tmp/foo\", os.O_RDWR, 0644)\n            check(err)\n            d := strconv.Itoa(i) + \"hello world\"\n            _, err = file1.Write([]byte(d))\n            check(err)\n            err = file1.Close()\n            check(err)\n            time.Sleep(2 * time.Second) // wait the context  writed to the file\n        }\n\n    }()\n\n    ExampleNewWatcher() // monitor file\n\n    stopchan &lt;- struct{}{}\n}\n\n</code></pre>\n"}, {"tags": ["go", "logging", "types"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1557618128, "post_id": 56094863, "comment_id": 98826169, "body": "I think you should be able to do it with a <code>Writer</code> without using the pipe and the goroutine. You&#39;ll have to collect whatever you get in the <code>Write</code> method until you see a newline, and then call the function with the entire line."}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1557620622, "creation_date": 1557620622, "answer_id": 56095270, "question_id": 56094863, "link": "https://stackoverflow.com/questions/56094863/replacement-for-os-file-of-go-default-log/56095270#56095270", "title": "Replacement for *os.File of Go default log", "body": "<p>How about something like this:</p>\n\n<pre><code>type myLogWriter struct {\n    logFunc func(string)\n    line    string\n}\n\nfunc (w *myLogWriter) Write(b []byte) (int, error) {\n    l := len(b)\n    for len(b) != 0 {\n        i := bytes.Index(b, []byte{'\\n'})\n        if i == -1 {\n            w.line += string(b)\n            break\n        } else {\n            w.logFunc(w.line + string(b[:i]))\n            b = b[i+1:]\n            w.line = \"\"\n        }\n    }\n\n    return l, nil\n}\n\nfunc NewLogWriter(f func(string)) *myLogWriter {\n    return &amp;myLogWriter{\n        logFunc: f,\n    }\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/L6PG1gCK1er\" rel=\"nofollow noreferrer\">https://play.golang.org/p/L6PG1gCK1er</a>.</p>\n"}], "owner": {"reputation": 693, "user_id": 3990434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/JMTJk.jpg?s=128&g=1", "display_name": "Gon", "link": "https://stackoverflow.com/users/3990434/gon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56095270, "answer_count": 1, "score": 0, "last_activity_date": 1557620622, "creation_date": 1557615104, "last_edit_date": 1557616157, "question_id": 56094863, "link": "https://stackoverflow.com/questions/56094863/replacement-for-os-file-of-go-default-log", "title": "Replacement for *os.File of Go default log", "body": "<p>I'm trying to write a wrapper for Go's built-in logger.\nThis is to have compatibility. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nvar(\n    mylog *log.Logger\n)\n\nfunc main() {\n    mylog = log.New(os.Stdout, \"\", 0)\n    mylog.Printf(\"test\")\n}\n</code></pre>\n\n<p>Instead of using <strong>os.Stdout</strong>, I want to create one something. Similar to <strong>os.Stdout</strong> but prints with prefix like below.</p>\n\n<pre><code>package main\n\nimport( \n    \"log\"\n    \"mylibrary\"\n)\n\nvar(\n    mylog *log.Logger\n)\n\nfunc main() {\n    mylog = log.New(mylibrary.Prefix, \"\", 0)\n    mylog.Printf(\"test\")\n}\n</code></pre>\n\n<p>Basically, I still want to have <strong>*log.Logger</strong> while having custom log. Can someone give me a hint how I can make this works?</p>\n\n<p>Currently, I'm using following to do that. But I bet there's a better way.</p>\n\n<pre><code>func NewIoWriter(f func(string)) *io.PipeWriter {\n    r, w := io.Pipe()\n    go func() {\n        scanner := bufio.NewScanner(r)\n        for scanner.Scan() {\n            f(scanner.Text())\n        }\n        if err := scanner.Err(); err != nil {\n            f(err.Error())\n        }\n        r.Close()\n    }()\n    runtime.SetFinalizer(w, (*io.PipeWriter).Close)\n    return w\n}\n</code></pre>\n\n<p>What would be the better way to make it work?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 12494, "user_id": 1402929, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IORgE.jpg?s=128&g=1", "display_name": "Matt Harrison", "link": "https://stackoverflow.com/users/1402929/matt-harrison"}, "edited": false, "score": 0, "creation_date": 1557610622, "post_id": 56093913, "comment_id": 98824919, "body": "It may be helpful to show what your data looks like in the <code>houses</code> collection. What if you set <code>filter</code> parameter to <code>nil</code> instead of <code>&amp;house</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 1, "last_activity_date": 1557680616, "creation_date": 1557680616, "answer_id": 56101512, "question_id": 56093913, "link": "https://stackoverflow.com/questions/56093913/how-to-get-the-distinct-value-of-a-collection/56101512#56101512", "title": "How to get the distinct value of a collection", "body": "<p>Replace the line </p>\n\n<pre><code>fmt.Println(collection.Distinct(ctx, \"City\", &amp;house))\n</code></pre>\n\n<p>With</p>\n\n<pre><code>fmt.Println(collection.Distinct(ctx, \"City\", bson.D{{}}))\n</code></pre>\n\n<p>The third parameter, filter, is a BSON document, <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/mongo#Collection.Distinct\" rel=\"nofollow noreferrer\">https://godoc.org/go.mongodb.org/mongo-driver/mongo#Collection.Distinct</a>.  Note that <code>Distinct()</code> returns two values, <code>([]interface, error)</code>.</p>\n"}], "owner": {"reputation": 2468, "user_id": 3672883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bOBrL.png?s=128&g=1", "display_name": "Tlaloc-ES", "link": "https://stackoverflow.com/users/3672883/tlaloc-es"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 56101512, "answer_count": 1, "score": 0, "last_activity_date": 1557680616, "creation_date": 1557605506, "last_edit_date": 1557650205, "question_id": 56093913, "link": "https://stackoverflow.com/questions/56093913/how-to-get-the-distinct-value-of-a-collection", "title": "How to get the distinct value of a collection", "body": "<p>I am trying the use of mongodb and Go and I cannot get the distinct values of the field in a collection.</p>\n\n<p>This is my code:</p>\n\n<pre><code>import (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n\n    \"go.mongodb.org/mongo-driver/mongo\"\n    \"go.mongodb.org/mongo-driver/mongo/options\"\n)\n\n\ntype House struct {\n    Ciudad string\n}\n\n\nfunc main() {\n\n    client, err := mongo.NewClient(options.Client().ApplyURI(\"mongodb://localhost:27017\"))\n    if err != nil {\n        log.Fatal(err)\n    }\n    ctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\n    err = client.Connect(ctx)\n\n    collection := client.Database(\"test\").Collection(\"houses\")\n\n    var house repository.House\n\n    fmt.Println(collection.Distinct(ctx, \"City\", &amp;house))\n\n}\n</code></pre>\n\n<p>After execute this always I am geting an empty array. Any idea that is wrong in this code?</p>\n"}, {"tags": ["go", "methods", "slice"], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 9579768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alexfwulf", "link": "https://stackoverflow.com/users/9579768/alexfwulf"}, "edited": false, "score": 0, "creation_date": 1557605180, "post_id": 56093767, "comment_id": 98823688, "body": "Thank you! This solved my problem. Forgot about the possibility to make other types than struct."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1557619449, "last_edit_date": 1557619449, "creation_date": 1557604230, "answer_id": 56093767, "question_id": 56093650, "link": "https://stackoverflow.com/questions/56093650/method-on-slice/56093767#56093767", "title": "Method on slice", "body": "<p>Declare the type as a slice:</p>\n\n<pre><code>//Minis is a slice of all Minis\ntype Minis []*Mini\n\n//Append adds a new Mini to the Minis slice\nfunc (m *Minis) Append(n *Mini) {\n    *m = append(*m, n)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/UhhqgMLhgEQ\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p><code>concat</code> panics because <code>QForename</code> passes a nil slice pointer as the receiver to <code>concat</code>.  Fix by using a non-nil pointer:</p>\n\n<pre><code>func (m *Minis) QForename(q string) *Minis {\n    var matches Minis\n    for _, n := range *m {\n        if n.Forename == q {\n            matches.concat(n)\n        }\n    }\n    return &amp;matches\n}\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 9579768, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alexfwulf", "link": "https://stackoverflow.com/users/9579768/alexfwulf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 56093767, "answer_count": 1, "score": 1, "last_activity_date": 1557660261, "creation_date": 1557603319, "last_edit_date": 1557660261, "question_id": 56093650, "link": "https://stackoverflow.com/questions/56093650/method-on-slice", "title": "Method on slice", "body": "<p>Although I think the problem I have is not correctly described in the heading it is the only way I am able to describe it now. </p>\n\n<p>I have a struct <code>Mini</code> which is defined in another file. A set of Minis should be described as a slice. As I want to change some fields of the <code>Mini</code> struct when it is appended to the slice custom functions for append are needed. </p>\n\n<p>Until now I got the following code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"fmt\"\n    \"reflect\"\n)\n\n//Minis is a slice of all Minis\ntype Minis struct {\n    AllMinis []*Mini\n}\n\n//Append adds a new Mini to the Minis slice\nfunc (m *Minis) Append(n *Mini) {\n    m.AllMinis = append(m.AllMinis, n)\n}\n</code></pre>\n\n<p>This code works totally fine.\nBut in my opinion a struct with just one field is kind of witless.</p>\n\n<p>Is there any way to make a method on a struct or a more elegant solution in general?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["javascript", "reactjs", "go", "fetch", "mux"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557605663, "post_id": 56093629, "comment_id": 98823822, "body": "Do you see the error on the POST request or on the OPTIONS request that precedes it? The OPTIONS request won&#39;t contain a body (as expected)."}, {"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557607469, "post_id": 56093629, "comment_id": 98824239, "body": "@Peter I&#39;m not seeing any errors on the POST request, the browser is not catching any errors and returns &quot;Success&quot;, the only error I see is the one returned by the server on the console which reads &quot;no such file&quot;"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1557657558, "post_id": 56093629, "comment_id": 98831832, "body": "you can try to dump the request object on the server side to inspect it <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequest\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/httputil/#DumpRequest</a>"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "edited": false, "score": 0, "creation_date": 1557684192, "post_id": 56094523, "comment_id": 98838598, "body": "I&#39;ve tried the latter, I&#39;ve made sure the file exists on the client before sending it, and I&#39;ve checked to see if there is an error at r.ParseMultipartForm. Still no luck, there are no errors at the r.ParseMultipartForm either. Thanks for the insight anyway"}, {"owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "edited": false, "score": 0, "creation_date": 1558400123, "post_id": 56094523, "comment_id": 99079457, "body": "Holy crap that was the solution"}], "tags": [], "owner": {"reputation": 409, "user_id": 4476357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lkPLG1GYS_Q/AAAAAAAAAAI/AAAAAAAAABg/gCmW6uoXgTk/photo.jpg?sz=128", "display_name": "cperez08", "link": "https://stackoverflow.com/users/4476357/cperez08"}, "is_accepted": false, "score": 0, "last_activity_date": 1557612531, "last_edit_date": 1557612531, "creation_date": 1557611311, "answer_id": 56094523, "question_id": 56093629, "link": "https://stackoverflow.com/questions/56093629/failing-to-send-image-to-go-server/56094523#56094523", "title": "Failing to send image to Go server", "body": "<p>Checking the code, this is a pretty standard upload file method, is your Go api working with other services?, I can not find anything wrong, so maybe is more about how the api is configured in general. </p>\n\n<p>Other thing you can do is handling the error at </p>\n\n<pre><code>if err := r.ParseMultipartForm(32 &lt;&lt; 20); err != nil {\nfmt.Println(err)\n}\n\n</code></pre>\n\n<p>maybe you can have a better idea about the error</p>\n\n<p>Also make sure your file is really there before appending it</p>\n\n<pre><code>console.log(e.target.files)\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 9743949, "user_type": "registered", "profile_image": "https://graph.facebook.com/1608305185933373/picture?type=large", "display_name": "Sasank Ganapathiraju", "link": "https://stackoverflow.com/users/9743949/sasank-ganapathiraju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557612531, "creation_date": 1557603135, "question_id": 56093629, "link": "https://stackoverflow.com/questions/56093629/failing-to-send-image-to-go-server", "title": "Failing to send image to Go server", "body": "<p>Recently I started working with Go to make servers, in my current experiment I am trying to upload an image to my Go/mux webserver via fetch on a React.js front-end. Whenever I upload an image through a form the server fails to receive the image and returns a \"no such file\" error. I am using JS's FormData API to store and send the image.</p>\n\n<p>Here is the code for the client</p>\n\n<pre><code>handleInput = (e) =&gt; {\n    let formData = new FormData();\n    formData.append(\"myImage\", e.target.files)\n    fetch(\"http://localhost:8080/api\", {\n      method: 'POST',\n      body: formData,\n    })\n    .then((res) =&gt; {\n       console.log(res)\n    })\n    .then(() =&gt; {\n       console.log(\"Success\")\n      })\n    .catch((error) =&gt; console.error(error))\n  }\n</code></pre>\n\n<p>Here is the code for the server</p>\n\n<pre><code>func api(w http.ResponseWriter, r *http.Request) {\n\n    w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n\n    fmt.Println(\"Connected -&gt; api route\")\n    fmt.Fprintf(w, \"connected to api\")\n\n    // ERROR HERE: no such file / failed to retrieve image\n    r.ParseMultipartForm(32 &lt;&lt; 20)\n    file, _, err := r.FormFile(\"myImage\")\n    if err != nil {\n        log.Print(err)\n        fmt.Println(\"failed to retrieve image\")\n        w.WriteHeader(http.StatusBadRequest)\n        return\n    } else if err == nil {\n        fmt.Println(\"Success\")\n    }\n\n    defer file.Close()\n}\n</code></pre>\n\n<p>I have tried adding and removing the multipart/form-data headers, neither have worked.</p>\n\n<p>I'm new to Go and still trying to figure things out, any help is appreciated!</p>\n"}, {"tags": ["go", "artificial-intelligence", "monte-carlo-tree-search"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5708127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276cdeeed53ef0317aaa3d3b59774f93?s=128&d=identicon&r=PG&f=1", "display_name": "Underflow", "link": "https://stackoverflow.com/users/5708127/underflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1557626435, "creation_date": 1557626435, "answer_id": 56095655, "question_id": 56093505, "link": "https://stackoverflow.com/questions/56093505/how-do-i-get-the-following-golang-mcts-example-running/56095655#56095655", "title": "How do I get the following Golang MCTS example running?", "body": "<p>The source code indicates, \"use chosenAction further\". One of the issues that you will encounter just following the Read me, is that a variable is left unused. </p>\n\n<p>Solutions to prevent the error generated as a result can be found here: <a href=\"https://stackoverflow.com/questions/21743841/how-to-avoid-annoying-error-declared-and-not-used#21744129\">How to avoid annoying error &quot;declared and not used&quot;</a></p>\n\n<p>In summary, there is no bug in the code, just an incomplete example.</p>\n"}], "owner": {"reputation": 41, "user_id": 5708127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/276cdeeed53ef0317aaa3d3b59774f93?s=128&d=identicon&r=PG&f=1", "display_name": "Underflow", "link": "https://stackoverflow.com/users/5708127/underflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557626435, "creation_date": 1557602036, "last_edit_date": 1557604648, "question_id": 56093505, "link": "https://stackoverflow.com/questions/56093505/how-do-i-get-the-following-golang-mcts-example-running", "title": "How do I get the following Golang MCTS example running?", "body": "<p>I am trying to grasp the flow of this implementation and figure out how to run this MCTS implementation: <a href=\"https://github.com/int8/gomcts/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/int8/gomcts/blob/master/README.md</a>. </p>\n\n<p>Steps taken: I have followed the Readme but it errors out. I posted an issue on the Github repository but I have received no response. I have skimmed the Golang documentation but nothing jumps out to me.</p>\n\n<p>Can anyone jumpstart me so I can get the code started and slowly work out the program flow with console print outs?</p>\n\n<p>Some background on me: My knowledge of Golang is new, and programming experience is just blossoming as of late. I have some Python experience and JavaScript experience. </p>\n\n<p>Thanks for your time! I will add more as I research and if I can eventually generalize this question to help others I will.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557602598, "post_id": 56093460, "comment_id": 98823100, "body": "The file may be rewritten every few minutes, but your node app doesn&#39;t reload it on change, does it?"}, {"owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557604352, "post_id": 56093460, "comment_id": 98823491, "body": "Yes it does, once its downloaded from scheduled job after interval, a timer runs in the node app which refresh the file. I use this. <code>delete require.cache[require.resolve(&quot;.&#47;config&#47;key_values.js&quot;)];</code> though this is not the concern for go implementation, I may restart the app itself to reload the config if required."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1557605878, "post_id": 56093460, "comment_id": 98823850, "body": "This question is too broad. There are plenty of configuration formats to chose from (json, yaml, toml, ini, etc.) Recommendations would be opinion based. Pick one and come back with a specific question if you&#39;re having trouble."}, {"owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "edited": false, "score": 0, "creation_date": 1557607148, "post_id": 56093460, "comment_id": 98824163, "body": "I did included a sample json config in question and need to know how can I reuse it though with some obvious change. yaml will do as well, just to make sure it works in the same way."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1557612879, "post_id": 56093460, "comment_id": 98825292, "body": "There&#39;s really not enough detail to go on here. Where are you storing t he config? What system has to read it? What <i>&quot;things&quot;</i> will be part of the config? If you&#39;re setting the port your service is supposed to listen on, reloading that isn&#39;t the biggest of your worries. If your service is HA, on multiple zones/nodes, then you might want to use a K/V store, and updates can be handled in a lot of ways, if it&#39;s a config file, you can use fsnotify, or reuse existing things like cobra etc..."}, {"owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "edited": false, "score": 0, "creation_date": 1557617294, "post_id": 56093460, "comment_id": 98826032, "body": "I am converting my node js app to go. So following the same structure will be keeping the both config file and file containing dynamic K/V pair in same config folder. The config will have all the static variable that may change/increase. like storing port, log level, static api url, timeout value, some flag to enable disable logging etc. and the key value file contains the data which will change every few minute hence to put that in different file.and app will just read/refresh(not sure how its done in go, have commented how i did it in node)."}, {"owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "edited": false, "score": 0, "creation_date": 1557617576, "post_id": 56093460, "comment_id": 98826073, "body": "Also the file containing key/value pair generated from the db and downloaded with scheduled job as commented. The basic idea of this 2 file is just config is for app level to which only I (developer) has access and file with K/V is generated say from admin perspective who is using some interface to put some config in db and loaded in the file to be used in app and he can anytime to change that and app should read that after few min of refreshing without changing anything or restarting the app."}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "is_accepted": false, "score": 0, "last_activity_date": 1557736114, "creation_date": 1557736114, "answer_id": 56108435, "question_id": 56093460, "link": "https://stackoverflow.com/questions/56093460/how-to-read-config-key-value-pair-from-file-in-go/56108435#56108435", "title": "How to read config Key/Value pair from file in Go?", "body": "<p>OK. So here is what I have done for now.\nconfig/index.js is now config/config.json with content</p>\n\n<pre><code>{\n    \"app\":{\"port\":9000},\n    \"log\":{\"level\":\"error\"}\n}\n</code></pre>\n\n<p>and  config/key_values.js is  config/key_values.json</p>\n\n<pre><code>{\n    \"key1\":\"value1\",\n    \"key2\":\"value2\"\n}\n</code></pre>\n\n<p>And to read this value I am just reading file as <code>[]byte</code> and passing the this to <code>function GetBytes</code> of library  <a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">gjson</a></p>\n\n<p>So the final code look like this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    configFile, err := os.Open(\"config/config.json\")\n    byteValue, _ := ioutil.ReadAll(configFile)\n    result := gjson.GetBytes(byteValue, \"app.port\")\n    fmt.Println(result) //prints 9000\n</code></pre>\n\n<p>And same for key values file.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    configFile, err := os.Open(\"config/key_values.json\")\n    byteValue, _ := ioutil.ReadAll(configFile)\n    result := gjson.GetBytes(byteValue, \"key1\")\n    fmt.Println(result) //prints value1\n</code></pre>\n\n<p>Also tried using struct before to parse config as described <a href=\"https://www.thepolyglotdeveloper.com/2017/04/load-json-configuration-file-golang-application/\" rel=\"nofollow noreferrer\">here</a>. But this gjson library seems to be what I was searching.</p>\n"}], "owner": {"reputation": 85, "user_id": 3677365, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/646dc01711bbd0d0fb7c2658d136b426?s=128&d=identicon&r=PG&f=1", "display_name": "user3677365", "link": "https://stackoverflow.com/users/3677365/user3677365"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 508, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557736114, "creation_date": 1557601666, "question_id": 56093460, "link": "https://stackoverflow.com/questions/56093460/how-to-read-config-key-value-pair-from-file-in-go", "title": "How to read config Key/Value pair from file in Go?", "body": "<p>I have a low latency app in Node.js from which I am coding a new baseline in Go.</p>\n\n<p>The app in node uses config and some key/value pairs.</p>\n\n<p>In config/index.js</p>\n\n<pre><code>var config = {};\nconfig.app = {\n    port:9000\n};\nconfig.log= {\n    level:\"error\"\n}\nmodule.exports=config;\n</code></pre>\n\n<p>And another file config/key_values.js which contains key/value pair and is refreshed every few minutes.</p>\n\n<pre><code>module.exports.key_values= {\n\"key1\":\"value1\",\n\"key2\":\"value2\",\n}\n</code></pre>\n\n<p>And to read this I just use the below code.</p>\n\n<pre><code>let config = require('./config/index');\nlet keys_vals = require('./config/key_values.js');\n\nconsole.log('port', config.app.port); //port 9000\nconsole.log('key1 data --&gt;', keys_vals.key_values['key1']); //key1 data --&gt; value1 \n</code></pre>\n\n<p>How can I achieve the same thing in go. I have checked <a href=\"https://github.com/tkanos/gonfig\" rel=\"nofollow noreferrer\">Gonfig</a> for config implementation as well as building structs.</p>\n\n<p>What should be better/best way to achieve the same functionalities as I do in Node?</p>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 1, "last_activity_date": 1557681107, "creation_date": 1557681107, "answer_id": 56101576, "question_id": 56093377, "link": "https://stackoverflow.com/questions/56093377/how-do-i-compact-a-monogdb-collection-using-go/56101576#56101576", "title": "How do I compact a monogdb collection using go?", "body": "<p>Use <code>Database.Run()</code>, <a href=\"https://godoc.org/github.com/globalsign/mgo#Database.Run\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/globalsign/mgo#Database.Run</a>.  Command <code>compact</code> is an administration command, <a href=\"https://docs.mongodb.com/manual/reference/command/compact/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/reference/command/compact/</a>.</p>\n"}], "owner": {"reputation": 1328, "user_id": 2350244, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5ae605c8746c51053107439fcc237?s=128&d=identicon&r=PG", "display_name": "Ehsan Iran-Nejad", "link": "https://stackoverflow.com/users/2350244/ehsan-iran-nejad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56101576, "answer_count": 1, "score": 0, "last_activity_date": 1557681107, "creation_date": 1557600962, "question_id": 56093377, "link": "https://stackoverflow.com/questions/56093377/how-do-i-compact-a-monogdb-collection-using-go", "title": "How do I compact a monogdb collection using go?", "body": "<p>I want to run a compact operation in MongoDB over a collection but don't know which driver supports this feature and how to perform the operation. Currently using <a href=\"https://github.com/globalsign/mgo\" rel=\"nofollow noreferrer\">https://github.com/globalsign/mgo</a> and do not see the compact option in its API.</p>\n"}, {"tags": ["go", "go-modules"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557594666, "post_id": 56091744, "comment_id": 98821252, "body": "Your module is <code>github.com&#47;pocockn&#47;models</code> but you initialized it only as <code>models</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1388, "user_id": 9609198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dc96575acd1296cba81df24ffd919d4?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Bui-Palsulich", "link": "https://stackoverflow.com/users/9609198/tyler-bui-palsulich"}, "is_accepted": true, "score": 5, "last_activity_date": 1559129171, "creation_date": 1559129171, "answer_id": 56359508, "question_id": 56091744, "link": "https://stackoverflow.com/questions/56091744/unexpected-module-path-go-modules/56359508#56359508", "title": "Unexpected module path go-modules", "body": "<p>Your module name in your <code>go.mod</code> should be <code>github.com/pocockn/models</code>, matching the repo path. It could also be a custom domain/path, assuming that domain either has the code hosted or the correct headers to redirect to your repo (using something like <a href=\"https://github.com/GoogleCloudPlatform/govanityurls\" rel=\"noreferrer\">https://github.com/GoogleCloudPlatform/govanityurls</a>).</p>\n\n<p>(Looks like you may have already done this. Answering here if others find this question.)</p>\n"}], "owner": {"reputation": 1470, "user_id": 3913746, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/c2d9ec6f6da29d8e0b3b22fe37dec448?s=128&d=identicon&r=PG&f=1", "display_name": "pocockn", "link": "https://stackoverflow.com/users/3913746/pocockn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2073, "favorite_count": 0, "accepted_answer_id": 56359508, "answer_count": 1, "score": 3, "last_activity_date": 1559129171, "creation_date": 1557588652, "question_id": 56091744, "link": "https://stackoverflow.com/questions/56091744/unexpected-module-path-go-modules", "title": "Unexpected module path go-modules", "body": "<p>I have a repo on Github which just holds some Go structs to be used as models throughout my services.</p>\n\n<p><a href=\"https://github.com/pocockn/models\" rel=\"nofollow noreferrer\">https://github.com/pocockn/models</a></p>\n\n<p>I then want to import this into my services, I am using Go Modules in both repos. When I run 'go get' in my service I get the following error.</p>\n\n<blockquote>\n  <p>go: finding github.com/pocockn/models/api/football latestgo: finding\n  github.com/pocockn/models/api latest go: finding\n  github.com/pocockn/models latest go:\n  github.com/pocockn/models@v0.0.0-20190511152220-d7675ec24338: parsing\n  go.mod: unexpected module path \"models\"</p>\n</blockquote>\n\n<p>My go.mod file in the models repo looks like this</p>\n\n<pre><code>module models\n\ngo 1.12\n\nrequire github.com/jinzhu/gorm v1.9.8\n</code></pre>\n"}, {"tags": ["string", "go", "types", "go-templates"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557588082, "post_id": 56091265, "comment_id": 98819620, "body": "What is <code>.Type</code> you want to test? Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 3903, "user_id": 6219957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fd612eb43ad1f536395189695efa4d7b?s=128&d=identicon&r=PG&f=1", "display_name": "Siya", "link": "https://stackoverflow.com/users/6219957/siya"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557588564, "post_id": 56091265, "comment_id": 98819740, "body": "That is not important because <code>Type</code> in this sample is simply a value."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557588685, "post_id": 56091265, "comment_id": 98819770, "body": "It&#39;s important because judging by its name, it looks you store the type as something like <code>reflect.Type</code>, which would change how to achieve what you want."}], "answers": [{"comments": [{"owner": {"reputation": 3903, "user_id": 6219957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fd612eb43ad1f536395189695efa4d7b?s=128&d=identicon&r=PG&f=1", "display_name": "Siya", "link": "https://stackoverflow.com/users/6219957/siya"}, "edited": false, "score": 0, "creation_date": 1557638783, "post_id": 56091741, "comment_id": 98828490, "body": "Where do I register this function? I am writing a go template that I pass to this package <a href=\"https://gnorm.org\" rel=\"nofollow noreferrer\">gnorm.org</a>. So it is not very clear to me where I would add this code so that I may be able to use it in the template that I have referenced above."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 3903, "user_id": 6219957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fd612eb43ad1f536395189695efa4d7b?s=128&d=identicon&r=PG&f=1", "display_name": "Siya", "link": "https://stackoverflow.com/users/6219957/siya"}, "edited": false, "score": 0, "creation_date": 1557655597, "post_id": 56091741, "comment_id": 98831327, "body": "@brandNew Custom functions must be registered prior to parsing the template text, because the template engine needs to be able to statically analyze the template, and it needs to know prior which literals designate valid custom functions. If you don&#39;t have access to the template to do this, use the 2nd approach (with the <code>printf</code> function) which doesn&#39;t require registering custom functions. For details, see <a href=\"https://stackoverflow.com/questions/38586651/using-custom-func-in-go-condition-template/38587070#38587070\">Using custom func in Go condition template</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1557593267, "last_edit_date": 1557593267, "creation_date": 1557588649, "answer_id": 56091741, "question_id": 56091265, "link": "https://stackoverflow.com/questions/56091265/how-to-test-if-a-value-is-a-string-in-a-template/56091741#56091741", "title": "How to test if a value is a string in a template", "body": "<h2>With a custom function</h2>\n\n<p>There is no predeclared <code>IsString()</code> function available in templates, but we may easily register and use such a function:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n    \"IsString\": func(i interface{}) bool {\n        _, ok := i.(string)\n        return ok\n    },\n}).Parse(`{{.}} {{if IsString .}}is a string{{else}}is not a string{{end}}`))\nfmt.Println(t.Execute(os.Stdout, \"hi\"))\nfmt.Println(t.Execute(os.Stdout, 23))\n</code></pre>\n\n<p>This will output (try it on the <a href=\"https://play.golang.org/p/j9KvOREyx5U\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>hi is a string&lt;nil&gt;\n23 is not a string&lt;nil&gt;\n</code></pre>\n\n<p>(The <code>&lt;nil&gt;</code> literals at the end of lines are the error values returned by the template execution, telling there were no errors.)</p>\n\n<h2>Using <code>printf</code> and <code>%T</code> verb</h2>\n\n<p>We may also do this without custom functions. There is a <a href=\"https://golang.org/pkg/text/template/#hdr-Functions\" rel=\"nofollow noreferrer\"><code>printf</code></a> function available by default, which is an alias for <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf()</code></a>. And there is a <code>%T</code> verb which outputs the argument's type.</p>\n\n<p>The idea is to call <code>printf %T</code> on the value, and compare the result with <code>\"string\"</code>, and we're done:</p>\n\n<pre><code>t := template.Must(template.New(\"\").\n    Parse(`{{.}} {{if eq \"string\" (printf \"%T\" .)}}is a string{{else}}is not a string{{end}}`))\nfmt.Println(t.Execute(os.Stdout, \"hi\"))\nfmt.Println(t.Execute(os.Stdout, 23))\n</code></pre>\n\n<p>This will also output (try it on the <a href=\"https://play.golang.org/p/8U1yZDfMR6h\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>hi is a string&lt;nil&gt;\n23 is not a string&lt;nil&gt;\n</code></pre>\n"}], "owner": {"reputation": 3903, "user_id": 6219957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/fd612eb43ad1f536395189695efa4d7b?s=128&d=identicon&r=PG&f=1", "display_name": "Siya", "link": "https://stackoverflow.com/users/6219957/siya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 942, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557635373, "creation_date": 1557585190, "last_edit_date": 1557635373, "question_id": 56091265, "link": "https://stackoverflow.com/questions/56091265/how-to-test-if-a-value-is-a-string-in-a-template", "title": "How to test if a value is a string in a template", "body": "<p>I would like to find out if it is possible and if so how, to test if a value is a string in a Go template.</p>\n\n<p>I have tried the following with no success</p>\n\n<pre><code>{{- range .Table.PrimaryKeys.DBNames.Sorted }}{{ with (index $colsByName .)}}\n{{ .Name }}: {{ if .IsArray }}[]{{ end }}'{{.Type}}', {{end}}\n{{- end }}\n{{- range $nonPKDBNames }}{{ with (index $colsByName .) }}\n    {{ .Name }}: {{ if .IsArray }}[]{{end -}} {\n  type: {{ if .Type IsString}}GraphQLString{{end -}}, # line of interest where Type is a value that could be a number, string or an array\n}, {{end}}\n{{- end }}\n</code></pre>\n\n<p>And this is the error that I get</p>\n\n<blockquote>\n  <p>Error: error parsing TablePaths: error parsing contents template: template: templates/table.gotmpl:42: function \"IsString\" not defined</p>\n</blockquote>\n"}, {"tags": ["go", "orm"], "owner": {"reputation": 226, "user_id": 5131438, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XViWv8_F13Q/AAAAAAAAAAI/AAAAAAAAEsI/7at09k4TT1c/photo.jpg?sz=128", "display_name": "mousi", "link": "https://stackoverflow.com/users/5131438/mousi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 143, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557585130, "creation_date": 1557585130, "question_id": 56091257, "link": "https://stackoverflow.com/questions/56091257/sqlboiler-define-relations", "title": "Sqlboiler define relations", "body": "<p>I have a sqlite database for which I need read only access in go. I have been exploring sqlboiler as an ORM and it's been great so far generating the models etc but 1 thing I was not able to figure out is how to define custom relations. I know that it does this automatically when the db has foreign keys etc but my db doesn't and I can't change its structure (it's written by another application). So I have a structure like this:</p>\n\n<p>books:    </p>\n\n<pre><code>id  |  title\n1   | Sample title\n</code></pre>\n\n<p>authors:</p>\n\n<pre><code>id | name\n1  | Author Name\n</code></pre>\n\n<p>book_authors:</p>\n\n<pre><code>book_id | author_id\n1       | 1\n</code></pre>\n\n<p>I think it's fairly obvious what I want to do, this is a many to many relation between books and authors. The problem is that book_id and author_id are not foreign keys. Is there any way I can configure the code generation inside the toml file to create this relation or will I have to write code manually to do that? Thanks</p>\n"}, {"tags": ["go", "hash", "hex"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1557572818, "post_id": 56089693, "comment_id": 98816126, "body": "<i>&quot;I cannot do (&quot;%x&quot;, hash) because that only works on fmt&quot;</i> I don&#39;t understand this. This works, and returns the hexa string representation: <code>fmt.Sprintf(&quot;%x&quot;, sha256.Sum256([]byte{1, 2}))</code>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1557572975, "post_id": 56089693, "comment_id": 98816153, "body": "You may also do: <code>hex.EncodeToString(hash[:])</code>, see <a href=\"https://stackoverflow.com/questions/28040896/why-can-not-convert-sizebyte-to-string-in-go/28041357#28041357\">Why can not convert &#91;Size&#93;byte to string in Go?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 1, "last_activity_date": 1557588982, "creation_date": 1557588982, "answer_id": 56091798, "question_id": 56089693, "link": "https://stackoverflow.com/questions/56089693/converting-byte-array-to-hex-format/56091798#56091798", "title": "Converting byte array to hex format", "body": "<p>I think what you are asking is \"how do I make a string of the hexadecimal representation of the byte array\"</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha256\"\n    \"fmt\"\n)\n\nfunc main() {\n    password := \"abc123\"\n    sum := sha256.Sum256([]byte(password))\n    hexstring := fmt.Sprintf(\"%x\", sum)\n    fmt.Println(hexstring)\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10464231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed6c6c2f997ddb4631bd2fe3ca9d654a?s=128&d=identicon&r=PG&f=1", "display_name": "009820", "link": "https://stackoverflow.com/users/10464231/009820"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1557588982, "creation_date": 1557572652, "question_id": 56089693, "link": "https://stackoverflow.com/questions/56089693/converting-byte-array-to-hex-format", "title": "Converting byte array to hex format", "body": "<p>I am hashing passwords using Sha256.Sum256 then I'm supposed to store the hashed password on the database, but what I get instead is a byte array instead of a hex value. I cannot do (\"%x\", hash) because that only works on fmt</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 9232011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7762191750a4d46e23ac24ffe49357?s=128&d=identicon&r=PG&f=1", "display_name": "Sergo Kurbanov", "link": "https://stackoverflow.com/users/9232011/sergo-kurbanov"}, "is_accepted": false, "score": 0, "last_activity_date": 1557942662, "creation_date": 1557942662, "answer_id": 56155081, "question_id": 56089687, "link": "https://stackoverflow.com/questions/56089687/how-to-add-private-key-to-certificate/56155081#56155081", "title": "How to add private key to certificate", "body": "<p>I found the decision: unfortunately standard Go pkcs12 library doesn't include needed function but there is version from HashiCorp <em>\"github.com/hashicorp/packer/builder/azure/pkcs12\"</em> package with needed functionality:</p>\n\n<pre><code>// Read our key created by openssl genrsa -out... or by Go \n// rsa.GenerateKey/EncryptPEMBlock...\npemKey,_ := ioutil.ReadFile(\"private.key\")\n\n// Convert pem to rsa key because it required for pkcs12.Encode\nvar rsaKey *rsa.PrivateKey\nrsaKey,_ = dogtag.PemToRSA(pemKey,\"our_private_secret\")\n\n// Get signed cert from dogtag CMS\nvar cert *x509.Certificate\ncert,_ = dogtag.GetCert(\"0xF0F05A8\")\n\n// Create combined certificate\npfx,_ := pkcs12.Encode(cert.Raw, pemKey, \"somesecret\")\n\noutFile,_ := os.Create(\"priv_plus_cert.p12\")\ndefer outFile.Close()\noutFile.Write(pfx)\n</code></pre>\n\n<p>Finally we get certificate suitable for adding to keychain or browser.</p>\n"}], "owner": {"reputation": 17, "user_id": 9232011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c7762191750a4d46e23ac24ffe49357?s=128&d=identicon&r=PG&f=1", "display_name": "Sergo Kurbanov", "link": "https://stackoverflow.com/users/9232011/sergo-kurbanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557942662, "creation_date": 1557572582, "last_edit_date": 1557572849, "question_id": 56089687, "link": "https://stackoverflow.com/questions/56089687/how-to-add-private-key-to-certificate", "title": "How to add private key to certificate", "body": "<p>I'm trying to create with Go all-in-one utility that create csr, send it, then (after approving it by security guy) get signed certificate and finally create certificate + private for adding it to browser or system.</p>\n\n<p>For now I can do all till the final cut: adding private to signed certificate. With openssl I can do it by:</p>\n\n<pre><code>openssl pkcs12 -export -out sergo.kurbanov.p12 -in sergo.kurbanov.crt -inkey sergo.kurbanov.key -name \"Sergo Kurbanov\"\n</code></pre>\n\n<p>Could anybody suggest the way how to do it in Go?</p>\n\n<p>P.S. I'm use Dogtag Certificate System</p>\n"}, {"tags": ["go", "httpserver"], "answers": [{"tags": [], "owner": {"reputation": 656, "user_id": 9947010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43ecdf86bdd8e6632ac394a5a25654a?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Mottl", "link": "https://stackoverflow.com/users/9947010/dmitry-mottl"}, "is_accepted": false, "score": -2, "last_activity_date": 1557561269, "creation_date": 1557561269, "answer_id": 56088342, "question_id": 56088332, "link": "https://stackoverflow.com/questions/56088332/net-http-server-freezes-under-ab-apachebench-heavy-load/56088342#56088342", "title": "net/http server freezes under ab (ApacheBench) heavy load", "body": "<p>Following is the explanation by Bill Neubauer:  </p>\n\n<blockquote>\n  <p>This issue is caused by the OS running out of sockets.  ab and Go are\n  cycling through socket pairs for communication faster than the OS can\n  reallocate them for reuse.</p>\n</blockquote>\n\n<p>Refer to <a href=\"https://github.com/golang/go/issues/66#issuecomment-66047858\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/66#issuecomment-66047858</a></p>\n"}], "owner": {"reputation": 656, "user_id": 9947010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f43ecdf86bdd8e6632ac394a5a25654a?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry Mottl", "link": "https://stackoverflow.com/users/9947010/dmitry-mottl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1557563086, "creation_date": 1557561117, "last_edit_date": 1557563086, "question_id": 56088332, "link": "https://stackoverflow.com/questions/56088332/net-http-server-freezes-under-ab-apachebench-heavy-load", "title": "net/http server freezes under ab (ApacheBench) heavy load", "body": "<p>Golang <code>net/http</code> server on MacOS freezes after 16000 requests:</p>\n\n<pre><code>$ ab -c 4 -n 20000 http://127.0.0.1:8080/\nThis is ApacheBench, Version 2.3 &lt;$Revision: 1826891 $&gt;\nCopyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/\nLicensed to The Apache Software Foundation, http://www.apache.org/\n\nBenchmarking 127.0.0.1 (be patient)\nCompleted 2000 requests\nCompleted 4000 requests\n...\nCompleted 14000 requests\nCompleted 16000 requests\n^C\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1557558607, "post_id": 56087781, "comment_id": 98813205, "body": "Use pointer receiver, all of your methods work on an empty copy of the value. <a href=\"https://play.golang.com/p/dcc2cFPZ_WT\" rel=\"nofollow noreferrer\">play.golang.com/p/dcc2cFPZ_WT</a>"}, {"owner": {"reputation": 626, "user_id": 3237253, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vkeN5.jpg?s=128&g=1", "display_name": "Dipak", "link": "https://stackoverflow.com/users/3237253/dipak"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557559899, "post_id": 56087781, "comment_id": 98813405, "body": "@mkopriva thank you so much, that was stupid mistake I have made"}], "owner": {"reputation": 626, "user_id": 3237253, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/vkeN5.jpg?s=128&g=1", "display_name": "Dipak", "link": "https://stackoverflow.com/users/3237253/dipak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557555674, "creation_date": 1557555674, "question_id": 56087781, "link": "https://stackoverflow.com/questions/56087781/not-able-to-get-message-from-go-channel", "title": "Not able to get message from go channel", "body": "<p>I am a sample for stats collection in which I have used a go channel inside a struct, logically seems correct to me but I'm not able to find the problem with below code, it just simply doesn't print values I have added.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\n//StatsMessage will hold single stats entry\ntype StatsMessage struct {\n    Name  string\n    Value int64\n}\n\n//StatsCollector will hold collected stats\ntype StatsCollector struct {\n    msgchan  chan StatsMessage\n    messages []StatsMessage\n    done     chan int\n}\n\n//Init will start a go routine\nfunc (s StatsCollector) Init() {\n    s.msgchan = make(chan StatsMessage)\n    s.done = make(chan int)\n    s.messages = make([]StatsMessage, 0)\n    go s.fillMessages()\n}\n\n//AddStats adds a single stats in a Messages\nfunc (s StatsCollector) AddStats(name string, value int64) {\n    msg := StatsMessage{Name: name, Value: value}\n    s.msgchan &lt;- msg\n    fmt.Println(\"Message added\")\n}\n\nfunc (s StatsCollector) fillMessages() {\n    fmt.Println(\"Filler started...\")\n    for {\n        s.messages = append(s.messages, &lt;-s.msgchan)\n        fmt.Println(\"Added to messages\")\n    }\n}\n\nfunc generateStats(s *StatsCollector) {\n    for {\n        select {\n        case &lt;-time.After(1 * time.Second):\n            fmt.Println(\"Generated message...\")\n            s.AddStats(\"my_first_stats\", rand.Int63())\n        case &lt;-s.done:\n            fmt.Println(\"Stop generating\")\n            return\n        }\n    }\n}\n\nfunc flushStats(s *StatsCollector) {\n    for _, stat := range s.messages {\n        fmt.Println(stat.Name, stat.Value)\n    }\n}\n\nfunc main() {\n    s := &amp;StatsCollector{}\n    s.Init()\n    go generateStats(s)\n    time.Sleep(5 * time.Second)\n    flushStats(s)\n}\n</code></pre>\n\n<p>if I provide the struct fields at the time of StatsCollector object reation then it does work a bit</p>\n"}, {"tags": ["go", "redis", "broadcast"], "answers": [{"comments": [{"owner": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557552099, "post_id": 56087373, "comment_id": 98812227, "body": "so i need to create a another special channel for broadcast ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557553543, "post_id": 56087373, "comment_id": 98812424, "body": "@darmawanzulkifli Applications do not explicitly create Redis channels.  The channel is special only in that it&#39;s the one that the application subscribes all clients.  See updated answer."}, {"owner": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557561333, "post_id": 56087373, "comment_id": 98813703, "body": "thanks @CeriseLimon i will try your solution. but, I am still have confusion, whether when the user is connected and the subscribe channel client will wait until the message arrives ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557579001, "post_id": 56087373, "comment_id": 98817528, "body": "The application subscribes the connection to two channels and then goes into a loop receiving messages on that connection.  The receive operation blocks until a message is published to one of those two channels or there is an error on the connection. If you have the non-broadcast code working, adding broadcast is as simple as adding an argument to the subscribe call."}, {"owner": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557971392, "post_id": 56087373, "comment_id": 98947784, "body": "Thanks @CeriseLim&#243;n.. it&#39;s done, but there is any problem. when global channel called first, private channel not listen when sent the nessage. also when private channel called first, global channel not gonna work. did you know what happend ?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "edited": false, "score": 0, "creation_date": 1557971933, "post_id": 56087373, "comment_id": 98947862, "body": "When you say that a channel is called first, are you referring to the order of the function arguments or are you actually making two function calls?"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1557553275, "last_edit_date": 1557553275, "creation_date": 1557551271, "answer_id": 56087373, "question_id": 56087122, "link": "https://stackoverflow.com/questions/56087122/is-there-any-way-for-broadcast-to-every-channel-in-redis/56087373#56087373", "title": "Is there any way for broadcast to every channel in redis?", "body": "<p>Subscribe each connection to the per user channel and and a channel for broadcasts. To send to all users, publish to the broadcast channel. The subscriber code will look something like this with the go-redis client:</p>\n\n<pre><code>sub := client.Subscribe(userChannel, broadcastChannel)\ndefer sub.Close()\nfor {\n   m, err := sub.ReceiveMessage()\n   ... do something with m\n}\n</code></pre>\n\n<p>where userChannel and broadcastChannel are the names of Redis channels. Use code like this to broadcast:</p>\n\n<pre><code>cmd := client.Publish(broadcastChannel, message)\nif cmd.Err() != nil {\n    // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 7334197, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oku4dUDTgk8/AAAAAAAAAAI/AAAAAAAABW4/hJ6mUEk7PvQ/photo.jpg?sz=128", "display_name": "Darmawan Zulkifli", "link": "https://stackoverflow.com/users/7334197/darmawan-zulkifli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 670, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557567688, "creation_date": 1557548017, "question_id": 56087122, "link": "https://stackoverflow.com/questions/56087122/is-there-any-way-for-broadcast-to-every-channel-in-redis", "title": "Is there any way for broadcast to every channel in redis?", "body": "<p>I am trying to broadcast the message to channel in redis, but every user have they'r own channel with their user_id. </p>\n\n<p>the way i think can be use is get all active channel and then publish it one by one. because what i know redis can't publish if diferent channel. </p>\n\n<p>but the problem is, in lib <code>go-redis</code> i am using when the user subribe and check the redis  with command <code>PUBSUB CAHNNELS</code> there is no channel result. i read on documentation the subribe function not gonna actived thhe channel immidietly. so how can i get the subribe channel ?</p>\n\n<p>is there any solution to solve this ?\ni am using <code>golang-redis</code> <a href=\"https://godoc.org/github.com/go-redis/redis\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/go-redis/redis</a></p>\n"}, {"tags": ["reactjs", "go", "webpack", "server"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557552523, "post_id": 56087087, "comment_id": 98812272, "body": "Go and its standard lib doesn&#39;t provide a ready made solution for hot reload. You will have to look for 3rd party packages if you want hot reload with your go server. The first result from google points to <a href=\"https://github.com/cosmtrek/air\" rel=\"nofollow noreferrer\">github.com/cosmtrek/air</a> if that doesn&#39;t suit your needs you&#39;ll have to search the internet a bit more."}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557577312, "post_id": 56087087, "comment_id": 98817137, "body": "I am currently serving the /public/bundle.js output file. Do you know if its possible to serve the devserver output specified at /dist? That way I could use React&#39;s hot reloading?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557592219, "post_id": 56087087, "comment_id": 98820634, "body": "You can serve <code>&#47;dist</code> with go of course, create a file server handler and then register it, just like you do with the <code>&#47;public</code> one. However this will not hot reload you browser automatically on change, you&#39;ll have to refresh the page manually, or use a 3rd party package as already suggested in the previous comment."}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557604522, "post_id": 56087087, "comment_id": 98823536, "body": "So that&#39;s what I&#39;m having trouble with.  Can you tell me which changes need to be made to webpack and my server.go file in order to serve from /dist because it&#39;s not able to find the file."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557604643, "post_id": 56087087, "comment_id": 98823560, "body": "How are you accessing you web app? On which port?"}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557610818, "post_id": 56087087, "comment_id": 98824958, "body": "Webpack dev server hosts it on 3000"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557610992, "post_id": 56087087, "comment_id": 98824990, "body": "But your go server is running on port 8080, your go server is serving files from the <code>public</code> folder to which the webpack <b>build output</b> is saved, if i&#39;m reading the config correctly. Ergo try accessing you web app on port 8080. And make sure you don&#39;t ignore the error from <code>template.ParseFiles</code>."}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 842, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1557547808, "creation_date": 1557547489, "last_edit_date": 1557547808, "question_id": 56087087, "link": "https://stackoverflow.com/questions/56087087/render-react-from-go-server", "title": "Render React From Go Server", "body": "<p>I am currently rendering a webpack build file (bundle.js) through a Go server.\nHow can I make my build files hot reload, or what do I need to do in order to serve hot reload files from the Go server?</p>\n\n<p>When I use the 'npm run start' script, I am told that the webpack output is served from \n<a href=\"http://localhost:3000/dist/\" rel=\"nofollow noreferrer\">http://localhost:3000/dist/</a></p>\n\n<p>and the project output is from \n<a href=\"http://localhost:3000\" rel=\"nofollow noreferrer\">http://localhost:3000</a></p>\n\n<p>My directory is as follows</p>\n\n<pre><code>+ public\n  - bundle.js\n+ src\n  - App.js\n  - index.js\n- index.html\n- package.json\n- server.go\n- webpack.config.js\n</code></pre>\n\n<p>// index.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\" /&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"&gt;\n  &lt;title&gt;React Starter&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;div id=\"root\"&gt;&lt;/div&gt;\n  &lt;noscript&gt;\n    You need to enable JavaScript to run this app.\n  &lt;/noscript&gt;\n  &lt;script src=\"/public/bundle.js\"&gt;&lt;/script&gt; \n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>// webpack config</p>\n\n<pre><code>const path = require(\"path\");\nconst webpack = require(\"webpack\");\n\nmodule.exports = {\n  entry: \"./src/index.js\",\n  mode: \"development\",\n  module: {\n    rules: [\n      {\n        test: /\\.(js|jsx)$/,\n        exclude: /(node_modules|bower_components)/,\n        loader: \"babel-loader\",\n        options: { presets: [\"@babel/env\"] }\n      },\n      {\n        test: /\\.css$/,\n        use: [\"style-loader\", \"css-loader\"]\n      }\n    ]\n  },\n  resolve: { extensions: [\"*\", \".js\", \".jsx\"] },\n  output: {\n    path: path.join(__dirname, \"/public\"),\n    publicPath: \"/public/\",\n    filename: \"bundle.js\"\n  },\n  devServer: {\n    contentBase: path.join(__dirname, \"/\"),\n    port: 3000,\n    publicPath: \"http://localhost:3000/dist/\",\n    hotOnly: true\n  },\n  plugins: [new webpack.HotModuleReplacementPlugin()]\n};\n</code></pre>\n\n<p>// package.json</p>\n\n<pre><code>{\n  \"name\": \"r-proj\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"index.js\",\n  \"scripts\": {\n    \"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\",\n    \"start\": \"webpack-dev-server --mode development\",\n    \"build\": \"webpack --mode development\",\n    \"a\": \"webpack-dev-server --content-base src --hot --inline\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"devDependencies\": {\n    \"@babel/cli\": \"^7.1.0\",\n    \"@babel/core\": \"^7.1.0\",\n    \"@babel/preset-env\": \"^7.1.0\",\n    \"@babel/preset-react\": \"^7.0.0\",\n    \"babel-loader\": \"^8.0.2\",\n    \"css-loader\": \"^1.0.0\",\n    \"style-loader\": \"^0.23.0\",\n    \"webpack\": \"^4.19.1\",\n    \"webpack-cli\": \"^3.1.1\",\n    \"webpack-dev-server\": \"^3.1.8\"\n  },\n  \"dependencies\": {\n    \"react\": \"^16.5.2\",\n    \"react-dom\": \"^16.5.2\"\n  }\n}\n</code></pre>\n\n<p>// server.go</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n  t, _ := template.ParseFiles(\"./index.html\")\n  t.Execute(w, \"\")\n}\n\nfunc main() {\n  http.HandleFunc(\"/\", handler)\n  fs := http.FileServer(http.Dir(\"./public/\"))\n\n  http.Handle(\"/public/\", http.StripPrefix(\"/public\", fs)) \n\n  log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "gccgo"], "comments": [{"owner": {"reputation": 5432, "user_id": 4723732, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77fa71fdc548472c228be40043c1bc1f?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Rublev", "link": "https://stackoverflow.com/users/4723732/richard-rublev"}, "edited": false, "score": 0, "creation_date": 1557551862, "post_id": 56086573, "comment_id": 98812198, "body": "Show us tree. of your working directory."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557576030, "post_id": 56086573, "comment_id": 98816785, "body": "<code>gccgo</code> doesn\u2019t support the race detector."}, {"owner": {"reputation": 59, "user_id": 7330349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c1a686b2e8efe16639f4d5f16ec857?s=128&d=identicon&r=PG&f=1", "display_name": "lizhengxian", "link": "https://stackoverflow.com/users/7330349/lizhengxian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557579152, "post_id": 56086573, "comment_id": 98817553, "body": "So how to change gccgo , I just use initial golang @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557579416, "post_id": 56086573, "comment_id": 98817604, "body": "I&#39;m not sure what you mean. Just install Go normally: <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">golang.org/doc/install</a>"}, {"owner": {"reputation": 59, "user_id": 7330349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c1a686b2e8efe16639f4d5f16ec857?s=128&d=identicon&r=PG&f=1", "display_name": "lizhengxian", "link": "https://stackoverflow.com/users/7330349/lizhengxian"}, "edited": false, "score": 0, "creation_date": 1557581278, "post_id": 56086573, "comment_id": 98818001, "body": "thank you. Maybe i initially install go with gccgo.Now it works"}], "owner": {"reputation": 59, "user_id": 7330349, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07c1a686b2e8efe16639f4d5f16ec857?s=128&d=identicon&r=PG&f=1", "display_name": "lizhengxian", "link": "https://stackoverflow.com/users/7330349/lizhengxian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557539355, "creation_date": 1557539355, "question_id": 56086573, "link": "https://stackoverflow.com/questions/56086573/go-race-detector-cant-run-because-of-import-error-ports-runtime-race-cannot-f", "title": "go race detector can&#39;t run because of import error. ports runtime/race: cannot find package &quot;runtime/race&quot; in any of GOROOT or GOPATH", "body": "<p>my os is ubuntu18.04. <br/>\nmy go compiler is gccgo.<br/>\nGOROOT is /usr/local/go<br/>\nit is report as:<br/>\npackage testmain\n    imports runtime/race: cannot find package \"runtime/race\" in any of:<br/>\n    /usr/local/go/src/runtime/race (from $GOROOT)<br/>\n    /home/lzx/tiny_distributed_system/src/runtime/race (from $GOPATH)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557546728, "post_id": 56086437, "comment_id": 98811626, "body": "I did not know the 2nd fact (<code>context.DeadlineExceeded satisfies the net.Error interface</code>), but isn&#39;t a simple <code>err == context.DeadlineExceeded</code> enough? i.e. no need to check for interface match?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1557547052, "post_id": 56086437, "comment_id": 98811650, "body": "If you want to check for context timeout specifically, then use <code>err == context.DeadlineExceeded</code>.  If you want to check for all timeout errors including the context timeout, then use the <code>isTimeoutError</code> function shown in this answer."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 5, "last_activity_date": 1557546971, "last_edit_date": 1557546971, "creation_date": 1557537184, "answer_id": 56086437, "question_id": 56086405, "link": "https://stackoverflow.com/questions/56086405/how-to-check-if-an-error-is-deadline-exceeded-error/56086437#56086437", "title": "How to check if an error is &quot;deadline exceeded&quot; error?", "body": "<p>You can determine if an error is the result of a context timeout by comparing the error to <a href=\"https://godoc.org/context#DeadlineExceeded\" rel=\"nofollow noreferrer\">context.DeadlineExceeded</a>:</p>\n\n<pre><code> if err == context.DeadlineExceeded {\n     // context deadline exceeded\n }\n</code></pre>\n\n<p>You can determine if an error is any timeout error using the following function:</p>\n\n<pre><code>func isTimeoutError(err error) bool {\n     e, ok := err.(net.Error)\n     return ok &amp;&amp; e.Timeout()\n}\n</code></pre>\n\n<p>This function returns true all timeout errors including the value <code>context.DeadlineExceeded</code>.  That value satisfies the <code>net.Error</code> interface and has a <code>Timeout</code> method that always returns <code>true</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2217, "user_id": 2604708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b62fe48f9c75ebe5e3868f9d428c125?s=128&d=identicon&r=PG", "display_name": "Dirbaio", "link": "https://stackoverflow.com/users/2604708/dirbaio"}, "is_accepted": true, "score": 14, "last_activity_date": 1571136989, "creation_date": 1571136989, "answer_id": 58393046, "question_id": 56086405, "link": "https://stackoverflow.com/questions/56086405/how-to-check-if-an-error-is-deadline-exceeded-error/58393046#58393046", "title": "How to check if an error is &quot;deadline exceeded&quot; error?", "body": "<p>The cleanest way to do this in Go 1.13+ is using the new <a href=\"https://golang.org/pkg/errors/#Is\" rel=\"noreferrer\"><code>errors.Is</code></a> function.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// Create a context with a very short timeout\nctx, cancel := context.WithTimeout(context.Background(), time.Millisecond)\ndefer cancel()\n\n// Create the request with it\nr, _ := http.NewRequest(\"GET\", \"http://example.com\", nil)\nr = r.WithContext(ctx)\n\n// Do it, it will fail because the request will take longer than 1ms\n_, err := http.DefaultClient.Do(r)\nlog.Println(err) // Get http://example.com: context deadline exceeded\n\n// This prints false, because the http client wraps the context.DeadlineExceeded\n// error into another one with extra information.\nlog.Println(err == context.DeadlineExceeded)\n\n// This prints true, because errors.Is checks all the errors in the wrap chain,\n// and returns true if any of them matches.\nlog.Println(errors.Is(err, context.DeadlineExceeded))\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5882, "favorite_count": 1, "accepted_answer_id": 58393046, "answer_count": 2, "score": 8, "last_activity_date": 1571136989, "creation_date": 1557536663, "question_id": 56086405, "link": "https://stackoverflow.com/questions/56086405/how-to-check-if-an-error-is-deadline-exceeded-error", "title": "How to check if an error is &quot;deadline exceeded&quot; error?", "body": "<p>I'm sending a request with a context which specified with a 10 seconds timeout:</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), time.Second * 10)\ndefer cancel()\n_, err := client.SendRequest(ctx)\nif err != nil {\n    return 0, err\n}\n</code></pre>\n\n<p>now when I hit that timeout the error message is confusing:</p>\n\n<blockquote>\n  <p>context deadline exceeded</p>\n</blockquote>\n\n<p>Is it possible to check if the err is the timeout error so that I can print a nicer error message?</p>\n\n<pre><code>ctx, cancel := context.WithTimeout(context.Background(), time.Second * 10)\ndefer cancel()\n_, err := client.SendRequest(ctx)\nif err != nil {\n    if isTimeoutError(err) {\n       return nil, fmt.Errorf(\"the request is timeout after 10 seconds\") \n    }\n    return nil, err\n}\n</code></pre>\n\n<p>How to implement such <code>isTimeoutError</code> function?</p>\n"}, {"tags": ["go", "go-get", "gitleaks"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557526280, "post_id": 56085373, "comment_id": 98808947, "body": "Do you have <code>GOBIN</code> set? Did you try with <code>-v</code> or <code>-x</code> to see what the output is? <code>github.com&#47;gitleaks&#47;</code> != <code>github.com&#47;zricethezav&#47;gitleaks</code>, so I&#39;m not sure how you go the former."}, {"owner": {"reputation": 1337, "user_id": 903766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94253e3b2045fbf75c05e81a92035e37?s=128&d=identicon&r=PG", "display_name": "ctt", "link": "https://stackoverflow.com/users/903766/ctt"}, "edited": false, "score": 0, "creation_date": 1557526372, "post_id": 56085373, "comment_id": 98808968, "body": "It looks like your <code>go install</code> package name has an extraneous prefix, <code>src&#47;</code>.  Keep in mind that <code>$GOPATH&#47;src</code> is the directory where package source is stored.  The actual package names are the parts of the pathnames that proceed <code>$GOPATH&#47;src</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "edited": false, "score": 0, "creation_date": 1557526441, "post_id": 56085373, "comment_id": 98808987, "body": "yeah I just posted a half-answer, maybe that helps"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1557535074, "post_id": 56085798, "comment_id": 98810441, "body": "GOPATH should never be go\u2019s root directory. It will produce an error if it is."}], "tags": [], "owner": {"reputation": 27, "user_id": 8637053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4trS5.jpg?s=128&g=1", "display_name": "Shahed Ahmed", "link": "https://stackoverflow.com/users/8637053/shahed-ahmed"}, "is_accepted": false, "score": -1, "last_activity_date": 1557529555, "creation_date": 1557529555, "answer_id": 56085798, "question_id": 56085373, "link": "https://stackoverflow.com/questions/56085373/how-to-install-go-package-after-downloading/56085798#56085798", "title": "How to install go package after downloading?", "body": "<p>If $GOPATH isn't go's root directory I think you have to create bin folder manually. I've manually created $GOPATH/bin folder and its working fine.</p>\n"}, {"tags": [], "owner": {"reputation": 364, "user_id": 11420978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjqxG.jpg?s=128&g=1", "display_name": "Hildeberto", "link": "https://stackoverflow.com/users/11420978/hildeberto"}, "is_accepted": false, "score": 0, "last_activity_date": 1557529932, "creation_date": 1557529932, "answer_id": 56085845, "question_id": 56085373, "link": "https://stackoverflow.com/questions/56085373/how-to-install-go-package-after-downloading/56085845#56085845", "title": "How to install go package after downloading?", "body": "<p>After <code>go get</code>, the gitleaks executable should be in <code>$GO_PATH\\bin</code> directory, not in the <code>$GO_PATH\\src...\\gitleaks</code>.</p>\n\n<p>See this: <a href=\"https://pocketgophers.com/go-install-vs-go-build/\" rel=\"nofollow noreferrer\">https://pocketgophers.com/go-install-vs-go-build/</a></p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "is_accepted": false, "score": 0, "last_activity_date": 1557530447, "creation_date": 1557530447, "answer_id": 56085915, "question_id": 56085373, "link": "https://stackoverflow.com/questions/56085373/how-to-install-go-package-after-downloading/56085915#56085915", "title": "How to install go package after downloading?", "body": "<p>I installed golang on MacOS with <code>brew install go</code>, and that apparently didn't put the main binaries in <code>/usr/local/go</code>, which is why my <code>go get</code> command failed.</p>\n\n<p>so instead of using brew, I installed via: <a href=\"https://golang.org/doc/install?download=go1.12.5.darwin-amd64.pkg\" rel=\"nofollow noreferrer\">https://golang.org/doc/install?download=go1.12.5.darwin-amd64.pkg</a></p>\n\n<p>and after installing using the .pkg file, there were files in <code>/usr/local/go</code>, so then my <code>go get</code> command worked.</p>\n\n<p>My guess is that homebrew puts the go binaries in a different location than <code>/usr/local/go</code> which kinda sux but I could see why.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7898461"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 1, "answer_count": 3, "score": -2, "last_activity_date": 1557530447, "creation_date": 1557526051, "last_edit_date": 1557528067, "question_id": 56085373, "link": "https://stackoverflow.com/questions/56085373/how-to-install-go-package-after-downloading", "title": "How to install go package after downloading?", "body": "<p>I ran this:</p>\n\n<pre><code>cd $GOPATH &amp;&amp; go get -u github.com/zricethezav/gitleaks\n</code></pre>\n\n<p>perplexingly, I now have this:</p>\n\n<pre><code>$GOPATH/\n     src/\n       github.com/\n         gitleaks/\n</code></pre>\n\n<p>but there is not a <code>bin/</code> folder ... I would have expected to see the bin folder here:  <code>$GOPATH/bin</code></p>\n\n<p>did I do something wrong? How do I install the package so that the binary shows up? I tried running:</p>\n\n<pre><code>go install github.com/zricethezav/gitleaks\n</code></pre>\n\n<p>but after installing I don't see a <code>bin/</code> folder...</p>\n\n<p>The output of <code>go env</code> looks like:</p>\n\n<pre><code>GOARCH=\"amd64\"\nGOBIN=\"/Users/alex/go/bin\"\nGOCACHE=\"/Users/alex/Library/Caches/go-build\"\nGOEXE=\"\"\nGOFLAGS=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/alex/go\"\nGOPROXY=\"\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go\"\nGOTMPDIR=\"\"\nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nGOMOD=\"\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/st/159q4vsd64b69_x99dtzzt6m0000gn/T/go-build133179815=/tmp/go-build -gno-record-gcc-switches -fno-common\"\n</code></pre>\n"}, {"tags": ["templates", "go", "nested"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557525217, "post_id": 56085107, "comment_id": 98808682, "body": "<code>urls</code> already seems to be what you want it to be, so you do not need this <code>urls := []url{urls}</code> step."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1557525462, "post_id": 56085107, "comment_id": 98808741, "body": "Can you show us the template? Aim for a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "edited": false, "score": 0, "creation_date": 1557609921, "post_id": 56085107, "comment_id": 98824777, "body": "The template is a simple {{range .}} {{.}} {{end}} however the app doesent start due to error in the code."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3886366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4b9016c4819940e5bd16026e7e37a9c?s=128&d=identicon&r=PG", "display_name": "David Skinner", "link": "https://stackoverflow.com/users/3886366/david-skinner"}, "is_accepted": false, "score": 0, "last_activity_date": 1557630270, "creation_date": 1557630270, "answer_id": 56095892, "question_id": 56085107, "link": "https://stackoverflow.com/questions/56085107/how-to-fix-golang-nested-templates-with-two-sets-of-data/56095892#56095892", "title": "How to fix golang nested templates with two sets of data", "body": "<p><a href=\"https://goplay.space/#og-isDSo2oW\" rel=\"nofollow noreferrer\">https://goplay.space/#og-isDSo2oW</a></p>\n\n<p>Always create a test case on playground to test your problem and to share with others. Hope this helps.</p>\n\n<pre><code>type Data struct {\n    url  // embedded\n    User []user\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8157095, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Rv8C01bznnU/AAAAAAAAAAI/AAAAAAAAG6s/IY45t5y9PG8/photo.jpg?sz=128", "display_name": "aircandyman", "link": "https://stackoverflow.com/users/8157095/aircandyman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1557630270, "creation_date": 1557524098, "last_edit_date": 1557610522, "question_id": 56085107, "link": "https://stackoverflow.com/questions/56085107/how-to-fix-golang-nested-templates-with-two-sets-of-data", "title": "How to fix golang nested templates with two sets of data", "body": "<p>I want to get two data structs into a golang nested template, I've created a struct like this for 'url' and for 'user' data like so,</p>\n\n<pre><code>type url struct {\n    id    string\n    Userid    string\n    Long_url  string\n    Short_url string\n}\ntype user struct {\n    Email        string\n    First_name   string\n    Last_name    string\n    Password     []byte\n}\n</code></pre>\n\n<p>I want to get the two sets of data into a nested golang template. The user data is just one set of data and the url struct will have many rows of data. </p>\n\n<p>My idea is that I would create another struct like so,</p>\n\n<pre><code>   type Data struct {\n        UU []url\n        User []user\n    }\n</code></pre>\n\n<p>and then do the following,</p>\n\n<pre><code>  bb := []url{urls}\n  tu := []user{u}\n  data := &amp;Data{bb, tu}\n tp.ExecuteTemplate(w, \"form\", data)\n</code></pre>\n\n<p>the output of the url data is like this,</p>\n\n<pre><code>[{2 123 https://confluence.expedia.biz/display/INFRAENG/Graphite+Infrastructure short2} {1 123 https://tour.golang.org/moretypes/13 short}]\n</code></pre>\n\n<p>the error I get is as follows:</p>\n\n<pre><code>error:  \"cannot use urls (type []url) as type url in array or slice literal\"\n</code></pre>\n\n<p>I'm really not sure how to progress, can you help?</p>\n"}, {"tags": ["reactjs", "forms", "go", "server"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557521992, "post_id": 56084091, "comment_id": 98807794, "body": "What is the problem with the current code? Are you getting any errors? If so maybe include them in the question."}, {"owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557528397, "post_id": 56084091, "comment_id": 98809439, "body": "Thanks for getting back to me.  When I enter something into the input, the browser outputs &quot;Cannot POST /api/postform&quot;"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557551969, "post_id": 56084091, "comment_id": 98812211, "body": "I may be wrong here but it looks to me, from the webpack config and the server.go file, that you&#39;re running two servers that talk past each other. You&#39;re serving the react app with a server that&#39;s listening on port <code>:3000</code> and you&#39;re serving the go api on a server that&#39;s listening on port <code>:5000</code>. When you make a request from <code>localhost:3000</code> to <code>&#47;api&#47;postform</code> that request is going to be sent to <code>localhost:3000&#47;api&#47;postform</code>, not <code>localhost:5000&#47;api&#47;postform</code> as you might have believed."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1557552075, "post_id": 56084091, "comment_id": 98812224, "body": "You either have to serve both the api and the react app from the same server, or send requests from one server <b>explicitly</b> to the other, for example try updating the form&#39;s action like so <code>&lt;form action=&quot;http:&#47;&#47;localhost:5000&#47;api&#47;postform&quot; method=&quot;POST&quot;&gt;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 27, "user_id": 8637053, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4trS5.jpg?s=128&g=1", "display_name": "Shahed Ahmed", "link": "https://stackoverflow.com/users/8637053/shahed-ahmed"}, "is_accepted": false, "score": -1, "last_activity_date": 1557530520, "creation_date": 1557530520, "answer_id": 56085925, "question_id": 56084091, "link": "https://stackoverflow.com/questions/56084091/how-can-i-link-back-end-go-server-to-front-end-reactjs/56085925#56085925", "title": "How Can I Link back end Go server to front end ReactJS?", "body": "<p>Generally Front end App Connect to Server with Restful API.</p>\n"}], "owner": {"reputation": 305, "user_id": 11466854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845e7b0dd47293a47bbf46d6869688ad?s=128&d=identicon&r=PG&f=1", "display_name": "Last_Node_Standing", "link": "https://stackoverflow.com/users/11466854/last-node-standing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557530520, "creation_date": 1557518247, "last_edit_date": 1557528439, "question_id": 56084091, "link": "https://stackoverflow.com/questions/56084091/how-can-i-link-back-end-go-server-to-front-end-reactjs", "title": "How Can I Link back end Go server to front end ReactJS?", "body": "<p>How can I enter an input in my App.js file and retrieve is in the go backend server using the FormValue() function?  I don't want to send the values as a JSON object.  The endpoint the form should post to is the PostForm function in Server.go.</p>\n\n<p>The go server should be able to serve the bundled react files without separately sending the input in react to a separate go server and then getting the information back.</p>\n\n<p>Errors:\nCurrently, when I enter something into the input form, the browser goes to \"Cannot POST /api/postform\"</p>\n\n<p>Thanks!</p>\n\n<p>index.html</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n  &lt;meta charset=\"UTF-8\" /&gt;\n  &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"&gt;\n  &lt;title&gt;React Starter&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;div id=\"root\"&gt;&lt;/div&gt;\n  &lt;noscript&gt;\n    You need to enable JavaScript to run this app.\n  &lt;/noscript&gt;\n  &lt;script src=\"../dist/bundle.js\"&gt;&lt;/script&gt; &lt;!--references the react app --&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>app.js</p>\n\n<pre><code>import React, { Component} from \"react\";\n\nclass App extends Component{\n\n    constructor() {\n        super();\n        this.state = {\n            query: '',\n        }\n        this.handleChange = this.handleChange.bind(this);\n    }\n\n    handleChange(event) {\n        this.setState({\n            query: event.target.value\n        });\n    }\n\n    render() {\n        return(\n          &lt;div className=\"App\"&gt;\n            &lt;h1&gt; Hello, World! &lt;/h1&gt;\n            &lt;form action=\"/api/postform\" method=\"POST\"&gt;\n            &lt;input type=\"text\" name=\"query\" onChange={this.handleChange} /&gt;\n            &lt;input type=\"submit\" value=\"Submit\" /&gt;\n            &lt;/form&gt;\n\n          &lt;/div&gt;\n        );\n    }\n\n}\n\nexport default App;\n\n</code></pre>\n\n<p>webpack.config.js</p>\n\n<pre><code>const path = require(\"path\");\nconst webpack = require(\"webpack\");\n\nmodule.exports = {\n  entry: \"./src/index.js\",\n  mode: \"development\",\n  module: {\n    rules: [\n      {\n        test: /\\.(js|jsx)$/,\n        exclude: /(node_modules|bower_components)/,\n        loader: \"babel-loader\",\n        options: { presets: [\"@babel/env\"] }\n      },\n      {\n        test: /\\.css$/,\n        use: [\"style-loader\", \"css-loader\"]\n      }\n    ]\n  },\n  resolve: { extensions: [\"*\", \".js\", \".jsx\"] },\n  output: {\n    path: path.resolve(__dirname, \"dist/\"),\n    publicPath: \"/dist/\",\n    filename: \"bundle.js\"\n  },\n  devServer: {\n    contentBase: path.join(__dirname, \"/\"),\n    port: 3000,\n    publicPath: \"http://localhost:3000/dist/\",\n    hotOnly: true\n  },\n  plugins: [new webpack.HotModuleReplacementPlugin()]\n};\n</code></pre>\n\n<p>server.go</p>\n\n<pre><code>package main\n\nimport (\n  \"net/http\"\n\n  \"github.com/gin-gonic/contrib/static\"\n  \"github.com/gin-gonic/gin\"\n  \"fmt\"\n)\n\n\nfunc main() {\n  // Set the router as the default one shipped with Gin\n  router := gin.Default()\n\n  router.Use(static.Serve(\"/\", static.LocalFile(\"./index.html\", true)))\n\n  // Setup route group for the API\n  api := router.Group(\"/api\")\n  {\n    api.GET(\"/\", func(c *gin.Context) {\n      c.JSON(http.StatusOK, gin.H {\n        \"message\": \"pong\",\n      })\n    })\n  }\n\n  // input form should hit this function when it posts\n  api.POST(\"/postform\", PostForm)\n  router.Run(\":5000\")\n}\n\n// should be able to retrieve the value netered into the form and print it out.\nfunc PostForm(c *gin.Context) {\n  c.Header(\"Content-Type\", \"application/json\")\n  q := c.Request.FormValue(\"query\")\n  fmt.Println(\"VALUE IS: \", q)\n\n}\n</code></pre>\n"}, {"tags": ["go", "types", "switch-statement", "declaration", "definition"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1557511631, "post_id": 56082759, "comment_id": 98803805, "body": "See <a href=\"https://stackoverflow.com/questions/36091801/avoid-using-type-assertions-in-the-branches-of-a-type-switch\" title=\"avoid using type assertions in the branches of a type switch\">stackoverflow.com/questions/36091801/&hellip;</a> and <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#type_switch</a>, and <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">tour.golang.org/methods/16</a>"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 2, "creation_date": 1557511823, "post_id": 56082759, "comment_id": 98803878, "body": "to add on JimB answer, i is interface{} type, v is typed according to the inner type of i. So if v were a struct with methods defined on it, you could call those methods on v, not i. the code you present to test that is confusing because you are mixing type semantic with print verbs (%T). to finish, no the two forms are NOT interchangeable."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1557512046, "post_id": 56082759, "comment_id": 98803975, "body": "Try using <code>i</code> in this (<a href=\"https://play.golang.com/p/soqsNXsm_k0\" rel=\"nofollow noreferrer\">play.golang.com/p/soqsNXsm_k0</a>) program and see if it compiles."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5835231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AMSl3iNRwns/AAAAAAAAAAI/AAAAAAAABz4/TrkW8A6In4s/photo.jpg?sz=128", "display_name": "Adam Pickering", "link": "https://stackoverflow.com/users/5835231/adam-pickering"}, "edited": false, "score": 0, "creation_date": 1557517986, "post_id": 56082833, "comment_id": 98806287, "body": "Ah, I see. I was confused by the fact that a <code>%T</code> in <code>fmt.Printf</code> doesn&#39;t print <code>interface{}</code>, but rather the type that the interface encapsulates. Seems like a strange decision on the part of the developers. Thanks for your help!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 13, "user_id": 5835231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AMSl3iNRwns/AAAAAAAAAAI/AAAAAAAABz4/TrkW8A6In4s/photo.jpg?sz=128", "display_name": "Adam Pickering", "link": "https://stackoverflow.com/users/5835231/adam-pickering"}, "edited": false, "score": 2, "creation_date": 1557520676, "post_id": 56082833, "comment_id": 98807331, "body": "If it didn&#39;t, it would <i>always</i> print <code>interface{}</code> no matter what you passed in, because that&#39;s the type it receives all arguments as."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1557511845, "creation_date": 1557511845, "answer_id": 56082833, "question_id": 56082759, "link": "https://stackoverflow.com/questions/56082759/why-is-a-separate-variable-declared-in-a-go-type-switch/56082833#56082833", "title": "Why is a separate variable declared in a Go type switch?", "body": "<p>They are not interchangeable; you're just passing <code>i</code> to a function that can take it regardless of its type (<code>fmt.Printf</code>'s arguments after the format string are of type <code>interface{}</code>). <code>i</code> is still its original type, because the type of a variable <strong>cannot change</strong>.</p>\n\n<p>If you actually wanted to do something with it based on its type, you would need the first form, so that <code>v</code> would be of the type in the <code>case</code> statement. Whether or not you assign the typed value to a variable, the original variable <code>i</code> retains its original type.</p>\n\n<p>This is covered well in the <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">Tour of Go: Type switches</a></p>\n"}], "owner": {"reputation": 13, "user_id": 5835231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AMSl3iNRwns/AAAAAAAAAAI/AAAAAAAABz4/TrkW8A6In4s/photo.jpg?sz=128", "display_name": "Adam Pickering", "link": "https://stackoverflow.com/users/5835231/adam-pickering"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56082833, "answer_count": 1, "score": -1, "last_activity_date": 1557511845, "creation_date": 1557511551, "question_id": 56082759, "link": "https://stackoverflow.com/questions/56082759/why-is-a-separate-variable-declared-in-a-go-type-switch", "title": "Why is a separate variable declared in a Go type switch?", "body": "<p>I am having trouble understanding why type switches are written with an additional variable defined in the switch statement. The below code seems to be the sanctioned way of doing things:</p>\n\n<pre><code>func test_func(i interface{}) {\n    switch v := i.(type) {\n    case int:\n        fmt.Printf(\"%T\\n\", v)\n    case float64:\n        fmt.Printf(\"%T\\n\", v)\n    case int:\n        fmt.Printf(\"I don't know about type %T!\\n\", v)\n    }\n}\n\nfunc main() {\n    test_func(float64(34))\n    test_func(int(34))\n    test_func(\"hello world\")\n}\n</code></pre>\n\n<p>As expected, this returns:</p>\n\n<pre><code>float64\nint\nI don't know about type string!\n</code></pre>\n\n<p>However, I can change <code>test_func</code> slightly so that <code>v</code> is not defined in the <code>switch</code> statement, and instead we use <code>i</code> inside our case statements:</p>\n\n<pre><code>func test_func(i interface{}) {\n    switch i.(type) {\n    case int:\n        fmt.Printf(\"%T\\n\", i)\n    case float64:\n        fmt.Printf(\"%T\\n\", i)\n    case int:\n        fmt.Printf(\"I don't know about type %T!\\n\", i)\n    }\n}\n\nfunc main() {\n    test_func(float64(34))\n    test_func(int(34))\n    test_func(\"hello world\")\n}\n</code></pre>\n\n<p>And the output is not changed. It seems the two forms are interchangeable. Why would I go to the trouble of defining <code>v</code> when I could just use <code>i</code>? The latter case is simpler since there is one less variable to keep track of; maybe it is even more performant.</p>\n"}, {"tags": ["mongodb", "go", "aggregate", "sample", "querying"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557509136, "post_id": 56082193, "comment_id": 98802672, "body": "In situations like this, it&#39;s much easier to first produce a version that works in mongodb shell. Then you know that this is indeed possible and translating it to go is just busy work."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1557509851, "post_id": 56082193, "comment_id": 98802979, "body": "Also, I haven&#39;t used mongodb go driver myself, but from looking at documentation, it seems that you need to shove those bson.E into a bson.D. Or use <code>bson.A</code> instead of <code>[]bson.E</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 1, "last_activity_date": 1557579698, "creation_date": 1557579698, "answer_id": 56090585, "question_id": 56082193, "link": "https://stackoverflow.com/questions/56082193/mongo-random-records-on-golang/56090585#56090585", "title": "Mongo random records on golang", "body": "<p>Use below instead</p>\n\n<pre><code>pipeline := []bson.D{bson.D{{\"$sample\", bson.D{{\"size\", 10}}}}}\n</code></pre>\n\n<p><code>bson.D</code> represents a BSON docoument and <code>bson.E</code> represents a BSON element.  An aggregation is an array of BSON documents.  More details can be found at <a href=\"https://godoc.org/go.mongodb.org/mongo-driver/bson\" rel=\"nofollow noreferrer\">https://godoc.org/go.mongodb.org/mongo-driver/bson</a>.</p>\n"}], "owner": {"reputation": 1605, "user_id": 2394787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/659394d70da41381b09a3a33b1d5f3b1?s=128&d=identicon&r=PG", "display_name": "diogo.appDev", "link": "https://stackoverflow.com/users/2394787/diogo-appdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 56090585, "answer_count": 1, "score": 0, "last_activity_date": 1557579698, "creation_date": 1557508829, "question_id": 56082193, "link": "https://stackoverflow.com/questions/56082193/mongo-random-records-on-golang", "title": "Mongo random records on golang", "body": "<p>I'm trying to retrieve random records from my <code>mongodb</code> collection.\nI'm using <code>golang</code> with <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">mongo-go-driver</a></p>\n\n<pre><code>pipeline := []bson.E{bson.E{\"$sample\", bson.E{\"size\", 10}}}\ncollection.Aggregate(context.TODO(), pipeline)\n</code></pre>\n\n<p>The aggregate is returning me this error:</p>\n\n<pre><code>A pipeline stage specification object must contain exactly one field.\n</code></pre>\n\n<p>I've tried with <code>$size</code> and <code>size</code></p>\n\n<p>Is it possible that <code>mongo-go-driver</code> doesn't support <a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/sample/#pipe._S_sample\" rel=\"nofollow noreferrer\">$sample</a>?</p>\n"}, {"tags": ["go", "opentracing"], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 2216215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60407fee1898fffef4871dfc5bf59112?s=128&d=identicon&r=PG", "display_name": "Milos Simic Simo", "link": "https://stackoverflow.com/users/2216215/milos-simic-simo"}, "edited": false, "score": 0, "creation_date": 1618503498, "post_id": 56223526, "comment_id": 118626738, "body": "Thank you, this helped me. I&#39;m not sure why it is not puling data from ENV, but this will work for now :)."}], "tags": [], "owner": {"reputation": 842, "user_id": 4611186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4e4d955029c501ed8adf1649c1b2e3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sonam", "link": "https://stackoverflow.com/users/4611186/sonam"}, "is_accepted": true, "score": 1, "last_activity_date": 1558364281, "creation_date": 1558364281, "answer_id": 56223526, "question_id": 56082168, "link": "https://stackoverflow.com/questions/56082168/opentracing-go-code-in-one-docker-container-and-jaegertracing-in-another-contain/56223526#56223526", "title": "Opentracing go code in one docker container and jaegertracing in another container", "body": "<p>My problem was with the configuration. The environment variables were not getting read using the above config.  I had to use the following to read the environment variables in open tracing:</p>\n\n<pre><code>cfg, err := jconfig.FromEnv()\n    if err != nil {\n        log.Error(\"cannot parse Jaeger env vars\")\n    }\n\n    cfg.ServiceName = service\n    cfg.Sampler.Type = jaeger.SamplerTypeConst\n    cfg.Sampler.Param = 1\n    cfg.Reporter.LogSpans = true\n</code></pre>\n"}], "owner": {"reputation": 842, "user_id": 4611186, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4e4d955029c501ed8adf1649c1b2e3c8?s=128&d=identicon&r=PG&f=1", "display_name": "Sonam", "link": "https://stackoverflow.com/users/4611186/sonam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 1, "accepted_answer_id": 56223526, "answer_count": 1, "score": 1, "last_activity_date": 1558364281, "creation_date": 1557508711, "question_id": 56082168, "link": "https://stackoverflow.com/questions/56082168/opentracing-go-code-in-one-docker-container-and-jaegertracing-in-another-contain", "title": "Opentracing go code in one docker container and jaegertracing in another container", "body": "<p>I have my go project which sends OpenTracing spans in one docker container and the jaegertracing running in it's own container using the following command:</p>\n\n<pre><code>docker run -p 6831:6831/udp -p 16686:16686 jaegertracing/all-in-one:latest\n</code></pre>\n\n<p>When I run the following go test code  I can see them in the jaegerui:</p>\n\n<pre><code> import (\n    \"testing\"\n    //\"fmt\"\n    \"io\"\n\n    opentracing \"github.com/opentracing/opentracing-go\"\n    jaeger \"github.com/uber/jaeger-client-go\"\n    config \"github.com/uber/jaeger-client-go/config\"\n    log2 \"github.com/sirupsen/logrus\"\n   // olog\"github.com/opentracing/opentracing-go/log\"\n    jaegerlog \"github.com/uber/jaeger-client-go/log\"\n    \"github.com/uber/jaeger-lib/metrics\"\n)\n\nfunc TestSum(t *testing.T) {\n     log2.Info(\"start opentracing\")\n   // helloTo := \"sonam\"\n    tracer, closer := initJaeger(\"opentracing_test\")\n    defer closer.Close()\n\n    helloStr := \"Sonam\"\n    //tracer := opentracing.GlobalTracer()\n\n    span := tracer.StartSpan(\"TestSum\")\n    println(helloStr)\n    span.Finish()\n}\n\n\n// initJaeger returns an instance of Jaeger Tracer that samples 100% of traces and logs all spans to stdout.\nfunc initJaeger(service string) (opentracing.Tracer, io.Closer) {\n    cfg := config.Configuration{\n        ServiceName: service,\n        Sampler:     &amp;config.SamplerConfig{\n            Type:  jaeger.SamplerTypeConst,\n            Param: 1,\n        },\n        Reporter:    &amp;config.ReporterConfig{\n            LogSpans: true,\n        },\n    }\n\n    //add\n    jLogger := jaegerlog.StdLogger\n    jMetricsFactory := metrics.NullFactory\n\n    // Initialize tracer with a logger and a metrics factory\n    tracer, closer, _ := cfg.NewTracer(\n        config.Logger(jLogger),\n        config.Metrics(jMetricsFactory),\n    )\n    // Set the singleton opentracing.Tracer with the Jaeger tracer.\n    opentracing.SetGlobalTracer(tracer)\n    return tracer, closer\n}\n</code></pre>\n\n<p>but not when the code executes in a separate docker container.</p>\n\n<p>Any ideas what I need to pass in my go app docker container?</p>\n"}, {"tags": ["go", "package"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 1, "last_activity_date": 1557509976, "creation_date": 1557509976, "answer_id": 56082424, "question_id": 56081972, "link": "https://stackoverflow.com/questions/56081972/missing-git-command-when-calling-go-get/56082424#56082424", "title": "Missing Git command when calling `go get`", "body": "<p><code>go get</code> internally calls the \"reference\" client-side tool of the particular VCS used to host the package to be fetched. In other words, <code>go get</code> by itself does not know how to interact with VCS servers.</p>\n\n<p>So yes, in order to <code>go get</code> a package which is hosted by Git, you need the working Git installation providing a callable <code>git</code> binary.</p>\n\n<p>As to your second problem, it <a href=\"https://www.google.com/search?q=ERROR%3A+unsatisfiable+constraints%3A+git+(missing)\" rel=\"nofollow noreferrer\">does not appear to have anything related to Go</a>, so I suggest you to do a bit of research and then ask a separate question tagged <code>alpine</code> if that fails.</p>\n"}], "owner": {"reputation": 5432, "user_id": 4723732, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/77fa71fdc548472c228be40043c1bc1f?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Rublev", "link": "https://stackoverflow.com/users/4723732/richard-rublev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 0, "accepted_answer_id": 56082424, "answer_count": 1, "score": -1, "last_activity_date": 1557510042, "creation_date": 1557507734, "last_edit_date": 1557510042, "question_id": 56081972, "link": "https://stackoverflow.com/questions/56081972/missing-git-command-when-calling-go-get", "title": "Missing Git command when calling `go get`", "body": "<p>My Dockerfile</p>\n\n<pre><code>FROM golang:1.10.2-alpine3.7 AS build\nRUN apk --no-cache add gcc g++ make ca-certificates\nRUN apk add git\nWORKDIR /go/src/github.com/meower\n\nCOPY Gopkg.lock Gopkg.toml ./\nCOPY util util\nCOPY event event\nCOPY db db\nCOPY search search\nCOPY schema schema\nCOPY meow-service meow-service\nCOPY query-service query-service\nCOPY pusher-service pusher-service\n\nRUN go get -d -v ./...\nRUN go install ./...\n\nFROM alpine:3.7\nWORKDIR /usr/bin\nCOPY --from=build /go/bin .\n</code></pre>\n\n<p>I added apk add git line.Without this line my docker-compose up produced</p>\n\n<pre><code>Step 13/17 : RUN go get -d -v ./...\n ---&gt; Running in d917adba00cd\ngithub.com/lib/pq (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/lib/pq: exec: \"git\": executable file not found in $PATH\ngithub.com/nats-io/go-nats (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/nats-io/go-nats: exec: \"git\": executable file not found in $PATH\ngithub.com/gorilla/mux (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/gorilla/mux: exec: \"git\": executable file not found in $PATH\ngithub.com/kelseyhightower/envconfig (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/kelseyhightower/envconfig: exec: \"git\": executable file not found in $PATH\npackage github.com/retry: invalid github.com/ import path \"github.com/retry\"\ngithub.com/segmentio/ksuid (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/segmentio/ksuid: exec: \"git\": executable file not found in $PATH\ngithub.com/gorilla/websocket (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/gorilla/websocket: exec: \"git\": executable file not found in $PATH\ngithub.com/olivere/elastic (download)\ngo: missing Git command. See https://golang.org/s/gogetcmd\npackage github.com/olivere/elastic: exec: \"git\": executable file not found in $PATH\n</code></pre>\n\n<p>With git line,other problems are still there</p>\n\n<pre><code>docker-compose up\nBuilding pusher\nStep 1/18 : FROM golang:1.10.2-alpine3.7 AS build\n ---&gt; 44ccce322b34\nStep 2/18 : RUN apk --no-cache add gcc g++ make ca-certificates\n ---&gt; Using cache\n ---&gt; 088fa5ba19a9\nStep 3/18 : RUN apk add git\n ---&gt; Running in 01022f57861b\nWARNING: Ignoring APKINDEX.70c88391.tar.gz: No such file or directory\nWARNING: Ignoring APKINDEX.5022a8a2.tar.gz: No such file or directory\nERROR: unsatisfiable constraints:\n  git (missing):\n</code></pre>\n\n<p>What does this mean?</p>\n"}]