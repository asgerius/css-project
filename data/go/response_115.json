[{"tags": ["linux", "shell", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1490222697, "post_id": 42963625, "comment_id": 73022134, "body": "Did you try using <code>os&#47;exec.Cmd</code> for what you trying to accomplish?"}], "answers": [{"comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1490290549, "post_id": 42963907, "comment_id": 73058366, "body": "I am not sure whose answer to take since each person gives half of the answer."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 8, "last_activity_date": 1490292806, "last_edit_date": 1490292806, "creation_date": 1490222056, "answer_id": 42963907, "question_id": 42963625, "link": "https://stackoverflow.com/questions/42963625/golang-program-terminates-after-calling-linux-shell-command/42963907#42963907", "title": "golang program terminates after calling linux shell command", "body": "<p><code>syscall.Exec</code> <a href=\"https://golang.org/pkg/syscall/#Exec\" rel=\"nofollow noreferrer\">invokes <code>execve(2)</code></a>, which on linux does not return execution to the caller but <a href=\"http://man7.org/linux/man-pages/man2/execve.2.html\" rel=\"nofollow noreferrer\">replaces</a> the current (Go) process with the process called.</p>\n\n<p>As David Budworth, and mkopriva suggest.. if you actually want to spawn a separate process and return to your Go code after spawning; consider using <a href=\"https://golang.org/pkg/os/exec/#example_Command\" rel=\"nofollow noreferrer\"><code>exec.Command</code></a></p>\n"}, {"comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1490290551, "post_id": 42967044, "comment_id": 73058367, "body": "I am not sure whose answer to take since each person gives half of the answer."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 2, "last_activity_date": 1490241789, "creation_date": 1490241789, "answer_id": 42967044, "question_id": 42963625, "link": "https://stackoverflow.com/questions/42963625/golang-program-terminates-after-calling-linux-shell-command/42967044#42967044", "title": "golang program terminates after calling linux shell command", "body": "<p>As @mkopriva mentioned, you probably want exec.Cmd</p>\n\n<p>here's an example:</p>\n\n<pre><code>cmd := exec.Command(\"auditctl\", \"-D\")\ncmd.Stdout = os.Stdout\ncmd.Stderr = os.Stderr\ncmd.Env = os.Environ()\nif err := cmd.Run(); err != nil {\n    log.Println(\"Failed to run auditctl:\",err)\n} \n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "accepted_answer_id": 42963907, "answer_count": 2, "score": 3, "last_activity_date": 1490292806, "creation_date": 1490220729, "question_id": 42963625, "link": "https://stackoverflow.com/questions/42963625/golang-program-terminates-after-calling-linux-shell-command", "title": "golang program terminates after calling linux shell command", "body": "<p>I am executing the following golang program (snippet) with root privilege:</p>\n\n<pre><code>  binary, lookErr := exec.LookPath(\"auditctl\")\n  if lookErr != nil {\n    panic(lookErr)\n  }\n  env := os.Environ()\n\n  args :=  []string{\"auditctl\", \"-D\"}\n  execErr := syscall.Exec(binary, args, env)\n  if execErr != nil {\n    fmt.Println(\"error\")\n    panic(execErr)\n  }\n\n  fmt.Println(\"no error\")\n</code></pre>\n\n<p>Because I dont have any auditctl rules in the system, the command print the following in the terminal. This is all normal just like when I type in the shell directly.</p>\n\n<pre><code>No rules\n</code></pre>\n\n<p>Except that neither \"error\" nor \"no error\" are printed. Which means the golang program terminates right after syscall.Exec. How did this happen and how can I continue execution after syscall.Exec because I have other things to run within the same program.</p>\n"}, {"tags": ["go", "google-sheets", "drive"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490225135, "post_id": 42963406, "comment_id": 73023090, "body": "I believe you need to use the drive api first to get the file by its name and then get that file&#39;s id which corresponds to the spreadsheet&#39;s id."}], "answers": [{"tags": [], "owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "is_accepted": false, "score": 1, "last_activity_date": 1587586741, "last_edit_date": 1587586741, "creation_date": 1490226074, "answer_id": 42964673, "question_id": 42963406, "link": "https://stackoverflow.com/questions/42963406/fetch-spreadsheet-id-using-google-golang-sheets-api-v4-drive-api-v3/42964673#42964673", "title": "Fetch Spreadsheet ID using Google Golang Sheets API V4 / Drive API V3?", "body": "<p>You can use <code>drive.files.list</code> in Drive API at Google. <code>drive.files.list</code> can search files with folder information from your Google Drive.</p>\n\n<p>From your question, I thought following 2 steps.</p>\n\n<ol>\n<li><p>Search file using <code>drive.files.list</code>. File ID and parent folder id can be retrieved, simultaneously. In this case, the fields are id and parents.</p></li>\n<li><p>Retrieve folder name from folder id using <code>drive.files.get</code>. The field is name.</p></li>\n</ol>\n\n<p>You can make file tree using folder information got from each file.</p>\n\n<p>About sample script, it used Go Quickstart for Drive API (<a href=\"https://developers.google.com/drive/v3/web/quickstart/go\" rel=\"nofollow noreferrer\">https://developers.google.com/drive/v3/web/quickstart/go</a>) Please change <code>main()</code> for a script of \"Step 3: Set up the sample\" to following script.</p>\n\n<p><strong>Script :</strong></p>\n\n<pre><code>func main() {\n    ctx := context.Background()\n\n    b, err := ioutil.ReadFile(\"client_secret.json\")\n    if err != nil {\n        log.Fatalf(\"Unable to read client secret file: %v\", err)\n    }\n\n    // If modifying these scopes, delete your previously saved credentials\n    // at ~/.credentials/drive-go-quickstart.json\n    config, err := google.ConfigFromJSON(b, drive.DriveMetadataReadonlyScope)\n    if err != nil {\n        log.Fatalf(\"Unable to parse client secret file to config: %v\", err)\n    }\n    client := getClient(ctx, config)\n\n    srv, err := drive.New(client)\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve drive Client %v\", err)\n    }\n\n    r, err := srv.Files.List().PageSize(10).\n        Fields(\"nextPageToken, files(id, name)\").Do()\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve files: %v\", err)\n    }\n\n    // From here, it's sample script.\n    searchfile := \"filename\"\n    r, err := srv.Files.List().\n        Q(\"name=\\\"\" + searchfile + \"\\\" and trashed=false\").Fields(\"files(id,parents)\").Do() // \"trashed=false\" doesn't search in the trash box.\n    if err != nil {\n        log.Fatalf(\"Error: %v\", err)\n    }\n    for _, i := range r.Files {\n        r, err := srv.Files.Get(i.Parents[0]).Fields(\"name\").Do()\n        if err != nil {\n            log.Fatalf(\"Error: %v\", err)\n        }\n        fmt.Printf(\"FileID=%s, FolderID=%s, FolderName=%s\\n\", i.Id, i.Parents[0], r.Name)\n    }\n}\n</code></pre>\n\n<p><strong>Result :</strong></p>\n\n<pre><code>FileID=#####, FolderID=#####, FolderName=#####\n</code></pre>\n\n<p>Files on Google Drive can have several parent folders. At this script, it assumes that each file has one parent folder. If your files have several parent folders, please retrieve their folders from parent array.</p>\n\n<p><strong>References :</strong></p>\n\n<p>drive.files.list \n<a href=\"https://developers.google.com/drive/v3/reference/files/list\" rel=\"nofollow noreferrer\">https://developers.google.com/drive/v3/reference/files/list</a></p>\n\n<p>drive.files.get \n<a href=\"https://developers.google.com/drive/v3/reference/files/get\" rel=\"nofollow noreferrer\">https://developers.google.com/drive/v3/reference/files/get</a></p>\n\n<p>Go Quickstart for Drive API \n<a href=\"https://developers.google.com/drive/v3/web/quickstart/go\" rel=\"nofollow noreferrer\">https://developers.google.com/drive/v3/web/quickstart/go</a></p>\n"}], "owner": {"reputation": 91, "user_id": 5238873, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oyDZj.jpg?s=128&g=1", "display_name": "king_geedorah", "link": "https://stackoverflow.com/users/5238873/king-geedorah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1587586741, "creation_date": 1490219816, "question_id": 42963406, "link": "https://stackoverflow.com/questions/42963406/fetch-spreadsheet-id-using-google-golang-sheets-api-v4-drive-api-v3", "title": "Fetch Spreadsheet ID using Google Golang Sheets API V4 / Drive API V3?", "body": "<p>I'm using Golang for a small project of mine and am currently trying to pull a spreadsheet ID given the exactly filesystem path (in Drive) and spreadsheet/worksheet name. However, looking through the API library in Golang, I don't see a function that allows me to do this.</p>\n\n<p>I'm pretty new to this kind of programming in general so sorry in advance if this has a trivial solution.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c++", "ssl", "go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 10343, "user_id": 1309332, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2CtHJ.png?s=128&g=1", "display_name": "dbn", "link": "https://stackoverflow.com/users/1309332/dbn"}, "edited": false, "score": 0, "creation_date": 1490227615, "post_id": 42964098, "comment_id": 73023832, "body": "Do you understand why the golang client version accepts the connection with my same self-signed root certificate?"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1490248466, "post_id": 42964098, "comment_id": 73029740, "body": "It looks that go client also has problem with the connection, you have to check the errors when you load the cert and ca, you&#39;re not checking any possible error in both codes"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1490222995, "creation_date": 1490222995, "answer_id": 42964098, "question_id": 42963332, "link": "https://stackoverflow.com/questions/42963332/connection-error-between-c-grpc-client-and-golang-server/42964098#42964098", "title": "connection error between C++ GRPC client and golang server", "body": "<p>The error message is caused by the certificate being presented is not trusted on the system that the C++ code is running on.</p>\n\n<p>If you're using a self-signed certificate you either need to add your root signing key to the ca-certificates on that system or configure your C++ code to read and recognise that root signing key.</p>\n\n<p>If you provide more information on the keys in your code (I assume the root.crt is your root signing key), someone may be able to give you more specific help.</p>\n"}], "owner": {"reputation": 10343, "user_id": 1309332, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2CtHJ.png?s=128&g=1", "display_name": "dbn", "link": "https://stackoverflow.com/users/1309332/dbn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490222995, "creation_date": 1490219517, "question_id": 42963332, "link": "https://stackoverflow.com/questions/42963332/connection-error-between-c-grpc-client-and-golang-server", "title": "connection error between C++ GRPC client and golang server", "body": "<p>I'm trying to write a GRPC server that talks to both a C++ and golang client. Since this is all internal to our system, there will be a self-signed certificate that signs the server certificate, and the server will sign the client certificates.</p>\n\n<p>I'm able to connect to the server from the golang client. However, the C++ client doesn't connect, and I see a bunch of errors from the ssl layer. What am I doing incorrectly in my configuration of the C++ grpc client?</p>\n\n<p>(My certificates all use a 2048bit RSA key for now)</p>\n\n<p>Here are the client codes that I thought were equivalent (error handling elided):</p>\n\n<p><strong>Golang:</strong></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"crypto/tls\"\n    \"io/ioutil\"\n    \"google.golang.org/grpc\"\n    \"google.golang.org/grpc/credentials\"\n)\n\nfunc getConnection(hostPort string) (*grpc.ClientConn, error) {\n    var config tls.Config\n    cert, _ := tls.LoadX509KeyPair(\"client.crt\", \"client.key\")\n    config.Certificates = append(config.Certificates, cert)\n    b, _ := ioutil.ReadFile(\"root.crt\")\n    config.RootCAs.AppendCertsFromPEM(b)\n\n    options := grpc.WithTransportCredentials(credentials.NewTLS(config))\n    return grpc.Dial(hostPort, options)\n}\n</code></pre>\n\n<p><strong>C++:</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;grpc++/grpc++.h&gt;\n\nstd::shared_ptr&lt;grpc::Channel&gt; get_connection(const std::string&amp; host_port) {\n    auto contents = [](const std::string&amp; filename) -&gt; std::string {\n        std::ifstream fh(filename);\n        std::stringstream buffer;\n        buffer &lt;&lt; fh.rdbuf();\n        fh.close();\n        return buffer.str();\n    };\n\n    auto ssl_options = grpc::SslCredentialsOptions();\n    ssl_options.pem_cert_chain = contents(\"client.crt\");\n    ssl_options.pem_private_key = contents(\"client.key\");\n    ssl_options.pem_root_certs = contents(\"root.crt\");\n    auto creds = grpc::SslCredentials(ssl_options);\n    auto channel = grpc::CreateChannel(hostport, creds);\n}\n</code></pre>\n\n<p>My error messages:</p>\n\n<p><strong>C++ Client error messages</strong></p>\n\n<pre><code>D0322 14:42:12.882767371   11701 env_linux.c:77]             Warning: insecure environment read function 'getenv' used\ngetting job record\nE0322 14:42:12.930157873   11701 ssl_transport_security.c:945] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed.\nE0322 14:42:12.930231627   11701 handshake.c:128]            Security handshake failed: {\"created\":\"@1490218932.930210185\",\"description\":\"Handshake failed\",\"file\":\"src/core/lib/security/transport/handshake.c\",\"file_line\":264,\"tsi_code\":10,\"tsi_error\":\"TSI_PROTOCOL_FAILURE\"}\nE0322 14:42:12.964082644   11701 ssl_transport_security.c:945] Handshake failed with fatal error SSL_ERROR_SSL: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed.\nE0322 14:42:12.964134746   11701 handshake.c:128]            Security handshake failed: {\"created\":\"@1490218932.964114213\",\"description\":\"Handshake failed\",\"file\":\"src/core/lib/security/transport/handshake.c\",\"file_line\":264,\"tsi_code\":10,\"tsi_error\":\"TSI_PROTOCOL_FAILURE\"}\nstd::string JobServerClient::getJobRecord(const string&amp;) const: GRPC connection error 14 []\n</code></pre>\n\n<p><strong>Golang Client error messages</strong></p>\n\n<pre><code>2017/03/22 17:42:12 grpc: Server.Serve failed to create ServerTransport:  connection error: desc = \"transport: EOF\"\n2017/03/22 17:42:12 grpc: Server.Serve failed to create ServerTransport:  connection error: desc = \"transport: EOF\"\n</code></pre>\n\n<p>What additional debugging can I do to determine where the C++ client is going awry?</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 5, "creation_date": 1490213692, "post_id": 42961730, "comment_id": 73017740, "body": "Idiomatically is to not modify the collection you&#39;re iterating over, but build a new one iteratively."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490213947, "post_id": 42961730, "comment_id": 73017848, "body": "<a href=\"https://play.golang.org/p/6_91N2LWQA\" rel=\"nofollow noreferrer\">play.golang.org/p/6_91N2LWQA</a> if you must, but you really don&#39;t need to repeatedly copy all the slice elements like that."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490214670, "post_id": 42961730, "comment_id": 73018236, "body": "Or, do you just want to pop off the first element in each iteration? <a href=\"https://play.golang.org/p/WgMpEGpZQV\" rel=\"nofollow noreferrer\">play.golang.org/p/WgMpEGpZQV</a>"}, {"owner": {"reputation": 27, "user_id": 3787772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84427b4895567fa8d6f86f7ae359224e?s=128&d=identicon&r=PG&f=1", "display_name": "shan3k", "link": "https://stackoverflow.com/users/3787772/shan3k"}, "edited": false, "score": 0, "creation_date": 1490217204, "post_id": 42961730, "comment_id": 73019658, "body": "Thanks for the responses - much better understanding now."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 1, "last_activity_date": 1490259536, "creation_date": 1490259536, "answer_id": 42971314, "question_id": 42961730, "link": "https://stackoverflow.com/questions/42961730/iterating-through-a-slice-and-resetting-the-index-golang/42971314#42971314", "title": "Iterating through a slice and resetting the index - golang", "body": "<p>I personally prefer to create a copy. But also it can be done without if you change <code>range</code> part:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := []int{1, 2, 3, 7, 16, 22, 17, 42}\n    fmt.Println(\"We will start out with\", x)\n\n    for i := 0; i &lt; len(x);  {\n        fmt.Println(\"The current value is\", x[i])\n        x = append(x[:i], x[i+1:]...)\n        fmt.Println(\"And after it is removed, we get\", x)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3787772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84427b4895567fa8d6f86f7ae359224e?s=128&d=identicon&r=PG&f=1", "display_name": "shan3k", "link": "https://stackoverflow.com/users/3787772/shan3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1662, "favorite_count": 0, "accepted_answer_id": 42971314, "answer_count": 1, "score": 1, "last_activity_date": 1490259536, "creation_date": 1490213445, "question_id": 42961730, "link": "https://stackoverflow.com/questions/42961730/iterating-through-a-slice-and-resetting-the-index-golang", "title": "Iterating through a slice and resetting the index - golang", "body": "<p>I am iterating through a slice in golang and picking off elements one by one. The problem I am having is that after I remove an item I should either reset the index or start from the beginning but I'm not sure how. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    x := []int{1, 2, 3, 7, 16, 22, 17, 42}\n    fmt.Println(\"We will start out with\", x)\n\n    for i, v := range x {\n        fmt.Println(\"The current value is\", v)\n        x = append(x[:i], x[i+1:]...)\n        fmt.Println(\"And after it is removed, we get\", x)\n    }\n}\n</code></pre>\n\n<p>Will Return the following:</p>\n\n<pre><code>We will start out with [1 2 3 7 16 22 17 42]\nThe current value is 1\nAnd after it is removed, we get [2 3 7 16 22 17 42]\nThe current value is 3\nAnd after it is removed, we get [2 7 16 22 17 42]\nThe current value is 16\nAnd after it is removed, we get [2 7 22 17 42]\nThe current value is 17\nAnd after it is removed, we get [2 7 22 42]\nThe current value is 42\npanic: runtime error: slice bounds out of range\n\ngoroutine 1 [running]:\nmain.main()\n    /tmp/sandbox337422483/main.go:13 +0x460\n</code></pre>\n\n<p>What is the idiomatic way to do this? \nI immediately thing i-- or i = i-1 coming from Python.</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1490208742, "creation_date": 1490208742, "answer_id": 42960328, "question_id": 42958704, "link": "https://stackoverflow.com/questions/42958704/how-to-run-go-test-and-include-unit-test-files-but-exclude-other-test-files/42960328#42960328", "title": "How to run &#39;go test&#39; and include unit test files but exclude other test files", "body": "<p>You can use build tags to limit builds, including tests, to a certain subset of files: <a href=\"https://dave.cheney.net/2014/09/28/using-build-to-switch-between-debug-and-release\" rel=\"nofollow noreferrer\">https://dave.cheney.net/2014/09/28/using-build-to-switch-between-debug-and-release</a></p>\n\n<p>For example, you could put <code>//+build integration</code> at the top of your integration test files, and then those would only be built and executed when you run <code>go test -tags integration</code>.</p>\n"}], "owner": {"reputation": 618, "user_id": 813016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0335bf86ceb7796caabc3bf417b6b03?s=128&d=identicon&r=PG", "display_name": "Philip Beber", "link": "https://stackoverflow.com/users/813016/philip-beber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1721, "favorite_count": 0, "closed_date": 1490210270, "accepted_answer_id": 42960328, "answer_count": 1, "score": 2, "last_activity_date": 1490208742, "creation_date": 1490203558, "question_id": 42958704, "link": "https://stackoverflow.com/questions/42958704/how-to-run-go-test-and-include-unit-test-files-but-exclude-other-test-files", "closed_reason": "Duplicate", "title": "How to run &#39;go test&#39; and include unit test files but exclude other test files", "body": "<p>I'm trying to automate running unit tests on an existing Go project. It already has a lot of existing tests which do non-unit test things like contact external services and write to databases. I would like to exclude these test files from the automation using a naming convention. Say the structure of the project is like this:</p>\n\n<pre><code>gopath/\n|-package1.go\n|-package1_unit_test.go\n|-package1_e2e_test.go\n|-package2/\n  |-package2.go\n  |-package2_unit_test.go\n  |-package2_e2e_test.go\n</code></pre>\n\n<p>I can run <code>go test ./...</code> to run all the tests. If I include 'UnitTest' in the names of my unit tests I can run <code>go test ./... -run UnitTest</code> but this still runs the startup code in the e2e tests. I need it to completely ignore those files. Someone suggested running <code>go test $(go list ./... | grep -v /e2e/)</code> but <code>go list</code> outputs directory names, not file names, so that doesn't work.</p>\n\n<p>And yes, ideally the e2e tests should go in a different directory and not rely on the internals of the package but unfortunately that's not how my coworkers wrote them. I'm looking for a quick fix right now!</p>\n"}, {"tags": ["go", "gcloud"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6058302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-dxVBrdVMaMY/AAAAAAAAAAI/AAAAAAAAAAo/XfgkF1b23ac/photo.jpg?sz=128", "display_name": "Artem Fedotov", "link": "https://stackoverflow.com/users/6058302/artem-fedotov"}, "edited": false, "score": 0, "creation_date": 1547992910, "post_id": 42961910, "comment_id": 95376278, "body": "Thanks for your help! You saved me a  lot of time."}], "tags": [], "owner": {"reputation": 6821, "user_id": 4627916, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-r7NWfPXyn48/AAAAAAAAAAI/AAAAAAAAAFk/SktlPY4AnqU/photo.jpg?sz=128", "display_name": "cherba", "link": "https://stackoverflow.com/users/4627916/cherba"}, "is_accepted": true, "score": 8, "last_activity_date": 1490214125, "creation_date": 1490214125, "answer_id": 42961910, "question_id": 42958662, "link": "https://stackoverflow.com/questions/42958662/why-isnt-gcloud-installing-the-app-engine-go-component/42961910#42961910", "title": "Why isn&#39;t Gcloud installing the &quot;app-engine-go&quot; component?", "body": "<p>You can see list of available components by running</p>\n\n<pre><code>gcloud components list\n</code></pre>\n\n<p>Many components are not installed by default, there are a few of them and some are rather large. If component is not installed you can install it via</p>\n\n<pre><code>gcloud components install app-engine-go\n</code></pre>\n\n<p>Since you have installed gcloud machine wide you would need to run last command with <code>sudo</code>.</p>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 2, "accepted_answer_id": 42961910, "answer_count": 1, "score": 3, "last_activity_date": 1490214125, "creation_date": 1490203445, "last_edit_date": 1490209120, "question_id": 42958662, "link": "https://stackoverflow.com/questions/42958662/why-isnt-gcloud-installing-the-app-engine-go-component", "title": "Why isn&#39;t Gcloud installing the &quot;app-engine-go&quot; component?", "body": "<p>I'm setting up Golang for App Engine on my Macbook Pro osX 0.11.6:\ngo version go1.8 darwin/amd64</p>\n\n<p>I updated Cloud SDK to 148.0.0 with  </p>\n\n<p>sudo /usr/local/google-cloud-sdk/bin/gcloud components update</p>\n\n<pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557  \n\u2560\u2550 Creating update staging area                             \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Uninstalling: BigQuery Command Line Tool                 \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Uninstalling: Cloud SDK Core Libraries                   \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Uninstalling: Cloud Storage Command Line Tool            \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563     \n\u2560\u2550 Uninstalling: gcloud cli dependencies                    \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Installing: BigQuery Command Line Tool                   \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Installing: Cloud SDK Core Libraries                     \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Installing: Cloud Storage Command Line Tool              \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Installing: gcloud cli dependencies                      \u2550\u2563  \n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563  \n\u2560\u2550 Creating backup and activating new installation          \u2550\u2563   \n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d  \n</code></pre>\n\n<p>Performing post processing steps...done.</p>\n\n<p>$ dev_appserver.py app.yaml</p>\n\n<pre><code>This action requires the installation of components: [app-engine-go]  \n\nTraceback (most recent call last):  \n  File \"/usr/local/google-cloud-sdk/bin/dev_appserver.py\", line 44, in &lt;module&gt;  \n    main()  \n  File \"/usr/local/google-cloud-sdk/bin/dev_appserver.py\", line 23, in main  \n    command=__file__)  \n  File \"/usr/local/google-cloud-sdk/lib/googlecloudsdk/core/updater/update_manager.py\", line 189, in EnsureInstalledAndRestart  \n    return manager._EnsureInstalledAndRestart(components, msg, command)  \n  File \"/usr/local/google-cloud-sdk/lib/googlecloudsdk/core/updater/update_manager.py\", line 1139, in _EnsureInstalledAndRestart  \n    restart_args=restart_args):  \n  File \"/usr/local/google-cloud-sdk/lib/googlecloudsdk/core/updater/update_manager.py\", line 665, in Install  \n    restart_args=restart_args)  \n  File \"/usr/local/google-cloud-sdk/lib/googlecloudsdk/core/updater/update_manager.py\", line 742, in Update  \n    config.EnsureSDKWriteAccess(self.__sdk_root)  \n  File \"/usr/local/google-cloud-sdk/lib/googlecloudsdk/core/config.py\", line 195, in EnsureSDKWriteAccess  \n    raise exceptions.RequiresAdminRightsError(sdk_root)  \ngooglecloudsdk.core.exceptions.RequiresAdminRightsError: You cannot perform this action because you do not have permission to modify the Google Cloud SDK installation directory [/usr/local/google-cloud-sdk].  \n\nRe-run the command with sudo: sudo /usr/local/google-cloud-sdk/bin/gcloud ...  \n</code></pre>\n\n<p>What is the command I'm being told to run \"sudo /usr/local/google-cloud-sdk/bin/gcloud ...\"  ?</p>\n\n<p>Why isn't the \"app-engine-go\" component being installed?</p>\n"}, {"tags": ["go", "server", "semaphore"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490201671, "post_id": 42957767, "comment_id": 73010574, "body": "That semaphore on its own won&#39;t add any noticeable latency to the requests. Have you checked that you actually have more than 10000 concurrent requests? If you are reaching a blocking state on that semaphore, my guess is that you were benefitting from the extra concurrency while previously only blocking around redis requests."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490202052, "post_id": 42957767, "comment_id": 73010812, "body": "AWS reports 30,000 requests per minute.  I&#39;m load balancing on two servers.  My fear is when I move the code over to a the east coast where we peak at 300,000 per minute.  Also most of my latency comes from our production mongo servers.  Although we use redis where we can, when traffic increases mongo gets slammed and nationally latency spikes. So I&#39;m following mongo (mgo) documentation and trying to limit at the &quot;door&quot;."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490202380, "post_id": 42957767, "comment_id": 73011008, "body": "This is about as efficient as it could be, so you&#39;re going to have to do some better system profiling (avg latency basically tells you nothing useful). Blocking handlers could be causing a spike in active connections, you may want to try limiting network connections directly to see if that helps."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1490203173, "post_id": 42957767, "comment_id": 73011513, "body": "30,000 request <b>per minute</b> is not equal to 10,000 concurrent / simultaneous requests (there is no direct correlation, it really depends on how long serving the requests take)."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1490203282, "post_id": 42957767, "comment_id": 73011594, "body": "I agree @icza. I used that number because its the max number of concurrent connections redis can handle. So mentally i know it should never be more then that... still experimenting."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1490203312, "post_id": 42957767, "comment_id": 73011608, "body": "Related: <a href=\"http://stackoverflow.com/questions/37529511/process-management-for-the-go-webserver/37531953#37531953\">Process Management for the Go Webserver</a>."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1491930273, "post_id": 42957767, "comment_id": 73767350, "body": "If your limit is Redis, why don&#39;t you limit the connections to Redis then. Virtually all the libraries I&#39;ve seen let you specify the maxium number of connections for the pool. If all connections are in use, the caller will just wait for one to become available. The number of concurrent requests seems unrelated to me."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1503914622, "post_id": 42957767, "comment_id": 78791190, "body": "@peter that is sane, but will also increase request latency which is what OP tries to normalize/get down. I guess OP rather wants to drop requests with a 4xx code than to have them wait until redis/mongo deigns to respond."}], "answers": [{"comments": [{"owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "edited": false, "score": 0, "creation_date": 1503904788, "post_id": 45913626, "comment_id": 78785831, "body": "The prebuilt pool also has the advantage of immediately telling you what you resource utilizations are likely to be, and holding them constant. So you&#39;re less likely to be surprised by load spikes."}], "tags": [], "owner": {"reputation": 15599, "user_id": 73831, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4813b578ef6e0ca5ba25a77f57fdb5f1?s=128&d=identicon&r=PG", "display_name": "Sudhir Jonathan", "link": "https://stackoverflow.com/users/73831/sudhir-jonathan"}, "is_accepted": false, "score": 1, "last_activity_date": 1503904583, "creation_date": 1503904583, "answer_id": 45913626, "question_id": 42957767, "link": "https://stackoverflow.com/questions/42957767/is-there-a-better-way-limit-requests-at-the-door/45913626#45913626", "title": "Is there a better way limit requests at the &quot;door&quot;?", "body": "<p>I'd use a slightly different mechanism for this, probably a worker pool as described here: </p>\n\n<p><a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">https://gobyexample.com/worker-pools</a></p>\n\n<p>I'd actually say keep 10000 goroutines running, (they'll be sleeping waiting to receive on a blocking channel, so it's not really a waste of resources), and send the request+response to the pool as they come in. </p>\n\n<p>If you want a timeout that responds with an error when the pool is full you could implement that with a <code>select</code> block as well. </p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": true, "score": 1, "last_activity_date": 1504886432, "creation_date": 1504886432, "answer_id": 46120451, "question_id": 42957767, "link": "https://stackoverflow.com/questions/42957767/is-there-a-better-way-limit-requests-at-the-door/46120451#46120451", "title": "Is there a better way limit requests at the &quot;door&quot;?", "body": "<p>The solution you outline has some issues. But first, let's take a small step back; there are two questions in this, one of them implied:</p>\n\n<ol>\n<li>How do you rate limit inbound connections efficiently?</li>\n<li>How do you prevent overloading a backend service with outbound connections?</li>\n</ol>\n\n<p>What it sounds like you want to do is actually the second, to prevent too many requests from hitting Redis. I'll start by addressing the first one and then make some comments on the second.</p>\n\n<h2>Rate limiting inbound connections</h2>\n\n<p>If you really do want to rate limit inbound connections \"at the door\", you should normally <em>never do that by waiting inside the handler</em>. With your proposed solution, the service will keep accepting requests, which will queue up at the <code>sema &lt;- struct{}{}</code> statement. If the load persists, it will eventually take down your service, either by running out of sockets, memory, or some other resource. Also note that if your request rate is approaching saturation of the semaphore, you would see an increase in latency caused by goroutines waiting at the semaphore before handling the request.</p>\n\n<p>A better way to do it is to always <em>respond as quickly as possible</em> (especially when under heavy load). This can be done by sending a <code>503 Service Unavailable</code> back to the client, or a smart load balancer, telling it to back off.</p>\n\n<p>In your case, it could for example look like something along these lines:</p>\n\n<pre><code>select {\ncase sema &lt;- struct{}{}:\n    defer func() { &lt;-sema }()\n    h.ServeHTTP(w, r)\ndefault:\n    http.Error(w, \"Overloaded\", http.StatusServiceUnavailable)\n}\n</code></pre>\n\n<h2>Rate limiting outbound connections to a backend service</h2>\n\n<p>If the reason for the rate limit is to avoid overloading a backend service, what you typically want to do is rather to react to that service being overloaded and apply <strong>back pressure</strong> through the request chain.</p>\n\n<p>In practical terms, this could mean something as simple as putting the same kind of semaphore logic as above in a wrapper protecting all calls to the backend, and return an error through your call chain of a request if the semaphore overflows.</p>\n\n<p>Additionally, if the backend sends status codes like <code>503</code> (or equivalent), you should typically propagate that indication downwards in the same way, or resort to some other fallback behaviour for handling the incoming request.</p>\n\n<p>You might also want to consider combining this with a <a href=\"https://martinfowler.com/bliki/CircuitBreaker.html\" rel=\"nofollow noreferrer\">circuit breaker</a>, cutting off attempts to call the backend service quickly if it seems to be unresponsive or down.</p>\n\n<p>Rate limiting by capping the number of concurrent or queued connection as above is usually a good way to handle overload. When the backend service is overloaded, requests will typically take longer, which will then reduce the effective number of requests per second. However, if, for some reason, you want to have a fixed limit on number of requests per second, you could do that with a <a href=\"https://godoc.org/golang.org/x/time/rate\" rel=\"nofollow noreferrer\"><code>rate.Limiter</code></a> instead of a semaphore.</p>\n\n<h2>A comment on performance</h2>\n\n<p>The cost of sending and receiving trivial objects on a channel should be sub-microsecond. Even on a highly congested channel, it wouldn't be anywhere near 150 ms of additional latency only to synchronise with the channel. So, assuming the work done in the handler is otherwise the same, whatever your latency increase comes from it should almost certainly be associated with goroutines waiting somewhere (e.g. on I/O or to get access to synchronised regions that are blocked by other goroutines).</p>\n\n<p>If you are getting incoming requests at a rate close to what can be handled with your set concurrency limit of 10000, or if you are getting spikes of requests, it is possible you would see such an increase in average latency stemming from goroutines in the wait queue on the channel.</p>\n\n<p>Either way, this should be easily measurable; you could for example trace timestamps at certain points in the handling pathway. I would do this on a sample (e.g. 0.1%) of all requests to avoid having the log output affect the performance.</p>\n"}], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 1, "accepted_answer_id": 46120451, "answer_count": 2, "score": 8, "last_activity_date": 1504886432, "creation_date": 1490200832, "last_edit_date": 1491975437, "question_id": 42957767, "link": "https://stackoverflow.com/questions/42957767/is-there-a-better-way-limit-requests-at-the-door", "title": "Is there a better way limit requests at the &quot;door&quot;?", "body": "<p>Right now I'm testing an extremely simple Semaphore in one of my production regions in AWS.  On deployment the latency jumped from 150ms to 300ms.  I assumed latency would occur, but if it could be dropped that would be great.  This is a bit new to me so I'm experimenting.  I've set the semaphore to allow 10000 connections. That's the same number as the maximum number of connections Redis is set to. Is the code below optimal? If not can someone help me optimize it, if I doing something wrong etc.  I want to keep this as a piece of middleware so that I can simply call it like this in on the server <code>n.UseHandler(wrappers.DoorMan(wrappers.DefaultHeaders(myRouter), 10000))</code>.</p>\n\n<pre><code>package wrappers\n\nimport \"net/http\"\n\n// DoorMan limit requests\nfunc DoorMan(h http.Handler, n int) http.Handler {\n    sema := make(chan struct{}, n)\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        sema &lt;- struct{}{}\n        defer func() { &lt;-sema }()\n\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mongodb-query", "mgo"], "comments": [{"owner": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 1, "creation_date": 1490197492, "post_id": 42956009, "comment_id": 73007533, "body": "Basically you need to use <a href=\"https://docs.mongodb.com/manual/reference/operator/projection/slice/\" rel=\"nofollow noreferrer\"><code>$slice</code></a> with your selector. So something like <code>roomsCollection.Find(bson.M{&quot;_id&quot;: room_id})).Select(bson.M{     &quot;messages&quot;: bson.M{         &quot;$slice&quot;: 5}     } ).One(room)</code> should help."}, {"owner": {"reputation": 532, "user_id": 5033823, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-5U-bEbVz9cY/AAAAAAAAAAI/AAAAAAAAABM/swSBgu7YT9I/photo.jpg?sz=128", "display_name": "Konstantin Chsherbakov", "link": "https://stackoverflow.com/users/5033823/konstantin-chsherbakov"}, "reply_to_user": {"reputation": 63390, "user_id": 2683814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/16a4c2fb341c51388d5cdfcf0e956f6c?s=128&d=identicon&r=PG&f=1", "display_name": "s7vr", "link": "https://stackoverflow.com/users/2683814/s7vr"}, "edited": false, "score": 0, "creation_date": 1490198360, "post_id": 42956009, "comment_id": 73008164, "body": "@Veeram Well, I did not know about $slice, but it solved the problem. Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1490200662, "post_id": 42957591, "comment_id": 73009840, "body": "You may also use <a href=\"https://godoc.org/gopkg.in/mgo.v2#Collection.FindId\" rel=\"nofollow noreferrer\">Collection.FindId()</a> to make it simpler: <code>roomscollection.FindId(room_id).One(...</code>."}], "tags": [], "owner": {"reputation": 532, "user_id": 5033823, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-5U-bEbVz9cY/AAAAAAAAAAI/AAAAAAAAABM/swSBgu7YT9I/photo.jpg?sz=128", "display_name": "Konstantin Chsherbakov", "link": "https://stackoverflow.com/users/5033823/konstantin-chsherbakov"}, "is_accepted": true, "score": 2, "last_activity_date": 1490200338, "creation_date": 1490200338, "answer_id": 42957591, "question_id": 42956009, "link": "https://stackoverflow.com/questions/42956009/select-one-document-with-array-with-limited-number-of-elements/42957591#42957591", "title": "Select one document with array with limited number of elements", "body": "<p>So, the solution was really simple. To perform this we can use $slice.\nThe result query will be as following:</p>\n\n<pre><code>roomsCollection.Find(bson.M{\"_id\": room_id})).Select(bson.M{ \"messages\": bson.M{ \"$slice\": 5} } ).One(room)\n</code></pre>\n\n<p>Special thanks to @Veeram for correct answer. </p>\n"}], "owner": {"reputation": 532, "user_id": 5033823, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-5U-bEbVz9cY/AAAAAAAAAAI/AAAAAAAAABM/swSBgu7YT9I/photo.jpg?sz=128", "display_name": "Konstantin Chsherbakov", "link": "https://stackoverflow.com/users/5033823/konstantin-chsherbakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 42957591, "answer_count": 1, "score": 1, "last_activity_date": 1490200338, "creation_date": 1490196324, "last_edit_date": 1490196814, "question_id": 42956009, "link": "https://stackoverflow.com/questions/42956009/select-one-document-with-array-with-limited-number-of-elements", "title": "Select one document with array with limited number of elements", "body": "<p>I have the following structure of the Room type:</p>\n\n<pre><code>type Room struct {\n   Id          bson.ObjectId       `json:\"id\" bson:\"_id,omitempty\"`\n   Title       string              `json:\"title\" bson:\"title\"`\n   Description string              `json:\"description\" bson:\"description,omitempty\"`\n   Type        string              `json:\"type\" bson:\"type,omitempty\"`\n   AdminId     bson.ObjectId       `json:\"admin_id\" bson:\"admin_id\"`\n   CreatedOn   time.Time           `json:\"created_on\" bson:\"created_on\"`\n   Messages    []Message           `json:\"messages\" bson:\"messages,omitempty\"`}\n</code></pre>\n\n<p>The type struct Message is embedded, which has the following structure</p>\n\n<pre><code>type Message struct {\n   Id       bson.ObjectId   `json:\"id\" bson:\"_id,omitempty\"`\n   Text     string          `json:\"text\" bson:\"text\"`\n   Author       Author          `json:\"author\" bson:\"author\"`\n   CreatedOn    time.Time   `json:\"createdon\" bson:\"created_on\"`\n   Reply        []Message   `json:\"reply\" bson:\"reply,omitempty\"`}\n</code></pre>\n\n<p>Using this code I can extract all the fields of the collection.</p>\n\n<pre><code>room := &amp;Room{}\nroomsCollection := session.DB(config.Data.DB.Database).C(\"Rooms\")\nerr := roomsCollection.Find(bson.M{\"_id\": room_id}).One(room)\nif err != nil {\n    panic(err)\n    return nil, err\n}\n</code></pre>\n\n<p>This gives the rooms with all the messages in the given documents. \nThe question is, can I limit the length of nested <code>Messages</code> array in each document? </p>\n"}, {"tags": ["macos", "go", "upgrade"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1490189232, "post_id": 42952979, "comment_id": 73000783, "body": "Execute <code>which go</code>, and you&#39;ll see where your old Go resides. Remove it (and references to it)."}, {"owner": {"reputation": 551, "user_id": 1400741, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5033c88121a8fb1e5e091195fb5a1f7?s=128&d=identicon&r=PG", "display_name": "Arnaud H", "link": "https://stackoverflow.com/users/1400741/arnaud-h"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1490189890, "post_id": 42952979, "comment_id": 73001288, "body": "Oh, I see now! I removed the go folder from usr/local, and the go file in usr/local/bin and it is now showing correctly. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 29, "last_activity_date": 1490190456, "creation_date": 1490190456, "answer_id": 42953523, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8/42953523#42953523", "title": "go version command shows old version number after update to 1.8", "body": "<p>You obviously have an old version of Go installed, else you couldn't see <code>go version go1.7.5 darwin/amd64</code> as the output of <code>go version</code>.</p>\n\n<p>IDEs might have more advanced method of detecting Go installations other that simply scanning <code>PATH</code> and <code>GOROOT</code> (and that's why your IDE found and suggested the newer Go 1.8).</p>\n\n<p>Execute <code>which go</code>, and you'll see where your old Go resides. Remove it (and references to it).</p>\n\n<p>Note that in your <code>.bashrc</code> you're appending the proper Go <code>bin</code> folder to the <em>end</em> of <code>PATH</code>:</p>\n\n<pre><code>export PATH=$PATH:/usr/local/go/bin\n</code></pre>\n\n<p>Which means if <code>PATH</code> contains the <code>bin</code> folder of the old Go installation (very likely), that is used to execute the <code>go</code> command.</p>\n"}, {"comments": [{"owner": {"reputation": 118, "user_id": 2526965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2838dba161c81aa39d982d2cff017604?s=128&d=identicon&r=PG", "display_name": "Adam Engebretson", "link": "https://stackoverflow.com/users/2526965/adam-engebretson"}, "edited": false, "score": 0, "creation_date": 1544812385, "post_id": 49806672, "comment_id": 94421742, "body": "+1 - I found that even though I originally installed golang via the .pkg from their website, my /usr/local/bin/go pointed to the brew installation of golang after running <code>brew install dep</code> for another project."}, {"owner": {"reputation": 364, "user_id": 5368990, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/z6kK9.jpg?s=128&g=1", "display_name": "Nisan Coskun", "link": "https://stackoverflow.com/users/5368990/nisan-coskun"}, "edited": false, "score": 0, "creation_date": 1583127695, "post_id": 49806672, "comment_id": 106998196, "body": "This works best. Brew should know where did you exacly installed go and go binary files."}], "tags": [], "owner": {"reputation": 455, "user_id": 2033450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6552571bdbfa7d31353b64f6fdec053a?s=128&d=identicon&r=PG", "display_name": "Sreenidhi Sreesha", "link": "https://stackoverflow.com/users/2033450/sreenidhi-sreesha"}, "is_accepted": false, "score": 27, "last_activity_date": 1528189554, "last_edit_date": 1528189554, "creation_date": 1523571417, "answer_id": 49806672, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8/49806672#49806672", "title": "go version command shows old version number after update to 1.8", "body": "<p>I had the same issue.  Even after installing golang 1.10 on mac through download from golang website, mac terminal still showed 1.7 version.</p>\n\n<p>Updating golang through homebrew fixed my issue.</p>\n\n<pre><code>brew update\nbrew upgrade golang\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1136, "user_id": 5142901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6GVy.png?s=128&g=1", "display_name": "boroboris", "link": "https://stackoverflow.com/users/5142901/boroboris"}, "is_accepted": false, "score": 2, "last_activity_date": 1546014151, "creation_date": 1546014151, "answer_id": 53961401, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8/53961401#53961401", "title": "go version command shows old version number after update to 1.8", "body": "<p><strong>TLDR</strong>\nI've resolved my problem by moving link to go binary from installation folder to <code>/usr/bin/go</code></p>\n\n<hr>\n\n<p><strong>Step by step:</strong></p>\n\n<ol>\n<li><p>find go binary:</p>\n\n<pre><code>$which go\n/usr/bin/go\n</code></pre></li>\n<li><p>create symlinks:</p>\n\n<pre><code>ln -s /usr/local/go/bin/go go\nln -s /usr/local/go/bin/godoc godoc\nln -s /usr/local/go/bin/gofmt gofmt\n</code></pre></li>\n<li><p>copy those 3 symlinks to <code>/usr/bin</code></p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 335, "user_id": 1693363, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fd4b5f916626e9a535ceb2a0008d6fcd?s=128&d=identicon&r=PG", "display_name": "Vishal", "link": "https://stackoverflow.com/users/1693363/vishal"}, "is_accepted": false, "score": 4, "last_activity_date": 1561105550, "creation_date": 1561105550, "answer_id": 56699590, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8/56699590#56699590", "title": "go version command shows old version number after update to 1.8", "body": "<p>In my case, I had to replace binary files manually after re-installation.</p>\n\n<pre><code>cp /usr/local/go/bin/* /usr/local/bin/\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 1513342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c695c87481b3d59a5d3b09b4eb745524?s=128&d=identicon&r=PG", "display_name": "Pavan", "link": "https://stackoverflow.com/users/1513342/pavan"}, "is_accepted": false, "score": 0, "last_activity_date": 1610128318, "creation_date": 1610128318, "answer_id": 65633975, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8/65633975#65633975", "title": "go version command shows old version number after update to 1.8", "body": "<p>I installed the latest version from <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">https://golang.org/doc/install</a>\nThat will replace the one in the default path which is /usr/local/go/bin/go for mac and doesn't require any manual changes to ~/.bashrc/ ~/.bash_profile on mac unless the default path was never set.</p>\n"}], "owner": {"reputation": 551, "user_id": 1400741, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/c5033c88121a8fb1e5e091195fb5a1f7?s=128&d=identicon&r=PG", "display_name": "Arnaud H", "link": "https://stackoverflow.com/users/1400741/arnaud-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51727, "favorite_count": 7, "accepted_answer_id": 42953523, "answer_count": 5, "score": 28, "last_activity_date": 1610128318, "creation_date": 1490189092, "question_id": 42952979, "link": "https://stackoverflow.com/questions/42952979/go-version-command-shows-old-version-number-after-update-to-1-8", "title": "go version command shows old version number after update to 1.8", "body": "<p>Pretty much the title. I downloaded/installed Go 1.8 for OS X, but when I go</p>\n\n<pre><code>$ go version\ngo version go1.7.5 darwin/amd64\n</code></pre>\n\n<p>My .bashrc look like the following</p>\n\n<pre><code># some exports omitted\n\nNPM_PACKAGES=/Users/&lt;me&gt;/.npm-packages\nNODE_PATH=\"$NPM_PACKAGES/lib/node_modules:$NODE_PATH\"\n\nexport PATH=~/Library/Python/3.4/bin:$PATH\n\nexport GOPATH=$HOME/Go\nexport PATH=$PATH:/usr/local/go/bin\n</code></pre>\n\n<p>My workspace is in a directory called \"Go\" in my home folder. </p>\n\n<p>What I have checked so far:</p>\n\n<ul>\n<li><p>I've checked the files in /usr/local/go/bin, and the VERSION file states \"1.8\", so I know the installation was successful.</p></li>\n<li><p>I have also renewed my terminal session, I even rebooted my pc to make sure no other processes were interfering with it.</p></li>\n<li><p>I use Webstorm as my IDE, and it correctly recognized 1.8 as the working version</p></li>\n<li><p>It's not a bug in the version number itself, as I can't use the \"NextResultSet()\" sql functionality, introduced in version 1.8</p></li>\n</ul>\n\n<p>I believe the culprit might be a wrong configuration in the .bashrc file above, as only the terminal is stuck on the old version, but I can't figure out what is wrong with it.</p>\n"}, {"tags": ["unit-testing", "testing", "go", "mocking"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490187470, "post_id": 42952191, "comment_id": 72999514, "body": "Yes. Just assign <code>v</code> to your mock and use <code>v</code> instead of <code>z.SomeFunc</code>. Probably you would want to make <code>v</code> a global (and rename to <code>zSomeFunc</code>."}, {"owner": {"reputation": 876, "user_id": 1087152, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/32887f865d6fcad622b1454f86b508f1?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/1087152/pradeep"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490283852, "post_id": 42952191, "comment_id": 73053578, "body": "Thanks Volker!!!"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4002112, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1024677000b5138485ed56b82e96ea31?s=128&d=identicon&r=PG&f=1", "display_name": "user4002112", "link": "https://stackoverflow.com/users/4002112/user4002112"}, "edited": false, "score": 0, "creation_date": 1589425307, "post_id": 42952311, "comment_id": 109291482, "body": "How to mock if the function returns more than one value?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 101, "user_id": 4002112, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1024677000b5138485ed56b82e96ea31?s=128&d=identicon&r=PG&f=1", "display_name": "user4002112", "link": "https://stackoverflow.com/users/4002112/user4002112"}, "edited": false, "score": 0, "creation_date": 1589444828, "post_id": 42952311, "comment_id": 109298389, "body": "@user4002112 The same way. Obviously the function used for mocking has to return multiple values too."}, {"owner": {"reputation": 91, "user_id": 4646963, "user_type": "registered", "profile_image": "https://graph.facebook.com/656181874509580/picture?type=large", "display_name": "Taeyeong Jeong", "link": "https://stackoverflow.com/users/4646963/taeyeong-jeong"}, "edited": false, "score": 0, "creation_date": 1615788041, "post_id": 42952311, "comment_id": 117789801, "body": "Doesn&#39;t it have race condition problem when we run tests concurrently?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 57, "last_activity_date": 1490250678, "last_edit_date": 1495535409, "creation_date": 1490187465, "answer_id": 42952311, "question_id": 42952191, "link": "https://stackoverflow.com/questions/42952191/is-it-possible-to-mock-a-function-imported-from-a-package-in-golang/42952311#42952311", "title": "Is it possible to mock a function imported from a package in golang?", "body": "<p>Yes, with a simple refactoring. Create a <code>zSomeFunc</code> variable of function type, initialized with <code>z.SomeFunc</code>, and have your package call that instead of <code>z.SomeFunc()</code>:</p>\n\n<pre><code>var zSomeFunc = z.SomeFunc\n\nfunc abc() {\n    // ...\n    v := zSomeFunc()\n    // ...\n}\n</code></pre>\n\n<p>In tests you may assign another function to <code>zSomeFunc</code>, one that is defined in tests, and does whatever the test wants it to.</p>\n\n<p>For example:</p>\n\n<pre><code>func TestAbc(t *testing.T) {\n    // Save current function and restore at the end:\n    old := zSomeFunc\n    defer func() { zSomeFunc = old }()\n\n    zSomeFunc = func() int {\n        // This will be called, do whatever you want to,\n        // return whatever you want to\n        return 1\n    }\n\n    // Call the tested function\n    abc()\n\n    // Check expected behavior\n}\n</code></pre>\n\n<p>See related / possible duplicate:\n<a href=\"https://stackoverflow.com/questions/40615641/testing-os-exit-scenarios-in-go-with-coverage-information-coveralls-io-goverall/40801733#40801733\">Testing os.Exit scenarios in Go with coverage information (coveralls.io/Goveralls)</a></p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490200050, "post_id": 42952417, "comment_id": 73009403, "body": "Worth noting, you can use the argument <code>-p 1</code> to <code>go test</code> to force all tests to run in series rather than parallel."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 9, "last_activity_date": 1580210615, "last_edit_date": 1580210615, "creation_date": 1490187746, "answer_id": 42952417, "question_id": 42952191, "link": "https://stackoverflow.com/questions/42952191/is-it-possible-to-mock-a-function-imported-from-a-package-in-golang/42952417#42952417", "title": "Is it possible to mock a function imported from a package in golang?", "body": "<p>One thing you can do is this:</p>\n\n<pre><code>import \"x/y/z\"\n\nvar someFunc = z.SomeFunc\n\nfunc abc() {\n    ...\n    v := someFunc()\n    ... \n}\n</code></pre>\n\n<p>And in your test file you would do this.</p>\n\n<pre><code>func Test_abc() {\n    someFunc = mockFunc\n    abc()\n}\n</code></pre>\n\n<p>But make sure that you do this in a concurrent manner, if you have multiple <code>TestXxx</code> functions calling <code>abc</code> or setting <code>someFunc</code> you may be better of using a <code>struct</code> with a <code>someFunc</code> field.  </p>\n"}, {"comments": [{"owner": {"reputation": 507, "user_id": 287266, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/30b63787b6fe215309507ce479f33ef6?s=128&d=identicon&r=PG", "display_name": "Tareq Sha", "link": "https://stackoverflow.com/users/287266/tareq-sha"}, "edited": false, "score": 0, "creation_date": 1568389021, "post_id": 44275986, "comment_id": 102270721, "body": "gmock is excellent but does not have a native solution for global functions. you have to wrap them with an interface."}, {"owner": {"reputation": 3248, "user_id": 3909198, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gdOpu.jpg?s=128&g=1", "display_name": "inquisitive", "link": "https://stackoverflow.com/users/3909198/inquisitive"}, "edited": false, "score": 0, "creation_date": 1579770425, "post_id": 44275986, "comment_id": 105879887, "body": "This article <a href=\"https://dev.to/jonfriesen/mocking-dependencies-in-go-1h4d\" rel=\"nofollow noreferrer\">dev.to/jonfriesen/mocking-dependencies-in-go-1h4d</a> explains the steps with examples for this approach."}], "tags": [], "owner": {"reputation": 189, "user_id": 1773858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/510f80ebcc789a222a7e7434dfbb8afa?s=128&d=identicon&r=PG", "display_name": "Abhishek Srivastava", "link": "https://stackoverflow.com/users/1773858/abhishek-srivastava"}, "is_accepted": false, "score": 5, "last_activity_date": 1540809470, "last_edit_date": 1540809470, "creation_date": 1496206693, "answer_id": 44275986, "question_id": 42952191, "link": "https://stackoverflow.com/questions/42952191/is-it-possible-to-mock-a-function-imported-from-a-package-in-golang/44275986#44275986", "title": "Is it possible to mock a function imported from a package in golang?", "body": "<p>Having function pointer and monkey patching it is the one of doing it. But then when you multiple functions to mock, you will have a number function pointers and unnecessarily you will have to call function using the function pointer only.</p>\n\n<p>The better and the recommended idea to have an interface and make your function part of the struct implementing the interface. Once done that, you can generate mocks using some nice tools available for go.</p>\n\n<p>I have been using this:</p>\n\n<pre><code>mockgen -source myModule.go -package myPackage -destination myModuleMock.go\n</code></pre>\n\n<p>You can install it by:</p>\n\n<pre><code>got get github.com/golang/mock\n</code></pre>\n"}], "owner": {"reputation": 876, "user_id": 1087152, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/32887f865d6fcad622b1454f86b508f1?s=128&d=identicon&r=PG", "display_name": "Pradeep", "link": "https://stackoverflow.com/users/1087152/pradeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17146, "favorite_count": 17, "accepted_answer_id": 42952311, "answer_count": 3, "score": 34, "last_activity_date": 1580210615, "creation_date": 1490187140, "last_edit_date": 1490187853, "question_id": 42952191, "link": "https://stackoverflow.com/questions/42952191/is-it-possible-to-mock-a-function-imported-from-a-package-in-golang", "title": "Is it possible to mock a function imported from a package in golang?", "body": "<p>I have the following method to test, which uses a function imported from a package.</p>\n\n<pre><code>import x.y.z\n\nfunc abc() {\n    ...\n    v := z.SomeFunc()\n    ... \n}\n</code></pre>\n\n<p>Is it possible to mock <code>SomeFunc()</code> in golang?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "edited": false, "score": 0, "creation_date": 1490184419, "post_id": 42951064, "comment_id": 72997240, "body": "Or better yet, try using <a href=\"https://golang.org/pkg/path/filepath/#Abs\" rel=\"nofollow noreferrer\"><code>filepath.Abs</code></a> to build the absolute path. Print that value to make sure you&#39;re using the path you expect."}, {"owner": {"reputation": 768, "user_id": 1011867, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3c7d3778a88027a6e925cd4360057d48?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1011867/michael"}, "edited": false, "score": 0, "creation_date": 1490336277, "post_id": 42951064, "comment_id": 73076109, "body": "It didn&#39;t help - same result."}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 0, "last_activity_date": 1490184932, "last_edit_date": 1490184932, "creation_date": 1490184097, "answer_id": 42951064, "question_id": 42950517, "link": "https://stackoverflow.com/questions/42950517/golang-exec-command-in-different-folder/42951064#42951064", "title": "golang exec.Command in different folder", "body": "<p>Use an absolute path. Check out <a href=\"https://godoc.org/path/filepath#Abs\" rel=\"nofollow noreferrer\">filepath.Abs</a></p>\n"}], "owner": {"reputation": 768, "user_id": 1011867, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3c7d3778a88027a6e925cd4360057d48?s=128&d=identicon&r=PG", "display_name": "Michael", "link": "https://stackoverflow.com/users/1011867/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1867, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1490184932, "creation_date": 1490182526, "question_id": 42950517, "link": "https://stackoverflow.com/questions/42950517/golang-exec-command-in-different-folder", "title": "golang exec.Command in different folder", "body": "<p>I have a problem with exec.Command with .Dir assigned. When I run command from the app I get an error. but if I run it from the shell the same command is working fine.</p>\n\n<pre><code>command := exec.Command(\"git\", \"rev-parse\", \"--verify\", \"tags/v1.0.0^{commit}\")\ncommand.Dir = \"sub/subdir\"\nout, err := command.CombinedOutput()\nfmt.Printf(\"Executed command [%s] %s\\nErrorCode = %s\\nOutput = %s\\n\", command.Dir, command.Args, err, out)\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Executed command [sub/subdir] [git rev-parse --verify tags/v1.0.0^{commit}]\nErrorCode = exit status 128 \nOutput = fatal: Needed a single revision\n</code></pre>\n\n<p>Shell command:</p>\n\n<pre><code>$ (cd sub/subdir; git rev-parse --verify tags/v1.0.0^{commit})\nc1f3b8707ac001dab875781def3c729e3ed6de2c\n</code></pre>\n\n<p>What did I do wrong?</p>\n"}, {"tags": ["dictionary", "go", "go-templates", "revel"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490178172, "post_id": 42948556, "comment_id": 72992827, "body": "Your map keys are strings like &quot;foo&quot; and &quot;wtf&quot;. What is an even string? That&#39;s not how things work."}, {"owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 1, "creation_date": 1490178548, "post_id": 42948556, "comment_id": 72993078, "body": "Must you use <code>even</code>, or could you use CSS styling (<code>:nth-child(odd)</code>, <code>:nth-child(even)</code>) and forget about <code>even</code>?"}, {"owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "reply_to_user": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "edited": false, "score": 0, "creation_date": 1490179619, "post_id": 42948556, "comment_id": 72993879, "body": "@kennytm this actually solved my problem. If you post it as Answer I will accept it, so the case is cleared"}], "answers": [{"comments": [{"owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "edited": false, "score": 0, "creation_date": 1490179410, "post_id": 42948949, "comment_id": 72993725, "body": "here both $index and $element are string/[]string. But I want the number of iteration"}, {"owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "edited": false, "score": 0, "creation_date": 1490179924, "post_id": 42948949, "comment_id": 72994117, "body": "with the edit i get ` error calling index: cannot index slice/array with type string`. I worked around it by now with help of @keynnytm&#39;s comment"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": -1, "last_activity_date": 1490258308, "last_edit_date": 1490258308, "creation_date": 1490178592, "answer_id": 42948949, "question_id": 42948556, "link": "https://stackoverflow.com/questions/42948556/iterate-go-map-get-index/42948949#42948949", "title": "Iterate Go map get index", "body": "<pre><code>{{range $key, $element := .Map}}\n  {{$index := index .Map $key}}\n{{end}}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "edited": false, "score": 0, "creation_date": 1490265544, "post_id": 42950177, "comment_id": 73039385, "body": "Its works, but I am curious, why does <code>e</code> not gets reset to false every time I call isEven()?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "edited": false, "score": 1, "creation_date": 1490265883, "post_id": 42950177, "comment_id": 73039622, "body": "@Mrlenny Added a new <b>Under the hood</b> section to explain the internals."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1490265864, "last_edit_date": 1490265864, "creation_date": 1490181611, "answer_id": 42950177, "question_id": 42948556, "link": "https://stackoverflow.com/questions/42948556/iterate-go-map-get-index/42950177#42950177", "title": "Iterate Go map get index", "body": "<p>You can't do this only with template actions, but you may register a function which provides the necessary help.</p>\n\n<p>You may register a function which returns a function (closure), which alternates its return value whenever called (exactly how \"odd\" and \"even\" indices alternate):</p>\n\n<pre><code>func isEven() func() bool {\n    e := false\n    return func() bool {\n        e = !e\n        return e\n    }\n}\n</code></pre>\n\n<p>I named it <code>isEven()</code> to not collide with ravel's <code>even()</code>. Using it:</p>\n\n<pre><code>func main() {\n    t := template.Must(template.New(\"\").Funcs(template.FuncMap{\n        \"isEven\": isEven,\n    }).Parse(templ))\n\n    m := map[string]string{\n        \"a\": \"A\", \"b\": \"B\", \"c\": \"C\", \"d\": \"D\",\n    }\n    if err := t.Execute(os.Stdout, m); err != nil {\n        panic(err)\n    }\n}\n\nconst templ = `{{$e := isEven}}\n{{- range $k, $v := . -}}\n    [even:{{call $e}}] key={{$k}}; value={{$v}}\n{{end}}`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/c-HsGZjI7A\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[even:true] key=a; value=A\n[even:false] key=b; value=B\n[even:true] key=c; value=C\n[even:false] key=d; value=D\n</code></pre>\n\n<p>If you want different output for odd and even iterations, you can call <code>$e</code> in an <code>{{if}}</code> action, like this:</p>\n\n<pre><code>const templ = `{{$e := isEven}}\n{{- range $k, $v := . -}}\n    [{{if call $e}}even{{else}}odd {{end}}] key={{$k}}; value={{$v}}\n{{end}}`\n</code></pre>\n\n<p>Output of this (try it on the <a href=\"https://play.golang.org/p/IsZJY4EyG9\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[even] key=a; value=A\n[odd ] key=b; value=B\n[even] key=c; value=C\n[odd ] key=d; value=D\n</code></pre>\n\n<h3>Under the hood</h3>\n\n<p>This template action:</p>\n\n<pre><code>{{$e := isEven}}\n</code></pre>\n\n<p>Creates a new template variable named <code>$e</code>, and its value will be the result (return value) of the <code>isEven()</code> function call. <code>isEven()</code> returns a function value, a closure that has access to a local variable <code>e</code> of type <code>bool</code>. When later you do <code>{{call $e}}</code>, you're not calling the <code>isEven()</code> Go function, but the function it returned (the closure) and is stored in <code>$e</code>. That closure has a reference to the local <code>bool</code> variable <code>e</code>, it is not \"freed\" until the function returned by <code>isEvent()</code> is accessible.</p>\n\n<p>So whenever you do <code>{{call $e}}</code>, it calls the closure, which \"has\" an <code>e</code> variable of type <code>bool</code>, whose value is retained between calls of this <code>$e</code>.</p>\n\n<p>If you would call <code>isEvent</code> in the template again, that would return a new function (closure), wrapping a new instance of the local variable <code>e</code>, being independent of the first wrapped variable of the closure returned by the first <code>isEvent()</code> call.</p>\n"}, {"tags": [], "owner": {"reputation": 13739, "user_id": 38333, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e2ea7c27233a9019a1f91a821726a4d4?s=128&d=identicon&r=PG", "display_name": "cd1", "link": "https://stackoverflow.com/users/38333/cd1"}, "is_accepted": false, "score": 0, "last_activity_date": 1490183965, "creation_date": 1490183965, "answer_id": 42951018, "question_id": 42948556, "link": "https://stackoverflow.com/questions/42948556/iterate-go-map-get-index/42951018#42951018", "title": "Iterate Go map get index", "body": "<p>Map entries have no index in Go; there's no way you can get an index out of any element. Also, each time you iterate on a map with <code>range</code>, you get a different order - another hint that there's no index concept in maps.</p>\n\n<p>Indexes are related to ordered data structures only (e.g. arrays, slices, lists, etc), not maps. Take a look at <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-maps-in-action</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 1595, "user_id": 3842464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Vja16.png?s=128&g=1", "display_name": "EdwinGuo", "link": "https://stackoverflow.com/users/3842464/edwinguo"}, "is_accepted": false, "score": 3, "last_activity_date": 1526522989, "creation_date": 1526522989, "answer_id": 50382365, "question_id": 42948556, "link": "https://stackoverflow.com/questions/42948556/iterate-go-map-get-index/50382365#50382365", "title": "Iterate Go map get index", "body": "<p>A Simple way to achieve index while looping through a map:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    mm := map[string]int{\"xx\" : 1, \"gg\" : 2}\n    cnt := 0\n    for a, b:= range mm{\n        fmt.Println(\"a\", a, \"b\",b, \"c\" , cnt)\n        cnt++\n    }\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p>And prints:</p>\n\n<pre><code>a xx b 1 c 0\na gg b 2 c 1\nHello, playground\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9765, "favorite_count": 0, "accepted_answer_id": 42950177, "answer_count": 4, "score": 5, "last_activity_date": 1526522989, "creation_date": 1490177562, "last_edit_date": 1490182068, "question_id": 42948556, "link": "https://stackoverflow.com/questions/42948556/iterate-go-map-get-index", "title": "Iterate Go map get index", "body": "<p>In order to use <code>revel</code>'s <a href=\"https://revel.github.io/manual/templates.html#even\" rel=\"nofollow noreferrer\"><code>even</code></a> keyword in templates I would like to get the index of a map entry when iterating with <code>range</code>. Is there any way to do so? \nMy map has the structure:</p>\n\n<pre><code>map[string][]string\n</code></pre>\n"}, {"tags": ["mysql", "go", "haproxy", "failover", "fault-tolerance"], "comments": [{"owner": {"reputation": 2271, "user_id": 1140727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/VAyCK.jpg?s=128&g=1", "display_name": "Ivanov", "link": "https://stackoverflow.com/users/1140727/ivanov"}, "edited": false, "score": 0, "creation_date": 1490178521, "post_id": 42946855, "comment_id": 72993062, "body": "please post all details about your MySQL cluster setup (config files and what you did). This &quot;set up replication in MySQL, but we are struggling with the failover part&quot; not good. <code>HAProxy</code> is recommended for load balancing and failover, but you need anyway a working MySQL setup."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7750281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc48799c63050561431f47cf392ebf45?s=128&d=identicon&r=PG&f=1", "display_name": "Hellenberg", "link": "https://stackoverflow.com/users/7750281/hellenberg"}, "edited": false, "score": 0, "creation_date": 1553589089, "post_id": 42949912, "comment_id": 97429372, "body": "I ended up using HAProxy running on a single server to decide which database to send requests to. It is still a SPOF, but it should be more stable and it was also hosted in the cloud. By using HAProxy we were able to direct some traffic that can accept some stale data, to read from the secondary database."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 0, "last_activity_date": 1490180896, "creation_date": 1490180896, "answer_id": 42949912, "question_id": 42946855, "link": "https://stackoverflow.com/questions/42946855/setting-up-servers-with-fault-tolerance-using-go-and-mysql-failover/42949912#42949912", "title": "Setting up servers with fault tolerance using Go and MySQL (failover)", "body": "<p>If you want two identical servers connecting to their local MySQL instances, you need a way of deciding which one is the production server. There are a number of solutions for that, including</p>\n\n<ul>\n<li>Setting up a reverse proxy, as you mention, but then, your proxy\nitself becomes a SPOF,</li>\n<li>Using a floating IP, also known as a failover\nIP, but this only works if your host supports it. Cloud providers\ntypically support them, as well as some bare metal server providers.</li>\n</ul>\n\n<p>There is nothing specific to Go as far as I know.</p>\n"}], "owner": {"reputation": 3, "user_id": 7750281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc48799c63050561431f47cf392ebf45?s=128&d=identicon&r=PG&f=1", "display_name": "Hellenberg", "link": "https://stackoverflow.com/users/7750281/hellenberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "accepted_answer_id": 42949912, "answer_count": 1, "score": -1, "last_activity_date": 1490192091, "creation_date": 1490173205, "last_edit_date": 1490192091, "question_id": 42946855, "link": "https://stackoverflow.com/questions/42946855/setting-up-servers-with-fault-tolerance-using-go-and-mysql-failover", "title": "Setting up servers with fault tolerance using Go and MySQL (failover)", "body": "<p>I am working in a project where we are using Go as a web server and MySQL.\nWe have been told to implement fault tolerance to handle a hardware crash. We were given 2 servers which have MySQL and the Go-server on them. </p>\n\n<p>We have succesfully set up replication in MySQL, but we are struggling with the failover part. Our thought was to get an extra server with HAProxy to have a primary server and then being able to failover to the backup server.\nWe also considered using MySQL failover, but did not see how we could redirect the traffic using it.</p>\n\n<p>Is this a reasonable plan? Or what would you recommend that we do instead? </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 2, "last_activity_date": 1490169224, "creation_date": 1490169224, "answer_id": 42945695, "question_id": 42945587, "link": "https://stackoverflow.com/questions/42945587/why-this-channel-operation-will-show-dead-lock-error/42945695#42945695", "title": "Why this channel operation will show dead lock error?", "body": "<p>A write to an unbuffered channel will block until there's someone reading it at the other end. In your case <code>updateM</code> will block indefinitely because to continue, it needs to continue so that it can read from the channel, which it can't because it's not reading from the channel.</p>\n\n<p>Channels are for communication between goroutines, they don't make sense for talking to yourself.</p>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 7265513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIEhO.jpg?s=128&g=1", "display_name": "Y.Ido", "link": "https://stackoverflow.com/users/7265513/y-ido"}, "edited": false, "score": 0, "creation_date": 1490172886, "post_id": 42945813, "comment_id": 72989179, "body": "Thanks for your help"}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 4, "last_activity_date": 1490169616, "creation_date": 1490169616, "answer_id": 42945813, "question_id": 42945587, "link": "https://stackoverflow.com/questions/42945587/why-this-channel-operation-will-show-dead-lock-error/42945813#42945813", "title": "Why this channel operation will show dead lock error?", "body": "<p>From the <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<p>If the channel is unbuffered, the sender blocks until the receiver has received the value. If the channel has a buffer, the sender blocks only until the value has been copied to the buffer; if the buffer is full, this means waiting until some receiver has retrieved a value.</p>\n\n<p>You can make it not blocking by changing the channel creation to</p>\n\n<pre><code>var update  = make(chan int, 1)\n</code></pre>\n\n<p>so that there's room for one item in the channel before it blocks.</p>\n"}], "owner": {"reputation": 193, "user_id": 7265513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GIEhO.jpg?s=128&g=1", "display_name": "Y.Ido", "link": "https://stackoverflow.com/users/7265513/y-ido"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1490169885, "creation_date": 1490168897, "last_edit_date": 1490169885, "question_id": 42945587, "link": "https://stackoverflow.com/questions/42945587/why-this-channel-operation-will-show-dead-lock-error", "title": "Why this channel operation will show dead lock error?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nvar money int = 100\nvar update  = make(chan int) \n\nfunc updateM( count int)  {\n    update&lt;- count\n}\n\nfunc main() {\n    updateM(200)\n    fmt.Println(&lt;-update)\n\n}\n</code></pre>\n\n<p>but when i change the code to add a go in front of updateM(200)\nthen no error</p>\n\n<pre><code>func main() {\n        go updateM(200)\n        fmt.Println(&lt;-update)\n\n    }\n</code></pre>\n\n<p>could anyone tell me , i am new learner of Go. Thanks a lot.</p>\n"}, {"tags": ["go", "types", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1490169180, "post_id": 42945530, "comment_id": 72987136, "body": "Please add a runnable link. For example using <a href=\"https://github.com/plutov/playgo\" rel=\"nofollow noreferrer\">github.com/plutov/playgo</a>"}, {"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "reply_to_user": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1490177488, "post_id": 42945530, "comment_id": 72992336, "body": "Here&#39;s a runnable example: <a href=\"https://play.golang.org/p/MrhlFdBN3w\" rel=\"nofollow noreferrer\">play.golang.org/p/MrhlFdBN3w</a>"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1490178509, "post_id": 42945530, "comment_id": 72993059, "body": "I think this one is enough:    return info.Types[v].Type.String() == &quot;error&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "edited": false, "score": 0, "creation_date": 1490176804, "post_id": 42946764, "comment_id": 72991818, "body": "In regular code, yes. But I&#39;m scanning the AST of a source file, so I have an ast.Expr as input."}], "tags": [], "owner": {"reputation": 2268, "user_id": 1861412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDcs9.jpg?s=128&g=1", "display_name": "Cristian Greco", "link": "https://stackoverflow.com/users/1861412/cristian-greco"}, "is_accepted": false, "score": 1, "last_activity_date": 1490182420, "last_edit_date": 1490182420, "creation_date": 1490172960, "answer_id": 42946764, "question_id": 42945530, "link": "https://stackoverflow.com/questions/42945530/go-ast-types-how-to-tell-an-error/42946764#42946764", "title": "Go AST / Types - how to tell an error?", "body": "<p><a href=\"https://golang.org/doc/effective_go.html#interface_conversions\" rel=\"nofollow noreferrer\">Type assertion</a> is the idiomatic way of checking the type of a variable.</p>\n\n<p>Given you're handling an AST expression, I'd try to check if the underlying type is an interface and if the <code>Error()</code> method is implemented:</p>\n\n<pre><code>isError := func(v ast.Expr, info *types.Info) bool {\n    if intf, ok := info.TypeOf(v).Underlying().(*types.Interface); ok {\n        return intf.NumMethods() == 1 &amp;&amp; intf.Method(0).FullName() == \"(error).Error\"\n    }\n    return false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "is_accepted": false, "score": 0, "last_activity_date": 1490254825, "creation_date": 1490254825, "answer_id": 42969919, "question_id": 42945530, "link": "https://stackoverflow.com/questions/42945530/go-ast-types-how-to-tell-an-error/42969919#42969919", "title": "Go AST / Types - how to tell an error?", "body": "<p>I think I prefer this solution:</p>\n\n<p><a href=\"https://play.golang.org/p/MA7F4Zpwqt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MA7F4Zpwqt</a></p>\n\n<pre><code>isError := func(v ast.Expr, info *types.Info) bool {\n    if n, ok := info.TypeOf(v).(*types.Named); ok {\n        o := n.Obj()\n        return o != nil &amp;&amp; o.Pkg() == nil &amp;&amp; o.Name() == \"error\"\n    }\n    return false\n}\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 1126290, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/b05a05b697f6245e72f30975ca80a781?s=128&d=identicon&r=PG", "display_name": "David Brophy", "link": "https://stackoverflow.com/users/1126290/david-brophy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490254825, "creation_date": 1490168606, "question_id": 42945530, "link": "https://stackoverflow.com/questions/42945530/go-ast-types-how-to-tell-an-error", "title": "Go AST / Types - how to tell an error?", "body": "<p>Is there a better way of doing this? I need to know if the type of v is the built-in \"error\" type. I feel like there should be a neater way of doing this:</p>\n\n<pre><code>import (\n    \"go/ast\"\n    \"go/types\"\n)\n\nfunc IsError(v ast.Expr, info types.Info) bool {\n    t := info.Types[v]\n    return t.Type.String() == \"error\" &amp;&amp;\n        t.Type.Underlying().String() == \"interface{Error() string}\"\n}\n</code></pre>\n"}, {"tags": ["sockets", "go"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490167183, "post_id": 42945086, "comment_id": 72986035, "body": "There is a difference between &#39;socket is closed&#39; and &#39;socket gets disconnected&#39;. Which are you asking about?"}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490167265, "post_id": 42945086, "comment_id": 72986071, "body": "@EJP What do you mean? If it&#39;s disconnected, then it&#39;s closed, I don&#39;t get it ..."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490167388, "post_id": 42945086, "comment_id": 72986121, "body": "No. If it&#39;s disconnected you can still use it, read from it and get end of stream, or write to it and get &#39;connection reset&#39; errors, etc. It&#39;s only closed when <i>you</i> close it."}, {"owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490167504, "post_id": 42945086, "comment_id": 72986185, "body": "@EJP Then I want to know both of them"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1490167864, "post_id": 42945086, "comment_id": 72986399, "body": "Then the part about knowing when you&#39;ve closed your own socket is trivial."}], "answers": [{"tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": true, "score": 1, "last_activity_date": 1490170028, "creation_date": 1490170028, "answer_id": 42945935, "question_id": 42945086, "link": "https://stackoverflow.com/questions/42945086/io-copy-how-to-know-if-a-socket-is-closed-or-disconnected/42945935#42945935", "title": "io.Copy: How to know if a socket is closed or disconnected", "body": "<p>If connection is closed, <code>io.Copy()</code> will return <code>(0, io.EOF)</code>, so you can check it.</p>\n"}], "owner": {"reputation": 19241, "user_id": 614944, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f92772ec8a16758d669026f736aa7f0f?s=128&d=identicon&r=PG", "display_name": "daisy", "link": "https://stackoverflow.com/users/614944/daisy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 574, "favorite_count": 0, "accepted_answer_id": 42945935, "answer_count": 1, "score": -1, "last_activity_date": 1490170028, "creation_date": 1490167046, "last_edit_date": 1490167518, "question_id": 42945086, "link": "https://stackoverflow.com/questions/42945086/io-copy-how-to-know-if-a-socket-is-closed-or-disconnected", "title": "io.Copy: How to know if a socket is closed or disconnected", "body": "<p>I have a simple program that connects a program's stdin, stdout and stderr to a socket, like this,</p>\n\n<pre><code>go func() {\n    defer conn.Close();\n    defer stdin.Close();\n\n    io.Copy(stdin, conn);\n}();\n\ngo func() {\n    defer conn.Close();\n    defer stdout.Close();\n    defer stderr.Close();\n\n    io.Copy(conn, stdout);\n    io.Copy(conn, stderr);\n}();\n\nselect{}\n</code></pre>\n\n<p>I have two problems,</p>\n\n<ol>\n<li>I have to keep these two goroutines running by doing a <code>select{}</code></li>\n<li>When the socket get disconnected, there's no way to tell it. I need to terminate the <code>select{}</code> loop if that happens.</li>\n</ol>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1490151746, "post_id": 42941676, "comment_id": 72980509, "body": "Yes, defer calls the function on every exit path, so it is possible. It&#39;s arguably not as clear though. Instead, consider extracting the bulk of the code into a separate canGzip(request) function."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1490155317, "post_id": 42941676, "comment_id": 72981495, "body": "Thanks for the advice on canGzip(request) too! Didn&#39;t occur to me that I could wrap those in a separate function. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1490209003, "post_id": 42942106, "comment_id": 73015081, "body": "Excellent and thorough explanation!"}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 5, "last_activity_date": 1490152657, "creation_date": 1490152657, "answer_id": 42942106, "question_id": 42941676, "link": "https://stackoverflow.com/questions/42941676/what-happens-if-i-defer-a-function-inside-a-function-that-returns-a-function-ho/42942106#42942106", "title": "What happens if I defer a function inside a function that returns a function? How is the ordering?", "body": "<p>golang <a href=\"https://golang.org/ref/spec#Calls\" rel=\"noreferrer\">spec</a></p>\n\n<blockquote>\n  <p>In a function call, the function value and arguments are evaluated in the usual order. After they are evaluated, the parameters of the call are passed by value to the function and the called function begins execution. </p>\n</blockquote>\n\n<p><code>gzipHandler(fileServer())</code> is somewhat like this:</p>\n\n<pre><code>a:=fileServer()\ngzipHandler(a)\n</code></pre>\n\n<p>So, obviously <code>fileServer()</code> is executed first.</p>\n\n<p>but i think what confuse you is when will <code>defer</code> statement execute, right?</p>\n\n<p>according to the <a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"noreferrer\">spec</a></p>\n\n<blockquote>\n  <p>Each time a \"defer\" statement executes, the function value and parameters to the call are evaluated as usual and saved anew but the actual function is not invoked. Instead, deferred functions are invoked immediately before the surrounding function returns, in the reverse order they were deferred. If a deferred function value evaluates to nil, execution panics when the function is invoked, not when the \"defer\" statement is executed.</p>\n</blockquote>\n\n<p>an example to explain:</p>\n\n<pre><code>func t() {\n        i := 1\n\n        defer fmt.Println(\"first defer:\", i)\n        defer func() {\n                fmt.Println(\"second defer:\", i)\n        }()\n\n        i = 2\n        fmt.Println(\"t return\")\n}\n</code></pre>\n\n<p><code>t()</code> will print:</p>\n\n<pre><code>t return\nsecond defer: 2\nfirst defer: 1\n</code></pre>\n\n<p>in your code, the deferred function \"<code>next.ServeHTTP</code>\" are invoked before anonymous function <code>func(w http.ResponseWriter, r *http.Request)</code> returns.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 42942106, "answer_count": 1, "score": 3, "last_activity_date": 1490152657, "creation_date": 1490149954, "question_id": 42941676, "link": "https://stackoverflow.com/questions/42941676/what-happens-if-i-defer-a-function-inside-a-function-that-returns-a-function-ho", "title": "What happens if I defer a function inside a function that returns a function? How is the ordering?", "body": "<p>I am trying to create a very simple gzip middleware for static files. But I am calling <code>next.ServeHTTP(w, r)</code> 5 different places in the code, what happens if I defer this? Will this be called before the function that is returned is run?</p>\n\n<p>This is what I have:</p>\n\n<pre><code>func gzipHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        if !strings.Contains(r.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n            // If for some weird reason client does not understand gzip, then continue.\n            next.ServeHTTP(w, r)\n            return\n        }\n        path := filepath.FromSlash(filepath.Join(cfg.PublicHTML, r.URL.Path))\n        if _, err := os.Stat(path); os.IsNotExist(err) {\n            // If file or folder does not exists, then continue.\n            next.ServeHTTP(w, r)\n            return\n        }\n        var ext string\n        for _, v := range cfg.GzipExt {\n            if strings.HasSuffix(r.URL.Path, v) {\n                ext = v\n            }\n        }\n        if ext == \"\" {\n            // This file should not be served as gzipped content.\n            next.ServeHTTP(w, r)\n            return\n        }\n        // Only serve gzipped file if it exists.\n        if _, err := os.Stat(path + \".gz\"); os.IsNotExist(err) {\n            // TODO: Create the gzipped file.\n            // http://stackoverflow.com/questions/16890648/how-can-i-use-golangs-compress-gzip-package-to-gzip-a-file\n            next.ServeHTTP(w, r)\n            return\n        }\n        w.Header().Add(\"Content-Encoding\", \"gzip\")\n        r.URL.Path = r.URL.Path + \".gz\"\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>Would it be possible here to defer next.ServeHTTP(w, r)? Like this:</p>\n\n<pre><code>func gzipHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        defer next.ServeHTTP(w, r)\n        if !strings.Contains(r.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n            // If for some weird reason client does not understand gzip, then continue.\n            return\n        }\n        path := filepath.FromSlash(filepath.Join(cfg.PublicHTML, r.URL.Path))\n        if _, err := os.Stat(path); os.IsNotExist(err) {\n            // If file or folder does not exists, then continue.\n            return\n        }\n        var ext string\n        for _, v := range cfg.GzipExt {\n            if strings.HasSuffix(r.URL.Path, v) {\n                ext = v\n            }\n        }\n        if ext == \"\" {\n            // This file should not be served as gzipped content.\n            return\n        }\n        // Only serve gzipped file if it exists.\n        if _, err := os.Stat(path + \".gz\"); os.IsNotExist(err) {\n            // TODO: Create the gzipped file.\n            // http://stackoverflow.com/questions/16890648/how-can-i-use-golangs-compress-gzip-package-to-gzip-a-file\n            return\n        }\n        w.Header().Add(\"Content-Encoding\", \"gzip\")\n        r.URL.Path = r.URL.Path + \".gz\"\n    })\n}\n</code></pre>\n\n<p>I am using this in my main() function like this to serve static files:</p>\n\n<pre><code>router.NotFound = gzipHandler(fileServer())\n</code></pre>\n\n<p>If I defer next.ServeHTTP(w, r) like this, will it be executed before fileServer() is executed?</p>\n"}, {"tags": ["linux", "go", "centos", "yum"], "comments": [{"owner": {"reputation": 1700, "user_id": 3517823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6ead39c453c59e5666b801a3a17919d?s=128&d=identicon&r=PG&f=1", "display_name": "Arash", "link": "https://stackoverflow.com/users/3517823/arash"}, "edited": false, "score": 0, "creation_date": 1490161831, "post_id": 42941488, "comment_id": 72983613, "body": "Look <a href=\"https://golang.org/doc/install#uninstall\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 2, "creation_date": 1490171060, "post_id": 42941488, "comment_id": 72988141, "body": "I think serverfault is a better place :)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1548086712, "post_id": 42941488, "comment_id": 95407935, "body": "You can&#39;t remove a package which isn&#39;t installed!"}], "answers": [{"tags": [], "owner": {"reputation": 890, "user_id": 3364249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQltG.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3364249/marco"}, "is_accepted": false, "score": 9, "last_activity_date": 1490170560, "creation_date": 1490170560, "answer_id": 42946072, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos/42946072#42946072", "title": "How to remove golang packages from CentOS", "body": "<p>Golang is currently only available in version 1.6.3 on CentOS. Therefore you should \"install\" it manually as described <a href=\"https://golang.org/doc/install#install\" rel=\"noreferrer\">here</a>. I assume this is what you did and therefore, you will have to uninstall it manually as well.</p>\n\n<p><strong>1. Remove the Go binary folder</strong></p>\n\n<p>To find out where you installed Go, run</p>\n\n<pre><code>which go\n</code></pre>\n\n<p>which will return the location of the Go binary.</p>\n\n<p>Next, remove the Go-Folder (as returned by the command above), for example:</p>\n\n<pre><code>[sudo] rm -rf /usr/local/go\n</code></pre>\n\n<p><strong>2. Remove extension of Environment varialbles</strong></p>\n\n<p>Finally, you should remove the extension of environment variables. Usually this is done in one of the following files</p>\n\n<pre><code>/etc/profile\n~/.profile\n</code></pre>\n\n<p>Remove any line that either sets the GOROOT or extends the PATH environment variable, so everything that looks like this:</p>\n\n<pre><code>export PATH=$PATH:/usr/local/go/bin\nexport GOROOT=$HOME/go1.X\nexport PATH=$PATH:$GOROOT/bin\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 10776395, "user_type": "registered", "profile_image": "https://graph.facebook.com/966884223522215/picture?type=large", "display_name": "Stephen", "link": "https://stackoverflow.com/users/10776395/stephen"}, "is_accepted": false, "score": 0, "last_activity_date": 1544540985, "creation_date": 1544540985, "answer_id": 53726992, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos/53726992#53726992", "title": "How to remove golang packages from CentOS", "body": "<p>If you only want to remove packages, you can enter the go source directory and remove the packages directory manually.</p>\n\n<p>if you don't know where is your gopath, you can get it by type <code>go env</code> or <code>go env gopath</code>. :)</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 6616405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca74e4500b56072d0560a7d0db45a16e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhao Shengwei", "link": "https://stackoverflow.com/users/6616405/zhao-shengwei"}, "is_accepted": false, "score": 2, "last_activity_date": 1548068355, "creation_date": 1548068355, "answer_id": 54288500, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos/54288500#54288500", "title": "How to remove golang packages from CentOS", "body": "<p>you can delete go directory by command \"find\",then install go use compile source code,finally set GOROOT and GOPATH in your environment.</p>\n"}, {"tags": [], "owner": {"reputation": 397, "user_id": 4997793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5dkyN.jpg?s=128&g=1", "display_name": "Nima Ghoroubi", "link": "https://stackoverflow.com/users/4997793/nima-ghoroubi"}, "is_accepted": false, "score": 0, "last_activity_date": 1556625271, "creation_date": 1556625271, "answer_id": 55920411, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos/55920411#55920411", "title": "How to remove golang packages from CentOS", "body": "<p>The best way is using a package manager to do.\nYou can use <a href=\"https://golang.github.io/dep/\" rel=\"nofollow noreferrer\">Dep</a> or <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">Go modules</a></p>\n"}, {"tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": false, "score": 0, "last_activity_date": 1556644215, "creation_date": 1556644215, "answer_id": 55925775, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos/55925775#55925775", "title": "How to remove golang packages from CentOS", "body": "<p>You don't need to do anything, because none of those packages are installed on your system.</p>\n\n<p>You have listed <em>available</em> packages, not <em>installed</em> packages.</p>\n\n<p>If the package was installed, a <code>@</code> symbol would appear next to the repository name in the third column. You could then remove it, and the <code>@</code> would disappear.</p>\n"}], "owner": {"reputation": 3332, "user_id": 1900290, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/6faa40dca462409201ce09fd4f40b4d4?s=128&d=identicon&r=PG", "display_name": "Rpj", "link": "https://stackoverflow.com/users/1900290/rpj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3669, "favorite_count": 0, "answer_count": 5, "score": -1, "last_activity_date": 1556644215, "creation_date": 1490148688, "last_edit_date": 1490160001, "question_id": 42941488, "link": "https://stackoverflow.com/questions/42941488/how-to-remove-golang-packages-from-centos", "title": "How to remove golang packages from CentOS", "body": "<p>How to remove golang packages from CentOS. I am unable to \"yum remove golang\" as it returns a no match error. How do I perform wildcard removal on CentOS to remove all the below packages</p>\n\n<pre><code>golang.x86_64                           1.6.3-2.el7                    base     \ngolang-bin.x86_64                       1.6.3-2.el7                    base     \ngolang-bitbucket-kardianos-osext-devel.noarch\ngolang-bitbucket-ww-goautoneg-devel.noarch\ngolang-bitbucket-ww-goautoneg-unit-test.x86_64\ngolang-cover.x86_64                     0-1.0.hgd32b5854c941.el7       epel     \ngolang-docs.noarch                      1.6.3-2.el7                    base     \ngolang-github-codegangsta-cli-devel.noarch\ngolang-github-coreos-go-log-devel.noarch\ngolang-github-coreos-go-systemd-devel.noarch\ngolang-github-cpuguy83-go-md2man.x86_64 1.0.4-2.el7_2                  base     \ngolang-github-cpuguy83-go-md2man-devel.noarch\ngolang-github-docopt-docopt-go-devel.noarch\ngolang-github-fsouza-go-dockerclient-devel.x86_64\ngolang-github-godbus-dbus-devel.noarch  0-0.1.gitcb98efb.el7.centos    extras   \ngolang-pkg-linux-386.noarch             1.4.2-1.el7.centos             extras   \ngolang-pkg-linux-amd64.noarch           1.4.2-1.el7.centos             extras   \ngolang-pkg-linux-arm.noarch             1.4.2-1.el7.centos             extras   \ngolang-pkg-netbsd-386.noarch            1.4.2-1.el7.centos             extras   \ngolang-pkg-netbsd-amd64.noarch          1.4.2-1.el7.centos             extras   \ngolang-pkg-netbsd-arm.noarch            1.4.2-1.el7.centos             extras   \ngolang-pkg-openbsd-386.noarch           1.4.2-1.el7.centos             extras   \ngolang-pkg-openbsd-amd64.noarch         1.4.2-1.el7.centos             extras   \ngolang-pkg-plan9-386.noarch             1.4.2-1.el7.centos             extras   \ngolang-pkg-plan9-amd64.noarch           1.4.2-1.el7.centos             extras   \ngolang-pkg-windows-386.noarch           1.4.2-1.el7.centos             extras   \ngolang-pkg-windows-amd64.noarch         1.4.2-1.el7.centos             extras   \ngolang-src.noarch                       1.6.3-2.el7                    base     \ngolang-tests.noarch                     1.6.3-2.el7                    base     \ngolang-vet.x86_64                       0-1.0.hgd32b5854c941.el7       epel     \ngolang-vim.noarch                       1.3.3-2.el7_0                  extras   \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 5, "creation_date": 1490146720, "post_id": 42941218, "comment_id": 72979113, "body": "You don&#39;t import files, you import packages. So, what you &quot;love to have&quot; is unlikely to be possible."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490147838, "post_id": 42941218, "comment_id": 72979421, "body": "There is no rule that i know of that says you must have a <code>src</code> directory in your Go project, there is a src directory in the <code>$GOPATH</code>, in which your Go project should live, but the directories inside your project... you can call them whatever you want."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1490161496, "post_id": 42941218, "comment_id": 72983502, "body": "Your last two lines work fine, just put your lib stuff in pkg main, call the functions direct and be happy. If you want a separate pkg though, it goes in a folder."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 3, "last_activity_date": 1490191543, "creation_date": 1490191543, "answer_id": 42953977, "question_id": 42941218, "link": "https://stackoverflow.com/questions/42941218/importing-a-file-that-resides-in-the-same-directory/42953977#42953977", "title": "Importing a file that resides in the same directory", "body": "<p>This is the layout you want to have:</p>\n\n<pre><code>main.go\nlib.go\n</code></pre>\n\n<p>And that is no problem. Go allows you to have such a file structure. And it is used by a lot of Go programms. But they both need to be defined as <code>package main</code>. If you ask why? Because that is the language specification. The inventors of Go defined it like that.</p>\n\n<p>The good thing here is, that you don't have to import anything, because the go compiler knows that these two files belong into the package main. </p>\n"}], "owner": {"reputation": 27031, "user_id": 1968972, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/bfdd4ec8dff5c7635520fe98348524ec?s=128&d=identicon&r=PG", "display_name": "exebook", "link": "https://stackoverflow.com/users/1968972/exebook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1490191543, "creation_date": 1490146646, "last_edit_date": 1490182729, "question_id": 42941218, "link": "https://stackoverflow.com/questions/42941218/importing-a-file-that-resides-in-the-same-directory", "title": "Importing a file that resides in the same directory", "body": "<p>One thing that makes it difficult for me to program in Go is that I must put modules (or I should call them packages?) that I want to import in my main module in separate directories, and even more, there must be an <code>src</code> directory. Is there a way to import the file that resides in the same dir as the main module?</p>\n\n<p>Current directory layout:</p>\n\n<pre><code>main.go\nsrc/lib/lib.go\n</code></pre>\n\n<p>Now I can do <code>import \"lib\"</code></p>\n\n<p>What I would love to have:</p>\n\n<pre><code>main.go\nlib.go\n</code></pre>\n\n<p>And still make the compiler happily find <code>lib.go</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 1, "creation_date": 1490144213, "post_id": 42940810, "comment_id": 72978441, "body": "The format specifier for printing the type is <code>%T</code>, not <code>%t</code>."}, {"owner": {"reputation": 11, "user_id": 1690484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2262032f7f8aeb5ef29755152e6e0e6?s=128&d=identicon&r=PG", "display_name": "zzWinD", "link": "https://stackoverflow.com/users/1690484/zzwind"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1490144542, "post_id": 42940810, "comment_id": 72978527, "body": "Oh,this is my wrong.Sorry,But do you know why i type int the compiler will error?"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1490145076, "post_id": 42940810, "comment_id": 72978670, "body": "See the linked question. You are mixing <code>int</code> and <code>float</code> in one computation without explicit conversion. This is not allowed since information is potentially lost. You have to convert the <code>float</code> or the <code>int</code> to the respective other type of the operation."}, {"owner": {"reputation": 11, "user_id": 1690484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2262032f7f8aeb5ef29755152e6e0e6?s=128&d=identicon&r=PG", "display_name": "zzWinD", "link": "https://stackoverflow.com/users/1690484/zzwind"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1490146053, "post_id": 42940810, "comment_id": 72978917, "body": "en,but when i without explicit abc as int on first example.on runtime,print abc&#39;s type is <b>int</b>,why this&#39;s no any error?"}, {"owner": {"reputation": 11, "user_id": 1690484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2262032f7f8aeb5ef29755152e6e0e6?s=128&d=identicon&r=PG", "display_name": "zzWinD", "link": "https://stackoverflow.com/users/1690484/zzwind"}, "reply_to_user": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "edited": false, "score": 0, "creation_date": 1491351587, "post_id": 42940810, "comment_id": 73510690, "body": "const abc = 11 //this is untyped int &lt;br/&gt;"}], "owner": {"reputation": 11, "user_id": 1690484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2262032f7f8aeb5ef29755152e6e0e6?s=128&d=identicon&r=PG", "display_name": "zzWinD", "link": "https://stackoverflow.com/users/1690484/zzwind"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1490144439, "answer_count": 0, "score": 0, "last_activity_date": 1490144657, "creation_date": 1490143791, "last_edit_date": 1490144657, "question_id": 42940810, "link": "https://stackoverflow.com/questions/42940810/how-to-const-type-deduction", "closed_reason": "Duplicate", "title": "How to const type deduction", "body": "<pre><code>func main() {\n    const abc = 111\n    fmt.Printf(\"%T\\n\", abc)\n    fmt.Println(math.Pi * abc)\n    fmt.Printf(\"%T\", math.Pi)\n}\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>int\n348.71678454846705\nfloat64\n</code></pre>\n\n<p>but when I type <code>abc</code> explicitly as <code>int</code></p>\n\n<pre><code>func main() {\n    const abc int = 111\n    fmt.Printf(\"%t\\n\", abc)\n    fmt.Println(math.Pi * abc)\n    fmt.Printf(\"%t\", math.Pi)\n}\n</code></pre>\n\n<p>the result is an error stating:</p>\n\n<pre><code>constant 3.14159 truncated to integer\n</code></pre>\n\n<p>I want to know why in the first example the type of <code>abc</code> is <code>int</code> but when I type <code>abc</code> explicitly as <code>int</code> the compiler gives me an error.</p>\n"}, {"tags": ["unit-testing", "debugging", "testing", "go", "code-duplication"], "comments": [{"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1490155778, "post_id": 42940676, "comment_id": 72981636, "body": "Please provide sme runnable examples."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490165997, "post_id": 42940676, "comment_id": 72985422, "body": "&quot;Go does not allow to debug tests&quot; is a very bold statement of which I think it is totally false. How come you think this is true?"}, {"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490174248, "post_id": 42940676, "comment_id": 72990008, "body": "@Volker - I think he posted a link about why he <i>thinks</i> this is true."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1490178052, "post_id": 42940676, "comment_id": 72992745, "body": "@jangroth And I think Java cannot be debugged at all because XEDIT cannot do it. We live in a strange world..."}, {"owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "edited": false, "score": 0, "creation_date": 1490193190, "post_id": 42940676, "comment_id": 73003949, "body": "I use VS Code with delve."}, {"owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "edited": false, "score": 0, "creation_date": 1490193561, "post_id": 42940676, "comment_id": 73004277, "body": "I assumed that if there are at least 2 major IDEs that cannot debug (Visual Studio Code and IntelliJ) then it&#39;s not possible to debug."}], "answers": [{"tags": [], "owner": {"reputation": 2268, "user_id": 1861412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDcs9.jpg?s=128&g=1", "display_name": "Cristian Greco", "link": "https://stackoverflow.com/users/1861412/cristian-greco"}, "is_accepted": true, "score": 3, "last_activity_date": 1490209363, "last_edit_date": 1490209363, "creation_date": 1490165811, "answer_id": 42944698, "question_id": 42940676, "link": "https://stackoverflow.com/questions/42940676/how-to-avoid-duplicate-tests-in-go/42944698#42944698", "title": "How to avoid duplicate tests in Go?", "body": "<p>I think your IDE is unable to debug tests.</p>\n\n<p>Try something different. For example, as of today, the early access edition of <a href=\"https://www.jetbrains.com/go/\" rel=\"nofollow noreferrer\">Gogland</a> works quite well with regards to debugging, even with tests. It uses the <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">Delve</a> debugger under the hood, so you can even resort to <a href=\"https://github.com/derekparker/delve/tree/master/Documentation\" rel=\"nofollow noreferrer\">run the debugger</a> manually from terminal or check to see if it is already <a href=\"https://github.com/derekparker/delve/blob/master/Documentation/EditorIntegration.md\" rel=\"nofollow noreferrer\">integrated</a> with your IDE of choice.</p>\n"}], "owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 42944698, "answer_count": 1, "score": 0, "last_activity_date": 1590796332, "creation_date": 1490142797, "last_edit_date": 1590796332, "question_id": 42940676, "link": "https://stackoverflow.com/questions/42940676/how-to-avoid-duplicate-tests-in-go", "title": "How to avoid duplicate tests in Go?", "body": "<p>Since Go <a href=\"https://stackoverflow.com/questions/34889319/go-tests-debugging\">does not allow to debug tests in some IDEs</a> (see also this <a href=\"https://github.com/go-lang-plugin-org/go-lang-idea-plugin/issues/1855\" rel=\"nofollow noreferrer\">issue</a>) I had to write my tests twice in my <a href=\"https://github.com/drylib/drylib/tree/master/go/src/queue\" rel=\"nofollow noreferrer\">queue implementation</a>.</p>\n\n<p>One time inside <a href=\"https://github.com/drylib/drylib/blob/master/go/src/queue/main/main.go\" rel=\"nofollow noreferrer\">main.go</a>, second time - inside <a href=\"https://github.com/drylib/drylib/blob/master/go/src/queue/test/queue_test.go\" rel=\"nofollow noreferrer\">queue_test.go</a></p>\n\n<p>I use Visual Studio Code with delve.</p>\n\n<p>What is the best IDE or pattern to debug Go tests without duplicating them ?</p>\n"}, {"tags": ["go", "time", "timezone"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1490140311, "post_id": 42940065, "comment_id": 72977337, "body": "from the docs &quot;Equal reports whether t and u represent the same time instant. Two times can be equal even if they are in different locations.&quot;"}, {"owner": {"reputation": 459, "user_id": 832169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4796962174e609c97d50ad2f705b394?s=128&d=identicon&r=PG", "display_name": "Steve101", "link": "https://stackoverflow.com/users/832169/steve101"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1490140340, "post_id": 42940065, "comment_id": 72977342, "body": "I agree with @mkopriva, however, it is interesting the time does not change with UTC. It does appear to work with other locations, for example Europe/Berlin, just not UTC."}, {"owner": {"reputation": 195413, "user_id": 634824, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/889cf720c96957e615463b5c903a5e18?s=128&d=identicon&r=PG", "display_name": "Matt Johnson-Pint", "link": "https://stackoverflow.com/users/634824/matt-johnson-pint"}, "edited": false, "score": 1, "creation_date": 1490153067, "post_id": 42940065, "comment_id": 72980865, "body": "Please - and this has been said SO many times already on stackoverflow and elsewhere - Do not attempt to choose a time zone by parsing an abbreviation.  Time zone abbreviations are not standardized, are not unique, and many time zones don&#39;t even <i>have</i> abbreviations.  You should be using IANA tz database identifiers, such as <code>America&#47;Los_Angeles</code> and <code>America&#47;New_York</code>.  Go supports these.  Please read <a href=\"http://stackoverflow.com/tags/timezone/info\">the timezone tag wiki</a>."}], "answers": [{"comments": [{"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1490140751, "post_id": 42940371, "comment_id": 72977470, "body": "Great, thanks for the clarification. Is there a way to test whether <code>sfTime.Before(nyTime)</code> correctly then?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1490140957, "post_id": 42940371, "comment_id": 72977527, "body": "I&#39;m pretty sure <code>Before</code> doesn&#39;t care about the location either. <a href=\"https://play.golang.org/p/DrFoWhT2mQ\" rel=\"nofollow noreferrer\">play.golang.org/p/DrFoWhT2mQ</a>"}, {"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1490156251, "post_id": 42940371, "comment_id": 72981782, "body": "Please check the chosen answer; it turns out that the go playground doesn&#39;t support time zones."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1490173999, "post_id": 42940371, "comment_id": 72989853, "body": "@hlin117 It&#39;s the better answer, well chosen. I&#39;ve updated mine to provide a bit more info."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 2, "last_activity_date": 1490173922, "last_edit_date": 1490173922, "creation_date": 1490140652, "answer_id": 42940371, "question_id": 42940065, "link": "https://stackoverflow.com/questions/42940065/how-to-get-equivalent-time-in-another-timezone/42940371#42940371", "title": "How to get equivalent time in another timezone", "body": "<p>Your examples are working as intended, <a href=\"https://golang.org/pkg/time/#Time.Equal\" rel=\"nofollow noreferrer\">Equal comparse an instant in time</a>. If you want to make sure timezones are equal as well you can do something like <code>t1.Equal(t2) &amp;&amp; t1.Location().String() == t2.Location().String()</code></p>\n\n<p>From the <a href=\"https://golang.org/pkg/time/#Time\" rel=\"nofollow noreferrer\">docs</a> with added emphasis:</p>\n\n<blockquote>\n  <p>Each Time has associated with it a Location, consulted when computing\n  the presentation form of the time, such as in the Format, Hour, and\n  Year methods. The methods Local, UTC, and In return a Time with a\n  specific location. <strong>Changing the location in this way changes only the\n  presentation; it does not change the instant in time</strong> being denoted and\n  therefore does not affect the computations described in earlier\n  paragraphs.</p>\n</blockquote>\n\n<p><strike>So, as far as I understand, whether you do <code>time.Parse(\"... PDT\")</code>, <code>time.Parse(\"... EDT\")</code>, or <code>sfTime.In(time.UTC)</code> you always get the same time instant, the same number of seconds since 1970 and therefore calling <code>Equal</code>, <code>Before</code>, and <code>After</code> on those Time values will return the same result, whatever the <code>Location</code>.</strike></p>\n\n<p><strong>Update</strong>: I would just like to add to the chosen answer, that this is not Playground specific, the original examples behave the same way on my machine and if you look at peterSO's output of the PDT time you can see it's still parsed as UTC. This behaviour is described in the last paragraph of <code>Parse</code>'s <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">documentation</a>. (emphasis mine)</p>\n\n<blockquote>\n  <p>When parsing a time with a zone abbreviation like MST, if the zone\n  abbreviation has a defined offset in the current location, then that\n  offset is used. The zone abbreviation \"UTC\" is recognized as UTC\n  regardless of location. <strong>If the zone abbreviation is unknown, Parse\n  records the time as being in a fabricated location with the given zone\n  abbreviation and a zero offset.</strong> This choice means that such a time can\n  be parsed and reformatted with the same layout losslessly, but the\n  exact instant used in the representation will differ by the actual\n  zone offset. To avoid such problems, <strong>prefer time layouts that use a\n  numeric zone offset, or use ParseInLocation.</strong></p>\n</blockquote>\n\n<p>Here's an example using <code>ParseInLocation</code> and numeric timezone offsets: <a href=\"https://play.golang.org/p/vY0muIvk5d\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vY0muIvk5d</a></p>\n"}, {"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1490142717, "post_id": 42940428, "comment_id": 72977999, "body": "That&#39;s weird @dave, i&#39;m getting <code>true</code> on my local machine, both those playground examples return the same results on my machine..."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 3, "last_activity_date": 1490141018, "last_edit_date": 1592644375, "creation_date": 1490141018, "answer_id": 42940428, "question_id": 42940065, "link": "https://stackoverflow.com/questions/42940065/how-to-get-equivalent-time-in-another-timezone/42940428#42940428", "title": "How to get equivalent time in another timezone", "body": "<p>I think this is a bug with play.golang.org, when I run it on my local machine it returns <code>Are these times equal? false</code> and <code>Are these times still equal? false</code>.</p>\n<p>According to the docs this is the expected behaviour (returning false):</p>\n<blockquote>\n<p>// Equal reports whether t and u represent the same time instant.</p>\n<p>// Two times can be equal even if they are in different locations.</p>\n<p>// For example, 6:00 +0200 CEST and 4:00 UTC are Equal.</p>\n</blockquote>\n<p>Have you tried running it locally?  The playground's time is set to a fixed instant so it may somehow be related to that.</p>\n"}, {"comments": [{"owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "edited": false, "score": 1, "creation_date": 1490156291, "post_id": 42941295, "comment_id": 72981802, "body": "Thanks for the answer. For those who want to run the above script, you can put the code into <code>script.go</code> and then run it by <code>go run script.go</code>."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1490149489, "last_edit_date": 1490149489, "creation_date": 1490147260, "answer_id": 42941295, "question_id": 42940065, "link": "https://stackoverflow.com/questions/42940065/how-to-get-equivalent-time-in-another-timezone/42941295#42941295", "title": "How to get equivalent time in another timezone", "body": "<p>Don't use the Go Playground for time calculations. It runs in a sandbox with a fake time:</p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/\" rel=\"noreferrer\">About the Playground</a></p>\n  \n  <p>The Go Playground is a web service that runs on golang.org's servers.\n  The service receives a Go program, compiles, links, and runs the\n  program inside a sandbox, then returns the output.</p>\n  \n  <p>There are limitations to the programs that can be run in the\n  playground.</p>\n  \n  <p>In the playground the time begins at 2009-11-10 23:00:00 UTC\n  (determining the significance of this date is an exercise for the\n  reader). This makes it easier to cache programs by giving them\n  deterministic output.</p>\n</blockquote>\n\n<p>Also, all times in the Go Playground use the UTC time zone. The Go Playground doesn't use the <a href=\"https://www.iana.org/time-zones\" rel=\"noreferrer\">IANA Time Zone Database</a>.</p>\n\n<p>For example, for this program,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"2006-01-02 15:04 MST\"\n    sfTime, err := time.Parse(layout, \"2017-03-01 12:00 PDT\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(sfTime, sfTime.UTC())\n    nyTime, err := time.Parse(layout, \"2017-03-01 12:00 EDT\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(nyTime, nyTime.UTC())\n    fmt.Printf(\"Are these times equal? %v\\n\", sfTime.Equal(nyTime))\n}\n</code></pre>\n\n<p>Output from the <a href=\"https://play.golang.org/p/zvb3B_XHul\" rel=\"noreferrer\">Go Playground</a> is:</p>\n\n<pre><code>2017-03-01 12:00:00 +0000 PDT 2017-03-01 12:00:00 +0000 UTC\n2017-03-01 12:00:00 +0000 EDT 2017-03-01 12:00:00 +0000 UTC\nAre these times equal? true\n</code></pre>\n\n<p>For the correct output, run the program using the Go gc or gccgo compiler:</p>\n\n<pre><code>$ go run equal.go\n2017-03-01 12:00:00 +0000 PDT 2017-03-01 12:00:00 +0000 UTC\n2017-03-01 11:00:00 -0500 EST 2017-03-01 16:00:00 +0000 UTC\nAre these times equal? false\n</code></pre>\n\n<p>Using the Go gc or gccgo compiler then <code>sfTime.Before(nyTime) == true</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"2006-01-02 15:04 MST\"\n    sfTime, err := time.Parse(layout, \"2017-03-01 12:00 PDT\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(sfTime, sfTime.UTC())\n    nyTime, err := time.Parse(layout, \"2017-03-01 12:00 EDT\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    fmt.Println(nyTime, nyTime.UTC())\n    fmt.Printf(\"Is the SF time before the NY time? %v\\n\", sfTime.Before(nyTime))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run before.go\n2017-03-01 12:00:00 +0000 PDT 2017-03-01 12:00:00 +0000 UTC\n2017-03-01 11:00:00 -0500 EST 2017-03-01 16:00:00 +0000 UTC\nIs the SF time before the NY time? true\n</code></pre>\n\n<p>The Go <code>time</code> package comparison methods (<code>Equal</code>, <code>Before</code>, and <code>After</code>) compare UTC values.</p>\n"}], "owner": {"reputation": 16096, "user_id": 2014591, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7d6cff955bb3f1865a419650bfe1372c?s=128&d=identicon&r=PG", "display_name": "hlin117", "link": "https://stackoverflow.com/users/2014591/hlin117"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9399, "favorite_count": 1, "accepted_answer_id": 42941295, "answer_count": 3, "score": 7, "last_activity_date": 1574154558, "creation_date": 1490138711, "last_edit_date": 1592644375, "question_id": 42940065, "link": "https://stackoverflow.com/questions/42940065/how-to-get-equivalent-time-in-another-timezone", "title": "How to get equivalent time in another timezone", "body": "<p>I'm trying to compare two times from different timezones, and see whether one is before the other. How would I do this in Go?</p>\n<p><strong>Note</strong>: Basically I would like <code>sfTime.Before(nyTime) == true</code>, but my example below would have <code>sfTime.Before(nyTime) == false</code>. Suggestions on how to make this happen would be great.</p>\n<hr />\n<p>For example, in this code...</p>\n<pre><code>layout := &quot;2006-01-02 15:04 MST&quot;\nsfTime, _ := time.Parse(layout, &quot;2017-03-01 12:00 PDT&quot;)\nnyTime, _ := time.Parse(layout, &quot;2017-03-01 12:00 EDT&quot;)\n\nfmt.Printf(&quot;Are these times equal? %v\\n&quot;, sfTime.Equal(nyTime))\n</code></pre>\n<p>This prints:</p>\n<blockquote>\n<p>Are these times equal? true</p>\n</blockquote>\n<p><a href=\"https://play.golang.org/p/uXkNV4vm7z\" rel=\"nofollow noreferrer\">Playground link here</a>.</p>\n<p>Unintuitively, even if you set them to be the same timezone, this only changes the timezone, but not the <code>HH:mm</code> value.</p>\n<pre><code>layout := &quot;2006-01-02 15:04 MST&quot;\nsfTime, _ := time.Parse(layout, &quot;2017-03-01 12:00 PDT&quot;)\nnyTime, _ := time.Parse(layout, &quot;2017-03-01 12:00 EDT&quot;)\n\n// Set timezone to UTC\nutcLocation, _ := time.LoadLocation(&quot;UTC&quot;)\nsfTime = sfTime.In(utcLocation)\nnyTime = nyTime.In(utcLocation)\n\n// Timezones should not be equal, but they are\nfmt.Printf(&quot;Are these times still equal? %v\\n&quot;, sfTime.Equal(nyTime))\nfmt.Printf(&quot;The New York Time: %v\\n&quot;, nyTime)\n</code></pre>\n<p>Prints</p>\n<blockquote>\n<p>Are these times still equal? true</p>\n<p>The New York Time: 2017-03-01 12:00:00 +0000 UTC</p>\n</blockquote>\n<p><a href=\"https://play.golang.org/p/JMieai_02t\" rel=\"nofollow noreferrer\">Playground link</a>.</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1490138639, "post_id": 42940026, "comment_id": 72976856, "body": "That doesn&#39;t look like valid json, shouldn&#39;t the root and the first group be arrays?"}], "answers": [{"comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1490142035, "post_id": 42940182, "comment_id": 72977822, "body": "Very cool! How can I reference the key field in the rules and configs?"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 3, "last_activity_date": 1490139792, "last_edit_date": 1490139792, "creation_date": 1490139452, "answer_id": 42940182, "question_id": 42940026, "link": "https://stackoverflow.com/questions/42940026/golang-parsing-json-file/42940182#42940182", "title": "golang parsing json file", "body": "<p>You can use <code>map</code>s and <code>slice</code>s for those unknown numbers.</p>\n\n<pre><code>type FirstGroup struct {\n    Rules Rules `json:\"rules\"`\n    Configs Configs `json:\"configs\"`\n}\n\ntype Rules map[string]string\n\ntype Configs map[string]string\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/zCymz62B9K\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zCymz62B9K</a> &lt;- The json in this example is a modified version of your's because your's is not really json.</p>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 42940182, "answer_count": 1, "score": -1, "last_activity_date": 1490139792, "creation_date": 1490138483, "question_id": 42940026, "link": "https://stackoverflow.com/questions/42940026/golang-parsing-json-file", "title": "golang parsing json file", "body": "<p>I want to parse the following json file and also reference the individual fields. </p>\n\n<p>The json file has some known pattern: The json file is has two group levels. It will have a variable but unknown number of first level groups. Each first level group will have two second level groups: the rule and config groups. Both the rule group and the config group will have unknown number of key:value pairs.</p>\n\n<pre><code>{\n  { // Comment: first level group\n    { // Comment: second level group\n      \"rule1\": \"doA\"\n      \"rule2\": \"doB\"\n      \"rule3\": \"doC\"\n      ...\n    }\n    {\n      \"config1\": \"goA\"\n      \"configX\": \"goB\"\n      ...\n    }\n  }\n  ...\n  {\n    {\n      \"rule100\": \"doAAA\"\n      \"rule200\": \"doBBB\"\n      \"rule300\": \"doCCC\"\n      ...\n    }\n    {\n      \"config100\": \"goAAA\"\n      \"configX00\": \"goBBB\"\n      ...\n  }\n}\n</code></pre>\n"}, {"tags": ["go", "decode"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1490119000, "post_id": 42934694, "comment_id": 72966492, "body": "Decode isn&#39;t rotating the image, the image was originally rotated at display time due to the exit orientation tag. You have to read that tag to determine how to rotate the image."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1490119057, "post_id": 42934694, "comment_id": 72966523, "body": "You should check the Exif data from your pictures. I would guess that it is not imaging which is rotating your pictures."}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 6, "last_activity_date": 1490128520, "last_edit_date": 1490128520, "creation_date": 1490121732, "answer_id": 42935638, "question_id": 42934694, "link": "https://stackoverflow.com/questions/42934694/golang-how-can-i-upload-external-images-without-rotating-them/42935638#42935638", "title": "Golang how can I upload external images without rotating them", "body": "<p>Unfortunately the go stdlib image package does not handle images which are marked as rotated with exif tags (like those here taken on a device upside down). The bug about this is here:</p>\n\n<p><a href=\"https://github.com/golang/go/issues/4341\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/4341</a></p>\n\n<p>You can see an example of handling this in camlistore, but it is quite involved:</p>\n\n<p><a href=\"https://camlistore.googlesource.com/camlistore/+/master/pkg/images/images.go\" rel=\"nofollow noreferrer\">https://camlistore.googlesource.com/camlistore/+/master/pkg/images/images.go</a></p>\n\n<p>First you have to decode exif options (DecodeOpts), then you have to check which orientation it has (out of 8 possible), then rotate as necessary. It's painful and there is no easy solution as yet. You can use this package to read exif data though:</p>\n\n<p><a href=\"https://github.com/rwcarlsen/goexif\" rel=\"nofollow noreferrer\">https://github.com/rwcarlsen/goexif</a></p>\n"}, {"tags": [], "owner": {"reputation": 2072, "user_id": 1195266, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/6c5Fj.jpg?s=128&g=1", "display_name": "Macilias", "link": "https://stackoverflow.com/users/1195266/macilias"}, "is_accepted": false, "score": -1, "last_activity_date": 1523284675, "last_edit_date": 1523284675, "creation_date": 1523275945, "answer_id": 49732699, "question_id": 42934694, "link": "https://stackoverflow.com/questions/42934694/golang-how-can-i-upload-external-images-without-rotating-them/49732699#49732699", "title": "Golang how can I upload external images without rotating them", "body": "<p>I had the same problem and solved it with a help of two libraries:</p>\n\n<pre><code>go get -u github.com/disintegration/imaging\ngo get -u github.com/rwcarlsen/goexif/exif\n</code></pre>\n\n<p>with <strong>exif</strong> you can obtain the actual orientation of the image and with <strong>imaging</strong> you can perform the operations which are needed to revert the image to orientation 1.\nSince a replaced image has no exif information left, the result is then shown correctly.</p>\n\n<pre><code>// ReadImage makes a copy of image (jpg,png or gif) and applies\n// all necessary operation to reverse its orientation to 1\n// The result is a image with corrected orientation and without\n// exif data.\nfunc ReadImage(fpath string) *image.Image {\n    var img image.Image\n    var err error\n    // deal with image\n    ifile, err := os.Open(fpath)\n    if err != nil {\n        logrus.Warnf(\"could not open file for image transformation: %s\", fpath)\n        return nil\n    }\n    defer ifile.Close()\n    filetype, err := GetSuffix(fpath)\n    if err != nil {\n        return nil\n    }\n    if filetype == \"jpg\" {\n        img, err = jpeg.Decode(ifile)\n        if err != nil {\n            return nil\n        }\n    } else if filetype == \"png\" {\n        img, err = png.Decode(ifile)\n        if err != nil {\n            return nil\n        }\n    } else if filetype == \"gif\" {\n        img, err = gif.Decode(ifile)\n        if err != nil {\n            return nil\n        }\n    }\n    // deal with exif\n    efile, err := os.Open(fpath)\n    if err != nil {\n        logrus.Warnf(\"could not open file for exif decoder: %s\", fpath)\n    }\n    defer efile.Close()\n    x, err := exif.Decode(efile)\n    if err != nil {\n        if x == nil {\n            // ignore - image exif data has been already stripped\n        }\n        logrus.Errorf(\"failed reading exif data in [%s]: %s\", fpath, err.Error())\n    }\n    if x != nil {\n        orient, _ := x.Get(exif.Orientation)\n        if orient != nil {\n            logrus.Infof(\"%s had orientation %s\", fpath, orient.String())\n            img = reverseOrientation(img, orient.String())\n        } else {\n            logrus.Warnf(\"%s had no orientation - implying 1\", fpath)\n            img = reverseOrientation(img, \"1\")\n        }\n        imaging.Save(img, fpath)\n    }\n    return &amp;img\n}\n\n// reverseOrientation amply`s what ever operation is necessary to transform given orientation\n// to the orientation 1\nfunc reverseOrientation(img image.Image, o string) *image.NRGBA {\n    switch o {\n    case \"1\":\n        return imaging.Clone(img)\n    case \"2\":\n        return imaging.FlipV(img)\n    case \"3\":\n        return imaging.Rotate180(img)\n    case \"4\":\n        return imaging.Rotate180(imaging.FlipV(img))\n    case \"5\":\n        return imaging.Rotate270(imaging.FlipV(img))\n    case \"6\":\n        return imaging.Rotate270(img)\n    case \"7\":\n        return imaging.Rotate90(imaging.FlipV(img))\n    case \"8\":\n        return imaging.Rotate90(img)\n    }\n    logrus.Errorf(\"unknown orientation %s, expect 1-8\", o)\n    return imaging.Clone(img)\n}\n</code></pre>\n\n<p>You can find this implementation also here:\n<a href=\"https://github.com/Macilias/go-images-orientation\" rel=\"nofollow noreferrer\">https://github.com/Macilias/go-images-orientation</a></p>\n"}], "owner": {"reputation": 913, "user_id": 5551912, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/4ed9452605a562b6865a5527f92173a0?s=128&d=identicon&r=PG&f=1", "display_name": "Rome Torres", "link": "https://stackoverflow.com/users/5551912/rome-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "accepted_answer_id": 42935638, "answer_count": 2, "score": 3, "last_activity_date": 1523284675, "creation_date": 1490118824, "question_id": 42934694, "link": "https://stackoverflow.com/questions/42934694/golang-how-can-i-upload-external-images-without-rotating-them", "title": "Golang how can I upload external images without rotating them", "body": "<p>I have been working on an image upload functionality for a few weeks and I just about have it done. I am using Golang as a backend language and it's purpose is to upload images sent from IOS devices to amazon s3 . In the process of uploading the image I also resize them and this has caused problems primarily the <strong>decode</strong> method sometimes rotates images which I do not want</p>\n\n<pre><code>file, handler, err := r.FormFile(\"file\")\n        if err != nil {\n            fmt.Println(\"Error Uploading Image\")\n            return\n        }\n        defer file.Close()\n         // the code below sometimes rotates an image\n        img,err := imaging.Decode(file)\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n      new_image := imaging.Resize(img,400,400, imaging.Lanczos)\n</code></pre>\n\n<p>The library I am using is this one <a href=\"https://github.com/disintegration/imaging\" rel=\"nofollow noreferrer\">https://github.com/disintegration/imaging</a> which is fantastic and the example they showed was this </p>\n\n<pre><code>src, err := imaging.Open(\"testdata/lena_512.png\")\n    if err != nil {\n        log.Fatalf(\"Open failed: %v\", err)\n    }\n\n    src = imaging.Resize(src, 256, 0, imaging.Lanczos)\n</code></pre>\n\n<p>That example is fine however my images are not stored locally they are coming from IOS devices is there something that I can do to fix this problem ? Some of my images are being saved like this </p>\n\n<p>Some images are rotated like this and it is the Decode method doing it\n<a href=\"https://i.stack.imgur.com/4nKNO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4nKNO.png\" alt=\"Some images are rotated and saved like this\"></a></p>\n\n<p>I can correct it by <strong>rotating</strong> the image however some other images that do not get rotated by <strong>decode</strong> end up being rotated by the <strong>Rotate270</strong> method .</p>\n\n<pre><code>img,err := imaging.Decode(file)\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n         // rotate the image\n        img = imaging.Rotate270(img)\n\n        new_image := imaging.Resize(img,400,400, imaging.Lanczos)\n</code></pre>\n\n<p>This is how the image is saved and looks after I rotate it . Is there someway I can upload external images without having to use decode or just fixing the decode issue ? Imaging.Resize first parameter takes in type <strong>image.Image</strong> and here is my full code</p>\n\n<pre><code>func myImages(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n    var buff bytes.Buffer\nfile, handler, err := r.FormFile(\"file\")\n        if err != nil {\n            fmt.Println(\"Error Uploading Image\")\n            return\n        }\n        defer file.Close()\n\n        img,err := imaging.Decode(file)\n        if err != nil {\n            print(\"Imaging Open error\")\n        }\n\n\n        new_image := imaging.Resize(img,400,400, imaging.Lanczos)\n        var buf bytes.Buffer\n\n\n\n\n        err = imaging.Encode(&amp;buf,new_image, imaging.JPEG)\n        if err != nil {\n            log.Println(err)\n            return\n        }\n    }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/El9l4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/El9l4.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["testing", "go", "integration-testing"], "comments": [{"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1490110549, "post_id": 42930944, "comment_id": 72960581, "body": "I would appreciate it if the people who are downvoting this question would suggest how it could be improved."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490113343, "post_id": 42930944, "comment_id": 72962850, "body": "You can&#39;t access unexported identifiers from another package period. This is a basic premise of Go packages, so these testing examples are no different."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490115193, "post_id": 42930944, "comment_id": 72964170, "body": "<a href=\"https://speakerdeck.com/mitchellh/advanced-testing-with-go?slide=52\" rel=\"nofollow noreferrer\">This talk</a> on testing Go code, by <a href=\"https://github.com/hashicorp\" rel=\"nofollow noreferrer\">hashicorp</a>&#39;s founder, provides a solution that you may find useful."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490127171, "post_id": 42930944, "comment_id": 72971438, "body": "@JimB: &quot;You can&#39;t access unexported identifiers from another package period&quot;\u2014that is true but moot.  As the fmt and fmt_test packages show, it is possible to &quot;open a window&quot; to unexported data for external tests\u2014with the somewhat arbitrary (but apparently entirely intentional) limitation that the mechanism only works when the test package is in the same directory as the package with the otherwise-unexported data."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490127848, "post_id": 42930944, "comment_id": 72971841, "body": "@mkopriva: There is a lot of good stuff in those slides.  It&#39;s a pity there seems to be no way to have <code>go build</code> ignore testing.go / testing_*.go."}, {"owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 1, "creation_date": 1490131269, "post_id": 42930944, "comment_id": 72973701, "body": "Why would you care about package internals in an integration test? This is a perfect example for black-box testing. As the name suggests, the intended purpose is to test the integration of different parts of the system, where you access those specific parts through their public interfaces."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1490137349, "post_id": 42930944, "comment_id": 72976403, "body": "@cpcallen i&#39;m not 100% sure so don&#39;t quote me on this but I think unused symbols are removed by the linker, with a few special cases where they are not, therefore, for example, if your <code>func</code> declared in <code>testing_*.go</code> is used only in <code>*_test.go</code> files, than i suspect it won&#39;t make it to the final executable..."}], "answers": [{"tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 2, "last_activity_date": 1490109112, "creation_date": 1490109112, "answer_id": 42931011, "question_id": 42930944, "link": "https://stackoverflow.com/questions/42930944/how-can-i-allow-one-package-access-to-another-packages-unexported-data-only-whe/42931011#42931011", "title": "How can I allow one package access to another package&#39;s unexported data only when testing?", "body": "<blockquote>\n  <p>Is there some other way I can allow tests from one package to access otherwise-internal data from another package, for integration testing purposes?</p>\n</blockquote>\n\n<p>No. There isn't.</p>\n"}, {"comments": [{"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1490126715, "post_id": 42931290, "comment_id": 72971186, "body": "The description of black-box vs. white-box testing may be useful for those not familiar with the concepts.  There are times\u2014when doing integration testing of related packages, notably\u2014when test can be made a lot simpler if they can directly inspect the internal state of another package."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 1, "creation_date": 1490175263, "post_id": 42931290, "comment_id": 72990672, "body": "@cpcallen I still don&#39;t think it&#39;s worth it. If you change internals of your package (including unexported identifiers) leaving the public API unchanged, that should effect <b>no one</b>. If integration tests could access \u2013and therefore rely on\u2013 internals of a package (unexported identifiers) could unjustifiably break when package internals change."}, {"owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1490193005, "post_id": 42931290, "comment_id": 73003798, "body": "you are absolutely right that white box tests are going to be more brittle, but I kind of think it&#39;s my prerogative to decide when it is and isn&#39;t worth it.  In some cases it makes the tests much simpler, and a very simple but theoretically-brittle test might be preferable to a very elaborate one that is robust against changes I never make."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "edited": false, "score": 0, "creation_date": 1490193204, "post_id": 42931290, "comment_id": 73003964, "body": "@cpcallen Then simply add an exported function exposing the value, and do comment that it&#39;s for testing purposes only and shouldn&#39;t be used otherwise."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 6, "last_activity_date": 1490113307, "last_edit_date": 1490113307, "creation_date": 1490109770, "answer_id": 42931290, "question_id": 42930944, "link": "https://stackoverflow.com/questions/42930944/how-can-i-allow-one-package-access-to-another-packages-unexported-data-only-whe/42931290#42931290", "title": "How can I allow one package access to another package&#39;s unexported data only when testing?", "body": "<p>As mentioned, there isn't any way to \"grant\" access to unexported identifiers.</p>\n\n<p>Some clarification on the <code>fmt</code> package's tests is needed / justified though.</p>\n\n<p>There are 2 kinds of testing: <em>black-box</em> testing and <em>white-box</em> testing.</p>\n\n<p><em>Black-box</em> testing is when you treat the package as a \"black-box\", and you test it only through its exported identifiers (through its \"public API\", what other packages see). In such cases, the test files have a different package name (e.g. <code>fmt_test</code> when testing the <code>fmt</code> package).</p>\n\n<p><em>White-box</em> testing is when you make use of both exported and unexported identifiers of the package. To create white-box tests, you specify the same package name in the test files as the package being tested (thus, <code>fmt</code> in case of the <code>fmt</code> package test).</p>\n\n<p>The tests included in the standard lib's <code>fmt</code> package <em>intend</em> to be a black-box test, but then it would not be able to test everything. So the Go authors went for a <em>mixed</em> version: they included a single <code>export_test.go</code> test file which uses the same package declaration (<code>package fmt</code>) so it gets access to unexported identifiers of the <code>fmt</code> package, and it \"exports\" 2 identifiers so that the other (black-box) test files will have access to:</p>\n\n<pre><code>var IsSpace = isSpace\nvar Parsenum = parsenum\n</code></pre>\n\n<p><sup>The authors did so because they wanted to minimize the use of unexported identifiers, and so this explicitly marks what unexported identifiers are used, and basically acts as a \"bridge\" between the <code>fmt</code> package and the black-box tests of the <code>fmt</code> package.</sup></p>\n\n<p>One thing to note here is that these will only be \"exported\" to the (black-box) tests of the <code>fmt</code> package (and white-box tests of <code>fmt</code> of course), and not for other packages or tests of other packages. The reason is simply because test files are not parsed and compiled when a package is built, only when package test is run.</p>\n\n<p><strong>Solution?</strong></p>\n\n<p>Unexported identifiers are for the package itself and they are no one else's business. Which means no other package should ever want to test them. If they need to be tested, it must be done inside the package's own tests.</p>\n\n<p>If for integration testing you need to access unexported identifiers, then the package must export \"something\" that either exposes the values (or some parts of them), or aids the testing without exporting the sensitive data or implementation details. If the package API is well designed and its tests are thorough, this should never (rarely) be needed.</p>\n"}], "owner": {"reputation": 1192, "user_id": 4969945, "user_type": "registered", "accept_rate": 11, "profile_image": "https://lh3.googleusercontent.com/-V_gW7xpKyDI/AAAAAAAAAAI/AAAAAAAAH7o/Fvn3wFRSbMA/photo.jpg?sz=128", "display_name": "cpcallen", "link": "https://stackoverflow.com/users/4969945/cpcallen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 42931011, "answer_count": 2, "score": 0, "last_activity_date": 1490113307, "creation_date": 1490108935, "question_id": 42930944, "link": "https://stackoverflow.com/questions/42930944/how-can-i-allow-one-package-access-to-another-packages-unexported-data-only-whe", "title": "How can I allow one package access to another package&#39;s unexported data only when testing?", "body": "<p>In <em>The Go Programming Language</em>, section 11.2.4, there is an example of of an external test accessing <code>fmt.isSpace()</code> via a declaration of <code>IsSpace</code> in <code>fmt</code>'s <code>export_test.go</code> file.  That seemed like the perfect solution, so that's what I did:</p>\n\n<p><code>a/a.go</code>:</p>\n\n<pre><code>package a\n\nvar x int\n\nfunc Set(v int) {\n    x = v\n}\n</code></pre>\n\n<p><code>a/a_test.go</code>:</p>\n\n<pre><code>package a\nimport \"testing\"\n\nfunc TestSet(t *testing.T) {\n    Set(42)\n    if x != 42 {\n        t.Errorf(\"x == %d (expected 42)\", x)\n    }\n}\n\nfunc Get() int {\n    return x\n}\n</code></pre>\n\n<p>(Running <code>go test</code> in <code>a/</code> works fine.)</p>\n\n<p><code>b/b.go</code>:</p>\n\n<pre><code>package b\nimport \"path/to/a\"\n\nfunc CallSet() {\n    a.Set(105)\n}\n</code></pre>\n\n<p><code>b/b_test.go</code></p>\n\n<pre><code>package b\nimport (\n    \"testing\"\n    \"path/to/a\"\n)\n\nfunc TestCallSet(t *testing.T) {\n    CallSet()\n    if r := a.Get(); r != 105 {\n        t.Errorf(\"Get() == %d (expected 105)\", r)\n    }\n}\n</code></pre>\n\n<p>Unfortunately, when I run <code>go test</code> in <code>b/</code>, I get:</p>\n\n<pre><code>./b_test.go:11: undefined: a.Get\n</code></pre>\n\n<p>Trying to run both sets of test at the same time with <code>go test ./...</code> did not help.</p>\n\n<p>After some considerable poking around I discover that \"<a href=\"https://github.com/golang/go/issues/10184\" rel=\"nofollow noreferrer\">The *_test.go files are compiled into the package <em>only when running go test for that package</em></a>\" (emphasis mine).  (So, in other words I could access <code>a.Get</code> from an <code>a_test</code> external test package in <code>a/</code>, but not from any package outside of <code>a/</code>.)</p>\n\n<p>Is there some other way I can allow tests from one package to access otherwise-internal data from another package, for integration testing purposes?</p>\n"}, {"tags": ["go", "network-programming", "system-calls"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490108136, "post_id": 42930401, "comment_id": 72958669, "body": "Have you looked at the <a href=\"https://godoc.org/golang.org/x/net/route\" rel=\"nofollow noreferrer\"><code>route</code> package</a>?"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490111568, "post_id": 42930401, "comment_id": 72961427, "body": "@JimB, thanks, I am looking into it."}], "answers": [{"comments": [{"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1490111696, "post_id": 42931952, "comment_id": 72961526, "body": "Thanks, but need this for macOs or FreeBSD, no linux"}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "reply_to_user": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1490112010, "post_id": 42931952, "comment_id": 72961804, "body": "It seems MacOS probably has an equivalent for strace see : <a href=\"https://opensourcehacker.com/2011/12/02/osx-strace-equivalent-dtruss-seeing-inside-applications-what-they-do-and-why-they-hang/\" rel=\"nofollow noreferrer\">opensourcehacker.com/2011/12/02/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 0, "last_activity_date": 1490115138, "last_edit_date": 1490115138, "creation_date": 1490111342, "answer_id": 42931952, "question_id": 42930401, "link": "https://stackoverflow.com/questions/42930401/what-syscall-to-use-in-order-to-obtain-the-value-of-some-rtf-flags/42931952#42931952", "title": "what syscall to use in order to obtain the value of some RTF_* flags", "body": "<p>The equivalent of <code>strace netstat</code> (dtruss on MacOS, see <a href=\"https://opensourcehacker.com/2011/12/02/osx-strace-equivalent-dtruss-seeing-inside-applications-what-they-do-and-why-they-hang/\" rel=\"nofollow noreferrer\">https://opensourcehacker.com/2011/12/02/osx-strace-equivalent-dtruss-seeing-inside-applications-what-they-do-and-why-they-hang/</a>) should give you a list of system calls it makes and you can decide what system calls you need to make for your problem.</p>\n"}, {"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 2, "last_activity_date": 1490194147, "creation_date": 1490194147, "answer_id": 42955069, "question_id": 42930401, "link": "https://stackoverflow.com/questions/42930401/what-syscall-to-use-in-order-to-obtain-the-value-of-some-rtf-flags/42955069#42955069", "title": "what syscall to use in order to obtain the value of some RTF_* flags", "body": "<p>Has @JimB suggested by using the <a href=\"https://godoc.org/golang.org/x/net/route\" rel=\"nofollow noreferrer\">route</a> package I was available to query the current routes and get only does IP matching certain flags, om this case\" <code>UGSH</code>, <code>UGSc</code>.</p>\n\n<p>Basic example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"syscall\"\n\n    \"golang.org/x/net/route\"\n)\n\nconst (\n    UGSH = syscall.RTF_UP | syscall.RTF_GATEWAY | syscall.RTF_STATIC | syscall.RTF_HOST\n    UGSc = syscall.RTF_UP | syscall.RTF_GATEWAY | syscall.RTF_STATIC | syscall.RTF_PRCLONING\n)\n\nfunc main() {\n    if rib, err := route.FetchRIB(syscall.AF_UNSPEC, route.RIBTypeRoute, 0); err == nil {\n        if msgs, err := route.ParseRIB(route.RIBTypeRoute, rib); err == nil {\n            for _, msg := range msgs {\n                m := msg.(*route.RouteMessage)\n                if m.Flags == UGSH || m.Flags == UGSc {\n                    var ip net.IP\n                    switch a := m.Addrs[syscall.AF_UNSPEC].(type) {\n                    case *route.Inet4Addr:\n                        ip = net.IPv4(a.IP[0], a.IP[1], a.IP[2], a.IP[3])\n                    case *route.Inet6Addr:\n                        ip = make(net.IP, net.IPv6len)\n                        copy(ip, a.IP[:])\n                    }\n                    fmt.Printf(\"ip = %s\\n\", ip)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "accepted_answer_id": 42955069, "answer_count": 2, "score": 2, "last_activity_date": 1490194147, "creation_date": 1490107577, "last_edit_date": 1490111646, "question_id": 42930401, "link": "https://stackoverflow.com/questions/42930401/what-syscall-to-use-in-order-to-obtain-the-value-of-some-rtf-flags", "title": "what syscall to use in order to obtain the value of some RTF_* flags", "body": "<p>Using <a href=\"https://golang.org/\" rel=\"nofollow noreferrer\">go</a>, I would like to obtain the value of some <code>RTF_*</code> flags, (UGHS) from <a href=\"https://www.freebsd.org/cgi/man.cgi?query=netstat&amp;sektion=1\" rel=\"nofollow noreferrer\">netstat(1)</a> man page:</p>\n\n<pre><code>G     RTF_GATEWAY  Destination requires forwarding by intermediary\nH     RTF_HOST     Host entry (net otherwise)\nS     RTF_STATIC   Manually added\nU     RTF_UP       Route usable\n</code></pre>\n\n<p>Any idea of what syscall/methods could I use to retrieve does values? I see they are declared <a href=\"https://golang.org/pkg/syscall/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/syscall/</a> but would like to know to use them?</p>\n\n<p>I need this to find the IP of gateways added to the route table, mainly when connecting to VPN's, currently using netstat for this (withing macOS, FreeBSD):</p>\n\n<pre><code> netstat -rna -f inet | grep UGHS | awk '{print $1}' \n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 10, "creation_date": 1490106710, "post_id": 42929882, "comment_id": 72957357, "body": "If there is no error, and the response is 200, what is the problem? There&#39;s no requirement for a response to have a body. BTW, you generally want to avoid nested if-else when you have the option to return early; most people would write this like: <a href=\"https://play.golang.org/p/q0x8cNvrYw\" rel=\"nofollow noreferrer\">play.golang.org/p/q0x8cNvrYw</a>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1490106799, "post_id": 42929882, "comment_id": 72957420, "body": "Have you checked <code>resp.ContentLength</code>? What does <code>readBody</code> do?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 1, "creation_date": 1490107537, "post_id": 42929882, "comment_id": 72958096, "body": "What is the result when you perform the same request with curl ?"}, {"owner": {"reputation": 303, "user_id": 1012369, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/052e56898ac8efe0503f57a5482be4b6?s=128&d=identicon&r=PG", "display_name": "zot24", "link": "https://stackoverflow.com/users/1012369/zot24"}, "edited": false, "score": 3, "creation_date": 1490110590, "post_id": 42929882, "comment_id": 72960612, "body": "You need to specify the type of the Authorization you are trying to do <code>Bearer</code> in this case I think that might be the problem, so the header will be <code>Authorization: Bearer MY_SUPER_SECRET_TOKEN</code>"}, {"owner": {"reputation": 303, "user_id": 1012369, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/052e56898ac8efe0503f57a5482be4b6?s=128&d=identicon&r=PG", "display_name": "zot24", "link": "https://stackoverflow.com/users/1012369/zot24"}, "edited": false, "score": 1, "creation_date": 1490111170, "post_id": 42929882, "comment_id": 72961074, "body": "Sorry I didn&#39;t give you a full proper example on my latest comment, something like:  ``` req.Header.Add(&quot;Authorization&quot;, fmt.Sprintf(&quot;Bearer %s&quot;, &quot;secretToken&quot;))  ```"}, {"owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490150712, "post_id": 42929882, "comment_id": 72980260, "body": "@JimB, you are correct, however, I am expecting a response body in this particular case. The output from a similar call made using cURL returns the data seen <a href=\"http://pastebin.com/GhkNn01t\" rel=\"nofollow noreferrer\">here</a>  With respect to general convention, I appreciate Go&#39;s support of variable declaration inline with a conditional. It makes for a subtly more concise code."}, {"owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1490150744, "post_id": 42929882, "comment_id": 72980266, "body": "@Ainar-G resp.ContentLength is consistently 0. <i>readyBody</i> uses bufio.NewScanner to extract the contents of the response ultimately instance a struct with it."}, {"owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "reply_to_user": {"reputation": 303, "user_id": 1012369, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/052e56898ac8efe0503f57a5482be4b6?s=128&d=identicon&r=PG", "display_name": "zot24", "link": "https://stackoverflow.com/users/1012369/zot24"}, "edited": false, "score": 0, "creation_date": 1490151357, "post_id": 42929882, "comment_id": 72980407, "body": "Thank you @ZoT. I believe you may be onto something, but wouldn&#39;t a bad authorization header typically result in a 400/401 response status? I will try your suggestion and update you."}, {"owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "reply_to_user": {"reputation": 303, "user_id": 1012369, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/052e56898ac8efe0503f57a5482be4b6?s=128&d=identicon&r=PG", "display_name": "zot24", "link": "https://stackoverflow.com/users/1012369/zot24"}, "edited": false, "score": 0, "creation_date": 1490192044, "post_id": 42929882, "comment_id": 73002989, "body": "@ZoT I tried updating the Authorization header as you suggested. The change had no impact on the application. Interestingly, it also had no affect while using cURL. The server appears to handle the header the same regardless of whether or not the term &quot;Bearer&quot; is included."}, {"owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "edited": false, "score": 0, "creation_date": 1490192105, "post_id": 42929882, "comment_id": 73003035, "body": "Correction to the original post: the content length of the response is actually -1, not 0 as originally reported."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "is_accepted": false, "score": 1, "last_activity_date": 1490333049, "creation_date": 1490333049, "answer_id": 42991971, "question_id": 42929882, "link": "https://stackoverflow.com/questions/42929882/empty-http-response-using-http-client-do-in-golang/42991971#42991971", "title": "Empty HTTP Response Using http.Client.Do in Golang", "body": "<p>I finally discovered the source of the problem. It had nothing to do with the request being made, or the response being received. It had to do with the parsing of the response.</p>\n\n<p>I was using bufio.NewScanner.Text to attempt to convert the response body into a string. Replacing this call with one to ioutil.ReadAll output the string that I originally expected. </p>\n\n<p>Thanks for all of your help, and apologies for the misleading question.</p>\n"}], "owner": {"reputation": 19, "user_id": 7729870, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-tRqoYYZmWc4/AAAAAAAAAAI/AAAAAAAAABI/tMIKEe5_10Y/photo.jpg?sz=128", "display_name": "s.napier", "link": "https://stackoverflow.com/users/7729870/s-napier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490333049, "creation_date": 1490106356, "question_id": 42929882, "link": "https://stackoverflow.com/questions/42929882/empty-http-response-using-http-client-do-in-golang", "title": "Empty HTTP Response Using http.Client.Do in Golang", "body": "<p>I am using Go to make an HTTP GET request to an external web service. For some reason, the body of the response is always empty; the content length is always zero bytes. The response status code is always 200, however, and the call to Client.Do returns no error. The request requires an Authorization header, so I am using the http.NewRequest / http.Client.Do pattern to submit the request, as you'll see below. I have done requests similar to these in the past, but never using a GET that required a header. It seems unlikely that this the cause, but I wonder if it may be related. If anyone can spot any potential issues with the pattern used or perhaps has had a similar experience, I'd really appreciate any help.</p>\n\n<p>Thank you.</p>\n\n<pre><code>if req, err := http.NewRequest(\"GET\", \"https://api.molt.in/v1/orders/11111111/items\", nil); err != nil {\n    return nil, err\n} else {\n    client := &amp;http.Client{}\n    req.Header.Add(\"Authorization\", \"secretToken\")\n\n    if resp, err := client.Do(req); err != nil {\n        return nil, err\n    } else {\n        defer resp.Body.Close()\n        return readBody(resp.Body)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "static-files"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490099990, "post_id": 42927339, "comment_id": 72952058, "body": "You can&#39;t use GOPATH, because GOPATH is only used for building the application. You install the files into one or more well-known locations, like any other program would."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1490099995, "post_id": 42927339, "comment_id": 72952061, "body": "Well, this one is not overridable."}, {"owner": {"reputation": 48078, "user_id": 279259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f34f02bafe93e3a3784de74c4d8b7732?s=128&d=identicon&r=PG&f=1", "display_name": "ereOn", "link": "https://stackoverflow.com/users/279259/ereon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490100690, "post_id": 42927339, "comment_id": 72952610, "body": "@JimB: Am I wrong to assume that <code>go get &lt;myproject&gt;</code> will &quot;install&quot; my command-line tool then ? I thought it was pretty idiomatic for Go tool to rely on the fact they were installed via <code>go get</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1490100690, "post_id": 42927339, "comment_id": 72952611, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests/31059125#31059125\">how to reference a relative file from code and tests</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490101017, "post_id": 42927339, "comment_id": 72952853, "body": "@ereOn: <code>go get</code> is a convenience for developers to fetch and build a go package. It relies on having a GOPATH (though there&#39;s a default now in go1.8), and GOBIN in your PATH. Many programs require extra steps not covered by the simple <code>go</code> tool, and have scripts or Makefiles to do the build. If you&#39;re targeting users that aren&#39;t developers, you ned to provide a way to install into standard system paths. Just provide a list of locations your program looks for templates."}, {"owner": {"reputation": 48078, "user_id": 279259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f34f02bafe93e3a3784de74c4d8b7732?s=128&d=identicon&r=PG&f=1", "display_name": "ereOn", "link": "https://stackoverflow.com/users/279259/ereon"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490102721, "post_id": 42927339, "comment_id": 72954205, "body": "@JimB That makes sense indeed. Thanks. BTW: I would accept this as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1490103217, "creation_date": 1490103217, "answer_id": 42928687, "question_id": 42927339, "link": "https://stackoverflow.com/questions/42927339/how-to-reliably-refer-to-static-file-in-a-go-application/42928687#42928687", "title": "How to reliably refer to static file in a Go application?", "body": "<p><code>GOPATH</code> is used for building the application. While you could look for <code>GOPATH</code> and check relative locations to each <code>GOPATH</code> entry at runtime, you can't be sure it will exist (unless of course you make it a prerequisite for running your application).</p>\n\n<p><code>go get</code> itself is a convenience for developers to fetch and build a go package. It relies on having a <code>GOPATH</code> (though there's a default now in go1.8), and <code>GOBIN</code> in your <code>PATH</code>. Many programs require extra steps not covered by the simple <code>go</code> tool, and have scripts or Makefiles to do the build. If you're targeting users that aren't developers, you need to provide a way to install into standard system paths anyway.</p>\n\n<p>Do what any regular program would do, and use some well-known path to locate the template files. You can certainly add some logic in your program to check for a hierarchy of locations: relative to <code>$GOPATH</code>, relative to the binary, working directory, <code>$HOME</code>, etc; just provide a list of locations to the user that your program will look for templates.</p>\n"}], "owner": {"reputation": 48078, "user_id": 279259, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/f34f02bafe93e3a3784de74c4d8b7732?s=128&d=identicon&r=PG&f=1", "display_name": "ereOn", "link": "https://stackoverflow.com/users/279259/ereon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 42928687, "answer_count": 1, "score": 0, "last_activity_date": 1490103217, "creation_date": 1490099750, "question_id": 42927339, "link": "https://stackoverflow.com/questions/42927339/how-to-reliably-refer-to-static-file-in-a-go-application", "title": "How to reliably refer to static file in a Go application?", "body": "<p>I am writing a Go command-line tool that generates some files based on templates.</p>\n\n<p>The templates are located in the Git repository alongside the code for the command-line tool itself.</p>\n\n<p>I wanted to allow the following:</p>\n\n<ol>\n<li>The binary, wherever it is called from, should always find the templates directory.</li>\n<li>The templates directory can be overriden by the user if need be.</li>\n</ol>\n\n<p>Since this is a Go application, I went with something like:</p>\n\n<pre><code>templateRoot := filepath.Join(\n    os.Getenv(\"GOPATH\"),\n    \"src/github.com/myuser/myproject/templates\",\n)\n</code></pre>\n\n<p>But being rather new to Go, I wonder if this approach is <strong>reliable</strong> enough: is it guaranteed that my application template will always be accessible at that path ?</p>\n\n<p>What if someone vendorize my application into their own project ? Does that even make sense for a command-line tool ?</p>\n\n<p>Because of 2., I obviously can't/won't use <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">go-bindata</a> because I want to allow for the templates to be overriden if need be.</p>\n\n<p>In summary: what is a good strategy to reliably refer to non-go, static files in a Go command-line tool ?</p>\n"}, {"tags": ["go", "jmeter", "gorilla"], "comments": [{"owner": {"reputation": 1544, "user_id": 970835, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f0fd55148d4af761e2cd060f0bd07fbd?s=128&d=identicon&r=PG", "display_name": "Snifff", "link": "https://stackoverflow.com/users/970835/snifff"}, "edited": false, "score": 0, "creation_date": 1490098907, "post_id": 42926130, "comment_id": 72955615, "body": "&quot;java.net.SocketException&quot; is obviously Java error. Cassandra is written in Java, so I guess the problem is in Cassandra and you should search for &quot;Cassandra java.net.SocketException error&quot;, and the tag should include Java, not Go."}, {"owner": {"reputation": 139, "user_id": 7166893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-hNv6vTfYAZU/AAAAAAAAAAI/AAAAAAAAADc/aPQeAZq1RGw/photo.jpg?sz=128", "display_name": "Rakshita Jain", "link": "https://stackoverflow.com/users/7166893/rakshita-jain"}, "reply_to_user": {"reputation": 1544, "user_id": 970835, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f0fd55148d4af761e2cd060f0bd07fbd?s=128&d=identicon&r=PG", "display_name": "Snifff", "link": "https://stackoverflow.com/users/970835/snifff"}, "edited": false, "score": 0, "creation_date": 1490100828, "post_id": 42926130, "comment_id": 72955616, "body": "java.net.SocketException is coming from jmeter which I am using for performance test. This should not be because of cassandra as that error is handled by my api and there is no error at my api end."}, {"owner": {"reputation": 19, "user_id": 2839119, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c3479833d572440cbd719eeeb2efc2fb?s=128&d=identicon&r=PG&f=1", "display_name": "akt", "link": "https://stackoverflow.com/users/2839119/akt"}, "edited": false, "score": 0, "creation_date": 1490111011, "post_id": 42926130, "comment_id": 72986502, "body": "Are you able to access your golang written API otherwise, say curl or browser? If so check what is the URL being tried by the jmeter by putting some logging."}], "answers": [{"tags": [], "owner": {"reputation": 461, "user_id": 7332423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-G5_G8dqc46o/AAAAAAAAAAI/AAAAAAAAAmY/JIZcHT8D_gk/photo.jpg?sz=128", "display_name": "Selva", "link": "https://stackoverflow.com/users/7332423/selva"}, "is_accepted": false, "score": 0, "last_activity_date": 1490115782, "creation_date": 1490115782, "answer_id": 42933737, "question_id": 42926130, "link": "https://stackoverflow.com/questions/42926130/socket-exception-with-2500-users-on-golang/42933737#42933737", "title": "Socket Exception with 2500 users on golang", "body": "<p>JMeter uses the connection timeout and receive timeouts that you specify in the HTTP sampler fields. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Ql2kM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ql2kM.jpg\" alt=\"HTTP Sampler with connect and receive fields configured\"></a></p>\n\n<p>If you haven't specified any value, it can wait for a long time to open the socket and also to receive the response. If you have configured a value for these fields, try to increase them slightly higher to observe if it helps. But it is just a troubleshooting step and most of the times, a bad idea. You need to figure out if the network connection between your test machine (JMeter) and the target system is good and not having any issues. To confirm this, open your result file in excel and you look at the 'elapsed', 'latency' and connect time fields. To add the connect time to your result file, you have to launch JMeter with the option -Jjmeter.save.saveservice.connect_time=true</p>\n\n<p>You should also verify this outside Jmeter by using curl or similar tools that can give you a complete picture of the time spent.</p>\n\n<pre><code>curl -s -w '\\nDNS time:\\t%{time_namelookup}\\nTCP Connect time:\\t%{time_connect}\\nAppCon Protocol time:\\t%{time_appconnect}\\nRedirect time:\\t%{time_redirect}\\nPreXfer time:\\t%{time_pretransfer}\\nStartXfer time:\\t%{time_starttransfer}\\n\\nTotal time:\\t%{time_total}\\n' http://www.google.com\n</code></pre>\n\n<p>This can give you output in the following format where TCP connect time provides the time taken by the end point to establish a connection</p>\n\n<p>DNS time:       0.002</p>\n\n<p>TCP Connect time:       0.003</p>\n\n<p>AppCon Protocol time:   0.000</p>\n\n<p>Redirect time:  0.000</p>\n\n<p>PreXfer time:   0.003</p>\n\n<p>StartXfer time: 0.070</p>\n\n<p>Total time:     0.071</p>\n\n<p>If there are no network issues, you need to find why your application is failing to process a socket creation request. I can imagine many issues including lack of sufficient threads to process the workload,  less max_clients and max_processes allocated for the process etc. There can be many reasons which you can troubleshoot by capturing the wireshark dump on both the sides.</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 7166893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-hNv6vTfYAZU/AAAAAAAAAAI/AAAAAAAAADc/aPQeAZq1RGw/photo.jpg?sz=128", "display_name": "Rakshita Jain", "link": "https://stackoverflow.com/users/7166893/rakshita-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1490252171, "creation_date": 1490252171, "answer_id": 42969189, "question_id": 42926130, "link": "https://stackoverflow.com/questions/42926130/socket-exception-with-2500-users-on-golang/42969189#42969189", "title": "Socket Exception with 2500 users on golang", "body": "<p>I enabled the keep-alive option in the jmeter. This solved my problem. \nBut I still dont know how to do it using go framework.</p>\n"}, {"tags": [], "owner": {"reputation": 439, "user_id": 4719672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6230812ad3e17215f447e5f262391e7c?s=128&d=identicon&r=PG&f=1", "display_name": "Satish Shihani", "link": "https://stackoverflow.com/users/4719672/satish-shihani"}, "is_accepted": false, "score": 0, "last_activity_date": 1490478710, "creation_date": 1490478710, "answer_id": 43022372, "question_id": 42926130, "link": "https://stackoverflow.com/questions/42926130/socket-exception-with-2500-users-on-golang/43022372#43022372", "title": "Socket Exception with 2500 users on golang", "body": "<p>Every Network has some limited socket size allocated to each device to transfer data. If you are using 1000 no of users from one machine, Then definitely it will allow only limited no of requests (According to channel size).</p>\n\n<p>Its like \"A door to pass 1000 people, and you want to pass all of them in 10 seconds\"</p>\n\n<p>Solution is: If you use Master-Slave and use Max 200-250 users from one machine (Ex- 4 Slaves 1 Master), You'll not get SocketException</p>\n\n<p>Hope This Helps!</p>\n"}], "owner": {"reputation": 139, "user_id": 7166893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-hNv6vTfYAZU/AAAAAAAAAAI/AAAAAAAAADc/aPQeAZq1RGw/photo.jpg?sz=128", "display_name": "Rakshita Jain", "link": "https://stackoverflow.com/users/7166893/rakshita-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1490478710, "creation_date": 1490096521, "last_edit_date": 1490162231, "question_id": 42926130, "link": "https://stackoverflow.com/questions/42926130/socket-exception-with-2500-users-on-golang", "title": "Socket Exception with 2500 users on golang", "body": "<p>I have written a web API in go using gorrilla/mux framework and cassandra database. When I run a load test on the API using jmeter, it passes for some 1000 concurrent users and starts giving this error as the users increase :</p>\n\n<blockquote>\n  <p>Non HTTP response code: java.net.SocketException,Non HTTP response message: Socket closed</p>\n</blockquote>\n\n<p>According to my understanding, this is happening because the threads are timing out. Can anyone help me regarding this?</p>\n"}, {"tags": ["ubuntu", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1490097584, "post_id": 42925551, "comment_id": 72950279, "body": "Fill <code>Env</code> in <a href=\"https://golang.org/pkg/os/exec/#Cmd\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#Cmd</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1490135294, "post_id": 42925551, "comment_id": 72975617, "body": "You should also update your version of Go, if only because go1.8 introduced a default GOPATH."}], "answers": [{"comments": [{"owner": {"reputation": 764, "user_id": 160149, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ee06835e17a71e6d8518c3e784e04c87?s=128&d=identicon&r=PG", "display_name": "jonydep", "link": "https://stackoverflow.com/users/160149/jonydep"}, "edited": false, "score": 0, "creation_date": 1490171838, "post_id": 42938576, "comment_id": 72988532, "body": "setting the Env is working perfectly now, thanks. Setting it in systemd process file is probably better though, i didn&#39;t realise i could do that."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 2, "last_activity_date": 1490132289, "creation_date": 1490132289, "answer_id": 42938576, "question_id": 42925551, "link": "https://stackoverflow.com/questions/42925551/running-go-install-with-golang-exec-command/42938576#42938576", "title": "running go install with golang exec.Command", "body": "<p>Are you running this in your editor context, or in a container perhaps? It won't work in a context without the GOPATH env variable set. </p>\n\n<p>If running with go run main.go, does it work? It works for me in that context without modifying your code. As long as the parent context has access to GOPATH it should. You could alternatively set it manually with something like this: </p>\n\n<pre><code>command.Env = append(os.Environ(), \"GOPATH=/tmp/go\")\n</code></pre>\n\n<p>Or you could set GOPATH (for install) and PATH (for go,git cmds) in the context this process will run in (probably preferable), for example in a systemd unit file. </p>\n"}], "owner": {"reputation": 764, "user_id": 160149, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ee06835e17a71e6d8518c3e784e04c87?s=128&d=identicon&r=PG", "display_name": "jonydep", "link": "https://stackoverflow.com/users/160149/jonydep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1276, "favorite_count": 0, "accepted_answer_id": 42938576, "answer_count": 1, "score": 1, "last_activity_date": 1490132289, "creation_date": 1490095015, "question_id": 42925551, "link": "https://stackoverflow.com/questions/42925551/running-go-install-with-golang-exec-command", "title": "running go install with golang exec.Command", "body": "<p>I'm trying to write some code for a webhook, that will call go install. The problem i'm having is that the GOPATH isn't set when i call any go commands with exec.Command</p>\n\n<pre><code>func exec_cmd(w http.ResponseWriter, cmd string, args ...string) {\n    command := exec.Command(cmd, args...)\n    var out bytes.Buffer\n    var stderr bytes.Buffer\n    command.Stdout = &amp;out\n    command.Stderr = &amp;stderr\n    err := command.Run()\n    if err != nil {\n        errstring := fmt.Sprintf(fmt.Sprint(err) + \": \" + stderr.String())\n        io.WriteString(w, errstring)\n    }\n    io.WriteString(w, out.String())\n    fmt.Println(out.String())\n}\n\nfunc webhook(w http.ResponseWriter, r *http.Request) {\n    exec_cmd(w, \"go\", \"install\", \"github.com/me/myrepo/mything\")\n}\n\nfunc test(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"test\")\n}\n\nfunc main() {\n    mux := http.NewServeMux()\n    mux.HandleFunc(\"/webhook\", webhook)\n    mux.HandleFunc(\"/\", test)\n    http.ListenAndServe(\":8000\", mux)\n}\n</code></pre>\n\n<p>when the webhook endpoint is hit, it gives:</p>\n\n<pre><code>exit status 1: can't load package: package github.com/me/myrepo/mything: cannot find package \"github.com/me/myrepo/mything\" in any of:\n    /usr/lib/go-1.6/src/github.com/me/myrepo/mything (from $GOROOT)\n    ($GOPATH not set)\n</code></pre>\n\n<p>How would i go about making sure the GOPATH is set in this context?</p>\n\n<p>If i run \"go install github.com/me/myrepo/mything\" from the command line, it works fine.</p>\n"}, {"tags": ["go", "go-chi"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1490094229, "creation_date": 1490094229, "answer_id": 42925253, "question_id": 42925162, "link": "https://stackoverflow.com/questions/42925162/go-package-naming/42925253#42925253", "title": "Go package naming", "body": "<p>It sounds like your editor is automatically running <code>goimports</code>, which means it will remove unused imports. So simply adding it to your <code>imports</code> section isn't good enough; you also have to <em>use</em> the import.</p>\n\n<p>It looks like your proper import path would be \"github.com/jiewmeng/finance/sbp\".  Then you need to reference it as well:</p>\n\n<pre><code>package main\n\nimport (\n    // other imports\n    \"github.com/jiewmeng/finance/bp\"\n)\n\nfunc main() {\n    // whatever\n    http.Handle(\"/somepath\", http.HandlerFunc(sbp.AddInvestment))\n}\n</code></pre>\n"}], "owner": {"reputation": 74019, "user_id": 292291, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e31d9d39e9fb0ec4cc5573a5e5b01ce7?s=128&d=identicon&r=PG", "display_name": "Jiew Meng", "link": "https://stackoverflow.com/users/292291/jiew-meng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1534002015, "creation_date": 1490093947, "last_edit_date": 1534002015, "question_id": 42925162, "link": "https://stackoverflow.com/questions/42925162/go-package-naming", "title": "Go package naming", "body": "<p>How do I reference project packages correctly? I have the following folder structure: </p>\n\n<pre><code>/sbp\n    /models.go\n    /controllers.go\n/main.go\n</code></pre>\n\n<p>In <code>main.go</code> I'd like to call my controller action from <code>sbp.controllers</code>. I can't seem to find a way to correctly reference it</p>\n\n<p><strong><code>main.go</code></strong></p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n\n    ...\n    \"github.com/pressly/chi\"\n)\n\nvar sess = session.Must(session.NewSession(&amp;aws.Config{\n    Region: aws.String(\"ap-southeast-1\"),\n}))\nvar dynamo = dynamodb.New(sess)\n\nfunc main() {\n    r := chi.NewRouter()\n    r.Get(\"/\", GetInvestments) // How do I call sbp.controller.GetInvestments?\n    r.Post(\"/\", AddInvestment)\n    http.ListenAndServe(\":8080\", r)\n}\n</code></pre>\n\n<p><strong><code>sbp/controller.go</code></strong></p>\n\n<pre><code>package sbp\n\nimport (\n    \"net/http\"\n    \"time\"\n\n    \"github.com/pressly/chi/render\"\n)\n\n// AddInvestment Adds an investment\nfunc AddInvestment(w http.ResponseWriter, r *http.Request) {\n    ...\n}\n\n// GetInvestments Gets list of investments\nfunc GetInvestments(w http.ResponseWriter, r *http.Request) {\n    ...\n}\n</code></pre>\n\n<p>I tried importing \"sbp/controller\", or even \"github.com/jiewmeng/finance/sbp/controller\" but they seem to be auto removed my VSCode, so I think its invalid? </p>\n"}, {"tags": ["inheritance", "go", "data-structures", "struct", "interface"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 3, "creation_date": 1490092502, "post_id": 42924518, "comment_id": 72946496, "body": "Are we supposed to run our fingers down the screen until we count 122 lines, or would you like to point out where the problem is? :)"}, {"owner": {"reputation": 71, "user_id": 2776340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QiYSy.jpg?s=128&g=1", "display_name": "Philipp Franke", "link": "https://stackoverflow.com/users/2776340/philipp-franke"}, "edited": false, "score": 1, "creation_date": 1490092977, "post_id": 42924518, "comment_id": 72946862, "body": "If I understood you correctly, you can probably add <code>Time() time.Time</code> to your <code>IEvent</code> interface. Furthermore, you need to implement a method called <code>Time() time.Time</code> to your structs and update the given lines 47,79 to <code>event.Time()</code>."}, {"owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 0, "creation_date": 1490097501, "post_id": 42924518, "comment_id": 72950207, "body": "Yes but I see two problems with this, one that I would have to add a getter/setter for all properties, two that if I add an entity e.g. called TreeEntity with properties Kind string, Branches []Branch and so on they would have different getters/setters because of having different properties so that would break in the Resolve methods. :/  I&#39;m so used to loosely types languages :/"}], "answers": [{"comments": [{"owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 0, "creation_date": 1490115326, "post_id": 42928097, "comment_id": 72964267, "body": "So the answer would be that I have to use getters/setters for all properties added to a struct, that is not exactly the answer I was hoping for but maybe it&#39;s the only way. Would have been so nice if there was another way of saving references in slice/map to a mix of structs without the need for getter/setter, even if the interface was not needed would be nice.  I did try with getters/setters without success but I guess I need to practice some more to get my head around this. Thanks for the input."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "reply_to_user": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 1, "creation_date": 1490115835, "post_id": 42928097, "comment_id": 72964565, "body": "Right, to be clear you don&#39;t have to use an interface as the type you are passing to the method/store in the struct, but if you are going to use an interface the interface better have all the methods you need."}, {"owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 0, "creation_date": 1490115856, "post_id": 42928097, "comment_id": 72964576, "body": "Changing player.Birthday to a setter requires me to add SetBirthday(time time.Time) to the IEntity which since not all entities will have to property Birthday breaks the complete point of having a generic interface called IEntity. :/"}, {"owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 0, "creation_date": 1490115980, "post_id": 42928097, "comment_id": 72964652, "body": "See your points but I guess I lack the knowledge of how to store/retrieve mixed struct types in single array/slice/maps, without interface somehow would have been super nice as well"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "reply_to_user": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 1, "creation_date": 1490117134, "post_id": 42928097, "comment_id": 72965392, "body": "you can&#39;t store mixed types in a slice/map You would have to use type assertions."}, {"owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "edited": false, "score": 0, "creation_date": 1490119763, "post_id": 42928097, "comment_id": 72966922, "body": "Yes I guess, I need to read up more on how to work with typed languages in general. In Java for example I would assume that I would be able to use inheritance to solve this, only passing in instances that inherits from a class called Entity but since there is no inheritance in Go I will have to find another way. I&#39;m probably trying to type it to much, I need another design that uses data structures that is more dynamic.  Thanks for your input so far how ever, I&#39;ll experiment some more :)"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 1, "last_activity_date": 1490101664, "creation_date": 1490101664, "answer_id": 42928097, "question_id": 42924518, "link": "https://stackoverflow.com/questions/42924518/go-maps-and-slices-with-mixed-struct-types/42928097#42928097", "title": "Go maps and slices with mixed struct types", "body": "<p>In golang when you declare an interface like </p>\n\n<pre><code>type IEntity interface {\n}\n</code></pre>\n\n<p>You define everything that can be done with this interface without a type cast. So here you have defined no functionality for this interface. If you want functionality than you have to give it a method like</p>\n\n<pre><code>type IEntity interface {\n    Time() time.Time\n}\n</code></pre>\n\n<p>Any type that wants to be used with that interface must implement those functions i.e.</p>\n\n<pre><code>func (a AddPlayerEvent) Time() time.Time {\n    return a.Time \n} \n</code></pre>\n\n<p><a href=\"https://golang.org/doc/effective_go.html#interfaces_and_types\" rel=\"nofollow noreferrer\">See the docs</a></p>\n\n<p>Then you can use any of those methods </p>\n\n<pre><code>func (projection *Projection) Append(event IEvent) {\n    ...\n    event.Time()\n    ...\n}\n</code></pre>\n\n<p>2 more notes </p>\n\n<ul>\n<li>When iterating through a map you can use k, v := range my_map</li>\n<li>*projection.Get(event.ID)  attempts to deference a non pointer type</li>\n</ul>\n"}], "owner": {"reputation": 2701, "user_id": 231582, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b82066b95508c6d6a9b2e70c99064db8?s=128&d=identicon&r=PG", "display_name": "tirithen", "link": "https://stackoverflow.com/users/231582/tirithen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490101664, "creation_date": 1490092312, "last_edit_date": 1490092670, "question_id": 42924518, "link": "https://stackoverflow.com/questions/42924518/go-maps-and-slices-with-mixed-struct-types", "title": "Go maps and slices with mixed struct types", "body": "<p>I'm trying to learn how to work with Go by creating a simple event store with the ability to create projections. I get stuck on how to work with slices and maps that contains structs of mixed types. The point with this would be that I want a developer to create as many structs implementing IEntity and IEvent as needed with various fields.</p>\n\n<p>I come from a JavaScript/Node.js background with some basic knowledge of C/C++/Java and I'm probably looking to much for class/inheritance patterns here and need some help on how to get the same functionality in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"time\"\n\n    uuid \"github.com/satori/go.uuid\"\n)\n\n// IEntity describes an entity, a struct that is the sum of all events resolved in a chronological order\ntype IEntity interface {\n}\n\n// IProjection describes the interface for a projection struct\ntype IProjection interface {\n    Lock()\n    Unlock()\n    Get(id uuid.UUID) IEntity\n    Set(id uuid.UUID, entity IEntity)\n    GetLastEventTime() time.Time\n    Append(event IEvent)\n}\n\n// IEvent describes the interface for a event, any event added to the system needs to implement this interface\ntype IEvent interface {\n    Resolve(projection IProjection)\n}\n\n// EventVault is the base struct that keeps all the events and allows for projections to be created\ntype EventVault struct {\n    sync.Mutex\n    events []IEvent\n}\n\n// Append adds a IEvent to the projection and runs that events IEvent.Resolve method\nfunc (vault *EventVault) Append(event IEvent) {\n    vault.Lock()\n    defer vault.Unlock()\n    vault.events = append(vault.events, event)\n}\n\n// Project creates a projection with entities from all events up until the choosen end time\nfunc (vault *EventVault) Project(endTime time.Time, projection IProjection) IProjection {\n    lastEventTime := projection.GetLastEventTime()\n    for index := range vault.events {\n        event := vault.events[index]\n        if event.Time.After(lastEventTime) &amp;&amp; event.Time.Before(endTime) {\n            projection.Append(event)\n        }\n    }\n    return projection\n}\n\n// Projection caculates and stores a projection of the events appended to it with the Append method\ntype Projection struct {\n    sync.Mutex\n    events   []IEvent\n    entities map[uuid.UUID]IEntity\n}\n\n// Get returns an IEntity struct from an id (for use in the IEvent.Resolve method)\nfunc (projection *Projection) Get(id uuid.UUID) IEntity {\n    return projection.entities[id]\n}\n\n// Set add a IEntity to the projection (for use in the IEvent.Resolve method)\nfunc (projection *Projection) Set(id uuid.UUID, entity IEntity) {\n    projection.entities[id] = entity\n}\n\n// GetLastEventTime returns the time for the event that was added last\nfunc (projection *Projection) GetLastEventTime() time.Time {\n    event := projection.events[len(projection.events)-1]\n\n    if event == nil {\n        return time.Unix(0, 0)\n    }\n\n    return event.Time\n}\n\n// Append adds a IEvent to the projection and runs that events IEvent.Resolve method\nfunc (projection *Projection) Append(event IEvent) {\n    projection.Lock()\n    projection.events = append(projection.events, event)\n    event.Resolve(projection)\n    projection.Unlock()\n}\n\n// ------------------ Below is usage of above system ------------------\n\n// PlayerEntity is a sample entity that can be used for testing\ntype PlayerEntity struct {\n    ID        uuid.UUID\n    Name      string\n    Birthday  time.Time\n    UpdatedAt time.Time\n}\n\n// AddPlayerEvent is a sample event that can be used for testing\ntype AddPlayerEvent struct {\n    ID   uuid.UUID\n    Time time.Time\n    Name string\n}\n\n// Resolve will create a new PlayerEntity and add that to the projection\nfunc (event *AddPlayerEvent) Resolve(projection IProjection) {\n    player := PlayerEntity{ID: uuid.NewV4(), Name: event.Name, UpdatedAt: event.Time}\n    projection.Set(player.ID, &amp;player)\n}\n\n// SetBirthdayPlayerEvent is a sample event that can be used for testing\ntype SetBirthdayPlayerEvent struct {\n    ID       uuid.UUID\n    Time     time.Time\n    Birthday time.Time\n}\n\n// Resolve will change the name on a PlayerEntity\nfunc (event *SetBirthdayPlayerEvent) Resolve(projection IProjection) {\n    player := *projection.Get(event.ID)\n    player.Birthday = event.Birthday\n    player.UpdatedAt = event.Time\n}\n\nfunc main() {\n    vault := EventVault{}\n    event1 := AddPlayerEvent{ID: uuid.NewV4(), Time: time.Now(), Name: \"Lisa\"}\n    vault.Append(&amp;event1)\n    birthday, _ := time.Parse(\"2006-01-02\", \"2017-03-04\")\n    event2 := SetBirthdayPlayerEvent{ID: event1.ID, Time: time.Now(), Birthday: birthday}\n    vault.Append(&amp;event2)\n}\n</code></pre>\n\n<p>The errors I get are</p>\n\n<pre><code>./main.go:47: event.Time undefined (type IEvent has no field or method Time)\n./main.go:79: event.Time undefined (type IEvent has no field or method Time)\n./main.go:122: invalid indirect of projection.Get(event.ID) (type IEntity)\n</code></pre>\n\n<p>The struct types are probably lost so I need another way of storing them to put them into the maps and slices but how?</p>\n"}, {"tags": ["scala", "go", "jar", "emr"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2614884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tlepo.png?s=128&g=1", "display_name": "Daman", "link": "https://stackoverflow.com/users/2614884/daman"}, "is_accepted": true, "score": 0, "last_activity_date": 1490265084, "creation_date": 1490265084, "answer_id": 42973466, "question_id": 42923413, "link": "https://stackoverflow.com/questions/42923413/what-is-the-correct-way-to-use-the-addjobflowstep-in-the-aws-emr-sdk/42973466#42973466", "title": "What is the correct way to use the AddJobFlowStep in the AWS EMR sdk?", "body": "<p>I managed to solve this issue.\nFor anyone who is struggling with something similar, the answer is that we need to send the arguments separately in an array. </p>\n"}], "owner": {"reputation": 11, "user_id": 2614884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tlepo.png?s=128&g=1", "display_name": "Daman", "link": "https://stackoverflow.com/users/2614884/daman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 42973466, "answer_count": 1, "score": 1, "last_activity_date": 1490265084, "creation_date": 1490089657, "question_id": 42923413, "link": "https://stackoverflow.com/questions/42923413/what-is-the-correct-way-to-use-the-addjobflowstep-in-the-aws-emr-sdk", "title": "What is the correct way to use the AddJobFlowStep in the AWS EMR sdk?", "body": "<p>I've used the go AWS sdk to create a cluster and added a job flow step to it. \nHowever the execution of the step always fails when I do it programatically. \nAn interesting point to notice is that when I attach the jar from the UI, it successfully executes. </p>\n\n<p>So when the jar is attached from the UI, this is the outcome of the step execution(it runs successfully and moves to the COMPLETED state): \n(Copying the full text)</p>\n\n<blockquote>\n  <p>JAR location : command-runner.jar \n  Main class : None Arguments :\n  spark-submit --deploy-mode cluster --class Hello\n  s3://mdv-testing/Util-assembly-1.0.jar Action on failure: Continue</p>\n</blockquote>\n\n<p>However, this is the output of the step when I try programatically:</p>\n\n<blockquote>\n  <p>Status :FAILED Reason : Main Class not found. \n  Log File : s3://mdv-testing/awsLogs/j-3RW9K14BS6GLO/steps/s-337M25MLV3BHT/stderr.gz\n  Details : Caused by: java.lang.ClassNotFoundException: scala.reflect.api.TypeCreator \n  JAR location : s3://mdv-testing/Util-assembly-1.0.jar Main class : None > Arguments : spark-submit \"--class Hello\" \n  Action on failure: Cancel and wait</p>\n</blockquote>\n\n<p>I tried various combinations for the arguments and realised that the command-runner.jar was never present. \nI accordingly made changes to the code and send the <strong>command-runner.jar</strong> as the argument now. This <strong>now reflects the same details as the step that executes successfully.</strong>\nThis is the revised output:</p>\n\n<blockquote>\n  <p>Status :FAILED Reason : Unknown Error.\n  Log File : s3://mdv-testing/awsLogs/j-3RW9K14BS6GLO/steps/s-3NI5ZO15VTWQK/\n  JAR location : command-runner.jar \n  Main class : None\n  Arguments : \"spark-submit --deploy-mode cluster --class Hello\n  s3://mdv-testing/Util-assembly-1.0.jar\n  Action on failure: Cancel and wait</p>\n</blockquote>\n\n<h2>Go Code</h2>\n\n<pre><code>package main\nimport (\n\"fmt\"\n\n\"github.com/aws/aws-sdk-go/aws\"\n\"github.com/aws/aws-sdk-go/aws/session\"\n\"github.com/aws/aws-sdk-go/service/emr\"\n)\n\nfunc main() {\nsess := session.New(&amp;aws.Config{Region: aws.String(\"us-east-1\")})\nsvc := emr.New(sess)\n\nparams := &amp;emr.AddJobFlowStepsInput{\nJobFlowId: aws.String(\"j-3RW9K14BS6aaa\"),\nSteps: []*emr.StepConfig{\n{\n    ActionOnFailure: aws.String(\"CANCEL_AND_WAIT\"), //TERMINATE_CLUSTER\"),\n    HadoopJarStep: &amp;emr.HadoopJarStepConfig{\n    Args: []*string{\n                     aws.String(\"spark-submit --deploy-mode cluster --class Hello s3://mdv-testing/Util-assembly-1.0.jar\"),\n                   },\n                     Jar: aws.String(\"command-runner.jar\"), },\n                     Name: aws.String(\"ReportJarExecution\"),\n    },\n},\n}\n\nresp, err := svc.AddJobFlowSteps(params)\n\nif err != nil {\n// Print the error, cast err to awserr. sError to get the Code and\n// Message from an error.\nfmt.Println(err.Error())\nreturn\n}\n\n// Pretty-print the response data.\nfmt.Println(resp)\n}\n</code></pre>\n\n<p>Can someone please help me !!! I think I'm pretty close to the solution but it is evading me big time :(</p>\n"}, {"tags": ["go", "cassandra", "timeout", "gocql"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1490089678, "post_id": 42922757, "comment_id": 72944352, "body": "Please check your network connection, if you can se the server network, and if the server is up and running."}, {"owner": {"reputation": 502, "user_id": 2499914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb64546181e2d8366c602dbe306b4ff6?s=128&d=identicon&r=PG", "display_name": "chetan dev", "link": "https://stackoverflow.com/users/2499914/chetan-dev"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1490093042, "post_id": 42922757, "comment_id": 72946910, "body": "Hi, all cassandra server are running . it is giving timeout error when i am running a load test"}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1490093634, "post_id": 42922757, "comment_id": 72947382, "body": "What you mean by &quot;load test&quot;?"}, {"owner": {"reputation": 502, "user_id": 2499914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb64546181e2d8366c602dbe306b4ff6?s=128&d=identicon&r=PG", "display_name": "chetan dev", "link": "https://stackoverflow.com/users/2499914/chetan-dev"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1490095119, "post_id": 42922757, "comment_id": 72948492, "body": "I am running a Jmeter load test on an api which is inserting data to cassandra (3 node cluster ), the test passes for initial few seconds after that it start giving error because of timeouts"}], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5259881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f46581f4fcabbae2c031c21b88917775?s=128&d=identicon&r=PG&f=1", "display_name": "nevsv", "link": "https://stackoverflow.com/users/5259881/nevsv"}, "is_accepted": true, "score": 4, "last_activity_date": 1490102570, "creation_date": 1490102570, "answer_id": 42928429, "question_id": 42922757, "link": "https://stackoverflow.com/questions/42922757/getting-timeout-error-with-gocql/42928429#42928429", "title": "Getting timeout error with Gocql", "body": "<p>Try to increase timeouts in Cassandra config file (<strong>write_request_timeout_in_ms</strong> - for writes) and concurrent writes (<strong>concurrent_writes</strong>).</p>\n\n<p>Also, try to lower <strong>NumConns</strong> parameter in your gocql driver.\nIf you are using goroutines, try to lower their number and verify that you are reusing same session object for all goroutines.</p>\n\n<p>If you are using protocol version prior to 4, you can try to set <strong>Timeout</strong> paramter of cluster object in gocql to higher value.</p>\n"}], "owner": {"reputation": 502, "user_id": 2499914, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb64546181e2d8366c602dbe306b4ff6?s=128&d=identicon&r=PG", "display_name": "chetan dev", "link": "https://stackoverflow.com/users/2499914/chetan-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3646, "favorite_count": 0, "accepted_answer_id": 42928429, "answer_count": 1, "score": 3, "last_activity_date": 1490102570, "creation_date": 1490087838, "last_edit_date": 1592644375, "question_id": 42922757, "link": "https://stackoverflow.com/questions/42922757/getting-timeout-error-with-gocql", "title": "Getting timeout error with Gocql", "body": "<p>I am getting following errors while inserting data in Cassandra.\nI am using <code>gocql</code> client for Cassandra.</p>\n<blockquote>\n<p>{&quot;error&quot;:&quot;gocql: too many query timeouts on the connection&quot;,&quot;status&quot;:500}</p>\n<p>{&quot;error&quot;:&quot;gocql: no response received from cassandra within timeout period&quot;,&quot;status&quot;:500}</p>\n<p>{&quot;error&quot;:&quot;write tcp 172.23.15.226:36954-\\u003e172.23.16.15:9042: use of closed network connection&quot;,&quot;status&quot;:500}</p>\n</blockquote>\n<p>Can anybody help me with this?</p>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1490087612, "post_id": 42921820, "comment_id": 72942853, "body": "&quot;Also to be noted that some routers strip the host from http.Request.URL&quot; -- not just routers; proxies can strip or modify that as well."}], "tags": [], "owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "is_accepted": false, "score": 1, "last_activity_date": 1490087277, "last_edit_date": 1490087277, "creation_date": 1490085046, "answer_id": 42921820, "question_id": 42921567, "link": "https://stackoverflow.com/questions/42921567/what-is-the-difference-between-host-and-url-host-for-golang-http-request/42921820#42921820", "title": "What is the difference between `Host` and `URL.Host` for golang `http.Request`?", "body": "<p>Essentially <code>http.Request.Host</code> is for convenience.</p>\n\n<p><code>r.Host</code> is much easier to call than <code>r.Header.Get(\"Host\")</code> or <code>r.URL.Host</code>.</p>\n\n<p>Also to be noted that some routers strip the host from <code>http.Request.URL</code> so <code>http.Request.Host</code> is useful in those cases as well.</p>\n\n<p>Hence it can be considered that req.Host provides the Host value even when the request header or url has been modified elsewhere.</p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 39, "last_activity_date": 1490096582, "creation_date": 1490096582, "answer_id": 42926149, "question_id": 42921567, "link": "https://stackoverflow.com/questions/42921567/what-is-the-difference-between-host-and-url-host-for-golang-http-request/42926149#42926149", "title": "What is the difference between `Host` and `URL.Host` for golang `http.Request`?", "body": "<p>The <a href=\"https://godoc.org/net/http#Request.URL\" rel=\"noreferrer\"><code>r.URL</code></a> field is created by parsing the HTTP request URI. </p>\n\n<p>The <a href=\"https://godoc.org/net/http#Request.Host\" rel=\"noreferrer\"><code>r.Host</code></a> field is the value of the <a href=\"https://tools.ietf.org/html/rfc7230#section-5.4\" rel=\"noreferrer\">Host request header</a>. It's the same value as calling <code>r.Header.Get(\"Host\")</code>.</p>\n\n<p>If the HTTP request on the wire is:</p>\n\n<pre><code> GET /pub/WWW/TheProject.html HTTP/1.1\n Host: www.example.org:8080\n</code></pre>\n\n<p>then <code>r.URL.Host</code> is \"\" and <code>r.Host</code> is <code>www.example.org:8080</code>.</p>\n\n<p>The value of <code>r.URL.Host</code> and <code>r.Host</code> are almost always different.  On a proxy server, <code>r.URL.Host</code> is the host of the target server and <code>r.Host</code> is the host of the proxy server itself. When not connecting through a proxy, the client does not specify a host in the request URI. In this scenario, <code>r.URL.Host</code> is the empty string.</p>\n\n<p>If you are not implementing a proxy, then you should use <code>r.Host</code> to determine the host.</p>\n"}], "owner": {"reputation": 9643, "user_id": 1925083, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/C3khW.jpg?s=128&g=1", "display_name": "cizixs", "link": "https://stackoverflow.com/users/1925083/cizixs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16429, "favorite_count": 6, "accepted_answer_id": 42926149, "answer_count": 2, "score": 19, "last_activity_date": 1490096582, "creation_date": 1490084250, "last_edit_date": 1490084659, "question_id": 42921567, "link": "https://stackoverflow.com/questions/42921567/what-is-the-difference-between-host-and-url-host-for-golang-http-request", "title": "What is the difference between `Host` and `URL.Host` for golang `http.Request`?", "body": "<p>When developing golang http application, I use <code>http.Request</code> a lot. When accessing request host address, I would use <code>req.Host</code>, but I find that there is <code>req.URL.Host</code> field, but when I print it, it's empty.</p>\n\n<pre><code>func handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"uri Host: \" + r.URL.Host + \" Scheme: \" + r.URL.Scheme)\n    fmt.Println(\"Host: \" + r.Host)\n}\n</code></pre>\n\n<p>The documentation of <a href=\"https://golang.org/src/net/http/request.go\" rel=\"noreferrer\">http.Request</a> gives the following comments, while <code>net/url</code> does not give much clue.</p>\n\n<pre><code>// For server requests Host specifies the host on which the\n// URL is sought. Per RFC 2616, this is either the value of\n// the \"Host\" header or the host name given in the URL itself.\n// It may be of the form \"host:port\". For international domain\n// names, Host may be in Punycode or Unicode form. Use\n// golang.org/x/net/idna to convert it to either format if\n// needed.\n//\n// For client requests Host optionally overrides the Host\n// header to send. If empty, the Request.Write method uses\n// the value of URL.Host. Host may contain an international\n// domain name.\nHost string\n</code></pre>\n\n<p>It seems to me that there are two host value in a request: uri line and <code>Host</code> header, like:</p>\n\n<pre><code>GET http://localhost:8080/ HTTP/1.1\nHost: localhost:8080\n</code></pre>\n\n<p>But it does not solve many problems than it creates:</p>\n\n<ol>\n<li>Why are there two different <code>Host</code> field in request? I mean isn't this a duplicate?</li>\n<li>Can the two <code>Host</code> fields be different in the same request?</li>\n<li>Which one should I use for what situation?</li>\n</ol>\n\n<p>Answers with a real HTTP request example would be the best. Thanks in advance.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 1659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d325c7f1dccd85419900e4b67d8b798?s=128&d=identicon&r=PG", "display_name": "Peter K&#246;rner", "link": "https://stackoverflow.com/users/1659732/peter-k%c3%b6rner"}, "edited": false, "score": 0, "creation_date": 1490084789, "post_id": 42921422, "comment_id": 72941163, "body": "Looking at the Sourcecode of the <a href=\"https://github.com/golang/go/blob/39fcf8bf0e3a3b447780983c1f88df5bb9f5bc98/src/net/ip.go#L45\" rel=\"nofollow noreferrer\">net Module</a>,  <code>net.IPv4</code> does not actually produce an instance of the Type IP with a length of 4 bytes, as I expected, but instead an instance of 16 Bytes, which contains a IPv4-in-6 Prefix plus the IPv4-Adress. Calling <code>.To4</code> on it generates the expected IPv4-Adress and also fulfills the DeepEqual requirement.  DeepEqual is used in this Case to compare an entire Struct of Configuration, with the IP being on part of it."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 101, "user_id": 1659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d325c7f1dccd85419900e4b67d8b798?s=128&d=identicon&r=PG", "display_name": "Peter K&#246;rner", "link": "https://stackoverflow.com/users/1659732/peter-k%c3%b6rner"}, "edited": false, "score": 0, "creation_date": 1490087243, "post_id": 42921422, "comment_id": 72942603, "body": "@PeterK&#246;rner: In that case, DeepEqual probably does make sense. Although, as you&#39;ve discovered, there are often sublte &quot;invisible&quot; differences that can make it difficult. One approach I sometimes take (when appropriate) is to marshal both the <code>expected</code> and <code>actual</code> values to JSON (or XML, or any appropriate intermediate format), then unmarshal to an <code>interface{}</code>. This ensures that any such subtleties are filtered out. But it also requires that the structure can be faithfully represented in your intermediate format."}, {"owner": {"reputation": 101, "user_id": 1659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d325c7f1dccd85419900e4b67d8b798?s=128&d=identicon&r=PG", "display_name": "Peter K&#246;rner", "link": "https://stackoverflow.com/users/1659732/peter-k%c3%b6rner"}, "edited": false, "score": 0, "creation_date": 1490218346, "post_id": 42921422, "comment_id": 73020191, "body": "yes, from the small experience I now have with DeepEqual I&#39;d not use it in Unit-Tests either. I&#39;ve seen a lot of &quot;expected [] got []&quot; in the tests which is rather annoying, because ie. one is a nil-value in a []string-type while the other is an empty slice, which behave exactly identical but are not deeply equal. I&#39;d go so far to compare the marshalled json srings, but this is not my project, I&#39;m just extending it. Thank you anyway for your insight. Best Regards"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 890, "user_id": 3364249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQltG.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/3364249/marco"}, "edited": false, "score": 0, "creation_date": 1490805292, "post_id": 42921422, "comment_id": 73280036, "body": "@Marco: Oops. Thanks! Fixed now."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1490805283, "last_edit_date": 1490805283, "creation_date": 1490083754, "answer_id": 42921422, "question_id": 42921227, "link": "https://stackoverflow.com/questions/42921227/ip-part-of-net-ipnet-does-not-fulfil-reflect-deepequal-but-are-equal/42921422#42921422", "title": "IP-Part of net.IPNet does not fulfil reflect.DeepEqual, but are Equal", "body": "<p>They aren't deep equal because they don't meet the <a href=\"https://golang.org/pkg/reflect/#DeepEqual\" rel=\"nofollow noreferrer\">definition of deep equality</a>.</p>\n\n<p>By looking at the internal representation of each value, as I did <a href=\"https://play.golang.org/p/pxeoR21XYC\" rel=\"nofollow noreferrer\">on this playground</a>, we can see that while they are both IPv4 address, <code>bip</code> is preceded by a number of extra bytes (presumably the IPv6 representation... why, I'm not sure).</p>\n\n<pre><code>IPa: 135.104.0.0 3133352e3130342e302e30 net.IP net.IP{0x87, 0x68, 0x0, 0x0}\nIPb: 135.104.0.0 3133352e3130342e302e30 net.IP net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff, 0x87, 0x68, 0x0, 0x0}\n</code></pre>\n\n<p>Further, using DeepEqual to compare something as basic as an IP address is a Very Bad Idea\u2122, for the simple reason that IPs <em>are not deep structures</em>. They are (for equality purposes) simple opaque values. So just compare the opaque values directly. This will mean outputting something from your various storage structs, but output them in a common format and compare that.  Comparing straight IPs in their byte representation (<code>int32</code>) will generally be the most efficient. If you need to compare the network address, netmask, etc, do it the same way.  Alternately, compare a string representation, if that's easier for your tools.</p>\n\n<p>But at the core, an IP address is just a 32-bit integer (or 128-bit integer in the case of IPv6), and the other attributes are other integers.  Checking for Deep Equality on integers makes no sense.</p>\n"}], "owner": {"reputation": 101, "user_id": 1659732, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d325c7f1dccd85419900e4b67d8b798?s=128&d=identicon&r=PG", "display_name": "Peter K&#246;rner", "link": "https://stackoverflow.com/users/1659732/peter-k%c3%b6rner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 42921422, "answer_count": 1, "score": 1, "last_activity_date": 1490805283, "creation_date": 1490083102, "last_edit_date": 1490083413, "question_id": 42921227, "link": "https://stackoverflow.com/questions/42921227/ip-part-of-net-ipnet-does-not-fulfil-reflect-deepequal-but-are-equal", "title": "IP-Part of net.IPNet does not fulfil reflect.DeepEqual, but are Equal", "body": "<p>I'm experiencing unexpected behavior in a unit test which uses reflect.DeepEqual to test for the equality of two parsed structures. The structures contain a Slice of <code>net.IPNet</code> structs. The tests fail because <code>reflect.DeepEqual</code> returns false.</p>\n\n<p>While tracking this issue down I found the following unexpected behavior of DeepEqual. The most fascinating thing for me is that it works with IPv6 addresses and using the war parsed IP, not the masked one in the <code>net.IPNet</code> struct.</p>\n\n<p>Can anyone explain to me:</p>\n\n<ul>\n<li>Why are those IPv4 addresses not DeepEqual, despite their byte-representation seems to be?</li>\n<li>Why are they DeepEqual for IPv6 addresses?</li>\n<li>How to construct an net.IP instance that match the one generated by ParseCIDR with respect to DeepEqual?</li>\n</ul>\n\n<p>Example program, runable with <code>go run</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"reflect\"\n)\n\nfunc main() {\n    aip, a, _ := net.ParseCIDR(\"135.104.0.0/32\")\n    //aip, a, _ := net.ParseCIDR(\"abcd:2345::/65\")\n\n    bip := net.IPv4(135, 104, 0, 0)\n    //bip := net.ParseIP(\"abcd:2345::\")\n\n\n    // IPa: 135.104.0.0 3133352e3130342e302e30\n    fmt.Printf(\"IPa: %s %x\\n\", a.IP, a.IP)\n\n    // IPb: 135.104.0.0 3133352e3130342e302e30\n    fmt.Printf(\"IPb: %s %x\\n\", bip, bip)\n\n    fmt.Println(\"eq?:\", a.IP.Equal(bip)) // true\n\n    // I'd expect this to be true\n    fmt.Println(\"deep eq?:\", reflect.DeepEqual(a.IP, bip)) // false\n\n    fmt.Println(\"deep eq w/o mask?:\", reflect.DeepEqual(aip, bip)) // true\n}\n</code></pre>\n"}, {"tags": ["go", "dependencies", "vendor", "godeps"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490083628, "post_id": 42920729, "comment_id": 72940519, "body": "Switch to a new, clean, empty GOPATH, git clone and build. Dead simple."}, {"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490116363, "post_id": 42920729, "comment_id": 72964897, "body": "Yeah. That is one way. I am just asking if there is anyway to avoid it like passing a flag in <code>go build</code> command."}], "answers": [{"comments": [{"owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "edited": false, "score": 0, "creation_date": 1490116494, "post_id": 42924699, "comment_id": 72964972, "body": "I am working on small project which is deployed on heroku with automatic deployment enabled with github."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1490092731, "creation_date": 1490092731, "answer_id": 42924699, "question_id": 42920729, "link": "https://stackoverflow.com/questions/42920729/how-to-make-sure-go-build-is-using-all-dependencies-from-vendor-directory/42924699#42924699", "title": "How to make sure go build is using all dependencies from vendor directory", "body": "<p>My CI service (<a href=\"https://travis-ci.org/\" rel=\"nofollow noreferrer\">Travis</a> is the one I use) lets me know. Because my test build will fail if the deps aren't available.</p>\n\n<p>You should be using a CI service anyway, and then you get that benefit for free.</p>\n"}, {"tags": [], "owner": {"reputation": 14127, "user_id": 641627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XEgWh.jpg?s=128&g=1", "display_name": "alexbt", "link": "https://stackoverflow.com/users/641627/alexbt"}, "is_accepted": false, "score": 0, "last_activity_date": 1490583978, "creation_date": 1490583978, "answer_id": 43037317, "question_id": 42920729, "link": "https://stackoverflow.com/questions/42920729/how-to-make-sure-go-build-is-using-all-dependencies-from-vendor-directory/43037317#43037317", "title": "How to make sure go build is using all dependencies from vendor directory", "body": "<p>I use <a href=\"https://github.com/kardianos/govendor\" rel=\"nofollow noreferrer\">govendor</a> to manage the dependencies, which has a <code>status</code> option. Here's some of the commands with govendor:</p>\n\n<pre><code>init     Create the \"vendor\" folder and the \"vendor.json\" file.\nlist     List and filter existing dependencies and packages.\nadd      Add packages from $GOPATH.\nupdate   Update packages from $GOPATH.\nremove   Remove packages from the vendor folder.\nstatus   Lists any packages missing, out-of-date, or modified locally.\nfetch    Add new or update vendor folder packages from remote repository.\nsync     Pull packages into vendor folder from remote repository with revisions\n             from vendor.json file.\nmigrate  Move packages from a legacy tool to the vendor folder with metadata.\n</code></pre>\n\n<p>Specifically, you'd do <code>govendor status</code> to check if there are missing packages.</p>\n\n<p>If you decide to use govendor, you can get started by doing:</p>\n\n<ul>\n<li><code>go get github.com/kardianos/govendor</code></li>\n<li><code>govendor migrate</code> (which will migrate from godeps to govendor)</li>\n</ul>\n\n<p>Also, you mentioned in a comment that your deploying to Heroky, here's some <a href=\"https://devcenter.heroku.com/articles/go-dependencies-via-govendor\" rel=\"nofollow noreferrer\">documentation from them on govendor</a></p>\n"}], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490583978, "creation_date": 1490081233, "last_edit_date": 1490087686, "question_id": 42920729, "link": "https://stackoverflow.com/questions/42920729/how-to-make-sure-go-build-is-using-all-dependencies-from-vendor-directory", "title": "How to make sure go build is using all dependencies from vendor directory", "body": "<p>I have used godep and vendored all my dependencies in vendor/ directory. Go build is working fine as well. However how can I be sure that all my dependencies are vendored?</p>\n\n<p>Is there any command that can make sure of that?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "is_accepted": true, "score": 10, "last_activity_date": 1490083920, "creation_date": 1490083920, "answer_id": 42921476, "question_id": 42920666, "link": "https://stackoverflow.com/questions/42920666/logrus-add-extra-field-to-contextlogger/42921476#42921476", "title": "Logrus add extra field to contextlogger", "body": "<p>You can just call <code>cl.WithFields()</code></p>\n\n<pre><code>package main\n\nimport \"github.com/Sirupsen/logrus\"\n\nfunc main() {\n    cl := logrus.WithFields(\n        logrus.Fields{\n            \"extra_field_one\": \"extra_value_one\",\n        })\n    cl = cl.WithFields(\n        logrus.Fields{\n            \"extra_field_two\": \"extra_value_two\",\n        })\n    cl.Info(\"hello world\")\n}\n</code></pre>\n\n<p>Output is:</p>\n\n<pre><code>INFO[0000] hello world extra_field_one=\"extra_value_one\" extra_field_two=\"extra_value_two\"\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4125, "favorite_count": 1, "accepted_answer_id": 42921476, "answer_count": 1, "score": 4, "last_activity_date": 1490171872, "creation_date": 1490081000, "last_edit_date": 1495535397, "question_id": 42920666, "link": "https://stackoverflow.com/questions/42920666/logrus-add-extra-field-to-contextlogger", "title": "Logrus add extra field to contextlogger", "body": "<p>I use logrus in all my go apps and recently I started using a context logger. Now I want to \"build up\" a context during the execution path of my app. See example below, which illustrates what I want.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/Sirupsen/logrus\"\n)\n\nfunc main() {\n    logrus.Info(\"normal logger\")\n\n    cl := logrus.WithFields(\n        logrus.Fields{\n            \"extra_field_one\": \"extra_value_one\",\n        })\n\n    // some code here\n\n    // here I want to add an additional field to to contextlogger cl.\n    // How do I do that?\n\n}\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>As <a href=\"https://stackoverflow.com/a/42921476/1909569\">ymonad</a> mentioned, it's possible by overwriting the contextLogger. Also found out that you can add one additional field:</p>\n\n<pre><code>cl = cl.WithField(\"key\", \"value\")\n</code></pre>\n"}, {"tags": ["json", "go", "marshalling"], "answers": [{"tags": [], "owner": {"reputation": 2449, "user_id": 6346483, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154223277015798/picture?type=large", "display_name": "Anish Goyal", "link": "https://stackoverflow.com/users/6346483/anish-goyal"}, "is_accepted": true, "score": 1, "last_activity_date": 1490081380, "last_edit_date": 1490081380, "creation_date": 1490081043, "answer_id": 42920676, "question_id": 42920581, "link": "https://stackoverflow.com/questions/42920581/add-keys-before-json-marshal-in-golang/42920676#42920676", "title": "Add keys before json.Marshal in Golang", "body": "<p>You could create a wrapper struct that contains an array of country structs, with <code>json: \"countries\"</code>  after the declaration for the countries array, then call json.Marshal on the wrapper. </p>\n\n<p>What it looks like:</p>\n\n<pre><code>type CountryWrapper struct {\n  Countries []*countryModel.Country `json: \"countries\"`\n} \n</code></pre>\n\n<p>Then, in your method, instantiate as <code>CountryWrapper{ Countries: countries }</code>, and call json.Marshal on this object.</p>\n"}], "owner": {"reputation": 31, "user_id": 6065531, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10205881871514956/picture?type=large", "display_name": "Delfrinando Pranata", "link": "https://stackoverflow.com/users/6065531/delfrinando-pranata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 42920676, "answer_count": 1, "score": 1, "last_activity_date": 1490086129, "creation_date": 1490080669, "last_edit_date": 1490086129, "question_id": 42920581, "link": "https://stackoverflow.com/questions/42920581/add-keys-before-json-marshal-in-golang", "title": "Add keys before json.Marshal in Golang", "body": "<p>I am creating a function to get array of object and save it into Struct. Then I want to convert it into JSON.</p>\n\n<pre><code>func GetCountry(msg string) []byte {\n    var countries []*countryModel.Country\n\n    countries = countryModel.GetAllCountry()\n\n    jsResult, err := json.Marshal(countries)\n\n    if err != nil {\n        logger.Error(err, \"Failed on GetCountry\")\n    }\n\n    return jsResult\n}\n</code></pre>\n\n<p>Here is the struct</p>\n\n<pre><code>type Country struct {\n    Id           int    `json:\"id\"`\n    CountryCode string `json:\"country_code\"`\n    CountryName string `json:\"country_name\"`\n    PhoneCode   string `json:\"phone_code\"`\n    Icon         string `json:\"icon\"`\n}\n</code></pre>\n\n<p>With that function, i get these result</p>\n\n<pre><code>[\n  {\n    \"id\": 2,\n    \"country_code\": \"MY\",\n    \"country_name\": \"Malaysia\",\n    \"phone_code\": \"+60\",\n    \"icon\": \"no-data\"\n  },\n  {\n    \"id\": 2,\n    \"country_code\": \"MY\",\n    \"country_name\": \"Malaysia\",\n    \"phone_code\": \"+60\",\n    \"icon\": \"no-data\"\n  }\n]\n</code></pre>\n\n<p>How can i add a key named 'countries' for that JSON result? These what i am expect </p>\n\n<pre><code>{\n    \"countries\" : \n        [\n          {\n            \"id\": 2,\n            \"country_code\": \"MY\",\n            \"country_name\": \"Malaysia\",\n            \"phone_code\": \"+60\",\n            \"icon\": \"no-data\"\n          },\n          {\n            \"id\": 2,\n            \"country_code\": \"MY\",\n            \"country_name\": \"Malaysia\",\n            \"phone_code\": \"+60\",\n            \"icon\": \"no-data\"\n          }\n        ]\n}\n</code></pre>\n\n<p>Please help</p>\n"}, {"tags": ["go", "youtube-api", "youtube-data-api"], "comments": [{"owner": {"reputation": 732, "user_id": 1377521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e875bc92c639a531707a9bfe54f6da8d?s=128&d=identicon&r=PG", "display_name": "Tempus", "link": "https://stackoverflow.com/users/1377521/tempus"}, "edited": false, "score": 0, "creation_date": 1490444240, "post_id": 42920028, "comment_id": 73120935, "body": "I don&#39;t know &quot;GO&quot;, but is it &quot;Slate&quot; or is it supposed to be &quot;State&quot; ? Just a thought."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 732, "user_id": 1377521, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e875bc92c639a531707a9bfe54f6da8d?s=128&d=identicon&r=PG", "display_name": "Tempus", "link": "https://stackoverflow.com/users/1377521/tempus"}, "edited": false, "score": 0, "creation_date": 1490505000, "post_id": 42920028, "comment_id": 73137260, "body": "it&#39;s a slate (meaning: cover)"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1490078230, "creation_date": 1490078230, "question_id": 42920028, "link": "https://stackoverflow.com/questions/42920028/go-youtube-api-the-field-startwithslate-is-required-startwithslaterequired", "title": "Go Youtube API The field startWithSlate is required, startWithSlateRequired", "body": "<p>I'm trying to update broadcast event with Go's <a href=\"https://developers.google.com/youtube/v3/live/docs/errors\" rel=\"nofollow noreferrer\">youtube data API v3</a></p>\n\n<p>But it always show an Error if I set it to <code>false</code>: <code>The field startWithSlate is required, startWithSlateRequired</code> unless I set <code>startWithSlate</code> to <code>true</code> or remove the lib's <a href=\"https://godoc.org/google.golang.org/api/youtube/v3\" rel=\"nofollow noreferrer\">source code</a> on <code>youtube/v3/youtube_gen.go</code> from</p>\n\n<pre><code>StartWithSlate bool `json:\"startWithSlate,omitempty\"`\n</code></pre>\n\n<p>to </p>\n\n<pre><code>StartWithSlate bool `json:\"startWithSlate\"`\n</code></pre>\n\n<p>Is there any other solution for this? or if this a bug, where can I send the bug report? since the site told me to <a href=\"https://developers.google.com/youtube/v3/support\" rel=\"nofollow noreferrer\">post on stackoverflow</a>.</p>\n"}, {"tags": ["go", "maps", "mutex"], "answers": [{"comments": [{"owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "edited": false, "score": 0, "creation_date": 1490069825, "post_id": 42918259, "comment_id": 72935272, "body": "Thanks Andy.  That occured to about 20 seconds after I laid down for the night..."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 6, "last_activity_date": 1490069145, "creation_date": 1490069145, "answer_id": 42918259, "question_id": 42918161, "link": "https://stackoverflow.com/questions/42918161/golang-mutex-sometimes-works/42918259#42918259", "title": "golang mutex sometimes works?", "body": "<p>Every execution of the function is going to create a new mutex, so it isn't actually protecting anything. You need to have the function always use the same mutex by creating it elsewhere (e.g., as a global variable).</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 7959546, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66c59a28109aaa304db6b086dd9dba39?s=128&d=identicon&r=PG&f=1", "display_name": "David S", "link": "https://stackoverflow.com/users/7959546/david-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1493842862, "creation_date": 1493842862, "answer_id": 43769302, "question_id": 42918161, "link": "https://stackoverflow.com/questions/42918161/golang-mutex-sometimes-works/43769302#43769302", "title": "golang mutex sometimes works?", "body": "<p>Make <em>mutex</em> variable not local in your function. This is fixed code:</p>\n\n<pre><code>var mutex sync.Mutex\n\nfunc HMAC(source string, i int) {\n    var value [4]byte\n    // var mutex sync.Mutex\n    defer WG.Done()\n    ... \n</code></pre>\n"}], "owner": {"reputation": 112, "user_id": 7389325, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UaKF.jpg?s=128&g=1", "display_name": "Cassey", "link": "https://stackoverflow.com/users/7389325/cassey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 42918259, "answer_count": 2, "score": 1, "last_activity_date": 1493842862, "creation_date": 1490068547, "question_id": 42918161, "link": "https://stackoverflow.com/questions/42918161/golang-mutex-sometimes-works", "title": "golang mutex sometimes works?", "body": "<p>I have the following goroutine that SOMETIMES generates the dreaded \"fatal error: concurrent map read and map write\".  Traceback indicates its on the s := db.FileInfo... map reference.</p>\n\n<pre><code>func HMAC(source string, i int) {\n    var value [4]byte\n    var mutex sync.Mutex\n    defer WG.Done()\n    hash, err := HashString(source);\n    if err != nil {\n            log.Critical(\"HashString error: \",err)\n    }\n    log.Trace(\"Slice:\",i,\"Authentication hash =\",hash)\n    rand.Seed(time.Now().UnixNano())\n    mutex.Lock()    // Protect Map activity\n    defer mutex.Unlock()\n    s := db.FileInfo.Slices[SliceName]\n    s.Block[i].HMAC = hash\n    for j:=0; j&lt;32; j++ {\n            off := rand.Intn(DataLen-5)  // 4 should do, but be safe\n            s.Block[i].Random[j].Offset = off\n            for k:=0; k&lt;4; k++ {\n                    value[k] = source[off+k]\n            }\n            s.Block[i].Random[j].Value = value\n    }\n    db.FileInfo.Slices[SliceName] = s\n}\n</code></pre>\n\n<p>The HashString(source) function is computationally intensive, so is appropriate as a goroutine.  The code after the mutex calls is all relatively trivial computationally, taking less than 1% of the time the HashString(source) call takes.  go vet is clean on the routine and its caller.</p>\n\n<p>This function is called (32) times as follows:</p>\n\n<pre><code>    util.WG.Add(32)\n    for i:=0; i&lt;32; i++ {\n            off := i*util.BlockLen\n            go util.HMAC(string(tblock[off:off+util.BlockLen-1]),i)\n    }\n    util.WG.Wait()\n</code></pre>\n\n<p>I get the error about once out of every half-dozen or so invocations of the program, very inconsistantly.</p>\n\n<p>Anybody spot what I've done wrong?  The SOMETIMES nature of this problem is perplexing me.  Oh, FWIW, its running on a 12 thread I7.  Also: go version go1.7.5 linux/amd64.</p>\n"}, {"tags": ["file", "go", "indexing"], "answers": [{"tags": [], "owner": {"reputation": 984, "user_id": 1244420, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ca029fbc9431b4df66c61c4c7447b3d5?s=128&d=identicon&r=PG", "display_name": "Addison", "link": "https://stackoverflow.com/users/1244420/addison"}, "is_accepted": false, "score": 0, "last_activity_date": 1490076318, "creation_date": 1490076318, "answer_id": 42919544, "question_id": 42917966, "link": "https://stackoverflow.com/questions/42917966/how-to-get-added-content-of-a-file-since-last-modification/42919544#42919544", "title": "how to get added content of a file since last modification", "body": "<p>If you're running in a Unix-like system, you could just use <a href=\"https://en.wikipedia.org/wiki/Tail_(Unix)\" rel=\"nofollow noreferrer\"><code>tail</code></a>. If you specify to follow the file, the process will keep waiting after reaching end of file. You can invoke this in your program with <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\"><code>os/exec</code></a> and pipe the Stdout to your program. Your program can then read from it periodically or with blocking.</p>\n\n<p>The only way I can think of to do this natively in Go is like how you described. There's also a library that tries to emulate <code>tail</code> in Go here: <a href=\"https://github.com/hpcloud/tail\" rel=\"nofollow noreferrer\">https://github.com/hpcloud/tail</a></p>\n"}, {"tags": [], "owner": {"reputation": 13457, "user_id": 954376, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/08PZK.jpg?s=128&g=1", "display_name": "NeoWang", "link": "https://stackoverflow.com/users/954376/neowang"}, "is_accepted": true, "score": 0, "last_activity_date": 1490077040, "creation_date": 1490077040, "answer_id": 42919713, "question_id": 42917966, "link": "https://stackoverflow.com/questions/42917966/how-to-get-added-content-of-a-file-since-last-modification/42919713#42919713", "title": "how to get added content of a file since last modification", "body": "<p>It depends on how the files change.</p>\n\n<p>If the files are append-only, then you only need to record the last offset where you stopped indexing, and start from there.</p>\n\n<p>If the changes can happen anywhere, and the changes are mostly replacing old bytes with new bytes (like changing pixels of an image), then perhaps you can consider computing checksum for small chucks, and only index those chunks that has different checksums.</p>\n\n<p>You can check out <code>crypto</code> package in Go standard library for computing hashes.</p>\n\n<p>If the changes are line insertion/deletion to text files (like changes to source code), then maybe a diff algorithm can help you find the differences. Something like <a href=\"https://github.com/octavore/delta\" rel=\"nofollow noreferrer\">https://github.com/octavore/delta</a>.</p>\n"}], "owner": {"reputation": 91, "user_id": 3579298, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/769fda9ee9c7a00d8d36e25ee40e2854?s=128&d=identicon&r=PG&f=1", "display_name": "InfinityPlus1", "link": "https://stackoverflow.com/users/3579298/infinityplus1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 42919713, "answer_count": 2, "score": 0, "last_activity_date": 1490077040, "creation_date": 1490067284, "question_id": 42917966, "link": "https://stackoverflow.com/questions/42917966/how-to-get-added-content-of-a-file-since-last-modification", "title": "how to get added content of a file since last modification", "body": "<p>I'm working on a project in golang that needs to index recently added file content (using framework called <strong>bleve</strong>), and I'm looking for a solution to get content of a file since last modification. My current work-around is to record the last indexed position of each file, and during indexing process later on I only retrieve file content starting from the previous recorded position.</p>\n\n<p>So I wonder if there's any library or built-in functionality for this? (doesn't need to be restricted to go, any language could work)</p>\n\n<p>I'll really appreciate it if anyone has a better idea than my work-around as well! </p>\n\n<p>Thanks</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 99308, "user_id": 107744, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7d6a34fb9a78937e1500b7ae0b5aee37?s=128&d=identicon&r=PG&f=1", "display_name": "spencer7593", "link": "https://stackoverflow.com/users/107744/spencer7593"}, "edited": false, "score": 0, "creation_date": 1490064667, "post_id": 42917516, "comment_id": 72933851, "body": "&quot;... logger writes to standard error and prints the date and time of each logged message....&quot;   <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\">golang.org/pkg/log</a>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1490067264, "post_id": 42917516, "comment_id": 72934538, "body": "if you are going to open and close the file with every log statement (which is a really bad idea) why would you even use the logger module at all?  Just <code>fmt.Fprintln(file,msg)</code> and be done with it"}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 7, "last_activity_date": 1490064772, "creation_date": 1490064772, "answer_id": 42917587, "question_id": 42917516, "link": "https://stackoverflow.com/questions/42917516/who-writes-date-and-time-into-log-file/42917587#42917587", "title": "Who writes date and time into log file?", "body": "<p>Create a logger instance with its flags set to <code>0</code>:</p>\n\n<pre><code>log.New(dest, \"\", 0)\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/log/#pkg-constants\" rel=\"noreferrer\">https://golang.org/pkg/log/#pkg-constants</a></li>\n</ul>\n\n<p>Demo: <a href=\"https://play.golang.org/p/ssVaeS9YAu\" rel=\"noreferrer\">https://play.golang.org/p/ssVaeS9YAu</a></p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 1, "accepted_answer_id": 42917587, "answer_count": 1, "score": 0, "last_activity_date": 1490064772, "creation_date": 1490064299, "question_id": 42917516, "link": "https://stackoverflow.com/questions/42917516/who-writes-date-and-time-into-log-file", "title": "Who writes date and time into log file?", "body": "<p>I wrote this little function to log into file</p>\n\n<pre><code>func logMessage(message string) {\n    file, err := os.OpenFile(\"my.log\", O_CREATE|O_RDWR|O_APPEND, 0)\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n    log.SetOutput(file)\n    log.Println(message)\n}\n</code></pre>\n\n<p>But what I do not understand is why </p>\n\n<pre><code>logMessage(\"foo\")\nlogMessage(\"bar\")\n</code></pre>\n\n<p>write this content into file:</p>\n\n<pre><code>2017/03/21 03:34:42 foo\n2017/03/21 03:34:42 bar\n</code></pre>\n\n<p>Can I write without <code>YYYY/MM/DD HH:II:SS</code>?</p>\n"}, {"tags": ["go", "ghostscript"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 993446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc815a3ac67b7969fcb0948d0c3f1dc?s=128&d=identicon&r=PG", "display_name": "Mujiang", "link": "https://stackoverflow.com/users/993446/mujiang"}, "edited": false, "score": 0, "creation_date": 1490089049, "post_id": 42921597, "comment_id": 72943907, "body": "thanks. what I am using is gs 9.20 on window os. (I copied gswin32c into gs :) )"}, {"owner": {"reputation": 11, "user_id": 993446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc815a3ac67b7969fcb0948d0c3f1dc?s=128&d=identicon&r=PG", "display_name": "Mujiang", "link": "https://stackoverflow.com/users/993446/mujiang"}, "edited": false, "score": 0, "creation_date": 1490089496, "post_id": 42921597, "comment_id": 72944228, "body": "and download the copy from offical site <a href=\"https://ghostscript.com/download/gsdnld.html\" rel=\"nofollow noreferrer\">ghostscript.com/download/gsdnld.html</a> . any info you want?"}, {"owner": {"reputation": 27865, "user_id": 701996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hx9ep.jpg?s=128&g=1", "display_name": "KenS", "link": "https://stackoverflow.com/users/701996/kens"}, "reply_to_user": {"reputation": 11, "user_id": 993446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc815a3ac67b7969fcb0948d0c3f1dc?s=128&d=identicon&r=PG", "display_name": "Mujiang", "link": "https://stackoverflow.com/users/993446/mujiang"}, "edited": false, "score": 0, "creation_date": 1490095464, "post_id": 42921597, "comment_id": 72948749, "body": "Well, the WIndows version of Ghostscript has al the resources compiled into the binary, so it can&#39;t be a missing library file. So, back to; &#39;print out the command line you are passing to exec.Command and try that from the Windows command shell&#39;. If that gives you an error you can post a link to the input file, and the command line and I can try it. If it doesn&#39;t give you an error then its something to do with &#39;exec.Command&#39; which I can&#39;t help you with. Oh, I&#39;d also probably <b>not</b> use &#39;-q&#39; since suppressing information isn&#39;t helpful when debugging."}, {"owner": {"reputation": 11, "user_id": 993446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc815a3ac67b7969fcb0948d0c3f1dc?s=128&d=identicon&r=PG", "display_name": "Mujiang", "link": "https://stackoverflow.com/users/993446/mujiang"}, "edited": false, "score": 0, "creation_date": 1490107801, "post_id": 42921597, "comment_id": 72958365, "body": "quite strange, after removing -q away, it works! still don&#39;t know the reason! anyway, thanks KenS"}], "tags": [], "owner": {"reputation": 27865, "user_id": 701996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hx9ep.jpg?s=128&g=1", "display_name": "KenS", "link": "https://stackoverflow.com/users/701996/kens"}, "is_accepted": false, "score": 0, "last_activity_date": 1490084367, "creation_date": 1490084367, "answer_id": 42921597, "question_id": 42916965, "link": "https://stackoverflow.com/questions/42916965/getting-error-while-call-ghostscrip-from-exec-command-of-golang/42921597#42921597", "title": "getting error while call ghostscrip from exec.Command of golang", "body": "<p>The error is telling you that a filename was undefined, that it was a library file, and the name of the file was empty. The () are string delimiters and the top of the operand stack contained that string.</p>\n\n<p>You haven't, unfortunately, quoted the entire error message, so I can't tell what version of Ghostscript you are using. I'm going to assume you are using Linux because you have used 'gs'. You also don't say where you got the version of Ghostscript you are using.</p>\n\n<p>You can add directories to the Ghostscript search path by using the -I switch, but that seems unlikely to be helpful here, as you'll presumably still be searching for an empty name, which obviously isn't going to be found.</p>\n\n<p>I would start by printing out the exact command line that you sent to exec, and trying that from the shell, if that works then we can progress further.</p>\n"}], "owner": {"reputation": 11, "user_id": 993446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2cc815a3ac67b7969fcb0948d0c3f1dc?s=128&d=identicon&r=PG", "display_name": "Mujiang", "link": "https://stackoverflow.com/users/993446/mujiang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490527141, "creation_date": 1490060627, "last_edit_date": 1490527141, "question_id": 42916965, "link": "https://stackoverflow.com/questions/42916965/getting-error-while-call-ghostscrip-from-exec-command-of-golang", "title": "getting error while call ghostscrip from exec.Command of golang", "body": "<p>it is my codes,\n<code>\n    extraCmds := []string{\"-q\", \"-dBATCH\", \"-dNOPAUSE\", \"-dSAFER\", \"-sDEVICE=pcxmono\",\n        fmt.Sprintf(\"-r%v\", dpi), // -r600\n        \"-sOutputFile=BBB%03d.pcx\",\n        \"WO-BC-CARE.pdf\",\n    }\n    s, _ := exec.Command(\"gs\", extraCmds...).Output()\n    reslt := string(s)\n    log.Println(reslt)\n</code></p>\n\n<p>show error,\n<code>\n2017/03/21 09:24:48 Error: /undefinedfilename in --findlibfile--\nOperand stack:\n   ()\nExecution stack:\n   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval-\n-   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   fa\nlse   1   %stopped_push   --nostringval--   1864   1   3   %oparray_pop   --nost\nringval--\nDictionary stack:\n   --dict:1200/1684(ro)(G)--   --dict:0/20(G)--   --dict:78/200(L)--\nCurrent allocation mode is local\nLast OS error: No such file or directory\n</code></p>\n\n<p>sounds like can not find ps library, but didn't know how to set gs path with exec.Command. \nthanks for suggestion in advance.</p>\n\n<p>[update], I solved the issue via upgrading gs from 9.20 to 9.21. Another pitfall need attention while using golang exec.Command. It is do not put quote in parameters, say <code>\"BBB%03d.pcx\"</code>. You have to use <code>BBB%03d.pcx</code> instead.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490060658, "post_id": 42916952, "comment_id": 72932842, "body": "If you don&#39;t return it will keep executing, if you don&#39;t want to use the <code>return</code> keyword you can use the <code>else</code> branch in your <code>if</code> statements."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490061269, "post_id": 42916952, "comment_id": 72932986, "body": "But I would still have to return after the else right? Or else it would go to the next handler."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490061801, "post_id": 42916952, "comment_id": 72933104, "body": "If you do your <code>else</code> branches this way <a href=\"https://play.golang.org/p/wQAOpy5vjC\" rel=\"nofollow noreferrer\">play.golang.org/p/wQAOpy5vjC</a>, you can see the code stops where it should."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490062186, "post_id": 42916952, "comment_id": 72933197, "body": "I understand. Thanks! May I ask which one you prefer? If with return or else?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490063039, "post_id": 42916952, "comment_id": 72933438, "body": "Personally I&#39;m not a fan of the <code>else</code> branch if the code inside its block is just one or two lines.. so in this specific case i would use <code>return</code> instead of <code>else</code>, and I also prefer to return early so as to avoid deep nested <code>if</code> statements. Something like this <a href=\"https://play.golang.org/p/uk0S1hCPhu\" rel=\"nofollow noreferrer\">play.golang.org/p/uk0S1hCPhu</a> but that&#39;s just me.."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490063948, "post_id": 42916952, "comment_id": 72933682, "body": "That was much better. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490062974, "post_id": 42917257, "comment_id": 72933422, "body": "&quot;just redirects the user to a different route&quot; --- that is pretty much inaccurate. <a href=\"https://golang.org/src/net/http/server.go?s=58995:59063#L1979\" rel=\"nofollow noreferrer\">golang.org/src/net/http/server.go?s=58995:59063#L1979</a> --- it sets headers and response. Basically, it has nothing to do with &quot;routes&quot;."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 0, "last_activity_date": 1490062506, "creation_date": 1490062506, "answer_id": 42917257, "question_id": 42916952, "link": "https://stackoverflow.com/questions/42916952/do-you-have-to-return-after-a-http-redirect-if-you-want-the-code-after-to-stop-e/42917257#42917257", "title": "Do you have to return after a http.Redirect if you want the code after to stop executing?", "body": "<p><code>http.Redirect</code> just redirects the user to a different route. It does not break out from the code execution.</p>\n\n<p>You could also use <code>else</code> statement to wrap around the last <code>next.ServeHTTP(w, r)</code> which makes it looks cleaner. But Go's idiom tends to use <code>return</code> instead of <code>else</code>.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 42917257, "answer_count": 1, "score": 0, "last_activity_date": 1490062506, "creation_date": 1490060506, "question_id": 42916952, "link": "https://stackoverflow.com/questions/42916952/do-you-have-to-return-after-a-http-redirect-if-you-want-the-code-after-to-stop-e", "title": "Do you have to return after a http.Redirect if you want the code after to stop executing?", "body": "<p>If I use http.Redirect in a middleware, do I explicitly have to return after the http.Redirect before calling next.ServeHTTP(w, r)?</p>\n\n<p>If I have something like this, do I have to return explicitly after every http.Redirect in order for the code to stop executing after the redirect? What happens if I don't return?</p>\n\n<pre><code>// HTTPSNonWWWRedirect redirects http requests to https non www.\nfunc HTTPSNonWWWRedirect(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        if r.TLS == nil {\n            u := *r.URL\n            u.Scheme = \"https\"\n            if r.Host[:3] == \"www\" {\n                u.Host = r.Host[4:]\n                http.Redirect(w, r, u.String(), http.StatusMovedPermanently)\n                return\n            }\n            http.Redirect(w, r, u.String(), http.StatusMovedPermanently)\n            return\n        }\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1490055366, "last_edit_date": 1490055366, "creation_date": 1490055060, "answer_id": 42916228, "question_id": 42916088, "link": "https://stackoverflow.com/questions/42916088/golang-unmarshal-array-without-key-value-to-stuct/42916228#42916228", "title": "Golang unmarshal array without key/value to stuct", "body": "<p>I don't think it's possible, with <code>encoding/json</code> to directly decode that json into a slice of structs <strong>without</strong> first implementing a <code>UnmarshalJSON</code> method on your <code>Row</code> type.</p>\n\n<pre><code>func (r *Row) UnmarshalJSON(data []byte) error {\n     var s []string\n     if err := json.Unmarshal(data, &amp;s); err != nil {\n          return err\n     }\n     if len(s) &gt;= 3 {\n         r.Gender = s[0]\n         r.AgeRange = s[1]\n         r.Count = s[2]\n     }\n     return nil\n}\n\n// make sure it's a slice of pointers to Row\ntype Resp struct {\n    Rows []*Row `json:\"rows\"`\n}\n</code></pre>\n\n<p><strong>Edit</strong>: fixed the code a little to make it actually compile. Heres a working example <a href=\"https://play.golang.org/p/eqVQj65xJv\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eqVQj65xJv</a>.</p>\n\n<p>You could also just decode the data first into a slice of strings and then loop over the result to build you struct values.</p>\n\n<pre><code>type Resp struct {\n    Rows [][]string `json:\"rows\"`\n}\n\ntype Row struct {\n    Gender   string `json:\"gender\"`\n    AgeRange string `json:\"blah\"`\n    Count    string `json:\"blah\"`\n}\n\nvar resp jResp\nif err := json.Unmarshal(data, &amp;resp); err != nil {\n    panic(err)\n}\n\nvar rows = make([]Row, len(resp.Rows))\nfor i, r := range resp.Rows {\n    rows[i] = Row{\n        Gender: r[0],\n        AgeRange: r[1],\n        Count: r[2],\n    }\n}\n</code></pre>\n\n<p><strong>Edit</strong>: fixed this one as well. <a href=\"https://play.golang.org/p/Otb7iULSh3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Otb7iULSh3</a></p>\n"}], "owner": {"reputation": 41, "user_id": 7742674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad9dae4997bab37268a48959b78d51b?s=128&d=identicon&r=PG&f=1", "display_name": "vinniyo", "link": "https://stackoverflow.com/users/7742674/vinniyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1365, "favorite_count": 0, "accepted_answer_id": 42916228, "answer_count": 1, "score": 0, "last_activity_date": 1490055366, "creation_date": 1490054065, "question_id": 42916088, "link": "https://stackoverflow.com/questions/42916088/golang-unmarshal-array-without-key-value-to-stuct", "title": "Golang unmarshal array without key/value to stuct", "body": "<p>I'm trying to place a json array into a struct from Google Analytics API. </p>\n\n<p>EG:</p>\n\n<pre><code>\"rows\": [\n    [\n        \"female\",\n        \"18-24\",\n        \"1308\"\n    ],\n    [\n        \"female\",\n        \"25-34\",\n        \"741\"\n    ]\n]\n</code></pre>\n\n<p>Typically I'd have key/value so I can put <code>json:\"gender\"</code> but there are no keys to associate with, so the values that it would search for change.</p>\n\n<p>The struct would be:</p>\n\n<pre><code>type Row struct {\n    Gender   string `json:\"gender\"`\n    AgeRange string `json:\"blah\"`\n    Count    string `json:\"blah\"`\n}\n</code></pre>\n\n<p>If I do len(jResp.Rows) I can see that it's grabbing all twelve rows/arrays but the fields are empty. </p>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 696, "user_id": 1856086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/edb72c51ff89eddf7e9d7a274cfd81fe?s=128&d=identicon&r=PG&f=1", "display_name": "Stas Makarov", "link": "https://stackoverflow.com/users/1856086/stas-makarov"}, "edited": false, "score": 0, "creation_date": 1490052150, "post_id": 42915639, "comment_id": 72930510, "body": "Hi! On what line do yo get the error message?  <code>*[]device.Device</code> -- pointer to a slice of <code>device.Device</code>. <code>[]*device.Device</code> -- slice of pointers to a <code>device.Device</code>. This read might be useful to you: <a href=\"https://divan.github.io/posts/avoid_gotchas/\" rel=\"nofollow noreferrer\">divan.github.io/posts/avoid_gotchas</a>"}, {"owner": {"reputation": 553, "user_id": 2066760, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/ca2379263a96d308177eac9cd3f260aa?s=128&d=identicon&r=PG", "display_name": "Sriram Venkatesh", "link": "https://stackoverflow.com/users/2066760/sriram-venkatesh"}, "reply_to_user": {"reputation": 696, "user_id": 1856086, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/edb72c51ff89eddf7e9d7a274cfd81fe?s=128&d=identicon&r=PG&f=1", "display_name": "Stas Makarov", "link": "https://stackoverflow.com/users/1856086/stas-makarov"}, "edited": false, "score": 0, "creation_date": 1490060322, "post_id": 42915639, "comment_id": 72932759, "body": "That was a good documentation thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "is_accepted": true, "score": 2, "last_activity_date": 1490055550, "creation_date": 1490055550, "answer_id": 42916302, "question_id": 42915639, "link": "https://stackoverflow.com/questions/42915639/golang-parsing-of-protobuf/42916302#42916302", "title": "Golang Parsing of ProtoBuf", "body": "<pre><code>func filterDevices(filter string) ([]*proto.Device, error) {\n    // Currently only supports listing a single service for now\n    // TODO: expand filter to be more consise\n    filteredDevices := make([]*proto.Device, 0, len(devices))\n    for _, e := range devices {\n        for _, f := range e.BoundServices {\n            if f == filter {\n                filteredDevices = append(filteredDevices, &amp;e)\n            }\n        }\n    }\n    return filteredDevices, nil\n}\n</code></pre>\n\n<p>There <em>is</em> a difference between a slice of pointers ([]*) and a pointer to a slice (*[]). You are returning a pointer to slice, whereas what you want is a slice of pointers. We can solve this by: </p>\n\n<ul>\n<li>Updating your <code>filterDevices</code> signature to return a slice of pointers</li>\n<li>Updating your <code>make</code> call to make a slice of pointers</li>\n<li>Taking the address of <code>e</code> in your call to append (we want a slice of pointers to devices) </li>\n<li><em>Not</em> returning the address of the slice</li>\n</ul>\n"}], "owner": {"reputation": 553, "user_id": 2066760, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/ca2379263a96d308177eac9cd3f260aa?s=128&d=identicon&r=PG", "display_name": "Sriram Venkatesh", "link": "https://stackoverflow.com/users/2066760/sriram-venkatesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1494, "favorite_count": 0, "accepted_answer_id": 42916302, "answer_count": 1, "score": 0, "last_activity_date": 1490055550, "creation_date": 1490051502, "last_edit_date": 1490051924, "question_id": 42915639, "link": "https://stackoverflow.com/questions/42915639/golang-parsing-of-protobuf", "title": "Golang Parsing of ProtoBuf", "body": "<p>I'm new to Golang and I am trying to write an home automation framework in Golang, using the Micro framework and Protobuf framework.</p>\n\n<p>I am currently having a hard time trying to implement a simple registry type service. </p>\n\n<p>An example of the problem I am having is that I have the following, I want to be able to get a list of devices, provided a client does a GET request to <code>http://localhost:8080/view/devices</code></p>\n\n<p>I have the following protobuf definition:</p>\n\n<pre><code>syntax = \"proto3\";\n\nservice DRegistry {\n    rpc View(ViewRequest) returns (DeviceRegistry) {}\n} \n\nmessage DeviceRegistry {\n    repeated Device devices = 1;\n}\n\nmessage ViewRequest {\n    string Alias = 1;\n}\n\nmessage Device {\n    string Alias = 1;\n    string HWAddress = 2;\n    string WakeUpMethod = 3;\n    repeated string BoundServices = 4;\n}\n</code></pre>\n\n<p>Then in my service defination I have the following: </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    micro \"github.com/micro/go-micro\"\n    proto \"github.com/srizzling/gotham/proto/device\"\n\n    \"golang.org/x/net/context\"\n)\n\n// DRegistry stands for Device Registry and is how devices register to Gotham.\ntype DRegistry struct{}\n\nvar devices map[string]proto.Device\n\nfunc (g *DRegistry) View(ctx context.Context, req *proto.ViewRequest, rsp *proto.DeviceRegistry) error {\n    filter := req.Alias\ndevices, err := filterDevices(filter)\nrsp.Devices = devices\n}\n\nfunc filterDevices(filter string) (*[]proto.Device, error) {\n    // Currently only supports listing a single service for now\n    // TODO: expand filter to be more consise\n    filteredDevices := make([]proto.Device, 0, len(devices))\n    for _, e := range devices {\n        for _, f := range e.BoundServices {\n            if f == filter {\n                filteredDevices = append(filteredDevices, e)\n            }\n        }\n    }\n    return &amp;filteredDevices, nil\n}\n\nfunc main() {\n    service := micro.NewService(\n        micro.Name(\"DRegistry\"),\n    )\n    proto.RegisterDRegistryHandler(service.Server(), new(DRegistry))\n\n    if err := service.Run(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>The problem I am having is that my IDE (Visual Studio Code) is complianing that I <code>cannot use devices (type *[]device.Device) as type []*device.Device in assignment</code> which is confusing.</p>\n\n<p>TLDR: How do I assign a collection of proto.Devices to the proto.DeviceRegistry?</p>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 1607, "user_id": 4447365, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e87a3dfea9b04716e33dcadf9d92d2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Burn", "link": "https://stackoverflow.com/users/4447365/ryan-burn"}, "edited": false, "score": 0, "creation_date": 1490140735, "post_id": 42939914, "comment_id": 72977464, "body": "Do you know if this is documented anywhere?"}, {"owner": {"reputation": 1607, "user_id": 4447365, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e87a3dfea9b04716e33dcadf9d92d2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Burn", "link": "https://stackoverflow.com/users/4447365/ryan-burn"}, "edited": false, "score": 0, "creation_date": 1490143582, "post_id": 42939914, "comment_id": 72978278, "body": "I know you can exit on errors; but in the case of no errors, are you allowed to omit a final call to <code>Recv</code> if you know the result will be <code>io.EOF</code>?"}, {"owner": {"reputation": 946, "user_id": 1549380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e48782f786b9d3f34b3cb86e514aad4?s=128&d=identicon&r=PG", "display_name": "Zack Butcher", "link": "https://stackoverflow.com/users/1549380/zack-butcher"}, "edited": false, "score": 0, "creation_date": 1494264468, "post_id": 42939914, "comment_id": 74743162, "body": "It depends on your exact setup: - If you close the ClientConn then the underlying transport is closed as well and the server will stop handling the stream. - If you set up the stream with a deadline on the client side, but omit closing the connection, the server will keep the connection open until the deadline is exceeded - If you do not set a deadline on the client side and do not close the client connection, GRPC will poll the underlying connection with backoff based on the <a href=\"https://godoc.org/google.golang.org/grpc/keepalive#ServerParameters\" rel=\"nofollow noreferrer\">keepalive options</a> used to create the server."}], "tags": [], "owner": {"reputation": 576, "user_id": 7371810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53dfe10f0150e2213e244ef1b93ccde?s=128&d=identicon&r=PG&f=1", "display_name": "menghanl", "link": "https://stackoverflow.com/users/7371810/menghanl"}, "is_accepted": true, "score": 0, "last_activity_date": 1490137849, "creation_date": 1490137849, "answer_id": 42939914, "question_id": 42915337, "link": "https://stackoverflow.com/questions/42915337/are-you-required-to-call-recv-until-you-get-io-eof-when-interacting-with-grpc-cl/42939914#42939914", "title": "Are you required to call Recv until you get io.EOF when interacting with grpc.ClientStreams?", "body": "<p>Your code is correct.</p>\n\n<p>You can exit on errors. You don't need to wait for an EOF.</p>\n"}], "owner": {"reputation": 1607, "user_id": 4447365, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e87a3dfea9b04716e33dcadf9d92d2ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Burn", "link": "https://stackoverflow.com/users/4447365/ryan-burn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1761, "favorite_count": 1, "accepted_answer_id": 42939914, "answer_count": 1, "score": 3, "last_activity_date": 1490137849, "creation_date": 1490049928, "question_id": 42915337, "link": "https://stackoverflow.com/questions/42915337/are-you-required-to-call-recv-until-you-get-io-eof-when-interacting-with-grpc-cl", "title": "Are you required to call Recv until you get io.EOF when interacting with grpc.ClientStreams?", "body": "<p>Suppose I define the following gRPC service:</p>\n\n<pre><code>service Library {\n  rpc Search(SearchBookRequest) returns (stream SearchBookResponse) {} \n}\n\nmessage SearchBookRequest {\n  string term = 1;\n  int32 max_results = 2;\n}\n\nmessage SearchBookResponse {\n  int32 book_id = 1;\n}\n</code></pre>\n\n<p>It streams search results back up to a specified maximum. When interacting with the service via gRPC's Go API, am I allowed to do something like this?</p>\n\n<pre><code>for i:=0; i&lt;maxResults; i++ {\n  search_result, err := stream.Recv()\n  if err == io.EOF {\n    // Note: If `maxResults` are returned this will never be reached.\n    break\n  }\n  if err != nil {\n    log.Fatalf(\"search error: %v\", err)\n  }\n  fmt.Printf(\"Book-ID: %d\\n\", search_result.BookId)\n}\n</code></pre>\n\n<p>Or am I required to keep calling <code>Recv</code> until I get <code>io.EOF</code> to ensure that gRPC properly cleans up all its resources?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490047607, "post_id": 42914774, "comment_id": 72928828, "body": "is <code>stopContainer(...)</code> a blocking call?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490050731, "post_id": 42914774, "comment_id": 72930021, "body": "@zerkms yes, in other words, that go-thread i spawn will wait for <code>stopContainer()</code> to finish before executing <code>os.Exit(0)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490051045, "post_id": 42914774, "comment_id": 72930145, "body": "But the main thread is not being blocked if that&#39;s what you mean. @zerkms also the &quot;Received a signal interrupt, stopping container...&quot; string is printing twice, I also found that odd"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490052192, "post_id": 42914774, "comment_id": 72930524, "body": "Any chance you receive more than one signal? What if you increase channel buffer?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490055420, "post_id": 42914774, "comment_id": 72931439, "body": "@zerkms disregard the last comment, it&#39;s not printing output twice, but the output is for sure spilling over the command prompt. It&#39;s pretty confusing to me how the command prompt is returning before the program stops printing output to stdout."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490055686, "post_id": 42914774, "comment_id": 72931510, "body": "What shell do you use? Any additional shell-related managers like screen or tmux?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1490055926, "post_id": 42914774, "comment_id": 72931581, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/138578/discussion-between-sreya-and-zerkms\">continue this discussion in chat</a>."}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490047235, "creation_date": 1490047235, "question_id": 42914774, "link": "https://stackoverflow.com/questions/42914774/why-is-my-command-prompt-being-returned-prematurely-on-a-ctrlc", "title": "Why is my command prompt being returned prematurely on a Ctrl+C?", "body": "<p>I've got a program where I spawn a goroutine to monitor for a SIGINT so I can do some cleanup work before exiting the program. However I've noticed that the cmd prompt for the terminal is returned immediately after the Ctrl+C which means that a bunch of the output spills over. Here's the code and an example of what I'm seeing:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>sigs := make(chan os.Signal, 1)\nsignal.Notify(sigs, syscall.SIGINT, syscall.SIGTERM, os.Interrupt)\n//spawn a thread to wait on the sigterm op\ngo func() {\n    &lt;-sigs\n    fmt.Println(\"Received a signal interrupt, stopping container\")\n    stopContainer(containerName)\n    os.Exit(0)\n}()\nruntime.Gosched()\n//rest of program that prints logs from a running docker container\n</code></pre>\n\n<p>The output looks like this </p>\n\n<pre><code>^CReceived a signal interrupt, stopping container\nReceived a signal interrupt, stopping container\n\nmbp:myDir myName$ Stopping the 'javaTest-tools' container...\nStopping the 'javaTest-tools' container...\n\nBuild time: 3m31.275495945s\nDone.\n</code></pre>\n\n<p>You can see that the 3rd line of output that begins with <code>mpb:myDir myName$</code> is the cmd line prompt being returned and then stdout being printed afterwards. I'm a little baffled by why the cmd line acts like the program ends earlier than it does.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2449, "user_id": 6346483, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154223277015798/picture?type=large", "display_name": "Anish Goyal", "link": "https://stackoverflow.com/users/6346483/anish-goyal"}, "edited": false, "score": 0, "creation_date": 1490045916, "post_id": 42914259, "comment_id": 72928071, "body": "You won&#39;t be able to typecast Bar in this way. Maybe you could look into using interfaces of some sort?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1490079203, "post_id": 42914259, "comment_id": 72938423, "body": "Vendoring per se does <i>not</i> &quot;hide&quot; types. Could you come up with a real example? Yours does not really show the actual problem."}, {"owner": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "edited": false, "score": 0, "creation_date": 1490157574, "post_id": 42914259, "comment_id": 72982139, "body": "An example of this issue is described <a href=\"https://github.com/golang/go/issues/12432\" rel=\"nofollow noreferrer\">here</a>: Essentially the type <code>T</code> from the a.go vendored in b is inaccessible outside of b."}], "answers": [{"comments": [{"owner": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "edited": false, "score": 0, "creation_date": 1490067284, "post_id": 42914383, "comment_id": 72934545, "body": "The problem is not that it&#39;s a private field, it&#39;s that Foo is not available due to vendoring. If Foo was not vendored the problem would not exist. Unfortunately it does not have the constructor."}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "reply_to_user": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "edited": false, "score": 0, "creation_date": 1490100701, "post_id": 42914383, "comment_id": 72952621, "body": "Im not sure what you mean by vendored.  As far as I can tell you mean its a private variable (has a lower case letter in the struct) If it is a private field in a library you didn&#39;t write there should be a method or you aren&#39;t using the library as intended (or it was written poorly) If it is a library you wrote, make it public?"}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": false, "score": 1, "last_activity_date": 1490045685, "last_edit_date": 1495542728, "creation_date": 1490045685, "answer_id": 42914383, "question_id": 42914259, "link": "https://stackoverflow.com/questions/42914259/how-to-convert-to-typeoffield/42914383#42914383", "title": "How to convert to typeof(field)?", "body": "<p>You shouldn't set the private method from another library <a href=\"https://stackoverflow.com/questions/17981651/in-go-is-there-any-way-to-access-private-fields-of-a-struct-from-another-packag\">as per this answer</a>. However,\nthe library should have an appropriate constructor. The library should have a method that looks like </p>\n\n<pre><code>func FooFooGenerator(appropriateInfo int) FooFoo {\n ... Library does the work \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1490055784, "last_edit_date": 1490055784, "creation_date": 1490046749, "answer_id": 42914626, "question_id": 42914259, "link": "https://stackoverflow.com/questions/42914259/how-to-convert-to-typeoffield/42914626#42914626", "title": "How to convert to typeof(field)?", "body": "<p>You just need to export a \"constructor\" function for <code>FooFoo</code> and keep your <code>foo</code> unexported.</p>\n\n<pre><code>func NewFooFoo() *FooFoo {\n    f := &amp;foo{ /* initialize foo */ }\n    return &amp;FooFoo{foo:f}\n}\n</code></pre>\n\n<p>Then clients of you package will have access to <code>NewFooFoo</code>, and <code>FooFoo</code>, but not <code>foo</code>.</p>\n\n<p>And as for casting <code>Foo</code> to <code>Bar</code>, not sure why you would want that, but you can do it, if you are on <strong>Go1.8+</strong>, this way <code>(*Foo)(&amp;Bar{ 5 })</code> <a href=\"https://play.golang.org/p/l696pw-Poh\" rel=\"nofollow noreferrer\">playground</a>.</p>\n"}], "owner": {"reputation": 4646, "user_id": 168683, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6c60cfdf4426b0067801bff11e836430?s=128&d=identicon&r=PG&f=1", "display_name": "Fozi", "link": "https://stackoverflow.com/users/168683/fozi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1490055784, "creation_date": 1490045163, "question_id": 42914259, "link": "https://stackoverflow.com/questions/42914259/how-to-convert-to-typeoffield", "title": "How to convert to typeof(field)?", "body": "<p>Given something like this:</p>\n\n<pre><code>type Foo struct {\n  x int\n}\n\ntype FooFoo struct {\n  foo *Foo\n}\n\ntype Bar struct {\n  x int\n}\n</code></pre>\n\n<p>Where <code>Foo</code> is hidden (in my case due to vendoring), how can I create a FooFoo struct with a valid foo entry?</p>\n\n<p>If <code>Foo</code> were available, I could do </p>\n\n<pre><code>foofoo := &amp;FooFoo{ foo: &amp;Foo{5} }\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>foofoo := &amp;FooFoo{ foo: (*Foo)&amp;Bar{ 5 } }\n</code></pre>\n\n<p>But I can't find a way to do it without mentioning <code>Foo</code>.</p>\n\n<p>I think I would need something like:</p>\n\n<pre><code>foofoo := &amp;FooFoo{ foo: (*typeof(FooFoo.foo)) &amp;Bar{ 5 } }\n</code></pre>\n"}, {"tags": ["html", "go", "revel"], "comments": [{"owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1490043238, "post_id": 42913737, "comment_id": 72926696, "body": "Isn&#39;t <code>p</code> the name of the template file?"}, {"owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "reply_to_user": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "edited": false, "score": 0, "creation_date": 1490044052, "post_id": 42913737, "comment_id": 72927122, "body": "@TheHippo tried to clearify that. It should render <code>Page</code> right there"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1490045587, "last_edit_date": 1490045587, "creation_date": 1490044933, "answer_id": 42914214, "question_id": 42913737, "link": "https://stackoverflow.com/questions/42913737/revel-template-multiple-variables-access-one-inside-the-others-range/42914214#42914214", "title": "Revel template multiple variables, access one inside the others range", "body": "<p>Revel seems to be using Go's template engine, therefore I guess you should be able to use whatever stuff's allowed with <code>html/template</code> like variables.</p>\n\n<pre><code>{{$p := .p}}\n{{range .g}}\n... // print g related stuff\n{{$p}}\n{{end}}\n</code></pre>\n\n<p>See documentation for more info <a href=\"https://golang.org/pkg/text/template/#hdr-Variables\" rel=\"nofollow noreferrer\">https://golang.org/pkg/text/template/#hdr-Variables</a></p>\n\n<p><strike>Please note, if <code>p</code> is not a key in a map but a field of a struct, you won't be able to access it, i believe, since it is not exported.</strike> Ok I understand now, Revel seems to derive the names inside the template from the names of the arguments that were passed to <code>Render</code>.</p>\n"}], "owner": {"reputation": 765, "user_id": 2176965, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44a425d990d4ff43fe5a93d1aa236db7?s=128&d=identicon&r=PG&f=1", "display_name": "DiCaprio", "link": "https://stackoverflow.com/users/2176965/dicaprio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 42914214, "answer_count": 1, "score": 0, "last_activity_date": 1490045587, "creation_date": 1490043110, "last_edit_date": 1490043905, "question_id": 42913737, "link": "https://stackoverflow.com/questions/42913737/revel-template-multiple-variables-access-one-inside-the-others-range", "title": "Revel template multiple variables, access one inside the others range", "body": "<p>I have a controller passing two variables </p>\n\n<pre><code>func (a App) Page() revel.Result {\n    var g []*G\n    ...\n    return c.Render(p, g)\n}\n</code></pre>\n\n<p>in my <code>.html</code> I want to iterate over <code>g</code>. Is it possible to access p inside the iteration? I couldnt manage. My try looks like the following</p>\n\n<pre><code>{{range .g}}\n... // print g related stuff\n.p\n{{end}}\n</code></pre>\n\n<p>and it throws <code>can't evaluate field p in type *G</code>.</p>\n"}, {"tags": ["pointers", "go", "struct", "heap"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490040709, "post_id": 42912601, "comment_id": 72925270, "body": "Go is safe here. You simply <b>cannot</b> produce dangling pointers, it simply does not matter what you do (if you stay away from package unsafe). The compiler is playing safe here: If it cannot prove that allocation on the stacke is safe it will allocate on the heap. Nothing to worry about; move along."}, {"owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490043312, "post_id": 42912601, "comment_id": 72926731, "body": "@Volker I am not worrying about dangling pointers, but I am worrying about enclosing structure not being garbage collected soon enough."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490073352, "post_id": 42912601, "comment_id": 72936251, "body": "First: type A is empty so there is nothing to collect in your example. Assuming A is not empty in real life than how could the GC collect localB if localB.A is in use? Are you assuming the GC is broken?"}, {"owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1490135816, "post_id": 42912601, "comment_id": 72975832, "body": "Assuming that A is not empty and B has other members besides A, then yes, like it was mentioned in escape analysis link from one of answers, Go escape analysis is not perfect, consequently garbage collection is not perfect too. So we can say to a certain degree that it&#39;s &quot;broken&quot; or better word - imperfect. Now if my structure B is big and A is small then this imperfection is important to know if I deal with millions of B. I can imagine that it should be possible for ideal GC to garbage collect parts of B even if A cannot be collected."}], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 3, "last_activity_date": 1490040660, "creation_date": 1490040660, "answer_id": 42913066, "question_id": 42912601, "link": "https://stackoverflow.com/questions/42912601/returning-pointer-on-struct-member-or-embedded-struct-in-go/42913066#42913066", "title": "Returning pointer on struct member or embedded struct in Go?", "body": "<p>The compiler performs <a href=\"http://blog.rocana.com/golang-escape-analysis\" rel=\"nofollow noreferrer\">escape analysis</a> to determine whether a variable may be used outside of the scope in which it is created, in which case it must be allocated on the heap. If the compiler can make sure that this won\u2019t happen, it allocates the variable on the stack.</p>\n\n<p>However, this is the current behaviour of the compiler, but it is not mentioned in the specification, so it may change in any future version.</p>\n"}, {"tags": [], "owner": {"reputation": 2268, "user_id": 1861412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDcs9.jpg?s=128&g=1", "display_name": "Cristian Greco", "link": "https://stackoverflow.com/users/1861412/cristian-greco"}, "is_accepted": false, "score": 3, "last_activity_date": 1490041369, "creation_date": 1490041369, "answer_id": 42913267, "question_id": 42912601, "link": "https://stackoverflow.com/questions/42912601/returning-pointer-on-struct-member-or-embedded-struct-in-go/42913267#42913267", "title": "Returning pointer on struct member or embedded struct in Go?", "body": "<p>Why are you even wondering about these details?</p>\n\n<p>Quoting the <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"nofollow noreferrer\">Go FAQ</a> (emphasis mine):</p>\n\n<blockquote>\n  <p>From a correctness standpoint, you don't need to know. Each variable\n  in Go exists as long as there are references to it. The storage\n  location <strong>chosen by the implementation</strong> is irrelevant to the semantics\n  of the language.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>In the current compilers, if a variable has its address taken, that\n  variable is a <strong>candidate</strong> for allocation on the heap. However, a basic\n  escape analysis recognizes some cases when such variables will not\n  live past the return from the function and can reside on the stack.</p>\n</blockquote>\n\n<p>The behavior of the compiler and the garbage collector are strictly implementation-dependent, and subject to changes across different releases.\nYou cannot event prove your opening statement is always true: the compiler may decide to apply further optimization depending on how your function is written or invoked.</p>\n"}], "owner": {"reputation": 2602, "user_id": 195446, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/352786317e9db0cac0bd6545d52d21ae?s=128&d=identicon&r=PG", "display_name": "alpav", "link": "https://stackoverflow.com/users/195446/alpav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 0, "accepted_answer_id": 42913066, "answer_count": 2, "score": 1, "last_activity_date": 1490136305, "creation_date": 1490038974, "last_edit_date": 1490136305, "question_id": 42912601, "link": "https://stackoverflow.com/questions/42912601/returning-pointer-on-struct-member-or-embedded-struct-in-go", "title": "Returning pointer on struct member or embedded struct in Go?", "body": "<p>Taking address and returning pointer to a local variable inside a function in Go causes compiler to allocate it on heap rather than stack, so that returned pointer remains valid.</p>\n\n<p>Now what happens if I take and return address of a struct member or embedded struct ?</p>\n\n<pre><code>type A struct {\n    a,b,c int\n}\ntype B struct {\n    A\n    d,e,f int\n}\nfunc (b *B) get1() *A {\n    return &amp;b.A\n}\nfunc (b *B) get2() *A {\n    localB := B{}\n    return &amp;localB.A\n}\n</code></pre>\n\n<p>Will compiler allocate embedded struct A on heap and keep members of B on stack ?</p>\n\n<p>Will garbage collector collect localB even if localB.A reference is still in use ?</p>\n\n<p>How can compiler determine when to keep embedded struct on stack or heap in case if it's accessed through reflection ?</p>\n"}, {"tags": ["parsing", "go", "yaml"], "comments": [{"owner": {"reputation": 2316, "user_id": 2213164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wllwh.jpg?s=128&g=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/2213164/stanislav"}, "edited": false, "score": 0, "creation_date": 1503306602, "post_id": 42912392, "comment_id": 78544092, "body": "This seems to work:  <a href=\"https://stackoverflow.com/questions/30341588/how-to-parse-a-complicated-json-with-go-unmarshal\" title=\"how to parse a complicated json with go unmarshal\">stackoverflow.com/questions/30341588/&hellip;</a>"}], "owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 674, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1490038215, "creation_date": 1490038215, "question_id": 42912392, "link": "https://stackoverflow.com/questions/42912392/golang-yaml-v2-umarshalling-complex-nested-structs", "title": "Golang yaml.v2 umarshalling complex nested structs", "body": "<p>Assume such a yaml:</p>\n\n<pre><code>A:\n  B0:\n    synonym: XX\n    C1:\n    - value1\n    - value2\n  B2:\n    synonym: ZZ\n    C7:\n    - value17\n    C3:\n    - value99\nAX:\n  B7:\n    synonym: GG\n    C99:\n    - value123\n</code></pre>\n\n<p>In addition, assume that all the A, B and C names are arbitrary names, and that there might be many more B entries, each with a synonym and [0-n[ C entries.</p>\n\n<p>How would a gopkg.in/yaml.v2 mapping look like with which I could parse such a yaml file? </p>\n\n<p>The examples I found in the docs or in the web don't deal with more complex nested structures (or I didn't understand them right).</p>\n"}, {"tags": ["go", "build", "sublimetext3"], "answers": [{"comments": [{"owner": {"reputation": 851, "user_id": 1809231, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d5428b9a308edeeb8b7d6d4041d059fa?s=128&d=identicon&r=PG", "display_name": "Joseph Little", "link": "https://stackoverflow.com/users/1809231/joseph-little"}, "edited": false, "score": 0, "creation_date": 1490041806, "post_id": 42912816, "comment_id": 72925922, "body": "Thank you! This is even better than what I thought I wanted."}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": true, "score": 1, "last_activity_date": 1490039783, "creation_date": 1490039783, "answer_id": 42912816, "question_id": 42912129, "link": "https://stackoverflow.com/questions/42912129/run-a-command-line-tool-as-part-of-build-process/42912816#42912816", "title": "Run a command line tool as part of build process", "body": "<p>Usually this is done with <a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\"><code>go generate</code></a>. Although the Sublime3 bundle does <strong>not</strong> support this.</p>\n\n<p>In one of your files add something like this into as the top comment:</p>\n\n<pre><code>//go:generate go-bindata data/\n</code></pre>\n\n<p>Now you can bundle and bundle your project with <code>go generate</code> and then <code>go build</code>.</p>\n\n<p>This works on all platforms that are supported by Go.</p>\n\n<p>If really need a one command does everything thing: Use a Makefile or a batch script and use that as your build command in Sublime.</p>\n"}], "owner": {"reputation": 851, "user_id": 1809231, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d5428b9a308edeeb8b7d6d4041d059fa?s=128&d=identicon&r=PG", "display_name": "Joseph Little", "link": "https://stackoverflow.com/users/1809231/joseph-little"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 42912816, "answer_count": 1, "score": 1, "last_activity_date": 1490039783, "creation_date": 1490037304, "question_id": 42912129, "link": "https://stackoverflow.com/questions/42912129/run-a-command-line-tool-as-part-of-build-process", "title": "Run a command line tool as part of build process", "body": "<p>I'm just getting started with Go, and also thought I'd learn Sublime Text while I was at it.</p>\n\n<p>I've installed the official <a href=\"https://github.com/golang/sublime-build\" rel=\"nofollow noreferrer\">Go Build package for Sublime</a> and got everything building nicely. But my little project relies on binary resources, so I'm using <a href=\"https://github.com/jteeuwen/go-bindata\" rel=\"nofollow noreferrer\">go-bindata</a> to build my files directly into my executable.</p>\n\n<p>What I need help with is the fact I don't know how to add the command line call to go-bindata to the build processes provided by Go Build. Ideally I'd like to simply run the command before the build process starts.</p>\n\n<p>I'm working on Windows 10, if that's important info.</p>\n\n<p>Cheers!</p>\n"}, {"tags": ["unix", "go", "compression", "pattern-matching", "file-format"], "comments": [{"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1490037114, "post_id": 42912054, "comment_id": 72923208, "body": "<a href=\"https://www.socketloop.com/references/golang-compress-lzw-newwriter-function-example\" rel=\"nofollow noreferrer\">compress/lzw example</a>"}, {"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1490037167, "post_id": 42912054, "comment_id": 72923237, "body": "<a href=\"https://wiki.wxwidgets.org/Development:_Z_File_Format\" rel=\"nofollow noreferrer\">Z File Format</a>"}], "owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1490037043, "creation_date": 1490037043, "last_edit_date": 1495535408, "question_id": 42912054, "link": "https://stackoverflow.com/questions/42912054/what-are-the-modifications-needed-to-make-this-go-program-read-lzc-instead-of-lz", "title": "What are the modifications needed to make this Go program read LZC instead of LZW?", "body": "<p>I am using an open source, third-party Go package: <a href=\"https://bitbucket.org/jasiekmarc/comprfind/src\" rel=\"nofollow noreferrer\">comprfind</a>. The package implements a famous compressed pattern matching algorithm from the paper \"Let sleeping files lie: Pattern matching in Z-compressed files.\" by Amir, Benson, and Farach. And it is supposed to take an LZW compressed text file <code>file.Z</code> (I need it to be compressed with <code>unix-compress</code>) and a pattern (<code>string</code>) and find the locations where the pattern occurs in the text of <code>file.Z</code>.</p>\n\n<p>I am just using the testing tool, without a <code>main func</code>. At the moment, for simplicity, I am only focusing on <code>func TestBigData</code> for debugging and initial testing.</p>\n\n<p>Wen I tried to give it a unix-compressed <code>file.txt.Z</code>, it gave me the error</p>\n\n<pre><code>finder_test.go:113: lzw: invalid code\n</code></pre>\n\n<p>Apparently, the way the package is implemented, it is only accepting LZW compressed data from a <code>[]byte</code> as seen in <code>finder_test.go</code>. The only way I could make it work is to compress a file with Go'z <code>compress/lzw</code> .I used (the code in the first link in comment bellow), but istead of <code>.lzw</code> I put <code>.Z</code> and use the output as input to <code>comprfinder</code>.</p>\n\n<p>I need the <code>comprfind</code> code to accept unix-compressed <code>.Z</code> files. So I tried to ignore the header bytes by doing the following:</p>\n\n<p>after <code>buf0, err := ioutil.ReadFile(\"file.txt.Z\")</code> (in <code>func TestBigData</code> in <code>finder_test.go</code>) I took a slice by doing <code>buf3 := buf0[3:]</code> and then used <code>buf3</code> instead of <code>buf0</code> in subsequent lines.</p>\n\n<p>And I still got the same error.</p>\n\n<p>From .Z file extension documentation (second link in comment) I found that <code>.Z</code> files generated by <code>unix-compress</code> actually use LZC algorithm (a very close variant of LZW). This seems to be the reason why <code>comprfind</code> is not able to read the <code>.Z</code> file.</p>\n\n<p>How can I modify <code>comprfind</code> source code to read the LZC version instead of LZW? Any tip or suggestion will be of great help.</p>\n\n<p>Note: I am working on Ubuntu installed in VirtualBox on a Mac.</p>\n\n<p>P.S.: Some information provided above, I learnt from <a href=\"https://stackoverflow.com/a/42889912/4725811\">Zoyd's answer</a> to a related question that I posted before.</p>\n"}, {"tags": ["assembly", "go", "arm", "opcodes"], "comments": [{"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1490036964, "post_id": 42911884, "comment_id": 72923122, "body": "You might need to a 32-bit &quot;word&quot; size directive to emit the opcode because ARM doesn&#39;t have any 8-bit instructions, they&#39;re all 32-bits. That would also solve your other problem, that you&#39;ve got the byte order backwards and 0xF57FF05F is 0x5F, 0xF0, 0x7F, 0xF5 in the little endian byte order that ARM uses."}, {"owner": {"reputation": 129, "user_id": 3340499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e043fa179ec7689e0998fd2a11350?s=128&d=identicon&r=PG&f=1", "display_name": "user3340499", "link": "https://stackoverflow.com/users/3340499/user3340499"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 1, "creation_date": 1490043748, "post_id": 42911884, "comment_id": 72926946, "body": "Thanks a lot, this solved it, using <code>WORD</code> directive instead of <code>BYTE</code>."}], "owner": {"reputation": 129, "user_id": 3340499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e043fa179ec7689e0998fd2a11350?s=128&d=identicon&r=PG&f=1", "display_name": "user3340499", "link": "https://stackoverflow.com/users/3340499/user3340499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1490036467, "creation_date": 1490036467, "question_id": 42911884, "link": "https://stackoverflow.com/questions/42911884/using-unsupported-opcode-dmb-in-golang-for-32bit-arm", "title": "Using unsupported opcode (DMB) in Golang (for 32bit ARM)", "body": "<p>I'm trying to issue a DMB instruction in a Go program, and I'm using asm function defined in a .s file. I'm compiling with Go 1.7.3 on an ARMv7 device.</p>\n\n<p>DMB isn't a supported instruction in Go, but I see <a href=\"https://golang.org/doc/asm#unsupported_opcodes\" rel=\"nofollow noreferrer\">documentation here</a> on how to use unsupported opcodes. </p>\n\n<p>Using some ARM gcc binutils, I found the opcode for DMB is f57ff05f. The <code>issue_dmb.s</code> file I have is below.</p>\n\n<pre><code>TEXT \u00b7issue_dmb(SB),$0\n\n    // DMB: opcode f57ff05f\n    BYTE $0xF5; BYTE $0x7F; BYTE $0xF0; BYTE $0x5F\n\n    RET\n</code></pre>\n\n<p>When I build, I get an error: unrecognized instruction \"BYTE\"</p>\n\n<p>(Possibly related: I got the same error about <code>NOSPLIT</code> when I used this in the first line of the .s file as I see in many examples, so I removed it).</p>\n\n<p>Am I missing something to get the assembler to recognise these keywords?</p>\n"}, {"tags": ["go", "methods", "dynamic", "struct"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1490034252, "post_id": 42906759, "comment_id": 72921530, "body": "See <a href=\"http://stackoverflow.com/questions/10210188/instance-new-type-golang\" title=\"instance new type golang\">stackoverflow.com/questions/10210188/instance-new-type-golan&zwnj;&#8203;g</a> for creating an instance of a type given a string."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 11, "last_activity_date": 1490043359, "last_edit_date": 1495540462, "creation_date": 1490023198, "answer_id": 42907403, "question_id": 42906759, "link": "https://stackoverflow.com/questions/42906759/how-to-call-method-by-its-string-name-with-string-struct-name/42907403#42907403", "title": "How to call method by its string name with string struct name?", "body": "<p>Calling a method of some type given by its name is easy (using <a href=\"https://golang.org/pkg/reflect/\" rel=\"noreferrer\">reflection</a>). See this example:</p>\n\n<pre><code>type My struct{}\n\nfunc (m My) MyFunc() {\n    fmt.Println(\"MyFunc called\")\n}\n\nfunc main() {\n    m := My{}\n    meth := reflect.ValueOf(m).MethodByName(\"MyFunc\")\n    meth.Call(nil)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NPUerRL8_I\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>MyFunc called\n</code></pre>\n\n<p>\"Instantiating\" a type given its string name is not possible, because if your code does not explicitly refer to the type, it may not even be included in the executable binary. For details, see <a href=\"https://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang/37384665#37384665\">Call all functions with special prefix or suffix in Golang</a>; and <a href=\"https://stackoverflow.com/questions/38875016/splitting-client-server-code/38875901#38875901\">Splitting client/server code</a>.</p>\n\n<p>A possible workaround is to use some kind of \"type-registry\" which you populate prior to using it (before you want to create a value by its name). The type registry (which may be a map) may hold <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\"><code>reflect.Type</code></a> values or factory functions mapped from the type name.</p>\n\n<p>Following the above <code>My</code> type declaration, a type registry storing <code>reflect.Type</code> values may look like this (try it on the <a href=\"https://play.golang.org/p/v5s_j7xnHW\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>registry := map[string]reflect.Type{\n    \"My\": reflect.TypeOf((*My)(nil)).Elem(),\n}\n\nv := reflect.New(registry[\"My\"]).Elem()\nv.MethodByName(\"MyFunc\").Call(nil)\n</code></pre>\n\n<p>And a registry that stores factory functions could look like this (try it on the <a href=\"https://play.golang.org/p/rZOa-6AfM5\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>registry := map[string]func() interface{}{\n    \"My\": func() interface{} { return My{} },\n}\n\nv := registry[\"My\"]()\nmeth := reflect.ValueOf(v).MethodByName(\"MyFunc\")\nmeth.Call(nil)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 3818534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/628dd53b0eca15ea763c958f78f5a63b?s=128&d=identicon&r=PG&f=1", "display_name": "user3818534", "link": "https://stackoverflow.com/users/3818534/user3818534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3324, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1490043359, "creation_date": 1490021465, "last_edit_date": 1490023425, "question_id": 42906759, "link": "https://stackoverflow.com/questions/42906759/how-to-call-method-by-its-string-name-with-string-struct-name", "title": "How to call method by its string name with string struct name?", "body": "<p>I have one struct with 2 methods under struct definition, I want to call in other place that use struct's name and method's name as param.</p>\n\n<p>Struct code as following:</p>\n\n<pre><code>type ArticleForm struct {\nName     string     `required:\"true\" pattern:\"^[A-Za-z0-9\\u4e00-\\u9fa5]{1,1024}$\" valid:\"Required;MaxSize(1024)\"`\nCategory []Category `class:\"multis\" required:\"true\" valid:\"Required\" optionqs:\"GetCategoryOption\"`\nContent  string     `class:\"wysiwg_area\" required:\"true\" valid:\"Required\"`\nTags     []Tags     `class:\"multis_create\" optionqs:\"GetTagOptions\"`\n}\n</code></pre>\n\n<p>Method definition as following:</p>\n\n<pre><code>func (this *ArticleForm) GetTagOptions() []Tags {\nreturn GetTagsOptions(nil)\n}\n</code></pre>\n\n<p>Following is what I want to call:</p>\n\n<pre><code>func main() {\ns := \"models.ArticleForm\"\nt := \"GetTagOptions\"\n//following is the question, how can i exec following?\nfuncall(s,t)\n}\n</code></pre>\n\n<p>How to fulfill the <code>funcall(s,t)</code>?</p>\n"}, {"tags": ["go", "httpresponse", "httpserver"], "comments": [{"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 2, "creation_date": 1490020962, "post_id": 42906490, "comment_id": 72912513, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26961764/multiple-response-writeheader-calls-in-go\">Multiple response.WriteHeader calls in Go</a>"}, {"owner": {"reputation": 7885, "user_id": 882862, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/9taZw.jpg?s=128&g=1", "display_name": "flyer", "link": "https://stackoverflow.com/users/882862/flyer"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490021175, "post_id": 42906490, "comment_id": 72912670, "body": "@Zoyd My question is different from that. I want to know the bad effects of &quot;http: multiple response.WriteHeader calls&quot; while that one explains why that&#39;s impossible that call <code>WriteHeader</code> again after having called <code>WriteHeader</code>."}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490021351, "post_id": 42906490, "comment_id": 72912825, "body": "The answer shows that calling WriteHeader multiple times doesn\u2019t make sense. Therefore, if it happens, it necessarily points to some kind of mistake or unintended behaviour."}, {"owner": {"reputation": 7885, "user_id": 882862, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/9taZw.jpg?s=128&g=1", "display_name": "flyer", "link": "https://stackoverflow.com/users/882862/flyer"}, "reply_to_user": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 0, "creation_date": 1490021492, "post_id": 42906490, "comment_id": 72912931, "body": "Though it doesn&#39;t make sense, it&#39;s ok if it doesn&#39;t cause something behave weirdly."}], "answers": [{"comments": [{"owner": {"reputation": 7885, "user_id": 882862, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/9taZw.jpg?s=128&g=1", "display_name": "flyer", "link": "https://stackoverflow.com/users/882862/flyer"}, "edited": false, "score": 0, "creation_date": 1490063541, "post_id": 42906652, "comment_id": 72933576, "body": "From <a href=\"https://golang.org/src/net/http/server.go#L1052\" rel=\"nofollow noreferrer\">the source code</a>, the client won&#39;t get s second  response header."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 7885, "user_id": 882862, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/9taZw.jpg?s=128&g=1", "display_name": "flyer", "link": "https://stackoverflow.com/users/882862/flyer"}, "edited": false, "score": 0, "creation_date": 1490063989, "post_id": 42906652, "comment_id": 72933698, "body": "@flyer: of course, because you can&#39;t really respond more than once. The server is warning you about a problem with your code so you can correct it."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1490021207, "creation_date": 1490021207, "answer_id": 42906652, "question_id": 42906490, "link": "https://stackoverflow.com/questions/42906490/whats-the-bad-effect-of-http-multiple-response-writeheader-calls/42906652#42906652", "title": "What&#39;s the bad effect of &quot;http: multiple response.WriteHeader calls&quot;?", "body": "<p>You can only write a response header once before it is sent to the client. Because your code is attempting to write a response header after it has been sent to the client, the client will never see the final response you are trying to send.</p>\n\n<p>You either have a bug where the client is getting the incorrect response which you later revised, or you have a bug where you are executing the wrong code after the correct response header has been written. Either way it's a bug. </p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 2, "last_activity_date": 1490029513, "creation_date": 1490029513, "answer_id": 42909667, "question_id": 42906490, "link": "https://stackoverflow.com/questions/42906490/whats-the-bad-effect-of-http-multiple-response-writeheader-calls/42909667#42909667", "title": "What&#39;s the bad effect of &quot;http: multiple response.WriteHeader calls&quot;?", "body": "<p>The bad effect is that the actual result will most probably be different from what you expect. If you call <code>WriteHeader(200)</code> on line 10, and later on line 50 you call, on the same <code>ResponseWriter</code>,  <code>WriteHeader(404)</code> what do you expect the response code to be? <code>404</code>, or <code>200</code>?</p>\n\n<p><code>WriteHeader</code> ignores subsequent calls and tells you about it by logging that message, so that when you're getting <code>200</code> instead of <code>404</code> as you probably expect, you just take a look at the server logs and you know what's up. The message is there to help you.</p>\n"}], "owner": {"reputation": 7885, "user_id": 882862, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/9taZw.jpg?s=128&g=1", "display_name": "flyer", "link": "https://stackoverflow.com/users/882862/flyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7439, "favorite_count": 0, "accepted_answer_id": 42906652, "answer_count": 2, "score": 1, "last_activity_date": 1490061494, "creation_date": 1490020812, "last_edit_date": 1490061494, "question_id": 42906490, "link": "https://stackoverflow.com/questions/42906490/whats-the-bad-effect-of-http-multiple-response-writeheader-calls", "title": "What&#39;s the bad effect of &quot;http: multiple response.WriteHeader calls&quot;?", "body": "<p>My server behaves well though I find the exception of \"http: multiple response.WriteHeader calls\". This exception doesn't cause my server panic or behaving weirdly.</p>\n\n<p>I have searched a lot but only found how to solve this problem. There's no doc describing the bad effects of the exception. Could someone help me find why \"http: multiple response.WriteHeader calls\" is an exception and what the bad effects are that it causes? Thanks in advance.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I have read the source code <a href=\"https://golang.org/src/net/http/server.go#L1052\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/07E9V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/07E9V.png\" alt=\"enter image description here\"></a></p>\n\n<p>When calling <code>WriteHeader</code> multitimes\uff0cit only prints a log and then does nothing. It seems that calling <code>WriteHeader</code> multitimes doesn't cause the server behaves weiredly.</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1490018035, "post_id": 42905377, "comment_id": 72910455, "body": "If you want a struct, you need to define the fields, if you don&#39;t want to define the fields, you need a map. You can&#39;t really have it both ways."}, {"owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490072753, "post_id": 42905377, "comment_id": 72936103, "body": "I thought may be there is a generic way of defining struct for such a case."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1490098631, "creation_date": 1490098631, "answer_id": 42926931, "question_id": 42905377, "link": "https://stackoverflow.com/questions/42905377/read-a-generic-yaml-file/42926931#42926931", "title": "Read a generic yaml file", "body": "<p>Since my config file was a map structure only. So what I did was adding anotheer nested level to the map and create a map of maps. Something like this:</p>\n\n<pre><code>    var m := make(map[string](map[string]string))\n</code></pre>\n\n<p>And my config looks like this now:</p>\n\n<pre><code>    A:\n     B:\n      C:\n      D:\n     E:\n      F:\n      G:\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1490098631, "creation_date": 1490017870, "last_edit_date": 1490018330, "question_id": 42905377, "link": "https://stackoverflow.com/questions/42905377/read-a-generic-yaml-file", "title": "Read a generic yaml file", "body": "<p>I have a config file in YAML. I want to define a struct which is generic enough for this file.</p>\n\n<p>Example:</p>\n\n<pre><code>A:\n  B:\n  C:\nD:\n  E:\n  F:\n  G:\n</code></pre>\n\n<p>Since there is no predefined structure, I am not able to find out a proper struct for this kind of a struct.</p>\n\n<p>PS: struct incorporating all the fields is not acceptable.</p>\n"}, {"tags": ["go", "command-line-interface", "read-eval-print-loop"], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 0, "last_activity_date": 1490014068, "creation_date": 1490014068, "answer_id": 42904032, "question_id": 42903815, "link": "https://stackoverflow.com/questions/42903815/adding-navigation-keys-arrow-keys-support-in-a-cli-repl/42904032#42904032", "title": "Adding navigation keys (arrow keys) support in a CLI REPL", "body": "<p>You could use <a href=\"https://github.com/chzyer/readline\" rel=\"nofollow noreferrer\">Readline</a>, it has what you ask for and much more.</p>\n"}], "owner": {"reputation": 873, "user_id": 2820419, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000721485668/picture?type=large", "display_name": "Siddharth Shukla", "link": "https://stackoverflow.com/users/2820419/siddharth-shukla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 303, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490014068, "creation_date": 1490013459, "last_edit_date": 1490013851, "question_id": 42903815, "link": "https://stackoverflow.com/questions/42903815/adding-navigation-keys-arrow-keys-support-in-a-cli-repl", "title": "Adding navigation keys (arrow keys) support in a CLI REPL", "body": "<p>I'm creating a CLI tool in golang, let's call it <code>repl</code>. It reads instructions from stdin delimited by a <code>;</code>, applies a function to the statement read, and prints the result to stdout (and goes back to reading)</p>\n\n<pre><code>repl&gt; foo;\n\"foo\"\nrepl&gt; bar; \n\"bar\"\n</code></pre>\n\n<p>If I misspell <code>bar</code> as <code>baer</code> and want to fix it, I have to delete all characters until <code>a</code> and then rewrite instead of being able to navigate to the character (using arrow keys) and only deleting that character. Essentially, I'm trying to replicate the behaviour already found in some commercial REPLs such as mysql, python, etc. where you can move between characters using arrow keys. Any suggestions about how to go about doing this?</p>\n"}, {"tags": ["go", "intellij-idea", "go-iris"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1490013736, "post_id": 42903737, "comment_id": 72907265, "body": "There is a hello world example in the repository: <a href=\"https://github.com/kataras/iris/blob/v6/_examples/examples/hello-world/main.go\" rel=\"nofollow noreferrer\">github.com/kataras/iris/blob/v6/_examples/examples/hello-wor&zwnj;&#8203;ld/&hellip;</a> - although I suggest you start with a better tutorial: <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">golang.org/doc/articles/wiki</a> - which will reduce confusion later on."}, {"owner": {"reputation": 1, "user_id": 6477470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d71012b56fe5aceeb23a8320ae8b44?s=128&d=identicon&r=PG&f=1", "display_name": "Budaya Lanu", "link": "https://stackoverflow.com/users/6477470/budaya-lanu"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1490014099, "post_id": 42903737, "comment_id": 72907550, "body": "hello world from golang documentation not doubt that&#39;s working, but iris documentation is not working perfectly  btw, thanks for you answer, maybe the documentation is not working again for this ages"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1490014716, "post_id": 42903737, "comment_id": 72908048, "body": "@BudayaLanu: if you&#39;re just getting started, I would avoid iris (<a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html\" rel=\"nofollow noreferrer\">I would actually avoid iris altogether if possible</a>). Start with the basics in the std lib, and start with the std documentation: <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How To Write Go Code</a>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490014975, "post_id": 42903737, "comment_id": 72908243, "body": "In your question you mentioned you ran <code>go get -u github.com&#47;kataras&#47;iris&#47;iris</code> did you also ran <code>go get -u github.com&#47;kataras&#47;iris</code>? <code>kataras&#47;iris</code> and <code>kataras&#47;iris&#47;iris</code> are related but not the same.. that documentation you followed seems outdated. But as @JimB already mentioned <code>iris</code> should probably be avoided for various reasons."}, {"owner": {"reputation": 1, "user_id": 6477470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d71012b56fe5aceeb23a8320ae8b44?s=128&d=identicon&r=PG&f=1", "display_name": "Budaya Lanu", "link": "https://stackoverflow.com/users/6477470/budaya-lanu"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490015614, "post_id": 42903737, "comment_id": 72908708, "body": "@mkopriva      i ran this, go get -u github.com/kataras/iris/iris i don&#39;t if they are different, thanks for you information"}], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 0, "last_activity_date": 1505038986, "creation_date": 1505038986, "answer_id": 46139651, "question_id": 42903737, "link": "https://stackoverflow.com/questions/42903737/iris-error-unresolved-get/46139651#46139651", "title": "Iris Error - Unresolved &#39;Get&#39;", "body": "<p>It's funny because the <a href=\"https://github.com/kataras/iris\" rel=\"nofollow noreferrer\">https://github.com/kataras/iris</a> and the <a href=\"https://iris-go.com\" rel=\"nofollow noreferrer\">https://iris-go.com</a> and <a href=\"https://docs.iris-go.com\" rel=\"nofollow noreferrer\">https://docs.iris-go.com</a> have many examples of those things, you spend your time asking that, you probably checked a third-party fork of Iris and not the Iris itself where did you find that code snippet?</p>\n\n<p>The correct way:</p>\n\n<pre><code>package main \nimport \"github.com/kataras/iris\"\nfunc main()    {\n    app := iris.New()\n    app.Get(\"/hi\", func(ctx iris.Context)  { // go &gt; 1.9\n        ctx.Writef(\"Hi %s\", \"iris\")\n    })\n    app.Run(iris.Addr(\":8080\"))\n}\n</code></pre>\n\n<p>Here's another example, a simple server which renders a template file with message to the client:</p>\n\n<pre><code>// file: main.go\npackage main\nimport \"github.com/kataras/iris\"\n\nfunc main() {\n    app := iris.New()\n    // Load all templates from the \"./views\" folder\n    // where extension is \".html\" and parse them\n    // using the standard `html/template` package.\n    app.RegisterView(iris.HTML(\"./views\", \".html\"))\n\n    // Method:    GET\n    // Resource:  http://localhost:8080\n    app.Get(\"/\", func(ctx iris.Context) {\n        // Bind: {{.message}} with \"Hello world!\"\n        ctx.ViewData(\"message\", \"Hello world!\")\n        // Render template file: ./views/hello.html\n        ctx.View(\"hello.html\")\n    })\n\n    // Method:    GET\n    // Resource:  http://localhost:8080/user/42\n    app.Get(\"/user/{id:long}\", func(ctx iris.Context) {\n        userID, _ := ctx.Params().GetInt64(\"id\")\n        ctx.Writef(\"User ID: %d\", userID)\n    })\n\n    // Start the server using a network address.\n    app.Run(iris.Addr(\":8080\"))\n}\n</code></pre>\n\n<hr>\n\n<pre><code>&lt;!-- file: ./views/hello.html --&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Hello Page&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;{{.message}}&lt;/h1&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>$ go run main.go\n&gt; Now listening on: http://localhost:8080\n&gt; Application started. Press CTRL+C to shut down.\n</code></pre>\n\n<p>If you ever need any help with Iris you can always contact with the support team via the live chat <a href=\"https://chat.iris-go.com\" rel=\"nofollow noreferrer\">https://chat.iris-go.com</a>. Have a nice day!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8612549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/158ab36e91cc3d274d062399a5b1dcba?s=128&d=identicon&r=PG&f=1", "display_name": "Tiny", "link": "https://stackoverflow.com/users/8612549/tiny"}, "is_accepted": false, "score": 0, "last_activity_date": 1505454074, "last_edit_date": 1505454074, "creation_date": 1505449275, "answer_id": 46231652, "question_id": 42903737, "link": "https://stackoverflow.com/questions/42903737/iris-error-unresolved-get/46231652#46231652", "title": "Iris Error - Unresolved &#39;Get&#39;", "body": "<p>If Go 1.8 remains the basic host for your go apps then you should declare and use the github.com/kataras/iris/context package on your source file's imports statement.</p>\n\n<pre><code>package main\nimport (\n\"github.com/kataras/iris\"\n\"github.com/kataras/iris/context\"\n)\n\nfunc main() {\napp := iris.New()\napp.RegisterView(iris.HTML(\"./views\", \".html\"))\n\napp.Get(\"/\", func(ctx context.Context) {\n    ctx.ViewData(\"message\", \"Hello world!\")\n    ctx.View(\"hello.html\")\n})\n\napp.Run(iris.Addr(\":8080\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6477470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3d71012b56fe5aceeb23a8320ae8b44?s=128&d=identicon&r=PG&f=1", "display_name": "Budaya Lanu", "link": "https://stackoverflow.com/users/6477470/budaya-lanu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 690, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505454074, "creation_date": 1490013223, "question_id": 42903737, "link": "https://stackoverflow.com/questions/42903737/iris-error-unresolved-get", "title": "Iris Error - Unresolved &#39;Get&#39;", "body": "<p>This is my code </p>\n\n<pre><code>`package main \n import \"github.com/kataras/iris\"\n func main()    {\n     iris.Get(\"/hi\",    func(ctx    *iris.Context)  {\n         ctx.Writef(\"Hi %s\",    \"iris\")\n     })\n     iris.Listen(\":8080\")\n }`\n</code></pre>\n\n<p>I have \"go get -u github.com/kataras/iris/iris\"\nthis is what i get, and i've been surving and still cannot solve this.</p>\n\n<p>./IRIS.go:6: undefined: iris.Get<br>\n./IRIS.go:9: undefined: iris.Listen</p>\n\n<p>This is my first time trying this framework, I followed from page <a href=\"https://docs.iris-go.com/\" rel=\"nofollow noreferrer\">https://docs.iris-go.com/</a>\nI though it would easy, but its really not, i only can do install iris, and this is my first worse hello world</p>\n\n<p>I'm using Intellij Idea as my IDE</p>\n\n<p>Please Help Me. Thanks</p>\n"}, {"tags": ["node.js", "go"], "comments": [{"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 2, "creation_date": 1490010946, "post_id": 42902815, "comment_id": 72905264, "body": "Why would you want to do this? This sounds like an A/B problem"}], "answers": [{"tags": [], "owner": {"reputation": 91104, "user_id": 613198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0a8a4fb43f9c19b3391a7b1066d491f?s=128&d=identicon&r=PG", "display_name": "rsp", "link": "https://stackoverflow.com/users/613198/rsp"}, "is_accepted": false, "score": 0, "last_activity_date": 1490012062, "creation_date": 1490012062, "answer_id": 42903334, "question_id": 42902815, "link": "https://stackoverflow.com/questions/42902815/running-nodejs-app-inside-go/42903334#42903334", "title": "running nodejs app inside go", "body": "<p>Well, you could make a Go program that includes e.g. a zipped Node application that it extracts and starts but it will be very hard to do well - you will have huge binaries, delays in extracting files, potential portability problems etc. Usually when you want to call REST endpoints then you host your Node app on some server and you let the client app (the Go app in your example) to connect to that Node app to work correctly. Advantages are that it is much faster, the app is much smaller, you don't have portability issues with Node binaries and addons and you can quickly update your backend any time you want.</p>\n"}, {"tags": [], "owner": {"reputation": 5101, "user_id": 153586, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3bc43786cfcbc75521a28870e76759c1?s=128&d=identicon&r=PG", "display_name": "Sankar", "link": "https://stackoverflow.com/users/153586/sankar"}, "is_accepted": false, "score": 0, "last_activity_date": 1490032295, "creation_date": 1490032295, "answer_id": 42910595, "question_id": 42902815, "link": "https://stackoverflow.com/questions/42902815/running-nodejs-app-inside-go/42910595#42910595", "title": "running nodejs app inside go", "body": "<p>It will be a very bad idea to embed a nodejs app into your golang, for various reasons such as: size, security updates pushing, etc.</p>\n\n<p>However, if you so strong feel that they should be together, you could easily create a <code>docker</code> container with these two (a golang server + a node app) and launch them via docker. You can set the entrypoint to a <code>supervisord</code> daemon so that your node server as well as the golang server can be brought up when your container is run. </p>\n\n<p>If you are planning to deploy via <code>kubernetes</code> you can create two individual docker containers (one for the golang server, one for the node server) but deploy them always together as a <code>pod</code> too.</p>\n"}, {"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 0, "last_activity_date": 1490039192, "creation_date": 1490039192, "answer_id": 42912670, "question_id": 42902815, "link": "https://stackoverflow.com/questions/42902815/running-nodejs-app-inside-go/42912670#42912670", "title": "running nodejs app inside go", "body": "<p>There are multiple projects to embed binary files and/or file system data into your Go application.</p>\n\n<p>Look at 'Alternatives' section of project 'vfsgen':</p>\n\n<p><a href=\"https://github.com/shurcooL/vfsgen#alternatives\" rel=\"nofollow noreferrer\">https://github.com/shurcooL/vfsgen#alternatives</a></p>\n"}], "owner": {"reputation": 193, "user_id": 978123, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/84279be6331ff9dd3c88855dd2ff95b9?s=128&d=identicon&r=PG", "display_name": "user978123", "link": "https://stackoverflow.com/users/978123/user978123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2101, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1490039192, "creation_date": 1490010525, "last_edit_date": 1490014356, "question_id": 42902815, "link": "https://stackoverflow.com/questions/42902815/running-nodejs-app-inside-go", "title": "running nodejs app inside go", "body": "<p>I have a requirement. Is there a way to run nodejs apps inside golang? I need to wrap the nodejs app inside a golang application and in the end to result a golang binary that starts the nodejs server and then to be able to call nodejs rest endpoints. I need to encapsulate in the golang binary the entire nodejs application with nodem_odules, if necessarily the nodejs runtime.</p>\n"}, {"tags": ["firebase", "go", "firebase-realtime-database"], "answers": [{"tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": true, "score": 1, "last_activity_date": 1490019384, "creation_date": 1490019384, "answer_id": 42905938, "question_id": 42902721, "link": "https://stackoverflow.com/questions/42902721/how-to-create-a-push-id-for-firebase-using-golang/42905938#42905938", "title": "How to create a push id for firebase using golang?", "body": "<p>Those keys starting with <code>-K</code> are called push IDs and they are automatically generated by Firebase:</p>\n\n<ul>\n<li>When you <a href=\"https://firebase.google.com/docs/database/web/lists-of-data#append_to_a_list_of_data\" rel=\"nofollow noreferrer\">call <code>push()</code></a> or <code>childByAutoId</code> in one of the supported SDKs</li>\n<li>When you perform a <a href=\"https://firebase.google.com/docs/database/rest/save-data#section-post\" rel=\"nofollow noreferrer\"><code>POST</code> request to the REST API</a></li>\n</ul>\n\n<p>There is no Firebase SDK for Go and uses the REST API to interact with the Firebase Database. That means that it only generates a push ID when it <code>POST</code>s a new node to the database. I don't know of any library for Go to generate Firebase push IDs client-side.</p>\n\n<p>But luckily the <a href=\"https://firebase.googleblog.com/2015/02/the-2120-ways-to-ensure-unique_68.html\" rel=\"nofollow noreferrer\">keys are quite well documented in a blog post</a>. The <a href=\"https://gist.github.com/mikelehen/3596a30bd69384624c11\" rel=\"nofollow noreferrer\">code for a JavaScript implementation of <code>generatePushID()</code></a> is also available, so you could port that over to Go.</p>\n"}], "owner": {"reputation": 45, "user_id": 6817108, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/1dc3af3e550437628d0a83b662895461?s=128&d=identicon&r=PG&f=1", "display_name": "ASWATHY", "link": "https://stackoverflow.com/users/6817108/aswathy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 42905938, "answer_count": 1, "score": 1, "last_activity_date": 1490019384, "creation_date": 1490010263, "last_edit_date": 1490019055, "question_id": 42902721, "link": "https://stackoverflow.com/questions/42902721/how-to-create-a-push-id-for-firebase-using-golang", "title": "How to create a push id for firebase using golang?", "body": "<p>i want to push a map to firebase with an id (eg:-KfKoScgRhylaLjQlK-y)</p>\n\n<pre><code>fitToWorkMap := make(map[string]models.TaskFitToWork)\n    fitToWorkForTask :=models.TaskFitToWork{}\n    for i := 0; i &lt; len(FitToWorkSlice); i++ {\n        fitToWorkForTask.Info =FitToWorkSlice[i]\n        fitToWorkForTask.DateOfCreation =time.Now().Unix()\n        fitToWorkForTask.Status = helpers.StatusPending\n\n        fitToWorkMap[\"fgsgdsfn+'i'\"] = fitToWorkForTask\n    }\n    task.FitToWork = fitToWorkMap\n</code></pre>\n\n<p>here fitToWorkMap is a map .i want to generate a key for this map</p>\n"}, {"tags": ["go", "concurrency", "queue", "subscription", "nats.io"], "answers": [{"tags": [], "owner": {"reputation": 676, "user_id": 7817149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/x4Mpb.jpg?s=128&g=1", "display_name": "I. Kozlovic", "link": "https://stackoverflow.com/users/7817149/i-kozlovic"}, "is_accepted": false, "score": 5, "last_activity_date": 1491347535, "creation_date": 1491347535, "answer_id": 43219238, "question_id": 42902515, "link": "https://stackoverflow.com/questions/42902515/go-lang-nats-queueing-with-multiple-queue-subscribe/43219238#43219238", "title": "GO lang NATS Queueing with multiple Queue Subscribe", "body": "<p>If you start multiple queue subscribers with the same name (in your example <code>my_queue</code>), then a message published on \"foo\" goes to only one of those queue subscribers.</p>\n\n<p>I am not sure from your statement if you imply that the queue subscriber sometimes misses messages or not. Keep in mind one thing: there is no persistence in NATS (there is in NATS Streaming). So if you publish messages <em>before</em> the subscriber is created, and if there is no other subscriber on that subject, the messages will be lost.</p>\n\n<p>If you were experimenting and starting the queue subscriber from one connection and then in the same application sending messages from another connection, it is possible that the server did not register the queue subscription before it started to receive messages (again, if you were using 2 connections). If that is the case, you would need to flush the connection after creating the subscription and before starting sending: <code>nc.Flush()</code>.</p>\n\n<p>Finally, there is nothing special to use queue subscribers in concurrent mode. This is what they are for: load balancing processing of messages on the same subject for subscribers belonging to the same group. The only thing you have to be careful of if you are creating multiple queue subscribers in the same application is either to not share the message handler or if you do, you need to use locking since the message handler would be concurrently invoked if messages arrive fast enough.</p>\n"}], "owner": {"reputation": 656, "user_id": 702227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KLGRa.jpg?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/702227/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1491347535, "creation_date": 1490009602, "question_id": 42902515, "link": "https://stackoverflow.com/questions/42902515/go-lang-nats-queueing-with-multiple-queue-subscribe", "title": "GO lang NATS Queueing with multiple Queue Subscribe", "body": "<p>I am creating NATS go lang Queue Subscriber client as follows,</p>\n\n<pre><code>nc.QueueSubscribe(\"foo\", \"my_queue\", func(msg *nats.Msg) {\n        log.Printf(\"Message :%s\", string(msg.Data))\n})\n</code></pre>\n\n<p>So whenever i publish any message to \"foo\" subject then some time it is receiving and some time not.</p>\n\n<p>e.g let say i sent 10 messages to above \"foo\" subject then it will receive 2 or 3 max.</p>\n\n<p>My requirement is as follows,</p>\n\n<ul>\n<li>There should be Queue Subscription.</li>\n<li>All input events should be processed.</li>\n<li>How to implement Queue Subscribe in concurrent mode.</li>\n</ul>\n\n<p>Any help appreciated.    </p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 241, "user_id": 5427367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e56416b1e446e56c0c715732c918191c?s=128&d=identicon&r=PG&f=1", "display_name": "M-AbdalRahman", "link": "https://stackoverflow.com/users/5427367/m-abdalrahman"}, "edited": false, "score": 0, "creation_date": 1490008700, "post_id": 42901974, "comment_id": 72903924, "body": "Country struct fields should be start with capital letter <code>type Country struct { ID  int }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1490016724, "creation_date": 1490016724, "answer_id": 42904953, "question_id": 42901974, "link": "https://stackoverflow.com/questions/42901974/how-to-select-data-from-mysql-then-append-it-into-new-struct-and-convert-it-into/42904953#42904953", "title": "How to select data from MySQL then append it into new struct and convert it into byte", "body": "<p>As mentioned by @M-AbdelRahman in the comment, your <code>Country</code> struct fields need to be <strong>exported</strong> (those that start with an uppercase letter) because <code>json.Marshal</code> skips over fields that are <strong>unexported</strong> (those that start with a lowercase letter) and that's why you're getting back <code>{}</code>.</p>\n\n<pre><code>type Country struct {\n    Id             int `json:\"Country.id\"`\n    CountryCode    string `json:\"Country.country_code\"`\n    CountryName    string `json:\"Country.country_name\"`\n    PhoneCode      string `json:\"Country.phone_code\"`\n    Icon           string `json:\"Country.icon\"`\n}\n</code></pre>\n\n<p>Your scan will have to change accordingly.</p>\n\n<pre><code>err := rows.Scan(&amp;country.Id, &amp;country.CountryCode, &amp;country.CountryName, &amp;country.PhoneCode, &amp;country.Icon)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6065531, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/10205881871514956/picture?type=large", "display_name": "Delfrinando Pranata", "link": "https://stackoverflow.com/users/6065531/delfrinando-pranata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1490016886, "creation_date": 1490007882, "last_edit_date": 1490016886, "question_id": 42901974, "link": "https://stackoverflow.com/questions/42901974/how-to-select-data-from-mysql-then-append-it-into-new-struct-and-convert-it-into", "title": "How to select data from MySQL then append it into new struct and convert it into byte", "body": "<p>I want to read data from a MySQL database using Go Language. The script is like this</p>\n\n<pre><code>func GetAllCountry() []*Country{\n\n    dbConnection := db.ConnectMySQL()\n\n    rows, err := dbConnection.Query(\"SELECT id, country_code, country_name, phone_code, icon FROM country;\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n\n    country := new(Country)\n    var countries []*Country\n    for rows.Next() {\n        err := rows.Scan(&amp;country.id, &amp;country.country_code, &amp;country.country_name, &amp;country.phone_code, &amp;country.icon)\n        if err != nil {\n            log.Fatal(err)\n        }\n        countries = append(countries, country)\n        fmt.Println(country)\n    }\n    return countries\n}\n</code></pre>\n\n<p>Data that returned will save into object Struct. The struct is like this</p>\n\n<pre><code>type Country struct {\n    id              int `json:\"Country.id\"`\n    country_code    string `json:\"Country.country_code\"`\n    country_name    string `json:\"Country.country_name\"`\n    phone_code      string `json:\"Country.phone_code\"`\n    icon            string `json:\"Country.icon\"`\n}\n</code></pre>\n\n<p>In the oher files, I am creating a function to get all data. I call that function, then convert it into <code>[]byte</code> because it used to send it into MessageBroker.</p>\n\n<p>Here is the function to convert it into <code>[]byte</code></p>\n\n<pre><code>func GetCountry(msg string) []byte {\n\n    // country := new(countryModel.Country)\n    var countries []*countryModel.Country\n\n    countries = countryModel.GetAllCountry()\n    log.Println(\"Show result: \", countries)\n\n    jsResult, err := json.Marshal(countries)\n\n    if err != nil {\n        logger.Error(err, \"Failed on GetCountry\")\n    }\n\n\n    log.Println(\"Show result JSON: \", jsResult)\n\n    return jsResult\n}\n</code></pre>\n\n<p>But the returned result at <code>GetCountry</code> function is not what I want.\nIn that function, I get </p>\n\n<pre><code>[\n  {},\n  {}\n]\n</code></pre>\n\n<p>I show  the data on my console.</p>\n\n<pre><code>&amp;{1 ID Indonesia +62 no-data}\n&amp;{2 MY Malaysia +60 no-data}\n2017/03/20 17:55:27 Show result:  [0xc8200ba410 0xc8200ba410]\n2017/03/20 17:55:27 Show result JSON:  [91 123 125 44 123 125 93]\n</code></pre>\n\n<p>Please help.</p>\n"}, {"tags": ["pointers", "go", "slice", "dereference"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1490007117, "post_id": 42900701, "comment_id": 72902916, "body": "Dereferencing should work. Maybe the variable <code>repos</code> has another type. Working example: <a href=\"https://play.golang.org/p/UDzaG5z8Pf\" rel=\"nofollow noreferrer\">play.golang.org/p/UDzaG5z8Pf</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9981, "user_id": 436721, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8f984927a179bde19a89e4b634cbf57?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/436721/felipe"}, "edited": false, "score": 0, "creation_date": 1490006861, "post_id": 42900949, "comment_id": 72902752, "body": "I had mistyped the error messages. There is a single <code>Repository</code> type, and it lives in package <code>github</code>.  So the way to do what I want is to dereference each repository in variable <code>repos</code> and then append each of those to <code>allRepos</code>?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 9981, "user_id": 436721, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8f984927a179bde19a89e4b634cbf57?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/436721/felipe"}, "edited": false, "score": 1, "creation_date": 1490007880, "post_id": 42900949, "comment_id": 72903398, "body": "Yes, of course. To an <code>[]int</code> you can append <code>int</code> only and not <code>*int</code>. As a syntactic sugar you can append <code>[]int</code> to <code>[]int</code> like <code>append(orig, fresh...)</code> but you cannot append <code>[]**[]***int</code> to <code>[]int</code> just because &quot;deep down there are some ints hidden&quot;."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 3, "last_activity_date": 1490004998, "creation_date": 1490004998, "answer_id": 42900949, "question_id": 42900701, "link": "https://stackoverflow.com/questions/42900701/golang-how-to-append-pointer-to-slice-to-slice/42900949#42900949", "title": "Golang: How to append pointer to slice to slice?", "body": "<p>Well, something is not okay here:</p>\n\n<p>You say in the comment that \"repos is of type <code>*[]github.Repository</code>\" but the compiler's error message indicates that repos is of type <code>[]*Repository</code>\". The compiler is never (except when buggy) wrong.</p>\n\n<p>Note that <code>*[]github.Repository</code> and <code>[]*Repository</code> are completely different types, especially the second is <em>not</em> a slice of Repositories and you <em>cannot</em> (really, there is <em>no</em> <em>way</em>) dereference these pointers during <code>append()</code>: You have to write a loop and dereference each slice item and append one by one.</p>\n\n<p>What is strange too: <code>github.Repository</code> and <code>Repository</code> seem to be two different types one from package github, the other from the current package. Again, you'll have to get that straight too.</p>\n\n<p>Note that there are <strong>no</strong> references in Go. Stop thinking about these immediately: This is a concept from other languages which is not helpful (as inexistent) in Go.</p>\n"}, {"comments": [{"owner": {"reputation": 9981, "user_id": 436721, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8f984927a179bde19a89e4b634cbf57?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/436721/felipe"}, "edited": false, "score": 0, "creation_date": 1490008188, "post_id": 42901782, "comment_id": 72903608, "body": "Still doesn&#39;t work... replacing that line with <code>allRepos = append(allRepos, *repos...)</code> gives me the same error message (<code>invalid indirect of repos (type []*github.Repository)</code>)"}], "tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": false, "score": 0, "last_activity_date": 1490007337, "creation_date": 1490007337, "answer_id": 42901782, "question_id": 42900701, "link": "https://stackoverflow.com/questions/42900701/golang-how-to-append-pointer-to-slice-to-slice/42901782#42901782", "title": "Golang: How to append pointer to slice to slice?", "body": "<p>In your example the dereferencing is not correct. You should make it like this:</p>\n\n<pre><code>allRepos = append(allRepos, *repos...)\n</code></pre>\n\n<p>Here a simple example with dereferencing a pointer to a slice of string. <a href=\"https://play.golang.org/p/UDzaG5z8Pf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UDzaG5z8Pf</a></p>\n"}], "owner": {"reputation": 9981, "user_id": 436721, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d8f984927a179bde19a89e4b634cbf57?s=128&d=identicon&r=PG&f=1", "display_name": "Felipe", "link": "https://stackoverflow.com/users/436721/felipe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1715, "favorite_count": 0, "accepted_answer_id": 42900949, "answer_count": 2, "score": 1, "last_activity_date": 1490068938, "creation_date": 1490004301, "last_edit_date": 1490068938, "question_id": 42900701, "link": "https://stackoverflow.com/questions/42900701/golang-how-to-append-pointer-to-slice-to-slice", "title": "Golang: How to append pointer to slice to slice?", "body": "<p>I'm a Golang newbie but I thought I had got the essentials of pointers and references straight, but apparently not:</p>\n\n<p>I have a method that must return a <code>[]github.Repository</code>, which is a type from the Github client in go.</p>\n\n<p>The API call returns the results paginated so I must cycle until there's no more results, and add the result of each call to the <code>allRepos</code> variable, and return <em>that</em>. Here's what I have so far:</p>\n\n<pre><code>func (s *inmemService) GetWatchedRepos(ctx context.Context, username string) ([]github.Repository, error) {\n    s.mtx.RLock()\n    defer s.mtx.RUnlock()\n\n    opt := &amp;github.ListOptions{PerPage: 20}\n\n    var allRepos []github.Repository\n\n    for {\n        // repos is of type *[]github.Repository\n        repos, resp, err := s.ghClient.Activity.ListWatched(ctx, \"\", opt)\n\n        if err != nil {\n            return []github.Repository{}, err\n        }\n\n        // ERROR: Cannot use repos (type []*github.Repository) as type github.Repository\n        // but dereferencing it doesn't work, either\n        allRepos = append(allRepos, repos...)\n        if resp.NextPage == 0 {\n            break\n        }\n        opt.Page = resp.NextPage\n    }\n\n    return allRepos, nil\n\n}\n</code></pre>\n\n<p>My question: <strong>how can I append the results of each call and return a result of type <code>[]github.Repository</code>?</strong></p>\n\n<p>Also, why doesn't dereferencing work here? I've tried replacing <code>allRepos = append(allRepos, repos...)</code> with <code>allRepos = append(allRepos, *(repos)...)</code> but I get this error message:</p>\n\n<pre><code>Invalid indirect of (repos) (type []*github.Repository)\n</code></pre>\n"}, {"tags": ["go", "daemon"], "answers": [{"comments": [{"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 671, "user_id": 1142154, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96b9d5e6f06a19bafbe3be141278c333?s=128&d=identicon&r=PG", "display_name": "Peter89", "link": "https://stackoverflow.com/users/1142154/peter89"}, "edited": false, "score": 0, "creation_date": 1490085774, "post_id": 42900314, "comment_id": 72941699, "body": "Well, look here <a href=\"http://software.clapper.org/daemonize/\" rel=\"nofollow noreferrer\">software.clapper.org/daemonize</a> the tool closes standard streams."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 0, "last_activity_date": 1490085886, "last_edit_date": 1490085886, "creation_date": 1490003282, "answer_id": 42900314, "question_id": 42900206, "link": "https://stackoverflow.com/questions/42900206/golang-run-with-daemonize/42900314#42900314", "title": "golang, run with daemonize", "body": "<p>Go logger logs to standard error, redirect standard error and it will work fine.</p>\n\n<pre><code>/var/www/repo/bin/tracking_api 2&gt;&amp;1 &gt;&gt; /var/www/repo/bin/tracking_api.log\n</code></pre>\n\n<p>Unfortunately, <code>daemonize</code> tool closes standard input, output and error so the only solution is to change the log file with <a href=\"https://golang.org/pkg/log/#SetOutput\" rel=\"nofollow noreferrer\">SetOutput</a> function.</p>\n"}, {"comments": [{"owner": {"reputation": 4329, "user_id": 3917091, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/04c742a0661e8f6dd68e8a1ce4345fa0?s=128&d=identicon&r=PG&f=1", "display_name": "Regular Jo", "link": "https://stackoverflow.com/users/3917091/regular-jo"}, "edited": false, "score": 1, "creation_date": 1490378451, "post_id": 42996147, "comment_id": 73101899, "body": "You can improve &quot;code/command&quot;-only answers by explaining what your solution does or what the topic creator did wrong."}], "tags": [], "owner": {"reputation": 1, "user_id": 7744489, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JqSA5.png?s=128&g=1", "display_name": "lxz", "link": "https://stackoverflow.com/users/7744489/lxz"}, "is_accepted": false, "score": 0, "last_activity_date": 1490348921, "creation_date": 1490348921, "answer_id": 42996147, "question_id": 42900206, "link": "https://stackoverflow.com/questions/42900206/golang-run-with-daemonize/42996147#42996147", "title": "golang, run with daemonize", "body": "<p><code>nohup /var/www/repo/bin/tracking_api &gt; /var/www/repo/bin/tracking_api.log &amp;</code>\u3000\u3000</p>\n"}, {"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": false, "score": 0, "last_activity_date": 1504810774, "creation_date": 1504810774, "answer_id": 46103378, "question_id": 42900206, "link": "https://stackoverflow.com/questions/42900206/golang-run-with-daemonize/46103378#46103378", "title": "golang, run with daemonize", "body": "<p>You could use <a href=\"https://immortal.run\" rel=\"nofollow noreferrer\">immortal</a> basically is a supervisor, you can either use it like this:</p>\n\n<pre><code>immortal -l /var/www/repo/bin/tracking_api.log tracking_api\n</code></pre>\n\n<p>or by a <a href=\"https://immortal.run/post/run.yml/\" rel=\"nofollow noreferrer\">configuration YAML</a> file which gives you more options, for example:</p>\n\n<pre><code>cmd: tracking_api\nlog:\n    file: /var/www/repo/bin/tracking_api.log\n    age: 86400 # seconds\n    num: 7     # int\n    size: 1    # MegaBytes\n    timestamp: true # will add timesamp to log\n</code></pre>\n\n<p>If you would like to keep also the standard error output in a separate file you could use something like:</p>\n\n<pre><code>cmd: tracking_api\nlog:\n    file: /var/www/repo/bin/tracking_api.log\n    age: 86400 # seconds\n    num: 7     # int\n    size: 1    # MegaBytes\nstderr:\n    file: /var/www/repo/bin/tracking_api.log\n    age: 86400 # seconds\n    num: 7     # int\n    size: 1    # MegaBytes\n    timestamp: true # will add timesamp to log\n</code></pre>\n"}], "owner": {"reputation": 671, "user_id": 1142154, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96b9d5e6f06a19bafbe3be141278c333?s=128&d=identicon&r=PG", "display_name": "Peter89", "link": "https://stackoverflow.com/users/1142154/peter89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 622, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1504810774, "creation_date": 1490002970, "last_edit_date": 1490372690, "question_id": 42900206, "link": "https://stackoverflow.com/questions/42900206/golang-run-with-daemonize", "title": "golang, run with daemonize", "body": "<p>After build to file. I run it by daemonize with command</p>\n\n<pre><code>daemonize /var/www/repo/bin/tracking_api 1&gt;&gt; /var/www/repo/bin/tracking_api.log\n</code></pre>\n\n<p>I see it generate a new file but nothing in that file. In code I log.Print a lot.   </p>\n\n<p>I just know basic about GO, please guide me to log that. Is there any easier way to run golang to server instead of using daemonize?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9441, "user_id": 1000254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e1621f7d5eef73c430632061efdc97b0?s=128&d=identicon&r=PG", "display_name": "shizhz", "link": "https://stackoverflow.com/users/1000254/shizhz"}, "edited": false, "score": 0, "creation_date": 1490002567, "post_id": 42899981, "comment_id": 72899969, "body": "What&#39;s the content of <code>err</code> of your <code>exec.Command</code> call?"}, {"owner": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "edited": false, "score": 1, "creation_date": 1490004889, "post_id": 42899981, "comment_id": 72901502, "body": "You&#39;ll still need to add the &#39;--&#39; to your flag arguments."}, {"owner": {"reputation": 15, "user_id": 3967645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH6pY.jpg?s=128&g=1", "display_name": "shiva", "link": "https://stackoverflow.com/users/3967645/shiva"}, "reply_to_user": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "edited": false, "score": 0, "creation_date": 1490018712, "post_id": 42899981, "comment_id": 72910957, "body": "@Gerben yes , I missed that, edited, thanks"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3967645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH6pY.jpg?s=128&g=1", "display_name": "shiva", "link": "https://stackoverflow.com/users/3967645/shiva"}, "edited": false, "score": 0, "creation_date": 1490018676, "post_id": 42901884, "comment_id": 72910927, "body": "Thanks for your answer, but still I am getting a error, exit status 2"}], "tags": [], "owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "is_accepted": true, "score": 0, "last_activity_date": 1490019098, "last_edit_date": 1490019098, "creation_date": 1490007647, "answer_id": 42901884, "question_id": 42899981, "link": "https://stackoverflow.com/questions/42899981/want-to-run-a-binary-having-flags-and-arguments-by-using-go-program/42901884#42901884", "title": "Want to run a binary having flags and arguments by using Go program", "body": "<p><code>output, err := exec.Command(\"./test\",\"flag1\", \"arg1\", \"flag2\", \"arg2\").Output()</code></p>\n\n<p><a href=\"https://golang.org/pkg/os/exec/#Cmd.Output\" rel=\"nofollow noreferrer\">Output</a> returns both a slice of bytes and an error. As indicated by the error, you are only expecting a single return value, whereas <code>Output</code> returns two. </p>\n\n<p>EDIT: As for debugging your second problem, get the <code>stderr</code> from the command: </p>\n\n<pre><code>cmd := exec.Command(\"./test\",\"flag1\", \"arg1\", \"flag2\", \"arg2\")\nvar stderr bytes.Buffer\ncmd.Stderr = &amp;stderr  \nerr := cmd.Run()\nif err != nil {\n    fmt.Println(stderr.String())\n    return\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 3967645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH6pY.jpg?s=128&g=1", "display_name": "shiva", "link": "https://stackoverflow.com/users/3967645/shiva"}, "edited": false, "score": 0, "creation_date": 1490026444, "post_id": 42905886, "comment_id": 72916617, "body": "No,  I have tried  a different binary with no flags, that is working without absolute path.. this flags making the problem"}], "tags": [], "owner": {"reputation": 374, "user_id": 7119031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvnGa.jpg?s=128&g=1", "display_name": "hiroyukik", "link": "https://stackoverflow.com/users/7119031/hiroyukik"}, "is_accepted": false, "score": 0, "last_activity_date": 1490019250, "creation_date": 1490019250, "answer_id": 42905886, "question_id": 42899981, "link": "https://stackoverflow.com/questions/42899981/want-to-run-a-binary-having-flags-and-arguments-by-using-go-program/42905886#42905886", "title": "Want to run a binary having flags and arguments by using Go program", "body": "<p>I guess  Exit code 2 means 'no such a file or directory'. You should check path where you executed go binary and where test is. </p>\n\n<p>Please try to specify absolute path for your cimmand first. </p>\n"}], "owner": {"reputation": 15, "user_id": 3967645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dH6pY.jpg?s=128&g=1", "display_name": "shiva", "link": "https://stackoverflow.com/users/3967645/shiva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "accepted_answer_id": 42901884, "answer_count": 2, "score": 1, "last_activity_date": 1490019250, "creation_date": 1490002290, "last_edit_date": 1490018601, "question_id": 42899981, "link": "https://stackoverflow.com/questions/42899981/want-to-run-a-binary-having-flags-and-arguments-by-using-go-program", "title": "Want to run a binary having flags and arguments by using Go program", "body": "<p>I want to run a binary file with flags.\nIf i directly run the binary it will be like following inside a golang program.</p>\n\n<p><code>./test --flag1 arg1 --flag2 arg2</code></p>\n\n<p>I was trying to run by the use of <code>os.exec</code>.</p>\n\n<p>code:  <code>reslt ,err:= exec.Command(\"./test\",\"--flag1\", \"arg1\", \"--flag2\", \"arg2\").Output</code></p>\n\n<p>It is giving error: </p>\n\n<blockquote>\n  <p>Exit status 2</p>\n</blockquote>\n\n<p>Can anyone help on this?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 4007, "user_id": 616398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/83e5ba145326da0edcc404bfff584df5?s=128&d=identicon&r=PG", "display_name": "Gerben Jacobs", "link": "https://stackoverflow.com/users/616398/gerben-jacobs"}, "edited": false, "score": 1, "creation_date": 1490001887, "post_id": 42899754, "comment_id": 72899566, "body": "If you want to wrap in an object you need to marshal as a map and each Reminder needs to have a unique name. However you can also marshal as a slice, JSON allows the root object to be an array."}, {"owner": {"reputation": 326, "user_id": 524370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0ca9cd5c39011be8f736147b72bbf6d9?s=128&d=identicon&r=PG", "display_name": "nJoshi", "link": "https://stackoverflow.com/users/524370/njoshi"}, "edited": false, "score": 0, "creation_date": 1490036280, "post_id": 42899754, "comment_id": 72922722, "body": "I believe your file is missing a root node, ie all the records are siblings without a parent. That is why you are getting the &quot;invalid character &#39;{&#39; after top-level value&quot;"}, {"owner": {"reputation": 326, "user_id": 524370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0ca9cd5c39011be8f736147b72bbf6d9?s=128&d=identicon&r=PG", "display_name": "nJoshi", "link": "https://stackoverflow.com/users/524370/njoshi"}, "edited": false, "score": 0, "creation_date": 1490039295, "post_id": 42899754, "comment_id": 72924491, "body": "@Paul, you will have to be clear and specific on what your question is, is it the error when you get when you are reading your .json file? or Marshaling the data in hand?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "reply_to_user": {"reputation": 326, "user_id": 524370, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/0ca9cd5c39011be8f736147b72bbf6d9?s=128&d=identicon&r=PG", "display_name": "nJoshi", "link": "https://stackoverflow.com/users/524370/njoshi"}, "edited": false, "score": 0, "creation_date": 1490039956, "post_id": 42899754, "comment_id": 72924867, "body": "@nJoshi I think I was pretty specific with my question and mkopriva has shown exactly what I&#39;ve wanted although it doesnt work on my machine, while it works on his."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "edited": false, "score": 0, "creation_date": 1490021152, "post_id": 42906336, "comment_id": 72912659, "body": "Well, your example does not work, after adding a reminder it says <code>EOF</code> and while displaying them it shows <code>unexpected end of JSON input</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490023483, "post_id": 42906336, "comment_id": 72914460, "body": "Are you sure you copied the code verbatim? I just ran that example implementation and here&#39;s the output: <a href=\"http://imgur.com/TutS0Uv\" rel=\"nofollow noreferrer\">imgur.com/TutS0Uv</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "edited": false, "score": 0, "creation_date": 1490024123, "post_id": 42906336, "comment_id": 72914980, "body": "Well that&#39;s strange, yes I did, and still the same error occurs also your variable err is redeclared 3 times. I&#39;ve tried running it both ways."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1490024723, "post_id": 42906336, "comment_id": 72915426, "body": "Not sure why it doesn&#39;t work for you... about the errors though, redeclaring errors is fine as long as they are redeclared inside a new block e.g. <code>if err := file.Close(); err != nil { ...</code> or as part of a multi value declaration (<code>x, y, z := 3, 2, 1</code>) where at least one of the declared values wasn&#39;t declared before in the current block e.g. <code>info, err := file.Stat()</code>."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1490020434, "creation_date": 1490020434, "answer_id": 42906336, "question_id": 42899754, "link": "https://stackoverflow.com/questions/42899754/wrapping-json-member-fields-to-object/42906336#42906336", "title": "Wrapping json member fields to object", "body": "<p>You should store the reminders into an array inside the json file, as mentioned by @Gerben Jacobs, and then, every time you want to add a new reminder to the array you need to read the full contents of <code>rem.json</code>, append the new reminder in Go, truncate the file, and write the new slice into the file. Here's a quick implentation <a href=\"https://play.golang.org/p/UKR91maQF2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/UKR91maQF2</a>.</p>\n\n<p>If you have lots of reminders and the process of reading, decoding, encoding, and writing the whole content becomes a pain you could open the file, implement a way to truncate only the last <code>]</code> from the file contents, and then write only <code>,</code> + new reminder + <code>]</code>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "is_accepted": true, "score": 0, "last_activity_date": 1490099267, "creation_date": 1490099267, "answer_id": 42927166, "question_id": 42899754, "link": "https://stackoverflow.com/questions/42899754/wrapping-json-member-fields-to-object/42927166#42927166", "title": "Wrapping json member fields to object", "body": "<p>So after some research, people in the <code>go-nuts</code> group helped me and suggested me to use a streaming json parser that parses items individually.</p>\n\n<p>So I needed to change my reminder listing function:</p>\n\n<pre><code>func listReminders() error {\n    f, err := os.Open(\"rem.json\")\n    if err != nil {\n        return err\n    }\n    dec := json.NewDecoder(f)\n    for {\n        var content Name\n        switch dec.Decode(&amp;content) {\n        case nil:\n            fmt.Printf(\"%#v\\n\", content)\n        case io.EOF:\n            return nil\n        default:\n            return err\n        }\n    }\n}\n</code></pre>\n\n<p>Now everything works the way I wanted.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 42927166, "answer_count": 2, "score": 1, "last_activity_date": 1490099267, "creation_date": 1490001632, "question_id": 42899754, "link": "https://stackoverflow.com/questions/42899754/wrapping-json-member-fields-to-object", "title": "Wrapping json member fields to object", "body": "<p>My objective is to add fields to json on user request. </p>\n\n<p>Everything is great, but when displaying the fields with</p>\n\n<pre><code>fmt.Printf(\"%s: %s\\n\", content.Date, content.Description)\n</code></pre>\n\n<p>an error occurs:</p>\n\n<p><code>invalid character '{' after top-level value</code></p>\n\n<p>And that is because after adding new fields the file looks like this:</p>\n\n<pre><code>{\"Date\":\"2017-03-20 10:46:48\",\"Description\":\"new\"}\n{\"Date\":\"2017-03-20 10:46:51\",\"Description\":\"new .go\"}\n</code></pre>\n\n<p>The biggest problem is with the writting to file</p>\n\n<pre><code>reminder := &amp;Name{dateString[:19], text} //text - input string\nnewReminder, _ := json.Marshal(&amp;reminder)\n</code></pre>\n\n<p>I dont really know how to do this properly</p>\n\n<p>My question is how should I wrap all member fields into one object?\nAnd what is the best way to iterate through member fields?</p>\n\n<p>The code is available here: <a href=\"https://play.golang.org/p/NunV_B6sud\" rel=\"nofollow noreferrer\">https://play.golang.org/p/NunV_B6sud</a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1489995052, "post_id": 42897567, "comment_id": 72896001, "body": "Assigning a var to <code>_</code> has nothing to do with importing."}, {"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1490002709, "post_id": 42897567, "comment_id": 72900055, "body": "@Flimzy   <code>var _=fmt.Println</code> can fix the error caused by <code>import  &quot;fmt&quot;</code> but not used. <code>import _ &quot;fmt&quot;</code> is the other way."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1490004368, "post_id": 42897567, "comment_id": 72901154, "body": "No.  <code>fmt.Println</code> solves that. Adding <code>var _ =</code> in front has absolutely no effect on importing."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1490044894, "post_id": 42897567, "comment_id": 72927597, "body": "Flimzy, calling fmt.Println() calls the function (in this case, printing a new line character).  Assigning the function to a blank identifier causes the <code>fmt</code> package to be imported and &quot;used&quot;, but doesn&#39;t actually call any functions from it, preventing side-effects but also allowing the <code>fmt</code> package to be imported without actually calling anything from it and without triggering a compile error from that lack of use.  It&#39;s a way of bypassing the must-by-used restriction on imports in Go."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 0, "last_activity_date": 1489993857, "last_edit_date": 1489993857, "creation_date": 1489993348, "answer_id": 42897567, "question_id": 42897353, "link": "https://stackoverflow.com/questions/42897353/function-is-assigned-to-an-underscores-what-is-the-meaning/42897567#42897567", "title": "function is assigned to an Underscores, what is the meaning", "body": "<p>prevent the <code>imported and not used</code> error.</p>\n\n<p><code>_</code> is <code>Blank identifier</code>, see <a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 267, "user_id": 1360420, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/93e04281f22e29753b5815f4d172c6ce?s=128&d=identicon&r=PG", "display_name": "Huang_Hai_Feng", "link": "https://stackoverflow.com/users/1360420/huang-hai-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "closed_date": 1489994885, "answer_count": 1, "score": 2, "last_activity_date": 1489993857, "creation_date": 1489992409, "last_edit_date": 1489993071, "question_id": 42897353, "link": "https://stackoverflow.com/questions/42897353/function-is-assigned-to-an-underscores-what-is-the-meaning", "closed_reason": "Duplicate", "title": "function is assigned to an Underscores, what is the meaning", "body": "<p>In go-plinq(<a href=\"https://github.com/fanliao/go-plinq/blob/master/linq.go\" rel=\"nofollow noreferrer\">https://github.com/fanliao/go-plinq/blob/master/linq.go</a>), line 28, there is a line listed as above:</p>\n\n<pre><code>var _ = fmt.Println //for debugger\n</code></pre>\n\n<p>What is the use of this statement? Does it make any sense?</p>\n"}, {"tags": ["go", "goroutine", "gorilla"], "comments": [{"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 5, "creation_date": 1489995372, "post_id": 42897351, "comment_id": 72896166, "body": "Alexander R that hasn&#39;t been true for a long time, you don&#39;t need to set gomaxprocs."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 8, "last_activity_date": 1489996000, "creation_date": 1489996000, "answer_id": 42898260, "question_id": 42897351, "link": "https://stackoverflow.com/questions/42897351/using-go-routines-in-gorilla-mux-framework/42898260#42898260", "title": "Using Go routines in gorilla/mux framework", "body": "<blockquote>\n  <p>I suppose automatically runs on all the cpu cores.</p>\n</blockquote>\n\n<p>You suppose wrong. Sort of.</p>\n\n<p>As of Go 1.5, Go will use all of your cores, by running go routines on different cores. But if you don't use go routines, there's no way for it to take advantage of this.</p>\n\n<blockquote>\n  <p>Is there a benefit of using go routines in such a case for cpu intensive processes for eg looping through a large object?</p>\n</blockquote>\n\n<p>There can be. But you're asking the wrong question.</p>\n\n<p>You don't use Go routines primarily to take advantage of different CPU cores (although this can also be a benefit).  You use Go routines to keep your program from blocking while doing something that takes a while.</p>\n\n<p>In the case of a web application, most requests are usually <em>not</em> CPU intensive at all. But they usually spend a lot of time (in computer terms) waiting around for things to happen. They wait for DNS lookups on the request hostname, they wait for the database to look up user credentials to establish a session, they wait for the database to store or return rows to produce the HTTP response, etc.</p>\n\n<p>Without go routines, while doing these things, your server would be unable to do anything else.  So if your typical HTTP request took, say, 1 second, to look up DNS, validate an authorization cookie, look up results from a database, and send a response, no other HTTP client could be served simultaneously.</p>\n\n<p>Fortunately, the <code>http</code> package, which is used by Gorilla (and practically every other web framework for Go) <em>already uses Go routines</em> to handle requests. So you're already using (at least) one Go routine per HTTP request.</p>\n\n<p>Whether it makes sense to use additional go routines is more up to your application design than \"using more CPU cores.\"</p>\n\n<p>Some suggestions:</p>\n\n<ol>\n<li>If you're doing multiple things to serve a request that could be done in parallel, use go routines.  Suppose you need to do 3 DB queries, you can do each one in a Go routine, so they run simultaneously.  They may run on different CPU cores, but that's completely irrelevant to actual performance, since each one is essentially doing nothing, and just waiting for the database. But you'll still improve performance.  (For completeness sake,I'll mention that goroutines aren't the only way to run database queries in parallel--but they are the idiomatic Go way, and the easy way in Go).</li>\n<li>If you have tasks that are run by an HTTP request, but don't affect the HTTP response, you can run them in a Go routine, so your response can return sooner. Logging is a common example.  You probably want to log your HTTP requests, but if the logger is slow, you probably don't want to wait for logging to finish before sending your HTTP response. So do it in a go routine. The logger can take it's sweet time and finish <em>after</em> the client has already received their response.  Another example is sending emails--please don't wait for an email to be sent before responding to an HTTP client.</li>\n</ol>\n"}], "owner": {"reputation": 139, "user_id": 7166893, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-hNv6vTfYAZU/AAAAAAAAAAI/AAAAAAAAADc/aPQeAZq1RGw/photo.jpg?sz=128", "display_name": "Rakshita Jain", "link": "https://stackoverflow.com/users/7166893/rakshita-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "accepted_answer_id": 42898260, "answer_count": 1, "score": 2, "last_activity_date": 1490455820, "creation_date": 1489992404, "last_edit_date": 1490455820, "question_id": 42897351, "link": "https://stackoverflow.com/questions/42897351/using-go-routines-in-gorilla-mux-framework", "title": "Using Go routines in gorilla/mux framework", "body": "<p>We are using gorilla mux framework for handling web requests which I suppose automatically runs on all the cpu cores. Is there a benefit of using go routines in such a case for cpu intensive processes for eg looping through a large object?</p>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 0, "creation_date": 1489985900, "post_id": 42895877, "comment_id": 72892741, "body": "What is a problem with adding CurrentYear field to your object myObject and the using {{ .CurrentYear }} in template?"}], "answers": [{"tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": true, "score": 11, "last_activity_date": 1489986311, "creation_date": 1489986311, "answer_id": 42896194, "question_id": 42895877, "link": "https://stackoverflow.com/questions/42895877/how-do-you-add-the-current-year-to-a-go-template/42896194#42896194", "title": "How do you add the current year to a Go template?", "body": "<p>you can add function to template, try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    funcMap := template.FuncMap{\n        \"now\": time.Now,\n    }\n\n    templateText := \"&lt;html&gt;&lt;body&gt;The current year is {{now.UTC.Year}}&lt;/body&gt;&lt;/html&gt;\"\n    tmpl, err := template.New(\"titleTest\").Funcs(funcMap).Parse(templateText)\n    if err != nil {\n        log.Fatalf(\"parsing: %s\", err)\n    }\n\n    // Run the template to verify the output.\n    err = tmpl.Execute(os.Stdout, nil)\n    if err != nil {\n        log.Fatalf(\"execution: %s\", err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1489999321, "last_edit_date": 1489999321, "creation_date": 1489995686, "answer_id": 42898180, "question_id": 42895877, "link": "https://stackoverflow.com/questions/42895877/how-do-you-add-the-current-year-to-a-go-template/42898180#42898180", "title": "How do you add the current year to a Go template?", "body": "<p>You're already including a <code>Title</code> in your template. How does that end up in the template? You pass it as an argument to <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\"><code>Template.Execute()</code></a>. This (unsurprisingly) works for the current year too.</p>\n\n<p>It's a better and easier solution than registering a function for this. This is how it could look like:</p>\n\n<pre><code>t := template.Must(template.New(\"\").Parse(\n    \"&lt;html&gt;&lt;body&gt;{{ .Title }}; Year: {{.Year}}&lt;/body&gt;&lt;/html&gt;\"))\n\nmyObject := struct {\n    Title string\n    Year  int\n}{\"Test Title\", time.Now().UTC().Year()}\n\nif err := t.Execute(os.Stdout, myObject); err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NvY2kqyAcf\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;html&gt;&lt;body&gt;Test Title; Year: 2009&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n\n<p>(Note: the current date/time on the Go Playground is <code>2009-11-10 23:00:00</code>, that's why you see <code>2009</code>).</p>\n\n<p>By design philosophy, templates should not contain <em>complex</em> logic. If something is (or looks) too complex in templates, you should consider calculating the result in Go code and either pass the result as data to the execution, or register a callback function in the templates and have a template action call that function and insert the return value.</p>\n\n<p>Arguably getting the current year is not a complex logic. But Go is a statically linked language. You only have guarantee that the executable binary will only include packages and functions that your Go (source) code refers to explicitly. This applies to all packages of the standard library (except the <code>runtime</code> package). So a template text cannot just refer to and call functions from packages like the <code>time</code> package, because there is no guarantee that will be available at runtime.</p>\n"}], "owner": {"reputation": 1159, "user_id": 989962, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/zMiu3.jpg?s=128&g=1", "display_name": "BlueSky", "link": "https://stackoverflow.com/users/989962/bluesky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4504, "favorite_count": 0, "accepted_answer_id": 42896194, "answer_count": 2, "score": 6, "last_activity_date": 1489999321, "creation_date": 1489984176, "question_id": 42895877, "link": "https://stackoverflow.com/questions/42895877/how-do-you-add-the-current-year-to-a-go-template", "title": "How do you add the current year to a Go template?", "body": "<p>In a Go template, you can retrieve a field like this:</p>\n\n<pre><code>template.Parse(\"&lt;html&gt;&lt;body&gt;{{ .Title }}&lt;/body&gt;&lt;/html&gt;\")\ntemplate.Execute(w, myObject)\n</code></pre>\n\n<p>How would you \"inline\" the current UTC year?  I want to do something like this:</p>\n\n<pre><code>template.Parse(\"&lt;html&gt;&lt;body&gt;The current year is {{time.Time.Now().UTC().Year()}}&lt;/body&gt;&lt;/html&gt;\")\n</code></pre>\n\n<p>But it returns the error:</p>\n\n<blockquote>\n  <p>panic: template: function \"time\" not defined</p>\n</blockquote>\n"}, {"tags": ["go", "cloudflare"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1490032752, "post_id": 42894944, "comment_id": 72920620, "body": "Note that Cloudflare in &quot;DNS only&quot; mode does not interact with HTTP(S), as Cloudflare would no longer be proxying your traffic. Browsers will try <code>http:&#47;&#47;example.com</code> when you enter just <code>example.com</code> by default, so unless you specify <code>https:&#47;&#47;example.com</code>, it will fail. You should therefore listen on 80, re-direct to HTTPS, and if you want the default behaviour after the first request to be HTTPS (always), use HSTS: <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security\" rel=\"nofollow noreferrer\">developer.mozilla.org/en-US/docs/Web/HTTP/Headers/&hellip;</a>"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1490069977, "post_id": 42894944, "comment_id": 72935313, "body": "Thanks that was helpful information!"}], "answers": [{"tags": [], "owner": {"reputation": 3577, "user_id": 1070329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b153ef5149a399ceec0cc097eda2ebd7?s=128&d=identicon&r=PG", "display_name": "mjsa", "link": "https://stackoverflow.com/users/1070329/mjsa"}, "is_accepted": true, "score": 0, "last_activity_date": 1490023913, "creation_date": 1490023913, "answer_id": 42907681, "question_id": 42894944, "link": "https://stackoverflow.com/questions/42894944/cloudflare-will-not-let-me-serve-only-https-it-works-only-if-i-serve-http-along/42907681#42907681", "title": "CloudFlare will not let me serve only HTTPS, it works only if I serve HTTP along with HTTPS", "body": "<p>When Cloudflare is set to Flexible SSL mode, <a href=\"https://support.cloudflare.com/hc/en-us/articles/200170416-What-do-the-SSL-options-mean-\" rel=\"nofollow noreferrer\">the connection to the origin will always be over HTTP</a> (not HTTPS).</p>\n\n<p>From Cloudflare KB:</p>\n\n<blockquote>\n  <p>You don't need to have an SSL certificate on your web server, but\n  your visitors still see the site as being HTTPS enabled. This option\n  is not recommended if you have any sensitive information on your\n  website. This setting will only work for port 443->80, not for the\n  other ports we support like 2053. It should only be used as a last\n  resort if you are not able to setup SSL on your own web server, but it\n  is less secure than any other option (even \u201cOff\u201d), and could even\n  cause you trouble when you decide to switch away from it: How do I fix\n  the infinite redirect loop...</p>\n</blockquote>\n\n<p>In order to change this, go to the Crypto tab in the Cloudflare dashboard and in the SSL option change \"Flexible\" to \"Full (Strict)\" (or \"Full\" if you're using a self-signed cert).</p>\n\n<p><a href=\"https://i.stack.imgur.com/5irZh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5irZh.png\" alt=\"Cloudflare SSL Modes\"></a></p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 42907681, "answer_count": 1, "score": 0, "last_activity_date": 1490023913, "creation_date": 1489977128, "question_id": 42894944, "link": "https://stackoverflow.com/questions/42894944/cloudflare-will-not-let-me-serve-only-https-it-works-only-if-i-serve-http-along", "title": "CloudFlare will not let me serve only HTTPS, it works only if I serve HTTP along with HTTPS", "body": "<p>I have set up a simple server to test my TLS certificate, the TLS part works fine. I have my DNS through CloudFlare.</p>\n\n<p>I would like the website to remain anonymous so I just changed the domain to \"example.com\".</p>\n\n<p>Here is the code for the simple server:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nvar hostname = \"example.com\"\n\nvar key = \"/srv/ssl/\" + hostname + \"-2017.03.20.key\"\nvar cert = \"/srv/ssl/ssl-bundle.crt\"\n\nfunc main() {\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"TLS test\"))\n    })\n    // go serveHTTP()\n    // go redirectHTTP()\n    serveHTTPS()\n}\n\nfunc serveHTTP() {\n    if err := http.ListenAndServe(\":80\", nil); err != nil {\n        log.Fatalf(\"ListenAndServe error: %v\", err)\n    }\n}\n\nfunc redirectHTTP() {\n    err := http.ListenAndServe(\":80\", http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        http.Redirect(w, r, \"https://\"+hostname+r.RequestURI, http.StatusMovedPermanently)\n    }))\n    if err != nil {\n        log.Fatalf(\"ListenAndServe error: %v\", err)\n    }\n}\n\nfunc serveHTTPS() {\n    log.Fatal(http.ListenAndServeTLS(\":443\", cert, key, nil))\n}\n</code></pre>\n\n<p>Now if I run the server like this, and go to <code>https://example.com</code> then it does not work.</p>\n\n<p>But if I change the part that lets me serve HTTP to this:</p>\n\n<pre><code>go serveHTTP()\n// go redirectHTTP()\nserveHTTPS()\n</code></pre>\n\n<p>Then suddenly both HTTP and HTTPS works. So if I go to my site by typing in <code>http://example.com</code>, and <code>https://example.com</code>, both works fine.</p>\n\n<p>If I comment out <code>go serveHTTP()</code> and try to redirect HTTP to HTTPS like this:</p>\n\n<pre><code>// go serveHTTP()\ngo redirectHTTP()\nserveHTTPS()\n</code></pre>\n\n<p>Then I get this on my screen:</p>\n\n<p><a href=\"https://i.stack.imgur.com/n5TBE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n5TBE.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If I change back to this:</p>\n\n<pre><code>// go serveHTTP()\n// go redirectHTTP()\nserveHTTPS()\n</code></pre>\n\n<p>And access the page not through the domain name, but though the ip address, I ofcourse get a warning because the certificate is not issued to the ip address, but the domain name I use.</p>\n\n<p><a href=\"https://i.stack.imgur.com/3XkmP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3XkmP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>If I persist by clicking advanced and adding exception then it works.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PIpy1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PIpy1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So actually it is being served at port 443, but trying to access the page through the domain name, that lets it go through CloudFlare DNS, then it does not work.</p>\n\n<p>Even if I only use CloudFlare as \"DNS only\" it still does not matter:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2cQAZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2cQAZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Or if I change to proxy, still the same:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yTtvA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yTtvA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have turned off cache and I use developer mode so that I should get \"real time responses\" from my server.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jYHdI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jYHdI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>So to summerize, since I have my DNS through CloudFlare, CloudFlare does not let me serve HTTPS, without HTTP. I need both HTTP and HTTPS without HTTP redirect. This is really weird and I have no idea how to fix this. The server serves through 443 because as I showed if I try to access the page through the IP address and add security exception, the page is actually being served.</p>\n\n<p>What can I do?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 2, "last_activity_date": 1489970910, "creation_date": 1489970910, "answer_id": 42894230, "question_id": 42894177, "link": "https://stackoverflow.com/questions/42894177/why-is-possible-to-pass-parameters-to-a-type-like-in-http-dir/42894230#42894230", "title": "Why is possible to pass parameters to a type like in http.Dir(&quot;.&quot;)?", "body": "<p><code>http.Dir(\".\")</code> is a type conversion. It converts the string <code>\".\"</code> to type <code>http.Dir</code>.</p>\n"}], "owner": {"reputation": 1403, "user_id": 4338325, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tmogA.jpg?s=128&g=1", "display_name": "Filipe Amaral", "link": "https://stackoverflow.com/users/4338325/filipe-amaral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 42894230, "answer_count": 1, "score": -1, "last_activity_date": 1489970910, "creation_date": 1489970503, "question_id": 42894177, "link": "https://stackoverflow.com/questions/42894177/why-is-possible-to-pass-parameters-to-a-type-like-in-http-dir", "title": "Why is possible to pass parameters to a type like in http.Dir(&quot;.&quot;)?", "body": "<p>In http package it is defined a custom type (<code>type Dir string</code>) and then a method <code>Open</code> is added to it (<a href=\"https://golang.org/src/net/http/fs.go#L34\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/fs.go#L34</a>). When invoked elsewhere it is done by <code>http.Dir(\".\")</code> as it were a function or method. Can someone explain me why and what is  happening here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489970617, "post_id": 42893937, "comment_id": 72889394, "body": "Where in your code do you access the context concurrently?"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489971182, "post_id": 42893937, "comment_id": 72889518, "body": "I don&#39;t access it concurrently as I showed on the post that I could use it in a getUser(w http.ResponseWriter, r *http.Request) type of function, I don&#39;t try to access it concurrently, but I thought maybe something happened in the background without me knowing. Since the go article says it needs to be thread safe."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489971449, "post_id": 42893937, "comment_id": 72889571, "body": "What it means is that <code>context</code> does not synchronise access for you (even though its own methods are thread-safe). So if you intend to pass the same context object to multiple goroutines then it would be your responsibility to properly synchronise access to the context value that you store."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489973244, "post_id": 42893937, "comment_id": 72889950, "body": "So if I just use it inside an http.HandlerFunc for requests and response as I showed at the end of the post, then I won&#39;t need it right? Just access it in a simple way, not in multiple go routines from my part."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489973464, "post_id": 42893937, "comment_id": 72889988, "body": "It looks like not. <a href=\"https://golang.org/src/context/context.go?s=14784:14844#L443\" rel=\"nofollow noreferrer\">golang.org/src/context/context.go?s=14784:14844#L443</a> there is nothing in the code that would require external synchronisation - it is simply a constructor function that sets a value, and a function to read it back."}], "answers": [{"tags": [], "owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "is_accepted": true, "score": 0, "last_activity_date": 1489988611, "creation_date": 1489988611, "answer_id": 42896565, "question_id": 42893937, "link": "https://stackoverflow.com/questions/42893937/do-i-need-mutex-read-lock-when-retrieving-slice-values-with-context-in-go/42896565#42896565", "title": "Do I need mutex read lock when retrieving slice values with context in Go?", "body": "<p>You are worried about a data race. Here is something helpful on the golang blog: </p>\n\n<blockquote>\n  <p>Data races are among the most common and hardest to debug types of\n  bugs in concurrent systems. A data race occurs when two goroutines\n  access the same variable concurrently and at least one of the accesses\n  is a write.</p>\n</blockquote>\n\n<p>The introduction to the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">race detector blog entry</a></p>\n\n<p>So if you are not sure you can run the race detector. Because it is not complicated. Just set the flag <code>-race</code> and go will check if there is a data race.</p>\n\n<p>When you use context normally you don't need to lock, because is passed through all the calls and for every new call there will be another address inside the memory. </p>\n\n<p>If you always read from a variable you don't need to lock it, because then the value will never change.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1371, "favorite_count": 0, "accepted_answer_id": 42896565, "answer_count": 1, "score": 2, "last_activity_date": 1489988611, "creation_date": 1489968425, "question_id": 42893937, "link": "https://stackoverflow.com/questions/42893937/do-i-need-mutex-read-lock-when-retrieving-slice-values-with-context-in-go", "title": "Do I need mutex read lock when retrieving slice values with context in Go?", "body": "<p>I have been reading about context and passing values in middlewares. Since the julienschmidt httprouter is not compatible with http.Handler interface I thought I could save the httprouter <code>Params</code> which is a slice of <code>Param</code></p>\n\n<p><a href=\"https://godoc.org/github.com/julienschmidt/httprouter#Params\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/julienschmidt/httprouter#Params</a></p>\n\n<p>and save this in a context value and retrieve later.</p>\n\n<p>The Go blog article on context: <a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">https://blog.golang.org/context</a> says that: </p>\n\n<blockquote>\n  <p>Value allows a Context to carry request-scoped data. That data must be\n  safe for simultaneous use by multiple goroutines.</p>\n</blockquote>\n\n<p>I don't know if this data is safe. Slices are not thread safe as I understand, but how would multiple go routines access the data in this situation?</p>\n\n<p>I have a handler that converts http.Handler to httprouter.Handle and saves the httprouter.Params so that I can use those params in http.HandlerFunc type functions.</p>\n\n<pre><code>type ctxKey string\n\nvar paramKey ctxKey = \"params\"\n\nfunc paramHandler(h http.Handler) httprouter.Handle {\n    return httprouter.Handle(func(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n        ctx := context.WithValue(r.Context(), paramKey, ps)\n        h.ServeHTTP(w, r.WithContext(ctx))\n    })\n}\n\nvar mutex sync.RWMutex\n\nfunc params(r *http.Request) httprouter.Params {\n    // https://blog.golang.org/context\n    // \"Value allows a Context to carry request-scoped data.\n    // That data must be safe for simultaneous use by multiple goroutines.\"\n    mutex.RLock()\n    value := r.Context().Value(paramKey)\n    mutex.RUnlock()\n    if ps, ok := value.(httprouter.Params); ok {\n        return ps\n    }\n    return httprouter.Params{}\n}\n</code></pre>\n\n<p>In paramHandler I set the context value which is a slice of httprouter.Param, and in params(r *http.Request) function I receive the parameters.</p>\n\n<p>My question is, do I need write locks when saving the slice of params in context in paramHandler, and read locks when retrieving the params from context as I have in the function param(*http.Request)?</p>\n\n<p>I plan on retrieving the params like this:</p>\n\n<pre><code>func getUser(w http.ResponseWriter, r *http.Request) {\n    ps := params(r)\n    fmt.Println(ps.ByName(\"id\"))\n}\n</code></pre>\n\n<p>Are the locks necessary?</p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 2, "last_activity_date": 1489998065, "creation_date": 1489998065, "answer_id": 42898714, "question_id": 42893752, "link": "https://stackoverflow.com/questions/42893752/unmarshal-xml-element-name-to-different-property/42898714#42898714", "title": "Unmarshal XML element name to different property", "body": "<p>You don't need to unmarshal into your final type. You could unmarshal into a separate set of types which mirror this data structure, then just translated into your preferred representation for use elsewhere (for example for fast lookup you might want to have a map[string]PriceRecord mapping domain names to Price records). I'd think of it that way rather than necessarily trying to do the translation in one step, which ties you completely to whatever xml they choose to produce - if it changes, your data structures would have to change too. </p>\n"}, {"comments": [{"owner": {"reputation": 510, "user_id": 5139282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed92cc217be9a873ae064b39af816962?s=128&d=identicon&r=PG", "display_name": "geek1011", "link": "https://stackoverflow.com/users/5139282/geek1011"}, "edited": false, "score": 0, "creation_date": 1490012965, "post_id": 42898839, "comment_id": 72906686, "body": "Thanks for the sample code, I thought it would end up as something like this."}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1489998529, "creation_date": 1489998529, "answer_id": 42898839, "question_id": 42893752, "link": "https://stackoverflow.com/questions/42893752/unmarshal-xml-element-name-to-different-property/42898839#42898839", "title": "Unmarshal XML element name to different property", "body": "<p>There's no simpler alternative to <code>XMLName xml.Name</code>.</p>\n\n<p>It's possible to do what you want with a type satisfying the <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshaler\" rel=\"nofollow noreferrer\">unmarshaller</a> interface. The added complexity is probably not worthwhile. <a href=\"https://play.golang.org/p/lyEuyoExRC\" rel=\"nofollow noreferrer\">Playground example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    var data Data\n    if err := xml.Unmarshal(payload, &amp;data); err != nil {\n        log.Fatal(err)\n    }\n\n    for k, v := range data.Reply.Domains {\n        fmt.Printf(\"%d: %#v\\n\", k, v)\n    }\n\n}\n\ntype Domain struct {\n    TLD          string\n    Registration string `xml:\"registration\"`\n    Transfer     string `xml:\"transfer\"`\n    Renew        string `xml:\"renew\"`\n}\n\nfunc (domain *Domain) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    v := struct {\n        XMLName      xml.Name\n        Registration string `xml:\"registration\"`\n        Transfer     string `xml:\"transfer\"`\n        Renew        string `xml:\"renew\"`\n    }{}\n    d.DecodeElement(&amp;v, &amp;start)\n\n    domain.TLD = v.XMLName.Local\n    domain.Registration = v.Registration\n    domain.Transfer = v.Transfer\n    domain.Renew = v.Renew\n\n    return nil\n}\n\ntype Data struct {\n    Request struct {\n        Operation string `xml:\"operation\"`\n        Ip        string `xml:\"ip\"`\n    } `xml:\"request\"`\n    Reply struct {\n        Code    string   `xml:\"code\"`\n        Detail  string   `xml:\"detail\"`\n        Domains []Domain `xml:\",any\"`\n    } `xml:\"reply\"`\n}\n\nvar payload = []byte(`&lt;namesilo&gt;\n    &lt;request&gt;\n        &lt;operation&gt;getPrices&lt;/operation&gt;\n        &lt;ip&gt;55.555.55.55&lt;/ip&gt;\n    &lt;/request&gt;\n    &lt;reply&gt;\n        &lt;code&gt;300&lt;/code&gt;\n        &lt;detail&gt;success&lt;/detail&gt;\n        &lt;com&gt;\n            &lt;registration&gt;8.99&lt;/registration&gt;\n            &lt;transfer&gt;8.39&lt;/transfer&gt;\n            &lt;renew&gt;8.99&lt;/renew&gt;\n        &lt;/com&gt;\n        &lt;net&gt;\n            &lt;registration&gt;9.29&lt;/registration&gt;\n            &lt;transfer&gt;8.99&lt;/transfer&gt;\n            &lt;renew&gt;9.29&lt;/renew&gt;\n        &lt;/net&gt;\n    &lt;/reply&gt;\n&lt;/namesilo&gt;`)\n</code></pre>\n"}], "owner": {"reputation": 510, "user_id": 5139282, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed92cc217be9a873ae064b39af816962?s=128&d=identicon&r=PG", "display_name": "geek1011", "link": "https://stackoverflow.com/users/5139282/geek1011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "accepted_answer_id": 42898839, "answer_count": 2, "score": 1, "last_activity_date": 1489998529, "creation_date": 1489967068, "last_edit_date": 1489998275, "question_id": 42893752, "link": "https://stackoverflow.com/questions/42893752/unmarshal-xml-element-name-to-different-property", "title": "Unmarshal XML element name to different property", "body": "<p>I am currently writing a library for the NameSilo API. I am stuck on the getPriceList api, which returns XML like this:</p>\n\n<pre><code>&lt;namesilo&gt;\n    &lt;request&gt;\n        &lt;operation&gt;getPrices&lt;/operation&gt;\n        &lt;ip&gt;55.555.55.55&lt;/ip&gt;\n    &lt;/request&gt;\n    &lt;reply&gt;\n        &lt;code&gt;300&lt;/code&gt;\n        &lt;detail&gt;success&lt;/detail&gt;\n        &lt;com&gt;\n            &lt;registration&gt;8.99&lt;/registration&gt;\n            &lt;transfer&gt;8.39&lt;/transfer&gt;\n            &lt;renew&gt;8.99&lt;/renew&gt;\n        &lt;/com&gt;\n        &lt;net&gt;\n            &lt;registration&gt;9.29&lt;/registration&gt;\n            &lt;transfer&gt;8.99&lt;/transfer&gt;\n            &lt;renew&gt;9.29&lt;/renew&gt;\n        &lt;/net&gt;\n    &lt;/reply&gt;\n&lt;/namesilo&gt;\n</code></pre>\n\n<p>As you can see, there is an element for each TLD. I would like to unmarshal the element name (example: com, net) into a property which is not called <code>XMLName</code> (I want it to be called TLD). </p>\n\n<p>After reading lines 34-39 of <a href=\"https://golang.org/src/encoding/xml/marshal.go\" rel=\"nofollow noreferrer\">https://golang.org/src/encoding/xml/marshal.go</a>, it seems like this is not possible.</p>\n\n<p>I have tried the following code, but it does not work. </p>\n\n<pre><code>type APIResponse struct {\n    Request struct {\n        Operation string `xml:\"operation\"`\n        IP        string `xml:\"ip\"`\n    } `xml:\"request\"`\n}\n\ntype GetPricesResponse struct {\n    APIResponse\n    Reply []struct {\n        Domains []struct {\n            TLD xml.name\n            Registration string `xml:\"registration\"`\n            Transfer     string `xml:\"transfer\"`\n            Renew        string `xml:\"renew\"`\n        } `xml:\",any\"`\n    } `xml:\"reply\"`\n}\n</code></pre>\n\n<p>Is there any way I can do this, or is it not possible to have a property name other than <code>XMLName</code> for the xml element name.</p>\n\n<p><strong>UPDATE</strong>: I looked a bit more into the code, and I found <a href=\"https://golang.org/src/encoding/xml/typeinfo.go?h=f.Name%20==%20%22XMLName%22#L97\" rel=\"nofollow noreferrer\">this</a>, which makes me think I cannot do this easily.</p>\n"}, {"tags": ["go", "timer"], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 178442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377cef4245e0fcbf76e021d9cd253e35?s=128&d=identicon&r=PG", "display_name": "Colin Stewart", "link": "https://stackoverflow.com/users/178442/colin-stewart"}, "is_accepted": false, "score": 0, "last_activity_date": 1489967324, "creation_date": 1489967324, "answer_id": 42893781, "question_id": 42893500, "link": "https://stackoverflow.com/questions/42893500/golang-difference-between-timer-expired-vs-stopped/42893781#42893781", "title": "Golang difference between timer expired VS stopped?", "body": "<p>Expired means that the timer has elapsed and sent the time on the channel.  Stop() means that the program no longer wants the time to fire - it returns true if it was stopped successfully and false if the timer has already fired and sent the time on the channel.</p>\n\n<p>See <a href=\"https://golang.org/pkg/time/#Timer.Stop\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#Timer.Stop</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 2268, "user_id": 1861412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDcs9.jpg?s=128&g=1", "display_name": "Cristian Greco", "link": "https://stackoverflow.com/users/1861412/cristian-greco"}, "is_accepted": false, "score": 1, "last_activity_date": 1489967520, "creation_date": 1489967520, "answer_id": 42893810, "question_id": 42893500, "link": "https://stackoverflow.com/questions/42893500/golang-difference-between-timer-expired-vs-stopped/42893810#42893810", "title": "Golang difference between timer expired VS stopped?", "body": "<p>A Timer created with a certain <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\">duration</a> <code>d</code> (specified at creation time) expires when such duration has passed. This means that waiting on the channel of a Timer with duration <code>d</code> will unblock the caller only after the duration has elapsed (maybe even later, depending on scheduling). Timer expiration can be thought of as event firing.</p>\n\n<p>If, after Timer creation, you want to prevent its expiration (e.g. because you're not interested in waiting anymore), you can <a href=\"https://golang.org/pkg/time/#Timer.Stop\" rel=\"nofollow noreferrer\">Stop()</a> the Timer. This is more useful when the Timer has been created with <a href=\"https://golang.org/pkg/time/#AfterFunc\" rel=\"nofollow noreferrer\">AfterFunc()</a>, in order to cancel the scheduled function execution.</p>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1489967520, "creation_date": 1489965239, "question_id": 42893500, "link": "https://stackoverflow.com/questions/42893500/golang-difference-between-timer-expired-vs-stopped", "title": "Golang difference between timer expired VS stopped?", "body": "<p>Based on this example (<a href=\"https://gobyexample.com/timers\" rel=\"nofollow noreferrer\">https://gobyexample.com/timers</a>), the timer can be either stopped or expired. But what are the differences?</p>\n\n<pre><code>package main\nimport \"time\"\nimport \"fmt\"\n\nfunc main() {\n    timer1 := time.NewTimer(time.Second*2)\n\n    &lt;-timer1.C\n    fmt.Println(\"Timer 1 expired\")\n\n    timer2 := time.NewTimer(time.Second)\n    go func() {\n        &lt;-timer2.C\n        fmt.Println(\"Timer 2 expired\")\n    } ()\n    stop2 := timer2.Stop()\n    if stop2 {\n        fmt.Println(\"Timer 2 stopped\")\n    }\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1489965223, "post_id": 42893493, "comment_id": 72888023, "body": "I can accept this answer in 12 minutes."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1489965185, "creation_date": 1489965185, "answer_id": 42893493, "question_id": 42893478, "link": "https://stackoverflow.com/questions/42893478/how-to-tell-whether-im-running-locally-on-google-app-engine-go/42893493#42893493", "title": "How to tell whether I&#39;m running locally on google app engine/go", "body": "<p>Call <a href=\"https://godoc.org/google.golang.org/appengine#IsDevAppServer\" rel=\"nofollow noreferrer\">IsDevAppServer</a> to determine if the application is running locally.</p>\n"}], "owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "closed_date": 1489996951, "accepted_answer_id": 42893493, "answer_count": 1, "score": 0, "last_activity_date": 1489965185, "creation_date": 1489965084, "question_id": 42893478, "link": "https://stackoverflow.com/questions/42893478/how-to-tell-whether-im-running-locally-on-google-app-engine-go", "closed_reason": "Duplicate", "title": "How to tell whether I&#39;m running locally on google app engine/go", "body": "<p>I'm aware of <code>if 'APPENGINE_RUNTIME' in os.environ.keys():</code> for the python runtime, but is there a similar way to tell whether I'm running locally using go?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 884, "user_id": 977910, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6234b108b8c0e0b3b7cdff599021e2df?s=128&d=identicon&r=PG", "display_name": "temple", "link": "https://stackoverflow.com/users/977910/temple"}, "edited": false, "score": 1, "creation_date": 1489965128, "post_id": 42893049, "comment_id": 72887980, "body": "thanks your reply, however, I am not able to change the source json file."}, {"owner": {"reputation": 2449, "user_id": 6346483, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154223277015798/picture?type=large", "display_name": "Anish Goyal", "link": "https://stackoverflow.com/users/6346483/anish-goyal"}, "reply_to_user": {"reputation": 884, "user_id": 977910, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6234b108b8c0e0b3b7cdff599021e2df?s=128&d=identicon&r=PG", "display_name": "temple", "link": "https://stackoverflow.com/users/977910/temple"}, "edited": false, "score": 0, "creation_date": 1489965338, "post_id": 42893049, "comment_id": 72888055, "body": "@temple got it - then, the other answer is the way to go. you&#39;ll be unmarshaling arrays of arrays of float64s. you can of course use that code for unmarshaling and then use the data to populate a more type-safe structure, and weed out any invalid data (e.g. data that has less than or more than 2 items in an ask/bid)"}], "tags": [], "owner": {"reputation": 2449, "user_id": 6346483, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154223277015798/picture?type=large", "display_name": "Anish Goyal", "link": "https://stackoverflow.com/users/6346483/anish-goyal"}, "is_accepted": false, "score": 2, "last_activity_date": 1489962509, "last_edit_date": 1489962509, "creation_date": 1489962359, "answer_id": 42893049, "question_id": 42892984, "link": "https://stackoverflow.com/questions/42892984/how-to-unmarshal-the-pair-values-in-an-nested-array-by-json-for-golang/42893049#42893049", "title": "How to Unmarshal the pair values in an nested array by json for Golang", "body": "<p>I believe it's because your arrays are structs in Go, but your JSON has arrays of arrays, which aren't the same. You'd want to change <code>[0.00000315,1022.53968253]</code> to <code>{\"0\": ##, \"1\": ##}</code>, so on and so forth.</p>\n\n<p>Or, you can have a separate Go struct where Asks is an array of arrays of float64s, etc., but this would be less type safe since arrays could have more or less than 2 elements.</p>\n\n<p>Now, in JS, array elements can be referenced by numerical keys and arrays can be treated as objects, but in JSON, objects and arrays are distinct.</p>\n\n<p>EDIT: add quotations around key names, as specified by the comment below. My mistake :) </p>\n"}, {"comments": [{"owner": {"reputation": 884, "user_id": 977910, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6234b108b8c0e0b3b7cdff599021e2df?s=128&d=identicon&r=PG", "display_name": "temple", "link": "https://stackoverflow.com/users/977910/temple"}, "edited": false, "score": 1, "creation_date": 1489965593, "post_id": 42893126, "comment_id": 72888130, "body": "thanks , I guess that&#39;s the answer. you saved my ton of time."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": true, "score": 3, "last_activity_date": 1489963612, "last_edit_date": 1489963612, "creation_date": 1489962936, "answer_id": 42893126, "question_id": 42892984, "link": "https://stackoverflow.com/questions/42892984/how-to-unmarshal-the-pair-values-in-an-nested-array-by-json-for-golang/42893126#42893126", "title": "How to Unmarshal the pair values in an nested array by json for Golang", "body": "<p>Asks and bids are array types not struct types.</p>\n\n<p>Here is a working <a href=\"https://play.golang.org/p/wbx_5pplNl\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>Below is an example that adds a <code>Nums</code> type that has a <code>One</code> and <code>Two</code> method you can use since those seem to be the format you are expecting. You could add some error checking in these methods to ensure the format is correct too.,</p>\n\n<pre><code>type Depth struct {\n    XXX XXX `json:\"xxx_xxx\"`\n}\n\ntype XXX struct {\n    Asks []Nums `json:\"asks\"`\n    Bids []Nums `json:\"bids\"`\n}\n\ntype Nums []float64\n\nfunc (n Nums) One() float64 {\n    if len(n) &gt; 0 {\n         return n[0]\n    }\n    return 0\n}\n\nfunc (n Nums) Two() float64 {\n    if len(n) &gt; 1 {\n        return n[1]\n    }\n    return 0\n}\n</code></pre>\n"}], "owner": {"reputation": 884, "user_id": 977910, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6234b108b8c0e0b3b7cdff599021e2df?s=128&d=identicon&r=PG", "display_name": "temple", "link": "https://stackoverflow.com/users/977910/temple"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 1, "accepted_answer_id": 42893126, "answer_count": 2, "score": 1, "last_activity_date": 1489963612, "creation_date": 1489961935, "last_edit_date": 1489962683, "question_id": 42892984, "link": "https://stackoverflow.com/questions/42892984/how-to-unmarshal-the-pair-values-in-an-nested-array-by-json-for-golang", "title": "How to Unmarshal the pair values in an nested array by json for Golang", "body": "<p>The JSON data like the following:</p>\n\n<pre><code>{\"xxx_xxx\":{\"asks\":[[0.00000315,1022.53968253],[0.00000328,200],[0.00000329,181.70008541]],\"bids\":[[0.00000254,2685.36319716],[0.00000253,600],[0.0000025,1000]]}}\n</code></pre>\n\n<p>the struct as:</p>\n\n<pre><code>type Depth struct {\n    XXX_XXX struct {\n        Asks []struct {\n            Num0 float64 `json:\"0\"`\n            Num1 float64 `json:\"1\"`\n        } `json:\"asks\"`\n        Bids []struct {\n            Num0 float64 `json:\"0\"`\n            Num1 float64 `json:\"1\"`\n        } `json:\"bids\"`\n    } `json:\"xxx_xxx\"`\n}\n</code></pre>\n\n<p>when try to map in go-lang as following:</p>\n\n<pre><code>json.Unmarshal(r, &amp;depth)\n</code></pre>\n\n<p>will get all zero arrays like following:</p>\n\n<pre><code>{{[{0 0} {0 0} {0 0} ] [{0 0} {0 0} {0 0} ]}}\n</code></pre>\n\n<p>It does not come up the result as I expected.\nHow to solve this problem?</p>\n\n<p>HERE is the code on playground:\n<a href=\"https://play.golang.org/p/wxFV6Mv26t\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wxFV6Mv26t</a></p>\n"}, {"tags": ["ubuntu", "go", "vagrant", "provisioning", "vagrant-provision"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489959679, "post_id": 42892030, "comment_id": 72886445, "body": "How do you set them in <code>my_provision.sh</code>? Do you <code>export</code> them? <code>.bashrc</code> won&#39;t work unless you <code>source</code> it explicitly (since it&#39;s run only when a new bash shell is started)"}, {"owner": {"reputation": 1764, "user_id": 970673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94b2447e847a20d32c93c5e77e66b041?s=128&d=identicon&r=PG", "display_name": "Jordan Morris", "link": "https://stackoverflow.com/users/970673/jordan-morris"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489963654, "post_id": 42892030, "comment_id": 72887568, "body": "@zerkms updated question to answer this"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1489963725, "post_id": 42892030, "comment_id": 72887581, "body": "If you <code>export</code> a variable in the script that runs other <code>go</code> commands - those totally must be able to see them. (and it works without issues here)"}], "answers": [{"tags": [], "owner": {"reputation": 1764, "user_id": 970673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94b2447e847a20d32c93c5e77e66b041?s=128&d=identicon&r=PG", "display_name": "Jordan Morris", "link": "https://stackoverflow.com/users/970673/jordan-morris"}, "is_accepted": true, "score": 0, "last_activity_date": 1489964060, "creation_date": 1489964060, "answer_id": 42893316, "question_id": 42892030, "link": "https://stackoverflow.com/questions/42892030/how-to-install-a-golang-package-during-vagrant-provision/42893316#42893316", "title": "How to install a golang package during vagrant provision?", "body": "<p>The problem I was having is that in the context of the provisioning script, <code>$HOME</code> refers to the <code>/root/</code> folder, rather than <code>/home/ubuntu/</code></p>\n\n<p>It pays to NOT rely on the <code>$HOME</code> variable when setting environment variables during provisioning, if you want to use those variables later in the provisioning scripts.</p>\n\n<p>Here is my solution (from <code>VagrantFile</code>)</p>\n\n<pre><code>config.vm.provision \"shell\", inline: &lt;&lt;-SHELL\n    echo -n                                          &gt;  /etc/profile.d/gopath.sh\n    echo 'export GOROOT=/usr/lib/go'                 &gt;&gt; /etc/profile.d/gopath.sh\n    echo 'export GOPATH=/home/ubuntu/go'             &gt;&gt; /etc/profile.d/gopath.sh\n    echo 'export PATH=$PATH:$GOROOT/bin:$GOPATH/bin' &gt;&gt; /etc/profile.d/gopath.sh\nSHELL\ndevbox.vm.provision \"shell\", path: \"scripts/my_provision.sh\"\n</code></pre>\n\n<p>After this, this <code>GOPATH</code> is picked up correctly by <code>go get</code> and <code>go install</code></p>\n"}], "owner": {"reputation": 1764, "user_id": 970673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94b2447e847a20d32c93c5e77e66b041?s=128&d=identicon&r=PG", "display_name": "Jordan Morris", "link": "https://stackoverflow.com/users/970673/jordan-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 0, "accepted_answer_id": 42893316, "answer_count": 1, "score": 0, "last_activity_date": 1489964060, "creation_date": 1489956177, "last_edit_date": 1489963636, "question_id": 42892030, "link": "https://stackoverflow.com/questions/42892030/how-to-install-a-golang-package-during-vagrant-provision", "title": "How to install a golang package during vagrant provision?", "body": "<p>There are similar questions about how to install golang with vagrant provision or how to set <code>$GOPATH</code> environment variable, such that it will be available on boot.</p>\n\n<p>However, this question is about how you can set <code>$GOPATH</code>, etc, such that the variable is available <em>during later steps of the provisioning script</em> (and everything else important about golang is in-place for that matter). I'm using an ubuntu image.</p>\n\n<p>Specifically, I want to run these steps in <code>my_provision.sh</code>:</p>\n\n<p><code>go get github.com/saymedia/terraform-s3-dir</code><br>\n<code>go install github.com/saymedia/terraform-s3-dir</code></p>\n\n<p>such that when I run the following command after <code>vagrant ssh</code>, it will just work:</p>\n\n<p><code>terraform-s3-dir</code></p>\n\n<p>When the go get/install commands run in <code>my_provision.sh</code>, it outputs one of two things: silence, or complaints that the <code>GOPATH</code> var is not set. Either way, when I boot in, <code>terraform-s3-dir</code> is not a recognised command.</p>\n\n<p>I've tried setting the <code>GOPATH</code>, <code>GOROOT</code> and <code>PATH</code> variables in several different ways:</p>\n\n<p>Setting them in <code>my_provision.sh</code> directly (with and without <code>export</code>), echoing export commands into .bashrc. echoing exporting commands to /etc/profile.d/gopath.sh. These all results in \"$GOPATH not set\".</p>\n\n<p>running exports in an inline provisioning script, prior to <code>my_provision.sh</code>. This resulted in silent failure, unless I try to run the go get/install commands with sudo, in which case it has the <code>$GOPATH</code> error, too.</p>\n\n<p>If I echo the GOPATH variable in <code>my_provision.sh</code> immediately before the go get/install commands, the variables show that they are set as expected.</p>\n\n<p>If I run the go get/install commands manually from the shell after <code>vagrant ssh</code>, then it installs successfully.</p>\n\n<p>What is different about the <code>vagrant ssh</code> context, vs the provisioning script context, where the go get/install commands get the desired result in the former, but not the latter?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1489944497, "post_id": 42889715, "comment_id": 72881146, "body": "The two statements do the same thing."}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "edited": false, "score": 3, "creation_date": 1489945783, "post_id": 42889715, "comment_id": 72881619, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/16959992/creating-map-with-without-make\">Creating map with/without make</a>"}, {"owner": {"reputation": 1, "user_id": 1389650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08c67ae83028fd85d09988a396a232a?s=128&d=identicon&r=PG", "display_name": "betsal", "link": "https://stackoverflow.com/users/1389650/betsal"}, "edited": false, "score": 0, "creation_date": 1489947269, "post_id": 42889715, "comment_id": 72882097, "body": "But why 2 pairs of braces?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1489948826, "post_id": 42889715, "comment_id": 72882617, "body": "In the first form, you&#39;re creating a map literal. The type is <code>map[string]interface{}</code>, which must be followed by the key/value pairs enclosed in braces. In your case, you&#39;re initializing an empty map, so you have <code>{}</code>."}, {"owner": {"reputation": 1, "user_id": 1389650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08c67ae83028fd85d09988a396a232a?s=128&d=identicon&r=PG", "display_name": "betsal", "link": "https://stackoverflow.com/users/1389650/betsal"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1489950528, "post_id": 42889715, "comment_id": 72883228, "body": "@AndySchweig thanks. Now I see that <code>m := map[string]interface{}{&quot;key&quot;: &quot;val&quot;}</code> works."}], "answers": [{"tags": [], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "is_accepted": false, "score": 0, "last_activity_date": 1490007130, "creation_date": 1490007130, "answer_id": 42901715, "question_id": 42889715, "link": "https://stackoverflow.com/questions/42889715/interface-declaration-difference/42901715#42901715", "title": "Interface declaration difference", "body": "<p>Both are the same except that when using <code>make</code>, you can (of course optionally) specify the size of the map you're trying to initialize.</p>\n\n<p>For e.g.,</p>\n\n<pre><code>m := make(map[string]interface{}, 10)\n</code></pre>\n\n<p>Also, when you initialize a map literal like this -</p>\n\n<pre><code>m := map[string]interface{}{}\n</code></pre>\n\n<p>you can add values to it then and there. In this case you have initialized it to a <code>nil</code> map. If you'd rather create a map in which you want to be able to add things in future (i.e. <code>append</code>), you should use either the first method or initialize it as</p>\n\n<pre><code>var m map[string]interface{}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1389650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d08c67ae83028fd85d09988a396a232a?s=128&d=identicon&r=PG", "display_name": "betsal", "link": "https://stackoverflow.com/users/1389650/betsal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1490007130, "creation_date": 1489944398, "question_id": 42889715, "link": "https://stackoverflow.com/questions/42889715/interface-declaration-difference", "title": "Interface declaration difference", "body": "<p>As a beginner gopher, i'm struggling to understand the difference between:</p>\n\n<pre><code>m := map[string]interface{}{}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>m := make(map[string]interface{})\n</code></pre>\n\n<p>I tried to find an explanation, but couldn't find anything.</p>\n"}, {"tags": ["go", "compression", "file-format", "lzw"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1489947142, "post_id": 42889912, "comment_id": 72882054, "body": "Or maybe the smarter thing to do would be to just read a unix-compressed .Z file in Go, and just omit the first 3 bytes. Am I right?"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1489947447, "post_id": 42889912, "comment_id": 72882163, "body": "One of those, yes. Then, that same page also suggests that compress uses a custom version of LZW, so it may still not be enough. In that case, you could experiment with GIF files instead."}, {"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1489947996, "post_id": 42889912, "comment_id": 72882333, "body": "In the <a href=\"https://pdfs.semanticscholar.org/200b/2261e11ddeb25298d6367db553a184af73fc.pdf\" rel=\"nofollow noreferrer\">paper</a> of one of the algorithms I&#39;m using, they use unix-compress, so, I will use it. Very helpful, thanks!"}, {"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1490022449, "post_id": 42889912, "comment_id": 72913702, "body": "after this line <code>buf0, err := ioutil.ReadFile(&quot;file.txt.Z&quot;)</code> i took a slice from I did <code>buf3 := buf0[3:]</code> and then used the slice <code>buf3</code> instead. It still gives me the same error"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1490022914, "post_id": 42889912, "comment_id": 72914048, "body": "As I wrote above, the page I linked to suggests that compress uses a custom version of LZW, which may not be compatible with Go\u2019s implementation."}, {"owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "edited": false, "score": 0, "creation_date": 1490028836, "post_id": 42889912, "comment_id": 72918198, "body": "Oh yes, it makes sense now. I&#39;m trying to figure out a way to modify the Go code to read the LZC variant of LZW."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": true, "score": 2, "last_activity_date": 1489945296, "creation_date": 1489945296, "answer_id": 42889912, "question_id": 42889664, "link": "https://stackoverflow.com/questions/42889664/why-using-unix-compress-and-go-compress-lzw-produce-different-files-not-readabl/42889912#42889912", "title": "Why using unix-compress and go compress/lzw produce different files, not readable by the other decoder?", "body": "<p>A .Z file does not only contain LZW compressed data, there is also <a href=\"https://wiki.wxwidgets.org/Development:_Z_File_Format\" rel=\"nofollow noreferrer\">a 3-bytes header</a> that the Go LZW code does not generate because it is meant to compress data, not generate a Z file.</p>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": false, "score": 1, "last_activity_date": 1489980216, "creation_date": 1489980216, "answer_id": 42895328, "question_id": 42889664, "link": "https://stackoverflow.com/questions/42889664/why-using-unix-compress-and-go-compress-lzw-produce-different-files-not-readabl/42895328#42895328", "title": "Why using unix-compress and go compress/lzw produce different files, not readable by the other decoder?", "body": "<p>Presumably you only want to test the performance of two of your/some third party algorithms (&amp; not the compression algorithms themselves), you may want to write a shell script which calls the compress command passing the files/dir's required and then call this script from your C / GO program. This is one way you can overcome this, but leaves open other parts of your queries on the correct way to use the compression libraries.</p>\n"}, {"tags": [], "owner": {"reputation": 2771, "user_id": 404949, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/5d457fe9d0c94a181f7631c3598b4e61?s=128&d=identicon&r=PG", "display_name": "puchu", "link": "https://stackoverflow.com/users/404949/puchu"}, "is_accepted": false, "score": 0, "last_activity_date": 1587139603, "creation_date": 1587139603, "answer_id": 61275905, "question_id": 42889664, "link": "https://stackoverflow.com/questions/42889664/why-using-unix-compress-and-go-compress-lzw-produce-different-files-not-readabl/61275905#61275905", "title": "Why using unix-compress and go compress/lzw produce different files, not readable by the other decoder?", "body": "<p>There is an ancient bug named <a href=\"https://github.com/vapier/ncompress/issues/5\" rel=\"nofollow noreferrer\">\"alignment bit groups\"</a> behind this question. I've described it in wikipedia <a href=\"https://en.wikipedia.org/wiki/Compress\" rel=\"nofollow noreferrer\">\"Special output format\"</a>. Please read.</p>\n\n<p>I've implemented a new library <a href=\"https://github.com/andrew-aladev/lzws\" rel=\"nofollow noreferrer\">lzws</a>. It has all possible options:</p>\n\n<ol>\n<li><code>--without-magic-header</code> (<code>-w</code>) - disable magic header</li>\n<li><code>--max-code-bit-length</code> (<code>-b</code>) - set max code bit length (9-16)</li>\n<li><code>--raw</code> (<code>-r</code>) - disable block mode</li>\n<li><code>--msb</code> (<code>-m</code>) - enable most significant bit</li>\n<li><code>--unaligned-bit-groups</code> (<code>-u</code>) - enable unaligned bit groups</li>\n</ol>\n\n<p>You can use any options in all possible combinations. All combinations has been tested. I am sure that you can find combinations suitable for go lzw implementation.</p>\n\n<p>You can use <a href=\"https://github.com/andrew-aladev/ruby-lzws\" rel=\"nofollow noreferrer\">ruby-lzws</a> binding if you like to use ruby.</p>\n"}], "owner": {"reputation": 43, "user_id": 4725811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0b3b1c2a1f3265272a99beb437ee69?s=128&d=identicon&r=PG&f=1", "display_name": "Maryam AbuShaaban", "link": "https://stackoverflow.com/users/4725811/maryam-abushaaban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "accepted_answer_id": 42889912, "answer_count": 3, "score": 2, "last_activity_date": 1587139603, "creation_date": 1489944157, "last_edit_date": 1489946843, "question_id": 42889664, "link": "https://stackoverflow.com/questions/42889664/why-using-unix-compress-and-go-compress-lzw-produce-different-files-not-readabl", "title": "Why using unix-compress and go compress/lzw produce different files, not readable by the other decoder?", "body": "<p>I compressed a file in a terminal with <code>compress file.txt</code> and got (as expected) <code>file.txt.Z</code></p>\n\n<p>When I pass that file to <code>ioutil.ReadFile</code> in Go,</p>\n\n<pre><code>buf0, err := ioutil.ReadFile(\"file.txt.Z\")\n</code></pre>\n\n<p>I get the error (the line above is 116):</p>\n\n<pre><code>finder_test.go:116: lzw: invalid code\n</code></pre>\n\n<p>I found that Go would accept the file if I compress it using the <code>compress/lzw</code> package, I just used code from <a href=\"https://www.socketloop.com/references/golang-compress-lzw-newwriter-function-example\" rel=\"nofollow noreferrer\">a website</a> that does that. I only modified the line</p>\n\n<pre><code>outputFile, err := os.Create(\"file.txt.lzw\")\n</code></pre>\n\n<p>I changed the <code>.lzw</code> to <code>.Z</code>. then used the resulting <code>file.txt.Z</code> in the Go code at the top, and it worked fine, no error.</p>\n\n<p>Note: <code>file.txt</code> is 16.0 kB, unix-compressed <code>file.txt.Z</code> is 7.8 kB, and go-compressed <code>file.txt.Z</code> is 8.2 kB</p>\n\n<p>Now, I was trying to understand why this happened. So, I tried to run</p>\n\n<pre><code>uncompress.real file.txt.Z\n</code></pre>\n\n<p>and it did not work. I got</p>\n\n<pre><code>file.txt.Z: not in compressed format\n</code></pre>\n\n<p>I need to use a compressor (preferably <code>unix-compress</code>) to compress files using <code>lzw-compression</code> then use the same compressed files on two different algorithms, one written in C and the other in Go, because I intend to compare the performance of the two algorithms. The <code>C</code> program will only accept the files compressed with <code>unix-compress</code> and the Go program will only accept the files compressed with Go's <code>compress/lzw</code>.</p>\n\n<p>Can someone explain why that happened? Why are the two .Z files not equivalent? How can I overcome this?</p>\n\n<p>Note: I am working on Ubuntu installed in VirtualBox on a Mac.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "is_accepted": true, "score": 2, "last_activity_date": 1489944620, "creation_date": 1489944620, "answer_id": 42889767, "question_id": 42889600, "link": "https://stackoverflow.com/questions/42889600/go-program-not-working-in-windows-7/42889767#42889767", "title": "Go Program not working in WIndows 7", "body": "<p>It looks like <code>Scanf</code> is treating windows newlines (<code>\\r\\n</code>) differently than unix newlines (<code>\\n</code>). I believe this was a bug in older versions of Go. What version are you running? Try using 1.7 or later.</p>\n\n<p>As a workaround, try doing <code>fmt.Scanf(\"%d\\n\", &amp;value)</code> to explicitly eat a newline character.</p>\n"}], "owner": {"reputation": 79, "user_id": 4779903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Fsp8.jpg?s=128&g=1", "display_name": "bhawani shanker", "link": "https://stackoverflow.com/users/4779903/bhawani-shanker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 42889767, "answer_count": 1, "score": 0, "last_activity_date": 1489944620, "creation_date": 1489943854, "question_id": 42889600, "link": "https://stackoverflow.com/questions/42889600/go-program-not-working-in-windows-7", "title": "Go Program not working in WIndows 7", "body": "<p>I am using this program to create a single linked list and print elements of list. Its working in my Mac but when I try same program in Windows 7 its not working as expected. Can someone identify what is issue here?</p>\n\n<pre><code>// Create a single linked list and display elements of list\npackage main\n\nimport \"fmt\"\n\n// Node structure\ntype Node struct {\n    Value int\n    Next *Node\n}\n\nfunc main() {\n    var value int\n    var head, current *Node\n\n    // Create linked list\n    for i := 0; i &lt;= 5; i++ {\n       fmt.Print(\"Plase enter a number: \")\n       fmt.Scanf(\"%d\", &amp;value)\n\n       var newNode = &amp;Node{value, nil}\n       if head != nil {\n          current.Next = newNode\n       } else {\n          head = newNode\n       }\n       current = newNode\n    }\n\n    // Print elements of linked list\n    for node := head; node != nil; node = node.Next {\n        fmt.Printf(\"%d \", node.Value)\n    }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>E:\\go &gt; go run linked_list.go\nPlease enter a number: 10\nPlease enter a number: Please enter a number: 20\nPlease enter a number: Please enter a number: 30\nPlease enter a number: 10 20 20 30 30 30\n</code></pre>\n"}, {"tags": ["go", "transactions", "sqlx"], "comments": [{"owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "edited": false, "score": 0, "creation_date": 1489943906, "post_id": 42889249, "comment_id": 72880908, "body": "What is the error you&#39;re getting? Also, just a sidenote, but <code>Rollback</code> can also return an error, so you should be handling that."}, {"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "reply_to_user": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "edited": false, "score": 0, "creation_date": 1489944049, "post_id": 42889249, "comment_id": 72880962, "body": "@MahlerFive, I am not sure yet, it panics and causes the execution to stop. Yes, I know that Rollback and Commit also returns errors, but I don&#39;t know how to handle them"}, {"owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "edited": false, "score": 0, "creation_date": 1489944165, "post_id": 42889249, "comment_id": 72881001, "body": "Can you post your whole function?"}], "answers": [{"comments": [{"owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "edited": false, "score": 0, "creation_date": 1489951066, "post_id": 42889708, "comment_id": 72883408, "body": "Can you please provide an example of using it? I didn&#39;t find anything on the internet"}, {"owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "reply_to_user": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "edited": false, "score": 0, "creation_date": 1489953520, "post_id": 42889708, "comment_id": 72884308, "body": "Examples showing how to use Context are available on the Golang blog (<a href=\"https://blog.golang.org/context\" rel=\"nofollow noreferrer\">blog.golang.org/context</a>) and the Context package itself is well documented (<a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">golang.org/pkg/context</a>)."}], "tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 2, "last_activity_date": 1507328296, "last_edit_date": 1507328296, "creation_date": 1489944358, "answer_id": 42889708, "question_id": 42889249, "link": "https://stackoverflow.com/questions/42889249/golang-transaction-exit-handling/42889708#42889708", "title": "Golang transaction exit handling", "body": "<p>If you want to roll back the transaction after 1 minute, you can use the standard Go timeout pattern (below).</p>\n\n<p>However, there may be better ways to deal with your problems. You don\u2019t give a lot of information about it, but you are probably using standard HTTP requests with contexts. In that case, it may help you to know that <a href=\"https://golang.org/pkg/database/sql/#DB.BeginTx\" rel=\"nofollow noreferrer\">a transaction started within a context is automatically rolled back when the context is cancelled</a>. One way to make sure that a context is cancelled if something gets stuck is to give it a <a href=\"https://golang.org/pkg/context/#WithDeadline\" rel=\"nofollow noreferrer\">deadline</a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>Excerpted from <a href=\"https://web.archive.org/web/20171006221636/https://stackoverflow.com/documentation/go/1263/channels/6050/timeouts#t=201710062216368423429\" rel=\"nofollow noreferrer\">Channels - Timeouts</a>. The original authors were <a href=\"https://stackoverflow.com/users/2670047/chris-lucas\">Chris Lucas</a>, <a href=\"https://stackoverflow.com/users/4725625/kwarrtz\">Kwarrtz</a> and <a href=\"https://stackoverflow.com/users/4804690/rodolfo-carvalho\">Rodolfo Carvalho</a>. Attribution details can be found on the <a href=\"https://web.archive.org/web/2/https://stackoverflow.com/documentation/contributors/example/6050\" rel=\"nofollow noreferrer\">contributor page</a>. The source is licenced under <a href=\"https://creativecommons.org/licenses/by-sa/3.0/\" rel=\"nofollow noreferrer\">CC BY-SA 3.0</a> and may be found in the <a href=\"https://archive.org/details/documentation-dump.7z\" rel=\"nofollow noreferrer\">Documentation archive</a>. Reference topic ID: 1263 and example ID: 6050.</p>\n</blockquote>\n\n<p><strong>Timeouts</strong></p>\n\n<p>Channels are often used to implement timeouts.</p>\n\n<pre><code>func main() {\n    // Create a buffered channel to prevent a goroutine leak. The buffer\n    // ensures that the goroutine below can eventually terminate, even if\n    // the timeout is met. Without the buffer, the send on the channel\n    // blocks forever, waiting for a read that will never happen, and the\n    // goroutine is leaked.\n    ch := make(chan struct{}, 1)\n\n    go func() {\n        time.Sleep(10 * time.Second)\n        ch &lt;- struct{}{}\n    }()\n\n    select {\n    case &lt;-ch:\n        // Work completed before timeout.\n    case &lt;-time.After(1 * time.Second):\n        // Work was not completed after 1 second.\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2183, "user_id": 5257738, "user_type": "registered", "accept_rate": 44, "profile_image": "https://graph.facebook.com/1481932215459032/picture?type=large", "display_name": "Rustam Ibragimov", "link": "https://stackoverflow.com/users/5257738/rustam-ibragimov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1592, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507328296, "creation_date": 1489941945, "question_id": 42889249, "link": "https://stackoverflow.com/questions/42889249/golang-transaction-exit-handling", "title": "Golang transaction exit handling", "body": "<p>I have a system with about 100 req/sec. And sometimes it doesn't respond until I restart my go program. I found out that this is because I open transaction and don't close it in some places. That's why all connections were occupied by opened transactions and I couldn't open another one After this I added this code</p>\n\n<pre><code>defer func() {\nif r := recover(); r != nil {\n    tx.Rollback()\n    return\n}\n\nif err == nil {\n    err = tx.Commit()\n} else {\n    tx.Rollback()\n}\n}()\n</code></pre>\n\n<p>This made my program work for a month without interruption. But just now it happened again. Probably because of this issue. Is there a better way to close transaction? Or maybe a way to close a transaction if it was open for 1 minute?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1489921796, "post_id": 42885573, "comment_id": 72873704, "body": "You build a package by name, not by trying to specify individual files."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1489923980, "creation_date": 1489923980, "answer_id": 42886211, "question_id": 42885573, "link": "https://stackoverflow.com/questions/42885573/fatal-error-when-building-go-package/42886211#42886211", "title": "Fatal error when building .go package", "body": "<p>I'm not sure what plain <code>go get -v -d</code> gets you but you should specify the package(s) that you want to install.\nSo what you should do is something like this:</p>\n\n<p><code>$go get github.com/moul/http2curl</code></p>\n\n<p>Without the <code>-d</code> flag this should download <strong>and install</strong> the package <code>http2curl</code> for you. But if you use the <code>-d</code> flag, you can install the package by first moving to the package's directory.</p>\n\n<p><code>$cd $GOPATH/src/github.com/moul/http2curl</code></p>\n\n<p>And then running build (without *.go).</p>\n\n<p><code>$go build</code></p>\n"}], "owner": {"reputation": 53, "user_id": 2568779, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd5795d25e9e04d6c48c4c73bd79d055?s=128&d=identicon&r=PG", "display_name": "yhelothar", "link": "https://stackoverflow.com/users/2568779/yhelothar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 376, "favorite_count": 0, "accepted_answer_id": 42886211, "answer_count": 1, "score": -1, "last_activity_date": 1489923980, "creation_date": 1489919735, "question_id": 42885573, "link": "https://stackoverflow.com/questions/42885573/fatal-error-when-building-go-package", "title": "Fatal error when building .go package", "body": "<p>I'm trying to install a go package. I cloned the package, ran the following commands to build it:</p>\n\n<pre><code>$go get -v -d\n\nFetching https://golang.org/x/net/publicsuffix?go-get=1\nParsing meta tags from https://golang.org/x/net/publicsuffix?go-get=1 (status code 200)\nget \"golang.org/x/net/publicsuffix\": found meta tag main.metaImport{Prefix:\"golang.org/x/net\", VCS:\"git\", RepoRoot:\"https://go.googlesource.com/net\"} at https://golang.org/x/net/publicsuffix?go-get=1\nget \"golang.org/x/net/publicsuffix\": verifying non-authoritative meta tag\nFetching https://golang.org/x/net?go-get=1\nParsing meta tags from https://golang.org/x/net?go-get=1 (status code 200)\ngolang.org/x/net (download)\n\n$go build *.go\n# github.com/moul/http2curl\ngccgo: error: $HOME/go/src/github.com/moul/http2curl/http2curl.go: No such file or directory\ngccgo: fatal error: no input files\ncompilation terminated.\n# github.com/pkg/errors\ngccgo: error: $HOME/go/src/github.com/pkg/errors/errors.go: No such file or directory\ngccgo: error: $HOME/go/src/github.com/pkg/errors/stack.go: No such file or directory\ngccgo: fatal error: no input files\ncompilation terminated.\n# golang.org/x/net/publicsuffix\ngccgo: error: $HOME/go/src/golang.org/x/net/publicsuffix/list.go: No such file or directory\ngccgo: error: $HOME/go/src/golang.org/x/net/publicsuffix/table.go: No such file or directory\ngccgo: fatal error: no input files\ncompilation terminated.\n</code></pre>\n\n<p>I tried cloning github.com/moul/http2curl to $HOME/go/src/github.com/moul/http2curl and the http2curl.go file is exactly in the path specified and yet it still says No such file or directory. \nHow do I build this?</p>\n"}, {"tags": ["mysql", "database", "go"], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "edited": false, "score": 1, "creation_date": 1489914703, "post_id": 42884197, "comment_id": 72871864, "body": "Is this possible in xorm?"}], "tags": [], "owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "is_accepted": false, "score": 2, "last_activity_date": 1489912469, "last_edit_date": 1489912469, "creation_date": 1489909857, "answer_id": 42884197, "question_id": 42884024, "link": "https://stackoverflow.com/questions/42884024/how-do-i-get-connection-pool-in-form-golang-to-an-instance-without-database/42884197#42884197", "title": "How do I get connection pool in form / golang to an instance without database?", "body": "<p>Just use the DSN without selecting a database:</p>\n\n<pre><code>dsn := \"root:@/\"\ndb, err := sql.Open(\"mysql\", dsn)\n</code></pre>\n\n<p>and then use one of your suggestions. \nYou can also create a 10-keys map between the databases' names and their corresponded <code>Db</code> object. </p>\n"}], "owner": {"reputation": 309, "user_id": 4517341, "user_type": "registered", "accept_rate": 36, "profile_image": "https://graph.facebook.com/100000867481103/picture?type=large", "display_name": "Kumar Siva", "link": "https://stackoverflow.com/users/4517341/kumar-siva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1489912469, "creation_date": 1489908377, "last_edit_date": 1489912443, "question_id": 42884024, "link": "https://stackoverflow.com/questions/42884024/how-do-i-get-connection-pool-in-form-golang-to-an-instance-without-database", "title": "How do I get connection pool in form / golang to an instance without database?", "body": "<p>I have 10 databases in one instance. I want to take a single connection pool to the instance. From that connection I will trigger \"use database\" query before trigger any other query or I can build query with database name. Ex <code>select * from database.table</code>.</p>\n\n<p>How do I get connection pool to instance without database in xorm or golang?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1489949509, "post_id": 42881490, "comment_id": 72882874, "body": "Ok, I tried to apply this knowledge in <a href=\"https://play.golang.org/p/rlkkQo31QJ\" rel=\"nofollow noreferrer\">another example</a> by  implementing a <code>String()</code> method, but i now get an assignment error. How can the <code>binfunc(add)</code> be assigned to an <code>error</code> type, but not a <code>string</code> type?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1489950244, "post_id": 42881490, "comment_id": 72883130, "body": "@LiamKelly <code>binFunc</code> satisfies the <code>error</code> interface by implementing an <code>Error() string</code> method. Note that the type of <code>binFunc(add)</code> is still <code>main.binFunc</code> (<code>fmt.Printf(&quot;%T\\n&quot;, err)</code> would say as much), not <code>string</code>. Because <code>error</code> is an interface, and <code>binFunc</code> satisfies the interface, you can use <code>err = binFunc(add)</code>. If you removed the <code>Error</code> method and left the <code>String</code> method, you&#39;d receive a compilation error because <code>binFunc</code> and <code>error</code> are no longer compatible types since <code>binFunc</code> does not implement the <code>Error</code> method. Try <code>var str fmt.Stringer</code> instead of <code>string</code> ;)"}, {"owner": {"reputation": 71, "user_id": 6021980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b33eaa37f14ba590b0832cef93f66509?s=128&d=identicon&r=PG", "display_name": "Elvis Attro", "link": "https://stackoverflow.com/users/6021980/elvis-attro"}, "reply_to_user": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "edited": false, "score": 0, "creation_date": 1612882370, "post_id": 42881490, "comment_id": 116900976, "body": "@LiamKelly, Rightly as @user539810 pointed!. And  the fact that you cannot assign  <code>binFunc(add)</code> to a &#39;string&#39; type is simply because binFunc DOES NOT implement a <code>string</code> interface (as there is no such interface in both the fmt package or the universe block). <code>string</code> is just a type, not an interface, and having any given type implementing <code>String() string</code> DOES NOT make that type a <code>string</code>. It makes it a <code>Stringer</code> because that what the actual interface is: <code>Stringer</code>. So if you want your 2nd example to compile and run, just change the line <code>var str string</code> to <code>var str fmt.Stringer</code>."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "is_accepted": true, "score": 5, "last_activity_date": 1489883080, "creation_date": 1489883080, "answer_id": 42881490, "question_id": 42881328, "link": "https://stackoverflow.com/questions/42881328/go-function-types-as-interface-values/42881490#42881490", "title": "Go Function Types as Interface Values", "body": "<p>The docs for the fmt package have this to say:</p>\n\n<blockquote>\n  <p>Except when printed using the verbs <code>%T</code> and <code>%p</code>, special formatting\n  considerations apply for operands that implement certain interfaces.\n  In order of application:</p>\n  \n  <p>...</p>\n  \n  <p>If the format (which is implicitly <code>%v</code> for <code>Println</code> etc.) is valid for a\n  string (<code>%s %q %v %x %X</code>), the following two rules apply:</p>\n  \n  <ol start=\"4\">\n  <li>If an operand implements the <code>error</code> interface, the <code>Error</code> method will be invoked to convert the object to a string, which will then be\n  formatted as required by the verb (if any).</li>\n  <li>If an operand implements method <code>String() string</code>, that method will be invoked to convert the object to a string, which will then be\n  formatted as required by the verb (if any).</li>\n  </ol>\n</blockquote>\n\n<p>In other words, <code>fmt.Println</code> will attempt to print the string representation of the interface. Since the error interface is satisfied by <code>binFunc</code>, it invokes the <code>Error</code> method of <code>binFunc</code>.</p>\n"}], "owner": {"reputation": 2776, "user_id": 1987437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/508e14a7e9414311eff04b2fd8d20ed6?s=128&d=identicon&r=PG", "display_name": "Liam Kelly", "link": "https://stackoverflow.com/users/1987437/liam-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3769, "favorite_count": 1, "accepted_answer_id": 42881490, "answer_count": 1, "score": 3, "last_activity_date": 1489883080, "creation_date": 1489881533, "question_id": 42881328, "link": "https://stackoverflow.com/questions/42881328/go-function-types-as-interface-values", "title": "Go Function Types as Interface Values", "body": "<p>I have been reading about <a href=\"http://jordanorelli.com/post/42369331748/function-types-in-go-golang\" rel=\"nofollow noreferrer\">function types as interface values</a> in go and I came across an example that I have not been able to figure out. Here it is:</p>\n\n<pre><code>type binFunc func(int, int) int\n\nfunc add(x, y int) int { return x + y }\n\nfunc (f binFunc) Error() string { return \"binFunc error\" }\n\nfunc main() {\n    var err error\n    err = binFunc(add)\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>You can find it on Go Playground <a href=\"https://play.golang.org/p/Dzwu9Xaqiy\" rel=\"nofollow noreferrer\">here</a>. </p>\n\n<p>I understand that you can assign a method to a function type, but I do not understand how <code>Error()</code> is being called. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1489870102, "post_id": 42879579, "comment_id": 72862901, "body": "Perhaps you could also say what you are trying to do with the <code>HandleHTTP</code> struct. It doesn&#39;t follow the conventional usage pattern for http servers as far as I can tell."}, {"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "reply_to_user": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1489870429, "post_id": 42879579, "comment_id": 72862983, "body": "@Ray, I am planning to use a go routines with listener for each struct object but on different port  to do that I would require to take this approach else I would get error for having same path for each struct. I don&#39;t know if you get me"}, {"owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1489871199, "post_id": 42879579, "comment_id": 72863261, "body": "Does this question help? <a href=\"http://stackoverflow.com/q/12648104/831878\">stackoverflow.com/q/12648104/831878</a>"}, {"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "reply_to_user": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "edited": false, "score": 0, "creation_date": 1489872344, "post_id": 42879579, "comment_id": 72863591, "body": "No, he has simply created a function inside which the actual http.HandleFunc is. Also in struct, he has simply tried to get the data type but not the function."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1489872686, "post_id": 42879579, "comment_id": 72863712, "body": "That&#39;s invalid Go, you cannot assign a package as a member of a struct, the selector in the error message simply means on of net/http&#39;s Types, function, etc. like http.ServeMux, or http.Handler."}], "answers": [{"comments": [{"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 0, "creation_date": 1489873798, "post_id": 42880219, "comment_id": 72864002, "body": "you are genius :-) Hats off"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 6, "last_activity_date": 1489873362, "creation_date": 1489873362, "answer_id": 42880219, "question_id": 42879579, "link": "https://stackoverflow.com/questions/42879579/golang-user-of-package-without-selector/42880219#42880219", "title": "Golang - User of package without selector", "body": "<p>If you want to have two or more instances serving from different ports you need to spin up two, or more, server. Would something like this, perhaps, work for you? </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\ntype HandleHTTP struct {\n    http *http.Server\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Path is %s\", r.URL.Path[1:])\n\n}\n\nfunc main() {\n    mux1 := http.NewServeMux()\n    mux1.HandleFunc(\"/\", handler)\n    test1 := HandleHTTP{http:&amp;http.Server{Addr:\":8081\", Handler:mux1}}\n\n    mux2 := http.NewServeMux()\n    mux2.HandleFunc(\"/\", handler)\n    test2 := HandleHTTP{http:&amp;http.Server{Addr:\":8082\", Handler:mux2}}\n\n    // run the first one in a goroutine so that the second one is executed\n    go test1.http.ListenAndServe()\n    test2.http.ListenAndServe()\n\n}\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12685, "favorite_count": 2, "accepted_answer_id": 42880219, "answer_count": 1, "score": 0, "last_activity_date": 1489873362, "creation_date": 1489869475, "question_id": 42879579, "link": "https://stackoverflow.com/questions/42879579/golang-user-of-package-without-selector", "title": "Golang - User of package without selector", "body": "<p>Please, I searched this a lot and after not been able to find, I am writing and not that I didn't try to search all over first. Couldn't get the right answer. I even tried to check Revel's function and couldn't get the answer from there as well. </p>\n\n<p>When I run this program I get this error for line </p>\n\n<pre><code>./test.go:11: use of package http without selector\n</code></pre>\n\n<p>This error points at the line below where I have written </p>\n\n<pre><code>*http\n</code></pre>\n\n<p>inside the struct</p>\n\n<p>Confusing part is that with test and dot I even get auto complete with VIM. So I don't know why is the error. Is it that it has to be somewhat like </p>\n\n<pre><code>*(net/http)\n</code></pre>\n\n<p>or something like that ? </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n)\n\ntype HandleHTTP struct {\n    *http\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"Path is %s\", r.URL.Path[1:])\n\n}\n\nfunc main() {\n\n    test := HandleHTTP{}\n\n    test.http.HandleFunc(\"/\", handler)\n    test.http.ListenAndServe(\":8080\", nil)\n\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5865, "user_id": 5298696, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_Lk3Kq_mN2c/AAAAAAAAAAI/AAAAAAAAAEQ/4UXPTXc6z6U/photo.jpg?sz=128", "display_name": "CollinD", "link": "https://stackoverflow.com/users/5298696/collind"}, "edited": false, "score": 6, "creation_date": 1489858306, "post_id": 42877566, "comment_id": 72858919, "body": "Just a recommendation, use a payment processor and leverage <i>their</i> api. You almost certainly don&#39;t want the liability of processing payments yourself."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1489858951, "post_id": 42877566, "comment_id": 72859117, "body": "<a href=\"https://github.com/stripe/stripe-go\" rel=\"nofollow noreferrer\">github.com/stripe/stripe-go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "is_accepted": true, "score": 7, "last_activity_date": 1489862328, "creation_date": 1489862328, "answer_id": 42878363, "question_id": 42877566, "link": "https://stackoverflow.com/questions/42877566/how-to-accept-payments-with-golang/42878363#42878363", "title": "How to accept payments with golang?", "body": "<p>Like some of the comments have mentioned, I also suggest choosing a preferred payment system and then using a Go client library which interfaces with that payment system's REST API.</p>\n\n<p>Here are a few payment libraries: <a href=\"https://golanglibs.com/top?q=payment\" rel=\"noreferrer\">https://golanglibs.com/top?q=payment</a>\nMost of these include example files or examples in the readme. Many Go packages also use GoDoc for documentation.</p>\n\n<p>The most popular one on the list there is <a href=\"https://github.com/logpacker/PayPal-Go-SDK\" rel=\"noreferrer\">PayPal-Go-SDK</a> which is a Go client for the PayPal REST API. \nIt includes an example file: <a href=\"https://github.com/logpacker/PayPal-Go-SDK/blob/master/example_test.go\" rel=\"noreferrer\">https://github.com/logpacker/PayPal-Go-SDK/blob/master/example_test.go</a></p>\n\n<p>It has GoDoc documentation: <a href=\"https://godoc.org/github.com/logpacker/PayPal-Go-SDK\" rel=\"noreferrer\">https://godoc.org/github.com/logpacker/PayPal-Go-SDK</a></p>\n\n<p>If you prefer to use a different payment service like Stripe, they have a similar client: <a href=\"https://github.com/stripe/stripe-go\" rel=\"noreferrer\">https://github.com/stripe/stripe-go</a></p>\n\n<p>They also have usage examples: <a href=\"https://github.com/stripe/stripe-go#usage\" rel=\"noreferrer\">https://github.com/stripe/stripe-go#usage</a></p>\n\n<p>They also have documentation: <a href=\"https://godoc.org/github.com/stripe/stripe-go\" rel=\"noreferrer\">https://godoc.org/github.com/stripe/stripe-go</a></p>\n"}], "owner": {"reputation": 49, "user_id": 6271067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/545455343a235bb780f89d1afbdf0b7d?s=128&d=identicon&r=PG&f=1", "display_name": "lyger", "link": "https://stackoverflow.com/users/6271067/lyger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4985, "favorite_count": 1, "closed_date": 1489891153, "accepted_answer_id": 42878363, "answer_count": 1, "score": 2, "last_activity_date": 1489862328, "creation_date": 1489858173, "question_id": 42877566, "link": "https://stackoverflow.com/questions/42877566/how-to-accept-payments-with-golang", "closed_reason": "Not suitable for this site", "title": "How to accept payments with golang?", "body": "<p>I'm making a back-end for my app using Golang the app is for android,ios and windows and i'm trying to find a way to accept payments.<br>\nIs there a package that I can use with examples? </p>\n"}, {"tags": ["go", "memory-management", "channel"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1489853908, "post_id": 42876720, "comment_id": 72857404, "body": "Don&#39;t call your receiver <code>this</code>.  Give it a meaningful name. The first letter of the type is common, so <code>m</code> in your case."}], "answers": [{"comments": [{"owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "edited": false, "score": 0, "creation_date": 1489854188, "post_id": 42876780, "comment_id": 72857508, "body": "Thank you so much @Cerise"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1489853847, "creation_date": 1489853847, "answer_id": 42876780, "question_id": 42876720, "link": "https://stackoverflow.com/questions/42876720/make-buffered-channel-after-channel-variable-initialisation/42876780#42876780", "title": "Make buffered channel after channel variable initialisation", "body": "<p>Do this:</p>\n\n<pre><code>type message struct {\n   queue chan string\n}\n\nfunc (m *message) init() {\n    m.queue = make(chan string, 10)\n}\n</code></pre>\n\n<p>There's no need to take the address of the channel in this scenario.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1489854064, "creation_date": 1489854064, "answer_id": 42876811, "question_id": 42876720, "link": "https://stackoverflow.com/questions/42876720/make-buffered-channel-after-channel-variable-initialisation/42876811#42876811", "title": "Make buffered channel after channel variable initialisation", "body": "<p>The same way:</p>\n\n<pre><code>type message struct {\n    queue chan string\n}\n\nfunc (m *message) init() {\n    m.queue = make(chan string, 10)\n}\n</code></pre>\n\n<p>But you seem to be a bit confused about what a channel is.  <code>*chan string</code> is a valid construct in Go, but usually unnecessary.  Just use a normal <code>chan string</code>--no need for a pointer.</p>\n\n<blockquote>\n  <p>// or will it be<br>\n  //queue []chan string</p>\n</blockquote>\n\n<p>This would be an array of channels, which is also valid, but not what you want in this case.</p>\n\n<p>A channel is not an array. It's more like a stream (as you might get when you read a file, or a network connection). But don't take that analogy too far, either. </p>\n"}], "owner": {"reputation": 747, "user_id": 5539547, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/z3y7F.jpg?s=128&g=1", "display_name": "Tahseen", "link": "https://stackoverflow.com/users/5539547/tahseen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "accepted_answer_id": 42876780, "answer_count": 2, "score": 0, "last_activity_date": 1489863641, "creation_date": 1489853517, "last_edit_date": 1489863641, "question_id": 42876720, "link": "https://stackoverflow.com/questions/42876720/make-buffered-channel-after-channel-variable-initialisation", "title": "Make buffered channel after channel variable initialisation", "body": "<p>I can initialise a buffered string channel like this</p>\n\n<pre><code>queue := make(chan string, 10)\n</code></pre>\n\n<p>But how to initialise a buffered channel in a struct in Go ? Basically I want to allocate memory to a buffered string channel. But initially in the struct I would just define it and in struct initialisation, I would like to allocate memory to it</p>\n\n<pre><code>type message struct {\n\n  queue *chan string\n// or will it be \n//queue []chan string\n\n}\n\nfunc (this *message) init() {\n\n  queue = make(chan string,10)\n\n  this.queue = &amp;queue\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 0, "last_activity_date": 1489853507, "creation_date": 1489853507, "answer_id": 42876715, "question_id": 42876621, "link": "https://stackoverflow.com/questions/42876621/hour-out-of-range-on-time-parse-in-golang/42876715#42876715", "title": "Hour out of range on time.parse in golang", "body": "<p>Your format needs to use a very specific date and time, see the docs:</p>\n\n<p><a href=\"https://golang.org/pkg/time/#example_Parse\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#example_Parse</a></p>\n\n<blockquote>\n  <p>Parse parses a formatted string and returns the time value it\n  represents. The layout defines the format by showing how the reference\n  time, defined to be</p>\n  \n  <p>Mon Jan 2 15:04:05 -0700 MST 2006</p>\n</blockquote>\n\n<p>So you need <a href=\"https://play.golang.org/p/c_Xc_R2OHb\" rel=\"nofollow noreferrer\">https://play.golang.org/p/c_Xc_R2OHb</a></p>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 2, "last_activity_date": 1541172434, "creation_date": 1541172434, "answer_id": 53121455, "question_id": 42876621, "link": "https://stackoverflow.com/questions/42876621/hour-out-of-range-on-time-parse-in-golang/53121455#53121455", "title": "Hour out of range on time.parse in golang", "body": "<p>Based on your shared code, you should change the layout to <code>01/02/2006 03:04 AM</code> to fix it:</p>\n\n<p>Note: \nIf you have 24 hours format, you should change the hour part in layout to <code>15 instead of 03</code> and also to get rid of <code>AM</code> part e.g. <code>01/02/2006 15:04</code> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    layout := \"01/02/2006 03:04 AM\"\n    if t, err := time.Parse(layout, \"01/31/2000 12:59 AM\"); err == nil {\n        fmt.Println(\"Time decoded:\", t)\n    } else {\n        fmt.Println(\"Failed to decode time:\", err)\n    }\n}\n</code></pre>\n\n<p>Here is a good <a href=\"https://yourbasic.org/golang/format-parse-string-time-date-example/\" rel=\"nofollow noreferrer\">article</a> that would help you to understand different layouts.</p>\n"}], "owner": {"reputation": 437, "user_id": 686334, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bd88dca6931036c734fdfc34535277aa?s=128&d=identicon&r=PG", "display_name": "CrabbyPete", "link": "https://stackoverflow.com/users/686334/crabbypete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2763, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1590319056, "creation_date": 1489853079, "last_edit_date": 1489853834, "question_id": 42876621, "link": "https://stackoverflow.com/questions/42876621/hour-out-of-range-on-time-parse-in-golang", "title": "Hour out of range on time.parse in golang", "body": "<p>I am trying to parse a date time string in go. I pass the exact string as the format and get and error parsing time \"01/31/2000 12:59 AM\": hour out of range.\nI am getting that string from an input. How can I make this work?</p>\n\n<p>Here is the code (<a href=\"https://play.golang.org/p/Kg9KfFpU2z\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Kg9KfFpU2z</a>)</p>\n\n<pre><code>func main() {\n    layout := \"01/31/2000 12:59 AM\"\n    if t, err := time.Parse(layout, \"01/31/2000 12:59 AM\"); err == nil {\n        fmt.Println(\"Time decoded:\", t)\n    } else {\n        fmt.Println(\"Failed to decode time:\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["parsing", "go", "yaml"], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 2864464, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c606da71fcfa488180a8d81c8fdcc7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kohler", "link": "https://stackoverflow.com/users/2864464/alexander-kohler"}, "is_accepted": true, "score": 3, "last_activity_date": 1489839157, "last_edit_date": 1489839157, "creation_date": 1489838960, "answer_id": 42874226, "question_id": 42874174, "link": "https://stackoverflow.com/questions/42874174/golang-yaml-v2-struct-with-a-mapstringstring-unmarshalling-fails/42874226#42874226", "title": "Golang yaml.v2 struct with a map[string]string unmarshalling fails", "body": "<p>Remove the space in your struct tag:</p>\n\n<pre><code>type sizesByType struct {\n    Map map[string]string `yaml:\"Sizes\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1362, "favorite_count": 0, "accepted_answer_id": 42874226, "answer_count": 1, "score": 3, "last_activity_date": 1489852653, "creation_date": 1489838615, "last_edit_date": 1489852653, "question_id": 42874174, "link": "https://stackoverflow.com/questions/42874174/golang-yaml-v2-struct-with-a-mapstringstring-unmarshalling-fails", "title": "Golang yaml.v2 struct with a map[string]string unmarshalling fails", "body": "<p>Im am using the gopkg.in/yaml.v2 package and I'm trying to unmarshal a yaml file like this: </p>\n\n<pre><code>Sizes: \n  A: small\n  B: small\n  C: medium\n</code></pre>\n\n<p>I created a go struct like this: </p>\n\n<pre><code>type sizesByType struct {\n    Map map[string]string `yaml: \"Sizes\"`\n}\n</code></pre>\n\n<p>but unmarshaling it with yaml.v2 gives me an empty map. </p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["multithreading", "go", "system-calls", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1489840608, "post_id": 42873082, "comment_id": 72853231, "body": "Related: <a href=\"http://stackoverflow.com/questions/39245660/number-of-threads-used-by-go-runtime/39246575#39246575\">Number of threads used by Go runtime</a>."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1489840927, "post_id": 42873082, "comment_id": 72853309, "body": "Also asked and being discussed <a href=\"https://groups.google.com/d/topic/golang-nuts/NXMTsgZ_In8/discussion\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 178442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377cef4245e0fcbf76e021d9cd253e35?s=128&d=identicon&r=PG", "display_name": "Colin Stewart", "link": "https://stackoverflow.com/users/178442/colin-stewart"}, "is_accepted": false, "score": 4, "last_activity_date": 1489834189, "creation_date": 1489834189, "answer_id": 42873366, "question_id": 42873082, "link": "https://stackoverflow.com/questions/42873082/does-it-make-sense-to-make-expensive-syscalls-from-different-goroutines/42873366#42873366", "title": "Does it make sense to make expensive syscalls from different goroutines?", "body": "<p>If a syscall blocks, the Go runtime will launch a new thread so that the number of threads available\u200b to run goroutines remains the same.</p>\n\n<p>A fuller explanation can be found here: <a href=\"https://morsmachine.dk/go-scheduler\" rel=\"nofollow noreferrer\">https://morsmachine.dk/go-scheduler</a></p>\n"}], "owner": {"reputation": 4530, "user_id": 2361497, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ce788c4eb1189394cfe46a6e40a4dd11?s=128&d=identicon&r=PG", "display_name": "Vitaly Isaev", "link": "https://stackoverflow.com/users/2361497/vitaly-isaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1489852687, "creation_date": 1489832386, "last_edit_date": 1489852687, "question_id": 42873082, "link": "https://stackoverflow.com/questions/42873082/does-it-make-sense-to-make-expensive-syscalls-from-different-goroutines", "title": "Does it make sense to make expensive syscalls from different goroutines?", "body": "<p>If application does some heavy lifting with multiple file descriptors (e.g., opening - writing data - syncing - closing), what actually happens to Go runtime? Does it block all the goroutines at the time when expensive syscall occures (like <code>syscall.Fsync</code>)? Or only the calling goroutine is blocked while the others are still operating?</p>\n\n<p>So does it make sense to write programs with multiple workers that do a lot of user space - kernel space context switching? Does it make sense to use multithreading patterns for disk input?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"sync\"\n)\n\nvar data = []byte(\"some big data\")\n\nfunc worker(filenamechan chan string, wg *sync.waitgroup) {\n    defer wg.done()\n    for {\n        filename, ok := &lt;-filenamechan\n        if !ok {\n            return\n        }\n\n        // open file is a quite expensive operation due to\n        // the opening new descriptor\n        f, err := os.openfile(filename, os.o_create|os.o_wronly, os.filemode(0644))\n        if err != nil {\n            log.fatal(err)\n            continue\n        }\n\n        // write is a cheap operation,\n        // because it just moves data from user space to the kernel space\n        if _, err := f.write(data); err != nil {\n            log.fatal(err)\n            continue\n        }\n\n        // syscall.fsync is a disk-bound expensive operation\n        if err := f.sync(); err != nil {\n            log.fatal(err)\n            continue\n        }\n\n        if err := f.close(); err != nil {\n            log.fatal(err)\n        }\n    }\n}\n\nfunc main() {\n\n    // launch workers\n    filenamechan := make(chan string)\n    wg := &amp;sync.waitgroup{}\n    for i := 0; i &lt; 2; i++ {\n        wg.add(1)\n        go worker(filenamechan, wg)\n    }\n\n    // send tasks to workers\n    filenames := []string{\n        \"1.txt\",\n        \"2.txt\",\n        \"3.txt\",\n        \"4.txt\",\n        \"5.txt\",\n    }\n    for i := range filenames {\n        filenamechan &lt;- filenames[i]\n    }\n    close(filenamechan)\n\n    wg.wait()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/O0omcPBMAJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/O0omcPBMAJ</a></p>\n"}, {"tags": ["go", "middleware", "go-alice"], "answers": [{"tags": [], "owner": {"reputation": 3055, "user_id": 3528562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356446110eb2675dfd9190c0e8e69ace?s=128&d=identicon&r=PG&f=1", "display_name": "Zoyd", "link": "https://stackoverflow.com/users/3528562/zoyd"}, "is_accepted": false, "score": 0, "last_activity_date": 1489831250, "last_edit_date": 1489831250, "creation_date": 1489830637, "answer_id": 42872818, "question_id": 42871194, "link": "https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers/42872818#42872818", "title": "How can I combine Go middleware pattern with error returning request handlers?", "body": "<p>The output of a middleware, by definition, is an HTTP response. If an error occurred, either it prevents the request from being fulfilled, in which case the middleware should return an HTTP error (500 if something unexpectedly went wrong on the server), or it does not, in which case whatever happened should be logged so that it can be fixed by a system administrator, and the execution should continue.</p>\n\n<p>If you want to achieve this by allowing your functions to panic (although I would not recommend doing this intentionally), catching this situation and handling it later without crashing the server, there is an example in <a href=\"https://www.nicolasmerouze.com/middlewares-golang-best-practices-examples/\" rel=\"nofollow noreferrer\">this blog post</a> in section <strong>Panic Recovery</strong> (it even uses Alice).</p>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1489853079, "last_edit_date": 1489853079, "creation_date": 1489832138, "answer_id": 42873036, "question_id": 42871194, "link": "https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers/42873036#42873036", "title": "How can I combine Go middleware pattern with error returning request handlers?", "body": "<p>From what I understand you wanted to chain your <code>errorHandler</code> function and and combine them in your <code>loggingHandler</code>.</p>\n\n<p>One way to do this is using a <code>struct</code> passing it to your <code>loggingHandler</code> as parameter like this : </p>\n\n<pre><code>func loggingHandler(errorHandler ErrorHandler, next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Call your error handler to do thing\n        err := errorHandler.ServeHTTP()\n        if err != nil {\n            log.Panic(err)\n        }\n\n        // next you can do what you want if error is nil.\n        log.Printf(\"Strated %s %s\", r.Method, r.URL.Path)\n        next.ServeHTTP(w, r)\n        // After executing the handler.\n        log.Printf(\"Completed %s in %v\", r.URL.Path, time.Since(start))\n    })\n}\n\n// create the struct that has error handler\ntype ErrorHandler struct {\n}\n\n// I return nil for the sake of example.\nfunc (e ErrorHandler) ServeHTTP() error {\n    return nil\n}\n</code></pre>\n\n<p>and in the <code>main</code> you call it like this : </p>\n\n<pre><code>func main() {\n    port := \"8080\"\n    // you can pass any field to the struct. right now it is empty.\n    errorHandler := ErrorHandler{}\n\n    // and pass the struct to your loggingHandler.\n    http.Handle(\"/\", loggingHandler(errorHandler, http.HandlerFunc(index)))\n\n\n    log.Println(\"App started on port = \", port)\n    err := http.ListenAndServe(\":\"+port, nil)\n    if err != nil {\n        log.Panic(\"App Failed to start on = \", port, \" Error : \", err.Error())\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 5, "last_activity_date": 1489852195, "last_edit_date": 1489852195, "creation_date": 1489851439, "answer_id": 42876307, "question_id": 42871194, "link": "https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers/42876307#42876307", "title": "How can I combine Go middleware pattern with error returning request handlers?", "body": "<p>I like this pattern of HandlerFuncs returning errors too, it's much neater and you just write your error handler once. Just think of your middleware separately from the handlers it contains, you don't need the middleware to pass errors. The middleware is like a chain which executes each one in turn, and then the very last middleware is one which is aware of your handler signature, and deals with the error appropriately. </p>\n\n<p>So in it's simplest form, keep the middleware you have exactly the same, but at the end insert one which is of this form (and doesn't execute another middleware but a special HandlerFunc):</p>\n\n<pre><code>// Use this special type for your handler funcs\ntype MyHandlerFunc func(w http.ResponseWriter, r *http.Request) error\n\n\n// Pattern for endpoint on middleware chain, not takes a diff signature.\nfunc errorHandler(h MyHandlerFunc) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n       // Execute the final handler, and deal with errors\n        err := h(w, r)\n        if err != nil {\n            // Deal with error here, show user error template, log etc\n        }\n    })\n}\n</code></pre>\n\n<p>...</p>\n\n<p>Then wrap your function like this:</p>\n\n<pre><code>moreMiddleware(myMiddleWare(errorHandler(myhandleFuncReturningError)))\n</code></pre>\n\n<p>That means this special error middleware can only ever wrap your special function signature, and come at the end of the chain, but that's fine. Also I'd consider wrapping this behaviour in your own mux to make it a little simpler and avoid passing error handlers around, and let you build a chain of middleware more easily without having ugly wrapping in your route setup.</p>\n\n<p>I think if you're using a router library, it needs explicit support for this pattern to work probably. You can see an example of this in action in a modified form in this router, which uses exactly the signatures you're after, but handles building a middleware chain and executing it without manual wrapping:</p>\n\n<p><a href=\"https://github.com/fragmenta/mux/blob/master/mux.go\" rel=\"noreferrer\">https://github.com/fragmenta/mux/blob/master/mux.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 686, "user_id": 10704601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71cae95e22c4d58d290e0e15057ed70b?s=128&d=identicon&r=PG&f=1", "display_name": "emmbee", "link": "https://stackoverflow.com/users/10704601/emmbee"}, "is_accepted": false, "score": 0, "last_activity_date": 1609379238, "creation_date": 1609379238, "answer_id": 65515707, "question_id": 42871194, "link": "https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers/65515707#65515707", "title": "How can I combine Go middleware pattern with error returning request handlers?", "body": "<p>The most flexible solution would be like this:</p>\n<p>First define a type that matches your handler signature and implement <code>ServeHTTP</code> to satisfy the <a href=\"https://golang.org/pkg/net/http/#Handler\" rel=\"nofollow noreferrer\">http.Handler</a> interface. By doing so, <code>ServeHTTP</code> will be able to call the handler function and process the error if it fails. Something like:</p>\n<pre><code>type httpHandlerWithError func(http.ResponseWriter, *http.Request) error\n\nfunc (fn httpHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    if err := fn(w, r); err != nil {\n         http.Error(w, err.Message, err.StatusCode)\n    }\n}\n</code></pre>\n<p>Now create the middleware as usual. The middleware should create a function which returns an error if it fails or calls the next in the chain on success. Then convert the function to the defined type something like:</p>\n<pre><code>func AuthMiddleware(next http.Handler) http.Handler {\n\n    // create handler which returns error\n    fn := func(w http.ResponseWriter, r *http.Request) error {\n\n        //a custom error value\n        unauthorizedError := &amp;httpError{Code: http.StatusUnauthorized, Message: http.StatusText(http.StatusUnauthorized)}\n\n        auth := r.Header.Get(&quot;authorization&quot;)\n        creds := credentialsFromHeader(auth)\n\n        if creds != nil {\n            return unauthorizedError\n        }\n\n        user, err := db.ReadUser(creds.username)\n        if err != nil {\n            return &amp;httpError{Code: http.StatusInternalServerError, Message: http.StatusText(http.StatusInternalServerError)}\n        }\n\n        err = checkPassword(creds.password+user.Salt, user.Hash)\n        if err != nil {\n            return unauthorizedError\n        }\n\n        ctx := r.Context()\n        userCtx := UserToCtx(ctx, user)\n\n        // we got here so there was no error\n        next.ServeHTTP(w, r.WithContext(userCtx))\n        return nil\n    }\n\n    // convert function\n    return httpHandlerWithError(fn)\n}\n</code></pre>\n<p>Now you can use the middleware as you would use any <em>regular</em> middleware.</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4497, "favorite_count": 2, "accepted_answer_id": 42876307, "answer_count": 4, "score": 8, "last_activity_date": 1609379238, "creation_date": 1489817867, "last_edit_date": 1489855760, "question_id": 42871194, "link": "https://stackoverflow.com/questions/42871194/how-can-i-combine-go-middleware-pattern-with-error-returning-request-handlers", "title": "How can I combine Go middleware pattern with error returning request handlers?", "body": "<p>I am familiar with the Go middleware pattern like this:</p>\n\n<pre><code>// Pattern for writing HTTP middleware.\nfunc middlewareHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Our middleware logic goes here before executing application handler.\n        next.ServeHTTP(w, r)\n        // Our middleware logic goes here after executing application handler.\n    })\n}\n</code></pre>\n\n<p>So for example if I had a loggingHandler:</p>\n\n<pre><code>func loggingHandler(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // Before executing the handler.\n        start := time.Now()\n        log.Printf(\"Strated %s %s\", r.Method, r.URL.Path)\n        next.ServeHTTP(w, r)\n        // After executing the handler.\n        log.Printf(\"Completed %s in %v\", r.URL.Path, time.Since(start))\n    })\n}\n</code></pre>\n\n<p>And a simple handleFunc:</p>\n\n<pre><code>func handleFunc(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(`Hello World!`))\n}\n</code></pre>\n\n<p>I could combine them like this:</p>\n\n<pre><code>http.Handle(\"/\", loggingHandler(http.HandlerFunc(handleFunc)))\nlog.Fatal(http.ListenAndServe(\":8080\", nil))\n</code></pre>\n\n<p>That is all fine.</p>\n\n<p>But I like the idea of Handlers being able to return errors like normal functions do. This makes error handling much easier as I can just return an error if there is an error, or just return nil at the end of the function.</p>\n\n<p>I have done it like this:</p>\n\n<pre><code>type errorHandler func(http.ResponseWriter, *http.Request) error\n\nfunc (f errorHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    err := f(w, r)\n    if err != nil {\n        // log.Println(err)\n        fmt.Println(err)\n        os.Exit(1)\n    }\n}\n\nfunc errorHandle(w http.ResponseWriter, r *http.Request) error {\n    w.Write([]byte(`Hello World from errorHandle!`))\n    return nil\n}\n</code></pre>\n\n<p>And then use it by wrapping it like this:</p>\n\n<pre><code>http.Handle(\"/\", errorHandler(errorHandle))\n</code></pre>\n\n<p>I can make these two patterns work separately, but I don't know how I could combine them. I like that I am able to chain middlewares with a library like Alice. But it would be nice if they could return errors too. Is there a way for me to achieve this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 1, "creation_date": 1489812537, "post_id": 42870507, "comment_id": 72846829, "body": "Have a look at the bottom of the context interface <a href=\"https://golang.org/pkg/context/#Context\" rel=\"nofollow noreferrer\">documentation</a>. The short answer is: use <a href=\"https://golang.org/pkg/context/#WithValue\" rel=\"nofollow noreferrer\">WithValue</a> to add a value to a context."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1489813162, "post_id": 42870507, "comment_id": 72846913, "body": "WithValue takes in a context as parameter, and returns a context. I don&#39;t understand how to use it. It is not as simple as the gorilla context package where you just set and get."}, {"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 0, "creation_date": 1489848190, "post_id": 42870507, "comment_id": 72855567, "body": "When you use WithValue, you&#39;re creating a new context with your current context as the parent. This way each layer of middleware can add context that is visible to it and to any subsequent layers. <a href=\"https://golang.org/pkg/context/#Background\" rel=\"nofollow noreferrer\">context.Background</a> can be used as your top-level context."}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1489815308, "post_id": 42870767, "comment_id": 72847261, "body": "@Alex, <a href=\"https://dave.cheney.net/2017/01/26/context-is-for-cancelation\" rel=\"nofollow noreferrer\">see also</a>."}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1489816680, "post_id": 42870767, "comment_id": 72847479, "body": "Thanks! The article: &quot;Pitfalls of context values and how to avoid or mitigate them in Go&quot; that you suggested had code snippet that made me understand it now. Thank you so much!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "edited": false, "score": 0, "creation_date": 1489817031, "post_id": 42870767, "comment_id": 72847538, "body": "@Alex Great. I have included the relevant code snippet in the answer"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 2, "last_activity_date": 1489817013, "last_edit_date": 1592644375, "creation_date": 1489814150, "answer_id": 42870767, "question_id": 42870507, "link": "https://stackoverflow.com/questions/42870507/how-can-i-use-the-new-context-package-from-go-like-i-would-use-gorilla-context-l/42870767#42870767", "title": "How can I use the new context package from Go like I would use gorilla context library?", "body": "<p>See &quot;<a href=\"https://medium.com/@ambot/exploring-the-context-package-db30a818d563#.1mczb58pf\" rel=\"nofollow noreferrer\">Exploring the context package</a>&quot;, using <a href=\"https://golang.org/pkg/context/#WithValue\" rel=\"nofollow noreferrer\"><code>WithValue</code></a> and the context associated to the Request:</p>\n<blockquote>\n<h2>Middleware</h2>\n<p>Middleware in Go refers to an http handler which wraps around a multiplexer. There are several 3rd party middleware solutions (such as negroni), but really the standard library supports a very similar pattern. The use of a Context in the request allows us to hold data in the request.</p>\n<p>See the example code for <a href=\"https://github.com/laher/context-example/blob/master/main.go#L49\" rel=\"nofollow noreferrer\">invocation</a> and <a href=\"https://github.com/laher/context-example/blob/eaf242039e9825ad8b4d379d4baf4df5eba21b35/main.go#L134-L145\" rel=\"nofollow noreferrer\">definition</a>.</p>\n</blockquote>\n<pre><code>func putClientIPIntoContext(r *http.Request) context.Context {\n    ci := r.RemoteAddr\n    fwd := r.Header.Get(&quot;X-Forwarded-For&quot;)\n    if fwd != &quot;&quot; {\n        ci = fwd\n    }\n    ctx := context.WithValue(r.Context(), ClientIPKey, ci)\n    return ctx\n}\n</code></pre>\n<blockquote>\n<p>The Context can store request-scoped variables.<br />\nIt\u2019s useful when writing \u2018middleware\u2019, but it\u2019s a little bit \u2018anti-pattern\u2019\u200a\u2014\u200ait\u2019s a bit magical, because it\u2019s not type-safe.</p>\n</blockquote>\n<p>See more at &quot;<a href=\"https://www.calhoun.io/pitfalls-of-context-values-and-how-to-avoid-or-mitigate-them/\" rel=\"nofollow noreferrer\">Pitfalls of context values and how to avoid or mitigate them in Go</a>&quot;.</p>\n<blockquote>\n<p><a href=\"https://gist.github.com/joncalhoun/ebf07cb652a91af6b481afc912ab8bff\" rel=\"nofollow noreferrer\">The example below</a> only shows how you might use the authentication logic from above to verify that when a user is logged in when visiting any page with a path prefix of <code>/dashboard/</code>.<br />\nA similar approach could be used to verify that a user is an admin before allowing them access to any page with a path prefix of <code>/admin/</code>.</p>\n</blockquote>\n<pre><code>func requireUser(next http.Handler) http.Handler {  \n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    user := lookupUser(r)\n    if user == nil {\n      // No user so redirect to login\n      http.Redirect(w, r, &quot;/login&quot;, http.StatusFound)\n      return\n    }\n    ctx := context.WithValue(r.Context(), &quot;user&quot;, user)\n    next.ServeHTTP(w, r.WithContext(ctx))\n  })\n}\n\nfunc main() {  \n  dashboard := http.NewServeMux()\n  dashboard.HandleFunc(&quot;/dashboard/hi&quot;, printHi)\n  dashboard.HandleFunc(&quot;/dashboard/bye&quot;, printBye)\n\n  mux := http.NewServeMux()\n  // ALL routes that start with /dashboard/ require that a \n  // user is authenticated using the requireUser middleware\n  mux.Handle(&quot;/dashboard/&quot;, requireUser(dashboard))\n  mux.HandleFunc(&quot;/&quot;, home)\n\n  http.ListenAndServe(&quot;:3000&quot;, addRequestID(mux))\n}\n</code></pre>\n<p>As <a href=\"https://stackoverflow.com/users/720999/kostix\">kostix</a> comments, use Context wisely, like <a href=\"https://dave.cheney.net/about\" rel=\"nofollow noreferrer\">Dave Cheney</a> suggest in &quot;<a href=\"https://dave.cheney.net/2017/01/26/context-is-for-cancelation\" rel=\"nofollow noreferrer\"><code>Context</code> is for cancelation</a>&quot;</p>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 3, "accepted_answer_id": 42870767, "answer_count": 1, "score": 2, "last_activity_date": 1489817013, "creation_date": 1489811834, "question_id": 42870507, "link": "https://stackoverflow.com/questions/42870507/how-can-i-use-the-new-context-package-from-go-like-i-would-use-gorilla-context-l", "title": "How can I use the new context package from Go like I would use gorilla context library?", "body": "<p>Go has come with a new package called context and with recent versions (Go 1.7 I think) we should be able to use it in the same way as gorilla/context package:</p>\n\n<p><a href=\"http://www.gorillatoolkit.org/pkg/context\" rel=\"nofollow noreferrer\">http://www.gorillatoolkit.org/pkg/context</a></p>\n\n<p>With gorilla context you can very easily set and get variables that are relevant to a request, it's handlers, and middlewares.</p>\n\n<p>To set a value in gorilla context is really easy:</p>\n\n<pre><code>func handleFunc(w http.ResponseWriter, r *http.Request) {\n    context.Set(r, \"foo\", \"bar\")\n}\n</code></pre>\n\n<p>To get the value we can do:</p>\n\n<pre><code>func handleFunc(w http.ResponseWriter, r *http.Request) {\n    val := context.Get(r, \"foo\")\n}\n</code></pre>\n\n<p>I understand that we can use this in middlewares so that the next middleware can use variables that were set in previous middleware. I would like to be able to do this with Go context package.</p>\n\n<p>I understand that to get a value is quite simple like this:</p>\n\n<pre><code>func handleFunc(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(r.Context().Value(\"foo\"))\n}\n</code></pre>\n\n<p>But I have no idea how to set the value. It was not very intuitive for me and I don't really understand how to do it.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "is_accepted": true, "score": 1, "last_activity_date": 1489812977, "creation_date": 1489812977, "answer_id": 42870632, "question_id": 42870351, "link": "https://stackoverflow.com/questions/42870351/is-it-possible-to-use-the-appengine-datastore-package-on-the-gae-flex-environmen/42870632#42870632", "title": "Is it possible to use the appengine/datastore package on the GAE flex environment?", "body": "<p>You need to migrate to cloud.google.com/go/datastore.</p>\n\n<p>From <a href=\"https://cloud.google.com/appengine/docs/flexible/go/migrating\" rel=\"nofollow noreferrer\">Migrating Services from the Standard Environment to the Flexible Environment</a>:</p>\n\n<blockquote>\n  <p>The App Engine flexible environment does not provide the API libraries\n  present in the App Engine SDK. If you <a href=\"https://cloud.google.com/appengine/docs/flexible/go/flexible-for-standard-users\" rel=\"nofollow noreferrer\">decide to migrate your\n  application from the App Engine standard environment to the flexible\n  environment</a>, you must update your code to use services and APIs\n  that are available across all Google Cloud Platform environments.</p>\n</blockquote>\n\n<p>And from <a href=\"https://cloud.google.com/appengine/docs/flexible/go/migrating#datastore\" rel=\"nofollow noreferrer\">Cloud Datastore</a>:</p>\n\n<blockquote>\n  <p>You can access <a href=\"https://cloud.google.com/datastore/docs\" rel=\"nofollow noreferrer\">Google Cloud Datastore</a> from anywhere using the\n  Cloud Datastore API. Use the <a href=\"https://cloud.google.com/sdk/cloud-client-libraries\" rel=\"nofollow noreferrer\">Google Cloud client libraries</a> to\n  store and retrieve data from Cloud Datastore.</p>\n  \n  <p>The same Cloud Datastore data is available regardless of if you use\n  the App Engine libraries, the Google Cloud client libraries, or call\n  the API directly.</p>\n  \n  <p>At this time ORM libraries that available in the standard environment\n  such as <a href=\"https://cloud.google.com/appengine/docs/standard/python/ndb/\" rel=\"nofollow noreferrer\">ndb</a> and <a href=\"https://cloud.google.com/appengine/docs/standard/java/gettingstarted/using-datastore-objectify\" rel=\"nofollow noreferrer\">Objectify</a> are not supported outside of the\n  standard environment.</p>\n  \n  <p>For more information, see the following guide:</p>\n  \n  <ul>\n  <li><a href=\"https://cloud.google.com/appengine/docs/flexible/go/using-cloud-datastore\" rel=\"nofollow noreferrer\">Using Cloud Datastore</a></li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 1, "accepted_answer_id": 42870632, "answer_count": 1, "score": 1, "last_activity_date": 1489812977, "creation_date": 1489810161, "question_id": 42870351, "link": "https://stackoverflow.com/questions/42870351/is-it-possible-to-use-the-appengine-datastore-package-on-the-gae-flex-environmen", "title": "Is it possible to use the appengine/datastore package on the GAE flex environment?", "body": "<p>There are two different datastore packages for Google App Engine:\n<a href=\"https://godoc.org/google.golang.org/appengine/datastore\" rel=\"nofollow noreferrer\">google.golang.org/appengine/datastore</a> and <a href=\"https://godoc.org/cloud.google.com/go/datastore\" rel=\"nofollow noreferrer\">cloud.google.com/go/datastore</a>.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference\" rel=\"nofollow noreferrer\">The documentation</a> for the appengine/datastore package uses the standard environment while <a href=\"https://cloud.google.com/appengine/docs/flexible/go/using-cloud-datastore\" rel=\"nofollow noreferrer\">the documentation</a> for the cloud package uses the flex environment. </p>\n\n<p>I have a Go application which uses the appengine/datastore package on the standard GAE environment. If I want to migrate this application from the standard environment to the flex environment do I need to switch to the cloud.google.com/go/datastore package, or can I continue using the appengine/datastore package? If not, why not?</p>\n"}, {"tags": ["arrays", "url", "go"], "comments": [{"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1489810257, "post_id": 42870319, "comment_id": 72846469, "body": "can you put status value to like this one instead? like <code>site.com?&amp;status=1,2,3</code>?"}, {"owner": {"reputation": 1475, "user_id": 1700554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/532ea0cb7878aad540d6fb3bf749d605?s=128&d=identicon&r=PG", "display_name": "Jeremy John", "link": "https://stackoverflow.com/users/1700554/jeremy-john"}, "reply_to_user": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1489810377, "post_id": 42870319, "comment_id": 72846483, "body": "I can&#39;t because my frontend is using a react js package component which convert the selection query to be <code>?status[0]=1&amp;status[1]=2&amp;status[1]=3</code>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 10, "last_activity_date": 1489812834, "last_edit_date": 1489812834, "creation_date": 1489812530, "answer_id": 42870571, "question_id": 42870319, "link": "https://stackoverflow.com/questions/42870319/how-to-get-value-of-array-key-from-query-in-golang/42870571#42870571", "title": "How to get value of array key from query in golang", "body": "<p>One approach is to loop over the possible values and append to a slice as you go:</p>\n\n<pre><code>r.ParseForm()  // parses request body and query and stores result in r.Form\nvar a []string\nfor i := 0; ; i++ {\n    key := fmt.Sprintf(\"status[%d]\", i)\n    values := r.Form[key] // form values are a []string\n    if len(values) == 0 {\n        // no more values\n        break\n    }\n    a = append(a, values[i])\n    i++\n}\n</code></pre>\n\n<p>If you have control over the query string, then use this format:</p>\n\n<pre><code> site.com/?status=1&amp;status=2&amp;status=3&amp;name=John\n</code></pre>\n\n<p>and get status values using:</p>\n\n<pre><code> r.ParseForm()\n a := r.Form[\"status\"]  // a is []string{\"1\", \"2\", \"3\"}\n</code></pre>\n"}], "owner": {"reputation": 1475, "user_id": 1700554, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/532ea0cb7878aad540d6fb3bf749d605?s=128&d=identicon&r=PG", "display_name": "Jeremy John", "link": "https://stackoverflow.com/users/1700554/jeremy-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6466, "favorite_count": 0, "accepted_answer_id": 42870571, "answer_count": 1, "score": 6, "last_activity_date": 1489812834, "creation_date": 1489809809, "question_id": 42870319, "link": "https://stackoverflow.com/questions/42870319/how-to-get-value-of-array-key-from-query-in-golang", "title": "How to get value of array key from query in golang", "body": "<p>I have this query</p>\n\n<pre><code>site.com/?status[0]=1&amp;status[1]=2&amp;status[1]=3&amp;name=John\n</code></pre>\n\n<p>I want to get all the values of <strong>status</strong> key like</p>\n\n<blockquote>\n  <p>1, 2, 3</p>\n</blockquote>\n\n<p>I tried something like this</p>\n\n<pre><code>for _, status:= range r.URL.Query()[\"status\"] {\n    fmt.Println(status)\n}\n</code></pre>\n\n<p>but it only works if the query is without array key: <code>site.com/?status=1&amp;status=2&amp;status=3&amp;name=John</code></p>\n"}, {"tags": ["networking", "go", "dns", "network-programming"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "edited": false, "score": 0, "creation_date": 1489805391, "post_id": 42869766, "comment_id": 72845723, "body": "When you say &quot;your DNS&quot; you mean I must install something like BIND in my server or is an issue related to the domain registration?"}], "tags": [], "owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "is_accepted": false, "score": 1, "last_activity_date": 1489803580, "creation_date": 1489803580, "answer_id": 42869766, "question_id": 42869683, "link": "https://stackoverflow.com/questions/42869683/golang-dns-resolution-not-working/42869766#42869766", "title": "Golang DNS resolution not working", "body": "<p>The problem has nothing to do with your code. Your DNS is not registered properly. When running <code>nslookup</code> I get the following:</p>\n\n<pre><code>$ nslookup n1.crosslogic.com.ar\n\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\n\n$ nslookup n2.crosslogic.com.ar\n\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\nDNS request timed out.\n    timeout was 2 seconds.\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1489803580, "creation_date": 1489802708, "question_id": 42869683, "link": "https://stackoverflow.com/questions/42869683/golang-dns-resolution-not-working", "title": "Golang DNS resolution not working", "body": "<p>I'be been reading a lot but I just can't find a solution.</p>\n\n<p>I opened a VPS in Google Cloud, started an instance with Ubuntu and runned a web server i've written in Go listening in port 80. I also registered a domain in my country www.crosslogic.com.ar which delegated like this:</p>\n\n<pre><code>n1.crosslogic.com.ar    130.211.196.55\nn2.crosslogic.com.ar    130.211.196.55\n</code></pre>\n\n<p>(Two were required but I only had one IP)</p>\n\n<p>When I type the IP in the browser everything everything works fine, but when I try to reach the server using www.crosslogic.com.ar, or crosslogic.com.ar, or n1.crosslogic.com.ar I get ERR_NAME_RESOLUTION_FAILED.</p>\n\n<p>I did this test intodns.com/crosslogic.com.ar to check the folowing errors:</p>\n\n<pre><code>-Missing nameservers reported by your nameservers. You should already know that your NS records at your nameservers are missing, so here it is again:\nns2.crosslogic.com.ar.\nns1.crosslogic.com.ar.\n\n-No valid SOA record came back!\n\n-ERROR: I could not get any A records for www.crosslogic.com.ar!\n(I only do a cache request, if you recently added a WWW A record, it might not show up here.) \n</code></pre>\n\n<p>This is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n)\n\nfunc main() {\n    // Genero un html con los detalles del calculo.\n\n\n    http.HandleFunc(\"/\", indexHandler)\n    err := http.ListenAndServe(\":80\", nil)\n    if err != nil {\n        fmt.Println(err.Error())\n    }\n\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request) {\n\n    temp, err := template.ParseFiles(\"index.html\")\n    if err != nil {\n        panic(err)\n    }\n\n    err = temp.Execute(w, nil)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Am I missing any configuration in Linux? Those NS Records, A records and SOA is something I need to configure in my server? Shoudln't http/net be handling this stuff? Why request don't reach my port 80?</p>\n"}, {"tags": ["gcc", "go", "compilation", "gccgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1489787946, "post_id": 42867659, "comment_id": 72841652, "body": "The <code>go</code> tool is trying to exec something which isn&#39;t there. Try using the <code>-x</code> to see if you can tell what is being called."}, {"owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490025737, "post_id": 42867659, "comment_id": 72916132, "body": "<code>go build -compiler gccgo -gccgoflags &#39;-static&#39; -x helloworld.go WORK=&#47;tmp&#47;go-build267938128</code> <code>mkdir -p $WORK&#47;command-line-arguments&#47;_obj&#47;</code> <code>mkdir -p $WORK&#47;command-line-arguments&#47;_obj&#47;exe&#47;</code> <code>cd &#47;root&#47;tmp</code> <code>&quot;&quot; -I $WORK -c -g -m64 -fgo-relative-import-path=_&#47;root&#47;tmp -o $WORK&#47;command-line-arguments&#47;_obj&#47;_go_.o -static .&#47;helloworld.go go build command-line-arguments: : fork&#47;exec : no such file or directory</code>"}, {"owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1490026155, "post_id": 42867659, "comment_id": 72916427, "body": "Any insight from these? @JimB (thanks and sorry for the poor formatting)"}, {"owner": {"reputation": 235, "user_id": 4017439, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-v6-6SQOeGVI/AAAAAAAAAAI/AAAAAAAAABg/Scha2K5nzuM/photo.jpg?sz=128", "display_name": "Iskander Sharipov", "link": "https://stackoverflow.com/users/4017439/iskander-sharipov"}, "edited": false, "score": 0, "creation_date": 1515666532, "post_id": 42867659, "comment_id": 83390636, "body": "Situation should be improved by now: <a href=\"https://github.com/golang/go/issues/19628\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/19628</a>."}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 7989206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a94601721c8a75b21dbc4f8352d31b?s=128&d=identicon&r=PG&f=1", "display_name": "samsong8610", "link": "https://stackoverflow.com/users/7989206/samsong8610"}, "is_accepted": false, "score": -1, "last_activity_date": 1510678033, "creation_date": 1510678033, "answer_id": 47291063, "question_id": 42867659, "link": "https://stackoverflow.com/questions/42867659/build-go-with-gccgo-fork-exec-no-such-file-or-directory/47291063#47291063", "title": "build Go with gccgo - fork/exec no such file or directory", "body": "<p>You should install gccgo compiler first. On my Fedora 26 desktop, run <code>dnf install gcc-go</code> to install.</p>\n\n<p><code>\n$ which gccgo\n/usr/bin/gccgo\ngo build --compiler gccgo -x\nWORK=/tmp/go-build848309745\nmkdir -p $WORK/_/home/sam/sandbox/go/src/hello/_obj/\nmkdir -p $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/\ncd /home/sam/sandbox/go/src/hello\n/usr/bin/gccgo -I $WORK -c -g -m64 -fgo-relative-import-path=_/home/sam/sandbox/go/src/hello -o $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o ./helloworld.go\nar rc $WORK/_/home/sam/sandbox/go/src/libhello.a $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o\ncd .\n/usr/bin/gccgo -o $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/a.out $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o -Wl,-( -m64 -Wl,--whole-archive -Wl,--no-whole-archive -Wl,-)\ncp $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/a.out hello\n</code></p>\n\n<p>If you need to link static, package glibc-static and libgo-static are required to be installed too. After installed them, compile using gccgo and link statically by </p>\n\n<p><code>\n$ go build -compiler gccgo -x --gccgoflags \"-static\" \nWORK=/tmp/go-build815863722\nmkdir -p $WORK/_/home/sam/sandbox/go/src/hello/_obj/\nmkdir -p $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/\ncd /home/sam/sandbox/go/src/hello\n/usr/bin/gccgo -I $WORK -c -g -m64 -fgo-relative-import-path=_/home/sam/sandbox/go/src/hello -o $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o -static ./helloworld.go\nar rc $WORK/_/home/sam/sandbox/go/src/libhello.a $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o\ncd .\n/usr/bin/gccgo -o $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/a.out $WORK/_/home/sam/sandbox/go/src/hello/_obj/_go_.o -Wl,-( -m64 -Wl,--whole-archive -Wl,--no-whole-archive -Wl,-) -static\ncp $WORK/_/home/sam/sandbox/go/src/hello/_obj/exe/a.out hello\n</code></p>\n"}], "owner": {"reputation": 21, "user_id": 6283163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ef06fe7a801f826f90aa3b0c138121?s=128&d=identicon&r=PG&f=1", "display_name": "chingy", "link": "https://stackoverflow.com/users/6283163/chingy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2622, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1510678033, "creation_date": 1489787661, "question_id": 42867659, "link": "https://stackoverflow.com/questions/42867659/build-go-with-gccgo-fork-exec-no-such-file-or-directory", "title": "build Go with gccgo - fork/exec no such file or directory", "body": "<p>I am trying to run a simple helloworld.go on RHEL 6.8.</p>\n\n<pre><code>% cat helloworld.go \npackage main\nimport \"fmt\"\nfunc main() {\n    fmt.Println(\"hello world\")\n}\n</code></pre>\n\n<p>The GC compiler works ok</p>\n\n<pre><code>%  go build -compiler gccgo helloworld.go \ngo build command-line-arguments: : fork/exec : no such file or directory\n</code></pre>\n\n<p>For some reason, instead, I need to compile with gccgo, but could never get it to compile. Let alone to eventually compile it statically. </p>\n\n<pre><code>% go build -compiler gccgo -gccgoflags '-static' helloworld.go\ngo build command-line-arguments: : fork/exec : no such file or directory\n% go build -compiler gccgo -gccgoflags '-static-libgo' helloworld.go\ngo build command-line-arguments: : fork/exec : no such file or directory\n\n\n% go version \ngo version go1.7 linux/amd64\n% gcc --version\ngcc (GCC) 4.9.2 20150212 (Red Hat 4.9.2-6)\n</code></pre>\n\n<p>Insights on what the problem is would be appreciated?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "is_accepted": false, "score": 2, "last_activity_date": 1489782891, "creation_date": 1489782891, "answer_id": 42866655, "question_id": 42866569, "link": "https://stackoverflow.com/questions/42866569/line-breaks-in-go-understanding-this-example-from-go-tour/42866655#42866655", "title": "Line Breaks in Go - Understanding this example from Go Tour", "body": "<p>Go \"automatically\" adds <code>;</code> as the end of a statement.</p>\n\n<p>So</p>\n\n<pre><code>fmt.Println(\n    pow(3, 2, 10),\n    pow(3, 3, 20),\n)\n</code></pre>\n\n<p>as the same as</p>\n\n<pre><code>fmt.Println(\n    pow(3, 2, 10),\n    pow(3, 3, 20),\n);\n</code></pre>\n\n<p>But </p>\n\n<pre><code>fmt.Println(\n    pow(3, 2, 10),\n    pow(3, 3, 20)\n)\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>fmt.Println(\n    pow(3, 2, 10),\n    pow(3, 3, 20);\n);\n</code></pre>\n\n<p>which is obvioulsy a syntax error.</p>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1489782897, "creation_date": 1489782897, "answer_id": 42866657, "question_id": 42866569, "link": "https://stackoverflow.com/questions/42866569/line-breaks-in-go-understanding-this-example-from-go-tour/42866657#42866657", "title": "Line Breaks in Go - Understanding this example from Go Tour", "body": "<p>There's no significance. Trailing commas are allowed in function calls, although <code>go fmt</code> will remove them.</p>\n"}], "owner": {"reputation": 21, "user_id": 2701243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51422b2966a09f79b383c28dd200ffb6?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2701243/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1489783428, "answer_count": 2, "score": 1, "last_activity_date": 1489782897, "creation_date": 1489782477, "question_id": 42866569, "link": "https://stackoverflow.com/questions/42866569/line-breaks-in-go-understanding-this-example-from-go-tour", "closed_reason": "Duplicate", "title": "Line Breaks in Go - Understanding this example from Go Tour", "body": "<p>I am trying to understand this example from the Go Tour.<br>\nWhat is the significance of this last comma on line 3</p>\n\n<pre><code>fmt.Println(\n    pow(3, 2, 10),\n    pow(3, 3, 20),\n)\n</code></pre>\n\n<p>How do line breaks generally modify the code in go.<br>\nI know, that without the line breaks, I can write this statement as </p>\n\n<pre><code>fmt.Println( pow(3, 2, 10), pow(3, 3, 20) )\n</code></pre>\n\n<p>and it would compile.<br>\nSo, why is the extra comma needed with line breaks</p>\n"}]