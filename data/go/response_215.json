[{"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1550705379, "post_id": 54796848, "comment_id": 96371581, "body": "Just copy the binary to the correct location (like any other install process would do). You can set GOBIN, but if it&#39;s a system-wide path, it probably isn&#39;t world-writable, and you never want to be building software as <code>root</code>."}], "answers": [{"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1550705587, "creation_date": 1550705587, "answer_id": 54796914, "question_id": 54796848, "link": "https://stackoverflow.com/questions/54796848/how-do-you-install-golang-binaries-for-all-users/54796914#54796914", "title": "How do you install golang binaries for all users", "body": "<p>The cleanest way is to use symlinks, so it's obvious where the tool came from e.g.</p>\n\n<blockquote>\n  <p>$ ls -al /usr/local/bin/brew</p>\n  \n  <p>lrwxr-xr-x  1 user  admin  28 Nov 17 18:38 /usr/local/bin/brew ->\n  /usr/local/Homebrew/bin/brew</p>\n</blockquote>\n\n<p>So to make a tool like <a href=\"https://github.com/robertkrimen/godocdown\" rel=\"nofollow noreferrer\">godocdown</a> global to all users:</p>\n\n<blockquote>\n  <p><code>ln -s \"$GOPATH/bin/godocdown\" /usr/local/bin/</code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 3833263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d580fb2544563a80e0feb3296baae0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael B.", "link": "https://stackoverflow.com/users/3833263/michael-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1550713324, "creation_date": 1550713324, "answer_id": 54797950, "question_id": 54796848, "link": "https://stackoverflow.com/questions/54796848/how-do-you-install-golang-binaries-for-all-users/54797950#54797950", "title": "How do you install golang binaries for all users", "body": "<p>There are more environment variables that control how <code>go ...</code> commands work. See: <a href=\"https://golang.org/cmd/go/#hdr-Environment_variables\" rel=\"nofollow noreferrer\">https://golang.org/cmd/go/#hdr-Environment_variables</a>. In this case, you can set <code>GOBIN</code> to your desired install location. Ex:</p>\n\n<pre><code>GOBIN=/path/to/common/binaries go get blah\n</code></pre>\n\n<p>will put the <code>blah</code> binary in <code>/path/to/common/binaries</code>. Note that you'll likely have to run with <code>sudo</code>.</p>\n"}], "owner": {"reputation": 1418, "user_id": 370537, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a98de7866600cb89ab85039918f31768?s=128&d=identicon&r=PG", "display_name": "zoidberg", "link": "https://stackoverflow.com/users/370537/zoidberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 0, "accepted_answer_id": 54797950, "answer_count": 2, "score": 1, "last_activity_date": 1550713324, "creation_date": 1550705078, "question_id": 54796848, "link": "https://stackoverflow.com/questions/54796848/how-do-you-install-golang-binaries-for-all-users", "title": "How do you install golang binaries for all users", "body": "<p>From all of the Golang tutorials I have read, the way that you install a Go program is by setting the environment variable <code>GOPATH=~/go</code> or something similar, and then you can run <code>go get blah</code> and Go will download the program and put the binary in <code>~/go/bin</code>.  You also have to add <code>~/go/bin</code> into your <code>$PATH</code> environment variable so that you can run the programs.  </p>\n\n<p>How would you go about installing a Golang program into a common location for all users, so that each user on a system did not need to add a PATH environment variable?</p>\n\n<p>The only way I can see of doing it is to make a directory like <code>/usr/local/go</code>, and set that as my <code>GOPATH</code> when I install the program, and then I need to add <code>/usr/local/go/bin</code> into the system-wide $PATH so that all users can run the programs.  Is that how it should be done?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550703063, "post_id": 54796361, "comment_id": 96370886, "body": "You can&#39;t pass <code>&quot;&gt;&quot;,  &quot;&#47;dev&#47;null&quot;, &quot;2&gt;&amp;1&quot;</code> as arguments to bash, they need to be in <code>command</code> if you want bash to interpret them as part of <code>command</code>"}, {"owner": {"reputation": 127, "user_id": 7960258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff1b37dd38f331b04d9898c789178e8?s=128&d=identicon&r=PG&f=1", "display_name": "bmw417", "link": "https://stackoverflow.com/users/7960258/bmw417"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550703678, "post_id": 54796361, "comment_id": 96371103, "body": "I removed the redirection from my command, but it unfortunately did not stop the FNF error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550704928, "post_id": 54796361, "comment_id": 96371464, "body": "No, that was just a basic error I saw. Also, why are you shelling out to <code>wget</code> in the first place, instead of just downloading the file directly? I would make sure everything is in the same working directory, and verify the file exists from the commandline too."}, {"owner": {"reputation": 127, "user_id": 7960258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff1b37dd38f331b04d9898c789178e8?s=128&d=identicon&r=PG&f=1", "display_name": "bmw417", "link": "https://stackoverflow.com/users/7960258/bmw417"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550705428, "post_id": 54796361, "comment_id": 96371597, "body": "I have done those things, the file exists and is named the same as what the command is looking for. What would you mean by downloading the file directly? That&#39;s what wget is for, a file download through the shell. Unless there is an included go tool tool that is easier to use I don&#39;t know why wget would be bad to use. Also I&#39;ve edited my question to include a pastebin with the code"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1550705735, "post_id": 54796361, "comment_id": 96371703, "body": "<code>wget</code> isn&#39;t bad, it&#39;s just adding more variables to your problem. The go http package works perfectly fine. Did you verify that there&#39;s no hidden whitespace in the name that the shell would be stripping out for you?"}, {"owner": {"reputation": 127, "user_id": 7960258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff1b37dd38f331b04d9898c789178e8?s=128&d=identicon&r=PG&f=1", "display_name": "bmw417", "link": "https://stackoverflow.com/users/7960258/bmw417"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550706038, "post_id": 54796361, "comment_id": 96371793, "body": "I didn&#39;t know of the package but I&#39;ll look into it - I&#39;m a bit new to go. Anyway, I have looked at the files and none of them have whitespace, all the words in the file are delimited by a hyphen. I also thought of that before I posted but unfortunately that&#39;s also not the issue"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1550706131, "post_id": 54796361, "comment_id": 96371818, "body": "whitespace would most likely be at the end, not where the hyphens are. Just use <code>fmt.Printf(&quot;PDF name: %q\\n&quot;, pdfName)</code> rather than guessing at what characters may or may not be there."}, {"owner": {"reputation": 127, "user_id": 7960258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff1b37dd38f331b04d9898c789178e8?s=128&d=identicon&r=PG&f=1", "display_name": "bmw417", "link": "https://stackoverflow.com/users/7960258/bmw417"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550706311, "post_id": 54796361, "comment_id": 96371857, "body": "NO WAY - there is an extra space at the end of the filename on the last one! Great job @JimB. Post your answer and I&#39;ll accept"}], "owner": {"reputation": 127, "user_id": 7960258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ff1b37dd38f331b04d9898c789178e8?s=128&d=identicon&r=PG&f=1", "display_name": "bmw417", "link": "https://stackoverflow.com/users/7960258/bmw417"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1611322663, "creation_date": 1550702269, "last_edit_date": 1611322663, "question_id": 54796361, "link": "https://stackoverflow.com/questions/54796361/file-not-found-error-even-though-the-two-filenames-are-exactly-the-same", "title": "File Not Found error even though the two filenames are exactly the same?", "body": "<p>I'm writing a crawler in Go that crawls the trendmicro site for security reports (in pdf form), then uses wget when it gets a hit on a pdf to download the pdf. Afterwards, I use a library I found from github (<a href=\"https://github.com/sajari/docconv\" rel=\"nofollow noreferrer\">https://github.com/sajari/docconv</a>) to translate the pdf into text, then print that text to the terminal. For some reason, the code works just fine for the first two pdfs, but once it hits the third, it says that the pdf was not found, even though it downloads just the same as the others and is in the same directory. The program trace is below:</p>\n<pre><code>HTTP request sent, awaiting response... 200 OK\nLength: 2268867 (2.2M) [application/pdf]\nSaving to: \u2018rpt-2016-annual-security-roundup-a-record-year-for-enterprise-threats.pdf\u2019\n\nrpt-2016-annual-sec 100%[===================&gt;]   2.16M  1.02MB/s    in 2.1s    \n\n2019-02-20 15:25:07 (1.02 MB/s) - \u2018rpt-2016-annual-security-roundup-a-record-year-for-enterprise-threats.pdf\u2019 saved [2268867/2268867]\n\n2019/02/20 15:25:07 open rpt-2016-annual-security-roundup-a-record-year-for-enterprise-threats.pdf : no such file or directory\nexit status 1\n</code></pre>\n<p>I diff'd the two strings to see if they're different but they're not. And again, the first two download just fine. Here's the affected part of the code:</p>\n<pre><code>pdfName := strings.Replace(link, &quot;https://documents.trendmicro.com/assets/rpt/&quot;, &quot;&quot;, -1)\nfmt.Printf(&quot;PDF name: %s\\n&quot;, pdfName)\nexistingPdf := 0;\nif len(pdfs) &gt; 0 {\n    for i := 0; i &lt; len(pdfs); i++ {\n        if pdfs[i] == pdfName {\n            existingPdf = 1;\n        }\n    }\n}\nif existingPdf == 0 {\n    pdfs = append(pdfs, pdfName)\n    command := &quot;wget &quot; + link\n    cmd := exec.Command(&quot;/bin/bash&quot;, &quot;-c&quot;, command, &quot;&gt;&quot;,  &quot;/dev/null&quot;, &quot;2&gt;&amp;1&quot;)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Run()\n    res, err := docconv.ConvertPath(pdfName)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(res)\n}\n</code></pre>\n<p>If you'd like the full code and/or would like to run it, I've put it in pastebin (<a href=\"https://pastebin.com/5JkJDamV\" rel=\"nofollow noreferrer\">https://pastebin.com/5JkJDamV</a>)</p>\n"}, {"tags": ["mysql", "go", "buffalo"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1550703948, "post_id": 54796063, "comment_id": 96371186, "body": "The by yourself indicated critical connection code is not in the question, making it extremely difficult to say anything useful"}, {"owner": {"reputation": 1, "user_id": 11089604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JVO12TIgLxs/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP0SBbQuTfYW2Gr29omldH2xODVSg/mo/photo.jpg?sz=128", "display_name": "Marcel J.B", "link": "https://stackoverflow.com/users/11089604/marcel-j-b"}, "reply_to_user": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1550743475, "post_id": 54796063, "comment_id": 96385094, "body": "Do you know, in which part of the application could be the problem? I thought, that it is some configuration problem."}, {"owner": {"reputation": 316, "user_id": 4901191, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/--zVehh4nWiU/AAAAAAAAAAI/AAAAAAAAAGU/8tzmW126jBM/photo.jpg?sz=128", "display_name": "Stanislas Michalak", "link": "https://stackoverflow.com/users/4901191/stanislas-michalak"}, "edited": false, "score": 0, "creation_date": 1550781188, "post_id": 54796063, "comment_id": 96407857, "body": "Please add more info about where the problem is: you said &quot;buffalo application cannot write to my MySQL db or read from it&quot;, but what result do you see ? What did you try to do?"}], "owner": {"reputation": 1, "user_id": 11089604, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JVO12TIgLxs/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQP0SBbQuTfYW2Gr29omldH2xODVSg/mo/photo.jpg?sz=128", "display_name": "Marcel J.B", "link": "https://stackoverflow.com/users/11089604/marcel-j-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550743457, "creation_date": 1550700899, "last_edit_date": 1550743457, "question_id": 54796063, "link": "https://stackoverflow.com/questions/54796063/cannot-write-to-mysql-db-or-read-from-it-in-my-buffalo-application", "title": "Cannot write to mySQL db or read from it in my buffalo application", "body": "<p>Currently i have the problem, that my buffalo application cannot write to my MySQL db or read from it. But in the logs no errors occurring.</p>\n\n<p><strong>My database.yml file</strong></p>\n\n<pre><code>development:\n  dialect: \"mysql\"\n  database: \"test_buff\"\n  host: \"localhost\"\n  port: \"3306\"\n  user: \"root\"\n  password: \"password\"\n</code></pre>\n\n<p><strong>worker.go</strong></p>\n\n<p>I created this model with POP.</p>\n\n<pre><code>type Worker struct {\nID        uuid.UUID `json:\"id\" db:\"id\"`\nCreatedAt time.Time `json:\"created_at\" db:\"created_at\"`\nUpdatedAt time.Time `json:\"updated_at\" db:\"updated_at\"`\nName      string    `json:\"name\" db:\"name\"`\nAge       int   `json:\"age\" db:\"age\"`\nPlz       string    `json:\"plz\" db:\"plz\"`\n</code></pre>\n\n<p>}</p>\n\n<p><strong>models.go</strong> (auto generated)</p>\n\n<pre><code>// DB is a connection to your database to be used\n// throughout your application.\nvar DB *pop.Connection\n\nfunc init() {\n    var err error\n    env := envy.Get(\"GO_ENV\", \"development\")\n    DB, err = pop.Connect(env)\n    if err != nil {\n        log.Fatal(err)\n    }\n    pop.Debug = env == \"development\"\n}\n</code></pre>\n\n<p><strong>home.go</strong></p>\n\n<pre><code>a := models.Worker{}\ntx, ok := c.Value(\"tx\").(*pop.Connection)\nif !ok {\n    //\n}\ntx.All(&amp;a)\n</code></pre>\n\n<p>If i use another mySql driver(not the buffalo) than it works. So it might be a problem with the buffalo framework</p>\n\n<p><strong>Code with the other driver</strong></p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"root:password@/test_buff\")\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1550699882, "post_id": 54795852, "comment_id": 96369774, "body": "So, 3 lines with <code>MYSTRING=foo</code> is expected here?"}, {"owner": {"reputation": 1606, "user_id": 7242490, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/259444dba6bc0f46688d3522a93cd82c?s=128&d=identicon&r=PG&f=1", "display_name": "bli00", "link": "https://stackoverflow.com/users/7242490/bli00"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1550699925, "post_id": 54795852, "comment_id": 96369788, "body": "Yes. Basically I want to replace everything between <code>MYSTRING=</code> and <code>\\n</code> with a string of my choice."}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 5, "last_activity_date": 1550699934, "creation_date": 1550699934, "answer_id": 54795889, "question_id": 54795852, "link": "https://stackoverflow.com/questions/54795852/golang-regex-replace-between-strings/54795889#54795889", "title": "Golang regex replace between strings", "body": "<p>You may use</p>\n\n<pre><code>(MYSTRING=).*\n</code></pre>\n\n<p>and replace with <code>${1}foo</code>. See <a href=\"https://regex101.com/r/cDlt1m/1\" rel=\"noreferrer\">the online Go regex demo</a>.</p>\n\n<p>Here, <code>(MYSTRING=).*</code> matches and captures <code>MYSTRING=</code> substring (the <code>${1}</code> will reference this value from the replacement pattern) and <code>.*</code> will match and consume any 0+ chars other than line break chars up to the end of the line.</p>\n\n<p>See the <a href=\"https://play.golang.org/p/_E3eX0ueZ85\" rel=\"noreferrer\">Go demo</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nconst sample = `MYSTRING=${MYSTRING}\nMYSTRING=\nMYSTRING=randomstringwithvariablelength\n`\nfunc main() {\n    var re = regexp.MustCompile(`(MYSTRING=).*`)\n    s := re.ReplaceAllString(sample, `${1}foo`)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>MYSTRING=foo\nMYSTRING=foo\nMYSTRING=foo\n</code></pre>\n"}], "owner": {"reputation": 1606, "user_id": 7242490, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/259444dba6bc0f46688d3522a93cd82c?s=128&d=identicon&r=PG&f=1", "display_name": "bli00", "link": "https://stackoverflow.com/users/7242490/bli00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 1, "accepted_answer_id": 54795889, "answer_count": 1, "score": 3, "last_activity_date": 1550699960, "creation_date": 1550699749, "last_edit_date": 1550699960, "question_id": 54795852, "link": "https://stackoverflow.com/questions/54795852/golang-regex-replace-between-strings", "title": "Golang regex replace between strings", "body": "<p>I have some strings in the following possible forms:</p>\n\n<pre><code>MYSTRING=${MYSTRING}\\n\nMYSTRING=\\n\nMYSTRING=randomstringwithvariablelength\\n\n</code></pre>\n\n<p>I want to be able to regex this into <code>MYSTRING=foo</code>, basically replacing everything between <code>MYSTRING=</code> and <code>\\n</code>. I've tried:</p>\n\n<pre><code>re := regexp.MustCompile(\"MYSTRING=*\\n\")\ns = re.ReplaceAllString(s, \"foo\")\n</code></pre>\n\n<p>But it doesn't work. Any help is appreciated.</p>\n\n<hr>\n\n<p>P.S. the <code>\\n</code> is to indicate that there's a newline for this purpose. It's not actually there.</p>\n"}, {"tags": ["xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 8477074, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0UgLisIi_jI/AAAAAAAAAAI/AAAAAAAAABI/iuy08Bs0WTs/photo.jpg?sz=128", "display_name": "Rustavil Nurkaev", "link": "https://stackoverflow.com/users/8477074/rustavil-nurkaev"}, "is_accepted": true, "score": 1, "last_activity_date": 1550700806, "last_edit_date": 1550700806, "creation_date": 1550700503, "answer_id": 54795982, "question_id": 54795471, "link": "https://stackoverflow.com/questions/54795471/parsing-in-go-xml-that-has-elements-with-arbitrary-endings/54795982#54795982", "title": "parsing in GO xml that has elements with arbitrary endings", "body": "<p>You can use the following structure (<a href=\"https://play.golang.org/p/GbgA9N1wx34\" rel=\"nofollow noreferrer\">try it online!</a>):</p>\n\n<pre><code>type GetPriceChangesForReseller struct {\n    XMLName xml.Name        `xml:\"GetPriceChangesForReseller\"`\n    Items   []PriceContract `xml:\",any\"`\n}\n\ntype PriceContract struct {\n    Price string `xml:\"EndUserPrice\"`\n}\n</code></pre>\n\n<p>It should work.</p>\n"}, {"tags": [], "owner": {"reputation": 1143, "user_id": 370213, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/PH4vL.jpg?s=128&g=1", "display_name": "zhengchun", "link": "https://stackoverflow.com/users/370213/zhengchun"}, "is_accepted": false, "score": 0, "last_activity_date": 1550894645, "last_edit_date": 1592644375, "creation_date": 1550894645, "answer_id": 54838131, "question_id": 54795471, "link": "https://stackoverflow.com/questions/54795471/parsing-in-go-xml-that-has-elements-with-arbitrary-endings/54838131#54838131", "title": "parsing in GO xml that has elements with arbitrary endings", "body": "<p>you can try <a href=\"https://github.com/antchfx/xmlquery\" rel=\"nofollow noreferrer\">xmlquery</a>, its easy to parse and query for XML document , without defined types like structs.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>doc, err := xmlquery.Parse(strings.NewReader(s))\n    if err != nil {\n        panic(err)\n    }\n    for _, n := range xmlquery.Find(doc, &quot;//GetPriceChangesForReseller/*&quot;) {\n        fmt.Printf(&quot;%s price: %s\\n&quot;, n.Data, n.SelectElement(&quot;EndUserPrice&quot;).InnerText())\n    }\n</code></pre>\n<blockquote>\n<p>PriceContractArray0 price: 1990,00</p>\n<p>PriceContractArray1 price: 2290,00</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 11092449, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XXHna1ipGBo/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQOcLrlTSfypC2s-YPs2fzIvqvhH9g/mo/photo.jpg?sz=128", "display_name": "\u0421\u0435\u0440\u0433\u0435\u0439 \u0425\u0430\u043c\u0435\u043d\u0435\u0432", "link": "https://stackoverflow.com/users/11092449/%d0%a1%d0%b5%d1%80%d0%b3%d0%b5%d0%b9-%d0%a5%d0%b0%d0%bc%d0%b5%d0%bd%d0%b5%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 54795982, "answer_count": 2, "score": 1, "last_activity_date": 1550894645, "creation_date": 1550697938, "last_edit_date": 1550723625, "question_id": 54795471, "link": "https://stackoverflow.com/questions/54795471/parsing-in-go-xml-that-has-elements-with-arbitrary-endings", "title": "parsing in GO xml that has elements with arbitrary endings", "body": "<p>I try to parse xml file that has elements with arbitrary endings</p>\n\n<p>Example of xml with Array0 and Array1: </p>\n\n<pre><code>&lt;GetPriceChangesForReseller&gt;\n          &lt;PriceContractArray0 actualtype=\"PriceContract\"&gt;\n            &lt;EndUserPrice&gt;1990,00&lt;/EndUserPrice&gt;     \n          &lt;/PriceContractArray0&gt;\n          &lt;PriceContractArray1 actualtype=\"PriceContract\"&gt;        \n            &lt;EndUserPrice&gt;2290,00&lt;/EndUserPrice&gt;\n          &lt;/PriceContractArray1&gt;  \n&lt;/GetPriceChangesForReseller&gt;\n</code></pre>\n\n<p>How can I work with this case?</p>\n\n<p>a part of my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\n\ntype GetPriceChangesForReseller struct {\n    XMLName                    xml.Name             `xml:\"GetPriceChangesForReseller\"`\n    GetPriceChangesForReseller []PriceContractArray `xml:\"PriceContractArray\"`\n}\n\n\ntype PriceContractArray struct {\n    XMLName             xml.Name `xml:\"PriceContractArray\"`\n    Price               string   `xml:\"Price\"`\nfunc main() {\n\n// Open our xmlFile\nxmlFile, err := os.Open(\"GetPriceChangesForReseller.xml\")\n// if we os.Open returns an error then handle it\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Thanks in advance! </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1550697615, "post_id": 54795286, "comment_id": 96368850, "body": "Use pointers for the optional fields and the <code>omitempty</code> json tag option: <a href=\"https://play.golang.org/p/2caRIciVF66\" rel=\"nofollow noreferrer\">play.golang.org/p/2caRIciVF66</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550697776, "post_id": 54795286, "comment_id": 96368926, "body": "It&#39;s not generally necessary to use pointers for optional fields."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550698026, "post_id": 54795286, "comment_id": 96369047, "body": "@Adrian wouldn&#39;t that then produce <code>&quot;basicCard&quot;: {}</code> in the first element and <code>&quot;simpleResponse&quot;: {}</code> in the second, which would be not exactly the same as the desired json in the question? Or does omitempty work on empty non-pointer structs?"}, {"owner": {"reputation": 7736, "user_id": 2744242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71d3267f5993b6b79619213c789524b5?s=128&d=identicon&r=PG&f=1", "display_name": "rafaelcb21", "link": "https://stackoverflow.com/users/2744242/rafaelcb21"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550701903, "post_id": 54795286, "comment_id": 96370482, "body": "@mkopriva Thank you it worked perfectly with pointers."}, {"owner": {"reputation": 7736, "user_id": 2744242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71d3267f5993b6b79619213c789524b5?s=128&d=identicon&r=PG&f=1", "display_name": "rafaelcb21", "link": "https://stackoverflow.com/users/2744242/rafaelcb21"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550701913, "post_id": 54795286, "comment_id": 96370485, "body": "@Adrian your solution does not work, the error continues. You tested?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550757858, "post_id": 54795286, "comment_id": 96394285, "body": "I may have assumed too much. Added a working playground example."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1550757776, "last_edit_date": 1550757776, "creation_date": 1550697617, "answer_id": 54795420, "question_id": 54795286, "link": "https://stackoverflow.com/questions/54795286/slice-of-type-struct-with-different-structs-inside-it/54795420#54795420", "title": "Slice of type struct with different structs inside it", "body": "<p><code>Items</code> is a slice of structs but you're using it as if it's a single <code>Item</code> struct. Being a slice with elements of type <code>Item</code> the correct syntax would be:</p>\n\n<pre><code>group := RichResponse{  \n    Items: Items{ // This is a slice\n        Item{ // This is an element in the slice\n            SimpleResponse{\"foo1\", \"foo2\"},\n            BasicCard{\n                FormattedText: \"foo3\",\n                ImageDisplayOptions: \"CROPPED\",\n            },\n        },\n    },\n}\n</code></pre>\n\n<p>Note that you need to define <code>Item</code> as a named type if you don't want some really messy struct literals. Here's a working example on Playground: <a href=\"https://play.golang.org/p/pzO_w2cIeOJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pzO_w2cIeOJ</a></p>\n"}], "owner": {"reputation": 7736, "user_id": 2744242, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/71d3267f5993b6b79619213c789524b5?s=128&d=identicon&r=PG&f=1", "display_name": "rafaelcb21", "link": "https://stackoverflow.com/users/2744242/rafaelcb21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550757776, "creation_date": 1550697009, "last_edit_date": 1592644375, "question_id": 54795286, "link": "https://stackoverflow.com/questions/54795286/slice-of-type-struct-with-different-structs-inside-it", "title": "Slice of type struct with different structs inside it", "body": "<p>I'm trying to create the following json below, but I'm not getting it:</p>\n<p><strong>json</strong></p>\n<pre><code>{\n  &quot;richResponse&quot;: {\n    &quot;items&quot;: [\n      {\n        &quot;simpleResponse&quot;: {\n          &quot;textToSpeech&quot;: &quot;foo1&quot;,\n          &quot;displayText&quot;: &quot;foo2&quot;\n        }\n      },\n      {\n        &quot;basicCard&quot;: {\n          &quot;formattedText&quot;: &quot;foo3&quot;,\n          &quot;imageDisplayOptions&quot;: &quot;CROPPED&quot;\n        }\n      }\n    ]\n  }\n}\n</code></pre>\n<p>The problem is that I have a <code>[]struct</code> called<code> Items</code> (slice of structs) and it has 2 different structs <code>SimpleResponse</code> and<code> BasicCard</code> and I am not able to mount this json.</p>\n<p>The errors appear:</p>\n<blockquote>\n<p>can not use literal SimpleResponse</p>\n<p>can not use BasicCard literal</p>\n</blockquote>\n<p><strong>main.go</strong></p>\n<p><a href=\"https://play.golang.org/p/Gbl0UNWhqko\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Gbl0UNWhqko</a></p>\n<pre><code>package main\n\nimport (\n    &quot;encoding/json&quot;\n    &quot;fmt&quot;\n    &quot;os&quot;\n)\n\nfunc main() {\n\n    type SimpleResponse struct {\n        TextToSpeech string `json:&quot;textToSpeech&quot;`\n        DisplayText  string `json:&quot;displayText&quot;`\n    }\n\n    type BasicCard struct {\n        FormattedText       string `json:&quot;formattedText&quot;`\n        ImageDisplayOptions string `json:&quot;imageDisplayOptions&quot;`\n    }\n\n    type Items []struct {\n        SimpleResponse SimpleResponse `json:&quot;simpleResponse&quot;`\n        BasicCard BasicCard `json:&quot;basicCard&quot;`\n    }\n\n    type RichResponse struct{\n        Items Items `json:&quot;items&quot;`\n    }\n\n    group := RichResponse{  \n        Items: Items{\n            SimpleResponse{&quot;foo1&quot;, &quot;foo2&quot;},\n            BasicCard{\n                FormattedText: &quot;foo3&quot;,\n                ImageDisplayOptions: &quot;CROPPED&quot;,\n            },\n        },\n    }\n\n    b, err := json.Marshal(group)\n    if err != nil {\n        fmt.Println(&quot;error:&quot;, err)\n    }\n    os.Stdout.Write(b)\n}\n</code></pre>\n<p>Could you help me mount this json?</p>\n"}, {"tags": ["go", "amazon-s3"], "comments": [{"owner": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1550696880, "post_id": 54795227, "comment_id": 96368535, "body": "The url utils contain all you are looking for: Identification of parameters and base url. Alternative you can use a string split on &quot;?&quot;."}, {"owner": {"reputation": 47, "user_id": 8886896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hrKYNS_j6rs/AAAAAAAAAAI/AAAAAAAAABU/HfYdrjLHjcQ/photo.jpg?sz=128", "display_name": "Christian Herrejon", "link": "https://stackoverflow.com/users/8886896/christian-herrejon"}, "reply_to_user": {"reputation": 5548, "user_id": 4625526, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6378aa788195a771461c5043057e2ed5?s=128&d=identicon&r=PG&f=1", "display_name": "Norbert van Nobelen", "link": "https://stackoverflow.com/users/4625526/norbert-van-nobelen"}, "edited": false, "score": 0, "creation_date": 1550697160, "post_id": 54795227, "comment_id": 96368652, "body": "I tried use <a href=\"https://vis3dev.s3.amazonaws.com/266295041.mp4\" rel=\"nofollow noreferrer\">https://vis3dev.s3.amazonaws.com/266295041.mp4</a> but doesn&#39;t work always I have <code>the file doesn&#39;t have correct format</code>"}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 8886896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hrKYNS_j6rs/AAAAAAAAAAI/AAAAAAAAABU/HfYdrjLHjcQ/photo.jpg?sz=128", "display_name": "Christian Herrejon", "link": "https://stackoverflow.com/users/8886896/christian-herrejon"}, "is_accepted": true, "score": 0, "last_activity_date": 1550701554, "last_edit_date": 1550701554, "creation_date": 1550699892, "answer_id": 54795878, "question_id": 54795227, "link": "https://stackoverflow.com/questions/54795227/golang-unsigned-url/54795878#54795878", "title": "Golang unsigned URL", "body": "<p><code>acl := \"public-read\"</code></p>\n\n<p>I fixed it changing the upload file adding <code>ACL:           aws.String(acl),</code></p>\n"}], "owner": {"reputation": 47, "user_id": 8886896, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-hrKYNS_j6rs/AAAAAAAAAAI/AAAAAAAAABU/HfYdrjLHjcQ/photo.jpg?sz=128", "display_name": "Christian Herrejon", "link": "https://stackoverflow.com/users/8886896/christian-herrejon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 54795878, "answer_count": 1, "score": 0, "last_activity_date": 1550701554, "creation_date": 1550696708, "last_edit_date": 1550697086, "question_id": 54795227, "link": "https://stackoverflow.com/questions/54795227/golang-unsigned-url", "title": "Golang unsigned URL", "body": "<p>I have the next code to get URL from Amazon, but I need that URL looks something like </p>\n\n<p><a href=\"https://vis3dev.s3.amazonaws.com/359952_1550525274.mp4\" rel=\"nofollow noreferrer\">https://vis3dev.s3.amazonaws.com/359952_1550525274.mp4</a> </p>\n\n<p>and not </p>\n\n<p><a href=\"https://vis3dev.s3.amazonaws.com/266295041.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIE4CD73A5BW7WNTQ%2F20190220%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20190220T193732Z&amp;X-Amz-Expires=900&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ba839af2fb7b314df2f47a589165558ae50264164c686314b6d73eab2975d8f1\" rel=\"nofollow noreferrer\">https://vis3dev.s3.amazonaws.com/266295041.mp4?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIE4CD00A5BW7WNTQ%2F20190220%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20190220T193732Z&amp;X-Amz-Expires=900&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Signature=ba800af2fb7b314df2f47a589165558ae50264164c686314b6d73eab2975d8f1\n</a></p>\n\n<pre><code>func GetFileLink(svc *session.Session) error {\n    req, _ := s3.New(svc).GetObjectRequest(&amp;s3.GetObjectInput{\n        Bucket: aws.String(AwsBucket),\n        Key:    aws.String(NameFile + \".mp4\"),\n    })\n\n    url, err := req.Presign(15 * time.Minute)\n\n    if err != nil {\n        fmt.Print(err)\n    }\n\n    fmt.Println(url)\n\n    return err\n}\n</code></pre>\n"}, {"tags": ["c++", "arrays", "pointers", "go", "swig"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1550688609, "post_id": 54793264, "comment_id": 96364695, "body": "Pass them as slices?"}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1550688834, "post_id": 54793264, "comment_id": 96364805, "body": "I must return the pointer from the function. I don&#39;t think slices is the correct play but would be happy to be proven wrong with example code. I think the issue could be how the pointer loses address as it goes from c++ to Go. Thanks for the reply"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550689159, "post_id": 54793264, "comment_id": 96364956, "body": "related questions: <a href=\"https://stackoverflow.com/questions/28925179/cgo-how-to-pass-struct-array-from-c-to-go\" title=\"cgo how to pass struct array from c to go\">stackoverflow.com/questions/28925179/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/43330938/export-function-that-returns-array-of-doubles\" title=\"export function that returns array of doubles\">stackoverflow.com/questions/43330938/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/36542385/casting-a-cgo-array-into-a-slice\" title=\"casting a cgo array into a slice\">stackoverflow.com/questions/36542385/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/47354663/access-c-array-of-type-const-char-from-go/47355217\" title=\"access c array of type const char from go\">stackoverflow.com/questions/47354663/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/42530538/how-to-pass-pointer-to-slice-to-c-function-in-go/42533858\" title=\"how to pass pointer to slice to c function in go\">stackoverflow.com/questions/42530538/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550689331, "post_id": 54793264, "comment_id": 96365043, "body": "have you tried this? <a href=\"https://github.com/golang/go/wiki/cgo#turning-c-arrays-into-go-slices\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/cgo#turning-c-arrays-into-go-slice&zwnj;&#8203;s</a>"}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550691044, "post_id": 54793264, "comment_id": 96365813, "body": "@JimB all of your links are for C -&gt; Go. Would my case be different if C++ -&gt; Go?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550691465, "post_id": 54793264, "comment_id": 96366015, "body": "Go only has a C interface (cgo), that&#39;s why you&#39;re using SWIG, to write the C interface for you."}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550692574, "post_id": 54793264, "comment_id": 96366581, "body": "@JimB Could you possibly provide a road map for tackling this problem?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550693787, "post_id": 54793264, "comment_id": 96367154, "body": "@DanielRamsey: Can you explain which part you don&#39;t understand? If <code>pSrc</code> is a pointer, those 6 other examples all demonstrate accessing it as a go slice."}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550696239, "post_id": 54793264, "comment_id": 96368254, "body": "@JimB I dont understand how those 6 examples apply to my case because they all use C, not C++"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550696506, "post_id": 54793264, "comment_id": 96368389, "body": "@DanielRamsey: Again, Go can only call C code, period. C++ code needs a C wrapper, which you&#39;re generating with SWIG. Besides that though, how would the <code>pSrc</code> pointer be any different between C and C++? They are both <code>int*</code>, and the memory layout would be identical. Try using the documented example first, and post any issues you encounter."}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550700388, "post_id": 54793264, "comment_id": 96369971, "body": "@JimB should I make the changes from from links you shared in the C wrapper the was generated by SWIFT?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550700657, "post_id": 54793264, "comment_id": 96370073, "body": "@DanielRamsey: Sorry, I&#39;m not following. If <code>pSrc</code> is the array pointer you want to access, then <code>pSrc</code> is what you want to convert to a slice using the technique shown."}, {"owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550704873, "post_id": 54793264, "comment_id": 96371441, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/188773/discussion-between-daniel-ramsey-and-jimb\">continue this discussion in chat</a>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550776225, "post_id": 54793264, "comment_id": 96405527, "body": "See also <a href=\"https://stackoverflow.com/questions/48756732/what-does-1-30c-yourtype-do-exactly-in-cgo\" title=\"what does 1 30c yourtype do exactly in cgo\">stackoverflow.com/questions/48756732/&hellip;</a>, which explains the syntax of the slice conversion."}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "is_accepted": false, "score": 1, "last_activity_date": 1550707525, "last_edit_date": 1550707525, "creation_date": 1550707005, "answer_id": 54797123, "question_id": 54793264, "link": "https://stackoverflow.com/questions/54793264/c-to-go-using-swig-how-to-pass-c-pointers-to-go/54797123#54797123", "title": "C++ to Go using SWIG: How to pass C++ pointers to Go?", "body": "<p>@JimB Thanks for all of your resources. I figured it out and this seems to do the trick.</p>\n\n<pre><code>int* Camera::retrieveDataPointerPerBuffer() {\n   int cameraData [10] = {1,2,3,4,5,6,7,8,9,10};\n   int* pSrc = cameraData;\n   return cameraData; \n} //camera.cpp\n</code></pre>\n\n<p>Below contains the changes that I made</p>\n\n<pre><code>func myCamera() { //For Goroutine\n   cam := camera.NewCamera()\n   pSrc := cam.RetrieveDataPointerPerBuffer()\n\n   arraySize := 10\n   slice := (*[1 &lt;&lt; 30]C.int)(unsafe.Pointer(pSrc))[:arraySize:arraySize]\n\n   fmt.Println(slice)\n}\n</code></pre>\n\n<p>Output: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</p>\n\n<p>Follow Up Question: Would anyone mind explaining this line of code?</p>\n\n<pre><code>slice := (*[1 &lt;&lt; 30]C.int)(unsafe.Pointer(pSrc))[:arraySize:arraySize]\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 10993065, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PZLWmOv3CZA/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNmAN159G1YjShfR7djjUTcR0NtlA/mo/photo.jpg?sz=128", "display_name": "Daniel Ramsey", "link": "https://stackoverflow.com/users/10993065/daniel-ramsey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 323, "favorite_count": 1, "closed_date": 1550707182, "answer_count": 1, "score": 1, "last_activity_date": 1550707525, "creation_date": 1550688403, "question_id": 54793264, "link": "https://stackoverflow.com/questions/54793264/c-to-go-using-swig-how-to-pass-c-pointers-to-go", "closed_reason": "Duplicate", "title": "C++ to Go using SWIG: How to pass C++ pointers to Go?", "body": "<p>See code below and I will explain</p>\n\n<pre><code>int* Camera::retrieveDataPointerPerBuffer() {\n    int cameraData [10] = {1,2,3,4,5,6,7,8,9,10};\n    int* pSrc = cameraData;\n    return cameraData; \n} //camera.cpp\n</code></pre>\n\n<p>The code above has int pointer pSrc pointing to array and then returned. This is a function in C++. Next, I am using SWIG to essentially wrap this C++ function, so that I can call it in Go. The following code demonstrates the function being called in Go. </p>\n\n<pre><code>func myCamera() {\n    cam := camera.NewCamera()\n    pSrc := cam.RetrieveDataPointerPerBuffer()\n\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(\"%d\", pSrc)\n    }\n} //main.go\n</code></pre>\n\n<p>Note: I know that I cannot iterate pointers in Go. But is there any way?</p>\n\n<p>Output: 0</p>\n\n<p>Problems: How do you access the arrays elements via pointer from C++ to Go?\nAdditional Information: This is a simplified version of a larger project I am working on. I must return this pointer, I cannot return a vector.</p>\n\n<p>Let me know if you need me to clarify anything for you.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550688216, "post_id": 54793169, "comment_id": 96364497, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/54714355/go-mod-changes-in-travis-ci\">go.mod changes in travis-ci</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1550688311, "post_id": 54793169, "comment_id": 96364539, "body": "Go modules by default assume you want the latest non-major update in order to receive backward-compatible bug fixes and security patches; if that&#39;s not what you want you&#39;ll need to specifically pin the libraries at the versions you need: <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules</a>"}, {"owner": {"reputation": 175, "user_id": 3829638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Glyo.jpg?s=128&g=1", "display_name": "kardolus", "link": "https://stackoverflow.com/users/3829638/kardolus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550693543, "post_id": 54793169, "comment_id": 96367028, "body": "@Adrian Thanks! Any idea how we could pin a specific version? We are specifying a version in our go.mod"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1550695209, "post_id": 54793169, "comment_id": 96367771, "body": "Read the accepted answer to the question I linked and/or the wiki page I linked. Both explain it."}], "answers": [{"comments": [{"owner": {"reputation": 2971, "user_id": 496351, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ce4ddeab530fecaf1270a1bf5cccea90?s=128&d=identicon&r=PG", "display_name": "Tristian", "link": "https://stackoverflow.com/users/496351/tristian"}, "edited": false, "score": 0, "creation_date": 1554178351, "post_id": 54798189, "comment_id": 97645067, "body": "How did you find out which dependency was bumping the version?"}], "tags": [], "owner": {"reputation": 175, "user_id": 3829638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Glyo.jpg?s=128&g=1", "display_name": "kardolus", "link": "https://stackoverflow.com/users/3829638/kardolus"}, "is_accepted": false, "score": 2, "last_activity_date": 1550715308, "creation_date": 1550715308, "answer_id": 54798189, "question_id": 54793169, "link": "https://stackoverflow.com/questions/54793169/running-go-mod-vendor-updates-my-libraries/54798189#54798189", "title": "Running go mod vendor updates my libraries", "body": "<p>I think the problem I was having is that my go program specified version 1.2.3 of a specific library, but a dependency of my program pulled in version 1.2.4, resulting in a bump when I did a go vendor.</p>\n\n<p>Hostile environment here! I had no idea ;). I will think twice before asking anything in the future.</p>\n\n<p>Peace!</p>\n"}], "owner": {"reputation": 175, "user_id": 3829638, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0Glyo.jpg?s=128&g=1", "display_name": "kardolus", "link": "https://stackoverflow.com/users/3829638/kardolus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 986, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550715308, "creation_date": 1550688002, "question_id": 54793169, "link": "https://stackoverflow.com/questions/54793169/running-go-mod-vendor-updates-my-libraries", "title": "Running go mod vendor updates my libraries", "body": "<p>I'm trying to vendor my go-modules and am using go 1.11.5. However, when i run <code>go mod vendor</code>, it appears that under the hood <code>go mod tidy</code> is being called first. This updates my go libraries. Unfortunately, I am dependent on an older version of a certain library. </p>\n\n<p>Is there any way I can vendor based on go.sum instead? </p>\n\n<p>Any help much appreciated!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 6, "creation_date": 1550686700, "post_id": 54792822, "comment_id": 96363704, "body": "Do it like that: <a href=\"https://play.golang.org/p/VURnlebXCO-\" rel=\"nofollow noreferrer\">play.golang.org/p/VURnlebXCO-</a>"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 4, "creation_date": 1550686794, "post_id": 54792822, "comment_id": 96363753, "body": "You can put your functions in a slice and do a <code>range</code> over it"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 3, "creation_date": 1550687718, "post_id": 54792822, "comment_id": 96364253, "body": "Your code runs <code>validate</code> only if <code>init</code> fails, and <code>process</code> only if both <code>init</code> and <code>validate</code> failed, and so on. It doesn&#39;t sound like that is your intent. Tobias&#39; example would be the idiomatic solution if your intent is to abort if a step fails."}, {"owner": {"reputation": 143, "user_id": 11091724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a061b841cfd03126361b22dc2b2d40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/11091724/peter"}, "edited": false, "score": 0, "creation_date": 1550690920, "post_id": 54792822, "comment_id": 96365762, "body": "right it should proceed just in case the previous method finished with no error"}, {"owner": {"reputation": 2312, "user_id": 3254692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pg8j6.jpg?s=128&g=1", "display_name": "Omar Faroque Anik", "link": "https://stackoverflow.com/users/3254692/omar-faroque-anik"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 1, "creation_date": 1550692216, "post_id": 54792822, "comment_id": 96366435, "body": "Just an extension with @TobiasTheel comment. <a href=\"https://play.golang.org/p/cJlGAanKDyt\" rel=\"nofollow noreferrer\">play.golang.org/p/cJlGAanKDyt</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "is_accepted": false, "score": 2, "last_activity_date": 1550698216, "last_edit_date": 1550698216, "creation_date": 1550697606, "answer_id": 54795418, "question_id": 54792822, "link": "https://stackoverflow.com/questions/54792822/run-multiple-conditional-function-in-golang/54795418#54795418", "title": "Run multiple conditional function in golang", "body": "<p>As i allready said in a comment, i think the most <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow noreferrer\">idiomatic</a> way would be to just call a method, check for errors. And if there was an error return it. \nYou can of course use the simplified error handling version, like you used in your question, but even if you do that. Try to avoid that deep <a href=\"https://www.webopedia.com/TERM/N/nesting.html\" rel=\"nofollow noreferrer\">nesting</a>. It's hard to read &amp; understand (deeply) nested code.</p>\n\n<pre><code>result,err := init()\nif err != nil {\n  return nil, err // An error occured so handle it\n}\n\nresult,err = validate()\nif err != nil {\n  return nil, err\n}\n\n\nresult,err = process()\nif err != nil {\n  return nil, err\n}\n\n\nresult,err = execute()\nif err != nil {\n  return nil, err\n}\n\nresult,err = finalize()\nif err != nil {\n  return nil, err\n}\n</code></pre>\n\n<h2>Problems of your example code</h2>\n\n<p>You've done the error checking wrong. You are checking for </p>\n\n<blockquote>\n  <p>if err != nil</p>\n</blockquote>\n\n<p>Spoken \"if there is an error\". And you continue with your code, although there is an error.</p>\n\n<p>To fix that you need to write:</p>\n\n<pre><code>var result someType\n\nif result, err := init(); err != nil {\n  return nil, err // An error occured so handle it\n}\n\nif result, err := validate(); err != nil {\n  return nil, err\n}\n\n\nif result, err := process(); err != nil {\n  return nil, err\n}\n\nif result, err := execute(); err != nil {\n  return nil, err\n}\n\nif result, err := finalize(); err != nil {\n  return nil, err\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550699286, "post_id": 54795524, "comment_id": 96369551, "body": "You can also have a set of different functions (different parameter etc). This <a href=\"https://stackoverflow.com/a/37319624/4992212\">answer</a> shows how. I was also about to create an example of a slice of functions, but you were faster :)"}], "tags": [], "owner": {"reputation": 461, "user_id": 9611230, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v5Tmd.jpg?s=128&g=1", "display_name": "Lukas Danin", "link": "https://stackoverflow.com/users/9611230/lukas-danin"}, "is_accepted": true, "score": 2, "last_activity_date": 1550698170, "creation_date": 1550698170, "answer_id": 54795524, "question_id": 54792822, "link": "https://stackoverflow.com/questions/54792822/run-multiple-conditional-function-in-golang/54795524#54795524", "title": "Run multiple conditional function in golang", "body": "<p>You can create a slice of functions and make this whole process prettier, e.g.</p>\n\n<pre><code>functions := []func() (string, error){\n    function1, function2, function3, function4, function5,\n}\nfor _, function := range functions {\n    someValue, err := function()\n    if err != nil {\n        fmt.Println(\"Function \" + someValue + \" didn't feel so good.\")\n        break\n    }\n    fmt.Println(\"Function \" + someValue + \" went all right!\")\n}\n</code></pre>\n\n<p>In short, the break stops things from going on, if you wrap the above process as a function, you could also use something like</p>\n\n<pre><code>return false\n</code></pre>\n\n<p>in case of an error, and at the end of the total amount of iterations, say i == len(functions) -1, you could return true if everything went all right.</p>\n\n<p>It is noteworthy to mention that you can only create slice of functions that satisfies these conditions:</p>\n\n<ul>\n<li><p>They all must have the same amount of arguments;</p></li>\n<li><p>All arguments must have the same type per position;</p></li>\n<li><p>They all have the same amount of return values;</p></li>\n<li><p>Likewise, they (return values) must have the same type per position;</p></li>\n</ul>\n\n<p>Still, you can easily overcome these limitations by having two or three different slices. For example, function1 to function3 can all be classified as</p>\n\n<pre><code>func () (bool, err)\n</code></pre>\n\n<p>Where function4 and 5 are</p>\n\n<pre><code>func () (int, err)\n</code></pre>\n\n<p>For these functions to work you could just reiterate the first slice, then if everything goes as planned, move on to the second.</p>\n\n<pre><code>firstSetOfFuncs := []func() (bool, error){\n    function1, function2, function3,\n}\nsecondSetOfFuncs := []func() (int, err){\n    function4, function5,\n}\nfor i, function := range firstSetOfFuncs {\n    someValue, err := function()\n    if err != nil {\n        fmt.Println(\"Something went terribly wrong.\")\n        break\n    }\n    if i == len(firstSetOfFuncs) - 1 {\n        for _, secondTypeOfFunc := range secondSetOfFuncs {\n            someNum, anotherErr := secondTypeOfFunc()\n            if anotherErr != nil {\n                fmt.Println(\"All seemed all right, until it didn't.\")\n                break\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 11091724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a061b841cfd03126361b22dc2b2d40?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/11091724/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 838, "favorite_count": 0, "accepted_answer_id": 54795524, "answer_count": 2, "score": 1, "last_activity_date": 1550704171, "creation_date": 1550686445, "last_edit_date": 1550704171, "question_id": 54792822, "link": "https://stackoverflow.com/questions/54792822/run-multiple-conditional-function-in-golang", "title": "Run multiple conditional function in golang", "body": "<p>I would like to run workflow functions using 5 functions in golang</p>\n\n<ol>\n<li>init </li>\n<li>validate  </li>\n<li>process   </li>\n<li>execute</li>\n<li>finalize</li>\n</ol>\n\n<p>Each method should return the same result object and error object in case of failure</p>\n\n<p>I would like to find a pattern to run this workflow rather than doing the following:</p>\n\n<pre><code>if result, err := init(); err != nil {\n    if result, err := validate(); err != nil {\n       if result, err := process(); err != nil {\n           if result, err := execute(); err != nil {\n               if result, err := finalize(); err != nil {\n\n               }\n           }\n       }\n    }\n}\n</code></pre>\n\n<p>Thanks in advance\nPeter</p>\n"}, {"tags": ["go", "gopath"], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 1461333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e22507765e19c12febc06a97816c8632?s=128&d=identicon&r=PG&f=1", "display_name": "Schparky", "link": "https://stackoverflow.com/users/1461333/schparky"}, "is_accepted": false, "score": 0, "last_activity_date": 1564429575, "creation_date": 1564429575, "answer_id": 57260511, "question_id": 54792775, "link": "https://stackoverflow.com/questions/54792775/kallax-package-is-not-in-any-of-the-go-paths/57260511#57260511", "title": "Kallax: package is not in any of the go paths", "body": "<p>This is due to the fact that you have <code>GO111MODULE=ON</code>. You will need to change it to <code>auto</code> (or <code>off</code>) and re-run the Kallax install in a non-module path (a directory that does not have a <code>go.mod</code> file present in that directory or any parent directory). </p>\n\n<p>For example:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cd ~\nexport GO111MODULE=auto\ngo get -u gopkg.in/src-d/go-kallax.v1/...\n</code></pre>\n\n<p>or in fish shell:</p>\n\n<pre><code>cd ~\nset -x GO111MODULE auto\ngo get -u gopkg.in/src-d/go-kallax.v1/...\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 6752082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d69ca3ca0e2028101663d4777ad3f866?s=128&d=identicon&r=PG&f=1", "display_name": "A.Smith", "link": "https://stackoverflow.com/users/6752082/a-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1564429575, "creation_date": 1550686297, "question_id": 54792775, "link": "https://stackoverflow.com/questions/54792775/kallax-package-is-not-in-any-of-the-go-paths", "title": "Kallax: package is not in any of the go paths", "body": "<p>I have tried to use <a href=\"https://github.com/src-d/go-kallax\" rel=\"nofollow noreferrer\">kallax</a>. When I tried to run that, I caught an error like this: </p>\n\n<pre><code>panic: parseutil: package is not in any of the go paths\n\ngoroutine 1 [running]:\ngopkg.in/src-d/go-kallax.v1/generator.glob..func1(0x890120, 0xc00015af60)\n    /home/user/go/pkg/mod/gopkg.in/src-d/go-kallax.v1@v1.3.5/generator/template.go:491 +0xa2\n\n</code></pre>\n\n<p><code>GOPATH</code> is set to <code>/home/user/go</code>, besides I use vendoring <code>GO111MODULE=on</code>.\nCould you tell me what did I wrong? Or how can I install parseutil package to <code>PATH</code>?<br>\nThank you.</p>\n"}, {"tags": ["go", "slack", "slack-api"], "comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1550683152, "post_id": 54791455, "comment_id": 96362029, "body": "FYI: there should be a <code>return</code> after <code>w.WriteHeader(http.StatusInternalServerError)</code>"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1550688865, "post_id": 54791455, "comment_id": 96364815, "body": "You are explicitly sleeping in your goroutine for 5 seconds before sending on the channel, which is 5000ms, and 2000ms longer than said timeout."}], "answers": [{"tags": [], "owner": {"reputation": 2312, "user_id": 3254692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pg8j6.jpg?s=128&g=1", "display_name": "Omar Faroque Anik", "link": "https://stackoverflow.com/users/3254692/omar-faroque-anik"}, "is_accepted": false, "score": 1, "last_activity_date": 1550682354, "creation_date": 1550682354, "answer_id": 54791795, "question_id": 54791455, "link": "https://stackoverflow.com/questions/54791455/how-to-make-my-function-return-to-slack-right-away/54791795#54791795", "title": "How to make my function return to Slack right away?", "body": "<p>I am learning stage of golang. Here is my understanding: \n1. any operations with channel is blocking\n2. You are writing on the channel in the </p>\n\n<pre><code>    go func() {\n        fmt.Println(\"Warning! This is a long and blocking process.\")\n        time.Sleep(5 * time.Second)\n\n        done &lt;- true\n    }()\n</code></pre>\n\n<ol start=\"3\">\n<li>The scheduler is still moving in the main function and trying to read from the channel but it is waiting to see, something has written on the channel or not. So it got blocked, when the above function is done with writing on the channel, controls came back and main start executing again. </li>\n</ol>\n\n<p><strong>Note: Experts will be able to explain better.</strong> </p>\n"}, {"comments": [{"owner": {"reputation": 1809, "user_id": 9801728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LXQkV.jpg?s=128&g=1", "display_name": "MoxieBall", "link": "https://stackoverflow.com/users/9801728/moxieball"}, "edited": false, "score": 0, "creation_date": 1550689521, "post_id": 54791808, "comment_id": 96365135, "body": "This sounds right to me, however OP seems to indicate that they never see the first message at all."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 1809, "user_id": 9801728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LXQkV.jpg?s=128&g=1", "display_name": "MoxieBall", "link": "https://stackoverflow.com/users/9801728/moxieball"}, "edited": false, "score": 0, "creation_date": 1550689720, "post_id": 54791808, "comment_id": 96365240, "body": "I inferred that same reading too @MoxieBall - which seemed impossible. Tried the code out in a real example - and &quot;slack&quot; message was always sent - just later if not flushed."}, {"owner": {"reputation": 1809, "user_id": 9801728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LXQkV.jpg?s=128&g=1", "display_name": "MoxieBall", "link": "https://stackoverflow.com/users/9801728/moxieball"}, "edited": false, "score": 0, "creation_date": 1550689775, "post_id": 54791808, "comment_id": 96365268, "body": "Thanks for testing it out."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 2, "last_activity_date": 1550683449, "last_edit_date": 1550683449, "creation_date": 1550682411, "answer_id": 54791808, "question_id": 54791455, "link": "https://stackoverflow.com/questions/54791455/how-to-make-my-function-return-to-slack-right-away/54791808#54791808", "title": "How to make my function return to Slack right away?", "body": "<p><code>http.ResponseWriter</code> streams are buffered by default. If you want data to be sent to a client in realtime (e.g. HTTP SSE), you need to flush the stream after each 'event':</p>\n\n<pre><code>wf, ok := w.(http.Flusher)\n\nif !ok {\n    http.Error(w, \"Streaming unsupported!\", http.StatusInternalServerError)\n    return\n}\n\nfmt.Fprintln(w, \"This should be printed to Slack first!\")\n\nwf.Flush()\n</code></pre>\n\n<p>Flushing is expensive - so take advantage of go's buffering. There will always be an implicit flush once your handler finally exits (hence why you saw your output 'late').</p>\n"}], "owner": {"reputation": 332, "user_id": 3510093, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/94cd3c49ac0024a6727f7a3d63bb40a5?s=128&d=identicon&r=PG&f=1", "display_name": "sedawkgrep", "link": "https://stackoverflow.com/users/3510093/sedawkgrep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 54791808, "answer_count": 2, "score": 1, "last_activity_date": 1550683449, "creation_date": 1550681289, "last_edit_date": 1550682038, "question_id": 54791455, "link": "https://stackoverflow.com/questions/54791455/how-to-make-my-function-return-to-slack-right-away", "title": "How to make my function return to Slack right away?", "body": "<p>I'm trying to develop a simple API for Slack and I want to return something to the user right away to avoid the 3000 ms timeout.</p>\n\n<p>Here are my questions:  </p>\n\n<ol>\n<li><p>Why the <code>This should be printed to Slack first</code> doesn't get printed right away, instead I only got the last message which is <code>The long and blocking process completed</code>? But it appears in ngrok log though.</p></li>\n<li><p>Why is my function still reaching the 3000 ms limit even though I'm already using a go routine? Is it because of the <code>done</code> channel?</p></li>\n</ol>\n\n<pre><code>func testFunc(w http.ResponseWriter, r *http.Request) {\n    // Return to the user ASAP to avoid 3000ms timeout.\n    // But this doesn't work. Nothing is returned but\n    // the message appeared in ngrok log.\n    fmt.Fprintln(w, \"This should be printed to Slack first!\")\n\n    // Get the response URL.\n    r.ParseForm()\n    responseURL := r.FormValue(\"response_url\")\n\n    done := make(chan bool)\n\n    go func() {\n        fmt.Println(\"Warning! This is a long and blocking process.\")\n        time.Sleep(5 * time.Second)\n\n        done &lt;- true\n    }()\n\n    // This works! I received this message. But I still reached the 3000ms timeout.\n    func(d bool) {\n        if d == true {\n            payload := map[string]string{\"text\": \"The long and blocking process completed!\"}\n            j, err := json.Marshal(payload)\n\n            if err != nil {\n                w.WriteHeader(http.StatusInternalServerError)\n            }\n\n            http.Post(responseURL, \"application/json\", bytes.NewBuffer(j))\n        }\n    }(&lt;-done)\n}\n</code></pre>\n"}, {"tags": ["go", "certificate", "csr"], "owner": {"reputation": 453, "user_id": 7211112, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/60424642a956f6850ca232c8e24bfb3e?s=128&d=identicon&r=PG&f=1", "display_name": "Vivi", "link": "https://stackoverflow.com/users/7211112/vivi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 249, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1590812467, "creation_date": 1550680278, "question_id": 54791135, "link": "https://stackoverflow.com/questions/54791135/how-to-create-a-certificate-signing-request-with-extensions-and-atributes-values", "title": "How to create a certificate signing request with extensions and atributes values in GO?", "body": "<p>I'm trying to use crypto/x509 package to create a certificate request (csr) but I can't figure out how to add extensions and atributes parameters.</p>\n\n<p>In <a href=\"https://golang.org/pkg/crypto/x509/#CertificateRequest\" rel=\"nofollow noreferrer\">CertificateRequest struct</a> we can see that extensions are pkix.Extension type. This is the structure of <a href=\"https://golang.org/pkg/crypto/x509/pkix/#Extension\" rel=\"nofollow noreferrer\">pki.Extension</a>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Extension struct {\n        Id       asn1.ObjectIdentifier\n        Critical bool `asn1:\"optional\"`\n        Value    []byte\n}\n</code></pre>\n\n<p>Searching in code I found the following constants in <a href=\"https://golang.org/src/crypto/x509/x509.go\" rel=\"nofollow noreferrer\">https://golang.org/src/crypto/x509/x509.go</a>:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var (\n    oidExtKeyUsageAny                            = asn1.ObjectIdentifier{2, 5, 29, 37, 0}\n    oidExtKeyUsageServerAuth                     = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 1}\n    oidExtKeyUsageClientAuth                     = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 2}\n    oidExtKeyUsageCodeSigning                    = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 3}\n    oidExtKeyUsageEmailProtection                = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 4}\n    oidExtKeyUsageIPSECEndSystem                 = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 5}\n    oidExtKeyUsageIPSECTunnel                    = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 6}\n    oidExtKeyUsageIPSECUser                      = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 7}\n    oidExtKeyUsageTimeStamping                   = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 8}\n    oidExtKeyUsageOCSPSigning                    = asn1.ObjectIdentifier{1, 3, 6, 1, 5, 5, 7, 3, 9}\n    oidExtKeyUsageMicrosoftServerGatedCrypto     = asn1.ObjectIdentifier{1, 3, 6, 1, 4, 1, 311, 10, 3, 3}\n    oidExtKeyUsageNetscapeServerGatedCrypto      = asn1.ObjectIdentifier{2, 16, 840, 1, 113730, 4, 1}\n    oidExtKeyUsageMicrosoftCommercialCodeSigning = asn1.ObjectIdentifier{1, 3, 6, 1, 4, 1, 311, 2, 1, 22}\n    oidExtKeyUsageMicrosoftKernelCodeSigning     = asn1.ObjectIdentifier{1, 3, 6, 1, 4, 1, 311, 61, 1, 1}\n)\n</code></pre>\n\n<p>Ok, now I have the Id of parameter. In my case, I want to set KeyUsage extension to serverAuth. I have the id but what is the value?</p>\n\n<p>I don't know if I am in the right way. Could someone help me with this?</p>\n"}, {"tags": ["go", "inheritance", "struct", "append", "slice"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1550677967, "post_id": 54789987, "comment_id": 96358945, "body": "There is no inheritance in Go. If you want to append (pointers to) Bs, you have to have a slice of (pointers to)  Bs."}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 11091096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e71264018f193d89ef7295d5816bbda?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/11091096/robin"}, "is_accepted": true, "score": 3, "last_activity_date": 1550678337, "creation_date": 1550678337, "answer_id": 54790470, "question_id": 54789987, "link": "https://stackoverflow.com/questions/54789987/append-a-struct-b-which-inherits-from-the-struct-a-to-a-slice-of-structs-a/54790470#54790470", "title": "append a struct B (which inherits from the struct A) to a slice of structs A", "body": "<p>col1.Cols is type *A, col2 is type *B, col2.A is type A, if you want to add new element to the slices, they should be of the same type.\nso if you change the last statement to </p>\n\n<pre><code>col1.Cols = append(col1.Cols, &amp;col2.A)\n</code></pre>\n\n<p>it will work. </p>\n"}], "owner": {"reputation": 1, "user_id": 11090821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/741cf547a76ebec08ec721be012774a7?s=128&d=identicon&r=PG&f=1", "display_name": "mano", "link": "https://stackoverflow.com/users/11090821/mano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54790470, "answer_count": 1, "score": -3, "last_activity_date": 1550678337, "creation_date": 1550677018, "question_id": 54789987, "link": "https://stackoverflow.com/questions/54789987/append-a-struct-b-which-inherits-from-the-struct-a-to-a-slice-of-structs-a", "title": "append a struct B (which inherits from the struct A) to a slice of structs A", "body": "<p>I have a struct B which inherits from the struct A. I have another struct C (which contains a slice of structs A) and I want to append B to C. </p>\n\n<pre><code>package main\n\ntype A struct {\n    target string\n}\n\ntype B struct{\n    A\n    values []int\n}\n\ntype C struct{\n    Cols []*A\n}\n\nfunc main() {\n\nvar values = []int{1,2,3}\nvar col1 = C{} \nvar col2 = &amp;B {\n    A: A{\n        target: \"txt\",\n    },\n    values: values,\n    }\n\ncol1.Cols = append(col1.Cols, col2)\n\n}\n</code></pre>\n\n<p>When running this code, it generates an error: cannot use col2 (type *B) as type *A in append</p>\n\n<p>What's wrong please ? I'm newer </p>\n\n<p>Ps: sorry for my bad English</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550676198, "post_id": 54789718, "comment_id": 96357803, "body": "What path would you use in Powershell?"}, {"owner": {"reputation": 13, "user_id": 9402926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf8ccc2b3f8562999e90eab4c16a514?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9402926/alex"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550676525, "post_id": 54789718, "comment_id": 96358020, "body": "@Adrian I meant ADB, sorry for the mistake"}], "owner": {"reputation": 13, "user_id": 9402926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf8ccc2b3f8562999e90eab4c16a514?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9402926/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550676491, "creation_date": 1550676126, "last_edit_date": 1550676491, "question_id": 54789718, "link": "https://stackoverflow.com/questions/54789718/go-access-smartphone-connected-to-pc", "title": "Go access smartphone connected to PC", "body": "<p>I'm trying to copy files from a pc to a smartphone. The problem is, that Windows doesn't assign the phone a drive-letter. It just shows up as 'Phone' (the device name).</p>\n\n<p>The path shown in the Explorer is 'This PC\\Phone\\SD card,' which is not a path that a go programm can use.</p>\n\n<p>Is there a way to directly copy the files or do I have to use ADB?</p>\n"}, {"tags": ["azure", "go", "azure-cosmosdb", "azure-cosmosdb-mongoapi"], "answers": [{"tags": [], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "is_accepted": false, "score": 0, "last_activity_date": 1551289616, "creation_date": 1551289616, "answer_id": 54911541, "question_id": 54788718, "link": "https://stackoverflow.com/questions/54788718/golang-cosmos-db-quickstart-missing-environment-variable-azure-database/54911541#54911541", "title": "golang COSMOS DB, quickstart, Missing Environment variable AZURE_DATABASE", "body": "<p>See the <strong>update</strong> above.  Very simple solution and works elegantly.</p>\n"}], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1551289616, "creation_date": 1550673111, "last_edit_date": 1551289559, "question_id": 54788718, "link": "https://stackoverflow.com/questions/54788718/golang-cosmos-db-quickstart-missing-environment-variable-azure-database", "title": "golang COSMOS DB, quickstart, Missing Environment variable AZURE_DATABASE", "body": "<p>UPDATE:</p>\n\n<ol>\n<li>GetEnvVarOrExit used in the init function, is deprecated. ( but probably still works )</li>\n</ol>\n\n<h2>2. ( this worked ) The quick solution is to simply edit the init() function this way...</h2>\n\n<pre><code>func init() {\n  // database = utils.GetEnvVarOrExit(\"AZURE_DATABASE\")\n  // password = utils.GetEnvVarOrExit(\"AZURE_DATABASE_PASSWORD\")\n  database = \"testDBForStart\"\n  password = \"lTy8axgO6O49JaR2GetYourOwnPasswordFromPortala7yNucQ==\"\n}\n</code></pre>\n\n<hr>\n\n<ol start=\"3\">\n<li>3rd Option is to set environment Var which is what the instructions call to do.  But Item 2 above works.  I did not use this option.  </li>\n</ol>\n\n<p><strong>The solution that worked for me was to just change the Init() function above to hard code Azure/Cosmos credentials.</strong></p>\n\n<hr>\n\n<h1>ORIGINAL QUESTION</h1>\n\n<p>I am trying to do the MS Azure Quick Start for GoLang and CosmosDB.\nI have a CosmosDB setup and confirmed </p>\n\n<ul>\n<li>Aggregation Pipleine Enabled </li>\n<li>MongoDB 3.4 wire Protocol ( version 5 ) enabled</li>\n<li>Per-Document TTL enabled</li>\n</ul>\n\n<p>The article I am following is:\n<a href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/create-mongodb-golang\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/azure/cosmos-db/create-mongodb-golang</a></p>\n\n<p>However, I am getting this error:</p>\n\n<pre><code>Missing environment variable AZURE_DATABASE\n</code></pre>\n\n<p>In the Azure/CosmosDB Control Pannel > Connection String</p>\n\n<pre><code>HOST: testDBForStart.documents.azure.com\n</code></pre>\n\n<p>thus DB should be vytest02?</p>\n\n<pre><code>USERNAME: testDBForStart\n\nPRIMARY PASSWORD: lTy8axgOveryfakePasswordpa7yNr8lZ1GoC5RoMucQ==\n</code></pre>\n\n<hr>\n\n<h2># CODE</h2>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"os\"\n    \"time\"\n\n    \"github.com/Azure/go-autorest/autorest/utils\"\n    \"gopkg.in/mgo.v2\"\n    \"gopkg.in/mgo.v2/bson\"\n)\n\nvar (\n    database string\n    password string\n)\n\nfunc init() {\n    database = utils.GetEnvVarOrExit(\"AZURE_DATABASE\")\n    password = utils.GetEnvVarOrExit(\"AZURE_DATABASE_PASSWORD\")\n}\n\n// Package represents a document in the collection\ntype Package struct {\n    Id            bson.ObjectId `bson:\"_id,omitempty\"`\n    FullName      string\n    Description   string\n    StarsCount    int\n    ForksCount    int\n    LastUpdatedBy string\n}\n\nfunc main() {\n    // DialInfo holds options for establishing a session with Azure Cosmos DB for MongoDB API account.\n        dialInfo := &amp;mgo.DialInfo{\n    Addrs:    []string{fmt.Sprintf(\"%s.documents.azure.com:10255\", database)}, // Get HOST + PORT\n    Timeout:  60 * time.Second,\n    Database: database, // It can be anything\n    Username: database, // Username\n    Password: password, // PASSWORD\n    DialServer: func(addr *mgo.ServerAddr) (net.Conn, error) {\n        return tls.Dial(\"tcp\", addr.String(), &amp;tls.Config{})\n    },\n\n    // Create a session which maintains a pool of socket connections\n    session, err := mgo.DialWithInfo(dialInfo)\n\n    if err != nil {\n        fmt.Printf(\"Can't connect, go error %v\\n\", err)\n        os.Exit(1)\n    }\n\n    defer session.Close()\n\n    // SetSafe changes the session safety mode.\n    // If the safe parameter is nil, the session is put in unsafe mode, and writes become fire-and-forget,\n    // without error checking. The unsafe mode is faster since operations won't hold on waiting for a confirmation.\n    // http://godoc.org/labix.org/v2/mgo#Session.SetMode.\n    session.SetSafe(&amp;mgo.Safe{})\n\n    // get collection\n    collection := session.DB(database).C(\"package\")\n\n    // insert Document in collection\n    err = collection.Insert(&amp;Package{\n        FullName:      \"react\",\n        Description:   \"A framework for building native apps with React.\",\n        ForksCount:    11392,\n        StarsCount:    48794,\n        LastUpdatedBy: \"shergin\",\n    })\n\n    if err != nil {\n        log.Fatal(\"Problem inserting data: \", err)\n        return\n    }\n\n    // Get Document from collection\n    result := Package{}\n    err = collection.Find(bson.M{\"fullname\": \"react\"}).One(&amp;result)\n    if err != nil {\n        log.Fatal(\"Error finding record: \", err)\n        return\n    }\n\n    fmt.Println(\"Description:\", result.Description)\n\n    // update document\n    updateQuery := bson.M{\"_id\": result.Id}\n    change := bson.M{\"$set\": bson.M{\"fullname\": \"react-native\"}}\n    err = collection.Update(updateQuery, change)\n    if err != nil {\n        log.Fatal(\"Error updating record: \", err)\n        return\n    }\n\n    // delete document\n    err = collection.Remove(updateQuery)\n    if err != nil {\n        log.Fatal(\"Error deleting record: \", err)\n        return\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1550670241, "post_id": 54787581, "comment_id": 96353903, "body": "Except for the case where the only operation on the cannel is a <code>close</code> you do <i>not</i> want to <code>make</code> a receive only channel as nobody would be able to send."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1550670564, "post_id": 54787581, "comment_id": 96354116, "body": "@Volker, <code>close</code> is a send operation, you can\u2019t close a read only channel either. The only thing it can do is block indefinitely on a receive."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1550673891, "post_id": 54787581, "comment_id": 96356272, "body": "@Volker I&#39;m not <code>make</code>ing a receive-only channel. I&#39;m <code>make</code>ing a regular send-receive channel. Then I&#39;m inserting receive-only channels into it, but those receive-only channels are of course &quot;upcasted&quot; from regular send-receive channels. Some other goroutine is holding the sending end of those channels."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550675509, "post_id": 54787581, "comment_id": 96357317, "body": "@JimB Yes, sorry. You do not want to make a <b>unidirectional</b> channel."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1550675636, "post_id": 54787581, "comment_id": 96357401, "body": "@Thomas While a chan-of-chan might be useful the question is of basically no relevance."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1550677167, "post_id": 54787581, "comment_id": 96358397, "body": "@Volker It was not obvious to me how to write this syntax. I could not find any information about how to do it, and <code>gofmt</code> kept &quot;correcting&quot; my code to something different from what I intended. Even when I realized that <code>gofmt</code> was just rewriting the code to match the compiler&#39;s interpretation, I still didn&#39;t know how to write this correctly. Hence this self-answered question. It may not be relevant to you, but that doesn&#39;t mean it&#39;s of &quot;no relevance&quot; to anyone."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550678588, "post_id": 54787581, "comment_id": 96359309, "body": "As a hint, when you format this (which you should always be doing), the statement is reformatted to <code>chan&lt;- chan int</code> which should be a good indication of how it&#39;s being evaluated and if you need parenthesis."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1550675658, "post_id": 54787582, "comment_id": 96357416, "body": "Bad use of type alias. A simple named type would do."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1550677572, "post_id": 54787582, "comment_id": 96358664, "body": "I think a type alias might have its uses (e.g. if the caller just wants a <code>&lt;-chan int</code> and not bother with your internal types), but OK, I&#39;ll change it."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 4, "last_activity_date": 1550677516, "last_edit_date": 1550677516, "creation_date": 1550669649, "answer_id": 54787582, "question_id": 54787581, "link": "https://stackoverflow.com/questions/54787581/how-to-create-a-channel-of-receive-only-channels/54787582#54787582", "title": "How to create a channel of receive-only channels?", "body": "<p>The answer is simple: add parentheses.</p>\n\n<pre><code>c := make(chan (&lt;-chan int))\n</code></pre>\n\n<p>An alternative, which might be more readable in some situations, would be to create a new type for the inner channel:</p>\n\n<pre><code>type ReceiveOnlyIntChan &lt;-chan int\nc := make(chan ReceiveOnlyIntChan)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1550689750, "last_edit_date": 1592644375, "creation_date": 1550679969, "answer_id": 54791034, "question_id": 54787581, "link": "https://stackoverflow.com/questions/54787581/how-to-create-a-channel-of-receive-only-channels/54791034#54791034", "title": "How to create a channel of receive-only channels?", "body": "<p>If something is unclear regarding Go's syntax, the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">language specification</a> should be the first thing to check. Compared to other languages, Go's spec is more readable and shorter.</p>\n<p>Exactly this is mentioned in <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow noreferrer\">Spec: Channel types:</a></p>\n<blockquote>\n<p>The <code>&lt;-</code> operator associates with the leftmost <code>chan</code> possible:</p>\n<pre><code>chan&lt;- chan int    // same as chan&lt;- (chan int)\nchan&lt;- &lt;-chan int  // same as chan&lt;- (&lt;-chan int)\n&lt;-chan &lt;-chan int  // same as &lt;-chan (&lt;-chan int)\nchan (&lt;-chan int)\n</code></pre>\n</blockquote>\n<p>The answer is there clear and simple in these few quoted lines.</p>\n<ul>\n<li>The <strong>reason</strong> for what you experience: the <code>&lt;-</code> operator associates with the leftmost <code>chan</code> possible.</li>\n<li>The <strong>meaning</strong> of what you've tried: <code>chan&lt;- chan int</code> is the same as <code>chan&lt;- (chan int)</code></li>\n<li>The <strong>solution</strong> to what you want to achieve (the last line): <code>chan (&lt;-chan int)</code></li>\n</ul>\n"}], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 54791034, "answer_count": 2, "score": 0, "last_activity_date": 1550692409, "creation_date": 1550669649, "last_edit_date": 1550692409, "question_id": 54787581, "link": "https://stackoverflow.com/questions/54787581/how-to-create-a-channel-of-receive-only-channels", "title": "How to create a channel of receive-only channels?", "body": "<p>I want to create a channel from which someone can only pull receive-only channels, for instance:</p>\n\n<pre><code>c := make(chan &lt;-chan int)\n</code></pre>\n\n<p>However, I can't read from this channel:</p>\n\n<pre><code>invalid operation: &lt;-c (receive from send-only type chan&lt;- chan int)\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/_LgvgCsY2nQ\" rel=\"nofollow noreferrer\">Playground link</a>) From the error message, it's clear that my syntax <code>chan &lt;-chan</code> is interpreted as <code>chan&lt;- chan</code>, i.e. a send-only channel of channels. Running <code>gofmt</code> even changes the code to reflect this.</p>\n\n<p>So how do I denote the channel type I want?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 0, "last_activity_date": 1550670990, "last_edit_date": 1550670990, "creation_date": 1550669375, "answer_id": 54787496, "question_id": 54787400, "link": "https://stackoverflow.com/questions/54787400/how-to-convert-map-of-map-of-interface-to-string/54787496#54787496", "title": "How to convert map of map of interface to string", "body": "<p>You can use something like <code>Sprintf</code>:</p>\n\n<pre><code>func main() {\n    d1 := map[string][]interface{}{\n        \"a\": []interface{}{20, \"hello\"},\n        \"b\": []interface{}{100}}\n    d2 := map[string][]interface{}{\n        \"x\": []interface{}{\"str\", 10, 20},\n    }\n\n    m := make(map[string]map[string][]interface{})\n    m[\"d1\"] = d1\n    m[\"d2\"] = d2\n\n    s := fmt.Sprintf(\"%v\", m)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Or you could also do that with the <code>json</code> module to convert to a JSON string with <code>json.Marshal</code>. If the actual runtime type behind your <code>interface{}</code> is marshal-able to JSON, <code>json.Marshal</code> will figure it out on its own.</p>\n\n<pre><code>b, _ := json.Marshal(m)\nfmt.Println(string(b))\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 727277, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b3eecf0381bf842301b2c0366b577cf1?s=128&d=identicon&r=PG", "display_name": "surendra", "link": "https://stackoverflow.com/users/727277/surendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6763, "favorite_count": 0, "accepted_answer_id": 54787496, "answer_count": 1, "score": -1, "last_activity_date": 1569075471, "creation_date": 1550669031, "last_edit_date": 1569075471, "question_id": 54787400, "link": "https://stackoverflow.com/questions/54787400/how-to-convert-map-of-map-of-interface-to-string", "title": "How to convert map of map of interface to string", "body": "<p>I am newer to go lang and I have a type of variable like below:</p>\n\n<pre><code>type ResultData map[string]map[string][]interface{}\n</code></pre>\n\n<p>When I receive data in this variable, how do I convert the whole data into single string in Go?</p>\n"}, {"tags": ["docker", "go", "dockerfile"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1550658166, "post_id": 54783910, "comment_id": 96346373, "body": "Is <code>.env</code> blacklisted in <code>.dockerignore</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 2, "creation_date": 1550661975, "post_id": 54784735, "comment_id": 96348885, "body": "i think it should be said that solutions to embed files to a go bin exists, see for example <a href=\"https://github.com/gobuffalo/packr\" rel=\"nofollow noreferrer\">github.com/gobuffalo/packr</a>"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 2, "creation_date": 1550665763, "post_id": 54784735, "comment_id": 96351180, "body": "Also also, in the absence of a <code>WORKDIR</code>, the final Dockerfile stage will run out of the container&#39;s root directory; if the program is looking for <code>$PWD&#47;.env</code> or <code>$HOME&#47;.env</code> it&#39;s worth checking that those line up."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 3, "last_activity_date": 1550662299, "last_edit_date": 1550662299, "creation_date": 1550660440, "answer_id": 54784735, "question_id": 54783910, "link": "https://stackoverflow.com/questions/54783910/include-env-file-in-go-build-command/54784735#54784735", "title": "Include .env file in `go build` command", "body": "<p>You cannot include non-go files in the <code>go build</code> process. The Go tool doesn't support \"embedding\" arbitrary files into the final executable.</p>\n\n<p>You should use <code>go build</code> to build your executable then, any non-go files, e.g. templates, images, config files, need to be made available to that executable. That is; the executable needs to know where the non-go files are on the filesystem of the host machine on which the go program is running, and then open and read them as needed. So forget about embeding <code>.env</code> into <code>main</code>, instead copy <code>.env</code> together with <code>main</code> to the same location from which you want to run <code>main</code>.</p>\n\n<p>Then the issue with your dockerfile is the fact that the target host only copies the final executable file from go-compile (<code>COPY --from=go-compile /app/main /app/main</code>), it doesn't copy any other files that are present in the go-compile image and therefore your <code>main</code> app cannot access <code>.env</code> since they are not on the same host.</p>\n\n<hr>\n\n<p>As pointed out in the comments by @mh-cbon, there do exist 3rd-party solutions for embedding non-go files into the go binary, one of which is <a href=\"https://github.com/gobuffalo/packr\" rel=\"nofollow noreferrer\"><code>gobuffalo/packr</code></a>.</p>\n"}], "owner": {"reputation": 181, "user_id": 8098544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49f5016b496a8e5eec53a38eac15e4f?s=128&d=identicon&r=PG", "display_name": "Ben Rolfe", "link": "https://stackoverflow.com/users/8098544/ben-rolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1375, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550662299, "creation_date": 1550657971, "question_id": 54783910, "link": "https://stackoverflow.com/questions/54783910/include-env-file-in-go-build-command", "title": "Include .env file in `go build` command", "body": "<p>I have the following <strong>Dockerfile</strong> which builds an image for my Go project.</p>\n\n<pre><code>FROM golang:1.11.2-alpine3.8 as go-compile\n\nRUN apk update &amp;&amp; apk add git\nRUN mkdir /app\nCOPY src/ /app\nWORKDIR /app\n\nRUN go get github.com/joho/godotenv\n\nRUN go build -o main .\n\nFROM alpine:latest\n\nRUN mkdir /app\nCOPY --from=go-compile /app/main /app/main\n\nCMD [\"/app/main\"]\n</code></pre>\n\n<p>The image builds, but my \".env\" file is not included in the Docker image.</p>\n\n<p>I've tried to copy the \".env\" from the <code>src</code> folder into the image using <code>COPY src/.env /app/.env</code>, but still the Go code can't find/read the file.</p>\n\n<p>How can I include the \".env\" file, or in fact any other non Go file?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 7006974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PrbJXQ2PwAs/AAAAAAAAAAI/AAAAAAAAAO8/m9xsDIL-uDY/photo.jpg?sz=128", "display_name": "L RodMrez", "link": "https://stackoverflow.com/users/7006974/l-rodmrez"}, "edited": false, "score": 0, "creation_date": 1550653393, "post_id": 54782127, "comment_id": 96343417, "body": "Thanks a lot for your answer, very clear and precise explanation. Nice job!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 11, "last_activity_date": 1550663955, "last_edit_date": 1592644375, "creation_date": 1550652320, "answer_id": 54782127, "question_id": 54782079, "link": "https://stackoverflow.com/questions/54782079/why-exactly-is-there-a-capacity-parameter-when-creating-a-slice-in-golang/54782127#54782127", "title": "Why exactly is there a CAPACITY parameter when creating a slice in Golang", "body": "<blockquote>\n<p>If the <strong>capacity</strong> of a slice in Golang can be exceeded, why is there a capacity parameter in the first place?</p>\n</blockquote>\n<p>I don't know what you mean by this, but the capacity can't be exceeded. Slices can be indexed up to its length (exclusive) which can't exceed the capacity, and they can be re-sliced up to its capacity (inclusive).</p>\n<p><a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"nofollow noreferrer\">Spec: Index expressions:</a></p>\n<blockquote>\n<p>A primary expression of the form <code>a[x]</code></p>\n<p>If <code>a</code> is not a map: ...the index <code>x</code> is <em>in range</em> if <code>0 &lt;= x &lt; len(a)</code>, otherwise it is <em>out of range</em></p>\n</blockquote>\n<p>And <a href=\"https://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow noreferrer\">Spec: Slice expressions:</a></p>\n<blockquote>\n<p>...the primary expression: <code>a[low : high]</code></p>\n<p>For arrays or strings, the indices are <em>in range</em> if <code>0 &lt;= low &lt;= high &lt;= len(a)</code>, otherwise they are <em>out of range</em>. For slices, the upper index bound is the slice capacity <code>cap(a)</code> rather than the length.</p>\n</blockquote>\n<p>And also:</p>\n<blockquote>\n<p>...the primary expression: <code>a[low : high : max]</code></p>\n<p>The indices are <em>in range</em> if <code>0 &lt;= low &lt;= high &lt;= max &lt;= cap(a)</code>, otherwise they are <em>out of range</em>.</p>\n</blockquote>\n<p>You may provide the capacity to the builtin <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow noreferrer\"><code>make()</code></a> thinking of future growth, so fewer allocations will be needed should you need to append elements to it or should you need to reslice it. The builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a> just reslices the slice you append to if it has enough capacity for the additional elements, but it has to allocate a new backing array (and copy the existing contents into it) if it has no room for the new elements. <code>append()</code> will return the new slice which may or may not point to the original backing array.</p>\n<p>Let's see an example. Let's create a slice with 0 length and capacity, and append 10 elements to it. And to see when a new reallocation happens, we also print the address of its first element (the 0th element):</p>\n<pre><code>fmt.Println(&quot;With 0 capacity&quot;)\ns := make([]int, 0)\nfor i := 0; i &lt; 10; i++ {\n    s = append(s, i)\n    fmt.Println(i, &amp;s[0])\n}\n</code></pre>\n<p>This outputs:</p>\n<pre><code>With 0 capacity\n0 0x416030\n1 0x416030\n2 0x416040\n3 0x416040\n4 0x452000\n5 0x452000\n6 0x452000\n7 0x452000\n8 0x434080\n9 0x434080\n</code></pre>\n<p>As you can see, a new backing array is allocated when we appended the third (<code>i=2</code>), fifth (<code>i=4</code>) and ninth elements (<code>i=8</code>), and also when we appended the first element (as the original backing array could not hold any elements).</p>\n<p>Now let's repeat the above example when we create the initial slice with again length = 0 but with capacity = 10:</p>\n<pre><code>fmt.Println(&quot;With 10 capacity&quot;)\ns = make([]int, 0, 10)\nfor i := 0; i &lt; 10; i++ {\n    s = append(s, i)\n    fmt.Println(i, &amp;s[0])\n}\n</code></pre>\n<p>Now output will be:</p>\n<pre><code>With 10 capacity\n0 0x44c030\n1 0x44c030\n2 0x44c030\n3 0x44c030\n4 0x44c030\n5 0x44c030\n6 0x44c030\n7 0x44c030\n8 0x44c030\n9 0x44c030\n</code></pre>\n<p>As you can see, the address of the first element never changed, which means there were no new backing array allocations happening in the background.</p>\n<p>Try the example on the <a href=\"https://play.golang.org/p/gNgc65ubVG0\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3736659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47ea822f0d6a8a50a0fac931ec585a79?s=128&d=identicon&r=PG&f=1", "display_name": "Mohit Pawar", "link": "https://stackoverflow.com/users/3736659/mohit-pawar"}, "is_accepted": false, "score": 2, "last_activity_date": 1550744206, "last_edit_date": 1550744206, "creation_date": 1550663453, "answer_id": 54785726, "question_id": 54782079, "link": "https://stackoverflow.com/questions/54782079/why-exactly-is-there-a-capacity-parameter-when-creating-a-slice-in-golang/54785726#54785726", "title": "Why exactly is there a CAPACITY parameter when creating a slice in Golang", "body": "<p><strong>To increase the capacity of a slice one must create a new, larger slice and copy the contents of the original slice into it.</strong></p>\n\n<blockquote>\n  <p>If the capacity of a slice in Golang can be exceeded, why is there a\n  capacity parameter in the first place?</p>\n</blockquote>\n\n<p>Suppose we know ahead of time the capacity of slice, then we can use capacity parameter of make built in function to allocate memory instead of increasing capacity of slice dynamically using append which is not that memory efficient.</p>\n\n<p>so in below example</p>\n\n<pre><code>type Element struct {\n    Number int\n}\n\nfunc main() {\n    Max := 100000\n    startTime := time.Now()\n\n    // Capacity given\n    elements1 := make([]Element, Max, Max)\n    for i := 0; i &lt; Max; i++ {\n        elements1[i].Number = i\n    }\n    elapsedTime := time.Since(startTime)\n    fmt.Println(\"Total Time Taken with Capacity in first place: \", elapsedTime)\n\n    startTime = time.Now()\n    // Capacity not given\n    elements2 := make([]Element, 0)\n    for i := 0; i &lt; Max; i++ {\n        elements2 = append(elements2, Element{Number: i})\n    }\n    elapsedTime = time.Since(startTime)\n    fmt.Println(\"Total Time Taken without capacity: \", elapsedTime)\n}\n\noutput\n\nTotal Time Taken with Capacity in first place:  121.084\u00b5s\nTotal Time Taken without capacity:  2.720059ms\n\n</code></pre>\n\n<p>Time Taken to build slice with capacity at first place is less that to build dynamically</p>\n\n<p>So to answer you question, capacity parameter is in the first place for better performance and memory efficiency </p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1550672820, "creation_date": 1550672820, "answer_id": 54788636, "question_id": 54782079, "link": "https://stackoverflow.com/questions/54782079/why-exactly-is-there-a-capacity-parameter-when-creating-a-slice-in-golang/54788636#54788636", "title": "Why exactly is there a CAPACITY parameter when creating a slice in Golang", "body": "<p>There are many excellent posts in the golang blog. This <a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">one on slices</a>, will give you a detailed insight into the underlying implementation of slices and how capacity works.</p>\n\n<p>The post goes through how the <code>append</code> operation works and how the capacity value lets <code>append</code> know whether to reuse the underlying memory array, or allocate a bigger array when more capacity is needed.</p>\n"}], "owner": {"reputation": 89, "user_id": 7006974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PrbJXQ2PwAs/AAAAAAAAAAI/AAAAAAAAAO8/m9xsDIL-uDY/photo.jpg?sz=128", "display_name": "L RodMrez", "link": "https://stackoverflow.com/users/7006974/l-rodmrez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 54782127, "answer_count": 3, "score": 2, "last_activity_date": 1550744206, "creation_date": 1550652154, "question_id": 54782079, "link": "https://stackoverflow.com/questions/54782079/why-exactly-is-there-a-capacity-parameter-when-creating-a-slice-in-golang", "title": "Why exactly is there a CAPACITY parameter when creating a slice in Golang", "body": "<p>This is a pretty straightforward question: </p>\n\n<p>If the <strong>capacity</strong> of a slice in Golang can be exceeded, why is there a capacity parameter in the first place?</p>\n\n<p>I reckon this has to do with the <strong>memory management</strong>, some kind of \"knowing where to allocate the slice in memory\" but I don't know exactly.</p>\n"}, {"tags": ["go", "compiler-construction", "yacc", "lex"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 2608764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f313b77899bb307f89a6483d53807d33?s=128&d=identicon&r=PG", "display_name": "Stivenson", "link": "https://stackoverflow.com/users/2608764/stivenson"}, "edited": false, "score": 0, "creation_date": 1550674835, "post_id": 54788981, "comment_id": 96356870, "body": "oh ok. thanks for you answer. I have a theoretical emptiness. The examples that i found are confusing for me and complex for someone who is starting and other example are with C language.   How would you make a simple implementation of this?"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 23, "user_id": 2608764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f313b77899bb307f89a6483d53807d33?s=128&d=identicon&r=PG", "display_name": "Stivenson", "link": "https://stackoverflow.com/users/2608764/stivenson"}, "edited": false, "score": 0, "creation_date": 1550676209, "post_id": 54788981, "comment_id": 96357811, "body": "I did a search for &quot;golang goyacc lexical analysis&quot;. I can&#39;t say the results were perfect. Many of them were pretty complicated; others were reimplementations of flex by people who may or may not have any expertise in the area and in any case don&#39;t document well. And others don&#39;t actually use goyacc despite it being in the search. However, <a href=\"https://about.sourcegraph.com/go/gophercon-2018-how-to-write-a-parser-in-go\" rel=\"nofollow noreferrer\">GopherCon 2018 - How to Write a Parser in Go</a> is actually about writing simple parsers using goyacc and includes code for several small lexers. Good luck."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 23, "user_id": 2608764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f313b77899bb307f89a6483d53807d33?s=128&d=identicon&r=PG", "display_name": "Stivenson", "link": "https://stackoverflow.com/users/2608764/stivenson"}, "edited": false, "score": 0, "creation_date": 1550676369, "post_id": 54788981, "comment_id": 96357921, "body": "@stivenson. <b>Note:</b> I&#39;m not endorsing the tutorial in the previous comment. In fact, SO guidelines recommend not asking for (or providing) links to tutorials, because they tend to be opinionated. I actually have no opinion on that link, since I&#39;m not a Go programmer and I didn&#39;t read it thoroughly. Still, it might help you. From a <i>theoretical</i> perspective, you might find that a book or other resource about parsing theory is helpful, even if Go is not the target language. The theoretical concepts are the same."}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 1, "last_activity_date": 1550673954, "creation_date": 1550673954, "answer_id": 54788981, "question_id": 54779531, "link": "https://stackoverflow.com/questions/54779531/problem-yacc-in-golang-syntax-error-unexpected-end/54788981#54788981", "title": "Problem yacc in golang: syntax error: unexpected $end", "body": "<p>When your parser needs to know what the next input symbol (\"token\") is, it calls the <code>yyLexer</code>'s <code>Lex</code> method. Your implementation of that makes no attempt to read a token. Instead, it just returns 0:</p>\n\n<pre><code>func (f *mlex) Lex(lval *yySymType) int {\n    yyErrorVerbose = true\n    return 0\n}\n</code></pre>\n\n<p>So from the parser's perspective, it is being given an empty input stream, regardless of what input you might actually have provided. It then attempts to parse this empty input, but your grammar doesn't permit it. The only valid inputs start with the tokens <code>DB</code> or <code>OTHER_DB</code>, and it doesn't see either of those things.</p>\n\n<p>So it produces the error message, detailing exactly what its problem is. (The parser represents the end of input with the internal pseudo-token <code>$end</code>, in case that was confusing you.)</p>\n"}], "owner": {"reputation": 23, "user_id": 2608764, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f313b77899bb307f89a6483d53807d33?s=128&d=identicon&r=PG", "display_name": "Stivenson", "link": "https://stackoverflow.com/users/2608764/stivenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550673954, "creation_date": 1550641340, "last_edit_date": 1550642818, "question_id": 54779531, "link": "https://stackoverflow.com/questions/54779531/problem-yacc-in-golang-syntax-error-unexpected-end", "title": "Problem yacc in golang: syntax error: unexpected $end", "body": "<p>A cordial greeting.</p>\n\n<p>I'm learning yacc in golang and i created this file:</p>\n\n<pre><code>%{\n\npackage main\n\nimport (\n    \"fmt\"\n)\n\n%}\n\n%union{\n    ex string\n}\n\n%token &lt;ex&gt; DB OTHER_DB\n\n%% \nquery:  other\n        |\n        db\n        ;\n\ndb:     DB\n        {\n            fmt.Printf(\"\\tDB: %s\\n\", $1 )\n        }\n        ;\n\nother:  OTHER_DB\n        {\n            fmt.Printf(\"\\tOTHER_DB: %s\\n\", $1 )\n        }\n        ;\n%% \n\ntype mlex struct {\n    expr   string\n    result int\n}\n\nfunc (f *mlex) Lex(lval *yySymType) int {\n    yyErrorVerbose = true\n    return 0\n}\n\nfunc (f *mlex) Error(s string) {\n    fmt.Printf(\"syntax error: %s\\n\", s)\n}\n\nfunc Parse(expr string) int {\n    m := &amp;mlex{expr, 0}\n    yyParse(m)\n    return m.result\n}\n</code></pre>\n\n<p>but when executing it I get this error:</p>\n\n<blockquote>\n  <p>syntax error: syntax error: unexpected $end, expecting DB or OTHER_DB</p>\n</blockquote>\n\n<p>I have been testing this yacc file with this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    res := Parse(\"db\")\n    fmt.Println(res)\n}\n</code></pre>\n\n<p><strong>What could it be ? Will I need anything else in the yacc file?</strong></p>\n\n<p>I am trying to make a very simple, fully functional example to understand it well.</p>\n\n<p>Thanks for your time. </p>\n"}, {"tags": ["docker", "go", "docker-api"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "edited": false, "score": 0, "creation_date": 1550679666, "post_id": 54779333, "comment_id": 96359990, "body": "follwoing is the permissions to vendor directory in docker enviroment. I think it is fine.Kindly let me kow if it is not fine <code>drwxrwxr-x  9 vignesh vignesh   4096 Feb 20 21:43 vendor</code>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "edited": false, "score": 0, "creation_date": 1550742300, "post_id": 54779333, "comment_id": 96384352, "body": "yes it is find but when you copy a new folder it will default to other permissions so try to run that recursively and try again. I solved the same issue using that."}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1550640084, "creation_date": 1550640084, "answer_id": 54779333, "question_id": 54779211, "link": "https://stackoverflow.com/questions/54779211/not-able-to-use-packages-in-vendor-directory-in-dockers-repository/54779333#54779333", "title": "not able to use packages in vendor directory in docker&#39;s repository", "body": "<p>It will work just try to provide user permissions to the vendor directory in docker environment. Beucase the vendor path to import the package is correct. </p>\n\n<blockquote>\n  <p>Import  in golang works as:- First it will import the package from\n  vendor directory if not it will look for <code>$GOPATH</code> src directory for\n  the same package.</p>\n</blockquote>\n\n<p>The error says it cannot find the package at any of the given paths. But you have it in the vendor directory so this can be any permission issue.</p>\n\n<p>Since it happens if you are working on a linux the permissions will not allow to access the vendor directory.</p>\n\n<p>Also it is better not to copy rather to generate a vendor package using <code>Gopkg.toml</code> in the docker.</p>\n"}, {"comments": [{"owner": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "edited": false, "score": 0, "creation_date": 1550679401, "post_id": 54783113, "comment_id": 96359820, "body": "I moved all of dockers vendored dependencies to my vendor directory. But then I am getting following errors <code>..&#47;docker&#47;docker&#47;client&#47;container_commit.go:9:2: cannot find package &quot;github.com&#47;docker&#47;distribution&#47;reference&quot; in any of: \t&#47;usr&#47;local&#47;go&#47;src&#47;github.com&#47;docker&#47;distribution&#47;reference (from $GOROOT) \t&#47;home&#47;vignesh&#47;go-book&#47;src&#47;github.com&#47;docker&#47;distribution&#47;re&zwnj;&#8203;ference (from $GOPATH) </code>"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1550655573, "creation_date": 1550655573, "answer_id": 54783113, "question_id": 54779211, "link": "https://stackoverflow.com/questions/54779211/not-able-to-use-packages-in-vendor-directory-in-dockers-repository/54783113#54783113", "title": "not able to use packages in vendor directory in docker&#39;s repository", "body": "<p>Theses two directories are not equivalent:</p>\n\n<pre><code>github.com/docker/docker/vendor/github.com/docker/go-connections/nat\ngithub.com/my_fabric/vendor/go-connections/nat\n</code></pre>\n\n<p>You have to move (not copy) all of Docker's vendored dependencies unchanged into your own vendor directory, e.g. the following directory should exist:</p>\n\n<pre><code>github.com/my_fabric/vendor/github.com/docker/go-connections/nat\n</code></pre>\n\n<p>Note the <code>github.com/docker</code> segments. If you <em>copy</em> the directories you'll end up with two copies of the packages, which will get you into trouble. For instance, you end up with the distinct types </p>\n\n<pre><code>\"github.com/docker/docker/vendor/github.com/docker/go-connections/nat\".Port\n\"github.com/docker/go-connections/nat\".Port\n</code></pre>\n\n<p>You don't have to change your import statements at all.</p>\n"}], "owner": {"reputation": 79, "user_id": 8371222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7260680a42d0df879dc21584b5e09e41?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh k", "link": "https://stackoverflow.com/users/8371222/vignesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 710, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550655573, "creation_date": 1550639269, "question_id": 54779211, "link": "https://stackoverflow.com/questions/54779211/not-able-to-use-packages-in-vendor-directory-in-dockers-repository", "title": "not able to use packages in vendor directory in docker&#39;s repository", "body": "<p>I am trying to create a container with docker's go api. I want to expose a port using <code>container.Config.ExposedPorts</code> in <code>ContainerCreate()</code>API. Below is the code</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"context\"\n        \"github.com/docker/docker/api/types/container\"\n        \"github.com/docker/docker/client\"\n        \"github.com/docker/go-connections/nat\"\n)\n\nfunc main() {\n\n        ctx := context.Background()\n        cli, err := client.NewClientWithOpts(client.WithVersion(\"1.38\"))\n        if err != nil {\n                fmt.Println(\"Failed to get container envoronment\", err)\n        }   \n\n        resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n                Image: \"hyperledger/fabric-ca\",\n                Cmd:   []string{\"/bin/sh\", \"-c\", \"fabric-ca-server start -b admin:adminpw\"},\n                Env: []string{\"FABRIC_CA_HOME=/etc/hyperledger/fabric-ca-server\",\n                        \"FABRIC_CA_SERVER_CA_NAME=ca.example.com\"},\n                ExposedPorts: nat.PortSet{\"22/tcp\":struct{}{},},\n        }, nil, nil, \"ca.example.com\")\n\n\n        if err != nil {\n                fmt.Println(\" failed to create container, err:\", err)\n        } else {\n                fmt.Println(\" Container ID :\", resp.ID, \"warning:\", resp.Warnings, \"err:\", err)\n        }   \n}\n</code></pre>\n\n<p>when I compile I get the below error</p>\n\n<pre><code>vignesh@vignesh-ThinkPad-E470 ~/go-book/src/github.com/my_fabric $ go build asd.go \nasd.go:8:9: cannot find package \"github.com/docker/go-connections/nat\" in any of:\n    /home/vignesh/go-book/src/github.com/my_fabric/vendor/github.com/docker/go-connections/nat (vendor tree)\n    /usr/local/go/src/github.com/docker/go-connections/nat (from $GOROOT)\n    /home/vignesh/go-book/src/github.com/docker/go-connections/nat (from $GOPATH)\n</code></pre>\n\n<p>As package <code>\"github.com/docker/go-connections/nat\"</code> is in a vendor directory at <code>\"github.com/docker/docker/vendor/github.com/docker/go-connections/nat\"</code>, I then created a vendor directory in my working directory and copied contents of <code>github.com/docker/docker/vendor/github.com/docker/go-connections/nat</code> to <code>github.com/my_fabric/vendor/go-connections/nat</code> and used <code>\"github.com/my_fabric/go-connections/nat\"</code> in import rather than <code>\"github.com/docker/go-connections/nat\"</code>. But I got the following error.</p>\n\n<pre><code>vignesh@vignesh-ThinkPad-E470 ~/go-book/src/github.com/my_fabric $ go build asd.go \n# command-line-arguments\n./asd.go:25:29: cannot use \"github.com/my_fabric/vendor/github.com/my_fabric/go-connections/nat\".PortSet literal (type \"github.com/my_fabric/vendor/github.com/my_fabric/go-connections/nat\".PortSet) as type \"github.com/docker/docker/vendor/github.com/docker/go-connections/nat\".PortSet in field value\n</code></pre>\n\n<p>Basically I want to use packages which is in vendor directory in docker's repository. Kindly help :)</p>\n"}, {"tags": ["json", "rest", "go"], "comments": [{"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 0, "creation_date": 1550638602, "post_id": 54778865, "comment_id": 96337164, "body": "How are you currently unmarshaling your json into a Go struct?"}, {"owner": {"reputation": 534, "user_id": 6192935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh4.googleusercontent.com/-WzVJWA1aLts/AAAAAAAAAAI/AAAAAAAABfQ/FxZhI2PBCBA/photo.jpg?sz=128", "display_name": "Manish Champaneri", "link": "https://stackoverflow.com/users/6192935/manish-champaneri"}, "edited": false, "score": 0, "creation_date": 1550653914, "post_id": 54778865, "comment_id": 96343713, "body": "You can use json.RawMessage  refer to this answer  : <a href=\"https://stackoverflow.com/questions/11066946/partly-json-unmarshal-into-a-map-in-go\" title=\"partly json unmarshal into a map in go\">stackoverflow.com/questions/11066946/&hellip;</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550675067, "post_id": 54778865, "comment_id": 96357025, "body": "If you unmarshal JSON over top of an already-populated struct, only the fields in the JSON will be modified in the struct, making this trivially easy - load the record from DB, unmarshal the JSON over it, then write it back to DB. Can you show what you&#39;ve tried and what issues you&#39;re having with it?"}, {"owner": {"reputation": 9502, "user_id": 1377895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08b21d815dc9a832a99bf93b6f28f01b?s=128&d=identicon&r=PG", "display_name": "Roman Vottner", "link": "https://stackoverflow.com/users/1377895/roman-vottner"}, "edited": false, "score": 0, "creation_date": 1550675144, "post_id": 54778865, "comment_id": 96357069, "body": "Note that by <a href=\"https://tools.ietf.org/html/rfc7231#section-4.3.4\" rel=\"nofollow noreferrer\">RFC 7231</a> you either need to use <code>PATCH</code> to perform a partial update or update a resource via <code>PUT</code> that partially overlap the actual resource. To the actual resource this has the effect of a partial update then, though the semantics of <code>PUT</code> remain: replace the current payload of the targeted resource with the payload provided in the request. Anything other is a violation of the HTTP protocol. Also, patching should send instructions to the server on how to modify the resource to end up in a desired state."}, {"owner": {"reputation": 9502, "user_id": 1377895, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/08b21d815dc9a832a99bf93b6f28f01b?s=128&d=identicon&r=PG", "display_name": "Roman Vottner", "link": "https://stackoverflow.com/users/1377895/roman-vottner"}, "edited": false, "score": 0, "creation_date": 1550675220, "post_id": 54778865, "comment_id": 96357111, "body": "The closest thing you might want to do is <code>PATCH</code>ing the resource with media-type <code>application&#47;merge-patch+json</code> as spedified in <a href=\"https://tools.ietf.org/html/rfc7396\" rel=\"nofollow noreferrer\">RFC 7396</a> and only for such media-types. I&#39;d still recommend to use <code>application&#47;json-patch+json</code> as specified in <a href=\"https://tools.ietf.org/html/rfc6902\" rel=\"nofollow noreferrer\">RFC 6902</a> though"}], "answers": [{"comments": [{"owner": {"reputation": 922, "user_id": 1064473, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8ad795aafc17a286a84cf4afccf33a99?s=128&d=identicon&r=PG", "display_name": "Khoi Nguyen", "link": "https://stackoverflow.com/users/1064473/khoi-nguyen"}, "edited": false, "score": 0, "creation_date": 1550643705, "post_id": 54779173, "comment_id": 96338878, "body": "Thanks @Saurav Prakash, but if I want to update value of Age to 0, it&#39;s impossible with this framework"}], "tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": false, "score": 2, "last_activity_date": 1550639007, "creation_date": 1550639007, "answer_id": 54779173, "question_id": 54778865, "link": "https://stackoverflow.com/questions/54778865/rest-api-update-by-partial-json/54779173#54779173", "title": "REST API Update by partial json", "body": "<p>If the Update request uses the same <code>Customer</code> struct then the struct fields could be pointers to differentiate between zero value and value not being set in the JSON.<br>\nNow all you need to do is merge existing struct into updated <code>Consumer</code> struct.<br>\nFor this you can use <a href=\"https://github.com/imdario/mergo\" rel=\"nofollow noreferrer\">https://github.com/imdario/mergo</a> library in Go.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/imdario/mergo\"\n    \"encoding/json\"\n    \"os\"\n)\n\ntype Address struct {\n    City string `json:\"city\"`\n}\n\ntype Customer struct {\n    Id      int64 `json:\"id\"`\n    Name    string `json:\"name\"`\n    Age     int `json:\"age\"`\n    Address *Address `json:\"address\"`\n}\n\n\nfunc main() {\n    old1 := &amp;Customer{Id:1, Name:\"alpha\", Age:5, Address:&amp;Address{City:\"Delhi\"}}\n\n    b := []byte(`{\"name\": \"beta\"}`) //no address, age specified picks from old\n    up1 := new(Customer)\n    json.Unmarshal(b, up1)\n    if err := mergo.Merge(up1, old1); err != nil {\n        fmt.Printf(\"err in 1st merge: %v\\n\", err)\n        os.Exit(1)\n    }\n    m1, _ := json.Marshal(up1)\n    fmt.Printf(\"merged to: %v\\n\", string(m1))\n\n    old2 := &amp;Customer{Id:1, Name:\"alpha\", Age:5, Address:&amp;Address{City:\"Delhi\"}}\n    b2 := []byte(`{ \"address\": {\"city\": \"mumbai\"}}`) //address specified\n    up2 := new(Customer)\n    json.Unmarshal(b2, up2)\n    if err := mergo.Merge(up2, old2); err != nil {\n        fmt.Printf(\"err in 1st merge: %v\\n\", err)\n        os.Exit(1)\n    }\n    m2, _ := json.Marshal(up2)\n    fmt.Printf(\"merged to: %v\\n\", string(m2))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1550674585, "creation_date": 1550674585, "answer_id": 54789189, "question_id": 54778865, "link": "https://stackoverflow.com/questions/54778865/rest-api-update-by-partial-json/54789189#54789189", "title": "REST API Update by partial json", "body": "<p>from your comments it seems you are hitting the zero-value issue a lot of users with <code>go</code> encounter i.e. how does one tell if the input data passed a legitimate value - or was that value zeroed by default omission.</p>\n\n<p>The only way to solve this is to use pointers. So in your example, changing your data struct to this:</p>\n\n<pre><code>type Customer struct {\n    Id   *int64  `json:\"id\"`\n    Name *string `json:\"name\"`\n    Age  *int    `json:\"age\"`\n}\n</code></pre>\n\n<p>Then after unmarshaling, any uninitialized fields will have <code>nil</code> values e.g.</p>\n\n<pre><code>var c Customer\n\nerr := json.Unmarshal(jsonData, &amp;c)\nif err != nil {\n    panic(err)\n}\n\nif c.Id != nil {\n    log.Println(\"TODO: added SQL update parms for c.Id:\", *c.Id)\n}\nif c.Name != nil {\n    log.Println(\"TODO: added SQL update params for c.Name:\", *c.Name)\n}\nif c.Age != nil {\n    log.Println(\"TODO: added SQL update parms for c.Age:\", *c.Age)\n}\n</code></pre>\n\n<p>Note: care must be taken to ensure one does not accidentally reference any nil pointers which would trigger an instant <code>panic</code>.</p>\n\n<p>Working <a href=\"https://play.golang.org/p/aP1CHzCBJjo\" rel=\"nofollow noreferrer\">playground example</a>.</p>\n"}], "owner": {"reputation": 922, "user_id": 1064473, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/8ad795aafc17a286a84cf4afccf33a99?s=128&d=identicon&r=PG", "display_name": "Khoi Nguyen", "link": "https://stackoverflow.com/users/1064473/khoi-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 590, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1550674585, "creation_date": 1550636945, "question_id": 54778865, "link": "https://stackoverflow.com/questions/54778865/rest-api-update-by-partial-json", "title": "REST API Update by partial json", "body": "<p>We are using Golang to implement a REST API which including CRUD, in Update service, client could send partial JSON including changed fields, and we need to handle for updating entity with these changes.</p>\n\n<p>Logically, we need to get entity by Id from DB to struct, and then unmarshal payload json to another struct and update entity.</p>\n\n<p>However if payload json is not fully, for example I have struct</p>\n\n<pre><code>type Customer struct {\n    Id      int64 `json:\"id\"`\n    Name    string `json:\"name\"`\n    Age     int `json:\"age\"`\n}\n</code></pre>\n\n<p>And JSON request looks like </p>\n\n<pre><code>{\n  \"Name\": \"Updated name\"\n}\n</code></pre>\n\n<p>Then the customer should be updated with new name.</p>\n\n<p>That's simple example, actually it could be a nested struct and nested json, how could we handle that case with golang, or event other language like Java, .NET</p>\n"}, {"tags": ["go", "concurrency", "data-race"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1550641294, "post_id": 54778559, "comment_id": 96337964, "body": "No. Nothing is concurrency safe unless explicitly stated (e.g. channel ops in the Memeory Model) and data races <b>must</b> be avoided: A program with a data race is wrong and may produce wrong results at any time."}], "answers": [{"comments": [{"owner": {"reputation": 389, "user_id": 6321432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CpTh0.jpg?s=128&g=1", "display_name": "HolaYang", "link": "https://stackoverflow.com/users/6321432/holayang"}, "edited": false, "score": 0, "creation_date": 1550647918, "post_id": 54778716, "comment_id": 96340652, "body": "Thanks a lot. I was trapped in some misunderstanding, in my mind, doing multi <code>copy</code>  concurrently cause <code>data race</code>. I got it from your answer."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1550636494, "last_edit_date": 1550636494, "creation_date": 1550635826, "answer_id": 54778716, "question_id": 54778559, "link": "https://stackoverflow.com/questions/54778559/is-copy-concurrency-safe-in-golang/54778716#54778716", "title": "Is copy concurrency safe in golang?", "body": "<p>To avoid the data race, which will have undefined results, synchronize. For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n    a := make([]int, 10)\n    for i := 0; i &lt; 10; i++ {\n        b := []int{i}\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            copy(a[i:i+1], b)\n        }(i)\n    }\n    wg.Wait()\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/rYCBMV7wuNn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rYCBMV7wuNn</a></p>\n\n<p>Output:</p>\n\n<pre><code>$ go run -race norace.go\n[0 1 2 3 4 5 6 7 8 9]\n$\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">Package sync</a></p>\n\n<pre><code>import \"sync\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">type WaitGroup</a></p>\n  \n  <p>A WaitGroup waits for a collection of goroutines to finish. The main\n  goroutine calls Add to set the number of goroutines to wait for. Then\n  each of the goroutines runs and calls Done when finished. At the same\n  time, Wait can be used to block until all goroutines have finished.</p>\n  \n  <p>A WaitGroup must not be copied after first use.</p>\n\n<pre><code>type WaitGroup struct {\n        // contains filtered or unexported fields\n}\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 389, "user_id": 6321432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CpTh0.jpg?s=128&g=1", "display_name": "HolaYang", "link": "https://stackoverflow.com/users/6321432/holayang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1550636494, "creation_date": 1550634712, "question_id": 54778559, "link": "https://stackoverflow.com/questions/54778559/is-copy-concurrency-safe-in-golang", "title": "Is copy concurrency safe in golang?", "body": "<p>In some circumstance, i would copy some content to different piece of the slice. \nLike this</p>\n\n<pre><code>a := make([]int, 10)\nfor i := 0; i &lt; 10; i++ {\n    b := []int{i}\n    go func(i int) {\n        copy(a[i:i+1], b)\n    }(i)\n}\ntime.Sleep(time.Second)\nfmt.Println(a)\n</code></pre>\n\n<p>It leads <code>DATA RACE</code>. But it always behave right in product environment.</p>\n\n<p>So my question is:</p>\n\n<ol>\n<li>Any data race cloud be undefined behavior?</li>\n<li>Can i always get right result in such a practice?</li>\n</ol>\n"}, {"tags": ["database", "mongodb", "go", "database-connection", "mongo-go"], "answers": [{"comments": [{"owner": {"reputation": 2400, "user_id": 6112685, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RAHsYhTeNC0/AAAAAAAAAAI/AAAAAAAAAsc/A5bLML9T638/photo.jpg?sz=128", "display_name": "Abhay", "link": "https://stackoverflow.com/users/6112685/abhay"}, "edited": false, "score": 0, "creation_date": 1551101776, "post_id": 54778827, "comment_id": 96505126, "body": "Followed latest steps from github. After using import &quot;go.mongodb.org/mongo-driver/mongo&quot; , getting error &quot;options.Client().ApplyURI undefined (type *options.ClientOptions has no field or method ApplyURI)&quot; ... options is taking from github.com/mongodb/mongo-go-driver/mongo/options"}, {"owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "edited": false, "score": 1, "creation_date": 1554894127, "post_id": 54778827, "comment_id": 97916138, "body": "Answer outdated either"}, {"owner": {"reputation": 749, "user_id": 3034488, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/fcfd5caca3a62bec03e4f7b3c973db31?s=128&d=identicon&r=PG&f=1", "display_name": "Galil", "link": "https://stackoverflow.com/users/3034488/galil"}, "edited": false, "score": 1, "creation_date": 1557399866, "post_id": 54778827, "comment_id": 98756419, "body": "The up-to-date answer can be found here: <a href=\"https://stackoverflow.com/questions/55157890/mongo-go-driver-error-new-client-error-clientoptions-in-argument-to-mongo-newcli\" title=\"mongo go driver error new client error clientoptions in argument to mongo newcli\">stackoverflow.com/questions/55157890/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "is_accepted": true, "score": 6, "last_activity_date": 1550636687, "creation_date": 1550636687, "answer_id": 54778827, "question_id": 54778520, "link": "https://stackoverflow.com/questions/54778520/mongo-go-driver-failing-to-connect/54778827#54778827", "title": "Mongo-Go-Driver Failing to Connect", "body": "<p>To those who come searching - the docs are out of date as of this posting, but their latest push here: <a href=\"https://github.com/mongodb/mongo-go-driver/commit/32946b1f8b9412a6a94e68ff789575327bb257cf\" rel=\"noreferrer\">https://github.com/mongodb/mongo-go-driver/commit/32946b1f8b9412a6a94e68ff789575327bb257cf</a> has them doing this with the connect:</p>\n\n<pre><code>client, err := mongo.NewClient(options.Client().ApplyURI(uri))\n</code></pre>\n\n<p>You will also now need to import the options package. Happy hacking.</p>\n\n<p>EDIT: thanks vcanales for finding this -  you're a gentleman and a scholar.</p>\n"}, {"tags": [], "owner": {"reputation": 69, "user_id": 5020190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ENL5m.png?s=128&g=1", "display_name": "John O. Morales-Marquez", "link": "https://stackoverflow.com/users/5020190/john-o-morales-marquez"}, "is_accepted": false, "score": 2, "last_activity_date": 1579265864, "last_edit_date": 1579265864, "creation_date": 1561647231, "answer_id": 56793750, "question_id": 54778520, "link": "https://stackoverflow.com/questions/54778520/mongo-go-driver-failing-to-connect/56793750#56793750", "title": "Mongo-Go-Driver Failing to Connect", "body": "<p>In addition to the accepted answer - this snippet below may be improved by using an environment variable to pass in the Mongodb URL.</p>\n\n<pre><code>package main\n\nimport (\n   \"context\" //use import withs \" char\n   \"fmt\"\n   \"time\"\n   \"go.mongodb.org/mongo-driver/mongo\"\n   \"go.mongodb.org/mongo-driver/mongo/options\"\n   \"go.mongodb.org/mongo-driver/mongo/readpref\"\n)\n\nfunc ConnectMongo() {\n\n   var (\n       client     *mongo.Client\n       mongoURL = \"mongodb://localhost:27017\"\n   )\n\n   // Initialize a new mongo client with options\n   client, err := mongo.NewClient(options.Client().ApplyURI(mongoURL))\n\n   // Connect the mongo client to the MongoDB server\n   ctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\n   err = client.Connect(ctx)\n\n   // Ping MongoDB\n   ctx, _ = context.WithTimeout(context.Background(), 10*time.Second)\n   if err = client.Ping(ctx, readpref.Primary()); err != nil {\n       fmt.Println(\"could not ping to mongo db service: %v\\n\", err)\n       return\n   }\n\n   fmt.Println(\"connected to nosql database:\", mongoURL)\n\n}\n\n\nfunc main() {\n\n   ConnectMongo()\n}\n</code></pre>\n\n<p>More information on options and readpref respectively: \n<a href=\"https://docs.mongodb.com/manual/reference/method/cursor.readPref/index.html\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/reference/method/cursor.readPref/index.html</a>\n<a href=\"https://docs.mongodb.com/manual/core/read-preference/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/core/read-preference/</a></p>\n"}], "owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7914, "favorite_count": 2, "accepted_answer_id": 54778827, "answer_count": 2, "score": 1, "last_activity_date": 1579265864, "creation_date": 1550634438, "question_id": 54778520, "link": "https://stackoverflow.com/questions/54778520/mongo-go-driver-failing-to-connect", "title": "Mongo-Go-Driver Failing to Connect", "body": "<p>So I am trying to use <a href=\"https://github.com/mongodb/mongo-go-driver\" rel=\"nofollow noreferrer\">https://github.com/mongodb/mongo-go-driver</a> to connect to a mongo database in golang.</p>\n\n<p>Here is my connection handler: </p>\n\n<pre><code>var DB *mongo.Database\n\nfunc CreateConnectionHandler()(*mongo.Database, error){\n    fmt.Println(\"inside createConnection in database package\")\n    godotenv.Load()\n    fmt.Println(\"in CreateConnectionHandler and SERVER_CONFIG: \")\n    fmt.Println(os.Getenv(\"SERVER_CONFIG\"))\n    uri:=\"\"\n    if os.Getenv(\"SERVER_CONFIG\")==\"kubernetes\"{\n        fmt.Println(\"inside kubernetes db config\")\n        uri = \"mongodb://patientplatypus:SUPERSECRETPASSDOOT@\n               mongo-release-mongodb.default.svc.cluster.local:27017/\n               platypusNEST?authMechanism=SCRAM-SHA-1\"\n    }else if os.Getenv(\"SERVER_CONFIG\")==\"compose\"{\n        fmt.Println(\"inside compose db config\")\n        uri = \"mongodb://datastore:27017\"\n    }\n    ctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\n    client, err := mongo.Connect(ctx, uri)\n    if err != nil {\n        return nil, fmt.Errorf(\"mongo client couldn't connect: %v\", err)\n    }\n    DB := client.Database(\"platypusNEST\")\n    return DB, nil\n}\n</code></pre>\n\n<p>And the error I am getting: </p>\n\n<pre><code>api         | database/connection.go:29:30: cannot use uri (type \nstring) as type *options.ClientOptions in argument to mongo.Connect\n</code></pre>\n\n<p>So I tried replacing <code>uri</code> with the connection string like this: </p>\n\n<pre><code>client, err := mongo.Connect(ctx, \"mongodb://datastore:27017\")\n</code></pre>\n\n<p>But I still got the error.</p>\n\n<p>Compare this with what is in the documentation: </p>\n\n<blockquote>\n<pre><code>ctx, _ := context.WithTimeout(context.Background(), 10*time.Second)\nclient, err := mongo.Connect(ctx, \"mongodb://localhost:27017\")\n</code></pre>\n</blockquote>\n\n<p>And it is exactly the same! I'm really not sure why there is this error. Any ideas?</p>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 7629, "user_id": 978005, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9219975d0b744e19422761516d419f12?s=128&d=identicon&r=PG", "display_name": "Phix", "link": "https://stackoverflow.com/users/978005/phix"}, "edited": false, "score": 0, "creation_date": 1550625027, "post_id": 54777316, "comment_id": 96334159, "body": "Shot in the dark, is the leading slash an issue? You&#39;re requesting <code>resources&#47;Style.css</code> and handling <code>&#47;resources&#47;</code>."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "reply_to_user": {"reputation": 7629, "user_id": 978005, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9219975d0b744e19422761516d419f12?s=128&d=identicon&r=PG", "display_name": "Phix", "link": "https://stackoverflow.com/users/978005/phix"}, "edited": false, "score": 0, "creation_date": 1550625173, "post_id": 54777316, "comment_id": 96334186, "body": "@Phix No, sadly not. I have tried every combination of slashes I could come up with. The address the <code>href</code> trys to access is <code>http:&#47;&#47;localhost:8080&#47;resources&#47;Styles.css</code> regardless of slashes."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1550626979, "post_id": 54777316, "comment_id": 96334593, "body": "Ultimately you&#39;lll probably also need to send the content type for CSS, but the text file should display if your path is right.  Did you check file and directory permissions?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "reply_to_user": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1550627177, "post_id": 54777316, "comment_id": 96334632, "body": "@jrefior I strip the prefix resource but also include <code>http.FileServer(http.Dir(&quot;resources&quot;))</code> hence putting the location to look for <code>&#47;resources&#47;Styles.css</code> after being stripped to <code>Styles.css</code> in the resources folder. I did try <code>resources&#47;resources&#47;Styles.css</code> regardless and sadly it did not work."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 0, "creation_date": 1550627312, "post_id": 54777316, "comment_id": 96334669, "body": "In all the examples in the package documentation, they use the full path in the parameter passed to <code>http.Dir</code>.  Have you tried that?  See <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#FileServer</a>"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550627357, "post_id": 54777316, "comment_id": 96334678, "body": "Yes I did try the full path. The permissions are good."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1550634386, "post_id": 54777316, "comment_id": 96336175, "body": "since your Index.html is at a higher level that the CSS content - how are you serving the route for Index.html?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1550634969, "post_id": 54777316, "comment_id": 96336313, "body": "@colminator To serve Index.html I am using HandleFunc() on the &quot;/&quot; path where the function simply does serveFile(ResponseWriter, HttpRequest, &quot;Index.html) no matter the address. As I am new to Go and HTML currently my server only show Index.html no matter what."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 1, "creation_date": 1550635222, "post_id": 54777316, "comment_id": 96336371, "body": "@Dylan I would put your html/css files like so <code>static&#47;Index.html</code> and <code>static&#47;resources&#47;Styles.css</code> - and have a single handle for both. I&#39;ll update my answer below to demonstrate."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550636695, "post_id": 54778598, "comment_id": 96336688, "body": "I won&#39;t be able to try till tomorrow."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550689767, "post_id": 54778598, "comment_id": 96365261, "body": "I&#39;ll update the question to better communicate what I actually have, I had simplified it earlier."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550692357, "post_id": 54778598, "comment_id": 96366490, "body": "@Dylan looking at your updated question - I have to think if you are still getting a 404 for the <code>css</code> route - your go-server is not being run from the correct relative location for the <code>http.FileServer</code> to work. As a test, can you put an absolute path in <code>http.Dir</code> to ensure the executable find the files?"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550692577, "post_id": 54778598, "comment_id": 96366584, "body": "Just tried, using the absolute path makes no difference."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550693087, "post_id": 54778598, "comment_id": 96366792, "body": "add log statements at the head of each of your handlers - to see which one is being triggered. I suspect your basic handler must be intercepting the css path (but based on the route definitions I don&#39;t see how that is possible...)"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550693189, "post_id": 54778598, "comment_id": 96366859, "body": "also note in your <code>index.html</code> you use a relative path <code>css&#47;Styles.css</code> - so if your index page is off another url - this will fail. So try <code>&#47;css&#47;Styles.css</code>"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550693303, "post_id": 54778598, "comment_id": 96366910, "body": "I tried using log statements yesterday and can confirm <code>basicHandler </code>does not intercept. Changing it to <code>&#47;css&#47;Styles.css</code> had no effect, in fact, changing it meant css would not even load by launching <code>index.html</code> in the web browser."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550693602, "post_id": 54778598, "comment_id": 96367069, "body": "try <code>&lt;link rel=&quot;stylesheet&quot; type=&quot;text&#47;css&quot; href=&quot;&#47;css&#47;Styles.css&quot;&#47;&gt;</code>. Also try testing the CSS url directly in a browser to debug e.g. <code>localhost:8080:&#47;css&#47;Styles.css</code>"}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550693760, "post_id": 54778598, "comment_id": 96367144, "body": "Just get <code>404 file not found</code>"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550694038, "post_id": 54778598, "comment_id": 96367261, "body": "Wait, you are using NewRouter() - is this gorilla mux? If you are chaining routers - you&#39;ll need the previous route&#39;s prefix, to prefix to your html url path."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550694182, "post_id": 54778598, "comment_id": 96367326, "body": "I am indeed using <code>github.com&#47;gorilla&#47;mux</code>. Not sure what you mean by changing routers, but if it helps I only execute <code>mux.NewRouter()</code> once throughout the programs life."}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550695621, "post_id": 54778598, "comment_id": 96367970, "body": "figured it out - gorilla/mux and http package routers are chained hence the confusion. Answer updated above to fix gorilla&#39;s router. See referenced other answer for details on why http.FileServer was being confused by gorilla/mux."}, {"owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "edited": false, "score": 0, "creation_date": 1550695824, "post_id": 54778598, "comment_id": 96368066, "body": "It makes sense now! I&#39;ll give it a go."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 2, "last_activity_date": 1550695528, "last_edit_date": 1550695528, "creation_date": 1550635052, "answer_id": 54778598, "question_id": 54777316, "link": "https://stackoverflow.com/questions/54777316/go-http-handle-not-working-as-expected-404-file-not-found/54778598#54778598", "title": "Go http.Handle() not working as expected. 404 file not found", "body": "<p>I'd suggest moving your files like so (note I renamed <code>index.html</code> to lowercase - so it will be loaded by default when visiting the document root URL):</p>\n\n<pre><code>Main.go\nstatic/\nstatic/index.html\nstatic/css/Styles.css\n</code></pre>\n\n<p>modify <code>index.html</code> to refer to the more aptly named <code>css</code> directory:</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/Styles.css\"/&gt;\n</code></pre>\n\n<p>EDIT: update to adjust for gorilla/mux.</p>\n\n<p>H/T to this <a href=\"https://stackoverflow.com/a/21251658/1218512\">answer</a>.</p>\n\n<pre><code>package main\n\nimport (\n        \"github.com/gorilla/mux\"\n        \"log\"\n        \"net/http\"\n)\n\nfunc main() {\n        r := mux.NewRouter()\n\n        r.PathPrefix(\"/css/\").Handler(\n                http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"static/css/\"))),\n        )   \n\n        err := http.ListenAndServe(\":8080\", r)\n        if err != nil {\n                log.Fatal(err)\n        }   \n\n        // curl 'localhost:8080/css/Styles.css'\n        // &lt;style&gt; ...  &lt;/style&gt;\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10908910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63c24d7e67eb32a490f2c76cefe9f04?s=128&d=identicon&r=PG&f=1", "display_name": "Dylan", "link": "https://stackoverflow.com/users/10908910/dylan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 54778598, "answer_count": 1, "score": 0, "last_activity_date": 1550695528, "creation_date": 1550624938, "last_edit_date": 1550690319, "question_id": 54777316, "link": "https://stackoverflow.com/questions/54777316/go-http-handle-not-working-as-expected-404-file-not-found", "title": "Go http.Handle() not working as expected. 404 file not found", "body": "<p>So I am trying to get <code>CSS</code> working using my <code>Go</code> server, but the css file is not loading correcly, I get <code>404 file not found</code>. It works fine when I run <code>Index.html</code> straight from the browser.</p>\n\n<p><strong>My directory structure with <code>#</code> representing a folder and <code>-</code> a file:</strong></p>\n\n<pre><code>- Main.go\n# static\n    - index.html\n    # css\n       - Styles.css\n</code></pre>\n\n<p><strong><code>Index.html</code> contains:</strong></p>\n\n<pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css/Styles.css\"/&gt;\n</code></pre>\n\n<p><strong>These are all my handlers:</strong></p>\n\n<pre><code>muxRouter := mux.NewRouter()\nmuxRouter.HandleFunc(\"/\", basicHandler)\nmuxRouter.HandleFunc(\"/ws\", wsHandler)\nmuxRouter.Handle(\"/css/\", http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"static/css\"))))\n</code></pre>\n\n<p><strong>basicHandler contains:</strong></p>\n\n<pre><code>toSend := template.HTMLEscapeString(outputMessage)\ntoSend = strings.Replace(toSend, \"\\n\", \"&lt;br&gt;\", -1)\n\ntemplateError := allTemplates.ExecuteTemplate(responseWriter, \"index.html\", template.HTML(toSend))\nif templateError != nil {\n    log.Fatal(\"Template error: \", templateError)\n}\n</code></pre>\n\n<p><strong>wsHandler</strong> handles the websocket which my program uses. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1550625916, "post_id": 54777109, "comment_id": 96334357, "body": "You need to give specific, real examples of what you are trying to accomplish."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550674818, "post_id": 54777914, "comment_id": 96356856, "body": "Because it&#39;s just an <code>int64</code> you can also divide it by any integer constant, e.g. <code>someDuration &#47; 2</code> is perfectly legal."}, {"owner": {"reputation": 91, "user_id": 11087350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aQHcma1_Fk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO0S1LQOrel9BIPHZ3YAnjqZ-RVvw/mo/photo.jpg?sz=128", "display_name": "Patrick Jones", "link": "https://stackoverflow.com/users/11087350/patrick-jones"}, "edited": false, "score": 6, "creation_date": 1550691260, "post_id": 54777914, "comment_id": 96365915, "body": "The example given in the <code>time</code> package indicates how to count the number of units in a Duration- not, for instance, get a duration that&#39;s 1/13 as long as the original one.  I know you can do it by casting both the <code>time.Duration</code> and the divisor into <code>int64</code>, doing the division, and then calling <code>time.Duration(result)</code>.  I&#39;m just a bit surprised that <code>time</code> doesn&#39;t have a &quot;Divide&quot; method or something similar."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 7, "last_activity_date": 1550675381, "last_edit_date": 1550675381, "creation_date": 1550629384, "answer_id": 54777914, "question_id": 54777109, "link": "https://stackoverflow.com/questions/54777109/dividing-a-time-duration-in-golang/54777914#54777914", "title": "Dividing a time.Duration in Golang", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"noreferrer\">Package time</a></p>\n\n<pre><code>import \"time\" \n</code></pre>\n  \n  <p>There is no definition for units of Day or larger to avoid confusion\n  across daylight savings time zone transitions.</p>\n  \n  <p>To count the number of units in a Duration, divide:</p>\n\n<pre><code>second := time.Second\nfmt.Print(int64(second/time.Millisecond)) // prints 1000\n</code></pre>\n  \n  <p>To convert an integer number of units to a Duration, multiply:</p>\n\n<pre><code>seconds := 10\nfmt.Print(time.Duration(seconds)*time.Second) // prints 10s\n\nconst (\n        Nanosecond  Duration = 1\n        Microsecond          = 1000 * Nanosecond\n        Millisecond          = 1000 * Microsecond\n        Second               = 1000 * Millisecond\n        Minute               = 60 * Second\n        Hour                 = 60 * Minute\n)\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/time/#Duration\" rel=\"noreferrer\">type Duration</a></p>\n  \n  <p>A Duration represents the elapsed time between two instants as an\n  int64 nanosecond count. The representation limits the largest\n  representable duration to approximately 290 years.</p>\n\n<pre><code>type Duration int64\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>Division and multiplication of <code>time.Duration</code> is described in the Go <code>time</code> package documentation.</p>\n"}], "owner": {"reputation": 91, "user_id": 11087350, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5aQHcma1_Fk/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQO0S1LQOrel9BIPHZ3YAnjqZ-RVvw/mo/photo.jpg?sz=128", "display_name": "Patrick Jones", "link": "https://stackoverflow.com/users/11087350/patrick-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4514, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1550675381, "creation_date": 1550623284, "question_id": 54777109, "link": "https://stackoverflow.com/questions/54777109/dividing-a-time-duration-in-golang", "title": "Dividing a time.Duration in Golang", "body": "<p>At present, the <code>time</code> package in Go has no 'divide' function or anything similar.  You can divide a time.Duration by some other value, but it requires a fair bit of casting.  Is there any easy/obvious way to divide a time.Duration by something in Go that I'm not seeing?  (I know you can divide by a numeric constant, but I need to do it on a dynamic basis.)  I'm planning on submitting a issue/feature request to add a basic 'divide' function to the <code>time</code> package, but I wanted to ask here first in case I'm missing some easy way to do this kind of division.</p>\n"}, {"tags": ["mysql", "go", "sql-injection"], "comments": [{"owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "edited": false, "score": 10, "creation_date": 1550606288, "post_id": 54773929, "comment_id": 96328024, "body": "If the legacy services will blithely execute <i>arbitrary input strings</i> as SQL, they&#39;re not fit to accept user input, full stop."}], "answers": [{"tags": [], "owner": {"reputation": 458695, "user_id": 20860, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iavmP.jpg?s=128&g=1", "display_name": "Bill Karwin", "link": "https://stackoverflow.com/users/20860/bill-karwin"}, "is_accepted": true, "score": 6, "last_activity_date": 1550682302, "last_edit_date": 1550682302, "creation_date": 1550608062, "answer_id": 54774413, "question_id": 54773929, "link": "https://stackoverflow.com/questions/54773929/how-to-minimize-risk-of-sql-injection-in-downstream-services-in-a-golang-service/54774413#54774413", "title": "How to minimize risk of SQL injection in downstream services in a golang service?", "body": "<p>At a past job, I maintained a facility for our service that permitted ad hoc queries. It allowed managers to request reports without having to wait weeks for a code deployment (back in the quaint days when deployments took weeks).</p>\n\n<p>We did NOT support ad hoc report queries by making the service accepting arbitrary strings as input and execute them as SQL. That's terribly insecure, as I'm sure you know.</p>\n\n<p>The way it worked was that the report queries were stored in a database, along with the number of query parameters required. </p>\n\n<pre><code>CREATE TABLE ManagerQueries (\n  id INT PRIMARY KEY,\n  query TEXT NOT NULL,\n  description TEXT NOT NULL,\n  num_params TINYINT UNSIGNED NOT NULL DEFAULT 0\n);\n\nINSERT INTO ManagerQueries\nSET query = 'SELECT COUNT(*) FROM logins WHERE user_id = {0} AND created_at &gt; {1}',\n    description = 'Count a given user logins since a date',\n    num_params = 2;\n</code></pre>\n\n<p>The manager front-end could request a query by its primary key, NOT by specifying an arbitrary SQL string in a web request.</p>\n\n<p>Only the DBA and perhaps other developers or managers who knew how to write safe queries were allowed to add new queries to this repository, so there was some assurance that the queries were tested and vetted.</p>\n\n<p>When a report query was requested through the UI, it forced the user to supply values for the query parameters. In our case, it read the SQL from the database, did a <code>prepare()</code> and then bound the values for the <code>execute()</code>. So SQL injection defense was satisfied.</p>\n\n<p>In your case, your code might not have direct access to the legacy service's database, so you can't do the prepare/execute and use bound parameters. You have to submit a static query with the values integrated.</p>\n\n<p>In other languages, you can make any string value safe for interpolation into an SQL query by <strong>escaping</strong>. See the MySQL C API function <a href=\"https://dev.mysql.com/doc/refman/8.0/en/mysql-real-escape-string.html\" rel=\"nofollow noreferrer\">mysql_real_escape_string()</a>.</p>\n\n<p>Numeric values are even easier. You don't have to escape anything, you just have to make sure the numeric value is a genuine numeric. Once you cast a dynamic value to a numeric, it's safe to interpolate back into any SQL string.</p>\n\n<p>Unfortunately, I don't think golang SQL packages support any escaping function. This has been requested as a feature, but as far as I know, there's no supported implementation yet. See discussion here: <a href=\"https://github.com/golang/go/issues/18478\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/18478</a></p>\n\n<p>So you may have to implement your own escaping function. You could for example model it after the official MySQL C implementation: <a href=\"https://github.com/mysql/mysql-server/blob/8.0/mysys/charset.cc#L716\" rel=\"nofollow noreferrer\">https://github.com/mysql/mysql-server/blob/8.0/mysys/charset.cc#L716</a></p>\n\n<p>Note that it's a bit trickier than just using a regexp substitution, because you need to account for multi-byte character sets.</p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1550612214, "creation_date": 1550612214, "answer_id": 54775293, "question_id": 54773929, "link": "https://stackoverflow.com/questions/54773929/how-to-minimize-risk-of-sql-injection-in-downstream-services-in-a-golang-service/54775293#54775293", "title": "How to minimize risk of SQL injection in downstream services in a golang service?", "body": "<p>To add to Bill's answer covering input of data. To ensure the sanitation of outputted data, to say a web-service, check out the <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">html/template</a>:</p>\n\n<blockquote>\n  <p>Package template (html/template) implements data-driven templates for\n  generating HTML output safe against code injection.</p>\n</blockquote>\n"}], "owner": {"reputation": 1868, "user_id": 499567, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c4ba4a2ce571f71370d270a21633e7e3?s=128&d=identicon&r=PG", "display_name": "Techrocket9", "link": "https://stackoverflow.com/users/499567/techrocket9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 54774413, "answer_count": 2, "score": 5, "last_activity_date": 1550682302, "creation_date": 1550605807, "last_edit_date": 1550610813, "question_id": 54773929, "link": "https://stackoverflow.com/questions/54773929/how-to-minimize-risk-of-sql-injection-in-downstream-services-in-a-golang-service", "title": "How to minimize risk of SQL injection in downstream services in a golang service?", "body": "<p>I'm writing a semi-externally facing web service in golang that lets users query information about their accounts which are spread over several internal legacy services.</p>\n\n<p>My service passes user input strings onto multiple backend RESTful APIs which do MySQL lookups based on the strings to generate the results which are passed back to my service to give to the user.</p>\n\n<p>Historically, these legacy backend services have not been exposed to user input, so I'm not sure that they have the proper guards in place against SQL injection.</p>\n\n<p>Ordinarily I'd prevent SQL injection with <a href=\"https://stackoverflow.com/questions/26345318/how-can-i-prevent-sql-injection-attacks-in-go-while-using-database-sql\">Prepared Statements</a> to keep the DB engine from treating user strings as parsable, but in this context I don't control the DB calls -- they're far downstream and it isn't practical to audit them all right now.</p>\n\n<p>What can I do in my golang code to sanitize the user input <em>as much as possible</em> to minimize the risk of an SQL injection slipping through? This is ultimately a stopgap measure until all the downstream DB calls can be audited for injection-safety.</p>\n\n<p>Edit: The user input can for all practical purposes be an arbitrary string, but it <em>shouldn't</em> ever be executable code. My service expects field values from the user, not code.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": true, "score": 5, "last_activity_date": 1550599619, "creation_date": 1550599619, "answer_id": 54772426, "question_id": 54772346, "link": "https://stackoverflow.com/questions/54772346/golang-how-to-check-struct-field-int-is-set/54772426#54772426", "title": "Golang how to check struct field int is set?", "body": "<p>Use a pointer for <code>Status</code> field:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype Admin struct {\n   Id string `json:\"id\"`\n   Status *int `json:\"status\"`\n}\n\nfunc main() {\n    b := []byte(`{\"id\": 1}`)\n    r := new(Admin)\n    json.Unmarshal(b, r)\n    fmt.Println(r.Status)\n\n    b2 := []byte(`{\"id\": 1, \"status\": 2}`)\n    r2 := new(Admin)\n    json.Unmarshal(b2, r2)\n    fmt.Println(*r2.Status)\n}\n</code></pre>\n\n<p>When its not present in Json, the pointer would be nil.</p>\n"}], "owner": {"reputation": 53, "user_id": 10943352, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjCks.jpg?s=128&g=1", "display_name": "Hung Quyen", "link": "https://stackoverflow.com/users/10943352/hung-quyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1755, "favorite_count": 0, "closed_date": 1550600767, "accepted_answer_id": 54772426, "answer_count": 1, "score": 3, "last_activity_date": 1550599619, "creation_date": 1550599289, "question_id": 54772346, "link": "https://stackoverflow.com/questions/54772346/golang-how-to-check-struct-field-int-is-set", "closed_reason": "Duplicate", "title": "Golang how to check struct field int is set?", "body": "<p>With golang script, I have a struct type and json below</p>\n\n<p><strong>struct</strong></p>\n\n<pre><code>admin\n\ntype Admin struct {\n   Id string `json:\"id\"`\n   Status int `json:\"status\"`\n}\n</code></pre>\n\n<p><strong>json</strong></p>\n\n<pre><code>jsonData\n\n{\n    \"id\": \"uuid\"\n}\n</code></pre>\n\n<p>When I using <code>json.Unmarshal(jsonData, &amp;admin)</code> with jsonData above does not have <code>status</code> value</p>\n\n<p>Default value of <code>admin.Status</code> is <code>0</code>. How i can check <code>admin.Status</code> is not set?</p>\n\n<p>Thanks so much!</p>\n"}, {"tags": ["oracle", "go", "nne", "goracle"], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1550596312, "post_id": 54770536, "comment_id": 96323184, "body": "A missing link for <a href=\"https://github.com/go-goracle/goracle/issues/138\" rel=\"nofollow noreferrer\">&quot;Per the driver maintainers&quot;</a>."}, {"owner": {"reputation": 18302, "user_id": 151200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gzru4.jpg?s=128&g=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/151200/andrey"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1550597069, "post_id": 54770536, "comment_id": 96323569, "body": "@kostix added the link"}, {"owner": {"reputation": 6003, "user_id": 4799035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuyZM.jpg?s=128&g=1", "display_name": "Christopher Jones", "link": "https://stackoverflow.com/users/4799035/christopher-jones"}, "edited": false, "score": 0, "creation_date": 1550619264, "post_id": 54770536, "comment_id": 96332824, "body": "The &#39;driver maintainers&#39; referred to are actually Oracle employees, and are not the maintainer of the goracle driver."}, {"owner": {"reputation": 18302, "user_id": 151200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gzru4.jpg?s=128&g=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/151200/andrey"}, "edited": false, "score": 0, "creation_date": 1550619948, "post_id": 54770536, "comment_id": 96333003, "body": "I changed &quot;maintainers&quot; to &quot;developers&quot; in my answer."}], "tags": [], "owner": {"reputation": 18302, "user_id": 151200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gzru4.jpg?s=128&g=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/151200/andrey"}, "is_accepted": false, "score": 1, "last_activity_date": 1550619917, "last_edit_date": 1550619917, "creation_date": 1550592659, "answer_id": 54770536, "question_id": 54770412, "link": "https://stackoverflow.com/questions/54770412/enabling-nne-for-go-oracle-drivers-ora-goracle/54770536#54770536", "title": "Enabling NNE for go oracle drivers (ora, goracle)", "body": "<p>[Per driver developers], there is no way of programmatically setting that parameter at this time; however there is a workaround (that I've just tested and confirmed working) - create sqlnet.ora file with one line <code>sql.net.encryption_client=required</code> and add an environment variable <code>TNS_ADMIN=&lt;folder path to sqlnet.ora file&gt;</code>. </p>\n\n<p>This will have the driver to require native network encryption on the client. </p>\n"}, {"comments": [{"owner": {"reputation": 18302, "user_id": 151200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gzru4.jpg?s=128&g=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/151200/andrey"}, "edited": false, "score": 0, "creation_date": 1550620169, "post_id": 54776623, "comment_id": 96333064, "body": "Some drivers allow setting those directly thru the driver (e.g. ODP.NET) and that&#39;s what I was looking for in goracle driver originally. As per your response on GitHub I&#39;ve understood that goracle driver doesn&#39;t supply that capability and I needed to create sqlnet.ora and set TNS_ADMIN."}], "tags": [], "owner": {"reputation": 6003, "user_id": 4799035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuyZM.jpg?s=128&g=1", "display_name": "Christopher Jones", "link": "https://stackoverflow.com/users/4799035/christopher-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1550619724, "creation_date": 1550619724, "answer_id": 54776623, "question_id": 54770412, "link": "https://stackoverflow.com/questions/54770412/enabling-nne-for-go-oracle-drivers-ora-goracle/54776623#54776623", "title": "Enabling NNE for go oracle drivers (ora, goracle)", "body": "<p>Oracle network encryption options and other network options are controlled by Oracle Net configuration, not by the scripting language drivers.</p>\n\n<ul>\n<li><p>For users of Oracle Instant Client a solution is to put your sqlnet.ora (containing the <code>SQLNET.ENCRYPTION_CLIENT = required</code> directive and related options) in a <code>network/admin</code> subdirectory, as mentioned in the Instant Client installation instructions (Linux <a href=\"https://www.oracle.com/technetwork/topics/linuxx86-64soft-092277.html#ic_x64_inst\" rel=\"nofollow noreferrer\">here</a>, Windows <a href=\"https://www.oracle.com/technetwork/topics/winx64soft-089540.html#ic_winx64_inst\" rel=\"nofollow noreferrer\">here</a>).  This directory is pre-created on Linux with Instant Client 18.3 onwards.</p></li>\n<li><p>Alternatively set the environment variable <code>TNS_ADMIN</code> to a directory, and put your <code>sqlnet.ora</code> file in that directory.</p></li>\n</ul>\n"}], "owner": {"reputation": 18302, "user_id": 151200, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/gzru4.jpg?s=128&g=1", "display_name": "Andrey", "link": "https://stackoverflow.com/users/151200/andrey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550619917, "creation_date": 1550592225, "question_id": 54770412, "link": "https://stackoverflow.com/questions/54770412/enabling-nne-for-go-oracle-drivers-ora-goracle", "title": "Enabling NNE for go oracle drivers (ora, goracle)", "body": "<p>I have a <code>go</code> service which communicates with an Oracle database. Now, I need to encrypt that traffic using Oracle NNE (Native Network Encryption). For that, I need to set <code>sql.net.encryption_client</code> parameter on the client to <code>required</code>, as our Oracle server doesn't force encryption (for legacy reasons).</p>\n\n<p>We are using <code>goracle</code> driver and I don't see any ways of setting that parameter. Any ideas?</p>\n"}, {"tags": ["ssl", "go", "curl", "https"], "comments": [{"owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550602702, "post_id": 54770016, "comment_id": 96326429, "body": "Can you update your code to show where you&#39;re setting the URL your requesting?"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "edited": false, "score": 0, "creation_date": 1550612451, "post_id": 54775058, "comment_id": 96330705, "body": "Works! I never notice that other fields are affected by assigning the config. Thank you very much!"}, {"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "reply_to_user": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "edited": false, "score": 0, "creation_date": 1550613059, "post_id": 54775058, "comment_id": 96330932, "body": "curious @J.Z which default field triggered the fix?  TLS handshake timeout?"}, {"owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "edited": false, "score": 1, "creation_date": 1550613285, "post_id": 54775058, "comment_id": 96331030, "body": "It&#39;s the proxy one fixed the issue. <code>Proxy: defaultTransport.Proxy</code>. I have http_proxy and https_proxy in my environment variable."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1550611080, "creation_date": 1550611080, "answer_id": 54775058, "question_id": 54770016, "link": "https://stackoverflow.com/questions/54770016/https-request-with-client-crt-and-client-key/54775058#54775058", "title": "https request with client.crt and client.key", "body": "<p>Firstly, <strong><em>never ever ever</em></strong> use <code>InsecureSkipVerify: true</code> no matter how convenient it may seem.  Instead set something like:</p>\n\n<pre><code>tls.Config {\n    ServerName: \"test-as.sgx.trustedservices.intel.com\",\n    Certificates: []tls.Certificate{pair}\n}\n</code></pre>\n\n<p>Second, initializing <code>http.Transport</code> - to pass your custom tls.Config - also zeros out all the other default <code>http.Transport</code> settings that come with the default <code>http.Client</code>.</p>\n\n<p>Some of those zero defaults may force behavior you might not expect.\nSee <a href=\"https://stackoverflow.com/a/46011355/1218512\">here</a> on how to restore some of those original defaults.</p>\n"}], "owner": {"reputation": 391, "user_id": 10991662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gdDbc.jpg?s=128&g=1", "display_name": "J.Z", "link": "https://stackoverflow.com/users/10991662/j-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 54775058, "answer_count": 1, "score": 0, "last_activity_date": 1568962668, "creation_date": 1550590917, "last_edit_date": 1568962668, "question_id": 54770016, "link": "https://stackoverflow.com/questions/54770016/https-request-with-client-crt-and-client-key", "title": "https request with client.crt and client.key", "body": "<p>I want to send a POST request to https server and get the response. Here is what I am doing in curl and it works well.</p>\n\n<p><code>curl --key ./client.key --cert ./client.crt https://test-as.sgx.trustedservices.intel.com:443/attestation/sgx/v2/report -H 'Content-Type: application/json' --data '{\"key\": \"value\"}'</code></p>\n\n<p>This is the code snippet I tried in Go.</p>\n\n<pre><code>    url := \"https://test-as.sgx.trustedservices.intel.com:443/attestation/sgx/v2/report\"\n    pair, e := tls.LoadX509KeyPair(\"client.crt\", \"client.key\")\n    if e != nil {\n        log.Fatal(\"LoadX509KeyPair:\", e)\n    }\n\n    client := &amp;http.Client{\n        Transport: &amp;http.Transport{\n            TLSClientConfig: &amp;tls.Config{\n                InsecureSkipVerify: true,\n                Certificates: []tls.Certificate{pair},\n            },\n        }}\n\n    resp, e := client.Post(url, \"application/json\", bytes.NewBufferString(payload))\n</code></pre>\n\n<p>The program is hanging at the last line, error message is</p>\n\n<pre><code>Post: dial tcp connectex: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.\n</code></pre>\n\n<p>I feel there is problem in my connection establish code, instead of the server's problem since server works perfectly with curl.</p>\n"}, {"tags": ["elasticsearch", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550590095, "post_id": 54769677, "comment_id": 96319431, "body": "Which elastic client lib are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 7, "last_activity_date": 1550590419, "creation_date": 1550590419, "answer_id": 54769858, "question_id": 54769677, "link": "https://stackoverflow.com/questions/54769677/why-searchresult-totalhits-is-different-than-lensearchresult-hits-hits/54769858#54769858", "title": "Why searchResult.TotalHits() is different than len(searchResult.Hits.Hits)?", "body": "<p>It's not specified in your question so please comment if you're using a different client library (eg the official client), but it appears you're using github.com/olivere/elastic. Based on that assumption, what you're seeing is the default result set size of 10. The <code>TotalHits</code> number is how many documents match your query in total; the <code>Hits</code> number is how many were returned in your current result, which you can manipulate using <a href=\"https://godoc.org/github.com/olivere/elastic#SearchService.Size\" rel=\"noreferrer\"><code>Size</code></a>, <code>Sort</code> and <code>From</code>. <code>Size</code> is documented as:</p>\n\n<blockquote>\n  <p>Size is the number of search hits to return. Defaults to 10.</p>\n</blockquote>\n"}], "owner": {"reputation": 329, "user_id": 5919955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8cabb9c86566b6e34d9c62213f2708ce?s=128&d=identicon&r=PG&f=1", "display_name": "kbenda", "link": "https://stackoverflow.com/users/5919955/kbenda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 54769858, "answer_count": 1, "score": 0, "last_activity_date": 1550590419, "creation_date": 1550589874, "question_id": 54769677, "link": "https://stackoverflow.com/questions/54769677/why-searchresult-totalhits-is-different-than-lensearchresult-hits-hits", "title": "Why searchResult.TotalHits() is different than len(searchResult.Hits.Hits)?", "body": "<p>I work with golang elastic 5 API to run queries in ElasticSearch. I check the number of hits with searchResult.TotalHits() and it gives me a large number (more than 100), but when I try to iterate over the hits it gives only 10 entities. Also when I check the len(searchResult.Hits.Hits) variable I get 10.</p>\n\n<p>I tried different queries when I select less than 10 entity and it works well. </p>\n\n<pre><code>query = elastic.NewBoolQuery()\nctx := context.Background()\n\nquery = query.Must(elastic.NewTermQuery(\"key0\", \"term\"),\n    elastic.NewWildcardQuery(\"key1\", \"*term2*\"),\n    elastic.NewWildcardQuery(\"key3\", \"*.*\"),\n    elastic.NewRangeQuery(\"timestamp\").From(fromTime).To(toTime),\n)\nsearchResult, err = client.Search().Index(\"index\").\n    Query(query).Pretty(true).Do(ctx)\nfmt.Printf(\"TotalHits(): %v\", searchResult.TotalHits()) //It gives me 482\nfmt.Printf(\"length of the hits array: %v\", len(searchResult.Hits.Hits)) //It gives 10\nfor _, hit := range searchResult.Hits.Hits {\n    var tweet Tweet\n    _ = json.Unmarshal(*hit.Source, &amp;tweet)\n            fmt.Printf(\"entity: %s\", tweet) //It prints 10 entity\n}\n</code></pre>\n\n<p>What am I doing wrong? Are there batches in the SearchResult or what could be the solution?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550590836, "post_id": 54769217, "comment_id": 96319933, "body": "How did you create the keys? I&#39;ve found that the go libraries can&#39;t parse the keys when they&#39;re created by openssl. You have to actually create the keys using go&#39;s key creation code. It&#39;s kind of a weird issue. I&#39;ll post a link when I get to work for the go code to do the creation."}, {"owner": {"reputation": 189, "user_id": 5013644, "user_type": "registered", "profile_image": "https://graph.facebook.com/852470824827684/picture?type=large", "display_name": "Matheus Vin&#237;cius de Andrade", "link": "https://stackoverflow.com/users/5013644/matheus-vin%c3%adcius-de-andrade"}, "reply_to_user": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550592170, "post_id": 54769217, "comment_id": 96320749, "body": "This key was created in Ruby&#39;s legacy service, and I just tried to encrypt a token with this PublicKey."}, {"owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550600994, "post_id": 54769217, "comment_id": 96325628, "body": "Yeah it sounds like the issue is with the ruby generated certificates. Try the solution I posted and see if the certificates that that generates works for you. My guess is that it&#39;s the same issue I ran into when creating certificates with openssl. The error looks like the same error I was getting."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550613818, "post_id": 54769217, "comment_id": 96331233, "body": "@BenjiVesterby The issue you&#39;re both experiencing is to do with different encodings.  There are multiple ways (PKCS#1 and PKCS#8) to encode RSA keys."}], "answers": [{"comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1550612530, "post_id": 54770074, "comment_id": 96330739, "body": "This doesn&#39;t answer the question."}], "tags": [], "owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "is_accepted": false, "score": -1, "last_activity_date": 1550591084, "creation_date": 1550591084, "answer_id": 54770074, "question_id": 54769217, "link": "https://stackoverflow.com/questions/54769217/x509-go-package-parsepkixpublickey-is-to-der-or-pem/54770074#54770074", "title": "x509 Go package - ParsePKIXPublicKey is to DER or PEM?", "body": "<p>Here you go. </p>\n\n<p><a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\">https://golang.org/src/crypto/tls/generate_cert.go</a></p>\n\n<p>You have to generate the certificates using the code above. </p>\n\n<p>Like this:</p>\n\n<p>./generate_cert --host=\"source:destination\" -rsa-bits 1024</p>\n\n<p>openssl pkcs8 -topk8 -nocrypt -in key.pem -out privatekey.pcks8</p>\n\n<p>openssl x509 -pubkey -noout -in cert.pem  > publickey.pem</p>\n\n<p>This should solve the issue for you and give you the files you need. </p>\n"}, {"tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": true, "score": 5, "last_activity_date": 1550614110, "last_edit_date": 1550614110, "creation_date": 1550613770, "answer_id": 54775627, "question_id": 54769217, "link": "https://stackoverflow.com/questions/54769217/x509-go-package-parsepkixpublickey-is-to-der-or-pem/54775627#54775627", "title": "x509 Go package - ParsePKIXPublicKey is to DER or PEM?", "body": "<p>The issue here is understanding the difference between <code>x509.ParsePKCS1PublicKey</code> (PKCS#1) and <code>x509.ParsePKIXPublicKey</code> (PKCS#8).</p>\n\n<p>Usually when the PEM header has the type as <code>RSA PUBLIC KEY</code>, it is referring to a PKCS#1 encoded RSA public key, which is defined in <a href=\"https://tools.ietf.org/html/rfc8017#appendix-A.1.1\" rel=\"noreferrer\">RFC 8017 (PKCS#1)</a> as:</p>\n\n<pre><code>RSAPublicKey ::= SEQUENCE {\n     modulus           INTEGER,  -- n\n     publicExponent    INTEGER   -- e\n }\n</code></pre>\n\n<p>You haven't actually provided the body of your public key (it would be safe to do so), but it is a fair assumption that, if decoding the key using <code>x509.ParsePKIXPublicKey</code> failed, your key is likely in the above format (<code>x509.ParsePKIXPublicKey</code> uses PKCS#8 encoding).</p>\n\n<p>If this is the case, you should be able to get an <code>rsa.PublicKey</code> from the file using the following code (don't forget to add the error handling):</p>\n\n<pre><code>rawPem, _ := ioutil.ReadFile(\"./public.key\")\npemBlock, _ := pem.Decode(rawPem)\npublicKey, _ := x509.ParsePKCS1PublicKey(pemBlock.Bytes)\n</code></pre>\n\n<p>If this doesn't solve your problem, try pasting the key you have into <a href=\"https://lapo.it/asn1js/\" rel=\"noreferrer\">this site</a> to see what ASN.1 structure it uses.  For reference, the key I used to test this is included here:</p>\n\n<pre><code>-----BEGIN RSA PUBLIC KEY-----\nMIIBCgKCAQEApW1W9dnfdFF7FHrq6HPveR/9T+nM70yO7QOGytR0j/chMBJcJBjG\nhJOuKPFbkVyS+BE/4M8CojLgvz4ex82Re0sFa5TqnoWvuP5P4vktR6M5W53sTW3y\ngUnfF/oHcEmARQ1xKZdgVnlIfrdbpjecPyLi1Ng4HmhEfCFUOW64koxpb4XeH5O5\nq+vc/731ExVOYBU8Sl6kPdjpJuVjS3DHKAVgfVEhscXd3JDjDuMDT3w1IYNb5c2s\nwHE55q4Jnc1cr42jdynnkXzmuOGo2C6yD95kbBDLp7wSiBxaMA8gbRkzWJ99T+6l\nKsKG2zfndMF3jZW1v1wWiEbYRN07qbN0NQIDAQAB\n-----END RSA PUBLIC KEY-----\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/kb2Rb.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/kb2Rb.png\" alt=\"ASN.1 Structure of reference RSA Public Key\"></a></p>\n"}], "owner": {"reputation": 189, "user_id": 5013644, "user_type": "registered", "profile_image": "https://graph.facebook.com/852470824827684/picture?type=large", "display_name": "Matheus Vin&#237;cius de Andrade", "link": "https://stackoverflow.com/users/5013644/matheus-vin%c3%adcius-de-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3041, "favorite_count": 3, "accepted_answer_id": 54775627, "answer_count": 2, "score": 8, "last_activity_date": 1550614110, "creation_date": 1550588514, "question_id": 54769217, "link": "https://stackoverflow.com/questions/54769217/x509-go-package-parsepkixpublickey-is-to-der-or-pem", "title": "x509 Go package - ParsePKIXPublicKey is to DER or PEM?", "body": "<p>I'm trying to get an object of rsa.PublicKey and I made these steps:</p>\n\n<pre><code> ----BEGIN RSA PUBLIC KEY----\n           ....\n ----END RSA PUBLIC KEY----\n</code></pre>\n\n<pre><code>package main\n\nimport (\n   \"crypto/rand\"\n   \"crypto/rsa\"\n   \"crypto/x509\"\n   \"encoding/pem\"\n   \"fmt\"\n   \"io/ioutil\"\n)\n\nfunc main() {\n\n key, err := ioutil.ReadFile(\"./new_public.pem\")\n if err != nil {\n    fmt.Println(err.Error())\n }\n\n block, _ := pem.Decode([]byte(key))\n if block == nil {\n    fmt.Println(\"unable to decode publicKey to request\")\n }\n\n pub, err := x509.ParsePKIXPublicKey(block.Bytes)\n if err != nil {\n     panic(\"failed to parse RSA encoded  public key\" + err.Error())\n }\n\n switch pub := pub.(type) {\n case *rsa.PublicKey:\n     fmt.Println(\"pub is of type RSA:\", pub)\n default:\n     panic(\"error\")\n }\n</code></pre>\n\n<p>}</p>\n\n<p>After this, when I try to <code>x509.ParsePKIXPublicKey(block.Bytes)</code> I get an error:</p>\n\n<pre><code>panic: failed to parse RSA encoded  public keyasn1: \nstructure error: tags don't match (16 vs {class:0 tag:2 length:129 isCompound:false}) \n{\n optional:false \n explicit:false \n application:false \n private:false \n defaultValue:&lt;nil&gt; tag:&lt;nil&gt; \n stringType:0 \n timeType:0 \n set:false \n omitEmpty:false\n} AlgorithmIdentifier @3\n</code></pre>\n\n<p>So, I read some blogs and documentations about DER and PEM formats, and they are differents ways to encode an certificate, basicaly one use base64 and other is just bytes.</p>\n\n<p>In x509's package of Golang, the x509.ParsePKIXPublicKey says:</p>\n\n<p><code>ParsePKIXPublicKey parses a DER-encoded public key. These values are typically found in PEM blocks with \"BEGIN PUBLIC KEY\"</code></p>\n\n<p>And, in the example of this function use the pem.Decode().  I'm very confused about this because this should use <code>pem.Decode</code> or something like <code>der.Decode()</code> ?</p>\n\n<p>Also, what's the real difference between <code>x509.ParsePKCS1PublicKey()</code> and <code>x509.ParsePKIXPublicKey()</code> ? Both do the same job to get a rsa.PublicKey ?</p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-functions"], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 7516349, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-haTyO5tQLO0/AAAAAAAAAAI/AAAAAAAAALE/ntCLrob-Deg/photo.jpg?sz=128", "display_name": "Luca Casonato", "link": "https://stackoverflow.com/users/7516349/luca-casonato"}, "is_accepted": true, "score": 3, "last_activity_date": 1550771692, "creation_date": 1550771692, "answer_id": 54813353, "question_id": 54768891, "link": "https://stackoverflow.com/questions/54768891/error-3-on-go-finding-package-when-deploying/54813353#54813353", "title": "Error 3 on &quot;go: finding [package]&quot; when deploying", "body": "<p>After contacting Google I have figured out what the issue is.</p>\n\n<p>The issue is a combination of an error character limit of 4096 characters in Google Cloud Functions wrapper and an artificial timeout for go mod downloads imposed by Google.</p>\n\n<p>The issue can be resolved by vendoring your dependencies as explained here:  <a href=\"https://cloud.google.com/functions/docs/writing/specifying-dependencies-go#using_a_vendor_directory\" rel=\"nofollow noreferrer\">https://cloud.google.com/functions/docs/writing/specifying-dependencies-go#using_a_vendor_directory</a></p>\n"}], "owner": {"reputation": 93, "user_id": 7516349, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-haTyO5tQLO0/AAAAAAAAAAI/AAAAAAAAALE/ntCLrob-Deg/photo.jpg?sz=128", "display_name": "Luca Casonato", "link": "https://stackoverflow.com/users/7516349/luca-casonato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 1, "accepted_answer_id": 54813353, "answer_count": 1, "score": 3, "last_activity_date": 1550771692, "creation_date": 1550587580, "question_id": 54768891, "link": "https://stackoverflow.com/questions/54768891/error-3-on-go-finding-package-when-deploying", "title": "Error 3 on &quot;go: finding [package]&quot; when deploying", "body": "<p>I am trying to deploy a Go cloud function. I successfully deployed this function to one GCP project, but now when trying to deploy it to another I can't seem to get it to deploy.</p>\n\n<p>I use this command to deploy the function:</p>\n\n<pre><code>gcloud functions deploy Generator --entry-point Generator --memory 512MB --region europe-west1 --runtime go111 --trigger-event google.storage.object.finalize --trigger-resource gs://[redacted].appspot.com --project [redacted]\n</code></pre>\n\n<p>I am using a go.mod when deploying:</p>\n\n<pre><code>module gitlab.com/[redacted]/[redacted]/[redacted]\n\nrequire (\n    cloud.google.com/go v0.35.1\n    firebase.google.com/go v3.6.0+incompatible\n    github.com/tdewolff/parse/v2 v2.3.5\n    golang.org/x/net v0.0.0-20190125091013-d26f9f9a57f3\n    golang.org/x/text v0.3.1-0.20180807135948-17ff2d5776d2\n    google.golang.org/api v0.1.0\n)\n</code></pre>\n\n<p>I get this error message, which is cut off at the interesting part so I can't see what the actual issue is (I think).</p>\n\n<pre><code>ERROR: (gcloud.functions.deploy) OperationError: code=3, message=Build failed: go: finding github.com/tdewolff/parse/v2 v2.3.5\ngo: finding golang.org/x/net v0.0.0-20190125091013-d26f9f9a57f3\ngo: finding google.golang.org/api v0.1.0\ngo: finding golang.org/x/text v0.3.1-0.20180807135948-17ff2d5776d2\ngo: finding cloud.google.com/go v0.35.1\ngo: finding firebase.google.com/go v3.6.0+incompatible\ngo: finding github.com/tdewolff/test v1.0.0\ngo: finding golang.org/x/lint v0.0.0-20181026193005-c67002cb31c3\ngo: finding github.com/BurntSushi/toml v0.3.1\ngo: finding google.golang.org/genproto v0.0.0-20190122154452-ba6ebe99b011\ngo: finding golang.org/x/sync v0.0.0-20181108010431-42b317875d0f\ngo: finding github.com/google/btree v0.0.0-20180813153112-4030bb1f1f0c\ngo: finding github.com/google/pprof v0.0.0-20181206194817-3ea8567a2e57\ngo: finding golang.org/x/oauth2 v0.0.0-20181203162652-d668ce993890\ngo: finding google.golang.org/grpc v1.17.0\ngo: finding github.com/googleapis/gax-go/v2 v2.0.3\ngo: finding github.com/golang/mock v1.2.0\ngo: finding golang.org/x/tools v0.0.0-20181030000716-a0a13e073c7b\ngo: finding github.com/golang/protobuf v1.2.0\ngo: finding go.opencensus.io v0.18.0\ngo: finding honnef.co/go/tools v0.0.0-20190106161140-3f1c8253044a\ngo: finding golang.org/x/time v0.0.0-20181108054448-85acf8d2951c\ngo: finding golang.org/x/build v0.0.0-20190111050920-041ab4dc3f9d\ngo: finding github.com/google/martian v2.1.0+incompatible\ngo: finding google.golang.org/grpc v1.16.0\ngo: finding honnef.co/go/tools v0.0.0-20180728063816-88497007e858\ngo: finding cloud.google.com/go v0.26.0\ngo: finding golang.org/x/oauth2 v0.0.0-20180821212333-d2e6202438be\ngo: finding golang.org/x/sys v0.0.0-20180909124046-d0be0721c37e\ngo: finding github.com/golang/mock v1.1.1\ngo: finding github.com/client9/misspell v0.3.4\ngo: finding google.golang.org/genproto v0.0.0-20180831171423-11092d34479b\ngo: finding github.com/prometheus/procfs v0.0.0-20180725123919-05ee40e3a273\ngo: finding github.com/ghodss/yaml v1.0.0\ngo: finding gopkg.in/yaml.v2 v2.2.1\ngo: finding github.com/golang/glog v0.0.0-20160126235308-23def4e6c14b\ngo: finding golang.org/x/net v0.0.0-20180826012351-8a410e7b638d\ngo: finding google.golang.org/appengine v1.3.0\ngo: finding golang.org/x/sys v0.0.0-20180830151530-49385e6e1522\ngo: finding github.com/matttproud/golang_protobuf_extensions v1.0.1\ngo: finding github.com/prometheus/common v0.0.0-20180801064454-c7de2306084e\ngo: finding github.com/gopherjs/gopherjs v0.0.0-20181017120253-0766667cb4d1\ngo: finding github.com/google/go-cmp v0.2.0\ngo: finding github.com/davecgh/go-spew v1.1.1\ngo: finding github.com/shurcooL/httperror v0.0.0-20170206035902-86b7830d14cc\ngo: finding github.com/stretchr/testify v1.2.2\ngo: finding golang.org/x/sys v0.0.0-20181029174526-d69651ed3497\ngo: finding github.com/shurcooL/httpfs v0.0.0-20171119174359-809beceb2371\ngo: finding github.com/google/go-github v17.0.0+incompatible\ngo: finding google.golang.org/api v0.0.0-20180910000450-7ca32eb868bf\ngo: finding github.com/kisielk/gotool v1.0.0\ngo: finding github.com/shurcooL/highlight_diff v0.0.0-20170515013008-09bb4053de1b\ngo: finding github.com/shurcooL/htmlg v0.0.0-20170918183704-d01228ac9e50\ngo: finding github.com/sourcegraph/syntaxhighlight v0.0.0-20170531221838-bd320f5d308e\ngo: finding google.golang.org/genproto v0.0.0-20181202183823-bd91e49a0898\ngo: finding golang.org/x/net v0.0.0-20181106065722-10aee1819953\ngo: finding golang.org/x/net v0.0.0-20181029044818-c44066c5c816\ngo: finding golang.org/x/lint v0.0.0-20180702182130-06c8688daad7\ngo: finding github.com/prometheus/client_golang v0.8.0\ngo: finding github.com/flynn/go-shlex v0.0.0-20150515145356-3f9db97f8568\ngo: finding github.com/coreos/go-systemd v0.0.0-20181012123002-c6f51f82210d\ngo: finding github.com/shurcooL/github_flavored_markdown v0.0.0-20181002035957-2122de532470\ngo: finding github.com/openzipkin/zipkin-go v0.1.1\ngo: finding golang.org/x/perf v0.0.0-20180704124530-6e6d33e29852\ngo: finding github.com/gliderlabs/ssh v0.1.1\ngo: finding go4.org v0.0.0-20180809161055-417644f6feb5\ngo: finding dmitri.shuralyov.com/html/belt v0.0.0-20180602232347-f7d459c86be0\ngo: finding golang.org/x/text v0.3.0\ngo: finding gi\n</code></pre>\n\n<p>How do I get the function to deploy?</p>\n"}, {"tags": ["go", "ssh", "mgo"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562825614, "post_id": 54768098, "comment_id": 100500585, "body": "Do you need to tunnel or are you just trying to have a poor man&#39;s version of TLS?"}, {"owner": {"reputation": 25, "user_id": 10166198, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ct5Q0Yye3rM/AAAAAAAAAAI/AAAAAAAAAAw/Euee5XXC0VU/photo.jpg?sz=128", "display_name": "Vladimir Loct", "link": "https://stackoverflow.com/users/10166198/vladimir-loct"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1562923273, "post_id": 54768098, "comment_id": 100540862, "body": "@MarkusWMahlberg I need to tunnel"}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 1, "last_activity_date": 1563917755, "creation_date": 1563917755, "answer_id": 57172526, "question_id": 54768098, "link": "https://stackoverflow.com/questions/54768098/connection-to-mongodb-via-ssh-golang/57172526#57172526", "title": "Connection to mongoDB via SSH golang", "body": "<p>It really does not make sense to add the tunneling function into your code. A simple wrapper shell script prevents you from the necessity to reinvent the wheel:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/bin/bash\n\nssh $USER@$MONGO_HOST -L $LOCAL_PORT:127.0.0.1:27017\n./yourApplication \"$*\"\n</code></pre>\n\n<p>With this, you can call your program via the wrapper as usual.</p>\n"}], "owner": {"reputation": 25, "user_id": 10166198, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ct5Q0Yye3rM/AAAAAAAAAAI/AAAAAAAAAAw/Euee5XXC0VU/photo.jpg?sz=128", "display_name": "Vladimir Loct", "link": "https://stackoverflow.com/users/10166198/vladimir-loct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 57172526, "answer_count": 1, "score": 0, "last_activity_date": 1563917755, "creation_date": 1550584968, "question_id": 54768098, "link": "https://stackoverflow.com/questions/54768098/connection-to-mongodb-via-ssh-golang", "title": "Connection to mongoDB via SSH golang", "body": "<p>I need to connect to remote mongoDB server via ssh, i was doing this earlier with mysql and its looks like :</p>\n\n<pre><code>sshcon, err := ssh.Dial(\"tcp\", fmt.Sprintf(\"%s:%d\", sshHost, sshPort), sshConfig)\n    if err == nil {\n        defer sshcon.Close()\n        mysql.RegisterDial(\"mysql+tcp\", (&amp;ViaSSHDialer{sshcon}).Dial)\n</code></pre>\n\n<p>Is there a similar function like mysql.RegisterDial in mgo package?</p>\n"}, {"tags": ["go", "methods", "interface", "gob"], "comments": [{"owner": {"reputation": 2010, "user_id": 6625815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XUtQf.jpg?s=128&g=1", "display_name": "Andrew F", "link": "https://stackoverflow.com/users/6625815/andrew-f"}, "edited": false, "score": 0, "creation_date": 1550581209, "post_id": 54766528, "comment_id": 96313864, "body": "I don&#39;t have time to test it right now, but I suspect you may want to register your <code>package.OtherStruct</code> also in the <code>init()</code> function."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 2010, "user_id": 6625815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XUtQf.jpg?s=128&g=1", "display_name": "Andrew F", "link": "https://stackoverflow.com/users/6625815/andrew-f"}, "edited": false, "score": 0, "creation_date": 1550584339, "post_id": 54766528, "comment_id": 96315826, "body": "@AndrewF, good idea!, sadly it wasn&#39;t because of that. Ill update the question. Thanks anyway!"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1550584555, "creation_date": 1550584555, "answer_id": 54767962, "question_id": 54766528, "link": "https://stackoverflow.com/questions/54766528/gob-decode-cannot-decode-interface-after-register-type/54767962#54767962", "title": "Gob decode cannot decode interface after register type", "body": "<p>The error message says:</p>\n\n<blockquote>\n  <p>gob: OtherMsg is not assignable to type MyMessage</p>\n</blockquote>\n\n<p>Which is true. <code>MyMessage</code> is an interface which requires implementing types to have a method:</p>\n\n<pre><code>Id() *MyMessageHeader\n</code></pre>\n\n<p>A value of type <code>OtherMsg</code> does not have such method in its <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">method set</a>, only a pointer to it, that is a value of type <code>*OtherMsg</code> (because <code>OtherMsg.Id()</code> has pointer receiver).</p>\n\n<p>To make it work, register a value of type <code>*OtherMsg</code>:</p>\n\n<pre><code>gob.RegisterName(\"OtherMsg\", &amp;OtherMsg{})\n</code></pre>\n\n<p>Or simply:</p>\n\n<pre><code>gob.Register(&amp;OtherMsg{})\n</code></pre>\n\n<p>See a working example on the Go Playground:</p>\n\n<pre><code>func init() {\n    gob.Register(&amp;OtherMsg{})\n}\n\nfunc main() {\n    var m MyMessage = &amp;OtherMsg{\n        MyMessageHeader: MyMessageHeader{\n            MessageId: 1,\n            OtherId:   2,\n        },\n        OtherField: \"othervalue\",\n    }\n\n    data, err := MarshalMessage(m)\n    if err != nil {\n        panic(err)\n    }\n\n    m2, err := UnmarshalMessage(data)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Printf(\"%+v\\n\", m2)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/lTfGmA7z-9f\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{MyMessageHeader:{MessageId:1 OtherId:2} OtherField:othervalue}\n</code></pre>\n"}], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 54767962, "answer_count": 1, "score": 5, "last_activity_date": 1550584817, "creation_date": 1550579823, "last_edit_date": 1550584817, "question_id": 54766528, "link": "https://stackoverflow.com/questions/54766528/gob-decode-cannot-decode-interface-after-register-type", "title": "Gob decode cannot decode interface after register type", "body": "<p>I have these types defined:</p>\n\n<pre><code>func init() {\n    gob.RegisterName(\"MyMessageHeader\", MyMessageHeader{})\n    gob.RegisterName(\"OtherMsg\", OtherMsg{})\n}\n\n//\n// Messages\n//\n\ntype MyMessageHeader struct {\n    MessageId InstanceIdType\n    OtherId   uint64\n}\n\ntype MyMessage interface {\n    Id() *MyMessageHeader\n}\n\ntype otherStruct struct {\n    X uint8\n    Y uint8\n}\ntype OtherMsg struct {\n    MyMessageHeader\n    OtherField *otherStruct\n}\n\n\nfunc (m *OtherMsg) Id() *MyMessageHeader {\n    return &amp;m.MyMessageHeader\n}\n\nfunc MarshalMessage(m MyMessage) ([]byte, error) {\n    var buff bytes.Buffer\n    encoder := gob.NewEncoder(&amp;buff)\n    if err := encoder.Encode(&amp;m); err != nil {\n        return nil, errors.Newf(\"Could not marshal message: %v\", err)\n    }\n    return buff.Bytes(), nil\n}\n\nfunc UnmarshalMessage(buf []byte) (MyMessage, error) {\n    var msg MyMessage\n    decoder := gob.NewDecoder(bytes.NewReader(buf))\n    if err := decoder.Decode(&amp;msg); err != nil {\n        return nil, errors.Newf(\"Could not decode my message: %v\", err)\n    }\n    return msg, nil\n}\n</code></pre>\n\n<p>When I try to use <code>UnmarshalMessage</code> I got the error <code>gob: OtherMsg is not assignable to type MyMessage</code>. \nI have no difference with the usage in the <a href=\"https://golang.org/pkg/encoding/gob/#example__interface\" rel=\"nofollow noreferrer\">go examples</a> for encoding and decoding an interface. What am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1550576161, "post_id": 54765161, "comment_id": 96310834, "body": "have you tried to use a pointer ?"}, {"owner": {"reputation": 189, "user_id": 1348572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ALppn.jpg?s=128&g=1", "display_name": "tunacado", "link": "https://stackoverflow.com/users/1348572/tunacado"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1550576347, "post_id": 54765161, "comment_id": 96310938, "body": "Not sure I follow, sorry; how would a pointer to the field in the struct that is unmarshalled help, if it still points to a <code>false</code> value by default?  I don&#39;t know whether the user explicitly set <code>false</code> or if it&#39;s actually an empty field, and I don&#39;t want to accidentally overwrite their settings.  Sorry if I&#39;m being dense."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 2, "creation_date": 1550576475, "post_id": 54765161, "comment_id": 96311018, "body": "If <code>yaml</code> works like the <code>json</code> package, then you can have a <code>VerifySSL *bool</code> field, and it will default to <code>nil</code> rather than (a pointer to) <code>false</code>. Might need the <code>omitempty</code> flag as well."}], "answers": [{"tags": [], "owner": {"reputation": 189, "user_id": 1348572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ALppn.jpg?s=128&g=1", "display_name": "tunacado", "link": "https://stackoverflow.com/users/1348572/tunacado"}, "is_accepted": true, "score": 5, "last_activity_date": 1550578282, "last_edit_date": 1550578282, "creation_date": 1550577012, "answer_id": 54765669, "question_id": 54765161, "link": "https://stackoverflow.com/questions/54765161/how-to-test-for-default-values-in-golang-when-yaml-has-already-initialized-the-v/54765669#54765669", "title": "How to test for default values in Golang when yaml has already initialized the value?", "body": "<p>Thanks to <a href=\"https://stackoverflow.com/users/14637/thomas\">Thomas</a> and <a href=\"https://stackoverflow.com/users/4466350/mh-cbon\">mh-cbon</a> I found out I can just use a pointer for this.  If I change my <code>VerifySSL</code> field to utilize a pointer and add <code>omitempty</code>:</p>\n\n<pre><code>type daemonConfig struct {\n    BindAddress string `yaml:\"bind_address\"`\n    BindPort    int    `yaml:\"bind_port\"`\n    VerifySSL   *bool  `yaml:\"verify_ssl\",omitempty`\n}\n</code></pre>\n\n<p>I can simply dereference the field in the struct to get the true value of what <code>yaml</code> unmarshalled.  Setting defaults is as easy as:</p>\n\n<pre><code>func setDefaults(config *daemonConfig) (*daemonConfig, error) {\n    if len(config.BindAddress) &lt;= 0 {\n        config.BindAddress = \"0.0.0.0\"\n    }\n    if config.BindPort == 0 {\n        config.BindPort = 9999\n    }\n    if config.VerifySSL == nil {\n        ssl := true\n        config.VerifySSL = &amp;ssl\n    }\n\n    return config, nil\n}\n</code></pre>\n\n<p>If it's loaded in the file, <code>config.VerifySSL</code> will contain the address of the <code>bool</code>, so it won't be <code>nil</code>, and if it's truly not in the file at all then the field is simply <code>nil</code> and I can set it or get it via a pointer.</p>\n\n<p>EDIT:\nJust a note, if your <code>VerifySSL</code> pointer is nil, you can't assign it like this:</p>\n\n<pre><code>*config.VerifySSL = true\n</code></pre>\n\n<p>That's dereferencing a <code>nil</code> pointer.  I've updated the solution to include something more manageable.</p>\n"}], "owner": {"reputation": 189, "user_id": 1348572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ALppn.jpg?s=128&g=1", "display_name": "tunacado", "link": "https://stackoverflow.com/users/1348572/tunacado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1594, "favorite_count": 0, "accepted_answer_id": 54765669, "answer_count": 1, "score": 1, "last_activity_date": 1550578282, "creation_date": 1550575381, "last_edit_date": 1550576166, "question_id": 54765161, "link": "https://stackoverflow.com/questions/54765161/how-to-test-for-default-values-in-golang-when-yaml-has-already-initialized-the-v", "title": "How to test for default values in Golang when yaml has already initialized the value?", "body": "<p>I'm writing a daemon's configuration handler and utilizing the <code>yaml</code> package to do so.  Importing my file works like this:</p>\n\n<pre><code>package daemon\n\nimport (\n    \"ioutil\"\n    \"log\"\n\n    \"gopkg.in/yaml.v2\"\n)\n\ntype daemonConfig struct {\n    BindAddress string `yaml:\"bind_address\"`\n    BindPort    int    `yaml:\"bind_port\"`\n    VerifySSL   bool   `yaml:\"verify_ssl\"`\n}\n</code></pre>\n\n<p>I easily unmarshall data from my YAML files like so:</p>\n\n<pre><code>func (config *daemonConfig) getConf() *daemonConfig {\n    yamlFile, err := ioutil.ReadFile(\"config.yaml\")\n    if err != nil {\n        log.Fatal(\"Unable to open config.yaml:\", err)\n    }\n    err = yaml.Unmarshal(yamlFile, config)\n    if err != nil {\n        log.Fatal(\"Failed to unmarshall config.yaml:\", err)\n    }\n    config, err = setDefaults(config)\n\n    return config\n}\n</code></pre>\n\n<p>My question is regarding my custom setDefaults function.  If a field isn't provided, like <code>bind_port</code> or <code>bind_address</code>, I'd like to just set them to defaults:</p>\n\n<pre><code>func setDefaults(config *daemonConfig) (*daemonConfig, error) {\n    if len(config.BindAddress) &lt;= 0 {\n        config.BindAddress = \"0.0.0.0\"\n    }\n    if config.BindPort == 0 {\n        config.BindPort = 9999\n    }\n\n    return config, nil\n}\n</code></pre>\n\n<p>You'll note I'm not setting a default to <code>verify_ssl</code>; when <code>yaml</code> unmarshalls this and fails to find the field, it initializes the <code>bool</code> as <code>false</code>, which is precisely the opposite of what I want the default behavior to be.  I'd prefer the user to explicitly set verification of SSL to be off, instead of having it off by default if not specified.  If I have a totally empty <code>config.yaml</code>, and expect the default values to be set, it will always put <code>verify_ssl</code> as false (this log is from elsewhere in the application):</p>\n\n<pre><code>2019/02/19 03:56:08 Currently loaded config: {0.0.0.0 9999 false}\n</code></pre>\n\n<p>How would I go about, if this field is not present in the YAML fields that are being unmarshalled, to checking if the line exists?  I could just read the file manually and check for that parameter first, but I was wondering if there's a more elegant way with what I have; otherwise, I'll just use <code>ioutil</code> and string checking to do it.  Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 40344, "user_id": 1796579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b14d3685f0765c738fd90c7ec71fa9ba?s=128&d=identicon&r=PG", "display_name": "Henry", "link": "https://stackoverflow.com/users/1796579/henry"}, "edited": false, "score": 0, "creation_date": 1550578747, "post_id": 54764980, "comment_id": 96312371, "body": "If you are using bash as your shell then <code>~&#47;.bashrc</code> would be a good place. Alternatively you can set it on the command line (<code>export GOPATH=...</code>), but that setting would be gone after the next login."}, {"owner": {"reputation": 2713, "user_id": 876882, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FmRII.jpg?s=128&g=1", "display_name": "Frax", "link": "https://stackoverflow.com/users/876882/frax"}, "edited": false, "score": 1, "creation_date": 1550580030, "post_id": 54764980, "comment_id": 96313191, "body": "It seems that the paths are already set, but you could be working in the wrong directory. Go is looking in ~/work whereas you&#39;re working in ~/.work (notice the &quot;dot&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 0, "last_activity_date": 1550585281, "creation_date": 1550585281, "answer_id": 54768189, "question_id": 54764980, "link": "https://stackoverflow.com/questions/54764980/how-do-i-set-the-gopath-environment-variable-in-go-1-11-on-ubuntu-what-file-mus/54768189#54768189", "title": "how do I SET the GOPATH environment variable in go 1.11 on Ubuntu? What file must I edit?", "body": "<p>This question seems to be about setting environment variables, not about the Go programming language.</p>\n\n<p>As such, there are many answers. For example <a href=\"https://askubuntu.com/questions/58814/how-do-i-add-environment-variables\">this ask.ubuntu question</a>.</p>\n\n<p>The easiest way for experimentation is prefixing your commands with <code>NAME=value</code>, for example:</p>\n\n<pre><code>$ GOPATH=/some/path go &lt;command&gt;\n</code></pre>\n\n<p>Or, if you want to extend it to multiple shell commands within the same session, do:</p>\n\n<pre><code>$ export GOPATH=/some/path\n$ go &lt;command&gt;\n</code></pre>\n\n<p>Once these work well, add the <code>GOPATH</code> setting to your <code>~/.bashrc</code> file so that future sessions will find it without needing to <code>export</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8315817, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4658175414306c1a13774f35c3d19977?s=128&d=identicon&r=PG&f=1", "display_name": "Sahana J C", "link": "https://stackoverflow.com/users/8315817/sahana-j-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 847, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1550585281, "creation_date": 1550574877, "last_edit_date": 1550578547, "question_id": 54764980, "link": "https://stackoverflow.com/questions/54764980/how-do-i-set-the-gopath-environment-variable-in-go-1-11-on-ubuntu-what-file-mus", "title": "how do I SET the GOPATH environment variable in go 1.11 on Ubuntu? What file must I edit?", "body": "<pre><code>ubuntu@ubuntu:~/.work/src/github.hpe.com/hybridpoc/marketplace-terraform-tf-broker$ go run main.go\nmain.go:10:2: cannot find package \"github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/broker/github\" in any of:\n        /home/ubuntu/go/src/github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/broker/github (from $GOROOT)\n        /home/ubuntu/work/src/github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/broker/github (from $GOPATH)\nmain.go:11:2: cannot find package \"github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/handlers\" in any of:\n        /home/ubuntu/go/src/github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/handlers (from $GOROOT)\n        /home/ubuntu/work/src/github.hpe.com/hybridpoc/marketplace-terraform-tf-broker/handlers (from $GOPATH)\n</code></pre>\n"}, {"tags": ["file", "go", "concurrency"], "comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550574503, "post_id": 54764757, "comment_id": 96309799, "body": "If you close the file, you will have to open it again at the beginning of your handler."}, {"owner": {"reputation": 67, "user_id": 11083943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080678835a931aec2dacea9c22870579?s=128&d=identicon&r=PG&f=1", "display_name": "Sailor Moon", "link": "https://stackoverflow.com/users/11083943/sailor-moon"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550574735, "post_id": 54764757, "comment_id": 96309930, "body": "@Abdullah that&#39;s why I&#39;m asking) Is it safe not to close the file?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1550575816, "post_id": 54764757, "comment_id": 96310630, "body": "<code>Should I close it somehow on each writing operation?</code> this is very specific to the use case. However, don t forget to sync to make sure data is written on disk, see <a href=\"https://golang.org/pkg/os/#File.Sync\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#File.Sync</a>."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 11083943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080678835a931aec2dacea9c22870579?s=128&d=identicon&r=PG&f=1", "display_name": "Sailor Moon", "link": "https://stackoverflow.com/users/11083943/sailor-moon"}, "edited": false, "score": 0, "creation_date": 1550575706, "post_id": 54765207, "comment_id": 96310558, "body": "Does <code>Write()</code> guarantees that changes will be saved? Isn&#39;t it <code>Close()</code>&#39;s responsibility?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 67, "user_id": 11083943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080678835a931aec2dacea9c22870579?s=128&d=identicon&r=PG&f=1", "display_name": "Sailor Moon", "link": "https://stackoverflow.com/users/11083943/sailor-moon"}, "edited": false, "score": 0, "creation_date": 1550575785, "post_id": 54765207, "comment_id": 96310608, "body": "@SailorMoon Yes, there is no guarantee that when <code>File.Write()</code> returns the data is written to the underlying storage unit."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550581234, "post_id": 54765207, "comment_id": 96313878, "body": "Neither <code>Write()</code> nor <code>Close()</code> guarantee that the changes are actually written. You can use <code>Sync()</code> and check the returned error before closing the file."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550582326, "post_id": 54765207, "comment_id": 96314520, "body": "@Abdullah Yes, it does not guarantee that the data written will appear on the disk right away. But if <code>Close()</code> does not return an error, the data will be written to disk eventually, even if the app terminates."}, {"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550621411, "post_id": 54765207, "comment_id": 96333376, "body": "@icza Yes, this is true unless there is a disk failure which is a bigger problem all together."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1550575710, "last_edit_date": 1550575710, "creation_date": 1550575547, "answer_id": 54765207, "question_id": 54764757, "link": "https://stackoverflow.com/questions/54764757/should-i-close-file-while-writing-reading-concurrently/54765207#54765207", "title": "Should I close file while writing/reading concurrently?", "body": "<p>You can't write to a closed file, so if you close it after each write operation, you also have to (re)open it before each write.</p>\n\n<p>This would be quite inefficient. So instead leave it open, and only close it once your app is about to terminate (this is required because <a href=\"https://golang.org/pkg/os/#File.Write\" rel=\"nofollow noreferrer\"><code>File.Write()</code></a> does not guarantee that when it returns the data is written to disk). Since you're writing the file from HTTP handlers, you should implement graceful server termination, and close the file after that. See <a href=\"https://golang.org/pkg/net/http/#Server.Shutdown\" rel=\"nofollow noreferrer\"><code>Server.Shutdown()</code></a> for details.</p>\n\n<p>Also, if the purpose of your shared file writing is to create some kind of logger, you could take advantage of the <a href=\"https://golang.org/pkg/log/\" rel=\"nofollow noreferrer\"><code>log</code></a> package, so you would not have to use a mutex. For details, see <a href=\"https://stackoverflow.com/questions/52294334/net-http-set-custom-logger/52298092#52298092\">net/http set custom logger</a>.</p>\n"}], "owner": {"reputation": 67, "user_id": 11083943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080678835a931aec2dacea9c22870579?s=128&d=identicon&r=PG&f=1", "display_name": "Sailor Moon", "link": "https://stackoverflow.com/users/11083943/sailor-moon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 54765207, "answer_count": 1, "score": 3, "last_activity_date": 1550575710, "creation_date": 1550574257, "question_id": 54764757, "link": "https://stackoverflow.com/questions/54764757/should-i-close-file-while-writing-reading-concurrently", "title": "Should I close file while writing/reading concurrently?", "body": "<p>I'm making a server that can read/write from file concurrently(from goroutines populated by <code>net/http</code> handlers). I've created The following struct:</p>\n\n<pre><code>type transactionsFile struct {\n    File  *os.File\n    Mutex *sync.RWMutex\n}\n</code></pre>\n\n<p>I'm initializing file once at the <code>init()</code> function. Should I close it somehow on each writing operation?</p>\n"}, {"tags": ["ubuntu", "go", "kubernetes", "kubelet"], "comments": [{"owner": {"reputation": 2796, "user_id": 9892073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVaKd.png?s=128&g=1", "display_name": "aurelius", "link": "https://stackoverflow.com/users/9892073/aurelius"}, "edited": false, "score": 0, "creation_date": 1550855134, "post_id": 54763027, "comment_id": 96438686, "body": "I followed ur steps and in no scenario I am getting any errors. Used Minikube v1.10, Compute Engine v1.13 and CE v1.12.1 all as single node cluster (master is the node). Only thing I spotted in minikube was <code>Error from server: error when creating &quot;STDIN&quot;: etcdserver: request timed out</code> but I was able to easily reach 400, 500 jobs completed. So there has to be other problem, can you provide more details - what else is going on in the cluster? How did you deploy it and where? Do you have any tolerations, requests/limits set? Also please provide <code>kubectl describe node master_name</code>"}, {"owner": {"reputation": 3157, "user_id": 4463242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5502cad7b1240282a94f2b6ff31f7a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederik Carlier", "link": "https://stackoverflow.com/users/4463242/frederik-carlier"}, "reply_to_user": {"reputation": 2796, "user_id": 9892073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVaKd.png?s=128&g=1", "display_name": "aurelius", "link": "https://stackoverflow.com/users/9892073/aurelius"}, "edited": false, "score": 0, "creation_date": 1551089636, "post_id": 54763027, "comment_id": 96498223, "body": "That&#39;s odd, I can consistently reproduce this in a Vagrant environment. I&#39;ve uploaded the script I use to provision the environment to <a href=\"https://github.com/qmfrederik/k8s-job-repro\" rel=\"nofollow noreferrer\">github.com/qmfrederik/k8s-job-repro</a>.  It uses a custom Ansible role to provision the VM, but it&#39;s pretty standard Kubernetes. I&#39;ve noticed the problem does not reproduce with Kubernetes v1.11 but does with v1.12 and v1.13."}, {"owner": {"reputation": 3157, "user_id": 4463242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5502cad7b1240282a94f2b6ff31f7a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederik Carlier", "link": "https://stackoverflow.com/users/4463242/frederik-carlier"}, "reply_to_user": {"reputation": 2796, "user_id": 9892073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVaKd.png?s=128&g=1", "display_name": "aurelius", "link": "https://stackoverflow.com/users/9892073/aurelius"}, "edited": false, "score": 0, "creation_date": 1551190210, "post_id": 54763027, "comment_id": 96543766, "body": "<a href=\"https://github.com/kubernetes/kubernetes/issues/74302\" rel=\"nofollow noreferrer\">github.com/kubernetes/kubernetes/issues/74302</a> and <a href=\"https://github.com/kubernetes/kubernetes/issues/74412\" rel=\"nofollow noreferrer\">github.com/kubernetes/kubernetes/issues/74412</a> describe this in further detail."}], "answers": [{"tags": [], "owner": {"reputation": 2796, "user_id": 9892073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pVaKd.png?s=128&g=1", "display_name": "aurelius", "link": "https://stackoverflow.com/users/9892073/aurelius"}, "is_accepted": true, "score": 0, "last_activity_date": 1555321398, "creation_date": 1555321398, "answer_id": 55686437, "question_id": 54763027, "link": "https://stackoverflow.com/questions/54763027/kubernetes-cluster-with-finished-jobs-unstable-kubelet-logs-filled-with-http2/55686437#55686437", "title": "Kubernetes Cluster with finished jobs unstable; kubelet logs filled with &quot;http2: no cached connection was available&quot;", "body": "<p>Just to summarize this problem and why does it happen. It has been actually an issue related to 1.12 and 1.13. As explained in <a href=\"https://github.com/kubernetes/kubernetes/issues/74412\" rel=\"nofollow noreferrer\">GitHub issue</a> (probably created by author) this seems to be an issue of http2 connection pool implementing, or as explained in one of the comments it is a connection management problem in kubelet. Described ways of mitigating can be found <a href=\"https://github.com/kubernetes/kubernetes/issues/74412#issuecomment-468437599\" rel=\"nofollow noreferrer\">here</a>. and if you would need more information all links are avaliable in the linked GitHub issue.  </p>\n"}], "owner": {"reputation": 3157, "user_id": 4463242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5502cad7b1240282a94f2b6ff31f7a1c?s=128&d=identicon&r=PG&f=1", "display_name": "Frederik Carlier", "link": "https://stackoverflow.com/users/4463242/frederik-carlier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "accepted_answer_id": 55686437, "answer_count": 1, "score": 0, "last_activity_date": 1555321398, "creation_date": 1550569217, "last_edit_date": 1550590740, "question_id": 54763027, "link": "https://stackoverflow.com/questions/54763027/kubernetes-cluster-with-finished-jobs-unstable-kubelet-logs-filled-with-http2", "title": "Kubernetes Cluster with finished jobs unstable; kubelet logs filled with &quot;http2: no cached connection was available&quot;", "body": "<h3>Summary</h3>\n\n<p>I have various single-node Kubernetes clusters which become unstable after having accumulated ~300 completed jobs.</p>\n\n<p>In one cluster, for example, there are 303 completed jobs:</p>\n\n<pre><code>root@xxxx:/home/xxxx# kubectl get jobs | wc -l\n303\n</code></pre>\n\n<h3>Observations</h3>\n\n<p>What I observe is that</p>\n\n<ul>\n<li>The <code>kubelet</code> logs are filled with error messages like this: <code>kubelet[877]: E0219 09:06:14.637045     877 reflector.go:134] object-\"default\"/\"job-162273560\": Failed to list *v1.ConfigMap: Get https://172.13.13.13:6443/api/v1/namespaces/default/configmaps?fieldSelector=metadata.name%3Djob-162273560&amp;limit=500&amp;resourceVersion=0: http2: no cached connection was available</code></li>\n<li>The node status is not being updated, with a similar error message:\n<code>kubelet[877]: E0219 09:32:57.379751     877 reflector.go:134] k8s.io/kubernetes/pkg/kubelet/kubelet.go:451: Failed to list *v1.Node: Get https://172.13.13.13:6443/api/v1/nodes?fieldSelector=metadata.name%3Dxxxxx&amp;limit=500&amp;resourceVersion=0: http2: no cached connection was available\n</code></li>\n<li>Eventually, the node is being marked as <code>NotReady</code> and no new pods are scheduled\n<code>\nNAME    STATUS     ROLES    AGE    VERSION\nxxxxx   NotReady   master   6d4h   v1.12.1</code></li>\n<li>The cluster is entering and exiting the master disruption mode (from the <code>kube-controller-manager</code> logs): \n<code>\nI0219 09:29:46.875397       1 node_lifecycle_controller.go:1015] Controller detected that all Nodes are not-Ready. Entering master disruption mode.\nI0219 09:30:16.877715       1 node_lifecycle_controller.go:1042] Controller detected that some Nodes are Ready. Exiting master disruption mode.\n</code></li>\n</ul>\n\n<p>The real culprit appears to be the <code>http2: no cached connection was available</code> error message. The only real references I've found are a couple of issues in the Go repository (like <a href=\"https://github.com/golang/go/issues/16582\" rel=\"nofollow noreferrer\">#16582</a>), which appear to have been fixed a long time ago.</p>\n\n<p>In most cases, deleting the completed jobs seems to restore the system stability.</p>\n\n<h3>Minimal repro (tbc)</h3>\n\n<p>I seem to be able to reproduce this problem by creating lots of jobs which use containers which mount ConfigMaps:</p>\n\n<pre><code>---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: job-%JOB_ID%\ndata:\n# Just some sample data\n  game.properties: |\n    enemies=aliens\n    lives=3\n    enemies.cheat=true\n    enemies.cheat.level=noGoodRotten\n    secret.code.passphrase=UUDDLRLRBABAS\n    secret.code.allowed=true\n    secret.code.lives=30\n  ui.properties: |\n    color.good=purple\n    color.bad=yellow\n    allow.textmode=true\n    how.nice.to.look=fairlyNice\n---\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: job-%JOB_ID%\nspec:\n  template:\n    spec:\n      containers:\n      - name: pi\n        image: perl\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(20)\"]\n        volumeMounts:\n        - name: config-volume\n          mountPath: /etc/config\n      volumes:\n        - name: config-volume\n          configMap:\n            name: job-%JOB_ID%\n      restartPolicy: Never\n  backoffLimit: 4\n</code></pre>\n\n<p>Schedule lots of these jobs:</p>\n\n<pre><code>#!/bin/bash\nfor i in `seq 100 399`;\ndo\n    cat job.yaml | sed \"s/%JOB_ID%/$i/g\" | kubectl create -f -\n    sleep 0.1\ndone\n</code></pre>\n\n<h3>Questions</h3>\n\n<p>I'm very curious though as to what causes this problem, as 300 completed jobs seems to be a fairly low number.</p>\n\n<p>Is this a configuration problem in my cluster? A possible bug in Kubernetes/Go? Anything else that I can try?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21, "user_id": 9037373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vWmi-OGkuWM/AAAAAAAAAAI/AAAAAAAAABo/OLG-XsmW2-M/photo.jpg?sz=128", "display_name": "Max Yu", "link": "https://stackoverflow.com/users/9037373/max-yu"}, "edited": false, "score": 0, "creation_date": 1550572403, "post_id": 54762079, "comment_id": 96308522, "body": "I&#39;m not only want to refresh the timestamp, but to update the timestamp as a setting value. like touch -t 201203101513 -h symlink"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 9037373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vWmi-OGkuWM/AAAAAAAAAAI/AAAAAAAAABo/OLG-XsmW2-M/photo.jpg?sz=128", "display_name": "Max Yu", "link": "https://stackoverflow.com/users/9037373/max-yu"}, "edited": false, "score": 0, "creation_date": 1550572223, "post_id": 54762335, "comment_id": 96308404, "body": "I haven&#39;t described my question clear, I want to change the timestamp as I want. for example, change the symlink&#39;s timestamp to 2018/12/12 11:22:33"}], "tags": [], "owner": {"reputation": 527, "user_id": 335472, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/3eec49d54e643c464a5d9e42c8dd5c59?s=128&d=identicon&r=PG", "display_name": "Joao Henrique", "link": "https://stackoverflow.com/users/335472/joao-henrique"}, "is_accepted": false, "score": 0, "last_activity_date": 1550566958, "creation_date": 1550566958, "answer_id": 54762335, "question_id": 54762079, "link": "https://stackoverflow.com/questions/54762079/how-to-change-timestamp-for-symbol-link-using-golang/54762335#54762335", "title": "How to change timestamp for symbol link using golang?", "body": "<p>You can check if a symlink exists and if so, remove it and create another one.</p>\n\n<pre><code>if _, err := os.Lstat(symlinkPath); err == nil {\n  os.Remove(symlinkPath)\n}\n\nerr := os.Symlink(filePath, symlinkPath)\nif err != nil {\n  fmt.Println(err)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2680, "user_id": 5556676, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/873efb3aa94e7f6805c489dcc0ebb57f?s=128&d=identicon&r=PG&f=1", "display_name": "init_js", "link": "https://stackoverflow.com/users/5556676/init-js"}, "edited": false, "score": 1, "creation_date": 1553840740, "post_id": 54769817, "comment_id": 97542754, "body": "This appears correct. I believe what would need to be done is to wrap the <code>lutimes</code> system call instead -- which is different from <code>utimes</code> in that it doesn&#39;t follow symlinks. Maybe there exists a go package that wraps that. A temporary patch would be to shell out to <code>touch -h</code>. Here is one <a href=\"https://grokbase.com/t/gg/golang-nuts/154wnph4y8/go-nuts-no-way-to-utimes-a-symlink\" rel=\"nofollow noreferrer\">debate</a> about how the fix should go."}], "tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": true, "score": 1, "last_activity_date": 1550590280, "creation_date": 1550590280, "answer_id": 54769817, "question_id": 54762079, "link": "https://stackoverflow.com/questions/54762079/how-to-change-timestamp-for-symbol-link-using-golang/54769817#54769817", "title": "How to change timestamp for symbol link using golang?", "body": "<p>Not sure it's possible, at least from the <code>syscall</code> package.</p>\n\n<p>Looking at the source-code for say <a href=\"https://golang.org/src/os/file_posix.go?s=3891:3956#L130\" rel=\"nofollow noreferrer\">syscall.Chtimes</a>:</p>\n\n<pre><code>func Chtimes(name string, atime time.Time, mtime time.Time) error {\n    var utimes [2]syscall.Timespec\n    utimes[0] = syscall.NsecToTimespec(atime.UnixNano())\n    utimes[1] = syscall.NsecToTimespec(mtime.UnixNano())\n    if e := syscall.UtimesNano(fixLongPath(name), utimes[0:]); e != nil {\n        return &amp;PathError{\"chtimes\", name, e}\n    }\n    return nil\n}\n</code></pre>\n\n<p>duplicating this code - and removing the <code>fixLongPath</code> call which I assumed followed the symlinks - still affects the target file, not the source symlink.</p>\n\n<p>Even trying this operation on a symlink which points to a non-existent file, returns a runtime error <code>no such file or directory</code>.</p>\n\n<p>A <code>CGO</code> pkg - could, but that seems overkill.</p>\n"}], "owner": {"reputation": 21, "user_id": 9037373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vWmi-OGkuWM/AAAAAAAAAAI/AAAAAAAAABo/OLG-XsmW2-M/photo.jpg?sz=128", "display_name": "Max Yu", "link": "https://stackoverflow.com/users/9037373/max-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 54769817, "answer_count": 2, "score": 2, "last_activity_date": 1550590280, "creation_date": 1550566055, "last_edit_date": 1550580124, "question_id": 54762079, "link": "https://stackoverflow.com/questions/54762079/how-to-change-timestamp-for-symbol-link-using-golang", "title": "How to change timestamp for symbol link using golang?", "body": "<p><code>os.Chtimes</code> always to follow symlinks and change the real files timestamp.\nIs there a method to change the symlinks timestamp in?</p>\n\n<p>Just like <code>touch -h</code> does.</p>\n"}, {"tags": ["go", "heroku", "mux"], "answers": [{"tags": [], "owner": {"reputation": 1852, "user_id": 208062, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/mgIZ3.jpg?s=128&g=1", "display_name": "Vokinneberg", "link": "https://stackoverflow.com/users/208062/vokinneberg"}, "is_accepted": false, "score": -2, "last_activity_date": 1550569623, "creation_date": 1550569623, "answer_id": 54763182, "question_id": 54761848, "link": "https://stackoverflow.com/questions/54761848/web-process-failed-to-bind-to-port-within-60-seconds-of-launch-golang/54763182#54763182", "title": "Web process failed to bind to $PORT within 60 seconds of launch golang", "body": "<p>This is known issue for node.js apps on Heroku.</p>\n\n<blockquote>\n  <p>In rarer cases, your app may be using process.env.PORT, but may still be failing to bind. This can be caused by the app attempting to bind on localhost. Instead, you may need to change this to 0.0.0.0.</p>\n</blockquote>\n\n<p>Can assume the same might be an issue for go service as well. Check out this article on <a href=\"https://help.heroku.com/P1AVPANS/why-is-my-node-js-app-crashing-with-an-r10-error\" rel=\"nofollow noreferrer\">Heroku support site </a>.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 5952878, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Z4AVPUrN9NY/AAAAAAAAAAI/AAAAAAAAARM/ROD38qf9iKc/photo.jpg?sz=128", "display_name": "Henry Lancy Muschett Oliva", "link": "https://stackoverflow.com/users/5952878/henry-lancy-muschett-oliva"}, "is_accepted": false, "score": 0, "last_activity_date": 1592320253, "creation_date": 1592320253, "answer_id": 62411748, "question_id": 54761848, "link": "https://stackoverflow.com/questions/54761848/web-process-failed-to-bind-to-port-within-60-seconds-of-launch-golang/62411748#62411748", "title": "Web process failed to bind to $PORT within 60 seconds of launch golang", "body": "<p>I solved that using </p>\n\n<p>os.Getenv(\"PORT\")</p>\n"}, {"tags": [], "owner": {"reputation": 647, "user_id": 8454203, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HTEnp.jpg?s=128&g=1", "display_name": "OM Bharatiya", "link": "https://stackoverflow.com/users/8454203/om-bharatiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1595923091, "creation_date": 1595923091, "answer_id": 63129495, "question_id": 54761848, "link": "https://stackoverflow.com/questions/54761848/web-process-failed-to-bind-to-port-within-60-seconds-of-launch-golang/63129495#63129495", "title": "Web process failed to bind to $PORT within 60 seconds of launch golang", "body": "<p>You can use <code>os.Getenv</code> for that.</p>\n<p>Here is the code for main.go after the modification:</p>\n<pre><code>package main\n\nimport (\n    &quot;os&quot;\n    &quot;github.com/mingrammer/go-todo-rest-api-example/app&quot;\n    &quot;github.com/mingrammer/go-todo-rest-api-example/config&quot;\n)\n\nfunc main() {\n    config := config.GetConfig()\n\n    app := &amp;app.App{}\n    app.Initialize(config)\n    port, err := os.Getenv(&quot;PORT&quot;)\n    if err != nil {\n        port = &quot;3000&quot;\n    } \n\n    app.Run(&quot;:&quot;+port)\n}\n</code></pre>\n"}], "owner": {"reputation": 351, "user_id": 4442980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca0fc013b043fafefc8d0db04dba60a6?s=128&d=identicon&r=PG&f=1", "display_name": "freelancer86", "link": "https://stackoverflow.com/users/4442980/freelancer86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1344, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1595923091, "creation_date": 1550565228, "last_edit_date": 1550688801, "question_id": 54761848, "link": "https://stackoverflow.com/questions/54761848/web-process-failed-to-bind-to-port-within-60-seconds-of-launch-golang", "title": "Web process failed to bind to $PORT within 60 seconds of launch golang", "body": "<p>I have developed a rest api using golang.I have pushed the repository to Heroku.I have also hosted a Mysql Server on the internet.The Go rest api connects to the Mysql Server and fetches and inserts data.</p>\n\n<p>The application on heroku was working fine yesterday.However this morning I get this error on \"heroku logs --tail\": Web process failed to bind to $PORT within 60 seconds of launch</p>\n\n<p>Here is the code for main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"github.com/mingrammer/go-todo-rest-api-example/app\"\n    \"github.com/mingrammer/go-todo-rest-api-example/config\"\n)\n\nfunc main() {\n    config := config.GetConfig()\n\n    app := &amp;app.App{}\n    app.Initialize(config)\n    port, ok := os.LookupEnv(\"PORT\")\n\n    if ok == false {\n        port = \"3000\"\n    }\n\n    app.Run(\":\"+port)\n}\n</code></pre>\n"}, {"tags": ["go", "math", "printing"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1550563545, "post_id": 54761166, "comment_id": 96303402, "body": "Don&#39;t ignore the error returned by Scanf."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1550570492, "last_edit_date": 1550570492, "creation_date": 1550563562, "answer_id": 54761389, "question_id": 54761166, "link": "https://stackoverflow.com/questions/54761166/tell-me-whats-wrong-with-this-code-golang/54761389#54761389", "title": "Tell me what&#39;s wrong with this code GOLANG", "body": "<p>Actually the code in question works on unix systems, but usually the problem is that calls like <code>fmt.Scanf(\"%f\", &amp;x1)</code> does not consume newlines, but quoting from package doc of <a href=\"https://golang.org/pkg/fmt/#hdr-Scanning\" rel=\"nofollow noreferrer\"><code>fmt: Scanning</code></a>:</p>\n\n<blockquote>\n  <p>Scan, Fscan, Sscan treat newlines in the input as spaces.</p>\n</blockquote>\n\n<p>And on Windows the newline is not a single <code>\\n</code> character but <code>\\r\\n</code>, so the subsequent <code>fmt.Scanf()</code> call will proceed immediately without waiting for further input from the user.</p>\n\n<p>So you have to add a newline to your format string to avoid subsequent <code>fmt.Scanf()</code> call to proceed:</p>\n\n<pre><code>fmt.Scanf(\"%f\\n\", &amp;x1)\n</code></pre>\n\n<p>But easier would be to just use <a href=\"https://golang.org/pkg/fmt/#Scanln\" rel=\"nofollow noreferrer\"><code>fmt.Scanln()</code></a> and skip the whole format string:</p>\n\n<pre><code>fmt.Scanln(&amp;x1)\n</code></pre>\n\n<blockquote>\n  <p>Scanln, Fscanln and Sscanln stop scanning at a newline and require that the items be followed by a newline or EOF.</p>\n</blockquote>\n\n<p>The scanner functions (<code>fmt.ScanXXX()</code>) return you the number of successfully scanned items and an <code>error</code>. To tell if scanning succeeded, you have to check its return value, e.g.:</p>\n\n<pre><code>if _, err := fmt.Scanln(&amp;x1); err != nil {\n    fmt.Println(\"Scanning failed:\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8812086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33bd73dc7cb40ddce30312de1f375e43?s=128&d=identicon&r=PG&f=1", "display_name": "Adnane Arrassen", "link": "https://stackoverflow.com/users/8812086/adnane-arrassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 54761389, "answer_count": 1, "score": -3, "last_activity_date": 1550683902, "creation_date": 1550562805, "last_edit_date": 1550683902, "question_id": 54761166, "link": "https://stackoverflow.com/questions/54761166/tell-me-whats-wrong-with-this-code-golang", "title": "Tell me what&#39;s wrong with this code GOLANG", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc main() {\n\n    distencecalc()\n}\n\nfunc distencecalc() {\n\n    fmt.Println(\"X1 :\")\n    var x1 float64\n    fmt.Scanf(\"%f\", &amp;x1)\n    fmt.Print(\"\")\n    fmt.Println(\"Y1 :\")\n    var y1 float64\n    fmt.Scanf(\"%f\", &amp;y1)\n    fmt.Print(\"\")\n    fmt.Println(\"Z1 :\")\n    var z1 float64\n    fmt.Scanf(\"%f\", &amp;z1)\n    fmt.Print(\"\")\n    fmt.Println(\"X2 :\")\n    var x2 float64\n    fmt.Scanf(\"%f\", &amp;x2)\n    fmt.Print(\"\")\n    fmt.Println(\"Y2 :\")\n    var y2 float64\n    fmt.Scanf(\"%f\", &amp;y2)\n    fmt.Print(\"\")\n\n    fmt.Println(\"Z2 :\")\n    var z2 float64\n    fmt.Scanf(\"%f\", &amp;z2)\n    fmt.Print(\"\")\n\n    var Xcalc = x2 - x1\n    var Ycalc = y2 - y1\n    var Zcalc = z2 - z1\n\n\n\n    var calcX = math.Pow(Xcalc, 2)\n    var calcY = math.Pow(Ycalc, 2)\n    var calcZ = math.Pow(Zcalc, 2)\n\n\n    var allcalc = calcX + calcZ + calcY\n    fmt.Println(\"the result is :\")\n    fmt.Println(math.Sqrt(allcalc))\n}\n</code></pre>\n\n<p>The problem is I compile then run the program it asks about x1 I enter the value and it asks about y1 and z1 at the same time. </p>\n"}, {"tags": ["go", "kubernetes", "client-go"], "comments": [{"owner": {"reputation": 1748, "user_id": 4106031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NM3jO.jpg?s=128&g=1", "display_name": "Alok Kumar Singh", "link": "https://stackoverflow.com/users/4106031/alok-kumar-singh"}, "edited": false, "score": 2, "creation_date": 1582194817, "post_id": 54760830, "comment_id": 106696848, "body": "How did you fix this?"}, {"owner": {"reputation": 528, "user_id": 8244089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OHsJF.jpg?s=128&g=1", "display_name": "joelazar", "link": "https://stackoverflow.com/users/8244089/joelazar"}, "reply_to_user": {"reputation": 1748, "user_id": 4106031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NM3jO.jpg?s=128&g=1", "display_name": "Alok Kumar Singh", "link": "https://stackoverflow.com/users/4106031/alok-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1613260890, "post_id": 54760830, "comment_id": 117022022, "body": "@AlokKumarSingh, you can find his solution <a href=\"https://github.com/kubernetes/client-go/issues/550\" rel=\"nofollow noreferrer\">here</a>.   I&#39;ve also spent a bit of time reproducing the same issue actually, but I couldn&#39;t. For me the deployment watch was working for over a half hour."}], "owner": {"reputation": 99, "user_id": 9071231, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cw6KW.jpg?s=128&g=1", "display_name": "Aranya", "link": "https://stackoverflow.com/users/9071231/aranya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1576, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1613163324, "creation_date": 1550561372, "last_edit_date": 1551147989, "question_id": 54760830, "link": "https://stackoverflow.com/questions/54760830/unable-to-decode-an-event-from-the-watch-stream-stream-error-stream-id-3-inte", "title": "Unable to decode an event from the watch stream: stream error: stream ID 3; INTERNAL_ERROR", "body": "<p>I want to listen for add events that are deployments within my cluster,I use the client-go Watch Api,It works well at first, but after a short period of time, it will report an error.</p>\n\n<p>I have tried two API ways to listen</p>\n\n<p>the one way:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func startWatchDeployment(clientSet *kubernetes.Clientset){\n    defer func() {\n        err := recover()\n        if err != nil {\n            fmt.Println(err)\n        }\n    }()\n\n    Log.Info(\"\u6b63\u5728\u76d1\u542cdeployment...\")\n    count := 0\n    deploymentsClient := clientSet.AppsV1beta1().Deployments(metav1.NamespaceAll)\n    list,_ := deploymentsClient.List(metav1.ListOptions{})\n    items := list.Items\n    w, _ := deploymentsClient.Watch(metav1.ListOptions{})\n    for {\n        select {\n            case e, _ := &lt;-w.ResultChan():\n                Log.Infof(\"162: %s\",e)\n                if e.Type == watch.Added || e.Type == watch.Deleted{\n                    if count != len(items){\n                        count += 1\n                    }else{\n                        // go\u7684reflect\u83b7\u53d6\u8fd0\u884c\u65f6\u7684struct\n                        nname := e.Object.(*v1beta1.Deployment).Namespace\n                        if r, _ := regexp.Compile(\"^(p|u|user)-\");nname != \"default\" &amp;&amp; nname != \"cattle-system\" &amp;&amp;\n                            nname != \"kube-system\" &amp;&amp; nname != \"dsky-system\" &amp;&amp;\n                            nname != \"kube-public\" &amp;&amp; nname != \"local\" &amp;&amp; nname != \"tools\" &amp;&amp; !r.MatchString(nname) {\n                            data := make(map[string]interface{},1)\n                            data[\"type\"] = e.Type\n                            data[\"name\"] = e.Object.(*v1beta1.Deployment).Name\n                            data[\"namespace\"] = e.Object.(*v1beta1.Deployment).Namespace\n                            watchChannel &lt;- data\n                        }\n                    }\n                }\n        }\n    }\n}\n</code></pre>\n\n<p>the other way:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func startWatchDp(clientSet *kubernetes.Clientset){\n    watchlist := cache.NewListWatchFromClient(\n        clientSet.AppsV1().RESTClient(),\n        \"deployments\",\n        metav1.NamespaceAll,\n        fields.Everything())\n\n    _, controller := cache.NewInformer(\n        watchlist,\n        &amp;v13.Deployment{},\n        time.Millisecond*100,\n        cache.ResourceEventHandlerFuncs{\n            AddFunc: func(obj interface{}) {\n                watchChannel &lt;- 1\n                //fmt.Println(obj)\n            },\n            DeleteFunc: func(obj interface{}) {\n                watchChannel &lt;- 1\n            },\n        },\n    )\n\n    stop := make(chan struct{})\n    go controller.Run(stop)\n\n    for {\n        time.Sleep(10 * time.Second)\n    }\n}\n</code></pre>\n\n<p>Here is my result:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>E0219 15:20:02.274210   19272 streamwatcher.go:109] Unable to decode an event from the watch stream: stream error: stream ID 3; INTERNAL_ERROR\ntime=\"2019-02-19T15:20:02+08:00\" level=info msg=\"162: { &lt;nil&gt;}\"\ntime=\"2019-02-19T15:20:02+08:00\" level=info msg=\"162: { &lt;nil&gt;}\"\ntime=\"2019-02-19T15:20:02+08:00\" level=info msg=\"162: { &lt;nil&gt;}\"\ntime=\"2019-02-19T15:20:02+08:00\" level=info msg=\"162: { &lt;nil&gt;}\"\ntime=\"2019-02-19T15:20:02+08:00\" level=info msg=\"162: { &lt;nil&gt;}\"\n</code></pre>\n\n<p>How can I fix it?Please help!Thanks</p>\n"}, {"tags": ["java", "windows", "go", "java-native-interface", "mingw-w64"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1550562151, "post_id": 54760090, "comment_id": 96302728, "body": "See <a href=\"https://stackoverflow.com/questions/49986729/how-to-call-go-function-from-java\">How to call go function from java?</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1550562227, "post_id": 54760090, "comment_id": 96302761, "body": "Also: <a href=\"https://medium.com/learning-the-go-programming-language/calling-go-functions-from-other-languages-4c7d8bcc69bf\" rel=\"nofollow noreferrer\">Calling Go Functions from Other Languages</a>"}, {"owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1550566764, "post_id": 54760090, "comment_id": 96304878, "body": "Thanks for your input. But this stuff is using JNA which is not my issue. I need a solution for JNI because JNA is for my purpose too slow."}, {"owner": {"reputation": 1908, "user_id": 2543253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a87e0065d4c5036eb7adabe2edfd187?s=128&d=identicon&r=PG", "display_name": "user2543253", "link": "https://stackoverflow.com/users/2543253/user2543253"}, "edited": false, "score": 1, "creation_date": 1550571810, "post_id": 54760090, "comment_id": 96308144, "body": "You can&#39;t call arbitrary libraries with JNI. You either need JNA for that or create a wrapper library. See also my answers here <a href=\"https://stackoverflow.com/questions/52308121/including-the-so-library-to-the-java-project-linux/52311702#52311702\" title=\"including the so library to the java project linux\">stackoverflow.com/questions/52308121/&hellip;</a> or here <a href=\"https://stackoverflow.com/questions/52944462/java-call-function-from-a-dll/52948018#52948018\" title=\"java call function from a dll\">stackoverflow.com/questions/52944462/&hellip;</a>"}, {"owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "edited": false, "score": 0, "creation_date": 1552222116, "post_id": 54760090, "comment_id": 96920537, "body": "Thank you all for the responses. But again: My target is to create a JNI wrapper. So my question still is: What I have to do that my code is valid JNI code in Golang? A attached a project above where it is the task to modify it until it works - with JNI and not JNA. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "is_accepted": true, "score": 0, "last_activity_date": 1553200568, "last_edit_date": 1553200568, "creation_date": 1553158872, "answer_id": 55276830, "question_id": 54760090, "link": "https://stackoverflow.com/questions/54760090/calling-golang-from-java-using-jni-on-windows-leads-to-a-dynamic-link-library/55276830#55276830", "title": "Calling Golang from Java using JNI on Windows leads to &quot;A dynamic link library (DLL) initialization routine failed&quot;", "body": "<p>It seems to be related to a bug inside Golang itself. There is currently a Pull Request opened <a href=\"https://github.com/golang/go/pull/30944\" rel=\"nofollow noreferrer\">runtime: This change modifies Go to fix c-shared dll crash on x64 windows #30944</a> where I can approve that this will fix the issue.</p>\n"}], "owner": {"reputation": 535, "user_id": 1781494, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fw1u3.png?s=128&g=1", "display_name": "GreNodge", "link": "https://stackoverflow.com/users/1781494/grenodge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 55276830, "answer_count": 1, "score": 1, "last_activity_date": 1553200568, "creation_date": 1550557981, "question_id": 54760090, "link": "https://stackoverflow.com/questions/54760090/calling-golang-from-java-using-jni-on-windows-leads-to-a-dynamic-link-library", "title": "Calling Golang from Java using JNI on Windows leads to &quot;A dynamic link library (DLL) initialization routine failed&quot;", "body": "<p>I created the following example project to test out calling Golang code from Java using JNI: <a href=\"https://github.com/blaubaer/golang-jni\" rel=\"nofollow noreferrer\">https://github.com/blaubaer/golang-jni</a></p>\n\n<p>When I call <code>build.cmd</code> I receive an error message like this:</p>\n\n<pre><code>Exception in thread \"main\" java.lang.UnsatisfiedLinkError: [...]\\out\\hello.dll: A dynamic link library (DLL) initialization routine failed\n        at java.base/java.lang.ClassLoader$NativeLibrary.load0(Native Method)\n        at java.base/java.lang.ClassLoader$NativeLibrary.load(ClassLoader.java:2430)\n        at java.base/java.lang.ClassLoader$NativeLibrary.loadLibrary(ClassLoader.java:2487)\n        at java.base/java.lang.ClassLoader.loadLibrary0(ClassLoader.java:2684)\n        at java.base/java.lang.ClassLoader.loadLibrary(ClassLoader.java:2649)\n        at java.base/java.lang.Runtime.loadLibrary0(Runtime.java:829)\n        at java.base/java.lang.System.loadLibrary(System.java:1867)\n        at Hello.&lt;clinit&gt;(Hello.java:3)\n</code></pre>\n\n<p>Used environment:</p>\n\n<ul>\n<li>Windows: 10.0.17763, Build 17763, 64bit</li>\n<li>Golang: 1.11.5, windows/amd64</li>\n<li>Java: 11.0.2 2019-01-15 LTS, 64-Bit</li>\n<li>MinGW-w64: x86_64-8.1.0-win32-sjlj-rt_v6-rev0</li>\n</ul>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2017, "user_id": 2213958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1936f3ddfc25fdb2c9e286823e091dd1?s=128&d=identicon&r=PG", "display_name": "yountae.kang", "link": "https://stackoverflow.com/users/2213958/yountae-kang"}, "edited": false, "score": 0, "creation_date": 1550558219, "post_id": 54760114, "comment_id": 96301073, "body": "Then, sometimes some package could not be installed properly.. Thanks!"}, {"owner": {"reputation": 2017, "user_id": 2213958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1936f3ddfc25fdb2c9e286823e091dd1?s=128&d=identicon&r=PG", "display_name": "yountae.kang", "link": "https://stackoverflow.com/users/2213958/yountae-kang"}, "edited": false, "score": 0, "creation_date": 1550558368, "post_id": 54760114, "comment_id": 96301133, "body": "Could you give me a link of official document that is explained?"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "reply_to_user": {"reputation": 2017, "user_id": 2213958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1936f3ddfc25fdb2c9e286823e091dd1?s=128&d=identicon&r=PG", "display_name": "yountae.kang", "link": "https://stackoverflow.com/users/2213958/yountae-kang"}, "edited": false, "score": 1, "creation_date": 1550558882, "post_id": 54760114, "comment_id": 96301327, "body": "<a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">golang.org/cmd/go/&hellip;</a>  Check this part:  When checking out or updating a package, get looks for a branch or tag that matches the locally installed version of Go. The most important rule is that if the local installation is running version &quot;go1&quot;, get searches for a branch or tag named &quot;go1&quot;. If no such version exists it retrieves the default branch of the package."}], "tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": true, "score": 2, "last_activity_date": 1550558220, "last_edit_date": 1550558220, "creation_date": 1550558109, "answer_id": 54760114, "question_id": 54759951, "link": "https://stackoverflow.com/questions/54759951/how-to-know-which-version-will-be-installed-if-i-use-go-get-for-install/54760114#54760114", "title": "How to know which version will be installed? If I use &quot;go get ./...&quot; for installing dependencies", "body": "<p>If you only want to use go get, then there is no <em>direct</em> way.<br>\ngo get always pulls from the HEAD of the default branch in the repository.<br>\nFor go get, there is no such thing as multiple versions of a Go package.<br>\nSo you have to use dep Or go mod for managing pkg versions.</p>\n\n<p>Also there is <a href=\"http://labix.org/gopkg.in\" rel=\"nofollow noreferrer\">http://labix.org/gopkg.in</a> which is one way of managing versions. It simply redirects you to the actual repo and doesn't host code.</p>\n"}], "owner": {"reputation": 2017, "user_id": 2213958, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1936f3ddfc25fdb2c9e286823e091dd1?s=128&d=identicon&r=PG", "display_name": "yountae.kang", "link": "https://stackoverflow.com/users/2213958/yountae-kang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 1, "accepted_answer_id": 54760114, "answer_count": 1, "score": -1, "last_activity_date": 1559534728, "creation_date": 1550557290, "last_edit_date": 1559534728, "question_id": 54759951, "link": "https://stackoverflow.com/questions/54759951/how-to-know-which-version-will-be-installed-if-i-use-go-get-for-install", "title": "How to know which version will be installed? If I use &quot;go get ./...&quot; for installing dependencies", "body": "<p>How is the \"go get ./...\" command working?</p>\n\n<p>Which version will be installed per package? Is it up to dated?</p>\n\n<p>I know If I use \"go mod\" then I can manage specific version.\nBut I'm just wondering How it be working if I just use \"go get ./...\"</p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550544255, "post_id": 54758108, "comment_id": 96297582, "body": "Do you want to <code>insert</code> in sorted Order? Or are you given a slice of slices to begin with? And do you wnat to sort based on 1st element?"}, {"owner": {"reputation": 1, "user_id": 11081987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903240446bea3b83eb565eae757096b4?s=128&d=identicon&r=PG&f=1", "display_name": "user11081987", "link": "https://stackoverflow.com/users/11081987/user11081987"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550544312, "post_id": 54758108, "comment_id": 96297595, "body": "the second option sir, but the first one is great too, i need to know"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550544373, "post_id": 54758108, "comment_id": 96297609, "body": "And sort on 1st element of each slice?"}, {"owner": {"reputation": 1, "user_id": 11081987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903240446bea3b83eb565eae757096b4?s=128&d=identicon&r=PG&f=1", "display_name": "user11081987", "link": "https://stackoverflow.com/users/11081987/user11081987"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550544544, "post_id": 54758108, "comment_id": 96297638, "body": "@SauravPrakash yes sir, based on first element"}], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": true, "score": 1, "last_activity_date": 1550544791, "last_edit_date": 1550544791, "creation_date": 1550544613, "answer_id": 54758178, "question_id": 54758108, "link": "https://stackoverflow.com/questions/54758108/sorting-slice-of-integer-inside-a-slices/54758178#54758178", "title": "sorting slice of integer inside a slices", "body": "<p>All you need is use Slice from sort package</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\nfunc main() {\n    a := [][]int{[]int{10,3}, []int{5,12}, []int{5, 3}, []int{1,1}}\n    fmt.Printf(\"before: %v\\n\", a)\n    sort.Slice(a, func(i,j int) bool{ return a[i][0] &lt; a[j][0]})\n    fmt.Printf(\"after: %v\\n\", a)\n}\n</code></pre>\n\n<p>For stable sort use, sort.SliceStable instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 11081987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/903240446bea3b83eb565eae757096b4?s=128&d=identicon&r=PG&f=1", "display_name": "user11081987", "link": "https://stackoverflow.com/users/11081987/user11081987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1550586501, "accepted_answer_id": 54758178, "answer_count": 1, "score": -1, "last_activity_date": 1550544791, "creation_date": 1550544031, "last_edit_date": 1550544571, "question_id": 54758108, "link": "https://stackoverflow.com/questions/54758108/sorting-slice-of-integer-inside-a-slices", "closed_reason": "Not suitable for this site", "title": "sorting slice of integer inside a slices", "body": "<p>I'm trying to sort slice of int inside a slice, for example : </p>\n\n<pre><code>slices := make([][]int32, 0)\nslices = append(slices, []int32{10,22})\nslices = append(slices, []int32{13,22})\nslices = append(slices, []int32{12,22})\n// [[10 22] [13 22] [12 22]]\n// to become \n// [[10 22] [12 22] [13 22]] (ascending)\n// *by the first element in slice\n</code></pre>\n\n<p>i had no idea for that, but i was thinking about append and prepend after check</p>\n"}, {"tags": ["mysql", "ubuntu", "unix", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1550541477, "post_id": 54757728, "comment_id": 96297061, "body": "Theres isn\u2019t really much to do in <code>go</code>, use whatever facilities your OS provides to view open files."}, {"owner": {"reputation": 13, "user_id": 7333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e9081c97a0482d7ea03eb4d6c578ff?s=128&d=identicon&r=PG&f=1", "display_name": "jlee", "link": "https://stackoverflow.com/users/7333445/jlee"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550554342, "post_id": 54757728, "comment_id": 96299773, "body": "@JimB I hope it didn&#39;t seem like I was implying that the solution needed to be in Go. I figured it would be something in Ubuntu. Sorry for the ambiguity."}, {"owner": {"reputation": 13, "user_id": 7333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e9081c97a0482d7ea03eb4d6c578ff?s=128&d=identicon&r=PG&f=1", "display_name": "jlee", "link": "https://stackoverflow.com/users/7333445/jlee"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550643592, "post_id": 54757728, "comment_id": 96338831, "body": "Why is this question being downvoted?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1550667183, "post_id": 54757728, "comment_id": 96352025, "body": "I imagine it\u2019s because there\u2019s no programming related question here. How to list open files should should be something easily found with a little research. Simply putting the title of this post into google returns a multitude of resources."}], "answers": [{"tags": [], "owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1550542136, "creation_date": 1550542136, "answer_id": 54757888, "question_id": 54757728, "link": "https://stackoverflow.com/questions/54757728/view-open-file-descriptors/54757888#54757888", "title": "View &quot;open file descriptors&quot;", "body": "<p>You can use the <code>lsof</code> command (Linux) to \"list open files\". There will be a lot of output so it's good to filter the output by using options. <code>lsof -p &lt;PID&gt;</code> might be useful if you know the PID of your process. Use the <code>ps</code> command to find the PID.</p>\n"}], "owner": {"reputation": 13, "user_id": 7333445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05e9081c97a0482d7ea03eb4d6c578ff?s=128&d=identicon&r=PG&f=1", "display_name": "jlee", "link": "https://stackoverflow.com/users/7333445/jlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550542136, "creation_date": 1550540700, "question_id": 54757728, "link": "https://stackoverflow.com/questions/54757728/view-open-file-descriptors", "title": "View &quot;open file descriptors&quot;", "body": "<p>I have a webpage where the backend is written in Go and running on Ubuntu, and after a certain amount of days and activity, like clockwork, the goroutine will throw a 'panic' and start giving 502 proxy errors. The error I'm getting in Go is \"too many open files.\"</p>\n\n<p>After doing some research, I feel that I've narrowed the issue down to having too many \"open file descriptors.\" I have read different proposed solutions which seem to have varying results for different people. That is all fine, but if I wanted to actually <em>view</em> these supposedly open file descriptors in realtime so that I can actually pinpoint what these \"files\" are how would I do that? I ask this because rather than try to guess as to which parts of my Go program are causing this I'd like to see if I can narrow things down even further (possibly to a MySQL socket that's not closing properly, or an OS file also not closing properly, etc.)</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11004748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2144637074437bcb485d5ff02321312?s=128&d=identicon&r=PG&f=1", "display_name": "Kedi Hatterson", "link": "https://stackoverflow.com/users/11004748/kedi-hatterson"}, "edited": false, "score": 0, "creation_date": 1550538469, "post_id": 54757497, "comment_id": 96296430, "body": "thankyou mr nilsocket, actually i&#39;m too lazy to write the code, &lt;3, many thankyou !"}, {"owner": {"reputation": 1, "user_id": 11004748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2144637074437bcb485d5ff02321312?s=128&d=identicon&r=PG&f=1", "display_name": "Kedi Hatterson", "link": "https://stackoverflow.com/users/11004748/kedi-hatterson"}, "edited": false, "score": 0, "creation_date": 1550538788, "post_id": 54757497, "comment_id": 96296475, "body": "cmon guys, at least i be honest"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "reply_to_user": {"reputation": 1, "user_id": 11004748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2144637074437bcb485d5ff02321312?s=128&d=identicon&r=PG&f=1", "display_name": "Kedi Hatterson", "link": "https://stackoverflow.com/users/11004748/kedi-hatterson"}, "edited": false, "score": 3, "creation_date": 1550538863, "post_id": 54757497, "comment_id": 96296491, "body": "It&#39;s not OK, to behave like that in here. One should be concise and specific about what they ask, one should always remember, it&#39;s community members  who are taking out there own time to help others. If someone behaves bad, there would be no community."}, {"owner": {"reputation": 1, "user_id": 11004748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2144637074437bcb485d5ff02321312?s=128&d=identicon&r=PG&f=1", "display_name": "Kedi Hatterson", "link": "https://stackoverflow.com/users/11004748/kedi-hatterson"}, "edited": false, "score": 0, "creation_date": 1550539434, "post_id": 54757497, "comment_id": 96296613, "body": "sorry sir nilsocket, i wouldn&#39;t do that again in my life"}], "tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": true, "score": 1, "last_activity_date": 1550538543, "last_edit_date": 1550538543, "creation_date": 1550538300, "answer_id": 54757497, "question_id": 54757465, "link": "https://stackoverflow.com/questions/54757465/how-to-convert-keys-values-map-to-slice-of-int/54757497#54757497", "title": "how to convert keys values map to slice of int", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    //create a map\n    m := map[int64]int64{512: 8, 513: 9, 234: 9, 392: 0}\n\n    //create a slice to hold required values\n    s := make([][]int64, 0)\n\n    //range over map `m` to append to slice `s`\n    for k, v := range m {\n\n        // append each element, with a new slice []int64{k, v}\n        s = append(s, []int64{k, v})\n    }\n\n    fmt.Println(s)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11004748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2144637074437bcb485d5ff02321312?s=128&d=identicon&r=PG&f=1", "display_name": "Kedi Hatterson", "link": "https://stackoverflow.com/users/11004748/kedi-hatterson"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "closed_date": 1550573561, "accepted_answer_id": 54757497, "answer_count": 1, "score": -7, "last_activity_date": 1550538543, "creation_date": 1550537938, "question_id": 54757465, "link": "https://stackoverflow.com/questions/54757465/how-to-convert-keys-values-map-to-slice-of-int", "closed_reason": "Not suitable for this site", "title": "how to convert keys values map to slice of int", "body": "<p>i'm trying to convert key-value map to slice of 2 value, for example :</p>\n\n<pre><code>slices := make(map[int64]int64)\nslices[int64(521)] = int64(4)\nslices[int64(528)] = int64(8)\n// how do i convert that to become\n// [[521, 4], [528, 8]]\n</code></pre>\n\n<p>i'm thinking about each all those key-value then create slice for that, but is there any simple code to do that ?</p>\n"}, {"tags": ["macos", "go", "vips"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 2, "creation_date": 1550548177, "post_id": 54755571, "comment_id": 96298372, "body": "<a href=\"https://github.com/golang/go/wiki/InvalidFlag\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/InvalidFlag</a>"}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 7987873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01c571008d916ec192ed3881c37d6c4?s=128&d=identicon&r=PG&f=1", "display_name": "cashews", "link": "https://stackoverflow.com/users/7987873/cashews"}, "edited": false, "score": 0, "creation_date": 1550690738, "post_id": 54792682, "comment_id": 96365670, "body": "Great, thank you for the explanation! I&#39;ve got it working."}], "tags": [], "owner": {"reputation": 3562, "user_id": 3427434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/38bbe01b0256d1edac89ea38481cf8d9?s=128&d=identicon&r=PG", "display_name": "Edward Samuel", "link": "https://stackoverflow.com/users/3427434/edward-samuel"}, "is_accepted": true, "score": 6, "last_activity_date": 1550685955, "creation_date": 1550685955, "answer_id": 54792682, "question_id": 54755571, "link": "https://stackoverflow.com/questions/54755571/issues-building-vips-library-from-go/54792682#54792682", "title": "Issues building vips library from go", "body": "<p><code>CFLAGS</code> is extra flags to give to the C compiler. (commonly used in <em>make</em>, see: <a href=\"https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html\" rel=\"noreferrer\">https://www.gnu.org/software/make/manual/html_node/Implicit-Variables.html</a>)</p>\n\n<p>The <a href=\"https://github.com/h2non/bimg/blob/v1.0.19/vips.go#L4\" rel=\"noreferrer\">gopkg.in/h2non/bimg.v1/vips.go</a> uses <code>pkg-config</code> to generate the extra flags. It has <a href=\"http://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html\" rel=\"noreferrer\"><code>-Xpreprocessor</code></a> flag, which is not allowed by CGo (by default at the time of writing this).</p>\n\n<blockquote>\n  <p>For security reasons, only a limited set of flags are allowed, notably <code>-D</code>, <code>-I</code>, and <code>-l</code>. To allow additional flags, set <code>CGO_CFLAGS_ALLOW</code> to a regular expression matching the new flags. To disallow flags that would otherwise be allowed, set <code>CGO_CFLAGS_DISALLOW</code> to a regular expression matching arguments that must be disallowed. In both cases the regular expression must match a full argument: to allow <code>-mfoo=bar</code>, use <code>CGO_CFLAGS_ALLOW='-mfoo.*'</code>, not just <code>CGO_CFLAGS_ALLOW='-mfoo'</code>. (See: <a href=\"https://golang.org/cmd/cgo/\" rel=\"noreferrer\">https://golang.org/cmd/cgo/</a>)</p>\n</blockquote>\n\n<p>To allow <code>-Xpreprocessor</code>, you can set <code>CGO_CFLAGS_ALLOW=-Xpreprocessor</code>.\nFor example:</p>\n\n<pre><code>CGO_CFLAGS_ALLOW=-Xpreprocessor go vet ./...\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 7987873, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01c571008d916ec192ed3881c37d6c4?s=128&d=identicon&r=PG&f=1", "display_name": "cashews", "link": "https://stackoverflow.com/users/7987873/cashews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1182, "favorite_count": 1, "accepted_answer_id": 54792682, "answer_count": 1, "score": 2, "last_activity_date": 1550685955, "creation_date": 1550524971, "last_edit_date": 1550525349, "question_id": 54755571, "link": "https://stackoverflow.com/questions/54755571/issues-building-vips-library-from-go", "title": "Issues building vips library from go", "body": "<p>I am trying to run/build a GoLang package that uses vips. When I try to compile the program I get this error:\n<code>go build gopkg.in/h2non/bimg.v1: invalid flag in pkg-config --cflags: -Xpreprocessor</code></p>\n\n<p>Here are my specs:</p>\n\n<pre><code>macOS Mojave Version 10.14.3\nvips Version 8.7.4\ngo Version 1.11.5 darwin/amd64\n</code></pre>\n\n<p>I read some issues adding CGOALLOWEDFLAGS I've tried that also but no luck.</p>\n"}, {"tags": ["go", "ffmpeg", "command", "exec"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1550524820, "post_id": 54755386, "comment_id": 96292591, "body": "If the command is failing with no output, that&#39;s an issue with the program you&#39;re executing, it has nothing to do with the code that&#39;s executing it. What happens when you run that same command from a terminal?"}, {"owner": {"reputation": 15, "user_id": 5080937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IfEPm.png?s=128&g=1", "display_name": "n3wton", "link": "https://stackoverflow.com/users/5080937/n3wton"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1550533305, "post_id": 54755386, "comment_id": 96295363, "body": "@Adrian it works fine in the terminal, gives me the length of the video"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1550533965, "post_id": 54755386, "comment_id": 96295508, "body": "The quotes around <code>p=0</code> seem suspicious. A shell would parse and eliminate them before executing ffprobe, but Go doesn&#39;t. What happens if you remove them?"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1550538736, "post_id": 54755386, "comment_id": 96296470, "body": "This may be helpful, <a href=\"https://stackoverflow.com/questions/52770746/executing-bash-echo-and-nc-together-in-golang\" title=\"executing bash echo and nc together in golang\">stackoverflow.com/questions/52770746/&hellip;</a>"}, {"owner": {"reputation": 15, "user_id": 5080937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IfEPm.png?s=128&g=1", "display_name": "n3wton", "link": "https://stackoverflow.com/users/5080937/n3wton"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1550595055, "post_id": 54755386, "comment_id": 96322495, "body": "@Peter You were correct, the quotes were the issue. After removing them it worked fine."}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 2, "last_activity_date": 1550567645, "creation_date": 1550567645, "answer_id": 54762534, "question_id": 54755386, "link": "https://stackoverflow.com/questions/54755386/exec-command-error-no-output-to-stdout-or-stderr/54762534#54762534", "title": "exec.Command error, no output to stdout or stderr", "body": "<p>The reason you aren't getting any clues is that you have set the command to not say anything.  From the <a href=\"https://ffmpeg.org/ffprobe.html\" rel=\"nofollow noreferrer\">ffprobe docs</a></p>\n\n<blockquote>\n  <p>-loglevel [flags+]loglevel | -v [flags+]loglevel Set logging level and flags used by the library.\n  .... </p>\n  \n  <p>loglevel is a string or a number containing one of the following\n  values:</p>\n  \n  <p>\u2018quiet, -8\u2019 Show nothing at all; be silent.</p>\n</blockquote>\n"}], "owner": {"reputation": 15, "user_id": 5080937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IfEPm.png?s=128&g=1", "display_name": "n3wton", "link": "https://stackoverflow.com/users/5080937/n3wton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 54762534, "answer_count": 1, "score": -1, "last_activity_date": 1550567645, "creation_date": 1550524149, "question_id": 54755386, "link": "https://stackoverflow.com/questions/54755386/exec-command-error-no-output-to-stdout-or-stderr", "title": "exec.Command error, no output to stdout or stderr", "body": "<p>I am trying to get the duration of a video using ffprobe and exec.Command but I keep getting an error. However, stdout and stderr are both empty so I don't know what the problem is. </p>\n\n<pre><code>func getVideoLength(filename string) float64 {\ncmd := exec.Command(\"ffprobe\", \"-i\", filename, \"-show_entries\", \"format=duration\", \"-v\", \"quiet\", \"-of\", \"csv=\\\"p=0\\\"\")\nfmt.Println(\"ffprobe\", \"-i\", filename, \"-show_entries\", \"format=duration\", \"-v\", \"quiet\", \"-of\", \"csv=\\\"p=0\\\"\")\n    var out bytes.Buffer\n    var stderr bytes.Buffer\n    cmd.Stdout = &amp;out\n    cmd.Stderr = &amp;stderr\n    err := cmd.Run()\n    if err != nil {\n        fmt.Println(\"out: \" + out.String())\n        fmt.Println(\"stderr: \" + stderr.String())\n        log.Fatal(err)\n    }\n\n    length, err := strconv.ParseFloat(out.String(), 64)\n    if err != nil {\n        log.Fatal(err)\n    }\n\nreturn length\n}\n</code></pre>\n\n<p>Here is the output I get:</p>\n\n<pre><code>ffprobe -i amelie.mp4 -show_entries format=duration -v quiet -of csv=\"p=0\"\nout: \nstderr: \n2019/02/18 21:04:39 exit status 1\n</code></pre>\n\n<p>not very helpful.</p>\n\n<p>Any ideas?. Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 423, "user_id": 8206705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be032ba68741f45a5abf1c2c9df8b53?s=128&d=identicon&r=PG&f=1", "display_name": "H. Ross", "link": "https://stackoverflow.com/users/8206705/h-ross"}, "edited": false, "score": 2, "creation_date": 1550524862, "post_id": 54754952, "comment_id": 96292607, "body": "I would suggest taking a look at <a href=\"https://github.com/gin-gonic/gin/issues/205\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin/issues/205</a>.  Gin-gonic has had this problem for a while, and there appears to be workarounds."}, {"owner": {"reputation": 423, "user_id": 8206705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be032ba68741f45a5abf1c2c9df8b53?s=128&d=identicon&r=PG&f=1", "display_name": "H. Ross", "link": "https://stackoverflow.com/users/8206705/h-ross"}, "edited": false, "score": 0, "creation_date": 1550525532, "post_id": 54754952, "comment_id": 96292864, "body": "Also, take a look at the answers for this question: <a href=\"https://stackoverflow.com/questions/52845807/gin-wildcard-route-conflicts-with-existing-children?rq=1\" title=\"gin wildcard route conflicts with existing children\">stackoverflow.com/questions/52845807/&hellip;</a>"}, {"owner": {"reputation": 51, "user_id": 11058097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800217bc35ed593f336a6f82f1717e31?s=128&d=identicon&r=PG&f=1", "display_name": "kodiu", "link": "https://stackoverflow.com/users/11058097/kodiu"}, "reply_to_user": {"reputation": 423, "user_id": 8206705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1be032ba68741f45a5abf1c2c9df8b53?s=128&d=identicon&r=PG&f=1", "display_name": "H. Ross", "link": "https://stackoverflow.com/users/8206705/h-ross"}, "edited": false, "score": 0, "creation_date": 1550531897, "post_id": 54754952, "comment_id": 96295018, "body": "@H.Ross i want elegant solution ..."}], "owner": {"reputation": 51, "user_id": 11058097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/800217bc35ed593f336a6f82f1717e31?s=128&d=identicon&r=PG&f=1", "display_name": "kodiu", "link": "https://stackoverflow.com/users/11058097/kodiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2215, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1550522020, "creation_date": 1550522020, "question_id": 54754952, "link": "https://stackoverflow.com/questions/54754952/path-segment-conflicts-with-existing-wildcard-in-path", "title": "path segment conflicts with existing wildcard in path", "body": "<p>I want to rewrite flask application in golang-gin, and i have a path problem in routes, :status have only 3 version <code>start</code> <code>pause</code> <code>end</code> , this is my current routes :</p>\n\n<pre><code>    contracts.POST(\"/:id/:status\", s.contractChangeStatus)\n    contracts.POST(\"/:id/events/:type\", AccessRole(models.Work), s.eventCreate)\n</code></pre>\n\n<p>problem is when i execute app, return this error :</p>\n\n<pre><code>panic: path segment 'events/:type' conflicts with existing wildcard ':status' in path '/contracts/:id/events/:type'\n</code></pre>\n\n<p>what is the best practice for solve this situation ? in flask exist a simple path /any(start|pause|stop), how i can solve this in golang-gin ? without change api structure !</p>\n"}, {"tags": ["c++", "go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1550524196, "post_id": 54753692, "comment_id": 96292362, "body": "erm... Yes, it depends... vague questions can only ever yield vague answers"}, {"owner": {"reputation": 354, "user_id": 5262104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64aa1e35a57e8869a5eb58466526530?s=128&d=identicon&r=PG&f=1", "display_name": "pkm", "link": "https://stackoverflow.com/users/5262104/pkm"}, "edited": false, "score": 1, "creation_date": 1550524367, "post_id": 54753692, "comment_id": 96292428, "body": "yes but you should also vendor your dependencies, to ensure the generated code is compatible with the version of grpc your project uses (i.e. pin a version of grpc in your Gopkg.toml)"}], "owner": {"user_type": "does_not_exist", "display_name": "user2813148"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1550526311, "creation_date": 1550516220, "last_edit_date": 1550526311, "question_id": 54753692, "link": "https://stackoverflow.com/questions/54753692/grpc-golang-c-generate-once-compile-for-everywhere", "title": "grpc golang/c++ generate once compile for everywhere", "body": "<p>Is it an ok approach to generate grpc code from a .proto for a system language like c++ or go, and maintain it as a part of source code assuming it's platform agnostic?</p>\n\n<p><strong>Edit</strong>\nTo be more precise, for a given version of the framework does the code generation process yield the same code for every supported platform (as the host)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 478, "user_id": 3491376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh2OC.png?s=128&g=1", "display_name": "Deadooshka", "link": "https://stackoverflow.com/users/3491376/deadooshka"}, "edited": false, "score": 1, "creation_date": 1550510609, "post_id": 54752167, "comment_id": 96286945, "body": "<a href=\"https://golang.org/pkg/database/sql/#Row.Scan\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#Row.Scan</a> . it&#39;s all about <code>interface{}</code> <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Interface_types</a>"}, {"owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "reply_to_user": {"reputation": 478, "user_id": 3491376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh2OC.png?s=128&g=1", "display_name": "Deadooshka", "link": "https://stackoverflow.com/users/3491376/deadooshka"}, "edited": false, "score": 0, "creation_date": 1550512212, "post_id": 54752167, "comment_id": 96287572, "body": "Should I then maybe change my exists string to a NullString? @Deadooshka"}, {"owner": {"reputation": 478, "user_id": 3491376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh2OC.png?s=128&g=1", "display_name": "Deadooshka", "link": "https://stackoverflow.com/users/3491376/deadooshka"}, "edited": false, "score": 1, "creation_date": 1550513273, "post_id": 54752167, "comment_id": 96288017, "body": "<a href=\"https://golang.org/pkg/database/sql/#Rows.Scan\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#Rows.Scan</a> use a pointer type <code>*string</code>. all conversions found in <a href=\"https://github.com/golang/go/blob/a10b4cff91cb5d26e2049f6efc20349aa4d50d20/src/database/sql/convert.go#L217\" rel=\"nofollow noreferrer\"><code>convertAssignRows</code></a> function"}, {"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "edited": false, "score": 2, "creation_date": 1550513876, "post_id": 54752167, "comment_id": 96288243, "body": "What do you mean by &quot;works&quot;? Does <code>exists</code> get populated with data? Also, by &quot;does not work&quot;? What is the error?"}], "answers": [{"comments": [{"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "edited": false, "score": 0, "creation_date": 1550514615, "post_id": 54753257, "comment_id": 96288565, "body": "I think the question is about how is it possible that <code>.Scan(exists)</code> (as opposed to <code>.Scan(&amp;exists)</code>) &quot;works&quot;"}, {"owner": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "reply_to_user": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 0, "creation_date": 1550515920, "post_id": 54753257, "comment_id": 96289111, "body": "But @Jay266, it might work in the sense that there is no error, but it won&#39;t put the result into <code>exists</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 0, "creation_date": 1550516226, "post_id": 54753257, "comment_id": 96289241, "body": "@Jay266 I was trying to answer your last question <i>(&quot;Why isn&#39;t the string <code>exists</code> and <code>.Scan(&amp;exists)</code> not working?&quot;)</i>, and if the double negative in that question was a typo then I think this is a legitimate answer."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 14274, "user_id": 579078, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/xC5kj.png?s=128&g=1", "display_name": "\u11bc\u11ba\u11bc", "link": "https://stackoverflow.com/users/579078/%e1%86%bc%e1%86%ba%e1%86%bc"}, "edited": false, "score": 1, "creation_date": 1550516257, "post_id": 54753257, "comment_id": 96289258, "body": "@\u0131\u0131\u0131 I&#39;m having a hard time believing that it &quot;works&quot; in the sense that it doesn&#39;t return any error."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "edited": false, "score": 1, "creation_date": 1550516892, "post_id": 54753257, "comment_id": 96289480, "body": "@Jay266 passing a non-pointer string to <code>Scan</code> returns an error <code>sql: Scan error on column index 0, name &quot;email&quot;: destination not a pointer</code> on my machine when using Go&#39;s <code>database&#47;sql</code> and <code>lib&#47;pq</code> as the db driver. If, on your setup, you do not get an error then please provide the Go version you&#39;re using along with what libraries you&#39;re using to connect and query the database."}, {"owner": {"reputation": 478, "user_id": 3491376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lh2OC.png?s=128&g=1", "display_name": "Deadooshka", "link": "https://stackoverflow.com/users/3491376/deadooshka"}, "edited": false, "score": 0, "creation_date": 1550517266, "post_id": 54753257, "comment_id": 96289608, "body": "it&#39;s there <a href=\"https://github.com/golang/go/blob/a10b4cff91cb5d26e2049f6efc20349aa4d50d20/src/database/sql/convert.go#L383\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/&hellip;</a>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1550514237, "creation_date": 1550514237, "answer_id": 54753257, "question_id": 54752167, "link": "https://stackoverflow.com/questions/54752167/scan-function-by-reference-or-by-value/54753257#54753257", "title": "Scan function by reference or by value", "body": "<p>You should have <code>exists</code> be the same type as, or a compatible type to, the type of the value you are retrieving from the database.</p>\n\n<p>Since you're selecting the <code>id</code> column, I will assume that it is an <code>integer</code>, and therefore you should declare exists as follows <code>var exists int</code>. If, however, you want to find out whether a row is present in the table or not you would generally use a query of the form:</p>\n\n<pre><code>SELECT EXISTS(SELECT 1 FROM source WHERE mgmt= $1)\n</code></pre>\n\n<p>(at least in postgres, I'm not sure what db you're using)</p>\n\n<p><a href=\"https://www.postgresql.org/docs/11/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS\" rel=\"nofollow noreferrer\"><code>EXISTS</code></a>:</p>\n\n<blockquote>\n  <p>The argument of EXISTS is an arbitrary SELECT statement, or subquery.\n  The subquery is evaluated to determine whether it returns any rows. If\n  it returns at least one row, the result of EXISTS is \u201ctrue\u201d; if the\n  subquery returns no rows, the result of EXISTS is \u201cfalse\u201d.</p>\n</blockquote>\n\n<p>Then your Go code would something like this:</p>\n\n<pre><code>query := `SELECT EXISTS(SELECT 1 FROM source WHERE mgmt = $1)`\n\nvar exists bool\nif err := dr.db.QueryRow(query, mgmt).Scan(&amp;exists); err != nil {\n    return err\n}\n\nif exists {\n    // already taken\n} else {\n    // unique\n}\n</code></pre>\n\n<p>Also note that since <code>EXISTS</code> always returns a boolean value you don't have to check the error against <code>sql.ErrNoRows</code>, if you do get an error it would not be that one.</p>\n"}], "owner": {"reputation": 895, "user_id": 5117502, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/3af1c137fcafdd6975f358e1fb43ca4c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay266", "link": "https://stackoverflow.com/users/5117502/jay266"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 54753257, "answer_count": 1, "score": 0, "last_activity_date": 1550514237, "creation_date": 1550509560, "last_edit_date": 1550512205, "question_id": 54752167, "link": "https://stackoverflow.com/questions/54752167/scan-function-by-reference-or-by-value", "title": "Scan function by reference or by value", "body": "<p>I have the following code:</p>\n\n<pre><code>statement := `SELECT id from source where mgmt = $1 `\nvar exists string\nerrUnique := dr.db.QueryRow(statement, mgmt).Scan(exists)\nif errUnique != nil &amp;&amp; errUnique != sql.ErrNoRows {\n    return errUnique\n}\n</code></pre>\n\n<p>The above code works for me. However, shouldn't my  <code>.Scan(&amp;exists)</code> have a by reference? This does not work. On the other hand, when I change exists to a bool as seen here <code>var exists bool</code> the <code>.Scan(&amp;exists)</code> suddenly works. Why isn't the string <code>exists</code> and <code>.Scan(&amp;exists)</code> not working?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1550510379, "post_id": 54751615, "comment_id": 96286842, "body": "Just a reminder: Adding <code>json:&quot;foo,omitempty&quot;</code> on an empty string will not remove the field outright, and empty string still is a value. You&#39;d need to use pointers, and set them to nil"}], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1550508738, "post_id": 54751648, "comment_id": 96286013, "body": "If you need a specific type to marshal/unmarshal in a specific way, then I agree: use custom marshallers. However, I get the impression the OP wants the types to be marshalled differently depending on <i>where</i> they&#39;re used, so you need a custom marshaller at the <code>Table</code> level, which does complicate things more in my experience."}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": false, "score": 3, "last_activity_date": 1550508209, "last_edit_date": 1550508209, "creation_date": 1550507675, "answer_id": 54751648, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json/54751648#54751648", "title": "Hide properties from a JSON", "body": "<p>You could create a custom <code>Marshaler</code> for <code>Table</code> types. This is the interface you have to implement:</p>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\">https://golang.org/pkg/encoding/json/#Marshaler</a></p>\n\n<pre><code>type Marshaler interface {\n        MarshalJSON() ([]byte, error)\n}\n</code></pre>\n\n<p>Then you'd remove the <code>-</code> tag from <code>Player</code> (because when you marshal it elsewhere you need to preserve the fields) and only ignore it in the custom <code>MarshalJSON</code> method of <code>Table</code>.</p>\n\n<hr>\n\n<p>Here's a simple (unrelated) example of implementing custom marshaling for a type, encoding one of the fields in hex:</p>\n\n<pre><code>type Account struct {\n    Id   int32\n    Name string\n}\n\nfunc (a Account) MarshalJSON() ([]byte, error) {\n    m := map[string]string{\n        \"id\":   fmt.Sprintf(\"0x%08x\", a.Id),\n        \"name\": a.Name,\n    }\n    return json.Marshal(m)\n}\n\nfunc main() {\n    joe := Account{Id: 123, Name: \"Joe\"}\n    fmt.Println(joe)\n\n    s, _ := json.Marshal(joe)\n    fmt.Println(string(s))\n}\n</code></pre>\n\n<p>As you can see here, such marshaling is easy to do by constructing a <code>map</code> with just the fields you need and passing it to <code>json.Marshal</code>. For your <code>Table</code> and <code>Player</code> this will result in just a few lines of trivial code. IMHO it's better to do this than to modify the types and complicate them with embeddings/aliases, just for the sake of JSON encoding.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 9415063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5700d38f7e3e4bf381a25aa4f62ec?s=128&d=identicon&r=PG&f=1", "display_name": "gnutella", "link": "https://stackoverflow.com/users/9415063/gnutella"}, "edited": false, "score": 0, "creation_date": 1550508359, "post_id": 54751739, "comment_id": 96285826, "body": "but then i would need a function to get every property from Player, so if it has 20 properties i would need 20 functiones like func (pp PartialPlayer) GetXXXXX() string {}  right?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 95, "user_id": 9415063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5700d38f7e3e4bf381a25aa4f62ec?s=128&d=identicon&r=PG&f=1", "display_name": "gnutella", "link": "https://stackoverflow.com/users/9415063/gnutella"}, "edited": false, "score": 0, "creation_date": 1550508439, "post_id": 54751739, "comment_id": 96285868, "body": "You don&#39;t need those functions, they&#39;re for convenience. You can access embedded fields directly, unless they&#39;re &quot;overridden&quot;, in which case you either use <code>v.Player.Email</code>, but the getter abstracts that away. It&#39;s completely optional however. I&#39;ve updated my answer to clear that up a bit"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 95, "user_id": 9415063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5700d38f7e3e4bf381a25aa4f62ec?s=128&d=identicon&r=PG&f=1", "display_name": "gnutella", "link": "https://stackoverflow.com/users/9415063/gnutella"}, "edited": false, "score": 0, "creation_date": 1550510784, "post_id": 54751739, "comment_id": 96287031, "body": "@gnutella: Also updated the answer to use a custom marshaller, still using embedded types, but with a brief explanation why I maintain embedding is the best approach here, as opposed to manually creating a <code>map[string]interface{}</code>"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": false, "score": 0, "last_activity_date": 1550510732, "last_edit_date": 1550510732, "creation_date": 1550507992, "answer_id": 54751739, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json/54751739#54751739", "title": "Hide properties from a JSON", "body": "<p>There's a couple of ways you can achieve this. The first would be to create a custom marshaller for the <code>Table</code> type. This is, however somewhat tedious, and can be quite restrictive. There is, IMHO, an easier way to do the same thing: embed types:</p>\n\n<pre><code>type PartialPlayer struct {\n     Player // embed the entire type\n     Email string `json:\"-\"` // override fields and add the tag to exclude them\n     Birthdate string `json:\"-\"`\n}\n</code></pre>\n\n<p>Now you can still access all data you want, and you could even add getters for indirect data access:</p>\n\n<pre><code>func (pp PartialPlayer) GetEmail() string {\n    if pp.Email == \"\" {\n        return pp.Player.Email // get embedded Email value\n    }\n    return pp.Email // add override value\n}\n</code></pre>\n\n<p>Note that you don't <em>need</em> to use these getter functions. The <code>Id</code> field is not overridden, so if I have a <code>PartialPlayer</code> variable, I can access the value directly:</p>\n\n<pre><code>pp := PartialPlayer{\n    Player: playerVar,\n}\nfmt.Printf(\"Player ID: %v\\n\", pp.Id) // still works\n</code></pre>\n\n<p>You can access overridden/masked fields by specifying you want the value held on the embedded type, without a function, too:</p>\n\n<pre><code>fmt.Printf(\"Email on partial: '%s', but I can see '%s'\\n\", pp.Email, pp.Player.Email)\n</code></pre>\n\n<p>The latter will print <code>Email on partial: '', but I can see 'foo@bar.com'</code>.</p>\n\n<p>Use this type in <code>Table</code> like this:</p>\n\n<pre><code>type Table struct {\n    Id           int            `json:\"id\"`\n    PlayerTop    PartialPlayer  `json:\"playerTop\"`\n    PlayerBottom PartialPlayer  `json:\"playerBottom\"`\n}\n</code></pre>\n\n<p>Initialise:</p>\n\n<pre><code>tbl := Table{\n    Id: 213,\n    PlayerTop: PartialPlayer{\n        Player: playerVar,\n    },\n    PlayerBottom: PartialPlayer{\n        Player: player2Var,\n    },\n}\n</code></pre>\n\n<p>That works just fine. The benefit of this approach is that marshalling to and from JSON doesn't require a call to your custom marshaller functions, and creating/mapping intermediary types like maps or hidden types etc...</p>\n\n<p>Should you want to hade another field, just add it to the  <code>PartialPlayer</code> type. Should you want to unhide a field like <code>Email</code>, just remove it from the <code>PartialPlayer</code> type, job done.</p>\n\n<hr>\n\n<p>Now for an approach with a custom marshaller:</p>\n\n<pre><code>type Table struct {\n    Id           int    `json:\"id\"`\n    PlayerTop    Player `json:\"playerTop\"`\n    PlayerBottom Player `json:\"playerBottom\"`\n}\n\ntype marshalTable {\n    Table\n    // assuming the PartialPlayer type above\n    PlayerTop    PartialPlayer `json:\"playerTop\"`\n    PlayerBottom PartialPlayer `json:\"playerBottom\"`\n}\n\nfunc (t Table) MarshalJSON() ([]byte, error) {\n    mt := marshalTable{\n        Table:        t,\n        PlayerTop:    PartialPlayer{\n            Player: t.PlayerTop,\n        },\n        PlayerBottom: PartialPlayer{\n            Player: t.PlayerBottom,\n        },\n    }\n    return json.Marshal(mt)\n}\n</code></pre>\n\n<p>It's not too different from building a type <code>map[string]interface{}</code> here, but by using type embedding, you don't have to update the marshaller function every time a field is renamed or changed on the <code>Player</code> type.</p>\n\n<p>Using this approach, your <code>Table</code> type can be used in the exact same way as you're doing right now, but the JSON output will not include the <code>Email</code> and <code>Birthdate</code> fields.</p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1550512930, "creation_date": 1550512930, "answer_id": 54752976, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json/54752976#54752976", "title": "Hide properties from a JSON", "body": "<p>Types that only differ in their field tags are <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">convertible</a> to one another <a href=\"https://golang.org/doc/go1.8#language\" rel=\"nofollow noreferrer\">since Go 1.8</a>. So you can define one or more \"view\" types for players and pick one that fits your use case when marshaling.</p>\n\n<p>The advantage over embedding or implementing <a href=\"https://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow noreferrer\">json.Marshaler</a> is that every time you add a new field to <code>Player</code> the compiler forces you to update every view type as well, i.e. you have to make a conscious decision whether or not to include the new field in each view.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"time\"\n)\n\ntype Player struct {\n    Id        int64     `json:\"id\"`\n    Username  string    `json:\"username,omitempty\"`\n    Password  string    `json:\"-,omitempty\"`\n    Email     string    `json:\"email,omitempty\"`\n    Birthdate time.Time `json:\"birthdate,omitempty\"`\n    Avatar    string    `json:\"avatar,omitempty\"`\n}\n\n// PlayerSummary has the same underlying type as Player, but omits some fields \n// in the JSON representation.\ntype PlayerSummary struct {\n    Id        int64     `json:\"id\"`\n    Username  string    `json:\"username,omitempty\"`\n    Password  string    `json:\"-\"`\n    Email     string    `json:\"-\"`\n    Birthdate time.Time `json:\"-\"`\n    Avatar    string    `json:\"avatar,omitempty\"`\n}\n\ntype Table struct {\n    Id           int           `json:\"id\"`\n    PlayerTop    PlayerSummary `json:\"playerTop\"`\n    PlayerBottom PlayerSummary `json:\"playerBottom\"`\n}\n\nfunc main() {\n    p1 := Player{\n        Id:        1,\n        Username:  \"Alice\",\n        Email:     \"alice@example.com\",\n        Birthdate: time.Date(2000, 1, 1, 0, 0, 0, 0, time.UTC),\n        Avatar:    \"https://www.gravatar.com/avatar/c160f8cc69a4f0bf2b0362752353d060\",\n    }\n    p2 := Player{\n        Id:        2,\n        Username:  \"Bob\",\n        Email:     \"bob@example.com\",\n        Birthdate: time.Date(1998, 6, 1, 0, 0, 0, 0, time.UTC),\n        Avatar:    \"https://www.gravatar.com/avatar/4b9bb80620f03eb3719e0a061c14283d\",\n    }\n\n    b, _ := json.MarshalIndent(Table{\n        Id:           0,\n        PlayerTop:    PlayerSummary(p1), // marshal p1 as PlayerSummary\n        PlayerBottom: PlayerSummary(p2), // marshal p2 as PlayerSummary\n    }, \"\", \"  \")\n\n    fmt.Println(string(b))\n}\n\n// Output:\n// {\n//   \"id\": 0,\n//   \"playerTop\": {\n//     \"id\": 1,\n//     \"username\": \"Alice\",\n//     \"avatar\": \"https://www.gravatar.com/avatar/c160f8cc69a4f0bf2b0362752353d060\"\n//   },\n//   \"playerBottom\": {\n//     \"id\": 2,\n//     \"username\": \"Bob\",\n//     \"avatar\": \"https://www.gravatar.com/avatar/4b9bb80620f03eb3719e0a061c14283d\"\n//   }\n// }\n</code></pre>\n\n<p>Try it on the Playground: <a href=\"https://play.golang.org/p/a9V2uvOJX3Y\" rel=\"nofollow noreferrer\">https://play.golang.org/p/a9V2uvOJX3Y</a></p>\n\n<hr>\n\n<p>Aside: Consider removing the Password field from Player. The password (hash) is typically only used by very few functions. Functions that do need it can accept the player and password as separate arguments. That way you eliminate the risk of accidentally leaking the password (in log messages, for instance).</p>\n"}, {"tags": [], "owner": {"reputation": 590, "user_id": 2138077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c66151968df6f11221913881daec2c46?s=128&d=identicon&r=PG", "display_name": "swift taylor", "link": "https://stackoverflow.com/users/2138077/swift-taylor"}, "is_accepted": true, "score": 1, "last_activity_date": 1550522390, "creation_date": 1550522390, "answer_id": 54755031, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json/54755031#54755031", "title": "Hide properties from a JSON", "body": "<p>The custom marshaller is a great way to change how your object is mapped to JSON. In you case however, I would not suggest this, in case you ever need to map your entire object to JSON at some other point (i.e. for an admin tool).</p>\n\n<p>Some key points of this answer:</p>\n\n<ul>\n<li>All values are exposed internally</li>\n<li>From the marshall code it's clear that values will be excluded and it's easy to get to the code that excludes values</li>\n<li>Minimize repetition and new types</li>\n</ul>\n\n<p><strong>I would suggest simply defining a function on your struct the returns a map of the fields you wish to expose.</strong></p>\n\n<p>From your example:</p>\n\n<pre><code>type Player struct {\n    Id        int64     `json:\"id\"`\n    Username  string    `json:\"username,omitempty\"`\n    Password  string    `json:\"-,omitempty\"`\n    Email     string    `json:\"email,omitempty\"`\n    Birthdate time.Time `json:\"birthdate,omitempty\"`\n    Avatar    string    `json:\"avatar,omitempty\"`\n}\n\nfunc (p Player) PublicInfo() map[string]interface{} {\n    return map[string]interface{}{\n        \"id\":       p.Id,\n        \"username\": p.Username,\n        \"avatar\":   p.Avatar,\n    }\n}\n</code></pre>\n\n<p>There are several ways you can bubble the use of this function up. One simple way is to have the <code>Table</code> struct use maps for <code>PlayerTop</code> and <code>PlayerBottom</code>:</p>\n\n<pre><code>type Table struct {\n    Id           int                         `json:\"id\"`\n    PlayerTop    map[string]interface{}      `json:\"playerTop\"`\n    PlayerBottom map[string]interface{}      `json:\"playerBottom\"`\n}\n\nfunc NewTable(id int, playerTop, playerBottom Player) Table {\n    return Table{Id: id, \n                 PlayerTop: playerTop.PublicInfo(), \n                 PlayerBottom: playerBottom.PublicInfo()}\n}\n</code></pre>\n\n<p>Marshalling this to JSON will return the fields you want. And you only need to edit one place to add/remove fields from the JSON.</p>\n\n<p>In case you use the <code>Table</code> type internally and need to access the players from it, then you may still need to store the full <code>Player</code> struct on the <code>Table</code>. I would simply follow the <code>Public</code> pattern from above with table like so:</p>\n\n<pre><code>type Table struct {\n    Id           int    `json:\"id\"`\n    PlayerTop    Player `json:\"playerTop\"`\n    PlayerBottom Player `json:\"playerBottom\"`\n}\n\nfunc (t Table) PublicInfo() map[string]interface{} {\n    return map[string]interface{}{\n        \"id\":           t.Id,\n        \"playerTop\":    t.PlayerTop.PublicInfo(),\n        \"playerBottom\": t.PlayerBottom.PublicInfo(),\n    }\n}\n</code></pre>\n\n<p>Now when you create a table and use it internally its clear what the types are, and when you marshall the JSON it's clear that you are excluding some types and where that exclusion is taking place.</p>\n\n<pre><code>func main() {\n    p1 := Player{Id: 1, Username: \"peter\", Avatar: \"avatar.png\", Email: \"PRIVATE\"}\n    p2 := Player{Id: 1, Username: \"peter\", Avatar: \"avatar.png\", Email: \"PRIVATE\"}\n    t := Table{Id: 1, PlayerTop: p1, PlayerBottom: p2}\n    admin, _ :=  json.Marshal(t)\n    public, _ := json.Marshal(t.PublicInfo())\n    fmt.Println(fmt.Sprintf(\"For admins: %s\", string(admin)))\n    fmt.Println(fmt.Sprintf(\"For public: %s\", string(public)))\n}\n/*\nOutput: \nFor admins: {\"id\":1,\"playerTop\":{\"id\":1,\"username\":\"peter\",\"email\":\"PRIVATE\",\"birthdate\":\"0001-01-01T00:00:00Z\",\"avatar\":\"avatar.png\"},\"playerBottom\":{\"id\":1,\"username\":\"peter\",\"email\":\"PRIVATE\",\"birthdate\":\"0001-01-01T00:00:00Z\",\"avatar\":\"avatar.png\"}}\nFor public: {\"id\":1,\"playerBottom\":{\"avatar\":\"avatar.png\",\"id\":1,\"username\":\"peter\"},\"playerTop\":{\"avatar\":\"avatar.png\",\"id\":1,\"username\":\"peter\"}}\n*/\n</code></pre>\n\n<p>See it in action: <a href=\"https://play.golang.org/p/24t-B6ZuUKu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/24t-B6ZuUKu</a></p>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 1, "last_activity_date": 1550613903, "last_edit_date": 1550613903, "creation_date": 1550594883, "answer_id": 54771159, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json/54771159#54771159", "title": "Hide properties from a JSON", "body": "<p>If you want to represent a public and private version of data - and one version is a superset of the other, try <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">embedded structs</a>. Adding a custom JSON marshaller and you can get two presentations of the same core data.</p>\n\n<pre><code>Database JSON: {\"Id\":12345,\"PlayerTop\":{\"id\":456,\"username\":\"Peter\",\"avatar\":\"peter.png\",\"password\":\"Secr3t\",\"birthdate\":\"0001-01-01T00:00:00Z\"},\"PlayerBottom\":{\"id\":890,\"username\":\"Paul\",\"avatar\":\"paul.png\",\"password\":\"abc123\",\"birthdate\":\"0001-01-01T00:00:00Z\"}}\n\nPublic JSON: {\"id\":12345,\"playerTop\":{\"id\":456,\"username\":\"Peter\",\"avatar\":\"peter.png\"},\"playerBottom\":{\"id\":890,\"username\":\"Paul\",\"avatar\":\"paul.png\"}}\n</code></pre>\n\n<p>Run in <a href=\"https://play.golang.org/p/Mi2xxqruzZL\" rel=\"nofollow noreferrer\">playground</a>:</p>\n\n<pre><code>// public info\ntype PublicPlayer struct {\n        Id       int64  `json:\"id\"`\n        Username string `json:\"username,omitempty\"`\n        Avatar   string `json:\"avatar,omitempty\"`\n}\n\n// private info\ntype Player struct {\n        PublicPlayer // embed public info\n\n        Password  string    `json:\"password,omitempty\"`\n        Email     string    `json:\"email,omitempty\"`\n        Birthdate time.Time `json:\"birthdate,omitempty\"`\n}\n\ntype Table struct {\n    Id           int    `json:\"id\"`\n    PlayerTop    Player `json:\"playerTop\"`\n    PlayerBottom Player `json:\"playerBottom\"`\n}\n\n// derivative type, so we can add a custom marshaller\ntype PublicTable Table\n\nfunc (t PublicTable) MarshalJSON() ([]byte, error) {\n        return json.Marshal(\n                // anonymous struct definition\n                struct {\n                        Id     int          `json:\"id\"`\n                        Top    PublicPlayer `json:\"playerTop\"`\n                        Bottom PublicPlayer `json:\"playerBottom\"`\n                }{  \n                        t.Id,\n                        t.PlayerTop.PublicPlayer,    // only export public data\n                        t.PlayerBottom.PublicPlayer, // only export public data\n                },  \n        )   \n}\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 9415063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb5700d38f7e3e4bf381a25aa4f62ec?s=128&d=identicon&r=PG&f=1", "display_name": "gnutella", "link": "https://stackoverflow.com/users/9415063/gnutella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 54755031, "answer_count": 5, "score": 5, "last_activity_date": 1550613903, "creation_date": 1550507526, "last_edit_date": 1550519407, "question_id": 54751615, "link": "https://stackoverflow.com/questions/54751615/hide-properties-from-a-json", "title": "Hide properties from a JSON", "body": "<p>I have a struct Table with 2 Players, but I need to ignore some properties from the struct <code>Player</code> when I send JSON.</p>\n\n<p>I could use <code>json:\"-\"</code>, but then the property will be ignored ALWAYS, and I need to ignore it only when I send the Table struct. I need those properties when I send the <code>Player</code> in other parts of the code.</p>\n\n<p>I have:</p>\n\n<pre><code>type Player struct {\n    Id            Int64   `json:\"id\"`\n    Username      string  `json:\"username,omitempty\"`\n    Password      string          `json:\"-,omitempty\"`\n    Email         string          `json:\"email,omitempty\"`\n    Birthdate     time.Time       `json:\"birthdate,omitempty\"`\n    Avatar        string  `json:avatar,omitempty\"`\n}\n\ntype Table struct {\n    Id           int       `json:\"id\"`\n    PlayerTop    Player      `json:\"playerTop\"`\n    PlayerBottom Player      `json:\"playerBottom\"`\n}\n</code></pre>\n\n<p>I need:</p>\n\n<pre><code>{\n    \"Table\": {\n        \"id\": 1,\n        \"playerBottom\": {\n            \"id\": 1,\n            \"username\": \"peter\",\n            \"avatar\": \"avatar.png\"\n        },\n        \"playerTop\": {\n            \"id\": 1,\n            \"username\": \"peter\",\n            \"avatar\": \"avatar.png\"\n        }\n\n    }\n}\n</code></pre>\n\n<p>The players come from the database, so the properties aren't empty.</p>\n\n<p>a) I could do something like:</p>\n\n<pre><code>myTable = new(Table)\n\nmyTable.PlayerBottom.Email = \"\"\nmyTable.PlayerBottom.Birthdate = \"\"\nmyTable.PlayerTop.Email = \"\"\nmyTable.PlayerTop.Birthdate = \"\"\n</code></pre>\n\n<p>so those properties will be ignored in the JSON, thanks to <code>json:\"omitempty\"</code>, but this is a bad idea.</p>\n\n<p>b) I could use something like an alias struct but <code>Table</code> is expecting that <code>PlayerBottom</code> is of type <code>Player</code> not <code>PlayerAlias</code>, but I don't know how to implement it:</p>\n\n<pre><code>type PlayerAlias struct {\n    Id            Int64   `json:\"id\"`\n    Username      string  `json:\"username,omitempty\"`\n    Avatar        string  `json:avatar,omitempty\"`\n}\n</code></pre>\n\n<p>c) I tried to add dynamically <code>json:\"-\"</code> to the properties that I don't want from the JSON before to send it, but it was a mess.</p>\n"}, {"tags": ["go", "tui"], "comments": [{"owner": {"reputation": 550, "user_id": 2665006, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f5fc5207efb9ca551f6c5f3e4804beca?s=128&d=identicon&r=PG", "display_name": "phage", "link": "https://stackoverflow.com/users/2665006/phage"}, "edited": false, "score": 0, "creation_date": 1550517335, "post_id": 54751609, "comment_id": 96289630, "body": "I found the error.  I need to add scn.Init() after creating the new screen."}, {"owner": {"reputation": 3793, "user_id": 2136970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e0b3de472b291902c62f5e1b414bbe3?s=128&d=identicon&r=PG", "display_name": "Kevin Sandow", "link": "https://stackoverflow.com/users/2136970/kevin-sandow"}, "edited": false, "score": 1, "creation_date": 1550562687, "post_id": 54751609, "comment_id": 96302966, "body": "Then add and accept your own answer, otherwise remove the question."}], "answers": [{"tags": [], "owner": {"reputation": 550, "user_id": 2665006, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f5fc5207efb9ca551f6c5f3e4804beca?s=128&d=identicon&r=PG", "display_name": "phage", "link": "https://stackoverflow.com/users/2665006/phage"}, "is_accepted": false, "score": 2, "last_activity_date": 1550852830, "creation_date": 1550852830, "answer_id": 54831291, "question_id": 54751609, "link": "https://stackoverflow.com/questions/54751609/go-tui-programming-using-tcell-api/54831291#54831291", "title": "Go TUI programming using TCell API", "body": "<p>The creator of this api (<a href=\"https://github.com/gdamore/tcell.git\" rel=\"nofollow noreferrer\">https://github.com/gdamore/tcell.git</a>) provided the solution.  Here is his respond:</p>\n\n<p>There are three potential issues.</p>\n\n<p>First, you need to initialize the screen. Call scn.Init() after creating the screen.</p>\n\n<p>The second is that your call to SetContent is misguided. The string you are passing is to accommodate combining characters. Instead you need to call SetContent 5 times (one for each letter of \"hello\") with a different offset, and the appropriate letter of \"hello\". You probably want to just pass \"\" for the 4th argument (the string), since none of this is combining characters..</p>\n\n<p>The third problem is that your program just exits. On most terminals this will cause the reset of the terminal to occur, losing your output. (On xterm, for example, tcell uses the alternate screen buffer by default, which leads to exit causing the contents of that screen to be lost, when it switches back to the primary screen buffer at program termination.)  The simplest way to prove this is to add a time.Sleep(time.Second * 10) or similar as the last line of your program.</p>\n\n<p>Here is the modified code:</p>\n\n<pre><code>\nimport (\n        \"fmt\"\n        \"github.com/gdamore/tcell\"\n        \"github.com/gdamore/tcell/encoding\"\n        \"os\"\n        \"time\"\n)\n\nfunc main() {\n        encoding.Register()\n        scn, err := tcell.NewScreen()\n        scn.Init()\n        if err != nil {\n                fmt.Fprintf(os.Stderr, \"%v\\n\", err)\n                os.Exit(1)\n        }\n        scn.Clear()\n        scn.SetContent(10, 10, rune('h'), []rune(\"\"), tcell.StyleDefault)\n        scn.Show()\n        time.Sleep(time.Second * 2)\n}\n</code></pre>\n\n<p>Hope this help.</p>\n"}], "owner": {"reputation": 550, "user_id": 2665006, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f5fc5207efb9ca551f6c5f3e4804beca?s=128&d=identicon&r=PG", "display_name": "phage", "link": "https://stackoverflow.com/users/2665006/phage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1602817535, "creation_date": 1550507501, "last_edit_date": 1550511834, "question_id": 54751609, "link": "https://stackoverflow.com/questions/54751609/go-tui-programming-using-tcell-api", "title": "Go TUI programming using TCell API", "body": "<p>I am trying to learn TUI programming in Go using the TCell API.\nIt is a simple app that print word \"hello\".  However, when I run the program below, nothing happens.  Please tell me what I am doing wrong.</p>\n\n<pre><code>package main\nimport (\n         \"fmt\"\n         \"github.com/gdamore/tcell\"\n         \"os\"\n)\n\nfunc main() {\n        scn, err := tcell.NewScreen()\n        if err != nil {\n                 fmt.Fprintf(os.Stderr, \"%v\\n\", err)\n                 os.Exit(1)\n         }\n         hhh := []rune(\"hello\")\n         scn.SetContent(10, 10, rune(' '), hhh, tcell.StyleDefault)\n         scn.Show()\n}\n</code></pre>\n"}, {"tags": ["go", "google-cloud-firestore"], "comments": [{"owner": {"reputation": 89473, "user_id": 5246885, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Bxclj.jpg?s=128&g=1", "display_name": "Alex Mamo", "link": "https://stackoverflow.com/users/5246885/alex-mamo"}, "edited": false, "score": 0, "creation_date": 1550501574, "post_id": 54749854, "comment_id": 96281817, "body": "Please add your database structure as a screenshot."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10902320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gy5HgUrS3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbPcEnw4iokoedbRLCrcF6IHJtF5g/mo/photo.jpg?sz=128", "display_name": "shaun larkin", "link": "https://stackoverflow.com/users/10902320/shaun-larkin"}, "edited": false, "score": 0, "creation_date": 1550505044, "post_id": 54750837, "comment_id": 96283975, "body": "Yes, this should be trivial so I must be missing something obvious."}, {"owner": {"reputation": 31, "user_id": 10902320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gy5HgUrS3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbPcEnw4iokoedbRLCrcF6IHJtF5g/mo/photo.jpg?sz=128", "display_name": "shaun larkin", "link": "https://stackoverflow.com/users/10902320/shaun-larkin"}, "edited": false, "score": 0, "creation_date": 1550510634, "post_id": 54750837, "comment_id": 96286957, "body": "I&#39;ve OrderBy with a less complex type &quot;number&quot; and still getting 0 results, so there&#39;s either a major bug in the Go firebase library(not likely) or I&#39;m missing something(more then likely).     I&#39;ve looked through the docs and can&#39;t see what I&#39;m doing wrong:   <a href=\"https://cloud.google.com/firestore/docs/query-data/order-limit-data\" rel=\"nofollow noreferrer\">cloud.google.com/firestore/docs/query-data/order-limit-data</a>"}], "tags": [], "owner": {"reputation": 1881, "user_id": 11042460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aab52c98a45d035426a71f4f18156e2f?s=128&d=identicon&r=PG&f=1", "display_name": "Java", "link": "https://stackoverflow.com/users/11042460/java"}, "is_accepted": false, "score": 0, "last_activity_date": 1550504715, "creation_date": 1550504715, "answer_id": 54750837, "question_id": 54749854, "link": "https://stackoverflow.com/questions/54749854/sorting-a-firebase-query-by-timestamp-seems-to-return-0-results-go-programming/54750837#54750837", "title": "Sorting a Firebase Query by timestamp seems to return 0 results [go programming language]", "body": "<p>That work for me in a similar context</p>\n\n<pre><code>db.collection(\"Sessions\")\n            .orderBy(\"DateCreated\", Query.Direction.ASCENDING)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10902320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gy5HgUrS3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbPcEnw4iokoedbRLCrcF6IHJtF5g/mo/photo.jpg?sz=128", "display_name": "shaun larkin", "link": "https://stackoverflow.com/users/10902320/shaun-larkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1550591129, "creation_date": 1550591129, "answer_id": 54770093, "question_id": 54749854, "link": "https://stackoverflow.com/questions/54749854/sorting-a-firebase-query-by-timestamp-seems-to-return-0-results-go-programming/54770093#54770093", "title": "Sorting a Firebase Query by timestamp seems to return 0 results [go programming language]", "body": "<p>It was <strong>user error</strong>:<br></p>\n\n<p>I was mapping the data to a custom <strong>type Session struct{}</strong> and one of the props was set to <strong>int</strong> when it should have been <strong>string</strong>, I wasn't catching the err. </p>\n"}], "owner": {"reputation": 31, "user_id": 10902320, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2gy5HgUrS3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbPcEnw4iokoedbRLCrcF6IHJtF5g/mo/photo.jpg?sz=128", "display_name": "shaun larkin", "link": "https://stackoverflow.com/users/10902320/shaun-larkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1550591129, "creation_date": 1550501516, "last_edit_date": 1550560376, "question_id": 54749854, "link": "https://stackoverflow.com/questions/54749854/sorting-a-firebase-query-by-timestamp-seems-to-return-0-results-go-programming", "title": "Sorting a Firebase Query by timestamp seems to return 0 results [go programming language]", "body": "<p><strong>Problem Overview:</strong><br>\nI'm querying a \"Sessions\" collection for sessions with a UserID == string, this works fine. But when I try and OrderBy(\"DateCreated\", Desc) which is of type timestamp I get 0 results</p>\n\n<p><strong>What I've tried:</strong> <br>\nI've checked the DB and the property I'm using which is called \"DateCreated\" and it's  a valid timestamp type. All sessions data is generated in go with random date ranges.</p>\n\n<p><strong>Current Results:</strong><br>\n<em>returns 100 results</em> (correct)<br>\nfirstSessionQuery := db.Collection(\"Sessions\").Where(\"UserID\", \"==\", uid).Documents(ctx)</p>\n\n<p><em>returns 0 results VS 100</em> (incorrect)<br>\nfirstSessionQuery := db.Collection(\"Sessions\").Where(\"UserID\", \"==\", uid).OrderBy(\"DateCreated\", firestore.Asc).Documents(ctx)</p>\n\n<pre><code>firstSessionQuery := db.Collection(\"Sessions\").Where(\"UserID\", \"==\", uid)\nallDocs, err := firstSessionQuery.Documents(ctx).GetAll()\n\ndocsSorted := firstSessionQuery.OrderBy(\"DateCreated\", firestore.Asc).Documents(ctx)\nallDocsSorted, err := docsSorted.GetAll()\nfmt.Printf(\"docs len: %v, docs sorted len: %v\\n\", len(allDocs), len(allDocsSorted))\n</code></pre>\n\n<p>the first %v returns 100, second %v returns 0</p>\n\n<p><strong>Expected results:</strong><br>\nMy expected results are 100 sessions sorted by date, either ascending or descending. </p>\n\n<p><strong>Here are db screenshots:</strong><br>\n<a href=\"https://i.stack.imgur.com/MTxiq.png\" rel=\"nofollow noreferrer\">here is the DateCreated prop</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Lwxk1.png\" rel=\"nofollow noreferrer\">Here is the UserID prop</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/BmoIQ.png\" rel=\"nofollow noreferrer\">Terminal fmt printout</a></p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11079508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d379963da9606ed5a1c86392c118ca?s=128&d=identicon&r=PG&f=1", "display_name": "JVDB", "link": "https://stackoverflow.com/users/11079508/jvdb"}, "edited": false, "score": 0, "creation_date": 1550519104, "post_id": 54750181, "comment_id": 96290281, "body": "Hi, thanks for the answer. If the last byte is a checksum. Should it be part of the param? Or do you suggest another solution?"}], "tags": [], "owner": {"reputation": 14361, "user_id": 3612353, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/94f2502e42d2e474bfd81dba411fe66f?s=128&d=identicon&r=PG", "display_name": "cn007b", "link": "https://stackoverflow.com/users/3612353/cn007b"}, "is_accepted": false, "score": 0, "last_activity_date": 1550502560, "creation_date": 1550502560, "answer_id": 54750181, "question_id": 54749382, "link": "https://stackoverflow.com/questions/54749382/golang-protobuf-dynamic-messages/54750181#54750181", "title": "Golang protobuf dynamic messages", "body": "<p>The answer is: yes, you can. And it must looks something like this:\n<br>proto file:</p>\n\n<pre><code>syntax = \"proto3\";\n\nmessage Event {\n  bytes start = 1;\n  bytes length = 2;\n  ...\n  repeated bytes param = 9;\n}\n</code></pre>\n\n<p>your go struct will be:</p>\n\n<pre><code>type Event struct {\n    Start  []byte\n    Length []byte\n    ...\n    Param  [][]byte\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11079508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70d379963da9606ed5a1c86392c118ca?s=128&d=identicon&r=PG&f=1", "display_name": "JVDB", "link": "https://stackoverflow.com/users/11079508/jvdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 642, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1550502560, "creation_date": 1550499902, "last_edit_date": 1550501572, "question_id": 54749382, "link": "https://stackoverflow.com/questions/54749382/golang-protobuf-dynamic-messages", "title": "Golang protobuf dynamic messages", "body": "<p>I'm writing a go tcp client to receive events from a server. The server response are bytes structured in this way:</p>\n\n<ol>\n<li>start byte</li>\n<li>length byte</li>\n<li>command byte</li>\n<li>adress1 byte</li>\n<li>adress2 byte</li>\n<li>address3 byte</li>\n<li>address4 byte</li>\n<li>error byte</li>\n<li>param 1 byte\n...\nN. param N byte</li>\n</ol>\n\n<p>Can I use Protobufs for this? If yes how should I structure the message?</p>\n\n<p>Kind regards,\n  Jurgen</p>\n"}, {"tags": ["json", "go", "maps", "mgo"], "comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550521048, "post_id": 54748463, "comment_id": 96291048, "body": "What mongo db driver are you using?  The offical, or a community one?"}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550522449, "post_id": 54748463, "comment_id": 96291675, "body": "I was just about to answer, as i realized, that i do miss information here. Have you tried to just debug your code? Where is the logic, which actually stores this map to the db? Maybe you alter a map directly, while you should use a pointer="}, {"owner": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "edited": false, "score": 0, "creation_date": 1550531158, "post_id": 54748463, "comment_id": 96294806, "body": "Are you sure the JSON is marshaled correctly? Can we see a sample of the JSON you&#39;re trying to unmarshal?"}, {"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1550534514, "post_id": 54748463, "comment_id": 96295641, "body": "The community MongoDB driver"}, {"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1550534641, "post_id": 54748463, "comment_id": 96295665, "body": "It may be an issue with the encoding when the map is created by the NATS publisher. What I was doing is decoding the map on the subscriber side, as opposed to prepping the NATS message, encoding it correctly, then sending it out"}], "answers": [{"tags": [], "owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "is_accepted": true, "score": 1, "last_activity_date": 1550535035, "creation_date": 1550535035, "answer_id": 54757173, "question_id": 54748463, "link": "https://stackoverflow.com/questions/54748463/inserting-json-or-a-map-from-mapstringinterface-to-mongodb-collection-sets-i/54757173#54757173", "title": "Inserting JSON or a map from map[string]interface{} to MongoDB collection sets ints and floats as strings", "body": "<p>this may not be a fix. But i've resolved the issue i've been having. I'm using a publisher and a subscriber via NATS. Previously I was creating a map with all the data, then sending that out as a message, then the subscriber takes the map from the message, and processing the datatypes (on the subscriber side)</p>\n\n<p>To fix the problem that I was experiencing, <strong>I instead formatted the maps' values on the publisher side</strong>. So I instead moved my code that checks for the datatype over to the NATS publisher, and not the code that processes the incoming message</p>\n\n<p>I understand this isn't an ideal solution, but if you're using NATS and find you're having the same issue. Try this</p>\n"}], "owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 645, "favorite_count": 0, "accepted_answer_id": 54757173, "answer_count": 1, "score": 1, "last_activity_date": 1606922317, "creation_date": 1550496670, "question_id": 54748463, "link": "https://stackoverflow.com/questions/54748463/inserting-json-or-a-map-from-mapstringinterface-to-mongodb-collection-sets-i", "title": "Inserting JSON or a map from map[string]interface{} to MongoDB collection sets ints and floats as strings", "body": "<p>I know the title seems generic and a duplicate, but i've tried many of the options from previous questions, and <strong>I can't use a struct here</strong></p>\n\n<p>My system is using the messaging service NATS to sends maps between a subscriber and a publisher. The subscriber takes the received map, and inserts it as a document in a MongoDB collection</p>\n\n<p>The problem I have is that floats and ints are inserted as strings!</p>\n\n<p>In my code, the <em>recipe</em> is a configuration file that sets the datatypes of the columns received in the map. Think of it as a series of keys like this:</p>\n\n<ul>\n<li>String column: \"string\",</li>\n<li>Int column: \"int\"</li>\n</ul>\n\n<p>Here's the code that creates the map with the right datatypes</p>\n\n<pre><code>mapWithCorrectDataTypes := make(map[string]interface{})\n\n    for columnNameFromDataTypesInRecipe, datatypeForColumnInRecipe := range dataTypesFromRecipeForColumns {\n\n    for natsMessageColumn, natsMessageColumnValue := range mapFromNATSMessage {\n\n            //If the column in the NATS message is found in the recipe, format the data as dictated in the recipe\n                    if natsMessageColumn == columnNameFromDataTypesInRecipe {\n\n                        if datatypeForColumnInRecipe.(string) == \"string\" {\n\n                            natsMessageColumnValue = natsMessageColumnValue.(string)\n                            mapWithCorrectDataTypes[columnNameFromDataTypesInRecipe] = natsMessageColumnValue\n                        }\n\n                        if datatypeForColumnInRecipe.(string) == \"int\" {\n\n                            convertedInt, err := strconv.Atoi(mapFromNATSMessage[columnNameFromDataTypesInRecipe].(string))\n                            if err != nil {\n                                fmt.Println(\"ERROR --&gt;\", err)\n                            }\n                            mapWithCorrectDataTypes[columnNameFromDataTypesInRecipe] = convertedInt\n                        }\n\n                        if datatypeForColumnInRecipe.(string) == \"float64\" {\n\n                            convertedFloat, err := strconv.ParseFloat(mapFromNATSMessage[columnNameFromDataTypesInRecipe].(string), 64)\n\n                            if err != nil {\n                                fmt.Println(\"ERROR --&gt;\", err)\n                            }\n                            mapWithCorrectDataTypes[columnNameFromDataTypesInRecipe] = convertedFloat\n\n                            fmt.Println(\"TYPE --&gt;\", reflect.TypeOf(mapWithCorrectDataTypes[columnNameFromDataTypesInRecipe]))\n                        }\n                    } else {\n                        //If column not found in the recipe, format as a string\n                        mapWithCorrectDataTypes[natsMessageColumn] = natsMessageColumnValue.(string)\n                    }\n                }\n            }\n</code></pre>\n\n<p>From the last line I put in a print statement for float64s to check that the datatype for this key in the map is correct, and it passes this test!</p>\n\n<hr>\n\n<p>My question is this: <strong>If the data types are correctly being set in the map, why when the map is inserted as a document in MongoDB are the floats and ints set as strings?!</strong></p>\n\n<p>What I have tried so far:</p>\n\n<p>Marshalling and unmarshalling the map as an interface, then inserting the record:</p>\n\n<pre><code>        jsonVersionOfMap, err := json.Marshal(mapWithCorrectDataTypes)\n\n        if err != nil {\n            fmt.Println(\"ERROR --&gt;\", err)\n        }\n\n        var interfaceForJSON interface{}\n\n        json.Unmarshal(jsonVersionOfMap, &amp;interfaceForJSON)\n\n        fmt.Println(\"JSON --&gt;\", interfaceForJSON)\n        err = mongoConnection.Insert(interfaceForJSON)\n\n        if err != nil {\n            fmt.Println(\"Error inserting MongoDB documents\", err)\n        }\n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p>See the result with the incorrectly formatted data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/hmp5V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hmp5V.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1550495413, "post_id": 54747796, "comment_id": 96278036, "body": "Is the container up and running when you try to <code>exec</code>? The error message states that the container is in a stopped state. The problem might be your command: <code>Cmd:   []string{&quot;cat&quot;, &quot;&#47;etc&#47;hosts&quot;}</code>. This won&#39;t keep the container running."}, {"owner": {"reputation": 523, "user_id": 2720351, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b04ca45dfcb035541981c8433a8bf511?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu97", "link": "https://stackoverflow.com/users/2720351/himanshu97"}, "reply_to_user": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1550496426, "post_id": 54747796, "comment_id": 96278630, "body": "i removed the command Cmd:  []string{&quot;cat&quot;, &quot;/etc/hosts&quot;} added a  time.sleep(5*time.Second) before adding exec commands, now getting error like : panic: unable to upgrade to tcp, received 404"}, {"owner": {"reputation": 523, "user_id": 2720351, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b04ca45dfcb035541981c8433a8bf511?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu97", "link": "https://stackoverflow.com/users/2720351/himanshu97"}, "reply_to_user": {"reputation": 16065, "user_id": 1561148, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/zN5vT.jpg?s=128&g=1", "display_name": "tgogos", "link": "https://stackoverflow.com/users/1561148/tgogos"}, "edited": false, "score": 0, "creation_date": 1550497390, "post_id": 54747796, "comment_id": 96279228, "body": "@tgogos  opps.. setting Tty:true while removing Cmd: has solved the issue for now, will post if any other error comes."}], "owner": {"reputation": 523, "user_id": 2720351, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/b04ca45dfcb035541981c8433a8bf511?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu97", "link": "https://stackoverflow.com/users/2720351/himanshu97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1762, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1550496670, "creation_date": 1550494408, "last_edit_date": 1550496670, "question_id": 54747796, "link": "https://stackoverflow.com/questions/54747796/golang-docker-api-cant-run-exec-on-a-container", "title": "Golang docker api: can&#39;t run Exec on a container", "body": "<p>I am trying to run Exec Command on a docker container created via Go client for the Docker Engine API.</p>\n\n<p>Here is my code.</p>\n\n<pre><code>func main() {\n    ctx := context.Background()\n    cli, err := client.NewEnvClient()\n    if err != nil {\n        panic(err)\n    }\n\n    reader, err := cli.ImagePull(ctx, \"docker.io/library/centos:7\", types.ImagePullOptions{})\n    if err != nil {\n        panic(err)\n    }\n    io.Copy(os.Stdout, reader)\n\n    resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n        Image: \"centos\",\n        //Cmd:   []string{\"cat\", \"/etc/hosts\"},\n        //Tty:   true,\n    }, nil, nil, \"\")\n    if err != nil {\n         panic(err)\n    }\n\n    if err := cli.ContainerStart(ctx, resp.ID, \ntypes.ContainerStartOptions{}); err != nil {\n        panic(err)\n    }\n\n     time.Sleep(5 * time.Second)\n\n    c := types.ExecConfig{AttachStdout: true, AttachStderr: true, \n    Cmd: []string{\"echo\", \"Hello Himanshu\"}}\n    execID, _ := cli.ContainerExecCreate(ctx, resp.ID, c)\n    fmt.Println(execID)\n\n    config := types.ExecConfig{}\n    res, er := cli.ContainerExecAttach(ctx, execID.ID, config)\n    if er != nil {\n        fmt.Println(\"Some Error\")\n    }\n\n    err = cli.ContainerExecStart(ctx,execID.ID,types.ExecStartCheck{})\n    if err != nil {\n        fmt.Println(\"Kuchh error\")\n    }\n    content, _, _ := res.Reader.ReadLine()\n    fmt.Println(string(content))\n    }\n</code></pre>\n\n<p>Here I always get error: </p>\n\n<blockquote>\n  <p>cannot exec in a stopped state: unknown\n  or</p>\n  \n  <p>unable to upgrade to tcp, received 404</p>\n</blockquote>\n\n<p>Even if I use container logs, it will print whatever is supplied in RUN cmd, but not what is sent in Exec. same error will be there as well.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1565, "user_id": 5093377, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/C9O8p.jpg?s=128&g=1", "display_name": "Milan Velebit", "link": "https://stackoverflow.com/users/5093377/milan-velebit"}, "edited": false, "score": 0, "creation_date": 1550488978, "post_id": 54746130, "comment_id": 96274172, "body": "Have you actually built the angular app?"}, {"owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 0, "creation_date": 1550489208, "post_id": 54746130, "comment_id": 96274321, "body": "Does that folder contain index.html?"}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 1565, "user_id": 5093377, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/C9O8p.jpg?s=128&g=1", "display_name": "Milan Velebit", "link": "https://stackoverflow.com/users/5093377/milan-velebit"}, "edited": false, "score": 0, "creation_date": 1550489309, "post_id": 54746130, "comment_id": 96274382, "body": "@Milan Velebit I do have a working app on localhost."}, {"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "reply_to_user": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 0, "creation_date": 1550489380, "post_id": 54746130, "comment_id": 96274419, "body": "@Krishna Chaitanya Kornepati No it doesn&#39;t contain that file."}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1550489451, "post_id": 54746130, "comment_id": 96274464, "body": "To serve angular app as first you need to build it, and then serve <code>dist</code> directory which will be created after building in your root project directory. So it probably will be <code>.&#47;static&#47;dist</code>."}, {"owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 0, "creation_date": 1550489534, "post_id": 54746130, "comment_id": 96274507, "body": "angular app needs to be build before it can be served by a simple file server and the folder needs to have index.html to show a webpage if you open it. which will be generated once you build it."}], "answers": [{"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1550491621, "post_id": 54746403, "comment_id": 96275735, "body": "This <code>index.html</code> will have whatever I create in the <code>src&#47;app</code> directory ? Also, I did as you said I am able to get the page served on the url."}, {"owner": {"reputation": 1565, "user_id": 5093377, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/C9O8p.jpg?s=128&g=1", "display_name": "Milan Velebit", "link": "https://stackoverflow.com/users/5093377/milan-velebit"}, "reply_to_user": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 1, "creation_date": 1550493075, "post_id": 54746403, "comment_id": 96276600, "body": "@ameyCU Yes, you can read about it <a href=\"https://github.com/angular/angular-cli/wiki/build\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 1565, "user_id": 5093377, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/C9O8p.jpg?s=128&g=1", "display_name": "Milan Velebit", "link": "https://stackoverflow.com/users/5093377/milan-velebit"}, "is_accepted": true, "score": 1, "last_activity_date": 1550489743, "creation_date": 1550489743, "answer_id": 54746403, "question_id": 54746130, "link": "https://stackoverflow.com/questions/54746130/how-to-serve-angular-with-golang/54746403#54746403", "title": "How to serve angular with golang?", "body": "<p>The Angular application is most likely served via its own NodeJS server (by default on port <em>4200</em> if I remember). You need to run <code>ng build</code> if you've created the app via <em>Angular cli</em>.</p>\n\n<p>Afterwards, serve the <code>index.html</code> file inside the <em>/dist</em> folder which'll be created upon running <code>ng build</code>. That file contains the minified, bundled JS which can be served via any webserver.</p>\n"}], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1749, "favorite_count": 0, "accepted_answer_id": 54746403, "answer_count": 1, "score": 1, "last_activity_date": 1550489743, "creation_date": 1550488854, "question_id": 54746130, "link": "https://stackoverflow.com/questions/54746130/how-to-serve-angular-with-golang", "title": "How to serve angular with golang?", "body": "<p>I am trying it using <code>http.FileServe</code> providing the directory of angular app. But instead I get the list of files in that folder. I am using gorilla mux package.</p>\n\n<p>If it is for a simple <code>html</code> file it does work but not for angular app.</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.PathPrefix(\"/\").Handler(http.FileServer(http.Dir(\"./static/src/app\")))\n</code></pre>\n\n<p>This lists all files in directory in <code>./static/src/app</code> when went to that url. How should I correctly do it ?</p>\n"}, {"tags": ["go", "vue.js", "nuxt.js"], "answers": [{"tags": [], "owner": {"reputation": 423, "user_id": 6149652, "user_type": "registered", "profile_image": "https://graph.facebook.com/1060569294015841/picture?type=large", "display_name": "Birante", "link": "https://stackoverflow.com/users/6149652/birante"}, "is_accepted": false, "score": 0, "last_activity_date": 1550492353, "creation_date": 1550492353, "answer_id": 54747167, "question_id": 54745970, "link": "https://stackoverflow.com/questions/54745970/how-do-i-handle-oauth-in-nuxt-with-a-separate-api-server/54747167#54747167", "title": "How do i handle oauth in Nuxt with a separate API server?", "body": "<p>Hi @sinusGob you can use this the auth plugin of nuxt</p>\n\n<p>See the docs.\n<a href=\"https://auth.nuxtjs.org/reference/providers/facebook\" rel=\"nofollow noreferrer\">https://auth.nuxtjs.org/reference/providers/facebook</a></p>\n\n<p>Thanks.</p>\n"}], "owner": {"reputation": 2343, "user_id": 4532065, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/477b5c1ec36a72979cde174ad9902d9f?s=128&d=identicon&r=PG&f=1", "display_name": "sinusGob", "link": "https://stackoverflow.com/users/4532065/sinusgob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 544, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550492353, "creation_date": 1550488317, "question_id": 54745970, "link": "https://stackoverflow.com/questions/54745970/how-do-i-handle-oauth-in-nuxt-with-a-separate-api-server", "title": "How do i handle oauth in Nuxt with a separate API server?", "body": "<p>Currently I have two separate apps</p>\n\n<ol>\n<li>Frontend (Nuxt)</li>\n<li>Backend (Golang)</li>\n</ol>\n\n<p>On the backend I'm using a third party library called <a href=\"https://github.com/markbates/goth\" rel=\"nofollow noreferrer\">Goth</a> and I'm using Facebook as the provider. Everything works fine on the backend but I'm confused on how to do on the frontend which is on the Nuxt side</p>\n\n<p>So technically on the backend there will be two urls </p>\n\n<pre><code> /auth/facebook\n\n/auth/facebook/callback\n</code></pre>\n\n<p>Once everything is correct then I will get the object from facebook on the backend side which is the API written in Golang</p>\n\n<pre><code> data: {\n         RawData: {\n             email: \"john@gmail.com\",\n             first_name: \"John\",\n             id: \"123123\",\n             last_name: \"Grave\",\n             name: \"John Grave\",\n             picture: {\n                 data: {\n                     height: 50,\n                     is_silhouette: true,\n                     url: \"https://platform-lookaside.fbsbx.com/platform/profilepic/?asid=13123123&amp;height=50&amp;width=50&amp;ext=1553079619&amp;hash=AeTX5RW5K_avWLbI\",\n                     width: 50\n                 }\n             }\n         },\n         Provider: \"facebook\",\n         Email: \"john@gmail.com\",\n         Name: \"John Grave\",\n         FirstName: \"John\",\n         LastName: \"Grave\",\n         NickName: \"John Grave\",\n         Description: \"\",\n         UserID: \"123123\",\n         AvatarURL: \"https://platform-lookaside.fbsbx.com/platform/profilepic/?asid=2312802522337124&amp;height=50&amp;width=50&amp;ext=1553079619&amp;hash=AeTX5RW5K_avWLbI\",\n         Location: \"\",\n         AccessToken: \"EAAIuR3NSCPwBAEcp2jskHuUCzdWLB97Aq99nCV5HuieVVz8xGfJ6exAZDZD\",\n         AccessTokenSecret: \"\",\n         RefreshToken: \"\",\n         ExpiresAt: \"2019-04-19T15:52:59.895655+08:00\"\n     },\n     status: 200\n }\n</code></pre>\n\n<p>Assume that everything is working fine on the backend. </p>\n\n<p>The only thing that I could think of is calling it on the method (Nuxt side)</p>\n\n<pre><code>export default {\n  methods: {\n    facebookLogin() {\n      window.location.href = `http://localhost:8080/auth/facebook`\n    }\n  }\n}\n</code></pre>\n\n<p>This will just redirect to the </p>\n\n<pre><code>http://localhost:8080/auth/facebook/callback?code=AQAaq9GYcGAnQ9wUCDAd5BFRHxMRjqGFR0J6zjGtYpD-\n</code></pre>\n\n<p>What are the correct steps should I do to communicate with the backend OAuth API?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["string", "templates", "go", "testing", "formatting"], "answers": [{"comments": [{"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550488485, "post_id": 54745446, "comment_id": 96273895, "body": "yeah this is what I tried and I still get it failing :-( it&#39;s also feels quite fiddly (as in I think I&#39;ve got it matching up, but clearly I don&#39;t for it to fail) so I think I prefer the <code>strings.Fields</code> approach described by &#39;leaf bebop&#39;."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550488586, "post_id": 54745446, "comment_id": 96273950, "body": "When specifying the <code>output</code> variable, the first line will be indented. That&#39;s not a problem, what matters is what is between the backticks. So when you specify the expected output, subsequent lines must not be indented by your code editor. Editors are smart enough not to auto-indent content in raw string literals."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550488751, "post_id": 54745446, "comment_id": 96274045, "body": "It&#39;s easy to make this wrong as if you copy-paste a valid output between backticks, code editors will format it wrong (auto-indent multi lines). The easy way to do this is to write the variable declaration, e.g. <code>output := ``</code>, then press an Enter after the first backtick, clear the indentation and then copy-paste the valid output (and finally remove the first line break)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550488776, "post_id": 54745446, "comment_id": 96274057, "body": "After all, this is completely a non-coding issue, but rather an issue of editors&#39; auto-format and defining a raw string literal."}, {"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550503075, "post_id": 54745446, "comment_id": 96282691, "body": "thanks for the updated answer. unfortunately that still fails even after following your explicit steps \ud83e\udd14 I don&#39;t believe my editor is doing anything with the spaces, and the failure output in the test looks like a spot on match."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550503191, "post_id": 54745446, "comment_id": 96282772, "body": "@Integralist There must be something different, e.g. tabs vs spaces. Print them as byte slices, and look for mismatched numbers. You can print the bytes like this: <code>fmt.Println([]byte(&quot;some string&quot;))</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550503713, "post_id": 54745446, "comment_id": 96283099, "body": "@Integralist Hey, I checked your updated test result, and in the result you get, there is a space after the first line: <code>digraph sitemap { </code>, and also there&#39;s a space after the 3rd line: <code>-&gt; { </code>, but you don&#39;t add those to your expected output. Either add those to your expected output too, or remove those spaces from the template!"}, {"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "edited": false, "score": 0, "creation_date": 1550505033, "post_id": 54745446, "comment_id": 96283963, "body": "oh interesting, so <i>that</i> does look to be an editor issue as my editor removes spaces at the end of lines. but the template code itself needs the space because otherwise the code itself errors: i.e. this works <code>digraph sitemap { {{range .}}</code> but this doesn&#39;t <code>digraph sitemap {{{range .}}</code> that space seems to stop the compiler from breaking?"}, {"owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1550505190, "post_id": 54745446, "comment_id": 96284072, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/188616/discussion-between-integralist-and-icza\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1550504093, "last_edit_date": 1550504093, "creation_date": 1550486641, "answer_id": 54745446, "question_id": 54745108, "link": "https://stackoverflow.com/questions/54745108/how-to-get-golang-to-test-a-multiline-output-matches/54745446#54745446", "title": "how to get golang to test a multiline output matches", "body": "<p>The simplest solution is to use the same indentation in the test when specifying the expected output (the same what you use in the template).</p>\n\n<p>You have:</p>\n\n<pre><code>output := `digraph sitemap {\n  \"http://www.example.com/\"\n      -&gt; {\n          \"http://www.example.com/foo\",\n          \"http://www.example.com/bar\",\n          \"http://www.example.com/baz\"\n  }\n}`\n</code></pre>\n\n<p>Change it to:</p>\n\n<pre><code>    output := `digraph sitemap {\n  \"http://www.example.com/\"\n    -&gt; {\n      \"http://www.example.com/foo\",\n      \"http://www.example.com/bar\",\n      \"http://www.example.com/baz\"\n    }\n}`\n</code></pre>\n\n<p>Note that for example the final line is not indented. When you use raw string literal, every character including indentation characters is part of the literal as-is.</p>\n\n<h2>Steps to create a correct, un-indented raw string literal</h2>\n\n<p>After all, this is completely a non-coding issue, but rather an issue of editors' auto-formatting and defining a raw string literal. An easy way to get it right is first to write an empty raw string literal, add an empty line to it and clear the auto-indentation inserted by the editor:</p>\n\n<pre><code>    output := `\n`\n</code></pre>\n\n<p>When you have this, copy-paste the correct input before the closing backtick, e.g.:</p>\n\n<pre><code>    output := `\ndigraph sitemap {\n  \"http://www.example.com/\"\n    -&gt; {\n      \"http://www.example.com/foo\",\n      \"http://www.example.com/bar\",\n      \"http://www.example.com/baz\"\n    }\n}`\n</code></pre>\n\n<p>And as a last step, remove line break from the first line of the raw string literal, and you have the correct raw string literal:</p>\n\n<pre><code>    output := `digraph sitemap {\n  \"http://www.example.com/\"\n    -&gt; {\n      \"http://www.example.com/foo\",\n      \"http://www.example.com/bar\",\n      \"http://www.example.com/baz\"\n    }\n}`\n</code></pre>\n\n<p>Once you have this, running <code>gofmt</code> or auto-formatting of editors will not mess with it anymore.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>I checked your updated test result, and in the result you get, there is a space after the first line: <code>digraph sitemap {</code>, and also there's a space after the 3rd line: <code>-&gt; {</code>, but you don't add those to your expected output. Either add those to your expected output too, or remove those spaces from the template! When comparing strings, they are compared byte-wise, every character (including white-spaces) matter.</p>\n\n<p>To remove those extra spaces from the template:</p>\n\n<pre><code>    dotTmpl := `digraph sitemap { {{- range .}}\n  \"{{.URL}}\"\n    -&gt; { {{- $n := len .Anchors}}{{range  $i, $v := .Anchors}}\n      \"{{.}}\"{{if eq (plus1 $i) $n}}{{else}},{{end}}{{end}}\n    } {{end}}\n}`\n</code></pre>\n\n<p>Note the use of <code>{{-</code>. This is to <a href=\"https://golang.org/pkg/text/template/#hdr-Text_and_spaces\" rel=\"nofollow noreferrer\">trim spaces around template actions</a>, this was added in <a href=\"https://golang.org/doc/go1.6#template\" rel=\"nofollow noreferrer\">Go 1.6</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "is_accepted": false, "score": 0, "last_activity_date": 1550488023, "last_edit_date": 1550488023, "creation_date": 1550486699, "answer_id": 54745462, "question_id": 54745108, "link": "https://stackoverflow.com/questions/54745108/how-to-get-golang-to-test-a-multiline-output-matches/54745462#54745462", "title": "how to get golang to test a multiline output matches", "body": "<p>the problem is that there is an extra space. in your formatted text right after <code>{</code> that seems to be your problem. You can fix it by changing your format string to this </p>\n\n<pre><code>`digraph sitemap {{{range .}}\n  \"{{.URL}}\"\n    -&gt; {{{$n := len .Anchors}}{{range  $i, $v := .Anchors}}\n      \"{{.}}\"{{if eq (plus1 $i) $n}}{{else}},{{end}}{{end}}\n    }{{end}}\n}`\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 2, "last_activity_date": 1550486994, "creation_date": 1550486994, "answer_id": 54745558, "question_id": 54745108, "link": "https://stackoverflow.com/questions/54745108/how-to-get-golang-to-test-a-multiline-output-matches/54745558#54745558", "title": "how to get golang to test a multiline output matches", "body": "<p>If you want to ignore format, you can use <code>strings.Fields</code>.</p>\n\n<pre><code>output := strings.Fields(`digraph sitemap {\n  \"http://www.example.com/\"\n      -&gt; {\n          \"http://www.example.com/foo\",\n          \"http://www.example.com/bar\",\n          \"http://www.example.com/baz\"\n  }\n}`)\n\nactual := strings.Fields(Dot(input))\n\nif !equal(output,actual) {\n    // ...\n}\n</code></pre>\n\n<p>where equal is a simple function that compares two slices.</p>\n"}], "owner": {"reputation": 5041, "user_id": 4288305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-SabTTMIHSb8/AAAAAAAAAAI/AAAAAAAAAjQ/EmdFmLWi2MY/photo.jpg?sz=128", "display_name": "Integralist", "link": "https://stackoverflow.com/users/4288305/integralist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 474, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1550504093, "creation_date": 1550485615, "last_edit_date": 1550502986, "question_id": 54745108, "link": "https://stackoverflow.com/questions/54745108/how-to-get-golang-to-test-a-multiline-output-matches", "title": "how to get golang to test a multiline output matches", "body": "<p>I have the following code which generates some string output:</p>\n\n<pre><code>package formatter\n\nimport (\n    \"bytes\"\n    \"log\"\n    \"text/template\"\n\n    \"github.com/foo/bar/internal/mapper\"\n)\n\n// map of template functions that enable us to identify the final item within a\n// collection being iterated over.\nvar fns = template.FuncMap{\n    \"plus1\": func(x int) int {\n        return x + 1\n    },\n}\n\n// Dot renders our results in dot format for use with graphviz\nfunc Dot(results []mapper.Page) string {\n    dotTmpl := `digraph sitemap { {{range .}}\n  \"{{.URL}}\"\n    -&gt; { {{$n := len .Anchors}}{{range  $i, $v := .Anchors}}\n      \"{{.}}\"{{if eq (plus1 $i) $n}}{{else}},{{end}}{{end}}\n    } {{end}}\n}`\n\n    tmpl, err := template.New(\"digraph\").Funcs(fns).Parse(dotTmpl)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var output bytes.Buffer\n    if err := tmpl.Execute(&amp;output, results); err != nil {\n        log.Fatal(err)\n    }\n\n    return output.String()\n}\n</code></pre>\n\n<p>It generates output like:</p>\n\n<pre><code>digraph sitemap {\n  \"http://www.example.com/\"\n    -&gt; {\n      \"http://www.example.com/foo\",\n      \"http://www.example.com/bar\",\n      \"http://www.example.com/baz\"\n    }\n}\n</code></pre>\n\n<p>Below is a test for this functionality...</p>\n\n<pre><code>package formatter\n\nimport (\n    \"testing\"\n\n    \"github.com/foo/bar/internal/mapper\"\n)\n\nfunc TestDot(t *testing.T) {\n    input := []mapper.Page{\n        mapper.Page{\n            URL: \"http://www.example.com/\",\n            Anchors: []string{\n                \"http://www.example.com/foo\",\n                \"http://www.example.com/bar\",\n                \"http://www.example.com/baz\",\n            },\n            Links: []string{\n                \"http://www.example.com/foo.css\",\n                \"http://www.example.com/bar.css\",\n                \"http://www.example.com/baz.css\",\n            },\n            Scripts: []string{\n                \"http://www.example.com/foo.js\",\n                \"http://www.example.com/bar.js\",\n                \"http://www.example.com/baz.js\",\n            },\n        },\n    }\n\n    output := `digraph sitemap {\n      \"http://www.example.com/\"\n          -&gt; {\n              \"http://www.example.com/foo\",\n              \"http://www.example.com/bar\",\n              \"http://www.example.com/baz\"\n      }\n    }`\n\n    actual := Dot(input)\n\n    if actual != output {\n        t.Errorf(\"expected: %s\\ngot: %s\", output, actual)\n    }\n}\n</code></pre>\n\n<p>Which fails with the following error (which is related to the outputted format spacing)...</p>\n\n<pre><code>--- FAIL: TestDot (0.00s)\n    format_test.go:43: expected: digraph sitemap {\n                  \"http://www.example.com/\"\n                          -&gt; {\n                                  \"http://www.example.com/foo\",\n                                  \"http://www.example.com/bar\",\n                                  \"http://www.example.com/baz\"\n              }\n                }\n        got: digraph sitemap { \n          \"http://www.example.com/\"\n            -&gt; { \n              \"http://www.example.com/foo\",\n              \"http://www.example.com/bar\",\n              \"http://www.example.com/baz\"\n            } \n        }\n</code></pre>\n\n<p>I've tried tweaking my test <code>output</code> variable so the spacing would align with what's actually outputted from the real code. That didn't work.</p>\n\n<p>I also tried using <code>strings.Replace()</code> on both my output variable and the actual outputted content and bizarrely the output from my function (even though it was passed through <code>strings.Replace</code> would <em>still</em> be multi-lined (and so the test would fail)? </p>\n\n<p>Anyone have any ideas how I can make the output consistent for the sake of code verification?</p>\n\n<p>Thanks.</p>\n\n<h2>UPDATE</h2>\n\n<p>I tried the approach suggested by @icza and it still fails the test, although the output in the test <em>looks</em> more like it's expected to be:</p>\n\n<pre><code>=== RUN   TestDot\n--- FAIL: TestDot (0.00s)\n    format_test.go:65: expected: digraph sitemap {\n          \"http://www.example.com/\"\n            -&gt; {\n              \"http://www.example.com/foo\",\n              \"http://www.example.com/bar\",\n              \"http://www.example.com/baz\"\n            }\n        }\n        got: digraph sitemap { \n          \"http://www.example.com/\"\n            -&gt; { \n              \"http://www.example.com/foo\",\n              \"http://www.example.com/bar\",\n              \"http://www.example.com/baz\"\n            }\n        }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1550484915, "post_id": 54744850, "comment_id": 96271859, "body": "<code>a</code> can take only ints, <code>b</code> needs a func that can take anything. If you pass <code>a</code> to <code>b</code> but <code>b</code> passes &quot;astring&quot; to its <code>f</code> argument, which is <code>a</code> in this case, instead of passing it <code>2</code> that would be an error, right? So the compiler stops you from doing that."}, {"owner": {"reputation": 1180, "user_id": 3420171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sR3Jy.png?s=128&g=1", "display_name": "Luke Stoward", "link": "https://stackoverflow.com/users/3420171/luke-stoward"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550485279, "post_id": 54744850, "comment_id": 96272103, "body": "@mkopriva so you&#39;re saying that because <code>b</code> could theoretically pass anything to its argument <code>f</code>, the compiler generates an error?"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550485551, "post_id": 54744850, "comment_id": 96272221, "body": "As @mkopriva already explained, the following 2 are not compatible:    func(int) AND func(interface{}). In your case b, expects the 2nd kind but you are passing the 1st kind."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1550485584, "post_id": 54744850, "comment_id": 96272249, "body": "The compiler generates an error because the two types, <code>func(int)</code> and <code>func(interface{})</code>, are not the same and neither are they compatible. The benefit of that error is that you cannot write a program where you pass a string to a function that expects an int."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1550485672, "post_id": 54744850, "comment_id": 96272288, "body": "The first thing to understand is this: <code>interface{}</code> does <b>not</b> mean &quot;any type&quot;. Really not. <code>interface{}</code> is a certain static type like uint16 and means &quot;the empty interface&quot;. While you can assign everything to a variable of type &quot;the empty interface&quot; the empty interface is different from uint16, int, whatever other type. And function signatures must match one one one on each static type."}, {"owner": {"reputation": 1180, "user_id": 3420171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sR3Jy.png?s=128&g=1", "display_name": "Luke Stoward", "link": "https://stackoverflow.com/users/3420171/luke-stoward"}, "edited": false, "score": 0, "creation_date": 1550485730, "post_id": 54744850, "comment_id": 96272330, "body": "Right, ok. I think I understand now. Thanks all for the explanations."}], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 5, "last_activity_date": 1550507104, "creation_date": 1550507104, "answer_id": 54751503, "question_id": 54744850, "link": "https://stackoverflow.com/questions/54744850/type-func-with-interface-parameter-incompatible-error/54751503#54751503", "title": "Type func with interface parameter incompatible error", "body": "<p>The concept you're looking for here is <a href=\"https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)\" rel=\"noreferrer\"><em>variance</em> in the type system</a>. Some type systems and types support <em>covariance</em> and <em>contravariance</em>, but Go's interfaces do not.</p>\n\n<p>While an <code>int</code> can be passed to a function that expects <code>interface{}</code>, the same cannot be said about <code>func(int)</code> and <code>func(interface{})</code>, because interfaces do not behave covariantly.</p>\n\n<p>If type <code>x</code> implements interface <code>ii</code>, it doesn't mean that <code>func(x)</code> implements <code>func(ii)</code>.</p>\n\n<p>What you could do is pass <code>func(int)</code> into a function that expects <code>interface{}</code>, so you could do</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc foo(x interface{}) {\n    fmt.Println(\"foo\", x)\n}\n\nfunc add2(n int) int {\n    return n + 2\n}\n\nfunc main() {\n    foo(add2)\n}\n</code></pre>\n\n<p>Because <code>func(int)int</code> <em>does</em> implement <code>interface{}</code>.</p>\n\n<hr>\n\n<p>In addition to the Wikipedia link at the top of the answer, <a href=\"https://eli.thegreenplace.net/2018/covariance-and-contravariance-in-subtyping/\" rel=\"noreferrer\">this post</a> provides more details about the different kinds of variance programming languages support. It mostly uses other languages, because variance is best demonstrated with languages that support inheritance.</p>\n"}], "owner": {"reputation": 1180, "user_id": 3420171, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sR3Jy.png?s=128&g=1", "display_name": "Luke Stoward", "link": "https://stackoverflow.com/users/3420171/luke-stoward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 54751503, "answer_count": 1, "score": 2, "last_activity_date": 1569573477, "creation_date": 1550484784, "last_edit_date": 1569573477, "question_id": 54744850, "link": "https://stackoverflow.com/questions/54744850/type-func-with-interface-parameter-incompatible-error", "title": "Type func with interface parameter incompatible error", "body": "<p>I have declared a new type <code>func</code> that takes any value that conforms to <code>interface{}</code>. However, when I invoke a function that has been passed as an argument (conforming to that type specification) I get an error.</p>\n\n<p>Can somebody explain why this is the case? Below is the simplest example I could recreate the issue with.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type myfunc func(x interface{})\n\nfunc a(num int) {\n    return\n}\n\nfunc b(f myfunc) {\n    f(2)\n    return\n}\n\nfunc main() {\n    b(a) // error: cannot use a (type func(int)) as type myfunc in argument to b\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "socket.io"], "answers": [{"tags": [], "owner": {"reputation": 57, "user_id": 9716692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947922611894394/picture?type=large", "display_name": "user9716692", "link": "https://stackoverflow.com/users/9716692/user9716692"}, "is_accepted": true, "score": 1, "last_activity_date": 1550546713, "creation_date": 1550546713, "answer_id": 54758426, "question_id": 54744632, "link": "https://stackoverflow.com/questions/54744632/how-to-broadcast-image-with-socket-io-in-golang/54758426#54758426", "title": "How to broadcast image with socket.io in Golang?", "body": "<p>I have found the answer myself. <code>\n</code>\nThe declare of data struct in GO should be:</p>\n\n<pre><code>type data struct {\nImage  bool   `json:\"image\"`\nBuffer string `json:\"buffer\"`}\n</code></pre>\n\n<p>Then it works!</p>\n"}], "owner": {"reputation": 57, "user_id": 9716692, "user_type": "registered", "profile_image": "https://graph.facebook.com/1947922611894394/picture?type=large", "display_name": "user9716692", "link": "https://stackoverflow.com/users/9716692/user9716692"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "accepted_answer_id": 54758426, "answer_count": 1, "score": 0, "last_activity_date": 1550546713, "creation_date": 1550484049, "question_id": 54744632, "link": "https://stackoverflow.com/questions/54744632/how-to-broadcast-image-with-socket-io-in-golang", "title": "How to broadcast image with socket.io in Golang?", "body": "<p>I want to use socket.io to broadcast images in Golang(Server side). I already know how to do it in Node.js, but I have no idea with Golang. Codes are below:<code>\n</code>\nNode.js(worked):</p>\n\n<pre><code>var io = require('socket.io')(http);\n   io.on('connection', function(socket){\n       fs.readFile(imagepath, (err, buf)=&gt;{\n       socket.broadcast.emit('image', { image: true, buffer: \n       buf.toString('base64') });\n   }\n</code></pre>\n\n<p>Go(not worked):</p>\n\n<pre><code>type data struct {\n    image  bool\n    buffer string\n}\nserver, _ := socketio.NewServer(nil)    \nserver.On(\"connection\", func(socket socketio.Socket) {\n                f, _ := os.Open(imagepath)\n                reader := bufio.NewReader(f)\n                content, _ := ioutil.ReadAll(reader)\n                encoded := base64.StdEncoding.EncodeToString(content)\n                socket.Emit(\"image\", data{true, encoded})\n        })\n</code></pre>\n\n<p>client side(worked with Server side using Node.js):</p>\n\n<pre><code>var img = document.getElementById('img')\nvar socket = io();\nsocket.on('image', function(info) {\nif(info.image)\n{ img.src = 'data:image/jpeg;base64,' + info.buffer;}\n});\n</code></pre>\n"}, {"tags": ["docker", "go", "grpc"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1550478442, "post_id": 54743025, "comment_id": 96268392, "body": "What the content of current directroy? Did you try to use <code>stage</code> build? Did you use the <code>.dockerignore</code> ?"}, {"owner": {"reputation": 57, "user_id": 6690245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07d9fc4c5d0b130d8f30584562242a5?s=128&d=identicon&r=PG", "display_name": "freshPrince", "link": "https://stackoverflow.com/users/6690245/freshprince"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1550478688, "post_id": 54743025, "comment_id": 96268500, "body": "Current directory is grpc example which is available at grpc repository [ <a href=\"https://github.com/grpc/grpc-go/tree/master/examples\" rel=\"nofollow noreferrer\">github.com/grpc/grpc-go/tree/master/examples</a> ]. I don&#39;t know about stage built. can you provide resources for it?"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1550479509, "post_id": 54743025, "comment_id": 96268872, "body": "You need to exclude from context things you dont need, you can do it by <code>COPY</code> only needed directroy or using <code>.dockerignore</code> file. Here is some info about mutli stage build <a href=\"https://blog.alexellis.io/mutli-stage-docker-builds/\" rel=\"nofollow noreferrer\">blog.alexellis.io/mutli-stage-docker-builds</a>"}, {"owner": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "edited": false, "score": 0, "creation_date": 1550480080, "post_id": 54743025, "comment_id": 96269117, "body": "Can you share from which image you start? the <code>FROM</code> in the <code>Dockerfile</code>"}, {"owner": {"reputation": 57, "user_id": 6690245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07d9fc4c5d0b130d8f30584562242a5?s=128&d=identicon&r=PG", "display_name": "freshPrince", "link": "https://stackoverflow.com/users/6690245/freshprince"}, "reply_to_user": {"reputation": 32481, "user_id": 2270041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cn7rq.jpg?s=128&g=1", "display_name": "Matteo", "link": "https://stackoverflow.com/users/2270041/matteo"}, "edited": false, "score": 1, "creation_date": 1550480213, "post_id": 54743025, "comment_id": 96269203, "body": "@Matteo Currently I am starting from golang 1.11 but I have seen it starting from debian and they may be small in size but I don&#39;t know much about it."}, {"owner": {"reputation": 2280, "user_id": 1918890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/018e4722f070586f7a475e3942b9aa32?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1918890/praveen"}, "edited": false, "score": 0, "creation_date": 1550480233, "post_id": 54743025, "comment_id": 96269212, "body": "Build the binary and copy it to another image? using Multi-stage builds?"}], "answers": [{"tags": [], "owner": {"reputation": 147, "user_id": 6892582, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wWXpJnaodf8/AAAAAAAAAAI/AAAAAAAAASo/iUT9ySE-cgg/photo.jpg?sz=128", "display_name": "Denis Sedchenko", "link": "https://stackoverflow.com/users/6892582/denis-sedchenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1550483470, "creation_date": 1550483470, "answer_id": 54744452, "question_id": 54743025, "link": "https://stackoverflow.com/questions/54743025/how-to-decrease-the-size-of-docker-image-with-grpc-in-golang-supported/54744452#54744452", "title": "How to decrease the size of docker image with gRPC in golang supported?", "body": "<p>You can try to use <a href=\"https://github.com/GoogleContainerTools/distroless\" rel=\"nofollow noreferrer\">distroless</a> base images and multi-stage builds. That might help you.</p>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 6690245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07d9fc4c5d0b130d8f30584562242a5?s=128&d=identicon&r=PG", "display_name": "freshPrince", "link": "https://stackoverflow.com/users/6690245/freshprince"}, "edited": false, "score": 0, "creation_date": 1550640242, "post_id": 54745664, "comment_id": 96337607, "body": "you&#39;re following this article on a Linux machine, simply replace alpine:3.8 with debian:linux, and you should be good to go"}], "tags": [], "owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "is_accepted": true, "score": 2, "last_activity_date": 1550488431, "last_edit_date": 1550488431, "creation_date": 1550487316, "answer_id": 54745664, "question_id": 54743025, "link": "https://stackoverflow.com/questions/54743025/how-to-decrease-the-size-of-docker-image-with-grpc-in-golang-supported/54745664#54745664", "title": "How to decrease the size of docker image with gRPC in golang supported?", "body": "<p>try to make a multistage docker image like this </p>\n\n<pre><code># Compile stage\nFROM golang:1.11 as build-env\n\nRUN apt-get update &amp;&amp; \\\n    apt-get -y install git unzip build-essential autoconf libtool\n\nRUN git clone https://github.com/google/protobuf.git &amp;&amp; \\\n    cd protobuf &amp;&amp; \\\n    ./autogen.sh &amp;&amp; \\\n    ./configure &amp;&amp; \\\n    make &amp;&amp; \\\n    make install &amp;&amp; \\\n    ldconfig &amp;&amp; \\\n    make clean &amp;&amp; \\\n    cd .. &amp;&amp; \\\n    rm -r protobuf\n\nRUN go get google.golang.org/grpc\n\nRUN go get github.com/golang/protobuf/protoc-gen-go\n\nRUN ls -la\n\nWORKDIR /helloworld\n\nCOPY . /helloworld\n\nRUN protoc -I helloworld/ helloworld/helloworld.proto --go_out=plugins=grpc:helloworld\nRUN go build -o server helloworld/greeter_server/main.go\n\n# Making image\nFROM alpine:3.8 AS host\nRUN apk add --no-cache \\\n        ca-certificates\nCOPY --from=build-env /helloworld/server /\n# copy any other files you need\n\nWORKDIR /\nEXPOSE 8000\nCMD [\"server\"]\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6690245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f07d9fc4c5d0b130d8f30584562242a5?s=128&d=identicon&r=PG", "display_name": "freshPrince", "link": "https://stackoverflow.com/users/6690245/freshprince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 54745664, "answer_count": 2, "score": 3, "last_activity_date": 1550488431, "creation_date": 1550478096, "last_edit_date": 1550480131, "question_id": 54743025, "link": "https://stackoverflow.com/questions/54743025/how-to-decrease-the-size-of-docker-image-with-grpc-in-golang-supported", "title": "How to decrease the size of docker image with gRPC in golang supported?", "body": "<p>I have some server and clients who are communicating using gRPC/golang. Now I want to containerize my application but the size of the docker image containing goland execution and grpc support is larger(more than 1GB). I would like to decrease the size of the docker image. </p>\n\n<p>The required golang version is 1.9 and higher. Here is the Dockerfile script is given. If there is other way please suggest it. </p>\n\n<pre><code>FROM golang:1.11\n\nRUN apt-get update &amp;&amp; \\\n    apt-get -y install git unzip build-essential autoconf libtool\n\nRUN git clone https://github.com/google/protobuf.git &amp;&amp; \\\n    cd protobuf &amp;&amp; \\\n    ./autogen.sh &amp;&amp; \\\n    ./configure &amp;&amp; \\\n    make &amp;&amp; \\\n    make install &amp;&amp; \\\n    ldconfig &amp;&amp; \\\n    make clean &amp;&amp; \\\n    cd .. &amp;&amp; \\\n    rm -r protobuf\n\nRUN go get google.golang.org/grpc\n\nRUN go get github.com/golang/protobuf/protoc-gen-go\n\nRUN ls -la\n\nWORKDIR /helloworld\n\nCOPY . /helloworld\n\nRUN protoc -I helloworld/ helloworld/helloworld.proto --go_out=plugins=grpc:helloworld\n\nCMD [\"go\", \"run\", \"helloworld/greeter_server/main.go\"]\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "mux"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1550460400, "post_id": 54739267, "comment_id": 96262446, "body": "Yes. The <a href=\"https://godoc.org/github.com/gorilla/mux#Router\" rel=\"nofollow noreferrer\">router documentation</a> describes how to use the router on App Engine."}], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 5817748, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_WauPfNYlQ/AAAAAAAAAAI/AAAAAAAAAhY/25dhIN10RXk/photo.jpg?sz=128", "display_name": "Alexander Richey", "link": "https://stackoverflow.com/users/5817748/alexander-richey"}, "is_accepted": false, "score": 0, "last_activity_date": 1550454110, "creation_date": 1550454110, "answer_id": 54739386, "question_id": 54739267, "link": "https://stackoverflow.com/questions/54739267/is-it-possible-to-use-gorilla-mux-router-with-google-appengine-standard-environm/54739386#54739386", "title": "Is it possible to use Gorilla mux router with Google appengine standard environment?", "body": "<p>The source of the problem was my <code>app.yaml</code>. I had</p>\n\n<pre><code>handlers:\n  - url: /api/.*\n    script: _go_app\n</code></pre>\n\n<p>Therefore, in order to match the routes properly, I had to update the paths in mux router to match the full path.</p>\n\n<pre><code>r.HandleFunc(\"/api/\", indexHandler)\n</code></pre>\n"}], "owner": {"reputation": 144, "user_id": 5817748, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4_WauPfNYlQ/AAAAAAAAAAI/AAAAAAAAAhY/25dhIN10RXk/photo.jpg?sz=128", "display_name": "Alexander Richey", "link": "https://stackoverflow.com/users/5817748/alexander-richey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550454110, "creation_date": 1550452650, "question_id": 54739267, "link": "https://stackoverflow.com/questions/54739267/is-it-possible-to-use-gorilla-mux-router-with-google-appengine-standard-environm", "title": "Is it possible to use Gorilla mux router with Google appengine standard environment?", "body": "<p>Is there a way to get <code>appengine.Main()</code> to work with mux router? The following code compiles but does not match any routes.</p>\n\n<pre><code>func main() {\n  r := mux.NewRouter()\n  r.HandleFunc(\"/\", indexHandler)\n  http.Handle(\"/\", r)\n  appengine.Main()\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1550452055, "post_id": 54739049, "comment_id": 96260879, "body": "FWIW implementing HTTP servers is not overly difficult. I&#39;ve done it 4 times in my life, twice for fun, once for a programming language that didn&#39;t have async I/O (Ferite, I implemented async I/O for my employer along with the async networking library) and once for an embedded project. The first time I did it after reading this: <a href=\"https://www.jmarshall.com/easy/http/\" rel=\"nofollow noreferrer\">jmarshall.com/easy/http</a> (the website says updated in 2012 but I&#39;m fairly sure I did it before 2005)"}, {"owner": {"reputation": 33, "user_id": 8292627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d0c1f9e11d3353ad2f97a09ae040b6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cohen", "link": "https://stackoverflow.com/users/8292627/steve-cohen"}, "reply_to_user": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1550455654, "post_id": 54739049, "comment_id": 96261518, "body": "Servers as endpoints are actually considerably easier than implementing transparent servers (proxies) which route requests for outside clients and servers out of your control. This code has been in use for about 18 months and handle most situations quite well. The above describes edge cases which are incredibly subtle and undetected in most implementations."}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1550458510, "post_id": 54739049, "comment_id": 96262078, "body": "Actually I&#39;ve also implemented proxies. I&#39;ve even published one as open source (<a href=\"https://github.com/slebetman/typhos\" rel=\"nofollow noreferrer\">github.com/slebetman/typhos</a>). Proxying is fairly easy. The tedious part is getting things like HTTP multipart right. Admittedly implementing a routing system is hard the first time around"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1550499726, "post_id": 54739049, "comment_id": 96280701, "body": "If you need to handle non-HTTP traffic, you need to go a layer lower than the HTTP server in your application (i.e. to the Transport)."}, {"owner": {"reputation": 33, "user_id": 8292627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d0c1f9e11d3353ad2f97a09ae040b6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cohen", "link": "https://stackoverflow.com/users/8292627/steve-cohen"}, "edited": false, "score": 0, "creation_date": 1550504021, "post_id": 54739049, "comment_id": 96283306, "body": "Sounds good. Can you please post a relevant solution if you have one?"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8292627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d0c1f9e11d3353ad2f97a09ae040b6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cohen", "link": "https://stackoverflow.com/users/8292627/steve-cohen"}, "is_accepted": false, "score": 0, "last_activity_date": 1552581989, "creation_date": 1552581989, "answer_id": 55167947, "question_id": 54739049, "link": "https://stackoverflow.com/questions/54739049/proper-way-to-mux-an-http-server-in-go-that-can-handle-non-http-protocols/55167947#55167947", "title": "Proper way to mux an HTTP server in Go that can handle non-HTTP protocols", "body": "<p>In the interest of helping others, I wanted to answer my question. The approach I suggested above does in fact work and is the proper way to do this. In summary:</p>\n\n<ul>\n<li>Implement ListenAndServe()</li>\n<li>Wrap the incoming net.Conn in a TeeReader or other multiplexed connection wrapper</li>\n<li>Record the request</li>\n<li>Dial the original destination and connect with the inbound connection, replaying the original request if necessary.</li>\n</ul>\n\n<p>A similar use case is required when upgrading connection requests for websockets servers. A nice writeup can be found here:</p>\n\n<p><a href=\"https://medium.freecodecamp.org/million-websockets-and-go-cc58418460bb\" rel=\"nofollow noreferrer\">https://medium.freecodecamp.org/million-websockets-and-go-cc58418460bb</a></p>\n"}], "owner": {"reputation": 33, "user_id": 8292627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43d0c1f9e11d3353ad2f97a09ae040b6?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Cohen", "link": "https://stackoverflow.com/users/8292627/steve-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1552581989, "creation_date": 1550450237, "last_edit_date": 1550451389, "question_id": 54739049, "link": "https://stackoverflow.com/questions/54739049/proper-way-to-mux-an-http-server-in-go-that-can-handle-non-http-protocols", "title": "Proper way to mux an HTTP server in Go that can handle non-HTTP protocols", "body": "<p>I have built a router with extended logging capabilities using Go. It works properly for most use cases. However, it encounters problems when clients send non-standard HTTP messages on port 80. </p>\n\n<p>To date, I have solved this by implementing my own version of ServeHTTP():</p>\n\n<pre><code>func (myproxy *MyProxy) ServeHTTP(w http.ResponseWtier, r *http.Request) {\n\n  // Inspect headers\n  // Determine if it is a custom protocol (ie: websockets, CONNECT requests)\n  // Implement handlers for each time\n} \n</code></pre>\n\n<p>In the event that I determine a request is a non-standard HTTP protocol, the request is played back to the original destination (via http.Request.Write()) and everyone is happy.</p>\n\n<p>At least, most of the time. The problem arises with edge cases. Tivo clients do not send \"Host\" headers and appear to not like all kinds of other  standard things that Go does (such as capitalizing header names). The number of possible variations on this is endless so what I would very much like to do is to buffer the original request - exactly as it was sent to me without any modifications - and replay it back to the original destination server. </p>\n\n<p>I could hack this by re-implementing net.Http.Server, but this seems like an extraordinarily difficult and brittle approach. Would I would prefer to do would be to somehow hook into net/http/http/server.go right around the point where it receives a connection, then wrap that in a spy wrapper that logs the request to a buffer.</p>\n\n<pre><code>func (srv *Server) Serve(l net.Listener) error {\n\n        // Lots of listener code...\n\n    c := srv.newConn(rw)\n    c.setState(c.rwc, StateNew) // before Serve can return\n\n        // I'd like to wrap c here and save the request for possible reply later.\n    go c.serve(ctx)\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/src/net/http/server.go?s=93229:93284#L2805\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/server.go?s=93229:93284#L2805</a></p>\n\n<p>Edit: I have looked at httpUtil:DumpRequest but this slightly modifies the original request (changes case and order of headers). If it didn't do that, it would be an ideal solution.</p>\n\n<p><a href=\"https://godoc.org/net/http/httputil#DumpRequest\" rel=\"nofollow noreferrer\">https://godoc.org/net/http/httputil#DumpRequest</a></p>\n\n<p>Is there a way to hook connections around this point before they are parsed by http.Request?</p>\n"}, {"tags": ["go", "logging"], "comments": [{"owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 3, "creation_date": 1550447768, "post_id": 54738697, "comment_id": 96260113, "body": "So first of all based on your code above you&#39;re trying to set a non-pointer logger with a pointer logger which wont work. Secondly you&#39;re using := when setting dlog which creates a scoped variable in your main method rather than setting your global variable."}, {"owner": {"reputation": 2210, "user_id": 146406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/uQOxY.png?s=128&g=1", "display_name": "Stop Slandering Monica Cellio", "link": "https://stackoverflow.com/users/146406/stop-slandering-monica-cellio"}, "reply_to_user": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550501433, "post_id": 54738697, "comment_id": 96281745, "body": "Thank you, that seemed to fix it! Can you put this in an answer so I can accept it?"}, {"owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "edited": false, "score": 0, "creation_date": 1550513047, "post_id": 54738697, "comment_id": 96287929, "body": "I&#39;ve added it as an answer below"}], "answers": [{"tags": [], "owner": {"reputation": 2312, "user_id": 3254692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/pg8j6.jpg?s=128&g=1", "display_name": "Omar Faroque Anik", "link": "https://stackoverflow.com/users/3254692/omar-faroque-anik"}, "is_accepted": false, "score": -2, "last_activity_date": 1550463397, "creation_date": 1550463397, "answer_id": 54740409, "question_id": 54738697, "link": "https://stackoverflow.com/questions/54738697/how-to-set-and-access-a-global-logger-in-go/54740409#54740409", "title": "How to set and access a &quot;global&quot; logger in Go?", "body": "<p>I tried this:</p>\n\n<pre><code>\nimport (\n    \"fmt\"\n    \"github.com/pkg/errors\"\n    \"log\"\n    \"os\"\n)\n\nconst logfile string = \"killer.log\"\nconst logprefix string = \"LOGTEST: \"\n\nvar DLog *log.Logger\nfunc setupLogger(filename, prefix string) {\n    var err error\n    out, err := os.OpenFile(filename, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)\n    if err != nil {\n        log.Fatal( nil, errors.Wrap(err, \"can't open logfile for writing\"))\n    }\n    DLog=log.New(out, prefix, log.LstdFlags)\n\n    fmt.Println(\"Log object: \",DLog)\n\n}\n\nfunc uselog() error {\n    DLog.Print(\"Hello\") ///// &lt; Here is the issue\n    DLog.Print(\"I have something standard to say\")\n\n    fmt.Println(\"I am done\")\n    return nil\n}\n\nfunc main() {\n    setupLogger(logfile, logprefix)\n    DLog.Printf(\"test from main\")\n    uselog()\n}\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 567, "user_id": 834319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gcFkP.png?s=128&g=1", "display_name": "Benji Vesterby", "link": "https://stackoverflow.com/users/834319/benji-vesterby"}, "is_accepted": true, "score": 1, "last_activity_date": 1550512940, "creation_date": 1550512940, "answer_id": 54752979, "question_id": 54738697, "link": "https://stackoverflow.com/questions/54738697/how-to-set-and-access-a-global-logger-in-go/54752979#54752979", "title": "How to set and access a &quot;global&quot; logger in Go?", "body": "<p>So first of all based on your code above you're trying to set a non-pointer logger with a pointer logger which wont work. Secondly you're using := when setting dlog which creates a scoped variable in your main method rather than setting your global variable</p>\n"}], "owner": {"reputation": 2210, "user_id": 146406, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/uQOxY.png?s=128&g=1", "display_name": "Stop Slandering Monica Cellio", "link": "https://stackoverflow.com/users/146406/stop-slandering-monica-cellio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 54752979, "answer_count": 2, "score": -1, "last_activity_date": 1550512940, "creation_date": 1550446382, "question_id": 54738697, "link": "https://stackoverflow.com/questions/54738697/how-to-set-and-access-a-global-logger-in-go", "title": "How to set and access a &quot;global&quot; logger in Go?", "body": "<p>I am sure there's some simple, fundamental issue I'm missing, I'm very new to go. <strong>How do I set up a logger so it can be shared between functions, assuming I do not want to use the default logger?</strong></p>\n\n<h2><code>logissue.go</code></h2>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"github.com/pkg/errors\"\n  \"log\"\n  \"os\"\n)\n\nvar dlog log.Logger\n\nconst logfile string = \"killer.log\"\nconst logprefix string = \"LOGTEST: \"\n\nfunc setupLogger(filename, prefix string) (*log.Logger, error) {\n  out, err := os.OpenFile(filename, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)\n  if err != nil {\n    return nil, errors.Wrap(err, \"can't open logfile for writing\")\n  }\n  return log.New(out, prefix, log.LstdFlags), nil\n}\n\nfunc uselog() error {\n  fmt.Printf(\"%T\\n\", dlog)\n  dlog.Printf(\"Hello\")            ///// &lt; Here is the issue\n  return nil\n}\n\nfunc main() {\n  dlog, err := setupLogger(logfile, logprefix)\n  if err != nil {\n    fmt.Printf(\"%+v\", err)\n  }\n  dlog.Printf(\"test from main\")\n  uselog()\n}\n</code></pre>\n\n<h2><code>stdout</code></h2>\n\n<pre><code>log.Logger\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x10970b8]\n\ngoroutine 1 [running]:\nlog.(*Logger).Output(0x116dd00, 0x2, 0xc000016106, 0x5, 0x0, 0x0)\n    /usr/local/go/src/log/log.go:172 +0x1e8\nlog.(*Logger).Printf(0x116dd00, 0x10c9202, 0x5, 0x0, 0x0, 0x0)\n    /usr/local/go/src/log/log.go:179 +0x7e\nmain.uselog(0xc000088050, 0x10ca43b)\n    /Users/sequoia/learning/Ex_Files_Go_EssT/Exercise Files/logissue.go:25 +0xc4\nmain.main()\n    /Users/sequoia/learning/Ex_Files_Go_EssT/Exercise Files/logissue.go:35 +0xee\nexit status 2\n</code></pre>\n\n<h2><code>killer.log</code></h2>\n\n<pre><code>LOGTEST: 2019/02/17 18:25:12 test from main\n</code></pre>\n"}, {"tags": ["docker", "go", "docker-compose", "rabbitmq", "restart"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1550446711, "post_id": 54738691, "comment_id": 96259863, "body": "Never ignore errors. Your <code>exec.Command</code> call is wrong"}, {"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1550447431, "post_id": 54738691, "comment_id": 96260043, "body": "I&#39;ve updated the post."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1550449790, "post_id": 54738691, "comment_id": 96260474, "body": "How exactly are you invoking <code>docker-compose</code>?  (Some invocations <a href=\"https://docs.docker.com/compose/compose-file/#restart\" rel=\"nofollow noreferrer\">can cause <code>restart:</code> to be ignored</a>.)"}, {"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1550450539, "post_id": 54738691, "comment_id": 96260601, "body": "@DavidMaze I&#39;m not sure I understand the question. I use <code>docker-compose up --build</code>, and each of my containers is tagged, as you can see above, with <code>restart: always</code>."}, {"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "edited": false, "score": 0, "creation_date": 1550450759, "post_id": 54738691, "comment_id": 96260643, "body": "Ah I see <code>Note: This option is ignored when deploying a stack in swarm mode with a (version 3) Compose file. Use restart_policy instead.</code> I don&#39;t believe this situation applies."}], "answers": [{"comments": [{"owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "edited": false, "score": 0, "creation_date": 1550459513, "post_id": 54739820, "comment_id": 96262253, "body": "Thanks for digging that restart blurb up, very helpful. I think the easiest way to do this will be to test the connection to the rabbit uri at the beginning of main and on an error sleep 10 seconds. Thanks!"}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 5, "last_activity_date": 1550458051, "creation_date": 1550458051, "answer_id": 54739820, "question_id": 54738691, "link": "https://stackoverflow.com/questions/54738691/golang-docker-container-not-restarting-in-docker-compose/54739820#54739820", "title": "Golang Docker Container Not Restarting in Docker-Compose", "body": "<p><a href=\"https://docs.docker.com/config/containers/start-containers-automatically/\" rel=\"noreferrer\">The Docker documentation says:</a></p>\n\n<blockquote>\n  <p>A restart policy only takes effect after a container starts successfully. In this case, starting successfully means that the container is up for at least 10 seconds and Docker has started monitoring it. This prevents a container which does not start at all from going into a restart loop.</p>\n</blockquote>\n\n<p>Since the Go code you show exits basically immediately, it never meets this 10-second-minimum rule.</p>\n\n<p>You can force Go to wait until the process has been alive a minimum of 10 seconds by using <a href=\"https://godoc.org/time#After\" rel=\"noreferrer\">time.After</a> somewhat like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>ch := time.After(10 * time.Second)\ndefer (func() { fmt.Println(\"waiting\"); &lt;-ch; fmt.Println(\"waited\") })()\n</code></pre>\n\n<p>That is, create a channel that will receive an event after 10 seconds, and then actually receive it (immediately if it's happened, waiting if not) before <code>main</code> returns.  From playing with <a href=\"https://play.golang.org/p/zGY5jFWbXyk\" rel=\"noreferrer\">https://play.golang.org/p/zGY5jFWbXyk</a>, the one trick is that there needs to be some observable effect after receiving from the channel or else it doesn't actually wait.</p>\n"}], "owner": {"reputation": 1569, "user_id": 7268968, "user_type": "registered", "accept_rate": 27, "profile_image": "https://graph.facebook.com/10107185465206940/picture?type=large", "display_name": "Peter Weyand", "link": "https://stackoverflow.com/users/7268968/peter-weyand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "accepted_answer_id": 54739820, "answer_count": 1, "score": 1, "last_activity_date": 1550458051, "creation_date": 1550446335, "last_edit_date": 1550447411, "question_id": 54738691, "link": "https://stackoverflow.com/questions/54738691/golang-docker-container-not-restarting-in-docker-compose", "title": "Golang Docker Container Not Restarting in Docker-Compose", "body": "<p>I want to be able to restart a golang docker file on failure to connect to rabbitmq as outined here: (<a href=\"https://stackoverflow.com/questions/31746182/docker-compose-wait-for-container-x-before-starting-y\">Docker Compose wait for container X before starting Y</a> see answer by: svenhornberg).\nUnfortunately my golang container will exit but never restart and I don't know why.</p>\n\n<p>Docker-compose:</p>\n\n<pre><code>version: '3.3'\nservices:\n  mongo:\n    image: 'mongo:3.4.1'\n    container_name: 'datastore'\n    ports:\n      - '27017:27017'\n  rabbitmq:\n    restart: always\n    tty: true\n    image: rabbitmq:3.7-management-alpine\n    hostname: \"rabbit\"\n    ports:\n      - \"15672:15672\" \n      - \"5672:5672\"\n    labels:\n      NAME: \"rabbitmq\"\n    volumes:\n      - ./rabbitmq-isolated.conf:/etc/rabbitmq/rabbitmq.config\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:15672\"]\n      interval: 3s\n      timeout: 5s\n      retries: 20\n  api:\n    restart: always\n    tty: true\n    container_name: 'api'\n    build: '.'\n    working_dir: /go/src/github.com/patientplatypus/project\n    ports:\n      - '8000:8000'\n    volumes:\n      - './:/go/src/github.com/patientplatypus/project'\n      - './uploads:/uploads'\n      - './scripts:/scripts'\n      - './templates:/templates'\n    depends_on:\n      - \"mongo\"\n      - \"rabbitmq\"\n</code></pre>\n\n<p>Docker file: </p>\n\n<pre><code>FROM golang:latest\n\nWORKDIR /go/src/github.com/patientplatypus/project\nCOPY . .\n\nRUN go get github.com/imroc/req\n&lt;...more go gets...&gt;\nRUN go get github.com/joho/godotenv\n\nEXPOSE 8000\n\nENTRYPOINT  [ \"fresh\" ]\n</code></pre>\n\n<p>Here is my golang code: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"os/exec\"\n    \"net/http\"\n)\n\nfunc main() {\n\n    fmt.Println(\"Golang server started\")\n    godotenv.Load()\n    fmt.Println(\"now doing healthcheck on rabbit\")\n    exec.Command(\"docker-compose restart api\")\n    os.Exit(1)\n  &lt;...&gt;\n</code></pre>\n\n<p>And here is my terminal output (golang never restarts after rabbit called):</p>\n\n<pre><code>api         | 23:23:00 app         | Golang server started\napi         | 23:23:00 app         | now doing healthcheck on rabbit\nrabbitmq_1  | \nrabbitmq_1  |   ##  ##\nrabbitmq_1  |   ##  ##      RabbitMQ 3.7.11. Copyright (C) 2007-2019 Pivotal Software, Inc.\nrabbitmq_1  |   ##########  Licensed under the MPL.  See http://www.rabbitmq.com/\nrabbitmq_1  |   ######  ##\nrabbitmq_1  |   ##########  Logs: &lt;stdout&gt;\n&lt;...more rabbit logging...&gt;\n</code></pre>\n\n<p>I'm very confused on how to get this to work. What am I doing wrong?</p>\n\n<p>EDIT: </p>\n\n<p>The <code>exec.Command</code> was incorrectly implemented, however <code>os.Exit(1)</code>, <code>log.Fatal</code>, and <code>log.Panic</code> exit the container, but the container does not restart. Still confused.</p>\n"}, {"tags": ["php", "go", "sha256", "hmac"], "answers": [{"comments": [{"owner": {"reputation": 1997, "user_id": 540771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/lsQwN.jpg?s=128&g=1", "display_name": "Gayan Hewa", "link": "https://stackoverflow.com/users/540771/gayan-hewa"}, "edited": false, "score": 0, "creation_date": 1550443708, "post_id": 54738124, "comment_id": 96259281, "body": "yes this does work, but do you think that strings with &quot;\\n&quot; has any different implication? For an instance I am looking at something like that has &quot;POST\\n/path/to/route\\nsom=strings&quot; because soon as I have a string with \\n character the go hash and php hash doesn&#39;t match"}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "reply_to_user": {"reputation": 1997, "user_id": 540771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/lsQwN.jpg?s=128&g=1", "display_name": "Gayan Hewa", "link": "https://stackoverflow.com/users/540771/gayan-hewa"}, "edited": false, "score": 1, "creation_date": 1550444010, "post_id": 54738124, "comment_id": 96259356, "body": "Recall that, in PHP, <code>&quot;\\n&quot;</code> will produce an actual new line character, where as <code>&#39;\\n&#39;</code> will produce the symbol <code>\\ </code> followed by the symbol <code>n</code> e.g. literally the string <code>\\n</code>.  This will cause a difference in your hashes.  If you want them both to interpret <code>\\n</code> as a new line, use <code>&quot;\\n&quot;</code> in both.  If you want neither of them to interpret the <code>\\n</code> as a new line, and as a literal string, use <code>&#39;\\n&#39;</code> in PHP and <code>`\\n`</code> in Go."}, {"owner": {"reputation": 1997, "user_id": 540771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/lsQwN.jpg?s=128&g=1", "display_name": "Gayan Hewa", "link": "https://stackoverflow.com/users/540771/gayan-hewa"}, "edited": false, "score": 0, "creation_date": 1550444273, "post_id": 54738124, "comment_id": 96259411, "body": "Finally was able to pin down, the query param order was messed up causing the diff. Thanks for pointing in the right direction."}], "tags": [], "owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "is_accepted": true, "score": 2, "last_activity_date": 1550441036, "creation_date": 1550441036, "answer_id": 54738124, "question_id": 54737926, "link": "https://stackoverflow.com/questions/54737926/hmac-hash-mismatch-in-php-and-go/54738124#54738124", "title": "hmac hash mismatch in PHP and Go", "body": "<p>There must be an issue with your input data.</p>\n\n<p>Using the below PHP:</p>\n\n<pre><code>echo hash_hmac('sha256', 'data', 'key');\n</code></pre>\n\n<p>And the below Go:</p>\n\n<pre><code>h := hmac.New(sha256.New, []byte(\"key\"))\nh.Write([]byte(\"data\"))\nsignature := hex.EncodeToString(h.Sum(nil))\nfmt.Println(signature)\n</code></pre>\n\n<p>I get the same result of <code>5031fe3d989c6d1537a013fa6e739da23463fdaec3b70137d828e36ace221bd0</code></p>\n"}], "owner": {"reputation": 1997, "user_id": 540771, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/lsQwN.jpg?s=128&g=1", "display_name": "Gayan Hewa", "link": "https://stackoverflow.com/users/540771/gayan-hewa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 54738124, "answer_count": 1, "score": 2, "last_activity_date": 1594192392, "creation_date": 1550439436, "last_edit_date": 1594192392, "question_id": 54737926, "link": "https://stackoverflow.com/questions/54737926/hmac-hash-mismatch-in-php-and-go", "title": "hmac hash mismatch in PHP and Go", "body": "<p>I am trying to connect to an API that uses an outdated hmac hash authentication mechanism for the API's. </p>\n\n<p>For an instance:</p>\n\n<pre><code>$signature = hash_hmac('sha256', $string_to_sign, $api_sec);\n</code></pre>\n\n<p>vs the one generated in Go:</p>\n\n<pre><code>h := hmac.New(sha256.New, []byte(authSecret))\nh.Write([]byte(stringToSign))\nsignature := hex.EncodeToString(h.Sum(nil))\n</code></pre>\n\n<p>When I use the same <code>stringToSign($string_to_sign)</code> and same <code>authSecret($api_sec)</code> the signature generated with Go results as an invalid  signature for the API. But if I create the same with the PHP function it works fine. I am a bit lost as to where to look. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 4, "last_activity_date": 1550444955, "creation_date": 1550444955, "answer_id": 54738534, "question_id": 54737898, "link": "https://stackoverflow.com/questions/54737898/data-in-memory-to-minimise-database-reads/54738534#54738534", "title": "Data in Memory to minimise database reads?", "body": "<p>You can invoke the <code>mlock</code> syscall (and its kin) in Go, using the <code>syscall</code> package. See <a href=\"https://golang.org/pkg/syscall/#Mlock\" rel=\"nofollow noreferrer\">https://golang.org/pkg/syscall/#Mlock</a>, for example.</p>\n\n<p>That said, with the Go garbage collector that may not be 100% bullet-proof if you need cryptographic safety (e.g. ensure that keys never get to disk). You may want to consider libraries like <a href=\"https://github.com/awnumar/memguard\" rel=\"nofollow noreferrer\">memguard</a> in that case.</p>\n"}], "owner": {"reputation": 1563, "user_id": 1619003, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wKhdR.png?s=128&g=1", "display_name": "GraphicalDot", "link": "https://stackoverflow.com/users/1619003/graphicaldot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "accepted_answer_id": 54738534, "answer_count": 1, "score": 1, "last_activity_date": 1550444955, "creation_date": 1550439254, "question_id": 54737898, "link": "https://stackoverflow.com/questions/54737898/data-in-memory-to-minimise-database-reads", "title": "Data in Memory to minimise database reads?", "body": "<p>How would you structure a program  in Golang to ensure that a piece of data remains in volatile memory and is never cached to disk or swap?</p>\n\n<p>I am trying to implement bloom filter for usernames to minimise disk reads.</p>\n\n<p>With reference to <a href=\"https://stackoverflow.com/questions/14779947/ensuring-secure-data-remains-in-memory\">Ensuring Secure Data Remains in Memory</a>, I am looking for a solution in golang for a different purpose.</p>\n"}, {"tags": ["go", "https", "http-status-code-404"], "comments": [{"owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "edited": false, "score": 0, "creation_date": 1550486331, "post_id": 54737897, "comment_id": 96272634, "body": "windows 10 sometimes has other services running on port 443. try changing the port to 8080 and access it via https protocol eg: <a href=\"https://localhost:8080/hello\" rel=\"nofollow noreferrer\">localhost:8080/hello</a>"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 2989208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0wOpq.jpg?s=128&g=1", "display_name": "VapoRizer", "link": "https://stackoverflow.com/users/2989208/vaporizer"}, "edited": false, "score": 1, "creation_date": 1550500105, "post_id": 54745356, "comment_id": 96280941, "body": "Big thanks to you, @Krishna. I just saw that VMware had a service running on port 443. After closing that, it works. It is just strange to me, that I did not change the settings for VMware and it must have been running there before."}], "tags": [], "owner": {"reputation": 660, "user_id": 4241562, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002353044375/picture?type=large", "display_name": "Krishna Chaitanya Kornepati", "link": "https://stackoverflow.com/users/4241562/krishna-chaitanya-kornepati"}, "is_accepted": true, "score": 2, "last_activity_date": 1550486355, "creation_date": 1550486355, "answer_id": 54745356, "question_id": 54737897, "link": "https://stackoverflow.com/questions/54737897/strange-404-server-error-listenandservetls/54745356#54745356", "title": "Strange 404 server error (ListenAndServeTLS)", "body": "<p>windows 10 sometimes has other services running on port 443. try changing the port to 8080 and access it via https protocol eg: <strong>localhost:8080/hello</strong></p>\n"}], "owner": {"reputation": 311, "user_id": 2989208, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/0wOpq.jpg?s=128&g=1", "display_name": "VapoRizer", "link": "https://stackoverflow.com/users/2989208/vaporizer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 54745356, "answer_count": 1, "score": 0, "last_activity_date": 1550512130, "creation_date": 1550439237, "last_edit_date": 1550512130, "question_id": 54737897, "link": "https://stackoverflow.com/questions/54737897/strange-404-server-error-listenandservetls", "title": "Strange 404 server error (ListenAndServeTLS)", "body": "<p>2 days ago I started to get these 404 errors:</p>\n\n<blockquote>\n  <p>Chrome console: Failed to load resource: the server responded with a\n  status of 404 ()</p>\n</blockquote>\n\n<p>I can run this compiled code on any PC without getting problems except on the PC (Win10) I am developing with. <strong>How can I find the problem source?</strong> I am starting to get really confused and have tried dozens of variations with and without gorilla/mux and others.</p>\n\n<p>This is a simple version of what I am using (I also tried with this of course)</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc HelloServer(w http.ResponseWriter, req *http.Request) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Write([]byte(\"This is an example server.\\n\"))\n}\n\nfunc main() {\n    http.HandleFunc(\"/hello\", HelloServer)\n    err := http.ListenAndServeTLS(\":443\", \"server.crt\", \"server.key\", nil)\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>The certificates are self signed and are imported as trusted root ca. and are also valid until 2029.</p>\n"}, {"tags": ["go", "struct", "casting"], "answers": [{"comments": [{"owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "edited": false, "score": 1, "creation_date": 1550438806, "post_id": 54737693, "comment_id": 96258078, "body": "The <code>Alias</code> trick is really nice! Thanks, this has been bugging me for a while."}], "tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 3, "last_activity_date": 1550437671, "creation_date": 1550437671, "answer_id": 54737693, "question_id": 54737585, "link": "https://stackoverflow.com/questions/54737585/cast-value-from-json-when-unmarshalling-to-struct/54737693#54737693", "title": "Cast value from JSON when unmarshalling to struct", "body": "<p>You can do something very similar to the custom JSON Unmarshal method described here:</p>\n\n<p><a href=\"http://choly.ca/post/go-json-marshalling/\" rel=\"nofollow noreferrer\">http://choly.ca/post/go-json-marshalling/</a></p>\n\n<p>Assuming that the JSON contains a string in your case this would look like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"time\"\n)\n\nconst input = `{\"time\": \"946684799\"}`\n\ntype Delivery struct {\n    Time time.Time `json:\"time\"`\n}\n\nfunc (d *Delivery) UnmarshalJSON(data []byte) error {\n    type Alias Delivery\n    aux := &amp;struct {\n        Time string `json:\"time\"`\n        *Alias\n    }{\n        Alias: (*Alias)(d),\n    }\n    if err := json.Unmarshal(data, &amp;aux); err != nil {\n        return err\n    }\n    i, err := strconv.ParseInt(aux.Time, 10, 64)\n    if err != nil {\n        return err\n    }\n    d.Time = time.Unix(i, 0)\n    return nil\n}\n\nfunc main() {\n    var delivery Delivery\n    err := json.Unmarshal([]byte(input), &amp;delivery)\n    if err != nil {\n        fmt.Println(err.Error())\n        os.Exit(1)\n    }\n    fmt.Println(delivery.Time)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/mdOmUO2EDIR\" rel=\"nofollow noreferrer\">https://play.golang.org/p/mdOmUO2EDIR</a></p>\n"}], "owner": {"reputation": 4331, "user_id": 59991, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fee5ffeec5750ef42697fdfe6e1348c4?s=128&d=identicon&r=PG", "display_name": "Cimm", "link": "https://stackoverflow.com/users/59991/cimm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 54737693, "answer_count": 1, "score": 2, "last_activity_date": 1550437671, "creation_date": 1550436814, "question_id": 54737585, "link": "https://stackoverflow.com/questions/54737585/cast-value-from-json-when-unmarshalling-to-struct", "title": "Cast value from JSON when unmarshalling to struct", "body": "<p>I have this JSON API that returns the delivery date as a UNIX timestamp. I would prefer using <code>Time</code> in the rest of the application. The following works but doesn't <em>feel</em> very Go like.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Delivery struct {\n  Time string `json:\"time\"`\n}\n\nfunc timestampToTime(s string) time.Time {\n  i, _ := strconv.ParseInt(s, 10, 64)\n  returns time.Unix(i, 0)\n}\n\nfmt.Println(timestampToTime(Delivery.Time))\n// 2019-02-17 11:55:00 +0100 CET\n</code></pre>\n\n<p>Is there a way to cast an incoming value in a struct?</p>\n"}, {"tags": ["performance", "go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1550437073, "post_id": 54737553, "comment_id": 96257685, "body": "I don&#39;t think the code needs improvement. How long does it take now and how long do you wish it to take? Have you profiled your program and are you sure this is where bottle-neck is?"}, {"owner": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550464663, "post_id": 54737553, "comment_id": 96263363, "body": "I don&#39;t really need to improve the speed, but in the interest of better understanding go, I wanted to give this a try. I&#39;ve profiled the application and currently most time is spent in readRecord (called by readAll), time.Parse and parseFloat."}], "answers": [{"comments": [{"owner": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "edited": false, "score": 0, "creation_date": 1550490029, "post_id": 54743678, "comment_id": 96274771, "body": "Thanks, I&#39;ll take a look at using os.Open() instead. I actually looked at bufio quickly, but since I still couldn&#39;t find a way to convert the []byte from bufio to float32 or time without going through string, I never went further. But I guess I could combine 1) and 2), and the functions to take a []byte rather than string. Might be a good project for a rainy day ;-) Thanks again, really appreciate your response."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "edited": false, "score": 1, "creation_date": 1550491007, "post_id": 54743678, "comment_id": 96275348, "body": "@Daniel please note that it may harm your future maintenance."}, {"owner": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "edited": false, "score": 0, "creation_date": 1550491200, "post_id": 54743678, "comment_id": 96275471, "body": "Absolutely, this is nothing I would do for a production system. More as a learning experience and to understand what kind of performance gains you could gain from more extreme measures like extracting and modifying internal APIs. The code currently parses ~10GB of data in about 100 seconds, which is more than fast enough."}, {"owner": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "edited": false, "score": 0, "creation_date": 1550561121, "post_id": 54743678, "comment_id": 96302263, "body": "I tried doing this, just for fun. Making parseFloat return a float32 directly did absolutely <i>nothing</i> for the performance. Changing it to accept a []byte instead of string cut the allocations in half, so I guess that might be worth exploring further if you had issues with that. But like you already said; probably not worth the trouble."}], "tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 1, "last_activity_date": 1550480804, "creation_date": 1550480804, "answer_id": 54743678, "question_id": 54737553, "link": "https://stackoverflow.com/questions/54737553/csv-to-date-and-float/54743678#54743678", "title": "CSV to date and float", "body": "<p>There is only one problem I see that needs fix:</p>\n\n<p>Do not use <code>ioutil.ReadFile</code> together with <code>bytes.NewReader</code>. It reads all the contents into the memory, which is inefficient when the file is large.</p>\n\n<p>Instead, use <code>os.Open(file)</code>, it perfectly provides a <code>io.Reader</code> that <code>csv.NewReader</code> can utilize. Do not forget to close the file and handle errors.</p>\n\n<p>If you still want to improve performance:</p>\n\n<ol>\n<li><p>Since your csv file is of fixed format, it is possible to using raw bytes instead provided by <code>bufio</code> instead of <code>csv</code>.</p></li>\n<li><p>You can copy and paste the underlying code in <code>strconv</code> and <code>time</code> to avoid general code that is not of your need.</p></li>\n</ol>\n\n<p>But I think they are not worth the trouble.</p>\n"}], "owner": {"reputation": 1589, "user_id": 591935, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/88818111c4091d9916c3e4e5ea590dbb?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/591935/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 1, "accepted_answer_id": 54743678, "answer_count": 1, "score": 3, "last_activity_date": 1550480804, "creation_date": 1550436521, "last_edit_date": 1550474827, "question_id": 54737553, "link": "https://stackoverflow.com/questions/54737553/csv-to-date-and-float", "title": "CSV to date and float", "body": "<p>I'm currently writing a small program which converts CSV-files into structs to be used for further prosessing. The csv lines look like this</p>\n\n<pre><code>20140102,09:30,38.88,38.88,38.82,38.85,67004\n</code></pre>\n\n<p>I have 500 files, each about 20-30 MB.\nMy code works just fine, but I can't help wondering if there isn't a better way to convert these files than what I'm doing now. \nFirst reading the file and converting to csv records (pseudo code)</p>\n\n<pre><code>    data, err := ioutil.ReadFile(path)\n    if err != nil {\n        ... \n    }\n    r := csv.NewReader(bytes.NewReader(data))\n    records, err := r.ReadAll()\n    if err != nil {\n        ... \n    }\n</code></pre>\n\n<p>Then looping over all the records and doing</p>\n\n<pre><code>    parsedTime, err := time.Parse(\"2006010215:04\", record[0]+record[1])\n    if err != nil {\n        return model.ZorroT6{}, time.Time{}, err\n    }\n\n    t6.Date = ConvertToOle(parsedTime)\n    if open, err := strconv.ParseFloat(record[2], 32); err == nil {\n        t6.Open = float32(open)\n    }\n    if high, err := strconv.ParseFloat(record[3], 32); err == nil {\n        t6.High = float32(high)\n    }\n    if low, err := strconv.ParseFloat(record[4], 32); err == nil {\n        t6.Low = float32(low)\n    }\n    if close, err := strconv.ParseFloat(record[5], 32); err == nil {\n        t6.Close = float32(close)\n    }\n    if vol, err := strconv.ParseInt(record[6], 10,32); err == nil {\n        t6.Vol = int32(vol)\n    }\n</code></pre>\n\n<p>For example I have to go through []byte -> string -> float64 -> float32 to get my float values. What could I do to improve this code?</p>\n\n<p>EDIT: Just to be clear I don't really <em>need</em> to improve the performance, I'm just better trying to understand Go and what performance optimization that could be applied to a problem like this. For example it seems like a lot of overhead to create loads of strings and float64 when I have a byte slice and want a float32.</p>\n"}, {"tags": ["go", "package", "private-methods"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1550438715, "post_id": 54737552, "comment_id": 96258056, "body": "What do you have against &quot;copy-pasting dozens of lines&quot;? You are about to circumvent one of Go&#39;s basic principles, and you&#39;re afraid to duplicate a few hundred lines of code? Believe me, duplicating is easier (and you get portability and backward / forward compatibility for free...)."}], "answers": [{"comments": [{"owner": {"reputation": 7206, "user_id": 153886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3494c51ae32711dc7428334ef1cafa02?s=128&d=identicon&r=PG", "display_name": "Julik", "link": "https://stackoverflow.com/users/153886/julik"}, "edited": false, "score": 0, "creation_date": 1550868517, "post_id": 54738597, "comment_id": 96444602, "body": "Yeah you are right - the way is indeed too gruesome to be applied in the wild. Or rather, it might work for some time on some version but having other people be confrontend with it&#39;s use would be too bad of a gift"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 3, "last_activity_date": 1550445469, "creation_date": 1550445469, "answer_id": 54738597, "question_id": 54737552, "link": "https://stackoverflow.com/questions/54737552/using-unexported-functions-types-from-stdlib-in-go/54738597#54738597", "title": "Using unexported functions/types from stdlib in Go", "body": "<p>There exist (<a href=\"http://www.alangpierce.com/blog/2016/03/17/adventures-in-go-accessing-unexported-functions/\" rel=\"nofollow noreferrer\">rather gruesome</a>) ways of accessing unexported symbols, but it requires nontrivial amounts of tricky code, so there's unlikely to be a net win.</p>\n\n<p>Since you've outruled the \"don't do this\" direction, it seems that the answer is either NO or use the methods described in the post I linked to (<a href=\"https://github.com/alangpierce/go-forceexport\" rel=\"nofollow noreferrer\">and this repo</a>).</p>\n\n<p>FWIW I'd personally just copy the code I need from the standard library and tweak it to my needs. This would likely take less time than the time it took you to write this SO question :-)</p>\n"}], "owner": {"reputation": 7206, "user_id": 153886, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3494c51ae32711dc7428334ef1cafa02?s=128&d=identicon&r=PG", "display_name": "Julik", "link": "https://stackoverflow.com/users/153886/julik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 54738597, "answer_count": 1, "score": -2, "last_activity_date": 1550445469, "creation_date": 1550436520, "question_id": 54737552, "link": "https://stackoverflow.com/questions/54737552/using-unexported-functions-types-from-stdlib-in-go", "title": "Using unexported functions/types from stdlib in Go", "body": "<p><strong>Disclaimer:</strong> yes I know that this is not \"supposed to be done\" and \"use interface composition and delegation\" and \"the authors of the language know better\". However, I am confronted with a choice of either copy-pasting from the standard library and creating my own packages, or doing what I am asking. So please do not reply with \"What you want to do is wrong, you are a bad dev and you should feel bad.\"</p>\n\n<p>So, in Go we have the <code>http</code> stdlib package. This package has a number of functions for dealing with HTTP Range headers and responses (parsers, a struct for \"offset+size\" and so forth). For various reasons I want to use something that is very similar to <code>ServeContent</code> but works a bit differently (long story short - the amount of plumbing needed to do the <code>ReaderAt</code> gymnastics is suboptimal for what I want to accomplish) so I want to parse the HTTP <code>Range</code> header myself, using the utility functions/structs from the <code>http</code> stdlib package and then deal with them manually. Basically, I want a changed version of <code>ServeContent</code> :-)</p>\n\n<p>Is there a way for me to \"reopen\" the <code>http</code> stdlib package to use it's unexported identifiers? ABI is not a concern for me as the source is mine, the program gets compiled from scratch every time etc. etc. and it does not need binary compatibility with older/other Go versions. I.e. I am able to ensure that the build is going to be done on a specific Go version and there are tests to check that an unexported identifier disappeared. So...</p>\n\n<p>If there is a package called <code>foo</code> in the Go standard library, but it only exposes a <code>MagicMegamethod</code> that does the thing I do not need, and uses <code>usefulFunc</code> and <code>usefulStruct</code> that I want to get access to, is there a way for me to get access to those identifiers? Either by reopening the package, or using some other way... that does not involve copy-pasting dozens of lines from stdlib without tests etc.</p>\n"}, {"tags": ["go", "apache-beam"], "comments": [{"owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "edited": false, "score": 0, "creation_date": 1550429904, "post_id": 54736046, "comment_id": 96255555, "body": "Seems to be <a href=\"https://jira.apache.org/jira/browse/BEAM-5381\" rel=\"nofollow noreferrer\">jira.apache.org/jira/browse/BEAM-5381</a> based on list feedback."}, {"owner": {"reputation": 393, "user_id": 3129465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8730f6cd8b8f04ae64d7e262d14310cf?s=128&d=identicon&r=PG&f=1", "display_name": "Brachi", "link": "https://stackoverflow.com/users/3129465/brachi"}, "edited": false, "score": 0, "creation_date": 1550586002, "post_id": 54736046, "comment_id": 96316840, "body": "In Java, you have a parameter for a step name in <code>apply</code> function. for example:  <code>.apply(&quot;build-table-row&quot;,TableRowBuilder.of(....)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "is_accepted": true, "score": 0, "last_activity_date": 1550608045, "creation_date": 1550608045, "answer_id": 54774406, "question_id": 54736046, "link": "https://stackoverflow.com/questions/54736046/step-name-already-exists-error-when-using-dataflow-runner/54774406#54774406", "title": "Step name already exists error when using dataflow runner", "body": "<p>It was a bug actually, sent PR to beam.</p>\n"}], "owner": {"reputation": 9119, "user_id": 180258, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8b3779ca7c73166d7016272086c6282f?s=128&d=identicon&r=PG", "display_name": "ron", "link": "https://stackoverflow.com/users/180258/ron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 54774406, "answer_count": 1, "score": 0, "last_activity_date": 1550608045, "creation_date": 1550426435, "question_id": 54736046, "link": "https://stackoverflow.com/questions/54736046/step-name-already-exists-error-when-using-dataflow-runner", "title": "Step name already exists error when using dataflow runner", "body": "<p>Cross-posting from <a href=\"https://groups.google.com/forum/#!topic/kythe/86kNuSCeorI\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/kythe/86kNuSCeorI</a>, since I was directed here by Beam faq for Beam questions.</p>\n\n<p>In short, I run a job written using the <code>golang</code> sdk successfully using the <code>direct</code> runner, but trying to use the <code>dataflow</code> runner I get the following error in the google cloud console:</p>\n\n<blockquote>\n  <p>2019-02-17 (12:03:53) Step with name e19 already exists. Duplicates\n  are not allowed.</p>\n</blockquote>\n\n<p>I attach the plan that was printed to the stderr at <a href=\"https://pastebin.com/vpu3U52j\" rel=\"nofollow noreferrer\">https://pastebin.com/vpu3U52j</a>. Grepping for e19: <a href=\"https://pastebin.com/L24L1guT\" rel=\"nofollow noreferrer\">https://pastebin.com/L24L1guT</a>.</p>\n\n<p>I'm not very familiar with beam yet. I wonder which part is responsible for generating the step names? What are likely causes of a collision?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["string", "go", "iota"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1550420439, "post_id": 54735113, "comment_id": 96252585, "body": "Not a good idea what you are trying. You should save &quot;Premium&quot; and not 2. Why? Because if you safe 2 and you add a constant to your package maybe 2 will be the value for Free."}, {"owner": {"reputation": 432, "user_id": 3060426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54Rp1.png?s=128&g=1", "display_name": "Mahmudul Haque", "link": "https://stackoverflow.com/users/3060426/mahmudul-haque"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1550420908, "post_id": 54735113, "comment_id": 96252720, "body": "@apxp In <code>user definition table</code> the <code>ID</code> of  <code>Premium</code> user is 2 and I need to save the ID not the value."}], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": false, "score": 1, "last_activity_date": 1550421970, "last_edit_date": 1550421970, "creation_date": 1550420674, "answer_id": 54735183, "question_id": 54735113, "link": "https://stackoverflow.com/questions/54735113/how-to-use-json-string-value-to-get-iota-value/54735183#54735183", "title": "How to use json string value to get iota value?", "body": "<p>Its best to use const string for such Enum use case.</p>\n\n<pre><code>type UserType string\n\nconst(\n  Premium UserType = \"Premium\"\n)\n</code></pre>\n\n<p>OR else define custom marshal/unmasrshal:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype UserType uint\n\nfunc (u UserType) String() string{\n    return \"Premium\"\n}\n\nconst(\n  Premium UserType = 1\n)\n\ntype User struct{\n    T UserType `json:\"type\"`\n}\n\nfunc (u *User) MarshalJSON() ([]byte, error) {\n    return json.Marshal(&amp;struct {\n        T string\n    }{\n        T:    fmt.Sprint(u.T),\n    })\n}\n\nfunc (u *User) UnmarshalJSON(data []byte) error {\n    aux := &amp;struct {\n        T string `json:\"type\"`\n    }{  }\n    if err := json.Unmarshal(data, &amp;aux); err != nil {\n        return err\n    }\n    fmt.Println(aux.T)\n    switch aux.T{\n    case \"Premium\":\n        u.T = Premium\n    }\n    return nil\n}\n\n\nfunc main() {\n    b := []byte(`{\"type\":\"Premium\"}`)\n    x := new(User)\n    if err := json.Unmarshal(b, x); err != nil{\n        fmt.Printf(\"err: %v\\n\", err)\n    }\n    fmt.Printf(\"unmasrshalled: %v\\n\", *x)\n    fmt.Printf(\"type: %d\\n\", x.T)\n    b, _ = json.Marshal(x)\n    fmt.Printf(\"marshalled: %v\\n\", string(b))\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550426179, "post_id": 54735353, "comment_id": 96254300, "body": "I wouldn&#39;t suggest using two maps <code>UserType -&gt; string</code> and <code>string -&gt; UserType</code>. Rather implement only one and have a <code>for</code> loop that extracts key from value. You reduce possible inconsistencies."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "reply_to_user": {"reputation": 2553, "user_id": 5198756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6xLRL.png?s=128&g=1", "display_name": "ifnotak", "link": "https://stackoverflow.com/users/5198756/ifnotak"}, "edited": false, "score": 0, "creation_date": 1550427001, "post_id": 54735353, "comment_id": 96254604, "body": "Yes good point. If there is lots of types i would probably generate in some way. Another solution if there is not hundreds of mappings for a type is to use just one map and iterate when mapping in one of the directions instead. My guess is that it will not be your performance bottleneck."}], "tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1550421847, "creation_date": 1550421847, "answer_id": 54735353, "question_id": 54735113, "link": "https://stackoverflow.com/questions/54735113/how-to-use-json-string-value-to-get-iota-value/54735353#54735353", "title": "How to use json string value to get iota value?", "body": "<p>Don't think there is any built-in way of mapping between <code>iota</code> values and strings. There are some tools that generate code for doing the mapping.</p>\n\n<p>I've been in similar situations and i've done something like this when I didn't want to depend on generators or other tools. Hope it serves as a start for something.</p>\n\n<p><a href=\"https://play.golang.org/p/MxPL-0FVGMt\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MxPL-0FVGMt</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype UserType uint\n\nconst (\n    UserTypeFree UserType = iota\n    UserTypePremium\n)\n\nvar UserTypeToString = map[UserType]string{\n    UserTypeFree:    \"Free\",\n    UserTypePremium: \"Premium\",\n}\n\nvar UserTypeFromString = map[string]UserType{\n    \"Free\":    UserTypeFree,\n    \"Premium\": UserTypePremium,\n}\n\nfunc (ut UserType) String() string {\n    if s, ok := UserTypeToString[ut]; ok {\n        return s\n    }\n    return \"unknown\"\n}\n\nfunc (ut UserType) MarshalJSON() ([]byte, error) {\n    if s, ok := UserTypeToString[ut]; ok {\n        return json.Marshal(s)\n    }\n    return nil, fmt.Errorf(\"unknown user type %d\", ut)\n}\n\nfunc (ut *UserType) UnmarshalJSON(text []byte) error {\n    var s string\n    if err := json.Unmarshal(text, &amp;s); err != nil {\n        return err\n    }\n    var v UserType\n    var ok bool\n    if v, ok = UserTypeFromString[s]; !ok {\n        return fmt.Errorf(\"unknown user type %s\", s)\n    }\n    *ut = v\n    return nil\n}\n\nfunc main() {\n    var ut UserType\n\n    json.Unmarshal([]byte(`\"Free\"`), &amp;ut)\n\n    fmt.Printf(\"%#v %v \\n\", ut, ut)\n\n    b, _ := json.Marshal(ut)\n\n    fmt.Printf(\"%v\\n\", string(b))\n\n}\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 3060426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/54Rp1.png?s=128&g=1", "display_name": "Mahmudul Haque", "link": "https://stackoverflow.com/users/3060426/mahmudul-haque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1399, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1550421970, "creation_date": 1550420199, "question_id": 54735113, "link": "https://stackoverflow.com/questions/54735113/how-to-use-json-string-value-to-get-iota-value", "title": "How to use json string value to get iota value?", "body": "<p>I have a constutil package where I have defined some const values using iota.</p>\n\n<pre><code>package constutil\n\ntype UserType uint\n\nconst (\n    Free UserType = iota + 1\n    Premium UserType\n    ...\n)\n</code></pre>\n\n<p>From <code>json</code> I will get <code>{\"user\": \"Premium\", ...}</code>. Now I need to save the value of the user like for <code>Premium</code> it's <code>2</code>. I tried to get the value like this:</p>\n\n<pre><code>constutil.(req.User)\n</code></pre>\n\n<p>But it didn't work as <code>req.User</code> returns a <code>string</code> like: <code>\"Premium\"</code>.</p>\n\n<p>I can just do it using <code>map[string]uint</code>. But is there any way of doing it using <code>iota</code>?</p>\n"}, {"tags": ["go", "interface", "structure", "implementation"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1550420291, "post_id": 54735079, "comment_id": 96252530, "body": "Depends on... if you just have a OpenGLWindow, there is no need to define a interface and a BaseWindow. Just implement the type OpenGLWindow and write some tests, then you can refactor your app if you would need a QTWindow later."}, {"owner": {"reputation": 11, "user_id": 9476610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GAT0chVgHYg/AAAAAAAAAAI/AAAAAAAAAGU/k2hH-9qGcCI/photo.jpg?sz=128", "display_name": "gjh33", "link": "https://stackoverflow.com/users/9476610/gjh33"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1550420381, "post_id": 54735079, "comment_id": 96252565, "body": "@apxp I require swapping implementations. For example I&#39;d like DirectX Support as well. Ideally my application just interfaces with a common API and properties, but the implementation under the hood can be swapped for DirectX, Metal, OpenGL, etc"}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 2, "creation_date": 1550420839, "post_id": 54735079, "comment_id": 96252704, "body": "In Go the caller should define the interface. So first you should write the function which uses your Window and then you should create the interface. Now you are thinking about the interface first. Now you are thinking about Launch() first. I think you should first implement everything for OpenGLWindow and then abstract everything. I would also remove the BaseWindow type. You can embed the size directly into OpenGLWindow."}, {"owner": {"reputation": 11, "user_id": 9476610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GAT0chVgHYg/AAAAAAAAAAI/AAAAAAAAAGU/k2hH-9qGcCI/photo.jpg?sz=128", "display_name": "gjh33", "link": "https://stackoverflow.com/users/9476610/gjh33"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1550421184, "post_id": 54735079, "comment_id": 96252786, "body": "@apxp thanks for your response. In my actual case BaseWindow type has several fields (4 or 5) and could have more moving forward. Thus why I wanted to put it all into one easily embedable type. That way if that basic structure changes, I don&#39;t have to go to all my specific window types and change the structure for each one. I could instead change the BaseWindow struct. Do you feel I&#39;m still incorrect for doing this?"}], "owner": {"reputation": 11, "user_id": 9476610, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GAT0chVgHYg/AAAAAAAAAAI/AAAAAAAAAGU/k2hH-9qGcCI/photo.jpg?sz=128", "display_name": "gjh33", "link": "https://stackoverflow.com/users/9476610/gjh33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550419973, "creation_date": 1550419973, "question_id": 54735079, "link": "https://stackoverflow.com/questions/54735079/what-is-the-correct-go-way-for-having-a-type-that-has-required-members-and-int", "title": "What is the correct &quot;Go way&quot; for having a type that has required members and interface?", "body": "<p>An issue I came across designing a Window that is platform independent for a graphics software. I require each window implements a Launch() function, and has a size.</p>\n\n<p>My current solution is a struct called BaseWindow that has Size embedded and an interface called Window with Launch() and GetSize(). An OpenGLWindow for example will then embed BaseWindow and implement Launch() using openGL calls. I feel this isn't correct because of a few code smells.\nA) I don't like it having to be called GetSize(). But if I call it Size() it conflicts with the Size field of the embedded size struct in BaseWindow.\nB) Interfaces should be implementation independent, but these getters are pretty close to forcing implementation.</p>\n\n<p>I would like in the end to have a single type Window to pass around and use without worrying about the implementation of which platform it's on.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>// What I have\ntype Size struct {\n  Width int\n  Height int\n}\n\n// What I would like to be my type that I use to access these functions/members\ntype Window interface {\n  GetSize() Size\n  Launch() error\n}\n\n// This would have more things in the final application, but for simplicity\n// I only included Size\ntype BaseWindow struct {\n  Size\n}\n\n// Example of what I want my end result to look like\ntype OpenGLWindow {\n  BaseWindow\n}\n\nfunc (window OpenGLWindow) Launch() {\n  // Do stuff\n}\n\n// Notice Window returns size of BaseWindow and uses Launch of OpenGLWindow\nfunc SetGlobalWin(window Window) {\n  GlobalWin = window\n  CirclePositionX = window.GetSize().Width / 2\n  window.Launch()\n}\n\n// If using openGL, open openGL window and use that as primary window\nfunc UseMyWindow() {\n  glwin := NewOpenGLWindow()\n  SetGlobalWin(glwin)\n}\n</code></pre>\n\n<p>While this approach works, it doesn't seem like a good solution for reasons stated above. I have a feeling I'm trying too hard to make Launch() act like a virtual function from oop and am missing some fundamental design patterns for Go's more composition based approach.</p>\n"}, {"tags": ["go", "timestamp"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1550432975, "post_id": 54735063, "comment_id": 96256490, "body": "A good rule of thumb is: Always consult the package documentation first and read it in full."}], "answers": [{"tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": false, "score": 2, "last_activity_date": 1550420916, "last_edit_date": 1550420916, "creation_date": 1550420232, "answer_id": 54735120, "question_id": 54735063, "link": "https://stackoverflow.com/questions/54735063/what-is-the-m-in-timestamp-and-how-to-get-timestamp-without-m/54735120#54735120", "title": "What is the &quot;m&quot; in timestamp and how to get timestamp without &quot;m&quot;?", "body": "<p>All you need is:</p>\n\n<pre><code>    time.Now().Truncate(0)\n</code></pre>\n\n<p>According to doc on time.String()</p>\n\n<blockquote>\n  <p>If the time has a monotonic clock reading, the returned string includes a final field \"m=\u00b1\", where value is the monotonic clock reading formatted as a decimal number of seconds.</p>\n</blockquote>\n\n<p>And time.Truncate() godoc says:</p>\n\n<blockquote>\n  <p>Truncate returns the result of rounding t down to a multiple of d (since the zero time). If d &lt;= 0, Truncate returns t stripped of any monotonic clock reading but otherwise unchanged.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1550426421, "last_edit_date": 1550426421, "creation_date": 1550420676, "answer_id": 54735184, "question_id": 54735063, "link": "https://stackoverflow.com/questions/54735063/what-is-the-m-in-timestamp-and-how-to-get-timestamp-without-m/54735184#54735184", "title": "What is the &quot;m&quot; in timestamp and how to get timestamp without &quot;m&quot;?", "body": "<blockquote>\n  <p>i need output like this => 2009-11-10 23:00:00 +0000 UTC</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"noreferrer\">Package time</a></p>\n  \n  <p>import \"time\"</p>\n  \n  <p>Monotonic Clocks</p>\n  \n  <p>Operating systems provide both a \u201cwall clock,\u201d which is subject to\n  changes for clock synchronization, and a \u201cmonotonic clock,\u201d which is\n  not. The general rule is that the wall clock is for telling time and\n  the monotonic clock is for measuring time. Rather than split the API,\n  in this package the Time returned by time.Now contains both a wall\n  clock reading and a monotonic clock reading; later time-telling\n  operations use the wall clock reading, but later time-measuring\n  operations, specifically comparisons and subtractions, use the\n  monotonic clock reading.</p>\n  \n  <p>The canonical way to strip a monotonic clock reading is to use t =\n  t.Round(0).</p>\n  \n  <p><a href=\"https://golang.org/pkg/time/#Time.Round\" rel=\"noreferrer\">func (Time) Round</a> 1.1</p>\n\n<pre><code>func (t Time) Round(d Duration) Time\n</code></pre>\n  \n  <p>Round returns the result of rounding t to the nearest multiple of d\n  (since the zero time). The rounding behavior for halfway values is to\n  round up. If d &lt;= 0, Round returns t stripped of any monotonic clock\n  reading but otherwise unchanged.</p>\n  \n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"noreferrer\">func (Time) String</a></p>\n\n<pre><code>func (t Time) String() string\n</code></pre>\n  \n  <p>String returns the time formatted using the format string</p>\n  \n  <p>If the time has a monotonic clock reading, the returned string\n  includes a final field \"m=\u00b1\", where value is the monotonic\n  clock reading formatted as a decimal number of seconds.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>The canonical way to strip a monotonic clock reading is to use\n  <code>t = t.Round(0)</code>.</p>\n</blockquote>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t := time.Now()\n    fmt.Println(t)\n    fmt.Println(t.Round(0))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/nglDbs9IGdU\" rel=\"noreferrer\">https://play.golang.org/p/nglDbs9IGdU</a></p>\n\n<p>Output:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC m=+0.000000001\n2009-11-10 23:00:00 +0000 UTC\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9022576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11d19a53c096b368018c7226883b86b?s=128&d=identicon&r=PG&f=1", "display_name": "Arvindh", "link": "https://stackoverflow.com/users/9022576/arvindh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1156, "favorite_count": 1, "accepted_answer_id": 54735184, "answer_count": 2, "score": 2, "last_activity_date": 1550426421, "creation_date": 1550419853, "question_id": 54735063, "link": "https://stackoverflow.com/questions/54735063/what-is-the-m-in-timestamp-and-how-to-get-timestamp-without-m", "title": "What is the &quot;m&quot; in timestamp and how to get timestamp without &quot;m&quot;?", "body": "<p>In Go , for time.Now() getting timestamp trailing with <strong>m=xx.xxxx...</strong>, what does that <strong>m</strong> means? </p>\n\n<p>How to remove it while printing or Is there any other ways or function to get timestamp without <strong>m</strong></p>\n\n<p>For Example:- for time.Now() getting output =>  2009-11-10 23:00:00 +0000 UTC <strong>m=+0.000000001</strong></p>\n\n<p>But i need output like this => 2009-11-10 23:00:00 +0000 UTC</p>\n"}, {"tags": ["go", "compiler-optimization"], "answers": [{"comments": [{"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550414450, "post_id": 54734212, "comment_id": 96250893, "body": "When does it compile the transitive dependencies to generate their object files?"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550414952, "post_id": 54734212, "comment_id": 96251030, "body": "@SauravPrakash: these dependencies are discovered because there&#39;s an <code>import</code> to them from somewhere, so they are added to the build, and so on..."}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550415055, "post_id": 54734212, "comment_id": 96251059, "body": "doesnt that again mean compiling the whole tree eventually?"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550415196, "post_id": 54734212, "comment_id": 96251099, "body": "@SauravPrakash: yes, absolutely, unless it has already been compiled. Obviously, if you program depends on <code>A</code> and <code>A</code> depends on <code>B</code>, you will need <code>B</code> in your final binary, there&#39;s no other way around it! But you don&#39;t need <code>B</code> to compile and type-check &#39;main` itself, you only need it to compile and type-check <code>A</code>. Since most dependencies are cached and don&#39;t change, in a regular edit-compile cycle you usually compile just one package, which is why Go builds are so fast"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1550453954, "post_id": 54734212, "comment_id": 96261206, "body": "If you <i>absolutely</i> need to import a package in order to like get its initializer to run and nothing else is going to import it you can do something like: import _ &quot;github.com/jwells131313/dargo/ioc&quot;"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1550413702, "creation_date": 1550413702, "answer_id": 54734212, "question_id": 54734046, "link": "https://stackoverflow.com/questions/54734046/why-go-compiler-needs-to-only-include-the-packages-that-you-are-importing-direct/54734212#54734212", "title": "Why Go compiler needs to only include the packages that you are importing directly?", "body": "<p>The Go compiler first compiles a single package into a single object file. At this stage, it only needs to resolve all the <code>import</code>s it finds in the package it compiles. For the object file of your package, there are only calls to the same package or direct imports, so there's no issue here. A separate linking stage links all object files together. There's a decent explanation of this in the <a href=\"https://golang.org/cmd/compile/\" rel=\"nofollow noreferrer\">doc of the compile package</a>:</p>\n\n<blockquote>\n  <p>Compile, typically invoked as \u201cgo tool compile,\u201d compiles a single Go\n  package comprising the files named on the command line. It then writes\n  a single object file named for the basename of the first source file\n  with a .o suffix. The object file can then be combined with other\n  objects into a package archive or passed directly to the linker (\u201cgo\n  tool link\u201d). If invoked with -pack, the compiler writes an archive\n  directly, bypassing the intermediate object file.</p>\n  \n  <p>The generated files contain type information about the symbols\n  exported by the package and about types used by symbols imported by\n  the package from other packages. It is therefore not necessary when\n  compiling client C of package P to read the files of P's dependencies,\n  only the compiled output of P.</p>\n</blockquote>\n"}], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54734212, "answer_count": 1, "score": 2, "last_activity_date": 1550413702, "creation_date": 1550412289, "question_id": 54734046, "link": "https://stackoverflow.com/questions/54734046/why-go-compiler-needs-to-only-include-the-packages-that-you-are-importing-direct", "title": "Why Go compiler needs to only include the packages that you are importing directly?", "body": "<p>I have been using Go and have read at some places that Go compiler needs to only include the packages that you are importing directly from <code>main</code>.<br>\nAs a result, the time it takes to resolve dependency is linear as compared to C++ where its exponential.\nHow does that work?<br>\nIf <code>main</code> imports package <code>alpha</code> which in turn imports package <code>beta</code> then wouldn't Go compiler need to compile the whole tree?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1550409894, "post_id": 54733648, "comment_id": 96249829, "body": "<a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Exported_identifiers</a>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1550410085, "post_id": 54733648, "comment_id": 96249872, "body": "Not related to the issue but I would suggest you read this <a href=\"https://blog.golang.org/package-names\" rel=\"nofollow noreferrer\">blog.golang.org/package-names</a>, in case you care about such things."}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 8296461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee2fcc9ebbee078c749f33fbb1bf795?s=128&d=identicon&r=PG&f=1", "display_name": "Sumukha Pk", "link": "https://stackoverflow.com/users/8296461/sumukha-pk"}, "edited": false, "score": 0, "creation_date": 1550460238, "post_id": 54734258, "comment_id": 96262411, "body": "I understood why 1.But why 2?"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 114, "user_id": 8296461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee2fcc9ebbee078c749f33fbb1bf795?s=128&d=identicon&r=PG&f=1", "display_name": "Sumukha Pk", "link": "https://stackoverflow.com/users/8296461/sumukha-pk"}, "edited": false, "score": 1, "creation_date": 1550500339, "post_id": 54734258, "comment_id": 96281073, "body": "@SumukhaPk: it&#39;s a convention. Breaking it makes your code immediately feel &quot;strange&quot; and unfamiliar"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 3, "last_activity_date": 1550413993, "creation_date": 1550413993, "answer_id": 54734258, "question_id": 54733648, "link": "https://stackoverflow.com/questions/54733648/accessing-variables-of-a-struct-from-another-nested-structs-variable-in-go/54734258#54734258", "title": "Accessing variables of a struct from another nested structs variable in Go", "body": "<p>There are some issues here:</p>\n\n<ol>\n<li>The fields of both your structs are not exported outside the package that contains them, because they begin with a lowercase letter. If you want to access fields outside of the package, they have to start with an uppercase letter.</li>\n<li>Name your packages in lowercase, like <code>dnsheader</code>, not <code>DNSHeader</code>.</li>\n</ol>\n\n<p>Read the spec on <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">exported names</a> and Effective Go on <a href=\"https://golang.org/doc/effective_go.html#package-names\" rel=\"nofollow noreferrer\">package names</a></p>\n"}], "owner": {"reputation": 114, "user_id": 8296461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee2fcc9ebbee078c749f33fbb1bf795?s=128&d=identicon&r=PG&f=1", "display_name": "Sumukha Pk", "link": "https://stackoverflow.com/users/8296461/sumukha-pk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 54734258, "answer_count": 1, "score": -2, "last_activity_date": 1550413993, "creation_date": 1550409314, "question_id": 54733648, "link": "https://stackoverflow.com/questions/54733648/accessing-variables-of-a-struct-from-another-nested-structs-variable-in-go", "title": "Accessing variables of a struct from another nested structs variable in Go", "body": "<p>Given are 2 structs I wrote.</p>\n\n<pre><code>type DNSPacket struct {\n    header      DNSHeader.DNSHeader\n    questions   []DNSQuestion.DNSQuestion\n    answers     []DNSRecord.DNSRecord\n    authorities []DNSRecord.DNSRecord\n    resources   []DNSRecord.DNSRecord\n}\n</code></pre>\n\n<pre><code>type DNSHeader struct {\n    id uint16 //16bits\n\n    recursion_desired    bool  // 1 bit\n    truncated_message    bool  // 1 bit\n    authoritative_answer bool  // 1 bit\n    opcode               uint8 // 4 bits\n    response             bool  // 1 bit\n\n    rescode             ResultCode // 4 bits\n    checking_disabled   bool       // 1 bit\n    authed_data         bool       // 1 bit\n    z                   bool       // 1 bit\n    recursion_available bool       // 1 bit\n\n    questions             uint16 // 16 bits\n    answers               uint16 // 16 bits\n    authoritative_entries uint16 // 16 bits\n    resource_entries      uint16 // 16 bits\n} // total 96 bits\n</code></pre>\n\n<p>Now, when I call <code>results.header.questions</code> where results is a type DNSPacket variable I get a <code>[go] result.header.questions undefined (cannot refer to unexported field or method questions)</code> error.</p>\n\n<p>What am I doing wrong? Is there a workaround?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["google-app-engine", "go", "go-build"], "answers": [{"tags": [], "owner": {"reputation": 351, "user_id": 500442, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4d20ddb73bc3045e7236b78f270c7fd?s=128&d=identicon&r=PG", "display_name": "avivl", "link": "https://stackoverflow.com/users/500442/avivl"}, "is_accepted": false, "score": 0, "last_activity_date": 1550562313, "creation_date": 1550562313, "answer_id": 54761068, "question_id": 54733641, "link": "https://stackoverflow.com/questions/54733641/how-to-pass-ldflags-to-gae-build/54761068#54761068", "title": "How to pass -ldflags to GAE build?", "body": "<p>You can't do it with you app.yaml file.\nHowever, you can use <a href=\"https://cloud.google.com/source-repositories/docs/quickstart-triggering-builds-with-source-repositories\" rel=\"nofollow noreferrer\">Cloud build</a> to build and deploy your app to App Engine.\nIn your cloudbuild.yaml you can add a line to the build step</p>\n\n<pre><code>args: ['build', '-a', '-installsuffix', 'cgo', '-ldflags', '''-w''', '-o', 'main', './main.go']\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 2253858, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/9HsDN.jpg?s=128&g=1", "display_name": "Andy Fusniak", "link": "https://stackoverflow.com/users/2253858/andy-fusniak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550562313, "creation_date": 1550409272, "question_id": 54733641, "link": "https://stackoverflow.com/questions/54733641/how-to-pass-ldflags-to-gae-build", "title": "How to pass -ldflags to GAE build?", "body": "<p>I have an HTTP service written in Go. Inside <code>main.go</code> I have a global <code>version</code> string.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nvar version string\n\n</code></pre>\n\n<p>Locally, I build using <code>-ldflags \"-X main.version=$VERSION</code> where <code>$VERSION</code> is determined by the shell environment, like so:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>VERSION=v0.16.0 go build ./cmd/app -ldflags \"-X main.version=$VERSION\n</code></pre>\n\n<p>I've recently decided to trial Google App Engine and started with a basic YAML file:</p>\n\n<pre><code>runtime: go111\n\nhandlers:\n- url: /.*\n  script: auto\n</code></pre>\n\n<p>What can I set in the YAML file in order to instruct GAE to build with the equivalent ldflags to bake in my version string? </p>\n\n<p>I should also mention I use go modules with <code>GO111MODULE=on</code> locally when building.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550407940, "post_id": 54733310, "comment_id": 96249225, "body": "When you talk about <code>better</code> do you mean better in terms of Time/Space Complexity OR better in terms of readability?"}, {"owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550408248, "post_id": 54733310, "comment_id": 96249325, "body": "In terms of readability and working method/solution @SauravPrakash"}, {"owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 1, "creation_date": 1550408694, "post_id": 54733310, "comment_id": 96249447, "body": "How is   ` [21, 2000000, 18, 18, 19, 20, 20], [20, 21, 18, 20, 18, 20, 1900000]. ` in sorted order?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1550408724, "post_id": 54733310, "comment_id": 96249463, "body": "I suggest you provide the link of orignal question, and read the question more carefully (or use a more capable translator). Your code does not make sense with the question description."}, {"owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550408938, "post_id": 54733310, "comment_id": 96249540, "body": "That&#39;s the only question provided. Start from the &quot;Sudu is a ... until 1900000] &quot; no other details @leafbebop"}, {"owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "reply_to_user": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "edited": false, "score": 0, "creation_date": 1550409067, "post_id": 54733310, "comment_id": 96249584, "body": "yeah.. i got confuse with that to be honest on how [21, 2000000, 18, 18, 19, 20, 20 ] is in sorted order. but these were provided by the questionnaire. isn&#39;t 21 suppose to be at the back? But no idea about this. @SauravPrakash"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550409227, "post_id": 54733310, "comment_id": 96249633, "body": "So what exactly is a <code>mangkuk</code>? And why are you sorting the string <code>&quot;MakeCawan&quot;</code>?"}, {"owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550409334, "post_id": 54733310, "comment_id": 96249671, "body": "oh yes, mangkuk is a list consisting of maximal size Sudu. @leafbebop"}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1550410411, "post_id": 54733705, "comment_id": 96249948, "body": "No, it does not solve the problem. Even sample input fails."}, {"owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "edited": false, "score": 1, "creation_date": 1550410507, "post_id": 54733705, "comment_id": 96249964, "body": "Thank you Saurav for the help. Just about the [21, 2000000, 18, 20, 18, 20, 19], it is less possibility to get into [21, 2000000, 18, 18, 19, 20, 20] since it is suppose to be in ascending order. Don&#39;t know how the questionnaire can be like that.. but thank you Saurav. :)"}], "tags": [], "owner": {"reputation": 1627, "user_id": 4007003, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0a1eb5a369aae01bcd84544bf749d2d7?s=128&d=identicon&r=PG&f=1", "display_name": "Saurav Prakash", "link": "https://stackoverflow.com/users/4007003/saurav-prakash"}, "is_accepted": false, "score": -1, "last_activity_date": 1550410934, "last_edit_date": 1550410934, "creation_date": 1550409807, "answer_id": 54733705, "question_id": 54733310, "link": "https://stackoverflow.com/questions/54733310/golang-ascending-order/54733705#54733705", "title": "Golang ascending order", "body": "<p>Answering this question assuming you want to sort a slice of int which are consecutive and repetitive.</p>\n\n<p>Simply sorting the slice is a readable solution but would take O(nlgn) using a comparsion based sorting algorithm for a slice of length n.</p>\n\n<p>We can use a better performin algorithm with O(n) auxillary space.\nAlgorithm:<br>\n 1. Iterate over array A and find min and max in.<br>\n 2. Create an array B with length max-min+1.<br>\n 3. Iterate over A and store count of each element in B\ni.e <code>B[A[i] - min]++</code> .<br>\n 4. Now iterate over B and print  <code>i + min</code>, B[i] times.   </p>\n\n<p>Time Complexity - O(n)</p>\n\n<p><a href=\"https://play.golang.org/p/rptgMpWdKCX\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rptgMpWdKCX</a></p>\n\n<p>Note that this loop is also O(n) where n is length of actual input array.</p>\n\n<pre><code>for i:=0;i&lt;len(b);i++{\n        for b[i] != 0{\n            fmt.Printf(\"%v \", i + min)\n            b[i]--\n        }\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 0, "last_activity_date": 1550411989, "creation_date": 1550411989, "answer_id": 54733995, "question_id": 54733310, "link": "https://stackoverflow.com/questions/54733310/golang-ascending-order/54733995#54733995", "title": "Golang ascending order", "body": "<p>The problem is a little bit tricky: It does not ask you to sort the whole slice (or mangkuk in its own term); it asks you to first recognize all successive intervals (with possible repeated elements) which is called sudu, and then sort each sudu.</p>\n\n<pre><code>func makeCawan(mangkuk []int) []int {\n    for now, n := 0, len(mangkuk); now &lt; n; {\n        min := mangkuk[now]\n        max := min\n        head := now\n    loop:\n        for now++; now &lt; n; now++ {\n            switch x := mangkuk[now]; {\n            case x &lt; min-1 || x &gt; max+1:\n                sort(mangkuk[head:now], min, max)\n                break loop\n            case x == min-1:\n                min = x\n            case x == max+1:\n                max = x\n            }\n        }\n        if now &gt;= n {\n            sort(mangkuk[head:now], min, max)\n        }\n    }\n\n    return mangkuk\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/z3TGWnWnrVY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/z3TGWnWnrVY</a></p>\n"}], "owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 54733995, "answer_count": 2, "score": -5, "last_activity_date": 1550411989, "creation_date": 1550407062, "last_edit_date": 1550409361, "question_id": 54733310, "link": "https://stackoverflow.com/questions/54733310/golang-ascending-order", "title": "Golang ascending order", "body": "<p>I have a Go Language question here, is there any much better way to answer the answer in coding Golang compare to mine below? </p>\n\n<p>Mangkuk is a list consisting of maximal size Sudu.\nSudu is a permutation of consecutive integers, possibly with repeated items.</p>\n\n<p>A Cawan is a Mangkuk where each Sudu is sorted in the ascending order.\nWrite a function, MakeCawan(\u2192Mangkuk), to sort the given Mangkuk into a Cawan.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>For example,\r\nMakeCawan([21, 20, 18, 20, 18, 20, 19]),\r\nMakeCawan([21, 2000000, 18, 20, 18, 20, 19]),\r\nMakeCawan([21, 20, 18, 20, 18, 20, 1900000])\r\nshould produce, respectively,\r\n[18, 18, 19, 20, 20, 20, 21],\r\n[21, 2000000, 18, 18, 19, 20, 20],\r\n[20, 21, 18, 20, 18, 20, 1900000].</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package main\r\n\r\n    import (\r\n    \t\"fmt\"\r\n    \t\"sort\"\r\n    )\r\n\r\n    func main() {\r\n    \tsl := []string{\"MakeCawan\"}\r\n    \tsort.Sort(sort.StringSlice(sl))\r\n    \tfmt.Println(sl)\r\n    \t\r\n    \tsl1 := []string{\"MakeCawan\"}\r\n    \tsort.Sort(sort.StringSlice(sl1))\r\n    \tfmt.Println(sl1)\r\n    \t\r\n    \tsl2 := []string{\"MakeCawan\"}\r\n    \tsort.Sort(sort.StringSlice(sl2))\r\n    \tfmt.Println(sl2)\r\n    \t\r\n    \tintSlice := []int{21,20,18,20,18,20,19}\r\n    \tsort.Sort(sort.IntSlice(intSlice))\r\n    \tfmt.Println(intSlice)\r\n\r\n    }</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>The Output: </p>\n\n<p><a href=\"https://play.golang.org/p/tsE0BtMRos_9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tsE0BtMRos_9</a></p>\n"}, {"tags": ["session", "go", "global-variables"], "comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 1, "creation_date": 1550405925, "post_id": 54733019, "comment_id": 96248754, "body": "Wouldn&#39;t it be better to inject these parameters into the objects/function who need it instead of trying to create something &quot;global&quot; or &quot;static&quot;?"}, {"owner": {"reputation": 2016, "user_id": 519521, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ychhs.jpg?s=128&g=1", "display_name": "SmootQ", "link": "https://stackoverflow.com/users/519521/smootq"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550406056, "post_id": 54733019, "comment_id": 96248787, "body": "you mean, return session, and call InitSession everytime I want it? ... the problem is that I want to call InitSession only once (in the main function)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1550406655, "post_id": 54733019, "comment_id": 96248926, "body": "Use <code>var Session *sessions.Session</code> at the package level, then at the bottom of your <code>initSession</code> do <code>Session = session</code>."}, {"owner": {"reputation": 2016, "user_id": 519521, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ychhs.jpg?s=128&g=1", "display_name": "SmootQ", "link": "https://stackoverflow.com/users/519521/smootq"}, "edited": false, "score": 0, "creation_date": 1550406700, "post_id": 54733019, "comment_id": 96248932, "body": "Thank you so much mkopriva , I will check it out, meanwhile, add your comment as an answer to the question. Best"}, {"owner": {"reputation": 2016, "user_id": 519521, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ychhs.jpg?s=128&g=1", "display_name": "SmootQ", "link": "https://stackoverflow.com/users/519521/smootq"}, "edited": false, "score": 0, "creation_date": 1550406900, "post_id": 54733019, "comment_id": 96248988, "body": "it worked ! thank you so much, that&#39;s what I was looking for <code>*sessions.Session</code> , thanks again .. please add it as an answer so that I can accept it as a best answer."}], "owner": {"reputation": 2016, "user_id": 519521, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ychhs.jpg?s=128&g=1", "display_name": "SmootQ", "link": "https://stackoverflow.com/users/519521/smootq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550405078, "creation_date": 1550404759, "last_edit_date": 1550405078, "question_id": 54733019, "link": "https://stackoverflow.com/questions/54733019/how-to-declare-session-variable-as-global-in-golang", "title": "How to declare session variable as global in Golang", "body": "<p>I do not want to repeat this code every time I want to create a session : </p>\n\n<pre><code> var shash, _ = bcrypt.GenerateFromPassword([]byte(os.Getenv(\"SESSION_KEY\")), bcrypt.DefaultCost)\nvar store = sessions.NewCookieStore(shash)\nsession, serr := store.Get(r, \"session-name\")\nif serr != nil {\n    ....\n}\n</code></pre>\n\n<p>So, I created a function in a file <code>inc/inc.go</code> in package <code>inc</code> : </p>\n\n<pre><code>func initSession(r *http.Request){\n    var shash, _ = bcrypt.GenerateFromPassword([]byte(os.Getenv(\"SESSION_KEY\")), bcrypt.DefaultCost)\n    var store = sessions.NewCookieStore(shash)\n    session, serr := store.Get(r, \"session-name\")\n    if serr != nil {\n        log.Fatal(serr)\n        return\n    }\n}\n</code></pre>\n\n<p>The function <code>initSession</code> initializes the session object.</p>\n\n<p>There are also global variables in the file <code>inc.go</code>, example :</p>\n\n<pre><code>var DbName string = \"dbname\"\nvar DbUser string = \"user\"\nvar DbPass string = \"pass\"\nvar DbHost string =\"localhost\"\n</code></pre>\n\n<p>So that I can access these variables from any file that imports package <code>inc</code>.</p>\n\n<p>My problem is that I do not know how to make <code>session</code> in the function initSession global like the other variables? so that I can access it using <code>inc.Session</code> ?</p>\n\n<p>Also, how do I declare the variable with <code>var Session type</code> , given that I am using package <code>github.com/gorilla/sessions</code>, what should I replace <code>type</code> with?</p>\n"}, {"tags": ["python", "go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550395371, "post_id": 54731031, "comment_id": 96246381, "body": "Which package/helper are you using to bridge Python and Go?"}, {"owner": {"reputation": 1, "user_id": 11073832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V7gOi6BgAx4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzw0KuInm-hM5v-t6vT0leDai_nw/mo/photo.jpg?sz=128", "display_name": "beegee", "link": "https://stackoverflow.com/users/11073832/beegee"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550408775, "post_id": 54731031, "comment_id": 96249486, "body": "<code>ctypes</code> Trying to create a GoSlice struct from, say , [&quot;a&quot;, &quot;b&quot;] or (&quot;a&quot;, &quot;b&quot;)   <code>class GoSlice(Structure):     _fields_ = [(&quot;data&quot;, POINTER(c_void_p)), (&quot;len&quot;, c_longlong), (&quot;cap&quot;, c_longlong)]</code>"}], "owner": {"reputation": 1, "user_id": 11073832, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-V7gOi6BgAx4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQMzw0KuInm-hM5v-t6vT0leDai_nw/mo/photo.jpg?sz=128", "display_name": "beegee", "link": "https://stackoverflow.com/users/11073832/beegee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550387905, "creation_date": 1550387905, "question_id": 54731031, "link": "https://stackoverflow.com/questions/54731031/how-do-i-convert-a-python-string-array-to-pointerc-void-p", "title": "How do I convert a python string array to POINTER(c_void_p)", "body": "<p>I'm trying to pass a python string array to Go, so I need to construct a 'GoSlice' from a python string array. A quick google search shows how to do this for integer arrays but I'm struggling to so the same for string arrays. Any help would be appreciated</p>\n"}, {"tags": ["go", "module", "go-modules"], "answers": [{"tags": [], "owner": {"reputation": 748, "user_id": 1645024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4835a765a5fb1547008d916a5165a702?s=128&d=identicon&r=PG", "display_name": "bcmills", "link": "https://stackoverflow.com/users/1645024/bcmills"}, "is_accepted": true, "score": 1, "last_activity_date": 1564428662, "creation_date": 1564428662, "answer_id": 57260343, "question_id": 54730564, "link": "https://stackoverflow.com/questions/54730564/module-does-not-cache-save-in-golang-test-build-process-how-do-you-work-around/57260343#57260343", "title": "Module does not cache/save in golang test/build process. How do you work around this?", "body": "<p>This symptom looks like the one in <a href=\"https://golang.org/issue/29773\" rel=\"nofollow noreferrer\">https://golang.org/issue/29773</a>, which is fixed at head (but not in <code>go1.13beta1</code> or earlier releases). Try it using a <code>go</code> command built from head, which you can obtain easily using the <a href=\"https://godoc.org/golang.org/dl/gotip\" rel=\"nofollow noreferrer\"><code>gotip</code></a> tool.</p>\n\n<p>If you're still seeing this using <code>gotip</code>, please open an issue by filling out the template at <a href=\"https://golang.org/issue/new\" rel=\"nofollow noreferrer\">https://golang.org/issue/new</a>.</p>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 57260343, "answer_count": 1, "score": 1, "last_activity_date": 1564443451, "creation_date": 1550382990, "last_edit_date": 1564443451, "question_id": 54730564, "link": "https://stackoverflow.com/questions/54730564/module-does-not-cache-save-in-golang-test-build-process-how-do-you-work-around", "title": "Module does not cache/save in golang test/build process. How do you work around this?", "body": "<p>In one of my projects, using go modules. It has started to continually do a search for a module every single time I do anything. I include lots of modules, but only one does this (see below). How do I work around this?</p>\n\n<pre><code>&gt; go test -run TestUodate\ngo: finding github.com/mohae/deepcopy latest\nPASS\nok    example.com/example/stuff   0.698s\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550382384, "post_id": 54730455, "comment_id": 96244095, "body": "Why are you posting a merge sort code? It doesn&#39;t seem relevant."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1550387782, "post_id": 54730934, "comment_id": 96244934, "body": "This makes great use of the &quot;You may assume that the arguments are really pumpungs&quot; clause. I&#39;d be interested to see a solution where you <i>can&#39;t</i> make such an assumption :)"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1550387668, "last_edit_date": 1550387668, "creation_date": 1550386895, "answer_id": 54730934, "question_id": 54730455, "link": "https://stackoverflow.com/questions/54730455/how-to-merge-consecutive-integers/54730934#54730934", "title": "How to merge consecutive integers", "body": "<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nconst (\n    maxInt = int(^uint(0) &gt;&gt; 1)\n    minInt = -maxInt - 1\n)\n\nfunc isMerge(a1, a2 []int) bool {\n    min1, max1 := maxInt, minInt\n    for _, e1 := range a1 {\n        if min1 &gt; e1 {\n            min1 = e1\n        }\n        if max1 &lt; e1 {\n            max1 = e1\n        }\n    }\n\n    for _, e2 := range a2 {\n        if e2 == min1-1 || e2 == max1+1 {\n            return true\n        }\n    }\n\n    return false\n}\n\nfunc main() {\n    a1 := []int{100, 101}\n    a2 := []int{103, 104, 102}\n    a3 := []int{103, 104, 105}\n    fmt.Println(a1, a2, isMerge(a1, a2))\n    fmt.Println(a2, a1, isMerge(a2, a1))\n    fmt.Println(a1, a3, isMerge(a1, a3))\n    fmt.Println(a3, a1, isMerge(a3, a1))\n\n    a4 := []int{222, 221, 220, 219}\n    a5 := []int{221, 222, 223, 225, 224}\n    fmt.Println(a4, a5, isMerge(a4, a5))\n    fmt.Println(a5, a4, isMerge(a5, a4))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/rRGPoivhEWW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/rRGPoivhEWW</a></p>\n\n<p>Output:</p>\n\n<pre><code>[100 101] [103 104 102] true\n[103 104 102] [100 101] true\n[100 101] [103 104 105] false\n[103 104 105] [100 101] false\n[222 221 220 219] [221 222 223 225 224] true\n[221 222 223 225 224] [222 221 220 219] true\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6821299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd1393550c2030d37f688054fe040aaf?s=128&d=identicon&r=PG&f=1", "display_name": "Faker", "link": "https://stackoverflow.com/users/6821299/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1550416113, "creation_date": 1550381761, "last_edit_date": 1550416113, "question_id": 54730455, "link": "https://stackoverflow.com/questions/54730455/how-to-merge-consecutive-integers", "title": "How to merge consecutive integers", "body": "<p>I want to know if there's a good way to return true if both integers can be merged but it must be in consecutive means, {100,101} can be merge with {103, 104, 102 }, but not {100,101} and {103,104,105} (Missing 102) coding based on the question.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>package main\r\n \r\nimport (\r\n    \"fmt\"\r\n    \"math/rand\"\r\n    \"time\"\r\n)\r\n \r\nfunc main() {\r\n \r\n    slice := generateSlice(20)\r\n    fmt.Println(\"\\n--- Unsorted --- \\n\\n\", slice)\r\n    fmt.Println(\"\\n--- Sorted ---\\n\\n\", mergeSort(slice), \"\\n\")\r\n}\r\n \r\n// Generates a slice of size, size filled with random numbers\r\nfunc generateSlice(size int) []int {\r\n \r\n    slice := make([]int, size, size)\r\n    rand.Seed(time.Now().UnixNano())\r\n    for i := 0; i &lt; size; i++ {\r\n        slice[i] = rand.Intn(999) - rand.Intn(999)\r\n    }\r\n    return slice\r\n}\r\n  \r\nfunc mergeSort(items []int) []int {\r\n    var num = len(items)\r\n      \r\n    if num == 1 {\r\n        return items\r\n    }\r\n      \r\n    middle := int(num / 2)\r\n    var (\r\n        left = make([]int, middle)\r\n        right = make([]int, num-middle)\r\n    )\r\n    for i := 0; i &lt; num; i++ {\r\n        if i &lt; middle {\r\n            left[i] = items[i]\r\n        } else {\r\n            right[i-middle] = items[i]\r\n        }\r\n    }\r\n      \r\n    return merge(mergeSort(left), mergeSort(right))\r\n}\r\n  \r\nfunc merge(left, right []int) (result []int) {\r\n    result = make([]int, len(left) + len(right))\r\n      \r\n    i := 0\r\n    for len(left) &gt; 0 &amp;&amp; len(right) &gt; 0 {\r\n        if left[0] &lt; right[0] {\r\n            result[i] = left[0]\r\n            left = left[1:]\r\n        } else {\r\n            result[i] = right[0]\r\n            right = right[1:]\r\n        }\r\n        i++\r\n    }\r\n      \r\n    for j := 0; j &lt; len(left); j++ {\r\n        result[i] = left[j]\r\n        i++\r\n    }\r\n    for j := 0; j &lt; len(right); j++ {\r\n        result[i] = right[j]\r\n        i++\r\n    }\r\n      \r\n    return\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Output: </p>\n\n<p><a href=\"https://play.golang.org/p/oAtGTiUnxrE\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oAtGTiUnxrE</a></p>\n\n<p>The question: </p>\n\n<p>A pumpung is a permutation of consecutive integers, possibly with repeated items.\nTwo pumpungs can be merged if they form a bigger pumpung. For example,\n[100, 101] and [103, 102, 104],\n[222, 221, 220, 219] and [221, 222, 223, 225, 224]\ncan be merged; whereas\n[100, 101] and [103, 104, 105]\ncannot.\nWrite a function, IsMergeable(pumpung1, pumpung2), returning true iff the given\npumpungs can be merged. You may assume that the arguments are really pumpungs.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1550381781, "post_id": 54730287, "comment_id": 96244002, "body": "I&#39;ve added it to the original question"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1550382315, "post_id": 54730287, "comment_id": 96244083, "body": "Make sure <code>values</code> has more elems than <code>results.Result</code>. Then make sure <code>datatest</code> always contains &quot;, &quot;."}, {"owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "edited": false, "score": 0, "creation_date": 1550383196, "post_id": 54730287, "comment_id": 96244207, "body": "It does, I can get good data when I remove that.  I am trying to filter unwanted city names that comes through my results i&#39;m getting out."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1550383896, "post_id": 54730287, "comment_id": 96244314, "body": "Which line of code panics?  That will point to the problem (which is probably one of the ones listed by @leafbebop)."}, {"owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "edited": false, "score": 0, "creation_date": 1550384012, "post_id": 54730287, "comment_id": 96244322, "body": "dtresult[1] == ps.ByName(&quot;name&quot;) panics"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1550387133, "post_id": 54730287, "comment_id": 96244815, "body": "If you get an error there then that means that <code>dtresult</code> has less than two elements. That is, index <code>1</code> which attempts to access a 2nd element is out of range because there is no 2nd element. To avoid the panic you can check the length before indexing the slice. E.g. <code>if len(dtresult) &gt; 1 &amp;&amp; dtresult[0] == ps.ByName(&quot;name&quot;) { ...</code>. This also means that not all of the <code>values[i].Name</code>s contain a <code>&quot;, &quot;</code> (with space), they may contain <code>&quot;,&quot;</code> (without space) but even that shouldn&#39;t ever be considered as guaranteed and you should always check the length of a slice before access."}], "owner": {"reputation": 645, "user_id": 695156, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/90e478591937482d1045181ad957a6b2?s=128&d=identicon&r=PG", "display_name": "Intelwalk", "link": "https://stackoverflow.com/users/695156/intelwalk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1550381758, "creation_date": 1550380160, "last_edit_date": 1550381758, "question_id": 54730287, "link": "https://stackoverflow.com/questions/54730287/comparing-substring-based-on-a-character-in-golang", "title": "Comparing subString based on a character in Golang", "body": "<p>I need to take a string in this format 1704 Woodward Avenue, Muscle Shoals and take the substring after the ', ' and compare it with another string.  I keep trying to use the strings.Split(data,', ') but it keeps erroring after I do it.  Can anyone point me in the right direction for getting subStrings and making comparison in Golang?</p>\n\n<p>Code:</p>\n\n<pre><code>for i := 0; i &lt; len(results.Results); i++ {\n\n        datatest := values[i].Name\n        dtresult := strings.Split(datatest, \", \")\n\n        if dtresult[1] == ps.ByName(\"name\") {\n\n            values[i].Name = results.Results[i].Name\n            values[i].Rating = strconv.FormatFloat(results.Results[i].Rating, 'f', 1, 64)\n            values[i].Icon = results.Results[i].Icon\n            values[i].Address = results.Results[i].Address\n        }\n    }\n</code></pre>\n\n<p>Error:\n2019/02/16 23:34:22 http: panic serving [::1]:51632: runtime error: index out of range\ngoroutine 19 [running]:</p>\n\n<p>Thanks</p>\n"}, {"tags": ["pointers", "go", "slice"], "answers": [{"tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1550359449, "creation_date": 1550359449, "answer_id": 54728658, "question_id": 54728455, "link": "https://stackoverflow.com/questions/54728455/how-to-access-struct-field-which-is-a-pointer-inside-of-a-struct-which-is-itself/54728658#54728658", "title": "How to access struct field which is a pointer inside of a struct which is itself a pointer", "body": "<p>Yes I think it will automatically dereference. See <a href=\"https://golang.org/ref/spec#Selectors\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Selectors</a></p>\n\n<p>I think rule number 3 is the one you're looking for:</p>\n\n<blockquote>\n  <p>As an exception, if the type of x is a defined pointer type and (*x).f is a valid selector expression denoting a field (but not a method), x.f is shorthand for (*x).f.</p>\n</blockquote>\n"}], "owner": {"reputation": 321, "user_id": 5799797, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/9e494da6b84910f338223ca57a4abd5e?s=128&d=identicon&r=PG&f=1", "display_name": "Madeleine Smith", "link": "https://stackoverflow.com/users/5799797/madeleine-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1550359449, "creation_date": 1550357441, "last_edit_date": 1550358696, "question_id": 54728455, "link": "https://stackoverflow.com/questions/54728455/how-to-access-struct-field-which-is-a-pointer-inside-of-a-struct-which-is-itself", "title": "How to access struct field which is a pointer inside of a struct which is itself a pointer", "body": "<p>In my code below, why does <code>*bikeSlice[0].Type</code> return to me the value of the <code>Type</code> field instead of the memory address? How come <code>*bikeSlice[0]</code> returns <code>{Type:0xc0000641c0}</code> though  <code>*bikeSlice[0].Type</code> seems to automatically dereference the <code>Type</code> field?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Bike struct {\n    Type *string\n}\n\nfunc main() {\n    type1 := \"road\"\n\n    bike1 := Bike{\n        Type: &amp;type1,\n    }\n\n    type2 := \"mountain\"\n\n    bike2 := Bike{\n        Type: &amp;type2,\n    }\n\n    var bikeSlice []*Bike\n\n    bikeSlice = append(bikeSlice, &amp;bike1)\n    bikeSlice = append(bikeSlice, &amp;bike2)\n\n    fmt.Printf(\"%+v\\n\", *bikeSlice[0])\n    fmt.Printf(\"%+v\", *bikeSlice[0].Type)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/2Q4Bt60SUdW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2Q4Bt60SUdW</a></p>\n\n<p>Output:</p>\n\n<pre><code>{Type:0x40e128}\nroad\n</code></pre>\n"}, {"tags": ["mongodb", "go"], "answers": [{"tags": [], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "is_accepted": true, "score": 0, "last_activity_date": 1550420215, "creation_date": 1550420215, "answer_id": 54735115, "question_id": 54727125, "link": "https://stackoverflow.com/questions/54727125/unable-to-find-elements-by-2sphere/54735115#54735115", "title": "Unable to find elements by 2sphere", "body": "<p>Finally found the issue.. Actually, I wasn't creating the index in the right way..</p>\n\n<pre><code>// EnsureIndex force ids to be unique\nfunc EnsureAddressIndex(session *mgo.Session) error {\n\n    _session := session.Copy()\n    defer _session.Close()\n\n    c := _session.DB(constants.DBName).C(addressDocument)\n    // Might be needed one day\n    pIndex := mgo.Index{\n        Key:  []string{\"$2dsphere:location\"},\n        Bits: 26,\n    }\n    err := c.EnsureIndex(pIndex)\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>At the index declaration, I had the following line:</p>\n\n<pre><code>pIndex := mgo.Index{\n    Key:  []string{\"location:2dsphere\"},\n    Bits: 26,\n}\n</code></pre>\n\n<p>But the correct way to write it is</p>\n\n<pre><code>pIndex := mgo.Index{\n    Key:  []string{\"$2dsphere:location\"},\n    Bits: 26,\n}\n</code></pre>\n\n<p>Hope it helps ! </p>\n"}], "owner": {"reputation": 3206, "user_id": 6093604, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/7f17S.jpg?s=128&g=1", "display_name": "Emixam23", "link": "https://stackoverflow.com/users/6093604/emixam23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 54735115, "answer_count": 1, "score": 0, "last_activity_date": 1550420215, "creation_date": 1550347215, "last_edit_date": 1592644375, "question_id": 54727125, "link": "https://stackoverflow.com/questions/54727125/unable-to-find-elements-by-2sphere", "title": "Unable to find elements by 2sphere", "body": "<p>I am coming because I need to realize geocalculs, however, it doesn't work. I am currently using the package <code>globalsign/mgo</code></p>\n<p>From the doc we have this:</p>\n<pre><code>db.&lt;collection&gt;.find( { &lt;location field&gt; :\n        { $near :\n            { $geometry :\n                { type : &quot;Point&quot; ,\n                     coordinates : [ &lt;longitude&gt; , &lt;latitude&gt; ] } ,\n                     $maxDistance : &lt;distance in meters&gt;,\n                } \n            }\n       }\n  )\n</code></pre>\n<p>Query a <em>2dsphere</em> index : <a href=\"https://docs.mongodb.com/manual/tutorial/query-a-2dsphere-index/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/tutorial/query-a-2dsphere-index/</a>\n<em>2dsphere</em> Indexes : <a href=\"https://docs.mongodb.com/manual/core/2dsphere/\" rel=\"nofollow noreferrer\">https://docs.mongodb.com/manual/core/2dsphere/</a></p>\n<p>So I have the following:</p>\n<pre><code>import (\n    &quot;github.com/globalsign/mgo/bson&quot;\n    &quot;shared/models&quot;\n    &quot;time&quot;\n)\n\ntype Address struct {\n    ID                 *bson.ObjectId `protobuf:&quot;bytes,1,opt,name=id,proto3&quot; json:&quot;_id,omitempty&quot; bson:&quot;_id&quot;`\n    IsArchived         bool           `protobuf:&quot;varint,2,opt,name=IsArchived,proto3&quot; json:&quot;is_archived,omitempty&quot; bson:&quot;is_archived&quot;`\n    CreatedAt          time.Time      `protobuf:&quot;varint,3,opt,name=CreatedAt,proto3&quot; json:&quot;created_at,omitempty&quot; bson:&quot;created_at&quot;`\n    UpdatedAt          time.Time      `protobuf:&quot;varint,4,opt,name=UpdatedAt,proto3&quot; json:&quot;update_at,omitempty&quot; bson:&quot;updated_at&quot;`\n    PlaceID            *bson.ObjectId `protobuf:&quot;bytes,5,opt,name=PlaceID,proto3&quot; json:&quot;place_id,omitempty&quot; bson:&quot;place_id&quot;`\n    CountryCode        string         `protobuf:&quot;bytes,6,opt,name=CountryCode,proto3&quot; json:&quot;country_code,omitempty&quot; bson:&quot;country_code,omitempty&quot;`\n    AdministrativeArea string         `protobuf:&quot;bytes,7,opt,name=AdministrativeArea,proto3&quot; json:&quot;administrative_area,omitempty&quot; bson:&quot;administrative_area,omitempty&quot;`\n    Locality           string         `protobuf:&quot;bytes,8,opt,name=Locality,proto3&quot; json:&quot;locality,omitempty&quot; bson:&quot;locality,omitempty&quot;`\n    PostalCode         string         `protobuf:&quot;bytes,9,opt,name=PostalCode,proto3&quot; json:&quot;postal_code,omitempty&quot; bson:&quot;postal_code,omitempty&quot;`\n    Thoroughfare       string         `protobuf:&quot;bytes,10,opt,name=Thoroughfare,proto3&quot; json:&quot;thoroughfare,omitempty&quot; bson:&quot;thoroughfare,omitempty&quot;`\n    Premise            string         `protobuf:&quot;bytes,11,opt,name=Premise,proto3&quot; json:&quot;premise,omitempty&quot; bson:&quot;premise,omitempty&quot;`\n    Location           GeoJson `protobuf:&quot;bytes,12,opt,name=Location,proto3&quot; json:&quot;location,omitempty&quot; bson:&quot;location,omitempty&quot;`\n}\n\ntype GeoJson struct {\n    Type        string    `json:&quot;-&quot;`\n    Coordinates []float64 `json:&quot;coordinates&quot;`\n}\n\nvar addresses []*models.Address\ncollection := _session.DB(constants.DBName).C(documentName)\nerr := collection.Find(session, addressDocument, bson.M{\n    &quot;location&quot;: bson.M{\n        &quot;$near&quot;: bson.M{\n            &quot;$geometry&quot;: bson.M{\n                &quot;type&quot;:        &quot;Point&quot;,\n                &quot;coordinates&quot;: []float64{ -115.172813, 36.101379 },\n            },\n            &quot;$maxDistance&quot;: 5000000,\n        },\n    },\n}) &amp;addresses)\n</code></pre>\n<p>From this, I got the following error:</p>\n<blockquote>\n<p>&quot;error processing query: ns=DBNAME.addressDocumentTree: GEONEAR  field=location maxdist=5e+06 isNearSphere=0\\nSort: {}\\nProj: {}\\n planner returned error: unable to find index for $geoNear query&quot;</p>\n</blockquote>\n<p><strong>I ensure my index at the initialization of my program</strong></p>\n<pre><code>// EnsureIndex\nfunc EnsureAddressIndex(session *mgo.Session) error {\n\n    _session := session.Copy()\n    defer _session.Close()\n\n    c := _session.DB(constants.DBName).C(addressDocument)\n    // Might be needed one day\n    pIndex := mgo.Index{\n        Key:  []string{&quot;location:2dsphere&quot;},\n        Bits: 26,\n    }\n    err := c.EnsureIndex(pIndex)\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n<p>Any idea? I have more than 20k addresses and they all have lat/lng.</p>\n<h1>Edit 1</h1>\n<p>I tried to switch from <code>globalsign/mgo</code> to <code>gopkg.in/mgo.v2</code> with no success</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1550346758, "post_id": 54726932, "comment_id": 96237964, "body": "See related / possible duplicates: <a href=\"https://stackoverflow.com/questions/45288751/what-use-case-does-pointers-to-pointer-eg-int-have/45297016#45297016\">What use case does pointers to pointer (eg **int) have?</a>; and <a href=\"https://stackoverflow.com/questions/35421495/golang-can-the-pointer-in-a-struct-pointer-method-be-reassigned-to-another-inst/35426997#35426997\">Golang: Can the pointer in a struct pointer method be reassigned to another instance?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3063, "user_id": 5075720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNyMGvaELDs/AAAAAAAAAAI/AAAAAAAAVnw/P1Rt8TFE2gc/photo.jpg?sz=128", "display_name": "PaSTE", "link": "https://stackoverflow.com/users/5075720/paste"}, "edited": false, "score": 1, "creation_date": 1550346494, "post_id": 54726966, "comment_id": 96237920, "body": "Note that the pass-by-value behavior of go is defined in the spec under <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls</a>"}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "reply_to_user": {"reputation": 3063, "user_id": 5075720, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNyMGvaELDs/AAAAAAAAAAI/AAAAAAAAVnw/P1Rt8TFE2gc/photo.jpg?sz=128", "display_name": "PaSTE", "link": "https://stackoverflow.com/users/5075720/paste"}, "edited": false, "score": 0, "creation_date": 1550346611, "post_id": 54726966, "comment_id": 96237936, "body": "@PaSTE: thanks for the suggestion - I have worked this into the answer (feel free to suggest an edit next time!)"}], "tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 4, "last_activity_date": 1550346585, "last_edit_date": 1550346585, "creation_date": 1550346060, "answer_id": 54726966, "question_id": 54726932, "link": "https://stackoverflow.com/questions/54726932/set-pointer-to-nil-from-method-or-function/54726966#54726966", "title": "Set pointer to nil from method or function", "body": "<p>You need a <a href=\"https://stackoverflow.com/questions/8768344/what-are-pointers-to-pointers-good-for\">pointer to pointer</a> to change a pointer's value.</p>\n\n<p>Here's your code sample, modified to do this (<a href=\"https://play.golang.org/p/2dVKgEaJNEe\" rel=\"nofollow noreferrer\">playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype position struct {\n    x int\n    y int\n}\n\nfunc destroy(p **position) {\n    *p = nil\n}\n\nfunc main() {\n    p1 := &amp;position{1, 1}\n    destroy(&amp;p1)\n\n    if p1 == nil {\n        fmt.Println(\"p1 == nil\")\n    } else {\n        fmt.Println(p1)\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>In your current code</p>\n\n<pre><code>func destroy(p *position) {\n    p = nil\n}\n</code></pre>\n\n<p>Inside <code>destroy</code>, <code>p</code> is a value the holds the address of a <code>position</code> struct. By assigning something to <code>p</code> itself, you're simply making it hold the address of some other <code>position</code> struct (or <code>nil</code>). You're not modifying the original pointer passed in.</p>\n\n<p>This isn't different from a function trying to modify its argument by assigning to it:</p>\n\n<pre><code>// This will not actually modify the argument passed in by the caller\nfunc setto2(value int) {\n  value = 2\n}\n</code></pre>\n\n<p>The go spec says, in the <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">section about calls and call parameters</a>:</p>\n\n<blockquote>\n  <p>After they are evaluated, the parameters of the call are passed by\n  value to the function and the called function begins execution. The\n  return parameters of the function are passed by value back to the\n  calling function when the function returns.</p>\n</blockquote>\n"}], "owner": {"reputation": 3339, "user_id": 1654940, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/88c65dba018958bb6462c0530016ec3b?s=128&d=identicon&r=PG", "display_name": "Marcin Doliwa", "link": "https://stackoverflow.com/users/1654940/marcin-doliwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 54726966, "answer_count": 1, "score": 2, "last_activity_date": 1550347311, "creation_date": 1550345856, "question_id": 54726932, "link": "https://stackoverflow.com/questions/54726932/set-pointer-to-nil-from-method-or-function", "title": "Set pointer to nil from method or function", "body": "<p>Why both these <code>destroy</code> functions do not change pointer to nil and how can I create such function?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype position struct {\n    x int\n    y int\n}\n\nfunc (p *position) destroy() {\n    p = nil\n}\n\nfunc destroy(p *position) {\n    p = nil\n}\n\nfunc main() {\n    p1 := &amp;position{1,1}\n    p2 := &amp;position{2,2}\n    p1.destroy()\n    destroy(p2)\n\n    if p1 == nil {\n        fmt.Println(\"p1 == nil\")\n    } else {\n        fmt.Println(p1)\n    }\n\n    if p2 == nil {\n        fmt.Println(\"p2 == nil\")\n    } else {\n        fmt.Println(p2)\n    }\n\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>&amp;{1 1}\n&amp;{2 2}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BmZjX1Hw24u\" rel=\"nofollow noreferrer\">https://play.golang.org/p/BmZjX1Hw24u</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 5, "last_activity_date": 1550344913, "creation_date": 1550344913, "answer_id": 54726792, "question_id": 54726660, "link": "https://stackoverflow.com/questions/54726660/a-tuple-assignment-in-go/54726792#54726792", "title": "A tuple assignment in Go", "body": "<p>Nope, it is not tuple assignment that gives wrong result.</p>\n\n<p>There is a subtle difference between the two code, which causes the bug. In the playgound code, <code>i,n = i+2,n-1</code> makes <code>n = n-1</code> runs everytimes the loop is iterated, while the github code only runs <code>n = n-1</code> when <code>i</code> is a prime (it skips <code>n--</code> if <code>continue next</code> runs).</p>\n"}], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 957, "favorite_count": 2, "accepted_answer_id": 54726792, "answer_count": 1, "score": 3, "last_activity_date": 1572650013, "creation_date": 1550344020, "last_edit_date": 1592644375, "question_id": 54726660, "link": "https://stackoverflow.com/questions/54726660/a-tuple-assignment-in-go", "title": "A tuple assignment in Go", "body": "<p>From <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">spec</a>:</p>\n<blockquote>\n<p>A tuple assignment assigns the individual elements of a multi-valued operation to a list of variables. There are two forms. In the first, the right-hand operand is a single multi-valued expression such as a function call, a channel or map operation, or a type assertion. The number of operands on the left-hand side must match the number of values. For instance, if f is a function returning two values, <code>x, y = f()</code> assigns the first value to x and the second to y. In the second form, the number of operands on the left must equal the number of expressions on the right, each of which must be single-valued, and the nth expression on the right is assigned to the nth operand on the left: <code>one, two, three = '\u4e00', '\u4e8c', '\u4e09'</code></p>\n<p>The assignment proceeds in two phases. First, the operands of index expressions and pointer indirections (including implicit pointer indirections in selectors) on the left and the expressions on the right are all evaluated in the usual order. Second, the assignments are carried out in the left-to-right order.</p>\n</blockquote>\n<p>Using <a href=\"https://play.golang.org/p/Is0DdM1roXe\" rel=\"nofollow noreferrer\">this</a> code ( <code>i, n = i+2, n-1</code> inside for loop) :</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;math&quot;\n)\n\nfunc main() {\n    p := &amp;Prime{}\n    p.Generate(1000000)\n    fmt.Println(p.Last()) // 15485863\n}\n\nfunc (p *Prime) Generate(n uint) {\n    p.Primes = make([]uint64, 1, n)\n    p.Primes[0] = 2\nnext:\n    for i := uint64(3); n &gt; 1; i, n = i+2, n-1 {\n        q := uint64(math.Sqrt(float64(i)))\n        for _, v := range p.Primes[1:] {\n            if v &gt; q {\n                break\n            }\n            if i%v == 0 {\n                continue next\n            }\n        }\n        p.Primes = append(p.Primes, i)\n        // n--\n    }\n}\n\ntype Prime struct {\n    Primes []uint64\n}\n\nfunc (p *Prime) Last() uint64 {\n    return p.Primes[len(p.Primes)-1]\n}\n</code></pre>\n<p>Output is:</p>\n<pre><code>1999993\n</code></pre>\n<p>This is <strong>not</strong> a correct result.</p>\n<p>And this code:</p>\n<pre><code>func (p *Prime) Generate(n uint) {\n    p.Primes = make([]uint64, 1, n)\n    p.Primes[0] = 2\nnext:\n    for i := uint64(3); n &gt; 1; i += 2 {\n        q := uint64(math.Sqrt(float64(i)))\n        for _, v := range p.Primes[1:] {\n            if v &gt; q {\n                break\n            }\n            if i%v == 0 {\n                continue next\n            }\n        }\n        p.Primes = append(p.Primes, i)\n        n--\n    }\n}\n</code></pre>\n<p>The output is correct:</p>\n<pre><code>15485863\n</code></pre>\n<p><code>go version go1.11.5 linux/amd64</code></p>\n<p>Am I missing something on tuple <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">Assignments</a> in Go?</p>\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 11034459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6dfed6ee23f471803b4387372ac33cf?s=128&d=identicon&r=PG&f=1", "display_name": "Zola Man", "link": "https://stackoverflow.com/users/11034459/zola-man"}, "edited": false, "score": 0, "creation_date": 1550379099, "post_id": 54726215, "comment_id": 96243667, "body": "I will try all day but nothing. That&#39;s all I want is know what difference between uintptr(unsafe.Pointer()) and uintptr() and why all values must be uintptr and why I cannot enter bool value and what I do with out values of library?"}, {"owner": {"reputation": 113, "user_id": 11034459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6dfed6ee23f471803b4387372ac33cf?s=128&d=identicon&r=PG&f=1", "display_name": "Zola Man", "link": "https://stackoverflow.com/users/11034459/zola-man"}, "edited": false, "score": 0, "creation_date": 1550379156, "post_id": 54726215, "comment_id": 96243674, "body": "Can you example for RtlAdjustPrivilege?"}], "tags": [], "owner": {"reputation": 3016, "user_id": 407861, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-6oTXFyxOgsM/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCdnbTTAUT8WV6--NCKwjh7D0ZnRw/mo/photo.jpg?sz=128", "display_name": "Alex V", "link": "https://stackoverflow.com/users/407861/alex-v"}, "is_accepted": true, "score": 1, "last_activity_date": 1550341102, "creation_date": 1550341102, "answer_id": 54726215, "question_id": 54725394, "link": "https://stackoverflow.com/questions/54725394/windows-api-dll-library-load-guide/54726215#54726215", "title": "Windows api dll library load guide", "body": "<p>There are quite a few guides on the topic.</p>\n\n<p><strong>The Golang wiki</strong> on Github has a rather decent introduction to importing Windows DLLs into Go programs, check it out: \n<a href=\"https://github.com/golang/go/wiki/WindowsDLLs\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/WindowsDLLs</a></p>\n\n<p>That ends with a link to <strong>cgo Documentation</strong>, where you will learn how to use C to import Windows DLLs from Go programs:\n<a href=\"https://github.com/golang/go/wiki/cgo\" rel=\"nofollow noreferrer\">https://github.com/golang/go/wiki/cgo</a></p>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 113, "user_id": 11034459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6dfed6ee23f471803b4387372ac33cf?s=128&d=identicon&r=PG&f=1", "display_name": "Zola Man", "link": "https://stackoverflow.com/users/11034459/zola-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 54726215, "answer_count": 1, "score": 0, "last_activity_date": 1550341102, "creation_date": 1550335794, "question_id": 54725394, "link": "https://stackoverflow.com/questions/54725394/windows-api-dll-library-load-guide", "title": "Windows api dll library load guide", "body": "<p>I want to know guide for load dll library with golang. For example how I can load <code>RtlAdjustPrivilege(int Privilege, bool bEnablePrivilege, bool IsThreadPrivilege, out bool PreviousValue)</code> from <code>ntdll.dll</code></p>\n\n<p>So for I know</p>\n\n<pre><code>c := syscall.MustLoadDLL(\"ntdll.dll\").MustFindProc(\"RtlAdjustPrivilege\")\n_, _, err = c.Call()\n</code></pre>\n"}, {"tags": ["dictionary", "go"], "answers": [{"tags": [], "owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "is_accepted": true, "score": 1, "last_activity_date": 1550334758, "creation_date": 1550334758, "answer_id": 54725224, "question_id": 54724467, "link": "https://stackoverflow.com/questions/54724467/is-it-possible-to-initialize-a-maps-values-upon-creation-of-a-new-mapping/54725224#54725224", "title": "Is it possible to initialize a map&#39;s values upon creation of a new mapping?", "body": "<p>The default value for slices is <code>nil</code>, which <code>append</code> can work with. You can do this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    m := make(map[string][]int)\n    m[\"test0\"] = append(m[\"test0\"], 10)\n    m[\"test1\"] = append(m[\"test1\"], 10)\n    m[\"test2\"] = append(m[\"test2\"], 10)\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>However, your case is trickier because your values are slices of slices. The default <code>nil</code> will not do in this case, because you're dereferencing a <code>nil</code> with <code>my_map[x][0]</code>. So you'll have to explicitly check if the <code>[0]</code> index was already allocated. There's nothing particularly inefficient about it, IMHO. It has the advantage of being explicit, so you can see exactly where things get allocated.</p>\n\n<p>If you wish, you can encapsulate this functionality into a function.</p>\n"}], "owner": {"reputation": 3243, "user_id": 5454400, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/50623f5ea714bc6271f9c34b13b090ab?s=128&d=identicon&r=PG&f=1", "display_name": "peachykeen", "link": "https://stackoverflow.com/users/5454400/peachykeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 54725224, "answer_count": 1, "score": 0, "last_activity_date": 1550334758, "creation_date": 1550329807, "last_edit_date": 1550331384, "question_id": 54724467, "link": "https://stackoverflow.com/questions/54724467/is-it-possible-to-initialize-a-maps-values-upon-creation-of-a-new-mapping", "title": "Is it possible to initialize a map&#39;s values upon creation of a new mapping?", "body": "<p>I am working with a map that goes from byte arrays to 2D lists whose separate list elements are unsigned 32 bit integers. i.e. <code>map[[8]byte][][]uint32</code></p>\n\n<p>Currently, I have logic that checks to see if the 2D list is populated, and if it isn't, I add two empty lists. From there I can begin to actually fill these lists. Like so:</p>\n\n<pre><code>my_map := make(map[[8]byte][][]uint32)\n/* Some logic to define x and i */\nif len(my_map[x]) == 0 {\n    /* Create two fresh inner-lists */\n}\nmy_map[x][0] = append(my_map[x][0], uint32(i))\n</code></pre>\n\n<p>However, that isn't the most elegant, nor efficient seeming solution. I was wondering if GO had a way to automatically populate a map's 2D list values with inner lists upon creation of a new mapping. Alternatively, if there is a better datatype to be using, I am all ears. </p>\n\n<p>Essentially, here is what I want to be able to do:</p>\n\n<pre><code>my_map := make(map[[8]byte][][]uint32)\n/* Some logic to define x and i */\nmy_map[x][0] = append(my_map[x][0], uint32(i))\n</code></pre>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 1, "last_activity_date": 1550333813, "creation_date": 1550333813, "answer_id": 54725082, "question_id": 54724403, "link": "https://stackoverflow.com/questions/54724403/read-and-write-on-the-same-channel-in-select/54725082#54725082", "title": "Read and write on the same channel in select", "body": "<p>It <a href=\"https://play.golang.org/p/zV0aURuRm8g\" rel=\"nofollow noreferrer\">works</a>, but is generally a bad idea(tm) </p>\n\n<p>your future software maintainers will hate you for it</p>\n\n<p>Note, if those loops are not exactly the same, then the app will crash with when the main goroutine blocks due to noone else writing or reading</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    c := make(chan int)\n\n    go func() {\n        for x := 0; x &lt; 5; x++ {\n            var i int\n            select {\n            case c &lt;- 1:\n                i = &lt;-c\n            case i = &lt;-c:\n                c &lt;- 1\n            }\n            fmt.Println(\" A - Written 1 red \", i)\n        }\n    }()\n    for x := 0; x &lt; 5; x++ {\n        var i int\n        select {\n        case c &lt;- 2:\n            i = &lt;-c\n        case i = &lt;-c:\n            c &lt;- 2\n        }\n        fmt.Println(\" B - Written 2 red \", i)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code> B - Written 2 red  1\n A - Written 1 red  2\n B - Written 2 red  1\n A - Written 1 red  2\n B - Written 2 red  1\n A - Written 1 red  2\n B - Written 2 red  1\n A - Written 1 red  2\n B - Written 2 red  1\n\nProgram exited.\n</code></pre>\n"}], "owner": {"reputation": 3247, "user_id": 625521, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f75ea35d0ffa8468c61f1fb2347a8000?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/625521/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 54725082, "answer_count": 1, "score": 1, "last_activity_date": 1550333813, "creation_date": 1550329393, "question_id": 54724403, "link": "https://stackoverflow.com/questions/54724403/read-and-write-on-the-same-channel-in-select", "title": "Read and write on the same channel in select", "body": "<p>Is it OK to exchange data between <strong>two</strong> routines using one channel this way?</p>\n\n<pre><code>c := make(chan int)\n\ngo func() {\n    var i int\n    select {\n    case c&lt;- 1:\n        i = &lt;-c\n    case i = &lt;-c:\n        c&lt;- 1\n    }\n    fmt.Println(\" A - Written 1 red \", i)\n}()\n\nvar i int\nselect {\ncase c&lt;- 2:\n    i = &lt;-c\ncase i = &lt;-c:\n    c&lt;- 2\n}\nfmt.Println(\" B - Written 2 red \", i)\n</code></pre>\n"}, {"tags": ["go", "deep-copy"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1550315659, "post_id": 54722448, "comment_id": 96229333, "body": "That&#39;s a shallow copy. If P has pointer fields you&#39;ll get a copy of those pointers pointing to the original values."}, {"owner": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550315741, "post_id": 54722448, "comment_id": 96229358, "body": "I have made some experiments, and the operations on the source don&#39;t have side effects on the copy and viceversa."}, {"owner": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550315821, "post_id": 54722448, "comment_id": 96229381, "body": "What if I have fields that are slices?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550315934, "post_id": 54722448, "comment_id": 96229409, "body": "You could provide the experiments if you have a different experience, however what i&#39;m seeing is this: <a href=\"https://play.golang.com/p/zHm2N36Pz18\" rel=\"nofollow noreferrer\">play.golang.com/p/zHm2N36Pz18</a>"}, {"owner": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1550316078, "post_id": 54722448, "comment_id": 96229439, "body": "<a href=\"https://play.golang.org/p/IT4RPhjG6lQ\" rel=\"nofollow noreferrer\">play.golang.org/p/IT4RPhjG6lQ</a>"}], "answers": [{"comments": [{"owner": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "edited": false, "score": 0, "creation_date": 1550321987, "post_id": 54722541, "comment_id": 96230812, "body": "Ok, so, basically, I can either devise a way to make an actual copy of my data structure or use the library <a href=\"https://github.com/jinzhu/copier\" rel=\"nofollow noreferrer\">github.com/jinzhu/copier</a>, right?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "edited": false, "score": 0, "creation_date": 1550324404, "post_id": 54722541, "comment_id": 96231446, "body": "See <a href=\"https://stackoverflow.com/questions/23033143/is-there-a-built-in-function-in-go-for-making-copies-of-arbitrary-maps\" title=\"is there a built in function in go for making copies of arbitrary maps\">stackoverflow.com/questions/23033143/&hellip;</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "edited": false, "score": 0, "creation_date": 1550419374, "post_id": 54722541, "comment_id": 96252315, "body": "@LucaMarzi, to understand why things work this way in Go, you should understand several things: 1) in Go,everything, ever is passed by value; 2) pointers (values of any pointer type) are itself values and are passed by value, too (sort of obviously); 3) <i>by their nature</i> all variables containing the same pointer value refer to the same object in memory; 4) some types either are pointers (maps, channels) or include pointers (strings, slices); custom Go types may be of either of these two varietes, too."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "edited": false, "score": 0, "creation_date": 1550419607, "post_id": 54722541, "comment_id": 96252372, "body": "@LucaMarzi, Once you&#39;ve absorbed this, the next thing to think through is that values of types which are pointers or contain pointer fields may form arbitrary hierarchies (a tree containing maps in its leaves is a silly but simple example), and how to deep-copy a value <i>of a particular type</i> is an open question which cannot have one &quot;true&quot; answer. To illustrate, let&#39;s consider my silly tree example. When deep-copying a tree, <i>usually</i> copying\u2014duplicating\u2014all the nodes is indeed a sensible thing, but you cannot say the same thing about the values the tree&#39;s leaves point to\u2014"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "edited": false, "score": 0, "creation_date": 1550419736, "post_id": 54722541, "comment_id": 96252403, "body": "@LucaMarzi,\u2014those might need be shared across all the existing trees. Now consider that blindly copying the tree&#39;s nodes has no sense: in different trees, each node should refer to the nodes of its own tree, not the tree the nodes were copied from. Please think of it. Go does not have any special syntax for &quot;automatic&quot; deep-copying simply because how to do a deep copy has to be decided on a case-by-case basis, there&#39;s no one-size-fits-all solution."}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 2, "last_activity_date": 1550316273, "creation_date": 1550316273, "answer_id": 54722541, "question_id": 54722448, "link": "https://stackoverflow.com/questions/54722448/how-to-deep-copy-objects/54722541#54722541", "title": "How to deep-copy objects", "body": "<p>this test shows that your method doesn't do a copy</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype teapot struct {\n   t []string\n}\ntype P struct {\n   a string\n   b teapot\n}\n\nfunc (receiver P) copy() *P{\n   return &amp;receiver\n}\n\nfunc main() {\n\nx:=new(P)\nx.b.t=[]string{\"aa\",\"bb\"}\ny:=x.copy()\n\ny.b.t[1]=\"cc\"  // y is altered but x should be the same\n\nfmt.Println(x)  // but as you can see...\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xL-E4XKNXYe\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xL-E4XKNXYe</a></p>\n"}], "owner": {"reputation": 728, "user_id": 1540840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/76b8ace6bc6887ef493e0a0b226cd116?s=128&d=identicon&r=PG", "display_name": "Luca Marzi", "link": "https://stackoverflow.com/users/1540840/luca-marzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1017, "favorite_count": 0, "closed_date": 1550419149, "accepted_answer_id": 54722541, "answer_count": 1, "score": -3, "last_activity_date": 1550416273, "creation_date": 1550315555, "last_edit_date": 1550416273, "question_id": 54722448, "link": "https://stackoverflow.com/questions/54722448/how-to-deep-copy-objects", "closed_reason": "Duplicate", "title": "How to deep-copy objects", "body": "<p>I have a complex data structure, which defines a type <strong>P</strong>, and I'd like to perform a deep copy of an instance of such a data structure.\nI have found <a href=\"https://github.com/jinzhu/copier\" rel=\"nofollow noreferrer\">this library</a> but, considering the semantics of the Go language, wouldn't a method like the following be more idiomatic?:</p>\n\n<pre><code>func (receiver P) copy() *P{\n   return &amp;receiver\n}\n</code></pre>\n\n<p>Since the method receives a value of type <strong>P</strong> (and values are always passed by copy), the result should be a reference to a deep copy of the source, like in this example:</p>\n\n<pre><code>src := new(P)\ndcp := src.copy()\n</code></pre>\n\n<p>Indeed, </p>\n\n<pre><code>src != dst =&gt; true\nreflect.DeepEqual(*src, *dst) =&gt; true\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550319869, "post_id": 54721986, "comment_id": 96230300, "body": "Try to delete the binary again. And do go install in your fork"}, {"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550489474, "post_id": 54721986, "comment_id": 96274476, "body": "@TobiasTheel, I did that already, multiple times, located all the binary files and deleted."}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550494146, "post_id": 54721986, "comment_id": 96277223, "body": "Okay, i don&#39;t exactly get your problem? You want to use the installed binary of your fork, yes?  If you deleted the old one and did a go install inside your fork, then everything should be fine"}, {"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550566395, "post_id": 54721986, "comment_id": 96304696, "body": "I really appreciate your help here. Yes, I want to use the installed binary of my fork. I am trying the steps you mentioned, yesterday it worked when I modified the Go files in the main directory but still not working when I modify the assets files (in another folder) which is what I have been trying from the beginning, must be my fault, because I don&#39;t much exp with Go Lang. But thank you for your help, will be using with the original repo for now due to time constraints."}, {"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 1, "creation_date": 1550571240, "post_id": 54721986, "comment_id": 96307754, "body": "Finally, this link helped: <a href=\"https://github.com/inconshreveable/ngrok/issues/181#issuecomment-65646229\" rel=\"nofollow noreferrer\">github.com/inconshreveable/ngrok/issues/&hellip;</a>, the problem was not generic but repo specific."}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550585037, "post_id": 54721986, "comment_id": 96316254, "body": "Then i suggest, that you add the link + a short explanation as answer and accept your own answer :)"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 2, "creation_date": 1550589998, "post_id": 54721986, "comment_id": 96319360, "body": "If you have actually solved the problem, you should either post your own answer or accept an existing answer. People will not expect to find answers in the question."}, {"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1550617520, "post_id": 54721986, "comment_id": 96332352, "body": "So it was XY-problem. I agree with @MichaelHampton that it would be better if you post your own solution as answer and accept it"}, {"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "reply_to_user": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550654383, "post_id": 54721986, "comment_id": 96343976, "body": "Done. Apologies, I am new to Go Lang, but thank you all for your help. @TobiasTheel"}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "edited": false, "score": 0, "creation_date": 1550314657, "post_id": 54722135, "comment_id": 96229083, "body": "Thanks for the quick response, but both the solution did not work for me."}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "reply_to_user": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "edited": false, "score": 0, "creation_date": 1550314851, "post_id": 54722135, "comment_id": 96229120, "body": "But they should work. Over the time i&#39;m using go i have successfully used both.  Can you edit your Question and provide what you have tried exactly? Maybe we can spot the mistake"}, {"owner": {"reputation": 68, "user_id": 1167282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0159ca706865623f2ac91bc359d5510?s=128&d=identicon&r=PG", "display_name": "albinowax", "link": "https://stackoverflow.com/users/1167282/albinowax"}, "edited": false, "score": 0, "creation_date": 1589450711, "post_id": 54722135, "comment_id": 109301634, "body": "I just used the second solution, worked perfectly for me"}], "tags": [], "owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "is_accepted": false, "score": 6, "last_activity_date": 1550313824, "last_edit_date": 1550313824, "creation_date": 1550313020, "answer_id": 54722135, "question_id": 54721986, "link": "https://stackoverflow.com/questions/54721986/issues-with-go-build-on-forked-repository/54722135#54722135", "title": "Issues with &#39;go build&#39; on forked repository", "body": "<p>That's a common problem in go. The references system in \"location based\" so it searches for these files in the \"correct\" path. Idk if go modules fix this issue, but atleast when not using go modules you'll have to work around it.</p>\n\n<p>You can solve it by</p>\n\n<h2>Solution 1</h2>\n\n<ol>\n<li>Download the original repository you forked by:</li>\n</ol>\n\n<blockquote>\n  <p>go get <a href=\"http://github.com/awesome-org/tool\" rel=\"nofollow noreferrer\">http://github.com/awesome-org/tool</a></p>\n</blockquote>\n\n<ol start=\"2\">\n<li>Add your fork as remote</li>\n</ol>\n\n<blockquote>\n  <p>git remote add awesome-you-fork <a href=\"http://github.com/awesome-you/tool\" rel=\"nofollow noreferrer\">http://github.com/awesome-you/tool</a></p>\n</blockquote>\n\n<ol start=\"3\">\n<li>You'll have to make changes in the folder of the original downloaded repo and Push and Pull to/from your fork. </li>\n</ol>\n\n<blockquote>\n  <p>git pull --rebase awesome-you-fork</p>\n  \n  <p>git push awesome-you-fork</p>\n</blockquote>\n\n<h2>Solution 2</h2>\n\n<p>Work around go get:\nYou create the path the original repo would have, but clone your own fork into it. That way you can push &amp; pull to your fork. That may be the better solution</p>\n\n<pre><code>cd $GOPATH\nmkdir -p {src,bin,pkg}\nmkdir -p src/github.com/awesome-org/\ncd src/github.com/awesome-org/\n\ngit clone git@github.com:awesome-you/tool.git # OR: git clone https://github.com/awesome-you/tool.git\ncd tool/\ngo get ./...\n</code></pre>\n\n<p>These Solutions were found here: <a href=\"http://code.openark.org/blog/development/forking-golang-repositories-on-github-and-managing-the-import-path\" rel=\"nofollow noreferrer\">http://code.openark.org/blog/development/forking-golang-repositories-on-github-and-managing-the-import-path</a></p>\n"}, {"comments": [{"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "edited": false, "score": 0, "creation_date": 1550319048, "post_id": 54722863, "comment_id": 96230111, "body": "Thanks, let me try those steps and update you by tomorrow."}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550319989, "post_id": 54722863, "comment_id": 96230333, "body": "Maybe a GO111MODULE=on is needed here"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1550323556, "post_id": 54722863, "comment_id": 96231218, "body": "Yes, GO111MODULE=on, or just put your code outside of GOPATH (which is what I do)"}, {"owner": {"reputation": 2616, "user_id": 4992212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cul0O.png?s=128&g=1", "display_name": "Tobias Theel", "link": "https://stackoverflow.com/users/4992212/tobias-theel"}, "edited": false, "score": 0, "creation_date": 1550325986, "post_id": 54722863, "comment_id": 96231877, "body": "Btw. this should be the accepted answer, as using go modules is better than a workaround :)"}, {"owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "edited": false, "score": 0, "creation_date": 1550489716, "post_id": 54722863, "comment_id": 96274597, "body": "I must share that I am new to Go language, but I did tried adding go.mod file, that didn&#39;t work, because the original repo does import other repo&#39;s but not in the format of <code>orig&#47;repo&#47;A</code>"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 3, "last_activity_date": 1550318635, "creation_date": 1550318635, "answer_id": 54722863, "question_id": 54721986, "link": "https://stackoverflow.com/questions/54721986/issues-with-go-build-on-forked-repository/54722863#54722863", "title": "Issues with &#39;go build&#39; on forked repository", "body": "<p>The problem with a forked copy of a go packages is when the package is really multiple go packages in one repo, the import statements refer to original base repo, ie: <code>github.com/orig/repo</code>.</p>\n\n<p>This is not an issue for repos with only one go package as it never refers to itself.  </p>\n\n<p>But if it has multiple, ie: package <code>github.com/orig/repo/A</code> imports <code>github.com/orig/repo/B</code> </p>\n\n<p>And then you fork it as: <code>github.com/fork/repo</code></p>\n\n<p>Then when the go compiler sees <code>import \"github.com/orig/repo/B\"</code> in the source, it goes to download the original version and not your fork.</p>\n\n<p>Fortunately, <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">go modules</a> solves this.</p>\n\n<p>Basically, create a <code>go.mod</code> at the top of your forked repo and add:\n<code>module github.com/orig/repo</code></p>\n\n<p>then, the go compiler will assume that you are \"orig/repo\" regardless of where you actually are checked out from.</p>\n\n<p>so, when <code>orig/repo/A</code> imports <code>orig/repo/B</code>, it will look locally.</p>\n\n<p>If there are other imports you need to override that are outside the main forked repo, you can also force dependencies to come from another place using <a href=\"https://github.com/golang/go/wiki/Modules#when-should-i-use-the-replace-directive\" rel=\"nofollow noreferrer\">replace</a></p>\n"}, {"tags": [], "owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "is_accepted": true, "score": 1, "last_activity_date": 1550654315, "creation_date": 1550654315, "answer_id": 54782712, "question_id": 54721986, "link": "https://stackoverflow.com/questions/54721986/issues-with-go-build-on-forked-repository/54782712#54782712", "title": "Issues with &#39;go build&#39; on forked repository", "body": "<p><strong>SOLVED</strong></p>\n\n<p>At first I thought it was problem with a FORK (which is a common problem experienced with fork of Go language repo's), but it turns out, it was Repo specific problem. \nOne of the dependent libraries had to be reinstalled for the forked repo to work, which was not mentioned in the Original repo docs.\nFinally, this link helped: <a href=\"https://github.com/inconshreveable/ngrok/issues/181#issuecomment-65646229\" rel=\"nofollow noreferrer\">https://github.com/inconshreveable/ngrok/issues/181#issuecomment-65646229</a>, the problem was not generic but repo specific\nI followed the below steps from above link to resolve the dependency on go-bindata</p>\n\n<pre><code>go get github.com/jteeuwen/go-bindata\ncd $GOPATH/src/github.com/jteeuwen/go-bindata/go-bindata\ngo build\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 1228430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QfV9C.jpg?s=128&g=1", "display_name": "MotsManish", "link": "https://stackoverflow.com/users/1228430/motsmanish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 963, "favorite_count": 2, "accepted_answer_id": 54782712, "answer_count": 3, "score": 4, "last_activity_date": 1550654315, "creation_date": 1550312006, "last_edit_date": 1550654026, "question_id": 54721986, "link": "https://stackoverflow.com/questions/54721986/issues-with-go-build-on-forked-repository", "title": "Issues with &#39;go build&#39; on forked repository", "body": "<p>I build a binary file for a GitHub repo (go code), which works fine. no issues.\nI forked that repo, and modified a single line in the HTML file that has nothing to do with GO code, built the binary file for the new forked repo but the binary it generates refers to the original repo code, can't understand why.</p>\n\n<p>I even cleaned all the code using <code>go clean -i all</code> command and manually removed all the installed code, binary files from $home/go/bin and the repo directory, but it still refers to the original repo code instead of new forked code.</p>\n\n<hr>\n\n<p>Based on the solution suggested by Tobias, I performed the following steps:\n<a href=\"https://i.stack.imgur.com/aftB0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aftB0.png\" alt=\"enter image description here\"></a></p>\n\n<p>After that, I executed <code>go build</code> in that repo directory, but the new binary file still refers to the old code. I even removed the old binary file and generated a new one.</p>\n\n<p><a href=\"https://i.stack.imgur.com/qcQ2P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qcQ2P.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["java", "android", "http", "go", "multipartform-data"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1550324371, "post_id": 54721548, "comment_id": 96231438, "body": "Calling <code>Header().Set</code> after the header has already been sent has no effect."}], "answers": [{"tags": [], "owner": {"reputation": 4078, "user_id": 2781271, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/22d16d429b7ea7d58974f91c889fbdcd?s=128&d=identicon&r=PG", "display_name": "CROSP", "link": "https://stackoverflow.com/users/2781271/crosp"}, "is_accepted": false, "score": 1, "last_activity_date": 1550321907, "last_edit_date": 1550321907, "creation_date": 1550313650, "answer_id": 54722219, "question_id": 54721548, "link": "https://stackoverflow.com/questions/54721548/how-to-parse-multipart-form-data/54722219#54722219", "title": "How to parse multipart/form-data?", "body": "<p>First of all I suggest you to use wrapper libraries for managing network connections, as far as it requires some experience to handle them in the right way. \nI don't you suggest manually crafting <code>multipart</code> request using <code>HttpURLConnection</code></p>\n\n<p><strong>Android</strong></p>\n\n<p>You can try to use <a href=\"https://square.github.io/okhttp/\" rel=\"nofollow noreferrer\">OkHTTP</a> or even <a href=\"https://square.github.io/retrofit/\" rel=\"nofollow noreferrer\">Retrofit</a>, if you don't want to manually configure the connection. </p>\n\n<p><em>OkHTTP</em></p>\n\n<p>Here is a basic example, I have omitted some parts like exception handling. Also please note you don't need to create the client for every call.</p>\n\n<pre><code>OkHttpClient client = new OkHttpClient.Builder().build();\nRequestBody body = new MultipartBody.Builder().setType(MultipartBody.FORM)\n       .addFormDataPart(\"image_file\", imageFileName, RequestBody.create(\n        MediaType.parse(\"image/jpeg\"), new File(pathToImage)));\n        .addFormDataPart(\"anyOtherFormArg\", arg1) \n        .addFormDataPart(\"anotherArg\", arg2)\n        .build();\nRequest request = new Request.Builder().url(url).post(body).build();\nResponse response = client.newCall(request).execute();\nresult = response.body().string();\n</code></pre>\n\n<p><em>Retrofit</em></p>\n\n<p>Retrofit just wraps underlying network requests with a pretty interface</p>\n\n<pre><code>@Multipart\n@POST(\"endpoint/image\")\nObservable&lt;ResponseBody&gt; uploadImage(@Part(\"arg1\") RequestBody arg1,\n                                       @Part MultipartBody.Part image);\n</code></pre>\n\n<p><strong>Go Server</strong></p>\n\n<p>On the server side you can try to use </p>\n\n<pre><code>func uploadHandler(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"POST\" {\n        err := r.ParseMultipartForm(32 &lt;&lt; 20) // 32MB max upload size\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        m := r.MultipartForm\n        var file_name string\n        file, handler, err := r.FormFile(\"image_file\")//get file \n        defer file.Close() //close the file when we finish\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        f, err := os.OpenFile(\"/path_to_save_image/\"+handler.Filename, os.O_WRONLY|os.O_CREATE, 0666)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        file_name = handler.Filename\n        defer f.Close()\n        io.Copy(f, file)\n\n        //return something\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.Write(\"success\")\n        w.WriteHeader(200)\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    w.Write(\"error\")\n    w.WriteHeader(400)\n}\n</code></pre>\n\n<p>This just a basic example, try to undertand each part and tune it as required.</p>\n"}], "owner": {"reputation": 43, "user_id": 1805930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d39d8ec408fc0b978a930e9658d15f88?s=128&d=identicon&r=PG", "display_name": "user1805930", "link": "https://stackoverflow.com/users/1805930/user1805930"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1889, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1550322019, "creation_date": 1550308349, "last_edit_date": 1550322019, "question_id": 54721548, "link": "https://stackoverflow.com/questions/54721548/how-to-parse-multipart-form-data", "title": "How to parse multipart/form-data?", "body": "<p>I have a server written in <code>Go</code>.<br>\nBasically, it receives POST-request and sends some file in response as multipart/form-data.<br>\nFollowing is the server code:  </p>\n\n<pre><code>func ColorTransferHandler(w http.ResponseWriter, r *http.Request) {\n    ... some routine...\n\n    w.WriteHeader(http.StatusOK)\n\n    mw := multipart.NewWriter(w)\n\n    filename := \"image_to_send_back.png\"\n\n    part, err := mw.CreateFormFile(\"image\", filename)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    local_file, err := os.Open(filename)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    local_file_content, err := ioutil.ReadAll(local_file)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    part.Write(local_file_content)\n\n    w.Header().Set(\"Content-Type\", mw.FormDataContentType())\n\n    if err := mw.Close(); err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n}\n</code></pre>\n\n<p>Client code in <code>Java</code> for Android:  </p>\n\n<pre><code>public class ConnectionUtility {\n    private final String boundary;\n    private static final String LINE_FEED = \"\\r\\n\";\n    private HttpURLConnection httpConn;\n    private String charset;\n    private OutputStream outputStream;\n    private PrintWriter writer;\n\n    public List&lt;String&gt; finish() throws IOException {\n        // ...\n        // content filling\n        // ...\n\n        writer.append(LINE_FEED).flush();\n        writer.append(\"--\" + boundary + \"--\").append(LINE_FEED);\n        writer.close();\n\n        List&lt;String&gt; response = new ArrayList&lt;String&gt;();\n\n        // checks server's status code first\n        int status = httpConn.getResponseCode();\n        if (status == HttpURLConnection.HTTP_OK) {\n            BufferedReader reader = new BufferedReader(new InputStreamReader(httpConn.getInputStream()));\n            String line = null;\n            while ((line = reader.readLine()) != null) {\n                response.add(line);\n            }\n            reader.close();\n            httpConn.disconnect();\n        } else {\n            throw new IOException(\"Server returned non-OK status: \" + status);\n        }\n\n        return response;\n    }\n\n</code></pre>\n\n<p>Following are my questions:<br>\n 1. How do I edit this function to get that image file and save it on a drive?<br>\n 2. Probably I can use some libraries to do this?</p>\n\n<p>Help will be appreciated</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1550308403, "post_id": 54721493, "comment_id": 96227656, "body": "Don&#39;t use <code>Query</code> for single-row retrievals, use <code>QueryRow</code> instead. And when you do need to retrieve multiple rows then you have to use <code>Query</code>, however you need to always remember to close the rows returned by it, not closing them will result in your app getting stuck as there will be no available connections. Take a look at the docs to see how <a href=\"https://golang.org/pkg/database/sql/#example_Rows\" rel=\"nofollow noreferrer\">Query</a> and <a href=\"https://golang.org/pkg/database/sql/#example_DB_QueryRowContext\" rel=\"nofollow noreferrer\">QueryRow</a> are to be used."}, {"owner": {"reputation": 230015, "user_id": 8206, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/fc761ccaf6c0d7d977e2959f9bfebd06?s=128&d=identicon&r=PG", "display_name": "Eli Bendersky", "link": "https://stackoverflow.com/users/8206/eli-bendersky"}, "edited": false, "score": 1, "creation_date": 1550354857, "post_id": 54721493, "comment_id": 96239865, "body": "There&#39;s a lot going on in your question. Could you perhaps extract a minimal example (<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>) of what&#39;s not working? That would greatly increase the chance of your question getting an answer"}], "answers": [{"tags": [], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "is_accepted": true, "score": 1, "last_activity_date": 1550369245, "creation_date": 1550369245, "answer_id": 54729497, "question_id": 54721493, "link": "https://stackoverflow.com/questions/54721493/cant-get-value-from-gorilla-sessions-with-mysql-backend-using-golang/54729497#54729497", "title": "Can&#39;t get value from gorilla/sessions with mySQL backend using Golang", "body": "<p>It turns out that I needed to register a struct to use it in Gorilla sessions.</p>\n\n<pre><code>import (\n\"encoding/gob\"\n)\n\nfunc main() {\n gob.Register(Venue{})\n}\n</code></pre>\n"}], "owner": {"reputation": 1176, "user_id": 951321, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9eb886c753c17c33ba7fd8061af43e3f?s=128&d=identicon&r=PG", "display_name": "markhorrocks", "link": "https://stackoverflow.com/users/951321/markhorrocks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 54729497, "answer_count": 1, "score": 0, "last_activity_date": 1550369245, "creation_date": 1550307833, "question_id": 54721493, "link": "https://stackoverflow.com/questions/54721493/cant-get-value-from-gorilla-sessions-with-mysql-backend-using-golang", "title": "Can&#39;t get value from gorilla/sessions with mySQL backend using Golang", "body": "<p>I am trying to save a struct for my model in gorilla sessions with a mySQL backend but only get 0 for venueID when I try to retrieve it. I have no trouble saving and getting flash messages. My goal is to save the model struct in the session and retrieve it to get the id number in edit, update and delete functions.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>type appResource struct {\n    tmpl  *template.Template // net/http\n    store *mysqlstore.MySQLStore\n    db    *sql.DB // database/sql\n}\n\n// newAppResource function to pass global var\nfunc newAppResource(store *mysqlstore.MySQLStore, db *sql.DB, tmpl *template.Template) *appResource {\n    return &amp;appResource{\n        store: store,\n        db:    db,\n        tmpl:  tmpl,\n    }\n}\n\nfunc main() {\n\nsessionKey := os.Getenv(\"sessionKey\")\n\n    endpoint := fmt.Sprintf(\"%s:%s@tcp(%s:%s)/%s?parseTime=true&amp;loc=Local\", dbUser, dbPass, dbHost, dbPort, dbName)\n    tableName := \"sessions\"\n    path := \"/\"\n    maxAge := 3600\n    codecs := []byte(sessionKey)\n\n    store, err := mysqlstore.NewMySQLStore(endpoint, tableName, path, maxAge, codecs)\n    if err != nil {\n        log.Println(\"SESSIONS STORE error\")\n        log.Fatal(err)\n....\n    }\n\n}\n\n\ntype Venue struct {\n    VenueID int\n    Name    string\n    Email   string\n    Phone   string\n    Active  bool\n}\n\n// VenueData template variable for show and edit\ntype VenueData struct {\n    Venue   Venue\n    Flashes []interface{}\n}\n\nfunc (rs *appResource) venuesShow(w http.ResponseWriter, r *http.Request) {\n\n    var venue Venue\n\n    var data VenueData\n\n    id := r.URL.Query().Get(\"id\")\n\n    venueID, err := strconv.Atoi(id)\n    if err != nil {\n        log.Println(\"show venue ID not &gt; 0\")\n        http.Redirect(w, r, \"/login\", http.StatusUnauthorized)\n        return\n    }\n\n    if !(venueID &gt; 0) {\n        log.Println(\"update venue ID not &gt; 0\")\n        http.Redirect(w, r, \"/login\", http.StatusUnauthorized)\n        return\n    }\n\n    query, err := rs.db.Query(\"SELECT id, name, email, phone, active FROM Venues WHERE id=?\", venueID)\n    if err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    for query.Next() {\n\n        err = query.Scan(&amp;venue.VenueID, &amp;venue.Name, &amp;venue.Email, &amp;venue.Phone, &amp;venue.Active)\n        if err != nil {\n            log.Fatal(err)\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n    }\n\n    data.Venue = venue\n\n    session, err := rs.store.Get(r, \"admin-data\")\n    if err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    log.Println(venue.VenueID)\n\n    if flashes := session.Flashes(); len(flashes) &gt; 0 {\n        for _, message := range flashes {\n            data.Flashes = append(data.Flashes, message)\n        }\n    }\n\n    session.Values[\"venue\"] = venue\n\n    session.Save(r, w)\n    if err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    if err := rs.tmpl.ExecuteTemplate(w, \"venues-show\", data); err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n\n\nfunc (rs *appResource) venuesEdit(w http.ResponseWriter, r *http.Request) {\n\n    var data VenueData\n\n    session, err := rs.store.Get(r, \"admin-data\")\n    if err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    venue := getVenue(session)\n\n    venueID := venue.VenueID\n\n    query, err := rs.db.Query(\"SELECT id, name, email, phone, active FROM Venues WHERE id=?\", venueID)\n    if err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    for query.Next() {\n\n        err = query.Scan(&amp;venueID, &amp;venue.Name, &amp;venue.Email, &amp;venue.Phone, &amp;venue.Active)\n        if err != nil {\n            log.Fatal(err)\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n        data.Venue = venue\n    }\n\n    if err := rs.tmpl.ExecuteTemplate(w, \"venues-edit\", data); err != nil {\n        log.Fatal(err)\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n\n\nfunc getVenue(s *sessions.Session) Venue {\n    val := s.Values[\"venue\"]\n    var venue = Venue{}\n    venue, ok := val.(Venue)\n    if !ok {\n        log.Println(\"no venue found\")\n        return Venue{}\n    }\n    return venue\n}\n</code></pre>\n"}]